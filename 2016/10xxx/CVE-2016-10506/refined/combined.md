=== Content from github.com_9d14538f_20250126_055404.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522Priority-Cri)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

state:open label:"Priority-Cri

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522Priority-Cri)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_eb87455c_20250125_041509.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F777)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F777)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 444) #777

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 444)](#top)#777Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on May 6, 2016](https://github.com/uclouvain/openjpeg/issues/777#issue-153384565)
# Title

division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 444)

# Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/05/06)

# Exception Information

```
Program received signal SIGFPE, Arithmetic exception.
0xb698ae01 in opj_pi_next_pcrl (pi=0xb4603d80) at
    /home/trylab/Desktop/repo/openjpeg/src/lib/openjp2/pi.c:444
444 if (!((pi->y % (OPJ_INT32)(comp->dy << rpy) == 0) ||
        ((pi->y == pi->ty0) && ((try0 << levelno) % (1 << rpy))))){

```
# PoC

[https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE\_opj\_pi\_next\_pcrl@444/poc.j2k](https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE_opj_pi_next_pcrl%40444/poc.j2k)

# Credit

Ke Liu of Tencent's Xuanwu LAB

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_15d36692_20250125_041507.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F731)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F731)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero (SIGFPE) error in opj\_pi\_next\_cprl function (line 523 of pi.c) #731

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero (SIGFPE) error in opj\_pi\_next\_cprl function (line 523 of pi.c)](#top)#731Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on Mar 28, 2016](https://github.com/uclouvain/openjpeg/issues/731#issue-143931420)

---

## Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/03/28)

---

## Exception Information

```
Program received signal SIGFPE, Arithmetic exception.
0xb7fb8ca1 in opj_pi_next_cprl (pi=0x80850d8)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:523
523  if (!((pi->y % (OPJ_INT32)(comp->dy << rpy) == 0) ||
        ((pi->y == pi->ty0) && ((try0 << levelno) % (1 << rpy))))){

(gdb) p rpy
$4 = 26
(gdb) p comp->dy
$5 = 128

(gdb) bt
#0  0xb7fb8ca1 in opj_pi_next_cprl (pi=0x80850d8)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:523
#1  0xb7fbc4cc in opj_pi_next (pi=0x80850d8)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:1871
#2  0xb7fc0b8d in opj_t2_decode_packets (p_t2=0x8084a90, p_tile_no=0,
                                         p_tile=0x80658d0, p_src=0x80668d8 "\337\aV",
                                         p_data_read=0xbfff9dec, p_max_len=0,
                                         p_cstr_index=0x8061d68, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/t2.c:412
#3  0xb7fc6368 in opj_tcd_t2_decode (p_tcd=0x8065890, p_src_data=0x80668d8 "\337\aV",
                                     p_data_read=0xbfff9dec, p_max_src_size=225,
                                     p_cstr_index=0x8061d68, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/tcd.c:1552
#4  0xb7fc5d17 in opj_tcd_decode_tile (p_tcd=0x8065890, p_src=0x80668d8 "\337\aV",
                                       p_max_length=225, p_tile_no=0,
                                       p_cstr_index=0x8061d68, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/tcd.c:1291
#5  0xb7fa832a in opj_j2k_decode_tile (p_j2k=0x8060298, p_tile_index=0,
                                       p_data=0x80664c8 "", p_data_size=97,
                                       p_stream=0x8060170, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:8125
#6  0xb7fac369 in opj_j2k_decode_tiles (p_j2k=0x8060298, p_stream=0x8060170,
                                        p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:9745
#7  0xb7fa661e in opj_j2k_exec (p_j2k=0x8060298, p_procedure_list=0x8062420,
                                p_stream=0x8060170, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:7341
#8  0xb7facaf9 in opj_j2k_decode (p_j2k=0x8060298, p_stream=0x8060170,
                                  p_image=0x8065cc0, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:9943
#9  0xb7fb1aad in opj_jp2_decode (jp2=0x8060210, p_stream=0x8060170,
                                  p_image=0x8065cc0, p_manager=0x80601e4)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/jp2.c:1487
#10 0xb7fb6c79 in opj_decode (p_codec=0x80601b8, p_stream=0x8060170, p_image=0x8065cc0)
    at /home/username/Desktop/openjpeg/src/lib/openjp2/openjpeg.c:412
#11 0x0804c2c0 in main (argc=5, argv=0xbffff124)
    at /home/username/Desktop/openjpeg/src/bin/jp2/opj_decompress.c:1330

```

---

## Simple Analysis

The value of comp->dy is 128 and the value of rpy is 26.

The value evaluated from (OPJ\_INT32)(comp->dy << rpy) is 0 (128<<26 == 0).

The code pi->y%(OPJ\_INT32)(comp->dy<<rpy) will cause a divide-by-zero exception (SIGFPE).

---

## Proof-of-Concept file

Use [poc.j2k](https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE_opj_pi_next_cprl%40523/poc.j2k).

---

## Credit

This vulnerability was discovered by Ke Liu of Tencent's Xuanwu LAB.

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0b0a8bc9_20250125_041510.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F778)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F778)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 447) #778

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 447)](#top)#778Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on May 6, 2016](https://github.com/uclouvain/openjpeg/issues/778#issue-153384621)
# Title

division-by-zero in function opj\_pi\_next\_pcrl of pi.c (line 447)

# Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/05/06)

# Exception Information

```
Program received signal SIGFPE, Arithmetic exception.
0xb698af0c in opj_pi_next_pcrl (pi=0xb4603d80) at
    /home/trylab/Desktop/repo/openjpeg/src/lib/openjp2/pi.c:447
447 if (!((pi->x % (OPJ_INT32)(comp->dx << rpx) == 0) ||
        ((pi->x == pi->tx0) && ((trx0 << levelno) % (1 << rpx))))){

```
# PoC

[https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE\_opj\_pi\_next\_pcrl@447/poc.j2k](https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE_opj_pi_next_pcrl%40447/poc.j2k)

# Credit

Ke Liu of Tencent's Xuanwu LAB

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_44114506_20250125_041512.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F780)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F780)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 366) #780

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 366)](#top)#780Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on May 6, 2016](https://github.com/uclouvain/openjpeg/issues/780#issue-153384708)
# Title

division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 366)

# Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/05/06)

# Exception Information

```
Program received signal SIGFPE, Arithmetic exception.
0xb69892b1 in opj_pi_next_rpcl (pi=0xb3a03ec0) at
    /home/trylab/Desktop/repo/openjpeg/src/lib/openjp2/pi.c:366
366 if (!((pi->x % (OPJ_INT32)(comp->dx << rpx) == 0) ||
        ((pi->x == pi->tx0) && ((trx0 << levelno) % (1 << rpx))))){

```
# PoC

[https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE\_opj\_pi\_next\_rpcl@366/poc.j2k](https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE_opj_pi_next_rpcl%40366/poc.j2k)

# Credit

Ke Liu of Tencent's Xuanwu LAB

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d903a437_20250125_041508.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F732)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F732)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero (SIGFPE) error in opj\_pi\_next\_cprl function (line 526 of pi.c) #732

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero (SIGFPE) error in opj\_pi\_next\_cprl function (line 526 of pi.c)](#top)#732Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on Mar 28, 2016](https://github.com/uclouvain/openjpeg/issues/732#issue-143931527)

---

## Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/03/28)

---

## Exception Information

username@ubuntu:~/Desktop/openjpeg/bin$ gdb opj\_decompress -q

Reading symbols from opj\_decompress...done.

(gdb) r -o image.pgm -i crashes/002.j2k

Starting program: ~/Desktop/openjpeg/bin/opj\_decompress -o image.pgm -i crashes/002.j2k

Program received signal SIGFPE, Arithmetic exception.

0xb7fb8d01 in opj\_pi\_next\_cprl (pi=0x8090ec0)

at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:526

526 if (!((pi->x % (OPJ\_INT32)(comp->dx << rpx) == 0) ||

((pi->x == pi->tx0) && ((trx0 << levelno) % (1 << rpx))))){

(gdb) p comp->dx

$1 = 2

(gdb) p rpx

$2 = 31

(gdb) bt

#0 0xb7fb8d01 in opj\_pi\_next\_cprl (pi=0x8090ec0)

```
at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:526

```

[#1](https://github.com/uclouvain/openjpeg/issues/1) 0xb7fbc4cc in opj\_pi\_next (pi=0x8090ec0)

```
at /home/username/Desktop/openjpeg/src/lib/openjp2/pi.c:1871

```

[#2](https://github.com/uclouvain/openjpeg/issues/2) 0xb7fc0b8d in opj\_t2\_decode\_packets (p\_t2=0x8090878, p\_tile\_no=0, p\_tile=0x80658d0,

```
                                     p_src=0x80668d8 "\337\aV", p_data_read=0xbfff9dec,
                                     p_max_len=49, p_cstr_index=0x8061d68, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/t2.c:412

```

[#3](https://github.com/uclouvain/openjpeg/issues/3) 0xb7fc6368 in opj\_tcd\_t2\_decode (p\_tcd=0x8065890, p\_src\_data=0x80668d8 "\337\aV",

```
                                 p_data_read=0xbfff9dec, p_max_src_size=225,
                                 p_cstr_index=0x8061d68, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/tcd.c:1552

```

[#4](https://github.com/uclouvain/openjpeg/issues/4) 0xb7fc5d17 in opj\_tcd\_decode\_tile (p\_tcd=0x8065890, p\_src=0x80668d8 "\337\aV",

```
                                   p_max_length=225, p_tile_no=0,
                                   p_cstr_index=0x8061d68, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/tcd.c:1291

```

[#5](https://github.com/uclouvain/openjpeg/issues/5) 0xb7fa832a in opj\_j2k\_decode\_tile (p\_j2k=0x8060298, p\_tile\_index=0,

```
                                   p_data=0x80664c8 "", p_data_size=128,
                                   p_stream=0x8060170, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:8125

```

[#6](https://github.com/uclouvain/openjpeg/issues/6) 0xb7fac369 in opj\_j2k\_decode\_tiles (p\_j2k=0x8060298, p\_stream=0x8060170, p\_manager=0x80601e4)

```
at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:9745

```

[#7](https://github.com/uclouvain/openjpeg/issues/7) 0xb7fa661e in opj\_j2k\_exec (p\_j2k=0x8060298, p\_procedure\_list=0x8062420,

```
                            p_stream=0x8060170, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:7341

```

[#8](https://github.com/uclouvain/openjpeg/issues/8) 0xb7facaf9 in opj\_j2k\_decode (p\_j2k=0x8060298, p\_stream=0x8060170,

```
                              p_image=0x8065cc0, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/j2k.c:9943

```

[#9](https://github.com/uclouvain/openjpeg/issues/9) 0xb7fb1aad in opj\_jp2\_decode (jp2=0x8060210, p\_stream=0x8060170,

```
                              p_image=0x8065cc0, p_manager=0x80601e4)
at /home/username/Desktop/openjpeg/src/lib/openjp2/jp2.c:1487

```

[#10](https://github.com/uclouvain/openjpeg/issues/10) 0xb7fb6c79 in opj\_decode (p\_codec=0x80601b8, p\_stream=0x8060170, p\_image=0x8065cc0)

```
at /home/username/Desktop/openjpeg/src/lib/openjp2/openjpeg.c:412

```

[#11](https://github.com/uclouvain/openjpeg/issues/11) 0x0804c2c0 in main (argc=5, argv=0xbffff124)

```
at /home/username/Desktop/openjpeg/src/bin/jp2/opj_decompress.c:1330

```

---

## Simple Analysis

The value of comp->dx is 2 and the value of rpx is 31.

The value evaluated from (OPJ\_INT32)(comp->dx << rpx) is 0 (2<<31 == 0).

The code pi->x%(OPJ\_INT32)(comp->dx<<rpx) will cause a divide-by-zero exception (SIGFPE).

---

## Proof-of-Concept file

Please decode the following content with base64 algorithm.

Then you should save the decoded content to a j2k file to generate the PoC.

AAAADGpQICANCocKAAAAFGZ0eXBqcDIgAAAAAGpwMiAAAAAtanAyaAAAABZpaGRyAAAAIAAAACAA

AweHAAAAAAAPY29scgEAAAAAABAAAAFnanAyY/9P/1EALwAAAAAAAQAAACAAAAAAAAAAAIAAACAA

AAAgAAAAAAAAAAAAAwcCAQcBAYoBAf9SAAwABAABAREEBIAB/1wABEBA/2QAJQABQ3JlYXRlZCBi

eSBPcGVuSlBFRyB2ZXJzaWZ0eXAuMS4w/5AACgAAAAAA7wAB/5PfB1YANB/WzgwnT0scoB/vuZfg

c1PvCOOcZjXu94sFdFbBplUpDNQKo/J/xlMus9LPf6OB3S2g7cWVduNF1Jaz7rIDsiUuZP97i6v6

AKLEZkELDIYYc/9zmmka8yiifaZFEnVtgpHmcWvWIj909OzjqMTdl/xjGiEA30lKlsnQgHvkAAAA

DCQlU8IGCRzPVltBDquXVV1SKEgCZ6AAAL//MDWwLWWTjY66dD2zcDL4QNwgyHZAed8ygGb/NYsD

EkIdgqz2vhAr2q6hLHANUHiJLHTG3LUbzHETySr/f/9//3//2Q==

---

## Credit

This vulnerability was discovered by Ke Liu of Tencent's Xuanwu LAB.

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_18a7332f_20250126_055404.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

state:open label:

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_32244ba2_20250125_041506.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2Fd27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2Fd27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

## Commit

[Permalink](/uclouvain/openjpeg/commit/d27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Avoid division by zero in opj\_pi\_next\_rpcl, opj\_pi\_next\_pcrl and opj\_…

[Browse files](/uclouvain/openjpeg/tree/d27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b)
Browse the repository at this point in the history

```
…pi_next_cprl ([#938](https://github.com/uclouvain/openjpeg/issues/938))

Fixes issues with id:000026,sig:08,src:002419,op:int32,pos:60,val:+32 and
id:000019,sig:08,src:001098,op:flip1,pos:49
```

* Loading branch information

[![@rouault](https://avatars.githubusercontent.com/u/1192433?s=40&v=4)](/rouault)

[rouault](/uclouvain/openjpeg/commits?author=rouault "View all commits by rouault")
committed
Jul 26, 2017

1 parent
[39e962a](/uclouvain/openjpeg/commit/39e962a0ca5e53722f6badda8e93681aad412cf1)

commit d27ccf0

Showing
**1 changed file**
with
**33 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

33 changes: 33 additions & 0 deletions

33
[src/lib/openjp2/pi.c](#diff-2d87a2b9d28551231d2495a42a632760b7386044f236b4464ca28bbbe9320f98 "src/lib/openjp2/pi.c")

Show comments

[View file](/uclouvain/openjpeg/blob/d27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b/src/lib/openjp2/pi.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -369,6 +369,17 @@ static OPJ\_BOOL opj\_pi\_next\_rpcl(opj\_pi\_iterator\_t \* pi) |
|  |  | try1 = opj\_int\_ceildiv(pi->ty1, (OPJ\_INT32)(comp->dy << levelno)); |
|  |  | rpx = res->pdx + levelno; |
|  |  | rpy = res->pdy + levelno; |
|  |  |  |
|  |  | /\* To avoid divisions by zero / undefined behaviour on shift \*/ |
|  |  | /\* in below tests \*/ |
|  |  | /\* Fixes reading id:000026,sig:08,src:002419,op:int32,pos:60,val:+32 \*/ |
|  |  | /\* of https://github.com/uclouvain/openjpeg/issues/938 \*/ |
|  |  | if (rpx >= 31 || ((comp->dx << rpx) >> rpx) != comp->dx || |
|  |  | rpy >= 31 || ((comp->dy << rpy) >> rpy) != comp->dy) { |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* See ISO-15441. B.12.1.3 Resolution level-position-component-layer progression \*/ |
|  |  | if (!((pi->y % (OPJ\_INT32)(comp->dy << rpy) == 0) || ((pi->y == pi->ty0) && |
|  |  | ((try0 << levelno) % (1 << rpy))))) { |
|  |  | continue; |
| Expand Down  Expand Up | | @@ -464,6 +475,17 @@ static OPJ\_BOOL opj\_pi\_next\_pcrl(opj\_pi\_iterator\_t \* pi) |
|  |  | try1 = opj\_int\_ceildiv(pi->ty1, (OPJ\_INT32)(comp->dy << levelno)); |
|  |  | rpx = res->pdx + levelno; |
|  |  | rpy = res->pdy + levelno; |
|  |  |  |
|  |  | /\* To avoid divisions by zero / undefined behaviour on shift \*/ |
|  |  | /\* in below tests \*/ |
|  |  | /\* Relates to id:000019,sig:08,src:001098,op:flip1,pos:49 \*/ |
|  |  | /\* of https://github.com/uclouvain/openjpeg/issues/938 \*/ |
|  |  | if (rpx >= 31 || ((comp->dx << rpx) >> rpx) != comp->dx || |
|  |  | rpy >= 31 || ((comp->dy << rpy) >> rpy) != comp->dy) { |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* See ISO-15441. B.12.1.4 Position-component-resolution level-layer progression \*/ |
|  |  | if (!((pi->y % (OPJ\_INT32)(comp->dy << rpy) == 0) || ((pi->y == pi->ty0) && |
|  |  | ((try0 << levelno) % (1 << rpy))))) { |
|  |  | continue; |
| Expand Down  Expand Up | | @@ -557,6 +579,17 @@ static OPJ\_BOOL opj\_pi\_next\_cprl(opj\_pi\_iterator\_t \* pi) |
|  |  | try1 = opj\_int\_ceildiv(pi->ty1, (OPJ\_INT32)(comp->dy << levelno)); |
|  |  | rpx = res->pdx + levelno; |
|  |  | rpy = res->pdy + levelno; |
|  |  |  |
|  |  | /\* To avoid divisions by zero / undefined behaviour on shift \*/ |
|  |  | /\* in below tests \*/ |
|  |  | /\* Fixes reading id:000019,sig:08,src:001098,op:flip1,pos:49 \*/ |
|  |  | /\* of https://github.com/uclouvain/openjpeg/issues/938 \*/ |
|  |  | if (rpx >= 31 || ((comp->dx << rpx) >> rpx) != comp->dx || |
|  |  | rpy >= 31 || ((comp->dy << rpy) >> rpy) != comp->dy) { |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* See ISO-15441. B.12.1.5 Component-position-resolution level-layer progression \*/ |
|  |  | if (!((pi->y % (OPJ\_INT32)(comp->dy << rpy) == 0) || ((pi->y == pi->ty0) && |
|  |  | ((try0 << levelno) % (1 << rpy))))) { |
|  |  | continue; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d27ccf0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2Fd27ccf01c68a31ad62b33d2dc1ba2bb1eeaafe7b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_42b7b188_20250125_041511.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F779)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F779)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# [CVE-2016-10506] division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 363) #779

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[CVE-2016-10506] division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 363)](#top)#779Copy linkLabels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)Milestone[OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=80)](/trylab)
## Description

[![@trylab](https://avatars.githubusercontent.com/u/15098475?u=9b84b5a4d3712a72ad6d89eb105377f6d85f1fb1&v=4&size=48)](/trylab)[trylab](https://github.com/trylab)opened [on May 6, 2016](https://github.com/uclouvain/openjpeg/issues/779#issue-153384652)
# Title

division-by-zero in function opj\_pi\_next\_rpcl of pi.c (line 363)

# Testing Environment

Ubuntu + OpenJPEG (GitHub master, 2016/05/06)

# Exception Information

```
Program received signal SIGFPE, Arithmetic exception.
0xb69891a6 in opj_pi_next_rpcl (pi=0xb4603d80)
    at /home/trylab/Desktop/repo/openjpeg/src/lib/openjp2/pi.c:363
363 if (!((pi->y % (OPJ_INT32)(comp->dy << rpy) == 0) ||
        ((pi->y == pi->ty0) && ((try0 << levelno) % (1 << rpy))))){

```
# PoC

[https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE\_opj\_pi\_next\_rpcl@363/poc.j2k](https://raw.githubusercontent.com/trylab/PoCs/master/openjpeg/SIGFPE_opj_pi_next_rpcl%40363/poc.j2k)

# Credit

Ke Liu of Tencent's Xuanwu LAB

## Metadata

### Assignees

No one assigned

### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

* [OPJ v2.1.3](https://github.com/uclouvain/openjpeg/milestone/8)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_fa9f5b88_20250125_041512.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenJPEG: Multiple vulnerabilities — GLSA **201710-26**

Multiple vulnerabilities have been found in OpenJPEG, the worst of
which may allow remote attackers to execute arbitrary code.

### Affected packages

| Package | **media-libs/openjpeg** on all architectures |
| --- | --- |
| Affected versions | < **2.3.0** |
| Unaffected versions | >= **2.3.0** |

### Background

OpenJPEG is an open-source JPEG 2000 library.

### Description

Multiple vulnerabilities have been discovered in OpenJPEG. Please review
the references below for details.

### Impact

A remote attacker, via a crafted BMP, PDF, or j2k document, could
execute arbitrary code, cause a Denial of Service condition, or have
other unspecified impacts.

### Workaround

There is no known workaround at this time.

### Resolution

All OpenJPEG users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/openjpeg-2.3.0:2"

```
### References

* [CVE-2016-10504](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10504)
* [CVE-2016-10505](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10505)
* [CVE-2016-10506](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10506)
* [CVE-2016-10507](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10507)
* [CVE-2016-1626](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1626)
* [CVE-2016-1628](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1628)
* [CVE-2016-9112](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9112)
* [CVE-2016-9113](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9113)
* [CVE-2016-9114](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9114)
* [CVE-2016-9115](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9115)
* [CVE-2016-9116](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9116)
* [CVE-2016-9117](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9117)
* [CVE-2016-9118](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9118)
* [CVE-2016-9572](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9572)
* [CVE-2016-9573](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9573)
* [CVE-2016-9580](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9580)
* [CVE-2016-9581](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9581)
* [CVE-2017-12982](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12982)
* [CVE-2017-14039](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-14039)
* [CVE-2017-14164](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-14164)

**Release date**

October 23, 2017

**Latest revision**

October 23, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [602180](https://bugs.gentoo.org/show_bug.cgi?id=602180)
* [606618](https://bugs.gentoo.org/show_bug.cgi?id=606618)
* [628504](https://bugs.gentoo.org/show_bug.cgi?id=628504)
* [629372](https://bugs.gentoo.org/show_bug.cgi?id=629372)
* [629668](https://bugs.gentoo.org/show_bug.cgi?id=629668)
* [630120](https://bugs.gentoo.org/show_bug.cgi?id=630120)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


