```
{
  "vulnerability_details": {
    "root_cause": "Heap-based buffer overflow in `_TIFFmemcpy` function.",
    "weaknesses": [
      "Heap-based buffer overflow"
    ],
    "impact": "The vulnerability can lead to a crash or potentially arbitrary code execution with user privileges if a crafted image is opened.",
    "attack_vectors": [
      "A malformed TIFF image file"
    ],
    "required_capabilities": "An attacker needs to provide a specially crafted TIFF file to an application that uses the vulnerable libtiff library."
  },
  "affected_files": [
    {
      "file_path": "libtiff/tif_luv.c",
      "changes": "The commit modifies the `LogLuvClose` function to reset `td_samplesperpixel`, `td_bitspersample`, and `td_sampleformat` to specific values before writing to the file. This is done to ensure consistency in written TIFF files, regardless of the data format used by the application. This change also addresses similar issue in the `PixarLogClose` function, as a workaround for the heap-based overflow."
    },
      {
      "file_path": "libtiff/tif_pixarlog.c",
       "changes": "The commit modifies the `PixarLogClose` function to reset `td_bitspersample` and `td_sampleformat` to specific values on close, to prevent buffer overflow due to size dependency of tags like `TransferFunction` on the value of `td_bitspersample`."
    }
  ],
    "additional_notes": "The vulnerability was reported by Agostino Sarubbo and is associated with a specific bug report at bugzilla.maptools.org (id=2604). The fix involves modifying how the library handles certain TIFF image properties (like ColorMap, TransferFunction) in combination with bitspersample settings, during the processing of PixarLog and LUV compressed files."
}
```