```
{
  "CVE-2016-10142": {
    "related_content": [
      {
        "source": "tools.ietf.org_5866442e_20250124_233313.html",
        "information": "This document discusses the security implications of the generation of IPv6 atomic fragments and a number of interoperability issues associated with IPv6 atomic fragments, and concludes that the aforementioned functionality is undesirable, thus documenting the motivation for removing this functionality in the revision of the core IPv6 protocol specification.\n\nSecurity Implications of the Generation of IPv6 Atomic Fragments\n\nAn attacker can leverage the generation of IPv6 atomic fragments to trigger the use of fragmentation in an arbitrary IPv6 flow (in scenarios in which actual fragmentation of packets is not needed), and subsequently perform any fragmentation-based attack against legacy IPv6 nodes that do not implement RFC6946. Unfortunately, even nodes that already implement RFC6946 can be subject to DoS attacks as a result of the generation of IPv6 atomic fragments. If an attacker sends a forged ICMPv6 'Packet Too Big' error message, reporting an MTU smaller than 1280, this will trigger the generation of IPv6 atomic fragments. When the target starts sending IPv6 atomic fragments, these packets will be dropped because some intermediate nodes might be dropping IPv6 packets with extension headers. This situation will result in a Denial of Service (DoS).\n\nAnother possible scenario is when two BGP peers using IPv6 transport implement ACLs to drop IPv6 fragments. An attacker could easily attack the peering session by simply sending an ICMPv6 PTB message with a reported MTU smaller than 1280 bytes, causing the routers to drop their own traffic.\n\nExacerbating factors include:\n\n    The attacker does not need to forge the IPv6 Source Address of attack packets.\n    Only the IPv6 addresses of the IPv6 packet embedded in the ICMPv6 payload needs to be forged.\n    Many implementations fail to perform validation checks on the received ICMPv6 error messages.\n    Upon receipt of an ICMPv6 'Packet Too Big' error message, the Destination Cache is usually updated to reflect that any subsequent packets to such a destination should include a Fragment Header.\n     IPv6 node cannot easily limit its exposure to the attack by only generating IPv6 atomic fragments towards IPv4 destinations behind a stateless translator."
      },
      {
        "source": "rhn.redhat.com_482c7e2e_20250124_233307.html",
         "information": "Security Fix(es):\n\n*   It was discovered that a remote attacker could leverage the generation of IPv6 atomic fragments to trigger the use of fragmentation in an arbitrary IPv6 flow (in scenarios in which actual fragmentation of packets is not needed) and could subsequently perform any type of a fragmentation-based attack against legacy IPv6 nodes that do not implement RFC6946. (CVE-2016-10142, Moderate)"
      },
      {
        "source": "tools.ietf.org_fe0cabf5_20250124_233313.html",
        "information": "This document discusses the security implications of the generation of IPv6 atomic fragments and a number of interoperability issues associated with IPv6 atomic fragments. It concludes that the aforementioned functionality is undesirable and thus documents the motivation for removing this functionality from an upcoming revision of the core IPv6 protocol specification. An attacker can leverage the generation of IPv6 atomic fragments to trigger the use of fragmentation in an arbitrary IPv6 flow and can subsequently perform any type of fragmentation-based attack against legacy IPv6 nodes that do not implement RFC6946. Even nodes that implement RFC6946 can be subject to DoS attacks as a result of generating IPv6 atomic fragments. An attacker could forge an ICMPv6 'Packet Too Big' error message reporting an MTU smaller than 1280. This triggers the generation of IPv6 atomic fragments which could then be dropped by intermediate nodes resulting in a Denial of Service scenario.\n\nAnother scenario is that of two BGP peers implementing ACLs to drop IPv6 fragments to avoid control-plane attacks.  An attacker could send an ICMPv6 PTB message with a reported MTU smaller than 1280, causing the routers themselves to drop their own traffic.  \n\nFactors exacerbating the attack include:\n\n  * The attacker does not need to forge the IPv6 Source Address of his attack packets. Hence, deployment of simple filters as per BCP 38 does not help as a countermeasure.\n   * Only the IPv6 addresses of the IPv6 packet embedded in the ICMPv6 payload need to be forged. \n   * Many implementations fail to perform validation checks on the received ICMPv6 error messages.\n  *  Upon receipt of a ICMPv6 PTB error message, the Destination Cache is updated so subsequent packets will include a fragment header.\n *  An IPv6 node cannot easily limit its exposure to this attack vector by only generating IPv6 atomic fragments towards IPv4 destinations behind a stateless translator."
      },
         {
        "source": "bugzilla.redhat.com_2486ffba_20250126_043057.html",
         "information": "An issue was discovered in the IPv6 protocol specification, related to ICMP Packet Too Big (PTB) messages. An attacker can leverage the generation of IPv6 atomic fragments to trigger the use of fragmentation in an arbitrary IPv6 flow (in scenarios in which actual fragmentation of packets is not needed) and can subsequently perform any type of fragmentation-based attack against legacy IPv6 nodes that do not implement [RFC6946].\n\n  Unfortunately, even nodes that already implement [RFC6946] can be subject to DoS attacks as a result of the generation of IPv6 atomic fragments. If an attacker sends a forged ICMPv6 PTB error message to Host B, reporting an MTU smaller than 1280, this will trigger the generation of IPv6 atomic fragments from that moment on When Host B starts sending IPv6 atomic fragments, these packets will be dropped if intermediate nodes are dropping IPv6 packets with extension headers, resulting in a DoS scenario.\n\n Another possible scenario is that in which two BGP peers are employing IPv6 transport and they implement Access Control Lists (ACLs) to drop IPv6 fragments. If the BGP peers drop IPv6 fragments but still honor received ICMPv6 PTB error messages, an attacker could easily attack the peering session by simply sending an ICMPv6 PTB message with a reported MTU smaller than 1280 bytes, causing the routers to drop their own traffic.\n"
        }
    ],
        "vulnerability_details": {
        "Root cause": "The vulnerability stems from the design of IPv6 atomic fragments and how they interact with Path MTU discovery, and IPv6/IPv4 translators which trigger the generation of atomic fragments when a 'Packet Too Big' ICMP message with a MTU less than 1280 bytes. This mechanism can be abused to force fragmentation.",
        "Weaknesses/vulnerabilities": "The core issue is the ability to force the use of IPv6 atomic fragments through forged ICMPv6 PTB messages, triggering fragmentation where it would otherwise not be needed. The generation of IPv6 atomic fragments can cause interoperability issues, as some nodes fail to produce them correctly. Also, there is no requirement on the low-order 16-bits of such value, so there is no guarantee that, by employing the low-order 16-bits of the IPv6 fragment Identification of a packet sent by a source host, IPv4 fragment identification collisions will be avoided or reduced.  Furthermore, the widespread filtering of IPv6 fragments makes such flows vulnerable to DoS attacks.",
        "Impact of exploitation": "Exploitation can result in a Denial of Service (DoS) attack. By forcing the generation of IPv6 atomic fragments and subsequent filtering, an attacker can disrupt communication flows. Additionally, legacy IPv6 nodes that do not implement RFC6946 can be subjected to fragmentation-based attacks.",
        "Attack vectors": "The primary attack vector is the injection of forged ICMPv6 'Packet Too Big' error messages with MTUs smaller than the minimum IPv6 MTU (1280 bytes). These messages can be sent without needing to spoof the IPv6 source address of the packet, but require forging the IPv6 addresses of the IPv6 packet embedded in the ICMPv6 payload.",
        "Required attacker capabilities/position": "The attacker needs to be able to send packets to the target network and forge ICMPv6 'Packet Too Big' messages. No special network position is required, though an off-path attacker may not be able to cause a DoS to a specific flow. The attacker doesn't need to be on-path but needs to be able to cause a host to send forged ICMPv6 messages."
      }
  }
}
```