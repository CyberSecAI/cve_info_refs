=== Content from advisories.dxw.com_13c11bef_20250125_151448.html ===


[# dxw advisories](https://advisories.dxw.com)

Menu

* [Advisories](/advisories/)
* [Plugins](/plugins/)
* [About](https://advisories.dxw.com/about/)

## Advisory:

# Unserialisation in Post Indexer could allow man-in-the-middle to execute arbitrary code (in some circumstances)

## Vulnerability

Last revised: November 17, 2016

Twice a day the blog makes an automated unencrypted HTTP request to `premium.wpmudev.org` and the value that is returned is passed to `unserialize()`. It is possible for `premium.wpmudev.org` or any one on the network in a man-in-the-middle position to return a string that contains an evil encoded object that executes arbitrary code (depending on the active plugins and themes).

This code is called twice a day by `wp_schedule_event(time(), 'twicedaily', 'wpmudev_scheduled_jobs')` (extra/wpmudev-dash-notification.php):

```
var $server_url = 'http://premium.wpmudev.org/wdp-un.php'; // line 12
$url = $this->server_url . '?action=check&un-version=3.3.3&wp=' . urlencode($wp) . '&bcount=' . $blog_count . '&domain=' . urlencode(network_site_url()) . $projects; // line 393
$response = wp_remote_get($url, $options); // line 400
$data = $response['body']; // line 402
$data = unserialize($data); // line 404
```

There is a class called `ProcessLocker` in this plugin with an exploitable `__destruct` method, which could be used as a jumping-off point for attacks using this `unserialize()` vulnerability (or the use of `unserialize()` in WordPress core which requires access to the database to exploit).

Current state:
 Fixed

## CVSS Summary

CVSS base scores for this vulnerability
| Score 7.6 High | |
| --- | --- |
| Vector | Network |
| Complexity | High |
| Authentication | None |
| Confidentiality | Complete |
| Integrity | Complete |
| Availability | Complete |

You can read more about CVSS base scores on [Wikipedia](http://en.wikipedia.org/wiki/CVSS) or in the [CVSS specification](http://www.first.org/cvss/cvss-guide).

## Proof of concept

Achieving arbitrary code execution depends on which classes are available (i.e. which plugins and themes are installed and active). It won’t be possible in all situations.

## Advisory timeline

1. 2016-11-01: Discovered
2. 2016-11-14: Reported to plugin author via https://premium.wpmudev.org/contact/
3. 2016-11-14: Plugin author responded
4. 2016-11-17: Confirmed that version 3.0.6.2 fixes the issue
5. 2016-11-17: Requested CVE
6. 2016-11-17: Advisory published

## Mitigation/further actions

Upgrade to version 3.0.6.2 or later.

Discovered by:
Glyn Wintle
Advisory ID:
dxw-2016-2712
CVE:
Awaiting assignment
Component/package:
Post Indexer
Homepage:
[Post Indexer](http://premium.wpmudev.org/project/post-indexer/)
Version:
3.0.6.1

##### Contact

dxw advisories
Studio 1.05c
4 The Boulevard
Leeds,
LS10 1PZ

Call us on 0345 257 7520
contact@dxw.com

##### Services

* [Plugin reviews](https://advisories.dxw.com/about/plugin-reviews/)
* [Plugin inspections](https://advisories.dxw.com/about/plugin-inspections/)
* [Responsible disclosure policy](https://advisories.dxw.com/disclosure/)
* [Terms of service](https://advisories.dxw.com/terms/)

##### Github

* [Whippet](https://github.com/dxw/whippet)
* [2FA Plugin](https://github.com/dxw/2fa)
* [Iguana](https://github.com/dxw/iguana)

##### More from dxw

* [dxw](https://www.dxw.com)
* [Tradecraft](https://www.tradecraft.com/)

---

[![UKAS logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)
![Government Procurement Service](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ccs-certificate.png)
[![Cyber Essentials logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-mark.png)](https://registry.blockmarktech.com/certificates/fe6a3790-9019-4df0-8d32-f894397b03d2/)
[![Cyber Essentials Plus logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-plus-mark.png)](https://registry.blockmarktech.com/certificates/ced635fc-ba0c-4e59-905c-508dd66dff1b/)

* [Bluesky

  Bluesky](https://bsky.app/profile/dxw.bsky.social)
* [Facebook

  Facebook](https://www.facebook.com/thedxw/)
* [LinkedIn

  LinkedIn](https://www.linkedin.com/company/dxw)
* [GitHub

  GitHub](https://github.com/dxw)

© 2008 – 2025. The Dextrous Web Ltd, trading as dxw. “dxw” is a registered trademark. All rights reserved. The Dextrous Web Ltd is a company registered in England & Wales, No. 6617101. Registered address Studio 1.05c, 4 The Boulevard, Leeds, LS10 1PZ.


