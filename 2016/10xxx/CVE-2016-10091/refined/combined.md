=== Content from www.openwall.com_316f26a4_20250125_220523.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2016/12/31/3) [[next>]](2) [[<thread-prev]](../../../2016/12/31/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20170101080326.sin4gisgscjtgouc@eldamar.local>
Date: Sun, 1 Jan 2017 09:03:26 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: cve-assign@...re.org
Cc: oss-security@...ts.openwall.com, daved@...siol.usyd.edu.au,
	jf@...kes.org, willi@...ian.org, security@...ian.org
Subject: Re: CVE Request: UnRTF: stack-based buffer overflows in cmd_*
 functions

Hi,

On Sat, Dec 31, 2016 at 12:12:14PM -0500, cve-assign@...re.org wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
>
> >> I've found a Stack-based buffer overflow in unrtf 0.21.9, which
> >> affects three functions including: cmd_expand, cmd_emboss and
> >> cmd_engrave.
>
> >> Apparently writing a negative integer to the buffer can trigger the
> >> overflow (Minus sign needs an extra byte).
>
> > <https://bugs.debian.org/849705>
>
> >>> I guess that you can just add a package patch to increate the str[] buffer
> >>> size, something like
> >>>
> >>> - char str[10];
> >>> + char str[15];
>
> Use CVE-2016-10091 (for all of the 849705 report).

Upstream patch:
<http://hg.savannah.gnu.org/hgweb/unrtf/rev/3b16893a6406>

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_a5d4f769_20250125_220525.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1409546)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1409546)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1409546)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1409546

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1409546**](show_bug.cgi?id=1409546)
(CVE-2016-10091)
- [CVE-2016-10091](https://access.redhat.com/security/cve/CVE-2016-10091) unrtf: stack-based buffer overflows in cmd\_\* functions

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-10091 unrtf: stack-based buffer overflows in cmd\_\* functions

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-10091 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1409547](show_bug.cgi?id=1409547 "CLOSED ERRATA - CVE-2016-10091 unrtf: stack-based buffer overflows in cmd_* functions [fedora-all]") [1409548](show_bug.cgi?id=1409548 "CLOSED ERRATA - CVE-2016-10091 unrtf: stack-based buffer overflows in cmd_* functions [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1409546&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1409546&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2017-01-02 12:51 UTC by Martin Prpič | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 14:03 UTC ([History](show_activity.cgi?id=1409546)) | | [CC List:](page.cgi?id=fields.html#cclist) | 0 users | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 03:04:56 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1409546#c0)  Martin Prpič    2017-01-02 12:51:21 UTC  ``` It was found that unrtf is vulnerable to multiple buffer overflow flaws in cmd_* functions. If any exposed application uses unrtf to process untrusted input, these flaws might lead to a denial-of-service.  References:  <http://seclists.org/oss-sec/2016/q4/786>  Originally reported in:  <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=849705>  Patch:  <http://hg.savannah.gnu.org/hgweb/unrtf/rev/3b16893a6406>   ```  [Comment 1](show_bug.cgi?id=1409546#c1)  Martin Prpič    2017-01-02 12:51:50 UTC  ``` Created unrtf tracking bugs for this issue:  Affects: epel-all [[bug 1409548](show_bug.cgi?id=1409548 "CLOSED ERRATA - CVE-2016-10091 unrtf: stack-based buffer overflows in cmd_* functions [epel-all]")] Affects: fedora-all [[bug 1409547](show_bug.cgi?id=1409547 "CLOSED ERRATA - CVE-2016-10091 unrtf: stack-based buffer overflows in cmd_* functions [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=1409546#c2)  Product Security DevOps Team    2019-06-08 03:04:56 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1409546&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_ff0141a7_20250126_121910.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

# blists - web interface to mailing list archives

blists is a web interface to mailing list archives that works off indexed mbox files.
There are two programs: *bindex* and *bit*.
*bindex* generates or updates the index file (yes, incremental updates are supported).
*bit* is a CGI/SSI program that generates web pages on the fly.
Both programs are written in C and are very fast.

You can view the latest <README> file,
which describes blists in more detail and provides installation instructions.
It is also included in the archive below.

Download ([release notes](/lists/announce/2017/11/19/1)):

* [blists 2.0](blists-2.0.tar.gz) and
  its [signature](blists-2.0.tar.gz.sign)* [blists 1.0](blists-1.0.tar.gz) and
    its [signature](blists-1.0.tar.gz.sign)

These files are also
[available from the Openwall file archive](https://download.openwall.net/pub/projects/blists/).
The source code of blists can be browsed on
[GitHub](https://github.com/openwall/blists) or via
[CVSweb](https://cvsweb.openwall.com/blists).

Follow [this link](/signatures/) for information on verifying the signatures.

To see blists in action, check out our
[Open Source and information security mailing list archives](https://lists.openwall.net).

blists is a registered project with
[Open Hub](https://www.openhub.net/p/blists).

Quick Comment:

413772



=== Content from www.openwall.com_d8ead5df_20250125_220523.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2017/01/01/1) [[<thread-prev]](2) [[thread-next>]](../../../2017/01/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <7af25344ac544162af359607a4bf34e4@imshyb02.MITRE.ORG>
Date: Sat, 31 Dec 2016 12:12:14 -0500
From: <cve-assign@...re.org>
To: <carnil@...ian.org>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>,
	<daved@...siol.usyd.edu.au>, <jf@...kes.org>, <willi@...ian.org>,
	<security@...ian.org>
Subject: Re: CVE Request: UnRTF: stack-based buffer overflows in cmd_* functions

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

>> I've found a Stack-based buffer overflow in unrtf 0.21.9, which
>> affects three functions including: cmd_expand, cmd_emboss and
>> cmd_engrave.

>> Apparently writing a negative integer to the buffer can trigger the
>> overflow (Minus sign needs an extra byte).

> <https://bugs.debian.org/849705>

>>> I guess that you can just add a package patch to increate the str[] buffer
>>> size, something like
>>>
>>> - char str[10];
>>> + char str[15];

Use CVE-2016-10091 (for all of the 849705 report).

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYZ+YzAAoJEHb/MwWLVhi2I1wQAKZleo2oQTznb6H4Ktghax2F
jJ8ZchpRw9miiQogbGzSHNVFOiR5Ap0O9Kxusy9ndflduYur3Q3ipdLrONVnR+Tp
RMMRNfBcWZi3g3DI6q10WeJ1jswoz2wYljICYIZWAHULvj34Y8Gj8fpFqq8Wr4SQ
TBDSyF4RyXRNgwBaYiT3VeHQgbYwz7krzLTytmllQ+I8eG9Ehi4p4eNYLKLvUqqL
5zNTnAresR9GytTl2uCyWJN9c+IBr18lZ3BbYnYY9EJZztZLnIRbQPF7mp1ZV4M3
d5xmq2Ota/vl/xUVpn42tq7ZR2tqnKvCOah0aCZsQTBz3MWmajITaAKH6tW8uvdy
xxzvDvhN6YFdafrWBfZREdiJab6zprK5P5ErpDoj3/WJukMYVGOmCJWky8JuBI7i
tT7OElaJOUoAk0VrcZoWKAGlxrNjQXbfCBUn+xawUgeLYBmUMlBFeoBg1XpZDpl/
4iuwY55s0nOq+JTtvNswl1uDRh4lJI2JQYm4KNCC6sFgWnuXitTkWUYw+K5vndnX
XXLTUj7KoPbg67Q4kKYS7J8wEJxAXFQ6WJZklfzQ0Y81IDuFJMGCyaBnljy2NN84
0uCUp3J39jGFk34j4/HiBFEcBxj1YfBEGuCKfjSj/Ey/to6ECqTR2AhF1TSwfhpt
uvY0H3jZ2y/XLDXoUiGr
=K2dj
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from hg.savannah.gnu.org_d8880974_20250125_220522.html ===

[![mercurial](/hgweb/unrtf/static/hglogo.png)](http://mercurial.selenic.com/)

* [log](/hgweb/unrtf/shortlog/3b16893a6406)
* [graph](/hgweb/unrtf/graph/3b16893a6406)
* [tags](/hgweb/unrtf/tags)
* [bookmarks](/hgweb/unrtf/bookmarks)
* [branches](/hgweb/unrtf/branches)

* changeset
* [raw](/hgweb/unrtf/raw-rev/3b16893a6406)
* [browse](/hgweb/unrtf/file/3b16893a6406)

* [bz2](/hgweb/unrtf/archive/3b16893a6406.tar.bz2)
* [zip](/hgweb/unrtf/archive/3b16893a6406.zip)
* [gz](/hgweb/unrtf/archive/3b16893a6406.tar.gz)

* [help](/hgweb/unrtf/help)

## [Mercurial](/) > [hgweb](/hgweb) > [unrtf](/hgweb/unrtf)

### changeset 105:3b16893a6406

Find changesets by keywords (author, files, the commit message), revision
number or hash, or [revset expression](/hgweb/unrtf/help/revsets).

Replace all instances of sprintf with snprintf and adjust size of integer field in some cases

| author | Jean-Francois Dockes <jf@dockes.org> |
| --- | --- |
| date | Sat, 31 Dec 2016 11:35:55 +0100 |
| parents | [f37dd4dea9c1](/hgweb/unrtf/rev/f37dd4dea9c1) |
| children | [dae0b00c1fcb](/hgweb/unrtf/rev/dae0b00c1fcb) |
| files | [Windows/unrtf\_w.c](/hgweb/unrtf/file/3b16893a6406/Windows/unrtf_w.c) [src/attr.c](/hgweb/unrtf/file/3b16893a6406/src/attr.c) [src/convert.c](/hgweb/unrtf/file/3b16893a6406/src/convert.c) [src/output.c](/hgweb/unrtf/file/3b16893a6406/src/output.c) |
| diffstat | 4 files changed, 27 insertions(+), 27 deletions(-) [+] [-] | [Windows/unrtf\_w.c](#l1.1) | 2 |  | | --- | --- | --- | | [src/attr.c](#l2.1) | 4 |  | | [src/convert.c](#l3.1) | 44 |  | | [src/output.c](#l4.1) | 4 |  | |

line wrap: on
 line diff
```

--- a/Windows/unrtf_w.c
+++ b/Windows/unrtf_w.c
@@ -102,7 +102,7 @@
     if (buffer[0] == 0) {
         const char *execdir = path_thisexecpath();
         if (strlen(execdir) + strlen("Share") + 4 < MAX_PATH) {
-            sprintf(buffer, "%s\\Share\\", execdir);
+            snprintf(buffer, MAX_PATH, "%s\\Share\\", execdir);
         }
     }
     return buffer;
```
```

--- a/src/attr.c
+++ b/src/attr.c
@@ -964,7 +964,7 @@
 assemble_string(char *string, int nr)
 {

-	char *s, tmp[12];/* Number of characters that can be in int type (including '\0') - AF */
+	char *s, tmp[20];
 	int i = 0, j = 0;

 	if (string == NULL)
@@ -986,7 +986,7 @@

 		if (string[i] != '\0')
 		{
-			sprintf(tmp, "%d", nr);
+			snprintf(tmp, 20, "%d", nr);
 			strcpy(&s[j], tmp);
 			j = j + strlen(tmp);
 		}
```
```

--- a/src/convert.c
+++ b/src/convert.c
@@ -555,7 +555,7 @@
 }

 // Translate code page to encoding name hopefully suitable as iconv input
-static char *cptoencoding(parm)
+static char *cptoencoding(int parm)
 {
 	// Note that CP0 is supposed to mean current system default, which does
 	// not make any sense as a stored value, we don't handle it.
@@ -1383,10 +1383,10 @@
 	}
 	else
 	{
-		sprintf(str, "#%02x%02x%02x",
-		        color_table[num].r,
-		        color_table[num].g,
-		        color_table[num].b);
+		snprintf(str, 40, "#%02x%02x%02x",
+				 color_table[num].r,
+				 color_table[num].g,
+				 color_table[num].b);
 		attr_push(ATTR_FOREGROUND, str);
 	}
 	return FALSE;
@@ -1412,10 +1412,10 @@
 	}
 	else
 	{
-		sprintf(str, "#%02x%02x%02x",
-		        color_table[num].r,
-		        color_table[num].g,
-		        color_table[num].b);
+		snprintf(str, 40, "#%02x%02x%02x",
+				 color_table[num].r,
+				 color_table[num].g,
+				 color_table[num].b);
 		attr_push(ATTR_BACKGROUND, str);
 	}
 	return FALSE;
@@ -1441,7 +1441,7 @@
 	/* Note, fs20 means 10pt */
 	points /= 2;

-	sprintf(str, "%d", points);
+	snprintf(str, 20, "%d", points);
 	attr_push(ATTR_FONTSIZE, str);

 	return FALSE;
@@ -1630,7 +1630,7 @@
 		{
 			// TOBEDONE: WHAT'S THIS ???
 			name = my_malloc(12);
-			sprintf(name, "%d", num);
+			snprintf(name, 12, "%d", num);
 		}

 		/* we are going to output entities, so should not output font */
@@ -1687,7 +1687,7 @@
 	}
 	else
 	{
-		sprintf(str, "#%02x%02x%02x",
+		snprintf(str, 40, "#%02x%02x%02x",
 		        color_table[num].r,
 		        color_table[num].g,
 		        color_table[num].b);
@@ -1855,10 +1855,10 @@
 static int
 cmd_expand(Word *w, int align, char has_param, int param)
 {
-	char str[10];
+	char str[20];
 	if (has_param)
 	{
-		sprintf(str, "%d", param / 4);
+		snprintf(str, 20, "%d", param / 4);
 		if (!param)
 		{
 			attr_pop(ATTR_EXPAND);
@@ -1882,7 +1882,7 @@
 static int
 cmd_emboss(Word *w, int align, char has_param, int param)
 {
-	char str[10];
+	char str[20];
 	if (has_param && !param)
 #ifdef SUPPORT_UNNESTED
 		attr_find_pop(ATTR_EMBOSS);
@@ -1891,7 +1891,7 @@
 #endif
 	else
 	{
-		sprintf(str, "%d", param);
+		snprintf(str, 20, "%d", param);
 		attr_push(ATTR_EMBOSS, str);
 	}
 	return FALSE;
@@ -1908,14 +1908,14 @@
 static int
 cmd_engrave(Word *w, int align, char has_param, int param)
 {
-	char str[10];
+	char str[20];
 	if (has_param && !param)
 	{
 		attr_pop(ATTR_ENGRAVE);
 	}
 	else
 	{
-		sprintf(str, "%d", param);
+		snprintf(str, 20, "%d", param);
 		attr_push(ATTR_ENGRAVE, str);
 	}
 	return FALSE;
@@ -2561,7 +2561,7 @@

 	short	done = 0;
 	long unicode_number = (long) param; /* On 16bit architectures int is too small to store unicode characters. - AF */
-	char tmp[12]; /* Number of characters that can be in int type (including '\0'). If int size is greater than 4 bytes change this value. - AF */
+	char tmp[20]; /* Number of characters that can be in int type (including '\0'). If int size is greater than 4 bytes change this value. - AF */
 	const char *alias;
 #define DEBUG 0
 #if DEBUG
@@ -2590,7 +2590,7 @@
 			/* RTF spec: Unicode values beyond 32767 are represented by negative numbers */
 			unicode_number += 65536;
 		}
-		sprintf(tmp, "%ld", unicode_number);
+		snprintf(tmp, 20, "%ld", unicode_number);

 		if (safe_printf(1, op->unisymbol_print, tmp))
 		{
@@ -4214,8 +4214,8 @@
 								ext = "emf";
 								break;  /* Enhanced MetaFile */
 							}
-							sprintf(picture_path, "pict%03d.%s",
-							        picture_file_number++, ext);
+							snprintf(picture_path, 255, "pict%03d.%s",
+									 picture_file_number++, ext);
 							pictfile = fopen(picture_path, "wb");
 						}

```
```

--- a/src/output.c
+++ b/src/output.c
@@ -402,7 +402,7 @@
 		if (op->fontsize_begin)
 		{
 			char expr[16];
-			sprintf(expr, "%d", size);
+			snprintf(expr, 16, "%d", size);
 			if (safe_printf(1, op->fontsize_begin, expr))
 			{
 				fprintf(stderr, TOO_MANY_ARGS, "fontsize_begin");
@@ -629,7 +629,7 @@
 		if (op->fontsize_end)
 		{
 			char expr[16];
-			sprintf(expr, "%d", size);
+			snprintf(expr, 16, "%d", size);
 			if (safe_printf(1, op->fontsize_end, expr))
 			{
 				fprintf(stderr, TOO_MANY_ARGS, "fontsize_end");
```



=== Content from bugs.debian.org_dcfc5714_20250126_121912.html ===

# Debian Bug report logs - #849705 unrtf: CVE-2016-10091: stack-based buffer overflows in cmd\_\* functions

[![version graph](version.cgi?collapse=1;absolute=0;package=unrtf;found=unrtf%2F0.21.5-1;found=unrtf%2F0.21.9-clean-2;found=unrtf%2F0.21.5-3;height=2;fixed=unrtf%2F0.21.9-clean-3;fixed=unrtf%2F0.21.5-3%2Bdeb8u1;width=2)](version.cgi?found=unrtf%2F0.21.5-1;found=unrtf%2F0.21.9-clean-2;found=unrtf%2F0.21.5-3;package=unrtf;collapse=1;absolute=0;info=1;fixed=unrtf%2F0.21.9-clean-3;fixed=unrtf%2F0.21.5-3%2Bdeb8u1)

Package:
[unrtf](pkgreport.cgi?package=unrtf);
Maintainer for [unrtf](pkgreport.cgi?package=unrtf) is [Willi Mann <willi@debian.org>](pkgreport.cgi?maint=willi%40debian.org); Source for [unrtf](pkgreport.cgi?package=unrtf) is [src:unrtf](pkgreport.cgi?src=unrtf) ([PTS](https://tracker.debian.org/pkg/unrtf), [buildd](https://buildd.debian.org/unrtf), [popcon](https://qa.debian.org/popcon.php?package=unrtf)).

Reported by: [Skylake <skyl@protonmail.com>](pkgreport.cgi?submitter=skyl%40protonmail.com)

Date: Fri, 30 Dec 2016 00:57:01 UTC

Severity: normal

Tags: security, upstream

Found in versions unrtf/0.21.5-1, unrtf/0.21.9-clean-2, unrtf/0.21.5-3

Fixed in versions unrtf/0.21.9-clean-3, unrtf/0.21.5-3+deb8u1

**Done:** Willi Mann <willi@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=849705;mbox=yes), [status mbox](bugreport.cgi?bug=849705;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=849705;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Willi Mann <willi@debian.org>`:

`Bug#849705`; Package `unrtf`.
(Fri, 30 Dec 2016 00:57:04 GMT) ([full text](bugreport.cgi?bug=849705;msg=2), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Skylake <skyl@protonmail.com>`:

New Bug report received and forwarded. Copy sent to `Willi Mann <willi@debian.org>`.
(Fri, 30 Dec 2016 00:57:04 GMT) ([full text](bugreport.cgi?bug=849705;msg=4), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=5), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=skyl%40protonmail.com)
From: Skylake <skyl@protonmail.com>
To: "submit@bugs.debian.org" <submit@bugs.debian.org>
Subject: unrtf: Stack buffer overflow
Date: Thu, 29 Dec 2016 19:44:14 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=849705;msg=5) (text/plain, inline)]
```
```
Package: unrtf
Version: 0.21.9-clean-2

I've found a Stack-based buffer overflow in unrtf 0.21.9, which affects three functions including: cmd_expand, cmd_emboss and cmd_engrave.

# convert.c

static int
cmd_expand (Word *w, int align, char has_param, int param) {
char str[10];
if (has_param) {
sprintf(str, "%d", param/4); // Overflow, 9-digit negative value triggers the bug
if (!param)
attr_pop(ATTR_EXPAND);
else
attr_push(ATTR_EXPAND, str);
}
return FALSE;
}

Apparently writing a negative integer to the buffer can trigger the overflow (Minus sign needs an extra byte).

* How to trigger the bug *

$ echo "\expnd-400000000" > poc
$ unrtf poc

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<!-- Translation from RTF performed by UnRTF, version 0.21.9 -->
*** buffer overflow detected ***: unrtf terminated
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x6737a)[0xb764f37a]
/lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x37)[0xb76dfe07]
/lib/i386-linux-gnu/libc.so.6(+0xf60a8)[0xb76de0a8]
/lib/i386-linux-gnu/libc.so.6(+0xf58b8)[0xb76dd8b8]
/lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0xa6)[0xb7653bf6]
/lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0xf66)[0xb762b1d6]
/lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0x90)[0xb76dd950]
/lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x20)[0xb76dd8a0]
unrtf[0x804c7b8]
unrtf[0x804f77d]
unrtf[0x804f9e7]
unrtf[0x804920b]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf6)[0xb7600276]
unrtf[0x804953c]
======= Memory map: ========
08048000-0805b000 r-xp 00000000 08:01 405354 /usr/bin/unrtf
0805b000-0805c000 r--p 00012000 08:01 405354 /usr/bin/unrtf
0805c000-0805d000 rw-p 00013000 08:01 405354 /usr/bin/unrtf
0805d000-08085000 rw-p 00000000 00:00 0
0952d000-0954e000 rw-p 00000000 00:00 0 [heap]
b75ca000-b75e6000 r-xp 00000000 08:01 393233 /usr/lib/i386-linux-gnu/libgcc_s.so.1
b75e6000-b75e7000 r--p 0001b000 08:01 393233 /usr/lib/i386-linux-gnu/libgcc_s.so.1
b75e7000-b75e8000 rw-p 0001c000 08:01 393233 /usr/lib/i386-linux-gnu/libgcc_s.so.1
b75e8000-b7799000 r-xp 00000000 08:01 395818 /usr/lib/i386-linux-gnu/libc-2.24.so
b7799000-b779b000 r--p 001b0000 08:01 395818 /usr/lib/i386-linux-gnu/libc-2.24.so
b779b000-b779c000 rw-p 001b2000 08:01 395818 /usr/lib/i386-linux-gnu/libc-2.24.so
b779c000-b779f000 rw-p 00000000 00:00 0
b77a3000-b77a6000 rw-p 00000000 00:00 0
b77a6000-b77a8000 r--p 00000000 00:00 0 [vvar]
b77a8000-b77aa000 r-xp 00000000 00:00 0 [vdso]
b77aa000-b77cc000 r-xp 00000000 08:01 393914 /usr/lib/i386-linux-gnu/ld-2.24.so
b77cc000-b77cd000 rw-p 00000000 00:00 0
b77cd000-b77ce000 r--p 00022000 08:01 393914 /usr/lib/i386-linux-gnu/ld-2.24.so
b77ce000-b77cf000 rw-p 00023000 08:01 393914 /usr/lib/i386-linux-gnu/ld-2.24.so
bf992000-bf9b3000 rw-p 00000000 00:00 0 [stack]
Aborted

* Test environment *

Linux debian 4.7.0-1-686-pae #1 SMP Debian 4.7.8-1 (2016-10-19) i686 GNU/Linux
libc6 2.24-8

Regards,
Amir

Sent with [ProtonMail](<https://protonmail.com>) Secure Email.
```
```
[[Message part 2](bugreport.cgi?att=1;bug=849705;msg=5) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#849705`; Package `unrtf`.
(Fri, 30 Dec 2016 17:54:02 GMT) ([full text](bugreport.cgi?bug=849705;msg=7), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Willi Mann <willi@debian.org>`:

Extra info received and forwarded to list.
(Fri, 30 Dec 2016 17:54:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=9), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=10), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=willi%40debian.org)
From: Willi Mann <willi@debian.org>
To: daved@physiol.usyd.edu.au, Jean-Francois Dockes <jf@dockes.org>
Cc: Skylake <skyl@protonmail.com>, 849705@bugs.debian.org,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Fri, 30 Dec 2016 18:45:23 +0100
```
Hi Dave,
Hi Jean-Francois,

I got the following bug report, apparrently describing a buffer overflow
in unrtf - which I can reproduce. Do you have a suggestion for a fix?

I'm also CCing debian's security team.

WM

Am 2016-12-30 um 01:44 schrieb Skylake:
> Package: unrtf
> Version: 0.21.9-clean-2
>
> I've found a Stack-based buffer overflow in unrtf 0.21.9, which affects three
> functions including: cmd_expand, cmd_emboss and cmd_engrave.
>
> # convert.c
>
> static int
> cmd_expand (Word *w, int align, char has_param, int param) {
>      char str[10];
>      if (has_param) {
>          sprintf(str, "%d", param/4); // Overflow, 9-digit negative value
> triggers the bug
>          if (!param)
>              attr_pop(ATTR_EXPAND);
>          else
>              attr_push(ATTR_EXPAND, str);
>      }
>      return FALSE;
> }
>
> Apparently writing a negative integer to the buffer can trigger the overflow
> (Minus sign needs an extra byte).
>
> * How to trigger the bug *
>
> $ echo "\expnd-400000000" > poc
> $ unrtf poc
>
> <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
> <html>
> <head>
> <meta http-equiv="content-type" content="text/html; charset=utf-8">
> <!-- Translation from RTF performed by UnRTF, version 0.21.9 -->
> *** buffer overflow detected ***: unrtf terminated
> ======= Backtrace: =========
> /lib/i386-linux-gnu/libc.so.6(+0x6737a)[0xb764f37a]
> /lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x37)[0xb76dfe07]
> /lib/i386-linux-gnu/libc.so.6(+0xf60a8)[0xb76de0a8]
> /lib/i386-linux-gnu/libc.so.6(+0xf58b8)[0xb76dd8b8]
> /lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0xa6)[0xb7653bf6]
> /lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0xf66)[0xb762b1d6]
> /lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0x90)[0xb76dd950]
> /lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x20)[0xb76dd8a0]
> unrtf[0x804c7b8]
> unrtf[0x804f77d]
> unrtf[0x804f9e7]
> unrtf[0x804920b]
> /lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf6)[0xb7600276]
> unrtf[0x804953c]
> ======= Memory map: ========
> 08048000-0805b000 r-xp 00000000 08:01 405354     /usr/bin/unrtf
> 0805b000-0805c000 r--p 00012000 08:01 405354     /usr/bin/unrtf
> 0805c000-0805d000 rw-p 00013000 08:01 405354     /usr/bin/unrtf
> 0805d000-08085000 rw-p 00000000 00:00 0
> 0952d000-0954e000 rw-p 00000000 00:00 0          [heap]
> b75ca000-b75e6000 r-xp 00000000 08:01 393233
> /usr/lib/i386-linux-gnu/libgcc_s.so.1
> b75e6000-b75e7000 r--p 0001b000 08:01 393233
> /usr/lib/i386-linux-gnu/libgcc_s.so.1
> b75e7000-b75e8000 rw-p 0001c000 08:01 393233
> /usr/lib/i386-linux-gnu/libgcc_s.so.1
> b75e8000-b7799000 r-xp 00000000 08:01 395818
> /usr/lib/i386-linux-gnu/libc-2.24.so
> b7799000-b779b000 r--p 001b0000 08:01 395818
> /usr/lib/i386-linux-gnu/libc-2.24.so
> b779b000-b779c000 rw-p 001b2000 08:01 395818
> /usr/lib/i386-linux-gnu/libc-2.24.so
> b779c000-b779f000 rw-p 00000000 00:00 0
> b77a3000-b77a6000 rw-p 00000000 00:00 0
> b77a6000-b77a8000 r--p 00000000 00:00 0          [vvar]
> b77a8000-b77aa000 r-xp 00000000 00:00 0          [vdso]
> b77aa000-b77cc000 r-xp 00000000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
> b77cc000-b77cd000 rw-p 00000000 00:00 0
> b77cd000-b77ce000 r--p 00022000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
> b77ce000-b77cf000 rw-p 00023000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
> bf992000-bf9b3000 rw-p 00000000 00:00 0          [stack]
> Aborted
>
> * Test environment *
>
> Linux debian 4.7.0-1-686-pae #1 SMP Debian 4.7.8-1 (2016-10-19) i686 GNU/Linux
> libc6 2.24-8
>
> Regards,
> Amir
>
> Sent with ProtonMail <<https://protonmail.com>> Secure Email.
>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Willi Mann <willi@debian.org>`:

`Bug#849705`; Package `unrtf`.
(Fri, 30 Dec 2016 18:21:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=12), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Jean-Francois Dockes <jf@dockes.org>`:

Extra info received and forwarded to list. Copy sent to `Willi Mann <willi@debian.org>`.
(Fri, 30 Dec 2016 18:21:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=14), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=15), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jf%40dockes.org)
From: Jean-Francois Dockes <jf@dockes.org>
To: Willi Mann <willi@debian.org>
Cc: daved@physiol.usyd.edu.au,
Skylake <skyl@protonmail.com>,
849705@bugs.debian.org,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Fri, 30 Dec 2016 19:16:12 +0100
```
Willi Mann writes:
 > Hi Dave,
 > Hi Jean-Francois,
 >
 > I got the following bug report, apparrently describing a buffer overflow
 > in unrtf - which I can reproduce. Do you have a suggestion for a fix?
 >
 > I'm also CCing debian's security team.
 >
 > WM

I guess that you can just add a package patch to increate the str[] buffer
size, something like

- char str[10];
+ char str[15];

(I'm sure that you could get by with less than 15 but I don't see the
point).

For completeness, sprintf() could be changed to snprintf(), but maybe this
can be left for the next release?

attr_push() does an strdup of the 2nd parameter, so the increased size
should not be an issue there.

I've not tested the change, but I'm foolishly confident that it should fix the
issue. I'll give it a better look in the following days (and also look for
possible other instances of the problem).

jf

 > Am 2016-12-30 um 01:44 schrieb Skylake:
 > > Package: unrtf
 > > Version: 0.21.9-clean-2
 > >
 > > I've found a Stack-based buffer overflow in unrtf 0.21.9, which affects three
 > > functions including: cmd_expand, cmd_emboss and cmd_engrave.
 > >
 > > # convert.c
 > >
 > > static int
 > > cmd_expand (Word *w, int align, char has_param, int param) {
 > >      char str[10];
 > >      if (has_param) {
 > >          sprintf(str, "%d", param/4); // Overflow, 9-digit negative value
 > > triggers the bug
 > >          if (!param)
 > >              attr_pop(ATTR_EXPAND);
 > >          else
 > >              attr_push(ATTR_EXPAND, str);
 > >      }
 > >      return FALSE;
 > > }
 > >
 > > Apparently writing a negative integer to the buffer can trigger the overflow
 > > (Minus sign needs an extra byte).
 > >
 > > * How to trigger the bug *
 > >
 > > $ echo "\expnd-400000000" > poc
 > > $ unrtf poc
 > >
 > > <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 > > <html>
 > > <head>
 > > <meta http-equiv="content-type" content="text/html; charset=utf-8">
 > > <!-- Translation from RTF performed by UnRTF, version 0.21.9 -->
 > > *** buffer overflow detected ***: unrtf terminated
 > > ======= Backtrace: =========
 > > /lib/i386-linux-gnu/libc.so.6(+0x6737a)[0xb764f37a]
 > > /lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x37)[0xb76dfe07]
 > > /lib/i386-linux-gnu/libc.so.6(+0xf60a8)[0xb76de0a8]
 > > /lib/i386-linux-gnu/libc.so.6(+0xf58b8)[0xb76dd8b8]
 > > /lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0xa6)[0xb7653bf6]
 > > /lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0xf66)[0xb762b1d6]
 > > /lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0x90)[0xb76dd950]
 > > /lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x20)[0xb76dd8a0]
 > > unrtf[0x804c7b8]
 > > unrtf[0x804f77d]
 > > unrtf[0x804f9e7]
 > > unrtf[0x804920b]
 > > /lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf6)[0xb7600276]
 > > unrtf[0x804953c]
 > > ======= Memory map: ========
 > > 08048000-0805b000 r-xp 00000000 08:01 405354     /usr/bin/unrtf
 > > 0805b000-0805c000 r--p 00012000 08:01 405354     /usr/bin/unrtf
 > > 0805c000-0805d000 rw-p 00013000 08:01 405354     /usr/bin/unrtf
 > > 0805d000-08085000 rw-p 00000000 00:00 0
 > > 0952d000-0954e000 rw-p 00000000 00:00 0          [heap]
 > > b75ca000-b75e6000 r-xp 00000000 08:01 393233
 > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
 > > b75e6000-b75e7000 r--p 0001b000 08:01 393233
 > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
 > > b75e7000-b75e8000 rw-p 0001c000 08:01 393233
 > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
 > > b75e8000-b7799000 r-xp 00000000 08:01 395818
 > > /usr/lib/i386-linux-gnu/libc-2.24.so
 > > b7799000-b779b000 r--p 001b0000 08:01 395818
 > > /usr/lib/i386-linux-gnu/libc-2.24.so
 > > b779b000-b779c000 rw-p 001b2000 08:01 395818
 > > /usr/lib/i386-linux-gnu/libc-2.24.so
 > > b779c000-b779f000 rw-p 00000000 00:00 0
 > > b77a3000-b77a6000 rw-p 00000000 00:00 0
 > > b77a6000-b77a8000 r--p 00000000 00:00 0          [vvar]
 > > b77a8000-b77aa000 r-xp 00000000 00:00 0          [vdso]
 > > b77aa000-b77cc000 r-xp 00000000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
 > > b77cc000-b77cd000 rw-p 00000000 00:00 0
 > > b77cd000-b77ce000 r--p 00022000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
 > > b77ce000-b77cf000 rw-p 00023000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
 > > bf992000-bf9b3000 rw-p 00000000 00:00 0          [stack]
 > > Aborted
 > >
 > > * Test environment *
 > >
 > > Linux debian 4.7.0-1-686-pae #1 SMP Debian 4.7.8-1 (2016-10-19) i686 GNU/Linux
 > > libc6 2.24-8
 > >
 > > Regards,
 > > Amir
 > >
 > > Sent with ProtonMail <<https://protonmail.com>> Secure Email.
 > >
 >
 >

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#849705`; Package `unrtf`.
(Sat, 31 Dec 2016 14:30:02 GMT) ([full text](bugreport.cgi?bug=849705;msg=17), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Willi Mann <willi@debian.org>`:

Extra info received and forwarded to list.
(Sat, 31 Dec 2016 14:30:02 GMT) ([full text](bugreport.cgi?bug=849705;msg=19), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=20), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=willi%40debian.org)
From: Willi Mann <willi@debian.org>
To: Jean-Francois Dockes <jf@dockes.org>, 849705@bugs.debian.org
Cc: daved@physiol.usyd.edu.au, Skylake <skyl@protonmail.com>,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Sat, 31 Dec 2016 15:26:48 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=849705;msg=20) (text/plain, inline)]
```
```
Hi Jean-Francois,

Are you fine with attached patch? I saw that two other cmd_ functions
follow the same pattern, so they are probably also vulnerable, right?

thanks
Willi

Am 2016-12-30 um 19:16 schrieb Jean-Francois Dockes:
> Willi Mann writes:
>  > Hi Dave,
>  > Hi Jean-Francois,
>  >
>  > I got the following bug report, apparrently describing a buffer overflow
>  > in unrtf - which I can reproduce. Do you have a suggestion for a fix?
>  >
>  > I'm also CCing debian's security team.
>  >
>  > WM
>
> I guess that you can just add a package patch to increate the str[] buffer
> size, something like
>
> - char str[10];
> + char str[15];
>
> (I'm sure that you could get by with less than 15 but I don't see the
> point).
>
> For completeness, sprintf() could be changed to snprintf(), but maybe this
> can be left for the next release?
>
> attr_push() does an strdup of the 2nd parameter, so the increased size
> should not be an issue there.
>
> I've not tested the change, but I'm foolishly confident that it should fix the
> issue. I'll give it a better look in the following days (and also look for
> possible other instances of the problem).
>
> jf
>
>
>  > Am 2016-12-30 um 01:44 schrieb Skylake:
>  > > Package: unrtf
>  > > Version: 0.21.9-clean-2
>  > >
>  > > I've found a Stack-based buffer overflow in unrtf 0.21.9, which affects three
>  > > functions including: cmd_expand, cmd_emboss and cmd_engrave.
>  > >
>  > > # convert.c
>  > >
>  > > static int
>  > > cmd_expand (Word *w, int align, char has_param, int param) {
>  > >      char str[10];
>  > >      if (has_param) {
>  > >          sprintf(str, "%d", param/4); // Overflow, 9-digit negative value
>  > > triggers the bug
>  > >          if (!param)
>  > >              attr_pop(ATTR_EXPAND);
>  > >          else
>  > >              attr_push(ATTR_EXPAND, str);
>  > >      }
>  > >      return FALSE;
>  > > }
>  > >
>  > > Apparently writing a negative integer to the buffer can trigger the overflow
>  > > (Minus sign needs an extra byte).
>  > >
>  > > * How to trigger the bug *
>  > >
>  > > $ echo "\expnd-400000000" > poc
>  > > $ unrtf poc
>  > >
>  > > <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
>  > > <html>
>  > > <head>
>  > > <meta http-equiv="content-type" content="text/html; charset=utf-8">
>  > > <!-- Translation from RTF performed by UnRTF, version 0.21.9 -->
>  > > *** buffer overflow detected ***: unrtf terminated
>  > > ======= Backtrace: =========
>  > > /lib/i386-linux-gnu/libc.so.6(+0x6737a)[0xb764f37a]
>  > > /lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x37)[0xb76dfe07]
>  > > /lib/i386-linux-gnu/libc.so.6(+0xf60a8)[0xb76de0a8]
>  > > /lib/i386-linux-gnu/libc.so.6(+0xf58b8)[0xb76dd8b8]
>  > > /lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0xa6)[0xb7653bf6]
>  > > /lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0xf66)[0xb762b1d6]
>  > > /lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0x90)[0xb76dd950]
>  > > /lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x20)[0xb76dd8a0]
>  > > unrtf[0x804c7b8]
>  > > unrtf[0x804f77d]
>  > > unrtf[0x804f9e7]
>  > > unrtf[0x804920b]
>  > > /lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf6)[0xb7600276]
>  > > unrtf[0x804953c]
>  > > ======= Memory map: ========
>  > > 08048000-0805b000 r-xp 00000000 08:01 405354     /usr/bin/unrtf
>  > > 0805b000-0805c000 r--p 00012000 08:01 405354     /usr/bin/unrtf
>  > > 0805c000-0805d000 rw-p 00013000 08:01 405354     /usr/bin/unrtf
>  > > 0805d000-08085000 rw-p 00000000 00:00 0
>  > > 0952d000-0954e000 rw-p 00000000 00:00 0          [heap]
>  > > b75ca000-b75e6000 r-xp 00000000 08:01 393233
>  > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
>  > > b75e6000-b75e7000 r--p 0001b000 08:01 393233
>  > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
>  > > b75e7000-b75e8000 rw-p 0001c000 08:01 393233
>  > > /usr/lib/i386-linux-gnu/libgcc_s.so.1
>  > > b75e8000-b7799000 r-xp 00000000 08:01 395818
>  > > /usr/lib/i386-linux-gnu/libc-2.24.so
>  > > b7799000-b779b000 r--p 001b0000 08:01 395818
>  > > /usr/lib/i386-linux-gnu/libc-2.24.so
>  > > b779b000-b779c000 rw-p 001b2000 08:01 395818
>  > > /usr/lib/i386-linux-gnu/libc-2.24.so
>  > > b779c000-b779f000 rw-p 00000000 00:00 0
>  > > b77a3000-b77a6000 rw-p 00000000 00:00 0
>  > > b77a6000-b77a8000 r--p 00000000 00:00 0          [vvar]
>  > > b77a8000-b77aa000 r-xp 00000000 00:00 0          [vdso]
>  > > b77aa000-b77cc000 r-xp 00000000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
>  > > b77cc000-b77cd000 rw-p 00000000 00:00 0
>  > > b77cd000-b77ce000 r--p 00022000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
>  > > b77ce000-b77cf000 rw-p 00023000 08:01 393914     /usr/lib/i386-linux-gnu/ld-2.24.so
>  > > bf992000-bf9b3000 rw-p 00000000 00:00 0          [stack]
>  > > Aborted
>  > >
>  > > * Test environment *
>  > >
>  > > Linux debian 4.7.0-1-686-pae #1 SMP Debian 4.7.8-1 (2016-10-19) i686 GNU/Linux
>  > > libc6 2.24-8
>  > >
>  > > Regards,
>  > > Amir
>  > >
>  > > Sent with ProtonMail <<https://protonmail.com>> Secure Email.
>  > >
>  >
>  >
>

```
```
[[0001-convert.c-Use-safe-buffer-size-and-snprintf.patch](bugreport.cgi?att=1;bug=849705;filename=0001-convert.c-Use-safe-buffer-size-and-snprintf.patch;msg=20) (text/x-patch, attachment)]
```

---

**Added tag(s) security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 31 Dec 2016 15:15:13 GMT) ([full text](bugreport.cgi?bug=849705;msg=22), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=22), [link](#21)).

---

**Added tag(s) upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 31 Dec 2016 15:27:04 GMT) ([full text](bugreport.cgi?bug=849705;msg=24), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=24), [link](#23)).

---

**Marked as found in versions unrtf/0.21.5-3.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 31 Dec 2016 15:48:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=26), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Willi Mann <willi@debian.org>`:

`Bug#849705`; Package `unrtf`.
(Sat, 31 Dec 2016 16:03:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=28), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Willi Mann <willi@debian.org>`.
(Sat, 31 Dec 2016 16:03:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=30), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=31), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Willi Mann <willi@debian.org>
Cc: Jean-Francois Dockes <jf@dockes.org>, 849705@bugs.debian.org,
daved@physiol.usyd.edu.au, Skylake <skyl@protonmail.com>,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Sat, 31 Dec 2016 16:59:28 +0100
```
Hi,

On Sat, Dec 31, 2016 at 03:26:48PM +0100, Willi Mann wrote:
> Hi Jean-Francois,
>
> Are you fine with attached patch? I saw that two other cmd_ functions
> follow the same pattern, so they are probably also vulnerable, right?

Thanks for the notice. I have done some minor updates to the bug
(adding tags, and found version for the jessie version).

I have requested a CVE here:

<http://www.openwall.com/lists/oss-security/2016/12/31/2>

Not sure yet if that would warrant a DSA, possibly it could be updated
via the upcoming point release as well.

Regards,
Salvatore

```

---

**Changed Bug title to 'unrtf: CVE-2016-10091: stack-based buffer overflows in cmd\_\* functions' from 'unrtf: Stack buffer overflow'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 31 Dec 2016 18:54:02 GMT) ([full text](bugreport.cgi?bug=849705;msg=33), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=33), [link](#32)).

---

**Marked as found in versions unrtf/0.21.5-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 31 Dec 2016 19:06:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=35), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=35), [link](#34)).

---

**Reply sent**
to `Willi Mann <willi@debian.org>`:

You have taken responsibility.
(Sat, 31 Dec 2016 19:51:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=37), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=37), [link](#36)).

---

**Notification sent**
to `Skylake <skyl@protonmail.com>`:

Bug acknowledged by developer.
(Sat, 31 Dec 2016 19:51:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=39), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 849705-close@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=40), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=willi%40debian.org)
From: Willi Mann <willi@debian.org>
To: 849705-close@bugs.debian.org
Subject: Bug#849705: fixed in unrtf 0.21.9-clean-3
Date: Sat, 31 Dec 2016 19:49:28 +0000
```
Source: unrtf
Source-Version: 0.21.9-clean-3

We believe that the bug you reported is fixed in the latest version of
unrtf, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 849705@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Willi Mann <willi@debian.org> (supplier of updated unrtf package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sat, 31 Dec 2016 20:35:19 +0100
Source: unrtf
Binary: unrtf
Architecture: source
Version: 0.21.9-clean-3
Distribution: unstable
Urgency: high
Maintainer: Willi Mann <willi@debian.org>
Changed-By: Willi Mann <willi@debian.org>
Description:
 unrtf      - RTF to other formats converter
Closes: [849705](bugreport.cgi?bug=849705)
Changes:
 unrtf (0.21.9-clean-3) unstable; urgency=high
 .
   * Security fix
   * Add patch from upstream to fix [CVE-2016-10091](https://security-tracker.debian.org/tracker/CVE-2016-10091) (buffer overflow in various
     cmd_ functions). closes: [849705](bugreport.cgi?bug=849705)
Checksums-Sha1:
 32d22625cf8317479cf66976e3170005ff12868b 1868 unrtf_0.21.9-clean-3.dsc
 1e36bf97457303470410d775e2fd68a1ab53855d 6104 unrtf_0.21.9-clean-3.debian.tar.xz
Checksums-Sha256:
 6e16779899ce765e8cfd015aa03b4b03fdcb84d3bb6ee935097e0943ed8842e5 1868 unrtf_0.21.9-clean-3.dsc
 26b52467952d2a0a030908c0a44121dde69f8005af05faa6511fbf7d5a58487c 6104 unrtf_0.21.9-clean-3.debian.tar.xz
Files:
 3556222cb8ea1f7725fffbcfca1dcf34 1868 text optional unrtf_0.21.9-clean-3.dsc
 a14a89a1c32c664c04dbfa22932a1c7e 6104 text optional unrtf_0.21.9-clean-3.debian.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYaAihAAoJEIy+IZx0V22B9qgP/RETGnRixEoM4x3RJXMNB76L
XmyQ1TnQWgQNUgwKCRZ31M1sQrhQLT5PYlE1WrXufgK4CERhtIdrAyC3QZoRI9At
NqY8pGcVhyHg00ScG+404w0QKyNdh8YR1EylXLOMhQdBUY7EvnctV+S0xCWHfAIn
8cm6SdAQX1jh7PhNLpg4cDYZOFhqN//VUk5TLsxpb9N0fWRI2DR5O6zwtqmvVjWM
F2MbC4NBNnfltRwk8cA25tdT4fhfdAKeCimY1bAZsTCbkZwOBKpCd6Iy5/iPyOKv
PZEHSnbQtWKhuVs+aCizDXqFOwybEi+K2nnguMwJW90UWe7LkIHKCEHCVvYb5XR+
pa+lOFyt9wDqr8fJeyg7vvwRjN7IXLSqPb93BeqSzRu/sluy3AvDDzVTdQZQsYV+
NkbHk1fBASxmhrqHFKlMzDAy9PSIMtlv6pAwF4QXHvHxe+X0Du/B8zc6X3qTa04v
g/xL30kACknDLs87hLWHqrIMw/MUG0cXGBYCkO+LK+Qph41SiWqLORroSjTMvto8
jYtrHgI7iI9oGod8EyLMyCe9rcpJlrwaqUIO6wn6+RzubLOwb0UzMVolgzOoMoo1
LbMEdqGhlYbA+ZDRX/TMA+VfNTT9Zj+6O+0cOza0DGFTInCzR8vWTq+Si0JwWoMR
F1bh069VSeGa/iSp1Cij
=k1Dr
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#849705`; Package `unrtf`.
(Sat, 31 Dec 2016 20:18:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=42), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=42), [link](#41)).

---

**Acknowledgement sent**
to `Willi Mann <willi@debian.org>`:

Extra info received and forwarded to list.
(Sat, 31 Dec 2016 20:18:03 GMT) ([full text](bugreport.cgi?bug=849705;msg=44), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=45), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=willi%40debian.org)
From: Willi Mann <willi@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 849705@bugs.debian.org
Cc: Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Sat, 31 Dec 2016 21:15:09 +0100
```
Hi,

> Not sure yet if that would warrant a DSA, possibly it could be updated
> via the upcoming point release as well.

I pushed a jessie branch to the git repository with the patch from
upstream (some hunks had to be ignored). I also uploaded a patched
version to unstable.

<https://anonscm.debian.org/cgit/collab-maint/unrtf.git/log/?h=jessie>

Let me know how I should proceed for jessie.

Bye
Willi

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Willi Mann <willi@debian.org>`:

`Bug#849705`; Package `unrtf`.
(Sun, 01 Jan 2017 07:30:04 GMT) ([full text](bugreport.cgi?bug=849705;msg=47), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=47), [link](#46)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Willi Mann <willi@debian.org>`.
(Sun, 01 Jan 2017 07:30:04 GMT) ([full text](bugreport.cgi?bug=849705;msg=49), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 849705@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=50), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Willi Mann <willi@debian.org>, 849705@bugs.debian.org
Cc: Debian Security Team <team@security.debian.org>
Subject: Re: Bug#849705: unrtf: Stack buffer overflow
Date: Sun, 1 Jan 2017 08:27:34 +0100
```
Hi Willi,

On Sat, Dec 31, 2016 at 09:15:09PM +0100, Willi Mann wrote:
> Hi,
>
> > Not sure yet if that would warrant a DSA, possibly it could be updated
> > via the upcoming point release as well.
>
> I pushed a jessie branch to the git repository with the patch from
> upstream (some hunks had to be ignored). I also uploaded a patched
> version to unstable.
>
> <https://anonscm.debian.org/cgit/collab-maint/unrtf.git/log/?h=jessie>
>
> Let me know how I should proceed for jessie.

Thanks, seen the unstable upload and updated the tracker information.
For jessie, can you schedule a fix via the upcoming point release? Cf.
<https://www.debian.org/doc/manuals/developers-reference/ch05.en.html#upload-stable>

Regards,
Salvatore

```

---

**Reply sent**
to `Willi Mann <willi@debian.org>`:

You have taken responsibility.
(Fri, 06 Jan 2017 23:36:12 GMT) ([full text](bugreport.cgi?bug=849705;msg=52), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=52), [link](#51)).

---

**Notification sent**
to `Skylake <skyl@protonmail.com>`:

Bug acknowledged by developer.
(Fri, 06 Jan 2017 23:36:12 GMT) ([full text](bugreport.cgi?bug=849705;msg=54), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 849705-close@bugs.debian.org ([full text](bugreport.cgi?bug=849705;msg=55), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=willi%40debian.org)
From: Willi Mann <willi@debian.org>
To: 849705-close@bugs.debian.org
Subject: Bug#849705: fixed in unrtf 0.21.5-3+deb8u1
Date: Fri, 06 Jan 2017 23:32:13 +0000
```
Source: unrtf
Source-Version: 0.21.5-3+deb8u1

We believe that the bug you reported is fixed in the latest version of
unrtf, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 849705@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Willi Mann <willi@debian.org> (supplier of updated unrtf package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 01 Jan 2017 19:50:41 +0100
Source: unrtf
Binary: unrtf
Architecture: source amd64
Version: 0.21.5-3+deb8u1
Distribution: stable
Urgency: medium
Maintainer: Willi Mann <willi@debian.org>
Changed-By: Willi Mann <willi@debian.org>
Description:
 unrtf      - RTF to other formats converter
Closes: [849705](bugreport.cgi?bug=849705)
Changes:
 unrtf (0.21.5-3+deb8u1) stable; urgency=medium
 .
   * Add patch from upstream to fix [CVE-2016-10091](https://security-tracker.debian.org/tracker/CVE-2016-10091) (buffer overflow in various
     cmd_ functions) closes: [849705](bugreport.cgi?bug=849705)
Checksums-Sha1:
 b509b150de60c9ea4cd2924d3d0c72c7e80ed43c 1857 unrtf_0.21.5-3+deb8u1.dsc
 c44ba70275788c1d47617f794e8a7ef40cc7d0a7 10988 unrtf_0.21.5-3+deb8u1.debian.tar.xz
 4eb6408e75f074ebdd4553bf7c6edb5cef7232f7 44032 unrtf_0.21.5-3+deb8u1_amd64.deb
Checksums-Sha256:
 e3411332e5d511682834157b2e9b2d84cb5a13212fb1efe3563160c7c1aab14c 1857 unrtf_0.21.5-3+deb8u1.dsc
 0dbdd48df60e78b89f986961782ddf7f6dfdd329d78f466bdcce1fbbff5ef958 10988 unrtf_0.21.5-3+deb8u1.debian.tar.xz
 d7c677d1d55ae92f320a7db1eefe7bbe43b247b6db360590187a087bcb0a07be 44032 unrtf_0.21.5-3+deb8u1_amd64.deb
Files:
 3e9b9131efa684f034fe804d4c6f1e09 1857 text optional unrtf_0.21.5-3+deb8u1.dsc
 69ad47869f3577110567de89ee81529c 10988 text optional unrtf_0.21.5-3+deb8u1.debian.tar.xz
 e489a0afa8939a5322355bbea998104e 44032 text optional unrtf_0.21.5-3+deb8u1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYb0hwAAoJEIy+IZx0V22BmcgP/RD3IaV9esHlLKBTVRvIBXvK
XET+XgSZbUrvjZ3oPT2aXK03mhFOg1QF1yszGQHkqbGM4GIjT8koxJOM2pw1Yxlp
i111KZD8FsvLRgMAaehr9PRb7Z8N/2F8CLFu+6LTowMzRfRbT4DZErIWcBlXFsxF
C7wIE9aszAwYZHEC6QhlQf7RMN0bcwBSLAaqijlqx2pMulDsCzFCv/WNmaMyNxuw
F5A3vvhuTF2OF6BCmG1PuBl/4O/igFYYwyN0IrN3hPQAu/tOGoKMCzTV5fp/CQqn
Dbz+QNrRC8bV8I0BwX+ZQtGBRor/4NdcbOXT17rbz/ogCNLkFkhwezL+kjO40fRO
mhcxYgKIeWPniJ7tYSUg68a34yj1lgQ2na8W7N+22cLoz14THjnOdJa+e6Hx8CyW
dKZFPss3m42NbxR73oLMxHEz0NGlFCebvkNJhYtT6Aw7aR3rzwcax5Au9EgyHMV4
/bJMLmE0QwoDBIv7BY9bMFXzhfP1Zm40v9Y1OzCCIXy4y/wVpBgUZXKL9QGVyPZU
z6GCNwmVVrsx1PfS1T/X4mnaz7DZbbIKC51cr8uQ/DE4I+0g+7XB05avoBh9o5Ar
Lm4HZsdMr06PfsvzD4ZoUEuew+/uhb7kCYLrnAr5/pj498RRsemNyeXuMxRxCmEW
hCSIM/+/Qdyej+MuRSMo
=vxM5
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 04 Feb 2017 07:25:39 GMT) ([full text](bugreport.cgi?bug=849705;msg=57), [mbox](bugreport.cgi?bug=849705;mbox=yes;msg=57), [link](#56)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=849705).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 12:19:08 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from access.redhat.com_39399ace_20250126_121911.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


