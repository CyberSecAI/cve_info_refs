=== Content from advisories.dxw.com_f6714edf_20250125_145204.html ===


[# dxw advisories](https://advisories.dxw.com)

Menu

* [Advisories](/advisories/)
* [Plugins](/plugins/)
* [About](https://advisories.dxw.com/about/)

## Advisory:

# SQL Injection in Post Indexer allows super admins to read the contents of the database

## Vulnerability

Last revised: November 17, 2016

Post Indexer does not use prepared queries in many cases and in some of its database calls it uses backticks (`). These are not automatically escaped by WordPress, thus leading to the possibility of SQL injection.

In other places in the code it simply takes user controlled values and adds them to SQL queries.

An example of this is remove\_post\_older\_than:

```
// classes/class.model.php line 589
function remove_posts_older_than( $unit, $period ) {
    // ...
    $sql = $this->db->prepare( "SELECT BLOG_ID, ID FROM {$this->network_posts} WHERE DATE_ADD(post_date, INTERVAL %d " . $period . ") < CURRENT_DATE() LIMIT %d", $unit, PI_CRON_TIDY_DELETE_LIMIT );
    $posts = $this->db->get_results( $sql );
    // ...
}

```

The value of $period is user-controlled and could easily be replaced with SQL:

```
// classes/cron.postindexerrebuild.php line 310
function process_tidy_agedposts($DEBUG = false) {
    // ...
    // The default is to remove posts from the index when they are over a year old
    $agedposts = get_site_option( 'postindexer_agedposts', array( 'agedunit' => 1, 'agedperiod' => 'year' ) );
    // ...
    $this->model->remove_posts_older_than( $agedposts['agedunit'], $agedposts['agedperiod'] );
    // ...
}
```

To exploit this vulnerability you need to be a super admin.

Current state:
 Fixed

## CVSS Summary

CVSS base scores for this vulnerability
| Score 4 Medium | |
| --- | --- |
| Vector | Network |
| Complexity | Low |
| Authentication | Single |
| Confidentiality | Partial |
| Integrity | None |
| Availability | None |

You can read more about CVSS base scores on [Wikipedia](http://en.wikipedia.org/wiki/CVSS) or in the [CVSS specification](http://www.first.org/cvss/cvss-guide).

## Proof of concept

## Advisory timeline

1. 2016-11-01: Discovered
2. 2016-11-14: Reported to plugin author via https://premium.wpmudev.org/contact/
3. 2016-11-14: Plugin author responded
4. 2016-11-17: Confirmed that version 3.0.6.2 fixes the issue
5. 2016-11-17: Requested CVE
6. 2016-11-17: Advisory published

## Mitigation/further actions

Upgrade to version 3.0.6.2 or later.

Discovered by:
Glyn Wintle
Advisory ID:
dxw-2016-2705
CVE:
Awaiting assignment
Component/package:
Post Indexer
Homepage:
[Post Indexer](http://premium.wpmudev.org/project/post-indexer/)
Version:
3.0.6.1

##### Contact

dxw advisories
Studio 1.05c
4 The Boulevard
Leeds,
LS10 1PZ

Call us on 0345 257 7520
contact@dxw.com

##### Services

* [Plugin reviews](https://advisories.dxw.com/about/plugin-reviews/)
* [Plugin inspections](https://advisories.dxw.com/about/plugin-inspections/)
* [Responsible disclosure policy](https://advisories.dxw.com/disclosure/)
* [Terms of service](https://advisories.dxw.com/terms/)

##### Github

* [Whippet](https://github.com/dxw/whippet)
* [2FA Plugin](https://github.com/dxw/2fa)
* [Iguana](https://github.com/dxw/iguana)

##### More from dxw

* [dxw](https://www.dxw.com)
* [Tradecraft](https://www.tradecraft.com/)

---

[![UKAS logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)
![Government Procurement Service](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ccs-certificate.png)
[![Cyber Essentials logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-mark.png)](https://registry.blockmarktech.com/certificates/fe6a3790-9019-4df0-8d32-f894397b03d2/)
[![Cyber Essentials Plus logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-plus-mark.png)](https://registry.blockmarktech.com/certificates/ced635fc-ba0c-4e59-905c-508dd66dff1b/)

* [Bluesky

  Bluesky](https://bsky.app/profile/dxw.bsky.social)
* [Facebook

  Facebook](https://www.facebook.com/thedxw/)
* [LinkedIn

  LinkedIn](https://www.linkedin.com/company/dxw)
* [GitHub

  GitHub](https://github.com/dxw)

© 2008 – 2025. The Dextrous Web Ltd, trading as dxw. “dxw” is a registered trademark. All rights reserved. The Dextrous Web Ltd is a company registered in England & Wales, No. 6617101. Registered address Studio 1.05c, 4 The Boulevard, Leeds, LS10 1PZ.


