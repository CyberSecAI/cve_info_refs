Based on the provided content, here's a breakdown of the vulnerability described in CVE-2016-0151:

**Root Cause of Vulnerability:**
The vulnerability stems from how the Client-Server Run-time Subsystem (CSRSS) in Windows manages process tokens in memory during the creation of a new process within a specific RPC call, `BaseSrvCheckVDM`. When the Virtual DOS Machine (VDM) is disabled (as is default on modern Windows systems), CSRSS attempts to be helpful by launching a process on the desktop prompting the user to install the VDM. However, the token used to create this new process is derived from the *impersonation* token of the caller, which, if manipulated can lead to unexpected behavior.

**Weaknesses/Vulnerabilities Present:**

*   **Token Impersonation Issue:** CSRSS uses the *impersonation* token of the caller (instead of the primary token) when launching the new VDM-related process. By impersonating the anonymous token before calling `CsrClientCallServer`, an attacker can force CSRSS to use the anonymous token for the new process.
*   **Session 0 Process Creation:** The anonymous token has a session ID of 0. This means the newly created process will be created in session 0, which has special security implications within Windows.
*   **Inconsistent Token Usage:** Within `BaseSrvLaunchProcess`, CSRSS opens the primary token of the calling process and then uses this to create an *impersonation* token, this token is then assigned to the thread which calls `NtCreateUserProcess`. However the token used is still the anonymous token.
*   **`CreateProcessWithLogonW` Abuse**: The vulnerability can be further exploited using `CreateProcessWithLogonW` with the `LOGON_NETCREDENTIALS_ONLY` flag. This API can create a new process with the token of the current user, but uses the parent process's session ID. By passing a process handle to the new process in session 0, the API creates a new process with the current user's token, but also in session 0.

**Impact of Exploitation:**

*   **Security Feature Bypass:** The vulnerability bypasses the intended security mechanisms by allowing a process to be created in Session 0 with the current user's token.
*   **Privilege Escalation:** Although the anonymous logon user has limited privileges, the ability to create a process in Session 0 allows an attacker to manipulate global objects, such as Sections and Symbolic Links in `\BaseNamedObjects`, which can impact system services.
*   **Arbitrary Code Execution:** By creating a process in session 0, the attacker can run code as the current user within session 0. This circumvents session isolation and could lead to full control of the machine.

**Attack Vectors:**

*   **Local Access:** The attacker needs to have a user account on the system.
*   **Specially Crafted Application:** The attacker needs to run a specially crafted application to trigger the vulnerability.

**Required Attacker Capabilities/Position:**

*   The attacker must be able to log on to the target system with a valid account (not necessarily an administrator account, a normal user account will suffice).
*   The attacker needs to be able to execute code on the target system.
*   The attacker needs to be able to exploit the `BaseSrvCheckVDM` RPC call and impersonate the anonymous token.
*   The attacker would also need to be able to win a race condition, by capturing the new process in session 0 and suspending it.
*   Finally the attacker would then need to use `CreateProcessWithLogonW` to create a process as the current user in session 0.

**Additional Details (from exploit-db.com content):**

*   The exploit code provided uses a hook on the `CsrClientCallServer` function within `kernel32.dll` to impersonate the anonymous token before the `BaseSrvCheckVDM` call is made.
*   The exploit then captures the process created in session 0, suspends it and then calls `CreateProcessWithLogonW` passing the process ID of the process from session 0 to create a new process as the current user in session 0.
*   The vulnerability is demonstrated on Windows 8.1 32-bit systems by calling `CreateProcess` with the executable `edit.com`, which is a 16-bit executable (used to trigger the call to the CSRSS API). However, the exploit may be modified to work on 64-bit Windows systems.
*   The exploit code mentions needing a multi-processor system to reliably win a race condition required for the exploit to work.

**In summary,** CVE-2016-0151 is a security feature bypass vulnerability that allows a local attacker to elevate privileges by abusing how CSRSS handles process tokens when creating a VDM related process. This allows for a process to be created in session 0 with an elevated token. This can be leveraged to gain further control of the system.