Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2016-0073

**Root Cause:**
- The `DeviceApi CMApi PnpCtxRegOpenCurrentUserKey` function in the Windows kernel does not properly check the impersonation level of the current effective token.

**Weaknesses/Vulnerabilities Present:**
- **Improper Impersonation Handling:** The vulnerable function opens registry keys in the user's hive using an impersonated token, even if the token is at the identification level. This means a lower-privileged process can leverage the token of a logged-on user.
- **Insufficient Access Control:** The vulnerability allows registry keys to be created with kernel privileges even when dealing with user hives, bypassing access checks when the keys are created.
- **Race Condition:** While not the main vulnerability, the exploit leverages a race condition where the user hive context is targeted, but keys are created as the current user.

**Impact of Exploitation:**
- **Elevation of Privilege:** A local attacker can gain access to registry information not intended for them, and ultimately gain elevated privileges by creating and modifying registry keys within another user's hive.
- **Arbitrary Registry Key Creation:** An attacker can create arbitrary registry keys in another user's loaded hive.
- **DACL Manipulation:** The attacker can mark themselves as the owner of created keys, allowing them to change the DACL and grant themselves access.

**Attack Vectors:**
- **Local Access:** The attacker needs local access to the system.
- **Specially Crafted Application:** The attack requires a specially crafted application to trigger the vulnerability.
- **Impersonation:** The attacker needs to either capture another user's token, or use techniques like S4U to impersonate a logged-on user.

**Required Attacker Capabilities/Position:**
- **Local User:** The attacker needs to be a local user on the system.
- **Ability to run code:** The attacker must be able to execute a specially crafted application.
- **User impersonation:** The attacker needs a way to impersonate another user (e.g., capture token or S4U).

**Additional Information:**
- The vulnerability is present in multiple versions of Windows including Windows 8.1, Windows Server 2012, Windows 10, and possibly Windows 7 and Server 2008 R2.
- The provided exploit code uses S4U (Service for User) to impersonate another user.
- The vulnerability lies within the handling of specific IOCTLs and flags within the DeviceApi and CMApi.
- The issue is present in the `PnpCtxRegOpenCurrentUserKey` function.
- The vulnerability is addressed by correcting how the kernel API restricts access to sensitive registry information.