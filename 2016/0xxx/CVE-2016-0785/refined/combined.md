=== Content from struts.apache.org_422eaedd_20250124_165654.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-029)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-029)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-029
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=62687048 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=62687048)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=62687048)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=62687048#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=62687048)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=62687048)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=62687048)
  + [Export to Word](/confluence/exportword?pageId=62687048)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=62687048)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-029](/confluence/display/WW/S2-029)

* Created by  [Lukasz Lenart](/confluence/display/~lukaszlenart), last modified on [Apr 27, 2016](/confluence/pages/diffpagesbyversion.action?pageId=62687048&selectedPageVersions=17&selectedPageVersions=18 "Show changes")

## Summary

Forced double OGNL evaluation, when evaluated on raw user input in tag attributes, may lead to remote code execution.

| Who should read this | All Struts 2 developers and users |
| --- | --- |
| Impact of vulnerability | Possible Remote Code Execution vulnerability |
| Maximum security rating | Important |
| Recommendation | Always validate incoming parameters' values when re-assigning them to certain Struts' tags attributes.  Don't use %{...} syntax in tag attributes other than *value* unless you have a valid use-case.  Alternatively upgrade to [Struts 2.3.20.3](/confluence/display/WW/Version%2BNotes%2B2.3.20.3), [Struts 2.3.24.3](/confluence/display/WW/Version%2BNotes%2B2.3.24.3) or [Struts 2.3.28](/confluence/display/WW/Version%2BNotes%2B2.3.28) |
| Affected Software | Struts 2.0.0 - Struts 2.3.24.1 (except 2.3.20.3) |
| Reporters | Romain Gaucher rgaucher at coverity dot com - Coverity  Lupin lupin1314 at gmail dot com- jd.com security team  nike.zheng at dbappsecurity dot com dot cn - dbappsecurity team  genxors at gmail dot com - Qihoo 360 SkyEye Lab |
| CVE Identifier | CVE-2016-0785 |

## Problem

The Apache Struts frameworks when forced, performs double evaluation of attributes' values assigned to certain tags so it is possible to pass in a value that will be evaluated again when a tag's attributes will be rendered.

## Solution

Adding a proper validation of each value that's coming in and it's used in tag's attributes.

Don't use forced evaluation of an attribute other than *value* using %{...} syntax unless really needed for a valid use-case.

By upgrading to Struts 2.3.20.3, 2.3.24.3 and 2.3.28, possible malicious effects of forced double evaluation are limited.

## Backward compatibility

No issues expected when upgrading to Struts 2.3.20.3, 2.3.24.3 and 2.3.28

## Workaround

If you are using Struts 2.3.20, 2.3.24 or 2.3.24.1 you can redefine `struts.excludedClasses` as showed below, for more details please read [internal security](/confluence/display/WW/Security) page.

```
    <constant name="struts.excludedClasses"
              value="
                java.lang.Object,
                java.lang.Runtime,
                java.lang.System,
                java.lang.Class,
                java.lang.ClassLoader,
                java.lang.Shutdown,
                java.lang.ProcessBuilder,
                ognl.OgnlContext,
                ognl.ClassResolver,
                ognl.TypeConverter,
                com.opensymphony.xwork2.ognl.SecurityMemberAccess,
                com.opensymphony.xwork2.ActionContext" />
```

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 82, "requestCorrelationId": "fc88a4600449fd8d"}

