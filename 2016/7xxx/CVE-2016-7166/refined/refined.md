```
{
  "guidelines": [
    "First verify if the content relates to the CVE specified based on the official description",
    "If the content does not relate to this CVE, respond with \"UNRELATED\"",
    "If no useful vulnerability information is found, respond with \"NOINFO\"",
    "For relevant content, extract:",
    "- Root cause of vulnerability",
    "- Weaknesses/vulnerabilities present",
    "- Impact of exploitation",
    "- Attack vectors",
    "- Required attacker capabilities/position",
    "Additional instructions:",
    "- Preserve original technical details and descriptions",
    "- Remove unrelated content",
    "- Translate non-English content to English",
    "- Note if the content provides more detail than the official CVE description"
  ],
  "response": {
    "match": true,
    "data": [
      {
        "content": "FreeBSD Bugzilla – Bug 207362\nCrafted gzip archive causes tar(1) to exhaust all your memory\nLast modified: 2017-12-17 07:09:51 UTC\n\nThe FreeBSD tar(1) program uses a heuristic to check if an archive file is compressed. If it is, it calls into an appropriate library to receive a decompressed stream. Then it applies the heuristic again to catch the case of an archive that has been compressed multiple times. There is no limit to the number of recursive decompressions.\n\nUsing a crafted gzip file (the attached file is a quine that unpacks to itself), one can get tar(1) to invoke an infinite chain of gzip compressors until all the memory on the machine running tar(1) has been exhausted or another resource limit kicks in.\n\nI see this behaviour as a bug and security problem. It can be used to perform denial-of-service attacks against machines that run FreeBSD and use tar(1) to list the contents of untrusted archives.",
        "vulnerability_details": {
          "root_cause": "The `tar(1)` program uses a heuristic to recursively decompress compressed archive files. The program lacks a limit on the number of recursive decompressions.",
          "weaknesses": [
            "Unbounded recursion",
            "Denial of service vulnerability"
          ],
          "impact": "A crafted gzip file can cause the `tar(1)` program to invoke an infinite chain of gzip compressors until all available memory is exhausted.",
          "attack_vector": "By providing a crafted gzip file as input to the `tar(1)` program.",
          "attacker_capabilities": "The attacker only needs the ability to supply the crafted gzip file to the vulnerable application."
        }
      },
      {
        "content": "This was fixed in libarchive 3.2.0, but never got a CVE.\n\nUpstream ticket:\n\n<https://github.com/libarchive/libarchive/issues/660>\n\nOriginal report:\n\n<https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=207362>",
         "vulnerability_details": {
          "root_cause": "The vulnerability was present in libarchive before version 3.2.0.",
          "weaknesses": [
            "Unbounded recursion",
             "Denial of service vulnerability"
           ],
          "impact": "A crafted gzip file can cause applications using libarchive to allocate an excessive amount of memory, eventually leading to a crash.",
          "attack_vector": "By supplying a crafted gzip file to an application using libarchive.",
           "attacker_capabilities": "The attacker needs to provide a crafted gzip file to the vulnerable application."
          }
      },
      {
         "content": "A denial of service vulnerability was found in libarchive's handling of GZIP streams. A crafted GZIP file could cause libarchive to allocate an excessive amount of memory, eventually leading to a crash. (CVE-2016-7166)",
        "vulnerability_details": {
           "root_cause": "A denial of service vulnerability exists in libarchive due to its handling of GZIP streams.",
           "weaknesses": [
            "Unbounded memory allocation",
            "Denial of service vulnerability"
          ],
           "impact": "A crafted GZIP file can cause libarchive to allocate an excessive amount of memory, eventually leading to a crash.",
           "attack_vector": "By providing a crafted GZIP file as input to an application using the vulnerable libarchive library.",
            "attacker_capabilities": "The attacker needs to provide a crafted gzip file to the vulnerable application."
        }
      },
      {
        "content": "It seems bsdtar automatically handles stacked compression. This is a nice feature but it could be problematic when it's completely unlimited.  Most clearly it's illustrated with quines:\n\n$ curl -sRO <http://www.maximumcompression.com/selfgz.gz>\n$ (ulimit -v 10000000 && bsdtar -tvf selfgz.gz)\nbsdtar: Error opening archive: Can't allocate data for gzip decompression\n\nWithout ulimit, bsdtar will eat all available memory. This could also be a problem for other applications using libarchive.",
         "vulnerability_details": {
            "root_cause": "The bsdtar utility (and applications using libarchive) automatically handle stacked compression without a limit, leading to potential resource exhaustion.",
            "weaknesses": [
               "Unbounded recursion",
              "Denial of service vulnerability"
          ],
            "impact": "A crafted gzip file can cause `bsdtar` or other applications using libarchive to consume all available memory, potentially leading to a crash.",
            "attack_vector": "By providing a crafted gzip file that decompresses to itself, causing infinite decompression.",
             "attacker_capabilities": "The attacker needs to provide a crafted gzip file that decompresses to itself."
          }
      },
      {
        "content": "This issue has been addressed in the following products:\n\n Red Hat Enterprise Linux 7\n Via RHSA-2016:1844 <https://rhn.redhat.com/errata/RHSA-2016-1844.html>",
        "vulnerability_details": {
          "root_cause": "The vulnerability stems from the lack of a limit on recursive decompression within the libarchive library, as used in Red Hat Enterprise Linux 7.",
            "weaknesses": [
               "Unbounded recursion",
             "Denial of service vulnerability"
          ],
            "impact": "A crafted gzip file can cause applications using libarchive to exhaust system resources, leading to denial of service.",
            "attack_vector": "By providing crafted gzip files to applications using the vulnerable libarchive library.",
            "attacker_capabilities": "The attacker needs to provide crafted gzip files to a vulnerable application."
         }
      },
      {
        "content": "A vulnerability was found in libarchive. A specially crafted gzip file can cause libarchive to allocate memory without limit, eventually leading to a crash.",
        "vulnerability_details": {
          "root_cause": "The libarchive library is vulnerable due to its handling of crafted gzip files which results in uncontrolled memory allocation.",
           "weaknesses": [
              "Unbounded memory allocation",
              "Denial of service vulnerability"
          ],
          "impact": "A crafted gzip file can cause libarchive to allocate memory without limit, leading to a crash due to excessive memory consumption.",
           "attack_vector": "By providing crafted gzip files to applications using the vulnerable libarchive library.",
            "attacker_capabilities": "The attacker needs to provide crafted gzip files."
        }
      },
        {
        "content": "This issue has been addressed in the following products:\n Red Hat Enterprise Linux 6\n Via RHSA-2016:1850 <https://rhn.redhat.com/errata/RHSA-2016-1850.html>",
         "vulnerability_details": {
            "root_cause": "The vulnerability is due to unbounded memory allocation while handling crafted gzip files in libarchive, affecting Red Hat Enterprise Linux 6.",
             "weaknesses": [
              "Unbounded memory allocation",
               "Denial of service vulnerability"
           ],
           "impact": "A specially crafted gzip file can cause libarchive to allocate memory without limit, leading to a crash.",
            "attack_vector": "By supplying a crafted gzip file to an application utilizing the vulnerable version of libarchive.",
           "attacker_capabilities": "The attacker needs to provide a crafted gzip file."
        }
      },
       {
        "content": "Multiple infinite loop / resource exhaustion flaws were found in libarchive. Specially crafted GZIP or ISO files could cause the application to consume an excessive amount of resources, eventually leading to a crash on memory exhaustion. (CVE-2016-7166,...)",
          "vulnerability_details": {
           "root_cause": "Multiple flaws related to infinite loops/resource exhaustion when processing specially crafted GZIP and ISO files.",
            "weaknesses": [
                "Unbounded recursion",
                 "Denial of service vulnerability"
             ],
           "impact": "Specially crafted GZIP or ISO files could cause the application to consume an excessive amount of resources, eventually leading to a crash on memory exhaustion.",
           "attack_vector": "By supplying a crafted GZIP or ISO file to an application using libarchive.",
             "attacker_capabilities": "The attacker needs to supply a crafted GZIP or ISO file."
            }
      },
        {
        "content": "CVE-2016-7166 libarchive: Denial of service using a crafted gzip file",
         "vulnerability_details": {
           "root_cause": "The vulnerability is due to libarchive's flawed handling of crafted gzip files.",
           "weaknesses": [
               "Unbounded recursion",
              "Denial of service vulnerability"
          ],
           "impact": "A crafted gzip file can cause libarchive to enter an infinite loop resulting in denial of service.",
            "attack_vector": "By providing a crafted gzip file to an application using libarchive.",
            "attacker_capabilities": "The attacker needs to provide a crafted gzip file."
        }
      },
      {
        "content": "CVE-2016-7166 libarchive: Denial of service using a crafted gzip file",
        "vulnerability_details": {
            "root_cause": "Improper handling of crafted GZIP files during decompression.",
              "weaknesses": [
                "Unbounded recursion",
               "Denial of service vulnerability"
           ],
            "impact": "A crafted GZIP file can cause libarchive to enter a denial-of-service state by allocating an excessive amount of memory.",
             "attack_vector": "By supplying a crafted GZIP file to an application using the vulnerable library.",
            "attacker_capabilities": "The attacker needs to provide a crafted GZIP file."
        }
      },
      {
          "content": "A denial of service vulnerability was found in libarchive's handling of GZIP streams. A crafted GZIP file could cause libarchive to allocate an excessive amount of memory, eventually leading to a crash. (CVE-2016-7166)",
          "vulnerability_details": {
            "root_cause": "The vulnerability resides in how libarchive processes crafted GZIP streams, allowing for excessive memory allocation.",
             "weaknesses": [
               "Unbounded memory allocation",
                "Denial of service vulnerability"
              ],
            "impact": "A crafted GZIP file can cause libarchive to allocate excessive memory, leading to a crash.",
           "attack_vector": "By sending a crafted GZIP file to an application using the vulnerable libarchive library.",
              "attacker_capabilities": "The attacker needs to provide a crafted GZIP file."
         }
      },
       {
          "content": "Use CVE-2016-7166.",
          "vulnerability_details": {
           "root_cause": "CVE-2016-7166 was assigned to address the vulnerability.",
             "weaknesses": [
               "Unbounded memory allocation",
                 "Denial of service vulnerability"
             ],
             "impact": "The vulnerability leads to denial of service from excessive memory allocation due to processing of a specially crafted gzip file.",
              "attack_vector": "By supplying a crafted gzip file to a vulnerable application utilizing libarchive.",
              "attacker_capabilities": "The attacker needs to provide a crafted gzip file to the vulnerable application."
          }
        }
    ]
  }
}
```