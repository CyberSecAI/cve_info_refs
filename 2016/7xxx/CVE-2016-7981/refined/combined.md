=== Content from core.spip.net_e2e94795_20250125_071954.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
c8a519f5**

authored
Sep 28, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb)

### Report de r23200 : - ?exec=valider\_xml n'est executable que par les webmestres

```
- var_url ne doit pas contenir de ../../ ni de ..\..\ (windows)
- elle ne lance une action que si on a un var_token qui correspond soit a la signature de l'action en POST soit a la signature de l'action+var_url en GET. Ceci evite de faire lancer le validateur par un lien malveillant fourni a un webmstre d'un site auquel on a pas acces (CSRF)

(Nicolas Chatelain)
```

parent
[70b2fe39](/spip/spip/-/commit/70b2fe39b1124b8b29b0454ec3a58f235e78a9ef)

Loading

Loading

Loading

* [Changes
  1](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb)

[Hide whitespace changes](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?action=show&controller=projects%2Fcommit&id=c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb&namespace_id=spip&project_id=spip&r=23202&w=1)
[Inline](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?r=23202&view=inline)
[Side-by-side](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?r=23202&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)



=== Content from www.openwall.com_93bc691c_20250125_071950.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](../../../2016/10/05/17) [[thread-next>]](../../../2016/10/07/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20161006151431.80DF36C58F9@smtpvmsrv1.mitre.org>
Date: Thu,  6 Oct 2016 11:14:31 -0400 (EDT)
From: cve-assign@...re.org
To: labs@...dream.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, spip-team-owner@...o.net
Subject: Re: SPIP vulnerabilities: request for 5 CVE

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Can you provide further information about whether each of these issues
could have been fixed independently?

We are aware of:

  <https://core.spip.net/projects/spip/repository/revisions/23200>
  <https://core.spip.net/projects/spip/repository/revisions/23201>
  <https://core.spip.net/projects/spip/repository/revisions/23202>

and these seem to indicate separate findings related to three
items on your list. Thus, we can initially assign these IDs:

> * Cross-Site Request Forgery

Use CVE-2016-7980.

> * Reflected Cross-Site Scripting

Use CVE-2016-7981.

> * File Enumeration / Path Traversal

Use CVE-2016-7982.

Is your reported Server Side Request Forgery a completely separate
problem? Is it resultant from an authorization issue, e.g., possibly
the wrong users have access to XML validation:

  -   if (!autoriser('sauvegarder')) {
  +   if (!autoriser('webmestre')) {

and also XML validation could be performed through CSRF? In other
words, is valider_xml.php supposed to block everyone from performing
an XML validation of an off-site document, or is it only supposed to
have access control for this functionality?

> * Template Compiler/Composer PHP Code Execution

Is there public information about this already on an spip.net web site
(such as a Redmine revision) or the <https://sysdream.com/news/lab/> web
site? Is this unrelated to the valider_xml.php script?

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJX9mnXAAoJEHb/MwWLVhi2/qcQAKEeOApYMW4Czdtc9dQYq5c1
BvrVK73txuLW346VYOGYB2HNp9b1RPoH34buXakJGXrhgyhbK/1fl1WILdUROuMs
UeEievyso1zudb2seSC/mPdvoyMfiKYQdQEvquQsuNNbdohR2TxA7i7k/33gpEoN
jQwsDCdm4xQQDPG5hrK39LmhboqgZtrYhZXetHWGloMMYWVMgoVOopdNXdMajXJ5
ycSlJoqMsMVWiZ4JKWPbEaFY7fJwHs3f5ZRa7WRRzAy6IdLQN/9Wo/awZsVTfe/s
mTC7bz3iiUCCu+XYWhmZGFG9JBBz4FL68CsYXw3tkjS8h0Gi4IsIKUc3ZiTm/2ee
boZiAJlRJETfgKozM/E3fyLytPeUX+2r8UI2SkkyjXM0JZ/r5NJuiaSumLo3sxst
bXsd5ruDb7FQyaQqkyPutti0Iz3gdM8MPqhGkwIG/xfDs6U/M9RFdPB91ShmuqWd
fYARzhJLsm+s2lQgMVzxLEAm7GVpJdORSRTW8JnlzxdeYy/Z/f1Nh6hxvi1pjGVO
voAvlQNNnVJYeWYoDwXBK0qF31CRNq5/wePt6JY1h92fwzgMo4w84Yny91qsHlY4
f0uaSduqB8DgO+P78X7fTai6T0j9i+6Qsnqukr9U/79Nt/tlmIJ+gs9DFF8RwQRz
IlWWaW48n/lLS/vAtKMl
=7eq2
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_c42d1c7e_20250125_071949.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](16) [[next>]](18) [[thread-next>]](../../../2016/10/06/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <db3c98e6-3e7d-c98b-7cb1-777cf7d484a3@sysdream.com>
Date: Wed, 5 Oct 2016 20:13:12 +0200
From: Sysdream Labs <labs@...dream.com>
To: oss-security@...ts.openwall.com
Cc: spip-team-owner@...o.net
Subject: SPIP vulnerabilities: request for 5 CVE

Hello,

We need 5 CVE ID for the following vulnerabilities found in SPIP <= 3.1.2 (<http://www.spip.net/>):

* Template Compiler/Composer PHP Code Execution
* Cross-Site Request Forgery
* Reflected Cross-Site Scripting
* File Enumeration / Path Traversal
* Server Side Request Forgery

Thank you in advance,

Best regards,

--
SYSDREAM Labs <labs@...dream.com>

GPG :
47D1 E124 C43E F992 2A2E
1551 8EB4 8CD9 D5B2 59A1

* Website: <https://sysdream.com/>
* Twitter: @sysdream

Download attachment "[signature.asc](17/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from core.spip.net_091be7f5_20250125_071951.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
851fe7f5**

authored
Sep 28, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/851fe7f5514b8e26cce9fc6def81db273d282ca5)

### - ?exec=valider\_xml n'est executable que par les webmestres

```
- var_url ne doit pas contenir de ../../ ni de ..\..\ (windows)
- elle ne lance une action que si on a un var_token qui correspond soit a la signature de l'action en POST soit a la signature de l'action+var_url en GET. Ceci evite de faire lancer le validateur par un lien malveillant fourni a un webmstre d'un site auquel on a pas acces (CSRF)

(Nicolas Chatelain)
```

parent
[5c9b388f](/spip/spip/-/commit/5c9b388faeb4ebc4add6cfeaf174b29350b600ae)

Loading

Loading

Loading

* [Changes
  1](/spip/spip/-/commit/851fe7f5514b8e26cce9fc6def81db273d282ca5)

[Hide whitespace changes](/spip/spip/-/commit/851fe7f5514b8e26cce9fc6def81db273d282ca5?action=show&controller=projects%2Fcommit&id=851fe7f5514b8e26cce9fc6def81db273d282ca5&namespace_id=spip&project_id=spip&r=23200&w=1)
[Inline](/spip/spip/-/commit/851fe7f5514b8e26cce9fc6def81db273d282ca5?r=23200&view=inline)
[Side-by-side](/spip/spip/-/commit/851fe7f5514b8e26cce9fc6def81db273d282ca5?r=23200&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)



=== Content from www.openwall.com_9f6f7021_20250125_071950.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <956e00cf-2553-d3fe-83f1-00e3c0b1075a@sysdream.com>
Date: Wed, 12 Oct 2016 15:27:32 +0200
From: Sysdream Labs <labs@...dream.com>
To: oss-security@...ts.openwall.com
Cc: fulldisclosure@...lists.org, spip-team-owner@...o.net
Subject: CVE-2016-7981: SPIP 3.1.2 Reflected Cross-Site Scripting

## SPIP 3.1.2 Reflected Cross-Site Scripting (CVE-2016-7981)

### Product Description

SPIP is a publishing system for the Internet, which put importance on collaborative working, multilingual environments and ease of use. It is free software, distributed under the GNU/GPL licence.

### Vulnerability Description

The `var_url` parameter of the `valider_xml` file is not correctly sanitized and can be used to trigger a reflected XSS vulnerability.

**Access Vector**: remote

**Security Risk**: medium

**Vulnerability**: CWE-79

**CVSS Base Score**: 6.8 (Medium)

**CVE-ID**: CVE-2016-7981

### Proof of Concept

    <http://spip-dev.srv/ecrire/?exec=valider_xml&var_url=%22%3E%3Ch1%3EXSS!%3C/h1%3E>

### Vulnerable code

The `$url variable` is not properly sanitized in `valider_xml.php`, line 134 :

    $res =
      "<div style='text-align: center'>" . $err . "</div>" .
      "<div style='margin: 10px; text-align: left'>" . $texte . '</div>';
    $bandeau = "<a href='$url_aff'>$url</a>";

The Cross-Site Scripting vulnerability is triggered on line 146 :

    echo "<h1>", $titre, '<br>', $bandeau, '</h1>',

### Timeline (dd/mm/yyyy)

* 15/09/2016 : Initial discovery
* 26/09/2016 : Contact with SPIP Team
* 27/09/2016 : Answer from SPIP Team, sent advisory details
* 27/09/2016 : Incorrect fix from SPIP Team.
* 27/09/2016 : New proof of concept for bypassing fixes for XSS sent.
* 27/09/2016 : Fixes issued for XSS (23185).
* 30/09/2016 : SPIP 3.1.3 Released

### Fixes

* <https://core.spip.net/projects/spip/repository/revisions/23200>
* <https://core.spip.net/projects/spip/repository/revisions/23201>
* <https://core.spip.net/projects/spip/repository/revisions/23202>

### Affected versions

* Version <= 3.1.2

### Credits

* Nicolas CHATELAIN, Sysdream (n.chatelain -at- sysdream -dot- com)

--
SYSDREAM Labs <labs@...dream.com>

GPG :
47D1 E124 C43E F992 2A2E
1551 8EB4 8CD9 D5B2 59A1

* Website: <https://sysdream.com/>
* Twitter: @sysdream

Download attachment "[signature.asc](7/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from core.spip.net_ab2869c1_20250125_071953.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
e0e00ea8**

authored
Sep 28, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/e0e00ea8224f0483a2db61df1d971239b0e146ac)

### Report de r23200 : - ?exec=valider\_xml n'est executable que par les webmestres

```
- var_url ne doit pas contenir de ../../ ni de ..\..\ (windows)
- elle ne lance une action que si on a un var_token qui correspond soit a la signature de l'action en POST soit a la signature de l'action+var_url en GET. Ceci evite de faire lancer le validateur par un lien malveillant fourni a un webmstre d'un site auquel on a pas acces (CSRF)

(Nicolas Chatelain)
```

parent
[793e7a96](/spip/spip/-/commit/793e7a969b82dd900d8cdeb0cc010f380cd05930)

Loading

Loading

Loading

* [Changes
  1](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac)

[Hide whitespace changes](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?action=show&controller=projects%2Fcommit&id=e0e00ea8224f0483a2db61df1d971239b0e146ac&namespace_id=spip&project_id=spip&r=23201&w=1)
[Inline](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?r=23201&view=inline)
[Side-by-side](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?r=23201&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)


