=== Content from seclists.org_c9b94605_20250124_183747.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](469)
[By Date](date.html#470)
[![Next](/images/right-icon-16x16.png)](471)

[![Previous](/images/left-icon-16x16.png)](468)
[By Thread](index.html#470)
[![Next](/images/right-icon-16x16.png)](471)

![](/shared/images/nst-icons.svg#search)

# CVE-2016-7078: Foreman organization/location authorization vulnerability

---

*From*: Dominic Cleal <dominic () cleal org>

*Date*: Wed, 22 Feb 2017 13:00:26 +0000

---

```
CVE-2016-7078: Foreman user with no organizations or locations can see
all resources

A user account that is associated to no organizations or locations is
able to view resources from all organizations/locations in the web UI or
API, when either the organization or location feature is enabled. The
user remains subject to permissions and filters on their assigned roles.

Mitigation: ensure all users are assigned to at least one organization
or location, or disable the feature if unused.

This issue was reported by Daniel Lobato Garcia.

Affects all known Foreman versions
Fix due to be released in Foreman 1.15.0

Patch:
<https://github.com/theforeman/foreman/commit/5f606e11cf39719bf62f8b1f3396861b32387905>

More information:
<https://theforeman.org/security.html#2016-7078>
<http://projects.theforeman.org/issues/16982>
<https://theforeman.org>

--
Dominic Cleal
dominic () cleal org

```

**Attachment:
[signature.asc](att-470/signature_asc.bin)**

*Description:* OpenPGP digital signature

---

[![Previous](/images/left-icon-16x16.png)](469)
[By Date](date.html#470)
[![Next](/images/right-icon-16x16.png)](471)

[![Previous](/images/left-icon-16x16.png)](468)
[By Thread](index.html#470)
[![Next](/images/right-icon-16x16.png)](471)

### Current thread:

* **CVE-2016-7078: Foreman organization/location authorization vulnerability** *Dominic Cleal (Feb 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from theforeman.org_ab2d2628_20250124_183748.html ===


* [Home](/)
* [*![Foreman home](/static/images/foremanhelmet.svg)*](/)
* Get Started
  [Features](/introduction.html)
  [Who uses Foreman](/who_uses.html)
  [Quickstart](/manuals/latest/quickstart_guide.html)
  [Sponsors](/sponsors.html)
* Get Help
  [Manual](/manuals/latest/index.html)
  [Plugins](/plugins/)
  [Foreman API docs](https://apidocs.theforeman.org/foreman/latest/apidoc/v2.html)
  [Foreman+Katello API docs](https://apidocs.theforeman.org/katello/latest/apidoc/v2.html)
  [Training](/training.html)
  [Support](/support.html)
  [Professional Services](/professional-services.html)
* Get involved
  [Community](https://community.theforeman.org)
  [Report a bug](https://projects.theforeman.org/projects)
  [Contribute](/contribute.html)
* News
  [Blog](/blog/index.html)
  [Events](https://community.theforeman.org/c/events/l/calendar)
  [Community Demos](/demos/)
  [Videos](/media.html)
  [Security](/security.html)

## Security process

We take security issues seriously and welcome responsible disclosure from researchers discovering vulnerabilities in Foreman. Please email foreman-security@googlegroups.com (a private address for the security team) with all reports. If you notice the security issue is related to a particular plugin, please mention the plugin within the body of the email to help us in routing the issue to the most authoritative source.

We will endeavour to resolve high severity issues in the current stable release and lower severity issues in the next major release. Announcements of security issues will be made on this page and in the [Release Announcements category of our community forums](https://community.theforeman.org/c/release-announcements/8) when a release containing a fix is available to end users and credit will be given to the researcher if desired.

The policy of the project is to treat all newly reported issues as private, and after evaluation, low to medium severity issues will be made public while high severity issues will be fixed under an embargo. Typically the project supports only one major (x.y) release at a time, though high severity issues may also be fixed in the previous release if it was only recently superseded.

## Security advisories

All security advisories made for Foreman are listed below with their corresponding [CVE identifier](https://cve.mitre.org/).

* [CVE-2024-7923: Authentication bypass in Pulpcore](security.html#2024-7923)
* [CVE-2024-7012: Authentication bypass in Foreman](security.html#2024-7012)
* [CVE-2023-4886: World readable tomcat server.xml contains passwords](security.html#2023-4886)
* [CVE-2022-4130: Blind SSRF via Referer header](security.html#2022-4130)
* [CVE-2022-3874: OS command injection via ct\_command and fcct\_command](security.html#2022-3874)
* [CVE-2021-3584: Remote code execution through Sendmail configuration](security.html#2021-3584)
* [CVE-2021-20256: BMC controller credential leak via API](security.html#2021-20256)
* [CVE-2021-20259: Proxmox compute resource password leak](security.html#2021-20259)
* [CVE-2021-3413: Azure compute resource secret\_key leak](security.html#2021-3413)
* [CVE-2020-14335: World readable dhcp OMAPI secret](security.html#2020-14335)
* [CVE-2020-14380: Users can gain elevated rights when logging in with SSO accounts](security.html#2020-14380)
* [CVE-2020-14334: World readable cache directory on RPM installs](security.html#2020-14334)
* [CVE-2019-14825: Registry credentials are captured in plain text in dynflow task during repository discovery](security.html#2019-14825)
* [CVE-2019-10198: Information disclosure in foreman tasks plugin](security.html#2019-10198)
* [CVE-2019-3845: Lack of access control around Qpid message broker](security.html#2019-3845)
* [CVE-2019-3893: Compute resource credentials exposed during deletion on API](security.html#2019-3893)
* [CVE-2018-14664: Persisted XSS on all pages that use breadcrumbs](security.html#2018-1097)
* [CVE-2018-1097: oVirt credetials exposed by power API](security.html#2018-1097)
* [CVE-2018-1096: SQL injection on dashboard](security.html#2018-1096)
* [CVE-2017-15100: Stored XSS in fact charts](security.html#2017-15100)
* [CVE-2017-7535: Stored XSS when assigning unassigned hosts to organization/location](security.html#2017-7535)
* [CVE-2017-7505: User scoped in organization with permissions for user management can manage administrators that are not assigned to any organization](security.html#2017-7505)
* [CVE-2017-2672: audit log stores plain text compute resource image passwords](security.html#2017-2672)
* [CVE-2017-2667: Hammer CLI does not verify server SSL certificate](security.html#2017-2667)
* [CVE-2016-9593: foreman-debug collects sensitive data](security.html#2016-9593)
* [CVE-2016-8639: settings dropdown menus may run stored XSS in org/location name](security.html#2016-8639)
* [CVE-2016-8634: organizations/locations wizard may run stored XSS in name](security.html#2016-8634)
* [CVE-2016-7078: user with no organizations or locations can see all resources](security.html#2016-7078)
* [CVE-2016-7077: information disclosure from association lists shown without authorization](security.html#2016-7077)
* [CVE-2016-6320: network interface device identifiers may contain stored XSS on host form](security.html#2016-6320)
* [CVE-2016-6319: Foreman form helpers do not escape JS when rendering label](security.html#2016-6319)
* [CVE-2016-5390: API host interfaces data not restricted by view\_hosts filters](security.html#2016-5390)
* [CVE-2016-4995: information disclosure through unauthorized template previews](security.html#2016-4995)
* [CVE-2016-4475: Privilege escalation in Organization and Locations API and UI](security.html#2016-4475)
* [CVE-2016-4451: Privilege escalation through Organization and Locations API](security.html#2016-4451)
* [CVE-2016-3728: remote code execution in smart proxy TFTP API](security.html#2016-3728)
* [CVE-2016-3693: application information leakage through templates](security.html#2016-3693)
* [Ruby code execution via Discovery settings](security.html#2016-discovery-settings)
* [CVE-2016-2100: private bookmarks can be viewed and edited](security.html#2016-2100)
* [CVE-2015-7518: parameter information popup allows stored XSS](security.html#2015-7518)
* [SQL injection via facts search terms](security.html#2015-facts-sql)
* [CVE-2015-5282: parameter hide checkbox allows stored XSS during change](security.html#2015-5282)
* [CVE-2015-5246: Active Directory login works with old password after change](security.html#2015-5246)
* [CVE-2015-5233: reports show/destroy not restricted by host authorization](security.html#2015-5233)
* [CVE-2015-5152: require\_ssl does not enforce HTTPS on API](security.html#2015-5152)
* [CVE-2015-3235: edit\_users permission allows changing of admin passwords](security.html#2015-3235)
* [CVE-2015-3199: Discovery: auto provision rule not enforcing org/locations](security.html#2015-3199)
* [CVE-2015-3155: session cookie set without secure flag on HTTPS](security.html#2015-3155)
* [CVE-2015-1844: users are not restricted to organizations/locations](security.html#2015-1844)
* [CVE-2015-1816: SSL certificate not verified on LDAP connections](security.html#2015-1816)
* [CVE-2014-3691: SSL certificate verification bypass in smart proxy](security.html#2014-3691)
* [CVE-2014-3653: stored cross site scripting (XSS) in template previews](security.html#2014-3653)
* [CVE-2014-3590: user logout vulnerable to CSRF](security.html#2014-3590)
* [CVE-2014-3531: stored cross site scripting (XSS) in operating system names](security.html#2014-3531)
* [CVE-2014-3492: stored cross site scripting (XSS) in YAML preview](security.html#2014-3492)
* [CVE-2014-3491: stored cross site scripting (XSS) in notification dialogs](security.html#2014-3491)
* [CVE-2014-0007: TFTP boot file fetch API permits remote code execution](security.html#2014-0007)
* [CVE-2014-0208: stored cross site scripting (XSS) in search auto-completion](security.html#2014-0208)
* [CVE-2014-0192: provisioning template previews are world-readable](security.html#2014-0192)
* [CVE-2014-0135: Kafo leaves world-readable default\_values.yaml file](security.html#2014-0135)
* [CVE-2014-0090: session fixation, new session IDs are not generated on login](security.html#2014-0090)
* [CVE-2014-0089: stored cross site scripting (XSS) on 500 error page](security.html#2014-0089)
* [CVE-2013-4386: SQL injection in host/host group parameter overrides](security.html#2013-4386)
* [CVE-2013-4182: hosts API privilege escalation](security.html#2013-4182)
* [CVE-2013-4180: DoS via hosts controller input conversion](security.html#2013-4180)
* [CVE-2013-2121: bookmarks remote code execution](security.html#2013-2121)
* [CVE-2013-2113: admin user creation, privilege escalation](security.html#2013-2113)
* [CVE-2013-0210: Arbitrary command execution risk in Foreman proxy](security.html#2013-0210)
* [CVE-2013-0187: XMLHttpRequest bypasses authorization](security.html#2013-0187)
* [CVE-2013-0174: exposed hashed root passwords can be retrieved by unauthenticated remote users](security.html#2013-0174)
* [CVE-2013-0173: insecure fixed salt âforemanâ for passwords](security.html#2013-0173)
* [CVE-2013-0171: import allows unauthenticated YAML uploads/parsing leading to arbitrary code execution](security.html#2013-0171)
* [CVE-2012-5648: SQL injection through search mechanism](security.html#2012-5648)
* [CVE-2012-5477: world writable files in proxy](security.html#2012-5477)

### Disclosure details

#### CVE-2024-7923: Authentication bypass in Pulpcore

An authentication bypass vulnerability has been identified in Pulpcore when
deployed by the Foreman Installer with Gunicorn versions prior to 22.0.

This issue arises from the way Apache is configured to do certificate authentication and
pass this information to the Gunicorn backend,
without unsetting all headers coming from a possibly malicious client.

* Affects Katello 4.0.0 and higher
* Fix released in Foreman 3.10.1, 3.11.2, 3.12.0
* GitHub PR [puppet-pulpcore#357](https://github.com/theforeman/puppet-pulpcore/pull/357)

#### CVE-2024-7012: Authentication bypass in Foreman

An authentication bypass vulnerability has been identified in Foreman when
deployed by the Foreman Installer with External Authentication.

This issue arises from the way Apache is configured to do certificate authentication and
pass this information to the Puma backend,
without unsetting all headers coming from a possibly malicious client.

* Affects Foreman 2.2.0 and higher
* Fix released in Foreman 3.10.1, 3.11.2, 3.12.0
* GitHub PR [puppet-foreman#1181](https://github.com/theforeman/puppet-foreman/pull/1181)

#### CVE-2023-4886: World readable tomcat server.xml contains passwords

The world readable file `/etc/tomcat/server.xml` contains passwords for the keystore and truststore.
The actual stores are limited by file permissions, but `server.xml` should also be limited.

* Affects Katello
* Fix released in Foreman 3.8.0
* Redmine issue [#36760](https://projects.theforeman.org/issues/36760)

#### CVE-2022-4130: Blind SSRF via Referer header

A blind site-to-site request forgery vulnerability was found in Satellite server.
It is possible to trigger an external interaction to an attackerâs server by modifying the Referer header in an HTTP request of specific resources in the server.

* Affects Foreman
* Fix released in Foreman 3.8.0
* Redmine issue [#36768](https://projects.theforeman.org/issues/36768)

#### CVE-2022-3874: OS command injection via ct\_command and fcct\_command

`ct_command` and `fcct_command` settings, available via Administer - Settings, both accept arbitrary
strings as the command name and calling CoreOS templates will execute those commands as the user Foreman runs under.
By default, only Foreman super administrator can access settings.

* Affects Foreman 3.2.0 and higher
* Fix released in Foreman 3.8.0
* Redmine issue [#36759](https://projects.theforeman.org/issues/36759)

#### CVE-2021-3584: Remote code execution through Sendmail configuration

Sendmail location and arguments, available via Administer - Settings, both accept arbitrary strings and pass them into shell.
By default, only Foreman super administrator can access settings.

* Affects Foreman 1.15.0 and higher
* Fix released in Foreman 2.4.1, 2.5.1 and 3.0.0
* Redmine issue [#32753](https://projects.theforeman.org/issues/32753)

#### CVE-2021-20256: BMC controller credential leak via API

A password leak was identified on Foreman which will expose BMC password in plaintext through the host API.

* Affects Foreman 1.4.0 and higher
* Fix released in Foreman 2.5.0
* Redmine issue [#31937](https://projects.theforeman.org/issues/31937)

#### CVE-2021-20259: Proxmox compute resource password leak

Proxmox compute resource credentials (`password`) were visible to any user with `view_compute_resource` permission in the API under `/api/compute_resources/` and `/api/compute_resources/:id/`.

* Affects Foreman Fog Proxmox 0.11.0 and higher
* Fix released in Foreman Fog Proxmox 0.13.1 and higher

#### CVE-2021-3413: Azure compute resource secret\_key leak

Azure compute resource credentials (`secret_key`) were visible to any user with `view_compute_resource` permission in the API under `/api/compute_resources/` and `/api/compute_resources/:id/`.

* Affects Foreman Azure RM 2.0.1 and higher
* Fix released in Foreman Azure RM 2.2.0 and higher
* Redmine issue [#31938](https://projects.theforeman.org/issues/31938)

#### CVE-2020-14335: World readable dhcp OMAPI secret could expose dhcp API access

OMAPI key used to secure dhcp API access could have been read by anyone with access to the hosting system.

*Mitigation:* override `/etc/dhcp/dhcpd.conf` file mode to `0640` and ensure access to the file for user `foreman-proxy` by other means.

On Red Hat based systems, acls are used by default, so you need to only set less permissive mode and you should be set.
On Debian based systems, you need to install acls and set read access to the `/etc/dhcp` directory by acls.
To set correct acls install `acl` package and use `setfacl -R -m u:foreman-proxy:rx /etc/dhcp`.

In case the system may have been accessed locally by an un-trusted user, it may be prudent to change the OMAPI secret for dhcp.

* Affects foreman-proxy installations with dhcp feature protected by `dhcp_key_secret` since Foreman 1.0
* Fix released in Foreman 2.2.0 and 2.1.3 and higher
* Redmine issue [#30489](https://projects.theforeman.org/issues/30489)

#### CVE-2020-14380: Users can gain elevated rights when logging via external authentication

Users that are authenticated using `external` authentication methods such as Kerberos, OpenID Connect or Apache SSO can gain the rights of an `internal` user. This is possible only when the username of an internal and external user is the same.

* Affects external user authentication since Foreman 1.4
* Fix released in Foreman 2.2.0, 2.1.3 and 2.0.3 and higher
* Redmine issue [#30739](https://projects.theforeman.org/issues/30739)

#### CVE-2020-14334: World readable cache could expose sensitive settings

Even encrypted settings have their raw values cached. Too permissive mode on cache dir caused, that anyone with access to the hosting system could read this encrypted settings.

*Mitigation:* override `/run/foreman` directory mode to `0750`.
To do so in a manner that survives reboot, update the file `/usr/lib/tmpfiles.d/foreman.conf`.

```
d /run/foreman 0750 foreman foreman -

```

For the change to have effect immediately run `systemd-tmpfiles --create`.

In case the system may have been accessed locally by an un-trusted user, it may be prudent to change any secrets stored in the settings, such as OAuth keys or remote execution passwords.

* Affects RPM installations using file cache since Foreman 1.3
* Fix released in Foreman 2.2.0, 2.1.1 and 2.0.2 and higher
* Redmine issue [#30490](https://projects.theforeman.org/issues/30490)

#### CVE-2019-14825: Registry credentials are captured in plain text in dynflow task during repository discover

A cleartext password storage issue was discovered in Katello. Registry credentials used during container image discovery were inadvertently logged without being masked. This could expose the registry credentials to other privileged users.

* Affects Katello 3.4 and higher.
* Fix released in Katello 3.14.0 and higher.
* Redmine issue [#27485](https://projects.theforeman.org/issues/27485)

#### CVE-2019-10198: Authorization bypass in foreman tasks plugin

The Foreman tasks plugin allowed authenticated users to view task details even if they lack the permission to do so. This bypass requires prior knowledge of the task UUID, which can not be easily guessed.

* Affects Foreman tasks 0.7.8 and higher.
* Fix released in Foreman tasks 0.15.7 and higher.
* Redmine issue [#27275](https://projects.theforeman.org/issues/27275)

#### CVE-2019-3845: Lack of access control around Qpid message broker

Katello installations include the Apache Qpid message broker and dispatch router services. It was found that due to the lack of access permissions around the message broker and router, clients using the katello-agent for package management could invoke QMF (QPid Management Framework) actions against the broker. QMF enables broker settings, queues, exchanges, etc. to be manipulated and those actions could compromise communication between hosts and the server, or allow undesired katello-agent actions to be invoked across clients. This issue was reported by Pavel Moravec.

* Affects Katello 1.4 and higher.
* Fix released with Foreman 1.20.3 (Katello 3.10.1), Foreman 1.21.3 (Katello 3.11.1) and higher.
* Redmine issue [#26571](https://projects.theforeman.org/issues/26571)

#### CVE-2019-3893: Compute resource credentials exposed during deletion on API

When deleting a compute resource via the API, the API responded with details of the compute resource, including credentials in clear text. Users not able to upgrade should ensure the `delete_compute_resource` permission is not granted to users not trusted with the credentials.

* Affects Foreman 1.1 and higher.
* Fix released with Foreman 1.21.1.
* Redmine issue [#26450](https://projects.theforeman.org/issues/26450)

#### CVE-2018-14664: Persisted XSS on all pages that use breadcrumbs

If user has the permission to edit resource which attribute is user in the breadcrumbs bar, itâs not properly escaped allowing attacker to store code, that will be executed on client side. E.g. create a domain with name test.com, then go to its edit form. See the breadcrumb didnât escape the HTML code.

* Affects Foreman 1.18 and higher
* Fix released with Foreman 1.18.3
* Redmine issue [#25169](https://projects.theforeman.org/issues/25169)

#### CVE-2018-1097: oVirt credentials exposed by power API

When sending a power action to a host provisioned on an oVirt compute resource, the API responded with details of the compute resource, including credentials in clear text.

* Affects Foreman 1.3 and higher.
* Fix released with Foreman 1.16.1.
* Redmine issue [#22546](https://projects.theforeman.org/issues/22546)

#### CVE-2018-1096: SQL injection on dashboard

One of the parameters passed when saving dashboard widget positions was not properly escaped, leading to possibility of SQL injection attack. Due to the nature of the query the impact is limited to possible information disclosure and does not allow modifications to the database.

This issue was reported by Martin PovolnÃ½ of Red Hat.

* Affects Foreman 1.9 and higher.
* Fix released with Foreman 1.16.1.
* Redmine issue [#23028](https://projects.theforeman.org/issues/23028)

#### CVE-2017-15100: Stored XSS on fact related charts

Facts reported by hosts that contain HTML code in their fact name or value could cause said HTML to be executed by usersâ browser when hovering over fact distribution charts on the facts page, on the statistic page and on the trends page.

This issue was reported by Roman Mueller.

* Affects Foreman 1.2 and higher.
* Fix released with Foreman 1.16.0
* Redmine issue [#21519](https://projects.theforeman.org/issues/21519)

#### CVE-2017-7535: Stored XSS when assigning unassigned hosts to organization/location

An organization or location named e.g. `<script>do_evil();</script>` may cause the script to be executed if a user tries to assign selected or all unassigned hosts to said organization or location.

This issue was reported by Sanket Jagtap.

* Affects Foreman 1.1 and higher.
* Fix released with Foreman 1.16.0
* Redmine issue [#20963](https://projects.theforeman.org/issues/20963)

#### CVE-2017-7505: User scoped in organization with permissions for user management can manage administrators that are not assigned to any organization

User with `*_users` permissions who is assigned to some organization(s) can do all operations granted by these permissions on all administrator user objects. We considered admin to effectively be present in all organizations.

The issue was reported by David Caplan.

* Affects Foreman 1.5 and higher
* Fix released with Foreman 1.15.1
* Redmine issue [#19612](https://projects.theforeman.org/issues/19612)

#### CVE-2017-2672: audit log stores plain text compute resource image passwords

Compute resource images added/registered in Foreman with username and password credentials will have the password stored in plain text in the audit log. A user with permission to view the audit log can view the password and may gain access to newly provisioned hosts.

This issue was reported by Daniel Kimsey.

* Affects Foreman 1.4 and higher
* Fix released with Foreman 1.15.0-RC2
* Redmine issue [#19169](https://projects.theforeman.org/issues/19169)

#### CVE-2017-2667: Hammer CLI does not verify server SSL certificate

HTTPS connections initiated by Hammer CLI to the API server do not perform validation of the server SSL/TLS certificate, allowing for a man-in-the-middle attack against the user.

This issue was reported by Tomas Strachota.

* Affects all versions of Hammer CLI
* Fix released in Hammer CLI 0.10.0 (with Foreman 1.15.0)
* Redmine issue [#19033](https://projects.theforeman.org/issues/19033)

#### CVE-2016-9593: foreman-debug collects sensitive data

It was found that foreman-debug did not obfuscate sensitive information (such as passwords, answer and configuration options) from the foreman-installer log file, allowing a user authorized to access the archives created by foreman-debug to gain access to potentially sensitive information.

This issue was reported by Pavel Moravec.

* Affects Foreman 1.2.0 up to and including 1.14.x
* Fix released with Foreman 1.15.0-RC1
* Redmine issue [#17005](https://projects.theforeman.org/issues/17005)

#### CVE-2016-8639: settings dropdown menus may run stored XSS in org/location name

If an organization or location is created with a name containing HTML, then the administrator-only Settings page will render the HTML as part of a dropdown menu.

This may permit a stored XSS attack if an organization/location with HTML in the name is created, then an administrator attempts to change the default organization/location settings.

*Mitigation:* restrict permissions to organization and location creation, use the API or CLI instead to change the default organization/location settings.

*Note:* this CVE identifier has been assigned retrospectively, to describe a vulnerability that was fixed during a refactoring of the affected code.

This issue was reported by Sanket Jagtap.

* Affects Foreman 1.11.0 to 1.12.4
* Fix released in Foreman 1.13.0
* Redmine issue [#15037](https://projects.theforeman.org/issues/15037)

#### CVE-2016-8634: organizations/locations wizard may run stored XSS in name

When creating an organization or location in Foreman, if the name contains HTML then the second step of the wizard will render the HTML. This occurs in the alert box on the page.

This may permit a stored XSS attack if an organization/location with HTML in the name is created, then a user is linked directly to this URL.

*Mitigation:* restrict permissions to organization and location creation, donât follow untrusted links to Foreman.

This issue was reported by Sanket Jagtap.

* Affects Foreman 1.1 and higher
* Fix released in Foreman 1.14.0-RC1
* Redmine issue [#17195](https://projects.theforeman.org/issues/17195)

#### CVE-2016-7078: user with no organizations or locations can see all resources

A user account that is associated to no organizations or locations is able to view resources from all organizations/locations in the web UI or API, when either the organization or location feature is enabled. The user remains subject to permissions and filters on their assigned roles.

*Mitigation:* ensure all users are assigned to at least one organization or location, or disable the feature if unused.

This issue was reported by Daniel Lobato Garcia.

* Affects all known Foreman versions
* Fix released in Foreman 1.15.0-RC1
* Redmine issue [#16982](https://projects.theforeman.org/issues/16982)

#### CVE-2016-7077: information disclosure from association lists shown without authorization

Lists of associated resources, such as operating systems associated to a new architecture, are not restricted to listing resources that the user is authorized to view, when rendering with fewer than six items. The list will show all possible associated resources, disclosing their names.

This issue was reported by Jitendra Yejare.

* Affects Foreman 1.1 and higher, but was first mitigated against in Foreman 1.9.0 for some cases
* Fix released in Foreman 1.14.0-RC1
* Redmine issue [#16971](https://projects.theforeman.org/issues/16971)

#### CVE-2016-6320: network interface device identifiers may contain stored XSS on host form

Network interface identifiers stored for hosts may contain HTML or JavaScript that allows a stored XSS (cross-site scripting) vulnerability when later viewing the host edit form.

This issue was reported by Sanket Jagtap.

* Affects Foreman 1.8.0 and higher
* Fix released in Foreman 1.12.2
* Redmine issue [#16022](https://projects.theforeman.org/issues/16022)

#### CVE-2016-6319: Foreman form helpers do not escape JS when rendering label

Label parameter of all form helpers was not escaped allowing XSS (cross-site scripting). The Foreman itself did not contain exploitable code but other plugins that relied on form helpers could be vulnerable. One known vulnerable plugin is Remote Execution. All versions of this plugin are affected.

* Affects Foreman 1.6.0 and higher
* Fix released in Foreman 1.12.2
* Redmine issue [#16024](https://projects.theforeman.org/issues/16024)

#### CVE-2016-5390: API host interfaces data not restricted by view\_hosts filters

Non-admin users with the view\_hosts permission containing a filter are able to access API routes beneath âhostsâ such as GET /api/v2/hosts/secrethost/interfaces without the filter being taken into account. This allows users to access network interface details (including BMC login details) for any host.

The filter is only correctly used when accessing the main host details (/api/v2/hosts/secrethost). Access to the ânestedâ routes, which includes interfaces, reports, parameters, audits, facts and Puppet classes, is not authorized beyond requiring any view\_hosts permission.

* Affects Foreman 1.10.0 and higher
* Fix released in Foreman 1.12.1 and 1.11.4
* Redmine issue [#15653](https://projects.theforeman.org/issues/15653)

#### CVE-2016-4995: information disclosure through unauthorized template previews

Users who are logged in with permissions to view some hosts are able to preview provisioning templates for any host by specifying its hostname in the URL, as the specific view\_hosts permissions and filters arenât checked.

If the organization or location features are enabled, the user will still be restricted to their associated orgs/locs.

* Affects Foreman 1.11.0 and higher
* Fix released in Foreman 1.12.1 and 1.11.4
* Redmine issue [#15490](https://projects.theforeman.org/issues/15490)

#### CVE-2016-4475: Privilege escalation in Organization and Locations API and UI

When accessing Foreman as a user limited to specific organization or location, these are not taken into account in the API or parts of the UI. This allows a user to view, edit and delete organizations and locations they are not associated with if they have the requisite permissions.

*Mitigation:* make sure you have filters restricted to organizations or locations when you limit user by assigning them to particular organizations or locations.

* Affects Foreman 1.1 and higher
* Fix released in Foreman 1.12.0-RC3 and 1.11.4
* Redmine issue [#15268](https://projects.theforeman.org/issues/15268)

#### CVE-2016-4451: Privilege escalation through Organization and Locations API

When accessing Foreman as a user limited to specific organization, if users know other organization id and have unlimited filters they can access/modify other organization data. They just have to set the id as API parameter.

*Mitigation:* make sure you have filters restricted to organizations or locations when you limit user by assigning him particular organization or location.

* Affects Foreman 1.7 and higher
* Fix released in Foreman 1.12.0-RC1 and 1.11.3
* Redmine issue [#15812](https://projects.theforeman.org/issues/15182)

#### CVE-2016-3728: remote code execution in smart proxy TFTP API

The smart proxy TFTP API is vulnerable to arbitrary remote code execution, as it passes untrusted user input (the PXE template type) to the eval() function causing it to be executed.

Thanks to Lukas Zapletal for reporting the issue.

*Mitigation:* ensure `trusted_hosts` is set in `/etc/foreman-proxy/settings.yml`, HTTPS is in use and `/etc/foreman-proxy/settings.d/tftp.yml` is configured for `https` only (if enabled).

* Affects Foreman 0.2 and higher
* Fix released in Foreman 1.11.2 and 1.10.4
* Redmine issue [#14931](https://projects.theforeman.org/issues/14931)

#### CVE-2016-3693: application information leakage through templates

A provisioning template containing `inspect` will expose sensitive information about the Rails controller and application when rendered when using Safemode rendering (the default setting). This includes the application secret token, possibly permitting a privilege escalation.

Thanks to Ivan Necas for reporting the issue.

As a precaution, the security token may be regenerated with:

1. `chown foreman /usr/share/foreman/config/initializers/local_secret_token.rb`
2. `foreman-rake security:generate_token`
3. `chown root /usr/share/foreman/config/initializers/local_secret_token.rb`

*Mitigation:* remove edit\_provisioning\_templates from untrusted users.

* Affects all known Foreman versions
* Fix released in Foreman 1.11.1
* Redmine issue [#14635](https://projects.theforeman.org/issues/14635)

#### Ruby code execution via Discovery settings

It is possible to run arbitrary Ruby code entering it on the Administer -
Settings - Discovery and then visiting a discovered host detail page where it
gets rendered.

* Affects Foreman Discovery 4.2.0 to 5.0.1 (gem releases only, rc and nightly builds)
* Discovery plugin 4.1 series (shipped with Foreman 1.10) was *not* affected.
* Fixed in Discovery plugin 5.0.2
* Redmine issue [#14140](https://projects.theforeman.org/issues/14140)

#### CVE-2016-2100: private bookmarks can be viewed and edited

Bookmarks set to âprivateâ can be viewed by any user, and edited or deleted by any user granted the edit or destroy\_bookmarks permissions.

*Mitigation:* remove edit\_bookmarks and destroy\_bookmarks from untrusted users, remove private information from bookmark searches.

* Affects Foreman 0.3 and higher
* Fix released in Foreman 1.11.0-RC2 and 1.10.3
* Redmine issue [#13828](https://projects.theforeman.org/issues/13828)

#### CVE-2015-7518: parameter information popup allows stored XSS

The popup boxes next to global parameters, smart class parameters and smart variables on the host and host group edit forms can allow stored XSS to be executed in the browser from the parameter description etc.

*Mitigation:* do not click on the information popup box next to parameters in the host/group forms, and/or remove permission to edit Puppet classes from untrusted users.

* Affects all known Foreman versions
* Fix released in Foreman 1.10.0
* Redmine issue [#12611](https://projects.theforeman.org/issues/12611)

#### SQL injection via facts search terms

The search for facts and also hosts by facts is vulnerable to SQL injection by breaking out of quotes in either the fact name or the fact value.

No CVE identifier will be assigned to this vulnerability as it affects only release candidates.

* Affects Foreman 1.10.0-RC1 and higher
* Fix released in Foreman 1.10.0-RC3
* Redmine issue [#12458](https://projects.theforeman.org/issues/12458)

#### CVE-2015-5282: parameter hide checkbox allows stored XSS during change

The parameter management UI has a checkbox to mark values as hidden to mask them from casual viewing. The checkbox that hides/shows the value fails to handle HTML properly and so is vulnerable to an XSS issue where HTML can be stored in a parameter, and executed by another user if they later tick/untick the hide box.

* Affects Foreman 1.7.0 and higher
* Fix released in Foreman 1.10.0-RC1
* Redmine issue [#11859](https://projects.theforeman.org/issues/11859)

#### CVE-2015-5246: Active Directory login works with old password after change

*This CVE identifier was assigned before realizing that this was not a bug in Foreman, but a feature of Active Directory. It will remain assigned for future reference only. See [the Active Directory password changes](/manuals/latest/index.html#4.1.1LDAPAuthentication) section of the manual or [Microsoft KB906305](https://support.microsoft.com/en-us/kb/906305) for more details.*

When using an Active Directory instance to log into Foreman (via an LDAP authentication source), it is possible to log into Foreman for up to one hour after a password change in AD using the old password.

* Fix to Foreman not required, reconfigure Active Directory
* Redmine issue [#11471](https://projects.theforeman.org/issues/11471)

#### CVE-2015-5233: reports show/destroy not restricted by host authorization

Users with view\_reports or destroy\_reports permissions allows a user to view or delete reports from any host without taking their view\_hosts permission into account.

The reports list and other views combine the reports and hosts permissions to only show reports for hosts that a user can view, but the individual report show/delete pages and APIs do not apply the hosts permissions.

*Mitigation:* remove view\_reports and destroy\_reports permissions from users until a fix is available, or add a search query to the role filter to restrict it.

* Affects Foreman 1.5.0 and higher
* Fix released in Foreman 1.9.1 and 1.8.4
* Redmine issue [#11579](https://projects.theforeman.org/issues/11579)

#### CVE-2015-5152: require\_ssl does not enforce HTTPS on API

The ârequire\_sslâ setting in /etc/foreman/settings.yml should enforce that web requests sent to Foreman over HTTP are redirected to HTTPS, but this was found not to happen with API requests (e.g. from Hammer CLI). Foreman will process API requests over HTTP, but should have redirected.

Redirection wonât help with credentials having already been sent, but should give some notification that the user/app is using the wrong URL.

*Mitigation:* add the following to the Apache HTTP VirtualHost, e.g. in `/etc/httpd/conf.d/05-foreman.d/api_request.conf`:

```
RewriteEngine On
RewriteRule ^/api/(.*) https://%{SERVER_NAME}/api/$1 [R,L]

```

* Affects Foreman 1.1 and higher
* Fix released in Foreman 1.9.0-RC1
* Redmine issue [#11119](https://projects.theforeman.org/issues/11119)

#### CVE-2015-3235: edit\_users permission allows changing of admin passwords

A user with the edit\_users permission (e.g. with the Manager role) is allowed to edit admin users. This allows them to change the password of the admin userâs account and gain access to it.

*Mitigation:* change roles of users with the edit\_users permission, remove the *Unlimited* flag and set a search query of `admin = false`.

* Affects all known Foreman versions
* Fix released in Foreman 1.9.0-RC1
* Redmine issue [#10829](https://projects.theforeman.org/issues/10829)

#### CVE-2015-3199: Discovery: auto provision rule not enforcing org/locations

*This CVE identifier was assigned before realizing that no released versions of Foreman Discovery were affected. It will remain assigned for future reference only.*

The Foreman Discovery plugin auto provisioning rules do not enforce that the rule and the assigned host group are in the same organization and location. This can allow a rule to be configured with mismatched orgs/locations, and for another user who has access to the rule but not the host group, to run it and provision a host into a group in a different org/location to their own.

* Affects no released versions of Foreman Discovery
* Fix released in Foreman Discovery 4.0.0
* Redmine issue [#10469](https://projects.theforeman.org/issues/10469)

#### CVE-2015-3155: session cookie set without secure flag on HTTPS

The session cookie created when accessing the Foreman web UI over HTTPS is not set with the âsecureâ flag, which may lead to session hijacking.

If a user successfully logs into Foreman, then accesses Foreman over HTTP (which redirects to HTTPS, but with a window of opportunity), the session ID will be sent unencrypted and the session may be hijacked by an attacker.

* Affects all known Foreman versions
* Fix released in Foreman 1.8.1
* Redmine issue [#10275](https://projects.theforeman.org/issues/10275)

#### CVE-2015-1844: users are not restricted to organizations/locations

When a non-admin user is associated to organizations or locations, their access is not correctly restricted. API access allows access to resources in any org/location, and UI access when the user is associated to more than one org/location is not restricted.

This allows users to read, edit and perform actions on resources (e.g. hosts) outside of the organizations or locations they have been assigned to.

* Affects Foreman 1.2.0 (TBC) and higher
* Fix released in Foreman 1.8.0-RC3 and 1.7.5
* Redmine issue [#9947](https://projects.theforeman.org/issues/9947)

#### CVE-2015-1816: SSL certificate not verified on LDAP connections

When making an SSL connection to an LDAP authentication source in Foreman, the remote server certificate is accepted without any verification against known certificate authorities.

This can allow the LDAP connection between Foreman and the LDAP server to be attacked, and a different LDAP server could be contacted to authenticate users to Foreman.

* Affects Foreman 1.3.0 and higher
* Fix released in Foreman 1.7.4 and 1.8.0-RC2
* Redmine issue [#9858](https://projects.theforeman.org/issues/9858)

#### CVE-2014-3691: SSL certificate verification bypass in smart proxy

The smart proxy (foreman-proxy) fails to block connections when no client SSL certificate is supplied, instead permitting any request. Typically the smart proxy is configured to receive HTTPS requests with a client SSL certificate that is signed by the same CA (certificate authority) as its own, preventing unauthorized access to manage services such as DHCP, DNS and the Puppet CA.

It is strongly recommended to mitigate the problem by restricting access to the smart proxy. More information on [foreman-announce](https://groups.google.com/forum/#!topic/foreman-announce/jXC5ixybjqo).

Thanks to Michael Moll, Jon McKenzie and Michael Messmore for reporting the issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.6.2 and 1.5.4
* Redmine issue [#7822](https://projects.theforeman.org/issues/7822)
* Red Hat Bugzilla [#1150879](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3691)

#### CVE-2014-3653: stored cross site scripting (XSS) in template previews

Provisioning templates can store HTML and then evaluate HTML or JS content when using the editorâs preview function.

Thanks to Aaron Stone for reporting this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.6.1
* Redmine issue [#7483](https://projects.theforeman.org/issues/7483)
* Red Hat Bugzilla [#1145398](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3653)

#### CVE-2014-3590: user logout vulnerable to CSRF

The user logout function could be triggered through cross-site request forgery (e.g. a redirect), causing a user to be logged out and lose their active session.

Thanks to Jan HutaÅ of Red Hat for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.6.1
* Redmine issue [#6999](https://projects.theforeman.org/issues/6999)
* Red Hat Bugzilla [#1128108](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3590)

#### CVE-2014-3531: stored cross site scripting (XSS) in operating system names

Operating system names and descriptions could store and cause evaluation of HTML in page views, allowing a cross site scripting (XSS) attack against the user.

Thanks to Jan HutaÅ of Red Hat for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.5.2
* Redmine issue [#6580](https://projects.theforeman.org/issues/6580)
* Red Hat Bugzilla [#1108745](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3531)

#### CVE-2014-3492: stored cross site scripting (XSS) in YAML preview

The host YAML page, used to preview the Foreman response for the Puppet ENC, will evaluate HTML stored in any host data such as parameters or comments, allowing a cross site scripting (XSS) attack against the user.

* Affects all known Foreman versions
* Fix released in Foreman 1.4.5 and 1.5.1
* Redmine issue [#6149](https://projects.theforeman.org/issues/6149)
* Red Hat Bugzilla [#1108241](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3492)

#### CVE-2014-3491: stored cross site scripting (XSS) in notification dialogs

When resources (e.g. a host group) were saved or deleted through the web UI, the name of the resource would be evaluated unsafely inside the notification popup, allowing a cross site scripting (XSS) attack against the user changing the resource.

Thanks to Adam Salah of the Red Hat Satellite 6 QE Team for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.4.5 and 1.5.1
* Redmine issue [#5881](https://projects.theforeman.org/issues/5881)
* Red Hat Bugzilla [#1100313](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3491)

#### CVE-2014-0007: TFTP boot file fetch API permits remote code execution

The Smart Proxy API for downloading boot files from installation media to the TFTP server was vulnerable to remote code execution exploits.

Thanks to Lukas Zapletal of the Red Hat Foreman Team for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.4.5 and 1.5.1
* Redmine issue [#6086](https://projects.theforeman.org/issues/6086)
* Red Hat Bugzilla [#1105369](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0007)

#### CVE-2014-0208: stored cross site scripting (XSS) in search auto-completion

The search auto-completion was vulnerable to a stored cross site scripting (XSS) attack via completion of (global/host) parameters in search keys.

Thanks to Jan HutaÅ of Red Hat for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.4.4 and 1.5.0
* Redmine issue [#5471](https://projects.theforeman.org/issues/5471)
* Red Hat Bugzilla [#1094642](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0208)

#### CVE-2014-0192: provisioning template previews are world-readable

Provisioning templates previews (âspoofâ) are accessible without authentication when used with the hostname parameter.

* Affects Foreman 1.4.0 to 1.4.3 inclusive
* Fix released in Foreman 1.4.4 and 1.5.0
* Redmine issue [#5436](https://projects.theforeman.org/issues/5436)
* Red Hat Bugzilla [#1092354](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0192)

#### CVE-2014-0135: Kafo leaves world-readable default\_values.yaml file

When Kafo (used in the Foreman installer) runs, a /tmp/default\_values.yaml file is written to and created with world readable permissions. This is prone to race-condition attacks and contains default values for all parameters, such as autogenerated passwords.

* Affects all known Kafo versions
* Fix released in Kafo 0.3.17 and 0.5.2 (to Foreman 1.4 and 1.5 repos respectively)
* Redmine issue [#4648](https://projects.theforeman.org/issues/4648)
* Red Hat Bugzilla [#1076335](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0135)

#### CVE-2014-0090: session fixation, new session IDs are not generated on login

Upon successful login, a new session ID was not generated for the user, so an attacker who had set the session ID in the request from the userâs browser would be able to exploit the escalated session with the userâs privileges.

Thanks to Jeremy Choi and Keqin Hong of the Red Hat HSS Pen-Test Team for discovering this issue.

* Affects all known Foreman versions
* Fix released in Foreman 1.4.2
* Redmine issue [#4457](https://projects.theforeman.org/issues/4457)
* Red Hat Bugzilla [#1072151](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0090)

#### CVE-2014-0089: stored cross site scripting (XSS) on 500 error page

The 500 error page was vulnerable to stored cross site scripting attacks, where the error message was rendered without HTML encoding. In addition, bookmarks could be saved by any user with HTML in the name which caused an error when rendering the bookmark list, leading to a 500 error and execution of the HTML in the browser.

Thanks to Jeremy Choi and Keqin Hong of the Red Hat HSS Pen-Test Team for discovering this issue.

* Affects Foreman 1.4.0 to 1.4.1 inclusive
* Fix released in Foreman 1.4.2
* Redmine issue [#4456](https://projects.theforeman.org/issues/4456)
* Red Hat Bugzilla [#1071741](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0089)

#### CVE-2013-4386: SQL injection in host/host group parameter overrides

Host and host group parameter overrides (lookup\_values) allowed SQL injection from the host FQDN or host group label.

* Fix released in Foreman 1.2.3
* Redmine issue [#3160](https://projects.theforeman.org/issues/3160)
* Red Hat Bugzilla [#1013076](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4386)

#### CVE-2013-4182: hosts API privilege escalation

The /api/hosts API was found to provide access to all hosts without checking whether the current user has privileges to view a particular host.

Thanks to Daniel Lobato Garcia of CERN IT-PES-PS for discovering this issue.

* Fix released in Foreman 1.2.2
* Redmine issue [#2863](https://projects.theforeman.org/issues/2863)
* Red Hat Bugzilla [#990374](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4182)

#### CVE-2013-4180: DoS via hosts controller input conversion

Power and IPMI boot actions converted user input to symbols, which could lead to memory exhaustion.

Thanks to Marek Hulan of the Red Hat Foreman Team for discovering this issue.

* Fix released in Foreman 1.2.2
* Redmine issue [#2860](https://projects.theforeman.org/issues/2860)
* Red Hat Bugzilla [#989755](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4180)

#### CVE-2013-2121: bookmarks remote code execution

Bookmarks could be created in Foreman containing data that was later executed arbitrarily when reading the bookmark.

Thanks to Ramon de C Valle of the Red Hat Product Security Team for discovering this issue.

* Fix released in Foreman 1.2.0
* Redmine issue [#2631](https://projects.theforeman.org/issues/2631)
* Red Hat Bugzilla [#968166](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-2121)

#### CVE-2013-2113: admin user creation, privilege escalation

Non-admin user with permissions to create or edit other users were able to change the admin flag, or assign roles that they themselves do not have, enabling a privilege escalation.

Thanks to Ramon de C Valle of the Red Hat Product Security Team for discovering this issue.

* Fix released in Foreman 1.2.0
* Redmine issue [#2630](https://projects.theforeman.org/issues/2630)
* Red Hat Bugzilla [#966804](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-2113)

#### CVE-2013-0210: Arbitrary command execution risk in smart proxy

Requests to the smart proxy Puppet run API were not properly escaped when running the Puppet command, leading to possible arbitrary command execution.

* Fix released in Foreman 1.2.0

#### CVE-2013-0187: XMLHttpRequest bypasses authorization

XMLHttpRequest or AJAX requests to Foreman were not subject to authorization checks, enabling privilege escalation for authenticated users.

* Fix released in Foreman 1.1

#### CVE-2013-0174: exposed hashed root passwords can be retrieved by unauthenticated remote users

The external node classifier (ENC) API in Foreman was accessible to any remote host and the output would contain the hashed root psasword (used for unattended installation). Authentication and authorization features were added to the ENC API to secure this data.

Thanks to Andreas Rogge for discovering this issue.

* Fix released in Foreman 1.1
* Redmine issue [#2069](https://projects.theforeman.org/issues/2069)

#### CVE-2013-0173: insecure fixed salt âforemanâ for passwords

The salt used to hash root passwords (used for unattended installation) was fixed to the string âforemanâ instead of being randomized.

* Fix released in Foreman 1.1
* Redmine issue [#2069](https://projects.theforeman.org/issues/2069)

#### CVE-2013-0171: import allows unauthenticated YAML uploads/parsing leading to arbitrary code execution

Fact and report import APIs in Foreman were accessible to any remote host and accepted YAML input, allowing arbitrary objects to be created on the Foreman server via YAML. Authentication and authorization features were added to the import APIs to prevent this.

* Fix released in Foreman 1.1
* Redmine issue [#2121](https://projects.theforeman.org/issues/2121)

#### CVE-2012-5648: SQL injection through search mechanism

Input to the search mechanism in Foreman was not escaped when constructing queries, enabling SQL injection into the resulting query.

* Fix released in Foreman 1.0.2

#### CVE-2012-5477: world writable files in smart proxy

The smart proxy daemon ran with a umask of 0, causing files and directories written by it to have world-writable bits set. Files managed by the smart proxy could be modified by local users on the same host.

* Fix released in Foreman 1.1
* Redmine issue [#1929](https://projects.theforeman.org/issues/1929)

## GPG keys

The Foreman project uses multiple GPG keys to sign packages and release artifacts. All stable releases will be signed by one of the keys. Nightly and plugin Debian packages will be signed, while nightly and plugin RPM packages will not (this may change in the future).

Signing for the Debian family of operating systems is via secure apt and more information, including verification steps can be found [on the Debian web site](https://wiki.debian.org/SecureApt#Debian_archive_key_expiry). RPMs themselves are signed and can be verified using `rpm --checksig PACKAGE`. All yum repository configs set up by foreman-release RPMs or the installer will enable GPG checking by default.

Key management is changing at the time of writing to cycle nightly keys every two years, and issue limited duration keys per stable release.

| Key ID | Fingerprint | Description | Created | Expires | Revoked | Notes |
| --- | --- | --- | --- | --- | --- | --- |
| [E775FF07](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x1DCB15D12CA140EEF4947E5766CF053FE775FF07) | 1DCB 15D1 2CA1 40EE F494 7E57 66CF 053F E775 FF07 | Foreman Archive Signing Key | 2010-11-10 |  | [2014-07-08](https://groups.google.com/forum/#!topic/foreman-announce/BiIT784Mb7Q) | Used up to Foreman 1.5.1 |
| [1AA043B8](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x7059542D5AEA367F78732D02B3484CB71AA043B8) | 7059 542D 5AEA 367F 7873 2D02 B348 4CB7 1AA0 43B8 | Foreman Automatic Signing Key (2014) | 2014-07-01 | 2016-06-30 |  |  |
| [563278F6](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0xAE0AF310E2EA96B6B6F4BD726F8600B9563278F6) | AE0A F310 E2EA 96B6 B6F4 BD72 6F86 00B9 5632 78F6 | Foreman Automatic Signing Key (2016) | 2016-04-08 | 2018-04-08 |  |  |
| [667D1F07](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0xA91E2984667D1F07) | 503E FA96 89AA AD57 D693 6514 A91E 2984 667D 1F07 | Foreman Release Signing Key (1.6) | 2014-08-14 | 2015-08-14 |  |  |
| [2D762E88](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x4C258BD42D762E88) | 730A 9338 F93E E729 2EAC 2052 4C25 8BD4 2D76 2E88 | Foreman Release Signing Key (1.7) | 2014-11-10 | 2016-11-09 |  |  |
| [225C9B71](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x28F5A69D225C9B71) | 64E3 7B1F A6C0 2416 6B53 5495 28F5 A69D 225C 9B71 | Foreman Release Signing Key (1.8) | 2015-03-09 | 2016-03-08 |  |  |
| [6E2A21BF](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0xE05F71576E2A21BF) | BEA5 E3F6 AF59 7107 0241 4514 E05F 7157 6E2A 21BF | Foreman Release Signing Key (1.9) | 2015-06-26 | 2016-06-25 |  |  |
| [BE67E9DA](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0xC1B2621DBE67E9DA) | 9EFD 673A 649D 77F5 C615 44AC C1B2 621D BE67 E9DA | Foreman Release Signing Key (1.10) | 2015-10-07 | 2016-10-06 |  |  |
| [3494A06D](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x335F3A453494A06D) | 6681 20FA 0528 3FD2 AF60 FC3A 335F 3A45 3494 A06D | Foreman Release Signing Key (1.11) | 2016-02-17 | 2017-02-16 |  |  |
| [7D492D06](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0xB507F6A67D492D06) | 860D D70A 378A 84CE 8D47 C10E B507 F6A6 7D49 2D06 | Foreman Release Signing Key (1.12) | 2016-05-31 | 2017-05-31 |  |  |
| [7DFE6FC2](https://pgp.mit.edu:11371/pks/lookup?op=get&search=0x4EA2F7E77DFE6FC2) | 84E7 90DF FB1D 2EAE C429 C6CD 4EA2 F7E7 7DFE 6FC2 | Foreman Release Signing Key (1.13) | 2016-09-05 | 2017-09-05 |  |  |
| [F06D8950](/static/keys/F06D8950.pub) | AF74 2A91 BF76 6333 E9FF 5EAA BFE5 1511 F06D 8950 | Foreman Release Signing Key (1.14) | 2016-12-06 | 2017-12-06 |  |  |
| [9A8DAAD5](/static/keys/9A8DAAD5.pub) | 6610 7FC8 658F F702 E849 9AC4 17A3 FD24 9A8D AAD5 | Foreman Release Signing Key (1.15) | 2017-03-29 | 2018-03-29 |  |  |
| [5245FE1D](/static/keys/897740E9.pub) | 41EE 8815 A84C ACA4 A583 5055 9C21 BCB2 8977 40E9 | Foreman Release Signing Key (1.16) | 2017-09-21 | 2018-09-21 |  |  |
| [2A8CA27B](/static/keys/2A8CA27B.pub) | B59D DB6C AB83 5E19 14DE 4725 F5F9 54D9 2A8C A27B | Foreman Release Signing Key (1.17) | 2017-11-21 | 2018-11-21 |  |  |
| [57CEF41F](/static/keys/57CEF41F.pub) | 6973 3EEC D1AE 1E23 71FA 04EA 4C3D D0B3 57CE F41F | Foreman Release Signing Key (1.18) | 2018-04-10 | 2019-04-10 |  |  |
| [46020A10694FA479](/static/keys/46020A10694FA479.pub) | CE31 59AA C3EC 09E5 1614 7754 4602 0A10 694F A479 | Foreman Release Signing Key (1.19) | 2018-07-17 | 2019-07-17 |  |  |
| [2EC99767565EA533](/static/keys/5C75B050DD0692EB042B5C822EC99767565EA533.pub) | 5C75 B050 DD06 92EB 042B 5C82 2EC9 9767 565E A533 | Foreman Release Signing Key (1.20) | 2018-10-15 | 2019-10-15 |  |  |
| [107BC89F19D72D85](/static/keys/BCF45390249051C42432F7EF107BC89F19D72D85.pub) | BCF4 5390 2490 51C4 2432 F7EF 107B C89F 19D7 2D85 | Foreman Release Signing Key (1.21) | 2019-01-11 | 2020-01-11 |  |  |
| [9365257981403859B36B3738163F76F3B36987A9](/static/keys/9365257981403859B36B3738163F76F3B36987A9.pub) | 9365 2579 8140 3859 B36B 3738 163F 76F3 B369 87A9 | Foreman Release Signing Key (1.22) | 2019-04-23 | 2020-04-22 |  |  |
| [4674C97BD8C2A3EF63BCB20788BB5C467B5B366A](/static/keys/4674C97BD8C2A3EF63BCB20788BB5C467B5B366A.pub) | 4674 C97B D8C2 A3EF 63BC B207 88BB 5C46 7B5B 366A | Foreman Release Signing Key (1.23) | 2019-07-29 | 2020-07-28 |  |  |
| [D885D3D9B12FA857CDECE3F1B76498E45AA9BCAD](/static/keys/D885D3D9B12FA857CDECE3F1B76498E45AA9BCAD.pub) | D885 D3D9 B12F A857 CDEC E3F1 B764 98E4 5AA9 BCAD | Foreman Release Signing Key (1.24) | 2019-10-29 | 2020-10-28 |  |  |
| [06ABEFE26C1997E0C9E56508926EA0100579BAEE](/static/keys/06ABEFE26C1997E0C9E56508926EA0100579BAEE.pub) | 06AB EFE2 6C19 97E0 C9E5 6508 926E A010 0579 BAEE | Foreman Release Signing Key (2.0) | 2020-02-11 | 2021-02-10 |  |  |
| [0F71D9EAC889A0F2C2CD8190628005A4B6F08CCF](/static/keys/0F71D9EAC889A0F2C2CD8190628005A4B6F08CCF.pub) | 0F71 D9EA C889 A0F2 C2CD 8190 6280 05A4 B6F0 8CCF | Foreman Release Signing Key (2.1) | 2020-05-12 | 2021-05-12 |  |  |
| [939E2FD66DF9A4104869FD182A63B068C7C509FA](/static/keys/939E2FD66DF9A4104869FD182A63B068C7C509FA.pub) | 939E 2FD6 6DF9 A410 4869 FD18 2A63 B068 C7C5 09FA | Foreman Release Signing Key (2.2) | 2020-08-03 | 2021-08-03 |  |  |
| [1CC363863DD64AF30638DB79C101586BE0745924](/static/keys/1CC363863DD64AF30638DB79C101586BE0745924.pub) | 1CC3 6386 3DD6 4AF3 0638 DB79 C101 586B E074 5924 | Foreman Automatic Signing Key (2.3) | 2020-11-02 | 2021-11-02 |  |  |
| [643253F71B82B1BEAF2E1D4FA439BD55AC2AD9F1](/static/keys/643253F71B82B1BEAF2E1D4FA439BD55AC2AD9F1.pub) | 6432 53F7 1B82 B1BE AF2E 1D4F A439 BD55 AC2A D9F1 | Foreman Automatic Signing Key (2.4) | 2021-02-01 | 2022-02-01 |  |  |
| [7EF7E6EA4022F241BB89A149955C283E7522CC3F](/static/keys/7EF7E6EA4022F241BB89A149955C283E7522CC3F.pub) | 7EF7 E6EA 4022 F241 BB89 A149 955C 283E 7522 CC3F | Foreman Automatic Signing Key (2.5) | 2021-04-26 | 2022-04-26 |  |  |
| [C8B9E30B0DBCAB595E98DF5C965467189B776908](/static/keys/C8B9E30B0DBCAB595E98DF5C965467189B776908.pub) | C8B9 E30B 0DBC AB59 5E98 DF5C 9654 6718 9B77 6908 | Foreman Automatic Signing Key (3.0) | 2021-08-02 | 2022-08-02 |  |  |
| [5B7C3E5A735BCB4D615829DC0BDDA991FD7AAC8A](/static/keys/5B7C3E5A735BCB4D615829DC0BDDA991FD7AAC8A.pub) | 5B7C 3E5A 735B CB4D 6158 29DC 0BDD A991 FD7A AC8A | Foreman Automatic Signing Key (2021) | 2021-07-23 | 2023-07-23 |  |  |
| [1CD4BC6A65EB598E53C66E176A3BF4ED1434F5D3](/static/keys/1CD4BC6A65EB598E53C66E176A3BF4ED1434F5D3.pub) | 1CD4 BC6A 65EB 598E 53C6 6E17 6A3B F4ED 1434 F5D3 | Foreman Automatic Signing Key (3.1) | 2021-11-09 | 2022-11-09 |  |  |
| [77F7076DFD4F373EF0F0E9AC8D746ED06DA7EB32](/static/keys/77F7076DFD4F373EF0F0E9AC8D746ED06DA7EB32.pub) | 77F7 076D FD4F 373E F0F0 E9AC 8D74 6ED0 6DA7 EB32 | Foreman Automatic Signing Key (3.2) | 2022-02-07 | 2023-02-07 |  |  |
| [5E77807805888E7F2F31A50E8321CBCA2A6A4BAA](/static/keys/5E77807805888E7F2F31A50E8321CBCA2A6A4BAA.pub) | 5E77 8078 0588 8E7F 2F31 A50E 8321 CBCA 2A6A 4BAA | Foreman Automatic Signing Key (3.3) | 2022-05-03 | 2023-05-03 |  |  |
| [2A6F745AA62DE481567D3AF639D12077F120E13E](/static/keys/2A6F745AA62DE481567D3AF639D12077F120E13E.pub) | 2A6F 745A A62D E481 567D 3AF6 39D1 2077 F120 E13E | Foreman Automatic Signing Key (3.4) | 2022-08-05 | 2023-08-05 |  |  |
| [51B9D1D1BADA3F001C8774046F7F9C618F5CA95B](/static/keys/51B9D1D1BADA3F001C8774046F7F9C618F5CA95B.pub) | 51B9 D1D1 BADA 3F00 1C87 7404 6F7F 9C61 8F5C A95B | Foreman Automatic Signing Key (3.5) | 2022-11-07 | 2023-11-07 |  |  |
| [A21D56E01064415EDC8FC7597803ABC5FED77E93](/static/keys/A21D56E01064415EDC8FC7597803ABC5FED77E93.pub) | A21D 56E0 1064 415E DC8F C759 7803 ABC5 FED7 7E93 | Foreman Automatic Signing Key (3.6) | 2023-02-21 | 2024-02-21 |  |  |
| [DC71C75A8B5438E972C645078FCB3EC0BDCC85AE](/static/keys/DC71C75A8B5438E972C645078FCB3EC0BDCC85AE.pub) | DC71 C75A 8B54 38E9 72C6 4507 8FCB 3EC0 BDCC 85AE | Foreman Automatic Signing Key (3.7) | 2023-05-16 | 2024-05-15 |  |  |
| [79AAD6C6E922580DBC7BF46A0959620CCBE50FBE](/static/keys/79AAD6C6E922580DBC7BF46A0959620CCBE50FBE.pub) | 79AA D6C6 E922 580D BC7B F46A 0959 620C CBE5 0FBE | Foreman Automatic Signing Key (3.8) | 2023-08-22 | 2024-08-21 |  |  |
| [7EC13BEC88DA66692700BB9ACD9851C256641D7B](/static/keys/7EC13BEC88DA66692700BB9ACD9851C256641D7B.pub) | 7EC1 3BEC 88DA 6669 2700 BB9A CD98 51C2 5664 1D7B | Foreman Automatic Signing Key (3.9) | 2023-11-14 | 2024-11-13 |  |  |
| [63B38BE51B2DDDAFF7EF7EC90A8F8D4093DD1D0C](/static/keys/63B38BE51B2DDDAFF7EF7EC90A8F8D4093DD1D0C.pub) | 63B3 8BE5 1B2D DDAF F7EF 7EC9 0A8F 8D40 93DD 1D0C | Foreman Automatic Signing Key (3.10) | 2024-02-20 | 2025-02-19 |  |  |
| [CD41E7A87E353C3A26F891D24E7082461790A6E6](/static/keys/CD41E7A87E353C3A26F891D24E7082461790A6E6.pub) | CD41 E7A8 7E35 3C3A 26F8 91D2 4E70 8246 1790 A6E6 | Foreman Automatic Signing Key (3.11) | 2024-05-20 | 2025-05-19 |  |  |
| [AEB8C6DDA2D3369B95E6AA414C6D3B24F1802F64](/static/keys/AEB8C6DDA2D3369B95E6AA414C6D3B24F1802F64.pub) | AEB8 C6DD A2D3 369B 95E6 AA41 4C6D 3B24 F180 2F64 | Foreman Automatic Signing Key (3.12) | 2024-08-16 | 2025-08-16 |  |  |
| [1204513861C597FE74FA7009738B00A28CBDB523](/static/keys/1204513861C597FE74FA7009738B00A28CBDB523.pub) | 1204 5138 61C5 97FE 74FA 7009 738B 00A2 8CBD B523 | Foreman Automatic Signing Key (3.13) | 2024-11-05 | 2025-11-05 |  |  |

### Key changes in July 2014

In July 2014 after a server was compromised, the existing GPG key (0xE775FF07) was revoked and replaced with a new key (0x1AA043B8) as a precaution. All existing packages were re-signed with the new key and thereafter, new major releases are signed with new per-release keys.

All users with the old key trusted are urged to immediately disable this as follows:

* Debian users must run `sudo apt-key del E775FF07`
* RPM users must run `sudo rpm -e gpg-pubkey-e775ff07-4cda3cf9`

More information is available in [the announcement](https://groups.google.com/forum/#!topic/foreman-announce/BiIT784Mb7Q).

Foreman 3.13.0 has been released! [Follow the quick start to install it.](manuals/3.13/quickstart_guide.html)

Foreman 3.12.1 has been released! [Follow the quick start to install it.](manuals/3.12/quickstart_guide.html)

View our [Privacy Policy](/privacy.html)

This web site is licensed under a [Creative Commons Attribution-ShareAlike 3.0 Unported License](http://creativecommons.org/licenses/by-sa/3.0/deed.en_GB). Source available: [github/theforeman/theforeman.org](https://github.com/theforeman/theforeman.org)

Thanks to [our sponsors](/sponsors.html) for hosting this website and our project services.



=== Content from projects.theforeman.org_982ff643_20250126_025033.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/foreman/search?scope=subprojects):

 Foreman[All Projects](/projects?jump=issues)
#

* [Overview](/projects/foreman)
* [Activity](/projects/foreman/activity)
* [Roadmap](/projects/foreman/roadmap)
* [Issues](/projects/foreman/issues)
* [Wiki](/projects/foreman/wiki)
* [Repository](/projects/foreman/repository)

### Custom queries

* [3.11.5 release DONE](/projects/foreman/issues?query_id=182)
* [3.11.5 release TODO](/projects/foreman/issues?query_id=186)
* [3.12.2 release DONE](/projects/foreman/issues?query_id=181)
* [3.12.2 release TODO](/projects/foreman/issues?query_id=168)
* [3.13.0 release DONE](/projects/foreman/issues?query_id=176)
* [3.13.0 release TODO](/projects/foreman/issues?query_id=167)
* [All bugs by votes](/projects/foreman/issues?query_id=25)
* [All issues closed in the last 3 weeks](/projects/foreman/issues?query_id=102)
* [Easy and Trivial Issues](/projects/foreman/issues?query_id=42)
* [Easy Issues (only)](/projects/foreman/issues?query_id=11)
* [Foreman - new open issues in last 10 days](/projects/foreman/issues?query_id=179)
* [Good first issues - Foreman core](/projects/foreman/issues?query_id=131)
* [high prio open bugs](/projects/foreman/issues?query_id=133)
* [Host registration [open]](/projects/foreman/issues?query_id=158)
* [Mine](/projects/foreman/issues?query_id=128)
* [My issues closed in the last 3 weeks](/projects/foreman/issues?query_id=132)
* [old bugs](/projects/foreman/issues?query_id=159)
* [Open with target version set (aka blockers)](/projects/foreman/issues?query_id=134)
* [registration](/projects/foreman/issues?query_id=173)
* [taken-none](/projects/foreman/issues?query_id=117)
* [Team Atlas untriaged bugs](/projects/foreman/issues?query_id=166)
* [templates](/projects/foreman/issues?query_id=172)
* [Trivial Issues](/projects/foreman/issues?query_id=10)
* [Untriaged and opened in the past two weeks](/projects/foreman/issues?query_id=144)

Actions
Copy link
## Bug #17195

closed
![](https://www.gravatar.com/avatar/e36bafa4e8bbf7ed347fdfa34d647591?rating=PG&size=50&default=identicon "Author: Dominic Cleal")
![](https://www.gravatar.com/avatar/8c1e5e47b81bfe541565ce8e8784ec8a?rating=PG&size=22&default=identicon "Assignee: Tomer Brisker")

### CVE-2016-8634 - Organization/location wizard may run stored XSS through alert

Added by [Dominic Cleal](/users/3536) [about 8 years](/projects/foreman/activity?from=2016-11-03 "11/03/2016 05:58 AM") ago.
Updated [over 6 years](/projects/foreman/activity?from=2018-07-10 "07/10/2018 09:52 AM") ago.

Status:ClosedPriority:NormalAssignee:[Tomer Brisker](/users/5096)Category:SecurityTarget version:[1.14.0](/versions/199)
Difficulty:Triaged:Bugzilla link:Pull request:<https://github.com/theforeman/foreman/pull/3996>Fixed in Releases:Found in Releases:Red Hat JIRA:|  |

---

**Description**

When creating an organization or location, if the name contains HTML then the second step of the wizard (/organizations/id/step2) will render the HTML.

This occurs in the alert box stating that "Assigning hosts to ... will also update ... to include all the resources that the selected hosts are currently using."

This may permit a stored XSS attack if an organization with HTML in its name was added, then a user was directed to the specific URL of the wizard. However there are no direct links back to the wizard, so ordinarily this would only affect the user who created the org/location.

Affects Foreman 1.1 and higher.

Reported by Sanket Jagtap to foreman-security@googlegroups.com.

* [History](/issues/17195?tab=history)
* [Notes](/issues/17195?tab=notes)
* [Property changes](/issues/17195?tab=properties)
* [Associated revisions](/issues/17195?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [Dominic Cleal](/users/3536) [about 8 years](/projects/foreman/activity?from=2016-11-03 "11/03/2016 09:21 AM") ago

* **Subject** changed from *Organization/location wizard may run stored XSS through alert* to *CVE-2016-8634 - Organization/location wizard may run stored XSS through alert*

ActionsCopy link
[#2](#note-2)
#### Updated by [Tomer Brisker](/users/5096) [about 8 years](/projects/foreman/activity?from=2016-11-06 "11/06/2016 07:39 AM") ago

* **Status** changed from *New* to *Assigned*
* **Assignee** set to *Tomer Brisker*

ActionsCopy link
[#3](#note-3)
#### Updated by [The Foreman Bot](/users/5048) [about 8 years](/projects/foreman/activity?from=2016-11-06 "11/06/2016 07:59 AM") ago

* **Status** changed from *Assigned* to *Ready For Testing*
* **Pull request** *https://github.com/theforeman/foreman/pull/3996* added

ActionsCopy link
[#4](#note-4)
#### Updated by Anonymous [about 8 years](/projects/foreman/activity?from=2016-11-08 "11/08/2016 08:01 AM") ago

* **Status** changed from *Ready For Testing* to *Closed*
* **% Done** changed from *0* to *100*

Applied in changeset [5a573456b5ecb3ba0d24e057722704f9afeda8f7](/projects/foreman/repository/foreman/revisions/5a573456b5ecb3ba0d24e057722704f9afeda8f7 "Fixes #17195 - CVE-2016-8634 escape html in alert text The alert helper used to mark the alert t...").

Actions
Copy link

Also available in: [Atom](/issues/17195.atom)
[PDF](/issues/17195.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from bugzilla.redhat.com_d89e910d_20250124_183741.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2016-7078)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2016-7078)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2016-7078)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1386244

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1386244**](show_bug.cgi?id=1386244)
(CVE-2016-7078)
- [CVE-2016-7078](https://access.redhat.com/security/cve/CVE-2016-7078) foreman: Information leak through organizations and locations feature

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-7078 foreman: Information leak through organizations and locations f...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-7078 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1391135](show_bug.cgi?id=1391135) [1391136](show_bug.cgi?id=1391136) [1399322](show_bug.cgi?id=1399322) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1385778](show_bug.cgi?id=1385778) [1432306](show_bug.cgi?id=1432306) | | TreeView+ | [depends on](buglist.cgi?bug_id=1386244&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1386244&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-10-18 13:28 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-10-21 00:55 UTC ([History](show_activity.cgi?id=1386244)) | | [CC List:](page.cgi?id=fields.html#cclist) | 23 users (show)  apevec bkearney cbillett ceph-eng-bugs chrisw cvsbot-xmlrpc jjoyce jmatthew jschluet lhh lpeer markmc mburns mmccune ohadlevy rbryant satellite6-bugs sclewis sisharma srevivo tdecacqu tlestach tsanders | | Fixed In Version: | foreman 1.15.0 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-10-21 00:55:30 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1386244#c0)  Andrej Nemec    2016-10-18 13:28:45 UTC  ```  When a user is assigned _no_ organizations/locations, they are able to view all resources instead of none (mirroring an administrator's view). The user's actions are still limited by their assigned permissions, e.g. to control viewing, editing and deletion.  Upstream bug:  <http://projects.theforeman.org/issues/16982>   ```  [Comment 1](show_bug.cgi?id=1386244#c1)  Andrej Nemec    2016-10-18 13:29:08 UTC  ``` Acknowledgments:  Name: the Foreman project Upstream: Daniel Lobato Garcia   ```  [Comment 4](show_bug.cgi?id=1386244#c4)  Andrej Nemec    2017-02-22 15:07:53 UTC  ``` Upstream patch:  <https://github.com/theforeman/foreman/commit/5f606e11cf39719bf62f8b1f3396861b32387905>  References:  <http://seclists.org/oss-sec/2017/q1/470>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1386244&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_2c85a96b_20250126_025034.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from projects.theforeman.org_37e2eea9_20250124_183744.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/foreman/search?scope=subprojects):

 Foreman[All Projects](/projects?jump=issues)
#

* [Overview](/projects/foreman)
* [Activity](/projects/foreman/activity)
* [Roadmap](/projects/foreman/roadmap)
* [Issues](/projects/foreman/issues)
* [Wiki](/projects/foreman/wiki)
* [Repository](/projects/foreman/repository)

### Custom queries

* [3.11.5 release DONE](/projects/foreman/issues?query_id=182)
* [3.11.5 release TODO](/projects/foreman/issues?query_id=186)
* [3.12.2 release DONE](/projects/foreman/issues?query_id=181)
* [3.12.2 release TODO](/projects/foreman/issues?query_id=168)
* [3.13.0 release DONE](/projects/foreman/issues?query_id=176)
* [3.13.0 release TODO](/projects/foreman/issues?query_id=167)
* [All bugs by votes](/projects/foreman/issues?query_id=25)
* [All issues closed in the last 3 weeks](/projects/foreman/issues?query_id=102)
* [Easy and Trivial Issues](/projects/foreman/issues?query_id=42)
* [Easy Issues (only)](/projects/foreman/issues?query_id=11)
* [Foreman - new open issues in last 10 days](/projects/foreman/issues?query_id=179)
* [Good first issues - Foreman core](/projects/foreman/issues?query_id=131)
* [high prio open bugs](/projects/foreman/issues?query_id=133)
* [Host registration [open]](/projects/foreman/issues?query_id=158)
* [Mine](/projects/foreman/issues?query_id=128)
* [My issues closed in the last 3 weeks](/projects/foreman/issues?query_id=132)
* [old bugs](/projects/foreman/issues?query_id=159)
* [Open with target version set (aka blockers)](/projects/foreman/issues?query_id=134)
* [registration](/projects/foreman/issues?query_id=173)
* [taken-none](/projects/foreman/issues?query_id=117)
* [Team Atlas untriaged bugs](/projects/foreman/issues?query_id=166)
* [templates](/projects/foreman/issues?query_id=172)
* [Trivial Issues](/projects/foreman/issues?query_id=10)
* [Untriaged and opened in the past two weeks](/projects/foreman/issues?query_id=144)

Actions
Copy link
## Bug #16982

closed
![](https://www.gravatar.com/avatar/fe4dc5ea02ac73b9981bcc549a7a288c?rating=PG&size=50&default=identicon "Author: Daniel Lobato Garcia")
![](https://www.gravatar.com/avatar/fe4dc5ea02ac73b9981bcc549a7a288c?rating=PG&size=22&default=identicon "Assignee: Daniel Lobato Garcia")

### CVE-2016-7078 - User with no organizations or locations can see all resources

Added by [Daniel Lobato Garcia](/users/3517) [over 8 years](/projects/foreman/activity?from=2016-10-18 "10/18/2016 06:23 AM") ago.
Updated [over 6 years](/projects/foreman/activity?from=2018-07-10 "07/10/2018 09:54 AM") ago.

Status:ClosedPriority:NormalAssignee:[Daniel Lobato Garcia](/users/3517)Category:SecurityTarget version:[1.15.0](/versions/36)
Difficulty:Triaged:Bugzilla link:Pull request:<https://github.com/theforeman/foreman/pull/3954>, <https://github.com/theforeman/foreman/pull/3961>, <https://github.com/theforeman/foreman/pull/4172>, <https://github.com/theforeman/foreman/pull/4327>, <https://github.com/theforeman/foreman/pull/4328>, <https://github.com/theforeman/foreman/pull/4329>Fixed in Releases:Found in Releases:Red Hat JIRA:|  |

---

**Description**

The default scope for hosts does not restrict properly by taxonomies. Given this use case:

1. User has role 'Edit host'
2. User has no organization or location
3. User logs in, goes to /hosts and can do anything it's permissions allow to. The list of hosts is unrestricted and shows hosts in any location or organization.
4. If the user gets a taxonomy assigned to it, then the restriction works normally.

This should work so that:

```
- Users without taxonomies, when set to 'any context' cannot see anything
 - Users with taxonomies, when set to 'any context' can see everything within all of their taxonomies context.
 - Admins set to 'any context' can see everything - regardless of whether it has a taxonomy or not.
 - Users or admins set to some organization/location scope can only see stuff within scope.
```

Pending CVE number.

---

**Related issues**
[7](/issues?issue_id=18662%2C18686%2C19409%2C20017%2C20321%2C20515%2C17266&set_filter=true&status_id=%2A) (0 open — [7 closed](/issues?issue_id=18662%2C18686%2C19409%2C20017%2C20321%2C20515%2C17266&set_filter=true&status_id=c))

|  | Related to Foreman - [Bug #18662](/issues/18662): Ensure Taxonomix empty default scope isn't overridden by association scopes | Closed | [Dominic Cleal](/users/3536) | 02/24/2017 |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | Related to Discovery - [Bug #18686](/issues/18686): Fix broken tests after taxonomy scope change | Closed | [Lukas Zapletal](/users/718) | 02/27/2017 |  |  | Actions |
|  | Related to Discovery - [Bug #19409](/issues/19409): Auto provision does not work after taxonomy fix | Closed | [Ohad Levy](/users/3) | 04/27/2017 |  |  | Actions |
|  | Related to Foreman - [Bug #20017](/issues/20017): Mail notifications not being sent | Closed | [Marek Hulán](/users/3830) | 06/14/2017 |  |  | Actions |
|  | Related to Foreman - [Bug #20321](/issues/20321): Cannot use foreman-rake import:puppet\_classes on Foreman 1.15.1/Katello 3.4.2 | Closed | [Marek Hulán](/users/3830) | 07/17/2017 |  |  | Actions |
|  | Related to Foreman - [Bug #20515](/issues/20515): User searching by login in code does not find the user because of missing unscoped | Closed | [Marek Hulán](/users/3830) | 08/07/2017 |  |  | Actions |
|  | Copied to Katello - [Bug #17266](/issues/17266): Fix tests that depend on CVE 2016-7078 | Closed | [Daniel Lobato Garcia](/users/3517) | 10/18/2016 |  |  | Actions |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/16982?tab=history)
* [Notes](/issues/16982?tab=notes)
* [Property changes](/issues/16982?tab=properties)
* [Associated revisions](/issues/16982?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [Dominic Cleal](/users/3536) [over 8 years](/projects/foreman/activity?from=2016-10-18 "10/18/2016 10:05 AM") ago

* **Subject** changed from *User with no taxonomies can see all hosts* to *CVE-2016-7078 - User with no organizations or locations can see all hosts*
* **Status** changed from *New* to *Assigned*

ActionsCopy link
[#2](#note-2)
#### Updated by [Dominic Cleal](/users/3536) [over 8 years](/projects/foreman/activity?from=2016-10-18 "10/18/2016 10:09 AM") ago

* **Subject** changed from *CVE-2016-7078 - User with no organizations or locations can see all hosts* to *CVE-2016-7078 - User with no organizations or locations can see all resources*

Applies to both hosts and objects linked to multiple orgs/locs (via Taxonomix).

ActionsCopy link
[#3](#note-3)
#### Updated by [The Foreman Bot](/users/5048) [over 8 years](/projects/foreman/activity?from=2016-10-19 "10/19/2016 05:34 AM") ago

* **Status** changed from *Assigned* to *Ready For Testing*
* **Pull request** *https://github.com/theforeman/foreman/pull/3954* added

ActionsCopy link
[#4](#note-4)
#### Updated by [The Foreman Bot](/users/5048) [over 8 years](/projects/foreman/activity?from=2016-10-21 "10/21/2016 03:25 PM") ago

* **Pull request** *https://github.com/theforeman/foreman/pull/3961* added

ActionsCopy link
[#5](#note-5)
#### Updated by [Daniel Lobato Garcia](/users/3517) [about 8 years](/projects/foreman/activity?from=2016-11-04 "11/04/2016 12:46 PM") ago

* **Target version** set to *1.5.2*

ActionsCopy link
[#6](#note-6)
#### Updated by [Daniel Lobato Garcia](/users/3517) [about 8 years](/projects/foreman/activity?from=2016-11-08 "11/08/2016 04:48 AM") ago

* **Copied to** *[Bug #17266](/issues/17266): Fix tests that depend on CVE 2016-7078* added

ActionsCopy link
[#7](#note-7)
#### Updated by [Daniel Lobato Garcia](/users/3517) [about 8 years](/projects/foreman/activity?from=2016-11-15 "11/15/2016 10:03 AM") ago

* **Target version** changed from *1.5.2* to *1.4.3*

ActionsCopy link
[#8](#note-8)
#### Updated by [The Foreman Bot](/users/5048) [about 8 years](/projects/foreman/activity?from=2017-01-10 "01/10/2017 03:38 PM") ago

* **Pull request** *https://github.com/theforeman/foreman/pull/4172* added

ActionsCopy link
[#9](#note-9)
#### Updated by [Daniel Lobato Garcia](/users/3517) [about 8 years](/projects/foreman/activity?from=2017-01-24 "01/24/2017 09:57 AM") ago

* **Target version** changed from *1.4.3* to *169*

ActionsCopy link
[#10](#note-10)
#### Updated by [Brad Buckingham](/users/4218) [almost 8 years](/projects/foreman/activity?from=2017-02-18 "02/18/2017 10:23 AM") ago

* **Target version** deleted (~~*169*~~)

ActionsCopy link
[#11](#note-11)
#### Updated by [Daniel Lobato Garcia](/users/3517) [almost 8 years](/projects/foreman/activity?from=2017-02-21 "02/21/2017 09:52 AM") ago

* **Target version** set to *1.11.0*

ActionsCopy link
[#12](#note-12)
#### Updated by Anonymous [almost 8 years](/projects/foreman/activity?from=2017-02-22 "02/22/2017 04:01 AM") ago

* **Status** changed from *Ready For Testing* to *Closed*
* **% Done** changed from *0* to *100*

Applied in changeset [5f606e11cf39719bf62f8b1f3396861b32387905](/projects/foreman/repository/foreman/revisions/5f606e11cf39719bf62f8b1f3396861b32387905 "Fixes #16982 - Scope properly when no taxonomies are set The default scope for hosts and other o...").

ActionsCopy link
[#13](#note-13)
#### Updated by [Dominic Cleal](/users/3536) [almost 8 years](/projects/foreman/activity?from=2017-02-22 "02/22/2017 06:49 AM") ago

* **Translation missing: en.field\_release** set to *209*

ActionsCopy link
[#14](#note-14)
#### Updated by [The Foreman Bot](/users/5048) [almost 8 years](/projects/foreman/activity?from=2017-02-24 "02/24/2017 07:13 AM") ago

* **Pull request** *https://github.com/theforeman/foreman/pull/4327* added

ActionsCopy link
[#15](#note-15)
#### Updated by [The Foreman Bot](/users/5048) [almost 8 years](/projects/foreman/activity?from=2017-02-24 "02/24/2017 07:14 AM") ago

* **Pull request** *https://github.com/theforeman/foreman/pull/4328* added

ActionsCopy link
[#16](#note-16)
#### Updated by [The Foreman Bot](/users/5048) [almost 8 years](/projects/foreman/activity?from=2017-02-24 "02/24/2017 07:21 AM") ago

* **Pull request** *https://github.com/theforeman/foreman/pull/4329* added

ActionsCopy link
[#17](#note-17)
#### Updated by [Dominic Cleal](/users/3536) [almost 8 years](/projects/foreman/activity?from=2017-02-24 "02/24/2017 07:46 AM") ago

* **Related to** *[Bug #18662](/issues/18662): Ensure Taxonomix empty default scope isn't overridden by association scopes* added

ActionsCopy link
[#18](#note-18)
#### Updated by [Lukas Zapletal](/users/718) [almost 8 years](/projects/foreman/activity?from=2017-02-27 "02/27/2017 02:47 AM") ago

* **Related to** *[Bug #18686](/issues/18686): Fix broken tests after taxonomy scope change* added

ActionsCopy link
[#19](#note-19)
#### Updated by [Lukas Zapletal](/users/718) [over 7 years](/projects/foreman/activity?from=2017-04-27 "04/27/2017 05:04 AM") ago

* **Related to** *[Bug #19313](/issues/19313): Auto-provisioning does not orchestrate TFTP* added

ActionsCopy link
[#20](#note-20)
#### Updated by [Ohad Levy](/users/3) [over 7 years](/projects/foreman/activity?from=2017-04-27 "04/27/2017 06:27 AM") ago

* **Related to** *[Bug #19409](/issues/19409): Auto provision does not work after taxonomy fix* added

ActionsCopy link
[#21](#note-21)
#### Updated by [Lukas Zapletal](/users/718) [over 7 years](/projects/foreman/activity?from=2017-05-03 "05/03/2017 04:47 AM") ago

* **Related to** deleted (*[Bug #19313](/issues/19313): Auto-provisioning does not orchestrate TFTP*)

ActionsCopy link
[#22](#note-22)
#### Updated by [Marek Hulán](/users/3830) [over 7 years](/projects/foreman/activity?from=2017-06-14 "06/14/2017 07:23 AM") ago

* **Related to** *[Bug #20017](/issues/20017): Mail notifications not being sent* added

ActionsCopy link
[#23](#note-23)
#### Updated by [Marek Hulán](/users/3830) [over 7 years](/projects/foreman/activity?from=2017-07-18 "07/18/2017 08:57 AM") ago

* **Related to** *[Bug #20321](/issues/20321): Cannot use foreman-rake import:puppet\_classes on Foreman 1.15.1/Katello 3.4.2* added

ActionsCopy link
[#24](#note-24)
#### Updated by [Marek Hulán](/users/3830) [over 7 years](/projects/foreman/activity?from=2017-08-07 "08/07/2017 09:33 AM") ago

* **Related to** *[Bug #20515](/issues/20515): User searching by login in code does not find the user because of missing unscoped* added

Actions
Copy link

Also available in: [Atom](/issues/16982.atom)
[PDF](/issues/16982.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from nmap.org_9ba698e9_20250126_025033.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_604e9e0c_20250124_183744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftheforeman%2Fforeman%2Fcommit%2F5f606e11cf39719bf62f8b1f3396861b32387905)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftheforeman%2Fforeman%2Fcommit%2F5f606e11cf39719bf62f8b1f3396861b32387905)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=theforeman%2Fforeman)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[theforeman](/theforeman)
/
**[foreman](/theforeman/foreman)**
Public

* [Notifications](/login?return_to=%2Ftheforeman%2Fforeman) You must be signed in to change notification settings
* [Fork
  994](/login?return_to=%2Ftheforeman%2Fforeman)
* [Star
   2.6k](/login?return_to=%2Ftheforeman%2Fforeman)

* [Code](/theforeman/foreman)
* [Pull requests
  75](/theforeman/foreman/pulls)
* [Actions](/theforeman/foreman/actions)
* [Security](/theforeman/foreman/security)
* [Insights](/theforeman/foreman/pulse)

Additional navigation options

* [Code](/theforeman/foreman)
* [Pull requests](/theforeman/foreman/pulls)
* [Actions](/theforeman/foreman/actions)
* [Security](/theforeman/foreman/security)
* [Insights](/theforeman/foreman/pulse)

## Commit

[Permalink](/theforeman/foreman/commit/5f606e11cf39719bf62f8b1f3396861b32387905)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixes #16982 - Scope properly when no taxonomies are set

[Browse files](/theforeman/foreman/tree/5f606e11cf39719bf62f8b1f3396861b32387905)
Browse the repository at this point in the history

```
The default scope for hosts and other objects did not restrict
properly by taxonomies. An user without organizations or
locations, could do anything it's permissions allow to.
The list of hosts was unrestricted and showed hosts in
any location or organization.

This is fixed to work so that:

Users without taxonomies, when set to 'any context' cannot see
anything (at all)

Users with taxonomies, when set to 'any context' can see
everything within all of their taxonomies context (including
children taxonomies).

Admins set to 'any context' can see everything - regardless
of whether it has a taxonomy or not.

Users or admins set to some organization/location scope
can only see stuff within scope.
```

* Loading branch information

[![@dLobatog](https://avatars.githubusercontent.com/u/598891?s=40&v=4)](/dLobatog) [![@tbrisker](https://avatars.githubusercontent.com/u/1540531?s=40&v=4)](/tbrisker)

[dLobatog](/theforeman/foreman/commits?author=dLobatog "View all commits by dLobatog")
authored and
[tbrisker](/theforeman/foreman/commits?author=tbrisker "View all commits by tbrisker")
committed
Feb 22, 2017

1 parent
[c7dbc30](/theforeman/foreman/commit/c7dbc30226df8dbd4b10e6706280bf520968b831)

commit 5f606e1

 Show file tree

 Hide file tree

Showing
**86 changed files**
with
**802 additions**
and
**557 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* app

  + controllers

    - concerns/foreman/controller

      * app/controllers/concerns/foreman/controller/smart\_proxy\_auth.rb
        [smart\_proxy\_auth.rb](#diff-ba913328a842eb6b3b2706496e588a92f79378d23d0a631753ee552f2951e681)
    - app/controllers/users\_controller.rb
      [users\_controller.rb](#diff-cfdccd0a9d5df5a43aaad2a35d36ebbe187c52ad5fdc9846fa189d04537adb6e)
  + models

    - concerns

      * app/models/concerns/taxonomix.rb
        [taxonomix.rb](#diff-04a08a233b05061e3f0b5ae7a3f95e3e9492257b99c035927d328b296f918f40)
    - host

      * app/models/host/base.rb
        [base.rb](#diff-095d7b54ca912bf04ebe822da756f888d0695a228be820b9762341a136ee1691)
  + services

    - sso

      * app/services/sso/base.rb
        [base.rb](#diff-3c6e9412c657a2cadbe7407bdd257cf1af51bad03ebc4e89aca74183a8283497)
      * app/services/sso/oauth.rb
        [oauth.rb](#diff-30d0b8b6ea76e3c3dab7614cc1d733b24d6880efd7326acfb655898ce1c8a52f)
    - app/services/tax\_host.rb
      [tax\_host.rb](#diff-4bff19d42046258a32b954968dc49855552229f73923d35ba7131d945fdbdb96)
* db

  + migrate

    - db/migrate/20130908100439\_delete\_orphaned\_records.rb
      [20130908100439\_delete\_orphaned\_records.rb](#diff-83c21d16706dc627a14489e7ef5e3b0867d6ade212a089ae227431cfbc272e13)
  + seeds.d

    - db/seeds.d/07-provisioning\_templates.rb
      [07-provisioning\_templates.rb](#diff-dcc4593cd29c6863a09a82bae6f39e951a92a4ab99b2ad065beb465b0116d417)
    - db/seeds.d/08-partition\_tables.rb
      [08-partition\_tables.rb](#diff-214fc5dd615d88d5db54bf0c003d8366df8aba0360e07e5d0e613cb1ae857cf4)
    - db/seeds.d/10-installation\_media.rb
      [10-installation\_media.rb](#diff-f50ec4a2a18dc270ccbf9a1129875145c408a7572a8c8945f1be10936627db72)
* test

  + test/active\_support\_test\_case\_helper.rb
    [active\_support\_test\_case\_helper.rb](#diff-93ce8bfe62062eb45427e17d40cb5f4bc2c597547ec8ea2b874c1f03a4785fba)
  + controllers

    - api

      * v1

        + test/controllers/api/v1/auth\_source\_ldaps\_controller\_test.rb
          [auth\_source\_ldaps\_controller\_test.rb](#diff-4852f217712874761d374b2905260c3b183c18bf5381901c51016081306252ed)
        + test/controllers/api/v1/compute\_resources\_controller\_test.rb
          [compute\_resources\_controller\_test.rb](#diff-bca2e82f76d51127b37ab480a2cf10c3d57040ff4ae213813d733df97fd32996)
        + test/controllers/api/v1/config\_templates\_controller\_test.rb
          [config\_templates\_controller\_test.rb](#diff-35593b737536982b21da020bf9ada7f9cfc5b574dabd24e81caf8d064d530424)
        + test/controllers/api/v1/domains\_controller\_test.rb
          [domains\_controller\_test.rb](#diff-eff570169f1f21413e005908bf7dc2b6fc7276cfa20e5429627795166acdb3d5)
        + test/controllers/api/v1/environments\_controller\_test.rb
          [environments\_controller\_test.rb](#diff-0739e9df713540fe00ddf5d32d2201ece81cdbfa7b9be4c62083d757afd81b01)
        + test/controllers/api/v1/hostgroups\_controller\_test.rb
          [hostgroups\_controller\_test.rb](#diff-618566df3a4e7b8f9bfe81fca37fb4b019d699a9bcd0393d13e8738b6303c8de)
        + test/controllers/api/v1/media\_controller\_test.rb
          [media\_controller\_test.rb](#diff-f43d1f01d925f6ddb3c9862a22da7530b899c7fd1ff09be96aaea7f9d7c176b5)
        + test/controllers/api/v1/ptables\_controller\_test.rb
          [ptables\_controller\_test.rb](#diff-5489c8545c7671b25e0bddc083f34427d99457bc13793f3dff030fa72ec9aef9)
        + test/controllers/api/v1/smart\_proxies\_controller\_test.rb
          [smart\_proxies\_controller\_test.rb](#diff-9041f59ac38f14057c9867fcd8d7488f309f41a1a2daeee4a2d5fa89571e113f)
        + test/controllers/api/v1/subnets\_controller\_test.rb
          [subnets\_controller\_test.rb](#diff-7ee50a79009ad06e313d35b210827f73a7ad00bd67a68c207cc29e3e18056fdd)
        + test/controllers/api/v1/users\_controller\_test.rb
          [users\_controller\_test.rb](#diff-caa0282cf85ea0d01ae0b74b61fa30550616ab6949a4a084b14db3b30a679cb2)
      * v2

        + test/controllers/api/v2/auth\_source\_ldaps\_controller\_test.rb
          [auth\_source\_ldaps\_controller\_test.rb](#diff-c34517b31b433f315fa873c12ebdc2b9db37c2a09d0e61827914277b71b37510)
        + test/controllers/api/v2/compute\_resources\_controller\_test.rb
          [compute\_resources\_controller\_test.rb](#diff-99cd9f36e45e84c887232c27897f3dd7ffaa4c097fc3847cd6a7f1b5b316fa09)
        + test/controllers/api/v2/config\_reports\_controller\_test.rb
          [config\_reports\_controller\_test.rb](#diff-f5f8cdb7d2c58b35be7c8465d3f02ab9c7bb1fb7af1349806d692f0896c41680)
        + test/controllers/api/v2/config\_templates\_controller\_test.rb
          [config\_templates\_controller\_test.rb](#diff-014e873074a97eb7380b71635d776ee982af6019070ac624ba7c130a39629eac)
        + test/controllers/api/v2/domains\_controller\_test.rb
          [domains\_controller\_test.rb](#diff-25b57c945e65bc8003ad18b37c2da3d9b6fb7e7713fa366600de814c9cf2ddea)
        + test/controllers/api/v2/environments\_controller\_test.rb
          [environments\_controller\_test.rb](#diff-42394de9305d11e97a197ff70106acea72186ffb79766c63a46f040ef317cead)
        + test/controllers/api/v2/hostgroups\_controller\_test.rb
          [hostgroups\_controller\_test.rb](#diff-23add80c8f997ab0ffb16763cb040df1b5f8a2ce71160adfb53e72bd1a8b8a24)
        + test/controllers/api/v2/hosts\_controller\_test.rb
          [hosts\_controller\_test.rb](#diff-bc967cdac18b83d602148e38e4f07168090b95f9b1fe8e5eb59c9f0ba457d2dd)
        + test/controllers/api/v2/locations\_controller\_test.rb
          [locations\_controller\_test.rb](#diff-a0eda61af082b22733e59fbbfbcf29e8ea3a49c4f2d981aa949072781333330d)
        + test/controllers/api/v2/media\_controller\_test.rb
          [media\_controller\_test.rb](#diff-8d50036c7fcf4c90c945ea58ac23b4c5d59c7a6792d0bec3477896022bde031a)
        + test/controllers/api/v2/parameters\_controller\_test.rb
          [parameters\_controller\_test.rb](#diff-7a8f99acb7dfed0d34388a64bb76e624f57f83928c0802c6c52ee5e82dc748d8)
        + test/controllers/api/v2/provisioning\_templates\_controller\_test.rb
          [provisioning\_templates\_controller\_test.rb](#diff-d81457700a3410567e25f37c4bf353c51d0fdf84d5bff7eef97c3329f19e7283)
        + test/controllers/api/v2/ptables\_controller\_test.rb
          [ptables\_controller\_test.rb](#diff-233a4a77e41fe1520cde5009c0fe0d050979e57f7b57d65faccf61ecd8fa1147)
        + test/controllers/api/v2/realms\_controller\_test.rb
          [realms\_controller\_test.rb](#diff-d5b7d3bc9c889242748b2732ae46227a7afc5f3da846de047e595a3eba53aa54)
        + test/controllers/api/v2/reports\_controller\_test.rb
          [reports\_controller\_test.rb](#diff-4c442a5dbd5cb9f9bd23e5acf0a4d0616f734eb767b7de3d872c627991b9d2f0)
        + test/controllers/api/v2/smart\_proxies\_controller\_test.rb
          [smart\_proxies\_controller\_test.rb](#diff-ed5349d6634f6654d049c485b8dfe7174e8e61b3efac8d393e6736b616052589)
        + test/controllers/api/v2/subnets\_controller\_test.rb
          [subnets\_controller\_test.rb](#diff-b868196dab72c5ba5be874ff4d2352f09324671a979d4e96c83b0ea77cfc72f1)
        + test/controllers/api/v2/users\_controller\_test.rb
          [users\_controller\_test.rb](#diff-8aa4bd3b5f42f80c1bdd679f8768140f7b32df6583c8f3da14afbcfc4de7cb9b)
    - test/controllers/application\_controller\_subclass\_test.rb
      [application\_controller\_subclass\_test.rb](#diff-31fac10a28d3d75d53a81014e9e8c5ea5b10ef0ec0e3ccf17180cd7d3652bfa5)
    - test/controllers/auth\_source\_ldaps\_controller\_test.rb
      [auth\_source\_ldaps\_controller\_test.rb](#diff-af46afd0e498ea04570d8b4142603c9472e5536270c8f008f1d82f88540e024b)
    - test/controllers/compute\_resources\_controller\_test.rb
      [compute\_resources\_controller\_test.rb](#diff-1880e3f14251edd8bbfd9a6521e394387f8817e175bf6c73d188ab2a9c7f8230)
    - test/controllers/compute\_resources\_vms\_controller\_test.rb
      [compute\_resources\_vms\_controller\_test.rb](#diff-27ba23a0f3812ac7f4d5ca55bb12c950c6597f10652056fadc1e121a236871a2)
    - test/controllers/domains\_controller\_test.rb
      [domains\_controller\_test.rb](#diff-4ec32051eb7327130206d901a67356a240d2a75428fc2f5a16ed6bd345be2c87)
    - test/controllers/environments\_controller\_test.rb
      [environments\_controller\_test.rb](#diff-1527e39e068c622d2bc7f2340b1161abbdd2ec5dbf93a076972181d7a624229a)
    - test/controllers/fact\_values\_controller\_test.rb
      [fact\_values\_controller\_test.rb](#diff-2925c1325c2826140bdfcbca8da44b6b5a065eb397ecba38aacfd0b62ca96b08)
    - test/controllers/hostgroups\_controller\_test.rb
      [hostgroups\_controller\_test.rb](#diff-73dd8fd7098b1459b83d4d91d012eeb8df462ad6bbc5db2c1aab8076ac70d548)
    - test/controllers/hosts\_controller\_test.rb
      [hosts\_controller\_test.rb](#diff-7980cd376ef1a4aed018ab7af0489eeecce91e9d00babf61f3c1b497dfaeec5f)
    - test/controllers/images\_controller\_test.rb
      [images\_controller\_test.rb](#diff-5bfb8f4d6bd8a0b860eeececd0f6e012d71bab2645b34b7b0c075b261ee02a80)
    - test/controllers/locations\_controller\_test.rb
      [locations\_controller\_test.rb](#diff-30bc94a4d3750c381d3f187d929fb521a20f6112a346083c61b95927161896cf)
    - test/controllers/media\_controller\_test.rb
      [media\_controller\_test.rb](#diff-5973ab559925cb327f065ee8b89ab64d70fcf2cae0f18b6a67a98976753a487d)
    - test/controllers/organizations\_controller\_test.rb
      [organizations\_controller\_test.rb](#diff-1585f86d6148165ea9cd780158852561a4dfc77cd4247470cf2fff95bb07fd22)
    - test/controllers/provisioning\_templates\_controller\_test.rb
      [provisioning\_templates\_controller\_test.rb](#diff-eb420c69fd4b7cf4f25cf774ef4ef01250e3976728d71b14e0dd9c006fa9c5f1)
    - test/controllers/puppetclasses\_controller\_test.rb
      [puppetclasses\_controller\_test.rb](#diff-7b8d0cb305f458fe789cc26209896431cda3e9d4bf45d6867b5bda0aff33ea37)
    - test/controllers/realms\_controller\_test.rb
      [realms\_controller\_test.rb](#diff-fcf71564dbd30848ef2d136a122499f0092db50c50645bd075c8b4f5cd64ff4a)
    - test/controllers/smart\_proxies\_controller\_test.rb
      [smart\_proxies\_controller\_test.rb](#diff-d47878fe73b96c6458d01cf3aef1466e2462c2627eb551fbdabba6a242d2d449)
    - test/controllers/subnets\_controller\_test.rb
      [subnets\_controller\_test.rb](#diff-6c618c3dd6eba0dbd0e22854a6a3cae93a0027072a2a54822d6e828b13700ed6)
    - test/controllers/unattended\_controller\_test.rb
      [unattended\_controller\_test.rb](#diff-d31c4a8cb73486d699863f458520c8e03a102c27dc45ac86df94e41fdac2f8b9)
    - test/controllers/users\_controller\_test.rb
      [users\_controller\_test.rb](#diff-2719d3c650da3c587f727ca3c105e6bc93a7113f85717bb15983543cf4f85ae5)
    - test/controllers/variable\_lookup\_keys\_controller\_test.rb
      [variable\_lookup\_keys\_controller\_test.rb](#diff-e49d6d999382096f8ae0259675539468666cae4313fc1ef78a568940c18dc233)
  + factories

    - test/factories/domain.rb
      [domain.rb](#diff-67c576ef2a4b54d35c219fdbc9af7ebbdbecf4eceed4da2861045da31b385840)
    - test/factories/host\_related.rb
      [host\_related.rb](#diff-53e4187d889cb887cf7d89a4f2f6678ef795fab53351cf1b1be563dfde0ad8e0)
    - test/factories/smart\_proxy.rb
      [smart\_proxy.rb](#diff-ab723796910016b12f0d8343c22559f9a49b7c27625a447291c5df6434643a11)
    - test/factories/subnet.rb
      [subnet.rb](#diff-7ad9dee78ab73d302b029df7777e446dac500be38c62b8d434c7cfa550d66195)
    - test/factories/user\_related.rb
      [user\_related.rb](#diff-18205eb017239f05ff6759f243ebd840d1113850f4f3f76024ca6f98e8872f7e)
  + fixtures

    - test/fixtures/taxable\_taxonomies.yml
      [taxable\_taxonomies.yml](#diff-952d843b5c36d653b9503522b473568c4c50ae5641df8fc003399c83dadd85f4)
  + integration

    - test/integration/location\_test.rb
      [location\_test.rb](#diff-e8deb857006ce44d86b65b5f1b3b70b1c1b3261c3ac26a6bf64af3785a7388b1)
    - test/integration/organization\_test.rb
      [organization\_test.rb](#diff-aed2c11c9d3474267ada3a091b69d2f8c4012d5e292d53da4d855114c6be12d7)
  + models

    - concerns

      * test/models/concerns/api\_taxonomy\_scope\_test.rb
        [api\_taxonomy\_scope\_test.rb](#diff-34cffede006b596fba5ddf431c0bf02e3d97cbf7578b96c1a526b6e2acccf1d1)
    - test/models/fact\_value\_test.rb
      [fact\_value\_test.rb](#diff-382759c53daeae7435e4f5c49fe688c3016e5789b38418497dbff67df944322a)
    - test/models/host\_test.rb
      [host\_test.rb](#diff-7759932460b771c945dc6f4c7838e25219eb21c7b5a4195ec60840ffd3271097)
    - test/models/nic\_test.rb
      [nic\_test.rb](#diff-9b8467aaabc8422ca6ab5455e6f7b87dd772892ac7b3aa024e22ebfdbb46713a)
    - test/models/report\_test.rb
      [report\_test.rb](#diff-8a327ede5b93ff905ead5dc6d960dc90bad6ffefd0dd7cd768921f950f952ac7)
    - shared

      * test/models/shared/taxonomies\_base\_test.rb
        [taxonomies\_base\_test.rb](#diff-71008dfab0c510c71d820c4fd140af3d9189ff793b44d8ee58955408ea2af3bf)
    - subnet

      * test/models/subnet/ipv6\_test.rb
        [ipv6\_test.rb](#diff-6ceacfaa868cc9deb65c761c23e66f36ea39f10d1616bdaf2a6d50157c0212ed)
    - test/models/subnet\_test.rb
      [subnet\_test.rb](#diff-4ec1d9d583726f1a6f4588fe3cef649bbfeb1ce5d9c4737b7568b8cbb202679c)
    - test/models/taxonomix\_test.rb
      [taxonomix\_test.rb](#diff-7f133b27cc271a7c4d1079bc6d0c7c8317c9a0db28a4c271e887e6ada7468d7f)
    - test/models/taxonomy\_test.rb
      [taxonomy\_test.rb](#diff-e983562f96cd4a701a70166c2184716a510c454f654da8d54624596ba26c0e0a)
    - test/models/user\_test.rb
      [user\_test.rb](#diff-91bef9fda3c55514e23a4a8edba948f68aad59b57951adcff0b11e9ea9159854)
  + test/test\_helper.rb
    [test\_helper.rb](#diff-ba37813ca277c227a74a372479b7b05b7f3ff085d890ab708f80d62573efdb7a)
  + unit

    - test/unit/has\_many\_common\_test.rb
      [has\_many\_common\_test.rb](#diff-981fdc2f31877ef3490a993a5768f69b326b310427d56880e5b885f5cee4f44c)
    - test/unit/puppet\_class\_importer\_test.rb
      [puppet\_class\_importer\_test.rb](#diff-723e34fc500b495004bd6ee4b3e4d197180d8ce84f9cc06020ba4d068d601cb4)
    - sso

      * test/unit/sso/basic\_test.rb
        [basic\_test.rb](#diff-04186713f5a97dcc9834d85e216e735935f35a383074d9043d91ed0977d3030f)
    - tasks

      * test/unit/tasks/seeds\_test.rb
        [seeds\_test.rb](#diff-8c701d1ee9344fdfd32a4cb6e0d13f1cb20d5c74ddd56e9886ee640554dfdb05)

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[app/controllers/concerns/foreman/controller/smart\_proxy\_auth.rb](#diff-ba913328a842eb6b3b2706496e588a92f79378d23d0a631753ee552f2951e681 "app/controllers/concerns/foreman/controller/smart_proxy_auth.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/controllers/concerns/foreman/controller/smart_proxy_auth.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,7 +30,11 @@ def add\_smart\_proxy\_filters(actions, options = {}) |
|  |  | # Permits registered Smart Proxies or a user with permission |
|  |  | def require\_smart\_proxy\_or\_login(features = nil) |
|  |  | features = features.call if features.respond\_to?(:call) |
|  |  | allowed\_smart\_proxies = features.blank? ? SmartProxy.all : SmartProxy.with\_features(\*features) |
|  |  | allowed\_smart\_proxies = if features.blank? |
|  |  | SmartProxy.unscoped.all |
|  |  | else |
|  |  | SmartProxy.unscoped.with\_features(\*features) |
|  |  | end |
|  |  |  |
|  |  | if !Setting[:restrict\_registered\_smart\_proxies] || auth\_smart\_proxy(allowed\_smart\_proxies, Setting[:require\_ssl\_smart\_proxies]) |
|  |  | set\_admin\_user |
| Expand All | | @@ -47,7 +51,7 @@ def require\_smart\_proxy\_or\_login(features = nil) |
|  |  |  |
|  |  | # Filter requests to only permit from hosts with a registered smart proxy |
|  |  | # Uses rDNS of the request to match proxy hostnames |
|  |  | def auth\_smart\_proxy(proxies = SmartProxy.all, require\_cert = true) |
|  |  | def auth\_smart\_proxy(proxies = SmartProxy.unscoped.all, require\_cert = true) |
|  |  | request\_hosts = nil |
|  |  | if request.ssl? |
|  |  | # If we have the client certficate in the request environment we can extract the dn and sans from there |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[app/controllers/users\_controller.rb](#diff-cfdccd0a9d5df5a43aaad2a35d36ebbe187c52ad5fdc9846fa189d04537adb6e "app/controllers/users_controller.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/controllers/users_controller.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -158,7 +158,7 @@ def parameter\_filter\_context |
|  |  | end |
|  |  |  |
|  |  | def verify\_active\_session |
|  |  | if !request.post? && params[:status].blank? && User.exists?(session[:user].presence) |
|  |  | if !request.post? && params[:status].blank? && User.unscoped.exists?(session[:user].presence) |
|  |  | warning \_("You have already logged in") |
|  |  | redirect\_back\_or\_to hosts\_path |
|  |  | return |
| Expand Down | |  |

68 changes: 44 additions & 24 deletions

68
[app/models/concerns/taxonomix.rb](#diff-04a08a233b05061e3f0b5ae7a3f95e3e9492257b99c035927d328b296f918f40 "app/models/concerns/taxonomix.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/models/concerns/taxonomix.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,15 +1,15 @@ |
|  |  | module Taxonomix |
|  |  | extend ActiveSupport::Concern |
|  |  | include DirtyAssociations |
|  |  | TAXONOMY\_JOIN\_TABLE = :taxable\_taxonomies |
|  |  |  |
|  |  | included do |
|  |  | taxonomy\_join\_table = :taxable\_taxonomies |
|  |  | has\_many taxonomy\_join\_table.to\_sym, :dependent => :destroy, :as => :taxable |
|  |  | has\_many TAXONOMY\_JOIN\_TABLE, :dependent => :destroy, :as => :taxable |
|  |  | has\_many :locations, -> { where(:type => 'Location') }, |
|  |  | :through => taxonomy\_join\_table, :source => :taxonomy, |
|  |  | :through => TAXONOMY\_JOIN\_TABLE, :source => :taxonomy, |
|  |  | :validate => false |
|  |  | has\_many :organizations, -> { where(:type => 'Organization') }, |
|  |  | :through => taxonomy\_join\_table, :source => :taxonomy, |
|  |  | :through => TAXONOMY\_JOIN\_TABLE, :source => :taxonomy, |
|  |  | :validate => false |
|  |  | after\_initialize :set\_current\_taxonomy |
|  |  |  |
| Expand All | | @@ -28,10 +28,11 @@ module ClassMethods |
|  |  |  |
|  |  | # default inner\_method includes children (subtree\_ids) |
|  |  | def with\_taxonomy\_scope(loc = Location.current, org = Organization.current, inner\_method = :subtree\_ids) |
|  |  | scope = block\_given? ? yield : where(nil) |
|  |  | return scope unless Taxonomy.enabled\_taxonomies.present? |
|  |  | self.which\_ancestry\_method = inner\_method |
|  |  | self.which\_location = Location.expand(loc) if SETTINGS[:locations\_enabled] |
|  |  | self.which\_organization = Organization.expand(org) if SETTINGS[:organizations\_enabled] |
|  |  | scope = block\_given? ? yield : where('1=1') |
|  |  | scope = scope\_by\_taxable\_ids(scope) |
|  |  | scope.readonly(false) |
|  |  | end |
| Expand Down  Expand Up | | @@ -69,26 +70,45 @@ def enforce\_default |
|  |  | end |
|  |  |  |
|  |  | def taxable\_ids(loc = which\_location, org = which\_organization, inner\_method = which\_ancestry\_method) |
|  |  | if SETTINGS[:locations\_enabled] && loc.present? |
|  |  | inner\_ids\_loc = if Location.ignore?(self.to\_s) |
|  |  | self.unscoped.pluck("#{table\_name}.id") |
|  |  | else |
|  |  | inner\_select(loc, inner\_method) |
|  |  | end |
|  |  | # Return everything (represented by nil), including objects without |
|  |  | # taxonomies. This value should only be returned for admin users. |
|  |  | return nil if any\_context?(loc) && any\_context?(org) && |
|  |  | User.current.try(:admin?) |
|  |  |  |
|  |  | ids = unscoped.pluck(:id) |
|  |  | ids &= inner\_ids(loc, Location, inner\_method) if SETTINGS[:locations\_enabled] |
|  |  | ids &= inner\_ids(org, Organization, inner\_method) if SETTINGS[:organizations\_enabled] |
|  |  |  |
|  |  | if self == User |
|  |  | # In the case of users we want the taxonomy scope to get both the users |
|  |  | # of the taxonomy, admins, and the current user. |
|  |  | ids.concat(admin\_ids) |
|  |  | ids << User.current.id if User.current.present? |
|  |  | end |
|  |  | if SETTINGS[:organizations\_enabled] && org.present? |
|  |  | inner\_ids\_org = if Organization.ignore?(self.to\_s) |
|  |  | self.unscoped.pluck("#{table\_name}.id") |
|  |  | else |
|  |  | inner\_select(org, inner\_method) |
|  |  | end |
|  |  | end |
|  |  | inner\_ids = inner\_ids\_loc & inner\_ids\_org if (inner\_ids\_loc && inner\_ids\_org) |
|  |  | inner\_ids ||= inner\_ids\_loc if inner\_ids\_loc |
|  |  | inner\_ids ||= inner\_ids\_org if inner\_ids\_org |
|  |  | # In the case of users we want the taxonomy scope to get both the users of the taxonomy and admins. |
|  |  | inner\_ids.concat(admin\_ids) if inner\_ids && self == User |
|  |  | inner\_ids |
|  |  |  |
|  |  | ids |
|  |  | end |
|  |  |  |
|  |  | # Returns the IDs available for the passed context. |
|  |  | # Passing a nil or [] value as taxonomy equates to "Any context". |
|  |  | # Any other value will be understood as 'IDs available in this taxonomy'. |
|  |  | def inner\_ids(taxonomy, taxonomy\_class, inner\_method) |
|  |  | return unscoped.pluck("#{table\_name}.id") if taxonomy\_class.ignore?(to\_s) |
|  |  | return inner\_select(taxonomy, inner\_method) if taxonomy.present? |
|  |  | return [] unless User.current.present? |
|  |  | # Any available taxonomy to the current user |
|  |  | return unscoped.pluck("#{table\_name}.id") if User.current.admin? |
|  |  |  |
|  |  | taxonomy\_relation = taxonomy\_class.to\_s.underscore.pluralize |
|  |  | any\_context\_taxonomies = User.current. |
|  |  | taxonomy\_and\_child\_ids(:"#{taxonomy\_relation}") |
|  |  | unscoped.joins(TAXONOMY\_JOIN\_TABLE). |
|  |  | where("#{TAXONOMY\_JOIN\_TABLE}.taxonomy\_id" => any\_context\_taxonomies). |
|  |  | pluck(:id) |
|  |  | end |
|  |  |  |
|  |  | def any\_context?(taxonomy) |
|  |  | taxonomy.blank? |
|  |  | end |
|  |  |  |
|  |  | # taxonomy can be either specific taxonomy object or array of these objects |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[app/models/host/base.rb](#diff-095d7b54ca912bf04ebe822da756f888d0695a228be820b9762341a136ee1691 "app/models/host/base.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/models/host/base.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,8 +49,8 @@ def self.taxonomy\_conditions |
|  |  | org = Organization.expand(Organization.current) if SETTINGS[:organizations\_enabled] |
|  |  | loc = Location.expand(Location.current) if SETTINGS[:locations\_enabled] |
|  |  | conditions = {} |
|  |  | conditions[:organization\_id] = Array(org).map { |o| o.subtree\_ids }.flatten.uniq if org.present? |
|  |  | conditions[:location\_id] = Array(loc).map { |l| l.subtree\_ids }.flatten.uniq if loc.present? |
|  |  | conditions[:organization\_id] = Array(org).map { |o| o.subtree\_ids }.flatten.uniq unless org.nil? |
|  |  | conditions[:location\_id] = Array(loc).map { |l| l.subtree\_ids }.flatten.uniq unless loc.nil? |
|  |  | conditions |
|  |  | end |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[app/services/sso/base.rb](#diff-3c6e9412c657a2cadbe7407bdd257cf1af51bad03ebc4e89aca74183a8283497 "app/services/sso/base.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/services/sso/base.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,7 +41,7 @@ def authenticate! |
|  |  | end |
|  |  |  |
|  |  | def current\_user |
|  |  | User.except\_hidden.find\_by\_login(self.user) |
|  |  | User.unscoped.except\_hidden.find\_by\_login(self.user) |
|  |  | end |
|  |  | end |
|  |  | end |

2 changes: 1 addition & 1 deletion

2
[app/services/sso/oauth.rb](#diff-30d0b8b6ea76e3c3dab7614cc1d733b24d6880efd7326acfb655898ce1c8a52f "app/services/sso/oauth.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/services/sso/oauth.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,7 +20,7 @@ def authenticate! |
|  |  | if OAuth::Signature.verify(request, :consumer\_secret => Setting['oauth\_consumer\_secret']) |
|  |  | if Setting['oauth\_map\_users'] |
|  |  | user\_name = request.headers['HTTP\_FOREMAN\_USER'].to\_s |
|  |  | User.find\_by\_login(user\_name).tap do |obj| |
|  |  | User.unscoped.find\_by\_login(user\_name).tap do |obj| |
|  |  | Rails.logger.warn "Oauth: mapping to user '#{user\_name}' failed" if obj.nil? |
|  |  | end.try(:login) |
|  |  | else |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[app/services/tax\_host.rb](#diff-4bff19d42046258a32b954968dc49855552229f73923d35ba7131d945fdbdb96 "app/services/tax_host.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/app/services/tax_host.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,11 +27,11 @@ def selected\_ids |
|  |  | ids = default\_ids\_hash |
|  |  | #types NOT ignored - get ids that are selected |
|  |  | hash\_keys.each do |col| |
|  |  | ids[col] = Array(taxonomy.send(col)) |
|  |  | ids[col] = Array(taxonomy.send(col)).uniq |
|  |  | end |
|  |  | #types that ARE ignored - get ALL ids for object |
|  |  | Array(taxonomy.ignore\_types).each do |taxonomy\_type| |
|  |  | ids["#{taxonomy\_type.tableize.singularize}\_ids"] = taxonomy\_type.constantize.pluck(:id) |
|  |  | ids["#{taxonomy\_type.tableize.singularize}\_ids"] = taxonomy\_type.constantize.pluck(:id).uniq |
|  |  | end |
|  |  |  |
|  |  | ids["#{opposite\_taxonomy\_type}\_ids"] = Array(taxonomy.send("#{opposite\_taxonomy\_type}\_ids")) |
| Expand Down  Expand Up | | @@ -213,7 +213,7 @@ def substract\_deep\_hashes(h1, h2) |
|  |  | def default\_ids\_hash(populate\_values = false) |
|  |  | ids = HashWithIndifferentAccess.new |
|  |  | hash\_keys.each do |col| |
|  |  | ids[col] = populate\_values ? Array(self.send(col)) : [] |
|  |  | ids[col] = populate\_values ? Array(self.send(col)).uniq : [] |
|  |  | end |
|  |  | ids |
|  |  | end |
| Expand Down | |  |

28 changes: 14 additions & 14 deletions

28
[db/migrate/20130908100439\_delete\_orphaned\_records.rb](#diff-83c21d16706dc627a14489e7ef5e3b0867d6ade212a089ae227431cfbc272e13 "db/migrate/20130908100439_delete_orphaned_records.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/db/migrate/20130908100439_delete_orphaned_records.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,23 +37,23 @@ def up |
|  |  | TrendCounter.where("trend\_id NOT IN (?)", Trend.pluck(:id)).delete\_all |
|  |  |  |
|  |  | # NULLIFY FOREIGN KEY VALUE IF IT HAS AN ORPHANED FOREIGN KEY |
|  |  | Audit.unscoped.where("user\_id NOT IN (?)", User.pluck(:id)).update\_all(:user\_id => nil) |
|  |  | Audit.unscoped.where("user\_id NOT IN (?)", User.unscoped.pluck(:id)).update\_all(:user\_id => nil) |
|  |  | FakeConfigTemplate.where("template\_kind\_id NOT IN (?)", TemplateKind.pluck(:id)).update\_all(:template\_kind\_id => nil) |
|  |  | Domain.where("dns\_id NOT IN (?)", SmartProxy.pluck(:id)).update\_all(:dns\_id => nil) |
|  |  | Subnet.where("dhcp\_id NOT IN (?)", SmartProxy.pluck(:id)).update\_all(:dhcp\_id => nil) |
|  |  | Subnet.where("dns\_id NOT IN (?)", SmartProxy.pluck(:id)).update\_all(:dns\_id => nil) |
|  |  | Subnet.where("tftp\_id NOT IN (?)", SmartProxy.pluck(:id)).update\_all(:tftp\_id => nil) |
|  |  | Image.where("architecture\_id NOT IN (?)", Architecture.pluck(:id)).update\_all(:architecture\_id => nil) |
|  |  | Image.where("compute\_resource\_id NOT IN (?)", ComputeResource.pluck(:id)).update\_all(:compute\_resource\_id => nil) |
|  |  | Domain.where("dns\_id NOT IN (?)", SmartProxy.unscoped.pluck(:id)).update\_all(:dns\_id => nil) |
|  |  | Subnet.where("dhcp\_id NOT IN (?)", SmartProxy.unscoped.pluck(:id)).update\_all(:dhcp\_id => nil) |
|  |  | Subnet.where("dns\_id NOT IN (?)", SmartProxy.unscoped.pluck(:id)).update\_all(:dns\_id => nil) |
|  |  | Subnet.where("tftp\_id NOT IN (?)", SmartProxy.unscoped.pluck(:id)).update\_all(:tftp\_id => nil) |
|  |  | Image.where("architecture\_id NOT IN (?)", Architecture.unscoped.pluck(:id)).update\_all(:architecture\_id => nil) |
|  |  | Image.where("compute\_resource\_id NOT IN (?)", ComputeResource.unscoped.pluck(:id)).update\_all(:compute\_resource\_id => nil) |
|  |  | Image.where("operatingsystem\_id NOT IN (?)", Operatingsystem.unscoped.pluck(:id)).update\_all(:operatingsystem\_id => nil) |
|  |  | Nic::Base.where("domain\_id NOT IN (?)", Domain.pluck(:id)).update\_all(:domain\_id => nil) |
|  |  | Nic::Base.where("host\_id NOT IN (?)", Host::Base.pluck(:id)).update\_all(:host\_id => nil) |
|  |  | Nic::Base.where("subnet\_id NOT IN (?)", Subnet.pluck(:id)).update\_all(:subnet\_id => nil) |
|  |  | OsDefaultTemplate.where("config\_template\_id NOT IN (?)", FakeConfigTemplate.pluck(:id)).update\_all(:config\_template\_id => nil) |
|  |  | Nic::Base.where("domain\_id NOT IN (?)", Domain.unscoped.pluck(:id)).update\_all(:domain\_id => nil) |
|  |  | Nic::Base.where("host\_id NOT IN (?)", Host::Base.unscoped.pluck(:id)).update\_all(:host\_id => nil) |
|  |  | Nic::Base.where("subnet\_id NOT IN (?)", Subnet.unscoped.pluck(:id)).update\_all(:subnet\_id => nil) |
|  |  | OsDefaultTemplate.where("config\_template\_id NOT IN (?)", FakeConfigTemplate.unscoped.pluck(:id)).update\_all(:config\_template\_id => nil) |
|  |  | OsDefaultTemplate.where("operatingsystem\_id NOT IN (?)", Operatingsystem.unscoped.pluck(:id)).update\_all(:operatingsystem\_id => nil) |
|  |  | OsDefaultTemplate.where("template\_kind\_id NOT IN (?)", TemplateKind.pluck(:id)).update\_all(:template\_kind\_id => nil) |
|  |  | TemplateCombination.where("config\_template\_id NOT IN (?)", FakeConfigTemplate.pluck(:id)).update\_all(:config\_template\_id => nil) |
|  |  | TemplateCombination.where("environment\_id NOT IN (?)", Environment.pluck(:id)).update\_all(:environment\_id => nil) |
|  |  | OsDefaultTemplate.where("template\_kind\_id NOT IN (?)", TemplateKind.unscoped.pluck(:id)).update\_all(:template\_kind\_id => nil) |
|  |  | TemplateCombination.where("config\_template\_id NOT IN (?)", FakeConfigTemplate.unscoped.pluck(:id)).update\_all(:config\_template\_id => nil) |
|  |  | TemplateCombination.where("environment\_id NOT IN (?)", Environment.unscoped.pluck(:id)).update\_all(:environment\_id => nil) |
|  |  | TemplateCombination.where("hostgroup\_id NOT IN (?)", Hostgroup.unscoped.pluck(:id)).update\_all(:hostgroup\_id => nil) |
|  |  |  |
|  |  | host\_groups\_up |
| Expand Down | |  |

11 changes: 5 additions & 6 deletions

11
[db/seeds.d/07-provisioning\_templates.rb](#diff-dcc4593cd29c6863a09a82bae6f39e951a92a4ab99b2ad065beb465b0116d417 "db/seeds.d/07-provisioning_templates.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/db/seeds.d/07-provisioning_templates.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,14 +7,14 @@ |
|  |  | # Template kinds |
|  |  | kinds = {} |
|  |  | TemplateKind.default\_template\_labels.keys.collect(&:to\_sym).each do |type| |
|  |  | kinds[type] = TemplateKind.find\_by\_name(type) |
|  |  | kinds[type] ||= TemplateKind.create(:name => type) |
|  |  | kinds[type] = TemplateKind.unscoped.find\_by\_name(type) |
|  |  | kinds[type] ||= TemplateKind.unscoped.create(:name => type) |
|  |  | raise "Unable to create template kind: #{format\_errors kinds[type]}" if kinds[type].nil? || kinds[type].errors.any? |
|  |  | end |
|  |  |  |
|  |  | # Provisioning templates |
|  |  | organizations = Organization.all |
|  |  | locations = Location.all |
|  |  | organizations = Organization.unscoped.all |
|  |  | locations = Location.unscoped.all |
|  |  | ProvisioningTemplate.without\_auditing do |
|  |  | [ |
|  |  | # Generic PXE files |
| Expand Down  Expand Up | | @@ -81,7 +81,6 @@ |
|  |  | { :name => 'puppet.conf', :source => 'snippets/\_puppet.conf.erb', :snippet => true }, |
|  |  | { :name => 'puppet\_setup', :source => 'snippets/\_puppet\_setup.erb', :snippet => true }, |
|  |  | { :name => 'puppetlabs\_repo', :source => 'snippets/\_puppetlabs\_repo.erb', :snippet => true }, |
|  |  | { :name => 'pxelinux\_discovery', :source => 'snippets/\_pxelinux\_discovery.erb', :snippet => true }, |
|  |  | { :name => 'redhat\_register', :source => 'snippets/\_redhat\_register.erb', :snippet => true }, |
|  |  | { :name => 'remote\_execution\_ssh\_keys', :source => 'snippets/\_remote\_execution\_ssh\_keys.erb', :snippet => true }, |
|  |  | { :name => 'saltstack\_minion', :source => 'snippets/\_saltstack\_minion.erb', :snippet => true }, |
| Expand All | | @@ -95,7 +94,7 @@ |
|  |  | ].each do |input| |
|  |  | contents = File.read(File.join("#{Rails.root}/app/views/unattended", input.delete(:source))) |
|  |  |  |
|  |  | if (t = ProvisioningTemplate.find\_by\_name(input[:name])) && !audit\_modified?(ProvisioningTemplate, input[:name]) |
|  |  | if (t = ProvisioningTemplate.unscoped.find\_by\_name(input[:name])) && !audit\_modified?(ProvisioningTemplate, input[:name]) |
|  |  | if t.template != contents |
|  |  | t.template = contents |
|  |  | raise "Unable to update template #{t.name}: #{format\_errors t}" unless t.save |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[db/seeds.d/08-partition\_tables.rb](#diff-214fc5dd615d88d5db54bf0c003d8366df8aba0360e07e5d0e613cb1ae857cf4 "db/seeds.d/08-partition_tables.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/db/seeds.d/08-partition_tables.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | # Partition tables |
|  |  | organizations = Organization.all |
|  |  | locations = Location.all |
|  |  | organizations = Organization.unscoped.all |
|  |  | locations = Location.unscoped.all |
|  |  | Ptable.without\_auditing do |
|  |  | [ |
|  |  | { :name => 'AutoYaST entire SCSI disk', :os\_family => 'Suse', :source => 'autoyast/disklayout\_scsi.erb' }, |
| Expand All | | @@ -19,7 +19,7 @@ |
|  |  | ].each do |input| |
|  |  | contents = File.read(File.join("#{Rails.root}/app/views/unattended", input.delete(:source))) |
|  |  |  |
|  |  | if (p = Ptable.find\_by\_name(input[:name])) && !audit\_modified?(Ptable, input[:name]) |
|  |  | if (p = Ptable.unscoped.find\_by\_name(input[:name])) && !audit\_modified?(Ptable, input[:name]) |
|  |  | if p.layout != contents |
|  |  | p.layout = contents |
|  |  | raise "Unable to update partition table: #{format\_errors p}" unless p.save |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[db/seeds.d/10-installation\_media.rb](#diff-f50ec4a2a18dc270ccbf9a1129875145c408a7572a8c8945f1be10936627db72 "db/seeds.d/10-installation_media.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/db/seeds.d/10-installation_media.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | os\_suse = Operatingsystem.where(:type => "Suse") || Operatingsystem.where("name LIKE ?", "suse") |
|  |  | os\_suse = Operatingsystem.unscoped.where(:type => "Suse") || Operatingsystem.unscoped.where("name LIKE ?", "suse") |
|  |  |  |
|  |  | # Installation media: default mirrors |
|  |  | Medium.without\_auditing do |
| Expand All | | @@ -12,7 +12,7 @@ |
|  |  | { :name => "Ubuntu mirror", :os\_family => "Debian", :path => "http://archive.ubuntu.com/ubuntu" }, |
|  |  | { :name => "CoreOS mirror", :os\_family => "Coreos", :path => "http://$release.release.core-os.net" } |
|  |  | ].each do |input| |
|  |  | next if Medium.where(['name = ? OR path = ?', input[:name], input[:path]]).any? |
|  |  | next if Medium.unscoped.where(['name = ? OR path = ?', input[:name], input[:path]]).any? |
|  |  | next if audit\_modified? Medium, input[:name] |
|  |  | m = Medium.create input |
|  |  | raise "Unable to create medium: #{format\_errors m}" if m.nil? || m.errors.any? |
| Expand Down | |  |

8 changes: 7 additions & 1 deletion

8
[test/active\_support\_test\_case\_helper.rb](#diff-93ce8bfe62062eb45427e17d40cb5f4bc2c597547ec8ea2b874c1f03a4785fba "test/active_support_test_case_helper.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/test/active_support_test_case_helper.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ class ActiveSupport::TestCase |
|  |  | setup :begin\_gc\_deferment |
|  |  | setup :reset\_setting\_cache |
|  |  | setup :skip\_if\_plugin\_asked\_to |
|  |  | setup :set\_admin |
|  |  |  |
|  |  | teardown :reconsider\_gc\_deferment |
|  |  | teardown :clear\_current\_user |
| Expand Down  Expand Up | | @@ -40,6 +41,10 @@ def skip\_if\_plugin\_asked\_to |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | def set\_admin |
|  |  | User.current = users(:admin) |
|  |  | end |
|  |  |  |
|  |  | def clear\_current\_user |
|  |  | User.current = nil |
|  |  | end |
| Expand Down  Expand Up | | @@ -125,7 +130,8 @@ def setup\_users |
|  |  | def setup\_user(operation, type = "", search = nil, user = :one) |
|  |  | @one = users(user) |
|  |  | as\_admin do |
|  |  | permission = Permission.find\_by\_name("#{operation}\_#{type}") || FactoryGirl.create(:permission, :name => "#{operation}\_#{type}") |
|  |  | permission = Permission.find\_by\_name("#{operation}\_#{type}") || |
|  |  | FactoryGirl.create(:permission, :name => "#{operation}\_#{type}") |
|  |  | filter = FactoryGirl.build(:filter, :search => search) |
|  |  | filter.permissions = [ permission ] |
|  |  | role = Role.where(:name => "#{operation}\_#{type}").first\_or\_create |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[test/controllers/api/v1/auth\_source\_ldaps\_controller\_test.rb](#diff-4852f217712874761d374b2905260c3b183c18bf5381901c51016081306252ed "test/controllers/api/v1/auth_source_ldaps_controller_test.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/test/controllers/api/v1/auth_source_ldaps_controller_test.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,7 +19,7 @@ class Api::V1::AuthSourceLdapsControllerTest < ActionController::TestCase |
|  |  | end |
|  |  |  |
|  |  | test "should create auth\_source\_ldap" do |
|  |  | assert\_difference('AuthSourceLdap.count', 1) do |
|  |  | assert\_difference('AuthSourceLdap.unscoped.count', 1) do |
|  |  | post :create, { :auth\_source\_ldap => valid\_attrs } |
|  |  | end |
|  |  | assert\_response :success |
| Expand All | | @@ -31,7 +31,7 @@ class Api::V1::AuthSourceLdapsControllerTest < ActionController::TestCase |
|  |  | end |
|  |  |  |
|  |  | test "should destroy auth\_source\_ldap" do |
|  |  | assert\_difference('AuthSourceLdap.count', -1) do |
|  |  | assert\_difference('AuthSourceLdap.unscoped.count', -1) do |
|  |  | auth = auth\_sources(:one) |
|  |  | User.where(:auth\_source\_id => auth.id).update\_all(:auth\_source\_id => nil) |
|  |  | delete :destroy, { :id => auth.id } |
| Expand Down | |  |

10 changes: 6 additions & 4 deletions

10
[test/controllers/api/v1/compute\_resources\_controller\_test.rb](#diff-bca2e82f76d51127b37ab480a2cf10c3d57040ff4ae213813d733df97fd32996 "test/controllers/api/v1/compute_resources_controller_test.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/test/controllers/api/v1/compute_resources_controller_test.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,12 +35,13 @@ def teardown |
|  |  |  |
|  |  | test "should update compute resource" do |
|  |  | put :update, { :id => compute\_resources(:mycompute).to\_param, :compute\_resource => { :description => "new\_description" } } |
|  |  | assert\_equal "new\_description", ComputeResource.find\_by\_name('mycompute').description |
|  |  | assert\_equal "new\_description", |
|  |  | ComputeResource.unscoped.find\_by\_name('mycompute').description |
|  |  | assert\_response :success |
|  |  | end |
|  |  |  |
|  |  | test "should destroy compute resource" do |
|  |  | assert\_difference('ComputeResource.count', -1) do |
|  |  | assert\_difference('ComputeResource.unscoped.count', -1) do |
|  |  | delete :destroy, { :id => compute\_resources(:yourcompute).id } |
|  |  | end |
|  |  | assert\_response :success |
| Expand All | | @@ -66,12 +67,13 @@ def teardown |
|  |  | test "should update compute resource for owner" do |
|  |  | setup\_user 'edit', 'compute\_resources', "id = #{compute\_resources(:mycompute).id}" |
|  |  | put :update, { :id => compute\_resources(:mycompute).to\_param, :compute\_resource => { :description => "new\_description" } } |
|  |  | assert\_equal "new\_description", ComputeResource.find\_by\_name('mycompute').description |
|  |  | assert\_equal "new\_description", |
|  |  | ComputeResource.unscoped.find\_by\_name('mycompute').description |
|  |  | assert\_response :success |
|  |  | end |
|  |  |  |
|  |  | test "should destroy compute resource for owner" do |
|  |  | assert\_difference('ComputeResource.count', -1) do |
|  |  | assert\_difference('ComputeResource.unscoped.count', -1) do |
|  |  | setup\_user 'destroy', 'compute\_resources', "id = #{compute\_resources(:mycompute).id}" |
|  |  | delete :destroy, { :id => compute\_resources(:mycompute).id } |
|  |  | end |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[test/controllers/api/v1/config\_templates\_controller\_test.rb](#diff-35593b737536982b21da020bf9ada7f9cfc5b574dabd24e81caf8d064d530424 "test/controllers/api/v1/config_templates_controller_test.rb")

Show comments

[View file](/theforeman/foreman/blob/5f606e11cf39719bf62f8b1f3396861b32387905/test/controllers/api/v1/config_templates_controller_test.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,15 +51,15 @@ class Api::V1::ConfigTemplatesControllerTest < ActionController::TestCase |
|  |  | config\_template = templates(:pxekickstart) |
|  |  | delete :destroy, { :id => config\_template.to\_param } |
|  |  | assert\_response :unprocessable\_entity |
|  |  | assert ProvisioningTemplate.exists?(config\_template.id) |
|  |  | assert ProvisioningTemplate.unscoped.exists?(config\_template.id) |
|  |  | end |
|  |  |  |
|  |  | test "should destroy" do |
|  |  | config\_template = templates(:pxekickstart) |
|  |  | config\_template.os\_default\_templates.clear |
|  |  | delete :destroy, { :id => config\_template.to\_param } |
|  |  | assert\_response :success |
|  |  | refute ProvisioningTemplate.exists?(config\_template.id) |
|  |  | refute ProvisioningTemplate.unscoped.exists?(config\_template.id) |
|  |  | end |
|  |  |  |
|  |  | test "should build pxe menu" do |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5f606e1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftheforeman%2Fforeman%2Fcommit%2F5f606e11cf39719bf62f8b1f3396861b32387905) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.gravatar.com_fe6dd45f_20250126_025034.html ===
���� JFIF  ` `  �� ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
�� C 



�� C  

��   " ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ����l��ӣ��N���Z[Y�n�ܞ7F�n$6:�,xoě��h^0��z�A����,� �J�y��C��n��\_5�п�U���Lѵ
";{�>�ھ�������s���c�����:v����m\*aw�k��]k�|�#��qP�X>:���yT�Zp�Ļ[{\_��ך��t��s�ψ~�\_�� �<I{��q�����Q��1cm��HϦ{�^U�Xu��~�׎ ��J����T�d{HU��p�u���Y<,�nZ^��V���O5��~$���'���oe��jR�l���\_)#
��X�� ϶�?�ǁ������u
Z�M��#]�G 2�2H��'�c��QE}d���ⷿ�c�+�A.ǹx?�/���X��A+6�n�1\ \g�Z(��:؊Ш�����=\*�R�S}�?��
