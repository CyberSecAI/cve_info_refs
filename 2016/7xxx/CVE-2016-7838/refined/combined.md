=== Content from github.com_e455a6a6_20250125_013034.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvslavik%2Fwinsparkle%2Fcommit%2Fbb454857348245a7397f9e4fbb3a902f4ac25913)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvslavik%2Fwinsparkle%2Fcommit%2Fbb454857348245a7397f9e4fbb3a902f4ac25913)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vslavik%2Fwinsparkle)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vslavik](/vslavik)
/
**[winsparkle](/vslavik/winsparkle)**
Public

* [Notifications](/login?return_to=%2Fvslavik%2Fwinsparkle) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2Fvslavik%2Fwinsparkle)
* [Star
   1.3k](/login?return_to=%2Fvslavik%2Fwinsparkle)

* [Code](/vslavik/winsparkle)
* [Issues
  19](/vslavik/winsparkle/issues)
* [Pull requests
  4](/vslavik/winsparkle/pulls)
* [Discussions](/vslavik/winsparkle/discussions)
* [Actions](/vslavik/winsparkle/actions)
* [Projects
  0](/vslavik/winsparkle/projects)
* [Wiki](/vslavik/winsparkle/wiki)
* [Security](/vslavik/winsparkle/security)
* [Insights](/vslavik/winsparkle/pulse)

Additional navigation options

* [Code](/vslavik/winsparkle)
* [Issues](/vslavik/winsparkle/issues)
* [Pull requests](/vslavik/winsparkle/pulls)
* [Discussions](/vslavik/winsparkle/discussions)
* [Actions](/vslavik/winsparkle/actions)
* [Projects](/vslavik/winsparkle/projects)
* [Wiki](/vslavik/winsparkle/wiki)
* [Security](/vslavik/winsparkle/security)
* [Insights](/vslavik/winsparkle/pulse)

## Commit

[Permalink](/vslavik/winsparkle/commit/bb454857348245a7397f9e4fbb3a902f4ac25913)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Verify UpdateTempDir isn't maliciously modified

[Browse files](/vslavik/winsparkle/tree/bb454857348245a7397f9e4fbb3a902f4ac25913)
Browse the repository at this point in the history

```
Don't just delete the stored updates temporary directory on launch, but
validate the registry key to ensure it is in an expected location and
follows WinSparkle's naming convention. This is to prevent malicious
users from modifying this registry key and forcing the host app to
delete arbitrary directories (a user being able to delete the key would
be able to delete the directory themselves, so it's not a serious issue,
but it nevertheless is bad behavior and shouldn't be possible).
```

* Loading branch information

[![@vslavik](https://avatars.githubusercontent.com/u/145881?s=40&v=4)](/vslavik)

[vslavik](/vslavik/winsparkle/commits?author=vslavik "View all commits by vslavik")
committed
Dec 12, 2016

1 parent
[786d180](/vslavik/winsparkle/commit/786d180882fd4fda6b5a253f6cc5dc0d2322fc9c)

commit bb45485

Showing
**1 changed file**
with
**27 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

32 changes: 27 additions & 5 deletions

32
[src/updatedownloader.cpp](#diff-c30ff6850815a5b9b6e7672ddb7ccfe7630cfadc79ad63709b96fcb69ed954ba "src/updatedownloader.cpp")

Show comments

[View file](/vslavik/winsparkle/blob/bb454857348245a7397f9e4fbb3a902f4ac25913/src/updatedownloader.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,6 +45,17 @@ namespace winsparkle |
|  |  | namespace |
|  |  | { |
|  |  |  |
|  |  | std::wstring GetUniqueTempDirectoryPrefix() |
|  |  | { |
|  |  | wchar\_t tmpdir[MAX\_PATH + 1]; |
|  |  | if (GetTempPath(MAX\_PATH + 1, tmpdir) == 0) |
|  |  | throw Win32Exception("Cannot create temporary directory"); |
|  |  |  |
|  |  | std::wstring dir(tmpdir); |
|  |  | dir += L"Update-"; |
|  |  | return dir; |
|  |  | } |
|  |  |  |
|  |  | std::wstring CreateUniqueTempDirectory() |
|  |  | { |
|  |  | // We need to put downloaded updates into a directory of their own, because |
| Expand All | | @@ -53,15 +64,11 @@ std::wstring CreateUniqueTempDirectory() |
|  |  | // |
|  |  | // This code creates a new randomized directory name and tries to create it; |
|  |  | // this process is repeated if the directory already exists. |
|  |  | wchar\_t tmpdir[MAX\_PATH+1]; |
|  |  | if ( GetTempPath(MAX\_PATH+1, tmpdir) == 0 ) |
|  |  | throw Win32Exception("Cannot create temporary directory"); |
|  |  | const std::wstring tmpdir = GetUniqueTempDirectoryPrefix(); |
|  |  |  |
|  |  | for ( ;; ) |
|  |  | { |
|  |  | std::wstring dir(tmpdir); |
|  |  | dir += L"Update-"; |
|  |  |  |
|  |  | UUID uuid; |
|  |  | UuidCreate(&uuid); |
|  |  | RPC\_WSTR uuidStr; |
| Expand Down  Expand Up | | @@ -192,6 +199,21 @@ void UpdateDownloader::CleanLeftovers() |
|  |  | if ( !Settings::ReadConfigValue("UpdateTempDir", tmpdir) ) |
|  |  | return; |
|  |  |  |
|  |  | // Check that the directory actually is a valid update temp dir, to prevent |
|  |  | // malicious users from forcing us into deleting arbitrary directories: |
|  |  | try |
|  |  | { |
|  |  | if (tmpdir.find(GetUniqueTempDirectoryPrefix()) != 0) |
|  |  | { |
|  |  | Settings::DeleteConfigValue("UpdateTempDir"); |
|  |  | return; |
|  |  | } |
|  |  | } |
|  |  | catch (Win32Exception&) // cannot determine temp directory |
|  |  | { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | tmpdir.append(1, '\0'); // double NULL-terminate for SHFileOperation |
|  |  |  |
|  |  | SHFILEOPSTRUCT fos = {0}; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bb45485`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvslavik%2Fwinsparkle%2Fcommit%2Fbb454857348245a7397f9e4fbb3a902f4ac25913) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jvn.jp_96205245_20250125_013037.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2016/12/26  Last Updated:2016/12/26
# JVN#96681653 WinSparkle issue where registry value is not validated

## Overview

WinSparkle contains an issue where the directory or file path specified in a certain registry key is not validated.

## Products Affected

* Applications that use WinSparkle versions prior to 0.5.3

Wireshark version 2.0.5 has been reported to be affected by this issue. Applications other than Wireshark may also be affected.

## Description

When an application that uses WinSparkle is launched, it checks the directory used by WinSparkle for temporary files and deletes any temporary files. This directory path is specified in a registry key.

In a situation where an attacker has modified the specific registry value used by this library, and a user launches an application that uses WinSparkle, an unintended directory or file may be deleted.

## Impact

Effects vary depending on the application. An arbitrary directory or file may be deleted with the privileges of the application.

## Solution

**Update the software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| WinSparkle | [WinSparkle](https://winsparkle.org/) |
|  | [Release Version 0.5.3](https://github.com/vslavik/winsparkle/releases/tag/v0.5.3) |
|  | [Verify UpdateTempDir isn't maliciously modified - GitHub](https://github.com/vslavik/winsparkle/commit/bb454857348245a7397f9e4fbb3a902f4ac25913) |
| Wireshark Foundation | [Wireshark](https://www.wireshark.org/) |
|  | [Wireshark 2.2.3 and 2.0.9 Released](https://www.wireshark.org/news/20161214.html) |

## References

1. [Japan Vulnerability Note JVN#90813656](https://jvn.jp/en/jp/JVN90813656/)
   Wireshark for Windows issue where an arbitrary file may be deleted

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L
Base Score:
3.6

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:H/Au:N/C:N/I:P/A:P
Base Score:
4.0

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Takashi Yoshikawa of Mitsui Bussan Secure Directions, Inc. reported this issue to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2016-7838](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7838) |
| JVN iPedia | [JVNDB-2016-000251](http://jvndb.jvn.jp/jvndb/JVNDB-2016-000251) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2016 JPCERT/CC and IPA. All rights reserved.



=== Content from jvn.jp_e55eedc2_20250125_013036.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2016/12/26  Last Updated:2016/12/26
# JVN#90813656 Wireshark for Windows issue where an arbitrary file may be deleted

## Overview

Wireshark for Windows contains an issue where an arbitrary file may be deleted.

## Products Affected

* Wireshark for Windows versions prior to 2.2.3
* Wireshark for Windows versions prior to 2.0.9

## Description

Wireshark for Windows uses a software updating library called WinSparkle. Wireshark for Windows contains an issue where an arbitrary directory of file may be deleted due to an issue contained in WinSparkle ([JVN#96681653](https://jvn.jp/en/jp/JVN96681653/)).

## Impact

An arbitrary directory or file may be deleted with the privileges of the application.

## Solution

**Update the software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Wireshark Foundation | [Wireshark](https://www.wireshark.org/) |
|  | [Wireshark 2.2.3 and 2.0.9 Released](https://www.wireshark.org/news/20161214.html) |

## References

1. [Japan Vulnerability Note JVN#96681653](https://jvn.jp/en/jp/JVN96681653/)
   WinSparkle issue where registry value is not validated

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:L
Base Score:
3.6

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:H/Au:N/C:N/I:P/A:P
Base Score:
4.0

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Takashi Yoshikawa of Mitsui Bussan Secure Directions, Inc. reported this issue to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2016-7838](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7838) |
| JVN iPedia | [JVNDB-2016-000250](http://jvndb.jvn.jp/jvndb/JVNDB-2016-000250) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2016 JPCERT/CC and IPA. All rights reserved.



=== Content from www.wireshark.org_cc18e2ee_20250125_013037.html ===

### Wireshark 2.2.3 and 2.0.9 Released

#### December 14, 2016

Wireshark 2.2.3 and 2.0.9 have been released. Installers for Windows,
Mac OS X 10.8 and above, and source code are now available.

#### In 2.2.3

Several bugs have been fixed. See the release
notes for details.

For a complete list of changes, please refer to the
[2.2.3 release notes](../docs/relnotes/wireshark-2.2.3.html).

#### In 2.0.9

Several bugs have been fixed. See the release
notes for details.

For a complete list of changes, please refer to the
[2.0.9 release notes](../docs/relnotes/wireshark-2.0.9.html).

Official releases are available right now from the
[download page](../download.html).

   [Big News: Introducing Stratoshark – 'Wireshark for the Cloud'! - Click here to learn more](https://stratoshark.org) X
