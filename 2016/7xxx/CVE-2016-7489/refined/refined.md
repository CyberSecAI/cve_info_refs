- **Root cause of vulnerability**: The `t2a.pl` script in Teradata Virtual Machine Community Edition v15.10 insecurely creates files in the `/tmp` directory. Specifically, it creates a script file named `$PROG.get_profile.scr` (e.g., `t2a.pl.get_profile.scr`). The script first executes `chmod +x /tmp/$PROG.get_profile.scr` and then executes `/tmp/$PROG.get_profile.scr >/dev/null 2>&1`.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the fact that the script does not check if the `/tmp/$PROG.get_profile.scr` file already exists before writing to it. This allows a malicious local user to create a file with the same name before the `t2a.pl` script is executed. Since the script later executes the created file with elevated permissions, an attacker can inject and execute arbitrary code.
- **Impact of exploitation**: A local user can gain elevated privileges (root access) by injecting malicious code into the `/tmp/$PROG.get_profile.scr` file and having that code executed by the `t2a.pl` script as root.
- **Attack vectors**: The attack vector is local. A malicious user needs to have the ability to create files in the `/tmp` directory.
- **Required attacker capabilities/position**: The attacker needs to be a local user on the system running the vulnerable Teradata Virtual Machine Community Edition v15.10. The attacker must have the ability to write files to the `/tmp` directory and needs to anticipate when the vulnerable script will run.