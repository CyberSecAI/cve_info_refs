=== Content from www.openwall.com_237d1a49_20250124_181706.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <bba41ca7-d5c1-bb07-47fc-dcec4898e81f@sysdream.com>
Date: Wed, 12 Oct 2016 15:26:23 +0200
From: Sysdream Labs <labs@...dream.com>
To: oss-security@...ts.openwall.com
Cc: fulldisclosure@...lists.org, spip-team-owner@...o.net
Subject: CVE-2016-7980: SPIP 3.1.2 Exec Code Cross-Site Request Forgery

## SPIP 3.1.2 Exec Code Cross-Site Request Forgery (CVE-2016-7980)

### Product Description

SPIP is a publishing system for the Internet, which put importance on collaborative working, multilingual environments and ease of use. It is free software, distributed under the GNU/GPL licence.

### Vulnerability Description

The vulnerable request to `valider_xml` (see: *SPIP 3.1.2 Template Compiler/Composer PHP Code Execution - CVE-2016-7998*) is vulnerable to Cross-Site Request Forgery, allowing the execution of the CVE-2016-7998 attack by tricking an administrator to open the malicious link.

**Access Vector**: remote

**Security Risk**: high

**Vulnerability**: CWE-352

**CVSS Base Score**: 8.3 (High)

**CVE-ID**: CVE-2016-7980

### Proof of Concept

    <http://spip-dev.srv/ecrire/?exec=valider_xml&var_url=/tmp/directory&ext=html>

### Timeline (dd/mm/yyyy)

* 15/09/2016 : Initial discovery
* 26/09/2016 : Contact with SPIP Team
* 27/09/2016 : Answer from SPIP Team, sent advisory details
* 28/09/2016 : Fixes issued for CSRF
* 30/09/2016 : SPIP 3.1.3 Released

### Fixes

* <https://core.spip.net/projects/spip/repository/revisions/23200>
* <https://core.spip.net/projects/spip/repository/revisions/23201>
* <https://core.spip.net/projects/spip/repository/revisions/23202>

### Affected versions

* Version <= 3.1.2

### Credits

* Nicolas CHATELAIN, Sysdream (n.chatelain -at- sysdream -dot- com)

--
SYSDREAM Labs <labs@...dream.com>

GPG :
47D1 E124 C43E F992 2A2E
1551 8EB4 8CD9 D5B2 59A1

* Website: <https://sysdream.com/>
* Twitter: @sysdream

Download attachment "[signature.asc](6/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from core.spip.net_ab2869c1_20250124_181707.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
e0e00ea8**

authored
Sep 28, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/e0e00ea8224f0483a2db61df1d971239b0e146ac)

### Report de r23200 : - ?exec=valider\_xml n'est executable que par les webmestres

```
- var_url ne doit pas contenir de ../../ ni de ..\..\ (windows)
- elle ne lance une action que si on a un var_token qui correspond soit a la signature de l'action en POST soit a la signature de l'action+var_url en GET. Ceci evite de faire lancer le validateur par un lien malveillant fourni a un webmstre d'un site auquel on a pas acces (CSRF)

(Nicolas Chatelain)
```

parent
[793e7a96](/spip/spip/-/commit/793e7a969b82dd900d8cdeb0cc010f380cd05930)

Loading

Loading

Loading

* [Changes
  1](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac)

[Hide whitespace changes](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?action=show&controller=projects%2Fcommit&id=e0e00ea8224f0483a2db61df1d971239b0e146ac&namespace_id=spip&project_id=spip&r=23201&w=1)
[Inline](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?r=23201&view=inline)
[Side-by-side](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac?r=23201&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)



=== Content from core.spip.net_e2e94795_20250124_181708.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
c8a519f5**

authored
Sep 28, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb)

### Report de r23200 : - ?exec=valider\_xml n'est executable que par les webmestres

```
- var_url ne doit pas contenir de ../../ ni de ..\..\ (windows)
- elle ne lance une action que si on a un var_token qui correspond soit a la signature de l'action en POST soit a la signature de l'action+var_url en GET. Ceci evite de faire lancer le validateur par un lien malveillant fourni a un webmstre d'un site auquel on a pas acces (CSRF)

(Nicolas Chatelain)
```

parent
[70b2fe39](/spip/spip/-/commit/70b2fe39b1124b8b29b0454ec3a58f235e78a9ef)

Loading

Loading

Loading

* [Changes
  1](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb)

[Hide whitespace changes](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?action=show&controller=projects%2Fcommit&id=c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb&namespace_id=spip&project_id=spip&r=23202&w=1)
[Inline](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?r=23202&view=inline)
[Side-by-side](/spip/spip/-/commit/c8a519f5ae8aba21db4f59b01ab3b3326b8e12eb?r=23202&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)



=== Content from core.spip.net_1be92401_20250124_181708.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
aa7059e3**

authored
Sep 29, 2016
by
**[![cerdic's avatar](https://secure.gravatar.com/avatar/dd4962c257035baf14bdcb6451b8f4dba99da3948dd83359ae88129b24315e06?s=96&d=identicon "cerdic")](/cerdic)
[cerdic](/cerdic)**

[Browse files](/spip/spip/-/tree/aa7059e36112853012b65b3d7eb253d69f68d23c)

### Report de r23093 : Prise en compte complete des entetes...

```
Report de r23093 : Prise en compte complete des entetes HTTP_X_FORWARDED_(FOR|HOST|PORT|PROTO) utilises conventionnellement lors de la prise en charge des hits par un proxy
(notamment pour gerer le https). On prend en compte les cas (rares) de double proxy, qui inserent possiblement des valeurs multiples dans HOST et FOR, separees par une virgule
Le risque d'empoisonnement du cache est garanti par le fait que HTTP_X_FORWARDED_HOST est injecte dans le contexte des caches, evitant de melanger les caches des hits servis avec et sans HTTP_X_FORWARDED_HOST
<https://core.spip.net/projects/spip/repository/entry/spip/ecrire/public/assembler.php#L226>
```

parent
[e0e00ea8](/spip/spip/-/commit/e0e00ea8224f0483a2db61df1d971239b0e146ac)

Loading

Loading

Loading

* [Changes
  2](/spip/spip/-/commit/aa7059e36112853012b65b3d7eb253d69f68d23c)

[Hide whitespace changes](/spip/spip/-/commit/aa7059e36112853012b65b3d7eb253d69f68d23c?action=show&controller=projects%2Fcommit&id=aa7059e36112853012b65b3d7eb253d69f68d23c&namespace_id=spip&project_id=spip&r=23203&w=1)
[Inline](/spip/spip/-/commit/aa7059e36112853012b65b3d7eb253d69f68d23c?r=23203&view=inline)
[Side-by-side](/spip/spip/-/commit/aa7059e36112853012b65b3d7eb253d69f68d23c?r=23203&view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment

Forge communautaire SPIP | [Charte d'utilisation](https://www.spip.net/fr_article6431.html) | [Signaler un problème sur ce site](https://git.spip.net/spip-contrib-outils/gitea_to_gitlab_migration/-/issues)



=== Content from www.openwall.com_c42d1c7e_20250124_181705.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](16) [[next>]](18) [[thread-next>]](../../../2016/10/06/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <db3c98e6-3e7d-c98b-7cb1-777cf7d484a3@sysdream.com>
Date: Wed, 5 Oct 2016 20:13:12 +0200
From: Sysdream Labs <labs@...dream.com>
To: oss-security@...ts.openwall.com
Cc: spip-team-owner@...o.net
Subject: SPIP vulnerabilities: request for 5 CVE

Hello,

We need 5 CVE ID for the following vulnerabilities found in SPIP <= 3.1.2 (<http://www.spip.net/>):

* Template Compiler/Composer PHP Code Execution
* Cross-Site Request Forgery
* Reflected Cross-Site Scripting
* File Enumeration / Path Traversal
* Server Side Request Forgery

Thank you in advance,

Best regards,

--
SYSDREAM Labs <labs@...dream.com>

GPG :
47D1 E124 C43E F992 2A2E
1551 8EB4 8CD9 D5B2 59A1

* Website: <https://sysdream.com/>
* Twitter: @sysdream

Download attachment "[signature.asc](17/1)" of type "application/pgp-signature" (820 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_93bc691c_20250124_181706.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](../../../2016/10/05/17) [[thread-next>]](../../../2016/10/07/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20161006151431.80DF36C58F9@smtpvmsrv1.mitre.org>
Date: Thu,  6 Oct 2016 11:14:31 -0400 (EDT)
From: cve-assign@...re.org
To: labs@...dream.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, spip-team-owner@...o.net
Subject: Re: SPIP vulnerabilities: request for 5 CVE

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Can you provide further information about whether each of these issues
could have been fixed independently?

We are aware of:

  <https://core.spip.net/projects/spip/repository/revisions/23200>
  <https://core.spip.net/projects/spip/repository/revisions/23201>
  <https://core.spip.net/projects/spip/repository/revisions/23202>

and these seem to indicate separate findings related to three
items on your list. Thus, we can initially assign these IDs:

> * Cross-Site Request Forgery

Use CVE-2016-7980.

> * Reflected Cross-Site Scripting

Use CVE-2016-7981.

> * File Enumeration / Path Traversal

Use CVE-2016-7982.

Is your reported Server Side Request Forgery a completely separate
problem? Is it resultant from an authorization issue, e.g., possibly
the wrong users have access to XML validation:

  -   if (!autoriser('sauvegarder')) {
  +   if (!autoriser('webmestre')) {

and also XML validation could be performed through CSRF? In other
words, is valider_xml.php supposed to block everyone from performing
an XML validation of an off-site document, or is it only supposed to
have access control for this functionality?

> * Template Compiler/Composer PHP Code Execution

Is there public information about this already on an spip.net web site
(such as a Redmine revision) or the <https://sysdream.com/news/lab/> web
site? Is this unrelated to the valider_xml.php script?

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJX9mnXAAoJEHb/MwWLVhi2/qcQAKEeOApYMW4Czdtc9dQYq5c1
BvrVK73txuLW346VYOGYB2HNp9b1RPoH34buXakJGXrhgyhbK/1fl1WILdUROuMs
UeEievyso1zudb2seSC/mPdvoyMfiKYQdQEvquQsuNNbdohR2TxA7i7k/33gpEoN
jQwsDCdm4xQQDPG5hrK39LmhboqgZtrYhZXetHWGloMMYWVMgoVOopdNXdMajXJ5
ycSlJoqMsMVWiZ4JKWPbEaFY7fJwHs3f5ZRa7WRRzAy6IdLQN/9Wo/awZsVTfe/s
mTC7bz3iiUCCu+XYWhmZGFG9JBBz4FL68CsYXw3tkjS8h0Gi4IsIKUc3ZiTm/2ee
boZiAJlRJETfgKozM/E3fyLytPeUX+2r8UI2SkkyjXM0JZ/r5NJuiaSumLo3sxst
bXsd5ruDb7FQyaQqkyPutti0Iz3gdM8MPqhGkwIG/xfDs6U/M9RFdPB91ShmuqWd
fYARzhJLsm+s2lQgMVzxLEAm7GVpJdORSRTW8JnlzxdeYy/Z/f1Nh6hxvi1pjGVO
voAvlQNNnVJYeWYoDwXBK0qF31CRNq5/wePt6JY1h92fwzgMo4w84Yny91qsHlY4
f0uaSduqB8DgO+P78X7fTai6T0j9i+6Qsnqukr9U/79Nt/tlmIJ+gs9DFF8RwQRz
IlWWaW48n/lLS/vAtKMl
=7eq2
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


