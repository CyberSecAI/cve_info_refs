=== Content from support.ntp.org_2916192b_20250125_145742.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)

# Security

##### Notification Policy

When we discover a security vulnerability in NTP we follow our Phased Vulnerability Process which includes first notifying Institutional members of the [NTP Consortium at Network Time Foundation](https://www.nwtime.org/membership/benefits/), then [CERT](https://www.sei.cmu.edu/about/divisions/cert/index.cfm), and finally making a public announcement.

[Institutional Members](https://www.nwtime.org/membership/benefits/#institutional-consortia-memberships) receive advanced notification of security vulnerabilities.

##### Security Patch Policy

When security patches are ready, they are first given to Premier and Partner Institutional members of the [NTP Consortium at Network Time Foundation](https://www.nwtime.org/membership/benefits/), then access instructions are provided to [CERT](https://www.sei.cmu.edu/about/divisions/cert/index.cfm), and finally the public release is made on the embargo date.

[Premier and Partner Members](https://www.nwtime.org/membership/benefits/#institutional-consortia-memberships) receive early access to security patches.

##### Reporting Security Issues

If you find a security vulnerability in the NTP codebase, please report it by **PGP-encrypted** email to the NTF Security Officer Team. You can use our [NTF Security Officer PGP Key](https://www.nwtime.org/about/documents/NTFSecurityOfficerPGPKey.txt). Please refrain from discussing potential security issues in any mailing lists or public forums.

**NOTE:** Non-code vulnerabilities (such as a website issue) should instead be reported to webmaster. Issues for subdomains of "pool.ntp.org" should be reported to the [NTP Pool Project](https://www.ntppool.org/en/mailinglists.html).

---

#### Known Vulnerabilities by Release Version

The following releases provided fixes for at least one security vulnerability. The table for each release provides an entry for each security issue (click its hyperlink to read the details for the vulnerability), indicates the issue’s severity, and provides the dates of advance notification to institutional members, advance release to premier and partner institutional members, and public release.

Refer to the [Release Timeline](https://www.ntp.org/dev/releasetimeline/) for a complete list of all releases, their public release dates, release announcements, and changelogs.

**Release Version:**

* [4.2.8p18](#428p18)
* [4.2.8p17](#428p17)
* [4.2.8p16](#428p16)
* [4.2.8p15](#428p15)
* [4.2.8p14](#428p14)
* [4.2.8p13](#428p13)
* [4.2.8p12](#428p12)
* [4.2.8p11](#428p11)
* [4.2.8p10](#428p10)
* [4.2.8p9](#428p9)
* [4.2.8p8](#428p8)
* [4.2.8p7](#428p7)
* [4.2.8p6](#428p6)
* [4.2.8p5](#428p5)
* [4.2.8p4](#428p4)
* [4.2.8p3](#428p3)
* [4.2.8p2](#428p2)
* [4.2.8p1](#428p1)
* [4.2.8](#428)
* [4.2.7p230](#427p230)
* [4.2.7p26](#427p26)
* [4.2.7p11](#427p11)
* [4.2.6](#426)
* [4.2.4p7](#424p7)
* [4.2.4p5](#424p5)

---

#### 4.2.8p18

* Public Release: 2024 May 25

No security fixes in this release.

---

#### 4.2.8p17

* Public Release: 2023 Jun 06

No security fixes in this release.

---

#### 4.2.8p16

* Advance Release: 2023 May 10
* Public Release: 2023 May 30

| Security Issue | Severity |
| --- | --- |
| [3808: ntpq will abort with an assertion failure given a malformed RT-11 date](https://www.ntp.org/support/securitynotice/ntpbug3808/) | NONE |
| [3807: praecis\_parse() in ntpd/refclock\_palisade.c can write out-of-bounds](https://www.ntp.org/support/securitynotice/ntpbug3807/) | LOW |
| [3806: libntp/mstolfp() needs bounds checking](https://www.ntp.org/support/securitynotice/ntpbug3806/) | LOW |
| [3767: An out-of-bounds KoD RATE ppoll value triggers an assertion abort in debug-enabled ntpd](https://www.ntp.org/support/securitynotice/ntpbug3767/) | LOW |

---

#### 4.2.8p15

* Advance Notification: 2020 Apr 07
* Advance Release: 2020 Apr 12
* Public Release: 2020 Jun 23

| Security Issue | Severity |
| --- | --- |
| [3661: Memory leak with CMAC keys](https://www.ntp.org/support/securitynotice/ntpbug3661/) | MEDIUM |

---

#### 4.2.8p14

* Advance Notification: 2019 Jun 05
* Advance Release: 2020 Feb 17
* Public Release: 2020 Mar 03

| Security Issue | Severity |
| --- | --- |
| [3610: `process_control()` should bail earlier on short packets](https://www.ntp.org/support/securitynotice/ntpbug3610/) | NONE |
| [3596: Unauthenticated and unmonitored `ntpd` may be susceptible to IPv4 attack from highly predictable transmit timestamps](https://www.ntp.org/support/securitynotice/ntpbug3596/) | MEDIUM |
| [3592: DoS Attack on Unauthenticated Client](https://www.ntp.org/support/securitynotice/ntpbug3592/) | MEDIUM |

---

#### 4.2.8p13

* Advance Notification: 2019 Jan 16
* Advance Release: 2019 Feb 20
* Public Release: 2019 Mar 07

| Security Issue | Severity |
| --- | --- |
| [3565: Crafted null dereference attack from a trusted source with an authenticated mode 6 packet](https://www.ntp.org/support/securitynotice/ntpbug3565/) | MEDIUM |

---

#### 4.2.8p12

* Advance Release: 2018 Jul 25
* Public Release: 2018 Aug 14

| Security Issue | Severity |
| --- | --- |
| [3505: NTPQ/NTPDC: Buffer Overflow in `openhost()`](https://www.ntp.org/support/securitynotice/ntpbug3505/) | LOW |
| [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012p12/) | LOW/MEDIUM |

---

#### 4.2.8p11

* Advance Notification: 2018 Jan 23
* Advance Release: 2018 Feb 12
* Public Release: 2018 Feb 27

| Security Issue | Severity |
| --- | --- |
| [3454: Unauthenticated packet can reset authenticated interleaved association](https://www.ntp.org/support/securitynotice/ntpbug3454/) | LOW/MEDIUM |
| [3453: Interleaved symmetric mode cannot recover from bad state](https://www.ntp.org/support/securitynotice/ntpbug3453/) | LOW |
| [3415: Provide a way to prevent authenticated symmetric passive peering](https://www.ntp.org/support/securitynotice/ntpbug3415/) | LOW |
| [3414: `ntpq: decodearr()` can write beyond its ‘buf’ limits](https://www.ntp.org/support/securitynotice/ntpbug3414/) | MEDIUM |
| [3412: `ctl_getitem()`: buffer read overrun leads to undefined behavior and information leak](https://www.ntp.org/support/securitynotice/ntpbug3412/) | INFO/MEDIUM |
| [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012/) | LOW/MEDIUM |

---

#### 4.2.8p10

* Public Release: 2017 Mar 21

| Security Issue | Severity |
| --- | --- |
| [3389: Denial of Service via Malformed Config](https://www.ntp.org/support/securitynotice/ntpbug3389/) | MEDIUM |
| [3388: Buffer Overflow in DPTS Clock](https://www.ntp.org/support/securitynotice/ntpbug3388/) | LOW |
| [3387: Authenticated DoS via Malicious Config Option](https://www.ntp.org/support/securitynotice/ntpbug3387/) | MEDIUM |
| [3386: `ntpq_stripquotes()` returns incorrect value](https://www.ntp.org/support/securitynotice/ntpbug3386/) | INFO |
| [3385: `ereallocarray() / eallocarray()` underused](https://www.ntp.org/support/securitynotice/ntpbug3385/) | INFO |
| [3384: Privileged execution of User Library code (Windows PPSAPI Only)](https://www.ntp.org/support/securitynotice/ntpbug3384/) | LOW |
| [3383: Stack Buffer Overflow from Command Line (Windows Installer Only)](https://www.ntp.org/support/securitynotice/ntpbug3383/) | LOW |
| [3382: Data Structure terminated insufficiently (Windows Installer Only)](https://www.ntp.org/support/securitynotice/ntpbug3382/) | LOW |
| [3381: Copious amounts of Unused Code](https://www.ntp.org/support/securitynotice/ntpbug3381/) | INFO |
| [3380: Off-by-one in Oncore GPS Receiver](https://www.ntp.org/support/securitynotice/ntpbug3380/) | LOW |
| [3379: Potential Overflows in `ctl_put()` functions](https://www.ntp.org/support/securitynotice/ntpbug3379/) | MEDIUM |
| [3378: Improper use of `snprintf()` in `mx4200_send()`](https://www.ntp.org/support/securitynotice/ntpbug3378/) | LOW |
| [3377: Buffer Overflow in `ntpq` when fetching `reslist` from a malicious `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug3377/) | MEDIUM |
| [3376: `Makefile` does not enforce Security Flags](https://www.ntp.org/support/securitynotice/ntpbug3376/) | INFO |
| [3361: 0rigin DoS](https://www.ntp.org/support/securitynotice/ntpbug3361/) | MEDIUM |

---

#### 4.2.8p9

* Public Release: 2016 Nov 21

| Security Issue | Severity |
| --- | --- |
| [3119: Mode 6 unauthenticated trap information disclosure and DDoS vector](https://www.ntp.org/support/securitynotice/ntpbug3119/) | MEDIUM |
| [3118: Mode 6 unauthenticated trap information disclosure and DDoS vector](https://www.ntp.org/support/securitynotice/ntpbug3118/) | MEDIUM |
| [3114: Broadcast Mode Replay Prevention DoS](https://www.ntp.org/support/securitynotice/ntpbug3114/) | LOW/MEDIUM |
| [3113: Broadcast Mode Poll Interval Enforcement DoS](https://www.ntp.org/support/securitynotice/ntpbug3113/) | LOW/MEDIUM |
| [3110: Windows: `ntpd` DoS by oversized UDP packet](https://www.ntp.org/support/securitynotice/ntpbug3110/) | HIGH |
| [3102: Zero Origin timestamp regression](https://www.ntp.org/support/securitynotice/ntpbug3102/) | MEDIUM |
| [3082: `read_mru_list()` does inadequate incoming packet checks](https://www.ntp.org/support/securitynotice/ntpbug3082/) | LOW |
| [3072: Attack on interface selection](https://www.ntp.org/support/securitynotice/ntpbug3072/) | LOW |
| [3071: Client rate limiting and server responses](https://www.ntp.org/support/securitynotice/ntpbug3071/) | LOW |
| [3067: Fix for bug 2085 broke initial sync calculations](https://www.ntp.org/support/securitynotice/ntpbug3067/) | LOW |

---

#### 4.2.8p8

Public Release: 2016 Jun 02

| Security Issue | Severity |
| --- | --- |
| [3046: `CRYPTO_NAK` crash](https://www.ntp.org/support/securitynotice/ntpbug3046/) | HIGH |
| [3045: Bad authentication demobilizes ephemeral associations](https://www.ntp.org/support/securitynotice/ntpbug3045/) | LOW |
| [3044: Processing spoofed server packets](https://www.ntp.org/support/securitynotice/ntpbug3044/) | LOW |
| [3043: Autokey association reset](https://www.ntp.org/support/securitynotice/ntpbug3043/) | LOW |
| [3042: Broadcast interleave](https://www.ntp.org/support/securitynotice/ntpbug3042/) | LOW |

---

#### 4.2.8p7

* Public Release: 2016 Apr 26

| Security Issue | Severity |
| --- | --- |
| [3020: Refclock impersonation vulnerability](https://www.ntp.org/support/securitynotice/ntpbug3020/) | LOW |
| [3011: Duplicate IPs on unconfig directives will cause an assertion botch in `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug3011/) | MEDIUM |
| [3010: remote configuration trustedkey/requestkey/controlkey values are not properly validated](https://www.ntp.org/support/securitynotice/ntpbug3010/) | MEDIUM |
| [3009: Crafted `addpeer` with `hmode` > 7 causes array wraparound with `MATCH_ASSOC`](https://www.ntp.org/support/securitynotice/ntpbug3009/) | LOW |
| [3008: `ctl_getitem()` return value not always checked](https://www.ntp.org/support/securitynotice/ntpbug3008/) | MEDIUM |
| [3007: `CRYPTO-NAK` DoS](https://www.ntp.org/support/securitynotice/ntpbug3007/) | MEDIUM/LOW |
| [2978: Interleave-pivot](https://www.ntp.org/support/securitynotice/ntpbug2978/) | MEDIUM |
| [2952: Original fix for NTP Bug 2901 broke peer associations](https://www.ntp.org/support/securitynotice/ntpbug2952/) | MEDIUM |
| [2946: Origin Leak: `ntpq` and `ntpdc` Disclose Origin Timestamp to Unauthenticated Clients](https://www.ntp.org/support/securitynotice/ntpbug2946/) | MEDIUM |
| [2879: Improve NTP security against buffer comparison timing attacks](https://www.ntp.org/support/securitynotice/ntpbug2879/) | LOW/MEDIUM |

---

#### 4.2.8p6

* Public Release: 2016 Jan 19

| Security Issue | Severity |
| --- | --- |
| [2948: Potential Infinite Loop in `ntpq`](https://www.ntp.org/support/securitynotice/ntpbug2948/) | MEDIUM |
| [2947: `ntpq` protocol vulnerable to replay attacks](https://www.ntp.org/support/securitynotice/ntpbug2947/) | MEDIUM |
| [2945: 0rigin: Zero Origin Timestamp Bypass](https://www.ntp.org/support/securitynotice/ntpbug2945/) | MEDIUM |
| [2942: Off-path Denial of Service (DoS) attack on authenticated broadcast mode](https://www.ntp.org/support/securitynotice/ntpbug2942/) | MEDIUM |
| [2940: Stack exhaustion in recursive traversal of restriction list](https://www.ntp.org/support/securitynotice/ntpbug2940/) | MEDIUM |
| [2939: `reslist` NULL pointer dereference](https://www.ntp.org/support/securitynotice/ntpbug2939/) | MEDIUM |
| [2938: `ntpq saveconfig` command allows dangerous characters in filenames](https://www.ntp.org/support/securitynotice/ntpbug2938/) | MEDIUM |
| [2937: `nextvar()` missing length check in `ntpq`](https://www.ntp.org/support/securitynotice/ntpbug2937/) | LOW |
| [2936: Skeleton Key: Any trusted key system can serve time](https://www.ntp.org/support/securitynotice/ntpbug2936/) | HIGH |
| [2935: Deja Vu: Replay attack on authenticated broadcast mode](https://www.ntp.org/support/securitynotice/ntpbug2935/) | MEDIUM |

---

#### 4.2.8p5

* Public Release: 2016 Jan 07

| Security Issue | Severity |
| --- | --- |
| [2956: Small-step/big-step](https://www.ntp.org/support/securitynotice/ntpbug2956/) | MEDIUM |

---

#### 4.2.8p4

* Public Release: 2015 Oct 21

| Security Issue | Severity |
| --- | --- |
| [2941: NAK to the Future: Symmetric association authentication bypass via crypto-NAK](https://www.ntp.org/support/securitynotice/ntpbug2941/) | LOW |
| [2922: `decodenetnum()` will ASSERT botch instead of returning FAIL on some bogus values](https://www.ntp.org/support/securitynotice/ntpbug2922/) | HIGH |
| [2921: TALOS-CAN-0065: Password Length Memory Corruption Vulnerability](https://www.ntp.org/support/securitynotice/ntpbug2921/) | HIGH |
| [2920: TALOS-CAN-0064: Invalid length data provided by a custom refclock driver could cause a buffer overflow](https://www.ntp.org/support/securitynotice/ntpbug2920/) | HIGH |
| [2919: TALOS-CAN-0063: `ntpq atoascii()` potential memory corruption](https://www.ntp.org/support/securitynotice/ntpbug2919/) | HIGH |
| [2918: TALOS-CAN-0062: Potential path traversal vulnerability in the config file saving of `ntpd` on VMS](https://www.ntp.org/support/securitynotice/ntpbug2918/) | HIGH |
| [2917: TALOS-CAN-0055: Infinite loop if extended logging enabled and the logfile and keyfile are the same](https://www.ntp.org/support/securitynotice/ntpbug2917/) | HIGH |
| [2916: TALOS-CAN-0054: memory corruption in password store](https://www.ntp.org/support/securitynotice/ntpbug2916/) | HIGH |
| [2913: TALOS-CAN-0052: mode 7 loop counter underrun](https://www.ntp.org/support/securitynotice/ntpbug2913/) | HIGH |
| [2909: Slow memory leak in `CRYPTO_ASSOC`](https://www.ntp.org/support/securitynotice/ntpbug2909/) | HIGH |
| [2902: Configuration directives to change “pidfile” and “driftfile” should only be allowed locally](https://www.ntp.org/support/securitynotice/ntpbug2902/) | HIGH |
| [2901: Clients that receive a KoD should validate the origin timestamp field](https://www.ntp.org/support/securitynotice/ntpbug2901/) | MEDIUM |
| [2899: Incomplete autokey data packet length checks](https://www.ntp.org/support/securitynotice/ntpbug2899/) | HIGH |

---

#### 4.2.8p3

* Advance Notification: 2015 Jun 22
* Advance Release: 2015 Jun 24
* Public Release: 2015 Jun 29

| Security Issue | Severity |
| --- | --- |
| [2853: ntpd control message crash: Crafted NUL-byte in configuration directive](https://www.ntp.org/support/securitynotice/ntpbug2853/) | LOW |

---

#### 4.2.8p2

* Advance Notification: 2015 Mar 15
* Advance Release: 2015 Mar 22
* Public Release: 2015 Apr 7

| Security Issue | Severity |
| --- | --- |
| [2781: Authentication doesn’t protect symmetric associations against DoS attacks](https://www.ntp.org/support/securitynotice/ntpbug2781/) | MEDIUM |
| [2779: ntpd accepts unauthenticated packets with symmetric key crypto](https://www.ntp.org/support/securitynotice/ntpbug2779/) | LOW |

---

#### 4.2.8p1

* Public Release: 2015 Feb 04

| Security Issue | Severity |
| --- | --- |
| [2672: ::1 can be spoofed on some OSes, so ACLs based on IPv6 ::1 addresses can be bypassed](https://www.ntp.org/support/securitynotice/ntpbug2672/) | MEDIUM |
| [2671: `vallen` is not validated in several places in `ntp_crypto.c`, leading to a potential info leak or possibly crashing `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug2671/) | LOW |

---

#### 4.2.8

* Public Release: 2014 Dec 18

| Security Issue | Severity |
| --- | --- |
| [2670: receive(): missing return on error](https://www.ntp.org/support/securitynotice/ntpbug2670/) | MEDIUM |
| [2669: Buffer overflow in configure()](https://www.ntp.org/support/securitynotice/ntpbug2669/) | HIGH |
| [2668: Buffer overflow in ctl\_putdata()](https://www.ntp.org/support/securitynotice/ntpbug2668/) | HIGH |
| [2667: Buffer overflow in crypto\_recv()](https://www.ntp.org/support/securitynotice/ntpbug2667/) | HIGH |

---

#### 4.2.7p230

* Public Release: 2011 Nov 1

| Security Issue | Severity |
| --- | --- |
| [2666: non-cryptographic random number generator with weak seed used by ntp-keygen to generate symmetric keys](https://www.ntp.org/support/securitynotice/ntpbug2666/) | HIGH |

---

#### 4.2.7p26

* Public Release: 2010 Apr 24

| Security Issue | Severity |
| --- | --- |
| [1532: DRDoS / Amplification Attack using ntpdc monlist command](https://www.ntp.org/support/securitynotice/ntpbug1532/) | MEDIUM |

---

#### 4.2.7p11

* Public Release: 2010 Jan 28

| Security Issue | Severity |
| --- | --- |
| [2665 :Weak default key in config\_auth()](https://www.ntp.org/support/securitynotice/ntpbug2665/) | HIGH |

---

#### 4.2.6

* Public Release: 2009 Dec 8

| Security Issue | Severity |
| --- | --- |
| [1331: DoS attack from certain NTP mode 7 packets](https://www.ntp.org/support/securitynotice/ntpbug1331/) | MEDIUM |

---

#### 4.2.4p7

* Public Release: 2009 Mar 4

| Security Issue | Severity |
| --- | --- |
| [1151: Remote exploit if autokey is enabled](https://www.ntp.org/support/securitynotice/ntpbug1151/) | MEDIUM |

#### 4.2.4p5

* Public Release: 2009 Jan 8

| Security Issue | Severity |
| --- | --- |
| [Multiple OpenSSL signature verification API misuse](https://nvd.nist.gov/vuln/detail/CVE-2009-0021) | MEDIUM |

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from bto.bluecoat.com_61a4965c_20250125_145744.html ===




=== Content from usn.ubuntu.com_b3dd5475_20250125_145749.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3707-2: NTP vulnerabilities

23 January 2019

Several security issues were fixed in NTP.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [ntp](/security/cves?package=ntp) - Network Time Protocol daemon and utility programs

## Details

USN-3707-1 and USN-3349-1 fixed several vulnerabilities in NTP. This update

provides the corresponding update for Ubuntu 12.04 ESM.

Original advisory details:

Miroslav Lichvar discovered that NTP incorrectly handled certain spoofed

addresses when performing rate limiting. A remote attacker could possibly

use this issue to perform a denial of service. ([CVE-2016-7426](/security/CVE-2016-7426))

Matthew Van Gundy discovered that NTP incorrectly handled certain crafted

broadcast mode packets. A remote attacker could possibly use this issue to

perform a denial of service. ([CVE-2016-7427](/security/CVE-2016-7427), [CVE-2016-7428](/security/CVE-2016-7428))

Matthew Van Gundy discovered that NTP incorrectly handled certain control

mode packets. A remote attacker could use this issue to set or unset traps.

([CVE-2016-9310](/security/CVE-2016-9310))

Matthew Van Gundy discovered that NTP incorrectly handled the trap service.

A remote attacker could possibly use this issue to cause NTP to crash, resulting

in a denial of service. ([CVE-2016-9311](/security/CVE-2016-9311))

It was discovered that the NTP legacy DPTS refclock driver incorrectly handled

the /dev/datum device. A local attacker could possibly use this issue to cause

a denial of service. ([CVE-2017-6462](/security/CVE-2017-6462))

It was discovered that NTP incorrectly handled certain invalid settings in a

:config directive. A remote authenticated user could possibly use this issue

to cause NTP to crash, resulting in a denial of service. ([CVE-2017-6463](/security/CVE-2017-6463))

Michael Macnair discovered that NTP incorrectly handled certain responses.

A remote attacker could possibly use this issue to execute arbitrary code.

([CVE-2018-7183](/security/CVE-2018-7183))

Miroslav Lichvar discovered that NTP incorrectly handled certain

zero-origin timestamps. A remote attacker could possibly use this issue to

cause a denial of service. ([CVE-2018-7185](/security/CVE-2018-7185))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [ntp](https://launchpad.net/ubuntu/%2Bsource/ntp)
  -
  [1:4.2.6.p3+dfsg-1ubuntu3.12](https://launchpad.net/ubuntu/%2Bsource/ntp/1%3A4.2.6.p3%2Bdfsg-1ubuntu3.12)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2016-7426](/security/CVE-2016-7426)
* [CVE-2016-7427](/security/CVE-2016-7427)
* [CVE-2016-7428](/security/CVE-2016-7428)
* [CVE-2016-9310](/security/CVE-2016-9310)
* [CVE-2016-9311](/security/CVE-2016-9311)
* [CVE-2017-6462](/security/CVE-2017-6462)
* [CVE-2017-6463](/security/CVE-2017-6463)
* [CVE-2018-7183](/security/CVE-2018-7183)
* [CVE-2018-7185](/security/CVE-2018-7185)

## Related notices

* [USN-3349-1](/security/notices/USN-3349-1)
* [USN-3707-1](/security/notices/USN-3707-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from nwtime.org_427d300f_20250125_145737.html ===
https://www.nwtime.org/news/ntp428p9\_release/

=== Content from support.hpe.com_744ec8dc_20250125_145748.html ===


[**Support Center**](/connect/s/)



=== Content from www.kb.cert.org_563c06ab_20250125_145750.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#633847

## NTP.org ntpd contains multiple denial of service vulnerabilities

#### Vulnerability Note VU#633847

Original Release Date: 2016-11-21 | Last Revised: 2017-11-20

---

### Overview

NTP.org ntpd versions ntp-4.2.7p385 up to but not including ntp-4.2.8p9 and ntp-4.3.0 up to but not including ntp-4.3.94 contain multiple denial of service vulnerabilities.

### Description

| NTP.org's ntpd, versions ntp-4.2.7p385 up to but not including ntp-4.2.8p9 and ntp-4.3.0 up to but not including ntp-4.3.94, contain multiple denial of service vulnerabilities.  [**CWE-476**](http://cwe.mitre.org/data/definitions/476.html)**: NULL Pointer Dereference -** CVE-2016-9311According to NTP.org, "ntpd does not enable trap service by default. If trap service has been explicitly enabled, an attacker can send a specially crafted packet to cause a null pointer dereference that will crash ntpd, resulting in a denial of service. Affects Windows only."[**CWE-400**](http://cwe.mitre.org/data/definitions/400.html)**: Uncontrolled Resource Consumption ('Resource Exhaustion') -** CVE-2016-9310According to NTP.org, "An exploitable configuration modification vulnerability exists in the control mode (mode 6) functionality of ntpd. If, against long-standing BCP recommendations, "restrict default noquery ..." is not specified, a specially crafted control mode packet can set ntpd traps, providing information disclosure and DDoS amplification, and unset ntpd traps, disabling legitimate monitoring. A remote, unauthenticated, network attacker can trigger this vulnerability."[**CWE-400**](http://cwe.mitre.org/data/definitions/400.html)**: Uncontrolled Resource Consumption ('Resource Exhaustion') -** CVE-2016-7427According to NTP.org, "The broadcast mode of NTP is expected to only be used in a trusted network. If the broadcast network is accessible to an attacker, a potentially exploitable denial of service vulnerability in ntpd's broadcast mode replay prevention functionality can be abused. An attacker with access to the NTP broadcast domain can periodically inject specially crafted broadcast mode NTP packets into the broadcast domain which, while being logged by ntpd, can cause ntpd to reject broadcast mode packets from legitimate NTP broadcast servers."[**CWE-400**](http://cwe.mitre.org/data/definitions/400.html)**: Uncontrolled Resource Consumption ('Resource Exhaustion') -** CVE-2016-7428According to NTP.org, "The broadcast mode of NTP is expected to only be used in a trusted network. If the broadcast network is accessible to an attacker, a potentially exploitable denial of service vulnerability in ntpd's broadcast mode poll interval enforcement functionality can be abused. To limit abuse, ntpd restricts the rate at which each broadcast association will process incoming packets. ntpd will reject broadcast mode packets that arrive before the poll interval specified in the preceding broadcast packet expires. An attacker with access to the NTP broadcast domain can send specially crafted broadcast mode NTP packets to the broadcast domain which, while being logged by ntpd, will cause ntpd to reject broadcast mode packets from legitimate NTP broadcast servers."[**CWE-410**](http://cwe.mitre.org/data/definitions/410.html)**: Insufficient Resource Pool -** CVE-2016-9312According to NTP.org, "If a vulnerable instance of ntpd on Windows receives a crafted malicious packet that is "too big", ntpd will stop working."[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2016-7431According to NTP.org, "Zero Origin timestamp problems were fixed by Bug 2945 in ntp-4.2.8p6. However, subsequent timestamp validation checks introduced a regression in the handling of some Zero origin timestamp checks."[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2016-7434According to NTP.org, "If ntpd is configured to allow mrulist query requests from a server that sends a crafted malicious packet, ntpd will crash on receipt of that crafted malicious mrulist query packet."[**CWE-605**](http://cwe.mitre.org/data/definitions/605.html)**: Multiple Binds to the Same Port -** CVE-2016-7429According to NTP.org, "When ntpd receives a server response on a socket that corresponds to a different interface than was used for the request, the peer structure is updated to use the interface for new requests. If ntpd is running on a host with multiple interfaces in separate networks and the operating system doesn't check source address in received packets (e.g. rp\_filter on Linux is set to 0), an attacker that knows the address of the source can send a packet with spoofed source address which will cause ntpd to select wrong interface for the source and prevent it from sending new requests until the list of interfaces is refreshed, which happens on routing changes or every 5 minutes by default. If the attack is repeated often enough (once per second), ntpd will not be able to synchronize with the source."[**CWE-410**](http://cwe.mitre.org/data/definitions/410.html)**: Insufficient Resource Pool -** CVE-2016-7426According to NTP.org, "When ntpd is configured with rate limiting for all associations (restrict default limited in ntp.conf), the limits are applied also to responses received from its configured sources. An attacker who knows the sources (e.g., from an IPv4 refid in server response) and knows the system is (mis)configured in this way can periodically send packets with spoofed source address to keep the rate limiting activated and prevent ntpd from accepting valid responses from its sources."[**CWE-682**](http://cwe.mitre.org/data/definitions/682.html)**: Incorrect Calculation -** CVE-2016-7433According to NTP.org, "Bug 2085 described a condition where the root delay was included twice, causing the jitter value to be higher than expected. Due to a misinterpretation of a small-print variable in The Book, the fix for this problem was incorrect, resulting in a root distance that did not include the peer dispersion. The calculations and formulae have been reviewed and reconciled, and the code has been updated accordingly."For more information, please see NTP.org's [security advisory](http://support.ntp.org/bin/view/Main/SecurityNotice#November_2016_ntp_4_2_8p9_NTP_Se).The CVSS score below is based on CVE-2016-9312. |
| --- |

### Impact

| A remote unauthenticated attacker may be able to perform a denial of service on ntpd. |
| --- |

### Solution

| **Implement BCP-38.**Use "restrict default noquery ..." in your ntp.conf file. Only allow mode 6 queries from trusted networks and hosts.**Apply an update**Upgrade to [4.2.8p9](nwtime.org/ntp428p9_release), or later, from the NTP Project Download Page or the NTP Public Services Project Download Page.**Monitor ntpd**Properly monitor your ntpd instances, and auto-restart ntpd (without -g) if it stops running. |
| --- |

### Vendor Information

633847
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23633847/) to view vendors.**
### [NTP Project](#GWAN-AFTSNE) Affected

Updated:  November 18, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [CoreOS](#BLUU-AFWNBD) Not Affected

Notified:  November 21, 2016  Updated: November 21, 2016

**Statement Date:   November 21, 2016**

### Status

Not Affected

### Vendor Statement

CoreOS Container Linux, by default, is not affected by this since ntpd is disabled.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [ACCESS](#BLUU-AFWNBT) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [AT&T](#BLUU-AFWNBP) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Alcatel-Lucent](#BLUU-AFWNBV) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Apple](#BLUU-AFWNBH) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Arch Linux](#BLUU-AFWNB6) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Arista Networks, Inc.](#BLUU-AFWNBK) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Aruba Networks](#BLUU-AFWNBM) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Avaya, Inc.](#BLUU-AFWNB4) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Barracuda Networks](#BLUU-AFWNBF) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Belkin, Inc.](#BLUU-AFWNB8) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Blue Coat Systems](#BLUU-AFWNDK) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Brocade Communication Systems](#BLUU-AFWNCG) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CA Technologies](#BLUU-AFWNDM) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CMX Systems](#BLUU-AFWND7) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CentOS](#BLUU-AFWNDR) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Check Point Software Technologies](#BLUU-AFWNDB) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Cisco](#BLUU-AFWNBA) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Contiki OS](#BLUU-AFWNCY) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [D-Link Systems, Inc.](#BLUU-AFWNFB) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Debian GNU/Linux](#BLUU-AFWNDT) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [DesktopBSD](#BLUU-AFWNDP) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [DragonFly BSD Project](#BLUU-AFWNEJ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [EMC Corporation](#BLUU-AFWNC8) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [EfficientIP SAS](#BLUU-AFWNCC) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Enterasys Networks](#BLUU-AFWNEZ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Ericsson](#BLUU-AFWNEC) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [European Registry for Internet Domains](#BLUU-AFWNFM) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Extreme Networks](#BLUU-AFWNCL) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [F5 Networks, Inc.](#BLUU-AFWNEX) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Fedora Project](#BLUU-AFWNEP) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Force10 Networks](#BLUU-AFWNEL) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Fortinet, Inc.](#BLUU-AFWNCA) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Foundry Brocade](#BLUU-AFWNCS) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [FreeBSD Project](#BLUU-AFWNEG) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [GNU adns](#BLUU-AFWNBR) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [GNU glibc](#BLUU-AFWNE3) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Gentoo Linux](#BLUU-AFWNBX) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Google](#BLUU-AFWNDF) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hardened BSD](#BLUU-AFWNDD) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hewlett Packard Enterprise](#BLUU-AFWNFH) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hitachi](#BLUU-AFWNDZ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Huawei Technologies](#BLUU-AFWNDH) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [IBM Corporation](#BLUU-AFWNEA) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Infoblox](#BLUU-AFWNE7) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Intel Corporation](#BLUU-AFWNF9) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Internet Systems Consortium](#BLUU-AFWNCE) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Internet Systems Consortium - DHCP](#BLUU-AFWNET) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [JH Software](#BLUU-AFWND9) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Juniper Networks](#BLUU-AFWNCU) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Lenovo](#BLUU-AFWNC4) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Lynx Software Technologies](#BLUU-AFWNDX) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [McAfee](#BLUU-AFWNFK) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Microchip Technology](#BLUU-AFWNF3) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Microsoft Corporation](#BLUU-AFWNCJ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NEC Corporation](#BLUU-AFWND3) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NLnet Labs](#BLUU-AFWNEV) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NetBSD](#BLUU-AFWNFD) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Nokia](#BLUU-AFWNDV) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Nominum](#BLUU-AFWND5) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OmniTI](#BLUU-AFWNER) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OpenBSD](#BLUU-AFWNCW) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OpenDNS](#BLUU-AFWNCN) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Openwall GNU/\*/Linux](#BLUU-AFWNE5) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Oracle Corporation](#BLUU-AFWNF7) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Oryx Embedded](#BLUU-AFWNFT) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Peplink](#BLUU-AFWNGD) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [PowerDNS](#BLUU-AFWNG5) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Q1 Labs](#BLUU-AFWNFF) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [QNX Software Systems Inc.](#BLUU-AFWNFZ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Quadros Systems](#BLUU-AFWNG9) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Red Hat, Inc.](#BLUU-AFWNHD) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Rocket RTOS](#BLUU-AFWNF5) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SUSE Linux](#BLUU-AFWNHA) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SafeNet](#BLUU-AFWNGV) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Secure64 Software Corporation](#BLUU-AFWNGH) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Slackware Linux Inc.](#BLUU-AFWNG3) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SmoothWall](#BLUU-AFWNFV) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Snort](#BLUU-AFWNGP) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Sony Corporation](#BLUU-AFWNH8) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Sourcefire](#BLUU-AFWNGR) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Symantec](#BLUU-AFWNFR) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [TCPWave](#BLUU-AFWNGT) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [TippingPoint Technologies Inc.](#BLUU-AFWNHF) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Tizen](#BLUU-AFWNFP) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [TrueOS](#BLUU-AFWNGK) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Turbolinux](#BLUU-AFWNG7) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Ubuntu](#BLUU-AFWNGX) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Unisys](#BLUU-AFWNGF) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [VMware](#BLUU-AFWNH3) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Wind River](#BLUU-AFWNGM) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [WizNET Technology](#BLUU-AFWNH5) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Xilinx](#BLUU-AFWNGZ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Zephyr Project](#BLUU-AFWNFX) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [ZyXEL](#BLUU-AFWNGB) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [dnsmasq](#BLUU-AFWNCQ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [gdnsd](#BLUU-AFWNBZ) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [m0n0wall](#BLUU-AFWNC6) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [openSUSE project](#BLUU-AFWNEE) Unknown

Notified:  November 21, 2016  Updated: November 21, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

View all 100 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.8 | AV:N/AC:L/Au:N/C:N/I:N/A:C |
| Temporal | 6.1 | E:POC/RL:OF/RC:C |
| Environmental | 6.1 | CDP:ND/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#November_2016_ntp_4_2_8p9_NTP_Se>
* <nwtime.org/ntp428p9_release>
### Acknowledgements

NTP.org thanks Matthew Van Gundy of Cisco, Robert Pajak, Sharon Goldberg and Aanchal Malhotra of Boston University, Magnus Stubman, Miroslav Lichvar of Red Hat, and Brian Utterback of Oracle for reporting these vulnerabilities.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2016-7426](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7426), [CVE-2016-7427](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7427), [CVE-2016-7428](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7428), [CVE-2016-7429](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7429), [CVE-2016-7431](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7431), [CVE-2016-7433](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7433), [CVE-2016-7434](http://web.nvd.nist.gov/vuln/detail/CVE-2016-7434), [CVE-2016-9310](http://web.nvd.nist.gov/vuln/detail/CVE-2016-9310), [CVE-2016-9312](http://web.nvd.nist.gov/vuln/detail/CVE-2016-9312) |
| --- | --- |
| **Date Public:** | 2016-11-21 |
| **Date First Published:** | 2016-11-21 |
| **Date Last Updated:** | 2017-11-20 15:38 UTC |
| **Document Revision:** | 26 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.ntp.org_2a8a3310_20250126_094106.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [4.2.8p9 Release Announcement](https://www.ntp.org/support/securitynotice/4_2_8p9-release-announcement/)

# 4.2.8p9 Release Announcement

Last update: June 28, 2022 21:06 UTC ([1f97faf40](https://git.nwtime.org/websites/ntpwww/commit/1f97faf40ebfcdfdee0201c3d607f8c2c9649d7b))

NTF’s NTP Project is releasing ntp-4.2.8p9 which addresses:

* 1 HIGH severity vulnerability that only affects Windows
* 2 MEDIUM severity vulnerabilities
* 2 MEDIUM/LOW severity vulnerabilities
* 5 LOW severity vulnerabilities
* 28 other non-security fixes and improvements

All of the security issues in this release are listed in [VU#633847](https://www.kb.cert.org/vuls/id/633847/).

ntp-4.2.8p9 is currently scheduled to be released on 21 November 2016.

* [3119: Trap crash](https://www.ntp.org/support/securitynotice/ntpbug3119/) / [CVE-2016-9311](https://nvd.nist.gov/vuln/detail/CVE-2016-9311)
  + Reported by Matthew Van Gundy of Cisco ASIG.
* [3118: Mode 6 unauthenticated trap information disclosure and DDoS vector](https://www.ntp.org/support/securitynotice/ntpbug3118/) / [CVE-2016-9310](https://nvd.nist.gov/vuln/detail/CVE-2016-9310)
  + Reported by Matthew Van Gundy of Cisco ASIG.
* [3114: Broadcast Mode Replay Prevention DoS](https://www.ntp.org/support/securitynotice/ntpbug3114/) / [CVE-2016-7427](https://nvd.nist.gov/vuln/detail/CVE-2016-7427)
  + Reported by Matthew Van Gundy of Cisco ASIG.
* [3113: Broadcast Mode Poll Interval Enforcement DoS](https://www.ntp.org/support/securitynotice/ntpbug3113/) / [CVE-2016-7428](https://nvd.nist.gov/vuln/detail/CVE-2016-7428)
  + Reported by Matthew Van Gundy of Cisco ASIG.
* [3110: Windows: ntpd DoS by oversized UDP packet](https://www.ntp.org/support/securitynotice/ntpbug3110/) / [CVE-2016-9312](https://nvd.nist.gov/vuln/detail/CVE-2016-9312)
  + Reported by Robert Pajak of ABB.
* [3102: Regression: 010-origin: Zero Origin Timestamp Bypass](https://www.ntp.org/support/securitynotice/ntpbug3102/) / [CVE-2016-7431](https://nvd.nist.gov/vuln/detail/CVE-2016-7431)
  + Reported by Sharon Goldberg and Aanchal Malhotra of Boston University.
* [3082: Null pointer dereference in \_IO\_str\_init\_static\_internal()](https://www.ntp.org/support/securitynotice/ntpbug3082/) / [CVE-2016-7434](https://nvd.nist.gov/vuln/detail/CVE-2016-7434)
  + Reported by Magnus Stubman.
* [3072: Interface selection attack](https://www.ntp.org/support/securitynotice/ntpbug3072/) / [CVE-2016-7429](https://nvd.nist.gov/vuln/detail/CVE-2016-7429)
  + Reported by Miroslav Lichvar of Red Hat.
* [3071: Client rate limiting and server responses](https://www.ntp.org/support/securitynotice/ntpbug3071/) / [CVE-2016-7426](https://nvd.nist.gov/vuln/detail/CVE-2016-7426)
  + Reported by Miroslav Lichvar of Red Hat.
* [3067: Reboot sync calculation problem](https://www.ntp.org/support/securitynotice/ntpbug3067/) / [CVE-2016-7433](https://nvd.nist.gov/vuln/detail/CVE-2016-7433)
  + Reported independently by Brian Utterback of Oracle, and by Sharon Goldberg and Aanchal Malhotra of Boston University.

ENotification of these issues were delivered to our Institutional members on a rolling basis as they were reported and as progress was made.

---

**Timeline:**

* 2016 Nov 21: Public release
* 2016 Nov 15: CERT given our software release notification
* 2016 Nov 14: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* : [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* : Report received

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from support.hpe.com_9f8b68d2_20250125_145747.html ===


[**Support Center**](/connect/s/)



=== Content from security.FreeBSD.org_5cc72134_20250125_145746.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:39.ntp Security Advisory
The FreeBSD Project
Topic: Multiple vulnerabilities of ntp
Category: contrib
Module: ntp
Announced: 2016-12-22
Credits: Network Time Foundation
Affects: All supported versions of FreeBSD.
Corrected: 2016-11-22 16:22:51 UTC (stable/11, 11.0-STABLE)
2016-12-22 16:19:05 UTC (releng/11.0, 11.0-RELEASE-p6)
2016-11-22 16:23:20 UTC (stable/10, 10.3-STABLE)
2016-12-22 16:19:05 UTC (releng/10.3, 10.3-RELEASE-p15)
2016-12-22 16:19:05 UTC (releng/10.2, 10.2-RELEASE-p28)
2016-12-22 16:19:05 UTC (releng/10.1, 10.1-RELEASE-p45)
2016-11-22 16:23:46 UTC (stable/9, 9.3-STABLE)
2016-12-22 16:19:05 UTC (releng/9.3, 9.3-RELEASE-p53)
CVE Name: CVE-2016-7426, CVE-2016-7427, CVE-2016-7428, CVE-2016-7431,
CVE-2016-7433, CVE-2016-7434, CVE-2016-9310, CVE-2016-9311
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The ntpd(8) daemon is an implementation of the Network Time Protocol (NTP)
used to synchronize the time of a computer system to a reference time
source.
Trap is a mechanism to collect NTP daemon information from remote.
II. Problem Description
Multiple vulnerabilities have been discovered in the NTP suite:
CVE-2016-9311: Trap crash, Reported by Matthew Van Gundy of Cisco ASIG.
CVE-2016-9310: Mode 6 unauthenticated trap information disclosure and DDoS
vector. Reported by Matthew Van Gundy of Cisco ASIG.
CVE-2016-7427: Broadcast Mode Replay Prevention DoS. Reported by
Matthew Van Gundy of Cisco ASIG.
CVE-2016-7428: Broadcast Mode Poll Interval Enforcement DoS. Reported by
Matthew Van Gundy of Cisco ASIG.
CVE-2016-7431: Regression: 010-origin: Zero Origin Timestamp Bypass.
Reported by Sharon Goldberg and Aanchal Malhotra of Boston University.
CVE-2016-7434: Null pointer dereference in \_IO\_str\_init\_static\_internal().
Reported by Magnus Stubman.
CVE-2016-7426: Client rate limiting and server responses. Reported by
Miroslav Lichvar of Red Hat.
CVE-2016-7433: Reboot sync calculation problem. Reported independently
by Brian Utterback of Oracle, and by Sharon Goldberg and Aanchal Malhotra
of Boston University.
III. Impact
A remote attacker who can send a specially crafted packet to cause a
NULL pointer dereference that will crash ntpd, resulting in a Denial of
Service. [CVE-2016-9311]
An exploitable configuration modification vulnerability exists in the
control mode (mode 6) functionality of ntpd. If, against long-standing
BCP recommendations, "restrict default noquery ..." is not specified,
a specially crafted control mode packet can set ntpd traps, providing
information disclosure and DDoS amplification, and unset ntpd traps,
disabling legitimate monitoring by an attacker from remote. [CVE-2016-9310]
An attacker with access to the NTP broadcast domain can periodically
inject specially crafted broadcast mode NTP packets into the broadcast
domain which, while being logged by ntpd, can cause ntpd to reject
broadcast mode packets from legitimate NTP broadcast servers.
[CVE-2016-7427]
An attacker with access to the NTP broadcast domain can send specially
crafted broadcast mode NTP packets to the broadcast domain which, while
being logged by ntpd, will cause ntpd to reject broadcast mode packets
from legitimate NTP broadcast servers. [CVE-2016-7428]
Origin timestamp problems were fixed in ntp 4.2.8p6. However, subsequent
timestamp validation checks introduced a regression in the handling of
some Zero origin timestamp checks. [CVE-2016-7431]
If ntpd is configured to allow mrulist query requests from a server
that sends a crafted malicious packet, ntpd will crash on receipt of
that crafted malicious mrulist query packet. [CVE-2016-7434]
An attacker who knows the sources (e.g., from an IPv4 refid in server
response) and knows the system is (mis)configured in this way can
periodically send packets with spoofed source address to keep the rate
limiting activated and prevent ntpd from accepting valid responses
from its sources. [CVE-2016-7426]
Ntp Bug 2085 described a condition where the root delay was included
twice, causing the jitter value to be higher than expected. Due to
a misinterpretation of a small-print variable in The Book, the fix
for this problem was incorrect, resulting in a root distance that did
not include the peer dispersion. The calculations and formulas have
been reviewed and reconciled, and the code has been updated accordingly.
[CVE-2016-7433]
IV. Workaround
No workaround is available, but systems not running ntpd(8) are not
affected. Network administrators are advised to implement BCP-38,
which helps to reduce the risk associated with these attacks.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
[FreeBSD 11.0]
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-11.0.patch
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-11.0.patch.asc
# gpg --verify ntp-11.0.patch.asc
[FreeBSD 10.x]
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-10.x.patch
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-10.x.patch.asc
# gpg --verify ntp-10.x.patch.asc
[FreeBSD 9.3]
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-9.3.patch
# fetch https://security.FreeBSD.org/patches/SA-16:39/ntp-9.3.patch.asc
# gpg --verify ntp-9.3.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart the applicable daemons, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r309009
releng/9.3/ r310419
stable/10/ r309008
releng/10.1/ r310419
releng/10.2/ r310419
releng/10.3/ r310419
stable/11/ r309007
releng/11.0/ r310419
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.16 (FreeBSD)
iQIzBAEBCgAdFiEEHPf/b631yp++G4yy7Wfs1l3PaucFAlhcqO8ACgkQ7Wfs1l3P
auesmRAAknI729Wvs8x4vWgn2ENXDNFBZUrdzcCHZtmnNRK8zjIhl8PzA47LxPwq
0+C7TdI6YPrsWqqovATUym/PinnGnZzvBa1tmzSAMUk9qfMLYbPsWB3haPCyIBN0
lM1eqJ9ir0WA9/msLE5oqJSDSpePo7BETkcP+kvdVLPsL3mJ4DltnqeV/MaAUYhF
Rru9UtYBnXelNJF14uEtJhATP9ImzdQuux8yJYfXaSebDKFfZVAkOkXqIHq1WdgM
UPGPDoOSYkOC4zRy/YSA0RaRilW1LNZOEg/8ImfWU87ArVDsaso+2xt71SsHGuG0
5TKfiN+xJPGNLh3XqXivbo3VcRw96cdzYGYRlcE1oG4mG8YaOPbTC0CI4u8RwJgd
PLqSsC1W6IgCKgOYJNok4/h1bEnmIMNisAy5gIvZjoR5+7frxEH5WNxbNBDR+jc9
NEtLp/Jp7Uk24+iYP8fok0IfwIhxCLMXq7NwIxHBAJ/7YeHQsOQ4EtDWbAe6BZQS
cWskAOJ9SZetOYprcWnm+EvkimKgzY5NGosWgC/1JznaRJv+bjOpLttd9ycAAHHE
iXS4L89LP4lHx135rU7LROARXIBCBQuG08y2me3CDA/dZbtRnZ9tJFCvVq8phz4y
Jttnh9zDfV7zjJ0MirQZ8EdIqNG2xGEgbfz9ctkzJVrVXXcjMOM=
=jR6z
-----END PGP SIGNATURE-----


=== Content from support.ntp.org_45e0e262_20250125_145740.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [NTP BUG 3114: Broadcast Mode Replay Prevention DoS](https://www.ntp.org/support/securitynotice/ntpbug3114/)

# NTP BUG 3114: Broadcast Mode Replay Prevention DoS

Last update: April 22, 2024 18:49 UTC ([7e7bd5857](https://git.nwtime.org/websites/ntpwww/commit/7e7bd5857f893277639b3765bf9347c4c6faa447))

---

#### Summary

| **Resolved** | [4.2.8p9](https://www.ntp.org/support/securitynotice/4_2_8p9-release-announcement/) | 21 Nov 2016 |
| --- | --- | --- |
| **References** | [Bug 3114](https://bugs.ntp.org/show_bug.cgi?id=3114) | [CVE-2016-7427](https://nvd.nist.gov/vuln/detail/CVE-2016-7427) |
| **Affects** | ntp-4.2.8p6, up to but not including ntp-4.2.8p9, and ntp-4.3.90 up to, but not including ntp-4.3.94 | Resolved in 4.2.8p9. |
| **CVSS2 Score** | LOW 3.3 | [AV:A/AC:L/Au:N/C:N/I:N/A:P](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:A/AC:L/Au:N/C:N/I:N/A:P)) |
| **CVSS3 Score** | MED 4.3 | [CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L) |

---

#### Description

The broadcast mode of NTP is expected to only be used in a trusted network. If the broadcast network is accessible to an attacker, a potentially exploitable denial of service vulnerability in `ntpd`’s broadcast mode replay prevention functionality can be abused. An attacker with access to the NTP broadcast domain can periodically inject specially crafted broadcast mode NTP packets into the broadcast domain which, while being logged by ntpd, can cause ntpd to reject broadcast mode packets from legitimate NTP broadcast servers.

---

#### Mitigation

* Implement [BCP-38.](http://www.bcp38.info/index.php/Main_Page)
* Upgrade to [4.2.8p9 or later.](https://downloads.nwtime.org/ntp/4.2.8/)
* Properly monitor your `ntpd` instances, and auto-restart `ntpd` (without `-g`) if it stops running.

---

#### Credit

This weakness was discovered by Matthew Van Gundy of Cisco.

---

#### Timeline

* 2016 Nov 21: Public release
* 2016 Nov 15: CERT given our software release notification
* 2016 Nov 14: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* : [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* : Report received

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from bugs.ntp.org_a6b14bb2_20250126_094113.html ===

[join](https://www.nwtime.org/membership/)

[donate](https://www.nwtime.org/donate/)

Network Time Foundation:
[NTP](https://www.nwtime.org/projects/ntp/ "Network Time Protocol Project")
• [Linux PTP](https://www.nwtime.org/projects/linuxptp/ "Linux Precision Time Protocol Project")
• [RADclock](https://www.nwtime.org/projects/radclock/ "Robust Absolute and Difference Clock Project")
• [GT API](https://www.nwtime.org/projects/timestamp-api/ "General Timestamp API Project")
• [More](http://networktimefoundation.org/projects/ "Other Projects")

---

[Help Us Continue the Legacy of Father Time by Donating to the
Mills-Spring Fund](https://www.nwtime.org/mills-spring/)
![](https://www.nwtime.org/images/support.jpg)

Bugzilla – Bug 3114
Broadcast Mode Replay Prevention DoS
Last modified: 2016-11-21 14:54:15 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3114&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3114&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

NTP users are strongly urged to take immediate action to ensure that their NTP daemons are not susceptible to being used in distributed denial-of-service (DDoS) attacks. Please also take this opportunity to defeat denial-of-service attacks by [implementing Ingress and Egress filtering through BCP38](http://www.bcp38.info/index.php/Main_Page "BCP38 Ingress/Egress filtering").

`ntp-4.2.8p18` was released on 25 May 2024 and addresses 40 bugs and provides 40 improvements.

Please see the [NTP 4.2.8p18 Changelog](https://www.ntp.org/support/securitynotice/4_2_8-series-changelog/#428p18 "4.2.8p18 Changelog") for details.

[**Bug 3114**](show_bug.cgi?id=3114)
- Broadcast Mode Replay Prevention DoS

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Broadcast Mode Replay Prevention DoS

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | ntp | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=ntp "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntpd ([show other bugs](buglist.cgi?component=ntpd&product=ntp&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.2.8 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 critical | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Harlan Stenn | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-09-13 04:54 UTC by Harlan Stenn | | --- | --- | | Modified: | 2016-11-21 14:54 UTC ([History](show_activity.cgi?id=3114)) | | CC List: | 5 users (show)  bugs matt-ntp mayer perlinger security | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | | Flags: | stenn: blocking4.2.8+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**changes from 4.2.8p8 / shot 1**](attachment.cgi?id=1445 "View the content of the attachment") (2.11 KB, patch)  [2016-09-13 19:37 UTC](#attach_1445 "Go to the comment associated with the attachment"), Juergen Perlinger | *no flags* | [Details](attachment.cgi?id=1445&action=edit) | [Diff](attachment.cgi?id=1445&action=diff) | | [**Python POC Script for reproducing bug**](attachment.cgi?id=1449 "View the content of the attachment") (1.91 KB, text/plain)  [2016-09-14 04:05 UTC](#attach_1449 "Go to the comment associated with the attachment"), Danny Mayer | *no flags* | [Details](attachment.cgi?id=1449&action=edit) | | [**broadcast-dos-bxmt.syslog.gz**](attachment.cgi?id=1452 "View the content of the attachment") (93.95 KB, application/x-gzip)  [2016-09-14 18:39 UTC](#attach_1452 "Go to the comment associated with the attachment"), Matthew Van Gundy | *no flags* | [Details](attachment.cgi?id=1452&action=edit) | | [**broadcast-dos-bxmt.pcap**](attachment.cgi?id=1453 "View the content of the attachment") (30.13 KB, application/octet-stream)  [2016-09-14 18:40 UTC](#attach_1453 "Go to the comment associated with the attachment"), Matthew Van Gundy | *no flags* | [Details](attachment.cgi?id=1453&action=edit) | | [**broadcast-dos-timelastrec.syslog.gz**](attachment.cgi?id=1454 "View the content of the attachment") (16.80 KB, application/x-gzip)  [2016-09-14 18:40 UTC](#attach_1454 "Go to the comment associated with the attachment"), Matthew Van Gundy | *no flags* | [Details](attachment.cgi?id=1454&action=edit) | | [**broadcast-dos-timelastrec.pcap**](attachment.cgi?id=1455 "View the content of the attachment") (5.90 KB, application/octet-stream)  [2016-09-14 18:40 UTC](#attach_1455 "Go to the comment associated with the attachment"), Matthew Van Gundy | *no flags* | [Details](attachment.cgi?id=1455&action=edit) | | [**step-problem.syslog.gz**](attachment.cgi?id=1456 "View the content of the attachment") (31.43 KB, application/x-gzip)  [2016-09-14 18:41 UTC](#attach_1456 "Go to the comment associated with the attachment"), Matthew Van Gundy | *no flags* | [Details](attachment.cgi?id=1456&action=edit) | | [**changes from 4.2.8p8 / shot 2**](attachment.cgi?id=1457 "View the content of the attachment") (2.67 KB, patch)  [2016-09-14 19:55 UTC](#attach_1457 "Go to the comment associated with the attachment"), Juergen Perlinger | *no flags* | [Details](attachment.cgi?id=1457&action=edit) | [Diff](attachment.cgi?id=1457&action=diff) | | [Show Obsolete](#a0) (3)  [Add an attachment](attachment.cgi?bugid=3114&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=3114&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3114#c0)  Harlan Stenn    2016-09-13 04:54:03 UTC   [Comment 1](show_bug.cgi?id=3114#c1)  Harlan Stenn    2016-09-13 04:57:02 UTC  ``` TALOS-CAN-0131 CVE-YYYY-NNNN  Network Time Protocol Broadcast Mode Replay Prevention Denial of Service Vulnerability   :: Summary  An exploitable denial of service vulnerability exists in the broadcast mode replay prevention functionality of ntpd.  To prevent replay of broadcast mode packets, ntpd rejects broadcast mode packets with non-monotonically increasing transmit timestamps.  Remote unauthenticated attackers can send specially crafted broadcast mode NTP packets to cause ntpd to reject all broadcast mode packets from legitimate NTP broadcast servers.   :: Tested Versions  NTP 4.2.8p6   :: Product URLs  <http://www.ntp.org/>   :: CVSS Scores  CVSSv2: 5.0 - (AV:N/AC:L/Au:N/C:N/I:N/A:P) CVSSv3: 5.3 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L   :: Details  In response to the NTP Deja Vu vulnerability (CVE-2015-7973), ntp-4.2.8p6 introduced several new integrity checks on incoming broadcast mode packets.  Upon receipt of a broadcast mode packet, before authentication is enforced, ntpd will reject the packet if any of the following conditions hold:  1. The packet poll value is out of bounds for the broadcast    association, i.e.          pkt->ppoll < peer->minpoll || pkt->ppoll > peer->maxpoll  2. The packet was received before a full poll interval has elapsed    since the last broadcast packet was received from the packet's    sender.  i.e. A server cannot ingress packets more frequently than    `peer->minpoll`.  3. The packet transmit timestamp is less than the last seen    broadcast packet transmit timestamp from the packet's sender.    i.e. Broadcast packet transmit timestamps must be monotonically    increasing.  The following logic is used to ensure that packet transmit timestamps are monotonically increasing:      /* ntp-4.2.8p6 ntpd/ntp_proto.c */     1305  if (MODE_BROADCAST == hismode) {     ...     1351      tdiff = p_xmt;     1352      L_SUB(&tdiff, &peer->bxmt);     1353      if (tdiff.l_i < 0) {     1354          msyslog(LOG_INFO, "receive: broadcast packet from %s contains non-monotonic timestamp: %#010x.%08x -> %#010x.%08x",     1355              stoa(&rbufp->recv_srcadr),     1356              peer->bxmt.l_ui, peer->bxmt.l_uf,     1357              p_xmt.l_ui, p_xmt.l_uf     1358              );     1359          ++bail;     1360      }     1361     1362      peer->bxmt = p_xmt;     1363     1364      if (bail) {     1365          peer->timelastrec = current_time;     1366          sys_declined++;     1367          return;     1368      }     1369  }  If the packet transmit timestamp is less than the transmit timestamp on the last received broadcast packet from this association (`p_xmt - peer->bxmt < 0`), the packet will be discarded.  Unfortunately, line 1362 updates the saved transmit timestamp for alleged sender of the packet (`peer->bxmt`) before the packet is discarded.  The update takes place even if the packet is unauthenticated and fails the previous integrity checks.  This leads to a trivial denial of service attack.  The attacker:  1. Discovers the IP address of the victim's broadcast server.    e.g. Send the victim a client mode NTP packet and discover the    broadcast server from the refid field of the victim's reply.  2. Every poll period, send the victim a spoofed broadcast mode    packet from the broadcast server with a transmit timestamp in the    future.  This will move `peer->bxmt` forward so that any    legitimate packet will be rejected by the non-monotonic timestamp    check.      - The attacker does not need to be on the same subnet as the       victim.  The attacker can address the spoofed broadcast NTP       packet directly to the victim's IP address.      - The attacker can choose any reasonably small estimate for the       poll period.  Because the `peer->bxmt` update happens even       when a packet fails the poll period checks, there is no       penalty for sending packets too frequently.  To prevent this vulnerability, `peer->bxmt` should only be updated when a packet authenticates correctly.  This is the approach taken in the patch below.   :: Mitigation  There is no workaround for this issue.  Because the vulnerable logic is executed before authentication is enforced, authentication and the `restrict notrust` ntpd.conf directive have no effect.  An attacker can bypass `notrust` restrictions by sending incorrectly authenticated packets.  In order to succeed in an attack, the attacker must send at least one spoofed packet per poll period.  Therefore observing more than one NTP broadcast packet from the same sender address per poll period indicates a possible attack.  The following patch can be used to fix this vulnerability:      From 097fd4dae9ac4927d7cfa8011fd42f704bd02c45 Mon Sep 17 00:00:00 2001     From: Matthew Van Gundy <mvangund@cisco.com>     Date: Tue, 26 Jan 2016 15:00:28 -0500     Subject: [PATCH] Fix unauthenticated broadcast mode denial of service (peer->bxmt)      ---      include/ntp_fp.h |  1 +      ntpd/ntp_proto.c | 22 ++++++++++++++++------      2 files changed, 17 insertions(+), 6 deletions(-)      diff --git a/include/ntp_fp.h b/include/ntp_fp.h     index 7806932..ad7a01d 100644     --- a/include/ntp_fp.h     +++ b/include/ntp_fp.h     @@ -242,6 +242,7 @@ typedef u_int32 u_fp;      #define  L_ISGTU(a, b) M_ISGTU((a)->l_ui, (a)->l_uf, (b)->l_ui, (b)->l_uf)      #define  L_ISHIS(a, b) M_ISHIS((a)->l_ui, (a)->l_uf, (b)->l_ui, (b)->l_uf)      #define  L_ISGEQ(a, b) M_ISGEQ((a)->l_ui, (a)->l_uf, (b)->l_ui, (b)->l_uf)     +#define  L_ISGEQU(a, b)  L_ISHIS(a, b)      #define  L_ISEQU(a, b) M_ISEQU((a)->l_ui, (a)->l_uf, (b)->l_ui, (b)->l_uf)       /*     diff --git a/ntpd/ntp_proto.c b/ntpd/ntp_proto.c     index ad45409..ac469ce 100644     --- a/ntpd/ntp_proto.c     +++ b/ntpd/ntp_proto.c     @@ -1305,7 +1305,6 @@ receive(         if (MODE_BROADCAST == hismode) {           u_char poll;           int bail = 0;     -     l_fp tdiff;            DPRINTF(2, ("receive: PROCPKT/BROADCAST: prev pkt %ld seconds ago, ppoll: %d, %d secs\n",                 (current_time - peer->timelastrec),     @@ -1348,9 +1347,8 @@ receive(             ++bail;           }      -     tdiff = p_xmt;     -     L_SUB(&tdiff, &peer->bxmt);     -     if (tdiff.l_i < 0) {     +     /* Use L_ISGEQU() to ensure unsigned comparison */     +     if (!L_ISGEQU(&p_xmt, &peer->bxmt)) {             msyslog(LOG_INFO, "receive: broadcast packet from %s contains non-monotonic timestamp: %#010x.%08x -> %#010x.%08x",               stoa(&rbufp->recv_srcadr),               peer->bxmt.l_ui, peer->bxmt.l_uf,     @@ -1359,8 +1357,6 @@ receive(             ++bail;           }      -     peer->bxmt = p_xmt;     -           if (bail) {             peer->timelastrec = current_time;             sys_declined++;     @@ -1563,6 +1559,14 @@ receive(       peer->xmt = p_xmt;        /*     +  * Now that we know the packet is correctly authenticated,     +  * update peer->bxmt if needed     +  */     + if (MODE_BROADCAST == hismode) {     +   peer->bxmt = p_xmt;     + }     +     + /*        * Set the peer ppoll to the maximum of the packet ppoll and the        * peer minpoll. If a kiss-o'-death, set the peer minpoll to        * this maximum and advance the headway to give the sender some     @@ -2400,6 +2404,7 @@ peer_clear(       )      {       u_char  u;     + l_fp bxmt = peer->bxmt;       #ifdef AUTOKEY       /*     @@ -2436,6 +2441,11 @@ peer_clear(       peer->flash = peer_unfit(peer);       peer->jitter = LOGTOD(sys_precision);      + /* Don't throw away our broadcast replay protection */     + if (peer->hmode == MODE_BCLIENT) {     +   peer->bxmt = bxmt;     + }     +       /*        * If interleave mode, initialize the alternate origin switch.        */   :: Credit  Discovered by Matthew Van Gundy of Cisco ASIG.   :: Timeline   2016-09-13 - Vendor Disclosure YYYY-MM-DD - Public Release ```  [Comment 2](show_bug.cgi?id=3114#c2)  Juergen Perlinger    2016-09-13 06:34:59 UTC  ``` This change set will also include the patch for [Bug 3113](show_bug.cgi?id=3113 "RESOLVED FIXED - Broadcast Mode Poll Interval Enforcement DoS"). ```  [Comment 3](show_bug.cgi?id=3114#c3)  Juergen Perlinger    2016-09-13 19:09:32 UTC  ``` I'm working my way through the diff manually, since it is against the GIT repo which is not quite the 4.2.8p8 release. AFAIK there has been trouble with the GIT export, which makes things awkward to handle. Anyway, I'll cope somehow.  But there is at least one issue: The snippet in  @@ -1348,9 +1347,8 @@ receive(  damages the compare op. Since the NTP time scale is seconds since 1900 (mod 2^32), a simple compare is not enough to handle the wrap-around / overflow. One has indeed to take the difference (mod 2^32) and check if the result is negative. So I won't apply that fragment, as it is definitely wrong. ```  [Comment 4](show_bug.cgi?id=3114#c4)  Juergen Perlinger    2016-09-13 19:37:49 UTC  ``` Created [attachment 1445](attachment.cgi?id=1445&action=diff "changes from 4.2.8p8 / shot 1") [[details]](attachment.cgi?id=1445&action=edit "changes from 4.2.8p8 / shot 1") changes from 4.2.8p8 / shot 1  Matthew, Harlan, and all who care about this: This is the consolidated patch (v.1) for the [Bug 3113](show_bug.cgi?id=3113 "RESOLVED FIXED - Broadcast Mode Poll Interval Enforcement DoS") + [Bug 3114](show_bug.cgi?id=3114 "RESOLVED FIXED - Broadcast Mode Replay Prevention DoS"). The patch is against the v4.2.8p8 release. Review and tests welcome. ```  [Comment 5](show_bug.cgi?id=3114#c5)  Matthew Van Gundy    2016-09-13 23:36:35 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=3114#c3)) > I'm working my way through the diff manually, since it is against the GIT repo > which is not quite the 4.2.8p8 release. AFAIK there has been trouble with the > GIT export, which makes things awkward to handle. Anyway, I'll cope somehow.  I'm sorry about that.  I'm guessing someone edited the disclosure in a non-whitespace-preserving editor before it made it out the door. :-/  I can provide a patch against 4.2.8p8 if you like.  > But there is at least one issue: The snippet in >  > @@ -1348,9 +1347,8 @@ receive( >  > damages the compare op. Since the NTP time scale is seconds since 1900 (mod > 2^32), a simple compare is not enough to handle the wrap-around / overflow. One > has indeed to take the difference (mod 2^32) and check if the result is > negative. So I won't apply that fragment, as it is definitely wrong.  I'm pretty sure that the current code doesn't handle wrap-around / overflow gracefully either, so I think they're equivalent on that criteria.  I changed:      tdiff = p_xmt;     L_SUB(&tdiff, &peer->bxmt);     if (tdiff.l_i < 0) { ...  to      if(!L_ISGEQU(&p_xmt, &peer->bxmt)){ ...  because the first code has a subtle bug.  If the incoming timestamp is non-monotonic (p_xmt < peer->bxmt), then it works as expected (tdiff.l_i < 0 == TRUE).  However, tdiff.l_i < 0 will also be true if p_xmt > peer->bxmt + 0x80000000.  So, if peer->bxmt currently contains a small value but a legitimate incoming p_xmt is greater than 2^31, the incoming packet will be rejected for having a non-monotonic timestamp.  This issue may have been obscured by the fact that peer->bxmt was being updated by packets that were failing the integrity check.  I changed it to an unsigned greater than or equal comparison to ensure that packets meeting p_xmt > peer->bxmt + 0x80000000 would not be rejected. ```  [Comment 6](show_bug.cgi?id=3114#c6)  Matthew Van Gundy    2016-09-13 23:40:13 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=3114#c4)) > Created [attachment 1445](attachment.cgi?id=1445&action=diff "changes from 4.2.8p8 / shot 1") [[details]](attachment.cgi?id=1445&action=edit "changes from 4.2.8p8 / shot 1") > changes from 4.2.8p8 / shot 1 >  > Matthew, Harlan, and all who care about this: This is the consolidated patch > (v.1) for the [Bug 3113](show_bug.cgi?id=3113 "RESOLVED FIXED - Broadcast Mode Poll Interval Enforcement DoS") + [Bug 3114](show_bug.cgi?id=3114 "RESOLVED FIXED - Broadcast Mode Replay Prevention DoS"). The patch is against the v4.2.8p8 release. > Review and tests welcome.  At first glance, the patch looks good modulo my previous comment.  I'll try to test it out tomorrow.  As an aside, I wasn't able to decrypt the disclosure archive that Regina sent to security@ntp.org.  Did it happen to include the PoC scripts that we developed? ```  [Comment 7](show_bug.cgi?id=3114#c7)  Danny Mayer    2016-09-14 03:04:45 UTC  ``` (In reply to [comment #6](show_bug.cgi?id=3114#c6)) >  > As an aside, I wasn't able to decrypt the disclosure archive that Regina sent > to security@ntp.org.  Did it happen to include the PoC scripts that we > developed?  Yes. There are two py files in there.One for timelastrec-poc and the other for bxmt-poc.  Danny ```  [Comment 10](show_bug.cgi?id=3114#c10)  Juergen Perlinger    2016-09-14 05:49:34 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=3114#c5)) > (In reply to [comment #3](show_bug.cgi?id=3114#c3)) > > I'm working my way through the diff manually, since it is against the GIT repo > > which is not quite the 4.2.8p8 release. AFAIK there has been trouble with the > > GIT export, which makes things awkward to handle. Anyway, I'll cope somehow. >  > I'm sorry about that.  I'm guessing someone edited the disclosure in a > non-whitespace-preserving editor before it made it out the door. :-/  I can > provide a patch against 4.2.8p8 if you like.  There have been some other changes, too -- it's not just whitespace. As I said, just a nuisance, not a problem.  >  > > But there is at least one issue: The snippet in > >  > > @@ -1348,9 +1347,8 @@ receive( > >  > > damages the compare op. Since the NTP time scale is seconds since 1900 (mod > > 2^32), a simple compare is not enough to handle the wrap-around / overflow. One > > has indeed to take the difference (mod 2^32) and check if the result is > > negative. So I won't apply that fragment, as it is definitely wrong. >  > I'm pretty sure that the current code doesn't handle wrap-around / overflow > gracefully either, so I think they're equivalent on that criteria.  I changed: >  >     tdiff = p_xmt; >     L_SUB(&tdiff, &peer->bxmt); >     if (tdiff.l_i < 0) { ... >  > to >  >     if(!L_ISGEQU(&p_xmt, &peer->bxmt)){ ... >  > because the first code has a subtle bug.  If the incoming timestamp is > non-monotonic (p_xmt < peer->bxmt), then it works as expected (tdiff.l_i < 0 == > TRUE).  However, tdiff.l_i < 0 will also be true if p_xmt > peer->bxmt + > 0x80000000.  So, if peer->bxmt currently contains a small value but a > legitimate incoming p_xmt is greater than 2^31, the incoming packet will be > rejected for having a non-monotonic timestamp.  This issue may have been > obscured by the fact that peer->bxmt was being updated by packets that were > failing the integrity check.  I changed it to an unsigned greater than or equal > comparison to ensure that packets meeting p_xmt > peer->bxmt + 0x80000000 would > not be rejected.  That's the problem when doing calculations in a number ring... Conceptually we have to split the interval (2^32) into a range that is considered 'forward' and one that is 'backward'. The sum of both ranges must not be bigger than the full range. So I took the same split as two's complement does on signed numbers, making 0x8000000 the most negative(!) value. As a result, x+0x8000000 becomes conceptually smaller than x.  It might make sense the check for tdiff <= 0 instead of tdiff < 0 -- this would weed out equal time stamps, too.  But believe it or not, the diff+comp code handles the era rollover ;) hint:  a < b          ===  a - b < 0            obvious for (unlimited) numbers a < b  (mod N) !=! a - b (mod N) < 0     that's what we have here  == ```  [Comment 11](show_bug.cgi?id=3114#c11)  Juergen Perlinger    2016-09-14 06:07:14 UTC  ``` Oh, I forgot to mention one little issue: When the rollover happens while NTPD is running, your code throws away all time stamps after the rollover, effectively disabling the broadcast sync mechanism.  If it's a consolidation, the first time I had to tackle this kind of problem I needed pen&paper to work it out... ;) It was an industrial control with a timer based on a 32-bit millisecond value. And after 28 days and a few hours the thing got stuck. Product management was not amused and I was fire-jumper like dropped onto the bug to squash it. Wasn't my code, so I had some interesting time to find out what happened... it was exactly the same kind of era rollover problem, just with a much shorter cycle. ```  [Comment 12](show_bug.cgi?id=3114#c12)  Matthew Van Gundy    2016-09-14 18:39:12 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=3114#c10)) > But believe it or not, the diff+comp code handles the era rollover ;) hint:  Ack!  Got it.  The fix against TALOS-CAN-0131 appears to be good.  Because `peer->bxmt` is not updated until after authentication is verified, the spoofed packets cannot move `peer->bxmt` forward causing legitimate broadcasts to be rejected as `non-monotonic`.  See: broadcast-dos-bxmt.syslog.gz, broadcast-dos-bxmt.pcap   It also appears that the TALOS-CAN-0130 works as expected. Spoofed packets are rejected with messages such as:      Sep 14 17:55:15 vagrant-ubuntu-trusty-32 ntpd: 14 Sep 17:55:15 ntpd[12719]: receive: broadcast packet from 192.168.33.10 arrived after 2, not 8 seconds!  and the association remains functional as long as the peer has been configured with `disable unpeer_digest_early`.  See: broadcast-dos-timelastrec.syslog.gz, broadcast-dos-timelastrec.pcap   However, it appears that there is something wrong with the logic when stepping.  After the client STEPs its clock      Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd[11993]: 0.0.0.0 c61c 0c clock_step +2.026588 s     Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd: 14 Sep 14:54:00 ntpd[11993]: 0.0.0.0 c61c 0c clock_step +2.0265     88 s     Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd: event at 185 0.0.0.0 c61c 0c clock_step +2.026588 s  all subsequent broadcast packets are rejected with:      Sep 14 14:54:09 vagrant-ubuntu-trusty-32 ntpd[11993]: receive: broadcast packet from 192.168.33.10 contains non-monotonic timestamp: 0000000000.00000000 -> 0xdb83e311.93c5f637  See: step-problem.syslog.gz  Could this have to do with throwing away timestamps as mentioned in [Comment #11](show_bug.cgi?id=3114#c11)?   I also happened to encounter a "known issue".  After running the broadcast-dos-bxmt attack for quite a while, the attack packet send times happened to match up precisely with the poll period and began to cause the association to flap causing a DoS condition.  This is because the testbed was configured with `enable unpeer_digest_early` causing any unauthenticated incoming packets that were not rejected for arriving too early to tear down the association.  I had to configure `disable unpeer_digest_early` in further testing. ```  [Comment 13](show_bug.cgi?id=3114#c13)  Matthew Van Gundy    2016-09-14 18:39:59 UTC  ``` Created [attachment 1452](attachment.cgi?id=1452 "broadcast-dos-bxmt.syslog.gz") [[details]](attachment.cgi?id=1452&action=edit "broadcast-dos-bxmt.syslog.gz") broadcast-dos-bxmt.syslog.gz ```  [Comment 14](show_bug.cgi?id=3114#c14)  Matthew Van Gundy    2016-09-14 18:40:17 UTC  ``` Created [attachment 1453](attachment.cgi?id=1453 "broadcast-dos-bxmt.pcap") [[details]](attachment.cgi?id=1453&action=edit "broadcast-dos-bxmt.pcap") broadcast-dos-bxmt.pcap ```  [Comment 15](show_bug.cgi?id=3114#c15)  Matthew Van Gundy    2016-09-14 18:40:37 UTC  ``` Created [attachment 1454](attachment.cgi?id=1454 "broadcast-dos-timelastrec.syslog.gz") [[details]](attachment.cgi?id=1454&action=edit "broadcast-dos-timelastrec.syslog.gz") broadcast-dos-timelastrec.syslog.gz ```  [Comment 16](show_bug.cgi?id=3114#c16)  Matthew Van Gundy    2016-09-14 18:40:54 UTC  ``` Created [attachment 1455](attachment.cgi?id=1455 "broadcast-dos-timelastrec.pcap") [[details]](attachment.cgi?id=1455&action=edit "broadcast-dos-timelastrec.pcap") broadcast-dos-timelastrec.pcap ```  [Comment 17](show_bug.cgi?id=3114#c17)  Matthew Van Gundy    2016-09-14 18:41:27 UTC  ``` Created [attachment 1456](attachment.cgi?id=1456 "step-problem.syslog.gz") [[details]](attachment.cgi?id=1456&action=edit "step-problem.syslog.gz") step-problem.syslog.gz ```  [Comment 18](show_bug.cgi?id=3114#c18)  Juergen Perlinger    2016-09-14 19:34:05 UTC  ``` (In reply to [comment #12](show_bug.cgi?id=3114#c12)) > (In reply to [comment #10](show_bug.cgi?id=3114#c10)) > Ack!  Got it.   ;) This kind of logic is always mind-boggling.  >  > However, it appears that there is something wrong with the logic when > stepping.  After the client STEPs its clock >  >     Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd[11993]: 0.0.0.0 c61c 0c > clock_step +2.026588 s >     Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd: 14 Sep 14:54:00 ntpd[11993]: > 0.0.0.0 c61c 0c clock_step +2.0265 >     88 s >     Sep 14 14:54:00 vagrant-ubuntu-trusty-32 ntpd: event at 185 0.0.0.0 c61c 0c > clock_step +2.026588 s >  > all subsequent broadcast packets are rejected with: >  >     Sep 14 14:54:09 vagrant-ubuntu-trusty-32 ntpd[11993]: receive: broadcast > packet from 192.168.33.10 contains non-monotonic timestamp: 0000000000.00000000 > -> 0xdb83e311.93c5f637 >  > See: step-problem.syslog.gz >  > Could this have to do with throwing away timestamps as mentioned > in [Comment #11](show_bug.cgi?id=3114#c11)? >  Oh! Yes. Looking at the old code, one can see that the first BC packet would be dumped because of the monotonic-check. (The highest bit in the time stamp is already set, and the peer's bxmt is zero: being more than the half interval ahead accounts to being in the past.)  BUT: the previous code set the bxmt time stamp nevertheless before bailing out. So at least the *next* BC packet would be used... Since we now make sure we update bxmt only if the packet is valid, this never happens due to a chicken/egg problem. I guess we have to make sure we execute the check only if p->bxmt is not all-zero, because otherwise the chicken never hatches.  Which leaves us a few problems when really stepping the clock backwards: Because now the time stamps we get are 'before' the last BC we accepted, BC packets will be rejected until the clock has recovered the time interval it had to step backwards. And *this* will be a real bugger if the step is a major one. OTOH, most system that need a major step after startup come up late because of missing battery-backed clocks or alike, and forward steps are not the real problem unless the jump is more than 68 years ahead.  I'll try to make sure the BCLIENT chicken can hatch, but the back-step problem needs more consideration before we can call it a day. ```  [Comment 19](show_bug.cgi?id=3114#c19)  Juergen Perlinger    2016-09-14 19:44:23 UTC  ``` And now it was my turn to get confused. The step problem arises when the BC *server* has a backstep. Which should not really happen, so maybe it's only the initial-value problem we have. I'm working on that. ```  [Comment 20](show_bug.cgi?id=3114#c20)  Juergen Perlinger    2016-09-14 19:55:48 UTC  ``` Created [attachment 1457](attachment.cgi?id=1457&action=diff "changes from 4.2.8p8 / shot 2") [[details]](attachment.cgi?id=1457&action=edit "changes from 4.2.8p8 / shot 2") changes from 4.2.8p8 / shot 2  This patch (also against a fresh 4.2.8p8 tree) should fix the initial-value problem with peer->bxmt. ```  [Comment 21](show_bug.cgi?id=3114#c21)  Matthew Van Gundy    2016-09-15 17:24:00 UTC  ``` (In reply to [comment #18](show_bug.cgi?id=3114#c18)) > Oh! Yes. Looking at the old code, one can see that the first BC packet would be > dumped because of the monotonic-check. (The highest bit in the time stamp is > already set, and the peer's bxmt is zero: being more than the half interval > ahead accounts to being in the past.)  I don't think it was an initial value problem.  The initial value of peer->bxmt gets set correctly just after newpeer() is called during association mobilization (when handling case AM_NEWBCL).  Also, peer_clear() was patched to preserve peer->bxmt when peer->hmode == MODE_BCLIENT.  I think the problem is that, if the client executes an initial volley and the clock is stepped during the initial volley, peer->hmode != MODE_BCLIENT so peer->bxmt isn't preserved.  I think your latest patch solves the case for when peer->bxmt gets cleared.  However, we could just preserve peer->bxmt in peer_clear() if peer->hmode == MODE_BCLIENT || (FLAG_BC_VOL & peer->flags).  The one caveat to this is that it looks like there may be a code path in process_packet() where FLAG_BC_VOL is cleared without peer->hmode being updated to MODE_BCLIENT:  		/* 		 * When calibration is complete and the clock is 		 * synchronized, the bias is calculated as the difference 		 * between the unicast timestamp and the broadcast 		 * timestamp. This works for both basic and interleaved 		 * modes. 		 * [[Bug 3031](show_bug.cgi?id=3031 "RESOLVED FIXED - ntp broadcastclient unable to synchronize to an server when the time of server changed")] Don't keep this peer when the delay  		 * calculation gives reason to suspect clock steps. 		 * This is assumed for delays > 50ms. 		 */ 		if (FLAG_BC_VOL & peer->flags) { 			peer->flags &= ~FLAG_BC_VOL; 			peer->delay = fabs(peer->offset - p_offset) * 2; 			DPRINTF(2, ("broadcast volley: initial delay=%.6f\n", 				peer->delay)); 			if (peer->delay > fabs(sys_bdelay)) { 		bcc_init_volley_fail: 				DPRINTF(2, ("%s", "broadcast volley: initial delay exceeds limit\n")); 				unpeer(peer); 				return; 			} 		} ```  [Comment 23](show_bug.cgi?id=3114#c23)  Harlan Stenn    2016-10-28 03:07:29 UTC  ``` Matt,  I'm going to comment on a number of things.  First, broadcast mode is useful in TRUSTED ENVIRONMENTS.  It specifically uses authentication by default.  There are known risks for its use in hostile environments.  In [comment #1](show_bug.cgi?id=3114#c1) you say:  > 2. The packet was received before a full poll interval has elapsed >    since the last broadcast packet was received from the packet's >    sender.  i.e. A server cannot ingress packets more frequently than >   `peer->minpoll`.  The 2nd sentence is correct, but inaccurate.  The broadcast minpoll need not be the same value as the broadcast maxpoll.  The condition is minpoll <= maxpoll.  I submit that a better sentence is:  i.e. A server cannot ingress packets more frequently than the current active broadcast association's poll interval.  Next, the reason for updating bxmt on each "acceptable" packet is specifically to avoid the situation where a packet with a future timestamp prevents the client from syncing until the clock reaches that future moment.  That's another DoS vector.  We can tweak the definition of "acceptable".  We log the receipt of unexpected packets.  We tell people to monitor their ntpd instances.  This monitoring should include their log files.  The current "fuzz" on broadcasts is 3 seconds.  We picked that number as smaller numbers caused too many log messages.  But we *could* let folks tweak this number.  You also talk about unpeer_digest_early.  This is a "choose your poison" issue.  The default behavior protects against one form of abuse, creating increased risk from the attack vector you describe.  Disabling unpeer_digest_early reduces the risk of the vector you describe, but it increases other risks.  If a broadcast server steps its time, that step could be either forward or backward.  We want clients to notice and follow this as soon as possible.  Granted, we're talking about broadcast mode here, so it will take a number of poll intervals for this to be noticed.  It seems to me we don't want to extend the time it takes for a broadcast client to synchronize to its broadcast server.  If folks are running broadcast mode and are seeing these attacks, the first thing they should do is evaluate whether or not they really should be using broadcast mode.  If that's still desirable, about the only other thing we can do is decide what else we can tweak.  This might be the fuzz, this might be something else.  But broadcast mode is not the best choice for hostile environments.  Do you think I'm missing something? ```  [Comment 24](show_bug.cgi?id=3114#c24)  Harlan Stenn    2016-11-09 13:11:06 UTC  ``` I've gently tweaked the patch and added a new 'tos bcpollbstep N' ntp.conf option, 0-4 allowed, default of 0, which says how many poll intervals need to pass before a backward broadcast timestamp will be believed. ```  [Comment 25](show_bug.cgi?id=3114#c25)  Harlan Stenn    2016-11-13 20:00:34 UTC  ``` Matt,  I think your CVSS scores are too high.  While AV:N is possible, it seems unreasonable.  AV:A is more reasonable.  NTP Broadcasts are *only* expected to be used on trusted network domains.  AV:N is clearly not a trusted network domain.  And the presence of a replay attack is evidence that the given network domain is not trustable. ```  [Comment 26](show_bug.cgi?id=3114#c26)  Matthew Van Gundy    2016-11-14 21:39:59 UTC  ``` (In reply to [comment #23](show_bug.cgi?id=3114#c23)) > I submit that a better sentence is:  i.e. A server cannot ingress packets more > frequently than the current active broadcast association's poll interval.  Fair enough.  I believe my original intention was that to indicate that there is a floor under the minimum poll period.  > Next, the reason for updating bxmt on each "acceptable" packet is specifically > to avoid the situation where a packet with a future timestamp prevents the > client from syncing until the clock reaches that future moment.  That's another > DoS vector.  We can tweak the definition of "acceptable".  The crux of this issue is that the timestamps are being updated by "unacceptable" packets that are discarded in addition to "acceptable" packets.  > We log the receipt of unexpected packets.  We tell people to monitor their ntpd > instances.  This monitoring should include their log files. >  > The current "fuzz" on broadcasts is 3 seconds.  We picked that number as > smaller numbers caused too many log messages.  But we *could* let folks tweak > this number. >  > You also talk about unpeer_digest_early.  This is a "choose your poison" issue. >  The default behavior protects against one form of abuse, creating increased > risk from the attack vector you describe.  Disabling unpeer_digest_early > reduces the risk of the vector you describe, but it increases other risks.  My mention of unpeer_digest_early was merely to indicate the configuration that was necessary to test the functionality.  Though, I'm curious, what risks are increased by disabling "unpeer_digest_early"?  I'm not aware of any.  > If a broadcast server steps its time, that step could be either forward or > backward.  We want clients to notice and follow this as soon as possible.  > Granted, we're talking about broadcast mode here, so it will take a number of > poll intervals for this to be noticed.  It seems to me we don't want to extend > the time it takes for a broadcast client to synchronize to its broadcast > server. >  > If folks are running broadcast mode and are seeing these attacks, the first > thing they should do is evaluate whether or not they really should be using > broadcast mode.  If that's still desirable, about the only other thing we can > do is decide what else we can tweak.  This might be the fuzz, this might be > something else. >  > But broadcast mode is not the best choice for hostile environments. >  > Do you think I'm missing something?  If it is the case that broadcast mode should only be used in trusted environments, then I agree that attempts at replay (and DoS) prevention are somewhat superfluous.  Should RFC 5905 and the NTP documentation be updated to indicate that broadcast mode should only be used in trusted environments without malicious actors?  The closest thing I've seen is <https://www.eecis.udel.edu/~mills/ntp/html/authentic.html> which doesn't really convey that broadcast is unsafe outside of trusted networks (in fact, it assumes an untrusted network):      In the case of unsolicited packets which might consume     significant resources, such as broadcast or symmetric mode     packets, , authentication is required, unless overridden by a     disable auth command. In the current climate of targeted     broadcast or "letterbomb" attacks, defeating this requirement     would be decidedly dangerous. ```  [Comment 27](show_bug.cgi?id=3114#c27)  Matthew Van Gundy    2016-11-14 22:12:56 UTC  ``` (In reply to [comment #25](show_bug.cgi?id=3114#c25)) > Matt, >  > I think your CVSS scores are too high.  While AV:N is possible, it seems > unreasonable.  AV:A is more reasonable. >  > NTP Broadcasts are *only* expected to be used on trusted network domains.  AV:N > is clearly not a trusted network domain.  And the presence of a replay attack > is evidence that the given network domain is not trustable.  Hi Harlan,  I took another look at it and AV:N is correct.  AV specifies the level of access that an attacker must have in order to successfully exploit the vulnerability, and an attacker can readily exploit this vulnerability from a non-adjacent network.  To exploit this DoS, the attacker does not need to be able to sniff or replay packets.  The attacker need only spoof the source address of the broadcast server.  Because ntpd does not use the packet destination address to determine which association an incoming packet belongs to an attacker can target any NTP broadcast client by sending the spoofed packets with: srcaddr=broadcast_server_ip, dstaddr=victim_ip  Though it's not needed for this attack, if the victim's local subnet allows ingress of broadcast packets, the attacker could also use: srcaddr=broadcast_server_ip, dstaddr=subnet_broadcast_ip  Thanks, Matt ```  [Comment 28](show_bug.cgi?id=3114#c28)  Harlan Stenn    2016-11-15 01:57:09 UTC  ``` (In reply to [comment #27](show_bug.cgi?id=3114#c27)) > (In reply to [comment #25](show_bug.cgi?id=3114#c25)) > > Matt, > >  > > I think your CVSS scores are too high.  While AV:N is possible, it seems > > unreasonable.  AV:A is more reasonable. > >  > > NTP Broadcasts are *only* expected to be used on trusted network domains.  AV:N > > is clearly not a trusted network domain.  And the presence of a replay attack > > is evidence that the given network domain is not trustable. >  > Hi Harlan, >  > I took another look at it and AV:N is correct.  AV specifies the level of > access that an attacker must have in order to successfully exploit the > vulnerability, and an attacker can readily exploit this vulnerability from a > non-adjacent network. >  > To exploit this DoS, the attacker does not need to be able to sniff or replay > packets.  The attacker need only spoof the source address of the broadcast > server.  Because ntpd does not use the packet destination address to determine > which association an incoming packet belongs to an attacker can target any NTP > broadcast client by sending the spoofed packets with: > srcaddr=broadcast_server_ip, dstaddr=victim_ip >  > Though it's not needed for this attack, if the victim's local subnet allows > ingress of broadcast packets, the attacker could also use: > srcaddr=broadcast_server_ip, dstaddr=subnet_broadcast_ip  Hi Matt,  Sure, but that means you don't have any sort of protection from bogus packets entering your network.  How is this considered "normal" or "acceptable" practice?  If the attacker is spoofing the source address of the real broadcast server on the broadcast network that's the Adjacent network, as I scored it. ```  [Comment 29](show_bug.cgi?id=3114#c29)  Matthew Van Gundy    2016-11-15 14:59:48 UTC  ``` (In reply to [comment #28](show_bug.cgi?id=3114#c28)) > Hi Matt, >  > Sure, but that means you don't have any sort of protection from bogus packets > entering your network. >  > How is this considered "normal" or "acceptable" practice? >  > If the attacker is spoofing the source address of the real broadcast server on > the broadcast network that's the Adjacent network, as I scored it.  Hi Harlan,  I agree that preventing this sort of IP spoofing is a best practice, but I was under the impression that it is not commonly followed.  Linux's reverse path filter does this by default on modern systems, but whether strict uRPF is commonly enabled on enterprise networking gear is a different question.  I double checked with some network admins that I know who have done consulting work on a variety of networks.  They confirmed that preventing ingress of packets with source addresses on the destination subnet is a "good, but not common, practice" and that, in their experience, only a minority of enterprise networks enable strict uRPF.  Matt ```  [Comment 30](show_bug.cgi?id=3114#c30)  Harlan Stenn    2016-11-21 14:54:15 UTC  ``` Matt,  Thanks for the report.  Please check ntp-4.2.8p9 and mark this bug as VERIFIED or IN_PROGRESS, as appropriate.  Pearly and Danny, thanks for your work on this. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3114)
* - [XML](show_bug.cgi?ctype=xml&id=3114)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3114)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3114&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3114&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[© 2025 Network Time Foundation](https://www.nwtime.org/)



=== Content from h20566.www2.hpe.com_24bb7c67_20250125_145746.html ===



