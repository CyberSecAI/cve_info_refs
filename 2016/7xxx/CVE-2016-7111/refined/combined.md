=== Content from www.openwall.com_e7f082ff_20250124_145312.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2016/08/27/2) [[next>]](2) [[thread-next>]](../../../2016/08/29/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ea35113c-d493-4bf7-ca47-9df7891dde67@mantisbt.org>
Date: Sat, 27 Aug 2016 23:16:56 +0200
From: Damien Regad <dregad@...tisbt.org>
To: oss-security@...ts.openwall.com
Subject: MantisBT weakened CSP when using bundled Gravatar plugin

Greetings,

Please assign a CVE ID for the following issue.

Description
-----------
MantisBT 1.3.0-rc.2 introduced a new bundled plugin to handle display of
users' avatars using Gravatar.

Instead of adding the Gravatar web site to the list of allowed image
sources in MantisBT's Content Security Policy, the plugin was replacing
the whole policy by:

   img-src 'self' <http://www.gravatar.com/>

instead of the more strict default one of:

   default-src 'self'; frame-ancestors 'none'; style-src 'self';
   script-src 'self'

Relaxed policy allows execution of remote and inline scripts, e.g.
potentially enabling XSS attacks.

Affected versions
-----------------
- >= 1.3.0-rc.2
- >= 2.0.0-beta.1

Fixed in versions:
------------------
- 1.3.1
- 2.0.0-beta.2

As of this writing, these have not been released yet, but both should be
available in the coming days. Until then, installations should be
patched manually.

As a workaround, disabling the Gravatar plugin restores the safer
default policy.

Patch
-----
See Github [1]

Credits
-------
The issue was discovered by Johannes Schultz, and fixed by Victor Boctor
(MantisBT Developer).

References
----------
Further details available in our issue tracker [2]

Best regards,
D. Regad
MantisBT Developer
<http://mantisbt.org>

[1] <https://github.com/mantisbt/mantisbt/commit/b3511d2f>
[2] <https://mantisbt.org/bugs/view.php?id=21263>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_004241a5_20250126_014041.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976911a4dc5a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976911a4dc5a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/a905dd01d97c8858327cc958b83d976911a4dc5a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add API for Content-Security-Policy

[Browse files](/mantisbt/mantisbt/tree/a905dd01d97c8858327cc958b83d976911a4dc5a)
Browse the repository at this point in the history

```
Add APIs to allow plugins to change the Content-Security-Policy header.

Fixes #21263
```

* Loading branch information

[![@vboctor](https://avatars.githubusercontent.com/u/6446?s=40&v=4)](/vboctor) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[vboctor](/mantisbt/mantisbt/commits?author=vboctor "View all commits by vboctor")
authored and
[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

1 parent
[77db038](/mantisbt/mantisbt/commit/77db0389feed47af5896f8455b2ca13d262b5b35)

commit a905dd0

Showing
**1 changed file**
with
**52 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

66 changes: 52 additions & 14 deletions

66
[core/http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4 "core/http_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/a905dd01d97c8858327cc958b83d976911a4dc5a/core/http_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,12 @@ |
|  |  |  |
|  |  | require\_api( 'config\_api.php' ); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The Content-Security-Policy settings array. Use http\_csp\_add() to update it. |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | $g\_csp = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks to see if script was queried through the HTTPS protocol |
|  |  | \* @return boolean True if protocol is HTTPS |
| Expand Down  Expand Up | | @@ -138,6 +144,43 @@ function http\_content\_headers() { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add a Content-Security-Policy directive. |
|  |  | \* |
|  |  | \* @param string $p\_type The directive type, e.g. style-src, script-src. |
|  |  | \* @param string $p\_value The directive value, e.g. 'self', https://ajax.googleapis.com |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( isset( $g\_csp[$p\_type] ) ) { |
|  |  | if ( !in\_array( $p\_value, $g\_csp[$p\_type] ) ) { |
|  |  | $g\_csp[$p\_type][] = $p\_value; |
|  |  | } |
|  |  | } else { |
|  |  | $g\_csp[$p\_type] = array( $p\_value ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructs the value of the CSP header. |
|  |  | \* @return string CSP header value. |
|  |  | \*/ |
|  |  | function http\_csp\_value() { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | $t\_csp\_value = ''; |
|  |  |  |
|  |  | foreach ( $g\_csp as $t\_key => $t\_values ) { |
|  |  | $t\_csp\_value .= $t\_key . ' ' . implode( ' ', $t\_values ) . '; '; |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = trim( $t\_csp\_value, '; ' ); |
|  |  |  |
|  |  | return $t\_csp\_value; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set security headers (frame busting, clickjacking/XSS/CSRF protection). |
|  |  | \* @return void |
| Expand All | | @@ -147,32 +190,27 @@ function http\_security\_headers() { |
|  |  | header( 'X-Frame-Options: DENY' ); |
|  |  |  |
|  |  | # Define Content Security Policy |
|  |  | $t\_csp = array( |
|  |  | "default-src 'self'", |
|  |  | "frame-ancestors 'none'", |
|  |  | ); |
|  |  |  |
|  |  | $t\_style\_src = "style-src 'self'"; |
|  |  | $t\_script\_src = "script-src 'self'"; |
|  |  | http\_csp\_add( 'default-src', "'self'" ); |
|  |  | http\_csp\_add( 'frame-ancestors', "'none'" ); |
|  |  | http\_csp\_add( 'style-src', "'self'" ); |
|  |  | http\_csp\_add( 'script-src', "'self'" ); |
|  |  | http\_csp\_add( 'img-src', "'self'" ); |
|  |  |  |
|  |  | # White list the CDN urls (if enabled) |
|  |  | if ( config\_get\_global( 'cdn\_enabled' ) == ON ) { |
|  |  | $t\_cdn\_url = 'https://ajax.googleapis.com'; |
|  |  | $t\_style\_src .= " $t\_cdn\_url"; |
|  |  | $t\_script\_src .= " $t\_cdn\_url"; |
|  |  | http\_csp\_add( 'style-src', $t\_cdn\_url ); |
|  |  | http\_csp\_add( 'script-src', $t\_cdn\_url ); |
|  |  | } |
|  |  |  |
|  |  | # Relaxing policy for roadmap page to allow inline styles |
|  |  | # This is a workaround to fix the broken progress bars (see #19501) |
|  |  | if( 'roadmap\_page.php' == basename( $\_SERVER['SCRIPT\_NAME'] ) ) { |
|  |  | $t\_style\_src .= " 'unsafe-inline'"; |
|  |  | http\_csp\_add( 'style-src', "'unsafe-inline'" ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp[] = $t\_style\_src; |
|  |  | $t\_csp[] = $t\_script\_src; |
|  |  |  |
|  |  | # Set CSP header |
|  |  | header( 'Content-Security-Policy: ' . implode('; ', $t\_csp) ); |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  |  |
|  |  | if( http\_is\_protocol\_https() ) { |
|  |  | header( 'Strict-Transport-Security: max-age=7776000' ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a905dd0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976911a4dc5a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e0591bfc_20250126_014040.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9f359863db21fd09af7e403e435e5aa8b10aac2a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9f359863db21fd09af7e403e435e5aa8b10aac2a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/9f359863db21fd09af7e403e435e5aa8b10aac2a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Protect against calling http\_csp\_add() too late

[Browse files](/mantisbt/mantisbt/tree/9f359863db21fd09af7e403e435e5aa8b10aac2a)
Browse the repository at this point in the history

```
If the CSP header is sent and then http_csp_add() is called, trigger error.

Fixes #21263
```

* Loading branch information

[![@vboctor](https://avatars.githubusercontent.com/u/6446?s=40&v=4)](/vboctor) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[vboctor](/mantisbt/mantisbt/commits?author=vboctor "View all commits by vboctor")
authored and
[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

1 parent
[f24a3e9](/mantisbt/mantisbt/commit/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae)

commit 9f35986

Showing
**1 changed file**
with
**22 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

24 changes: 22 additions & 2 deletions

24
[core/http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4 "core/http_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/9f359863db21fd09af7e403e435e5aa8b10aac2a/core/http_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -154,6 +154,11 @@ function http\_content\_headers() { |
|  |  | function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | if ( isset( $g\_csp[$p\_type] ) ) { |
|  |  | if ( !in\_array( $p\_value, $g\_csp[$p\_type] ) ) { |
|  |  | $g\_csp[$p\_type][] = $p\_value; |
| Expand All | | @@ -170,6 +175,11 @@ function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | function http\_csp\_value() { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = ''; |
|  |  |  |
|  |  | foreach ( $g\_csp as $t\_key => $t\_values ) { |
| Expand All | | @@ -181,6 +191,17 @@ function http\_csp\_value() { |
|  |  | return $t\_csp\_value; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Send header for Content-Security-Policy. |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_emit\_header() { |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  |  |
|  |  | global $g\_csp; |
|  |  | $g\_csp = null; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set security headers (frame busting, clickjacking/XSS/CSRF protection). |
|  |  | \* @return void |
| Expand Down  Expand Up | | @@ -209,8 +230,7 @@ function http\_security\_headers() { |
|  |  | http\_csp\_add( 'style-src', "'unsafe-inline'" ); |
|  |  | } |
|  |  |  |
|  |  | # Set CSP header |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  | http\_csp\_emit\_header(); |
|  |  |  |
|  |  | if( http\_is\_protocol\_https() ) { |
|  |  | header( 'Strict-Transport-Security: max-age=7776000' ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9f35986`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9f359863db21fd09af7e403e435e5aa8b10aac2a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_b832e83a_20250124_145312.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2016/08/28/1) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160829215135.463377BC071@smtpvmsrv1.mitre.org>
Date: Mon, 29 Aug 2016 17:51:35 -0400 (EDT)
From: cve-assign@...re.org
To: dregad@...tisbt.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: MantisBT weakened CSP when using bundled Gravatar plugin

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> MantisBT 1.3.0-rc.2 introduced a new bundled plugin to handle display of
> users' avatars using Gravatar.
>
> Instead of adding the Gravatar web site to the list of allowed image
> sources in MantisBT's Content Security Policy, the plugin was replacing
> the whole policy by:
>
>    img-src 'self' <http://www.gravatar.com/>
>
> instead of the more strict default one of:
>
>    default-src 'self'; frame-ancestors 'none'; style-src 'self';
>    script-src 'self'
>
> Relaxed policy allows execution of remote and inline scripts, e.g.
> potentially enabling XSS attacks.
>
> <https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229>
> <https://mantisbt.org/bugs/view.php?id=21263>

Use CVE-2016-7111.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXxK4MAAoJEHb/MwWLVhi2p3EQAKULs3JDc49mBXeyVZ24IUoE
6iWcUGjwiE5cHXnAxcNKZZp7/xsFo9tgdLbLZ37x48kU1cwp/B/rnQQCWJHfUJxJ
gR0qIutmEWCAq3nIVC0IR+tBm//0iiJuTuRhH/NjE9W4+EBPPjIHkkHxvnWLqyJo
SWBP/JJDYbB8sQ366+WLrNHTdxK+keVcu406KrbagWhPaMG1C9QAkTeHRxovI/me
JkbA3cVjfmO9BjHrAkbEYEJRU6Qxn8XsXUNW8bGoHBUt4WFON8BOGpt6Yyn1iDCs
APOou4yZqMPM8jSnS8MOCM9POuuK8QNXMTLPgnMkxLcFntz79ogVmzJYfl6jyQ6V
PW2dNtFU03QTI4nvL2UbVi1+oEbZycQbRnU0If7wHjedXIekFEX2uik0fAnJRwAk
LDgT/+g6g02RJZPmteQFrT0ZtXav2rFiznHicL93mRLt1sOiE32ULJrQ8DLBP5SA
EYitfKS09oBLDdSC5k+wogX22UgoFm4xZLrauVbRMKUApZNvKVSAADNewmRopXKR
Fm2lDPJKmmb+oOWVBj7MDz7J9u1SvnyVieX+53E8Bt0tnr9KD5R61XNfjnKJtvZg
+2l+S8HEUN3FdDz2WINbs9z1Sd5Fok9jc+TQXeIXR07jPC+MKE26zywhIiMYIfl/
2Rs4hh+EhmuT20OUq14x
=U1Gg
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_b6976d61_20250126_014046.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2feb47eaee41feb5f69cf3c8a2c9acd229)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2feb47eaee41feb5f69cf3c8a2c9acd229)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix weakened CSP by Gravatar plugin

[Browse files](/mantisbt/mantisbt/tree/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229)
Browse the repository at this point in the history

```
Merge vboctor's branch 'issue_21263_csp_headers_13x'

Fixes #21263
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

2 parents
[77db038](/mantisbt/mantisbt/commit/77db0389feed47af5896f8455b2ca13d262b5b35)
+
[c13b325](/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9)

commit b3511d2

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**91 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core.php
  [core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a)
* core

  + core/events\_inc.php
    [events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619)
  + core/http\_api.php
    [http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4)
* docbook/Developers\_Guide/en-US

  + docbook/Developers\_Guide/en-US/Events\_Reference.xml
    [Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8)
* plugins/Gravatar

  + plugins/Gravatar/Gravatar.php
    [Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a "core.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -274,6 +274,7 @@ function \_\_autoload( $p\_class ) { |
|  |  |  |
|  |  | # Set HTTP response headers |
|  |  | require\_api( 'http\_api.php' ); |
|  |  | event\_signal( 'EVENT\_CORE\_HEADERS' ); |
|  |  | http\_all\_headers(); |
|  |  |  |
|  |  | # Push default language to speed calls to lang\_get |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[core/events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619 "core/events_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/events_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  |  |
|  |  | # Events specific to the core system |
|  |  | 'EVENT\_CORE\_READY' => EVENT\_TYPE\_EXECUTE, |
|  |  | 'EVENT\_CORE\_HEADERS' => EVENT\_TYPE\_EXECUTE, |
|  |  |  |
|  |  | # MantisBT Layout Events |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => EVENT\_TYPE\_OUTPUT, |
| Expand Down | |  |

88 changes: 73 additions & 15 deletions

88
[core/http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4 "core/http_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/http_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,12 @@ |
|  |  |  |
|  |  | require\_api( 'config\_api.php' ); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The Content-Security-Policy settings array. Use http\_csp\_add() to update it. |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | $g\_csp = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks to see if script was queried through the HTTPS protocol |
|  |  | \* @return boolean True if protocol is HTTPS |
| Expand Down  Expand Up | | @@ -138,6 +144,64 @@ function http\_content\_headers() { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add a Content-Security-Policy directive. |
|  |  | \* |
|  |  | \* @param string $p\_type The directive type, e.g. style-src, script-src. |
|  |  | \* @param string $p\_value The directive value, e.g. 'self', https://ajax.googleapis.com |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | if ( isset( $g\_csp[$p\_type] ) ) { |
|  |  | if ( !in\_array( $p\_value, $g\_csp[$p\_type] ) ) { |
|  |  | $g\_csp[$p\_type][] = $p\_value; |
|  |  | } |
|  |  | } else { |
|  |  | $g\_csp[$p\_type] = array( $p\_value ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructs the value of the CSP header. |
|  |  | \* @return string CSP header value. |
|  |  | \*/ |
|  |  | function http\_csp\_value() { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = ''; |
|  |  |  |
|  |  | foreach ( $g\_csp as $t\_key => $t\_values ) { |
|  |  | $t\_csp\_value .= $t\_key . ' ' . implode( ' ', $t\_values ) . '; '; |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = trim( $t\_csp\_value, '; ' ); |
|  |  |  |
|  |  | return $t\_csp\_value; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Send header for Content-Security-Policy. |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_emit\_header() { |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  |  |
|  |  | global $g\_csp; |
|  |  | $g\_csp = null; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set security headers (frame busting, clickjacking/XSS/CSRF protection). |
|  |  | \* @return void |
| Expand All | | @@ -147,32 +211,26 @@ function http\_security\_headers() { |
|  |  | header( 'X-Frame-Options: DENY' ); |
|  |  |  |
|  |  | # Define Content Security Policy |
|  |  | $t\_csp = array( |
|  |  | "default-src 'self'", |
|  |  | "frame-ancestors 'none'", |
|  |  | ); |
|  |  |  |
|  |  | $t\_style\_src = "style-src 'self'"; |
|  |  | $t\_script\_src = "script-src 'self'"; |
|  |  | http\_csp\_add( 'default-src', "'self'" ); |
|  |  | http\_csp\_add( 'frame-ancestors', "'none'" ); |
|  |  | http\_csp\_add( 'style-src', "'self'" ); |
|  |  | http\_csp\_add( 'script-src', "'self'" ); |
|  |  | http\_csp\_add( 'img-src', "'self'" ); |
|  |  |  |
|  |  | # White list the CDN urls (if enabled) |
|  |  | if ( config\_get\_global( 'cdn\_enabled' ) == ON ) { |
|  |  | $t\_cdn\_url = 'https://ajax.googleapis.com'; |
|  |  | $t\_style\_src .= " $t\_cdn\_url"; |
|  |  | $t\_script\_src .= " $t\_cdn\_url"; |
|  |  | http\_csp\_add( 'style-src', $t\_cdn\_url ); |
|  |  | http\_csp\_add( 'script-src', $t\_cdn\_url ); |
|  |  | } |
|  |  |  |
|  |  | # Relaxing policy for roadmap page to allow inline styles |
|  |  | # This is a workaround to fix the broken progress bars (see #19501) |
|  |  | if( 'roadmap\_page.php' == basename( $\_SERVER['SCRIPT\_NAME'] ) ) { |
|  |  | $t\_style\_src .= " 'unsafe-inline'"; |
|  |  | http\_csp\_add( 'style-src', "'unsafe-inline'" ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp[] = $t\_style\_src; |
|  |  | $t\_csp[] = $t\_script\_src; |
|  |  |  |
|  |  | # Set CSP header |
|  |  | header( 'Content-Security-Policy: ' . implode('; ', $t\_csp) ); |
|  |  | http\_csp\_emit\_header(); |
|  |  |  |
|  |  | if( http\_is\_protocol\_https() ) { |
|  |  | header( 'Strict-Transport-Security: max-age=7776000' ); |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[docbook/Developers\_Guide/en-US/Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8 "docbook/Developers_Guide/en-US/Events_Reference.xml")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/docbook/Developers_Guide/en-US/Events_Reference.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,6 +83,19 @@ |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreheaders"> |
|  |  | <title>EVENT\_CORE\_HEADERS (Execute)</title> |
|  |  |  |
|  |  | <blockquote> |
|  |  | <para> |
|  |  | This event is triggered by the MantisBT bootstrap process just before emitting the |
|  |  | headers. This enables plugins to emit their own headers or use API that enables |
|  |  | tweaking values of headers emitted by core. An example, of headers that can be |
|  |  | tweaked is Content-Security-Policy header which can be tweaked using http\_csp\_\*() APIs. |
|  |  | </para> |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreready"> |
|  |  | <title>EVENT\_CORE\_READY (Execute)</title> |
|  |  |  |
| Expand Down | |  |

11 changes: 3 additions & 8 deletions

11
[plugins/Gravatar/Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949 "plugins/Gravatar/Gravatar.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/plugins/Gravatar/Gravatar.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -106,21 +106,16 @@ function config() { |
|  |  | function hooks() { |
|  |  | return array( |
|  |  | 'EVENT\_USER\_AVATAR' => 'user\_get\_avatar', |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => 'csp\_headers', |
|  |  | 'EVENT\_CORE\_HEADERS' => 'csp\_headers', |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add Content-Security-Policy for retrieving Avatar images. |
|  |  | \* |
|  |  | \* @return void |
|  |  | \* Register gravatar url as an img-src for CSP header |
|  |  | \*/ |
|  |  | function csp\_headers() { |
|  |  | # Policy for images: Allow gravatar URL |
|  |  | if( config\_get( 'show\_avatar' ) !== OFF ) { |
|  |  | # Set CSP header |
|  |  | header( "Content-Security-Policy: img-src 'self' " . |
|  |  | self::getAvatarUrl() ); |
|  |  | http\_csp\_add( 'img-src', self::getAvatarUrl() ); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b3511d2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2feb47eaee41feb5f69cf3c8a2c9acd229) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f33e938f_20250126_014042.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/a905dd01d97c8858327cc958b83d976911a4dc5a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add API for Content-Security-Policy

[Browse files](/mantisbt/mantisbt/tree/a905dd01d97c8858327cc958b83d976911a4dc5a)
Browse the repository at this point in the history

```
Add APIs to allow plugins to change the Content-Security-Policy header.

Fixes #21263
```

* Loading branch information

[![@vboctor](https://avatars.githubusercontent.com/u/6446?s=40&v=4)](/vboctor) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[vboctor](/mantisbt/mantisbt/commits?author=vboctor "View all commits by vboctor")
authored and
[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

1 parent
[77db038](/mantisbt/mantisbt/commit/77db0389feed47af5896f8455b2ca13d262b5b35)

commit a905dd0

Showing
**1 changed file**
with
**52 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

66 changes: 52 additions & 14 deletions

66
[core/http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4 "core/http_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/a905dd01d97c8858327cc958b83d976911a4dc5a/core/http_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,12 @@ |
|  |  |  |
|  |  | require\_api( 'config\_api.php' ); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The Content-Security-Policy settings array. Use http\_csp\_add() to update it. |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | $g\_csp = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks to see if script was queried through the HTTPS protocol |
|  |  | \* @return boolean True if protocol is HTTPS |
| Expand Down  Expand Up | | @@ -138,6 +144,43 @@ function http\_content\_headers() { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add a Content-Security-Policy directive. |
|  |  | \* |
|  |  | \* @param string $p\_type The directive type, e.g. style-src, script-src. |
|  |  | \* @param string $p\_value The directive value, e.g. 'self', https://ajax.googleapis.com |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( isset( $g\_csp[$p\_type] ) ) { |
|  |  | if ( !in\_array( $p\_value, $g\_csp[$p\_type] ) ) { |
|  |  | $g\_csp[$p\_type][] = $p\_value; |
|  |  | } |
|  |  | } else { |
|  |  | $g\_csp[$p\_type] = array( $p\_value ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructs the value of the CSP header. |
|  |  | \* @return string CSP header value. |
|  |  | \*/ |
|  |  | function http\_csp\_value() { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | $t\_csp\_value = ''; |
|  |  |  |
|  |  | foreach ( $g\_csp as $t\_key => $t\_values ) { |
|  |  | $t\_csp\_value .= $t\_key . ' ' . implode( ' ', $t\_values ) . '; '; |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = trim( $t\_csp\_value, '; ' ); |
|  |  |  |
|  |  | return $t\_csp\_value; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set security headers (frame busting, clickjacking/XSS/CSRF protection). |
|  |  | \* @return void |
| Expand All | | @@ -147,32 +190,27 @@ function http\_security\_headers() { |
|  |  | header( 'X-Frame-Options: DENY' ); |
|  |  |  |
|  |  | # Define Content Security Policy |
|  |  | $t\_csp = array( |
|  |  | "default-src 'self'", |
|  |  | "frame-ancestors 'none'", |
|  |  | ); |
|  |  |  |
|  |  | $t\_style\_src = "style-src 'self'"; |
|  |  | $t\_script\_src = "script-src 'self'"; |
|  |  | http\_csp\_add( 'default-src', "'self'" ); |
|  |  | http\_csp\_add( 'frame-ancestors', "'none'" ); |
|  |  | http\_csp\_add( 'style-src', "'self'" ); |
|  |  | http\_csp\_add( 'script-src', "'self'" ); |
|  |  | http\_csp\_add( 'img-src', "'self'" ); |
|  |  |  |
|  |  | # White list the CDN urls (if enabled) |
|  |  | if ( config\_get\_global( 'cdn\_enabled' ) == ON ) { |
|  |  | $t\_cdn\_url = 'https://ajax.googleapis.com'; |
|  |  | $t\_style\_src .= " $t\_cdn\_url"; |
|  |  | $t\_script\_src .= " $t\_cdn\_url"; |
|  |  | http\_csp\_add( 'style-src', $t\_cdn\_url ); |
|  |  | http\_csp\_add( 'script-src', $t\_cdn\_url ); |
|  |  | } |
|  |  |  |
|  |  | # Relaxing policy for roadmap page to allow inline styles |
|  |  | # This is a workaround to fix the broken progress bars (see #19501) |
|  |  | if( 'roadmap\_page.php' == basename( $\_SERVER['SCRIPT\_NAME'] ) ) { |
|  |  | $t\_style\_src .= " 'unsafe-inline'"; |
|  |  | http\_csp\_add( 'style-src', "'unsafe-inline'" ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp[] = $t\_style\_src; |
|  |  | $t\_csp[] = $t\_script\_src; |
|  |  |  |
|  |  | # Set CSP header |
|  |  | header( 'Content-Security-Policy: ' . implode('; ', $t\_csp) ); |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  |  |
|  |  | if( http\_is\_protocol\_https() ) { |
|  |  | header( 'Strict-Transport-Security: max-age=7776000' ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a905dd0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fa905dd01d97c8858327cc958b83d976) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_434d34d9_20250126_014045.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc13b325365bd98118fe8f31d20826bc7ada3a9d9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc13b325365bd98118fe8f31d20826bc7ada3a9d9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add EVENT\_CORE\_HEADERS event

[Browse files](/mantisbt/mantisbt/tree/c13b325365bd98118fe8f31d20826bc7ada3a9d9)
Browse the repository at this point in the history

```
Called before core emits headers enabling plugins to emit their
own headers or call APIs that shape the value of headers emitted by
core like Content-Security-Policy.

Fixes #21263
```

* Loading branch information

[![@vboctor](https://avatars.githubusercontent.com/u/6446?s=40&v=4)](/vboctor) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[vboctor](/mantisbt/mantisbt/commits?author=vboctor "View all commits by vboctor")
authored and
[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

1 parent
[9f35986](/mantisbt/mantisbt/commit/9f359863db21fd09af7e403e435e5aa8b10aac2a)

commit c13b325

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**25 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core.php
  [core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a)
* core

  + core/events\_inc.php
    [events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619)
* docbook/Developers\_Guide/en-US

  + docbook/Developers\_Guide/en-US/Events\_Reference.xml
    [Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8)
* plugins/Gravatar

  + plugins/Gravatar/Gravatar.php
    [Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a "core.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/core.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -274,6 +274,7 @@ function \_\_autoload( $p\_class ) { |
|  |  |  |
|  |  | # Set HTTP response headers |
|  |  | require\_api( 'http\_api.php' ); |
|  |  | event\_signal( 'EVENT\_CORE\_HEADERS' ); |
|  |  | http\_all\_headers(); |
|  |  |  |
|  |  | # Push default language to speed calls to lang\_get |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[core/events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619 "core/events_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/core/events_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  |  |
|  |  | # Events specific to the core system |
|  |  | 'EVENT\_CORE\_READY' => EVENT\_TYPE\_EXECUTE, |
|  |  | 'EVENT\_CORE\_HEADERS' => EVENT\_TYPE\_EXECUTE, |
|  |  |  |
|  |  | # MantisBT Layout Events |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => EVENT\_TYPE\_OUTPUT, |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[docbook/Developers\_Guide/en-US/Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8 "docbook/Developers_Guide/en-US/Events_Reference.xml")

Show comments

[View file](/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/docbook/Developers_Guide/en-US/Events_Reference.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,6 +83,19 @@ |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreheaders"> |
|  |  | <title>EVENT\_CORE\_HEADERS (Execute)</title> |
|  |  |  |
|  |  | <blockquote> |
|  |  | <para> |
|  |  | This event is triggered by the MantisBT bootstrap process just before emitting the |
|  |  | headers. This enables plugins to emit their own headers or use API that enables |
|  |  | tweaking values of headers emitted by core. An example, of headers that can be |
|  |  | tweaked is Content-Security-Policy header which can be tweaked using http\_csp\_\*() APIs. |
|  |  | </para> |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreready"> |
|  |  | <title>EVENT\_CORE\_READY (Execute)</title> |
|  |  |  |
| Expand Down | |  |

15 changes: 10 additions & 5 deletions

15
[plugins/Gravatar/Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949 "plugins/Gravatar/Gravatar.php")

Show comments

[View file](/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/plugins/Gravatar/Gravatar.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -104,16 +104,21 @@ function config() { |
|  |  | \* Register event hooks for plugin. |
|  |  | \*/ |
|  |  | function hooks() { |
|  |  | if( config\_get( 'show\_avatar' ) !== OFF ) { |
|  |  | # Set CSP header |
|  |  | http\_csp\_add( 'img-src', self::getAvatarUrl() ); |
|  |  | } |
|  |  |  |
|  |  | return array( |
|  |  | 'EVENT\_USER\_AVATAR' => 'user\_get\_avatar', |
|  |  | 'EVENT\_CORE\_HEADERS' => 'csp\_headers', |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Register gravatar url as an img-src for CSP header |
|  |  | \*/ |
|  |  | function csp\_headers() { |
|  |  | if( config\_get( 'show\_avatar' ) !== OFF ) { |
|  |  | http\_csp\_add( 'img-src', self::getAvatarUrl() ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return the user avatar image URL |
|  |  | \* in this first implementation, only gravatar.com avatars are supported |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c13b325`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fc13b325365bd98118fe8f31d20826bc7ada3a9d9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3097fca9_20250126_014044.html ===

[Skip to content](#start-of-content)

GitHub Copilot is now available for free.
[Learn more](https://github.com/features/copilot/?utm_source=github&utm_medium=banner&utm_campaign=copilotfree-bannerheader)

## Navigation Menu

Toggle navigation

[Sign in](/login)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F&source=header-home)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# Build and ship software on a single, collaborative platform

Join the world’s most widely adopted AI-powered developer platform.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## GitHub features

A demonstration animation of a code editor using GitHub Copilot Chat, where the user requests GitHub Copilot to refactor duplicated logic and extract it into a reusable function for a given code snippet.

CodePlanCollaborateAutomateSecureCode

Build code quickly and more securely with GitHub Copilot embedded throughout your workflows.

## GitHub is used by

![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Société Générale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)Pause
## Accelerate performance

With GitHub Copilot embedded throughout the platform, you can simplify your toolchain, automate tasks, and improve the developer experience.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)A Copilot chat window with extensions enabled. The user inputs the @ symbol to reveal a list of five Copilot Extensions. @Sentry is selected from the list, which shifts the window to a chat directly with that extension. There are three sample prompts at the bottom of the chat window, allowing the user to Get incident information, Edit status on incident, or List the latest issues. The last one is activated to send the prompt: @Sentry List the latest issues. The extension then lists several new issues and their metadata.
### Work 55% faster.[Jump to footnote 1](#footnote-1) Increase productivity with AI-powered coding assistance, including code completion, chat, and more.

[Explore GitHub Copilot](/features/copilot)![Duolingo](https://github.githubassets.com/assets/logo-duolingo-14477f9e54a6.svg)

Duolingo boosts developer speed by 25% with GitHub Copilot

[Read customer story](/customer-stories/duolingo)![Gartner](https://github.githubassets.com/assets/logo-gartner-aa8c2e452b64.svg)

2024 Gartner® Magic Quadrant™ for AI Code Assistants

[Read report](https://www.gartner.com/doc/reprints?id=1-2IKO4MPE&ct=240819&st=sb)![](https://github.githubassets.com/assets/accordion-1-ce487d44c0bf.webp)![](https://github.githubassets.com/assets/accordion-2-730955545f07.webp)![](https://github.githubassets.com/assets/accordion-3-52ca331d22ea.webp)![](https://github.githubassets.com/assets/accordion-4-a26744b70ff7.webp)
### Automate any workflow

Optimize your process with simple and secured CI/CD.

A list of workflows displays a heading ‘45,167 workflow runs’ at the top. Below are five rows of completed workflows accompanied by their completion time and their duration formatted in minutes and seconds.[Discover GitHub Actions](/features/actions)
### Get up and running in seconds

Start building instantly with a comprehensive dev environment in the cloud.

A GitHub Codespaces setup for the landing page of a game called OctoInvaders. On the left is a code editor with some HTML and Javascript files open. On the right is a live render of the page. In front of this split editor window is a screenshot of two active GitHub Codespaces environments with their branch names and a button to ‘Create codespace on main.’[Check out GitHub Codespaces](/features/codespaces)
### Build on the go

Manage projects and chat with GitHub Copilot from anywhere.

Two smartphone screens side by side. The left screen shows a Notification inbox, listing issues and pull requests from different repositories like TensorFlow and GitHub’s OctoArcade octoinvaders. The right screen shows a new conversation in GitHub Copilot chat.[Download GitHub Mobile](/mobile)
### Integrate the tools you love

Sync with 17,000+ integrations and a growing library of Copilot Extensions.

A grid of fifty app tiles displays logos for integrations and extensions for companies like Stripe, Slack, and Docker. The tiles extend beyond the bounds of the image to indicate a wide array of apps. [Visit GitHub Marketplace](/marketplace)
## Built-in application security where found means fixed

Use AI to find and fix vulnerabilities—freeing your teams to ship more secure software faster.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)
### Apply fixes in seconds. Spend less time fixing vulnerabilities and more time building features with Copilot Autofix.

[Explore GitHub Advanced Security](/enterprise/advanced-security)![Copilot Autofix identifies vulnerable code and provides an explanation, together with a secure code suggestion to remediate the vulnerability.](https://github.githubassets.com/assets/hero-64ecd484397f.webp)

Solve security debt. Leverage AI-assisted security campaigns to reduce application vulnerabilities and zero-day attacks.

[Discover security campaigns](/enterprise/advanced-security)![A security campaign screen displays the campaign’s progress bar with 97% completed of 701 alerts. A total of 23 alerts are left with 13 in progress, and the campaign started 20 days ago. The status below shows that there are 7 days left in the campaign with a due date of November 15, 2024.](https://github.githubassets.com/assets/pillar-1-dd667a921f55.webp)

Dependencies you can depend on. Update vulnerable dependencies with supported fixes for breaking changes.

[Learn about Dependabot](/features/security/software-supply-chain)![List of dependencies defined in a requirements .txt file.](https://github.githubassets.com/assets/pillar-2-ff69e872920a.webp)

Your secrets, your business: protected.  Detect, prevent, and remediate leaked secrets across your organization.

[Read about secret scanning](/features/security/code)![GitHub push protection confirms and displays an active secret, and blocks the push.](https://github.githubassets.com/assets/pillar-3-0a063e2daae2.webp)
### 7x fastervulnerability fixes with GitHub[Jump to footnote 2](#footnote-2)

### 90% coverage[of alert types in all supported languages with Copilot Autofix](https://docs.github.com/en/code-security/code-scanning/managing-your-code-scanning-configuration/codeql-query-suites)

## Work together, achieve more

Collaborate with your teams, use management tools that sync with your projects, and code from anywhere—all on a single, integrated platform.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)![A project management dashboard showing tasks for the ‘OctoArcade Invaders’ project, with tasks grouped under project phase categories like ‘Prototype,’ ‘Beta,’ and ‘Launch’ in a table layout. One of the columns displays sub-issue progress bars with percentages for each issue.](https://github.githubassets.com/assets/hero-961322485af6.webp)
### Your workflows, your way. Plan effectively with an adaptable spreadsheet that syncs with your work.

[Jump into GitHub Projects](/features/issues)“
> It helps us onboard new software engineers and get them productive right away. We have all our source code, issues, and pull requests in one place... GitHub is a complete platform that frees us from menial tasks and enables us to do our best work.

Fabian FaulhaberApplication manager at Mercedes-Benz

![](https://github.githubassets.com/assets/accordion-1-38ad6b6d1b20.webp)![](https://github.githubassets.com/assets/accordion-2-c0a62cfc31a1.webp)![](https://github.githubassets.com/assets/accordion-3-5d5d222f1830.webp)![](https://github.githubassets.com/assets/accordion-4-7abff9233556.webp)
### Keep track of your tasks

Create issues and manage projects with tools that adapt to your code.

Display of task tracking within an issue, showing the status of related sub-issues and their connection to the main issue.[Explore GitHub Issues](/features/issues)
### Share ideas and ask questions

Create space for open-ended conversations alongside your project.

A GitHub Discussions thread where a GitHub user suggests a power-up idea involving Hubot revealing a path and protecting Mona. The post has received 5 upvotes and several reactions. Below, three other users add to the discussion, suggesting Hubot could provide different power-ups depending on levels and appreciating the collaboration idea.[Discover GitHub Discussions](/features/discussions)
### Review code changes together

Create review processes that improve code quality and fit neatly into your workflow.

Two code review approvals by helios-ackmore and amanda-knox, which are followed by three successful checks for ‘Build,’ ‘Test,’ and ‘Publish.’[Learn about code review](/features/code-review)
### Fund open source projects

Become an open source partner and support the tools and libraries that power your work.

A GitHub Sponsors popup displays ‘$15,000 a month’ with a progress bar showing 87% towards a $15,000 goal.[Dive into GitHub Sponsors](/sponsors)
## From startups to enterprises, GitHub scales with teams of any size in any industry.

By industryBy sizeBy use caseBy industry

---

[![](https://github.githubassets.com/assets/figma-62d390a52419.webp)![Figma](https://github.githubassets.com/assets/figma-9b0c642e96b8.svg)Technology

Figma streamlines development and strengthens security

Read customer story](https://github.com/customer-stories/figma)[![](https://github.githubassets.com/assets/mercedes-benz-d8f89b041561.webp)![Mercedes-Benz](https://github.githubassets.com/assets/mercedes-benz-60ddd54043e7.svg)Automotive

Mercedes-Benz standardizes source code and automates onboarding

Read customer story](https://github.com/customer-stories/mercedes-benz)[![](https://github.githubassets.com/assets/mercado-libre-579cb5447302.webp)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-2d6d610fa873.svg)Financial services

Mercado Libre cuts coding time by 50%

Read customer story](https://github.com/customer-stories/mercado-libre)[Explore customer stories](/customer-stories)

---

[View all solutions](/solutions)
## Millions of developers and businesses call GitHub home

Whether you’re scaling your development process or just learning how to code, GitHub is where you belong. Join the world’s most widely adopted AI-powered developer platform to build the technologies that redefine what’s possible.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## Footnotes

1. [Survey: The AI wave continues to grow on software development teams, 2024.](https://github.blog/news-insights/research/survey-ai-wave-grows/)
2. This 7X times factor is based on data from the industry’s longest running analysis of fix rates Veracode State of Software Security 2023, which cites the average time to fix 50% of flaws as 198 days vs. GitHub’s fix rates of 72% of flaws with in 28 days which is at a minimum of 7X faster when compared.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from mantisbt.org_42a7e1e6_20250126_014047.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D21263)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=21263)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0021263 | mantisbt | security | public | 2016-07-11 19:10 | 2016-08-29 18:25 |
|  | | | | | |
|
| Reporter | [j\_schultz](https://mantisbt.org/bugs/view_user_page.php?id=20986) | Assigned To | [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081) |  | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 1.3.0 |  | | | |
| Target Version | 1.3.1 | Fixed in Version | 1.3.1 |  | |
|  | | | | | |
|
| Summary | 0021263: CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin | | | | |
| Description | When sending the same HTTP variable to PHP twice via the header() function, the old value is replaced. The default Gravatar plugin sets its own "Content-Security-Policy" HTTP header, which overrides the more strict defaults normally used by Mantis. Mantis should probably offer a plugin hook (as once discussed in [0011826:0025958](/bugs/view.php?id=11826#c25958 "0011826: [2010-06-23 01:53] dhx")) so that any plugin can add its wanted CSP rules before the header is sent. | | | | |
| Steps To Reproduce | Enable Gravatars and check the HTTP headers. | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=21263&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=21263&graph=dependency)

| related to | [0021611](view.php?id=21611) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2016-6837: XSS vulnerability in view\_all\_bug\_page.php |
| --- | --- | --- | --- | --- |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-16 17:53  developer    [~0053820](view.php?id=21263#c53820 "Direct link to note") | [@atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111) I'm not sure I understand what the relationship with [0021611](/bugs/view.php?id=21611 "[closed] CVE-2016-6837: XSS vulnerability in view_all_bug_page.php") is. |
| --- | --- |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2016-08-16 18:07  developer    [~0053822](view.php?id=21263#c53822 "Direct link to note") | [0021611](/bugs/view.php?id=21611 "[closed] CVE-2016-6837: XSS vulnerability in view_all_bug_page.php") can't be reproduced (at least with FF) if gravatar plugin is not enabled.  Enabling the plugin overrides the CSP headers and we send just img-src 'self' <http://www.gravatar.com/>  Without gravatar plugin enabled we send default-src 'self'; frame-ancestors 'none'; style-src 'self'; script-src 'self' which prevents FF from executing the code. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-16 19:25  developer    [~0053823](view.php?id=21263#c53823 "Direct link to note") | Thanks for the feedback Roland.  [@vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081) this needs to be fixed ASAP, if not permanently as per j\_schultz's suggestion, then at least implement a workaround to make the Gravatar plugin not break the default MantisBT CSP.  Can you please look into it ? |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2016-08-17 02:35  developer    [~0053830](view.php?id=21263#c53830 "Direct link to note") | Related discussion <https://www.mantisbt.org/forums/viewtopic.php?f=2&t=23974> |
|  | |
| [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)   [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  2016-08-17 02:58  manager    [~0053831](view.php?id=21263#c53831 "Direct link to note") | PR: <https://github.com/mantisbt/mantisbt/pull/859> |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-27 17:07  developer    [~0053898](view.php?id=21263#c53898 "Direct link to note")  Last edited: 2016-08-28 18:23 | I sent a CVE request to the OSS-security mailing list [1]; will update this with the ID once it's been assigned.  [1] <http://www.openwall.com/lists/oss-security/2016/08/28/1> |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-29 18:25  developer    [~0053907](view.php?id=21263#c53907 "Direct link to note") | CVE assignment <http://www.openwall.com/lists/oss-security/2016/08/29/2> |
|  | |

#### Related Changesets

| MantisBT: master-1.3.x a905dd01  2016-08-16 22:25  [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  Committer: [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22319) [Diff](https://github.com/mantisbt/mantisbt/commit/a905dd01d97c8858327cc958b83d976911a4dc5a) | Add API for Content-Security-Policy | | Affected Issues[0021263](/bugs/view.php?id=21263 "[closed] CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin") |
| --- | --- | --- | --- |
| mod - core/http\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/a905dd01d97c8858327cc958b83d976911a4dc5a) [File](https://github.com/mantisbt/mantisbt/blob/a905dd01d97c8858327cc958b83d976911a4dc5a/core/http_api.php) |
| MantisBT: master-1.3.x f24a3e9c  2016-08-16 22:44  [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  Committer: [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22320) [Diff](https://github.com/mantisbt/mantisbt/commit/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae) | Use Content-Security-Policy API in Gravatar | | Affected Issues[0021263](/bugs/view.php?id=21263 "[closed] CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin") |
| mod - plugins/Gravatar/Gravatar.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae) [File](https://github.com/mantisbt/mantisbt/blob/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae/plugins/Gravatar/Gravatar.php) |
| MantisBT: master-1.3.x 9f359863  2016-08-16 22:50  [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  Committer: [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22321) [Diff](https://github.com/mantisbt/mantisbt/commit/9f359863db21fd09af7e403e435e5aa8b10aac2a) | Protect against calling http\_csp\_add() too late | | Affected Issues[0021263](/bugs/view.php?id=21263 "[closed] CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin") |
| mod - core/http\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/9f359863db21fd09af7e403e435e5aa8b10aac2a) [File](https://github.com/mantisbt/mantisbt/blob/9f359863db21fd09af7e403e435e5aa8b10aac2a/core/http_api.php) |
| MantisBT: master-1.3.x c13b3253  2016-08-25 19:19  [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  Committer: [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22322) [Diff](https://github.com/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9) | Add EVENT\_CORE\_HEADERS event | | Affected Issues[0021263](/bugs/view.php?id=21263 "[closed] CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin") |
| mod - core.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9) [File](https://github.com/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/core.php) |
| mod - core/events\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9) [File](https://github.com/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/core/events_inc.php) |
| mod - docbook/Developers\_Guide/en-US/Events\_Reference.xml | | [Diff](https://github.com/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9) [File](https://github.com/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/docbook/Developers_Guide/en-US/Events_Reference.xml) |
| mod - plugins/Gravatar/Gravatar.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9) [File](https://github.com/mantisbt/mantisbt/blob/c13b325365bd98118fe8f31d20826bc7ada3a9d9/plugins/Gravatar/Gravatar.php) |
| MantisBT: master-1.3.x b3511d2f  2016-08-27 13:01  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22323) [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) | Fix weakened CSP by Gravatar plugin | | Affected Issues[0021263](/bugs/view.php?id=21263 "[closed] CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin") |
| mod - core.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) [File](https://github.com/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core.php) |
| mod - core/events\_inc.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) [File](https://github.com/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/events_inc.php) |
| mod - core/http\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) [File](https://github.com/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/http_api.php) |
| mod - docbook/Developers\_Guide/en-US/Events\_Reference.xml | | [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) [File](https://github.com/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/docbook/Developers_Guide/en-US/Events_Reference.xml) |
| mod - plugins/Gravatar/Gravatar.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229) [File](https://github.com/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/plugins/Gravatar/Gravatar.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1782 seconds



=== Content from github.com_8f6ae0ec_20250124_145313.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  78](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix weakened CSP by Gravatar plugin

[Browse files](/mantisbt/mantisbt/tree/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229)
Browse the repository at this point in the history

```
Merge vboctor's branch 'issue_21263_csp_headers_13x'

Fixes #21263
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

2 parents
[77db038](/mantisbt/mantisbt/commit/77db0389feed47af5896f8455b2ca13d262b5b35)
+
[c13b325](/mantisbt/mantisbt/commit/c13b325365bd98118fe8f31d20826bc7ada3a9d9)

commit b3511d2

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**91 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core.php
  [core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a)
* core

  + core/events\_inc.php
    [events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619)
  + core/http\_api.php
    [http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4)
* docbook/Developers\_Guide/en-US

  + docbook/Developers\_Guide/en-US/Events\_Reference.xml
    [Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8)
* plugins/Gravatar

  + plugins/Gravatar/Gravatar.php
    [Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[core.php](#diff-12c64b5df81f5ee6cf28ade08b1cb9e33d1e43339aa7c2aba61128d1bb57c83a "core.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -274,6 +274,7 @@ function \_\_autoload( $p\_class ) { |
|  |  |  |
|  |  | # Set HTTP response headers |
|  |  | require\_api( 'http\_api.php' ); |
|  |  | event\_signal( 'EVENT\_CORE\_HEADERS' ); |
|  |  | http\_all\_headers(); |
|  |  |  |
|  |  | # Push default language to speed calls to lang\_get |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[core/events\_inc.php](#diff-4ae428a663fef164003525ac76bd8988b835b7cbdc7065e11f6a42558b545619 "core/events_inc.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/events_inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  |  |
|  |  | # Events specific to the core system |
|  |  | 'EVENT\_CORE\_READY' => EVENT\_TYPE\_EXECUTE, |
|  |  | 'EVENT\_CORE\_HEADERS' => EVENT\_TYPE\_EXECUTE, |
|  |  |  |
|  |  | # MantisBT Layout Events |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => EVENT\_TYPE\_OUTPUT, |
| Expand Down | |  |

88 changes: 73 additions & 15 deletions

88
[core/http\_api.php](#diff-9c9f91706a93a46715a4140a5c21292204b6559fa956fc9dd10bf824fd91c1e4 "core/http_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/core/http_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,12 @@ |
|  |  |  |
|  |  | require\_api( 'config\_api.php' ); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The Content-Security-Policy settings array. Use http\_csp\_add() to update it. |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | $g\_csp = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks to see if script was queried through the HTTPS protocol |
|  |  | \* @return boolean True if protocol is HTTPS |
| Expand Down  Expand Up | | @@ -138,6 +144,64 @@ function http\_content\_headers() { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add a Content-Security-Policy directive. |
|  |  | \* |
|  |  | \* @param string $p\_type The directive type, e.g. style-src, script-src. |
|  |  | \* @param string $p\_value The directive value, e.g. 'self', https://ajax.googleapis.com |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_add( $p\_type, $p\_value ) { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | if ( isset( $g\_csp[$p\_type] ) ) { |
|  |  | if ( !in\_array( $p\_value, $g\_csp[$p\_type] ) ) { |
|  |  | $g\_csp[$p\_type][] = $p\_value; |
|  |  | } |
|  |  | } else { |
|  |  | $g\_csp[$p\_type] = array( $p\_value ); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructs the value of the CSP header. |
|  |  | \* @return string CSP header value. |
|  |  | \*/ |
|  |  | function http\_csp\_value() { |
|  |  | global $g\_csp; |
|  |  |  |
|  |  | if ( $g\_csp === null ) { |
|  |  | # Development error, headers already emitted. |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = ''; |
|  |  |  |
|  |  | foreach ( $g\_csp as $t\_key => $t\_values ) { |
|  |  | $t\_csp\_value .= $t\_key . ' ' . implode( ' ', $t\_values ) . '; '; |
|  |  | } |
|  |  |  |
|  |  | $t\_csp\_value = trim( $t\_csp\_value, '; ' ); |
|  |  |  |
|  |  | return $t\_csp\_value; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Send header for Content-Security-Policy. |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function http\_csp\_emit\_header() { |
|  |  | header( 'Content-Security-Policy: ' . http\_csp\_value() ); |
|  |  |  |
|  |  | global $g\_csp; |
|  |  | $g\_csp = null; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set security headers (frame busting, clickjacking/XSS/CSRF protection). |
|  |  | \* @return void |
| Expand All | | @@ -147,32 +211,26 @@ function http\_security\_headers() { |
|  |  | header( 'X-Frame-Options: DENY' ); |
|  |  |  |
|  |  | # Define Content Security Policy |
|  |  | $t\_csp = array( |
|  |  | "default-src 'self'", |
|  |  | "frame-ancestors 'none'", |
|  |  | ); |
|  |  |  |
|  |  | $t\_style\_src = "style-src 'self'"; |
|  |  | $t\_script\_src = "script-src 'self'"; |
|  |  | http\_csp\_add( 'default-src', "'self'" ); |
|  |  | http\_csp\_add( 'frame-ancestors', "'none'" ); |
|  |  | http\_csp\_add( 'style-src', "'self'" ); |
|  |  | http\_csp\_add( 'script-src', "'self'" ); |
|  |  | http\_csp\_add( 'img-src', "'self'" ); |
|  |  |  |
|  |  | # White list the CDN urls (if enabled) |
|  |  | if ( config\_get\_global( 'cdn\_enabled' ) == ON ) { |
|  |  | $t\_cdn\_url = 'https://ajax.googleapis.com'; |
|  |  | $t\_style\_src .= " $t\_cdn\_url"; |
|  |  | $t\_script\_src .= " $t\_cdn\_url"; |
|  |  | http\_csp\_add( 'style-src', $t\_cdn\_url ); |
|  |  | http\_csp\_add( 'script-src', $t\_cdn\_url ); |
|  |  | } |
|  |  |  |
|  |  | # Relaxing policy for roadmap page to allow inline styles |
|  |  | # This is a workaround to fix the broken progress bars (see #19501) |
|  |  | if( 'roadmap\_page.php' == basename( $\_SERVER['SCRIPT\_NAME'] ) ) { |
|  |  | $t\_style\_src .= " 'unsafe-inline'"; |
|  |  | http\_csp\_add( 'style-src', "'unsafe-inline'" ); |
|  |  | } |
|  |  |  |
|  |  | $t\_csp[] = $t\_style\_src; |
|  |  | $t\_csp[] = $t\_script\_src; |
|  |  |  |
|  |  | # Set CSP header |
|  |  | header( 'Content-Security-Policy: ' . implode('; ', $t\_csp) ); |
|  |  | http\_csp\_emit\_header(); |
|  |  |  |
|  |  | if( http\_is\_protocol\_https() ) { |
|  |  | header( 'Strict-Transport-Security: max-age=7776000' ); |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[docbook/Developers\_Guide/en-US/Events\_Reference.xml](#diff-985da638938d3ee14a38b53db2052bac411e5f6e9f5717c76a5e5c9987d302b8 "docbook/Developers_Guide/en-US/Events_Reference.xml")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/docbook/Developers_Guide/en-US/Events_Reference.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,6 +83,19 @@ |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreheaders"> |
|  |  | <title>EVENT\_CORE\_HEADERS (Execute)</title> |
|  |  |  |
|  |  | <blockquote> |
|  |  | <para> |
|  |  | This event is triggered by the MantisBT bootstrap process just before emitting the |
|  |  | headers. This enables plugins to emit their own headers or use API that enables |
|  |  | tweaking values of headers emitted by core. An example, of headers that can be |
|  |  | tweaked is Content-Security-Policy header which can be tweaked using http\_csp\_\*() APIs. |
|  |  | </para> |
|  |  | </blockquote> |
|  |  | </blockquote> |
|  |  |  |
|  |  | <blockquote id="dev.eventref.system.coreready"> |
|  |  | <title>EVENT\_CORE\_READY (Execute)</title> |
|  |  |  |
| Expand Down | |  |

11 changes: 3 additions & 8 deletions

11
[plugins/Gravatar/Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949 "plugins/Gravatar/Gravatar.php")

Show comments

[View file](/mantisbt/mantisbt/blob/b3511d2feb47eaee41feb5f69cf3c8a2c9acd229/plugins/Gravatar/Gravatar.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -106,21 +106,16 @@ function config() { |
|  |  | function hooks() { |
|  |  | return array( |
|  |  | 'EVENT\_USER\_AVATAR' => 'user\_get\_avatar', |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => 'csp\_headers', |
|  |  | 'EVENT\_CORE\_HEADERS' => 'csp\_headers', |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add Content-Security-Policy for retrieving Avatar images. |
|  |  | \* |
|  |  | \* @return void |
|  |  | \* Register gravatar url as an img-src for CSP header |
|  |  | \*/ |
|  |  | function csp\_headers() { |
|  |  | # Policy for images: Allow gravatar URL |
|  |  | if( config\_get( 'show\_avatar' ) !== OFF ) { |
|  |  | # Set CSP header |
|  |  | header( "Content-Security-Policy: img-src 'self' " . |
|  |  | self::getAvatarUrl() ); |
|  |  | http\_csp\_add( 'img-src', self::getAvatarUrl() ); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b3511d2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fb3511d2f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c745ea7d_20250126_014044.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff24a3e9cd0729688b7bdaa9ab8a450616fad58ae)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff24a3e9cd0729688b7bdaa9ab8a450616fad58ae)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Use Content-Security-Policy API in Gravatar

[Browse files](/mantisbt/mantisbt/tree/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae)
Browse the repository at this point in the history

```
Fixes #21263
```

* Loading branch information

[![@vboctor](https://avatars.githubusercontent.com/u/6446?s=40&v=4)](/vboctor) [![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[vboctor](/mantisbt/mantisbt/commits?author=vboctor "View all commits by vboctor")
authored and
[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 27, 2016

1 parent
[a905dd0](/mantisbt/mantisbt/commit/a905dd01d97c8858327cc958b83d976911a4dc5a)

commit f24a3e9

Showing
**1 changed file**
with
**5 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

20 changes: 5 additions & 15 deletions

20
[plugins/Gravatar/Gravatar.php](#diff-b99dfd1b749f2d15bbe3c5eeb675d4f30e6617647312eebb12780bdb20977949 "plugins/Gravatar/Gravatar.php")

Show comments

[View file](/mantisbt/mantisbt/blob/f24a3e9cd0729688b7bdaa9ab8a450616fad58ae/plugins/Gravatar/Gravatar.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -104,24 +104,14 @@ function config() { |
|  |  | \* Register event hooks for plugin. |
|  |  | \*/ |
|  |  | function hooks() { |
|  |  | return array( |
|  |  | 'EVENT\_USER\_AVATAR' => 'user\_get\_avatar', |
|  |  | 'EVENT\_LAYOUT\_RESOURCES' => 'csp\_headers', |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add Content-Security-Policy for retrieving Avatar images. |
|  |  | \* |
|  |  | \* @return void |
|  |  | \*/ |
|  |  | function csp\_headers() { |
|  |  | # Policy for images: Allow gravatar URL |
|  |  | if( config\_get( 'show\_avatar' ) !== OFF ) { |
|  |  | # Set CSP header |
|  |  | header( "Content-Security-Policy: img-src 'self' " . |
|  |  | self::getAvatarUrl() ); |
|  |  | http\_csp\_add( 'img-src', self::getAvatarUrl() ); |
|  |  | } |
|  |  |  |
|  |  | return array( |
|  |  | 'EVENT\_USER\_AVATAR' => 'user\_get\_avatar', |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f24a3e9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Ff24a3e9cd0729688b7bdaa9ab8a450616fad58ae) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


