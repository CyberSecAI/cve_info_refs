- **Root cause of vulnerability**: Insecure file permissions on the `/etc/luminex/pkgmgr` directory and its contents (`packages.db` and `pkgmgr`). These are set to `drwxrwxrwx` and `-rwxrwxrwx` respectively, granting write access to all users.
- **Weaknesses/vulnerabilities present**: Insecure file permissions, specifically granting write access to all users, allowing any local user to modify the contents of `/etc/luminex/pkgmgr` and the files within it.
- **Impact of exploitation**: A local user can modify the contents of `pkgmgr` to execute arbitrary commands as root. The provided exploit code demonstrates modifying `pkgmgr` to chmod the `/etc/shadow` file to be readable by all users, allowing an attacker to access user password hashes.
- **Attack vectors**: Local access is required to exploit this vulnerability.
- **Required attacker capabilities/position**: The attacker must have local access to the system.