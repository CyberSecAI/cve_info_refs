=== Content from github.com_1f5f25ea_20250124_220226.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F8148a73c9901a8794a50f950083c00ccf97d43b3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F8148a73c9901a8794a50f950083c00ccf97d43b3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/8148a73c9901a8794a50f950083c00ccf97d43b3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

proc: prevent accessing /proc/<PID>/environ until it's ready

[Browse files](/torvalds/linux/tree/8148a73c9901a8794a50f950083c00ccf97d43b3)
Browse the repository at this point in the history

```
If /proc/<PID>/environ gets read before the envp[] array is fully set up
in create_{aout,elf,elf_fdpic,flat}_tables(), we might end up trying to
read more bytes than are actually written, as env_start will already be
set but env_end will still be zero, making the range calculation
underflow, allowing to read beyond the end of what has been written.

Fix this as it is done for /proc/<PID>/cmdline by testing env_end for
zero.  It is, apparently, intentionally set last in create_*_tables().

This bug was found by the PaX size_overflow plugin that detected the
arithmetic underflow of 'this_len = env_end - (env_start + src)' when
env_end is still zero.

The expected consequence is that userland trying to access
/proc/<PID>/environ of a not yet fully set up process may get
inconsistent data as we're in the middle of copying in the environment
variables.

Fixes: <https://forums.grsecurity.net/viewtopic.php?f=3&t=4363>
Fixes: <https://bugzilla.kernel.org/show_bug.cgi?id=116461>
Signed-off-by: Mathias Krause <minipli@googlemail.com>
Cc: Emese Revfy <re.emese@gmail.com>
Cc: Pax Team <pageexec@freemail.hu>
Cc: Al Viro <viro@zeniv.linux.org.uk>
Cc: Mateusz Guzik <mguzik@redhat.com>
Cc: Alexey Dobriyan <adobriyan@gmail.com>
Cc: Cyrill Gorcunov <gorcunov@openvz.org>
Cc: Jarod Wilson <jarod@redhat.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
```

* Loading branch information

[![@minipli](https://avatars.githubusercontent.com/u/6798636?s=40&v=4)](/minipli) [![@torvalds](https://avatars.githubusercontent.com/u/1024025?s=40&v=4)](/torvalds)

[minipli](/torvalds/linux/commits?author=minipli "View all commits by minipli")
authored and
[torvalds](/torvalds/linux/commits?author=torvalds "View all commits by torvalds")
committed
May 6, 2016

1 parent
[32a4e16](/torvalds/linux/commit/32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc)

commit 8148a73

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[fs/proc/base.c](#diff-0877705e25683411e68e80ddb47b57b359ee9b33b0e49bc764a51c7b0ac3c369 "fs/proc/base.c")

Show comments

[View file](/torvalds/linux/blob/8148a73c9901a8794a50f950083c00ccf97d43b3/fs/proc/base.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -955,7 +955,8 @@ static ssize\_t environ\_read(struct file \*file, char \_\_user \*buf, |
|  |  | struct mm\_struct \*mm = file->private\_data; |
|  |  | unsigned long env\_start, env\_end; |
|  |  |  |
|  |  | if (!mm) |
|  |  | /\* Ensure the process spawned far enough to have an environment. \*/ |
|  |  | if (!mm || !mm->env\_end) |
|  |  | return 0; |
|  |  |  |
|  |  | page = (char \*)\_\_get\_free\_page(GFP\_TEMPORARY); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8148a73`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F8148a73c9901a8794a50f950083c00ccf97d43b3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.ubuntu.com_f5b7c989_20250124_220217.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3159-2: Linux kernel (OMAP4) vulnerability

20 December 2016

The system could be made to expose sensitive information.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [linux-ti-omap4](/security/cves?package=linux-ti-omap4) - Linux kernel for OMAP4

## Details

It was discovered that a race condition existed in the procfs

environ\_read function in the Linux kernel, leading to an integer

underflow. A local attacker could use this to expose sensitive

information (kernel memory).

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [linux-image-3.2.0-1497-omap4](https://launchpad.net/ubuntu/%2Bsource/linux-ti-omap4)
  -
  [3.2.0-1497.124](https://launchpad.net/ubuntu/%2Bsource/linux-ti-omap4/3.2.0-1497.124)
* [linux-image-omap4](https://launchpad.net/ubuntu/%2Bsource/linux-ti-omap4)
  -
  [3.2.0.1497.92](https://launchpad.net/ubuntu/%2Bsource/linux-ti-omap4/3.2.0-1497.124)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2016-7916](/security/CVE-2016-7916)

## Related notices

* [USN-3160-2](/security/notices/USN-3160-2)
* [USN-3159-1](/security/notices/USN-3159-1)
* [USN-3160-1](/security/notices/USN-3160-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from source.android.com_c5f1c859_20250124_220200.html ===


[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

`/`

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어

[Android Code Search](https://cs.android.com/android/platform/superproject/main)
Sign in

* [Documentation](https://source.android.com/docs)

[What's New?](https://source.android.com/docs/whatsnew)

[Getting Started](https://source.android.com/docs/setup)

[Security](https://source.android.com/docs/security)

[Core Topics](https://source.android.com/docs/core)

[Compatibility](https://source.android.com/docs/compatibility)

[Android Devices](https://source.android.com/docs/devices)

[Automotive](https://source.android.com/docs/automotive)

[Reference](https://source.android.com/reference)

[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

* [Docs](/docs)
  + More
  + [What's New?](/docs/whatsnew)
  + [Getting Started](/docs/setup)
  + [Security](/docs/security)
  + [Core Topics](/docs/core)
  + [Compatibility](/docs/compatibility)
  + [Android Devices](/docs/devices)
  + [Automotive](/docs/automotive)
  + [Reference](/reference)
* [Android Code Search](https://cs.android.com/android/platform/superproject/main)

* [Overview](/docs/security)
* Security overview
  + [Secure an Android device](/docs/security/overview)
  + [Kernel security](/docs/security/overview/kernel-security)
  + [App security](/docs/security/overview/app-security)
  + [Implement security](/docs/security/overview/implement)
  + [Updates and resources](/docs/security/overview/updates-resources)
  + [ASPIRE](/docs/security/overview/aspire)
  + [Reports](/docs/security/overview/reports)
  + [Enhancements](/docs/security/enhancements)
  + [Acknowledgements](/docs/security/overview/acknowledgements)
* Android Security Bulletins
  + [Bulletins home](/docs/security/bulletin)
  + [Overview](/docs/security/bulletin/asb-overview)
  + 2025 bulletins
    - [January](/docs/security/bulletin/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/2024-12-01)
    - [November](/docs/security/bulletin/2024-11-01)
    - [October](/docs/security/bulletin/2024-10-01)
    - [September](/docs/security/bulletin/2024-09-01)
    - [August](/docs/security/bulletin/2024-08-01)
    - [July](/docs/security/bulletin/2024-07-01)
    - [June](/docs/security/bulletin/2024-06-01)
    - [May](/docs/security/bulletin/2024-05-01)
    - [April](/docs/security/bulletin/2024-04-01)
    - [March](/docs/security/bulletin/2024-03-01)
    - [February](/docs/security/bulletin/2024-02-01)
    - [January](/docs/security/bulletin/2024-01-01)
    - [Android 15](/docs/security/bulletin/android-15)
  + 2023 bulletins
    - [December](/docs/security/bulletin/2023-12-01)
    - [November](/docs/security/bulletin/2023-11-01)
    - [October](/docs/security/bulletin/2023-10-01)
    - [September](/docs/security/bulletin/2023-09-01)
    - [August](/docs/security/bulletin/2023-08-01)
    - [July](/docs/security/bulletin/2023-07-01)
    - [June](/docs/security/bulletin/2023-06-01)
    - [May](/docs/security/bulletin/2023-05-01)
    - [April](/docs/security/bulletin/2023-04-01)
    - [March](/docs/security/bulletin/2023-03-01)
    - [February](/docs/security/bulletin/2023-02-01)
    - [January](/docs/security/bulletin/2023-01-01)
    - [Android 14](/docs/security/bulletin/android-14)
  + 2022 bulletins
    - [December](/docs/security/bulletin/2022-12-01)
    - [November](/docs/security/bulletin/2022-11-01)
    - [October](/docs/security/bulletin/2022-10-01)
    - [September](/docs/security/bulletin/2022-09-01)
    - [August](/docs/security/bulletin/2022-08-01)
    - [July](/docs/security/bulletin/2022-07-01)
    - [June](/docs/security/bulletin/2022-06-01)
    - [May](/docs/security/bulletin/2022-05-01)
    - [April](/docs/security/bulletin/2022-04-01)
    - [March](/docs/security/bulletin/2022-03-01)
    - [Android 12L](/docs/security/bulletin/android-12l)
    - [February](/docs/security/bulletin/2022-02-01)
    - [January](/docs/security/bulletin/2022-01-01)
    - [Android 13](/docs/security/bulletin/android-13)
    - [Index](/docs/security/bulletin/2022)
  + 2021 bulletins
    - [December](/docs/security/bulletin/2021-12-01)
    - [November](/docs/security/bulletin/2021-11-01)
    - [October](/docs/security/bulletin/2021-10-01)
    - [September](/docs/security/bulletin/2021-09-01)
    - [August](/docs/security/bulletin/2021-08-01)
    - [July](/docs/security/bulletin/2021-07-01)
    - [June](/docs/security/bulletin/2021-06-01)
    - [May](/docs/security/bulletin/2021-05-01)
    - [April](/docs/security/bulletin/2021-04-01)
    - [March](/docs/security/bulletin/2021-03-01)
    - [February](/docs/security/bulletin/2021-02-01)
    - [January](/docs/security/bulletin/2021-01-01)
    - [Android 12](/docs/security/bulletin/android-12)
    - [Index](/docs/security/bulletin/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/2020-12-01)
    - [November](/docs/security/bulletin/2020-11-01)
    - [October](/docs/security/bulletin/2020-10-01)
    - [September](/docs/security/bulletin/2020-09-01)
    - [August](/docs/security/bulletin/2020-08-01)
    - [July](/docs/security/bulletin/2020-07-01)
    - [June](/docs/security/bulletin/2020-06-01)
    - [May](/docs/security/bulletin/2020-05-01)
    - [April](/docs/security/bulletin/2020-04-01)
    - [March](/docs/security/bulletin/2020-03-01)
    - [February](/docs/security/bulletin/2020-02-01)
    - [January](/docs/security/bulletin/2020-01-01)
    - [Android 11](/docs/security/bulletin/android-11)
    - [Index](/docs/security/bulletin/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/2019-12-01)
    - [November](/docs/security/bulletin/2019-11-01)
    - [October](/docs/security/bulletin/2019-10-01)
    - [September](/docs/security/bulletin/2019-09-01)
    - [August](/docs/security/bulletin/2019-08-01)
    - [July](/docs/security/bulletin/2019-07-01)
    - [June](/docs/security/bulletin/2019-06-01)
    - [May](/docs/security/bulletin/2019-05-01)
    - [April](/docs/security/bulletin/2019-04-01)
    - [March](/docs/security/bulletin/2019-03-01)
    - [February](/docs/security/bulletin/2019-02-01)
    - [January](/docs/security/bulletin/2019-01-01)
    - [Android 10](/docs/security/bulletin/android-10)
    - [Index](/docs/security/bulletin/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/2018-12-01)
    - [November](/docs/security/bulletin/2018-11-01)
    - [October](/docs/security/bulletin/2018-10-01)
    - [September](/docs/security/bulletin/2018-09-01)
    - [August](/docs/security/bulletin/2018-08-01)
    - [July](/docs/security/bulletin/2018-07-01)
    - [June](/docs/security/bulletin/2018-06-01)
    - [May](/docs/security/bulletin/2018-05-01)
    - [April](/docs/security/bulletin/2018-04-01)
    - [March](/docs/security/bulletin/2018-03-01)
    - [February](/docs/security/bulletin/2018-02-01)
    - [January](/docs/security/bulletin/2018-01-01)
    - [Index](/docs/security/bulletin/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/2017-12-01)
    - [November](/docs/security/bulletin/2017-11-01)
    - [October](/docs/security/bulletin/2017-10-01)
    - [September](/docs/security/bulletin/2017-09-01)
    - [August](/docs/security/bulletin/2017-08-01)
    - [July](/docs/security/bulletin/2017-07-01)
    - [June](/docs/security/bulletin/2017-06-01)
    - [May](/docs/security/bulletin/2017-05-01)
    - [April](/docs/security/bulletin/2017-04-01)
    - [March](/docs/security/bulletin/2017-03-01)
    - [February](/docs/security/bulletin/2017-02-01)
    - [January](/docs/security/bulletin/2017-01-01)
    - [Index](/docs/security/bulletin/2017)
  + 2016 bulletins
    - [December](/docs/security/bulletin/2016-12-01)
    - [November](/docs/security/bulletin/2016-11-01)
    - [October](/docs/security/bulletin/2016-10-01)
    - [September](/docs/security/bulletin/2016-09-01)
    - [August](/docs/security/bulletin/2016-08-01)
    - [July](/docs/security/bulletin/2016-07-01)
    - [June](/docs/security/bulletin/2016-06-01)
    - [May](/docs/security/bulletin/2016-05-01)
    - [April](/docs/security/bulletin/2016-04-02)
    - [March](/docs/security/bulletin/2016-03-01)
    - [February](/docs/security/bulletin/2016-02-01)
    - [January](/docs/security/bulletin/2016-01-01)
    - [Index](/docs/security/bulletin/2016)
  + 2015 bulletins
    - [December](/docs/security/bulletin/2015-12-01)
    - [November](/docs/security/bulletin/2015-11-01)
    - [October](/docs/security/bulletin/2015-10-01)
    - [September](/docs/security/bulletin/2015-09-01)
    - [August](/docs/security/bulletin/2015-08-01)
    - [Index](/docs/security/bulletin/2015)
  + Pixel/Nexus bulletins
  + [Overview](/docs/security/bulletin/pixel)
  + 2025 bulletins
    - [January](/docs/security/bulletin/pixel/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel/2024-12-01)
    - [November](/docs/security/bulletin/pixel/2024-11-01)
    - [October](/docs/security/bulletin/pixel/2024-10-01)
    - [September](/docs/security/bulletin/pixel/2024-09-01)
    - [August](/docs/security/bulletin/pixel/2024-08-01)
    - [July](/docs/security/bulletin/pixel/2024-07-01)
    - [June](/docs/security/bulletin/pixel/2024-06-01)
    - [May](/docs/security/bulletin/pixel/2024-05-01)
    - [April](/docs/security/bulletin/pixel/2024-04-01)
    - [March](/docs/security/bulletin/pixel/2024-03-01)
    - [February](/docs/security/bulletin/pixel/2024-02-01)
    - [January](/docs/security/bulletin/pixel/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel/2023-12-01)
    - [November](/docs/security/bulletin/pixel/2023-11-01)
    - [October](/docs/security/bulletin/pixel/2023-10-01)
    - [September](/docs/security/bulletin/pixel/2023-09-01)
    - [August](/docs/security/bulletin/pixel/2023-08-01)
    - [July](/docs/security/bulletin/pixel/2023-07-01)
    - [June](/docs/security/bulletin/pixel/2023-06-01)
    - [May](/docs/security/bulletin/pixel/2023-05-01)
    - [April](/docs/security/bulletin/pixel/2023-04-01)
    - [March](/docs/security/bulletin/pixel/2023-03-01)
    - [February](/docs/security/bulletin/pixel/2023-02-01)
    - [January](/docs/security/bulletin/pixel/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/pixel/2022-12-01)
    - [November](/docs/security/bulletin/pixel/2022-11-01)
    - [October](/docs/security/bulletin/pixel/2022-10-01)
    - [September](/docs/security/bulletin/pixel/2022-09-01)
    - [August](/docs/security/bulletin/pixel/2022-08-01)
    - [July](/docs/security/bulletin/pixel/2022-07-01)
    - [June](/docs/security/bulletin/pixel/2022-06-01)
    - [May](/docs/security/bulletin/pixel/2022-05-01)
    - [April](/docs/security/bulletin/pixel/2022-04-01)
    - [March](/docs/security/bulletin/pixel/2022-03-01)
    - [February](/docs/security/bulletin/pixel/2022-02-01)
    - [January](/docs/security/bulletin/pixel/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/pixel/2021-12-01)
    - [November](/docs/security/bulletin/pixel/2021-11-01)
    - [October](/docs/security/bulletin/pixel/2021-10-01)
    - [September](/docs/security/bulletin/pixel/2021-09-01)
    - [August](/docs/security/bulletin/pixel/2021-08-01)
    - [July](/docs/security/bulletin/pixel/2021-07-01)
    - [June](/docs/security/bulletin/pixel/2021-06-01)
    - [May](/docs/security/bulletin/pixel/2021-05-01)
    - [April](/docs/security/bulletin/pixel/2021-04-01)
    - [March](/docs/security/bulletin/pixel/2021-03-01)
    - [February](/docs/security/bulletin/pixel/2021-02-01)
    - [January](/docs/security/bulletin/pixel/2021-01-01)
    - [Index](/docs/security/bulletin/pixel/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/pixel/2020-12-01)
    - [November](/docs/security/bulletin/pixel/2020-11-01)
    - [October](/docs/security/bulletin/pixel/2020-10-01)
    - [September](/docs/security/bulletin/pixel/2020-09-01)
    - [August](/docs/security/bulletin/pixel/2020-08-01)
    - [July](/docs/security/bulletin/pixel/2020-07-01)
    - [June](/docs/security/bulletin/pixel/2020-06-01)
    - [May](/docs/security/bulletin/pixel/2020-05-01)
    - [April](/docs/security/bulletin/pixel/2020-04-01)
    - [March](/docs/security/bulletin/pixel/2020-03-01)
    - [February](/docs/security/bulletin/pixel/2020-02-01)
    - [January](/docs/security/bulletin/pixel/2020-01-01)
    - [Index](/docs/security/bulletin/pixel/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/pixel/2019-12-01)
    - [November](/docs/security/bulletin/pixel/2019-11-01)
    - [October](/docs/security/bulletin/pixel/2019-10-01)
    - [September](/docs/security/bulletin/pixel/2019-09-01)
    - [August](/docs/security/bulletin/pixel/2019-08-01)
    - [July](/docs/security/bulletin/pixel/2019-07-01)
    - [June](/docs/security/bulletin/pixel/2019-06-01)
    - [May](/docs/security/bulletin/pixel/2019-05-01)
    - [April](/docs/security/bulletin/pixel/2019-04-01)
    - [March](/docs/security/bulletin/pixel/2019-03-01)
    - [February](/docs/security/bulletin/pixel/2019-02-01)
    - [January](/docs/security/bulletin/pixel/2019-01-01)
    - [Index](/docs/security/bulletin/pixel/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/pixel/2018-12-01)
    - [November](/docs/security/bulletin/pixel/2018-11-01)
    - [October](/docs/security/bulletin/pixel/2018-10-01)
    - [September](/docs/security/bulletin/pixel/2018-09-01)
    - [August](/docs/security/bulletin/pixel/2018-08-01)
    - [July](/docs/security/bulletin/pixel/2018-07-01)
    - [June](/docs/security/bulletin/pixel/2018-06-01)
    - [May](/docs/security/bulletin/pixel/2018-05-01)
    - [April](/docs/security/bulletin/pixel/2018-04-01)
    - [March](/docs/security/bulletin/pixel/2018-03-01)
    - [February](/docs/security/bulletin/pixel/2018-02-01)
    - [January](/docs/security/bulletin/pixel/2018-01-01)
    - [Index](/docs/security/bulletin/pixel/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/pixel/2017-12-01)
    - [November](/docs/security/bulletin/pixel/2017-11-01)
    - [October](/docs/security/bulletin/pixel/2017-10-01)
    - [Index](/docs/security/bulletin/pixel/2017)
  + Android Automotive
  + [Overview](/docs/security/bulletin/aaos)
  + 2025 bulletins
    - [January](/docs/security/bulletin/aaos/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/aaos/2024-12-01)
    - [November](/docs/security/bulletin/aaos/2024-11-01)
    - [October](/docs/security/bulletin/aaos/2024-10-01)
    - [September](/docs/security/bulletin/aaos/2024-09-01)
    - [August](/docs/security/bulletin/aaos/2024-08-01)
    - [July](/docs/security/bulletin/aaos/2024-07-01)
    - [June](/docs/security/bulletin/aaos/2024-06-01)
    - [May](/docs/security/bulletin/aaos/2024-05-01)
    - [April](/docs/security/bulletin/aaos/2024-04-01)
    - [March](/docs/security/bulletin/aaos/2024-03-01)
    - [February](/docs/security/bulletin/aaos/2024-02-01)
    - [January](/docs/security/bulletin/aaos/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/aaos/2023-12-01)
    - [November](/docs/security/bulletin/aaos/2023-11-01)
    - [October](/docs/security/bulletin/aaos/2023-10-01)
    - [September](/docs/security/bulletin/aaos/2023-09-01)
    - [August](/docs/security/bulletin/aaos/2023-08-01)
    - [July](/docs/security/bulletin/aaos/2023-07-01)
    - [June](/docs/security/bulletin/aaos/2023-06-01)
    - [May](/docs/security/bulletin/aaos/2023-05-01)
    - [April](/docs/security/bulletin/aaos/2023-04-01)
    - [March](/docs/security/bulletin/aaos/2023-03-01)
    - [February](/docs/security/bulletin/aaos/2023-02-01)
    - [January](/docs/security/bulletin/aaos/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/aaos/2022-12-01)
    - [November](/docs/security/bulletin/aaos/2022-11-01)
    - [October](/docs/security/bulletin/aaos/2022-10-01)
    - [September](/docs/security/bulletin/aaos/2022-09-01)
    - [August](/docs/security/bulletin/aaos/2022-08-01)
    - [July](/docs/security/bulletin/aaos/2022-07-01)
    - [June](/docs/security/bulletin/aaos/2022-06-01)
    - [May](/docs/security/bulletin/aaos/2022-05-01)
    - [April](/docs/security/bulletin/aaos/2022-04-01)
    - [March](/docs/security/bulletin/aaos/2022-03-01)
    - [February](/docs/security/bulletin/aaos/2022-02-01)
    - [January](/docs/security/bulletin/aaos/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/aaos/2021-12-01)
    - [November](/docs/security/bulletin/aaos/2021-11-01)
    - [October](/docs/security/bulletin/aaos/2021-10-01)
    - [September](/docs/security/bulletin/aaos/2021-09-01)
    - [August](/docs/security/bulletin/aaos/2021-08-01)
    - [July](/docs/security/bulletin/aaos/2021-07-01)
    - [June](/docs/security/bulletin/aaos/2021-06-01)
    - [May](/docs/security/bulletin/aaos/2021-05-01)
    - [April](/docs/security/bulletin/aaos/2021-04-01)
    - [March](/docs/security/bulletin/aaos/2021-03-01)
    - [February](/docs/security/bulletin/aaos/2021-02-01)
    - [January](/docs/security/bulletin/aaos/2021-01-01)
  + Chromecast
  + [Overview](/docs/security/bulletin/chromecast)
  + 2024 bulletins
    - [December](/docs/security/bulletin/chromecast/2024-12-01)
    - [September](/docs/security/bulletin/chromecast/2024-09-01)
    - [July](/docs/security/bulletin/chromecast/2024-07-01)
    - [March](/docs/security/bulletin/chromecast/2024-03-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/chromecast/2023-12-01)
    - [September](/docs/security/bulletin/chromecast/2023-07-01)
    - [June](/docs/security/bulletin/chromecast/2023-06-01)
    - [April](/docs/security/bulletin/chromecast/2023-04-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/chromecast/2022-12-01)
    - [October](/docs/security/bulletin/chromecast/2022-10-01)
    - [July](/docs/security/bulletin/chromecast/2022-07-01)
  + Wear
  + [Overview](/docs/security/bulletin/wear)
  + 2025 bulletins
    - [January](/docs/security/bulletin/wear/2025/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/wear/2024/2024-12-01)
    - [November](/docs/security/bulletin/wear/2024/2024-11-01)
    - [October](/docs/security/bulletin/wear/2024/2024-10-01)
    - [September](/docs/security/bulletin/wear/2024/2024-09-01)
    - [August](/docs/security/bulletin/wear/2024/2024-08-01)
    - [July](/docs/security/bulletin/wear/2024/2024-07-01)
    - [June](/docs/security/bulletin/wear/2024/2024-06-01)
    - [May](/docs/security/bulletin/wear/2024/2024-05-01)
    - [April](/docs/security/bulletin/wear/2024/2024-04-01)
    - [March](/docs/security/bulletin/wear/2024/2024-03-01)
    - [February](/docs/security/bulletin/wear/2024/2024-02-01)
    - [January](/docs/security/bulletin/wear/2024/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/wear/2023/2023-12-01)
    - [November](/docs/security/bulletin/wear/2023/2023-11-01)
    - [October](/docs/security/bulletin/wear/2023/2023-10-01)
    - [September](/docs/security/bulletin/wear/2023/2023-09-01)
    - [August](/docs/security/bulletin/wear/2023/2023-08-01)
  + Pixel Watch
  + [Overview](/docs/security/bulletin/pixel-watch)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2024-12-01)
    - [August](/docs/security/bulletin/pixel-watch/2024-08-01)
    - [July](/docs/security/bulletin/pixel-watch/2024-07-01)
    - [June](/docs/security/bulletin/pixel-watch/2024-06-01)
    - [May](/docs/security/bulletin/pixel-watch/2024-05-01)
    - [April](/docs/security/bulletin/pixel-watch/2024-04-01)
    - [March](/docs/security/bulletin/pixel-watch/2024-03-01)
    - [February](/docs/security/bulletin/pixel-watch/2024-02-01)
    - [January](/docs/security/bulletin/pixel-watch/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2023/2023-12-01)
    - [September](/docs/security/bulletin/pixel-watch/2023/2023-09-01)
    - [June](/docs/security/bulletin/pixel-watch/2023/2023-06-01)
  + Advisories
  + [Overview](/docs/security/bulletin/advisory)
  + [March 2016](/docs/security/bulletin/advisory/2016-03-18)
* Features
  + [Overview](/docs/security/features)
  + [Application Sandbox](/docs/security/app-sandbox)
  + [OMAPI vendor stable interface](/docs/security/features/open-mobile-api)
  + App signing
    - [Overview](/docs/security/features/apksigning)
    - [APK signature scheme v2](/docs/security/features/apksigning/v2)
    - [APK signature scheme v3](/docs/security/features/apksigning/v3)
    - [APK signature scheme v3.1](/docs/security/features/apksigning/v3-1)
    - [APK signature scheme v4](/docs/security/features/apksigning/v4)
  + Authentication
    - [Overview](/docs/security/features/authentication)
    - [Gatekeeper](/docs/security/features/authentication/gatekeeper)
    - Biometrics
      * [Overview](/docs/security/features/biometric)
      * [Measure biometric security](/docs/security/features/biometric/measure)
      * [Fingerprint HIDL](/docs/security/features/authentication/fingerprint-hal)
      * [Face authentication HIDL](/docs/security/features/biometric/face-authentication)
    - Protected confirmation
      * [Overview](/docs/security/features/protected-confirmation)
      * [Implementation](/docs/security/features/protected-confirmation/implementation)
      * [Design guidelines](/docs/security/features/protected-confirmation/design)
      * [Accessibility](/docs/security/features/protected-confirmation/accessibility)
  + DICE
    - [Overview](/docs/security/features/dice)
    - [Applications of DICE](/docs/security/features/dice/applications-of-dice)
  + Encryption
    - [Overview](/docs/security/features/encryption)
    - [File-based encryption](/docs/security/features/encryption/file-based)
    - [Full-disk encryption](/docs/security/features/encryption/full-disk)
    - [Metadata encryption](/docs/security/features/encryption/metadata)
    - [Enable Adiantum](/docs/security/features/encryption/adiantum)
    - [Hardware-wrapped keys](/docs/security/features/encryption/hw-wrapped-keys)
  + Keystore
    - [Overview](/docs/security/features/keystore)
    - [Features](/docs/security/features/keystore/features)
    - [Key and ID attestation](/docs/security/features/keystore/attestation)
    - [Version binding](/docs/security/features/keystore/version-binding)
    - [Authorization tags](/docs/security/features/keystore/tags)
    - [Functions](/docs/security/features/keystore/implementer-ref)
  + Identity credential
    - [Overview](/docs/security/features/identity-credentials)
  + SELinux
    - [Overview](/docs/security/features/selinux)
    - [Concepts](/docs/security/features/selinux/concepts)
    - [Implementation](/docs/security/features/selinux/implement)
    - [Customization](/docs/security/features/selinux/customize)
    - [Build sepolicy](/docs/security/features/selinux/build)
    - [Compatibility](/docs/security/features/selinux/compatibility)
    - [Validation](/docs/security/features/selinux/validate)
    - [Write policy](/docs/security/features/selinux/device-policy)
    - [Vendor init](/docs/security/features/selinux/vendor-init)
  + Trusty TEE
    - [Overview](/docs/security/features/trusty)
    - [Download and build](/docs/security/features/trusty/download-and-build)
    - [Trusty API reference](/docs/security/features/trusty/trusty-ref)
  + Verified Boot
    - [Overview](/docs/security/features/verifiedboot)
    - [Device state](/docs/security/features/verifiedboot/device-state)
    - [Verify Boot](/docs/security/features/verifiedboot/verified-boot)
    - [Boot flow](/docs/security/features/verifiedboot/boot-flow)
    - [Implement dm-verity](/docs/security/features/verifiedboot/dm-verity)
    - [Verify system\_other partition](/docs/security/features/verifiedboot/verify-system-other-partition)
    - [Reference implementation](/docs/security/features/verifiedboot/avb)
  + Safety Center
    - [Overview](/docs/security/safety-center/overview)
    - [Customize Safety Center](/docs/security/safety-center/customize)
    - [Customize Safety Center UI](/docs/security/safety-center/customize-ui)
    - [Interact with Safety Center](/docs/security/safety-center/interact)
    - [Testing and validation](/docs/security/safety-center/test-requirements)
  + Cellular security
    - [Overview](/docs/security/features/cellular-security/overview)
    - [Disable 2G](/docs/security/features/cellular-security/disable-2g)
  + [Private space](/docs/security/features/private-space)
* Testing
  + [Overview](/docs/security/test/fuzz-sanitize)
  + [Memory safety](/docs/security/test/memory-safety)
  + Arm Memory Tagging Extension
  + [Overview](/docs/security/test/memory-safety/arm-mte)
  + [Bootloader support](/docs/security/test/memory-safety/bootloader-support)
  + [Understand MTE reports](/docs/security/test/memory-safety/mte-reports)
  + [MTE configuration](/docs/security/test/memory-safety/mte-configuration)
  + Sanitizers
  + [Overview](/docs/security/test/sanitizers)
  + [AddressSanitizer](/docs/security/test/asan)
  + [Kernel AddressSanitizer](/docs/security/test/kasan)
  + [Hardware-assisted AddressSanitizer](/docs/security/test/hwasan)
  + [Understand HWASan reports](/docs/security/test/memory-safety/hwasan-reports)
  + [UndefinedBehaviorSanitizer](/docs/security/test/ubsan)
  + Other topics
  + [Control flow integrity](/docs/security/test/cfi)
  + [Kernel control flow integrity](/docs/security/test/kcfi)
  + [Execute-only memory](/docs/security/test/execute-only-memory)
  + [Fuzz with libFuzzer](/docs/security/test/libfuzzer)
  + [GWP-ASan and KFENCE](/docs/security/test/memory-safety/gwp-asan-kfence)
  + [Security Test Suite development kit](/docs/security/test/sts-sdk)
  + [Scudo](/docs/security/test/scudo)
  + [ShadowCallStack](/docs/security/test/shadow-call-stack)
  + [Tagged pointers](/docs/security/test/tagged-pointers)
  + [Zero initialized memory](/docs/security/test/memory-safety/zero-initialized-memory)
* Best practices
  + [Overview](/docs/security/best-practices)
  + [Operational security](/docs/security/best-practices/ops)
  + [System security](/docs/security/best-practices/system)
  + [App security](/docs/security/best-practices/app)
  + [Network security](/docs/security/best-practices/network)
  + [Hardware security](/docs/security/best-practices/hardware)
  + [Privacy security](/docs/security/best-practices/privacy)

* What's new?
* [Release notes](/docs/whatsnew/release-notes)
* [Latest security bulletins](/docs/whatsnew/latest-security-bulletins)
* [Latest Compatibility Definition Document (CDD)](/docs/whatsnew/latest-cdd)
* [Site updates](/docs/whatsnew/site-updates)
* Getting Started
* [About](/docs/setup/about)
* [Start](/docs/setup/start)
* [Download](/docs/setup/download)
* [Build](/docs/setup/build)
* [Test](/docs/setup/test)
* [Create](/docs/setup/create/coding-tasks)
* [Contribute](/docs/setup/contribute)
* [Community](/docs/setup/community/cofc)
* [Tools, build, and related reference](/docs/setup/reference)
* Security
* [Overview](/docs/security/overview)
* [Bulletins](/docs/security/bulletin)
* [Features](/docs/security/features)
* [Testing](/docs/security/test/fuzz-sanitize)
* [Best Practices](/docs/security/best-practices)
* Core Topics
* [Architecture](/docs/core/architecture)
* [Audio](/docs/core/audio)
* [Camera](/docs/core/camera)
* [Connectivity](/docs/core/connect)
* [Data](/docs/core/data)
* [Display](/docs/core/display)
* [Fonts](/docs/core/fonts/custom-font-fallback)
* [Graphics](/docs/core/graphics)
* [Interaction](/docs/core/interaction)
* [Media](/docs/core/media)
* [Performance](/docs/core/perf)
* [Permissions](/docs/core/permissions)
* [Power](/docs/core/power)
* [Runtime](/docs/core/runtime)
* [Settings](/docs/core/settings)
* [Storage](/docs/core/storage)
* [Tests](/docs/core/tests)
* [Updates](/docs/core/ota)
* [Virtualization](/docs/core/virtualization)
* Compatibility
* [Compatibility Definition Document (CDD)](/docs/compatibility/cdd)
* [Compatibility Test Suite (CTS)](/docs/compatibility/cts)
* Android Devices
* [Cuttlefish](/docs/devices/cuttlefish)
* [Enterprise](/docs/devices/admin)
* [TV](/docs/devices/tv)
* Automotive
* [Get Started](/docs/automotive/start/what_automotive)
* [Guidelines for Development](/docs/automotive/guidelines)
* [Development Tools](/docs/automotive/dev-tools)
* [Testing Tools and Infrastructure](/docs/automotive/tools)
* [Release Details](/docs/automotive/start/releases)
* Reference
* [HIDL](/reference/hidl)
* [HAL](/reference/hal)
* [Trade Federation](/reference/tradefed/classes)
* [Security Test Suite](/reference/sts/classes)

* [AOSP](https://source.android.com/)
* [Security](https://source.android.com/docs/security)

# Android Security Bulletin—November 2016

Stay organized with collections

Save and categorize content based on your preferences.

*Published November 07, 2016 | Updated December 21, 2016*

The Android Security Bulletin contains details of security vulnerabilities
affecting Android devices. Alongside the bulletin, we have released a security
update to Google devices through an over-the-air (OTA) update. The Google device
firmware images have also been released to the
[Google Developer
site](https://developers.google.com/android/nexus/images). Security patch levels of November 06, 2016 or later address all of
these issues. Refer to the
[Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices) to learn how to check a device's security patch level.

Partners were notified of the issues described in the bulletin on October 20,
2016 or earlier. Where applicable, source code patches for these issues have
been released to the Android Open Source Project (AOSP) repository. This
bulletin also includes links to patches outside of AOSP.

The most severe of these issues is a Critical security vulnerability that could
enable remote code execution on an affected device through multiple methods such
as email, web browsing, and MMS when processing media files. The
[severity
assessment](/docs/security/overview/updates-resources#severity) is based on the effect that exploiting the vulnerability would
possibly have on an affected device, assuming the platform and service
mitigations are disabled for development purposes or if successfully bypassed.

We have had no reports of active customer exploitation or abuse of these newly
reported issues. Refer to the
[Android and Google service
mitigations](#mitigations) section for details on the
[Android
security platform protections](/docs/security/enhancements) and service protections such as
[SafetyNet](https://developer.android.com/training/safetynet/index.html),
which improve the security of the Android platform.

We encourage all customers to accept these updates to their devices.

## Announcements

* With the introduction of the Pixel and Pixel XL devices, the term for
  [all devices supported by Google](#google-devices) is
  "Google devices" instead of "Nexus devices."
* This bulletin has three security patch levels to provide Android partners
  with the flexibility to more quickly fix a subset of vulnerabilities that are
  similar across all Android devices. See
  [Common questions and answers](#common-questions-and-answers) for
  additional information:
  + **2016-11-01**: Partial security patch level. This security
    patch level indicates that all issues associated with 2016-11-01 (and all
    previous security patch level) are addressed.
  + **2016-11-05**: Complete security patch level. This security
    patch level indicates that all issues associated with 2016-11-01 and 2016-11-05
    (and all previous security patch levels) are addressed.
  + **Supplemental security patch levels**

    Supplemental security patch levels are provided to identify devices
    that contain fixes for issues that were publicly disclosed after the
    patch level was defined. Addressing these recently disclosed
    vulnerabilities is not required until the 2016-12-01 security patch level.

    - **2016-11-06**: This security patch level indicates that the
      device has addressed all issues associated with 2016-11-05 and CVE-2016-5195,
      which was publicly disclosed on October 19, 2016.
* Supported Google devices will receive a single OTA update with the November
  05, 2016 security patch level.

## Android and Google service mitigations

This is a summary of the mitigations provided by the
[Android
security platform](/docs/security/enhancements) and service protections, such as SafetyNet. These
capabilities reduce the likelihood that security vulnerabilities could be
successfully exploited on Android.

* Exploitation for many issues on Android is made more difficult by
  enhancements in newer versions of the Android platform. We encourage all users
  to update to the latest version of Android where possible.
* The Android Security team actively monitors for abuse with
  [Verify
  Apps and SafetyNet](/static/docs/security/overview/reports/Google_Android_Security_2015_Report_Final.pdf), which are designed to warn users about
  [Potentially
  Harmful Applications](http://static.googleusercontent.com/media/source.android.com/en//security/reports/Google_Android_Security_PHA_classifications.pdf). Verify Apps is enabled by default on devices with
  [Google Mobile Services](http://www.android.com/gms) and is especially
  important for users who install applications from outside of Google Play. Device
  rooting tools are prohibited within Google Play, but Verify Apps warns users
  when they attempt to install a detected rooting application—no matter where it
  comes from. Additionally, Verify Apps attempts to identify and block
  installation of known malicious applications that exploit a privilege escalation
  vulnerability. If such an application has already been installed, Verify Apps
  will notify the user and attempt to remove the detected application.
* As appropriate, Google Hangouts and Messenger applications do not
  automatically pass media to processes such as Mediaserver.

## Acknowledgements

We would like to thank these researchers for their contributions:

* Abhishek Arya, Oliver Chang, and Martin Barbella of Google Chrome Security
  Team: CVE-2016-6722
* Andrei Kapishnikov and Miriam Gershenson of Google: CVE-2016-6703
* Ao Wang ([@ArayzSegment](https://twitter.com/ArayzSegment)) and
  [Zinuo Han](http://weibo.com/ele7enxxh) of
  [PKAV](http://www.pkav.net), Silence Information Technology:
  CVE-2016-6700, CVE-2016-6702
* Askyshang of Security Platform Department, Tencent: CVE-2016-6713
* Billy Lau of Android Security: CVE-2016-6737
* Constantinos Patsakis and
  Efthimios Alepis of University of Piraeus:
  CVE-2016-6715
* dragonltx of Alibaba mobile security team: CVE-2016-6714
* Gal Beniamini of Project Zero: CVE-2016-6707, CVE-2016-6717
* Gengjia Chen ([@chengjia4574](http://twitter.com/chengjia4574))
  and [pjf](http://weibo.com/jfpan) of IceSword Lab,
  [Qihoo 360 Technology Co. Ltd](http://www.360.com).: CVE-2016-6725,
  CVE-2016-6738, CVE-2016-6740, CVE-2016-6741, CVE-2016-6742, CVE-2016-6744,
  CVE-2016-6745, CVE-2016-3906
* Guang Gong (龚广) ([@oldfresher](http://twitter.com/oldfresher)) of
  Alpha Team, [Qihoo 360 Technology Co. Ltd](http://www.360.com).:
  CVE-2016-6754
* Jianqiang Zhao ([@jianqiangzhao](http://twitter.com/jianqiangzhao)) and
  [pjf](http://weibo.com/jfpan) of IceSword Lab,
  [Qihoo 360 Technology Co. Ltd](http://www.360.com).: CVE-2016-6739,
  CVE-2016-3904, CVE-2016-3907, CVE-2016-6698
* Marco Grassi ([@marcograss](http://twitter.com/marcograss)) of
  Keen Lab of Tencent ([@keen\_lab](http://twitter.com/keen_lab)):
  CVE-2016-6828
* Mark Brand of Project Zero: CVE-2016-6706
* Mark Renouf of Google: CVE-2016-6724
* Michał Bednarski ([github.com/michalbednarski](https://github.com/michalbednarski)):
  CVE-2016-6710
* Min Chong of Android Security: CVE-2016-6743
* Peter Pi ([@heisecode](http://twitter.com/heisecode)) of Trend
  Micro: CVE-2016-6721
* Qidan He (何淇丹) ([@flanker\_hqd](http://twitter.com/flanker_hqd))
  and Gengming Liu (刘耕铭) ([@dmxcsnsbh](http://twitter.com/dmxcsnsbh))
  of KeenLab, Tencent: CVE-2016-6705
* Robin Lee of Google: CVE-2016-6708
* Scott Bauer ([@ScottyBauer1](http://twitter.com/ScottyBauer1)): CVE-2016-6751
* Sergey Bobrov ([@Black2Fan](http://twitter.com/Black2Fan)) of
  Kaspersky Lab: CVE-2016-6716
* Seven Shen ([@lingtongshen](http://twitter.com/lingtongshen)) of
  Trend Micro Mobile Threat Research Team: CVE-2016-6748, CVE-2016-6749,
  CVE-2016-6750, CVE-2016-6753
* Victor van der Veen, Herbert Bos, Kaveh Razavi, and Cristiano Giuffrida of
  Vrije Universiteit Amsterdam and Yanick Fratantonio, Martina Lindorfer, and
  Giovanni Vigna of University of California, Santa Barbara: CVE-2016-6728
* Weichao Sun ([@sunblate](https://twitter.com/sunblate)) of
  Alibaba Inc: CVE-2016-6712, CVE-2016-6699, CVE-2016-6711
* Wenke Dou (vancouverdou@gmail.com), Chiachih Wu
  ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang
  of [C0RE Team](http://c0reteam.org): CVE-2016-6720
* Wish Wu (吴潍浠) ([@wish\_wu](http://twitter.com/wish_wu)) of Trend
  Micro Inc.: CVE-2016-6704
* Yakov Shafranovich of
  [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com):
  CVE-2016-6723
* Yuan-Tsung Lo,
  Yao Jun,
  Tong Lin, Chiachih Wu ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang of
  [C0RE Team](http://c0reteam.org): CVE-2016-6730, CVE-2016-6732,
  CVE-2016-6734, CVE-2016-6736
* Yuan-Tsung Lo,
  Yao Jun,
  Xiaodong Wang, Chiachih Wu ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang of
  [C0RE Team](http://c0reteam.org): CVE-2016-6731, CVE-2016-6733,
  CVE-2016-6735, CVE-2016-6746

Additional thanks to Zach Riggle of Android Security for his contributions
to several issues in this bulletin.

## 2016-11-01 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2016-11-01 patch level. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Remote code execution vulnerability in Mediaserver

A remote code execution vulnerability in Mediaserver could enable an attacker
using a specially crafted file to cause memory corruption during media file and
data processing. This issue is rated as Critical due to the possibility of
remote code execution within the context of the Mediaserver process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6699 | [A-31373622](https://android.googlesource.com/platform/frameworks/av/%2B/3b1c9f692c4d4b7a683c2b358fc89e831a641b88) | Critical | All | 7.0 | Jul 27, 2016 |

### Elevation of privilege vulnerability in libzipfile

An elevation of privilege vulnerability in libzipfile could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as Critical due to the possibility of a
local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6700 | A-30916186 | Critical | None\* | 4.4.4, 5.0.2, 5.1.1 | Aug 17, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Skia

A remote code execution vulnerability in libskia could enable an attacker using
a specially crafted file to cause memory corruption during media file and data
processing. This issue is rated as High due to the possibility of remote code
execution within the context of the gallery process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6701 | [A-30190637](https://android.googlesource.com/platform/external/skia/%2B/aca73722873e908633ff27375f6f93a08cbb7dd3) | High | All | 7.0 | Google internal |

### Remote code execution vulnerability in libjpeg

A remote code execution vulnerability in libjpeg could enable an attacker using
a specially crafted file to execute arbitrary code in the context of an
unprivileged process. This issue is rated as High due to the possibility of
remote code execution in an application that uses libjpeg.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6702 | A-30259087 | High | None\* | 4.4.4, 5.0.2, 5.1.1 | Jul 19, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Android runtime

A remote code execution vulnerability in an Android runtime library could enable
an attacker using a specially crafted payload to execute arbitrary code in the
context of an unprivileged process. This issue is rated as High due to the
possibility of remote code execution in an application that uses the Android
runtime.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6703 | A-30765246 | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Google internal |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in Mediaserver

An elevation of privilege vulnerability in Mediaserver could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as High because it could be used to gain
local access to elevated capabilities, which are not normally accessible to a
third-party application.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6704 | [A-30229821](https://android.googlesource.com/platform/frameworks/av/%2B/c6c446f9e022adf20064e65a17574804f8af8e7d) [[2](https://android.googlesource.com/platform/hardware/qcom/audio/%2B/9cb9810ecb63c8ff55ecf4bc77431dc5b0688b5f)] [[3](https://android.googlesource.com/platform/system/media/%2B/a6274f03b4dfe1c3a22af51e3a17ea56a314e747)] | High | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 19, 2016 |
| CVE-2016-6705 | [A-30907212](https://android.googlesource.com/platform/frameworks/av/%2B/3a03fa24d21f97e84e796ac5ef14b3f434c0e8f1) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/bd04b47d38a89f1dada1c6da2ef4a3d235c166b8)] | High | All | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Aug 16, 2016 |
| CVE-2016-6706 | [A-31385713](https://android.googlesource.com/platform/frameworks/av/%2B/1d4feebdb85db46e138530f360d9ff2490e14353) | High | All | 7.0 | Sep 8, 2016 |

### Elevation of privilege vulnerability in System Server

An elevation of privilege vulnerability in System Server could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as High because it could be used to gain
local access to elevated capabilities, which are not normally accessible to a
third-party application.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6707 | [A-31350622](https://android.googlesource.com/platform/frameworks/base/%2B/16024ea7c4bae08c972cf6b3734029aad33e8870) | High | All | 6.0, 6.0.1, 7.0 | Sep 7, 2016 |

### Elevation of privilege vulnerability in System UI

An elevation of privilege in the System UI could enable a local malicious user
to bypass the security prompt of a work profile in Multi-Window mode. This
issue is rated as High because it is a local bypass of user interaction
requirements for any developer or security setting modifications.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6708 | [A-30693465](https://android.googlesource.com/platform/frameworks/base/%2B/c9c73fde339b4db496f2c1ff8c18df1e9db5a7c1) | High | All | 7.0 | Google internal |

### Information disclosure vulnerability in Conscrypt

An information disclosure vulnerability in Conscrypt could enable
an attacker to gain access to sensitive information if a
legacy encryption API is used by an application. This issue is rated as High
because it could be used to access data without permission.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6709 | [A-31081987](https://android.googlesource.com/platform/external/conscrypt/%2B/44ef9535b9afb123d150d8e0362e4bb50794dd41) | High | All | 6.0, 6.0.1, 7.0 | Oct 9, 2015 |

### Information disclosure vulnerability in download manager

An information disclosure vulnerability in the download manager could enable a
local malicious application to bypass operating system protections that isolate
application data from other applications. This issue is rated as High because it
could be used to gain access to data that the application does not have access
to.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6710 | [A-30537115](https://android.googlesource.com/platform/frameworks/base/%2B/9fab683c9598d234dd8461335c276ed3e37c91e8) [[2](https://android.googlesource.com/platform/packages/providers/DownloadProvider/%2B/243e62949f7208d3b82eda3ee4ec22d3dbc1fb19)] | High | All | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 30, 2016 |

### Denial of service vulnerability in Bluetooth

A denial of service vulnerability in Bluetooth could enable a proximate attacker
to block Bluetooth access to an affected device. This issue is rated as High due
to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2014-9908 | A-28672558 | High | None\* | 4.4.4, 5.0.2, 5.1.1 | May 5, 2014 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Denial of service vulnerability in OpenJDK

A remote denial of service vulnerability in OpenJDK could enable an attacker to
use a specially crafted file to cause a device hang or reboot. This issue is
rated as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2015-0410 | [A-30703445](https://android.googlesource.com/platform/libcore/%2B/21098574528bdf99dd50a74a60e161573e999108) | High | All | 7.0 | Jan 16, 2015 |

### Denial of service vulnerability in Mediaserver

A remote denial of service vulnerability in Mediaserver could enable an attacker
to use a specially crafted file to cause a device hang or reboot. This issue is
rated as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6711 | [A-30593765](https://android.googlesource.com/platform/external/libvpx/%2B/063be1485e0099bc81ace3a08b0ec9186dcad693) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 1, 2016 |
| CVE-2016-6712 | [A-30593752](https://android.googlesource.com/platform/external/libvpx/%2B/fdb1b40e7bb147c07bda988c9501ad223795d12d) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 1, 2016 |
| CVE-2016-6713 | [A-30822755](https://android.googlesource.com/platform/external/libavc/%2B/8cafca0e8b1ed8125918e203118c5a4e612fd56c) | High | All | 6.0, 6.0.1, 7.0 | Aug 11, 2016 |
| CVE-2016-6714 | [A-31092462](https://android.googlesource.com/platform/external/libavc/%2B/5bdb0a6b72782e505671a387bb5f83222d891d6a) | High | All | 6.0, 6.0.1, 7.0 | Aug 22, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in Framework APIs

An elevation of privilege vulnerability in the Framework APIs could allow a
local malicious application to record audio without the user's permission. This
issue is rated as Moderate because it is a local bypass of user interaction
requirements (access to functionality that would normally require either user
initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6715 | [A-29833954](https://android.googlesource.com/platform/frameworks/base/%2B/3de09838fb0996bb4b420630800ad34e828fd1b6) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jun 28, 2016 |

### Elevation of privilege vulnerability in AOSP Launcher

An elevation of privilege vulnerability in the AOSP Launcher could allow a local
malicious application to create shortcuts that have elevated privileges without
the user's consent. This issue is rated as Moderate because it is a local bypass
of user interaction requirements (access to functionality that would normally
require either user initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6716 | [A-30778130](https://android.googlesource.com/platform/packages/apps/Launcher3/%2B/e83fc11c982e67dd0181966f5f3a239ea6b14924) | Moderate | All | 7.0 | Aug 5, 2016 |

### Elevation of privilege vulnerability in Mediaserver

An elevation of privilege vulnerability in Mediaserver could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as Moderate because it first requires
exploitation of a separate vulnerability.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6717 | [A-31350239](https://android.googlesource.com/platform/frameworks/av/%2B/45d9bbabbe7920bf4e0a68074b97d8260aef2e07) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Sep 7, 2016 |

### Elevation of privilege vulnerability in Account Manager Service

An elevation of privilege vulnerability in the Account Manager Service could
enable a local malicious application to retrieve sensitive information without
user interaction. This issue is rated as Moderate because it is a local bypass
of user interaction requirements (access to functionality that would normally
require either user initiation or user permission.)

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6718 | [A-30455516](https://android.googlesource.com/platform/frameworks/base/%2B/fecfd550edeca422c0d9f32a9c0abe73398a1ff1) | Moderate | All | 7.0 | Google internal |

### Elevation of privilege vulnerability in Bluetooth

An elevation of privilege vulnerability in the Bluetooth component could enable
a local malicious application to pair with any Bluetooth device without user
consent. This issue is rated as Moderate because it is a local bypass of user
interaction requirements (access to functionality that would normally require
either user initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6719 | [A-29043989](https://android.googlesource.com/platform/packages/apps/Bluetooth/%2B/e1b6db10e913c09d0b695368336137f6aabee462) [[2](https://android.googlesource.com/platform/frameworks/base/%2B/b1dc1757071ba46ee653d68f331486e86778b8e4)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Google internal |

### Information disclosure vulnerability in Mediaserver

An information disclosure vulnerability in Mediaserver could enable a local
malicious application to access data outside of its permission levels. This
issue is rated as Moderate because it could be used to access sensitive data
without permission.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6720 | [A-29422020](https://android.googlesource.com/platform/frameworks/av/%2B/0f177948ae2640bfe4d70f8e4248e106406b3b0a) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/2c75e1c3b98e4e94f50c63e2b7694be5f948477c)] [[3](https://android.googlesource.com/platform/frameworks/av/%2B/7c88b498fda1c2b608a9dd73960a2fd4d7b7e3f7)] [[4](https://android.googlesource.com/platform/frameworks/av/%2B/640b04121d7cd2cac90e2f7c82b97fce05f074a5)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jun 15, 2016 |
| CVE-2016-6721 | [A-30875060](https://android.googlesource.com/platform/frameworks/av/%2B/f6bf0102bdc1adff973e08d8ce9c869c4e2efade) | Moderate | All | 6.0, 6.0.1, 7.0 | Aug 13, 2016 |
| CVE-2016-6722 | [A-31091777](https://android.googlesource.com/platform/frameworks/av/%2B/89c03b3b9ff74a507a8b8334c50b08b334483556) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Aug 23, 2016 |

### Denial of service vulnerability in Proxy Auto Config

A denial of service vulnerability in Proxy Auto Config could enable a remote
attacker to use a specially crafted file to cause a device hang or reboot. This
issue is rated as Moderate because it requires an uncommon device configuration.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6723 | [A-30100884](https://android.googlesource.com/platform/frameworks/base/%2B/d5b0d0b1df2e1a7943a4bb2034fd21487edd0264) [[2](https://android.googlesource.com/platform/frameworks/base/%2B/31f351160cdfd9dbe9919682ebe41bde3bcf91c6)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 11, 2016 |

### Denial of service vulnerability in Input Manager Service

A denial of service vulnerability in the Input Manager Service could enable a
local malicious application to cause the device to continually reboot. This
issue is rated as Moderate because it is a temporary denial of service that
requires a factory reset to fix.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6724 | [A-30568284](https://android.googlesource.com/platform/frameworks/base/%2B/7625010a2d22f8c3f1aeae2ef88dde37cbebd0bf) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Google internal |

## 2016-11-05 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2016-11-05 patch level. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Remote code execution vulnerability in Qualcomm crypto driver

A remote code execution vulnerability in the Qualcomm crypto driver could enable
a remote attacker to execute arbitrary code within the context of the kernel.
This issue is rated as Critical due to the possibility of remote code execution
in the context of the kernel.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6725 | A-30515053 [QC-CR#1050970](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=cc95d644ee8a043f2883d65dda20e16f95041de3) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 25, 2016 |

### Elevation of privilege vulnerability in kernel file system

An elevation of privilege vulnerability in the kernel file system could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8961 | A-30952474  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6934da9238da947628be83635e365df41064b09b) | Critical | Pixel, Pixel XL | Oct 18, 2015 |
| CVE-2016-7911 | A-30946378  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8ba8682107ee2ca3347354e018865d8e1967c5f4) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 01, 2016 |
| CVE-2016-7910 | A-30942273  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=77da160530dd1dc94f6ae15a981f24e5f0021e84) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 29, 2016 |

### Elevation of privilege vulnerability in kernel SCSI driver

An elevation of privilege vulnerability in the kernel SCSI driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8962 | A-30951599  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f3951a3709ff50990bf3e188c27d346792103432) | Critical | Pixel, Pixel XL | Oct 30, 2015 |

### Elevation of privilege vulnerability in kernel media driver

An elevation of privilege vulnerability in the kernel media driver could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7913 | A-30946097  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8dfbcc4351a0b6d2f2d77f367552f48ffefafe18) | Critical | Nexus 6P, Android One, Nexus Player, Pixel, Pixel XL | Jan 28, 2016 |

### Elevation of privilege vulnerability in kernel USB driver

An elevation of privilege vulnerability in the kernel USB driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7912 | A-30950866  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=38740a5b87d53ceb89eb2c970150f6e94e00373a) | Critical | Pixel C, Pixel, Pixel XL | Apr 14, 2016 |

### Elevation of privilege vulnerability in kernel ION subsystem

An elevation of privilege vulnerability in the kernel ION subsystem could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6728 | A-30400942\* | Critical | Nexus 5, Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Nexus Player, Pixel C, Android One | Jul 25, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in Qualcomm bootloader

An elevation of privilege vulnerability in the Qualcomm bootloader could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6729 | A-30977990\*  QC-CR#977684 | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 25, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in NVIDIA GPU driver

An elevation of privilege vulnerability in the NVIDIA GPU driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6730 | A-30904789\* N-CVE-2016-6730 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6731 | A-30906023\* N-CVE-2016-6731 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6732 | A-30906599\* N-CVE-2016-6732 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6733 | A-30906694\* N-CVE-2016-6733 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6734 | A-30907120\* N-CVE-2016-6734 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6735 | A-30907701\* N-CVE-2016-6735 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6736 | A-30953284\* N-CVE-2016-6736 | Critical | Pixel C | Aug 18, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in kernel networking subsystem

An elevation of privilege vulnerability in the kernel networking subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6828 | A-31183296  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/include/net/tcp.h?id=bb1fceca22492109be12640d49f5ea5a544c6bb4) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Aug 18, 2016 |

### Elevation of privilege vulnerability in kernel sound subsystem

An elevation of privilege vulnerability in the kernel sound subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-2184 | A-30952477  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=836b34a935abc91e13e63053d0a83b24dfb5ea78) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Mar 31, 2016 |

### Elevation of privilege vulnerability in kernel ION subsystem

An elevation of privilege vulnerability in the kernel ION subsystem could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6737 | A-30928456\* | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Vulnerabilities in Qualcomm components

The table below contains security vulnerabilities affecting Qualcomm components
and are described in further detail in Qualcomm AMSS June 2016 security
bulletin and Security Alert 80-NV606-17.

| CVE | References | Severity\* | Updated Google devices | Date reported |
| CVE-2016-6727 | A-31092400\*\* | Critical | Android One | Qualcomm internal |
| CVE-2016-6726 | A-30775830\*\* | High | Nexus 6, Android One | Qualcomm internal |

\* The severity rating for these vulnerabilities was determined by the vendor.

\*\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Remote code execution vulnerability in Expat

The table below contains security vulnerabilities affecting the Expat library.
The most severe of these issues is an elevation of privilege vulnerability in
the Expat XML parser, which could enable an attacker using a specially crafted
file to execute arbitrary code in an unprivileged process. This issue is rated
as High due to the possibility of arbitrary code execution in an application
that uses Expat.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-0718 | [A-28698301](https://android.googlesource.com/platform/external/expat/%2B/52ac633b73856ded34b33bd4adb4ab793bbbe963) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | May 10, 2016 |
| CVE-2012-6702 | [A-29149404](https://android.googlesource.com/platform/external/expat/%2B/a11ff32280a863bff93df13ad643912ad9bf1302) | Moderate | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Mar 06, 2016 |
| CVE-2016-5300 | [A-29149404](https://android.googlesource.com/platform/external/expat/%2B/a11ff32280a863bff93df13ad643912ad9bf1302) | Moderate | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Jun 04, 2016 |
| CVE-2015-1283 | [A-27818751](https://android.googlesource.com/platform/external/expat/%2B/13b40c2040a17038b63a61e2b112c634da203d3b) | Low | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Jul 24, 2015 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Webview

A remote code execution vulnerability in Webview could enable a remote attacker
to execute arbitrary code when the user is navigating to a website. This issue
is rated as High due to the possibility of remote code execution in an
unprivileged process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6754 | A-31217937 | High | None\* | 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 23, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Freetype

A remote code execution vulnerability in Freetype could enable a local malicious
application to load a specially crafted font to cause memory corruption in an
unprivileged process. This issue is rated as High due to the possibility of
remote code execution in applications that use Freetype.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2014-9675 | [A-24296662](https://android.googlesource.com/platform/external/freetype/%2B/f720f0dbcf012d6c984dbbefa0875ef9840458c6) [[2](https://android.googlesource.com/platform/external/pdfium/%2B/96f965ff7411f1edba72140fd70740e63cabec71)] | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Google internal |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in kernel performance subsystem

An elevation of privilege vulnerability in the kernel performance subsystem
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8963 | A-30952077  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=12ca6ad2e3a896256f086497a7c7406a547ee373) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Dec 15, 2015 |

### Elevation of privilege vulnerability in kernel system-call auditing subsystem

An elevation of privilege vulnerability in the kernel system-call auditing
subsystem could enable a local malicious application to disrupt system-call
auditing in the kernel. This issue is rated as High because it is a general
bypass for a kernel-level defense in depth or exploit mitigation technology.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6136 | A-30956807  [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=43761473c254b45883a64441dd0bc85a42f3645c) | High | Android One, Pixel C, Nexus Player | Jul 1, 2016 |

### Elevation of privilege vulnerability in Qualcomm crypto engine driver

An elevation of privilege vulnerability in the Qualcomm crypto engine driver
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6738 | A-30034511  [QC-CR#1050538](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=a829c54236b455885c3e9c7c77ac528b62045e79) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 7, 2016 |

### Elevation of privilege vulnerability in Qualcomm camera driver

An elevation of privilege vulnerability in the Qualcomm camera driver could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6739 | A-30074605\* QC-CR#1049826 | High | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 11, 2016 |
| CVE-2016-6740 | A-30143904  [QC-CR#1056307](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=ef78bd62f0c064ae4c827e158d828b2c110ebcdc) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6741 | A-30559423  [QC-CR#1060554](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?id=d291eebd8e43bba3229ae7ef9146a132894dc293) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 28, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in Qualcomm bus driver

An elevation of privilege vulnerability in the Qualcomm bus driver could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as High because it first requires compromising a
privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-3904 | A-30311977  [QC-CR#1050455](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=069683407ca9a820d05c914b57c587bcd3f16a3a) | High | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 22, 2016 |

### Elevation of privilege vulnerability in Synaptics touchscreen driver

An elevation of privilege vulnerability in the Synaptics touchscreen driver
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6742 | A-30799828\* | High | Nexus 5X, Android One | Aug 9, 2016 |
| CVE-2016-6744 | A-30970485\* | High | Nexus 5X | Aug 19, 2016 |
| CVE-2016-6745 | A-31252388\* | High | Nexus 5X, Nexus 6P, Nexus 9, Android One, Pixel, Pixel XL | Sep 1, 2016 |
| CVE-2016-6743 | A-30937462\* | High | Nexus 9, Android One | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in kernel components

An information disclosure vulnerability in kernel components, including the
human interface device driver, file system, and Teletype driver, could enable a
local malicious application to access data outside of its permission levels.
This issue is rated as High because it could be used to access sensitive data
without explicit user permission.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8964 | A-30951112  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=dd42bf1197144ede075a9d4793123f7689e164bc) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Nov 27, 2015 |
| CVE-2016-7915 | A-30951261  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=50220dead1650609206efe91f0cc116132d59b3f) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jan 19, 2016 |
| CVE-2016-7914 | A-30513364  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2) | High | Pixel C, Pixel, Pixel XL | Apr 06, 2016 |
| CVE-2016-7916 | A-30951939  [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8148a73c9901a8794a50f950083c00ccf97d43b3) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | May 05, 2016 |

### Information disclosure vulnerability in NVIDIA GPU driver

An information disclosure vulnerability in the NVIDIA GPU driver could enable a
local malicious application to access data outside of its permission levels.
This issue is rated as High because it could be used to access sensitive data
without explicit user permission.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6746 | A-30955105\* N-CVE-2016-6746 | High | Pixel C | Aug 18, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Denial of service vulnerability in Mediaserver

A denial of service vulnerability in Mediaserver could enable an attacker to use
a specially crafted file to cause a device hang or reboot. This issue is rated
as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6747 | A-31244612\* N-CVE-2016-6747 | High | Nexus 9 | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in kernel components

An information disclosure vulnerability in kernel components, including the
process-grouping subsystem and the networking subsystem, could enable a local
malicious application to access data outside of its permission levels. This
issue is rated as Moderate because it first requires compromising a privileged
process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7917 | A-30947055  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=c58d6c93680f28ac58984af61d0a7ebf4319c241) | Moderate | Pixel C, Pixel, Pixel XL | Feb 02, 2016 |
| CVE-2016-6753 | A-30149174\* | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 13, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in Qualcomm components

An information disclosure vulnerability in Qualcomm components including the GPU
driver, power driver, SMSM Point-to-Point driver, and sound driver, could enable
a local malicious application to access data outside of its permission levels.
This issue is rated as Moderate because it first requires compromising a
privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6748 | A-30076504  [QC-CR#987018](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=be651d020b122a1ba9410d23ca4ebbe9f5598df6) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6749 | A-30228438  [QC-CR#1052818](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=f9185dc83b92e7d1ee341e32e8cf5ed00a7253a7) | Moderate | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6750 | A-30312054  [QC-CR#1052825](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=34bda711a1c7bc7f9fd7bea3a5be439ed00577e5) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 21, 2016 |
| CVE-2016-3906 | A-30445973  [QC-CR#1054344](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=b333d32745fec4fb1098ee1a03d4425f3c1b4c2e) | Moderate | Nexus 5X, Nexus 6P | Jul 27, 2016 |
| CVE-2016-3907 | A-30593266  [QC-CR#1054352](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=744330f4e5d70dce71c4c9e03c5b6a8b59bb0cda) | Moderate | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Aug 2, 2016 |
| CVE-2016-6698 | A-30741851  [QC-CR#1058826](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=de90beb76ad0b80da821c3b857dd30cd36319e61) | Moderate | Nexus 5X, Nexus 6P, Android One, Pixel, Pixel XL | Aug 2, 2016 |
| CVE-2016-6751 | A-30902162\* QC-CR#1062271 | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Aug 15, 2016 |
| CVE-2016-6752 | A-31498159  [QC-CR#987051](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?h=0de2c7600c8f1f0152a2f421c6593f931186400a) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

## 2016-11-06 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities listed in the
[2016-11-06 security patch level—Vulnerability
summary](#2016-11-06-summary) above. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Elevation of privilege vulnerability in kernel memory subsystem

An elevation of privilege vulnerability in the kernel memory subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

**Note:** A security patch level of 2016-11-06 indicates that this
issue, as well as all issues associated with 2016-11-01 and 2016-11-05 are
addressed.

| CVE | References | Severity | Updated kernel versions | Date reported |
| --- | --- | --- | --- | --- |
| CVE-2016-5195 | A-32141528 [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=9691eac5593ff1e2f82391ad327f21d90322aec1) [[2](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=e45a502bdeae5a075257c4f061d1ff4ff0821354)] | Critical | 3.10, 3.18 | Oct 12, 2016 |

## Common Questions and Answers

This section answers common questions that may occur after reading this
bulletin.

**1. How do I determine if my device is updated to address these issues?**

To learn how to check a device’s security patch level, read the instructions on the
[Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices).

* Security patch levels of 2016-11-01 or later address all issues associated
  with the 2016-11-01 security patch level.
* Security patch levels of 2016-11-05 or later address all issues associated
  with the 2016-11-05 security patch level and all previous patch levels.
* Security patch levels of 2016-11-06 or later address all issues associated
  with the 2016-11-06 security patch level and all previous patch
  levels.

Device manufacturers that include these updates should set the patch level
string to:

* [ro.build.version.security\_patch]:[2016-11-01]
* [ro.build.version.security\_patch]:[2016-11-05]
* [ro.build.version.security\_patch]:[2016-11-06].

**2. Why does this bulletin have three security patch levels?**

This bulletin has three security patch levels so that Android partners have the
flexibility to fix a subset of vulnerabilities that are similar across all
Android devices more quickly. Android partners are encouraged to fix all issues
in this bulletin and use the latest security patch level.

* Devices that use the November 1, 2016 security patch level must include all
  issues associated with that security patch level, as well as fixes for all
  issues reported in previous security bulletins.
* Devices that use the security patch level of November 5, 2016 or newer must
  include all applicable patches in this (and previous) security bulletins.
* Devices that use the security patch level of November 6, 2016 or newer must
  include all applicable patches in this (and previous) security
  bulletins.

Partners are encouraged to bundle the fixes for all issues they are addressing
in a single update.

**3. How do I determine which Google devices are affected by each
issue?**

In the
[2016-11-01](#2016-11-01-details),
[2016-11-05](#2016-11-05-details),
and
[2016-11-06](#2016-11-06-details)
security vulnerability details sections, each table has an *Updated Google
devices* column that covers the range of affected Google devices updated for
each issue. This column has a few options:

* **All Google devices**: If an issue affects all Nexus and Pixel
  devices, the table will have "All" in the *Updated Google devices*
  column. "All" encapsulates the following
  [supported
  devices](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices): Nexus 5, Nexus 5X, Nexus 6, Nexus 6P, Nexus 9,
  Android One, Nexus Player, Pixel C, Pixel, and Pixel XL.
* **Some Google devices**: If an issue doesn't affect all Google
  devices, the affected Google devices are listed in the *Updated Google
  devices* column.
* **No Google devices**: If no Google devices running Android 7.0
  are affected by the issue, the table will have "None" in the *Updated Google
  devices* column.

**4. What do the entries in the references column map to?**

Entries under the *References* column of the vulnerability details table
may contain a prefix identifying the organization to which the reference value
belongs. These prefixes map as follows:

| Prefix | Reference |
| --- | --- |
| A- | Android bug ID |
| QC- | Qualcomm reference number |
| M- | MediaTek reference number |
| N- | NVIDIA reference number |
| B- | Broadcom reference number |

## Revisions

* November 07, 2016: Bulletin published.
* November 08: Bulletin revised to include AOSP links and updated
  description for CVE-2016-6709.
* November 17: Bulletin revised to include attribution for CVE-2016-6828.
* December 21: Updated researcher credit.

Content and code samples on this page are subject to the licenses described in the [Content License](/license). Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.

Last updated 2024-08-26 UTC.

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-08-26 UTC."],[],[]]

* ### Build

  + [Android repository](//android.googlesource.com)
  + [Requirements](/source/requirements)
  + [Downloading](/source/downloading)
  + [Preview binaries](//developers.google.com/android/blobs-preview/)
  + [Factory images](//developers.google.com/android/images/)
  + [Driver binaries](//developers.google.com/android/drivers/)
* ### Connect

  + [@Android on Twitter](//twitter.com/Android/)
  + [@AndroidDev on Twitter](//twitter.com/AndroidDev/)
  + [Android Blog](//blog.google/products/android/)
  + [Google Security Blog](//security.googleblog.com)
  + [Platform on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-platform/)
  + [Building on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-building/)
  + [Porting on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-porting/)
* ### Get help

  + [Android Help Center](//support.google.com/android/)
  + [Pixel Help Center](//support.google.com/pixelphone/)
  + [www.android.com](//www.android.com)
  + [Google Mobile Services](//www.android.com/gms/)
  + [Stack Overflow](//stackoverflow.com/questions/tagged/android-source/)
  + [Issue Tracker](//issuetracker.google.com/issues?q=status:open%20componentid:190923)

* [About Android](/source/)
* [Community](/source/community)
* [Legal](/legal)
* [License](/license)
* [Privacy](//policies.google.com/privacy)
* [Site feedback](//issuetracker.google.com/issues/new?component=191476)
* Manage cookies

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어



=== Content from git.kernel.org_0551cebd_20250126_034859.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.13.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jerome Marchand <jmarchan@redhat.com> | 2016-04-06 14:06:48 +0100 |
| --- | --- | --- |
| committer | David Howells <dhowells@redhat.com> | 2016-04-06 14:06:48 +0100 |
| commit | [8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)) | |
| tree | [85292995079da8eb57c5c331630dcea9e679d104](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2) | |
| parent | [541d8f4d59d79f5d37c8c726f723d42ff307db57](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=541d8f4d59d79f5d37c8c726f723d42ff307db57) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2&id2=541d8f4d59d79f5d37c8c726f723d42ff307db57)) | |
| download | [linux-8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2.tar.gz) | |

assoc\_array: don't call compare\_object() on a nodeChanges since V1: fixed the description and added KASan warning.
In assoc\_array\_insert\_into\_terminal\_node(), we call the
compare\_object() method on all non-empty slots, even when they're
not leaves, passing a pointer to an unexpected structure to
compare\_object(). Currently it causes an out-of-bound read access
in keyring\_compare\_object detected by KASan (see below). The issue
is easily reproduced with keyutils testsuite.
Only call compare\_object() when the slot is a leave.
KASan warning:
==================================================================
BUG: KASAN: slab-out-of-bounds in keyring\_compare\_object+0x213/0x240 at addr ffff880060a6f838
Read of size 8 by task keyctl/1655
=============================================================================
BUG kmalloc-192 (Not tainted): kasan: bad access detected
-----------------------------------------------------------------------------
Disabling lock debugging due to kernel taint
INFO: Allocated in assoc\_array\_insert+0xfd0/0x3a60 age=69 cpu=1 pid=1647
\_\_\_slab\_alloc+0x563/0x5c0
\_\_slab\_alloc+0x51/0x90
kmem\_cache\_alloc\_trace+0x263/0x300
assoc\_array\_insert+0xfd0/0x3a60
\_\_key\_link\_begin+0xfc/0x270
key\_create\_or\_update+0x459/0xaf0
SyS\_add\_key+0x1ba/0x350
entry\_SYSCALL\_64\_fastpath+0x12/0x76
INFO: Slab 0xffffea0001829b80 objects=16 used=8 fp=0xffff880060a6f550 flags=0x3fff8000004080
INFO: Object 0xffff880060a6f740 @offset=5952 fp=0xffff880060a6e5d1
Bytes b4 ffff880060a6f730: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f740: d1 e5 a6 60 00 88 ff ff 0e 00 00 00 00 00 00 00 ...`............
Object ffff880060a6f750: 02 cf 8e 60 00 88 ff ff 02 c0 8e 60 00 88 ff ff ...`.......`....
Object ffff880060a6f760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f770: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f780: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f790: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7d0: 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
Object ffff880060a6f7f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
CPU: 0 PID: 1655 Comm: keyctl Tainted: G B 4.5.0-rc4-kasan+ #291
Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011
0000000000000000 000000001b2800b4 ffff880060a179e0 ffffffff81b60491
ffff88006c802900 ffff880060a6f740 ffff880060a17a10 ffffffff815e2969
ffff88006c802900 ffffea0001829b80 ffff880060a6f740 ffff880060a6e650
Call Trace:
[<ffffffff81b60491>] dump\_stack+0x85/0xc4
[<ffffffff815e2969>] print\_trailer+0xf9/0x150
[<ffffffff815e9454>] object\_err+0x34/0x40
[<ffffffff815ebe50>] kasan\_report\_error+0x230/0x550
[<ffffffff819949be>] ? keyring\_get\_key\_chunk+0x13e/0x210
[<ffffffff815ec62d>] \_\_asan\_report\_load\_n\_noabort+0x5d/0x70
[<ffffffff81994cc3>] ? keyring\_compare\_object+0x213/0x240
[<ffffffff81994cc3>] keyring\_compare\_object+0x213/0x240
[<ffffffff81bc238c>] assoc\_array\_insert+0x86c/0x3a60
[<ffffffff81bc1b20>] ? assoc\_array\_cancel\_edit+0x70/0x70
[<ffffffff8199797d>] ? \_\_key\_link\_begin+0x20d/0x270
[<ffffffff8199786c>] \_\_key\_link\_begin+0xfc/0x270
[<ffffffff81993389>] key\_create\_or\_update+0x459/0xaf0
[<ffffffff8128ce0d>] ? trace\_hardirqs\_on+0xd/0x10
[<ffffffff81992f30>] ? key\_type\_lookup+0xc0/0xc0
[<ffffffff8199e19d>] ? lookup\_user\_key+0x13d/0xcd0
[<ffffffff81534763>] ? memdup\_user+0x53/0x80
[<ffffffff819983ea>] SyS\_add\_key+0x1ba/0x350
[<ffffffff81998230>] ? key\_get\_type\_from\_user.constprop.6+0xa0/0xa0
[<ffffffff828bcf4e>] ? retint\_user+0x18/0x23
[<ffffffff8128cc7e>] ? trace\_hardirqs\_on\_caller+0x3fe/0x580
[<ffffffff81004017>] ? trace\_hardirqs\_on\_thunk+0x17/0x19
[<ffffffff828bc432>] entry\_SYSCALL\_64\_fastpath+0x12/0x76
Memory state around the buggy address:
ffff880060a6f700: fc fc fc fc fc fc fc fc 00 00 00 00 00 00 00 00
ffff880060a6f780: 00 00 00 00 00 00 00 00 00 00 00 fc fc fc fc fc
>ffff880060a6f800: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
^
ffff880060a6f880: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
ffff880060a6f900: fc fc fc fc fc fc 00 00 00 00 00 00 00 00 00 00
==================================================================
Signed-off-by: Jerome Marchand <jmarchan@redhat.com>
Signed-off-by: David Howells <dhowells@redhat.com>
cc: stable@vger.kernel.org
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)

| -rw-r--r-- | [lib/assoc\_array.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/lib/assoc_array.c?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/lib/assoc\_array.c b/lib/assoc\_array.cindex 03dd576e67730f..59fd7c0b119cbc 100644--- a/[lib/assoc\_array.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/lib/assoc_array.c?id=541d8f4d59d79f5d37c8c726f723d42ff307db57)+++ b/[lib/assoc\_array.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/lib/assoc_array.c?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2)@@ -524,7 +524,9 @@ static bool assoc\_array\_insert\_into\_terminal\_node(struct assoc\_array\_edit \*edit, free\_slot = i; continue; }- if (ops->compare\_object(assoc\_array\_ptr\_to\_leaf(ptr), index\_key)) {+ if (assoc\_array\_ptr\_is\_leaf(ptr) &&+ ops->compare\_object(assoc\_array\_ptr\_to\_leaf(ptr),+ index\_key)) { pr\_devel("replace in slot %d\n", i); edit->leaf\_p = &node->slots[i]; edit->dead\_leaf = node->slots[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-26 03:47:36 +0000



=== Content from www.kernel.org_0f993aa6_20250124_220208.html ===
commit a29ab351c8753bba3fd2dab8bb99454393c44dfb
Author: Greg Kroah-Hartman
Date: Wed May 11 11:22:08 2016 +0200
Linux 4.5.4
commit 0d5406b61afb06ca7c9b76c924ddc044127bb791
Author: Srinivas Pandruvada
Date: Wed Mar 23 21:07:39 2016 -0700
ACPI / processor: Request native thermal interrupt handling via \_OSC
commit a21211672c9a1d730a39aa65d4a5b3414700adfb upstream.
There are several reports of freeze on enabling HWP (Hardware PStates)
feature on Skylake-based systems by the Intel P-states driver. The root
cause is identified as the HWP interrupts causing BIOS code to freeze.
HWP interrupts use the thermal LVT which can be handled by Linux
natively, but on the affected Skylake-based systems SMM will respond
to it by default. This is a problem for several reasons:
- On the affected systems the SMM thermal LVT handler is broken (it
will crash when invoked) and a BIOS update is necessary to fix it.
- With thermal interrupt handled in SMM we lose all of the reporting
features of the arch/x86/kernel/cpu/mcheck/therm\_throt driver.
- Some thermal drivers like x86-package-temp depend on the thermal
threshold interrupts signaled via the thermal LVT.
- The HWP interrupts are useful for debugging and tuning
performance (if the kernel can handle them).
The native handling of thermal interrupts needs to be enabled
because of that.
This requires some way to tell SMM that the OS can handle thermal
interrupts. That can be done by using \_OSC/\_PDC in processor
scope very early during ACPI initialization.
The meaning of \_OSC/\_PDC bit 12 in processor scope is whether or
not the OS supports native handling of interrupts for Collaborative
Processor Performance Control (CPPC) notifications. Since on
HWP-capable systems CPPC is a firmware interface to HWP, setting
this bit effectively tells the firmware that the OS will handle
thermal interrupts natively going forward.
For details on \_OSC/\_PDC refer to:
http://www.intel.com/content/www/us/en/standards/processor-vendor-specific-acpi-specification.html
To implement the \_OSC/\_PDC handshake as described, introduce a new
function, acpi\_early\_processor\_osc(), that walks the ACPI
namespace looking for ACPI processor objects and invokes \_OSC for
them with bit 12 in the capabilities buffer set and terminates the
namespace walk on the first success.
Also modify intel\_thermal\_interrupt() to clear HWP status bits in
the HWP\_STATUS MSR to acknowledge HWP interrupts (which prevents
them from firing continuously).
Signed-off-by: Srinivas Pandruvada
[ rjw: Subject & changelog, function rename ]
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 833a955842a53a88f6d6c6bd58c39c4d551442ed
Author: Shashank Sharma
Date: Thu Apr 21 16:48:32 2016 +0530
drm/i915: Fake HDMI live status
commit 60b3143c7cac7e8d2ca65c0b347466c5776395d1 upstream.
This patch does the following:
- Fakes live status of HDMI as connected (even if that's not).
While testing certain (monitor + cable) combinations with
various intel platforms, it seems that live status register
doesn't work reliably on some older devices. So limit the
live\_status check for HDMI detection, only for platforms
from gen7 onwards.
V2: restrict faking live\_status to certain platforms
V3: (Ville)
- keep the debug message for !live\_status case
- fix indentation of comment
- remove "warning" from the debug message
(Jani)
- Change format of fix details in the commit message
Fixes: 237ed86c693d ("drm/i915: Check live status before reading edid")
Suggested-by: Ville Syrjala
Signed-off-by: Shashank Sharma
Link: http://patchwork.freedesktop.org/patch/msgid/1461237606-16491-1-git-send-email-shashank.sharma@intel.com
Signed-off-by: Ville Syrjälä
(cherry picked from commit 4f4a8185011773f7520d9916c6857db946e7f9d1)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 92e753482815696eb690e8e76dd282c43ea66f14
Author: Ville Syrjälä
Date: Wed Apr 20 16:43:56 2016 +0300
drm/i915: Make RPS EI/thresholds multiple of 25 on SNB-BDW
commit 4ea3959018d09edfa36a9e7b5ccdbd4ec4b99e49 upstream.
Somehow my SNB GT1 (Dell XPS 8300) gets very unhappy around
GPU hangs if the RPS EI/thresholds aren't suitably aligned.
It seems like scheduling/timer interupts stop working somehow
and things get stuck eg. in usleep\_range().
I bisected the problem down to
commit 8a5864377b12 ("drm/i915/skl: Restructured the gen6\_set\_rps\_thresholds function")
I observed that before all the values were at least multiples of 25,
but afterwards they are not. And rounding things up to the next multiple
of 25 does seem to help, so lets' do that. I also tried roundup(..., 5)
but that wasn't sufficient. Also I have no idea if we might need this sort of
thing on gen9+ as well.
These are the original EI/thresholds:
LOW\_POWER
GEN6\_RP\_UP\_EI 12500
GEN6\_RP\_UP\_THRESHOLD 11800
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 21250
BETWEEN
GEN6\_RP\_UP\_EI 10250
GEN6\_RP\_UP\_THRESHOLD 9225
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 18750
HIGH\_POWER
GEN6\_RP\_UP\_EI 8000
GEN6\_RP\_UP\_THRESHOLD 6800
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 15000
These are after 8a5864377b12:
LOW\_POWER
GEN6\_RP\_UP\_EI 12500
GEN6\_RP\_UP\_THRESHOLD 11875
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 21250
BETWEEN
GEN6\_RP\_UP\_EI 10156
GEN6\_RP\_UP\_THRESHOLD 9140
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 18750
HIGH\_POWER
GEN6\_RP\_UP\_EI 7812
GEN6\_RP\_UP\_THRESHOLD 6640
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 15000
And these are what we have after this patch:
LOW\_POWER
GEN6\_RP\_UP\_EI 12500
GEN6\_RP\_UP\_THRESHOLD 11875
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 21250
BETWEEN
GEN6\_RP\_UP\_EI 10175
GEN6\_RP\_UP\_THRESHOLD 9150
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 18750
HIGH\_POWER
GEN6\_RP\_UP\_EI 7825
GEN6\_RP\_UP\_THRESHOLD 6650
GEN6\_RP\_DOWN\_EI 25000
GEN6\_RP\_DOWN\_THRESHOLD 15000
Cc: Akash Goel
Cc: Chris Wilson
Testcase: igt/kms\_pipe\_crc\_basic/hang-read-crc-pipe-B
Fixes: 8a5864377b12 ("drm/i915/skl: Restructured the gen6\_set\_rps\_thresholds function")
Signed-off-by: Ville Syrjälä
Link: http://patchwork.freedesktop.org/patch/msgid/1461159836-9108-1-git-send-email-ville.syrjala@linux.intel.com
Acked-by: Chris Wilson
Reviewed-by: Patrik Jakobsson
(cherry picked from commit 8a292d016d1cc4938ff14b4df25328230b08a408)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit e0a0f419514404fb68cc911babfbc0a003ec260d
Author: Mika Kahola
Date: Wed Apr 20 15:39:02 2016 +0300
drm/i915: Fix eDP low vswing for Broadwell
commit 992e7a41f9fcc7bcd10e7d346aee5ed7a2c241cb upstream.
It was noticed on bug #94087 that module parameter
i915.edp\_vswing=2 that should override the VBT setting
to use default voltage swing (400 mV) was not applied
for Broadwell.
This patch provides a fix for this by checking if default
i.e. higher voltage swing is requested to be used and
applies the DDI translations table for DP instead of eDP
(low vswing) table.
v2: Combine two if statements into one (Jani)
v3: Change dev\_priv->edp\_low\_vswing to use dev\_priv->vbt.edp.low\_vswing
Bugzilla: https://bugs.freedesktop.org/show\_bug.cgi?id=94087
Signed-off-by: Mika Kahola
Link: http://patchwork.freedesktop.org/patch/msgid/1461155942-7749-1-git-send-email-mika.kahola@intel.com
Signed-off-by: Ville Syrjälä
(cherry picked from commit 00983519214b61c1b9371ec2ed55a4dde773e384)
[Jani: s/dev\_priv->vbt.edp.low\_vswing/dev\_priv->edp\_low\_vswing/ to backport]
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 54e03b7a92e3427971b203629051d1e456b47f9a
Author: Imre Deak
Date: Mon Apr 18 14:45:54 2016 +0300
drm/i915: Fix system resume if PCI device remained enabled
commit dab9a2663f4e688106c041f7cd2797a721382f0a upstream.
During system resume we depended on pci\_enable\_device() also putting the
device into PCI D0 state. This won't work if the PCI device was already
enabled but still in D3 state. This is because pci\_enable\_device() is
refcounted and will not change the HW state if called with a non-zero
refcount. Leaving the device in D3 will make all subsequent device
accesses fail.
This didn't cause a problem most of the time, since we resumed with an
enable refcount of 0. But it fails at least after module reload because
after that we also happen to leak a PCI device enable reference: During
probing we call drm\_get\_pci\_dev() which will enable the PCI device, but
during device removal drm\_put\_dev() won't disable it. This is a bug of
its own in DRM core, but without much harm as it only leaves the PCI
device enabled. Fixing it is also a bit more involved, due to DRM
mid-layering and because it affects non-i915 drivers too. The fix in
this patch is valid regardless of the problem in DRM core.
v2:
- Add a code comment about the relation of this fix to the freeze/thaw
vs. the suspend/resume phases. (Ville)
- Add a code comment about the inconsistent ordering of set power state
and device enable calls. (Chris)
CC: Ville Syrjälä
CC: Chris Wilson
Signed-off-by: Imre Deak
Reviewed-by: Ville Syrjälä
Link: http://patchwork.freedesktop.org/patch/msgid/1460979954-14503-1-git-send-email-imre.deak@intel.com
(cherry picked from commit 44410cd0bfb26bde9288da34c190cc9267d42a20)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 1a484857ca5e61b3d5c9975ab22c868daa7a8ff0
Author: Imre Deak
Date: Mon Apr 18 10:04:21 2016 +0300
drm/i915/ddi: Fix eDP VDD handling during booting and suspend/resume
commit 5eaa60c7109b40f17ac81090bc8b90482da76cd1 upstream.
The driver's VDD on/off logic assumes that whenever the VDD is on we
also hold an AUX power domain reference. Since BIOS can leave the VDD on
during booting and resuming and on DDI platforms we won't take a
corresponding power reference, the above assumption won't hold on those
platforms and an eventual delayed VDD off work will do an extraneous AUX
power domain put resulting in a refcount underflow. Fix this the same
way we did this for non-DDI DP encoders:
commit 6d93c0c41760c0 ("drm/i915: fix VDD state tracking after system
resume")
At the same time call the DP encoder suspend handler the same way as the
non-DDI DP encoders do to flush any pending VDD off work. Leaving the
work running may cause a HW access where we don't expect this (at a point
where power domains are suspended already).
While at it remove an unnecessary function call indirection.
This fixed for me AUX refcount underflow problems on BXT during
suspend/resume.
CC: Ville Syrjälä
Signed-off-by: Imre Deak
Reviewed-by: Ville Syrjälä
Link: http://patchwork.freedesktop.org/patch/msgid/1460963062-13211-4-git-send-email-imre.deak@intel.com
(cherry picked from commit bf93ba67e9c05882f05b7ca2d773cfc8bf462c2a)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit b04de71b86e9a4ad75ae9222c4a9f5fad49d1d60
Author: Chris Wilson
Date: Sun Apr 17 20:42:46 2016 +0100
drm/i915: Avoid stalling on pending flips for legacy cursor updates
commit 7ac7d19f808697abe6658c64c96868f728273f9c upstream.
The legacy cursor ioctl expects to be asynchronous with respect to other
screen updates, in particular page flips. As X updates the cursor from a
signal context, if the cursor blocks then it will stall both the input
and output chains causing bad stuttering and horrible UX.
Reported-and-tested-by: Rafael Ristovski
Bugzilla: https://bugs.freedesktop.org/show\_bug.cgi?id=94980
Fixes: 5008e874edd34 ("drm/i915: Make wait\_for\_flips interruptible.")
Suggested-by: Maarten Lankhorst
Signed-off-by: Chris Wilson
Cc: Maarten Lankhorst
Cc: Ville Syrjälä
Cc: Daniel Vetter
Cc: Jani Nikula
Link: http://patchwork.freedesktop.org/patch/msgid/1460922166-20292-1-git-send-email-chris@chris-wilson.co.uk
Acked-by: Daniel Vetter
Reviewed-by: Maarten Lankhorst
(cherry picked from commit acf4e84d6167317ff21be5c03e1ea76ea5783701)
Signed-off-by: Jani Nikula
Signed-off-by: Greg Kroah-Hartman
commit 45225b7e84ee53ffdaeb84970640e9e174bcce0b
Author: Alex Deucher
Date: Mon May 2 18:53:27 2016 -0400
drm/radeon: make sure vertical front porch is at least 1
commit 3104b8128d4d646a574ed9d5b17c7d10752cd70b upstream.
hw doesn't like a 0 value.
Signed-off-by: Alex Deucher
Signed-off-by: Greg Kroah-Hartman
commit 47b0084c2eedd73c85f378f8bd11c6eb65b8999f
Author: Richard Leitner
Date: Tue Apr 5 15:03:48 2016 +0200
iio: ak8975: fix maybe-uninitialized warning
commit 05be8d4101d960bad271d32b4f6096af1ccb1534 upstream.
If i2c\_device\_id \*id is NULL and acpi\_match\_device returns NULL too,
then chipset may be unitialized when accessing &ak\_def\_array[chipset] in
ak8975\_probe. Therefore initialize chipset to AK\_MAX\_TYPE, which will
return an error when not changed.
This patch fixes the following maybe-uninitialized warning:
drivers/iio/magnetometer/ak8975.c: In function ‘ak8975\_probe’:
drivers/iio/magnetometer/ak8975.c:788:14: warning: ‘chipset’ may be used
uninitialized in this function [-Wmaybe-uninitialized]
data->def = &ak\_def\_array[chipset];
Signed-off-by: Richard Leitner
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit 3d1e08a31bde2cf5a32dcfe32996d4c753d43ff4
Author: Krzysztof Kozlowski
Date: Mon Apr 4 14:54:59 2016 +0900
iio: ak8975: Fix NULL pointer exception on early interrupt
commit 07d2390e36ee5b3265e9cc8305f2a106c8721e16 upstream.
In certain probe conditions the interrupt came right after registering
the handler causing a NULL pointer exception because of uninitialized
waitqueue:
$ udevadm trigger
i2c-gpio i2c-gpio-1: using pins 143 (SDA) and 144 (SCL)
i2c-gpio i2c-gpio-3: using pins 53 (SDA) and 52 (SCL)
Unable to handle kernel NULL pointer dereference at virtual address 00000000
pgd = e8b38000
[00000000] \*pgd=00000000
Internal error: Oops: 5 [#1] SMP ARM
Modules linked in: snd\_soc\_i2s(+) i2c\_gpio(+) snd\_soc\_idma snd\_soc\_s3c\_dma snd\_soc\_core snd\_pcm\_dmaengine snd\_pcm snd\_timer snd soundcore ac97\_bus spi\_s3c64xx pwm\_samsung dwc2 exynos\_adc phy\_exynos\_usb2 exynosdrm exynos\_rng rng\_core rtc\_s3c
CPU: 0 PID: 717 Comm: data-provider-m Not tainted 4.6.0-rc1-next-20160401-00011-g1b8d87473b9e-dirty #101
Hardware name: SAMSUNG EXYNOS (Flattened Device Tree)
(...)
(\_\_wake\_up\_common) from [] (\_\_wake\_up+0x38/0x4c)
(\_\_wake\_up) from [] (ak8975\_irq\_handler+0x28/0x30)
(ak8975\_irq\_handler) from [] (handle\_irq\_event\_percpu+0x88/0x140)
(handle\_irq\_event\_percpu) from [] (handle\_irq\_event+0x44/0x68)
(handle\_irq\_event) from [] (handle\_edge\_irq+0xf0/0x19c)
(handle\_edge\_irq) from [] (generic\_handle\_irq+0x24/0x34)
(generic\_handle\_irq) from [] (exynos\_eint\_gpio\_irq+0x50/0x68)
(exynos\_eint\_gpio\_irq) from [] (handle\_irq\_event\_percpu+0x88/0x140)
(handle\_irq\_event\_percpu) from [] (handle\_irq\_event+0x44/0x68)
(handle\_irq\_event) from [] (handle\_fasteoi\_irq+0xb4/0x194)
(handle\_fasteoi\_irq) from [] (generic\_handle\_irq+0x24/0x34)
(generic\_handle\_irq) from [] (\_\_handle\_domain\_irq+0x5c/0xb4)
(\_\_handle\_domain\_irq) from [] (gic\_handle\_irq+0x54/0x94)
(gic\_handle\_irq) from [] (\_\_irq\_usr+0x50/0x80)
The bug was reproduced on exynos4412-trats2 (with a max77693 device also
using i2c-gpio) after building max77693 as a module.
Fixes: 94a6d5cf7caa ("iio:ak8975 Implement data ready interrupt handling")
Signed-off-by: Krzysztof Kozlowski
Tested-by: Gregor Boirie
Signed-off-by: Jonathan Cameron
Signed-off-by: Greg Kroah-Hartman
commit 258868e6b953083e459f1e98679cf581889361c2
Author: Dave Airlie
Date: Tue May 3 12:44:29 2016 +1000
drm/amdgpu: set metadata pointer to NULL after freeing.
commit 0092d3edcb23fcdb8cbe4159ba94a534290ff982 upstream.
Without this there was a double free of the metadata,
which ended up freeing the fd table for me here, and taking
out the machine more often than not.
I reproduced with X.org + modesetting DDX + latest llvm/mesa,
also required using dri3.
Reviewed-by: Christian König
Signed-off-by: Dave Airlie
Signed-off-by: Alex Deucher
Signed-off-by: Greg Kroah-Hartman
commit bdc6a007a3252d2d7be325fe6198b0ffd73ae6f5
Author: Alex Deucher
Date: Mon May 2 18:54:39 2016 -0400
drm/amdgpu: make sure vertical front porch is at least 1
commit 0126d4b9a516256f2432ca0dc78ab293a8255378 upstream.
hw doesn't like a 0 value.
Signed-off-by: Alex Deucher
Signed-off-by: Greg Kroah-Hartman
commit 5e894774db088718ca19c6f00ad38c0a806b8bf6
Author: Philipp Zabel
Date: Wed Apr 27 10:17:51 2016 +0200
gpu: ipu-v3: Fix imx-ipuv3-crtc module autoloading
commit 503fe87bd0a8346ba9d8b7f49115dcd0a4185226 upstream.
If of\_node is set before calling platform\_device\_add, the driver core
will try to use of: modalias matching, which fails because the device
tree nodes don't have a compatible property set. This patch fixes
imx-ipuv3-crtc module autoloading by setting the of\_node property only
after the platform modalias is set.
Fixes: 304e6be652e2 ("gpu: ipu-v3: Assign of\_node of child platform devices to corresponding ports")
Reported-by: Dennis Gilmore
Signed-off-by: Philipp Zabel
Tested-By: Dennis Gilmore
Signed-off-by: Dave Airlie
Signed-off-by: Greg Kroah-Hartman
commit e81de7e0c84f4080642936caf205e67e392ebb07
Author: K. Y. Srinivasan
Date: Sat Apr 2 16:17:38 2016 -0700
Drivers: hv: vmbus: Fix signaling logic in hv\_need\_to\_signal\_on\_read()
commit 1db488d12894f1936360779d6ab2aede3dd7f06a upstream.
On the consumer side, we have interrupt driven flow management of the
producer. It is sufficient to base the signaling decision on the
amount of space that is available to write after the read is complete.
The current code samples the previous available space and uses this
in making the signaling decision. This state can be stale and is
unnecessary. Since the state can be stale, we end up not signaling
the host (when we should) and this can result in a hang. Fix this
problem by removing the unnecessary check. I would like to thank
Arseney Romanenko  for pointing out this issue.
Also, issue a full memory barrier before making the signaling descision
to correctly deal with potential reordering of the write (read index)
followed by the read of pending\_sz.
Signed-off-by: K. Y. Srinivasan
Tested-by: Dexuan Cui
Signed-off-by: Greg Kroah-Hartman
commit 61a33e0e3a51e43c5b3970c6f2dadb5ef14c61ed
Author: Stanislav Meduna
Date: Mon May 2 16:05:11 2016 +0100
nvmem: mxs-ocotp: fix buffer overflow in read
commit d1306eb675ad7a9a760b6b8e8e189824b8db89e7 upstream.
This patch fixes the issue where the mxs\_ocotp\_read is reading
the ocotp in reg\_size steps but decrements the remaining size
by 1. The number of iterations is thus four times higher,
overwriting the area behind the output buffer.
Fixes: c01e9a11ab6f ("nvmem: add driver for ocotp in i.MX23 and i.MX28")
Tested-by: Stefan Wahren
Signed-off-by: Stanislav Meduna
Signed-off-by: Srinivas Kandagatla
Signed-off-by: Greg Kroah-Hartman
commit dc19120c1cfd7bc8ae59776ad9f48ffdf37d7c7d
Author: Johan Hovold
Date: Mon May 2 15:35:57 2016 +0200
Revert "USB / PM: Allow USB devices to remain runtime-suspended when sleeping"
commit 9be427efc764464fbcbc1ca3f0d34f575cb0f037 upstream.
This reverts commit e3345db85068ddb937fc0ba40dfc39c293dad977, which
broke system resume for a large class of devices.
Devices that after having been reset during resume need to be rebound
due to a missing reset\_resume callback, are now left in a suspended
state. This specifically broke resume of common USB-serial devices,
which are now unusable after system suspend (until disconnected and
reconnected) when USB persist is enabled.
During resume, usb\_resume\_interface will set the needs\_binding flag for
such interfaces, but unlike system resume, run-time resume does not
honour it.
Signed-off-by: Johan Hovold
Acked-by: Alan Stern
Signed-off-by: Greg Kroah-Hartman
commit c0947948aed5b84aaf54a7757bf899d80d2079fe
Author: Jasem Mutlaq
Date: Tue Apr 19 10:38:27 2016 +0300
USB: serial: cp210x: add Straizona Focusers device ids
commit 613ac23a46e10d4d4339febdd534fafadd68e059 upstream.
Adding VID:PID for Straizona Focusers to cp210x driver.
Signed-off-by: Jasem Mutlaq
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 7b9cf0adfcf71a616c16970e440e450b7d402856
Author: Mike Manning
Date: Mon Apr 18 12:13:23 2016 +0000
USB: serial: cp210x: add ID for Link ECU
commit 1d377f4d690637a0121eac8701f84a0aa1e69a69 upstream.
The Link ECU is an aftermarket ECU computer for vehicles that provides
full tuning abilities as well as datalogging and displaying capabilities
via the USB to Serial adapter built into the device.
Signed-off-by: Mike Manning
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit dd7ac00e80f3711a61212549135a013871b2daa2
Author: Srinivas Kandagatla
Date: Fri Apr 1 08:52:57 2016 +0100
ata: ahci-platform: Add ports-implemented DT bindings.
commit 17dcc37e3e847bc0e67a5b1ec52471fcc6c18682 upstream.
On some SOCs PORTS\_IMPL register value is never programmed by the
firmware and left at zero value. Which means that no sata ports are
available for software. AHCI driver used to cope up with this by
fabricating the port\_map if the PORTS\_IMPL register is read zero,
but recent patch broke this workaround as zero value was valid for
NVMe disks.
This patch adds ports-implemented DT bindings as workaround for this issue
in a way that DT can can override the PORTS\_IMPL register in cases where
the firmware did not program it already.
Fixes: 566d1827df2e ("libata: disable forced PORTS\_IMPL for >= AHCI 1.3")
Signed-off-by: Srinivas Kandagatla
Acked-by: Tejun Heo
Reviewed-by: Andy Gross
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit 24514718a8d7cfde0d871cd41e6695f840d10701
Author: Srinivas Kandagatla
Date: Fri Apr 1 08:52:56 2016 +0100
libahci: save port map for forced port map
commit 2fd0f46cb1b82587c7ae4a616d69057fb9bd0af7 upstream.
In usecases where force\_port\_map is used saved\_port\_map is never set,
resulting in not programming the PORTS\_IMPL register as part of initial
config. This patch fixes this by setting it to port\_map even in case
where force\_port\_map is used, making it more inline with other parts of
the code.
Fixes: 566d1827df2e ("libata: disable forced PORTS\_IMPL for >= AHCI 1.3")
Signed-off-by: Srinivas Kandagatla
Acked-by: Tejun Heo
Reviewed-by: Andy Gross
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit 1b827ac8f57dbc38e10970bf163cdc6a9109deb8
Author: Anton Blanchard
Date: Sat Apr 30 08:29:27 2016 +1000
powerpc: Fix bad inline asm constraint in create\_zero\_mask()
commit b4c112114aab9aff5ed4568ca5e662bb02cdfe74 upstream.
In create\_zero\_mask() we have:
addi %1,%2,-1
andc %1,%1,%2
popcntd %0,%1
using the "r" constraint for %2. r0 is a valid register in the "r" set,
but addi X,r0,X turns it into an li:
li r7,-1
andc r7,r7,r0
popcntd r4,r7
Fix this by using the "b" constraint, for which r0 is not a valid
register.
This was found with a kernel build using gcc trunk, narrowed down to
when -frename-registers was enabled at -O2. It is just luck however
that we aren't seeing this on older toolchains.
Thanks to Segher for working with me to find this issue.
Fixes: d0cebfa650a0 ("powerpc: word-at-a-time optimization for 64-bit Little Endian")
Signed-off-by: Anton Blanchard
Signed-off-by: Michael Ellerman
Signed-off-by: Greg Kroah-Hartman
commit 1a2f5e091630fa32c68d268eb9435f1e330be249
Author: Prarit Bhargava
Date: Wed May 4 13:48:56 2016 +0800
ACPICA: Dispatcher: Update thread ID for recursive method calls
commit 93d68841a23a5779cef6fb9aa0ef32e7c5bd00da upstream.
ACPICA commit 7a3bd2d962f221809f25ddb826c9e551b916eb25
Set the mutex owner thread ID.
Original patch from: Prarit Bhargava
Link: https://bugzilla.kernel.org/show\_bug.cgi?id=115121
Link: https://github.com/acpica/acpica/commit/7a3bd2d9
Signed-off-by: Prarit Bhargava
Tested-by: Andy Lutomirski  # On a Dell XPS 13 9350
Signed-off-by: Bob Moore
Signed-off-by: Lv Zheng
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 9db555f30fbcc07be06ce4682faf6ebd9ed44da6
Author: Srinivas Kandagatla
Date: Fri Apr 1 08:52:58 2016 +0100
ARM: dts: apq8064: add ahci ports-implemented mask
commit bb4add2ce991e4ec891b5a0287fd1ab77b631979 upstream.
This patch adds new ports-implemented mask, which is required to get
achi working on the mainline. Without this patch value read from
PORTS\_IMPL register which is zero would not enable any ports for
software to use.
Fixes: 566d1827df2e ("libata: disable forced PORTS\_IMPL for >= AHCI 1.3")
Signed-off-by: Srinivas Kandagatla
Reviewed-by: Andy Gross
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit ebb096d092fa27159b24d1de55629e847e62798e
Author: Wang YanQing
Date: Thu May 5 14:14:21 2016 +0100
x86/sysfb\_efi: Fix valid BAR address range check
commit c10fcb14c7afd6688c7b197a814358fecf244222 upstream.
The code for checking whether a BAR address range is valid will break
out of the loop when a start address of 0x0 is encountered.
This behaviour is wrong since by breaking out of the loop we may miss
the BAR that describes the EFI frame buffer in a later iteration.
Because of this bug I can't use video=efifb: boot parameter to get
efifb on my new ThinkPad E550 for my old linux system hard disk with
3.10 kernel. In 3.10, efifb is the only choice due to DRM/I915 not
supporting the GPU.
This patch also add a trivial optimization to break out after we find
the frame buffer address range without testing later BARs.
Signed-off-by: Wang YanQing
[ Rewrote changelog. ]
Signed-off-by: Matt Fleming
Reviewed-by: Peter Jones
Cc: Ard Biesheuvel
Cc: David Herrmann
Cc: Linus Torvalds
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: Tomi Valkeinen
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/1462454061-21561-2-git-send-email-matt@codeblueprint.co.uk
Signed-off-by: Ingo Molnar
Signed-off-by: Greg Kroah-Hartman
commit fa04b83c64c8ef6aab759b6a33fc9b35659c0a0b
Author: Vineet Gupta
Date: Thu May 5 13:32:34 2016 +0530
ARC: Add missing io barriers to io{read,write}{16,32}be()
commit e5bc0478ab6cf565619224536d75ecb2aedca43b upstream.
While reviewing a different change to asm-generic/io.h Arnd spotted that
ARC ioread32 and ioread32be both of which come from asm-generic versions
are not symmetrical in terms of calling the io barriers.
generic ioread32 -> ARC readl() [ has barriers]
generic ioread32be -> \_\_be32\_to\_cpu(\_\_raw\_readl()) [ lacks barriers]
While generic ioread32be is being remediated to call readl(), that involves
a swab32(), causing double swaps on ioread32be() on Big Endian systems.
So provide our versions of big endian IO accessors to ensure io barrier
calls while also keeping them optimal
Suggested-by: Arnd Bergmann
Acked-by: Arnd Bergmann
Signed-off-by: Vineet Gupta
Signed-off-by: Greg Kroah-Hartman
commit 97e5ea472b70811cdf3a9c7403da06b55a2ecc5f
Author: Sudeep Holla
Date: Wed Apr 27 17:18:59 2016 +0100
cpufreq: st: enable selective initialization based on the platform
commit 2482bc31ca8096241b8fa97610ef23154ce55f45 upstream.
The sti-cpufreq does unconditional registration of the cpufreq-dt driver
which causes issue on an multi-platform build. For example, on Vexpress
TC2 platform, we get the following error on boot:
cpu cpu0: OPP-v2 not supported
cpu cpu0: Not doing voltage scaling
cpu: dev\_pm\_opp\_of\_cpumask\_add\_table: couldn't find opp table
for cpu:0, -19
cpu cpu0: dev\_pm\_opp\_get\_max\_volt\_latency: Invalid regulator (-6)
...
arm\_big\_little: bL\_cpufreq\_register: Failed registering platform driver:
vexpress-spc, err: -17
The actual driver fails to initialise as cpufreq-dt is probed
successfully, which is incorrect. This issue can happen to any platform
not using cpufreq-dt in a multi-platform build.
This patch adds a check to do selective initialization of the driver.
Fixes: ab0ea257fc58 (cpufreq: st: Provide runtime initialised driver for ST's platforms)
Signed-off-by: Sudeep Holla
Acked-by: Viresh Kumar
Acked-by: Lee Jones
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 60d4c63013b2e24a262742185b562082d1c91cfe
Author: Dmitry V. Levin
Date: Wed Apr 27 04:56:11 2016 +0300
parisc: fix a bug when syscall number of tracee is \_\_NR\_Linux\_syscalls
commit f0b22d1bb2a37a665a969e95785c75a4f49d1499 upstream.
Do not load one entry beyond the end of the syscall table when the
syscall number of a traced process equals to \_\_NR\_Linux\_syscalls.
Similar bug with regular processes was fixed by commit 3bb457af4fa8
("[PARISC] Fix bug when syscall nr is \_\_NR\_Linux\_syscalls").
This bug was found by strace test suite.
Signed-off-by: Dmitry V. Levin
Acked-by: Helge Deller
Signed-off-by: Helge Deller
Signed-off-by: Greg Kroah-Hartman
commit 20c2b0d977d5f4255d84d82908e29e531e993652
Author: James Morse
Date: Tue Apr 26 12:15:01 2016 +0100
ARM: cpuidle: Pass on arm\_cpuidle\_suspend()'s return value
commit 625fe4f8ffc1b915248558481bb94249f6bd411c upstream.
arm\_cpuidle\_suspend() may return -EOPNOTSUPP, or any value returned
by the cpu\_ops/cpuidle\_ops suspend call. arm\_enter\_idle\_state() doesn't
update 'ret' with this value, meaning we always signal success to
cpuidle\_enter\_state(), causing it to update the usage counters as if we
succeeded.
Fixes: 191de17aa3c1 ("ARM64: cpuidle: Replace cpu\_suspend by the common ARM/ARM64 function")
Signed-off-by: James Morse
Acked-by: Lorenzo Pieralisi
Acked-by: Daniel Lezcano
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 1ef1d7bf79e81997d0bed1aef0b440c17ae30bf6
Author: Chen Yu
Date: Fri May 6 11:33:39 2016 +0800
x86/tsc: Read all ratio bits from MSR\_PLATFORM\_INFO
commit 886123fb3a8656699dff40afa0573df359abeb18 upstream.
Currently we read the tsc radio: ratio = (MSR\_PLATFORM\_INFO >> 8) & 0x1f;
Thus we get bit 8-12 of MSR\_PLATFORM\_INFO, however according to the SDM
(35.5), the ratio bits are bit 8-15.
Ignoring the upper bits can result in an incorrect tsc ratio, which causes the
TSC calibration and the Local APIC timer frequency to be incorrect.
Fix this problem by masking 0xff instead.
[ tglx: Massaged changelog ]
Fixes: 7da7c1561366 "x86, tsc: Add static (MSR) TSC calibration on Intel Atom SoCs"
Signed-off-by: Chen Yu
Cc: "Rafael J. Wysocki"
Cc: Bin Gao
Cc: Len Brown
Link: http://lkml.kernel.org/r/1462505619-5516-1-git-send-email-yu.c.chen@intel.com
Signed-off-by: Thomas Gleixner
Signed-off-by: Greg Kroah-Hartman
commit df0e585778892f181aefdc3324e6407872d83a28
Author: Matt Fleming
Date: Tue May 3 20:29:39 2016 +0100
MAINTAINERS: Remove asterisk from EFI directory names
commit e8dfe6d8f6762d515fcd4f30577f7bfcf7659887 upstream.
Mark reported that having asterisks on the end of directory names
confuses get\_maintainer.pl when it encounters subdirectories, and that
my name does not appear when run on drivers/firmware/efi/libstub.
Reported-by: Mark Rutland
Signed-off-by: Matt Fleming
Cc: Ard Biesheuvel
Cc: Catalin Marinas
Cc: Linus Torvalds
Cc: Peter Zijlstra
Cc: Thomas Gleixner
Cc: linux-efi@vger.kernel.org
Link: http://lkml.kernel.org/r/1462303781-8686-2-git-send-email-matt@codeblueprint.co.uk
Signed-off-by: Ingo Molnar
Signed-off-by: Greg Kroah-Hartman
commit 6eaf7a4da0e6e7987c355e10f3b620e08ffb8740
Author: Howard Cochran
Date: Thu Mar 10 01:12:39 2016 -0500
writeback: Fix performance regression in wb\_over\_bg\_thresh()
commit 74d369443325063a5f0260e63971decb950fd8fa upstream.
Commit 947e9762a8dd ("writeback: update wb\_over\_bg\_thresh() to use
wb\_domain aware operations") unintentionally changed this function's
meaning from "are there more dirty pages than the background writeback
threshold" to "are there more dirty pages than the writeback threshold".
The background writeback threshold is typically half of the writeback
threshold, so this had the effect of raising the number of dirty pages
required to cause a writeback worker to perform background writeout.
This can cause a very severe performance regression when a BDI uses
BDI\_CAP\_STRICTLIMIT because balance\_dirty\_pages() and the writeback worker
can now disagree on whether writeback should be initiated.
For example, in a system having 1GB of RAM, a single spinning disk, and a
"pass-through" FUSE filesystem mounted over the disk, application code
mmapped a 128MB file on the disk and was randomly dirtying pages in that
mapping.
Because FUSE uses strictlimit and has a default max\_ratio of only 1%, in
balance\_dirty\_pages, thresh is ~200, bg\_thresh is ~100, and the
dirty\_freerun\_ceiling is the average of those, ~150. So, it pauses the
dirtying processes when we have 151 dirty pages and wakes up a background
writeback worker. But the worker tests the wrong threshold (200 instead of
100), so it does not initiate writeback and just returns.
Thus, balance\_dirty\_pages keeps looping, sleeping and then waking up the
worker who will do nothing. It remains stuck in this state until the few
dirty pages that we have finally expire and we write them back for that
reason. Then the whole process repeats, resulting in near-zero throughput
through the FUSE BDI.
The fix is to call the parameterized variant of wb\_calc\_thresh, so that the
worker will do writeback if the bg\_thresh is exceeded which was the
behavior before the referenced commit.
Fixes: 947e9762a8dd ("writeback: update wb\_over\_bg\_thresh() to use wb\_domain aware operations")
Signed-off-by: Howard Cochran
Acked-by: Tejun Heo
Signed-off-by: Miklos Szeredi
Tested-by Sedat Dilek
Signed-off-by: Jens Axboe
Signed-off-by: Greg Kroah-Hartman
commit d43a71c7203434cc202e9b5279cbd915a56bddd4
Author: Dan Williams
Date: Sat Apr 30 13:07:06 2016 -0700
libnvdimm, pfn: fix memmap reservation sizing
commit 658922e57b847bb7112aa67f6441b6bbc6554412 upstream.
When configuring a pfn-device instance to allocate the memmap array it
needs to account for the fact that vmemmap\_populate\_hugepages()
allocates struct page blocks in HPAGE\_SIZE chunks. We need to align the
reserved area size to 2MB otherwise arch\_add\_memory() runs out of memory
while establishing the memmap:
WARNING: CPU: 0 PID: 496 at arch/x86/mm/init\_64.c:704 arch\_add\_memory+0xe7/0xf0
[..]
Call Trace:
[] dump\_stack+0x85/0xc2
[] \_\_warn+0xcb/0xf0
[] warn\_slowpath\_null+0x1d/0x20
[] arch\_add\_memory+0xe7/0xf0
[] devm\_memremap\_pages+0x287/0x450
[] ? devm\_memremap\_pages+0x1ea/0x450
[] \_\_wrap\_devm\_memremap\_pages+0x58/0x70 [nfit\_test\_iomap]
[] pmem\_attach\_disk+0x318/0x420 [nd\_pmem]
[] nd\_pmem\_probe+0x6f/0x90 [nd\_pmem]
[] nvdimm\_bus\_probe+0x69/0x110 [libnvdimm]
[..]
ndbus0: nd\_pmem.probe(pfn3.0) = -12
nd\_pmem: probe of pfn3.0 failed with error -12
libndctl: ndctl\_pfn\_enable: pfn3.0: failed to enable
Reported-by: Namratha Kothapalli
Signed-off-by: Dan Williams
Signed-off-by: Greg Kroah-Hartman
commit 1b4297673495d4970aef8b59c66efb709c78bf10
Author: Sven Eckelmann
Date: Sun Mar 20 12:27:53 2016 +0100
batman-adv: Reduce refcnt of removed router when updating route
commit d1a65f1741bfd9c69f9e4e2ad447a89b6810427d upstream.
\_batadv\_update\_route rcu\_derefences orig\_ifinfo->router outside of a
spinlock protected region to print some information messages to the debug
log. But this pointer is not checked again when the new pointer is assigned
in the spinlock protected region. Thus is can happen that the value of
orig\_ifinfo->router changed in the meantime and thus the reference counter
of the wrong router gets reduced after the spinlock protected region.
Just rcu\_dereferencing the value of orig\_ifinfo->router inside the spinlock
protected region (which also set the new pointer) is enough to get the
correct old router object.
Fixes: e1a5382f978b ("batman-adv: Make orig\_node->router an rcu protected pointer")
Signed-off-by: Sven Eckelmann
Signed-off-by: Marek Lindner
Signed-off-by: Antonio Quartulli
Signed-off-by: Greg Kroah-Hartman
commit faf1954f51fcf82eae28226dc9801afd8646a99b
Author: Linus Lüssing
Date: Fri Mar 11 14:04:49 2016 +0100
batman-adv: Fix broadcast/ogm queue limit on a removed interface
commit c4fdb6cff2aa0ae740c5f19b6f745cbbe786d42f upstream.
When removing a single interface while a broadcast or ogm packet is
still pending then we will free the forward packet without releasing the
queue slots again.
This patch is supposed to fix this issue.
Fixes: 6d5808d4ae1b ("batman-adv: Add missing hardif\_free\_ref in forw\_packet\_free")
Signed-off-by: Linus Lüssing
[sven@narfation.org: fix conflicts with current version]
Signed-off-by: Sven Eckelmann
Signed-off-by: Marek Lindner
Signed-off-by: Antonio Quartulli
Signed-off-by: Greg Kroah-Hartman
commit accd3bbf7bafa5741f2317c4ea97896ec571d165
Author: Sven Eckelmann
Date: Fri Feb 26 17:56:13 2016 +0100
batman-adv: Check skb size before using encapsulated ETH+VLAN header
commit c78296665c3d81f040117432ab9e1cb125521b0c upstream.
The encapsulated ethernet and VLAN header may be outside the received
ethernet frame. Thus the skb buffer size has to be checked before it can be
parsed to find out if it encapsulates another batman-adv packet.
Fixes: 420193573f11 ("batman-adv: softif bridge loop avoidance")
Signed-off-by: Sven Eckelmann
Signed-off-by: Marek Lindner
Signed-off-by: Antonio Quartulli
Signed-off-by: Greg Kroah-Hartman
commit 932793e450c0b57c93fa5ac048e3936c478291b8
Author: Antonio Quartulli
Date: Sat Mar 12 11:12:59 2016 +0100
batman-adv: fix DAT candidate selection (must use vid)
commit 2871734e85e920503d49b3a8bc0afbe0773b6036 upstream.
Now that DAT is VLAN aware, it must use the VID when
computing the DHT address of the candidate nodes where
an entry is going to be stored/retrieved.
Fixes: be1db4f6615b ("batman-adv: make the Distributed ARP Table vlan aware")
Signed-off-by: Antonio Quartulli
[sven@narfation.org: fix conflicts with current version]
Signed-off-by: Sven Eckelmann
Signed-off-by: Marek Lindner
Signed-off-by: Greg Kroah-Hartman
commit 61ecd7fd2fafedc786ba500680a674324715673f
Author: Jason Baron
Date: Thu May 5 16:22:12 2016 -0700
mm: update min\_free\_kbytes from khugepaged after core initialization
commit bc22af74f271ef76b2e6f72f3941f91f0da3f5f8 upstream.
Khugepaged attempts to raise min\_free\_kbytes if its set too low.
However, on boot khugepaged sets min\_free\_kbytes first from
subsys\_initcall(), and then the mm 'core' over-rides min\_free\_kbytes
after from init\_per\_zone\_wmark\_min(), via a module\_init() call.
Khugepaged used to use a late\_initcall() to set min\_free\_kbytes (such
that it occurred after the core initialization), however this was
removed when the initialization of min\_free\_kbytes was integrated into
the starting of the khugepaged thread.
The fix here is simply to invoke the core initialization using a
core\_initcall() instead of module\_init(), such that the previous
initialization ordering is restored. I didn't restore the
late\_initcall() since start\_stop\_khugepaged() already sets
min\_free\_kbytes via set\_recommended\_min\_free\_kbytes().
This was noticed when we had a number of page allocation failures when
moving a workload to a kernel with this new initialization ordering. On
an 8GB system this restores min\_free\_kbytes back to 67584 from 11365
when CONFIG\_TRANSPARENT\_HUGEPAGE=y is set and either
CONFIG\_TRANSPARENT\_HUGEPAGE\_ALWAYS=y or
CONFIG\_TRANSPARENT\_HUGEPAGE\_MADVISE=y.
Fixes: 79553da293d3 ("thp: cleanup khugepaged startup")
Signed-off-by: Jason Baron
Acked-by: Kirill A. Shutemov
Acked-by: David Rientjes
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 3e047c7357c2022dffdddd0b6484ed53571f13ba
Author: Mathias Krause
Date: Thu May 5 16:22:26 2016 -0700
proc: prevent accessing /proc//environ until it's ready
commit 8148a73c9901a8794a50f950083c00ccf97d43b3 upstream.
If /proc//environ gets read before the envp[] array is fully set up
in create\_{aout,elf,elf\_fdpic,flat}\_tables(), we might end up trying to
read more bytes than are actually written, as env\_start will already be
set but env\_end will still be zero, making the range calculation
underflow, allowing to read beyond the end of what has been written.
Fix this as it is done for /proc//cmdline by testing env\_end for
zero. It is, apparently, intentionally set last in create\_\*\_tables().
This bug was found by the PaX size\_overflow plugin that detected the
arithmetic underflow of 'this\_len = env\_end - (env\_start + src)' when
env\_end is still zero.
The expected consequence is that userland trying to access
/proc//environ of a not yet fully set up process may get
inconsistent data as we're in the middle of copying in the environment
variables.
Fixes: https://forums.grsecurity.net/viewtopic.php?f=3&t=4363
Fixes: https://bugzilla.kernel.org/show\_bug.cgi?id=116461
Signed-off-by: Mathias Krause
Cc: Emese Revfy
Cc: Pax Team
Cc: Al Viro
Cc: Mateusz Guzik
Cc: Alexey Dobriyan
Cc: Cyrill Gorcunov
Cc: Jarod Wilson
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 182029d97919c3712676c46c18b4190d28fc802a
Author: Knut Wohlrab
Date: Mon Apr 25 14:08:25 2016 -0700
Input: zforce\_ts - fix dual touch recognition
commit 6984ab1ab35f422292b7781c65284038bcc0f6a6 upstream.
A wrong decoding of the touch coordinate message causes a wrong touch
ID. Touch ID for dual touch must be 0 or 1.
According to the actual Neonode nine byte touch coordinate coding,
the state is transported in the lower nibble and the touch ID in
the higher nibble of payload byte five.
Signed-off-by: Knut Wohlrab
Signed-off-by: Oleksij Rempel
Signed-off-by: Dirk Behme
Signed-off-by: Dmitry Torokhov
Signed-off-by: Greg Kroah-Hartman
commit eadd64d6214ae166105fda54509a9240f39cdb2a
Author: Nazar Mokrynskyi
Date: Mon Apr 25 17:01:56 2016 +0300
HID: Fix boot delay for Creative SB Omni Surround 5.1 with quirk
commit 567a44ecb44eb2584ddb93e962cfb133ce77e0bb upstream.
Needed for v2 of the device firmware, otherwise kernel will stuck for few
seconds and throw "usb\_submit\_urb(ctrl) failed: -1" early on system boot.
Signed-off-by: Nazar Mokrynskyi
Reviewed-by: Benjamin Tissoires
Signed-off-by: Jiri Kosina
Signed-off-by: Greg Kroah-Hartman
commit 20a0d92976779082cd8fe90ba712a736d746ea3b
Author: Ping Cheng
Date: Tue Apr 12 13:37:45 2016 -0700
HID: wacom: Add support for DTK-1651
commit e1123fe975852cc0970b4e53ea65ca917e54c923 upstream.
DTK-1651 is a display pen-only tablet
Signed-off-by: Ping Cheng
Signed-off-by: Jiri Kosina
Signed-off-by: Greg Kroah-Hartman
commit c29239fa84d99a5695595ff9600ac0b25d4e3368
Author: Jan Beulich
Date: Wed May 4 07:02:36 2016 -0600
xen/evtchn: fix ring resize when binding new events
commit 27e0e6385377c4dc68a4ddaf1a35a2dfa951f3c5 upstream.
The copying of ring data was wrong for two cases: For a full ring
nothing got copied at all (as in that case the canonicalized producer
and consumer indexes are identical). And in case one or both of the
canonicalized (after the resize) indexes would point into the second
half of the buffer, the copied data ended up in the wrong (free) part
of the new buffer. In both cases uninitialized data would get passed
back to the caller.
Fix this by simply copying the old ring contents twice: Once to the
low half of the new buffer, and a second time to the high half.
This addresses the inability to boot a HVM guest with 64 or more
vCPUs. This regression was caused by 8620015499101090 (xen/evtchn:
dynamically grow pending event channel ring).
Reported-by: Konrad Rzeszutek Wilk
Signed-off-by: Jan Beulich
Signed-off-by: David Vrabel
Signed-off-by: Greg Kroah-Hartman
commit 464ae61119b0430bf8c97432780f5081f442dead
Author: Ross Lagerwall
Date: Thu Mar 17 16:52:00 2016 +0000
xen/balloon: Fix crash when ballooning on x86 32 bit PAE
commit dfd74a1edfaba5864276a2859190a8d242d18952 upstream.
Commit 55b3da98a40dbb3776f7454daf0d95dde25c33d2 (xen/balloon: find
non-conflicting regions to place hotplugged memory) caused a
regression in 4.4.
When ballooning on an x86 32 bit PAE system with close to 64 GiB of
memory, the address returned by allocate\_resource may be above 64 GiB.
When using CONFIG\_SPARSEMEM, this setup is limited to using physical
addresses < 64 GiB. When adding memory at this address, it runs off
the end of the mem\_section array and causes a crash. Instead, fail
the ballooning request.
Signed-off-by: Ross Lagerwall
Signed-off-by: David Vrabel
Signed-off-by: Greg Kroah-Hartman
commit 2a2432a51fa831a7754a13f3f64ac60583968252
Author: Ross Lagerwall
Date: Thu Mar 17 16:51:59 2016 +0000
xen: Fix page <-> pfn conversion on 32 bit systems
commit 60901df3aed230d4565dca003f11b6a95fbf30d9 upstream.
Commit 1084b1988d22dc165c9dbbc2b0e057f9248ac4db (xen: Add Xen specific
page definition) caused a regression in 4.4.
The xen functions to convert between pages and pfns fail due to an
overflow on systems where a physical address may not fit in an
unsigned long (e.g. x86 32 bit PAE systems). Rework the conversion to
avoid overflow. This should also result in simpler object code.
This bug manifested itself as disk corruption with Linux 4.4 when
using blkfront in a Xen HVM x86 32 bit guest with more than 4 GiB of
memory.
Signed-off-by: Ross Lagerwall
Signed-off-by: David Vrabel
Signed-off-by: Greg Kroah-Hartman
commit bcb6a4ed25d6d3d43aaab2b1d2c59228ab725559
Author: Sascha Hauer
Date: Wed Apr 20 13:34:31 2016 +0000
ARM: SoCFPGA: Fix secondary CPU startup in thumb2 kernel
commit 5616f36713ea77f57ae908bf2fef641364403c9f upstream.
The secondary CPU starts up in ARM mode. When the kernel is compiled in
thumb2 mode we have to explicitly compile the secondary startup
trampoline in ARM mode, otherwise the CPU will go to Nirvana.
Signed-off-by: Sascha Hauer
Reported-by: Steffen Trumtrar
Suggested-by: Ard Biesheuvel
Signed-off-by: Dinh Nguyen
Signed-off-by: Kevin Hilman
Signed-off-by: Greg Kroah-Hartman
commit 008e868fe30d39e8cb7d328edd0b813ef5160367
Author: Krzysztof Kozlowski
Date: Fri Apr 22 09:26:52 2016 +0200
ARM: EXYNOS: Properly skip unitialized parent clock in power domain on
commit a0a966b83873f33778710a4fc59240244b0734a5 upstream.
We want to skip reparenting a clock on turning on power domain, if we
do not have the parent yet. The parent is obtained when turning the
domain off. However due to a typo, the loop is continued on IS\_ERR() of
clock being reparented, not on the IS\_ERR() of the parent.
Theoretically this could lead to OOPS on first turn on of a power
domain, if there was no turn off before. Practically that should never
happen because all power domains are turned on by default (reset value,
bootloader does not turn off them usually) so the first action will be
always turn off.
Fixes: 29e5eea06bc1 ("ARM: EXYNOS: Get current parent clock for power domain on/off")
Reported-by: Vladimir Zapolskiy
Signed-off-by: Krzysztof Kozlowski
Signed-off-by: Greg Kroah-Hartman
commit cdfa8796c9971707685ac5e868db99a29e52f29a
Author: Philipp Zabel
Date: Thu May 5 16:22:29 2016 -0700
modpost: fix module autoloading for OF devices with generic compatible property
commit acbef7b7662953cec96c243db4009ac561d88989 upstream.
Since the wildcard at the end of OF module aliases is gone, autoloading
of modules that don't match a device's last (most generic) compatible
value fails.
For example the CODA960 VPU on i.MX6Q has the SoC specific compatible
"fsl,imx6q-vpu" and the generic compatible "cnm,coda960". Since the
driver currently only works with knowledge about the SoC specific
integration, it doesn't list "cnm,cod960" in the module device table.
This results in the device compatible
"of:NvpuTCfsl,imx6q-vpuCcnm,coda960" not matching the module alias
"of:N\*T\*Cfsl,imx6q-vpu" anymore, whereas before commit 2f632369ab79
("modpost: don't add a trailing wildcard for OF module aliases") it
matched the module alias "of:N\*T\*Cfsl,imx6q-vpu\*".
This patch adds two module aliases for each compatible, one without the
wildcard and one with "C\*" appended.
$ modinfo coda | grep imx6q
alias: of:N\*T\*Cfsl,imx6q-vpuC\*
alias: of:N\*T\*Cfsl,imx6q-vpu
Fixes: 2f632369ab79 ("modpost: don't add a trailing wildcard for OF module aliases")
Link: http://lkml.kernel.org/r/1462203339-15340-1-git-send-email-p.zabel@pengutronix.de
Signed-off-by: Philipp Zabel
Cc: Javier Martinez Canillas
Cc: Brian Norris
Cc: Sjoerd Simons
Cc: Rusty Russell
Cc: Greg Kroah-Hartman
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit b439d566d2219d9e1f05ae4cdb4fd19f132899c8
Author: Eric W. Biederman
Date: Thu May 5 09:29:29 2016 -0500
propogate\_mnt: Handle the first propogated copy being a slave
commit 5ec0811d30378ae104f250bfc9b3640242d81e3f upstream.
When the first propgated copy was a slave the following oops would result:
> BUG: unable to handle kernel NULL pointer dereference at 0000000000000010
> IP: [] propagate\_one+0xbe/0x1c0
> PGD bacd4067 PUD bac66067 PMD 0
> Oops: 0000 [#1] SMP
> Modules linked in:
> CPU: 1 PID: 824 Comm: mount Not tainted 4.6.0-rc5userns+ #1523
> Hardware name: Bochs Bochs, BIOS Bochs 01/01/2007
> task: ffff8800bb0a8000 ti: ffff8800bac3c000 task.ti: ffff8800bac3c000
> RIP: 0010:[] [] propagate\_one+0xbe/0x1c0
> RSP: 0018:ffff8800bac3fd38 EFLAGS: 00010283
> RAX: 0000000000000000 RBX: ffff8800bb77ec00 RCX: 0000000000000010
> RDX: 0000000000000000 RSI: ffff8800bb58c000 RDI: ffff8800bb58c480
> RBP: ffff8800bac3fd48 R08: 0000000000000001 R09: 0000000000000000
> R10: 0000000000001ca1 R11: 0000000000001c9d R12: 0000000000000000
> R13: ffff8800ba713800 R14: ffff8800bac3fda0 R15: ffff8800bb77ec00
> FS: 00007f3c0cd9b7e0(0000) GS:ffff8800bfb00000(0000) knlGS:0000000000000000
> CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
> CR2: 0000000000000010 CR3: 00000000bb79d000 CR4: 00000000000006e0
> Stack:
> ffff8800bb77ec00 0000000000000000 ffff8800bac3fd88 ffffffff811fbf85
> ffff8800bac3fd98 ffff8800bb77f080 ffff8800ba713800 ffff8800bb262b40
> 0000000000000000 0000000000000000 ffff8800bac3fdd8 ffffffff811f1da0
> Call Trace:
> [] propagate\_mnt+0x105/0x140
> [] attach\_recursive\_mnt+0x120/0x1e0
> [] graft\_tree+0x63/0x70
> [] do\_add\_mount+0x9b/0x100
> [] do\_mount+0x2aa/0xdf0
> [] ? strndup\_user+0x4e/0x70
> [] SyS\_mount+0x75/0xc0
> [] do\_syscall\_64+0x4b/0xa0
> [] entry\_SYSCALL64\_slow\_path+0x25/0x25
> Code: 00 00 75 ec 48 89 0d 02 22 22 01 8b 89 10 01 00 00 48 89 05 fd 21 22 01 39 8e 10 01 00 00 0f 84 e0 00 00 00 48 8b 80 d8 00 00 00 <48> 8b 50 10 48 89 05 df 21 22 01 48 89 15 d0 21 22 01 8b 53 30
> RIP [] propagate\_one+0xbe/0x1c0
> RSP
> CR2: 0000000000000010
> ---[ end trace 2725ecd95164f217 ]---
This oops happens with the namespace\_sem held and can be triggered by
non-root users. An all around not pleasant experience.
To avoid this scenario when finding the appropriate source mount to
copy stop the walk up the mnt\_master chain when the first source mount
is encountered.
Further rewrite the walk up the last\_source mnt\_master chain so that
it is clear what is going on.
The reason why the first source mount is special is that it it's
mnt\_parent is not a mount in the dest\_mnt propagation tree, and as
such termination conditions based up on the dest\_mnt mount propgation
tree do not make sense.
To avoid other kinds of confusion last\_dest is not changed when
computing last\_source. last\_dest is only used once in propagate\_one
and that is above the point of the code being modified, so changing
the global variable is meaningless and confusing.
fixes: f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68 ("smarter propagate\_mnt()")
Reported-by: Tycho Andersen
Reviewed-by: Seth Forshee
Tested-by: Seth Forshee
Signed-off-by: "Eric W. Biederman"
Signed-off-by: Greg Kroah-Hartman
commit de6d747a37d456e5a64055d2a8647c666449c2b6
Author: Dan Streetman
Date: Thu May 5 16:22:23 2016 -0700
mm/zswap: provide unique zpool name
commit 32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc upstream.
Instead of using "zswap" as the name for all zpools created, add an
atomic counter and use "zswap%x" with the counter number for each zpool
created, to provide a unique name for each new zpool.
As zsmalloc, one of the zpool implementations, requires/expects a unique
name for each pool created, zswap should provide a unique name. The
zsmalloc pool creation does not fail if a new pool with a conflicting
name is created, unless CONFIG\_ZSMALLOC\_STAT is enabled; in that case,
zsmalloc pool creation fails with -ENOMEM. Then zswap will be unable to
change its compressor parameter if its zpool is zsmalloc; it also will
be unable to change its zpool parameter back to zsmalloc, if it has any
existing old zpool using zsmalloc with page(s) in it. Attempts to
change the parameters will result in failure to create the zpool. This
changes zswap to provide a unique name for each zpool creation.
Fixes: f1c54846ee45 ("zswap: dynamic pool creation")
Signed-off-by: Dan Streetman
Reported-by: Sergey Senozhatsky
Reviewed-by: Sergey Senozhatsky
Cc: Dan Streetman
Cc: Minchan Kim
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit f1b5f0d8d55029e34d1bb3a2558c6ac5ae92aee3
Author: Hugh Dickins
Date: Thu May 5 16:22:15 2016 -0700
mm, cma: prevent nr\_isolated\_\* counters from going negative
commit 14af4a5e9b26ad251f81c174e8a43f3e179434a5 upstream.
/proc/sys/vm/stat\_refresh warns nr\_isolated\_anon and nr\_isolated\_file go
increasingly negative under compaction: which would add delay when
should be none, or no delay when should delay. The bug in compaction
was due to a recent mmotm patch, but much older instance of the bug was
also noticed in isolate\_migratepages\_range() which is used for CMA and
gigantic hugepage allocations.
The bug is caused by putback\_movable\_pages() in an error path
decrementing the isolated counters without them being previously
incremented by acct\_isolated(). Fix isolate\_migratepages\_range() by
removing the error-path putback, thus reaching acct\_isolated() with
migratepages still isolated, and leaving putback to caller like most
other places do.
Fixes: edc2ca612496 ("mm, compaction: move pageblock checks up from isolate\_migratepages\_range()")
[vbabka@suse.cz: expanded the changelog]
Signed-off-by: Hugh Dickins
Signed-off-by: Vlastimil Babka
Acked-by: Joonsoo Kim
Cc: Michal Hocko
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 948a36c33ff066b57600a8af3159132ff480380f
Author: Johannes Weiner
Date: Thu May 5 16:22:03 2016 -0700
mm: memcontrol: let v2 cgroups follow changes in system swappiness
commit 4550c4e157ca3da929593bb6c64080a59141af35 upstream.
Cgroup2 currently doesn't have a per-cgroup swappiness setting. We
might want to add one later - that's a different discussion - but until
we do, the cgroups should always follow the system setting. Otherwise
it will be unchangeably set to whatever the ancestor inherited from the
system setting at the time of cgroup creation.
Signed-off-by: Johannes Weiner
Acked-by: Michal Hocko
Acked-by: Vladimir Davydov
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit e223f3f95a942ad4529f59eeeb1bcbf413193492
Author: Linus Torvalds
Date: Mon May 2 12:46:42 2016 -0700
Minimal fix-up of bad hashing behavior of hash\_64()
commit 689de1d6ca95b3b5bd8ee446863bf81a4883ea25 upstream.
This is a fairly minimal fixup to the horribly bad behavior of hash\_64()
with certain input patterns.
In particular, because the multiplicative value used for the 64-bit hash
was intentionally bit-sparse (so that the multiply could be done with
shifts and adds on architectures without hardware multipliers), some
bits did not get spread out very much. In particular, certain fairly
common bit ranges in the input (roughly bits 12-20: commonly with the
most information in them when you hash things like byte offsets in files
or memory that have block factors that mean that the low bits are often
zero) would not necessarily show up much in the result.
There's a bigger patch-series brewing to fix up things more completely,
but this is the fairly minimal fix for the 64-bit hashing problem. It
simply picks a much better constant multiplier, spreading the bits out a
lot better.
NOTE! For 32-bit architectures, the bad old hash\_64() remains the same
for now, since 64-bit multiplies are expensive. The bigger hashing
cleanup will replace the 32-bit case with something better.
The new constants were picked by George Spelvin who wrote that bigger
cleanup series. I just picked out the constants and part of the comment
from that series.
Cc: George Spelvin
Cc: Thomas Gleixner
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit ea70acba9060f000b29a448ae297e52afae62674
Author: Shaohua Li
Date: Mon Apr 25 16:52:38 2016 -0700
MD: make bio mergeable
commit 9c573de3283af007ea11c17bde1e4568d9417328 upstream.
blk\_queue\_split marks bio unmergeable, which makes sense for normal bio.
But if dispatching the bio to underlayer disk, the blk\_queue\_split
checks are invalid, hence it's possible the bio becomes mergeable.
In the reported bug, this bug causes trim against raid0 performance slash
https://bugzilla.kernel.org/show\_bug.cgi?id=117051
Reported-and-tested-by: Park Ju Hyung
Fixes: 6ac45aeb6bca(block: avoid to merge splitted bio)
Cc: Ming Lei
Cc: Neil Brown
Reviewed-by: Jens Axboe
Signed-off-by: Shaohua Li
Signed-off-by: Greg Kroah-Hartman
commit 8da6fc209021d8668602401b59cc08c52c3e0e01
Author: Chunyu Hu
Date: Tue May 3 19:34:34 2016 +0800
tracing: Don't display trigger file for events that can't be enabled
commit 854145e0a8e9a05f7366d240e2f99d9c1ca6d6dd upstream.
Currently register functions for events will be called
through the 'reg' field of event class directly without
any check when seting up triggers.
Triggers for events that don't support register through
debug fs (events under events/ftrace are for trace-cmd to
read event format, and most of them don't have a register
function except events/ftrace/functionx) can't be enabled
at all, and an oops will be hit when setting up trigger
for those events, so just not creating them is an easy way
to avoid the oops.
Link: http://lkml.kernel.org/r/1462275274-3911-1-git-send-email-chuhu@redhat.com
Fixes: 85f2b08268c01 ("tracing: Add basic event trigger framework")
Signed-off-by: Chunyu Hu
Signed-off-by: Steven Rostedt
Signed-off-by: Greg Kroah-Hartman
commit 76b41725381f94570085755e37883a0bf55ee176
Author: Johannes Berg
Date: Tue Apr 26 13:47:08 2016 +0200
mac80211: fix statistics leak if dev\_alloc\_name() fails
commit e6436be21e77e3659b4ff7e357ab5a8342d132d2 upstream.
In the case that dev\_alloc\_name() fails, e.g. because the name was
given by the user and already exists, we need to clean up properly
and free the per-CPU statistics. Fix that.
Fixes: 5a490510ba5f ("mac80211: use per-CPU TX/RX statistics")
Signed-off-by: Johannes Berg
Signed-off-by: Greg Kroah-Hartman
commit 8010bbdf5d0aa35b9dfa598f41d837c2f987e05c
Author: Oleksij Rempel
Date: Tue Apr 12 19:37:44 2016 +0200
ath9k: ar5008\_hw\_cmn\_spur\_mitigate: add missing mask\_m & mask\_p initialisation
commit de478a61389cacafe94dc8b035081b681b878f9d upstream.
by moving common code to ar5008\_hw\_cmn\_spur\_mitigate i forgot to move
mask\_m & mask\_p initialisation. This coused a performance regression
on ar9281.
Fixes: f911085ffa88 ("ath9k: split ar5008\_hw\_spur\_mitigate and reuse common code in ar9002\_hw\_spur\_mitigate.")
Reported-by: Gustav Frederiksen
Tested-by: Gustav Frederiksen
Signed-off-by: Oleksij Rempel
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit b9a9e4a4f79e801d638786c81a4fdba827c378a2
Author: Ville Syrjälä
Date: Mon Apr 25 16:01:19 2016 +0300
gpiolib-acpi: Duplicate con\_id string when adding it to the crs lookup list
commit 7df89e92a56a3d2c8f84aa76c61471e4a7bc24f9 upstream.
Calling gpiod\_get() from a module and then unloading the module leads to an
oops due to acpi\_can\_fallback\_to\_crs() storing the pointer to the passed
'con\_id' string onto acpi\_crs\_lookup\_list. The next guy to come along will then
try to access the string but the memory may now be gone with the module.
Make a copy of the passed string instead, and store the copy on the list.
BUG: unable to handle kernel paging request at ffffffffa03e7855
IP: [] strcmp+0x12/0x30
PGD 2a07067 PUD 2a08063 PMD 74720067 PTE 0
Oops: 0000 [#1] PREEMPT SMP
Modules linked in: i915(+) drm\_kms\_helper drm intel\_gtt snd\_hda\_codec snd\_hda\_core i2c\_algo\_bit syscopya
rea sysfillrect sysimgblt fb\_sys\_fops agpgart snd\_soc\_sst\_bytcr\_rt5640 coretemp hwmon intel\_rapl intel\_soc\_dts\_thermal
punit\_atom\_debug snd\_soc\_rt5640 snd\_soc\_rl6231 serio snd\_intel\_sst\_acpi snd\_intel\_sst\_core video snd\_soc\_sst\_mfld\_platf
orm snd\_soc\_sst\_match backlight int3402\_thermal processor\_thermal\_device int3403\_thermal int3400\_thermal acpi\_thermal\_r
el snd\_soc\_core intel\_soc\_dts\_iosf int340x\_thermal\_zone snd\_compress i2c\_hid hid snd\_pcm snd\_timer snd soundcore evdev
sch\_fq\_codel efivarfs ipv6 autofs4 [last unloaded: drm]
CPU: 2 PID: 3064 Comm: modprobe Tainted: G U W 4.6.0-rc3-ffrd-ipvr+ #302
Hardware name: Intel Corp. VALLEYVIEW C0 PLATFORM/BYT-T FFD8, BIOS BLAKFF81.X64.0088.R10.1403240443 FFD8
\_X64\_R\_2014\_13\_1\_00 03/24/2014
task: ffff8800701cd200 ti: ffff880070034000 task.ti: ffff880070034000
RIP: 0010:[] [] strcmp+0x12/0x30
RSP: 0000:ffff880070037748 EFLAGS: 00010286
RAX: 0000000080000000 RBX: ffff88007a342800 RCX: 0000000000000006
RDX: 0000000000000006 RSI: ffffffffa054f856 RDI: ffffffffa03e7856
RBP: ffff880070037748 R08: 0000000000000000 R09: 0000000000000001
R10: 0000000000000000 R11: 0000000000000000 R12: ffffffffa054f855
R13: ffff88007281cae0 R14: 0000000000000010 R15: ffffffffffffffea
FS: 00007faa51447700(0000) GS:ffff880079300000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: ffffffffa03e7855 CR3: 0000000041eba000 CR4: 00000000001006e0
Stack:
ffff880070037770 ffffffff8136ad28 ffffffffa054f855 0000000000000000
ffff88007a0a2098 ffff8800700377e8 ffffffff8136852e ffff88007a342800
00000007700377a0 ffff8800700377a0 ffffffff81412442 70672d6c656e6170
Call Trace:
[] acpi\_can\_fallback\_to\_crs+0x88/0x100
[] gpiod\_get\_index+0x25e/0x310
[] ? mipi\_dsi\_attach+0x22/0x30
[] gpiod\_get+0x12/0x20
[] intel\_dsi\_init+0x421/0x480 [i915]
[] intel\_modeset\_init+0x853/0x16b0 [i915]
[] ? intel\_setup\_gmbus+0x214/0x260 [i915]
[] i915\_driver\_load+0xdc8/0x19b0 [i915]
[] ? \_raw\_spin\_unlock\_irqrestore+0x43/0x70
[] drm\_dev\_register+0xab/0xc0 [drm]
[] drm\_get\_pci\_dev+0x93/0x1f0 [drm]
[] ? \_raw\_spin\_unlock\_irqrestore+0x43/0x70
[] i915\_pci\_probe+0x34/0x50 [i915]
[] pci\_device\_probe+0x91/0x100
[] driver\_probe\_device+0x20a/0x2d0
[] \_\_driver\_attach+0x9e/0xb0
[] ? driver\_probe\_device+0x2d0/0x2d0
[] bus\_for\_each\_dev+0x69/0xa0
[] driver\_attach+0x1e/0x20
[] bus\_add\_driver+0x1c0/0x240
[] driver\_register+0x60/0xe0
[] \_\_pci\_register\_driver+0x60/0x70
[] drm\_pci\_init+0xe4/0x110 [drm]
[] ? trace\_hardirqs\_on+0xe/0x10
[] ? 0xffffffffa02f1000
[] i915\_init+0x94/0x9b [i915]
[] do\_one\_initcall+0x8b/0x1c0
[] ? rcu\_read\_lock\_sched\_held+0x86/0x90
[] ? kmem\_cache\_alloc\_trace+0x1f6/0x270
[] do\_init\_module+0x60/0x1dc
[] load\_module+0x1d0d/0x2390
[] ? \_\_symbol\_put+0x70/0x70
[] ? kernel\_read\_file+0x92/0x120
[] SYSC\_finit\_module+0xa4/0xb0
[] SyS\_finit\_module+0xe/0x10
[] do\_syscall\_64+0x63/0x350
[] entry\_SYSCALL64\_slow\_path+0x25/0x25
Code: f7 48 8d 76 01 48 8d 52 01 0f b6 4e ff 84 c9 88 4a ff 75 ed 5d c3 0f 1f 00 55 48 89 e5 eb 04 84 c0
74 18 48 8d 7f 01 48 8d 76 01 <0f> b6 47 ff 3a 46 ff 74 eb 19 c0 83 c8 01 5d c3 31 c0 5d c3 66
RIP [] strcmp+0x12/0x30
RSP
CR2: ffffffffa03e7855
v2: Make the copied con\_id const
Cc: Dmitry Torokhov
Cc: Mika Westerberg
Cc: Alexandre Courbot
Fixes: 10cf4899f8af ("gpiolib: tighten up ACPI legacy gpio lookups")
Signed-off-by: Ville Syrjälä
Acked-by: Mika Westerberg
Reviewed-by: Dmitry Torokhov
Signed-off-by: Linus Walleij
Signed-off-by: Greg Kroah-Hartman
commit b6de3b96580259012915ba5b6c3c45f39a57b227
Author: Arnd Bergmann
Date: Mon Mar 14 15:29:44 2016 +0100
lpfc: fix misleading indentation
commit aeb6641f8ebdd61939f462a8255b316f9bfab707 upstream.
gcc-6 complains about the indentation of the lpfc\_destroy\_vport\_work\_array()
call in lpfc\_online(), which clearly doesn't look right:
drivers/scsi/lpfc/lpfc\_init.c: In function 'lpfc\_online':
drivers/scsi/lpfc/lpfc\_init.c:2880:3: warning: statement is indented as if it were guarded by... [-Wmisleading-indentation]
lpfc\_destroy\_vport\_work\_array(phba, vports);
^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
drivers/scsi/lpfc/lpfc\_init.c:2863:2: note: ...this 'if' clause, but it is not
if (vports != NULL)
^~
Looking at the patch that introduced this code, it's clear that the
behavior is correct and the indentation is wrong.
This fixes the indentation and adds curly braces around the previous
if() block for clarity, as that is most likely what caused the code
to be misindented in the first place.
Signed-off-by: Arnd Bergmann
Fixes: 549e55cd2a1b ("[SCSI] lpfc 8.2.2 : Fix locking around HBA's port\_list")
Reviewed-by: Sebastian Herbszt
Reviewed-by: Hannes Reinecke
Reviewed-by: Ewan D. Milne
Signed-off-by: Martin K. Petersen
Signed-off-by: Greg Kroah-Hartman
commit fdf354707a098eb25d4097eaf9182f86d9d3bf49
Author: David Rivshin
Date: Fri Jan 29 23:26:53 2016 -0500
pwm: omap-dmtimer: Round load and match values rather than truncate
commit 7b0883f33809ff0aeca9848193c31629a752bb77 upstream.
When converting period and duty\_cycle from nanoseconds to fclk cycles,
the error introduced by the integer division can be appreciable, especially
in the case of slow fclk or short period. Use DIV\_ROUND\_CLOSEST\_ULL() so
that the error is kept to +/- 0.5 clock cycles.
Fixes: 6604c6556db9 ("pwm: Add PWM driver for OMAP using dual-mode timers")
Signed-off-by: David Rivshin
Acked-by: Neil Armstrong
Signed-off-by: Thierry Reding
Signed-off-by: Greg Kroah-Hartman
commit 3f2f96761734e73f43d0c5442c1c7a5cf028e239
Author: David Rivshin
Date: Fri Jan 29 23:26:52 2016 -0500
pwm: omap-dmtimer: Add sanity checking for load and match values
commit cd378881426379a62a7fe67f34b8cbe738302022 upstream.
Add sanity checking to ensure that we do not program load or match values
that are out of range if a user requests period or duty\_cycle values which
are not achievable. The match value cannot be less than the load value (but
can be equal), and neither can be 0xffffffff. This means that there must be
at least one fclk cycle between load and match, and another between match
and overflow.
Fixes: 6604c6556db9 ("pwm: Add PWM driver for OMAP using dual-mode timers")
Signed-off-by: David Rivshin
Acked-by: Neil Armstrong
[thierry.reding@gmail.com: minor coding style cleanups]
Signed-off-by: Thierry Reding
Signed-off-by: Greg Kroah-Hartman
commit 0b3ece4d8ba3e1d17d5cef76e1493bf6b4088a3d
Author: David Rivshin
Date: Fri Jan 29 23:26:51 2016 -0500
pwm: omap-dmtimer: Fix inaccurate period and duty cycle calculations
commit f8caa792261c0edded20eba2b8fcc899a1b91819 upstream.
Fix the calculation of load\_value and match\_value. Currently they
are slightly too low, which produces a noticeably wrong PWM rate with
sufficiently short periods (i.e. when 1/period approaches clk\_rate/2).
Example:
clk\_rate=32768Hz, period=122070ns, duty\_cycle=61035ns (8192Hz/50% PWM)
Correct values: load = 0xfffffffc, match = 0xfffffffd
Current values: load = 0xfffffffa, match = 0xfffffffc
effective PWM: period=183105ns, duty\_cycle=91553ns (5461Hz/50% PWM)
Fixes: 6604c6556db9 ("pwm: Add PWM driver for OMAP using dual-mode timers")
Signed-off-by: David Rivshin
Acked-by: Neil Armstrong
Tested-by: Adam Ford
Signed-off-by: Thierry Reding
Signed-off-by: Greg Kroah-Hartman
commit 452a55daa3653c4ada9f8f4f6dd027dc09695b15
Author: Vladimir Zapolskiy
Date: Sun Mar 6 03:21:35 2016 +0200
clk: bcm2835: fix check of error code returned by devm\_ioremap\_resource()
commit 4d3ac6662452060721599a3392bc2f524af984cb upstream.
The change fixes potential oops while accessing iomem on invalid
address, if devm\_ioremap\_resource() fails due to some reason.
The devm\_ioremap\_resource() function returns ERR\_PTR() and never
returns NULL, which makes useless a following check for NULL.
Signed-off-by: Vladimir Zapolskiy
Fixes: 5e63dcc74b30 ("clk: bcm2835: Add a driver for the auxiliary peripheral clock gates")
Reviewed-by: Eric Anholt
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit da596e76e09236a30a4e092f4d20ef780e4f3c3e
Author: Loc Ho
Date: Mon Feb 29 14:15:43 2016 -0700
clk: xgene: Add missing parenthesis when clearing divider value
commit 0f4c7a138dfefb0ebdbaf56e3ba2acd2958a6605 upstream.
In the initial fix for non-zero divider shift value, the parenthesis
was missing after the negate operation. This patch adds the required
parenthesis. Otherwise, lower bits may be cleared unintentionally.
Signed-off-by: Loc Ho
Acked-by: Toan Le
Fixes: 1382ea631ddd ("clk: xgene: Fix divider with non-zero shift value")
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit 51c822713d042b81bb455f8921e354b24677b863
Author: Chen-Yu Tsai
Date: Mon Feb 15 17:40:19 2016 +0800
clk: sunxi: Fix sun8i-a23-apb0-clk divider flags
commit 33f60d02605a3a604e56b07a78d80d7d801b2843 upstream.
The APB0 clock on A23 is a zero-based divider, not a power-of-two based
divider.
Note that this patch does not apply cleanly to kernels before 4.5-rc1,
which added CLK\_OF\_DECLARE support to this driver.
Fixes: 57a1fbf28424 ("clk: sunxi: Add A23 APB0 divider clock support")
Signed-off-by: Chen-Yu Tsai
Signed-off-by: Maxime Ripard
Signed-off-by: Greg Kroah-Hartman
commit de8ec2040e310dfc6cf15c9e60150cac4405fe64
Author: Stephen Boyd
Date: Tue Mar 1 17:26:48 2016 -0800
clk: qcom: msm8960: Fix ce3\_src register offset
commit 0f75e1a370fd843c9e508fc1ccf0662833034827 upstream.
The offset seems to have been copied from the sata clk. Fix it so
that enabling the crypto engine source clk works.
Tested-by: Srinivas Kandagatla
Tested-by: Bjorn Andersson
Fixes: 5f775498bdc4 ("clk: qcom: Fully support apq8064 global clock control")
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit f798e3ed236db3cb3b29988166c9bc3b563b10f6
Author: Linus Walleij
Date: Wed Feb 24 09:39:11 2016 +0100
clk: versatile: sp810: support reentrance
commit ec7957a6aa0aaf981fb8356dc47a2cdd01cde03c upstream.
Despite care take to allocate clocks state containers the
SP810 driver actually just supports creating one instance:
all clocks registered for every instance will end up with the
exact same name and \_\_clk\_init() will fail.
Rename the timclken<0> .. timclken to sp810\_\_
so every clock on every instance gets a unique name.
This is necessary for the RealView PBA8 which has two SP810
blocks: the second block will not register its clocks unless
every clock on every instance is unique and results in boot
logs like this:
------------[ cut here ]------------
WARNING: CPU: 0 PID: 0 at ../drivers/clk/versatile/clk-sp810.c:137
clk\_sp810\_of\_setup+0x110/0x154()
Modules linked in:
CPU: 0 PID: 0 Comm: swapper/0 Not tainted
4.5.0-rc2-00030-g352718fc39f6-dirty #225
Hardware name: ARM RealView Machine (Device Tree Support)
[] (unwind\_backtrace) from []
(show\_stack+0x10/0x14)
[] (show\_stack) from []
(dump\_stack+0x84/0x9c)
[] (dump\_stack) from []
(warn\_slowpath\_common+0x74/0xb0)
[] (warn\_slowpath\_common) from []
(warn\_slowpath\_null+0x1c/0x24)
[] (warn\_slowpath\_null) from []
(clk\_sp810\_of\_setup+0x110/0x154)
[] (clk\_sp810\_of\_setup) from []
(of\_clk\_init+0x12c/0x1c8)
[] (of\_clk\_init) from []
(time\_init+0x20/0x2c)
[] (time\_init) from []
(start\_kernel+0x244/0x3c4)
[] (start\_kernel) from [<7000807c>] (0x7000807c)
---[ end trace cb88537fdc8fa200 ]---
Cc: Michael Turquette
Cc: Pawel Moll
Fixes: 6e973d2c4385 "clk: vexpress: Add separate SP810 driver"
Signed-off-by: Linus Walleij
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit e5a3b2876a5da1038a8079986fa0162df7849714
Author: Srinivas Kandagatla
Date: Mon Feb 22 11:43:39 2016 +0000
clk: qcom: msm8960: fix ce3\_core clk enable register
commit 732d6913691848db9fabaa6a25b4d6fad10ddccf upstream.
This patch corrects the enable register offset which is actually 0x36cc
instead of 0x36c4
Signed-off-by: Srinivas Kandagatla
Fixes: 5f775498bdc4 ("clk: qcom: Fully support apq8064 global clock control")
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit 6f14af38abc3e45d13a556590afdf7db3dae4b48
Author: Andreas Färber
Date: Sun Feb 7 22:13:03 2016 +0100
clk: meson: Fix meson\_clk\_register\_clks() signature type mismatch
commit bb473593c8099302bfd7befc23de67df907e3a99 upstream.
As preparation for arm64 based mesongxbb, which pulls in this code once
enabling ARCH\_MESON, fix a size\_t vs. unsigned int type mismatch.
The loop uses a local unsigned int variable, so adopt that type,
matching the header.
Fixes: 7a29a869434e ("clk: meson: Add support for Meson clock controller")
Signed-off-by: Andreas Färber
Acked-by: Carlo Caione
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit 4f2f2e7d177ed83dda98c3248e8bf603b9558498
Author: Shawn Lin
Date: Tue Feb 2 11:37:50 2016 +0800
clk: rockchip: free memory in error cases when registering clock branches
commit 2467b6745e0ae9c6cdccff24c4cceeb14b1cce3f upstream.
Add free memeory if rockchip\_clk\_register\_branch fails.
Fixes: a245fecbb806 ("clk: rockchip: add basic infrastructure...")
Signed-off-by: Shawn Lin
Signed-off-by: Heiko Stuebner
Signed-off-by: Greg Kroah-Hartman
commit d2697f62467377bc43901145638b67887b0bcdd9
Author: Shawn Lin
Date: Tue Jan 26 11:30:18 2016 +0800
clk: rockchip: fix wrong mmc phase shift for rk3228
commit bb07698fc8d13ec74f4f5bd87b04953777ee6982 upstream.
mmc sample shift is 0 for rk3228 refer to user manaul.
So it's broken if we enable mmc tuning for rk3228.
Fixes: 307a2e9ac ("clk: rockchip: add clock controller for rk3228")
Signed-off-by: Shawn Lin
Reviewed-by: Xing Zheng
Signed-off-by: Heiko Stuebner
Signed-off-by: Greg Kroah-Hartman
commit ac322c13727a9aa0823895cddd7c6e53786b88fe
Author: Shawn Lin
Date: Mon Feb 1 16:18:40 2016 +0800
soc: rockchip: power-domain: fix err handle while probing
commit 1d961f11a108af9f7fbe89cc950a8d16ddbdbb28 upstream.
If we fail to probe the driver, we should not directly break
from the for\_each\_available\_child\_of\_node since it calls of\_node\_get
while iterating. This patch add of\_node\_put to fix the unbalanced
call pair.
Fixes: 7c696693a4f5 ("soc: rockchip: power-domain: Add power domain driver")
Signed-off-by: Shawn Lin
Signed-off-by: Heiko Stuebner
Signed-off-by: Greg Kroah-Hartman
commit a2a9208d19bd14adda6a4ab8738315b4c9b5959b
Author: Heiko Stuebner
Date: Thu Jan 21 21:53:09 2016 +0100
clk-divider: make sure read-only dividers do not write to their register
commit 50359819794b4a16ae35051cd80f2dab025f6019 upstream.
Commit e6d5e7d90be9 ("clk-divider: Fix READ\_ONLY when divider > 1") removed
the special ops struct for read-only clocks and instead opted to handle
them inside the regular ops.
On the rk3368 this results in breakage as aclkm now gets set a value.
While it is the same divider value, the A53 core still doesn't like it,
which can result in the cpu ending up in a hang.
The reason being that "ACLKENMasserts one clock cycle before the rising
edge of ACLKM" and the clock should only be touched when STANDBYWFIL2
is asserted.
To fix this, reintroduce the read-only ops but do include the round\_rate
callback. That way no writes that may be unsafe are done to the divider
register in any case.
The Rockchip use of the clk\_divider\_ops is adapted to this split again,
as is the nxp, lpc18xx-ccu driver that was included since the original
commit. On lpc18xx-ccu the divider seems to always be read-only
so only uses the new ops now.
Fixes: e6d5e7d90be9 ("clk-divider: Fix READ\_ONLY when divider > 1")
Reported-by: Zhang Qing
Signed-off-by: Heiko Stuebner
Signed-off-by: Stephen Boyd
Signed-off-by: Greg Kroah-Hartman
commit 826a816fb278289e231ac8f1eec355730ac2b592
Author: Krzysztof Halasa
Date: Fri Mar 11 12:32:14 2016 +0100
CNS3xxx: Fix PCI cns3xxx\_write\_config()
commit 88e9da9a2a70b6f1a171fbf30a681d6bc4031c4d upstream.
The "where" offset was added twice, fix it.
Signed-off-by: Krzysztof Hałasa
Fixes: 498a92d42596 ("ARM: cns3xxx: pci: avoid potential stack overflow")
Signed-off-by: Olof Johansson
Signed-off-by: Greg Kroah-Hartman
commit 3fb17a4d3e0d8760d268815f27589662fb702f4f
Author: Amitkumar Karwar
Date: Tue Feb 23 05:16:17 2016 -0800
mwifiex: fix corner case association failure
commit a6139b6271f9f95377fe3486aed6120c9142779b upstream.
This patch corrects the error case in association path by returning
-1. Earlier "media\_connected" used to remain on in this error case
causing failure for further association attempts.
Signed-off-by: Amitkumar Karwar
Fixes: b887664d882ee4 ('mwifiex: channel switch handling for station')
Signed-off-by: Cathy Luo
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit 4b758fd539dd8a40c9fafc4fae5c84932d4b1bf5
Author: Ashok Raj Nagarajan
Date: Fri Feb 5 21:12:48 2016 +0530
ath10k: fix pktlog in QCA99X0
commit 53a5c9bc53ce51f65699a43c67ab167436d28083 upstream.
Currently, we are providing wrong payload data of pktlog to trace points.
Data we receive from FW through copy engine 8 contains pktlog data alone.
We don't need to parse anything in driver before handing it to trace
points.
Fixes: afb0bf7f530b ("ath10k: add support for pktlog in QCA99X0")
Signed-off-by: Ashok Raj Nagarajan
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit 1364fd09f7f2c400df57c938761bc6fbd05e1544
Author: Andrzej Hajda
Date: Thu Jan 7 14:28:50 2016 +0100
wlcore: fix error handling in wlcore\_event\_fw\_logger
commit 68f37e5d7a2e00306adab033fba6c3042b33e8e1 upstream.
wlcore\_read/wlcore\_write can return negative values so it should
be assigned to signed variable.
The problem has been detected using proposed semantic patch
scripts/coccinelle/tests/unsigned\_lesser\_than\_zero.cocci [1].
[1]: http://permalink.gmane.org/gmane.linux.kernel/2120705
Fixes: 3719c17e1816 ("wlcore/wl18xx: fw logger over sdio")
Signed-off-by: Andrzej Hajda
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit f0ffb73b2c569cdd2ac40be762981ff69d508800
Author: Dan Carpenter
Date: Thu Mar 10 10:45:32 2016 +0300
ata: ahci\_xgene: dereferencing uninitialized pointer in probe
commit 8134233e8d346aaa1c929dc510e75482ae318bce upstream.
If the call to acpi\_get\_object\_info() fails then "info" hasn't been
initialized. In that situation, we already know that "version" should
be XGENE\_AHCI\_V1 so we don't actually need to dereference "info".
Fixes: c9802a4be661 ('ata: ahci\_xgene: Add AHCI Support for 2nd HW version of APM X-Gene SoC AHCI SATA Host controller.')
Signed-off-by: Dan Carpenter
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit c44c5c623b797503f31c2f2a9b366eee74a0677c
Author: Wenwei Tao
Date: Sat Mar 5 00:27:04 2016 +0800
null\_blk: add lightnvm null\_blk device to the nullb\_list
commit 3681c85dffda70e551dead31c8d102bd69033fe8 upstream.
After register null\_blk devices into lightnvm, we forget
to add these devices to the the nullb\_list, makes them
invisible to the null\_blk driver.
Signed-off-by: Wenwei Tao
Fixes: a514379b0c77 ("null\_blk: oops when initializing without lightnvm")
Signed-off-by: Jens Axboe
Signed-off-by: Greg Kroah-Hartman
commit 3ebb655a6aa716086e1234b37683c8091832a4f0
Author: Javier González
Date: Sat Feb 20 08:52:40 2016 +0100
lightnvm: update closed list outside of intr context
commit 6adb03de406e8c92579c2e4b11640841fa908277 upstream.
When an I/O finishes, full blocks are moved from the open to the closed
list - a lock is taken to protect the list. This happens at the moment
in the interrupt context, which is not correct.
This patch moves this logic to the block workqueue instead, avoiding
holding a spinlock without interrupt save in an interrupt context.
Signed-off-by: Javier González
Fixes: ff0e498bfa18 ("lightnvm: manage open and closed blocks sepa...")
Signed-off-by: Matias Bjørling
Signed-off-by: Jens Axboe
Signed-off-by: Greg Kroah-Hartman
commit cf06fea41cd4e5f1fa1b584b830c6b9b0cdf291d
Author: Dan Streetman
Date: Thu Jan 14 13:42:32 2016 -0500
nbd: ratelimit error msgs after socket close
commit da6ccaaa79caca4f38b540b651238f87215217a2 upstream.
Make the "Attempted send on closed socket" error messages generated in
nbd\_request\_handler() ratelimited.
When the nbd socket is shutdown, the nbd\_request\_handler() function emits
an error message for every request remaining in its queue. If the queue
is large, this will spam a large amount of messages to the log. There's
no need for a separate error message for each request, so this patch
ratelimits it.
In the specific case this was found, the system was virtual and the error
messages were logged to the serial port, which overwhelmed it.
Fixes: 4d48a542b427 ("nbd: fix I/O hang on disconnected nbds")
Signed-off-by: Dan Streetman
Signed-off-by: Markus Pargmann
Signed-off-by: Greg Kroah-Hartman
commit 318ff841ff1dee3a2572b9efaab243aed896b64e
Author: Andy Shevchenko
Date: Fri Jan 22 16:48:46 2016 +0200
mfd: intel-lpss: Remove clock tree on error path
commit 84cb36cac581c915ef4e8b70abb73e084325df92 upstream.
We forgot to remove the clock tree if something goes wrong in ->probe(). Add a
call to intel\_lpss\_unregister\_clock() on error path in ->probe() to fix the
potential issue.
Fixes: 4b45efe85263 (mfd: Add support for Intel Sunrisepoint LPSS devices)
Signed-off-by: Andy Shevchenko
Acked-by: Mika Westerberg
Signed-off-by: Lee Jones
Signed-off-by: Greg Kroah-Hartman
commit 7bbda3d4ec7a9f989fa0f43669698928adc3cc39
Author: Larry Finger
Date: Thu Feb 25 11:03:01 2016 -0600
rtlwifi: Fix size of wireless mode variable
commit 73fb270592164b1917442f8bff4c791d095ee2ef upstream.
Smatch reports the following warning:
CHECK drivers/net/wireless/realtek/rtlwifi/rc.c
drivers/net/wireless/realtek/rtlwifi/rc.c:144 \_rtl\_rc\_rate\_set\_series() warn: impossible condition '(wireless\_mode == 256) => (0-255 == 256)'
This warning arises because commit acc6907b87a9 ("rtlwifi: Fix warning
from ieee80211\_get\_tx\_rates() when using 5G") now checks the wireless
mode for WIRELESS\_MODE\_AC\_ONLY (BIT(8)) in \_rtl\_rc\_rate\_set\_series().
As a result, all quantities used to store the wireless mode must be u16.
This patch also reorders struct rtl\_sta\_info to save a little space.
Fixes: d76d65fd2695 ("rtlwifi: fix broken VHT support")
Reported-by: Dan Williams
Signed-off-by: Larry Finger
Signed-off-by: Kalle Valo
Signed-off-by: Greg Kroah-Hartman
commit 4920ee6f309009d122f929c0aaae47464e413eb9
Author: Julian Anastasov
Date: Sat Mar 5 15:03:22 2016 +0200
ipvs: drop first packet to redirect conntrack
commit f719e3754ee2f7275437e61a6afd520181fdd43b upstream.
Jiri Bohac is reporting for a problem where the attempt
to reschedule existing connection to another real server
needs proper redirect for the conntrack used by the IPVS
connection. For example, when IPVS connection is created
to NAT-ed real server we alter the reply direction of
conntrack. If we later decide to select different real
server we can not alter again the conntrack. And if we
expire the old connection, the new connection is left
without conntrack.
So, the only way to redirect both the IPVS connection and
the Netfilter's conntrack is to drop the SYN packet that
hits existing connection, to wait for the next jiffie
to expire the old connection and its conntrack and to rely
on client's retransmission to create new connection as
usually.
Jiri Bohac provided a fix that drops all SYNs on rescheduling,
I extended his patch to do such drops only for connections
that use conntrack. Here is the original report from Jiri Bohac:
Since commit dc7b3eb900aa ("ipvs: Fix reuse connection if real server
is dead"), new connections to dead servers are redistributed
immediately to new servers. The old connection is expired using
ip\_vs\_conn\_expire\_now() which sets the connection timer to expire
immediately.
However, before the timer callback, ip\_vs\_conn\_expire(), is run
to clean the connection's conntrack entry, the new redistributed
connection may already be established and its conntrack removed
instead.
Fix this by dropping the first packet of the new connection
instead, like we do when the destination server is not available.
The timer will have deleted the old conntrack entry long before
the first packet of the new connection is retransmitted.
Fixes: dc7b3eb900aa ("ipvs: Fix reuse connection if real server is dead")
Signed-off-by: Jiri Bohac
Signed-off-by: Julian Anastasov
Signed-off-by: Simon Horman
Signed-off-by: Greg Kroah-Hartman
commit 3ed30f36fe42d7a88d7020e55d7a85ab27687126
Author: Marco Angaroni
Date: Sat Mar 5 12:10:02 2016 +0100
ipvs: correct initial offset of Call-ID header search in SIP persistence engine
commit 7617a24f83b5d67f4dab1844956be1cebc44aec8 upstream.
The IPVS SIP persistence engine is not able to parse the SIP header
"Call-ID" when such header is inserted in the first positions of
the SIP message.
When IPVS is configured with "--pe sip" option, like for example:
ipvsadm -A -u 1.2.3.4:5060 -s rr --pe sip -p 120 -o
some particular messages (see below for details) do not create entries
in the connection template table, which can be listed with:
ipvsadm -Lcn --persistent-conn
Problematic SIP messages are SIP responses having "Call-ID" header
positioned just after message first line:
SIP/2.0 200 OK
[Call-ID header here]
[rest of the headers]
When "Call-ID" header is positioned down (after a few other headers)
it is correctly recognized.
This is due to the data offset used in get\_callid function call inside
ip\_vs\_pe\_sip.c file: since dptr already points to the start of the
SIP message, the value of dataoff should be initially 0.
Otherwise the header is searched starting from some bytes after the
first character of the SIP message.
Fixes: 758ff0338722 ("IPVS: sip persistence engine")
Signed-off-by: Marco Angaroni
Acked-by: Julian Anastasov
Signed-off-by: Simon Horman
Signed-off-by: Greg Kroah-Hartman
commit 12bd7b2817dc5de5fc1bd979a9e9c2db1828551e
Author: Arnd Bergmann
Date: Wed Jan 27 14:52:02 2016 +0100
ipvs: handle ip\_vs\_fill\_iph\_skb\_off failure
commit 3f20efba41916ee17ce82f0fdd02581ada2872b2 upstream.
ip\_vs\_fill\_iph\_skb\_off() may not find an IP header, and gcc has
determined that ip\_vs\_sip\_fill\_param() then incorrectly accesses
the protocol fields:
net/netfilter/ipvs/ip\_vs\_pe\_sip.c: In function 'ip\_vs\_sip\_fill\_param':
net/netfilter/ipvs/ip\_vs\_pe\_sip.c:76:5: error: 'iph.protocol' may be used uninitialized in this function [-Werror=maybe-uninitialized]
if (iph.protocol != IPPROTO\_UDP)
^
net/netfilter/ipvs/ip\_vs\_pe\_sip.c:81:10: error: 'iph.len' may be used uninitialized in this function [-Werror=maybe-uninitialized]
dataoff = iph.len + sizeof(struct udphdr);
^
This adds a check for the ip\_vs\_fill\_iph\_skb\_off() return code
before looking at the ip header data returned from it.
Signed-off-by: Arnd Bergmann
Fixes: b0e010c527de ("ipvs: replace ip\_vs\_fill\_ip4hdr with ip\_vs\_fill\_iph\_skb\_off")
Acked-by: Julian Anastasov
Signed-off-by: Simon Horman
Signed-off-by: Greg Kroah-Hartman
commit 0123127c7f11f0b91bbfe7f71d845b2249a0d062
Author: Leon Romanovsky
Date: Tue Feb 23 10:25:21 2016 +0200
net/mlx5\_core: Fix caching ATOMIC endian mode capability
commit 91d9ed8443b88cc50b81cf5ec900172515270f6f upstream.
Add caching of maximum device capability of ATOMIC endian mode.
Fixes: f91e6d8941bf ('net/mlx5\_core: Add setting ATOMIC endian mode')
Signed-off-by: Leon Romanovsky
Reviewed-by: Saeed Mahameed
Signed-off-by: Doug Ledford
Signed-off-by: Greg Kroah-Hartman
commit 2b2da6e18561efbd763659fd0ff1dfb9dd54873e
Author: Hariprasad S
Date: Tue Apr 5 10:23:48 2016 +0530
RDMA/iw\_cxgb4: Fix bar2 virt addr calculation for T4 chips
commit 32cc92c7b5e52357a0a24010bae9eb257fa75d3e upstream.
For T4, kernel mode qps don't use the user doorbell. User mode qps during
flow control db ringing are forced into kernel, where user doorbell is
treated as kernel doorbell and proper bar2 offset in bar2 virtual space is
calculated, which incase of T4 is a bogus address, causing a kernel panic
due to illegal write during doorbell ringing.
In case of T4, kernel mode qp bar2 virtual address should be 0. Added T4
check during bar2 virtual address calculation to return 0. Fixed Bar2
range checks based on bar2 physical address.
The below oops will be fixed
<1>BUG: unable to handle kernel paging request at 000000000002aa08
<1>IP: [] c4iw\_uld\_control+0x4e0/0x880 [iw\_cxgb4]
<4>PGD 1416a8067 PUD 15bf35067 PMD 0
<4>Oops: 0002 [#1] SMP
<4>last sysfs file:
/sys/devices/pci0000:00/0000:00:03.0/0000:02:00.4/infiniband/cxgb4\_0/node\_guid
<4>CPU 5
<4>Modules linked in: rdma\_ucm rdma\_cm ib\_cm ib\_sa ib\_mad ib\_uverbs
ip6table\_filter ip6\_tables ebtable\_nat ebtables ipt\_MASQUERADE
iptable\_nat nf\_nat nf\_conntrack\_ipv4 nf\_defrag\_ipv4 xt\_state nf\_conntrack
ipt\_REJECT xt\_CHECKSUM iptable\_mangle iptable\_filter ip\_tables bridge autofs4
target\_core\_iblock target\_core\_file target\_core\_pscsi target\_core\_mod
configfs bnx2fc cnic uio fcoe libfcoe libfc scsi\_transport\_fc scsi\_tgt 8021q
garp stp llc cpufreq\_ondemand acpi\_cpufreq freq\_table mperf vhost\_net macvtap
macvlan tun kvm uinput microcode iTCO\_wdt iTCO\_vendor\_support sg joydev
serio\_raw i2c\_i801 i2c\_core lpc\_ich mfd\_core e1000e ptp pps\_core ioatdma dca
i7core\_edac edac\_core shpchp ext3 jbd mbcache sd\_mod crc\_t10dif pata\_acpi
ata\_generic ata\_piix iw\_cxgb4 iw\_cm ib\_core ib\_addr cxgb4 ipv6 dm\_mirror
dm\_region\_hash dm\_log dm\_mod [last unloaded: scsi\_wait\_scan]
<4>
Supermicro X8ST3/X8ST3
<4>RIP: 0010:[] []
c4iw\_uld\_control+0x4e0/0x880 [iw\_cxgb4]
<4>RSP: 0000:ffff880155a03db0 EFLAGS: 00010006
<4>RAX: 000000000000001d RBX: ffff88013ae5fc00 RCX: ffff880155adb180
<4>RDX: 000000000002aa00 RSI: 0000000000000001 RDI: ffff88013ae5fdf8
<4>RBP: ffff880155a03e10 R08: 0000000000000000 R09: 0000000000000001
<4>R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000000
<4>R13: 000000000000001d R14: ffff880156414ab0 R15: ffffe8ffffc05b88
<4>FS: 0000000000000000(0000) GS:ffff8800282a0000(0000) knlGS:0000000000000000
<4>CS: 0010 DS: 0018 ES: 0018 CR0: 000000008005003b
<4>CR2: 000000000002aa08 CR3: 000000015bd0e000 CR4: 00000000000007e0
<4>DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
<4>DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
<4>Process cxgb4 (pid: 394, threadinfo ffff880155a00000, task ffff880156414ab0)
<4>Stack:
<4> ffff880156415068 ffff880155adb180 ffff880155a03df0 ffffffffa00a344b
<4> 00000000000003e8 ffff880155920000 0000000000000004 ffff880155920000
<4> ffff88015592d438 ffffffffa00a3860 ffff880155a03fd8 ffffe8ffffc05b88
<4>Call Trace:
<4> [] ? enable\_txq\_db+0x2b/0x80 [cxgb4]
<4> [] ? process\_db\_full+0x0/0xa0 [cxgb4]
<4> [] process\_db\_full+0x46/0xa0 [cxgb4]
<4> [] worker\_thread+0x170/0x2a0
<4> [] ? autoremove\_wake\_function+0x0/0x40
<4> [] ? worker\_thread+0x0/0x2a0
<4> [] kthread+0x9e/0xc0
<4> [] child\_rip+0xa/0x20
<4> [] ? kthread+0x0/0xc0
<4> [] ? child\_rip+0x0/0x20
<4>Code: e9 ba 00 00 00 66 0f 1f 44 00 00 44 8b 05 29 07 02 00 45 85 c0 0f 85
71 02 00 00 8b 83 70 01 00 00 45 0f b7 ed c1 e0 0f 44 09 e8 <89> 42 08 0f ae f8
66 c7 83 82 01 00 00 00 00 44 0f b7 ab dc 01
<1>RIP [] c4iw\_uld\_control+0x4e0/0x880 [iw\_cxgb4]
<4> RSP
<4>CR2: 000000000002aa08`
Based on original work by Bharat Potnuri
Fixes: 74217d4c6a4fb0d8 ("iw\_cxgb4: support for bar2 qid densities exceeding the page size")
Signed-off-by: Steve Wise
Signed-off-by: Hariprasad Shenai
Reviewed-by: Leon Romanovsky
Signed-off-by: Doug Ledford
Signed-off-by: Greg Kroah-Hartman
commit 42ff5fc8661040f37a67a4a95c231f6765d6f59c
Author: Daniel Lezcano
Date: Tue Apr 19 15:43:02 2016 +0200
clocksource/drivers/tango-xtal: Fix boot hang due to incorrect test
commit 16eeed7e5558a3dcf30f75526a896b2632f299f9 upstream.
Commit 0881841f7e78 introduced a regression by inverting a test check
after calling clocksource\_mmio\_init(). That results on the system to
hang at boot time.
Fix it by inverting the test again.
Fixes: 0881841f7e78 ("Replace code by clocksource\_mmio\_init")
Reported-by: Marc Gonzalez
Signed-off-by: Daniel Lezcano
Signed-off-by: Greg Kroah-Hartman


=== Content from forums.grsecurity.net_438f3191_20250124_220223.html ===


# grsecurity forums

[Skip to content](#start_here)

[Advanced search](./search.php?sid=f4637e9e20e3ba2bbc4c49170751616f "View the advanced search options")

* [Board index](./index.php?sid=f4637e9e20e3ba2bbc4c49170751616f) **‹** [grsecurity](./viewforum.php?f=6&sid=f4637e9e20e3ba2bbc4c49170751616f) **‹** [grsecurity support](./viewforum.php?f=3&sid=f4637e9e20e3ba2bbc4c49170751616f)
* Change font size
* [Print view](./viewtopic.php?f=3&t=4363&sid=f4637e9e20e3ba2bbc4c49170751616f&view=print "Print view")

* [FAQ](./faq.php?sid=f4637e9e20e3ba2bbc4c49170751616f "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&sid=f4637e9e20e3ba2bbc4c49170751616f "Login")

## [PAX: size overflow in function environ\_read fs/proc/base.c](./viewtopic.php?f=3&t=4363&sid=f4637e9e20e3ba2bbc4c49170751616f)

Discuss usability issues, general maintenance, and general support issues for a grsecurity-enabled system.

[Topic locked](./posting.php?mode=reply&f=3&t=4363&sid=f4637e9e20e3ba2bbc4c49170751616f "This topic is locked, you cannot edit posts or make further replies.")

15 posts
• Page **1** of **1**

* [Reply with quote](./posting.php?mode=quote&f=3&p=15967&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [PAX: size overflow in function environ\_read fs/proc/base.c](#p15967)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15967&sid=f4637e9e20e3ba2bbc4c49170751616f#p15967)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 4:29 am

Using Gentoo-s hardened-sources (4.2.6-r8 and 4.3.3-r4):

Code: Select all`PAX: size overflow detected in function environ_read fs/proc/base.c:1067 cicus.472_265 min, count: 58, decl: access_remote_vm; num: 4; context: fndecl; /usr/bin/ldd[ldd:24710] uid/euid:0/0 gid/egid:0/0
CPU: 4 PID: 2522 Comm: ps Not tainted 4.2.6-hardened-r8 #1tr.so.1.1.0.debug by /lib64/ld-2.21.so[ld-linux-x86-64:24718] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/ldd[ldd:24716] uid/euid:0/0 gid/egid:0/0
 ffffffff81805c83 b24ca701ca6321a0 0000000000000000 ffffffff816723cf.0.debug by /lib64/ld-2.21.so[ld-linux-x86-64:24724] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/ldd[ldd:24722] uid/euid:0/0 gid/egid:0/0
 ffffc90007ffbc48 ffffffff8152feb7 0000000000000097 ffffffff8167246d-2.21.so.debug by /lib64/ld-2.21.so[ld-linux-x86-64:24730] uid/euid:0/0 gid/egid:0/0, parent /usr/bin/ldd[ldd:24728] uid/euid:0/0 gid/egid:0/0
 ffffc90007ffbc78 ffffffff81139f96 0000000000000000 0000000000000000
Call Trace:
 [<ffffffff8152feb7>] dump_stack+0x45/0x5d
 [<ffffffff81139f96>] report_size_overflow+0x36/0x40
 [<ffffffff811938f5>] environ_read+0x3a5/0x4f0
 [<ffffffff811306dd>] __vfs_read+0x5d/0x140
 [<ffffffff8126518b>] ? security_file_permission+0xbb/0xd0
 [<ffffffff81130893>] vfs_read+0xd3/0x240
 [<ffffffff81130f7c>] SyS_read+0x5c/0xe0
 [<ffffffff81534eb0>] entry_SYSCALL_64_fastpath+0x12/0x8a`

Code: Select all`PAX: size overflow detected in function environ_read fs/proc/base.c:1064 cicus.503_265 min, count: 54, decl: access_remote_vm; num: 4; context: fndecl;
CPU: 0 PID: 18410 Comm: ps Not tainted 4.3.3-hardened-r4 #1
 ffffffff00000002 14080fbf382ba2a6 0000000000000000 0000000000000428
 ffffc90003bcbc20 ffffffff812c27b8 ffffffff816912de ffffc90003bcbc50
 ffffffff8114397e 0000000000000000 0000000000000000 fffffc68e816d818
Call Trace:
 [<ffffffff812c27b8>] dump_stack+0x44/0x5c
 [<ffffffff8114397e>] report_size_overflow+0x6e/0x80
 [<ffffffff811a00d3>] environ_read+0x3b3/0x510
 [<ffffffff81139e96>] __vfs_read+0x56/0x130
 [<ffffffff81276ff8>] ? security_file_permission+0xc8/0xe0
 [<ffffffff8113a044>] vfs_read+0xd4/0x250
 [<ffffffff8113a735>] SyS_read+0x55/0xd0
 [<ffffffff81550ff0>] entry_SYSCALL_64_fastpath+0x12/0x8a`

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=15973&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p15973)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15973&sid=f4637e9e20e3ba2bbc4c49170751616f#p15973)by **[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 1:31 pm

Could you please send me the results (fs/proc/base.\*) of make fs/proc/base.o EXTRA\_CFLAGS="-fdump-tree-all -fdump-ipa-all" and your kernel .config?
Which gcc version did you use?

[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 134**Joined:** Tue Mar 20, 2012 4:36 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=15974&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p15974)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15974&sid=f4637e9e20e3ba2bbc4c49170751616f#p15974)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 3:06 pm

You can find the fs/proc/base.\* files [here](https://paste.xinu.at/M0AiD9qSgAsOiV/), no .config. GCC version 4.9.3.

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=15975&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p15975)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15975&sid=f4637e9e20e3ba2bbc4c49170751616f#p15975)by **[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 5:06 pm

Could you please apply this patch (4.3.3) and send me the result from dmesg?
Code: Select all`--- fs/proc/base.c.orig 2016-01-19 22:01:14.699210722 +0100
+++ fs/proc/base.c      2016-01-19 22:05:22.467199676 +0100
@@ -1061,6 +1061,7 @@
                this_len = mm->env_end - (mm->env_start + src);

                max_len = min_t(size_t, PAGE_SIZE, count);
+               printk(KERN_ERR "PAX environ_read: env_end: %lx, mm->env_start: %lx, src: %lx, count: %lx\n", mm->env_end, mm->env_start, src, count);
                this_len = min(max_len, this_len);

                retval = access_remote_vm(mm, (mm->env_start + src),`

[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 134**Joined:** Tue Mar 20, 2012 4:36 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=15976&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p15976)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15976&sid=f4637e9e20e3ba2bbc4c49170751616f#p15976)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 7:36 pm

Last time this overflow happened was after 12 days of uptime for that VM. I usually reboot it more frequently, so patching and trying to reproduce the bug will likely take too much time for me. Sorry!

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=15977&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p15977)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=15977&sid=f4637e9e20e3ba2bbc4c49170751616f#p15977)by **[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Jan 19, 2016 8:19 pm

> jotik wrote:Last time this overflow happened was after 12 days of uptime for that VM. I usually reboot it more frequently, so patching and trying to reproduce the bug will likely take too much time for me. Sorry!

I see. But I didn't find the bug so I don't know how to fix it. It could be a real bug not a false positive ![;)](./images/smilies/icon_wink.gif)

[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 134**Joined:** Tue Mar 20, 2012 4:36 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16146&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16146)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16146&sid=f4637e9e20e3ba2bbc4c49170751616f#p16146)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Mar 22, 2016 4:08 am

Happened again with 4.4.4, for which I didn't to apply the patch... ![:-?](./images/smilies/icon_confused.gif)
Code: Select all`[343779.647418] PAX: size overflow detected in function environ_read /usr/src/linux-4.4.4-hardened/fs/proc/base.c:1064 cicus.477_287 min, count: 54, decl: access_remote_vm; num: 4; context: fndecl;
[343779.647926] CPU: 5 PID: 7976 Comm: ps Not tainted 4.4.4-hardened #1
[343779.647929]  797c830700000002 797c8307d0c10909 0000000000000286 0000000000000000
[343779.647934]  ffffc90001aebc10 ffffffff812ca75a 0000000000000000 797c8307d0c10909
[343779.647937]  ffffffff816aa870 0000000000000428 ffffc90001aebc40 ffffffff8114a8ce
[343779.647941] Call Trace:
[343779.647948]  [<ffffffff812ca75a>] dump_stack+0x76/0xbc
[343779.647953]  [<ffffffff8114a8ce>] report_size_overflow+0x6e/0x80
[343779.647957]  [<ffffffff811a7041>] environ_read+0x3b1/0x510
[343779.647961]  [<ffffffff81140d77>] __vfs_read+0x57/0x140
[343779.647965]  [<ffffffff8127ddb8>] ? security_file_permission+0xc8/0xe0
[343779.647969]  [<ffffffff81140f23>] vfs_read+0xc3/0x250
[343779.647972]  [<ffffffff8114163c>] SyS_read+0x5c/0xd0
[343779.647977]  [<ffffffff8155cd30>] entry_SYSCALL_64_fastpath+0x12/0x8a`

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16147&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16147)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16147&sid=f4637e9e20e3ba2bbc4c49170751616f#p16147)by **[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Mar 22, 2016 7:17 am

Thanks for the report, but I need the printk output before I can fix this.

[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 134**Joined:** Tue Mar 20, 2012 4:36 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16197&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16197)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16197&sid=f4637e9e20e3ba2bbc4c49170751616f#p16197)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Tue Apr 12, 2016 3:43 am

Code: Select all`... after many previous similar debug messages ...
[37315.188078] PAX environ_read: env_end: 38b2728fbf8, mm->env_start: 38b2728f4ed, src: 0, count: 7ff
[37315.188218] PAX environ_read: env_end: 382858f104b, mm->env_start: 382858f0929, src: 0, count: 7ff
[37315.188715] PAX environ_read: env_end: 0, mm->env_start: 39cf59b19ca, src: 0, count: 7ff
[37315.188717] PAX: size overflow detected in function environ_read fs/proc/base.c:1065 cicus.479_290 min, count: 54, decl: access_remote_vm; num: 4; context: fndecl;
[37315.189082] CPU: 5 PID: 20991 Comm: ps Not tainted 4.4.6-hardened-r1 #2
[37315.189083]  28c16bdf00000002 28c16bdf5c6fdc95 0000000000000286 0000000000000000
[37315.189085]  ffffc90003aa3c80 ffffffff812c9e2a 0000039cf59b19ca 28c16bdf5c6fdc95
[37315.189087]  ffffffff816a08ef 0000000000000429 ffffc90003aa3cb0 ffffffff8114a47e
[37315.189088] Call Trace:
[37315.189092]  [<ffffffff812c9e2a>] dump_stack+0x76/0xbc
[37315.189095]  [<ffffffff8114a47e>] report_size_overflow+0x6e/0x80
[37315.189097]  [<ffffffff811a6dac>] environ_read+0x38c/0x5b0
[37315.189100]  [<ffffffff81140a07>] __vfs_read+0x57/0x130
[37315.189102]  [<ffffffff8127d4db>] ? security_file_permission+0xbb/0xd0
[37315.189104]  [<ffffffff81140ba3>] vfs_read+0xc3/0x240
[37315.189108]  [<ffffffff81141279>] SyS_read+0x59/0xd0
[37315.189111]  [<ffffffff8155c670>] entry_SYSCALL_64_fastpath+0x12/0x8a
[45519.802369] PAX environ_read: env_end: 39b3e125fd5, mm->env_start: 39b3e1258ca, src: 0, count: 7ff
[45519.802531] PAX environ_read: env_end: 3ae9efb655f, mm->env_start: 3ae9efb5e3d, src: 0, count: 7ff
[45519.802722] PAX environ_read: env_end: 3cdd8d85f12, mm->env_start: 3cdd8d857ef, src: 0, count: 7ff
... more of these debug messages follow ...`

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16200&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16200)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16200&sid=f4637e9e20e3ba2bbc4c49170751616f#p16200)by **[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Fri Apr 15, 2016 2:27 pm

I think it is a real bug, env\_end can't be 0. Could you please report it to upstream?

[ephox](./memberlist.php?mode=viewprofile&u=5414&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 134**Joined:** Tue Mar 20, 2012 4:36 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16201&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16201)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16201&sid=f4637e9e20e3ba2bbc4c49170751616f#p16201)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Fri Apr 15, 2016 2:42 pm

Reported to upstream Kernel Bug Tracker as [Bug 116461](https://bugzilla.kernel.org/show_bug.cgi?id=116461). I won't waste my time on their mailing lists.

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16217&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16217)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16217&sid=f4637e9e20e3ba2bbc4c49170751616f#p16217)by **[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Sat Apr 23, 2016 3:54 am

I guess your application is reading /proc/PID/environ of a not yet fully initialized process so env\_end can, in fact, be zero in this case (see fs/binfmt\_elf.c:create\_elf\_tables(), it sets env\_end last).

Other places facing the same problem simply test the variable to be non-zero to test if 'mm' is ready for inspection, e.g. fs/proc/base.c:proc\_pid\_cmdline\_read() or mm/util.c:get\_cmdline()). So, I'd say, just do so here as well.

Can you try the following patch, please?:

Code: Select all`diff --git a/fs/proc/base.c b/fs/proc/base.c
index 417bafef0012..c1235e2e6b63 100644
--- a/fs/proc/base.c
+++ b/fs/proc/base.c
@@ -1034,7 +1034,7 @@ static ssize_t environ_read(struct file *file, char __user *buf,
        int ret = 0;
        struct mm_struct *mm = file->private_data;

-       if (!mm)
+       if (!mm || !mm->env_end)
                return 0;

 #ifdef CONFIG_GRKERNSEC_PROC_MEMMAP`

But Emese is right, this looks like an upstream bug that should probably be fixed there as well.

[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 21**Joined:** Mon Jan 03, 2011 6:39 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16218&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16218)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16218&sid=f4637e9e20e3ba2bbc4c49170751616f#p16218)by **[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Sat Apr 23, 2016 6:46 am

\*shrugs\*

I don't have a reliable means to trigger this code path. If I apply the patch and the PAX size overflow plugin doesn't trigger for N days, then what do you suppose that would tell us? That it compiled? ![8)](./images/smilies/icon_cool.gif)

[jotik](./memberlist.php?mode=viewprofile&u=7527&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 22**Joined:** Mon Oct 19, 2015 5:11 am

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16219&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16219)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16219&sid=f4637e9e20e3ba2bbc4c49170751616f#p16219)by **[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Sat Apr 23, 2016 7:45 am

It'll ensure the condition that triggers the size overflow won't happen -- assuming it compiles ![;)](./images/smilies/icon_wink.gif)

[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 21**Joined:** Mon Jan 03, 2011 6:39 pm

[Top](#wrap "Top")

---

* [Reply with quote](./posting.php?mode=quote&f=3&p=16220&sid=f4637e9e20e3ba2bbc4c49170751616f "Reply with quote")

### [Re: PAX: size overflow in function environ\_read fs/proc/base](#p16220)

[![Post](./styles/prosilver/imageset/icon_post_target.gif "Post")](./viewtopic.php?p=16220&sid=f4637e9e20e3ba2bbc4c49170751616f#p16220)by **[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)** » Sat Apr 23, 2016 7:52 am

Btw., here's a way to reproduce the size overflow fast:
Code: Select all`$ while : ; do cat /proc/*/environ >/dev/null 2>&1; done &
$ for i in $(seq 16); do export FOO$i="$(dd if=/dev/urandom bs=16k count=1 2>&1 | hexdump -C)"; done
$ while : ; do /bin/true; done`

Without the patch the size overflow triggered in the second loop already. With the patch it survived for around 15 minutes so far ![;)](./images/smilies/icon_wink.gif)

[minipli](./memberlist.php?mode=viewprofile&u=4813&sid=f4637e9e20e3ba2bbc4c49170751616f)

**Posts:** 21**Joined:** Mon Jan 03, 2011 6:39 pm

[Top](#wrap "Top")

---

Display posts from previous: All posts1 day7 days2 weeks1 month3 months6 months1 year
Sort by AuthorPost timeSubject AscendingDescending

---

[Topic locked](./posting.php?mode=reply&f=3&t=4363&sid=f4637e9e20e3ba2bbc4c49170751616f "This topic is locked, you cannot edit posts or make further replies.")

15 posts
• Page **1** of **1**

[Return to grsecurity support](./viewforum.php?f=3&sid=f4637e9e20e3ba2bbc4c49170751616f)

Jump to:
Select a forum
------------------
grsecurity
   grsecurity development
   grsecurity support
   RBAC policy development
   grsecurity paid kernel support
Blog

* [Board index](./index.php?sid=f4637e9e20e3ba2bbc4c49170751616f)
* [The team](./memberlist.php?mode=leaders&sid=f4637e9e20e3ba2bbc4c49170751616f) • [Delete all board cookies](./ucp.php?mode=delete_cookies&sid=f4637e9e20e3ba2bbc4c49170751616f) • All times are UTC - 5 hours [ DST ]

Powered by [phpBB](https://www.phpbb.com/)® Forum Software © phpBB Group

![cron](./cron.php?cron_type=tidy_search&sid=f4637e9e20e3ba2bbc4c49170751616f)



=== Content from git.kernel.org_956a2c39_20250124_220154.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Mathias Krause <minipli@googlemail.com> | 2016-05-05 16:22:26 -0700 |
| --- | --- | --- |
| committer | Linus Torvalds <torvalds@linux-foundation.org> | 2016-05-05 17:38:53 -0700 |
| commit | [8148a73c9901a8794a50f950083c00ccf97d43b3](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8148a73c9901a8794a50f950083c00ccf97d43b3) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)) | |
| tree | [8b26dcbaa5d0dc9320342e4e950adfc53dee0bbc](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=8148a73c9901a8794a50f950083c00ccf97d43b3) | |
| parent | [32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8148a73c9901a8794a50f950083c00ccf97d43b3&id2=32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc)) | |
| download | [linux-8148a73c9901a8794a50f950083c00ccf97d43b3.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-8148a73c9901a8794a50f950083c00ccf97d43b3.tar.gz) | |

proc: prevent accessing /proc/<PID>/environ until it's readyIf /proc/<PID>/environ gets read before the envp[] array is fully set up
in create\_{aout,elf,elf\_fdpic,flat}\_tables(), we might end up trying to
read more bytes than are actually written, as env\_start will already be
set but env\_end will still be zero, making the range calculation
underflow, allowing to read beyond the end of what has been written.
Fix this as it is done for /proc/<PID>/cmdline by testing env\_end for
zero. It is, apparently, intentionally set last in create\_\*\_tables().
This bug was found by the PaX size\_overflow plugin that detected the
arithmetic underflow of 'this\_len = env\_end - (env\_start + src)' when
env\_end is still zero.
The expected consequence is that userland trying to access
/proc/<PID>/environ of a not yet fully set up process may get
inconsistent data as we're in the middle of copying in the environment
variables.
Fixes: https://forums.grsecurity.net/viewtopic.php?f=3&t=4363
Fixes: https://bugzilla.kernel.org/show\_bug.cgi?id=116461
Signed-off-by: Mathias Krause <minipli@googlemail.com>
Cc: Emese Revfy <re.emese@gmail.com>
Cc: Pax Team <pageexec@freemail.hu>
Cc: Al Viro <viro@zeniv.linux.org.uk>
Cc: Mateusz Guzik <mguzik@redhat.com>
Cc: Alexey Dobriyan <adobriyan@gmail.com>
Cc: Cyrill Gorcunov <gorcunov@openvz.org>
Cc: Jarod Wilson <jarod@redhat.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=8148a73c9901a8794a50f950083c00ccf97d43b3)

| -rw-r--r-- | [fs/proc/base.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/fs/proc/base.c?id=8148a73c9901a8794a50f950083c00ccf97d43b3) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/fs/proc/base.c b/fs/proc/base.cindex b1755b23893e5e..92e37e224cd22d 100644--- a/[fs/proc/base.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/fs/proc/base.c?id=32a4e169039927bfb6ee9f0ccbbe3a8aaf13a4bc)+++ b/[fs/proc/base.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/fs/proc/base.c?id=8148a73c9901a8794a50f950083c00ccf97d43b3)@@ -955,7 +955,8 @@ static ssize\_t environ\_read(struct file \*file, char \_\_user \*buf, struct mm\_struct \*mm = file->private\_data; unsigned long env\_start, env\_end; - if (!mm)+ /\* Ensure the process spawned far enough to have an environment. \*/+ if (!mm || !mm->env\_end) return 0;  page = (char \*)\_\_get\_free\_page(GFP\_TEMPORARY); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-24 22:00:31 +0000



=== Content from www.ubuntu.com_6a8d2493_20250124_220213.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3159-1: Linux kernel vulnerability

20 December 2016

The system could be made to expose sensitive information.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel

## Details

It was discovered that a race condition existed in the procfs

environ\_read function in the Linux kernel, leading to an integer

underflow. A local attacker could use this to expose sensitive

information (kernel memory).

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [linux-image-3.2.0-119-generic-pae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-omap](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-powerpc-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-powerpc-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-generic-pae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-highbank](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-powerpc64-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-virtual](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-powerpc64-smp](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-highbank](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-virtual](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-omap](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0.119.134](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)
* [linux-image-3.2.0-119-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.2.0-119.162](https://launchpad.net/ubuntu/%2Bsource/linux/3.2.0-119.162)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2016-7916](/security/CVE-2016-7916)

## Related notices

* [USN-3160-2](/security/notices/USN-3160-2)
* [USN-3159-2](/security/notices/USN-3159-2)
* [USN-3160-1](/security/notices/USN-3160-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.kernel.org_05b0856d_20250124_220220.html ===


Kernel.org Bugzilla – Bug 116461
PAX: size overflow in function environ\_read fs/proc/base.c
Last modified: 2016-07-17 22:35:09 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/latest/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=116461&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](createaccount.cgi?request_new_password=1)
  Login:

  [x]

[**Bug 116461**](show_bug.cgi?id=116461)
- PAX: size overflow in function environ\_read fs/proc/base.c

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
PAX: size overflow in function environ\_read fs/proc/base.c

| | [Status](page.cgi?id=fields.html#bug_status): | NEW | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | File System | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=File System "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Other ([show other bugs](buglist.cgi?component=Other&product=File%20System&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86-64 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P1 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | fs\_other | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://forums.grsecurity.net/viewtop...](https://forums.grsecurity.net/viewtopic.php?f=3&t=4363) | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-04-15 18:37 UTC by jaak+bugzilla.kernel.org | | --- | --- | | Modified: | 2016-07-17 22:35 UTC ([History](show_activity.cgi?id=116461)) | | CC List: | 2 users (show)  adobriyan pageexec | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Kernel Version:](page.cgi?id=fields.html#cf_kernel_version "A custom Free Text field in this installation of Bugzilla.") | 4.4.6 | | [Subsystem:](page.cgi?id=fields.html#cf_subsystem "The subsystem responsible for this bug (must match MAINTAINERS entry verbatim)") |  | | [Regression:](page.cgi?id=fields.html#cf_regression "A custom Drop Down field in this installation of Bugzilla.") | No | | [Bisected commit-id:](page.cgi?id=fields.html#cf_bisect_commit "Full commit-id of the commit that introduced this regression.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=116461&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=116461#c0)  jaak+bugzilla.kernel.org    2016-04-15 18:37:57 UTC  ``` It seems that env_end ends up being 0 at the location of this printout:  --- fs/proc/base.c.orig 2016-01-19 22:01:14.699210722 +0100 +++ fs/proc/base.c      2016-01-19 22:05:22.467199676 +0100 @@ -1061,6 +1061,7 @@                 this_len = mm->env_end - (mm->env_start + src);                   max_len = min_t(size_t, PAGE_SIZE, count); +               printk(KERN_ERR "PAX environ_read: env_end: %lx, mm->env_start: %lx, src: %lx, count: %lx\n", mm->env_end, mm->env_start, src, count);                 this_len = min(max_len, this_len);                   retval = access_remote_vm(mm, (mm->env_start + src),  Example dmesg output:  ... [37315.188078] PAX environ_read: env_end: 38b2728fbf8, mm->env_start: 38b2728f4ed, src: 0, count: 7ff [37315.188218] PAX environ_read: env_end: 382858f104b, mm->env_start: 382858f0929, src: 0, count: 7ff [37315.188715] PAX environ_read: env_end: 0, mm->env_start: 39cf59b19ca, src: 0, count: 7ff [37315.188717] PAX: size overflow detected in function environ_read fs/proc/base.c:1065 cicus.479_290 min, count: 54, decl: access_remote_vm; num: 4; context: fndecl; [37315.189082] CPU: 5 PID: 20991 Comm: ps Not tainted 4.4.6-hardened-r1 #2 [37315.189083]  28c16bdf00000002 28c16bdf5c6fdc95 0000000000000286 0000000000000000 [37315.189085]  ffffc90003aa3c80 ffffffff812c9e2a 0000039cf59b19ca 28c16bdf5c6fdc95 [37315.189087]  ffffffff816a08ef 0000000000000429 ffffc90003aa3cb0 ffffffff8114a47e [37315.189088] Call Trace: [37315.189092]  [<ffffffff812c9e2a>] dump_stack+0x76/0xbc [37315.189095]  [<ffffffff8114a47e>] report_size_overflow+0x6e/0x80 [37315.189097]  [<ffffffff811a6dac>] environ_read+0x38c/0x5b0 [37315.189100]  [<ffffffff81140a07>] __vfs_read+0x57/0x130 [37315.189102]  [<ffffffff8127d4db>] ? security_file_permission+0xbb/0xd0 [37315.189104]  [<ffffffff81140ba3>] vfs_read+0xc3/0x240 [37315.189108]  [<ffffffff81141279>] SyS_read+0x59/0xd0 [37315.189111]  [<ffffffff8155c670>] entry_SYSCALL_64_fastpath+0x12/0x8a [45519.802369] PAX environ_read: env_end: 39b3e125fd5, mm->env_start: 39b3e1258ca, src: 0, count: 7ff [45519.802531] PAX environ_read: env_end: 3ae9efb655f, mm->env_start: 3ae9efb5e3d, src: 0, count: 7ff [45519.802722] PAX environ_read: env_end: 3cdd8d85f12, mm->env_start: 3cdd8d857ef, src: 0, count: 7ff ...   PAX team thinks this is an upstream bug. Originally reported here:   <https://forums.grsecurity.net/viewtopic.php?f=3&t=4363> ```  [Comment 1](show_bug.cgi?id=116461#c1)  Alexey Dobriyan    2016-07-17 22:35:09 UTC  ``` commit 8148a73c9901a8794a50f950083c00ccf97d43b3 Author: Mathias Krause <minipli@googlemail.com> Date:   Thu May 5 16:22:26 2016 -0700      proc: prevent accessing /proc/<PID>/environ until it's ready ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=116461&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=116461)
* - [XML](show_bug.cgi?ctype=xml&id=116461)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=116461)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/latest/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=116461&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](createaccount.cgi?request_new_password=1)
    Login:

    [x]


