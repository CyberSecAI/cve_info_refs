=== Content from github.com_e7bce8fd_20250124_211951.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=capstone-engine%2Fcapstone)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capstone-engine](/capstone-engine)
/
**[capstone](/capstone-engine/capstone)**
Public

* [Notifications](/login?return_to=%2Fcapstone-engine%2Fcapstone) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fcapstone-engine%2Fcapstone)
* [Star
   7.7k](/login?return_to=%2Fcapstone-engine%2Fcapstone)

* [Code](/capstone-engine/capstone)
* [Issues
  340](/capstone-engine/capstone/issues)
* [Pull requests
  8](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects
  1](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

Additional navigation options

* [Code](/capstone-engine/capstone)
* [Issues](/capstone-engine/capstone/issues)
* [Pull requests](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

## Commit

[Permalink](/capstone-engine/capstone/commit/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

x86: fast path checking for X86\_insn\_reg\_intel()

[Browse files](/capstone-engine/capstone/tree/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)
Browse the repository at this point in the history

* Loading branch information

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=40&v=4)](/aquynh)

[aquynh](/capstone-engine/capstone/commits?author=aquynh "View all commits by aquynh")
committed
Aug 27, 2016

1 parent
[d7459a0](/capstone-engine/capstone/commit/d7459a0ed760b62c08d2110292c20491cad8928f)

commit 87a25bb

Showing
**1 changed file**
with
**8 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

11 changes: 8 additions & 3 deletions

11
[arch/X86/X86Mapping.c](#diff-483d476f7ade8dde4b1a8c1056439448aa1f33ed79706bfa67e16735083e8ade "arch/X86/X86Mapping.c")

Show comments

[View file](/capstone-engine/capstone/blob/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06/arch/X86/X86Mapping.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2930,15 +2930,15 @@ static int regs\_cmp(const void \*a, const void \*b) |
|  |  | return (l - r); |
|  |  | } |
|  |  |  |
|  |  | static bool intel\_regs\_sorted = false; |
|  |  | // return register of given instruction id |
|  |  | // return 0 if not found |
|  |  | // this is to handle instructions embedding accumulate registers into AsmStrs[] |
|  |  | x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | { |
|  |  | static bool intel\_regs\_sorted = false; |
|  |  | unsigned int first = 0; |
|  |  | unsigned int last = ARR\_SIZE(insn\_regs\_intel) - 1; |
|  |  | unsigned int mid = ARR\_SIZE(insn\_regs\_intel) / 2; |
|  |  | unsigned int mid; |
|  |  |  |
|  |  | if (!intel\_regs\_sorted) { |
|  |  | memcpy(insn\_regs\_intel\_sorted, insn\_regs\_intel, |
| Expand All | | @@ -2949,7 +2949,13 @@ x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | intel\_regs\_sorted = true; |
|  |  | } |
|  |  |  |
|  |  | if (insn\_regs\_intel\_sorted[0].insn > id || |
|  |  | insn\_regs\_intel\_sorted[last].insn < id) { |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | while (first <= last) { |
|  |  | mid = (first + last) / 2; |
|  |  | if (insn\_regs\_intel\_sorted[mid].insn < id) { |
|  |  | first = mid + 1; |
|  |  | } else if (insn\_regs\_intel\_sorted[mid].insn == id) { |
| Expand All | | @@ -2962,7 +2968,6 @@ x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | break; |
|  |  | last = mid - 1; |
|  |  | } |
|  |  | mid = (first + last) / 2; |
|  |  | } |
|  |  |  |
|  |  | // not found |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `87a25bb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1bf02a15_20250126_033527.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xx4j-rvcc-2vhr)

**CVE-2016-7151**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-xx4j-rvcc-2vhr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2016-7151](/advisories/GHSA-xx4j-rvcc-2vhr)

## Capstone SEGV caused by a read memory access

Moderate severity

GitHub Reviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Nov 21, 2024

[Vulnerability details](/advisories/GHSA-xx4j-rvcc-2vhr)
[Dependabot alerts
0](/advisories/GHSA-xx4j-rvcc-2vhr/dependabot)

## Package

pip

capstone
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 4.0.0

## Patched versions

4.0.0

## Description

Capstone 3.0.4 has an out-of-bounds vulnerability (SEGV caused by a read memory access) in X86\_insn\_reg\_intel in arch/X86/X86Mapping.c.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2016-7151>
* [capstone-engine/capstone#725](https://github.com/capstone-engine/capstone/pull/725)
* [capstone-engine/capstone@87a25bb](https://github.com/capstone-engine/capstone/commit/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)
* <https://github.com/pypa/advisory-database/tree/main/vulns/capstone/PYSEC-2019-242.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2016-7151)
May 15, 2019

Published to the GitHub Advisory Database
May 24, 2022

Reviewed
Nov 21, 2024

Last updated
Nov 21, 2024

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

### EPSS score

0.061%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (28th percentile)

### Weaknesses

[CWE-125](/advisories?query=cwe%3A125)

### CVE ID

CVE-2016-7151

### GHSA ID

GHSA-xx4j-rvcc-2vhr

### Source code

[capstone-engine/capstone](https://github.com/capstone-engine/capstone)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-xx4j-rvcc-2vhr/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b0cf058a_20250126_033527.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=capstone-engine%2Fcapstone)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capstone-engine](/capstone-engine)
/
**[capstone](/capstone-engine/capstone)**
Public

* [Notifications](/login?return_to=%2Fcapstone-engine%2Fcapstone) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fcapstone-engine%2Fcapstone)
* [Star
   7.7k](/login?return_to=%2Fcapstone-engine%2Fcapstone)

* [Code](/capstone-engine/capstone)
* [Issues
  340](/capstone-engine/capstone/issues)
* [Pull requests
  8](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects
  1](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

Additional navigation options

* [Code](/capstone-engine/capstone)
* [Issues](/capstone-engine/capstone/issues)
* [Pull requests](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

## Commit

[Permalink](/capstone-engine/capstone/commit/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

x86: fast path checking for X86\_insn\_reg\_intel()

[Browse files](/capstone-engine/capstone/tree/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06)
Browse the repository at this point in the history

* Loading branch information

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=40&v=4)](/aquynh)

[aquynh](/capstone-engine/capstone/commits?author=aquynh "View all commits by aquynh")
committed
Aug 27, 2016

1 parent
[d7459a0](/capstone-engine/capstone/commit/d7459a0ed760b62c08d2110292c20491cad8928f)

commit 87a25bb

Showing
**1 changed file**
with
**8 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

11 changes: 8 additions & 3 deletions

11
[arch/X86/X86Mapping.c](#diff-483d476f7ade8dde4b1a8c1056439448aa1f33ed79706bfa67e16735083e8ade "arch/X86/X86Mapping.c")

Show comments

[View file](/capstone-engine/capstone/blob/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06/arch/X86/X86Mapping.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2930,15 +2930,15 @@ static int regs\_cmp(const void \*a, const void \*b) |
|  |  | return (l - r); |
|  |  | } |
|  |  |  |
|  |  | static bool intel\_regs\_sorted = false; |
|  |  | // return register of given instruction id |
|  |  | // return 0 if not found |
|  |  | // this is to handle instructions embedding accumulate registers into AsmStrs[] |
|  |  | x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | { |
|  |  | static bool intel\_regs\_sorted = false; |
|  |  | unsigned int first = 0; |
|  |  | unsigned int last = ARR\_SIZE(insn\_regs\_intel) - 1; |
|  |  | unsigned int mid = ARR\_SIZE(insn\_regs\_intel) / 2; |
|  |  | unsigned int mid; |
|  |  |  |
|  |  | if (!intel\_regs\_sorted) { |
|  |  | memcpy(insn\_regs\_intel\_sorted, insn\_regs\_intel, |
| Expand All | | @@ -2949,7 +2949,13 @@ x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | intel\_regs\_sorted = true; |
|  |  | } |
|  |  |  |
|  |  | if (insn\_regs\_intel\_sorted[0].insn > id || |
|  |  | insn\_regs\_intel\_sorted[last].insn < id) { |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | while (first <= last) { |
|  |  | mid = (first + last) / 2; |
|  |  | if (insn\_regs\_intel\_sorted[mid].insn < id) { |
|  |  | first = mid + 1; |
|  |  | } else if (insn\_regs\_intel\_sorted[mid].insn == id) { |
| Expand All | | @@ -2962,7 +2968,6 @@ x86\_reg X86\_insn\_reg\_intel(unsigned int id, enum cs\_ac\_type \*access) |
|  |  | break; |
|  |  | last = mid - 1; |
|  |  | } |
|  |  | mid = (first + last) / 2; |
|  |  | } |
|  |  |  |
|  |  | // not found |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `87a25bb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fcommit%2F87a25bb543c8e4c09b48d4b4a6c7db31ce58df06) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0377a27e_20250124_211952.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fpull%2F725)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fpull%2F725)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=capstone-engine%2Fcapstone)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capstone-engine](/capstone-engine)
/
**[capstone](/capstone-engine/capstone)**
Public

* [Notifications](/login?return_to=%2Fcapstone-engine%2Fcapstone) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fcapstone-engine%2Fcapstone)
* [Star
   7.7k](/login?return_to=%2Fcapstone-engine%2Fcapstone)

* [Code](/capstone-engine/capstone)
* [Issues
  340](/capstone-engine/capstone/issues)
* [Pull requests
  8](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects
  1](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

Additional navigation options

* [Code](/capstone-engine/capstone)
* [Issues](/capstone-engine/capstone/issues)
* [Pull requests](/capstone-engine/capstone/pulls)
* [Discussions](/capstone-engine/capstone/discussions)
* [Actions](/capstone-engine/capstone/actions)
* [Projects](/capstone-engine/capstone/projects)
* [Wiki](/capstone-engine/capstone/wiki)
* [Security](/capstone-engine/capstone/security)
* [Insights](/capstone-engine/capstone/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcapstone-engine%2Fcapstone%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcapstone-engine%2Fcapstone%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix oob in X86\_insn\_reg\_intel #725

 Closed

[alvarofe](/alvarofe)
wants to merge
1
commit into
[capstone-engine:next](/capstone-engine/capstone/tree/next "capstone-engine/capstone:next")
from
[alvarofe:fix](/alvarofe/capstone/tree/fix "alvarofe/capstone:fix")

 Closed

# [Fix oob in X86\_insn\_reg\_intel](#top) #725

[alvarofe](/alvarofe)
wants to merge
1
commit into
[capstone-engine:next](/capstone-engine/capstone/tree/next "capstone-engine/capstone:next")
from
[alvarofe:fix](/alvarofe/capstone/tree/fix "alvarofe/capstone:fix")

[Conversation
21](/capstone-engine/capstone/pull/725)
[Commits
1](/capstone-engine/capstone/pull/725/commits)
[Checks
0](/capstone-engine/capstone/pull/725/checks)
[Files changed](/capstone-engine/capstone/pull/725/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![alvarofe](https://avatars.githubusercontent.com/u/3474042?s=60&v=4)](/alvarofe)

Copy link

Contributor

### @alvarofe **[alvarofe](/alvarofe)** commented [Jun 29, 2016](#issue-163022719) • edited Loading

I just detected an oob when doing things with radare. I can't help but wonder why isn't there test for capstone? I couldn't find anywhere.

Sorry, something went wrong.

All reactions

[![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=40&v=4)](/alvarofe)

`[Fix oob in X86_insn_reg_intel](/capstone-engine/capstone/pull/725/commits/8ef7b2caed33fa8c24089b551e9e0182676a872b "Fix oob in X86_insn_reg_intel")`

`[8ef7b2c](/capstone-engine/capstone/pull/725/commits/8ef7b2caed33fa8c24089b551e9e0182676a872b)`

 [![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=40&u=5febe403cb4cadd4743810d4abeee12575b4e4fc&v=4)](/alvarofe)
[alvarofe](/alvarofe)
[force-pushed](/capstone-engine/capstone/compare/b00c910cbf2f384a1ff762b990224911f9d56076..8ef7b2caed33fa8c24089b551e9e0182676a872b)
the
fix

branch
from
[`b00c910`](/capstone-engine/capstone/commit/b00c910cbf2f384a1ff762b990224911f9d56076) to
[`8ef7b2c`](/capstone-engine/capstone/commit/8ef7b2caed33fa8c24089b551e9e0182676a872b)  [Compare](/capstone-engine/capstone/compare/b00c910cbf2f384a1ff762b990224911f9d56076..8ef7b2caed33fa8c24089b551e9e0182676a872b)
[June 29, 2016 21:29](#event-708381124)

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Jun 29, 2016](#issuecomment-229503886)

| Why do we have OOB bug here? |
| --- |

All reactions

Sorry, something went wrong.

[![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=80&u=5febe403cb4cadd4743810d4abeee12575b4e4fc&v=4)](/alvarofe)

Copy link

Contributor

Author

### **[alvarofe](/alvarofe)** commented [Jun 29, 2016](#issuecomment-229506298) • edited Loading

| I don't know the reason exactly why but `access 2147483647 max 115 first 0 last -1` means that for an array of 115 (insn\_regs\_intel) was accessing to UT32\_MAX because last -1. But with the use of unsigned int the while loop condition was always true. The reason why last == -1 (the size of insn\_regs\_intel == 0?) i don't know I didn't research further I just fixed it to try to fix a bug in radare2 |
| --- |

All reactions

Sorry, something went wrong.

[![@danghvu](https://avatars.githubusercontent.com/u/1152714?s=80&u=eda7abfb852c133a085f1a7a4ca73ef3f3b04b28&v=4)](/danghvu)

Copy link

Collaborator

### **[danghvu](/danghvu)** commented [Jun 29, 2016](#issuecomment-229506494) • edited Loading

| So something is wrong with `ARR_SIZE(insn_regs_intel)` ? why is it returning 0 ? Can you confirm it is returning 0 ? If it is the case, this is not the right patch. |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Jun 30, 2016](#issuecomment-229557138)

| how to reproduce this bug? |
| --- |

All reactions

Sorry, something went wrong.

[![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=80&u=5febe403cb4cadd4743810d4abeee12575b4e4fc&v=4)](/alvarofe)

Copy link

Contributor

Author

### **[alvarofe](/alvarofe)** commented [Jun 30, 2016](#issuecomment-229769238)

| clone radare and remove the patch of capstone in the folder `shlr/capstone-fixes` and load this binary <http://delphiforfun.org/Programs/Download/CountGridCells.zip> after that `aac` |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Jul 8, 2016](#issuecomment-231268110)

| [@crowell](https://github.com/crowell), can you confirm this issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@crowell](https://avatars.githubusercontent.com/u/616288?s=80&v=4)](/crowell)

Copy link

Contributor

### **[crowell](/crowell)** commented [Jul 8, 2016](#issuecomment-231268799)

| Yes I see the crash too, the patch is safe and we're using in radare On Jul 7, 2016 11:42 PM, "Nguyen Anh Quynh" notifications@github.com wrote:  [@crowell](https://github.com/crowell) <https://github.com/crowell>, can you confirm this issue?  — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub [#725 (comment)](https://github.com/capstone-engine/capstone/pull/725#issuecomment-231268110), or mute the thread <https://github.com/notifications/unsubscribe/AAlnYG2A9fVzppLAn8hk8ZhGnLZv1B69ks5qTcb7gaJpZM4JBjI0> . |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Jul 8, 2016](#issuecomment-231269028)

| can you explain how this is triggered? i dont see how ARR\_SIZE can return 0 here. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jul 10, 2016](#issuecomment-231582425)

| ``` ==30051==ERROR: AddressSanitizer: SEGV on unknown address 0x7f11300b33b4 (pc 0x7f0b2f827c2d bp 0x7ffdc67f0910 sp 0x7ffdc67f0880 T0) ==30051==The signal is caused by a READ memory access.     #0 0x7f0b2f827c2c in X86_insn_reg_intel /home/fuzzer/Fuzzers/capstone-next/arch/X86/X86Mapping.c:2784:7     #1 0x7f0b2f7ecad2 in X86_Intel_printInst /home/fuzzer/Fuzzers/capstone-next/arch/X86/X86IntelInstPrinter.c:729:8     #2 0x7f0b2f466a51 in cs_disasm /home/fuzzer/Fuzzers/capstone-next/cs.c:664:4     #3 0x4f2b9c in LLVMFuzzerTestOneInput (/home/fuzzer/Fuzzers/capstone_fuzzer+0x4f2b9c)     #4 0x4fa02c in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /home/fuzzer/Fuzzers/Fuzzer/FuzzerLoop.cpp:488:13     #5 0x4f9870 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long) /home/fuzzer/Fuzzers/Fuzzer/FuzzerLoop.cpp:444:3     #6 0x4fa0e2 in fuzzer::Fuzzer::RunOneAndUpdateCorpus(unsigned char const*, unsigned long) /home/fuzzer/Fuzzers/Fuzzer/FuzzerLoop.cpp:465:7     #7 0x4fb583 in fuzzer::Fuzzer::MutateAndTestOne() /home/fuzzer/Fuzzers/Fuzzer/FuzzerLoop.cpp:678:5     #8 0x4fbae7 in fuzzer::Fuzzer::Loop() /home/fuzzer/Fuzzers/Fuzzer/FuzzerLoop.cpp:766:5     #9 0x4f4cd2 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /home/fuzzer/Fuzzers/Fuzzer/FuzzerDriver.cpp:416:5     #10 0x4ff530 in main /home/fuzzer/Fuzzers/Fuzzer/FuzzerMain.cpp:21:10     #11 0x7f0b2e067abf in __libc_start_main /build/glibc-qbmteM/glibc-2.21/csu/libc-start.c:289     #12 0x41aa78 in _start (/home/fuzzer/Fuzzers/capstone_fuzzer+0x41aa78)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV /home/fuzzer/Fuzzers/capstone-next/arch/X86/X86Mapping.c:2784:7 in X86_insn_reg_intel ==30051==ABORTING 0x46,0xf2,0xf,0xc2,0xb0,0x54,0xa1,0xcc,0x0,0xde,0xd9,0xe1,0x80,0x31,0xa1,0xde,0xb0,0x34,0x4e,0x40,0xcd,0xcc,0x97,0x69,0xe4,0x30,0xe1,0x97,0x44,0xde,0x69,0x6e,0x80,0xb0,0x31,0xa7,0xcd,0xde, F\xf2\x0f\xc2\xb0T\xa1\xcc\x00\xde\xd9\xe1\x801\xa1\xde\xb04N@\xcd\xcc\x97i\xe40\xe1\x97D\xdein\x80\xb01\xa7\xcd\xde artifact_prefix='./'; Test unit written to ./crash-b84724713cb49e1456f93ba73536584e63a4061e Base64: RvIPwrBUocwA3tnhgDGh3rA0TkDNzJdp5DDhl0TeaW6AsDGnzd4=  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@Maijin](https://avatars.githubusercontent.com/u/1408600?s=80&u=a55b84060a0fd8bc308068a0289e09f4961778b6&v=4)](/Maijin)

Copy link

### **[Maijin](/Maijin)** commented [Jul 26, 2016](#issuecomment-235327909)

| Ping |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Jul 26, 2016](#issuecomment-235329069)

| this report is pretty confused. can you answer the question of [@danghvu](https://github.com/danghvu) above? |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Jul 26, 2016](#issuecomment-235330511)

| [@aquynh](https://github.com/aquynh) just replace CODE with RvIPwrBUocwA3tnhgDGh3rA0TkDNzJdp5DDhl0TeaW6AsDGnzd4= pasted in my comment in your C example code <http://www.capstone-engine.org/lang_c.html>. Obviously not in base64, and compile with -fsanitize=address |
| --- |

All reactions

Sorry, something went wrong.

[![@radare](https://avatars.githubusercontent.com/u/917142?s=80&u=ff3cb2635d392e234764a575e3c3acaf3b1257cd&v=4)](/radare)

Copy link

Contributor

### **[radare](/radare)** commented [Jul 26, 2016](#issuecomment-235332349)

| [tumblr_ma98p4y6gt1qjdbzao1_500](https://cloud.githubusercontent.com/assets/917142/17147277/691041f2-5362-11e6-92d9-5808e89baa70.jpg) |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Aug 27, 2016](#issuecomment-242896674)

| this is a wrong fix. i just pushed a commit for this issue, can you confirm? |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Sep 6, 2016](#issuecomment-244915015)

| Mitre assigned [CVE-2016-7151](https://github.com/advisories/GHSA-xx4j-rvcc-2vhr "CVE-2016-7151") to [87a25bb](https://github.com/capstone-engine/capstone/commit/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06) |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Sep 6, 2016](#issuecomment-244923481)

| interesting! just wondering how they stick that to this bug in the "next" branch, which has no actual version. |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Sep 6, 2016](#issuecomment-244924404) • edited by ghost Loading

| No need to have a X version of there, hence a CVE link to this commit for example in a situation that someone uses a fork or your next branch or as upstream. Anyway still waiting your release after months in your stable branch, and there are already some CVEs assigned that should be notified in a future changelog in case people wonder to upgrade or move to 'next' branch. |
| --- |

All reactions

Sorry, something went wrong.

[![@radare](https://avatars.githubusercontent.com/u/917142?s=80&u=ff3cb2635d392e234764a575e3c3acaf3b1257cd&v=4)](/radare)

Copy link

Contributor

### **[radare](/radare)** commented [Apr 14, 2017](#issuecomment-294132531)

| still waiting for this thing to be merged.. almost a year have passed and this issue has been confirmed by a bunch of peeps. any interest in fixing or should we keep maintaining forks and patches? |
| --- |

All reactions

Sorry, something went wrong.

[![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=80&u=f3eac23969e0e93688f38ac9cf81f264eb9ea509&v=4)](/aquynh)

Copy link

Collaborator

### **[aquynh](/aquynh)** commented [Apr 14, 2017](#issuecomment-294132968) via email

| I did not merge because the fix does not fix the root cause. Can you provide a minimal input triggering this crash, that works with cstool? |
| --- |

All reactions

Sorry, something went wrong.

[![@radare](https://avatars.githubusercontent.com/u/917142?s=80&u=ff3cb2635d392e234764a575e3c3acaf3b1257cd&v=4)](/radare)

Copy link

Contributor

### **[radare](/radare)** commented [Apr 14, 2017](#issuecomment-294135522)

| it does fixes the crash, the code has been already provided in hexa and base64 by [@revskills](https://github.com/revskills) , and having this out of the crash is also easy. what else do you need?  i cant reproduce the issue with last capstone, in fact i removed the patch in r2 after upgrading to capstone [d3155db](https://github.com/capstone-engine/capstone/commit/d3155db362dee12c93aa0df59de183250e32d1a1) . so i think it was silently fixed by someone else.  [@revskills](https://github.com/revskills) [@alvarofe](https://github.com/alvarofe) can you confirm this? i cant reproduce with this:  ``` valgrind cstool/cstool x64 "46 f2 0f c2 b0 54 a1 cc00 de d9 e1 80 31 a1 de b0 34 4e 40 cd cc 97 69e4 30 e1 97 44 de 69 6e80b031a7cdde"  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@vit9696](https://avatars.githubusercontent.com/u/4348897?s=80&v=4)](/vit9696)

Copy link

Contributor

### **[vit9696](/vit9696)** commented [May 16, 2017](#issuecomment-301737249)

| TL;DR The current implementation is less efficient speed-wise but it does not have this bug. I feel pretty frightened to discover such issues given that I use capstone in the kernel but I guess a security audit is what you have to do on your own with opensource sw :/  *Explanation*: Assume insn\_regs\_intel\_sorted has 2 instructions with ids 1 and 2 and id passed is 0.  Before the first iteration the variables will be: first = 0; last = 1; mid = 1; Next else branch will be taken and thus: last = 0; mid = 0; Given first == last another iteration happens and else branch is taken once again, and thus last is assigned mid - 1, i.e. 0 - 1 unsigned. Which leads to UB.  X86\_REG\_INVALID has id == 0, and insn\_regs\_intel has no entry with such an id, so a non zero identifier is the smallest. For this reason whenever the previous implementation of X86\_insn\_reg\_intel got called with X86\_REG\_INVALID could go nuts. |
| --- |

All reactions

Sorry, something went wrong.

[![@vit9696](https://avatars.githubusercontent.com/u/4348897?s=40&v=4)](/vit9696)
[vit9696](/vit9696)
mentioned this pull request
[May 24, 2017](#ref-pullrequest-230950770)

[Merge #929 with some changes to get things compile
#930](/capstone-engine/capstone/pull/930)
 Merged

[![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=40&u=5febe403cb4cadd4743810d4abeee12575b4e4fc&v=4)](/alvarofe)
[alvarofe](/alvarofe)
closed this
[Jul 23, 2017](#event-1175223123)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapstone-engine%2Fcapstone%2Fpull%2F725)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@alvarofe](https://avatars.githubusercontent.com/u/3474042?s=52&v=4)](/alvarofe) [![@aquynh](https://avatars.githubusercontent.com/u/5965536?s=52&v=4)](/aquynh) [![@danghvu](https://avatars.githubusercontent.com/u/1152714?s=52&v=4)](/danghvu) [![@crowell](https://avatars.githubusercontent.com/u/616288?s=52&v=4)](/crowell) [![@Maijin](https://avatars.githubusercontent.com/u/1408600?s=52&v=4)](/Maijin) [![@radare](https://avatars.githubusercontent.com/u/917142?s=52&v=4)](/radare) [![@vit9696](https://avatars.githubusercontent.com/u/4348897?s=52&v=4)](/vit9696)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_87578690_20250126_033526.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  P P" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ��RN�4� i��H��<��
�qϧ���QH�p1Y2[='�4�ۅ�z�\_
4���n�A����l�ƒ\_��9e0�7h�¬H���@b
8W�j~�Շ�5V���e�դ��W�1e�9��ּ][4 ���@�Mf�o�#�� �X�?3@�}=��r�MBT�̱�� ��'�y��DKkT��@xUQ��W�|3�g�ܶҶ���Ã�]��� j� nCj 6 �=�?���5`����� ln' I8�>2���iK �!�%s���^���<��0��3ԏ���Ui�A4�g�U��`c�!��Ey�b�N�{��n�4�o� x?����^�6�ک$JcF��b3Ͽ�W?�w�����F\v=O�� �V�n��:.HtʐG�(�@n�N�F��8?�Z�u4� z���m^Gvb�yQ��fD� 
��&x���`r��\��sS��)���=Ht?�?�tڶ�;�ϗ�1�D%�r��� �uk당����2k&+��IĶ�n;���ʺ�nZ+x�@%��(�'�ejZ=�p��DAu�r� tW��\����rX֟���G�̎˿N�v�g��5�U7�9q��\!��z�����f��!��:����pƀ9�;���w���}h�U�S�P[�3L�9T�� Oew��Gycs-��d��&\*��#ؑR���6�5�.Z�x��i máɥ��d��Ճ�� �z ��*�i5���<Q�G5�[�@�x�-�0������Rh�q�\_��X��ya��(<��#�8&����`&`a�=G\�U��k�;Ky�F[U)�8�����P(u}FU�Ԯ~�泋���1=� P]����Iuyq-�ć/$�Y��$���h�C�MƜ��@sK��������pb:Sh�p�� ʵhC�[��cX�PL�0��ֆ��F+���6��%��p+:[�f'q��P�$�I�(���*
