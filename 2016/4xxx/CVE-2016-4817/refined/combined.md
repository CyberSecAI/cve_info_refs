=== Content from github.com_7eb0c2f3_20250126_091926.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-32wr-c4w3-hg28)

**CVE-2016-4817**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-32wr-c4w3-hg28)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2016-4817](/advisories/GHSA-32wr-c4w3-hg28)

## lib/http2/connection.c in H2O before 1.7.3 and 2.x before...

High severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Feb 1, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-32wr-c4w3-hg28/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

lib/http2/connection.c in H2O before 1.7.3 and 2.x before 2.0.0-beta5 mishandles HTTP/2 disconnection, which allows remote attackers to cause a denial of service (use-after-free and application crash) or possibly execute arbitrary code via a crafted packet.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2016-4817>
* [h2o/h2o#920](https://github.com/h2o/h2o/pull/920)
* [h2o/h2o@1c0808d](https://github.com/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4)
* <http://jvn.jp/en/jp/JVN87859762/index.html>
* <http://jvndb.jvn.jp/jvndb/JVNDB-2016-000091>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2016-4817)
Jun 19, 2016

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 1, 2023

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### EPSS score

1.122%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (85th percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2016-4817

### GHSA ID

GHSA-32wr-c4w3-hg28

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-32wr-c4w3-hg28/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_4e10a03f_20250126_091930.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F1c0808d580da09fdec5a9a74ff09e103ea058dd4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F1c0808d580da09fdec5a9a74ff09e103ea058dd4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=h2o%2Fh2o)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[h2o](/h2o)
/
**[h2o](/h2o/h2o)**
Public

* [Notifications](/login?return_to=%2Fh2o%2Fh2o) You must be signed in to change notification settings
* [Fork
  851](/login?return_to=%2Fh2o%2Fh2o)
* [Star
   11k](/login?return_to=%2Fh2o%2Fh2o)

* [Code](/h2o/h2o)
* [Issues
  585](/h2o/h2o/issues)
* [Pull requests
  109](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

Additional navigation options

* [Code](/h2o/h2o)
* [Issues](/h2o/h2o/issues)
* [Pull requests](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

## Commit

[Permalink](/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

h2: use after free on premature connection close [#920](https://github.com/h2o/h2o/pull/920)

[Browse files](/h2o/h2o/tree/1c0808d580da09fdec5a9a74ff09e103ea058dd4)
Browse the repository at this point in the history

```
lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.
```

* Loading branch information

[![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=40&v=4)](/deweerdt) [![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)

[deweerdt](/h2o/h2o/commits?author=deweerdt "View all commits by deweerdt")
authored and
[kazuho](/h2o/h2o/commits?author=kazuho "View all commits by kazuho")
committed
May 26, 2016

1 parent
[92ef196](/h2o/h2o/commit/92ef196b35c681d8691a03217bde6834cff8bc4f)

commit 1c0808d

Showing
**1 changed file**
with
**10 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

17 changes: 10 additions & 7 deletions

17
[lib/http2/connection.c](#diff-b67d14a05bbdf6145b58265d8f4202e9ae701ff0e70d0046e45a34adfa1afce1 "lib/http2/connection.c")

Show comments

[View file](/h2o/h2o/blob/1c0808d580da09fdec5a9a74ff09e103ea058dd4/lib/http2/connection.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,7 +55,7 @@ static const h2o\_iovec\_t SETTINGS\_HOST\_BIN = {H2O\_STRLIT("\x00\x00\x0c" /\* f |
|  |  | static \_\_thread h2o\_buffer\_prototype\_t wbuf\_buffer\_prototype = {{16}, {H2O\_HTTP2\_DEFAULT\_OUTBUF\_SIZE}}; |
|  |  |  |
|  |  | static void initiate\_graceful\_shutdown(h2o\_context\_t \*ctx); |
|  |  | static void close\_connection(h2o\_http2\_conn\_t \*conn); |
|  |  | static int close\_connection(h2o\_http2\_conn\_t \*conn); |
|  |  | static void send\_stream\_error(h2o\_http2\_conn\_t \*conn, uint32\_t stream\_id, int errnum); |
|  |  | static ssize\_t expect\_default(h2o\_http2\_conn\_t \*conn, const uint8\_t \*src, size\_t len, const char \*\*err\_desc); |
|  |  | static int do\_emit\_writereq(h2o\_http2\_conn\_t \*conn); |
| Expand Down  Expand Up | | @@ -261,15 +261,17 @@ static void close\_connection\_now(h2o\_http2\_conn\_t \*conn) |
|  |  | free(conn); |
|  |  | } |
|  |  |  |
|  |  | void close\_connection(h2o\_http2\_conn\_t \*conn) |
|  |  | int close\_connection(h2o\_http2\_conn\_t \*conn) |
|  |  | { |
|  |  | conn->state = H2O\_HTTP2\_CONN\_STATE\_IS\_CLOSING; |
|  |  |  |
|  |  | if (conn->\_write.buf\_in\_flight != NULL || h2o\_timeout\_is\_linked(&conn->\_write.timeout\_entry)) { |
|  |  | /\* there is a pending write, let on\_write\_complete actually close the connection \*/ |
|  |  | } else { |
|  |  | close\_connection\_now(conn); |
|  |  | return -1; |
|  |  | } |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | void send\_stream\_error(h2o\_http2\_conn\_t \*conn, uint32\_t stream\_id, int errnum) |
| Expand Down  Expand Up | | @@ -808,7 +810,7 @@ static ssize\_t expect\_preface(h2o\_http2\_conn\_t \*conn, const uint8\_t \*src, size\_t |
|  |  | return CONNECTION\_PREFACE.len; |
|  |  | } |
|  |  |  |
|  |  | static void parse\_input(h2o\_http2\_conn\_t \*conn) |
|  |  | static int parse\_input(h2o\_http2\_conn\_t \*conn) |
|  |  | { |
|  |  | size\_t http2\_max\_concurrent\_requests\_per\_connection = conn->super.ctx->globalconf->http2.max\_concurrent\_requests\_per\_connection; |
|  |  | int perform\_early\_exit = 0; |
| Expand All | | @@ -831,20 +833,20 @@ static void parse\_input(h2o\_http2\_conn\_t \*conn) |
|  |  | enqueue\_goaway(conn, (int)ret, |
|  |  | err\_desc != NULL ? (h2o\_iovec\_t){(char \*)err\_desc, strlen(err\_desc)} : (h2o\_iovec\_t){}); |
|  |  | } |
|  |  | close\_connection(conn); |
|  |  | return; |
|  |  | return close\_connection(conn); |
|  |  | } |
|  |  | /\* advance to the next frame \*/ |
|  |  | h2o\_buffer\_consume(&conn->sock->input, ret); |
|  |  | } |
|  |  |  |
|  |  | if (!h2o\_socket\_is\_reading(conn->sock)) |
|  |  | h2o\_socket\_read\_start(conn->sock, on\_read); |
|  |  | return; |
|  |  | return 0; |
|  |  |  |
|  |  | EarlyExit: |
|  |  | if (h2o\_socket\_is\_reading(conn->sock)) |
|  |  | h2o\_socket\_read\_stop(conn->sock); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | static void on\_read(h2o\_socket\_t \*sock, int status) |
| Expand All | | @@ -858,7 +860,8 @@ static void on\_read(h2o\_socket\_t \*sock, int status) |
|  |  | } |
|  |  |  |
|  |  | update\_idle\_timeout(conn); |
|  |  | parse\_input(conn); |
|  |  | if (parse\_input(conn) != 0) |
|  |  | return; |
|  |  |  |
|  |  | /\* write immediately, if there is no write in flight and if pending write exists \*/ |
|  |  | if (h2o\_timeout\_is\_linked(&conn->\_write.timeout\_entry)) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1c0808d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fcommit%2F1c0808d580da09fdec5a9a74ff09e103ea058dd4) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_7d9510e7_20250126_091931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fpull%2F920)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fpull%2F920)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=h2o%2Fh2o)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[h2o](/h2o)
/
**[h2o](/h2o/h2o)**
Public

* [Notifications](/login?return_to=%2Fh2o%2Fh2o) You must be signed in to change notification settings
* [Fork
  851](/login?return_to=%2Fh2o%2Fh2o)
* [Star
   11k](/login?return_to=%2Fh2o%2Fh2o)

* [Code](/h2o/h2o)
* [Issues
  585](/h2o/h2o/issues)
* [Pull requests
  109](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

Additional navigation options

* [Code](/h2o/h2o)
* [Issues](/h2o/h2o/issues)
* [Pull requests](/h2o/h2o/pulls)
* [Actions](/h2o/h2o/actions)
* [Wiki](/h2o/h2o/wiki)
* [Security](/h2o/h2o/security)
* [Insights](/h2o/h2o/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fh2o%2Fh2o%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fh2o%2Fh2o%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix use after free on premature connection close (CVE-2016-4817) #920

 Merged

[kazuho](/kazuho)
merged 1 commit into
[master](/h2o/h2o/tree/master "h2o/h2o:master")
from
[kazuho/http2/invalid-preface](/h2o/h2o/tree/kazuho/http2/invalid-preface "h2o/h2o:kazuho/http2/invalid-preface")

May 26, 2016

 Merged

# [fix use after free on premature connection close (CVE-2016-4817)](#top) #920

[kazuho](/kazuho)
merged 1 commit into
[master](/h2o/h2o/tree/master "h2o/h2o:master")
from
[kazuho/http2/invalid-preface](/h2o/h2o/tree/kazuho/http2/invalid-preface "h2o/h2o:kazuho/http2/invalid-preface")

May 26, 2016

[Conversation
1](/h2o/h2o/pull/920)
[Commits
1](/h2o/h2o/pull/920/commits)
[Checks
0](/h2o/h2o/pull/920/checks)
[Files changed](/h2o/h2o/pull/920/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kazuho](https://avatars.githubusercontent.com/u/41567?s=60&v=4)](/kazuho)

Copy link

Member

### @kazuho **[kazuho](/kazuho)** commented [May 26, 2016](#issue-156888427) ‚Ä¢ edited Loading

A use-after-free vulnerability has been reported by Tim Newsham and fixed by [Frederik Deweerdt](https://github.com/deweerdt).

CVE-ID for this issue is [CVE-2016-4817](https://github.com/advisories/GHSA-32wr-c4w3-hg28 "CVE-2016-4817"). The issue has been fixed in version 1.7.3 and version 2.0.0-beta5. Users are encouraged to update to the latest versions.

The issue is that when H2O tries to disconnect a premature HTTP/2 connection, it calls free(3) to release memory allocated for the connection and immediately after then touches the memory. No malloc-related operation is performed by the same thread between the time it calls free and the time the memory is touched.

Therefore, it is estimated that the exploitability of the issue depends on if an attacker can overwrite the memory chunk at the appropriate moment from another thread (note: the number of threads used to accept incoming connections are governed by [num-threads](https://h2o.examp1e.net/configure/base_directives.html#num-threads) configuration directive).

In case the issue is exploitable, then it would mean that a remote attacker can mount a DoS attack against H2O, or at worst result in remote code execution.

We would like to thank the aforementioned people for finding and fixing the issue.

Sorry, something went wrong.

All reactions

[![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=40&v=4)](/deweerdt) [![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)

`[h2: use after free on premature connection close](/h2o/h2o/pull/920/commits/8705cc19ea312ad6a4b445029ef27b1c5922527e "h2: use after free on premature connection close

lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.")`
 ‚Ä¶

`[8705cc1](/h2o/h2o/pull/920/commits/8705cc19ea312ad6a4b445029ef27b1c5922527e)`

```
lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.
```

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)
[kazuho](/kazuho)
added
[bug](/h2o/h2o/labels/bug)
[http2](/h2o/h2o/labels/http2)
labels
[May 26, 2016](#event-672608786)

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)
[kazuho](/kazuho)
merged commit [`65b8941`](/h2o/h2o/commit/65b894160a1f408c6e8bb2e9a9058aa23ab0e24e)
into
master

[May 26, 2016](https://github.com/h2o/h2o/pull/920#event-672622568)

[kazuho](/kazuho)
pushed a commit
that referenced
this pull request
[May 26, 2016](#ref-commit-1c0808d)
[![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=40&v=4)](/deweerdt) [![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)

`[h2: use after free on premature connection](/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4 "h2: use after free on premature connection close #920

lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.") [close](/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4 "h2: use after free on premature connection close #920

lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.") [#920](https://github.com/h2o/h2o/pull/920)`
‚Ä¶

`[1c0808d](/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4)`

```
lib/http2/connection.c:on_read() calls parse_input(), which might free
`conn`. It does so in particular if the connection preface isn't
the expected one in expect_preface(). `conn` is then used after the free
in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`.
We fix this by adding a return value to close_connection that returns a
negative value if `conn` has been free'd and can't be used anymore.

Credits for finding the bug to Tim Newsham.
```

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)
[kazuho](/kazuho)
added
[vulnerability](/h2o/h2o/labels/vulnerability)
and removed
[bug](/h2o/h2o/labels/bug)
labels
[May 26, 2016](#event-672657555)

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=40&v=4)](/kazuho)
[kazuho](/kazuho)
changed the title
~~fix use after free on premature connection close~~
fix use after free on premature connection close (CVE-2016-4817)
[May 26, 2016](#event-672663720)

[![@dch](https://avatars.githubusercontent.com/u/284368?s=80&v=4)](/dch)

Copy link

Collaborator

### **[dch](/dch)** commented [Jun 1, 2016](#issuecomment-222995356)

| waiting on <https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=209926> to commit this to ports. |
| --- |

 üëç
1
 kazuho reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@tatianab](https://avatars.githubusercontent.com/u/6238967?s=40&v=4)](/tatianab)
[tatianab](/tatianab)
mentioned this pull request
[Nov 8, 2023](#ref-issue-1984464867)

[x/vulndb: potential Go vuln in github.com/h2o/h2o: CVE-2016-4817
golang/vulndb#2193](/golang/vulndb/issues/2193)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fh2o%2Fh2o%2Fpull%2F920)

Reviewers

No reviews

Assignees

No one assigned

Labels

[http2](/h2o/h2o/labels/http2)
[vulnerability](/h2o/h2o/labels/vulnerability)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@kazuho](https://avatars.githubusercontent.com/u/41567?s=52&v=4)](/kazuho) [![@dch](https://avatars.githubusercontent.com/u/284368?s=52&v=4)](/dch) [![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=52&v=4)](/deweerdt)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from jvndb.jvn.jp_e66c62bb_20250125_141647.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2016/06/23

| [[Japanese]](/ja/contents/2016/JVNDB-2016-000091.html) | |
| --- | --- |
| JVNDB-2016-000091 | |
| H2O use-after-free vulnerability | |
| Overview | |
| H2O is an open source web server software. H2O contains a use-after-free vulnerability. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [5.3](/cvss/en/v3.html#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L) (Medium) [IPA¬†Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: None * User Interaction: None * Scope: Unchanged * Confidentiality Impact: None * Integrity Impact: None * Availability Impact: Low  **CVSS V2 Severity:Base Metrics [5.0](/cvss/en/v2.html#AV:N/AC:L/Au:N/C:N/I:N/A:P) (Medium) [Vendor Score]**  * Access Vector: Network * Access Complexity: Low * Authentication: None * Confidentiality Impact: None * Integrity Impact: None * Availability Impact: Partial | |
| Affected Products | |
|  | |
| Kazuho Oku  * H2O version 1.7.2 and earlier | |
|  | |
| Impact | |
| An attacker may cause a denial-of-service (DoS) condition by sending a specially crafted packet. | |
| Solution | |
| [Update the Software] | |
| Vendor Information | |
| Kazuho Oku  * GitHub : [h2: use after free on premature connection close #920](https://github.com/h2o/h2o/commit/1c0808d580da09fdec5a9a74ff09e103ea058dd4) * GitHub : [fix use after free on premature connection close (CVE-2016-4817) #920](https://github.com/h2o/h2o/pull/920) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Resource¬†Management¬†Errors](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE399)(CWE-399) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2016-4817](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4817) | |
| References | |
| 1. JVN : [JVN#87859762](https://jvn.jp/en/jp/JVN87859762/index.html) 2. National Vulnerability Database (NVD) : [CVE-2016-4817](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-4817) | |
| Revision History | |
| * [2016/05/27] | |

| --- | |
| --- | --- |
| Date Public | 2016/05/27 |
| Date First Published | 2016/05/27 |
| Date Last Updated | 2016/06/23 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright ¬© 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvn.jp_52b38ee4_20250126_091930.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2016/05/27¬†¬†Last Updated:2016/05/27
# JVN#87859762 H2O use-after-free vulnerability

## Overview

H2O contains a use-after-free vulnerability.

## Products Affected

* H2O version 1.7.2 and earlier

## Description

H2O is an open source web server software. H2O contains a use-after-free vulnerability.

## Impact

An attacker may cause a denial-of-service (DoS) condition by sending a specially crafted packet.

## Solution

**Update the Software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Kazuho Oku | [fix use after free on premature connection close (CVE-2016-4817) #920](https://github.com/h2o/h2o/pull/920) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
Base Score:
5.3

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:N/C:N/I:N/A:P
Base Score:
5.0

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Kazuho Oku reported this vulnerability to IPA to notify users of its solution through JVN. JPCERT/CC and Kazuho Oku coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2016-4817](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4817) |
| JVN iPedia | [JVNDB-2016-000091](http://jvndb.jvn.jp/jvndb/JVNDB-2016-000091) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2016 JPCERT/CC and IPA. All rights reserved.



=== Content from github.com_494f2878_20250126_091927.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdeweerdt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdeweerdt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=64&v=4)

**deweerdt**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdeweerdt)

[Overview](/deweerdt)
[Repositories
79](/deweerdt?tab=repositories)
[Projects
0](/deweerdt?tab=projects)
[Packages
0](/deweerdt?tab=packages)
[Stars
45](/deweerdt?tab=stars)

More

* [Overview](/deweerdt)
* [Repositories](/deweerdt?tab=repositories)
* [Projects](/deweerdt?tab=projects)
* [Packages](/deweerdt?tab=packages)
* [Stars](/deweerdt?tab=stars)

![@deweerdt](https://avatars.githubusercontent.com/u/5094?s=64&v=4)

**deweerdt**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdeweerdt)

[![View deweerdt's full-sized avatar](https://avatars.githubusercontent.com/u/5094?v=4)](https://avatars.githubusercontent.com/u/5094?v=4)

# Frederik Deweerdt deweerdt

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdeweerdt)

[45
followers](https://github.com/deweerdt?tab=followers) ¬∑ [5
following](https://github.com/deweerdt?tab=following)

* [@fastly](https://github.com/fastly)
* San Francisco

## [Achievements](/deweerdt?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)](/deweerdt?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Mars 2020 Contributor](https://github.githubassets.com/assets/mars-2020-contributor-default-c9cad8495acf.png)](/deweerdt?achievement=mars-2020-contributor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/deweerdt?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/deweerdt?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/deweerdt?achievement=pull-shark&tab=achievements)
## [Achievements](/deweerdt?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)](/deweerdt?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Mars 2020 Contributor](https://github.githubassets.com/assets/mars-2020-contributor-default-c9cad8495acf.png)](/deweerdt?achievement=mars-2020-contributor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/deweerdt?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/deweerdt?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/deweerdt?achievement=pull-shark&tab=achievements)
## Organizations

[![@h2o](https://avatars.githubusercontent.com/u/9275116?s=64&v=4)](/h2o)

Block or Report

# Block or report deweerdt

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=deweerdt+%28user%29)

[Overview](/deweerdt)
[Repositories
79](/deweerdt?tab=repositories)
[Projects
0](/deweerdt?tab=projects)
[Packages
0](/deweerdt?tab=packages)
[Stars
45](/deweerdt?tab=stars)

More

* [Overview](/deweerdt)
* [Repositories](/deweerdt?tab=repositories)
* [Projects](/deweerdt?tab=projects)
* [Packages](/deweerdt?tab=packages)
* [Stars](/deweerdt?tab=stars)

## Popular repositories Loading

1. [h2priograph](/deweerdt/h2priograph) h2priograph
   Public

   Generates a .dot file from Chrome's net-internals tab

   Go

   [18](/deweerdt/h2priograph/stargazers)
   [2](/deweerdt/h2priograph/forks)
2. [h2get](/deweerdt/h2get) h2get
   Public

   An H2 client

   C

   [17](/deweerdt/h2get/stargazers)
   [12](/deweerdt/h2get/forks)
3. [netfilter-hook](/deweerdt/netfilter-hook) netfilter-hook
   Public

   Creates a character device allowing a user space application to intercept packets on the netfilter route

   C

   [13](/deweerdt/netfilter-hook/stargazers)
   [3](/deweerdt/netfilter-hook/forks)
4. [JSON-Spirit](/deweerdt/JSON-Spirit) JSON-Spirit
   Public

   C++ JSon library

   [8](/deweerdt/JSON-Spirit/stargazers)
   [1](/deweerdt/JSON-Spirit/forks)
5. [little](/deweerdt/little) little
   Public

   Small HTTP server

   C

   [6](/deweerdt/little/stargazers)
   [1](/deweerdt/little/forks)
6. [tamis](/deweerdt/tamis) tamis
   Public

   Variable access analyzer

   C

   [5](/deweerdt/tamis/stargazers)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from jvn.jp_67ea1f0f_20250125_141644.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2016/05/27¬†¬†Last Updated:2016/05/27
# JVN#87859762 H2O use-after-free vulnerability

## Overview

H2O contains a use-after-free vulnerability.

## Products Affected

* H2O version 1.7.2 and earlier

## Description

H2O is an open source web server software. H2O contains a use-after-free vulnerability.

## Impact

An attacker may cause a denial-of-service (DoS) condition by sending a specially crafted packet.

## Solution

**Update the Software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Kazuho Oku | [fix use after free on premature connection close (CVE-2016-4817) #920](https://github.com/h2o/h2o/pull/920) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
Base Score:
5.3

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:N/C:N/I:N/A:P
Base Score:
5.0

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Kazuho Oku reported this vulnerability to IPA to notify users of its solution through JVN. JPCERT/CC and Kazuho Oku coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2016-4817](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4817) |
| JVN iPedia | [JVNDB-2016-000091](http://jvndb.jvn.jp/jvndb/JVNDB-2016-000091) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2016 JPCERT/CC and IPA. All rights reserved.


