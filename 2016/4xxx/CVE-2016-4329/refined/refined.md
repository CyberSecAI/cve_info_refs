Based on the provided content, here's a breakdown of the vulnerability described:

**Root Cause:**

The vulnerability stems from a lack of proper handling of specific Windows broadcast messages within the Kaspersky Anti-Virus software. The application's message dispatcher doesn't have handlers for certain `wParam` values, leading to application termination when such messages are received.

**Weaknesses/Vulnerabilities:**

*   **Unhandled Windows Messages:** The core issue is the absence of proper handlers for specific broadcast window messages.
*   **Lack of Input Validation:** The application fails to validate the `wParam` value of incoming messages, directly using it as a lookup in the dispatch table.
*   **Self-Protection Bypass:**  By crashing the main application process (`avpui.exe`), an attacker effectively bypasses the software's self-protection mechanisms.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** An attacker can cause the Kaspersky Anti-Virus user interface application to terminate, rendering the software's UI inaccessible.
*   **Protection Bypass:**  Since the application terminates, it effectively bypasses the anti-virus protection, though the core antivirus functionality may reside in another process.

**Attack Vectors:**

*   **Local Attack:** The attack requires the attacker to be able to send Windows messages on the local system.
*   **Windows Message Broadcasting:** The exploit involves sending a specific, unhandled window message through the `PostMessage` API to the `HWND_BROADCAST` handle.

**Required Attacker Capabilities/Position:**

*   **Local Access:** The attacker needs to have the ability to execute code on the target system to send the crafted Windows messages, likely needing user-level access.
*   **Knowledge of Message ID and `wParam` Values:** The attacker requires knowledge of the specific Windows message name ("Kaspersky Anti-Virus") and the `wParam` values that trigger the crash.

**Additional Details:**

*   The provided proof-of-concept (PoC) Python script demonstrates how to send the malicious Windows message.
*   The crash analysis shows the application terminates due to a CLR exception after receiving the crafted message.
*   The vulnerability was discovered by Marcin ‘Icewall’ Noga of Cisco Talos.
*   The vulnerability was present in Kaspersky Total Security 16.0.0.614
*   The vulnerability was fixed by migrating to newer versions of Kaspersky products (2017)

This report provides more technical details than the original CVE description, including the root cause in the unhandled window messages, the PoC script, and the crash analysis.