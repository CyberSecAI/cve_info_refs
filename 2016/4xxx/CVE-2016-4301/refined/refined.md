```
{
  "vulnerability": {
    "root_cause": "The `parse_device` function in `archive_read_support_format_mtree.c` incorrectly handles arguments, leading to a stack buffer overflow. Specifically, the code attempts to prevent writing past the end of the `numbers` array by checking if the argument count `argc` exceeds `MAX_PACK_ARGS`. However, it increments `argc` *before* performing the check, allowing a write out of bounds.",
    "weaknesses": [
      "Stack-based buffer overflow",
      "Incorrect bounds checking"
    ],
    "impact": "Arbitrary code execution by overwriting return addresses or other critical data on the stack.",
    "attack_vectors": [
      "A specially crafted mtree file processed by a vulnerable version of libarchive."
    ],
    "required_capabilities": "An attacker needs to provide a malformed mtree file to be processed by libarchive.",
    "additional_information": "The vulnerability is triggered by providing more than 3 arguments to the `device` keyword in an mtree file, or by providing one argument that is larger than an unsigned long. The fix involves changing the check to be `>= MAX_PACK_ARGS` instead of `> MAX_PACK_ARGS` which effectively avoids the out of bounds write.",
    "cvss_v3_base_metrics": {
        "attack_vector": "Local",
        "attack_complexity": "Low",
        "privileges_required": "None",
        "user_interaction": "Required",
        "scope": "Unchanged",
        "confidentiality": "High",
        "integrity": "High",
        "availability": "High"
        },
    "cwe": "CWE-119"
  }
}
```