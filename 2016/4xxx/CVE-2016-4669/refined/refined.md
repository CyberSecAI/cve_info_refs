```
{
  "cveId": "CVE-2016-4669",
  "relatedContent": [
    {
      "source": "support.apple.com_2764373f_20250124_151506.html",
      "vulnerability": {
        "rootCause": "Multiple input validation issues existed in MIG generated code.",
        "weaknesses": [
          "Input validation issues"
        ],
        "impact": "A local user may be able to cause an unexpected system termination or arbitrary code execution in the kernel.",
        "attackVectors": [
          "Local access"
        ],
        "attackerCapabilities": "Local user"
      },
        "affectedProducts": [
          "OS X Yosemite 10.10.5",
          "OS X El Capitan 10.11.6",
          "macOS Sierra 10.12"
        ]
    },
    {
      "source": "www.exploit-db.com_23ba5410_20250124_151507.html",
      "vulnerability": {
          "rootCause": "The `mach_ports_register` MIG method does not verify if `init_port_setCnt` is equal to the actual length of the provided port array, leading to out-of-bounds reads and potential use-after-free issues.",
          "weaknesses": [
              "Out-of-bounds read",
              "Use-after-free",
              "Incorrect size verification"
          ],
        "impact": "A kernel panic due to decrementing an invalid reference or a mach_port_t use-after-free, potentially leading to arbitrary code execution with kernel privileges. Could potentially allow an attacker to get another task's task port.",
          "attackVectors": [
              "Local access via crafted mach message"
          ],
          "attackerCapabilities": "Local user with the ability to send crafted mach messages"
      },
      "additionalDetails": "The vulnerability lies in the `mach_ports_register` function, specifically in how it uses the `init_port_setCnt` value which is part of the mach message, instead of the actual length of the allocated buffer containing the ports. This can be exploited to read mach ports out of bounds, and then potentially free those pointers, leading to a UAF. The provided code includes a proof of concept that patches the MIG generated code to always send one OOL mach port, but sets init_port_setCnt to a controlled value causing a kernel panic."
    },
    {
      "source": "support.apple.com_212e2d4a_20250124_151505.html",
      "vulnerability": {
        "rootCause": "Multiple input validation issues existed in MIG generated code.",
         "weaknesses": [
          "Input validation issues"
        ],
        "impact": "A local user may be able to cause an unexpected system termination or arbitrary code execution in the kernel.",
        "attackVectors": [
          "Local access"
        ],
        "attackerCapabilities": "Local user"
      },
         "affectedProducts": [
          "iPhone 5 and later",
          "iPad 4th generation and later",
          "iPod touch 6th generation and later"
         ]
    },
     {
      "source": "support.apple.com_e709ec06_20250124_151502.html",
        "vulnerability": {
           "rootCause": "Multiple input validation issues existed in MIG generated code.",
           "weaknesses": [
             "Input validation issues"
            ],
        "impact": "A local user may be able to cause an unexpected system termination or arbitrary code execution in the kernel.",
          "attackVectors": [
            "Local access"
          ],
        "attackerCapabilities": "Local user"
        },
        "affectedProducts": [
          "All Apple Watch models"
        ]
    },
    {
      "source": "support.apple.com_d786689b_20250124_151503.html",
        "vulnerability": {
           "rootCause": "Multiple input validation issues existed in MIG generated code.",
           "weaknesses": [
              "Input validation issues"
           ],
        "impact": "A local user may be able to cause an unexpected system termination or arbitrary code execution in the kernel.",
          "attackVectors": [
            "Local access"
          ],
          "attackerCapabilities": "Local user"
        },
        "affectedProducts": [
          "Apple TV (4th generation)"
        ]
     }
  ]
}
```