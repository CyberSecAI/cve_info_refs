```
{
  "CVE-2016-4557": {
    "description": "The replace_map_fd_with_map_ptr function in kernel/bpf/verifier.c in the Linux kernel before 4.5.5 does not properly maintain an fd data structure, which allows local users to gain privileges or cause a denial of service (use-after-free) via crafted BPF instructions that reference an incorrect file descriptor.",
    "vulnerability_details": {
      "root_cause": "A double fdput() call in the error handling path of `replace_map_fd_with_map_ptr` when a non-map file descriptor was incorrectly referenced as a map file descriptor in a BPF program.",
      "weaknesses": [
        "Use-after-free"
      ],
      "impact": "Local root privilege escalation or a denial of service due to a use-after-free condition.",
      "attack_vectors": [
        "Crafted BPF instructions",
        "Incorrectly referencing non-map file descriptor as a map file descriptor in BPF program"
      ],
        "required_capabilities": "Ability to load BPF programs and create a file descriptor table which can be shared."
    },
     "affected_versions": [
      "Linux kernel versions before 4.5.5",
      "Linux kernel >=4.4 (based on Debian bug report, and metasploit module)"
    ],
    "fix_details": {
       "fix": "Fixed by commit 8358b02bf67d3a5d8a825070e1aa73f25fb2e4c7, which removes the redundant `fdput()` call.",
        "fixed_versions": [
          "linux 4.5.3-1",
           "kernel-default >= 4.4.21-69.1"
        ]
     },
    "references": [
      "https://bugs.chromium.org/p/project-zero/issues/detail?id=808",
      "https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8358b02bf67d3a5d8a825070e1aa73f25fb2e4c7",
       "https://bugs.debian.org/823603",
       "https://www.suse.com/security/cve/CVE-2016-4557.html",
       "https://www.exploit-db.com/exploits/40759",
      "https://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-NNN1.html",
      "https://security-tracker.debian.org/tracker/CVE-2016-4557"
     ]
  }
}
```