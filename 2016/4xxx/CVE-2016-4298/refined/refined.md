- **Root cause of vulnerability:** Integer overflow when calculating the size of a buffer, leading to a heap-based buffer overflow.
- **Weaknesses/vulnerabilities present:** Integer overflow, heap-based buffer overflow. The application reads a 32-bit integer from the file and multiplies it by 0x228, without checking for an upper bound. This result is used for memory allocation. However, a different value read from the file is later used as the loop counter for copying data into the allocated memory. The discrepancy allows for data to be written beyond the allocated buffer.
- **Impact of exploitation:** Arbitrary code execution in the context of the application. An attacker can overwrite heap memory leading to code execution.
- **Attack vectors:** Maliciously crafted .hpt file. An attacker can create a specially crafted Hangul HShow document (.hpt) that triggers the integer overflow and buffer overflow.
- **Required attacker capabilities/position:** The attacker needs to be able to deliver the crafted file to the victim, who then has to open it using the vulnerable application. This can be done by email or other delivery methods. No special permissions or privileges are needed.