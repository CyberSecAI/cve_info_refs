The provided content is a detailed vulnerability report for CVE-2016-4294.

**Root cause of vulnerability:** Heap-based buffer overflow due to inconsistent size calculations during processing of OfficeArt properties within a Hangul HCell document.

**Weaknesses/vulnerabilities present:**
- The application allocates heap space based on the `nElems` field of an `IMsoArray` structure multiplied by a constant size (8 bytes per element).
- When copying data into the allocated buffer, the application uses the `cbElem` field of the same `IMsoArray` structure for the size of each element.
- The `cbElem` is controlled by the attacker. If `cbElem` is greater than 8 bytes, a heap buffer overflow occurs.

**Impact of exploitation:**
- Code execution under the context of the application.
- The attacker can corrupt the heap, potentially overwriting critical structures and gaining control of execution flow.

**Attack vectors:**
- Opening a specially crafted Hangul HCell document (.cell file).
- The vulnerability is triggered during the processing of OfficeArt shapes and their associated properties.

**Required attacker capabilities/position:**
- Ability to create or modify Hangul HCell document files.
- User interaction is required to open the malicious document.

**Technical details:**
- The vulnerability lies within the processing of the `pVertices` (ID 0x145) and `pSegmentInfo` (ID 0x151) properties.
- The `IMsoArray` structure, which holds the size information, is located in the complex data section of the OfficeArt properties within the document.
- Specifically, `cbElem` field within `IMsoArray` is abused in a memcpy operation leading to the heap overflow.
- The application parses the "Workbook" stream within a .cell file and then goes through 3 passes when processing a record.
- If the record type is 0x00ec then the application will enter a function that deals with OfficeArt records.
- When processing the record type 0xf004, the application will initialize a object containing a number of associative arrays to store the offsets to the various record types that compose a Microsoft Office shape container.
- When the record type 0xf00b is processed the application uses the flags for the properties.
- The vulnerable function processes properties by using the `fComplex` flag. If set, then the associative-arrayâ€™s value is mapped to the out-of-band data associated with the property.
- The `IMsoArray` structure within the complexData contains the following fields: `nElems`, `cbElem` and `data`.
- During heap allocation, the application multiplies `nElems` by 8, and allocates a buffer of that size.
- When copying the data to the heap buffer, it uses `cbElem` for the size of each element resulting in a heap-based buffer overflow if `cbElem` is greater than 8.