=== Content from www.openwall.com_6d6fb589_20250124_172732.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160429150851.0723C8BC556@smtpvmsrv1.mitre.org>
Date: Fri, 29 Apr 2016 11:08:51 -0400 (EDT)
From: cve-assign@...re.org
To: gustavo.grieco@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: Mplayer/Mencoder integer overflow parsing gif files

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> A crash caused by an integer overflow parsing a gif was found in the last
> revision of mplayer. It seems to affect older versions too. It was recently
> fixed (r37857). Technical details and a reproducer are available here:
>
> <https://trac.mplayerhq.hu/ticket/2295>
>
> I verified that this issue affects mencoder

>> Fixed in r37857.
>>
>> The gif demuxes assumes in many places that width*height is <=
>> INT_MAX; this is not true with the sample. Fixed by validating the
>> picture size.

Use CVE-2016-4352.

This code was added to libmpdemux/demux_gif.c between r37856 and r37857:

   // Validate image size, most code in this demuxer assumes w*h <= INT_MAX
   if ((int64_t)gif->SWidth * gif->SHeight > INT_MAX) {
     mp_msg(MSGT_DEMUX, MSGL_ERR,
            "[demux_gif] Unsupported picture size %dx%d.\n", gif->SWidth,
            gif->SHeight);
     if (DGifCloseFile(gif) == GIF_ERROR)
       print_gif_error(NULL);
     free(priv);
     return NULL;
   }

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXI3iYAAoJEHb/MwWLVhi2ndcQAIfNBWzI+O+D90r31xFgzNHh
q5AYsp+VN48Z6f8Ctp6AVXWoD+I/KHC1AIBc5Pn9/ahDyQ+cv9ejMdizkohu7TpW
q4vfeCsmp94pw2w8tKbT4wgI19mdERvWiFe03SD/1xpxaHc6gIZN4+zwmswyIJVq
9UVl6cEbSD/NGDpudTwqNH2Tc6KPfpUTPDh05nHhdEYkoPepemS0E6dHZl0cnV38
qFAF7EvF4h+1pQSfchVdtf58nPu5g7tuR7eudnqnq9g49PZlIOPBKB/cdra7ZON7
eFvZp+0XZ3QtwvDiQ18uAHnobN2RdnonISfimOsd7zYDyoxtAttfOvBRaVRDtTBr
U0hfDRA8g/d5JTmeLMcfm1NWG3+0nF90BVYjY7cziAVBAGoj17fo66mw6nM5Jn2A
1T/9Cc/gqzIvlGlVQk/3KObdK0DbZvGxgFxo8pKTzrRo/thAS6Rp30X672pfGH1W
DxWhbkJgnU+PmaW+86zrWsnHGqoX++bduSIxo/Y1jjigwetaTgCRHO6nFI0onWex
dP0z76DjZ4jBAs7GzsFkv3ck/ZfaQ6MxjXjcR1yYZFeTp3WlD3VIZVuZwohg78wo
IR/5QOoQjwoV5nbgH3l2f0h2pvrCJPvQiwbADzZJpklpg45D2Y8EIMtOQy64hZSz
2kFgy6oWuYKbuQf49Wi4
=oaGW
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from trac.mplayerhq.hu_616cc4a7_20250124_172732.html ===


[![MPlayer - The Movie Player](https://mplayerhq.hu/mplayer-logo.png)](https://mplayerhq.hu/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/query)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ← [Previous Ticket](/ticket/2294 "Ticket #2294")
* [Next Ticket](/ticket/2296 "Ticket #2296") →

---

Opened [9 years ago](/timeline?from=2016-04-26T20%3A40%3A00Z&precision=second "See timeline at Apr 26, 2016, 8:40:00 PM")

Closed [9 years ago](/timeline?from=2016-04-28T21%3A34%3A49Z&precision=second "See timeline at Apr 28, 2016, 9:34:49 PM")

Last modified [9 years ago](/timeline?from=2016-05-01T08%3A27%3A33Z&precision=second "See timeline at May 1, 2016, 8:27:33 AM")

## [#2295](/ticket/2295) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# Integer overflow and crash parsing gif files

| Reported by: | [ggrieco](/query?reporter=ggrieco&status=!closed) | Owned by: | [beastd](/query?owner=beastd&status=!closed) |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [demuxer](/query?component=demuxer&status=!closed) |
| Version: | [HEAD](/query?status=!closed&version=HEAD) | Severity: | [blocker](/query?severity=blocker&status=!closed) |
| Keywords: |  | Cc: |  |
| Blocked By: |  | Blocking: |  |
| Reproduced by developer: | [yes](/query?reproduced=1&status=!closed) | Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |

## Description

Summary of the bug:

Mplayer is crashing when playing a fuzzed gif file (attached). This bug is present in the last source snapshot (mplayer-export-2016-04-25) as well as older versions. I suspect this crash is related with an integer overflow happening just before.

How to reproduce:

```

$ ASAN_OPTIONS='abort_on_error=1' gdb --args ./mplayer -ao null -vo null overflow.gif
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from mplayer...done.
(gdb) r
Starting program: ./mplayer -ao null -vo null overflow.gif
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
MPlayer SVN-r37856-snapshot-4.8 (C) 2000-2016 MPlayer Team

Playing overflow.gif.
libavformat version 57.34.103 (internal)
GIF file format detected.
==836== WARNING: AddressSanitizer failed to allocate 0xffffffffe48e6289 bytes
VIDEO:  RGB]  65341x58685  8bpp  5.000 fps    0.0 kbps ( 0.0 kbyte/s)
==========================================================================
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
libavcodec version 57.38.100 (internal)
[IMGUTILS @ 0x555558187900]Picture size 65341x58685 is invalid
Could not open codec.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
Movie-Aspect is undefined - no prescaling applied.
VO: [null] 65341x58685 => 65341x58685 BGR 8-bit
Selected video codec: [rawbgr8] vfm: raw (RAW BGR8)
==========================================================================
Load subtitles in ./

Program received signal SIGSEGV, Segmentation fault.
0x0000555555d4c1b3 in new_demux_packet (len=<optimized out>) at libmpdemux/demuxer.h:300
300	    free(dp);
(gdb) bt
#0  0x0000555555d4c1b3 in new_demux_packet (len=<optimized out>) at libmpdemux/demuxer.h:300
#1  demux_gif_fill_buffer (demuxer=0x606a00003500, ds=<optimized out>) at libmpdemux/demux_gif.c:194
#2  0x0000555555b93395 in demux_fill_buffer (ds=0x601a0000aa10, demux=0x606a00003500) at libmpdemux/demuxer.c:649
#3  ds_get_next_pts (ds=0x601a0000aa10) at libmpdemux/demuxer.c:965
#4  0x0000555555981255 in print_file_properties (filename=<optimized out>, mpctx=0x55555818bd00 <mpctx_s>) at mplayer.c:526
#5  main (argc=6, argv=0x7fffffffe4c8) at mplayer.c:3603

...

```

### Attachments (1)

[overflow.gif](/attachment/ticket/2295/overflow.gif "View attachment")[​](/raw-attachment/ticket/2295/overflow.gif "Download")
(65 bytes
) - added by ggrieco [9 years ago](/timeline?from=2016-04-26T20%3A41%3A01Z&precision=second "See timeline at Apr 26, 2016, 8:41:01 PM").

Download all attachments as:
[.zip](/zip-attachment/ticket/2295/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### by ggrieco, [9 years ago](/timeline?from=2016-04-26T20%3A41%3A01Z&precision=second "See timeline at Apr 26, 2016, 8:41:01 PM")

| Attachment: | [*overflow.gif*](/attachment/ticket/2295/overflow.gif)[​](/raw-attachment/ticket/2295/overflow.gif "Download") added |
| --- | --- |

### [comment:1](#comment:1) by rxt, [9 years ago](/timeline?from=2016-04-27T19%3A26%3A43Z&precision=second "See timeline at Apr 27, 2016, 7:26:43 PM")

| Component: | demuxer → undetermined |
| --- | --- |
| Reproduced by developer: | set |
| Version: | unspecified → HEAD |

Reproducible only with -vo null

### [comment:2](#comment:2) by rxt, [9 years ago](/timeline?from=2016-04-28T21%3A34%3A49Z&precision=second "See timeline at Apr 28, 2016, 9:34:49 PM")

| Component: | undetermined → demuxer |
| --- | --- |
| Resolution: | → fixed |
| Status: | new → closed |

Fixed in r37857.

The gif demuxes assumes in many places that width\*height is <= INT\_MAX; this is not true with the sample. Fixed by validating the picture size.

Thanks for reporting.

### [comment:3](#comment:3) by Henri Salo, [9 years ago](/timeline?from=2016-05-01T08%3A27%3A33Z&precision=second "See timeline at May 1, 2016, 8:27:33 AM")

For cross-reference CVE-2016-4352 was assigned for this issue in: [​http://www.openwall.com/lists/oss-security/2016/04/29/7](http://www.openwall.com/lists/oss-security/2016/04/29/7)

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/2295?format=rss)
* [Comma-delimited Text](/ticket/2295?format=csv)
* [Tab-delimited Text](/ticket/2295?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>


