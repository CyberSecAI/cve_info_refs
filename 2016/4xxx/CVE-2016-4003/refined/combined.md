=== Content from issues.apache.org_a434c8d9_20250125_071812.html ===


[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-4507)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/WW "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-4507)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'Struts 2'](https://issues.apache.org/jira/secure/projectavatar?pid=12311041&avatarId=22177)

1. [Struts 2](/jira/browse/WW)
2. [WW-4507](/jira/browse/WW-4507)

# Struts 2 XSS vulnerability with <s:textfield>

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FWW-4507 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Closed
* **Priority:**
  ![](/jira/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Resolution:**
  Fixed
* **Affects Version/s:**
  2.3.16.3
* **Fix Version/s:**
  [2.3.28](/jira/issues/?jql=project+%3D+WW+AND+fixVersion+%3D+2.3.28 "2.3.28 Maintenance version of 2.3"), [2.5](/jira/issues/?jql=project+%3D+WW+AND+fixVersion+%3D+2.5 "2.5 Middle step to 3.0 version")
* **Component/s:**
  None
* **Labels:**
  + [struts2](/jira/issues/?jql=labels+%3D+struts2 "struts2")
  + [vulnerability](/jira/issues/?jql=labels+%3D+vulnerability "vulnerability")
  + [xss](/jira/issues/?jql=labels+%3D+xss "xss")
* **Environment:**

  Operating System: Windows 7. Application Server: JBoss-4.2.1.GA. Java: jdk1.5.0.11. Developloment Framework: Struts 2.3.16.3. Browser: FireFox 38.0.1
#### Description

WhiteHat Security (whitehatsec.com) has found an xss vulnerability with the <s:textfield> tag. When loading a url in a browser with some param name, in this case "myinput", and the jsp being loaded has the tag <s:textfield name="myinput" id="myinput"></s:textfield>, an alert message is popped open in the browser- which is WhiteHat's method of showing the vulnerability. Example url is: <http://localhost:8080/sample.action?myinput=%fc%80%80%80%80%a2%fc%80%80%80%80%bE%FC%80%80%80%80%BC%FC%80%80%80%81%B7%FC%80%80%80%81%A8%FC%80%80%80%81%B3%FC%80%80%80%81%A3%FC%80%80%80%81%A8%FC%80%80%80%81%A5%FC%80%80%80%81%A3%FC%80%80%80%81%AB%FC%80%80%80%80%BE%fc%80%80%80%80%bCscript%fc%80%80%80%80%bEalert%fc%80%80%80%80%a81%fc%80%80%80%80%a9%fc%80%80%80%80%bC%fc%80%80%80%80%aFscript%fc%80%80%80%80%bE>

#### Attachments

#### Issue Links

breaks

![Bug - A problem which impairs or prevents the functions of the product.](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[WW-4628](/jira/browse/WW-4628)
Space character and includeParams

* ![Major - Major loss of function.](/jira/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

mentioned in

![](https://issues.apache.org/jira/s/xd97tr/820010/13pdxe5/8.20.10/_/download/resources/com.atlassian.jira.jira-view-issue-plugin:linkingmodule/throbber)

[Page](https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=62686284) Loading...

#### Activity

#### People

Assignee:

![rgielen](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
René Gielen

Reporter:

![greaserscc@gmail.com](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
brian neisen

Votes:
0
Vote for this issue

Watchers:
8
Start watching this issue

#### Dates

Created:

28/May/15 15:33

Updated:

03/Aug/16 07:57

Resolved:

03/Mar/16 19:15

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from struts.apache.org_7898e82a_20250125_071812.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-028)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-028)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-028
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=62686284 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=62686284)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=62686284)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=62686284#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=62686284)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=62686284)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=62686284)
  + [Export to Word](/confluence/exportword?pageId=62686284)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=62686284)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-028](/confluence/display/WW/S2-028)

* Created by  [René Gielen](/confluence/display/~rgielen), last modified by  [Lukasz Lenart](/confluence/display/~lukaszlenart) on [Oct 31, 2017](/confluence/pages/diffpagesbyversion.action?pageId=62686284&selectedPageVersions=10&selectedPageVersions=11 "Show changes")

## Summary

Use of a JRE with broken URLDecoder implementation may lead to XSS vulnerability in Struts 2 based web applications.

| Who should read this | All Struts 2 developers and users |
| --- | --- |
| Impact of vulnerability | Affects of a cross-site scripting vulnerability. |
| Maximum security rating | Important |
| Recommendation | Upgrade runtime JRE to a recent major version, preferably 1.8. Alternatively upgrade to [Struts 2.3.28](/confluence/display/WW/Version%2BNotes%2B2.3.28) |
| Affected Software | Struts 2.0.0 - Struts Struts 2.3.24.1 |
| Reporter | WhiteHat Security ([whitehatsec.com](http://whitehatsec.com)) |
| CVE Identifier | CVE-2016-4003 |

## Problem

When using a single byte page encoding such as ISO-8895-1, an attacker might submit a non-spec URL-encoded parameter value including multi-byte characters.

Struts 2 used the standard JRE URLDecoder to decode parameter values. Especially JRE 1.5's URLDecoder implementation seems to be broken to the point that this non-spec encoding isn't rejected / filtered. In later JREs the issue was fixed, best known solution is found in JRE 1.8.

## Solution

Upgrade runtime JRE/JDK, preferably to the most recent 1.8 version.

Alternatively upgrade to Struts 2.3.28, which includes and uses a safe URLDecoder implementation from Apache Tomcat

## Backward compatibility

No issues expected when upgrading to Struts 2.3.28

## Workaround

Use UTF-8 for page and parameter encoding.

## Further Reference

 [WW-4507](https://issues.apache.org/jira/browse/WW-4507)
-
Getting issue details...
STATUS

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 75, "requestCorrelationId": "b9e8470040da298f"}

