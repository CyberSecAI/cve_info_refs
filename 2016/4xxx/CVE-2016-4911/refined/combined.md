=== Content from www.openwall.com_b8b5e551_20250125_230734.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160517194818.E7D25B2E00E@smtpvbsrv1.mitre.org>
Date: Tue, 17 May 2016 15:48:18 -0400 (EDT)
From: cve-assign@...re.org
To: morgan.fainberg@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for vulnerability in OpenStack Keystone

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Incorrect Audit IDs in Keystone Fernet Tokens can result in
> revocation bypass
>
> By rescoping a token a user will receive a new
> token without correct audit_ids, these incorrect audit_ids will prevent
> the entire chain of tokens from being revoked properly. This
> vulnerability does not impact revoking a token by its individual
> audit_id. Only deployments with Keystone configured to use Fernet tokens
> are impacted.
>
> <https://launchpad.net/bugs/1577558>

>> caused token rescoping to not work because audit ids were never pulled
>> from the original token.

Use CVE-2016-4911.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXO3T9AAoJEHb/MwWLVhi2vmEP/iC2MvbKll1QM0MxSqXkfJTz
lr771a5N2oPmfxz35nTu38BjcTXVMp0e0VO/9ZmqD0eoXaG6p8K64IcDP/tJkL1f
kIyf8EQEj0g0T8RkcV1J/cGkzd5sRT3EvxH6BJe7UPnW2NXcqO6j+LRY7R5ZFb2y
0iRRQx9HgqijRA8J+WN1tgaRDKeC5zv84rrNi/h0u7669Ps4tAJuaEvRNCMbRahI
MHXTvreTs6UMr8iqL8K1wFfNSVaBoS9ep3t31dr/ZLH0piAxHVzINSNyiqAUbGps
L2mkxY9XoI7AcgZh3C2iw5VD1A86BGEv3vuuSNK8/VOSPoovNaTtcErV25ria6cd
qtH6HQH1S4ibMLI7PDYXf09DwOa6Kbc1IyEKus4S8XSXbUutV9j3l1UaH+3psQcO
jLH2dD2pvVHznFaIrryz0jl/oKb/mPOcgQAFYelOSpwBle3GQdrqO9oBMIji8LIg
B+rLWs5RbeUPYyucXkRrQTU3pn3e0Rt+zxZ8Wpd/P2Yjkp+wNtcacscgqVdk/Njn
e/NaGYYRq/ReD9ES7xkYXkElMP8EO4RDZJhgcvtNODIQYvhPAU1gk06riE5QWk3Y
tZI6Sseir0KpqH3VjAHdAx/nBoAQJh7JdCYv+Xp0ffAPOEWAixfjXsF0emkJvSzg
CMj8C4b8j1qylWAbaTQz
=9W3o
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from answers.launchpad.net_da5dcf83_20250126_124019.html ===

[Log in / Register](https://answers.launchpad.net/keystone/%2Blogin)

[![](https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png)](https://launchpad.net/keystone)

## [OpenStack Identity (keystone)](https://launchpad.net/keystone)

* [Overview](https://launchpad.net/keystone)
* [Code](https://code.launchpad.net/keystone)
* [Bugs](https://bugs.launchpad.net/keystone)
* [Blueprints](https://blueprints.launchpad.net/keystone)
* [Translations](https://translations.launchpad.net/keystone)
* Answers

# Questions for OpenStack Identity (keystone)

**Launchpad does not know where
OpenStack Identity (keystone)
tracks support requests.**

OpenStack Identity (keystone) questions are
tracked in:
[keystone in Ubuntu](/ubuntu/%2Bsource/keystone).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_e5163751_20250125_230733.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <573B6E50.1010806@gmail.com>
Date: Tue, 17 May 2016 12:17:36 -0700
From: morgan fainberg <morgan.fainberg@...il.com>
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: CVE request for vulnerability in OpenStack Keystone

A vulnerability was discovered in OpenStack (see below). In order to
ensure full traceability, we need a CVE number assigned that we can
attach to further notifications. This issue is already public, although an
advisory was not sent yet.

Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in
revocation bypass
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: ==9.0.0

Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone
Fernet Token Provider. By rescoping a token a user will receive a new
token without correct audit_ids, these incorrect audit_ids will prevent
the entire chain of tokens from being revoked properly. This
vulnerability does not impact revoking a token by it's individual
audit_id. Only deployments with Keystone configured to use Fernet tokens
are impacted.

References:
<https://launchpad.net/bugs/1577558> <<https://launchpad.net/bugs/1577558>>

Thanks in advance,

--
Morgan Fainberg
OpenStack Vulnerability Management Team

Download attachment "[0xA07C6D8A.asc](10/1)" of type "application/pgp-keys" (30192 bytes)

Download attachment "[signature.asc](10/2)" of type "application/pgp-signature" (843 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from launchpad.net_024b305a_20250126_124025.html ===

[Log in / Register](https://launchpad.net/~icordasc/%2Blogin)

[![](https://launchpadlibrarian.net/298967102/ian-glider%2064sq.png)](https://launchpad.net/~icordasc)

## [Ian Cordasco](https://launchpad.net/~icordasc)

* Overview
* [Code](https://code.launchpad.net/~icordasc)
* [Bugs](https://bugs.launchpad.net/~icordasc)
* [Blueprints](https://blueprints.launchpad.net/~icordasc)
* [Translations](https://translations.launchpad.net/~icordasc)
* [Answers](https://answers.launchpad.net/~icordasc)

* [Related packages](https://launchpad.net/~icordasc/%2Brelated-packages)
* [Related projects](https://launchpad.net/~icordasc/%2Brelated-projects)

## User information

Launchpad Id:
icordasc

Email:
[Log in](%2Blogin) for email information.

Member since:
2012-07-19

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~icordasc/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sigmavirus24**
 on
**irc.freenode.net**

![IRC](/@@/social-irc "IRC")
**sigmavirus24**
 on
**irc.oftc.net**

## [All bugs in progress](https://launchpad.net/~icordasc/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1346648 [glance APIs missing target for most policy checks](https://bugs.launchpad.net/glance/%2Bbug/1346648) |  |
| --- | --- | --- |
| in [Glance](/glance) | | |

| --- | --- | --- | --- | --- | --- |
||  | #1406582 [Configuration should use 'auth\_strategy' instead of 'flavor'](https://bugs.launchpad.net/glance/%2Bbug/1406582) |  |
| --- | --- | --- |
| in [Glance](/glance) | | |

||  | #1253963 [Can not define only image creator can delete the image](https://bugs.launchpad.net/glance/%2Bbug/1253963) |  |
| --- | --- | --- |
| in [Glance](/glance) | | |

## [All assigned blueprints](/~icordasc/%2Bspecs?role=assignee) Assigned blueprints

| **[Policy Validation CLI Utility](https://blueprints.launchpad.net/oslo.policy/%2Bspec/oslopolicy-cli "oslopolicy-cli")** for **oslo.policy**  A command-line utility to check or validate a policy file with a specified token and privileges. | |
| --- | --- |

## [All memberships](https://launchpad.net/~icordasc/%2Bparticipation) Latest memberships

| [Craton Developers](/~craton)  Joined on 2016-07-27 | |
| --- | --- |
| [craton-drivers](/~craton-drivers)  Joined on 2016-06-21 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_504c6d7d_20250126_124023.html ===




=== Content from launchpad.net_4deb75d1_20250126_124027.html ===

[Log in / Register](https://launchpad.net/~lbragstad/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~lbragstad)

## [Lance Bragstad](https://launchpad.net/~lbragstad)

* Overview
* [Code](https://code.launchpad.net/~lbragstad)
* [Bugs](https://bugs.launchpad.net/~lbragstad)
* [Blueprints](https://blueprints.launchpad.net/~lbragstad)
* [Translations](https://translations.launchpad.net/~lbragstad)
* [Answers](https://answers.launchpad.net/~lbragstad)

* [Related packages](https://launchpad.net/~lbragstad/%2Brelated-packages)
* [Related projects](https://launchpad.net/~lbragstad/%2Brelated-projects)

## User information

Launchpad Id:
lbragstad

Email:
[Log in](%2Blogin) for email information.

Member since:
2012-07-23

[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)

Languages:

English

SSH keys:

[ubuntu@devstack-upstream](%2Bsshkeys)

[lbragstad@laptop](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~lbragstad/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**lbragstad**
 on
**irc.freenode.net**

## [All bugs in progress](https://launchpad.net/~lbragstad/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1840235 [[Errno 110] ETIMEDOUT with endpoint discovery and token request](https://bugs.launchpad.net/keystoneauth/%2Bbug/1840235) |  |
| --- | --- | --- |
| in [keystoneauth](/keystoneauth) | | |

| --- | --- | --- | --- | --- | --- |

## [All assigned blueprints](/~lbragstad/%2Bspecs?role=assignee) Assigned blueprints

| **[Implement Secure RBAC in glance](https://blueprints.launchpad.net/glance/%2Bspec/secure-rbac "secure-rbac")** for **Glance**  Implement Secure RBAC in glance | |
| --- | --- |

## [All memberships](https://launchpad.net/~lbragstad/%2Bparticipation) Latest memberships

| [Oslo Limit Core](/~oslo-limit-core)  Joined on 2018-03-07 | |
| --- | --- |
| [Keystone Drivers](/~keystone-drivers)  Joined on 2014-07-10 | |
| [Keystone Bugs](/~keystone-bugs)  Joined on 2014-06-24 | |
| [OpenStack Contributors](/~openstack-cla)  Joined on 2012-11-01 | |
| [OpenStack Team](/~openstack)  Joined on 2012-07-23 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_f6dd5330_20250126_124015.html ===




=== Content from launchpad.net_cb7e2f6f_20250126_124011.html ===

[Log in / Register](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Blogin)

[![](https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png)](https://launchpad.net/keystone)

## [OpenStack Identity (keystone)](https://launchpad.net/keystone)

* [Overview](https://launchpad.net/keystone)
* [Code](https://code.launchpad.net/keystone)
* [Bugs](https://bugs.launchpad.net/keystone)
* [Blueprints](https://blueprints.launchpad.net/keystone)
* [Translations](https://translations.launchpad.net/keystone)
* [Answers](https://answers.launchpad.net/keystone)

# [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent (CVE-2016-4911)

Bug #1577558 reported by
[Lance Bragstad](https://launchpad.net/~lbragstad)
on 2016-05-02

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Identity (keystone)](https://bugs.launchpad.net/keystone) | Fix Released | High | [Lance Bragstad](https://launchpad.net/~lbragstad) | [OpenStack Identity (keystone) newton-1 "n1"](https://launchpad.net/keystone/%2Bmilestone/newton-1) |
|  | [Mitaka](https://bugs.launchpad.net/keystone/mitaka) | Fix Released | High | Unassigned |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |

### Bug Description

If you set the token provider to token.provider = fernet, get an unscoped token from v2.0, then rescope that token to a project, you'll notice the audit ids don't match. I've recreated this issue in a test [0].

What should happen is that the unscoped token response will have a list of audit\_ids containing a single audit\_id. The project scoped token response from the unscoped token will also have a list of audit\_ids in the token response but the original audit\_id from the unscoped token will be in the list of the project scoped token.

Right now this behavior doesn't exist in with the fernet provider on v2.0.

[0] <https://review.openstack.org/#/c/311816/1>

Tags:

[fernet](/keystone/%2Bbugs?field.tag=fernet)
[in-stable-mitaka](/keystone/%2Bbugs?field.tag=in-stable-mitaka)
[mitaka-backport-potential](/keystone/%2Bbugs?field.tag=mitaka-backport-potential)

## CVE References

* [2016-4911](/bugs/cve/2016-4911 "The Fernet Token Provider in OpenStac...")

[Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad)
on 2016-05-02

| **tags**: | added: fernet |
| --- | --- |
| **tags**: | added: mitaka-backport-potential |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-02:  [**Fix proposed to keystone (master)**](/keystone/%2Bbug/1577558/comments/1) |  |  | [#1](/keystone/%2Bbug/1577558/comments/1) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/311886>

Fix proposed to branch: master
Review: https://review.openstack.org/311886

| Changed in keystone: | |
| --- | --- |
| **assignee**: | nobody → Lance Bragstad (lbragstad) |
| **status**: | New → In Progress |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Lance Bragstad (lbragstad) → Steve Martinelli (stevemar) |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Steve Martinelli (stevemar) → Lance Bragstad (lbragstad) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/2) |  |  | [#2](/keystone/%2Bbug/1577558/comments/2) |
| --- | --- | --- | --- |

This is causing race failures in the gate, so that's why it's marked high:

<http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d>

This is causing race failures in the gate, so that's why it's marked high:
http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list\_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles\_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth\_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token\_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d

| Changed in keystone: | |
| --- | --- |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix proposed to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/3) |  |  | [#3](/keystone/%2Bbug/1577558/comments/3) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/312582>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/312582

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (master)**](/keystone/%2Bbug/1577558/comments/4) |  |  | [#4](/keystone/%2Bbug/1577558/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/311886>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240>

Submitter: Jenkins

Branch: master

commit 0d376025bae61bf5ee19d992c7f336b99ac69240

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

Reviewed: https://review.openstack.org/311886
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240
Submitter: Jenkins
Branch: master
commit 0d376025bae61bf5ee19d992c7f336b99ac69240
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

| Changed in keystone: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brant Knudson (blk-u)](https://launchpad.net/~blk-u) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/5) |  |  | [#5](/keystone/%2Bbug/1577558/comments/5) |
| --- | --- | --- | --- |

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

| **information type**: | Public → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#6](/keystone/%2Bbug/1577558/comments/6) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#7](/keystone/%2Bbug/1577558/comments/7) |
| --- | --- | --- | --- |

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/8) |  |  | [#8](/keystone/%2Bbug/1577558/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/312582>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572>

Submitter: Jenkins

Branch: stable/mitaka

commit ee1dc941042d1f71699971c5c30566af1b348572

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

    (cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

Reviewed: https://review.openstack.org/312582
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572
Submitter: Jenkins
Branch: stable/mitaka
commit ee1dc941042d1f71699971c5c30566af1b348572
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e
(cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

| **tags**: | added: in-stable-mitaka |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-09

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/9) |  |  | [#9](/keystone/%2Bbug/1577558/comments/9) |
| --- | --- | --- | --- |

Proposed impact description -

Title: Incorrect Audit IDs in Keystone Fernet Tokens

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: Master (Newton), Mitaka

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Proposed impact description -
Title: Incorrect Audit IDs in Keystone Fernet Tokens
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: Master (Newton), Mitaka
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#10](/keystone/%2Bbug/1577558/comments/10) |
| --- | --- | --- | --- |

2nd Revision impact statement

Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: >=9.0.0

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

2nd Revision impact statement
Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: >=9.0.0
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#11](/keystone/%2Bbug/1577558/comments/11) |
| --- | --- | --- | --- |

Erm, I think I got the Affects >= incorrect.

Erm, I think I got the Affects >= incorrect.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-17: |  |  | [#12](/keystone/%2Bbug/1577558/comments/12) |
| --- | --- | --- | --- |

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-17: |  |  | [#13](/keystone/%2Bbug/1577558/comments/13) |
| --- | --- | --- | --- |

+1 on the impact description. Thanks Morgan!

+1 on the impact description. Thanks Morgan!

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-17

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ian Cordasco (icordasc)](https://launchpad.net/~icordasc) wrote on 2016-05-17: |  |  | [#14](/keystone/%2Bbug/1577558/comments/14) |
| --- | --- | --- | --- |

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Martinelli (stevemar)](https://launchpad.net/~stevemar) wrote on 2016-05-17: |  |  | [#15](/keystone/%2Bbug/1577558/comments/15) |
| --- | --- | --- | --- |

impact looks fine to me!

impact looks fine to me!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-18: |  |  | [#16](/keystone/%2Bbug/1577558/comments/16) |
| --- | --- | --- | --- |

@Ian,

I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

@Ian,
I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Thode (prometheanfire)](https://launchpad.net/~prometheanfire) wrote on 2016-05-18: |  |  | [#17](/keystone/%2Bbug/1577558/comments/17) |
| --- | --- | --- | --- |

Did this impact liberty?

Did this impact liberty?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#18](/keystone/%2Bbug/1577558/comments/18) |
| --- | --- | --- | --- |

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.

I'll pull down the latest liberty branch and test this locally.

[0] <https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41>

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.
I'll pull down the latest liberty branch and test this locally.
[0] https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#19](/keystone/%2Bbug/1577558/comments/19) |
| --- | --- | --- | --- |

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:

commit 26240963712541d215d414fa71596cccc60dd7ce

I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:

"audit\_ids": [

                "i8OpkdQHSJOgMQVIJgkG9w",

                "8HAaHKMnSxe-wrTTv2RgxA"

            ],

This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.

original token: <http://paste.openstack.org/show/497523/>

rescoped token: <http://paste.openstack.org/show/497524/>

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:
commit 26240963712541d215d414fa71596cccc60dd7ce
I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:
"audit\_ids": [
"i8OpkdQHSJOgMQVIJgkG9w",
"8HAaHKMnSxe-wrTTv2RgxA"
],
This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.
original token: http://paste.openstack.org/show/497523/
rescoped token: http://paste.openstack.org/show/497524/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-05-23:  [**Fix included in openstack/keystone 9.0.1**](/keystone/%2Bbug/1577558/comments/20) |  |  | [#20](/keystone/%2Bbug/1577558/comments/20) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 9.0.1 release.

This issue was fixed in the openstack/keystone 9.0.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-24:  [**Related fix proposed to ossa (master)**](/keystone/%2Bbug/1577558/comments/21) |  |  | [#21](/keystone/%2Bbug/1577558/comments/21) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/320209>

Related fix proposed to branch: master
Review: https://review.openstack.org/320209

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-24

| **summary**: | - v2.0 fernet tokens audit ids are inconsistent+ [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent+ (CVE-2016-4911) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-31:  [**Related fix merged to ossa (master)**](/keystone/%2Bbug/1577558/comments/22) |  |  | [#22](/keystone/%2Bbug/1577558/comments/22) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/320209>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024>

Submitter: Jenkins

Branch: master

commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024

Author: Morgan Fainberg <email address hidden>

Date: Mon May 23 20:48:44 2016 -0700

Adds OSSA 2016-008 (CVE-2016-4911)

Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928

    Related-Bug: #1577558

Reviewed: https://review.openstack.org/320209
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Submitter: Jenkins
Branch: master
commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Author: Morgan Fainberg <morgan.fainberg@gmail.com>
Date: Mon May 23 20:48:44 2016 -0700
Adds OSSA 2016-008 (CVE-2016-4911)
Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928
Related-Bug: #1577558

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-06-02:  [**Fix included in openstack/keystone 10.0.0.0b1**](/keystone/%2Bbug/1577558/comments/23) |  |  | [#23](/keystone/%2Bbug/1577558/comments/23) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-07-07

| Changed in keystone: | |
| --- | --- |
| **milestone**: | none → newton-1 |

[See full activity log](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/keystone/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1578210](https://bugs.launchpad.net/keystone/%2Bbug/1578210 "Keystone fails negative tests with unauthenticated users")

You are
[not directly subscribed to this bug's notifications.](/keystone/%2Bbug/1577558/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_7a5d68a9_20250126_124013.html ===

[Log in / Register](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Blogin)

[![](https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png)](https://launchpad.net/keystone)

## [OpenStack Identity (keystone)](https://launchpad.net/keystone)

* [Overview](https://launchpad.net/keystone)
* [Code](https://code.launchpad.net/keystone)
* [Bugs](https://bugs.launchpad.net/keystone)
* [Blueprints](https://blueprints.launchpad.net/keystone)
* [Translations](https://translations.launchpad.net/keystone)
* [Answers](https://answers.launchpad.net/keystone)

# [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent (CVE-2016-4911)

Bug #1577558 reported by
[Lance Bragstad](https://launchpad.net/~lbragstad)
on 2016-05-02

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Identity (keystone)](https://bugs.launchpad.net/keystone) | Fix Released | High | [Lance Bragstad](https://launchpad.net/~lbragstad) | [OpenStack Identity (keystone) newton-1 "n1"](https://launchpad.net/keystone/%2Bmilestone/newton-1) |
|  | [Mitaka](https://bugs.launchpad.net/keystone/mitaka) | Fix Released | High | Unassigned |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |

### Bug Description

If you set the token provider to token.provider = fernet, get an unscoped token from v2.0, then rescope that token to a project, you'll notice the audit ids don't match. I've recreated this issue in a test [0].

What should happen is that the unscoped token response will have a list of audit\_ids containing a single audit\_id. The project scoped token response from the unscoped token will also have a list of audit\_ids in the token response but the original audit\_id from the unscoped token will be in the list of the project scoped token.

Right now this behavior doesn't exist in with the fernet provider on v2.0.

[0] <https://review.openstack.org/#/c/311816/1>

Tags:

[fernet](/keystone/%2Bbugs?field.tag=fernet)
[in-stable-mitaka](/keystone/%2Bbugs?field.tag=in-stable-mitaka)
[mitaka-backport-potential](/keystone/%2Bbugs?field.tag=mitaka-backport-potential)

## CVE References

* [2016-4911](/bugs/cve/2016-4911 "The Fernet Token Provider in OpenStac...")

[Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad)
on 2016-05-02

| **tags**: | added: fernet |
| --- | --- |
| **tags**: | added: mitaka-backport-potential |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-02:  [**Fix proposed to keystone (master)**](/keystone/%2Bbug/1577558/comments/1) |  |  | [#1](/keystone/%2Bbug/1577558/comments/1) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/311886>

Fix proposed to branch: master
Review: https://review.openstack.org/311886

| Changed in keystone: | |
| --- | --- |
| **assignee**: | nobody → Lance Bragstad (lbragstad) |
| **status**: | New → In Progress |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Lance Bragstad (lbragstad) → Steve Martinelli (stevemar) |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Steve Martinelli (stevemar) → Lance Bragstad (lbragstad) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/2) |  |  | [#2](/keystone/%2Bbug/1577558/comments/2) |
| --- | --- | --- | --- |

This is causing race failures in the gate, so that's why it's marked high:

<http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d>

This is causing race failures in the gate, so that's why it's marked high:
http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list\_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles\_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth\_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token\_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d

| Changed in keystone: | |
| --- | --- |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix proposed to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/3) |  |  | [#3](/keystone/%2Bbug/1577558/comments/3) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/312582>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/312582

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (master)**](/keystone/%2Bbug/1577558/comments/4) |  |  | [#4](/keystone/%2Bbug/1577558/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/311886>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240>

Submitter: Jenkins

Branch: master

commit 0d376025bae61bf5ee19d992c7f336b99ac69240

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

Reviewed: https://review.openstack.org/311886
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240
Submitter: Jenkins
Branch: master
commit 0d376025bae61bf5ee19d992c7f336b99ac69240
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

| Changed in keystone: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brant Knudson (blk-u)](https://launchpad.net/~blk-u) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/5) |  |  | [#5](/keystone/%2Bbug/1577558/comments/5) |
| --- | --- | --- | --- |

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

| **information type**: | Public → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#6](/keystone/%2Bbug/1577558/comments/6) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#7](/keystone/%2Bbug/1577558/comments/7) |
| --- | --- | --- | --- |

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/8) |  |  | [#8](/keystone/%2Bbug/1577558/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/312582>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572>

Submitter: Jenkins

Branch: stable/mitaka

commit ee1dc941042d1f71699971c5c30566af1b348572

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

    (cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

Reviewed: https://review.openstack.org/312582
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572
Submitter: Jenkins
Branch: stable/mitaka
commit ee1dc941042d1f71699971c5c30566af1b348572
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e
(cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

| **tags**: | added: in-stable-mitaka |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-09

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/9) |  |  | [#9](/keystone/%2Bbug/1577558/comments/9) |
| --- | --- | --- | --- |

Proposed impact description -

Title: Incorrect Audit IDs in Keystone Fernet Tokens

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: Master (Newton), Mitaka

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Proposed impact description -
Title: Incorrect Audit IDs in Keystone Fernet Tokens
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: Master (Newton), Mitaka
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#10](/keystone/%2Bbug/1577558/comments/10) |
| --- | --- | --- | --- |

2nd Revision impact statement

Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: >=9.0.0

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

2nd Revision impact statement
Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: >=9.0.0
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#11](/keystone/%2Bbug/1577558/comments/11) |
| --- | --- | --- | --- |

Erm, I think I got the Affects >= incorrect.

Erm, I think I got the Affects >= incorrect.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-17: |  |  | [#12](/keystone/%2Bbug/1577558/comments/12) |
| --- | --- | --- | --- |

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-17: |  |  | [#13](/keystone/%2Bbug/1577558/comments/13) |
| --- | --- | --- | --- |

+1 on the impact description. Thanks Morgan!

+1 on the impact description. Thanks Morgan!

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-17

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ian Cordasco (icordasc)](https://launchpad.net/~icordasc) wrote on 2016-05-17: |  |  | [#14](/keystone/%2Bbug/1577558/comments/14) |
| --- | --- | --- | --- |

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Martinelli (stevemar)](https://launchpad.net/~stevemar) wrote on 2016-05-17: |  |  | [#15](/keystone/%2Bbug/1577558/comments/15) |
| --- | --- | --- | --- |

impact looks fine to me!

impact looks fine to me!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-18: |  |  | [#16](/keystone/%2Bbug/1577558/comments/16) |
| --- | --- | --- | --- |

@Ian,

I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

@Ian,
I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Thode (prometheanfire)](https://launchpad.net/~prometheanfire) wrote on 2016-05-18: |  |  | [#17](/keystone/%2Bbug/1577558/comments/17) |
| --- | --- | --- | --- |

Did this impact liberty?

Did this impact liberty?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#18](/keystone/%2Bbug/1577558/comments/18) |
| --- | --- | --- | --- |

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.

I'll pull down the latest liberty branch and test this locally.

[0] <https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41>

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.
I'll pull down the latest liberty branch and test this locally.
[0] https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#19](/keystone/%2Bbug/1577558/comments/19) |
| --- | --- | --- | --- |

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:

commit 26240963712541d215d414fa71596cccc60dd7ce

I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:

"audit\_ids": [

                "i8OpkdQHSJOgMQVIJgkG9w",

                "8HAaHKMnSxe-wrTTv2RgxA"

            ],

This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.

original token: <http://paste.openstack.org/show/497523/>

rescoped token: <http://paste.openstack.org/show/497524/>

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:
commit 26240963712541d215d414fa71596cccc60dd7ce
I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:
"audit\_ids": [
"i8OpkdQHSJOgMQVIJgkG9w",
"8HAaHKMnSxe-wrTTv2RgxA"
],
This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.
original token: http://paste.openstack.org/show/497523/
rescoped token: http://paste.openstack.org/show/497524/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-05-23:  [**Fix included in openstack/keystone 9.0.1**](/keystone/%2Bbug/1577558/comments/20) |  |  | [#20](/keystone/%2Bbug/1577558/comments/20) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 9.0.1 release.

This issue was fixed in the openstack/keystone 9.0.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-24:  [**Related fix proposed to ossa (master)**](/keystone/%2Bbug/1577558/comments/21) |  |  | [#21](/keystone/%2Bbug/1577558/comments/21) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/320209>

Related fix proposed to branch: master
Review: https://review.openstack.org/320209

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-24

| **summary**: | - v2.0 fernet tokens audit ids are inconsistent+ [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent+ (CVE-2016-4911) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-31:  [**Related fix merged to ossa (master)**](/keystone/%2Bbug/1577558/comments/22) |  |  | [#22](/keystone/%2Bbug/1577558/comments/22) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/320209>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024>

Submitter: Jenkins

Branch: master

commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024

Author: Morgan Fainberg <email address hidden>

Date: Mon May 23 20:48:44 2016 -0700

Adds OSSA 2016-008 (CVE-2016-4911)

Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928

    Related-Bug: #1577558

Reviewed: https://review.openstack.org/320209
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Submitter: Jenkins
Branch: master
commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Author: Morgan Fainberg <morgan.fainberg@gmail.com>
Date: Mon May 23 20:48:44 2016 -0700
Adds OSSA 2016-008 (CVE-2016-4911)
Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928
Related-Bug: #1577558

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-06-02:  [**Fix included in openstack/keystone 10.0.0.0b1**](/keystone/%2Bbug/1577558/comments/23) |  |  | [#23](/keystone/%2Bbug/1577558/comments/23) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-07-07

| Changed in keystone: | |
| --- | --- |
| **milestone**: | none → newton-1 |

[See full activity log](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/keystone/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1578210](https://bugs.launchpad.net/keystone/%2Bbug/1578210 "Keystone fails negative tests with unauthenticated users")

You are
[not directly subscribed to this bug's notifications.](/keystone/%2Bbug/1577558/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_358978c3_20250126_124018.html ===

[Log in / Register](https://launchpad.net/~hudson-openstack/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~hudson-openstack)

## [OpenStack Infra](https://launchpad.net/~hudson-openstack)

* Overview
* [Code](https://code.launchpad.net/~hudson-openstack)
* [Bugs](https://bugs.launchpad.net/~hudson-openstack)
* [Blueprints](https://blueprints.launchpad.net/~hudson-openstack)
* [Translations](https://translations.launchpad.net/~hudson-openstack)
* [Answers](https://answers.launchpad.net/~hudson-openstack)

* [Related packages](https://launchpad.net/~hudson-openstack/%2Brelated-packages)
* [Related projects](https://launchpad.net/~hudson-openstack/%2Brelated-projects)

## User information

Launchpad Id:
hudson-openstack

Email:
[Log in](%2Blogin) for email information.

Member since:
2010-07-14

[![Icon of Burrow](https://launchpadlibrarian.net/67728214/os14.png "Member of Burrow")](/~burrow)
[![Icon of Citrix OpenStack development team](https://launchpadlibrarian.net/64472709/Citrix%2014.png "Member of Citrix OpenStack development team")](/~citrix-openstack)
[![Icon of (deprecated) OpenStack PPA maintainers](https://launchpadlibrarian.net/87891894/ppa.gif "Member of (deprecated) OpenStack PPA maintainers")](/~openstack-ppa)
[![Icon of Designate Core](https://launchpadlibrarian.net/360468328/designate_14.jpg "Member of Designate Core")](/~designate-core)
[![Icon of Designate Drivers](https://launchpadlibrarian.net/360468067/designate_14.jpg "Member of Designate Drivers")](/~designate-drivers)
[![Icon of MidoNet Bugs](https://launchpadlibrarian.net/228074955/midonet_14x14.png "Member of MidoNet Bugs")](/~midonet-bugs)
[![Icon of Nova Bug Team](https://launchpadlibrarian.net/108832444/bug.gif "Member of Nova Bug Team")](/~nova-bugs)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)

Languages:

English

OpenPGP keys:

72571ACC301E6FE900837F5CDF85501232EE128C

SSH keys:

[hudson@hudson](%2Bsshkeys)

[jenkins@vpcslave](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[6503](https://launchpad.net/~hudson-openstack/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All memberships](https://launchpad.net/~hudson-openstack/%2Bparticipation) Latest memberships

| [Compute Hyper-V Bugs](/~compute-hyperv-bugs)  Joined on 2019-08-28 | |
| --- | --- |
| [OS-Win Bugs](/~os-win-bugs)  Joined on 2019-08-28 | |
| [Networking Hyper-V Bugs](/~networking-hyperv-bugs)  Joined on 2019-08-28 | |
| [kolla-drivers](/~kolla-drivers)  Joined on 2019-05-20 | |
| [fixtures-git-bugs](/~fixtures-git-bugs)  Joined on 2018-03-25 | |

## [Recent activities](https://launchpad.net/~hudson-openstack/%2Bkarma) Most active in

| [StarlingX](/starlingx) |  |
| --- | --- |
| [kolla-ansible](/kolla-ansible) |  |
| [kolla](/kolla) |  |
| [kayobe](/kayobe) |  |
| [OpenStack Compute (nova)](/nova) |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_d7e350ba_20250126_124014.html ===




=== Content from launchpad.net_9e50c715_20250126_124026.html ===

[Log in / Register](https://launchpad.net/~tristan-cacqueray/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~tristan-cacqueray)

## [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray)

* Overview
* [Code](https://code.launchpad.net/~tristan-cacqueray)
* [Bugs](https://bugs.launchpad.net/~tristan-cacqueray)
* [Blueprints](https://blueprints.launchpad.net/~tristan-cacqueray)
* [Translations](https://translations.launchpad.net/~tristan-cacqueray)
* [Answers](https://answers.launchpad.net/~tristan-cacqueray)

* [Related packages](https://launchpad.net/~tristan-cacqueray/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tristan-cacqueray/%2Brelated-projects)

## User information

Launchpad Id:
tristan-cacqueray

Email:
[Log in](%2Blogin) for email information.

Member since:
2013-10-25

[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

EB103DE8B5E69E631C6FF17922B9A05C925CC5D8

SSH keys:

[localadmin@controller](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~tristan-cacqueray/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tristanC**
 on
**irc.freenode.net**

## [All memberships](https://launchpad.net/~tristan-cacqueray/%2Bparticipation) Latest memberships

| [Swiftsync dev](/~swiftsync-devteam)  Joined on 2014-02-13 | |
| --- | --- |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2013-12-12 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from security.openstack.org_99b25c56_20250125_230738.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2016-008: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass

# OSSA-2016-008: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass[Â¶](#ossa-2016-008-incorrect-audit-ids-in-keystone-fernet-tokens-can-result-in-revocation-bypass "Link to this heading")

Date:

May 23, 2016

CVE:

CVE-2016-4911

## Affects[Â¶](#affects "Link to this heading")

* Keystone: ==9.0.0

## Description[Â¶](#description "Link to this heading")

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by its individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.openstack.org/#/c/312582/> (Mitaka)
* <https://review.openstack.org/#/c/311886/> (Newton)

## Credits[Â¶](#credits "Link to this heading")

* Lance Bragstad from Rackspace (CVE-2016-4911)

## References[Â¶](#references "Link to this heading")

* <https://bugs.launchpad.net/bugs/1577558>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4911>

## Notes[Â¶](#notes "Link to this heading")

* This fix was included in the openstack/keystone 9.0.1 (mitaka)
  release.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2016-008: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from bugs.launchpad.net_feec4c56_20250125_230736.html ===

[Log in / Register](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Blogin)

[![](https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png)](https://launchpad.net/keystone)

## [OpenStack Identity (keystone)](https://launchpad.net/keystone)

* [Overview](https://launchpad.net/keystone)
* [Code](https://code.launchpad.net/keystone)
* [Bugs](https://bugs.launchpad.net/keystone)
* [Blueprints](https://blueprints.launchpad.net/keystone)
* [Translations](https://translations.launchpad.net/keystone)
* [Answers](https://answers.launchpad.net/keystone)

# [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent (CVE-2016-4911)

Bug #1577558 reported by
[Lance Bragstad](https://launchpad.net/~lbragstad)
on 2016-05-02

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Identity (keystone)](https://bugs.launchpad.net/keystone) | Fix Released | High | [Lance Bragstad](https://launchpad.net/~lbragstad) | [OpenStack Identity (keystone) newton-1 "n1"](https://launchpad.net/keystone/%2Bmilestone/newton-1) |
|  | [Mitaka](https://bugs.launchpad.net/keystone/mitaka) | Fix Released | High | Unassigned |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |

### Bug Description

If you set the token provider to token.provider = fernet, get an unscoped token from v2.0, then rescope that token to a project, you'll notice the audit ids don't match. I've recreated this issue in a test [0].

What should happen is that the unscoped token response will have a list of audit\_ids containing a single audit\_id. The project scoped token response from the unscoped token will also have a list of audit\_ids in the token response but the original audit\_id from the unscoped token will be in the list of the project scoped token.

Right now this behavior doesn't exist in with the fernet provider on v2.0.

[0] <https://review.openstack.org/#/c/311816/1>

Tags:

[fernet](/keystone/%2Bbugs?field.tag=fernet)
[in-stable-mitaka](/keystone/%2Bbugs?field.tag=in-stable-mitaka)
[mitaka-backport-potential](/keystone/%2Bbugs?field.tag=mitaka-backport-potential)

## CVE References

* [2016-4911](/bugs/cve/2016-4911 "The Fernet Token Provider in OpenStac...")

[Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad)
on 2016-05-02

| **tags**: | added: fernet |
| --- | --- |
| **tags**: | added: mitaka-backport-potential |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-02:  [**Fix proposed to keystone (master)**](/keystone/%2Bbug/1577558/comments/1) |  |  | [#1](/keystone/%2Bbug/1577558/comments/1) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/311886>

Fix proposed to branch: master
Review: https://review.openstack.org/311886

| Changed in keystone: | |
| --- | --- |
| **assignee**: | nobody → Lance Bragstad (lbragstad) |
| **status**: | New → In Progress |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Lance Bragstad (lbragstad) → Steve Martinelli (stevemar) |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-05-04

| Changed in keystone: | |
| --- | --- |
| **assignee**: | Steve Martinelli (stevemar) → Lance Bragstad (lbragstad) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Riedemann (mriedem)](https://launchpad.net/~mriedem) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/2) |  |  | [#2](/keystone/%2Bbug/1577558/comments/2) |
| --- | --- | --- | --- |

This is causing race failures in the gate, so that's why it's marked high:

<http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers._impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d>

This is causing race failures in the gate, so that's why it's marked high:
http://logstash.openstack.org/#dashboard/file/logstash.json?query=(message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20RolesClient.list\_roles%20of%20%26lt%3Btempest.services.identity.v2.json.roles\_client.RolesClient%5C%22%20OR%20message%3A%5C%22testtools.matchers.\_impl.MismatchError%3A%20%26lt%3Bbound%20method%20TokenClient.auth\_token%20of%20%26lt%3Btempest.lib.services.identity.v2.token\_client.TokenClient%5C%22)%20AND%20tags%3A%5C%22console%5C%22&from=7d

| Changed in keystone: | |
| --- | --- |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix proposed to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/3) |  |  | [#3](/keystone/%2Bbug/1577558/comments/3) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/312582>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/312582

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (master)**](/keystone/%2Bbug/1577558/comments/4) |  |  | [#4](/keystone/%2Bbug/1577558/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/311886>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240>

Submitter: Jenkins

Branch: master

commit 0d376025bae61bf5ee19d992c7f336b99ac69240

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

Reviewed: https://review.openstack.org/311886
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=0d376025bae61bf5ee19d992c7f336b99ac69240
Submitter: Jenkins
Branch: master
commit 0d376025bae61bf5ee19d992c7f336b99ac69240
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

| Changed in keystone: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brant Knudson (blk-u)](https://launchpad.net/~blk-u) wrote on 2016-05-04:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/5) |  |  | [#5](/keystone/%2Bbug/1577558/comments/5) |
| --- | --- | --- | --- |

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

This means that if you're using fernet then revocation doesn't work, because we revoke by audit ID.

| **information type**: | Public → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#6](/keystone/%2Bbug/1577558/comments/6) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-05-04: |  |  | [#7](/keystone/%2Bbug/1577558/comments/7) |
| --- | --- | --- | --- |

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Does this mean token revocation is broken for all production deployments using fernet tokens? Only affects stable/mitaka, or was the implementation available in any earlier releases as well?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-04:  [**Fix merged to keystone (stable/mitaka)**](/keystone/%2Bbug/1577558/comments/8) |  |  | [#8](/keystone/%2Bbug/1577558/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/312582>

Committed: <https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572>

Submitter: Jenkins

Branch: stable/mitaka

commit ee1dc941042d1f71699971c5c30566af1b348572

Author: Lance Bragstad <email address hidden>

Date: Mon May 2 19:16:11 2016 +0000

Fix fernet audit ids for v2.0

The fernet token provider was doing some weird things with audit ids that

    caused token rescoping to not work because audit ids were never pulled from the

    original token. This commit also enables some tests for v2.0 authentication

    with the Fernet as the token provider.

Closes-Bug: 1577558

    Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e

    (cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

Reviewed: https://review.openstack.org/312582
Committed: https://git.openstack.org/cgit/openstack/keystone/commit/?id=ee1dc941042d1f71699971c5c30566af1b348572
Submitter: Jenkins
Branch: stable/mitaka
commit ee1dc941042d1f71699971c5c30566af1b348572
Author: Lance Bragstad <lbragstad@gmail.com>
Date: Mon May 2 19:16:11 2016 +0000
Fix fernet audit ids for v2.0
The fernet token provider was doing some weird things with audit ids that
caused token rescoping to not work because audit ids were never pulled from the
original token. This commit also enables some tests for v2.0 authentication
with the Fernet as the token provider.
Closes-Bug: 1577558
Change-Id: Iffbaf505ef50a6c6d97c5340645acb2f6fda7e0e
(cherry picked from commit 0d376025bae61bf5ee19d992c7f336b99ac69240)

| **tags**: | added: in-stable-mitaka |
| --- | --- |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-09

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16:  [**Re: v2.0 fernet tokens audit ids are inconsistent**](/keystone/%2Bbug/1577558/comments/9) |  |  | [#9](/keystone/%2Bbug/1577558/comments/9) |
| --- | --- | --- | --- |

Proposed impact description -

Title: Incorrect Audit IDs in Keystone Fernet Tokens

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: Master (Newton), Mitaka

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Proposed impact description -
Title: Incorrect Audit IDs in Keystone Fernet Tokens
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: Master (Newton), Mitaka
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. When Keystone was configured to use Fernet tokens, the unique string (audit\_id) was not properly maintained during a token rescope (requesting a token for a new project scope using the current token for authentication). This resulted in the inability to revoke entire chain of tokens. The revocation of the chain of tokens. Most revocations are not for the entire chain of tokens. Only Master (Newton) and Mitaka releases of Keystone configured to use Fernet as the Keystone token provider were affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#10](/keystone/%2Bbug/1577558/comments/10) |
| --- | --- | --- | --- |

2nd Revision impact statement

Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass

Reporter: Lance Bragstad (Rackspace)

Products: OpenStack Kesytone

Affects: >=9.0.0

Description:

Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

2nd Revision impact statement
Title: Incorrect Audit IDs in Keystone Fernet Tokens can result in revocation bypass
Reporter: Lance Bragstad (Rackspace)
Products: OpenStack Kesytone
Affects: >=9.0.0
Description:
Lance Bragstad (Rackspace) reported a vulnerability in the Keystone Fernet Token Provider. By rescoping a token a user will receive a new token without correct audit\_ids, these incorrect audit\_ids will prevent the entire chain of tokens from being revoked properly. This vulnerability does not impact revoking a token by it's individual audit\_id. Only deployments with Keystone configured to use Fernet tokens are impacted.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-16: |  |  | [#11](/keystone/%2Bbug/1577558/comments/11) |
| --- | --- | --- | --- |

Erm, I think I got the Affects >= incorrect.

Erm, I think I got the Affects >= incorrect.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-17: |  |  | [#12](/keystone/%2Bbug/1577558/comments/12) |
| --- | --- | --- | --- |

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Beside the affect line that should be "==9.0.0", the impact description in comment #10 LGTM. Thanks Morgan!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-17: |  |  | [#13](/keystone/%2Bbug/1577558/comments/13) |
| --- | --- | --- | --- |

+1 on the impact description. Thanks Morgan!

+1 on the impact description. Thanks Morgan!

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-17

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ian Cordasco (icordasc)](https://launchpad.net/~icordasc) wrote on 2016-05-17: |  |  | [#14](/keystone/%2Bbug/1577558/comments/14) |
| --- | --- | --- | --- |

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

CVE-2016-4911 has been assigned to this but Launchpad believes it to be invalid.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Martinelli (stevemar)](https://launchpad.net/~stevemar) wrote on 2016-05-17: |  |  | [#15](/keystone/%2Bbug/1577558/comments/15) |
| --- | --- | --- | --- |

impact looks fine to me!

impact looks fine to me!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Morgan Fainberg (mdrnstm)](https://launchpad.net/~mdrnstm) wrote on 2016-05-18: |  |  | [#16](/keystone/%2Bbug/1577558/comments/16) |
| --- | --- | --- | --- |

@Ian,

I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

@Ian,
I'll look into that tomorrow. That was the number assigned when it was requested. I'll confirm it's not doing something weird. Thanks for pointing it out.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matthew Thode (prometheanfire)](https://launchpad.net/~prometheanfire) wrote on 2016-05-18: |  |  | [#17](/keystone/%2Bbug/1577558/comments/17) |
| --- | --- | --- | --- |

Did this impact liberty?

Did this impact liberty?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#18](/keystone/%2Bbug/1577558/comments/18) |
| --- | --- | --- | --- |

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.

I'll pull down the latest liberty branch and test this locally.

[0] <https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41>

I don't think this impacts liberty because in liberty the fernet provider was technically still it's \*own\* provider. When Fernet tokens were originally introduced, the provider inherited the BaseProvider class from keystone.token.providers.common.py but it overrode a lot of the methods provided because it needed to do specific things [0]. This resulted in differences in the token responses depending on if the token being validated was a fernet token or a uuid token. One of the top priorities for the Mitaka release was to consolidate the duplicated methods in the Fernet provider into the BaseProvider. This is where the bug comes from because the Fernet provider had to use a couple hooks in order to pull the attributes needed out of the v2 token request. The logic that pulled the attributes was wrong about audit\_ids and it wasn't tested against v2.
I'll pull down the latest liberty branch and test this locally.
[0] https://github.com/openstack/keystone/blob/stable/liberty/keystone/token/providers/fernet/core.py#L41

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lance Bragstad (lbragstad)](https://launchpad.net/~lbragstad) wrote on 2016-05-18: |  |  | [#19](/keystone/%2Bbug/1577558/comments/19) |
| --- | --- | --- | --- |

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:

commit 26240963712541d215d414fa71596cccc60dd7ce

I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:

"audit\_ids": [

                "i8OpkdQHSJOgMQVIJgkG9w",

                "8HAaHKMnSxe-wrTTv2RgxA"

            ],

This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.

original token: <http://paste.openstack.org/show/497523/>

rescoped token: <http://paste.openstack.org/show/497524/>

This doesn't seem to be an issue with liberty. I pulled the latest liberty as of today:
commit 26240963712541d215d414fa71596cccc60dd7ce
I was able to get a token with an audit\_id = "8HAaHKMnSxe-wrTTv2RgxA". I rescoped that token and the audit\_ids returned in the response contained the original audit\_id from the first token:
"audit\_ids": [
"i8OpkdQHSJOgMQVIJgkG9w",
"8HAaHKMnSxe-wrTTv2RgxA"
],
This doesn't seem to apply to liberty (probably because of the reasoning listed in comment #18). The following pastes are the authentication responses from my manual test.
original token: http://paste.openstack.org/show/497523/
rescoped token: http://paste.openstack.org/show/497524/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-05-23:  [**Fix included in openstack/keystone 9.0.1**](/keystone/%2Bbug/1577558/comments/20) |  |  | [#20](/keystone/%2Bbug/1577558/comments/20) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 9.0.1 release.

This issue was fixed in the openstack/keystone 9.0.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-24:  [**Related fix proposed to ossa (master)**](/keystone/%2Bbug/1577558/comments/21) |  |  | [#21](/keystone/%2Bbug/1577558/comments/21) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/320209>

Related fix proposed to branch: master
Review: https://review.openstack.org/320209

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-05-24

| **summary**: | - v2.0 fernet tokens audit ids are inconsistent+ [OSSA 2016-008] v2.0 fernet tokens audit ids are inconsistent+ (CVE-2016-4911) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-31:  [**Related fix merged to ossa (master)**](/keystone/%2Bbug/1577558/comments/22) |  |  | [#22](/keystone/%2Bbug/1577558/comments/22) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/320209>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024>

Submitter: Jenkins

Branch: master

commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024

Author: Morgan Fainberg <email address hidden>

Date: Mon May 23 20:48:44 2016 -0700

Adds OSSA 2016-008 (CVE-2016-4911)

Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928

    Related-Bug: #1577558

Reviewed: https://review.openstack.org/320209
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Submitter: Jenkins
Branch: master
commit c6db6d9d4ab7193fc4d48cd5eaca3c8a0c56a024
Author: Morgan Fainberg <morgan.fainberg@gmail.com>
Date: Mon May 23 20:48:44 2016 -0700
Adds OSSA 2016-008 (CVE-2016-4911)
Change-Id: I35ae3174ce88363c1a2b0b3f8c5beb0a3054d928
Related-Bug: #1577558

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-06-02:  [**Fix included in openstack/keystone 10.0.0.0b1**](/keystone/%2Bbug/1577558/comments/23) |  |  | [#23](/keystone/%2Bbug/1577558/comments/23) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

This issue was fixed in the openstack/keystone 10.0.0.0b1 development milestone.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Steve Martinelli (stevemar)](https://launchpad.net/~stevemar)
on 2016-07-07

| Changed in keystone: | |
| --- | --- |
| **milestone**: | none → newton-1 |

[See full activity log](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/keystone/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1578210](https://bugs.launchpad.net/keystone/%2Bbug/1578210 "Keystone fails negative tests with unauthenticated users")

You are
[not directly subscribed to this bug's notifications.](/keystone/%2Bbug/1577558/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/keystone/%2Bbug/1577558/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from translations.launchpad.net_4db0e6d1_20250126_124016.html ===

[Log in / Register](https://translations.launchpad.net/keystone/%2Blogin)

[![](https://launchpadlibrarian.net/359059841/OpenStack_Project_Keystone_mascot%20%281%29.png)](https://launchpad.net/keystone)

## [OpenStack Identity (keystone)](https://launchpad.net/keystone)

* [Overview](https://launchpad.net/keystone)
* [Code](https://code.launchpad.net/keystone)
* [Bugs](https://bugs.launchpad.net/keystone)
* [Blueprints](https://blueprints.launchpad.net/keystone)
* Translations
* [Answers](https://answers.launchpad.net/keystone)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

There are no translations for this project.

### Translation details

To see all the translation files that are waiting to be
imported, please look at
[OpenStack Identity (keystone) import queue](/keystone/%2Bimports).

### Permissions

[OpenStack Identity (keystone)](https://launchpad.net/keystone) is translated
with [Open](/%2Bhelp-translations/permissions-policies.html)
permissions.

### All translatable distribution packages

* [keystone source package in Plucky](/ubuntu/plucky/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Oracular](/ubuntu/oracular/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Noble](/ubuntu/noble/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Mantic](/ubuntu/mantic/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Lunar](/ubuntu/lunar/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Kinetic](/ubuntu/kinetic/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Jammy](/ubuntu/jammy/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Impish](/ubuntu/impish/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Hirsute](/ubuntu/hirsute/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Groovy](/ubuntu/groovy/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Focal](/ubuntu/focal/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Eoan](/ubuntu/eoan/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Disco](/ubuntu/disco/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Cosmic](/ubuntu/cosmic/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Bionic](/ubuntu/bionic/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Artful](/ubuntu/artful/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Zesty](/ubuntu/zesty/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Yakkety](/ubuntu/yakkety/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Xenial](/ubuntu/xenial/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Wily](/ubuntu/wily/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Vivid](/ubuntu/vivid/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Utopic](/ubuntu/utopic/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Trusty](/ubuntu/trusty/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Saucy](/ubuntu/saucy/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Raring](/ubuntu/raring/%2Bsources/keystone/%2Btranslations)
* [keystone source package in Quantal](/ubuntu/quantal/%2Bsources/keystone/%2Btranslations)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


