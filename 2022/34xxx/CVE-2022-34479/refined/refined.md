```
{
  "cve": "CVE-2022-34479",
  "description": "A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks. This bug only affects Thunderbird for Linux and Firefox for Linux. Other operating systems are unaffected.",
  "affected_products": [
    "Thunderbird",
    "Firefox"
  ],
  "vulnerability_details": {
    "root_cause": "The vulnerability arises due to the way popup windows are resized on Linux systems using the GTK toolkit. When a popup window is resized using `window.sizeToContent()` on a page with a large top margin, the address bar UI can be pushed up and overlaid with the content of the HTML5 page.",
    "weaknesses": [
      "Improper handling of window resizing",
      "Inadequate UI protection against content overlay"
    ],
    "impact": "Address bar spoofing, leading to potential user confusion or phishing attacks.",
    "attack_vectors": [
      "A malicious website creates a popup window.",
       "The website uses `window.sizeToContent()` to resize the popup.",
      "If the conditions are met, the popup window is resized to overlay the address bar."
    ],
    "required_capabilities": [
      "Attacker needs to host a malicious website that can create popup windows",
      "User needs to be using Firefox or Thunderbird on Linux (X11 or XWayland)"
    ],
    "additional_notes": "The vulnerability is specific to Linux systems using the X11 or XWayland windowing protocol. It is triggered when WebRender is enabled and does not occur when `gfx.webrender.software` is set to `true`."
  },
    "affected_versions": {
        "Thunderbird": [
            "versions prior to 91.11",
            "versions prior to 102"
         ],
        "Firefox": [
            "versions prior to 102",
            "versions prior to ESR 91.11"
        ]
    },
 "patch_details": "The fix addresses the improper window resizing by ensuring widget sizes are updated after resizes are confirmed by the OS. It also waits for resize events before getting the font size and adding media queries."
}
```