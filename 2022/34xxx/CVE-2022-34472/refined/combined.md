=== Content from www.mozilla.org_da77736f_20250114_192607.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-26

## Security Vulnerabilities fixed in Thunderbird 91.11 and Thunderbird 102

Announced
June 28, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102
* Thunderbird 91.11

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*
*Note*: While [Bug 1771084](https://bugzilla.mozilla.org/show_bug.cgi?id=1771084) does not represent a specific vulnerability that was fixed, we recommend anyone rebasing patches to include it. 102 branch: Patch [1](https://hg.mozilla.org/releases/mozilla-beta/rev/82e3067ad2e7) and [2](https://hg.mozilla.org/releases/mozilla-beta/rev/6e4639dc3614). 91 Branch: Patch [1](https://hg.mozilla.org/releases/mozilla-esr91/rev/72bca7a337e4) and [2](https://hg.mozilla.org/releases/mozilla-esr91/rev/befef01949f2) (Despite saying Parts 2 and 3, there is no Part 1)

#### [#CVE-2022-34479: A popup window could be resized in a way to overlay the address bar with web content](#CVE-2022-34479)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks.
*This bug only affects Thunderbird for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1745595](https://bugzilla.mozilla.org/show_bug.cgi?id=1745595)

#### [#CVE-2022-34470: Use-after-free in nsSHistory](#CVE-2022-34470)

Reporter
Armin Ebert
Impact
high
##### Description

Session history navigations may have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1765951](https://bugzilla.mozilla.org/show_bug.cgi?id=1765951)

#### [#CVE-2022-34468: CSP sandbox header without "allow-scripts" can be bypassed via retargeted javascript: URI](#CVE-2022-34468)

Reporter
Armin Ebert
Impact
high
##### Description

An iframe that was not permitted to run scripts could do so if the user clicked on a `javascript:` link.

##### References

* [Bug 1768537](https://bugzilla.mozilla.org/show_bug.cgi?id=1768537)

#### [#CVE-2022-2226: An email with a mismatching OpenPGP signature date was accepted as valid](#CVE-2022-2226)

Reporter
Nickolay Olshevsky
Impact
moderate
##### Description

An OpenPGP digital signature includes information about the date when the signature was created. When displaying an email that contains a digital signature, the email's date will be shown. If the dates were different, then Thunderbird didn't report the email as having an invalid signature. If an attacker performed a replay attack, in which an old email with old contents are resent at a later time, it could lead the victim to believe that the statements in the email are current. Fixed versions of Thunderbird will require that the signature's date roughly matches the displayed date of the email.

##### References

* [Bug 1775441](https://bugzilla.mozilla.org/show_bug.cgi?id=1775441)

#### [#CVE-2022-34481: Potential integer overflow in ReplaceElementsAt](#CVE-2022-34481)

Reporter
Ronald Crane
Impact
moderate
##### Description

In the `nsTArray_Impl::ReplaceElementsAt()` function, an integer overflow could have occurred when the number of elements to replace was too large for the container.

##### References

* [Bug 1497246](https://bugzilla.mozilla.org/show_bug.cgi?id=1497246)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-34472: Unavailable PAC file resulted in OCSP requests being blocked](#CVE-2022-34472)

Reporter
Laurent Bigonville
Impact
moderate
##### Description

If there was a PAC URL set and the server that hosts the PAC was not reachable, OCSP requests would have been blocked, resulting in incorrect error pages being shown.

##### References

* [Bug 1770123](https://bugzilla.mozilla.org/show_bug.cgi?id=1770123)

#### [#CVE-2022-34478: Microsoft protocols can be attacked if a user accepts a prompt](#CVE-2022-34478)

Reporter
Gijs
Impact
moderate
##### Description

The `ms-msdt`, `search`, and `search-ms` protocols deliver content to Microsoft applications, bypassing the browser, when a user accepts a prompt. These applications have had known vulnerabilities, exploited in the wild (although we know of none exploited through Thunderbird), so in this release Thunderbird has blocked these protocols from prompting the user to open them.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1773717](https://bugzilla.mozilla.org/show_bug.cgi?id=1773717)

#### [#CVE-2022-2200: Undesired attributes could be set as part of prototype pollution](#CVE-2022-2200)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
moderate
##### Description

If an object prototype was corrupted by an attacker, they would have been able to set undesired attributes on a JavaScript object, leading to privileged code execution.

##### References

* [Bug 1771381](https://bugzilla.mozilla.org/show_bug.cgi?id=1771381)

#### [#CVE-2022-34484: Memory safety bugs fixed in Thunderbird 91.11 and Thunderbird 102](#CVE-2022-34484)

Reporter
Mozilla developers and community
Impact
high
##### Description

The Mozilla Fuzzing Team reported potential vulnerabilities present in Thunderbird 91.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.11 and Thunderbird 102](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763634%2C1772651)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_4b07982f_20250114_192605.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1770123)
* [XML](/show_bug.cgi?ctype=xml&id=1770123)

Closed
[Bug 1770123](/show_bug.cgi?id=1770123)
(CVE-2022-34472)

Opened 3 years ago
Closed 3 years ago

# Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set

## Categories

### (Core :: Networking, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 100

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

103 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [102+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=102%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox101 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=wontfix) |
| firefox102 | [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified) |
| firefox103 | [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 102+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox101 |  | wontfix |
| firefox102 | + | verified |
| firefox103 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bigon, Assigned: kershaw)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/23030d8ba77bc28102b00a4d290540a5?d=mm&size=40)  [bigon](/user_profile?user_id=131358)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-other, sec-moderate, Whiteboard: [necko-triaged][adv-main102+][adv-esr91.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-34472

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][adv-main102+][adv-esr91.11+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 4 obsolete files)

| [log.txt-main.25435.moz\_log.gz](/attachment.cgi?id=9278078)  [3 years ago](#c7)  [Laurent Bigonville](/user_profile?user_id=131358)   21.85 KB, application/gzip |  | [Details](/attachment.cgi?id=9278078&action=edit) |
| --- | --- | --- |
| [log.txt-main.172064.moz\_log.gz](/attachment.cgi?id=9278489)  [3 years ago](#c13)  [Laurent Bigonville](/user_profile?user_id=131358)   3.43 KB, application/gzip |  | [Details](/attachment.cgi?id=9278489&action=edit) |
| [log.txt-main.378256.moz\_log.gz](/attachment.cgi?id=9278822)  [3 years ago](#c17)  [Laurent Bigonville](/user_profile?user_id=131358)   322.38 KB, application/gzip |  | [Details](/attachment.cgi?id=9278822&action=edit) |
| [log.txt-child.378784.moz\_log](/attachment.cgi?id=9278823)  [3 years ago](#c18)  [Laurent Bigonville](/user_profile?user_id=131358)   1.45 KB, application/octet-stream |  | [Details](/attachment.cgi?id=9278823&action=edit) |
| [log.txt-main.71082.moz\_log.gz](/attachment.cgi?id=9279043)  [3 years ago](#c22)  [Laurent Bigonville](/user_profile?user_id=131358)   142.73 KB, application/gzip |  | [Details](/attachment.cgi?id=9279043&action=edit) |
| [log.txt-child.71812.moz\_log](/attachment.cgi?id=9279044)  [3 years ago](#c23)  [Laurent Bigonville](/user_profile?user_id=131358)   1.01 KB, application/octet-stream |  | [Details](/attachment.cgi?id=9279044&action=edit) |
| [ocsp.pcapng.gz](/attachment.cgi?id=9279045)  [3 years ago](#c24)  [Laurent Bigonville](/user_profile?user_id=131358)   50.91 KB, application/gzip |  | [Details](/attachment.cgi?id=9279045&action=edit) |
| [Bug 1770123 - Clear PAC loader when the load is failed, r=#necko](/attachment.cgi?id=9279092)  [3 years ago](#c25)  [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c32 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c37 "3 years ago") | [Details](/attachment.cgi?id=9279092&action=edit) | [Review](/attachment.cgi?id=9279092) |
| [advisory.txt](/attachment.cgi?id=9282650)  [3 years ago](#c40)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   250 bytes, text/plain |  | [Details](/attachment.cgi?id=9282650&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1770123#c0)• 3 years ago |
|  | |

Hello

On my work laptop, I've a proxy setup (via a .pac file) in GNOME configuration. In Firefox, the configuration is set to use the system settings.

With the proxy is setup (when I'm disconnected from the VPN, the pac file or the proxy is not reachable, so it doesn't seem to matter if the proxy is actually used) if I go to <https://revoked.badssl.com/> I get a red scary page telling me that I shouldn't be seeing this.

As soon as I disable the proxy in the GNOME configuration, I'm getting the SEC\_ERROR\_REVOKED\_CERTIFICATE as expected.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1770123#c1)• 3 years ago |
|  | |

Is your proxy blocking OCSP? (port 80)

Flags: needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1770123#c2)• 3 years ago |
|  | |

I've the same issue when I'm at home and not connected to the company VPN and there port OSCP/80 is definitely not blocked

Flags: needinfo?(bigon)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1770123#c3)• 3 years ago |
|  | |

What's the value of `security.OCSP.enabled` in `about:config`?

What does Firefox do if you set `security.OCSP.require` to `true`?

Can you capture the packets of the handshake (and any OCSP requests) with `https://revoked.badssl.com/` using Wireshark and attach the results here?

Thanks!

Flags: needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1770123#c4)• 3 years ago |
|  | |

`security.OCSP.enabled` is set to 1

With the proxy set via a pac file, but nor the pac file nor the proxy is reachable (not at the office or connected via the VPN):

* When I'm forcing `security.OCSP.require` to true, I get the `SEC_ERROR_OCSP_SERVER_ERROR` for <https://revoked.badssl.com/>. I also get the same error when browsing to google.com
* When I'm forcing `security.OCSP.require` to true, going to my own website that has https via let's encrypt with OCSP stapling, it works. If I disable the `security.ssl_enable_ocsp_stapling`, my website become unreachable with the `SEC_ERROR_OCSP_SERVER_ERROR` error
* I don't see any call to the OCSP server (<http://ocsp.digicert.com>, IP: 93.184.220.29)

So really, if a proxy is set, direct queries to the OCSP server are disabled completely. I doubt it's that the expected behavior?

Flags: needinfo?(bigon)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1770123#c5)• 3 years ago |
|  | |

It's expected that OCSP requests don't occur while the PAC is loading, but they should happen when it's done loading (or presumably when it fails to load and Firefox continues without it).

Kershaw, any ideas as to if this is behaving correctly?

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1770123#c6)• 3 years ago |
|  | |

Hi Reporter,

Could you try to capture a [http log](https://firefox-source-docs.mozilla.org/networking/http/logging.html) for this?

Please also add `pipnss:5,proxy:5` to `MOZ_LOG` environment variable.

Thanks.

Flags: needinfo?(kershaw) → needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1770123#c7)• 3 years ago |
|  | |

Attached file
[log.txt-main.25435.moz\_log.gz](attachment.cgi?id=9278078) (obsolete)
— [Details](attachment.cgi?id=9278078&action=edit)

Hello,

I can reproduce this by literally setting `http://proxy.example.com/proxy.pac` as a pac file directly in firefox

I've attached the requested logs

Flags: needinfo?(bigon)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1770123#c8)• 3 years ago |
|  | |

Moving this out of the Fx frontend product as this seems like a necko/tls issue.

Group: firefox-core-security → network-core-securityComponent: Security → NetworkingProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a565987_1689)• 3 years ago |

Summary: Firefox allows user to visit webpages with revoked certificate when proxy is set → Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1770123#c9)• 3 years ago |
|  | |

What's happening makes sense, the question is how do we best help users? Warn them when their specified proxy isn't loading? Or maybe we just aren't communicating that the PAC loading failed back to the OCSP checking code?

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1770123#c10)• 3 years ago |
|  | |

So if I understand properly, when the proxy is reachable, the OCSP validation is not done by Firefox but is supposed to be delegated to the proxy?

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1770123#c11)• 3 years ago |
|  | |

No, if the proxy is reachable, OCSP requests should still occur.

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1770123#c12)• 3 years ago |
|  | |

I'm asking because that doesn't seem to happen either

I'll have to get the logs when I'm able to connect to the proxy also then

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1770123#c13)• 3 years ago |
|  | |

Attached file
[log.txt-main.172064.moz\_log.gz](attachment.cgi?id=9278489) (obsolete)
— [Details](attachment.cgi?id=9278489&action=edit)

Logs when the connection to the proxy succeed

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1770123#c14)• 3 years ago |
|  | |

Scratch my last comment ([comment 12](/show_bug.cgi?id=1770123#c12 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set") and 13), the proxy is doing MITM by replacing the certificate but does not add OCSP information to it.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1770123#c15)• 3 years ago |
|  | |

Kershaw, is this just [bug 1639914](/show_bug.cgi?id=1639914 "NEW - SEC_ERROR_OCSP_SERVER_ERROR with most https websites when security.OCSP.require is set to true and a https .pac file is used")? (see in particular [bug 1639914 comment 4](/show_bug.cgi?id=1639914#c4 "NEW - SEC_ERROR_OCSP_SERVER_ERROR with most https websites when security.OCSP.require is set to true and a https .pac file is used"))

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1770123#c16)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #15](/show_bug.cgi?id=1770123#c15 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set"))

> Kershaw, is this just [bug 1639914](/show_bug.cgi?id=1639914 "NEW - SEC_ERROR_OCSP_SERVER_ERROR with most https websites when security.OCSP.require is set to true and a https .pac file is used")? (see in particular [bug 1639914 comment 4](/show_bug.cgi?id=1639914#c4 "NEW - SEC_ERROR_OCSP_SERVER_ERROR with most https websites when security.OCSP.require is set to true and a https .pac file is used"))

No, I think the problem in this bug is not about `pac` request being cancelled.

I think the problem is in [comment #4](/show_bug.cgi?id=1770123#c4 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set"):

```
When I'm forcing security.OCSP.require to true, going to my own website that has https via let's encrypt with OCSP stapling, it works. If I disable the security.ssl_enable_ocsp_stapling, my website become unreachable with the SEC_ERROR_OCSP_SERVER_ERROR error

```

Why does the reporter's website work when the proxy is not reachable?

I am guessing maybe the content is loaded from cache.

Reporter, the log file is not completed because you only set `MOZ_LOG` to `pipnss:5,proxy:5`. We need to turn on more logging.

In this case, I think setting `MOZ_LOG` to `nsHttp:5,cache2:5,nsSocketTransport:5,nsHostResolver:5,pipnss:5,proxy:5` should be enough.

Could you try to capture the log again? Thanks.

Flags: needinfo?(kershaw) → needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1770123#c17)• 3 years ago |
|  | |

Attached file
[log.txt-main.378256.moz\_log.gz](attachment.cgi?id=9278822) (obsolete)
— [Details](attachment.cgi?id=9278822&action=edit)

I really don't think this has anything to do with the cache.

Forcing OCSP (via `security.OCSP.require`) and then toggling `security.ssl_enable_ocsp_stapling` prevents me (or not) to access my personal website.

You cannot reproduce this behavior on your side?

Flags: needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1770123#c18)• 3 years ago |
|  | |

Attached file
[log.txt-child.378784.moz\_log](attachment.cgi?id=9278823) (obsolete)
— [Details](attachment.cgi?id=9278823&action=edit)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1770123#c19)• 3 years ago |
|  | |

When the pac file is not reachable, firefox tries to connect directly: `D/proxy pac not available, use DIRECT`

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1770123#c20)• 3 years ago |
|  | |

(In reply to Laurent Bigonville from [comment #17](/show_bug.cgi?id=1770123#c17 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set"))

> Created [attachment 9278822](/attachment.cgi?id=9278822 "log.txt-main.378256.moz_log.gz") [[details]](/attachment.cgi?id=9278822&action=edit "log.txt-main.378256.moz_log.gz")
>
> log.txt-main.378256.moz\_log.gz
>
> I really don't think this has anything to do with the cache.
>
> Forcing OCSP (via `security.OCSP.require`) and then toggling `security.ssl_enable_ocsp_stapling` prevents me (or not) to access my personal website.

Thanks for the log. It shows Firefox sending one ocsp request.

```
[Parent 378256: SSL Cert #2]: D/pipnss DoOCSPRequest to 'http://r3.o.lencr.org'

```

Dana, do you have any idea here? Why toggling `security.ssl_enable_ocsp_stapling` makes difference?

Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1770123#c21)• 3 years ago |
|  | |

Disabling OCSP stapling means the server won't include OCSP information in the TLS handshake, so Firefox won't have any OCSP information (assuming fetching OCSP is failing, which it looks like is happening). Combining that with `security.OCSP.require` would prevent you from reaching sites, as expected.

This bug is getting a bit confusing to me - you've outlined a number of different scenarios, and it's unclear to me what's happening and what you're expecting to happen. Can you maybe lay out the configurations you're concerned about in an ordered fashion?

Also, again, it would be very helpful to have a packet trace to see what requests Firefox is making and what responses it's getting. Thank you!

Flags: needinfo?(dkeeler) → needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1770123#c22)• 3 years ago |
|  | |

Attached file
[log.txt-main.71082.moz\_log.gz](attachment.cgi?id=9279043)
— [Details](attachment.cgi?id=9279043&action=edit)

Well not sure what's confusing here, when the pac file is not reachable, firefox is not sending any OCSP requests, I can reproduce that 100% of the time here. pac file not being reachable can happen often when people are using a corporate computer and not connected to their VPN or not being inside the corporate network

Anyway where what I'm doing:

1. Create an empty profile
2. Set the proxy to <http://proxy.example.com:8080/proxy.pac>
3. Set `security.OCSP.require` to true
4. Set `security.ssl.enable_ocsp_stapling` to false
5. Go to <https://bigon.be>
6. Website is not reachable (`SEC_ERROR_OCSP_SERVER_ERROR` error)
7. Set `security.ssl.enable_ocsp_stapling` to true
8. Go to <https://bigon.be> again
9. Website is reachable

That seems to suggest that OCSP is not completely broken, just OCSP requests are not being done as the proxy is not reachable

[Attachment #9278078](/attachment.cgi?id=9278078&action=edit "log.txt-main.25435.moz_log.gz") -
Attachment is obsolete: true
[Attachment #9278489](/attachment.cgi?id=9278489&action=edit "log.txt-main.172064.moz_log.gz") -
Attachment is obsolete: true
[Attachment #9278822](/attachment.cgi?id=9278822&action=edit "log.txt-main.378256.moz_log.gz") -
Attachment is obsolete: trueFlags: needinfo?(bigon)

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1770123#c23)• 3 years ago |
|  | |

Attached file
[log.txt-child.71812.moz\_log](attachment.cgi?id=9279044)
— [Details](attachment.cgi?id=9279044&action=edit)

[Attachment #9278823](/attachment.cgi?id=9278823&action=edit "log.txt-child.378784.moz_log") -
Attachment is obsolete: true

|  | [Laurent Bigonville](/user_profile?user_id=131358)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1770123#c24)• 3 years ago |
|  | |

Attached file
[ocsp.pcapng.gz](attachment.cgi?id=9279045)
— [Details](attachment.cgi?id=9279045&action=edit)

I attach here the capture my last attempt

I used the following filter: `(ipv6.addr == 2001:bc8:25f1:100::1 and tcp.port == 443) or ocsp`

As you can see, no OCSP requests are made

When disabling the proxy, I can see the OCSP requests being made again

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1770123#c25)• 3 years ago |
|  | |

Attached file
[Bug 1770123 - Clear PAC loader when the load is failed, r=#necko](attachment.cgi?id=9279092)
— [Details](attachment.cgi?id=9279092&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a1137086_600971)• 3 years ago |

Assignee: nobody → kershawStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a1137203_505624)• 3 years ago |

Severity: -- → S3Priority: -- → P2Whiteboard: [necko-triaged]

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1770123#c26)• 3 years ago |
|  | |

I found a problem that `GetIsPACLoading` always returns true when the pac is not reachable. This blocks sending ocsp request [here](https://searchfox.org/mozilla-central/rev/3419858c997f422e3e70020a46baae7f0ec6dacc/security/manager/ssl/nsNSSCallbacks.cpp#243).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1770123#c27)• 3 years ago |
|  | |

If the PAC is *actually* loading we don't want to send OCSP because it's quite possible the OCSP request is for the PAC file itself. So it'd really be nice to know the difference between actually-loading and failed-loading.

Especially so if we've decided to let other network requests continue without waiting for the PAC to load.

This probably isn't that useful as an attack vector so maybe we can unhide the bug.

Keywords: [csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1770123#c28)• 3 years ago |
|  | |

Clear PAC loader when the load is failed, r=necko-reviewers,dragana

<https://hg.mozilla.org/integration/autoland/rev/f6c203dbc605c69887d1547d5e89f4fb44c9ffcc>

<https://hg.mozilla.org/mozilla-central/rev/f6c203dbc605>

Group: network-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 103 Branch

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1770123#c29)• 3 years ago |
|  | |

Should we uplift this to 102?

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1770123#c30)• 3 years ago |
|  | |

(In reply to Mike Kaply [:mkaply] from [comment #29](/show_bug.cgi?id=1770123#c29 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set"))

> Should we uplift this to 102?

I can uplift this, since the change is not risky.

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1770123#c31)• 3 years ago |
|  | |

Comment on [attachment 9279092](/attachment.cgi?id=9279092 "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") [[details]](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko")

[Bug 1770123](/show_bug.cgi?id=1770123 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set") - Clear PAC loader when the load is failed, r=#necko

### Beta/Release Uplift Approval Request

* **User impact if declined**: If there is a PAC URL set and the server that hosts the PAC is not reachable, OCSP requests are blocked.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: N/A
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This change is straightforward.
* **String changes made/needed**: N/A
* **Is Android affected?**: Yes
[Attachment #9279092](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1770123#c32)• 3 years ago |
|  | |

Comment on [attachment 9279092](/attachment.cgi?id=9279092 "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") [[details]](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko")

[Bug 1770123](/show_bug.cgi?id=1770123 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set") - Clear PAC loader when the load is failed, r=#necko

Approved for 102 beta 6, thanks.

[Attachment #9279092](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1770123#c33)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/c351fdbdb221>

[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1770123#c34)• 3 years ago |
|  | |

Is that something we should uplift to the ESR 91 branch as well? ESR 102 will inherit from the uplift to the 102 beta branch.

Flags: needinfo?(kershaw)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a1792106_75935)• 3 years ago |

[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → ---
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1770123#c35)• 3 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #34](/show_bug.cgi?id=1770123#c34 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set"))

> Is that something we should uplift to the ESR 91 branch as well? ESR 102 will inherit from the uplift to the 102 beta branch.

Sure, I think we can also uplift to ESR 91.

Thanks.

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1770123#c36)• 3 years ago |
|  | |

Comment on [attachment 9279092](/attachment.cgi?id=9279092 "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") [[details]](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko")

[Bug 1770123](/show_bug.cgi?id=1770123 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set") - Clear PAC loader when the load is failed, r=#necko

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: If there is a PAC URL set and the server that hosts the PAC is not reachable, OCSP requests are blocked.
* **User impact if declined**: If there is a PAC URL set and the server that hosts the PAC is not reachable, OCSP requests are blocked.
* **Fix Landed on Version**: 103
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This patch is straightforward.
[Attachment #9279092](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1770123#c37)• 3 years ago |
|  | |

Comment on [attachment 9279092](/attachment.cgi?id=9279092 "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") [[details]](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko")

[Bug 1770123](/show_bug.cgi?id=1770123 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set") - Clear PAC loader when the load is failed, r=#necko

Approved for 91.11esr.

[Attachment #9279092](/attachment.cgi?id=9279092&action=edit "Bug 1770123 - Clear PAC loader when the load is failed, r=#necko") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1770123#c38)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/d517719645b2>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F) → [102+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=102%2B)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a1894876_500622)• 3 years ago |

Flags: qe-verify+

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a1909795_500622)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1770123#c39)• 3 years ago |
|  | |

I've reproduced this bug using an affected Nightly build from 2022-05-19, using the STR from [comment 22](/show_bug.cgi?id=1770123#c22 "VERIFIED FIXED - Firefox allows user to visit webpages with revoked certificate when non-resolving proxy is set").

The issue is verified as fixed on the latest builds: ESR 91.11, Beta 102.0b8 and latest Nightly 103.0a1.

Status: RESOLVED → VERIFIED
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified)
[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a2891352_578488)• 3 years ago |

Whiteboard: [necko-triaged] → [necko-triaged][adv-main102+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1770123#c40)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9282650)
— [Details](attachment.cgi?id=9282650&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a3135411_578488)• 3 years ago |

Alias: CVE-2022-34472

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a3142263_578488)• 3 years ago |

Whiteboard: [necko-triaged][adv-main102+] → [necko-triaged][adv-main102+][adv-esr91.11+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770123#a20981304_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1770123&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Laurent Bigonville](/user_profile?user_id=131358)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_f096317f_20250114_192606.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-24

## Security Vulnerabilities fixed in Firefox 102

Announced
June 28, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 102

*Note*: While [Bug 1771084](https://bugzilla.mozilla.org/show_bug.cgi?id=1771084) does not represent a specific vulnerability that was fixed, we recommend anyone rebasing patches to include it. 102 branch: Patch [1](https://hg.mozilla.org/releases/mozilla-beta/rev/82e3067ad2e7) and [2](https://hg.mozilla.org/releases/mozilla-beta/rev/6e4639dc3614). 91 Branch: Patch [1](https://hg.mozilla.org/releases/mozilla-esr91/rev/72bca7a337e4) and [2](https://hg.mozilla.org/releases/mozilla-esr91/rev/befef01949f2) (Despite saying Parts 2 and 3, there is no Part 1)

#### [#CVE-2022-34479: A popup window could be resized in a way to overlay the address bar with web content](#CVE-2022-34479)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1745595](https://bugzilla.mozilla.org/show_bug.cgi?id=1745595)

#### [#CVE-2022-34470: Use-after-free in nsSHistory](#CVE-2022-34470)

Reporter
Armin Ebert
Impact
high
##### Description

Session history navigations may have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1765951](https://bugzilla.mozilla.org/show_bug.cgi?id=1765951)

#### [#CVE-2022-34468: CSP sandbox header without "allow-scripts" can be bypassed via retargeted javascript: URI](#CVE-2022-34468)

Reporter
Armin Ebert
Impact
high
##### Description

An iframe that was not permitted to run scripts could do so if the user clicked on a `javascript:` link.

##### References

* [Bug 1768537](https://bugzilla.mozilla.org/show_bug.cgi?id=1768537)

#### [#CVE-2022-34482: Drag and drop of malicious image could have led to malicious executable and potential code execution](#CVE-2022-34482)

Reporter
Attila Suszter
Impact
moderate
##### Description

An attacker who could have convinced a user to drag and drop an image to a filesystem could have manipulated the resulting filename to contain an executable extension, and by extension potentially tricked the user into executing malicious code. While very similar, this is a separate issue from CVE-2022-34483.

##### References

* [Bug 845880](https://bugzilla.mozilla.org/show_bug.cgi?id=845880)

#### [#CVE-2022-34483: Drag and drop of malicious image could have led to malicious executable and potential code execution](#CVE-2022-34483)

Reporter
Eduardo Braun Prado
Impact
moderate
##### Description

An attacker who could have convinced a user to drag and drop an image to a filesystem could have manipulated the resulting filename to contain an executable extension, and by extension potentially tricked the user into executing malicious code. While very similar, this is a separate issue from CVE-2022-34482.

##### References

* [Bug 1335845](https://bugzilla.mozilla.org/show_bug.cgi?id=1335845)

#### [#CVE-2022-34476: ASN.1 parser could have been tricked into accepting malformed ASN.1](#CVE-2022-34476)

Reporter
Gustavo Grieco
Impact
moderate
##### Description

ASN.1 parsing of an indefinite SEQUENCE inside an indefinite GROUP could have resulted in the parser accepting malformed ASN.1.

##### References

* [Bug 1387919](https://bugzilla.mozilla.org/show_bug.cgi?id=1387919)

#### [#CVE-2022-34481: Potential integer overflow in ReplaceElementsAt](#CVE-2022-34481)

Reporter
Ronald Crane
Impact
moderate
##### Description

In the `nsTArray_Impl::ReplaceElementsAt()` function, an integer overflow could have occurred when the number of elements to replace was too large for the container.

##### References

* [Bug 1497246](https://bugzilla.mozilla.org/show_bug.cgi?id=1497246)
* [Bug 1483699](https://bugzilla.mozilla.org/show_bug.cgi?id=1483699)

#### [#CVE-2022-34474: Sandboxed iframes could redirect to external schemes](#CVE-2022-34474)

Reporter
Amazon Malvertising Team
Impact
moderate
##### Description

Even when an iframe was sandboxed with `allow-top-navigation-by-user-activation`, if it received a redirect header to an external protocol the browser would process the redirect and prompt the user as appropriate.

##### References

* [Bug 1677138](https://bugzilla.mozilla.org/show_bug.cgi?id=1677138)

#### [#CVE-2022-34469: TLS certificate errors on HSTS-protected domains could be bypassed by the user on Firefox for Android](#CVE-2022-34469)

Reporter
Peter Gerber
Impact
moderate
##### Description

When a TLS Certificate error occurs on a domain protected by the HSTS header, the browser should not allow the user to bypass the certificate error. On Firefox for Android, the user was presented with the option to bypass the error; this could only have been done by the user explicitly.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1721220](https://bugzilla.mozilla.org/show_bug.cgi?id=1721220)

#### [#CVE-2022-34471: Compromised server could trick a browser into an addon downgrade](#CVE-2022-34471)

Reporter
Rob Wu
Impact
moderate
##### Description

When downloading an update for an addon, the downloaded addon update's version was not verified to match the version selected from the manifest. If the manifest had been tampered with on the server, an attacker could trick the browser into downgrading the addon to a prior version.

##### References

* [Bug 1766047](https://bugzilla.mozilla.org/show_bug.cgi?id=1766047)

#### [#CVE-2022-34472: Unavailable PAC file resulted in OCSP requests being blocked](#CVE-2022-34472)

Reporter
Laurent Bigonville
Impact
moderate
##### Description

If there was a PAC URL set and the server that hosts the PAC was not reachable, OCSP requests would have been blocked, resulting in incorrect error pages being shown.

##### References

* [Bug 1770123](https://bugzilla.mozilla.org/show_bug.cgi?id=1770123)

#### [#CVE-2022-34478: Microsoft protocols can be attacked if a user accepts a prompt](#CVE-2022-34478)

Reporter
Gijs
Impact
moderate
##### Description

The `ms-msdt`, `search`, and `search-ms` protocols deliver content to Microsoft applications, bypassing the browser, when a user accepts a prompt. These applications have had known vulnerabilities, exploited in the wild (although we know of none exploited through Firefox), so in this release Firefox has blocked these protocols from prompting the user to open them.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1773717](https://bugzilla.mozilla.org/show_bug.cgi?id=1773717)

#### [#CVE-2022-2200: Undesired attributes could be set as part of prototype pollution](#CVE-2022-2200)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
moderate
##### Description

If an object prototype was corrupted by an attacker, they would have been able to set undesired attributes on a JavaScript object, leading to privileged code execution.

##### References

* [Bug 1771381](https://bugzilla.mozilla.org/show_bug.cgi?id=1771381)

#### [#CVE-2022-34480: Free of uninitialized pointer in lg\_init](#CVE-2022-34480)

Reporter
Ronald Crane
Impact
low
##### Description

Within the `lg_init()` function, if several allocations succeed but then one fails, an uninitialized pointer would have been freed despite never being allocated.

##### References

* [Bug 1454072](https://bugzilla.mozilla.org/show_bug.cgi?id=1454072)

#### [#CVE-2022-34477: MediaError message property leaked information on cross-origin same-site pages](#CVE-2022-34477)

Reporter
jannis
Impact
low
##### Description

The MediaError message property should be consistent to avoid leaking information about cross-origin resources; however for a same-site cross-origin resource, the message could have leaked information enabling XS-Leaks attacks.

##### References

* [Bug 1731614](https://bugzilla.mozilla.org/show_bug.cgi?id=1731614)

#### [#CVE-2022-34475: HTML Sanitizer could have been bypassed via same-origin script via use tags](#CVE-2022-34475)

Reporter
Gareth Heyes
Impact
low
##### Description

SVG `<use>` tags that referenced a same-origin document could have resulted in script execution if attacker input was sanitized via the HTML Sanitizer API. This would have required the attacker to reference a same-origin JavaScript file containing the script to be executed.

##### References

* [Bug 1757210](https://bugzilla.mozilla.org/show_bug.cgi?id=1757210)

#### [#CVE-2022-34473: HTML Sanitizer could have been bypassed via use tags](#CVE-2022-34473)

Reporter
Armin Ebert
Impact
low
##### Description

The HTML Sanitizer should have sanitized the `href` attribute of SVG `<use>` tags; however it incorrectly did not sanitize `xlink:href` attributes.

##### References

* [Bug 1770888](https://bugzilla.mozilla.org/show_bug.cgi?id=1770888)

#### [#CVE-2022-34484: Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](#CVE-2022-34484)

Reporter
Mozilla developers and community
Impact
high
##### Description

The Mozilla Fuzzing Team reported potential vulnerabilities present in Firefox 101 and Firefox ESR 91.10. Some of these bugs showed evidence of JavaScript prototype or memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763634%2C1772651)

#### [#CVE-2022-34485: Memory safety bugs fixed in Firefox 102](#CVE-2022-34485)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Bryce Seager van Dyk and the Mozilla Fuzzing Team reported potential vulnerabilities present in Firefox 101. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 102](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1768409%2C1768578)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5284e496_20250114_192606.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-25

## Security Vulnerabilities fixed in Firefox ESR 91.11

Announced
June 28, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.11

*Note*: While [Bug 1771084](https://bugzilla.mozilla.org/show_bug.cgi?id=1771084) does not represent a specific vulnerability that was fixed, we recommend anyone rebasing patches to include it. 102 branch: Patch [1](https://hg.mozilla.org/releases/mozilla-beta/rev/82e3067ad2e7) and [2](https://hg.mozilla.org/releases/mozilla-beta/rev/6e4639dc3614). 91 Branch: Patch [1](https://hg.mozilla.org/releases/mozilla-esr91/rev/72bca7a337e4) and [2](https://hg.mozilla.org/releases/mozilla-esr91/rev/befef01949f2) (Despite saying Parts 2 and 3, there is no Part 1)

#### [#CVE-2022-34479: A popup window could be resized in a way to overlay the address bar with web content](#CVE-2022-34479)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1745595](https://bugzilla.mozilla.org/show_bug.cgi?id=1745595)

#### [#CVE-2022-34470: Use-after-free in nsSHistory](#CVE-2022-34470)

Reporter
Armin Ebert
Impact
high
##### Description

Session history navigations may have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1765951](https://bugzilla.mozilla.org/show_bug.cgi?id=1765951)

#### [#CVE-2022-34468: CSP sandbox header without "allow-scripts" can be bypassed via retargeted javascript: URI](#CVE-2022-34468)

Reporter
Armin Ebert
Impact
high
##### Description

An iframe that was not permitted to run scripts could do so if the user clicked on a `javascript:` link.

##### References

* [Bug 1768537](https://bugzilla.mozilla.org/show_bug.cgi?id=1768537)

#### [#CVE-2022-34481: Potential integer overflow in ReplaceElementsAt](#CVE-2022-34481)

Reporter
Ronald Crane
Impact
moderate
##### Description

In the `nsTArray_Impl::ReplaceElementsAt()` function, an integer overflow could have occurred when the number of elements to replace was too large for the container.

##### References

* [Bug 1497246](https://bugzilla.mozilla.org/show_bug.cgi?id=1497246)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-34472: Unavailable PAC file resulted in OCSP requests being blocked](#CVE-2022-34472)

Reporter
Laurent Bigonville
Impact
moderate
##### Description

If there was a PAC URL set and the server that hosts the PAC was not reachable, OCSP requests would have been blocked, resulting in incorrect error pages being shown.

##### References

* [Bug 1770123](https://bugzilla.mozilla.org/show_bug.cgi?id=1770123)

#### [#CVE-2022-34478: Microsoft protocols can be attacked if a user accepts a prompt](#CVE-2022-34478)

Reporter
Gijs
Impact
moderate
##### Description

The `ms-msdt`, `search`, and `search-ms` protocols deliver content to Microsoft applications, bypassing the browser, when a user accepts a prompt. These applications have had known vulnerabilities, exploited in the wild (although we know of none exploited through Firefox), so in this release Firefox has blocked these protocols from prompting the user to open them.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1773717](https://bugzilla.mozilla.org/show_bug.cgi?id=1773717)

#### [#CVE-2022-2200: Undesired attributes could be set as part of prototype pollution](#CVE-2022-2200)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
moderate
##### Description

If an object prototype was corrupted by an attacker, they would have been able to set undesired attributes on a JavaScript object, leading to privileged code execution.

##### References

* [Bug 1771381](https://bugzilla.mozilla.org/show_bug.cgi?id=1771381)

#### [#CVE-2022-34484: Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](#CVE-2022-34484)

Reporter
Mozilla developers and community
Impact
high
##### Description

The Mozilla Fuzzing Team reported potential vulnerabilities present in Firefox 101 and Firefox ESR 91.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763634%2C1772651)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


