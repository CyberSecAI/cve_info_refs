The provided content describes CVE-2022-34001, an XML External Entity (XXE) vulnerability in Unit 4 ERP 7.9 software.

**Root Cause:**
The vulnerability stems from the improper handling of XML input within the 'ExecuteServerProcessAsynchronously' SOAP call. The software allows the insertion of arbitrary XML, including external entities, without proper sanitization or validation.

**Weaknesses/Vulnerabilities:**
- **XXE Injection:** The core vulnerability is a blind XXE injection. The application processes external entities defined within the XML input.
- **Lack of Input Sanitization:** The software fails to sanitize or validate XML input, allowing malicious XML to be processed.
- **SOAP API Misconfiguration:** The 'ExecuteServerProcessAsynchronously' SOAP call allows the insertion of arbitrary XML within its body.

**Impact of Exploitation:**
- **Arbitrary File Read:** An authenticated attacker can read arbitrary files from the host server by exploiting the XXE vulnerability. The content of these files, such as configuration files containing sensitive information (e.g., web.config), can be exfiltrated.
- **Server-Side Request Forgery (SSRF):** The vulnerability can be leveraged to make SSRF calls within the internal network, potentially allowing attackers to map the internal network and make requests to internal hosts.

**Attack Vectors:**
- **SOAP API:** The attack is conducted by crafting a malicious SOAP request to the 'ExecuteServerProcessAsynchronously' endpoint.
- **XML Payload:**  The attacker embeds a malicious XML payload within the SOAP request, specifically within the `<Xml>` tag. This payload defines an external entity that references a malicious DTD hosted on an attacker-controlled server. The malicious DTD uses parameter entities to exfiltrate data from the server by making an HTTP GET request to the attacker's controlled server.

**Required Attacker Capabilities/Position:**
- **Authenticated Access:** The attacker needs to be an authenticated user of the Unit 4 ERP software to initiate the vulnerable SOAP call.
- **Network Access:** The attacker needs to have network access to the ERP server.
- **External Server:** The attacker requires a server to host the malicious DTD and to receive exfiltrated data via HTTP requests.

**Additional Details:**
- The attack is considered 'blind' because the SOAP response doesn't directly reveal the content being exfiltrated. Out-of-band techniques, like using a Burp Collaborator server or hosting a malicious DTD on an attacker-controlled server, are required to exfiltrate data.
- The vulnerability was tested using HTTP and FILE protocols via the crafted XML payload.
- The vulnerability was found in the latest version of Unit 4 ERP 7.9 at the time of discovery, but older versions may also be affected.