```
{
  "vulnerability_details": {
    "root_cause": "An SQL injection vulnerability exists in the Badges code related to configuring criteria.",
    "weaknesses": [
      "SQL Injection"
    ],
    "impact": "Successful exploitation could lead to unauthorized database access, potentially allowing an attacker to read, modify, or delete sensitive data.",
    "attack_vectors": "The vulnerability is triggered when configuring criteria for badge awards, specifically in the way user-provided input is handled in the SQL queries.",
        "required_capabilities": "Site administrators are the primary target of the vulnerability. In older Moodle versions, teachers and managers are also potentially vulnerable. An attacker would need to have the capability to configure badge award criteria.",
     "affected_versions": "Moodle versions 4.0, 3.11 to 3.11.6, 3.10 to 3.10.10, 3.9 to 3.9.13 and earlier unsupported versions."
  },
  "fixes": [
    "Moodle versions 4.0.1, 3.11.7, 3.10.11, and 3.9.14 include the fix."
  ],
  "additional_notes": [
        "In Moodle 4.0, 3.11.6, 3.10.10 and 3.9.13, access to this vulnerability was available to site administrators only. In earlier versions, access to the relevant capability was also limited to teachers and managers by default.",
    "A workaround for versions earlier than Moodle 4.0, 3.11.6, 3.10.10, and 3.9.13 is to remove the moodle/badges:configurecriteria capability from users to prevent them from accessing the affected functionality until the patch is applied."
  ]
}
```