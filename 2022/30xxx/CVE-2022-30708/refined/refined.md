```
{
  "CVE-2022-30708": {
    "Metadata": {
      "ID": "CVE-2022-30708",
      "Description": "Webmin through 1.991, when the Authentic theme is used, allows remote code execution when a user has been manually created (i.e., not created in Virtualmin or Cloudmin). This occurs because settings-editor_write.cgi does not properly restrict the file parameter."
    },
    "Content": {
      "Root cause": "The `settings-editor_write.cgi` script in Webmin's Authentic theme does not properly validate the `file` parameter, allowing an attacker to write to arbitrary files on the server.",
      "Weaknesses": [
        "Improper Input Validation",
        "Remote Code Execution",
        "Privilege Escalation"
      ],
      "Impact": "An attacker can achieve Remote Code Execution (RCE) on the Webmin server, potentially leading to complete system compromise.",
      "Attack vectors": [
        "HTTP POST request to `settings-editor_write.cgi`",
         "Manipulation of the `file` parameter"
      ],
      "Required attacker capabilities/position": [
        "The attacker needs to have a valid Webmin user account with access to the settings editor feature, but it does not need to be an administrator account. This vulnerability is present even with non-privileged users that were created manually (not through Virtualmin or Cloudmin).",
         "Knowledge of the Webmin server's URL and login credentials."
      ],
        "Additional Details": [
           "The vulnerability is specific to the Authentic theme.",
            "The `settings-editor_write.cgi` script uses the `file` parameter from the URL without validating if the file path is legitimate or not.",
            "The vulnerability exists because the code checking `get_user_level` in `settings-editor_write.cgi` fails to handle users created manually in Webmin." ,
            "The vulnerability can be exploited by providing an arbitrary file path in the file parameter, allowing the attacker to write to any file on the server.",
             "The attacker uses this to create a reverse shell payload in the /etc/webmin/authentic-theme/scripts.pl"
        ]
    }
  }
}
```