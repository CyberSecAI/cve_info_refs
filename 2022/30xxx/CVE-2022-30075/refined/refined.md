Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2022-30075:

**Root Cause:**

The vulnerability stems from insufficient validation of user-supplied data during the backup and restore process on TP-Link routers. Specifically, the router firmware fails to properly sanitize the contents of a backup configuration file, allowing an attacker to inject malicious commands.

**Weaknesses/Vulnerabilities:**

*   **Lack of Input Validation:** The router does not adequately validate the contents of the configuration backup files before restoring them. This allows modification of parameters that control system behavior.
*   **Command Injection:** By modifying specific XML parameters within the backup file, an attacker can inject arbitrary commands that will be executed by the router's firmware. Parameters such as `system.button.handler`, `ddns.service.ip_script`, `firewall.include.path`, and `uhttpd.main` can be manipulated to achieve code execution.
*   **Backup File Manipulation:** The backup file format, while seemingly encrypted and compressed, is vulnerable to a bypass. The encryption and compression mechanism is broken, allowing an attacker to decrypt, modify, and re-encrypt the backup file with injected commands.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** A successful exploit allows an attacker to execute arbitrary code on the vulnerable TP-Link router with root privileges. This can lead to complete control over the device.
*   **Device Compromise:** The attacker can modify router settings, potentially intercept network traffic, use the router as a botnet node, or perform other malicious activities.
*   **Network Security Breach:**  Compromising the router can provide an attacker with a foothold into the network, allowing for further attacks on other devices connected to that network.

**Attack Vectors:**

1.  **Authentication:** The attacker needs to authenticate to the router's web interface.
2.  **Backup Download:** Download the router's configuration backup file.
3.  **Backup File Decryption/Modification:** Decrypt, decompress, and modify the downloaded backup file to inject malicious commands into parameters such as `ddns.service.ip_script`.
4.  **Backup File Encryption/Upload:** Encrypt and compress the modified backup file.
5.  **Backup File Restore:** Upload and restore the modified backup file via the router's web interface.
6.  **Trigger Command Execution:** Trigger the injected command by performing a specific action (e.g., pressing the LED button). In the provided exploit, the `ddns.service.ip_script` is modified and automatically triggered after the restoration and subsequent reboot of the router.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs to be on the same network as the router or have access to its web interface via a port forward or VPN.
*   **Credentials:** The attacker must have valid credentials to log in to the router's web interface.
*   **Technical Knowledge:** The attacker needs to understand the router's backup file format, how to decrypt/modify/encrypt it and how to inject commands through the router's functionality.

**Additional Details:**

*   The vulnerability is present in TP-Link routers that have a backup and restore functionality with firmware older than June 2022.
*   The provided exploit code demonstrates how to achieve RCE on a TP-Link Archer AX50 router by injecting a command into the `ddns.service.ip_script` parameter to start the telnet daemon on the router. Other vulnerable parameters are also mentioned in the exploit description.
*   The provided exploit code includes functions for AES encryption and decryption, RSA encryption, and backup file parsing.
*   The vulnerability was reported to TP-Link, and a firmware fix was released on May 27, 2022.