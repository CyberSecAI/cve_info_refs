=== Content from www.pluginvulnerabilities.com_746ed08d_20250114_210751.html ===

[Login](https://www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://www.pluginvulnerabilities.com/product/subscription/)
  + [Set Up](https://www.pluginvulnerabilities.com/set-up/)
* [Why Plugin Vulnerabilities?](https://www.pluginvulnerabilities.com/why-plugin-vulnerabilities/)
  + [We Provide Fixes for Vulnerabilities](https://www.pluginvulnerabilities.com/we-provide-fixes-for-wordpress-plugin-vulnerabilities/)
  + [We Provide Accurate Vulnerability Information](https://www.pluginvulnerabilities.com/we-provide-accurate-information-on-the-affected-versions-of-vulnerable-wordpress-plugins/)
  + [Insightful Blocked Exploit Attempt Reporting](https://www.pluginvulnerabilities.com/insightful-blocked-exploit-attempt-reporting-from-a-wordpress-firewall-plugin/)
  + [How We Are Improving the Security of WordPress Plugins](https://www.pluginvulnerabilities.com/how-we-are-improving-the-security-of-wordpress-plugins/)
  + [Proactive Monitoring for Vulnerabilities in New Versions of WordPress Plugins](https://www.pluginvulnerabilities.com/proactive-monitoring-for-vulnerabilities-in-new-versions-of-wordpress-plugins/)
  + [Select Plugins to Receive Security Reviews](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/)
* Our Plugins
  + [Plugin Vulnerabilities Firewall](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)
  + [Lockdown Mode Plugin for WordPress](https://www.pluginvulnerabilities.com/lockdown-mode-plugin/)
  + [2FA for WooCommerce](https://www.pluginvulnerabilities.com/two-factor-authentication-2fa-for-woocommerce-plugin/)
* Other Services
  + [Plugin Security Review](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/)
  + [Continuous Plugin Security Review Service](https://www.pluginvulnerabilities.com/continuous-wordpress-plugin-security-review-service/)
  + [Theme Security Review](https://www.pluginvulnerabilities.com/wordpress-theme-security-review-service/)
  + [Hacked WordPress Website Cleanup](https://www.whitefirdesign.com/services/hacked-wordpress-website-cleanup.html)
  + [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html)
  + [Blue Hat Hacking Service for WordPress Plugins/Websites](https://www.pluginvulnerabilities.com/blue-hat-hacking-service-for-wordpress-plugins-websites/)
  + [Plugin Vulnerabilities Subscription for ClassicPress](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/)
  + [Plugin Vulnerabilities Daily Newsletter](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/)
  + [Solutions for Web Hosts](https://www.pluginvulnerabilities.com/solutions-for-web-hosts/)
  + [Solutions for Security Providers](https://www.pluginvulnerabilities.com/solutions-for-security-providers/)
* [Plugin Search](https://www.pluginvulnerabilities.com/plugin-search/)
  + [Search WooCommerce Plugins](https://www.pluginvulnerabilities.com/plugin-search/?woocommerce=)
  + [Search Elementor Plugins](https://www.pluginvulnerabilities.com/plugin-search/?elementor=)
* [Research](https://www.pluginvulnerabilities.com/blog/)
  + [Unfixed Security Issues in WordPress](https://www.pluginvulnerabilities.com/unfixed-security-issues-in-wordpress/)
  + [Latest WordPress News](https://www.pluginvulnerabilities.com/latest-wordpress-news/)
  + [Latest ClassicPress News](https://www.pluginvulnerabilities.com/latest-classicpress-news/)
  + [What WordPress Plugins Are No Longer Receiving Updates Through the WordPress Plugin Directory?](https://www.pluginvulnerabilities.com/2024/10/22/what-wordpress-plugins-are-no-longer-receiving-updates-through-the-wordpress-plugin-directory/)
  + [WordPress Firewall Plugin Protection Comparison](https://www.pluginvulnerabilities.com/wordpress-firewall-plugin-protection-comparison/)
  + [Security Advisories on WordPress Plugin Developers](https://www.pluginvulnerabilities.com/security-advisories-on-wordpress-plugin-developers/)
  + [Send us a Tip](https://www.pluginvulnerabilities.com/news-tip/)
* [About](https://www.pluginvulnerabilities.com/about/)
  + [WordPress Plugin Zero-Day Vulnerability Exploitation Info Sharing Partnership](https://www.pluginvulnerabilities.com/wordpress-plugin-zero-day-vulnerability-exploitation-info-sharing-partnership/)
  + [Get Free Help Fixing A Security Vulnerability In Your WordPress Plugin](https://www.pluginvulnerabilities.com/get-free-help-fixing-a-security-vulnerability-in-your-wordpress-plugin/)
  + [Contact Us](https://www.pluginvulnerabilities.com/contact/)
  + [Feedback](https://www.pluginvulnerabilities.com/feedback/)
  + [Report a WordPress Plugin Vulnerability We Are Missing](https://www.pluginvulnerabilities.com/report-a-vulnerability/)

12
Apr
2022

# 5+ Million Install WordPress Plugin Elementor Contains Authenticated Remote Code Execution (RCE) Vulnerability

Late last week, third-party data we monitor showed what was possibly a hacker probing for usage of a WordPress plugin [Elementor](https://wordpress.org/plugins/elementor/), which has 5+ million active installs according to WordPress, by the requesting this file:

> /wp-content/plugins/elementor/readme.txt

We couldn’t find any recent disclosed vulnerabilities that should explain that, so we started doing our standard checks we do in a situation where a hacker may be exploiting an unfixed vulnerability in a plugin. What we immediately found was that plugin isn’t handling basic security right, as we found many functionalities where capabilities checks were missing where they shouldn’t. While some of those where not accessible to users that shouldn’t have access, we found at least one that is and the functionality accessible leads to one of the most serious types of vulnerabilities, remote code execution (RCE). That means that malicious code provided by the attacker can be run by the website.

In this instance, it is possible that the vulnerability might be exploitable by someone not logged in to WordPress, but it can easily be exploited by anyone logged in to WordPress who has access to WordPress admin dashboard. Unless another plugin restricts access to the admin dashboard, that would mean anyone logged in to WordPress would have access.

The vulnerability was introduced in the plugin in version 3.6.0, which was released on March 22. According to WordPress’ latest stats, 30.3 percent of users of the plugin are now on version 3.6.x.

Based on just what we saw in our very limited checking, we would recommend not using this plugin until it has had a thorough security review and all issues are addressed. That it has 5+ million installs and hasn’t been properly secured should be very concerning. It certainly isn’t for a lack of money at the developer, as they [raised 15 million dollars in 2020](https://techcrunch.com/2020/02/26/elementor-raises-15m-for-its-wordpress-website-builder/). It also isn’t for a lack of reason to be concerned, as two years ago it was claimed [a zero-day vulnerability in paid version of the plugin was being exploited](https://blog.nintechnet.com/zero-day-vulnerability-exploited-in-elementor-pro/).

We tested and confirmed that our [firewall plugin for WordPress](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/) already protected against exploitation of this vulnerability when the option to restrict what types of of files can be uploaded in .zip files is enabled, as part of its protection against zero-day vulnerabilities. The next release of the firewall is planned to introduce protection more directly related to this type of situation (which also would be enabled by the default) and we are now looking to expand that protection to address to the situation involved here.

Last week introduced an improvement to our automated tools, including our [Plugin Security Checker,](https://www.pluginvulnerabilities.com/plugin-security-checker/) to detect some instances of code like was vulnerable here and we have made a further improvement based on this situation. So you can check if other plugins might have a similar issue to what was found here using that tool.

## Authenticated Remote Code Execution (RCE)

In the plugin’s file /core/app/modules/onboarding/module.php, the following code is set to run during admin\_init, which means it runs even for those not logged in to WordPress:

| ``` 434 435 436 437 438 439 440  ``` | ``` add_action( 'admin_init', function() { 	if ( wp_doing_ajax() && 		isset( $_POST['action'] ) && 		isset( $_POST['_nonce'] ) && 		wp_verify_nonce( $_POST['_nonce'], Ajax::NONCE_KEY ) 	) { 		$this->maybe_handle_ajax(); ``` |
| --- | --- |

add\_action( 'admin\_init', function() {
if ( wp\_doing\_ajax() &&
isset( $\_POST['action'] ) &&
isset( $\_POST['\_nonce'] ) &&
wp\_verify\_nonce( $\_POST['\_nonce'], Ajax::NONCE\_KEY )
) {
$this->maybe\_handle\_ajax();

That code will run another function in the file, maybe\_handle\_ajax(), if an AJAX request is being made and a valid nonce is provided. That function, in turn, will run other functions depending on the value of the POST input “action”:

| ``` 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403  ``` | ``` private function maybe_handle_ajax() { 	$result = [];   	// phpcs:ignore WordPress.Security.NonceVerification.Missing 	switch ( $_POST['action'] ) { 		case 'elementor_update_site_name': 			// If no value is passed for any reason, no need ot update the site name. 			$result = $this->maybe_update_site_name(); 			break; 		case 'elementor_update_site_logo': 			$result = $this->maybe_update_site_logo(); 			break; 		case 'elementor_upload_site_logo': 			$result = $this->maybe_upload_logo_image(); 			break; 		case 'elementor_update_data_sharing': 			$result = $this->set_usage_data_opt_in(); 			break; 		case 'elementor_activate_hello_theme': 			$result = $this->activate_hello_theme(); 			break; 		case 'elementor_upload_and_install_pro': 			$result = $this->upload_and_install_pro(); 			break; 		case 'elementor_update_onboarding_option': 			$result = $this->maybe_update_onboarding_db_option(); 	} ``` |
| --- | --- |

private function maybe\_handle\_ajax() {
$result = [];
// phpcs:ignore WordPress.Security.NonceVerification.Missing
switch ( $\_POST['action'] ) {
case 'elementor\_update\_site\_name':
// If no value is passed for any reason, no need ot update the site name.
$result = $this->maybe\_update\_site\_name();
break;
case 'elementor\_update\_site\_logo':
$result = $this->maybe\_update\_site\_logo();
break;
case 'elementor\_upload\_site\_logo':
$result = $this->maybe\_upload\_logo\_image();
break;
case 'elementor\_update\_data\_sharing':
$result = $this->set\_usage\_data\_opt\_in();
break;
case 'elementor\_activate\_hello\_theme':
$result = $this->activate\_hello\_theme();
break;
case 'elementor\_upload\_and\_install\_pro':
$result = $this->upload\_and\_install\_pro();
break;
case 'elementor\_update\_onboarding\_option':
$result = $this->maybe\_update\_onboarding\_db\_option();
}

Neither of those does a capabilities check to limit who can access them.

The RCE vulnerability we found involves the function upload\_and\_install\_pro() accessible through the previous function. That function will install a WordPress plugin sent with the request:

| ``` 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323  ``` | ``` private function upload_and_install_pro() { 	$result = []; 	$error_message = __( 'There was a problem uploading your file', 'elementor' );   	// phpcs:ignore WordPress.Security.NonceVerification.Missing 	if ( empty( $_FILES['fileToUpload'] ) ) { 		$result = [ 			'status' => 'error', 			'payload' => [ 				'error_message' => $error_message, 			], 		];   		return $result; 	}   	if ( ! class_exists( 'Automatic_Upgrader_Skin' ) ) { 		require_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php'; 	}   	$skin = new Automatic_Upgrader_Skin(); 	$upgrader = new Plugin_Upgrader( $skin ); 	$upload_result   = $upgrader->install( $_FILES['fileToUpload']['tmp_name'], [ 'overwrite_package' => false ] ); ``` |
| --- | --- |

private function upload\_and\_install\_pro() {
$result = [];
$error\_message = \_\_( 'There was a problem uploading your file', 'elementor' );
// phpcs:ignore WordPress.Security.NonceVerification.Missing
if ( empty( $\_FILES['fileToUpload'] ) ) {
$result = [
'status' => 'error',
'payload' => [
'error\_message' => $error\_message,
],
];
return $result;
}
if ( ! class\_exists( 'Automatic\_Upgrader\_Skin' ) ) {
require\_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php';
}
$skin = new Automatic\_Upgrader\_Skin();
$upgrader = new Plugin\_Upgrader( $skin );
$upload\_result = $upgrader->install( $\_FILES['fileToUpload']['tmp\_name'], [ 'overwrite\_package' => false ] );

That means that arbitrary files can be uploaded to the website. The RCE occurs as the code then tries to activate a plugin that would be located in the location of Elementor Pro:

| ``` 333  ``` | ``` $activated = activate_plugin( WP_PLUGIN_DIR . '/elementor-pro/elementor-pro.php', false, false, true ); ``` |
| --- | --- |

$activated = activate\_plugin( WP\_PLUGIN\_DIR . '/elementor-pro/elementor-pro.php', false, false, true );

So if plugin being uploaded matches that, it will get activated and the code in the relevant file will then run.

Based on all that, the only restriction in place is access to a valid nonce. What we found is that the relevant nonce is included in the line of the source code of admin pages of WordPress that starts “elementorCommonConfig”, which is included when logged in as a user with the Subscriber role.

## WordPress Causes Full Disclosure

As a protest of the moderators of the WordPress Support Forum’s continued inappropriate behavior [we changed from reasonably disclosing to full disclosing vulnerabilities for plugins in the WordPress Plugin Directory in protest, until WordPress gets that situation cleaned up](https://www.pluginvulnerabilities.com/2018/09/25/our-new-disclosure-policy-in-response-to-the-continued-inappropriate-behavior-of-the-wordpress-support-forum-moderators/), so we are releasing this post and then leaving a message about that for the developer through the WordPress Support Forum. (For plugins that are also in the [ClassicPress Plugin Directory](https://directory.classicpress.net/plugins), we will follow [our reasonable disclosure policy](https://www.pluginvulnerabilities.com/vulnerability-disclosure-policy/).)

You can notify the developer of this issue on the forum as well.

Hopefully, the moderators will finally see the light and clean up their act soon, so these full disclosures will no longer be needed (we hope they end soon). You would think they would have already done that, but considering that they believe that having [plugins, which have millions installs, remain in the Plugin Directory despite them knowing they are vulnerable is “appropriate action”,](https://www.pluginvulnerabilities.com/2019/04/22/wordpress-believes-that-leaving-millions-of-installs-of-plugins-vulnerable-to-publicly-known-vulnerabilities-is-appropriate-action/) something is very amiss with them (which is even more reason the moderation needs to be cleaned up).

If the moderation is cleaned up, it would also allow the possibility of being able to use the forum to start discussing fixing the problems caused by the very problematic handling of security by the team running the Plugin Directory, discussions which they have for years [shut down](https://www.pluginvulnerabilities.com/2017/02/17/wordpress-shutdowns-discussion-of-their-refusal-to-warn-about-unfixed-vulnerable-plugins/) through their control of the Support Forum.

**Update:**To clear up the confusion where developers claim we hadn’t tried to notify them through the Support Forum (while at the same time moderators are complaining about us doing just that), here is the message we left for this vulnerability:

![](https://www.pluginvulnerabilities.com/wp-content/uploads/2022/04/elementor-notification.png)

## Is It Fixed?

If you are reading this post down the road the best way to find out if this vulnerability or other WordPress plugin vulnerabilities in plugins you use have been fixed is to sign up for [our service](https://www.pluginvulnerabilities.com/product/subscription/), since what we uniquely do when it comes to that type of data is to test to see if vulnerabilities have really been fixed. Relying on the developer’s information can lead you astray, as we often find that they believe they have fixed vulnerabilities, but have failed to do that.

## Proof of Concept

The following proof of concept will install the plugin specified, when logged in to WordPress.

Replace “[path to WordPress]” with the location of WordPress and “[nonce]” with the value of the nonce on the line of the source that begins on “elementorCommonConfig” on admin pages of the website.

```
<html>
<body>
<form action="http://[path to WordPress]/wp-admin/admin-ajax.php" enctype="multipart/form-data" method="POST">
<input type="hidden" name="action" value="elementor_upload_and_install_pro" />
<input type="hidden" name="_nonce" value="[nonce]" />
<input type="file" name="fileToUpload" />
<input type="submit" value="Submit" />
</form>
</body>
</html>
```

No related posts.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).

---

## Plugin Security Scorecard Grade for Elementor

Checked on August 29, 2024F

[See issues causing the plugin to get less than A+ grade](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=elementor)

[Plugin Vulnerabilities](https://www.pluginvulnerabilities.com)
Posted in [Vulnerability Report](https://www.pluginvulnerabilities.com/category/vulnerability-report/)
[Authenticated Remote Code Execution (RCE)](https://www.pluginvulnerabilities.com/tag/authenticated-remote-code-execution-rce/), [Elementor](https://www.pluginvulnerabilities.com/tag/elementor/), [Vulnerability Report](https://www.pluginvulnerabilities.com/tag/vulnerability-report/)
[2 Comments](https://www.pluginvulnerabilities.com/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/#comments)

# Post navigation

## 2 thoughts on “5+ Million Install WordPress Plugin Elementor Contains Authenticated Remote Code Execution (RCE) Vulnerability”

1. ![](https://secure.gravatar.com/avatar/ae9e363e490e9dec80c29adf989912cc?s=60&d=mm&r=g)

   PowerKiKi -
   [April 18, 2022 at 5:57 am](https://www.pluginvulnerabilities.com/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/#comment-18345)

   This has been fixed in Elementor 3.6.4, as mentioned in changelog “Optimized controls sanitization to enforce better security policies in Onboarding wizard” (<https://wordpress.org/plugins/elementor/#developers>).

   The fix is visible in the original source <https://github.com/elementor/elementor/commit/5c3bcdf4e291e8d1ddb495a938023453646b1020#diff-e1c63fd822393f59547df1d9aa174933e8c48be4bbe3718da019d718d003b235R355-R358>, and a also in WordPress centralized SVN: <https://plugins.trac.wordpress.org/browser/elementor/trunk/core/app/modules/onboarding/module.php?annotate=blame&rev=2709267#L355>

   [Reply](/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/?replytocom=18345#respond)

   * ![](https://secure.gravatar.com/avatar/43d3d05e8661efc480320db4edd33bb6?s=60&d=mm&r=g)

     Plugin Vulnerabilities -
     [April 19, 2022 at 11:12 am](https://www.pluginvulnerabilities.com/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/#comment-18359)

     The vulnerability has been addressed, but the general insecurity hasn’t.

     [Reply](/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/?replytocom=18359#respond)

### Leave a Reply [Cancel reply](/2022/04/12/5-million-install-wordpress-plugin-elementor-contains-authenticated-remote-code-execution-rce-vulnerability/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### What WordPress Security issue do you need help with today?

Protecting Your WordPress Websites

Cleaning Up Hacked WordPress Websites

Ensuring WordPress Websites are Secure

Fixing a Vulnerable WP Plugin You Use

Ensuring a WordPress Plugin is Secure

Maintenance for Abandoned WP Plugin

Ensuring a WordPress Theme is Secure

Protecting Your Customers’ Websites

Fixing a Vulnerable Plugin You Develop

How Many Websites Do You Have?
1
2-10
11+

How Critical is it That Your Website Remain Secure?
Low
Medium
High

or

### Latest WordPress Plugin Security Scorecard Grades

* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/post-content-shortcodes)[Post Content Shortcodes](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=post-content-shortcodes)     D+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/daggerhart-openid-connect-generic)[OpenID Connect Generic C...](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=daggerhart-openid-connect-generic)     B
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/wp-native-php-sessions)[WordPress Native PHP Ses...](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=wp-native-php-sessions)     D+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/mammoth-docx-converter)[Mammoth .docx converter](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=mammoth-docx-converter)     C+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/inactive-logout)[Inactive Logout](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=inactive-logout)     C+
* [See More Recent Grades](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?results=recent)
* [Check Another Plugin](https://www.pluginvulnerabilities.com/plugin-security-scorecard/)
* [Titan Anti-spam & Security vs Jetpack Protect](/plugin-security-scorecard/?slug=anti-spam&vs=jetpack-protect)
### Latest News

* [Matt Mullenweg Will Again Be “Community Member” Ultimately Responsible for WordPress Release With Version 6.8](https://www.pluginvulnerabilities.com/2025/01/14/matt-mullenweg-will-again-be-community-member-ultimately-responsible-for-wordpress-release-with-version-6-8/)
* [New Executive Director of WordPress.org Now Credited as Author of Automattic’s Post Announcing Company’s Reduction in WordPress Contributions](https://www.pluginvulnerabilities.com/2025/01/13/new-executive-director-of-wordpress-org-now-credited-as-author-of-automattics-post-announcing-companys-reduction-in-wordpress-contributions/)
* [The New Executive Director of WordPress.org is Now Claiming to Only Spend 5 Hours a Week on WordPress](https://www.pluginvulnerabilities.com/2025/01/10/the-new-executive-director-of-wordpress-org-is-now-claiming-to-only-spend-5-hours-a-week-on-wordpress/)
### Follow Us

* [Google News](https://news.google.com/publications/CAAqBwgKMNaxwAsw6MzXAw)
* [Bluesky](https://bsky.app/profile/pluginvulns.bsky.social)
* [RSS](https://www.pluginvulnerabilities.com/category/news/feed/)
### Latest Plugin Security Reviews

* [WordPress Plugin Security Review: WP API Privacy](https://www.pluginvulnerabilities.com/2024/11/18/wordpress-plugin-security-review-wp-api-privacy/)
* [WordPress Plugin Security Review: Two Factor](https://www.pluginvulnerabilities.com/2024/09/17/wordpress-plugin-security-review-two-factor/)
* [WordPress Plugin Security Review: Download Monitor](https://www.pluginvulnerabilities.com/2024/09/06/wordpress-plugin-security-review-download-monitor/)

Powered by WordPress and WooCommerce

© 2016-2025 [White Fir Design LLC](http://www.whitefirdesign.com/) | [Privacy Policy](/privacy-policy/)
 Fruitful theme by [fruitfulcode](http://fruitfulcode.com)

[↑](#top "Back to top")

![](https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)



=== Content from www.wordfence.com_4caecb12_20250114_210752.html ===


![](https://www.wordfence.com/wp-content/uploads/2022/04/abstract-futuristic-cyberspace-with-a-hacked-array-of-binary-data-vector-id969859872.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

April 13, 2022

# Critical Remote Code Execution Vulnerability in Elementor

On March 29, 2022, the Wordfence Threat Intelligence team initiated the disclosure process for a critical vulnerability in the Elementor plugin that allowed any authenticated user to upload arbitrary PHP code. Elementor is one of the most popular WordPress plugins and is installed on over 5 million websites.

We sent our disclosure to the official Elementor security contact email address on March 29, and followed up on April 5, 2022. As we did not receive a response by April 11, 2022, we sent the disclosure to the WordPress plugins team. A patched version of the plugin, 3.6.3, was released the next day on April 12, 2022.

[Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) users received a firewall rule protecting against this issue on March 29, 2022. Sites still running the free version of Wordfence will receive the same protection 30 days later, on April 28, 2022.

---

**Description:** Insufficient Access Control leading to Subscriber+ Remote Code Execution

**Affected Plugin:** [Elementor](https://wordpress.org/plugins/elementor/)

**Plugin Slug:** elementor

**Plugin Developer:** Elementor

**Affected Versions:** 3.6.0 – 3.6.2

**CVE ID:** CVE-2022-1329

**CVSS Score**: 9.9(Critical)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**Researcher/s**: Ramuel Gall

**Fully Patched Version**: 3.6.3

The Elementor plugin for WordPress introduced an Onboarding module in version 3.6.0, designed to simplify the initial setup of the plugin. The module uses an unusual method to register AJAX actions, adding an `admin_init` listener in its constructor that first checks whether or not a request was to the AJAX endpoint and contains a valid nonce before calling the `maybe_handle_ajax` function.

```
		add_action( 'admin_init', function() {
			if ( wp_doing_ajax() &&
				isset( $_POST['action'] ) &&
				isset( $_POST['_nonce'] ) &&
				wp_verify_nonce( $_POST['_nonce'], Ajax::NONCE_KEY )
			) {
				$this->maybe_handle_ajax();
			}
		} );
```

Unfortunately no capability checks were used in the vulnerable versions. There are a number of ways for an authenticated user to obtain the `Ajax::NONCE_KEY`, but one of the simplest ways is to view the source of the admin dashboard as a logged-in user, as it is present for all authenticated users, even for subscriber-level users.

This means that any logged-in user could use any of the onboarding functions. Additionally, an *unauthenticated* attacker with access to the `Ajax::NONCE_KEY` could use any of the functions called from `maybe_handle_ajax`, though this would likely require a separate vulnerability.

The function with the most severe impact was the `upload_and_install_pro` function. An attacker could craft a fake malicious “Elementor Pro” plugin zip and use this function to install it. Any code present in the fake plugin would be executed, which could be used to take over the site or access additional resources on the server.

In addition to this functionality, a less sophisticated attacker could simply deface the site by using the `maybe_update_site_name`, `maybe_upload_logo_image`, and `maybe_update_site_logo` functions to change the site name and logo.

## Timeline

**March 29, 2022** – We finish our investigation and deploy a firewall rule to protect [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) customers. We send our full disclosure to the plugin developer’s official security contact.

**April 5, 2022** – We follow up with the plugin developer’s security contact as we have not yet received a response.

**April 11, 2022** – We send our full disclosure to the WordPress Plugins team.

**April 12, 2022** – A patched version of Elementor is released.

**April 28, 2022** – The firewall rule becomes available to free Wordfence users.

## Conclusion

In today’s post, we covered a Critical vulnerability that allows any authenticated user to upload and execute malicious code on a site running a vulnerable version of the Elementor plugin. If your site is using the Elementor plugin, we urge you to update immediately. The good news is that the vulnerability is not present in versions prior to 3.6.0 and was successfully patched in 3.6.3.

[Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), Wordfence Care, and Wordfence Response customers are fully protected from this vulnerability. Sites running the free version of Wordfence will receive the same protection on April 28, 2022, but have the option of updating Elementor to the patched version 3.6.3 to eliminate the risk immediately.

If you believe your site has been compromised as a result of this vulnerability or any other vulnerability, we offer Incident Response services via [Wordfence Care](https://www.wordfence.com/products/wordfence-care/). If you need your site cleaned immediately, [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) offers the same service with 24/7/365 availability and a 1-hour response time. Both these products include hands-on support in case you need further assistance.

If you know a friend or colleague who is using WordPress, we highly recommend forwarding this advisory to them to help keep their sites protected, as this is a Critical vulnerability that makes it easy for attackers to take over a site.

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Felementor-critical-remote-code-execution-vulnerability%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Felementor-critical-remote-code-execution-vulnerability%2F&text=Critical%20Remote%20Code%20Execution%20Vulnerability%20in%20Elementor&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Felementor-critical-remote-code-execution-vulnerability%2F)

## Comments

12 Comments

* ![](https://secure.gravatar.com/avatar/af323cfd2b5ea1013c048088421b83d0?s=96&d=mm&r=g)
  Allen Essensa
  April 13, 2022
   10:22 am

  I just had 4 sites using elementor rendered broken (won't start sites - just displays fatal error message on startup that's emailed to admin account)
* ![](https://secure.gravatar.com/avatar/0bc360de631d78cee795e84c3e2e980d?s=96&d=mm&r=g)
  Jay
  April 13, 2022
   10:55 am

  Hi,

  Elementor did another update just now to 3.6.4 do you know if this is also part of the exploit or if 3.6.3 is fine? We just pushed an update after receiving a notice from WordFence yesterday to 3.6.3 this morning on a large variety of websites but I don't know if it is safe to leave it on 3.6.3 or if we should also update to 3.6.4 right away.

  Your thoughts?

  Thanks!

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 13, 2022
   11:45 am

  Hi Jay,

  It looks like the 3.6.4 patch offers some security improvements, particularly more fine-grained access control as well as sanitization improvements for some of the other onboarding functions that don't allow direct code execution. If you're the sole administrator on your site you're likely fine, but as a general rule we recommend updating to new security patches as soon as possible. While the original patch was sufficient to prevent abuse in almost all cases, there may be configurations where they're necessary and it's great to see Elementor following best practices here.

* ![](https://secure.gravatar.com/avatar/0bc360de631d78cee795e84c3e2e980d?s=96&d=mm&r=g)
  Jay
  April 13, 2022
   12:21 pm

  Thanks for the information!
* ![](https://secure.gravatar.com/avatar/ec5f261d7d1bdcf7bccf8b2ae9951543?s=96&d=mm&r=g)
  Andy Gee
  April 13, 2022
   12:35 pm

  It's interesting to note that those (possibly most) who use Elementor, receive it bundled with a theme and as such, without the automatic ability to update.

  I believe a step in the right direction would be that premium publishers patch all prior versions when a vulnerability is discovered without the need to purchase a license. After all it is not the fault of the end user and it would go a long way toward showing ethical practices are at least equal to financial gain.

  Personally I don't use Elementor so if I have my assumptions twisted for this specific publisher I apologize.

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 14, 2022
   7:12 am

  Hi Andy,

  Elementor is fairly good in this respect, even if it's bundled with a theme as a requirement, what's bundled is the free version which contains most of the functionality and will continue to update. But you're not wrong that certain premium-only site builder plugins have had this problem in the past.

* ![](https://secure.gravatar.com/avatar/41a9c5f05817a16c7e8c9a549ef23857?s=96&d=mm&r=g)
  Doloris Lajoie
  April 13, 2022
   2:32 pm

  I guess I may be asking for too much, but as a "free user", I honestly expect a notification from your software about this....which might allow me to take action on my own. We, after all, are at WAR with Russia and particularly vulnerable right now. Getting protection a month after the fact doesn't cut it.

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 14, 2022
   7:16 am

  Hi Doloris,

  The Wordfence scanner will notify you when a known vulnerable plugin is installed, and you can update it immediately to secure your site. As a rule, though, we can't do that until after we publicly disclose the issue, so if you're on the mailing list that's likely to be the first place you hear about our finds.

* ![](https://secure.gravatar.com/avatar/60c0740bf9709db654e20f86636ba833?s=96&d=mm&r=g)
  Jordan
  April 15, 2022
   6:45 pm

  Can this come from the vulnerability?

  Warning: Cannot modify header information - headers already sent by (output started at /home/somarzfd/public\_html/wp-blog-header.php:1) in /home/xxx/public\_html/wp-includes/pluggable.php on line 1355

  Warning: Cannot modify header information - headers already sent by (output started at /home/somarzfd/public\_html/wp-blog-header.php:1) in /home/xxx/public\_html/wp-includes/pluggable.php on line 1358

  all of a sudden my website is broken

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 18, 2022
   6:22 am

  Hi Jordan,

  That kind of error can be caused by an infected site, or by code that has been otherwise modified incorrectly. It doesn't necessarily mean that your site has been infected, but if you or your site developer haven't touched the site recently then it's definitely worth investigating. Whether or not the issue was caused by this vulnerability would be difficult to determine without a specialist reviewing the issue. If you want to try to DIY we do have a starter guide on how to clean your site using the Wordfence plugin as well at https://www.wordfence.com/docs/how-to-clean-a-hacked-wordpress-site-using-wordfence/

* ![](https://secure.gravatar.com/avatar/bf58469551f49952917d5247d55f2243?s=96&d=mm&r=g)
  Amy
  April 19, 2022
   3:25 pm

  Hi,

  Every site I run Elementor on is hacked. I have the latest update (I pay for the premium so its not just the free level impacted if anyone wondered).

  I cannot find a way to fix any of the sites. It is even going around my maintenance mode. Does anyone have any advice besides reverting from a back up because we have tried on all the sites already. We also removed the plug in from the file manager wp-content folder, etc. Nothing is working.

  Thank you for any help.

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 20, 2022
   6:42 am

  Hi Amy,

  It can be difficult to clean multiple sites, especially if they're all hosted on the same hosting account, since it only takes one missed malicious file to reinfect the whole site. For that reason I would recommend moving each site to a separate hosting account and then cleaning them individually. Note that this would also be a requirement if you choose to have our Incident Response team take a look at it https://www.wordfence.com/products/wordfence-care/. We do have some tips at https://www.wordfence.com/docs/how-to-clean-a-hacked-wordpress-site-using-wordfence/ as well.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from plugins.trac.wordpress.org_a63fce33_20250114_210747.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2708766%2Felementor%2Ftrunk%2Fcore%2Fapp%2Fmodules%2Fonboarding%2Fmodule.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2688036/elementor/trunk/core/app/modules/onboarding/module.php "Changeset 2688036 for elementor/trunk/core/app/modules/onboarding/module.php")
* [Next Change](/changeset/2709267/elementor/trunk/core/app/modules/onboarding/module.php "Changeset 2709267 for elementor/trunk/core/app/modules/onboarding/module.php") →

---

# Changeset [2708766](/changeset/2708766 "Show full changeset") for [elementor/trunk/core/app/modules/onboarding/module.php](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2708766 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
04/12/2022 07:29:58 PM
([3 years](/timeline?from=2022-04-12T19%3A29%3A58Z&precision=second "See timeline at 04/12/2022 07:29:58 PM") ago)

Author:
KingYes
Message:

Upload v3.6.3

File:

1 edited

* [elementor/trunk/core/app/modules/onboarding/module.php](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2708766 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [elementor/trunk/core/app/modules/onboarding/module.php](/changeset/2708766/elementor/trunk/core/app/modules/onboarding/module.php "Show the changeset 2708766 restricted to elementor/trunk/core/app/modules/onboarding/module.php")

  | [r2688036](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2688036#L3 "Show revision 2688036 of this file in browser") | [r2708766](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2708766#L3 "Show revision 2708766 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 |  |
  | 4 | 4 | use Automatic\_Upgrader\_Skin; |
  | 5 |  | ~~use Elementor\Core\App\Modules\KitLibrary\Connect\Kit\_Library;~~ |
  | 6 | 5 | use Elementor\Core\Base\Module as BaseModule; |
  | 7 | 6 | use Elementor\Core\Common\Modules\Ajax\Module as Ajax; |
  | 8 | 7 | use Elementor\Core\Common\Modules\Connect\Apps\Library; |
  | 9 |  | ~~use Elementor\Core\Common\Modules\Connect\Module as ConnectModule;~~ |
  | 10 | 8 | use Elementor\Core\Files\Uploads\_Manager; |
  | 11 | 9 | use Elementor\Plugin; |
  | […](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2688036#L94) | […](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2708766#L92) |  |
  | 94 | 92 | 'source' => 'generic', |
  | 95 | 93 | ] ), |
  |  | 94 | 'signUp' => $library->get\_admin\_url( 'authorize', [ |
  |  | 95 | 'utm\_source' => 'onboarding-wizard', |
  |  | 96 | 'utm\_campaign' => 'connect-account', |
  |  | 97 | 'utm\_medium' => 'wp-dash', |
  |  | 98 | 'utm\_term' => self::VERSION, |
  |  | 99 | 'source' => 'generic', |
  |  | 100 | 'screen\_hint' => 'signup', |
  |  | 101 | ] ), |
  | 96 | 102 | 'uploadPro' => Plugin::$instance->app->get\_base\_url() . '#/onboarding/uploadAndInstallPro?mode=popup', |
  | 97 | 103 | ], |
  | […](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2688036#L436) | […](/browser/elementor/trunk/core/app/modules/onboarding/module.php?rev=2708766#L442) |  |
  | 436 | 442 | isset( $\_POST['action'] ) && |
  | 437 | 443 | isset( $\_POST['\_nonce'] ) && |
  | 438 |  | wp\_verify\_nonce( $\_POST['\_nonce'], Ajax::NONCE\_KEY ) |
  |  | 444 | wp\_verify\_nonce( $\_POST['\_nonce'], Ajax::NONCE\_KEY ) && |
  |  | 445 | current\_user\_can( 'manage\_options' ) |
  | 439 | 446 | ) { |
  | 440 | 447 | $this->maybe\_handle\_ajax(); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2708766)
* [Zip Archive](?format=zip&new=2708766)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from packetstormsecurity.com_26cdb10c_20250114_210746.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


