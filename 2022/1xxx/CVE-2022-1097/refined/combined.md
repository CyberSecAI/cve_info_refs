=== Content from www.mozilla.org_e6c176ce_20250114_191636.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-13

## Security Vulnerabilities fixed in Firefox 99

Announced
April 5, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 99

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potentially exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28283: Missing security checks for fetching sourceMapURL](#CVE-2022-28283)

Reporter
Gijs
Impact
moderate
##### Description

The sourceMapURL feature in devtools was missing security checks that would have allowed a webpage to attempt to include local files or other files that should have been inaccessible.

##### References

* [Bug 1754066](https://bugzilla.mozilla.org/show_bug.cgi?id=1754066)

#### [#CVE-2022-28284: Script could be executed via svg's use element](#CVE-2022-28284)

Reporter
Leo Balter
Impact
moderate
##### Description

SVG's `<use>` element could have been used to load unexpected content that could have executed script in certain circumstances. While the specification seems to allow this, other browsers do not, and web developers relied on this property for script security so gecko's implementation was aligned with theirs.

##### References

* [Bug 1754522](https://bugzilla.mozilla.org/show_bug.cgi?id=1754522)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-28287: Text Selection could crash Firefox](#CVE-2022-28287)

Reporter
Aryan Sinha
Impact
low
##### Description

In unusual circumstances, selecting text could cause text selection caching to behave incorrectly, leading to a crash.

##### References

* [Bug 1741515](https://bugzilla.mozilla.org/show_bug.cgi?id=1741515)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](#CVE-2022-28289)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98 and Firefox ESR 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

#### [#CVE-2022-28288: Memory safety bugs fixed in Firefox 99](#CVE-2022-28288)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers and community members Randell Jesup, Sebastian Hengst, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746415%2C1746495%2C1746500%2C1747282%2C1748759%2C1749056%2C1749786%2C1751679%2C1752120%2C1756010%2C1756017%2C1757213%2C1757258%2C1757427)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d827746b_20250114_191636.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-14

## Security Vulnerabilities fixed in Firefox ESR 91.8

Announced
April 5, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.8

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-1196: Use-after-free after VR Process destruction](#CVE-2022-1196)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

After a VR Process is destroyed, a reference to it may have been retained and used, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1750679](https://bugzilla.mozilla.org/show_bug.cgi?id=1750679)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potential exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](#CVE-2022-28289)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98 and Firefox ESR 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_08ed189d_20250114_191637.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-15

## Security Vulnerabilities fixed in Thunderbird 91.8

Announced
April 5, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.8

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-1197: OpenPGP revocation information was ignored](#CVE-2022-1197)

Reporter
Thunderbird user Johannes König
Impact
moderate
##### Description

When importing a revoked key that specified key compromise as the revocation reason, Thunderbird did not update the existing copy of the key that was not yet revoked, and the existing key was kept as non-revoked. Revocation statements that used another revocation reason, or that didn't specify a revocation reason, were unaffected.

##### References

* [Bug 1754985](https://bugzilla.mozilla.org/show_bug.cgi?id=1754985)

#### [#CVE-2022-1196: Use-after-free after VR Process destruction](#CVE-2022-1196)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

After a VR Process is destroyed, a reference to it may have been retained and used, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1750679](https://bugzilla.mozilla.org/show_bug.cgi?id=1750679)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potential exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Thunderbird 91.8](#CVE-2022-28289)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_9473b078_20250114_191636.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1745667)
* [XML](/show_bug.cgi?ctype=xml&id=1745667)

Closed
[Bug 1745667](/show_bug.cgi?id=1745667)
(CVE-2022-1097)

Opened 3 years ago
Closed 3 years ago

# Crash in [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
▾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
▾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

other

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows 10

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

## Tracking

### (firefox-esr9199+ fixed, firefox97 wontfix, firefox98+ wontfix, firefox99+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.76

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [99+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=99%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox97 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr91 | 99+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox97 |  | wontfix |
| firefox98 | + | wontfix |
| firefox99 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jesup, Assigned: jschanck)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/291ff310b7805a4159d7f46af196813e?d=mm&size=40)  [jschanck](/user_profile?user_id=689878)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1370866](/show_bug.cgi?id=1370866 "RESOLVED FIXED - check return value of PK11Slot_GetNSSToken()")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1763237](/show_bug.cgi?id=1763237 "NEW - [meta] Thread safety issues in NSS"), [1467587](/show_bug.cgi?id=1467587 "RESOLVED DUPLICATE - Crash in PR_Unlock | nssTokenObjectCache_FindObjectsByTemplate | nssToken_FindObjectsByTemplate | nssToken_FindCertificateByIssuerAndSerialNumber | nssTrustDomain_UpdateCachedTokenCerts | PK11_DoPassword"), [1756271](/show_bug.cgi?id=1756271 "RESOLVED FIXED - Crash in nssSlot_IsTokenPresent | nssSlot_GetToken")

[1760872](/show_bug.cgi?id=1760872 "RESOLVED FIXED - Upgrade Firefox 91.8esr to use NSS 3.68.3")

Dependency [tree](/showdependencytree.cgi?id=1745667&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1745667)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1467587](/show_bug.cgi?id=1467587 "RESOLVED DUPLICATE - Crash in PR_Unlock | nssTokenObjectCache_FindObjectsByTemplate | nssToken_FindObjectsByTemplate | nssToken_FindCertificateByIssuerAndSerialNumber | nssTrustDomain_UpdateCachedTokenCerts | PK11_DoPassword"), [1728048](/show_bug.cgi?id=1728048 "RESOLVED DUPLICATE - Intermittent org.mozilla.geckoview.test.crash.ParentCrashTest#crashParent | application crashed [@ nssToken_FindObjectsByTemplate]")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1755555](/show_bug.cgi?id=1755555 "RESOLVED FIXED - Crash in nssTrustDomain_GetActiveSlots")

## Details

### (4 keywords, Whiteboard: [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage][adv-main99+][adv-esr91.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-1097

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage][adv-main99+][adv-esr91.8+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [btot](/user_profile?user_id=553429) | [qe-verify](#a7423330_553429 "3 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

[[@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword ]](https://crash-stats.mozilla.org/signature/?signature=PR_Unlock%20%7C%20nssTokenObjectCache_FindObjectsByTemplate%20%7C%20nssToken_FindObjectsByTemplate%20%7C%20nssToken_FindCertificateByIssuerAndSerialNumber%20%7C%20nssTrustDomain_UpdateCachedTokenCerts%20%7C%20PK11_DoPassword)

[[@ nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword ]](https://crash-stats.mozilla.org/signature/?signature=nssTokenObjectCache_FindObjectsByTemplate%20%7C%20nssToken_FindObjectsByTemplate%20%7C%20nssToken_FindCertificateByIssuerAndSerialNumber%20%7C%20nssTrustDomain_UpdateCachedTokenCerts%20%7C%20PK11_DoPassword)

[[@ nssToken\_FindObjectsByTemplate ]](https://crash-stats.mozilla.org/signature/?signature=nssToken_FindObjectsByTemplate)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [Bug 1745667 - Make PK11Slot\_GetNSSToken thread safe. r?rrelyea,beurdouche](/attachment.cgi?id=9261617)  [3 years ago](#c4)  [John Schanck [:jschanck]](/user_profile?user_id=689878)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c10 "3 years ago") | [Details](/attachment.cgi?id=9261617&action=edit) | [Review](/attachment.cgi?id=9261617) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9269930)  [3 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   248 bytes, text/plain |  | [Details](/attachment.cgi?id=9269930&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1745667#c0)• 3 years ago |
|  | |

Long-term UAF, appears to go back to either 60 or 72. Hopefully a duplicate.

Crash report: <https://crash-stats.mozilla.org/report/index/7f2e9311-1197-45bb-a6a4-134c10211117>

Reason: `EXCEPTION_ACCESS_VIOLATION_READ`

Top 10 frames of crashing thread:

```
0 nss3.dll PR_Unlock nsprpub/pr/src/threads/combined/prulock.c:326
1 nss3.dll nssTokenObjectCache_FindObjectsByTemplate security/nss/lib/dev/devutil.c:736
2 nss3.dll nssToken_FindObjectsByTemplate security/nss/lib/dev/devtoken.c:412
3 nss3.dll nssToken_FindCertificateByIssuerAndSerialNumber security/nss/lib/dev/devtoken.c:832
4 nss3.dll nssTrustDomain_UpdateCachedTokenCerts security/nss/lib/pki/tdcache.c:474
5 nss3.dll PK11_DoPassword security/nss/lib/pk11wrap/pk11auth.c:640
6 nss3.dll PK11_Authenticate security/nss/lib/pk11wrap/pk11auth.c:324
7 xul.dll mozilla::psm::FindClientCertificatesWithPrivateKeys security/manager/ssl/nsNSSComponent.cpp:2684
8 xul.dll ClientAuthDataRunnable::RunOnTargetThread security/manager/ssl/nsNSSIOLayer.cpp:2317
9 xul.dll mozilla::psm::SyncRunnableBase::Run security/manager/ssl/PSMRunnable.cpp:31

```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a351357_1689)• 3 years ago |

Group: core-security → dom-core-security

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1745667#c1)• 3 years ago |
|  | |

Hey Benjamin, is this a sec-high?

Assignee: nobody → nobodyGroup: dom-core-security → crypto-core-securityComponent: Security → LibrariesFlags: needinfo?(bbeurdouche)Product: Core → NSSVersion: unspecified → other

|  | [Benjamin Beurdouche [:beurdouche]](/user_profile?user_id=622637) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a3350593_622637)• 3 years ago |

Flags: needinfo?(bbeurdouche)

|  | [Benjamin Beurdouche [:beurdouche]](/user_profile?user_id=622637) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1745667#c2)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1745667&comment_id=15741192 "1 revision") |
|  | |

Difficult to say, the crash address seem to have a fixed offset, so my understanding is that it should not be that easy to trigger.

Maybe sec-moderate, but I would trust Randall's and Dan's judgement more than mine...

|  | [Benjamin Beurdouche [:beurdouche]](/user_profile?user_id=622637) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a3353476_622637)• 3 years ago |

Priority: -- → P3

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1745667#c3)• 3 years ago |
|  | |

In `PK11_DoPassword(PK11SlotInfo *slot, ...)` we have a non-owning reference to `slot->nssToken` that we pass to `nssTrustDomain_UpdateCachedTokenCerts`. The crash happens when the reference count for `slot->nssToken` is decremented to 0 in another thread (probably [here](https://searchfox.org/mozilla-central/source/security/manager/ssl/nsNSSComponent.cpp#868), based on the fact that this affects Mac OS and Windows versions after osclientcerts landed). We should be able to reduce the crash frequency by taking an owning reference to `slot->nssToken` in `PK11_DoPassword`.

There's a deeper problem though, and I think that fixing this bug properly would involve finishing some of the abandoned "Stan" work, e.g. [Bug 135532](/show_bug.cgi?id=135532 "NEW - trust domains should contain slots, not tokens"). As it stands, I see no thread-safe way to obtain an owning reference to `slot->nssToken` from `PK11SlotInfo *slot`; c.f. the extensive discussion `PK11_GetNSSToken` in [Bug 1366187](/show_bug.cgi?id=1366187 "RESOLVED WONTFIX - Crash in nssToken_AddRef | find_certs_from_nickname"). Performing a null check on `slot->nssToken` before taking an owning reference, as in [Bug 1370866](/show_bug.cgi?id=1370866 "RESOLVED FIXED - check return value of PK11Slot_GetNSSToken()"), narrows the window for a race but does not eliminate it.

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1745667#c4)• 3 years ago |
|  | |

Attached file
[Bug 1745667 - Make PK11Slot\_GetNSSToken thread safe. r?rrelyea,beurdouche](attachment.cgi?id=9261617) (obsolete)
— [Details](attachment.cgi?id=9261617&action=edit)

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1745667#c5)• 3 years ago |
|  | |

Hmm it seems that:

1. the slot should own a reference to it's nssToken,
2. There should be a function which "atomicly" returns the token for the slot.

   2a) the returned token should be checked for null
3. The code that changes or clears nssToken should use the same lock as the one in function 2 to make sure #2 is atomic.

The biggest question is does 1) mess up the token life cycle?

bob

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1745667#c6)• 3 years ago |
|  | |

So we already have the appropriate calls (warning pseudo code without complete spellings):

PK11Slot\_SetNSSToken() {

new == addref(nsst);

lock()

old = ssl->nssToken;

ssl->nssToken = new;

unlock();

if (old) freeref(old);

}

PK11Slot\_GetNSSToken()

{

lock();

if (ssl->nssToken) {

nsst = addref(ssl->nssToken);

}

unlock();

return nsst;

}

For the one existing caller we need to add an extra destroy because it now returns a reference. Other places we can now use this function to get a durable token (until it's freed).

bob

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a4674128_600971)• 3 years ago |

[Attachment #9261617](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") -
Attachment description: Bug 1745667 - Increment slot->nssToken ref count before calling nssTrustDomain\_UpdateCachedTokenCerts. r?rrelyea,beurdouche → Bug 1745667 - Make PK11Slot\_GetNSSToken thread safe. r?rrelyea,beurdouche

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1745667#c7)• 3 years ago |
|  | |

Thanks, Bob. I've taken this approach in the latest revision. The patch also adds null checks for all but two of the `PK11Slot_GetNSSToken` calls. There are two exceptions are in `sha1_hash` and `md5_hash` in `devtoken.c`. Those require a bit of refactoring, and I think they should be handled in a separate bug.

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1745667#c8)• 3 years ago |
|  | |

Thanks John, I really had only one comment on the patch, other than that it looks good. Since it's so extensive, it would be good to make sure all our tests (including the memory leak tests) come back clean.

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a4682042_689878)• 3 years ago |

Assignee: nobody → jschanck

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1745667#c9)• 3 years ago |
|  | |

Comment on [attachment 9261617](/attachment.cgi?id=9261617 "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") [[details]](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche")

[Bug 1745667](/show_bug.cgi?id=1745667 "RESOLVED FIXED - Crash in [@ PR_Unlock | nssTokenObjectCache_FindObjectsByTemplate | nssToken_FindObjectsByTemplate | nssToken_FindCertificateByIssuerAndSerialNumber | nssTrustDomain_UpdateCachedTokenCerts | PK11_DoPassword]") - Make PK11Slot\_GetNSSToken thread safe. r?rrelyea,beurdouche

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. The patch fixes data races that happen primarily at shutdown. The exact location of this UAF is not obvious from the patch. The fact that there may be UAFs due to threading issues in token destruction is well documented in public bugs (e.g. 1607588, 1366187, 1370866).
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Not difficult. The patch applies cleanly to NSS 3.68.2, but I have not reviewed it thoroughly.
* **How likely is this patch to cause regressions; how much testing does it need?**: The most likely type of regression would be a memory leak. A full nss-try run should be sufficient.
[Attachment #9261617](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1745667#c10)• 3 years ago |
|  | |

Comment on [attachment 9261617](/attachment.cgi?id=9261617 "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") [[details]](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche")

[Bug 1745667](/show_bug.cgi?id=1745667 "RESOLVED FIXED - Crash in [@ PR_Unlock | nssTokenObjectCache_FindObjectsByTemplate | nssToken_FindObjectsByTemplate | nssToken_FindCertificateByIssuerAndSerialNumber | nssTrustDomain_UpdateCachedTokenCerts | PK11_DoPassword]") - Make PK11Slot\_GetNSSToken thread safe. r?rrelyea,beurdouche

Approved to land and request uplift

[Attachment #9261617](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1745667#c11)• 3 years ago |
|  | |

Hi John, is this ready to land?

Flags: needinfo?(jschanck)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a5778711_75935)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B)
[tracking-firefox99](/buglist.cgi?f1=cf_tracking_firefox99&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1745667#c12)• 3 years ago |
|  | |

Changing the priority to p1 as the bug is tracked by a release manager for the current beta.

See [What Do You Triage](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html) for more information

Priority: P3 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1745667#c13)• 3 years ago |
|  | |

In Firefox this crash happens in the parent process, and not directly in response to things happening in the client. It seems safe to call this race "sec-moderate for Firefox" and not have to backport to ESR.

On the other hand, it does not look like there's a big regression risk. It would be nice to have it backported

Keywords: [csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---)Whiteboard: [sec-moderate for Firefox]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a5792941_1689)• 3 years ago |

See Also: → [1755555](/show_bug.cgi?id=1755555 "RESOLVED FIXED - Crash in nssTrustDomain_GetActiveSlots")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1745667#c14)• 3 years ago |
|  | |

John mentioned wanting to check this patch in as part of [bug 1370866](/show_bug.cgi?id=1370866 "RESOLVED FIXED - check return value of PK11Slot_GetNSSToken()") which seems like a good plan.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a5793346_1689)• 3 years ago |

Depends on: [1370866](/show_bug.cgi?id=1370866 "RESOLVED FIXED - check return value of PK11Slot_GetNSSToken()")Whiteboard: [sec-moderate for Firefox] → [sec-moderate for Firefox][will be fixed in bug 1370866]

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1745667#c15)• 3 years ago |
|  | |

Current plan is to test on nss-try early next week and check in under [bug 1370866](/show_bug.cgi?id=1370866 "RESOLVED FIXED - check return value of PK11Slot_GetNSSToken()") before the NSS 3.76 tree freeze on Thursday, Feb 24.

Flags: needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a5805910_689878)• 3 years ago |

Blocks: [1467587](/show_bug.cgi?id=1467587 "RESOLVED DUPLICATE - Crash in PR_Unlock | nssTokenObjectCache_FindObjectsByTemplate | nssToken_FindObjectsByTemplate | nssToken_FindCertificateByIssuerAndSerialNumber | nssTrustDomain_UpdateCachedTokenCerts | PK11_DoPassword")

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a5897976_689878)• 3 years ago |

Blocks: [1756271](/show_bug.cgi?id=1756271 "RESOLVED FIXED - Crash in nssSlot_IsTokenPresent | nssSlot_GetToken")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1745667#c16)• 3 years ago |
|  | |

IIUC, we're having this all ride with the 99/91.8esr cycle.

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B) → [99+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=99%2B)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a6474645_600971)• 3 years ago |

[Attachment #9261617](/attachment.cgi?id=9261617&action=edit "Bug 1745667 - Make PK11Slot_GetNSSToken thread safe. r?rrelyea,beurdouche") -
Attachment is obsolete: true

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1745667#c17)• 3 years ago |
|  | |

<https://hg.mozilla.org/projects/nss/rev/d7e8c2df6bcaa2d723c94659e67b033a0bdd5ab2>

<https://hg.mozilla.org/mozilla-central/rev/1ecdb4c33adf>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a6477551_575867)• 3 years ago |

Crash Signature: [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword] → [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_…

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a6831811_75935)• 3 years ago |

Group: crypto-core-security → core-security-releaseStatus: NEW → RESOLVEDCrash Signature: [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssTokenObjectCache\_FindObjectsByTemplate | → [@ PR\_Unlock | nssTokenObjectCache\_FindObjectsByTemplate | nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssTokenObjectCache\_FindObjectsByTemplate |Closed: 3 years ago
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1745667#c19)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1745667) to reply.

Flags: needinfo?(jschanck)Whiteboard: [sec-moderate for Firefox][will be fixed in bug 1370866] → [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey]

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a6912422_689878)• 3 years ago |

Flags: needinfo?(jschanck)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a7423330_553429)• 3 years ago |

Flags: qe-verify-Whiteboard: [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] → [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage]

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a8760654_689878)• 3 years ago |

Blocks: [1760872](/show_bug.cgi?id=1760872 "RESOLVED FIXED - Upgrade Firefox 91.8esr to use NSS 3.68.3")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a8890871_578488)• 3 years ago |

Alias: CVE-2022-1097

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a9155920_578488)• 3 years ago |

Whiteboard: [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage] → [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage][adv-main99+]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a9166861_75935)• 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)Target Milestone: --- → 3.76

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1745667#c20)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9269930)
— [Details](attachment.cgi?id=9269930&action=edit)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a9260328_575867)• 3 years ago |

Crash Signature: nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword] → nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssToken\_FindObjectsByTemplate]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a9397259_578488)• 3 years ago |

Crash Signature: nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssToken\_FindObjectsByTemplate] → nssToken\_FindObjectsByTemplate | nssToken\_FindCertificateByIssuerAndSerialNumber | nssTrustDomain\_UpdateCachedTokenCerts | PK11\_DoPassword]
[@ nssToken\_FindObjectsByTemplate]Whiteboard: [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage][adv-main99+] → [sec-moderate for Firefox][will be fixed in bug 1370866][sec-survey] [post-critsmash-triage][adv-main99+][adv-esr91.8+]

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a9857462_689878)• 3 years ago |

Blocks: [1763237](/show_bug.cgi?id=1763237 "NEW - [meta] Thread safety issues in NSS")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1745667#a22329174_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1745667&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [John Schanck [:jschanck]](/user_profile?user_id=689878)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


