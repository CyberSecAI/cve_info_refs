```
{
  "CVE-2022-1706": {
    "Metadata": {
      "Description": "The ignition configs are accessible from unprivileged containers in VMs running on VMware products. This issue is only relevant in user environments where the Ignition config contains secrets.",
      "References": [
        "https://access.redhat.com/security/cve/CVE-2022-1706"
      ]
    },
    "Vulnerability Details": {
      "Root Cause": "The vulnerability stems from the fact that Ignition configurations are stored in a way that is accessible to unprivileged containers within virtual machines running on VMware products. These configurations are stored as guestinfo properties or OVF metadata.",
      "Weaknesses": [
        "Insecure storage of sensitive data in a way that is accessible to unprivileged users/processes.",
        "Lack of access control for guestinfo properties and OVF metadata."
      ],
      "Impact": "An unprivileged container within a VMware VM could potentially access the Ignition configuration, which may contain sensitive information, such as disk encryption keys, or other secrets meant for system initialization or configuration.",
       "Attack Vectors": [
        "Exploitation can occur from within a virtual machine running on VMware.",
        "Accessing the Ignition config via guestinfo properties or OVF metadata."
      ],
      "Required Capabilities": [
        "Attacker must have access to an unprivileged container within the affected VM.",
          "Attacker needs to be able to access and read guestinfo properties or OVF metadata using standard tools/libraries within the virtual machine."
      ]
    },
     "Additional Information": {
      "Mitigation": "The vulnerability is mitigated by an update to the `ignition` package. The update includes the `ignition-rmcfg` binary and service which deletes the Ignition config from the hypervisor on first boot in VirtualBox and VMware. This service can be masked in the configuration to prevent deletion.",
       "Affected Products": [
          "Red Hat Enterprise Linux for x86_64 9 x86_64",
          "Red Hat Enterprise Linux for x86_64 - Extended Update Support 9.4 x86_64",
          "Red Hat Enterprise Linux for x86_64 - Extended Update Support 9.2 x86_64",
          "Red Hat Enterprise Linux Server - AUS 9.4 x86_64",
          "Red Hat Enterprise Linux Server - AUS 9.2 x86_64",
          "Red Hat Enterprise Linux for IBM z Systems 9 s390x",
          "Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 9.4 s390x",
          "Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 9.2 s390x",
          "Red Hat Enterprise Linux for Power, little endian 9 ppc64le",
          "Red Hat Enterprise Linux for Power, little endian - Extended Update Support 9.4 ppc64le",
          "Red Hat Enterprise Linux for Power, little endian - Extended Update Support 9.2 ppc64le",
          "Red Hat Enterprise Linux for ARM 64 9 aarch64",
          "Red Hat Enterprise Linux for ARM 64 - Extended Update Support 9.4 aarch64",
          "Red Hat Enterprise Linux for ARM 64 - Extended Update Support 9.2 aarch64",
          "Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 9.4 ppc64le",
          "Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 9.2 ppc64le",
          "Red Hat Enterprise Linux for x86_64 - Update Services for SAP Solutions 9.4 x86_64",
          "Red Hat Enterprise Linux for x86_64 - Update Services for SAP Solutions 9.2 x86_64",
          "Red Hat Enterprise Linux for ARM 64 - 4 years of updates 9.4 aarch64",
          "Red Hat Enterprise Linux for ARM 64 - 4 years of updates 9.2 aarch64",
           "Red Hat Enterprise Linux for IBM z Systems - 4 years of updates 9.4 s390x",
          "Red Hat Enterprise Linux for IBM z Systems - 4 years of updates 9.2 s390x",
           "Red Hat OpenShift Container Platform 4.11",
            "Red Hat OpenShift Container Platform 4.11 for RHEL 8 x86_64",
           "Red Hat OpenShift Container Platform for Power 4.11 for RHEL 8 ppc64le",
           "Red Hat OpenShift Container Platform for IBM Z and LinuxONE 4.11 for RHEL 8 s390x",
            "Red Hat OpenShift Container Platform for ARM 64 4.11 aarch64"
        ],
       "Fix Information": {
          "Fixed Versions": [
             "ignition-2.14.0",
             "ignition-2.13.0-2.el9",
            "runc 1.1.2"
          ],
           "Errata": [
              "RHSA-2022:8126",
               "RHSA-2022:5068"
            ]
         },
        "notes":"The security concern is due to the accessible nature of Ignition config when utilizing VMware for VM Storage. Ignition configs may contain sensitive information that should not be accessed by workloads running on the system. The fix involves introducing an ignition-rmcfg binary and related systemd service that will remove Ignition configuration data from the hypervisor. Additionally, the use of ssh-key-dir is enabled for RHEL 9 and other derived systems."
     }
  }
}
```