=== Content from www.wordfence.com_190b87de_20250114_212727.html ===


![](https://www.wordfence.com/wp-content/uploads/2022/04/illustration-abstract-syringe-injection-needle-futuristic-innovation-picture-id1286232573.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

April 27, 2022

# PHP Object Injection Vulnerability in Booking Calendar Plugin

On April 18, 2022, the Wordfence Threat Intelligence team initiated the responsible disclosure process for an Object Injection vulnerability in the Booking Calendar plugin for WordPress, which has over 60,000 installations.

We received a response the same day and sent over our full disclosure early the next day, on April 19, 2022. A patched version of the plugin, 9.1.1, was released on April 21, 2022.

We released a firewall rule to protect [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) customers on April 18, 2022. Sites still running the free version of Wordfence will receive the same protection on May 18, 2022. We recommend that all Wordfence users update to the patched version, 9.1.1, as soon as possible as this will entirely eliminate the vulnerability.

---

**Description:** Insecure Deserialization/PHP Object Injection

**Affected Plugin:** [Booking Calendar](https://wordpress.org/plugins/booking/)

**Plugin Slug:** booking

**Plugin Developer:** wpdevelop, oplugins

**Affected Versions:** <= 9.1

**CVE ID:** [CVE-2022-1463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1463)

**CVSS Score**: 8.1(High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s**: Ramuel Gall

**Fully Patched Version**: 9.1.1

The Booking Calendar plugin allows site owners to add a booking system to their site, which includes the ability to publish a flexible timeline showing existing bookings and openings using a shortcode, `[bookingflextimeline]`.

The flexible timeline includes the ability to configure viewing preferences and options when viewing the published timeline. Some of these options were passed in PHP’s serialized data format, and unserialized by the `define_request_view_params_from_params` function in `core/timeline/v2/wpbc-class-timeline_v2.php`.

An attacker could control the serialized data via several methods:

1. If a timeline was published, an unauthenticated attacker could obtain the nonce required to send an AJAX request with the action set to `WPBC_FLEXTIMELINE_NAV` and a `timeline_obj[options]` parameter set to a serialized PHP object.
2. Any authenticated attacker could use the built-in `parse-media-shortcode` AJAX action to execute the `[bookingflextimeline]` shortcode, adding an `options` attribute in the shortcode set to a serialized PHP object. This would work even on sites without a published timeline.
3. An attacker with contributor-level privileges or above could also embed the `[bookingflextimeline]` shortcode containing a malicious `options` attribute into a post and execute it by previewing it, or obtain the `WPBC_FLEXTIMELINE_NAV`  nonce by previewing the `[bookingflextimeline]` shortcode and then using method #1.

Any time an attacker can control data that is unserialized by PHP, they can inject a PHP object with properties of their choice. If a “POP Chain” is also present, it can allow an attacker to execute arbitrary code, delete files, or otherwise destroy or gain control of a vulnerable website. Fortunately, no POP chain was present in the Booking plugin, so an attacker would require some luck as well as additional research in order to exploit this vulnerability. Nonetheless, POP chains appear in a number of popular software libraries, so many sites could still be exploited if another plugin using one of these libraries is installed.

Despite the lack of a POP chain and the complexity involved in exploitation, the potential consequences of a successful attack are so severe that object injection vulnerabilities still warrant a “High” CVSS score. [We’ve written about Object Injection vulnerabilities in the past](https://www.wordfence.com/blog/2020/08/newsletter-plugin-vulnerabilities-affect-over-300000-sites/#how-does-php-object-injection-work) if you’d like to find out more about how they work.

## Timeline

**April 18, 2022** – We release a firewall rule to protect Wordfence Premium, Care, and Response customers. We initiate the disclosure process. The plugin developer verifies the contact method.

**April 19, 2022** – We send the full disclosure to the plugin developer.

**April 21, 2022** – A patched version of the Booking Calendar plugin, 9.1.1, is released.

**May 18, 2022** – The firewall rule becomes available to free Wordfence users.

## Conclusion

In today’s post, we covered an Object Injection vulnerability in the Booking Calendar plugin. [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) customers are fully protected from this vulnerability. Sites running the free version of Wordfence will receive the same protection on May 18, 2022, but have the option of updating the Booking calendar plugin to the patched version 9.1.1 to eliminate the risk immediately.

If you believe your site has been compromised as a result of this vulnerability or any other vulnerability, we offer Incident Response services via [Wordfence Care](https://www.wordfence.com/products/wordfence-care/). If you need your site cleaned immediately, [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) offers the same service with 24/7/365 availability and a 1-hour response time. Both these products include hands-on support in case you need further assistance.

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Fphp-object-injection-in-booking-calendar-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Fphp-object-injection-in-booking-calendar-plugin%2F&text=PHP%20Object%20Injection%20Vulnerability%20in%20Booking%20Calendar%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F04%2Fphp-object-injection-in-booking-calendar-plugin%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


