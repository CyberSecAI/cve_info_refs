- **Root cause of vulnerability:** The `define_request_view_params_from_params` function in `core/timeline/v2/wpbc-class-timeline_v2.php` unserializes data received from user input, specifically options for the `[bookingflextimeline]` shortcode.
- **Weaknesses/vulnerabilities present:** Insecure deserialization/PHP Object Injection. The plugin unserializes user-controlled data without proper sanitization.
- **Impact of exploitation:** An attacker can inject a PHP object with properties of their choice. While there was no usable POP chain in the plugin itself, the presence of a POP chain in another installed plugin could allow an attacker to execute arbitrary code, delete files, or gain control of the vulnerable website.
- **Attack vectors:**
    1. Unauthenticated attackers could obtain a nonce and send an AJAX request with a serialized PHP object in the `timeline_obj[options]` parameter.
    2. Authenticated attackers could use the `parse-media-shortcode` AJAX action with a serialized PHP object in the `options` attribute of the `[bookingflextimeline]` shortcode.
    3. An attacker with contributor-level privileges or above could embed the malicious shortcode into a post and execute it by previewing it, or obtain the nonce required for attack vector #1.
- **Required attacker capabilities/position:**
    - Unauthenticated attacker can exploit the vulnerability if a timeline was published via AJAX request with the right nonce.
    - Authenticated attacker can exploit the vulnerability by using the `parse-media-shortcode` AJAX action even without a published timeline.
    - Contributor-level or above attacker can embed a shortcode and exploit the vulnerability by previewing it.