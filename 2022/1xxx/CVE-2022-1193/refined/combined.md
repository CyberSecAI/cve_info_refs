=== Content from gitlab.com_ebc892d4_20250115_091505.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Last commit message, description & sha1 hash of a private repo in a private group is leaked to guest users through merge request

**[HackerOne report #1465994](https://hackerone.com/reports/1465994)** by `albatraoz` on 2022-01-31, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Commit related details like commit message, description, sha1, etc are leaked to demoted guest users who should not have access to the repository of a private project according to the [permission model](https://docs.gitlab.com/ee/user/permissions.html#project-members-permissions). This information is leaked through a fork of the project created by the user(reporter/developer) before being demoted to guest. Once being demoted to guest, the user is able to sneak all the latest commits to the parent branch.

##### Steps to reproduce

1. Create a private project in a group as user A.
2. Add User B as a reporter to this project.
3. As User B create a fork of the project on you personal namespace.
4. As User A demote User B to guest from the group settings.
5. As User B visit the forked repo & go to the create new merge request. In the target branch you will see the parent branch is selected & the commit message is being leaked.
6. As User A add a new commit message to the parent branch.
7. As User B refresh the page opened in step 5 & you will see the latest commit added by User A in step 6.

##### POC

Attaching a video as POC for easier reproduction of the issue

[commit\_leak.mp4](https://user-content.gitlab-static.net/7956223f63c1473c3846aca51366b317a1c60e04/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33373962306136612d316365622d346566632d393536392d3565366532363134396562322f636f6d6d69745f6c65616b2e6d7034 "Download 'commit_leak.mp4'")

#### Impact

An attacker would be able to snoop into commit messages on the default branch even after being demoted to guest user. These commit messages or descriptions may include confidential information to the repo like unreleased features/ vulnerability information, etc

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [commit\_leak.mp4](https://h1.sec.gitlab.net/a/379b0a6a-1ceb-4efc-9569-5e6e26149eb2/commit_leak.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_f5b16f44_20250115_091504.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-1193.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-1193.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-1193.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-1193.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  May 12, 2022

  [6ec49f36](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  繚
  6ec49f36

  [ GitLab Bot ](/gitlab-bot) authored May 12, 2022

  6ec49f36

  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  [ GitLab Bot ](/gitlab-bot) authored May 12, 2022

Loading


