- **Root cause of vulnerability:** The plugin does not properly validate and escape some of its settings. Specifically, the "Watermark font size" and "Watermark opacity" fields, intended to be numeric, are not properly sanitized, allowing arbitrary text input when their input type is changed to "text" via browser inspector. Other settings which should be number are also affected.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS).
- **Impact of exploitation:** An attacker with high privileges (e.g., admin) can inject malicious JavaScript code that will be executed in the context of other users' browsers when they access the affected settings pages, potentially leading to session hijacking, defacement, or other malicious activities.
- **Attack vectors:** The attacker needs to be logged in as a high-privilege user (such as admin) and have access to the Photo Gallery plugin settings. They then modify the input type of vulnerable fields in the browser and inject the malicious payload.
- **Required attacker capabilities/position:** The attacker must have administrative access or a similar high-privilege user role within the WordPress system to modify the plugin settings. They also need to have the ability to use a web browser's inspector tool to change the input field types.