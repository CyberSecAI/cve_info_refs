- **Root cause of vulnerability**: The Popup Maker plugin fails to properly sanitize and escape user-controlled input within its popup settings. Specifically, the "Cookie Time" field under the "Triggers" section allows for the injection of arbitrary JavaScript code.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS). The plugin does not sanitize user input, allowing malicious scripts to be permanently stored in the database and executed in the browsers of other users who access the affected pages.
- **Impact of exploitation**: An attacker could inject malicious JavaScript code that can be executed in the browsers of administrators and other users who edit the popup. This could lead to actions such as stealing session cookies, redirecting users to malicious sites, or performing actions within the application with the privileges of the victim.
- **Attack vectors**: The vulnerability is triggered when a high privilege user, such as an administrator, creates or edits a popup and inserts malicious JavaScript code into the "Cookie Time" field under "Triggers", via the admin panel. This payload is then stored in the database. When the popup is edited again by any user, the stored XSS will be triggered.
- **Required attacker capabilities/position**: The attacker needs to have administrator-level or similarly high privileges to create or modify popups in the WordPress administration interface. The attacker needs to be able to access the Popup Maker plugin settings to insert the malicious payload.