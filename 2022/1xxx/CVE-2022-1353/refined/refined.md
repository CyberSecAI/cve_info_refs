```
{
  "vulnerability": {
    "root_cause": "The `compose_sadb_supported` function allocates a sk_buff but doesn't zero it out. It then initializes the `sadb_supported_len` and `sadb_supported_exttype` fields but not `sadb_supported_reserved`. This results in uninitialized kernel memory being exposed when the structure is sent via netlink.",
    "weaknesses": [
      "Information leak due to uninitialized memory"
    ],
    "impact": "A local unprivileged user can leak kernel memory, potentially leading to a system crash or disclosure of internal kernel information.",
    "attack_vectors": [
      "Local exploitation by sending a specific netlink message to trigger the `pfkey_register` function."
    ],
    "required_capabilities": [
      "Ability to send netlink messages"
    ],
    "details": "The vulnerability lies in `net/key/af_key.c` within the `pfkey_register` function. When registering an IPsec daemon, the kernel uses the `compose_sadb_supported` function to prepare a message. This function allocates memory for the message but does not initialize all fields. Specifically, when the `auth_len` is greater than zero, the function treats the allocated memory as `struct sadb_supported`. It initializes some fields but leaves `sadb_supported_reserved` uninitialized, which may contain sensitive kernel memory. When this structure is sent through netlink, the uninitialized memory is exposed to the user."
  }
}
```