=== Content from bugzilla.mozilla.org_1a8c566b_20250114_203305.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1770137)
* [XML](/show_bug.cgi?ctype=xml&id=1770137)

Closed
[Bug 1770137](/show_bug.cgi?id=1770137)
(CVE-2022-1802)

Opened 3 years ago
Closed 3 years ago

# Spot fix for pwn2own-2022 sandbox escape

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Spot fix for pwn2own-2022 sandbox escape

## Categories

### (Toolkit Graveyard :: Notifications and Alerts, defect)

[Product:](/describecomponents.cgi?product=Toolkit%20Graveyard)

Toolkit Graveyard
▾

Toolkit Graveyard
Old, retired Toolkit components
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit%20Graveyard&component=Notifications%20and%20Alerts#Notifications%20and%20Alerts)

Notifications and Alerts
▾

Toolkit Graveyard :: Notifications and Alerts
Popup/doorhanger notifications, notification bars, alerts, and prompts.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit%20Graveyard&component=Notifications%20and%20Alerts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit%20Graveyard&component=Notifications%20and%20Alerts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit%20Graveyard&component=Notifications%20and%20Alerts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (firefox-esr91100+ verified, firefox100+ verified, firefox101+ verified, firefox102+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

102 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified) |
| firefox102 | [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | 100+ | verified |
| firefox100 | + | verified |
| firefox101 | + | verified |
| firefox102 | + | verified |

## People

### (Reporter: peterv, Assigned: peterv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

45 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1770227](/show_bug.cgi?id=1770227 "NEW - NotificationDB.sys.mjs does not perform origin checks on received messages"), [1770783](/show_bug.cgi?id=1770783 "RESOLVED FIXED - BrowserElementParent indexes into an Object with data from the child process"), [1770848](/show_bug.cgi?id=1770848 "RESOLVED FIXED - ContentPrefService2._observers indexed by a content-controlled value"), [1771026](/show_bug.cgi?id=1771026 "VERIFIED FIXED - content process value used to index to an object in addTags()"), [CVE-2024-29944](/show_bug.cgi?id=1886852 "RESOLVED FIXED - [pwn2own-2024] sandbox escape using non-SHIP session restore")

[1770154](/show_bug.cgi?id=1770154 "RESOLVED DUPLICATE - Reconcile old/ and new/ NotificationDB.sys.mjs")

## Details

### (Keywords: csectype-sandbox-escape, sec-critical)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-1802

[Keywords:](/describekeywords.cgi)

[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!](/attachment.cgi?id=9277284)  [3 years ago](#c1)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c8 "3 years ago")  diannaS : [approval-mozilla-release+](#c8 "3 years ago")  diannaS : [approval-mozilla-esr91+](#c8 "3 years ago")  tjr : [sec-approval+](#c5 "3 years ago") | [Details](/attachment.cgi?id=9277284&action=edit) | [Review](/attachment.cgi?id=9277284) |
| --- | --- | --- |
| [Bug 1770137 - Part 2, r=gijs](/attachment.cgi?id=9277369)  [3 years ago](#c13)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c16 "3 years ago")  diannaS : [approval-mozilla-release+](#c16 "3 years ago")  diannaS : [approval-mozilla-esr91+](#c16 "3 years ago") | [Details](/attachment.cgi?id=9277369&action=edit) | [Review](/attachment.cgi?id=9277369) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1770137#c0)• 3 years ago |
|  | |

+++ This bug was initially created as a clone of [Bug #1770057](/show_bug.cgi?id=1770057 "ASSIGNED") +++

This bug is for the sandbox escape portion of the pwn2own-2022, described in section 2.2 of the PDF.

I think the basic, specific issue is that on [this](https://searchfox.org/mozilla-central/rev/4719c903af605c2caeda3bb1ce4edb9ca58bf68e/dom/notification/old/NotificationDB.jsm#361) line of code we use an untrusted string from the content process to index into an Object:

`this.notifications[origin][notification.id] = notification;`

If `origin` is the string `"__proto__"`, then we're now polluting the prototype of Object used by all JSMs, which can be taken advantage of later.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1770137#c1)• 3 years ago |
|  | |

Attached file
[Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!](attachment.cgi?id=9277284)
— [Details](attachment.cgi?id=9277284&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a291_600971)• 3 years ago |

Assignee: nobody → petervStatus: NEW → ASSIGNED

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1770137#c2)• 3 years ago |
|  | |

For posterity: We've decided that a spot fix is the saner approach given the reduced time we have and the amount of code it would have to touch otherwise. Fix for the underlying issue of prototype pollutions in JS IPC code will happen in through [Bug #1770057](/show_bug.cgi?id=1770057 "ASSIGNED"), but not immediately.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1770137#c3)• 3 years ago |
|  | |

Comment on [attachment 9277284](/attachment.cgi?id=9277284 "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") [[details]](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Make notification code use Object.create. r?gijs!,freddyb!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: I think it shouldn't be too hard for people who know about prototype pollution to figure out how to exploit this.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Patch should just apply.
* **How likely is this patch to cause regressions; how much testing does it need?**: This shouldn't be very risky.

I'll note here that nightly uses a different implementation, so the patch would be a noop there :-/.

* **Is Android affected?**: Yes
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: sec-approval?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a3585_406194)• 3 years ago |

See Also: → [1770154](/show_bug.cgi?id=1770154 "RESOLVED DUPLICATE - Reconcile old/ and new/ NotificationDB.sys.mjs")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a4240_406194)• 3 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a4464_690067)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)
[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1770137#c4)• 3 years ago |
|  | |

This code is disabled in Nightly (see [bug 1770154](/show_bug.cgi?id=1770154 "RESOLVED DUPLICATE - Reconcile old/ and new/ NotificationDB.sys.mjs")), so I'm marking 102 as disabled. We still want to land the patch there, but that should be kept in mind for testing and verification purposes.

[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=affected) → [disabled](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=disabled)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1770137#c5)• 3 years ago |
|  | |

Comment on [attachment 9277284](/attachment.cgi?id=9277284 "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") [[details]](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Make notification code use Object.create. r?gijs!,freddyb!

Approved to move forward

[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1770137#c6)• 3 years ago |
|  | |

Make notification code use Object.create. r=Gijs,freddyb

<https://hg.mozilla.org/integration/autoland/rev/60f027a372e5baff03aa1463aeed366e2a26d468>

<https://hg.mozilla.org/mozilla-central/rev/60f027a372e5>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[disabled](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=disabled) → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 102 Branch

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1770137#c7)• 3 years ago |
|  | |

Comment on [attachment 9277284](/attachment.cgi?id=9277284 "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") [[details]](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Make notification code use Object.create. r?gijs!,freddyb!

### Beta/Release Uplift Approval Request

* **User impact if declined**: sandbox escape
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: IIRC we don't have a reliable QE test strategy for this change yet. :mccr8 is working on building a snippet which we'll be able to paste in the browser content toolbox to test this fix (though it will only work on Beta and Release)
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This shouldn't be very risky. Nightly uses a different version of the code.
* **String changes made/needed**: None
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: sandbox escape
* **Fix Landed on Version**: 102
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This shouldn't be very risky. Nightly uses a different version of the code.
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-release?
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-esr91?
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-beta?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a27026_534482)• 3 years ago |

Flags: qe-verify+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1770137#c8)• 3 years ago |
|  | |

Comment on [attachment 9277284](/attachment.cgi?id=9277284 "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") [[details]](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Make notification code use Object.create. r?gijs!,freddyb!

Approved for 100.0.2

Approved for 101.0b9

Approved for 91.9.1esr

[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-release?
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-release+
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-esr91?
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-esr91+
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-beta?
[Attachment #9277284](/attachment.cgi?id=9277284&action=edit "Bug 1770137 - Make notification code use Object.create. r?gijs!,freddyb!") -
Flags: approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1770137#c9)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/ab6ade69feee> (91.9.1)

<https://hg.mozilla.org/releases/mozilla-esr91/rev/f26740996746>

<https://hg.mozilla.org/releases/mozilla-beta/rev/97f2fc7c28b7>

<https://hg.mozilla.org/releases/mozilla-release/rev/d6d9df73d017>

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1770137#c10)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1770137&comment_id=15907039 "6 revisions") |
|  | |

Steps to reproduce:

You want to start with a fresh profile. (The important factor is that we need to make sure there are no existing saved notifications, which will show up as notificationstore.json in the profile directory. You can just delete that file to get back to the "fresh" state when the browser is not running.)

1. First, you have to enable the browser toolbox.

a) Hamburger menu --> More tools --> Developer tools

b) [Click on the ... next to the x on the developer tools bar](https://firefox-source-docs.mozilla.org/devtools-user/settings/index.html), then click on settings. [Under "Advanced settings" in the lower right](https://firefox-source-docs.mozilla.org/devtools-user/browser_toolbox/index.html), check "Enable browser chrome and addon-on debugging toolboxes" and "Enable remote debugging".

2. Now, load the browser toolbox. Hamburger menu --> More tools --> Browser toolbox.
3. In the window that pops up, at the bottom there is an area for console input starting with ">>". Click on that to get a cursor, then paste in the following string and hit enter:

`Services.cpmm.sendAsyncMessage("Notification:Save", {origin:"__proto__", notification: { id: "someKey" }}); setTimeout(() => { alert("This should be undefined: " + Cu.getGlobalForObject(Services).Object.prototype.someKey); }, 100);`

This will pop up an alert in main browser window. It will say "This should be undefined" followed by a JS value. If it says "undefined", then the exploit is fixed. If it says "[Object]", it is not.

4. Now, exit the browser, start the browser again, then repeat steps 2 and 3. The pop up should again say undefined. (This tests a separate code path when we restore the notifications from disk, and was unfixed in the initial patch.)

Also note that in my experiments the browser would hang and crash on exit in the cases where the test failed, probably because the Object prototype got messed up, but there's no need to worry about that.

(Nika helped me put these steps together.)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a31924_578488)• 3 years ago |

Alias: CVE-2022-1802

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1770137#c11)• 3 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Additional testing notes: It looks like this code goes through a slightly different code path in a fresh profile and in an existing profile, which we found out because the test case was failing because I tried it in a old profile, so it would be good to exit the browser and repeat the steps in the same profile a second time, if it passes the first time. (Nika is working on a fix for that.)

Also note that in my experiments the browser would hang and crash on exit in the cases where the test failed, probably because the Object prototype got messed up, but there's no need to worry about that.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1770137#c12)• 3 years ago |
|  | |

Per the Slack channel, we need a follow-up patch for this bug.

Status: RESOLVED → REOPENED
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Resolution: FIXED → ---

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1770137#c13)• 3 years ago |
|  | |

Attached file
[Bug 1770137 - Part 2, r=gijs](attachment.cgi?id=9277369)
— [Details](attachment.cgi?id=9277369&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a34549_600971)• 3 years ago |

[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Attachment description: Bug 1770137 - Part , r=gijs → Bug 1770137 - Part 2, r=gijs

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a34992_1689)• 3 years ago |

See Also: → [1770227](/show_bug.cgi?id=1770227 "NEW - NotificationDB.sys.mjs does not perform origin checks on received messages")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1770137#c14)• 3 years ago |
|  | |

For the purposes of this bug, a "fresh state" in a profile seems to mean that notificationstore.json doesn't exist in the profile directory, so you can delete that file to get back to a fresh state. With only the initial patch, you get something like: delete notificationstore.json, start browser, run test. Test passes. (Test causes a new notificationstore.json to be created...) Restart browser, run test. Now the test fails.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1770137#c15)• 3 years ago |
|  | |

Comment on [attachment 9277369](/attachment.cgi?id=9277369 "Bug 1770137 - Part 2, r=gijs") [[details]](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Part 2, r=gijs

### Beta/Release Uplift Approval Request

* **User impact if declined**: sandbox escape for existing profiles
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: see [comment 10](/show_bug.cgi?id=1770137#c10 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape"), try on both new and existing profiles.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: quick fix to remaining hole from previous spot-fix.
* **String changes made/needed**: None
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: sandbox escape for existing profiles
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: quick fix to remaining hole from previous spot-fix.
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-release?
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-esr91?
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-beta?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1770137#c16)• 3 years ago |
|  | |

Comment on [attachment 9277369](/attachment.cgi?id=9277369 "Bug 1770137 - Part 2, r=gijs") [[details]](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs")

[Bug 1770137](/show_bug.cgi?id=1770137 "VERIFIED FIXED - Spot fix for pwn2own-2022 sandbox escape") - Part 2, r=gijs

Approved for 100.0.2

Approved for 101.0b9

Approved for 91.9.1esr

[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-release?
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-release+
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-esr91?
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-esr91+
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-beta?
[Attachment #9277369](/attachment.cgi?id=9277369&action=edit "Bug 1770137 - Part 2, r=gijs") -
Flags: approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1770137#c17)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/262b3b86a564> (91.9.1)

<https://hg.mozilla.org/releases/mozilla-esr91/rev/842ab8d9394a>

<https://hg.mozilla.org/releases/mozilla-beta/rev/49f60cc53ea3>

<https://hg.mozilla.org/releases/mozilla-release/rev/7ce9f0fe6cb4>

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1770137#c18)• 3 years ago |
|  | |

Part 2, r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/27b6009eb1f7cef2177e3e42aed6823fd510a54a>

<https://hg.mozilla.org/mozilla-central/rev/27b6009eb1f7>

Status: REOPENED → RESOLVEDClosed: 3 years ago → 3 years ago
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1770137#c19)• 3 years ago |
|  | |

Verified as fixed on macOS 11.6, Windows 10 x64 and on Ubuntu 20.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Delia Pop (Android QA)](/user_profile?user_id=697911) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1770137#c20)• 3 years ago |
|  | |

Verified as fixed on Mobile Fenix/Focus RC 100.3.0 and Beta 101.0.0 Beta 6.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a357293_406194)• 3 years ago |

See Also: → [1770783](/show_bug.cgi?id=1770783 "RESOLVED FIXED - BrowserElementParent indexes into an Object with data from the child process")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a357722_1689)• 3 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a381593_406194)• 3 years ago |

See Also: → [1770848](/show_bug.cgi?id=1770848 "RESOLVED FIXED - ContentPrefService2._observers indexed by a content-controlled value")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a466122_406194)• 3 years ago |

See Also: → [1771026](/show_bug.cgi?id=1771026 "VERIFIED FIXED - content process value used to index to an object in addTags()")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a20969064_1689)• 2 years ago |

Group: core-security-release

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a35691490_546015)• 2 years ago |

Product: Toolkit → Toolkit Graveyard

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770137#a58096354_406194)• 10 months ago |

See Also: → [CVE-2024-29944](/show_bug.cgi?id=1886852 "RESOLVED FIXED - [pwn2own-2024] sandbox escape using non-SHIP session restore")
You need to [log in](/show_bug.cgi?id=1770137&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8d28999c_20250114_203306.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-19

## Security Vulnerabilities fixed in Firefox 100.0.2, Firefox for Android 100.3.0, Firefox ESR 91.9.1, Thunderbird 91.9.1

Announced
May 20, 2022
Impact
critical
Products
Firefox, Firefox ESR, Firefox for Android, Thunderbird
Fixed in

* Firefox 100.0.2
* Firefox ESR 91.9.1
* Firefox for Android 100.3
* Thunderbird 91.9.1

#### [#CVE-2022-1802: Prototype pollution in Top-Level Await implementation](#CVE-2022-1802)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
critical
##### Description

If an attacker was able to corrupt the methods of an Array object in JavaScript via prototype pollution, they could have achieved execution of attacker-controlled JavaScript code in a privileged context.

##### References

* [Bug 1770137](https://bugzilla.mozilla.org/show_bug.cgi?id=1770137)

#### [#CVE-2022-1529: Untrusted input used in JavaScript object indexing, leading to prototype pollution](#CVE-2022-1529)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
critical
##### Description

An attacker could have sent a message to the parent process where the contents were used to double-index into a JavaScript object, leading to prototype pollution and ultimately attacker-controlled JavaScript executing in the privileged parent process.

##### References

* [Bug 1770048](https://bugzilla.mozilla.org/show_bug.cgi?id=1770048)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


