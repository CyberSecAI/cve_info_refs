=== Content from github.com_4fd32b3c_20250114_212040.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenemr%2Fopenemr%2Fcommit%2Fa2e918abcf15f9fc1f7cb4a1f2b09ff019021175)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenemr%2Fopenemr%2Fcommit%2Fa2e918abcf15f9fc1f7cb4a1f2b09ff019021175)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openemr%2Fopenemr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openemr](/openemr)
/
**[openemr](/openemr/openemr)**
Public

* [Notifications](/login?return_to=%2Fopenemr%2Fopenemr) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Fopenemr%2Fopenemr)
* [Star
   3.2k](/login?return_to=%2Fopenemr%2Fopenemr)

* [Code](/openemr/openemr)
* [Issues
  280](/openemr/openemr/issues)
* [Pull requests
  81](/openemr/openemr/pulls)
* [Actions](/openemr/openemr/actions)
* [Projects
  0](/openemr/openemr/projects)
* [Security](/openemr/openemr/security)
* [Insights](/openemr/openemr/pulse)

Additional navigation options

* [Code](/openemr/openemr)
* [Issues](/openemr/openemr/issues)
* [Pull requests](/openemr/openemr/pulls)
* [Actions](/openemr/openemr/actions)
* [Projects](/openemr/openemr/projects)
* [Security](/openemr/openemr/security)
* [Insights](/openemr/openemr/pulse)

## Commit

[Permalink](/openemr/openemr/commit/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

limit access to reports for front and back office ([#4893](https://github.com/openemr/openemr/pull/4893))

[Browse files](/openemr/openemr/tree/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175)
Browse the repository at this point in the history

```
* add acl report check to custom report

* remove report and notes access for accountants and front office on install

* revert change to administrators

* adjust install and upgrade

* reorder case in shiftAcl

* add alter acls to template

* review fixes, thanks Brady!

* more review fixes
```

* Loading branch information

[![@stephenwaite](https://avatars.githubusercontent.com/u/5618372?s=40&v=4)](/stephenwaite)

[stephenwaite](/openemr/openemr/commits?author=stephenwaite "View all commits by stephenwaite")
authored
Feb 14, 2022

1 parent
[ac97285](/openemr/openemr/commit/ac97285c2410d6d34730942d8e56f3f6b12009b0)

commit a2e918a

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**89 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* acl\_upgrade.php
  [acl\_upgrade.php](#diff-40f29eeb83aa65decf7f321a07e30e75d254a212429868e6ac07b8d52bf87627)
* interface/patient\_file/report

  + interface/patient\_file/report/custom\_report.php
    [custom\_report.php](#diff-b9822724c18302febb8a0a03fee41f46ac299a347e1ad8168b1382da4c5d841b)
* library/classes

  + library/classes/Installer.class.php
    [Installer.class.php](#diff-27eb3e7b9d3a5f9bcbb149650154bbce8da69817bc92990383083375b6599ba5)
* src

  + Common/Acl

    - src/Common/Acl/AclExtended.php
      [AclExtended.php](#diff-4cc362f512036194716a413224cf2695db35e37360066b0fee99e8ff0716e1d1)
  + Gacl

    - src/Gacl/GaclApi.php
      [GaclApi.php](#diff-f85259407e5e52987c05407ed7862293ac69ee26126c639ed75e75fb07ab0333)
* version.php
  [version.php](#diff-0dc418129946563e59bb69680a5ef0ded4329ed9e56e3d295c25e12ea726726b)

## There are no files selected for viewing

39 changes: 37 additions & 2 deletions

39
[acl\_upgrade.php](#diff-40f29eeb83aa65decf7f321a07e30e75d254a212429868e6ac07b8d52bf87627 "acl_upgrade.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/acl_upgrade.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -816,13 +816,48 @@ |
|  |  | $acl\_version = $upgrade\_acl; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\* This is a template for a new revision, when needed |
|  |  | // Upgrade for acl\_version 12 |
|  |  | $upgrade\_acl = 12; |
|  |  | if ($acl\_version < $upgrade\_acl) { |
|  |  | echo "<B>UPGRADING ACCESS CONTROLS TO VERSION " . $upgrade\_acl . ":</B></BR>"; |
|  |  |  |
|  |  | //Collect the ACL ID numbers. |
|  |  | echo "<B>Checking to ensure all the proper ACL(access control list) are present:</B></BR>"; |
|  |  | $accounting\_view = AclExtended::getAclIdNumber('Accounting', 'view'); |
|  |  | $frontoffice\_view = AclExtended::getAclIdNumber('Front Office', 'view'); |
|  |  | $frontoffice\_write = AclExtended::getAclIdNumber('Front Office', 'write'); |
|  |  |  |
|  |  | //Add new object Sections |
|  |  | echo "<BR/><B>Adding new object sections</B><BR/>"; |
|  |  |  |
|  |  | //Add new Objects |
|  |  | echo "<BR/><B>Adding new objects</B><BR/>"; |
|  |  |  |
|  |  | //Update already existing Objects |
|  |  | echo "<BR/><B>Upgrading objects</B><BR/>"; |
|  |  |  |
|  |  | //Add new ACLs here (will return the ACL ID of newly created or already existant ACL) |
|  |  | // (will also place in the appropriate group and CREATE a new group if needed) |
|  |  | echo "<BR/><B>Adding ACLs(Access Control Lists) and groups</B><BR/>"; |
|  |  |  |
|  |  | //Update the ACLs |
|  |  | echo "<BR/><B>Updating the ACLs(Access Control Lists)</B><BR/>"; |
|  |  | AclExtended::shiftAcl($accounting\_view, 'Accounting', 'patients', 'Patients', 'pat\_rep', 'Patient Report', 'view'); |
|  |  | AclExtended::shiftAcl($frontoffice\_view, 'Front Office', 'patients', 'Patients', 'pat\_rep', 'Patient Report', 'view'); |
|  |  | AclExtended::shiftAcl($frontoffice\_write, 'Front Office', 'patients', 'Patients', 'trans', 'Transactions (write,wsome optional)', 'write'); |
|  |  | AclExtended::shiftAcl($frontoffice\_write, 'Front Office', 'patients', 'Patients', 'notes', 'Patient Notes (write,wsome optional)', 'write'); |
|  |  |  |
|  |  |  |
|  |  | //DONE with upgrading to this version |
|  |  | $acl\_version = $upgrade\_acl; |
|  |  | } |
|  |  |  |
|  |  | /\* This is a template for a new revision, when needed |
|  |  | // Upgrade for acl\_version 13 |
|  |  | $upgrade\_acl = 13; |
|  |  | if ($acl\_version < $upgrade\_acl) { |
|  |  | echo "<B>UPGRADING ACCESS CONTROLS TO VERSION " . $upgrade\_acl . ":</B></BR>"; |
|  |  |  |
|  |  | //Collect the ACL ID numbers. |
|  |  | echo "<B>Checking to ensure all the proper ACL(access control list) are present:</B></BR>"; |
|  |  |  |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[interface/patient\_file/report/custom\_report.php](#diff-b9822724c18302febb8a0a03fee41f46ac299a347e1ad8168b1382da4c5d841b "interface/patient_file/report/custom_report.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/interface/patient_file/report/custom_report.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,10 @@ |
|  |  | use OpenEMR\MedicalDevice\MedicalDevice; |
|  |  | use OpenEMR\Services\FacilityService; |
|  |  |  |
|  |  | if (!AclMain::aclCheckCore('patients', 'pat\_rep')) { |
|  |  | die(xlt('Not authorized')); |
|  |  | } |
|  |  |  |
|  |  | $facilityService = new FacilityService(); |
|  |  |  |
|  |  | $staged\_docs = array(); |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[library/classes/Installer.class.php](#diff-27eb3e7b9d3a5f9bcbb149650154bbce8da69817bc92990383083375b6599ba5 "library/classes/Installer.class.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/library/classes/Installer.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -975,7 +975,7 @@ public function install\_gacl() |
|  |  | // |
|  |  | $gacl->add\_acl( |
|  |  | array( |
|  |  | 'patients' => array('alert','pat\_rep') |
|  |  | 'patients' => array('alert') |
|  |  | ), |
|  |  | null, |
|  |  | array($front), |
| Expand Down  Expand Up | | @@ -1017,7 +1017,7 @@ public function install\_gacl() |
|  |  | // xl('Things that front office can read and partly modify') |
|  |  | $gacl->add\_acl( |
|  |  | array( |
|  |  | 'patients' => array('appt', 'demo', 'trans', 'notes'), |
|  |  | 'patients' => array('appt', 'demo'), |
|  |  | 'groups' => array('gcalendar') |
|  |  | ), |
|  |  | null, |
| Expand All | | @@ -1035,7 +1035,7 @@ public function install\_gacl() |
|  |  | // |
|  |  | $gacl->add\_acl( |
|  |  | array( |
|  |  | 'patients' => array('alert','pat\_rep') |
|  |  | 'patients' => array('alert') |
|  |  | ), |
|  |  | null, |
|  |  | array($back), |
| Expand Down | |  |

37 changes: 37 additions & 0 deletions

37
[src/Common/Acl/AclExtended.php](#diff-4cc362f512036194716a413224cf2695db35e37360066b0fee99e8ff0716e1d1 "src/Common/Acl/AclExtended.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/src/Common/Acl/AclExtended.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1019,6 +1019,43 @@ public static function updateAcl($array\_acl\_id\_number, $group\_title, $section\_na |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Shift the ACL, opposite of updateAcl() |
|  |  | \* Tries to remove the object from a specific ACL if only one is found. |
|  |  | \* |
|  |  | \* @param array $array\_acl\_id\_number Array containing hopefully one element, which is an integer, and is identifier of acl to be updated. |
|  |  | \* @param string $group\_title Title of group. |
|  |  | \* @param string $object\_section\_name Identifier of section |
|  |  | \* @param string $object\_section\_title Title of section |
|  |  | \* @param string $object\_name Identifier of object |
|  |  | \* @param string $object\_title Title of object |
|  |  | \* @param string $acl\_return\_value What the acl returns (string), usually 'write', 'addonly', 'wsome' or 'view' |
|  |  | \*/ |
|  |  | public static function shiftAcl($array\_acl\_id\_number, $group\_title, $section\_name, $section\_title, $object\_name, $object\_title, $return\_value) |
|  |  | { |
|  |  | $gacl = self::collectGaclApiObject(); |
|  |  | $tmp\_array = $gacl->search\_acl($section\_name, $object\_name, false, false, $group\_title, false, false, false, $return\_value); |
|  |  | switch (count($tmp\_array)) { |
|  |  | case 0: |
|  |  | echo "The '$object\_title' object of the '$section\_title' section is not found in the '$group\_title' group '$return\_value' ACL.</BR>"; |
|  |  | break; |
|  |  | case 1: |
|  |  | $tmp\_boolean = @$gacl->shift\_acl($array\_acl\_id\_number[0], null, null, null, null, array($section\_name => array($object\_name))); |
|  |  | if ($tmp\_boolean) { |
|  |  | echo "Successfully removed the '$object\_title' object of the '$section\_title' section into the '$group\_title' group '$return\_value' ACL.</BR>"; |
|  |  | } else { |
|  |  | echo "<B>ERROR</B>,unable to remove the '$object\_title' object of the '$section\_title' section into the '$group\_title' group '$return\_value' ACL.</BR>"; |
|  |  | } |
|  |  | break; |
|  |  | default: |
|  |  | echo "<B>ERROR</B>, Multiple '$group\_title' group '$return\_value' ACLs with the '$object\_title' object of the '$section\_title' section are present.</BR>"; |
|  |  | break; |
|  |  | } |
|  |  |  |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Update the provided array of ACOs that the designated group has permission for. |
|  |  | \* This is an array keyed on ACO section ID with values that are arrays keyed on ACO ID |
| Expand Down | |  |

12 changes: 7 additions & 5 deletions

12
[src/Gacl/GaclApi.php](#diff-f85259407e5e52987c05407ed7862293ac69ee26126c639ed75e75fb07ab0333 "src/Gacl/GaclApi.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/src/Gacl/GaclApi.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -404,8 +404,9 @@ function append\_acl($acl\_id, $aro\_array=NULL, $aro\_group\_ids=NULL, $axo\_array=NU |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | //Grab ACL data. |
|  |  | $acl\_array = &$this->get\_acl($acl\_id); |
|  |  | //Grab ACL data. |
|  |  | $get\_acl = $this->get\_acl($acl\_id); |
|  |  | $acl\_array = &$get\_acl; |
|  |  |  |
|  |  | //Append each object type seperately. |
|  |  | if (is\_array($aro\_array) AND count($aro\_array) > 0) { |
| Expand Down  Expand Up | | @@ -524,8 +525,9 @@ function shift\_acl($acl\_id, $aro\_array=NULL, $aro\_group\_ids=NULL, $axo\_array=NUL |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | //Grab ACL data. |
|  |  | $acl\_array = &$this->get\_acl($acl\_id); |
|  |  | //Grab ACL data. |
|  |  | $get\_acl = $this->get\_acl($acl\_id); |
|  |  | $acl\_array = &$get\_acl; |
|  |  |  |
|  |  | //showarray($acl\_array); |
|  |  | //Remove each object type seperately. |
| Expand Down  Expand Up | | @@ -612,7 +614,7 @@ function shift\_acl($acl\_id, $aro\_array=NULL, $aro\_group\_ids=NULL, $axo\_array=NUL |
|  |  | foreach ($aco\_array as $aco\_section\_value => $aco\_value\_array) { |
|  |  | foreach ($aco\_value\_array as $aco\_value) { |
|  |  | $this->debug\_text("shift\_acl(): ACO Section Value: $aco\_section\_value ACO VALUE: $aco\_value"); |
|  |  | $aco\_key = array\_search($aco\_value, $acl\_array['aco'][$aco\_section\_value]); |
|  |  | $aco\_key = array\_search($aco\_value, ($acl\_array['aco'][$aco\_section\_value] ?? [])); |
|  |  |  |
|  |  | if ($aco\_key !== FALSE) { |
|  |  | $this->debug\_text("shift\_acl(): Removing ACO. ($aco\_key)"); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[version.php](#diff-0dc418129946563e59bb69680a5ef0ded4329ed9e56e3d295c25e12ea726726b "version.php")

Show comments

[View file](/openemr/openemr/blob/a2e918abcf15f9fc1f7cb4a1f2b09ff019021175/version.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,7 +36,7 @@ |
|  |  | // controls is (subsequently the acl\_upgrade.php script then is used to |
|  |  | // upgrade and track this value) |
|  |  | // |
|  |  | $v\_acl = 11; |
|  |  | $v\_acl = 12; |
|  |  |  |
|  |  | // Version for JavaScript and stylesheet includes. Increment whenever a .js or .css file changes. |
|  |  | // Also whenever you change a .js or .css file, make sure that all URLs referencing it |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a2e918a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenemr%2Fopenemr%2Fcommit%2Fa2e918abcf15f9fc1f7cb4a1f2b09ff019021175) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from huntr.dev_819ee513_20250114_212042.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)
