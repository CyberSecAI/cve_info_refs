```
{
  "CVE-2022-1122": [
    {
      "Root cause of vulnerability": "The `opj2_decompress` program in openjpeg2 fails to properly handle an input directory with a large number of files. Specifically, when it fails to allocate memory to store filenames, it calls `free()` on an uninitialized pointer.",
      "Weaknesses/vulnerabilities present": "Use of uninitialized pointer which leads to a segmentation fault.",
      "Impact of exploitation": "A segmentation fault and denial of service.",
      "Attack vectors": "By providing an input directory with a large number of files to the `opj2_decompress` program.",
       "Required attacker capabilities/position": "The attacker needs to be able to execute the `opj2_decompress` program with a crafted input directory. "
    },
        {
      "Root cause of vulnerability": "The `opj2_decompress` program in OpenJPEG v2.4.0 has a flaw in how it handles an input directory with a large number of files. When memory allocation fails for storing filenames, it attempts to free an uninitialized pointer.",
      "Weaknesses/vulnerabilities present": "Uninitialized pointer leading to use-after-free",
      "Impact of exploitation": "Segmentation fault leading to a denial of service.",
       "Attack vectors": "Providing the `opj2_decompress` with a directory containing a large number of files through the `-ImgDir` command-line option.",
      "Required attacker capabilities/position": "Attacker needs to provide a directory with large number of files as input to the `opj2_decompress` program"
    }
  ]
}
```