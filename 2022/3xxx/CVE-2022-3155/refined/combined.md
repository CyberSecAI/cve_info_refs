=== Content from www.mozilla.org_f0a3d189_20250115_093614.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-42

## Security Vulnerabilities fixed in Thunderbird 102.3

Announced
September 20, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Thunderbird on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-3155: Attachment files saved to disk on macOS could be executed without warning](#CVE-2022-3155)

Reporter
Koh M. Nakagawa
Impact
low
##### Description

When saving or opening an email attachment on macOS, Thunderbird did not set attribute com.apple.quarantine on the received file. If the received file was an application and the user attempted to open it, then the application was started immediately without asking the user to confirm.

##### References

* [Bug 1789061](https://bugzilla.mozilla.org/show_bug.cgi?id=1789061)

#### [#CVE-2022-40962: Memory safety bugs fixed in Thunderbird 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d2d576c1_20250115_093613.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1789061)
* [XML](/show_bug.cgi?ctype=xml&id=1789061)

Closed
[Bug 1789061](/show_bug.cgi?id=1789061)
(CVE-2022-3155)

Opened 2 years ago
Closed 2 years ago

# Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.

## Categories

### (Thunderbird :: Security, defect)

[Product:](/describecomponents.cgi?product=Thunderbird)

Thunderbird
▾

Thunderbird
For bugs in MZLA's Thunderbird desktop mail client. Bugs in the back-end (e.g. protocols) should be filed in the [MailNews Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=MailNews Core) product. Bugs in calendar should be filed in the [Calendar](https://bugzilla.mozilla.org/enter_bug.cgi?product=Calendar) product. Bugs for the chat features, file in the [Chat Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=Chat%20Core) product.
[See Open Bugs in This Product](/buglist.cgi?product=Thunderbird&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Thunderbird)
Watch This Product

[Component:](/describecomponents.cgi?product=Thunderbird&component=Security#Security)

Security
▾

Thunderbird :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Thunderbird&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Thunderbird 102

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (thunderbird\_esr102 fixed, thunderbird105 wontfix, thunderbird106 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

106 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr102 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed) |
| thunderbird105 | --- | [wontfix](/buglist.cgi?f1=cf_status_thunderbird_105&o1=equals&v1=wontfix) |
| thunderbird106 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_106&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr102 |  | fixed |
| thunderbird105 |  | wontfix |
| thunderbird106 |  | fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: tsunekou1019, Assigned: rjl)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6085829a04926c21ff576e0bbd1cb417?d=mm&size=40)  [rjl](/user_profile?user_id=63411)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8be878d61f741d8ef552c0c02f1e307c?d=mm&size=40)  [tsunekou1019](/user_profile?user_id=712784)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-3155

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [poc.mp4](/attachment.cgi?id=9292951)  [2 years ago](#c1)  [Koh M. Nakagawa](/user_profile?user_id=712784)   2.68 MB, video/mp4 |  | [Details](/attachment.cgi?id=9292951&action=edit) |
| --- | --- | --- |
| [poc.zip](/attachment.cgi?id=9293013)  [2 years ago](#c4)  [Rob Lemley [:rjl]](/user_profile?user_id=63411)   380.93 KB, application/zip |  | [Details](/attachment.cgi?id=9293013&action=edit) |
| [Bug 1789061 - Update macOS Info.plist. r=kaie](/attachment.cgi?id=9293022)  [2 years ago](#c6)  [Rob Lemley [:rjl]](/user_profile?user_id=63411)   48 bytes, text/x-phabricator-request | wsmwk : [approval-comm-esr102+](#c19 "2 years ago") | [Details](/attachment.cgi?id=9293022&action=edit) | [Review](/attachment.cgi?id=9293022) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1789061#c0)• 2 years ago |
|  | |

Summary:

Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.

Background (Gatekeeper):

Gatekeeper is a security mechanism of recent macOS to prevent the execution of an unverified application. This feature builds upon File Quarantine, which works by adding com.apple.quarantine attribute to downloaded files. When an application with com.apple.quarantine attribute is launched, Gatekeeper checks its code signature and its notarization requirement. If these checks are failed, the application is not executed. Files without com.apple.quarantine.attribute are regarded as local files, i.e., these files are trusted, and Gatekeeper does not check these files. com.apple.quarantine attribute is typically added to files downloaded from the internet by applications such as Safari and macOS mail client.

Vulnerability Descriptions:

Thunderbird for macOS does not add com.apple.quarantine attribute to files attached to e-mails. So, when the attached file (e.g., zipped application bundle) is saved locally and executed, its code signature and notarization requirement are not checked.

Steps to reproduce:

1. Save a file attached to an e-mail. In this example, an application bundle named Test.app (not code-signed nor nortaralized) is zipped and attached to the e-mail as Test.zip.
2. Check the extended file attribute of Test.zip by running the xattr command. We cannot check com.apple.quarantine attribute.
3. Unarchive Test.zip and run extracted Test.app. Gatekeeper does not check its execution. So, Test.app is successfully launched even though it is not code-signed nor notarized.

I have also attached PoC movie. Please check it.

Suggested fix:

com.apple.quarantine attribute should be added to files attached to e-mails. We can manually add this attribute by calling setResourceValuves(\_:) (<https://developer.apple.com/documentation/foundation/url/1779940-setresourcevalues>). For more details, see the talk by Patrick Wardle (<https://archive.org/details/Gatekeeper_Exposed>).

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a214_712784)• 2 years ago |

Group: firefox-core-security → mail-core-securityOS: Unspecified → macOSProduct: Firefox → ThunderbirdHardware: Unspecified → ARM64Version: unspecified → Thunderbird 102

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1789061#c1)• 2 years ago |
|  | |

Attached video
[poc.mp4](attachment.cgi?id=9292951)
— [Details](attachment.cgi?id=9292951&action=edit)

PoC movie

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1789061#c2)• 2 years ago |
|  | |

A quick search of mozilla-central didn't turn up any use of setResourceValues. However, in the Info.plist file shipped with Firefox, `LSFileQuarantineEnabled` is set to `true`. Per <https://developer.apple.com/documentation/bundleresources/information_property_list/lsfilequarantineenabled?language=objc>, "A Boolean value indicating whether the files this app creates are quarantined by default.". It's not set in Thunderbird's Info.plist. Should be easy enough to check.

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1789061#c3)• 2 years ago |
|  | |

It seems to be better solution to set `LSFileQuarantineEnabled` to `true`. For other mail client such as Microsoft Outlook, `LSFileQuarantineEnabled` of Info.plist is set to `true` as follows. So, it would be ok.

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
        <key>CFBundlePackageType</key>
        <string>APPL</string>
        <key>DTPlatformVersion</key>
        <string>12.3</string>
        <key>DTSDKBuild</key>
        <string>21E226</string>
        <key>NSAppleScriptEnabled</key>
        <string>Yes</string>
        <key>LSFileQuarantineEnabled</key>
        <true/>
        <key>NSPrincipalClass</key>
        <string>CErageCocoaApp</string>
        <key>OneAuthConfiguration</key>
        <dict>
                <key>OneAuthApplicationName</key>
                <string>Microsoft Outlook</string>
                <key>OneAuthApplicationID</key>
                <string>com.microsoft.Outlook</string>
        </dict>
...

```

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1789061#c4)• 2 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9293013)
— [Details](attachment.cgi?id=9293013&action=edit)

Attaching a very simple macOS application bundle that can be used for testing. The executable itself is a bash script that runs an osascript command to display a 'Hello World' dialog.

I tested by emailing the poc.zip file to a test account. I saved it to the Desktop and checked the output of `xattr -l poc.zip`. The `com.apple.quarantine` attribute was not present.

After unzipping, I was able to execute the test application and the dialog displayed.

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1789061#c5)• 2 years ago |
|  | |

There's some good information in [bug 1305339](/show_bug.cgi?id=1305339 "RESOLVED FIXED - macOS: Wrong quarantine types for https, ftp").

Most interesting is [bug 1305339 comment 16](/show_bug.cgi?id=1305339#c16 "RESOLVED FIXED - macOS: Wrong quarantine types for https, ftp"), which refers to an Exceptions.plist file that is part of the OS and enforces the quarantining. That file does include `org.mozilla.thunderbird`, which is the bundle id in Thunderbird release and beta builds. Daily would be `org.mozilla.thunderbird-daily`. But it doesn't seem to be working.

One thing I had been concerned about, setting `LSFileQuarantineEnabled` means that all files created by the application will have `com.apple.quarantine` set. I was wondering if the profile directory would need any special handling. But, on my Mac, I can see that the Firefox profile files all have the attribute set, so it should be okay for Thunderbird as well. Nothing would be executing out of there anyway.

Status: UNCONFIRMED → NEW
[status-thunderbird105](/buglist.cgi?f1=cf_status_thunderbird_105&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_105&o1=equals&v1=affected)
[status-thunderbird106](/buglist.cgi?f1=cf_status_thunderbird_106&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_106&o1=equals&v1=affected)
[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected)Ever confirmed: true

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1789061#c6)• 2 years ago |
|  | |

Attached file
[Bug 1789061 - Update macOS Info.plist. r=kaie](attachment.cgi?id=9293022)
— [Details](attachment.cgi?id=9293022&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a133908_600971)• 2 years ago |

Assignee: nobody → robStatus: NEW → ASSIGNED

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a133955_600971)• 2 years ago |

[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Attachment description: Bug 1789061 - Update macOS Info.list. r=kaie → Bug 1789061 - Update macOS Info.plist. r=kaie

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1789061#c7)• 2 years ago |
|  | |

I tested the patch in [comment 6](/show_bug.cgi?id=1789061#c6 "VERIFIED FIXED - Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.") with a local build (no try-c-c build). After saving the attachment, I verified that the `com.apple.quarantine` attribute was set. I also verified that it was set on the application bundle after unzipping. When I tried to run it, the untrusted developer/application popup appeared as expected.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1789061#c8)• 2 years ago |
|  | |

Koh M. Nakagawa, thanks a lot for your report and your advice.

If I understand correctly, the user is still required to make the decision to execute the attachment.

Also, in previous versions of macos, the OS did not prevent the user to execute.

Is my understanding correct?

It's difficult to decide whether this bug is a security issue, or whether it's simply a "Thunderbird does not yet enable the new feature to make it more difficult to execute attached applications".

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1789061#c9)• 2 years ago |
|  | |

Tom or Freddy, what's your opinion, omission bug, or security issue?

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1789061#c10)• 2 years ago |
|  | |

> If I understand correctly, the user is still required to make the decision to execute the attachment.

Yes. User interaction is still required.

> Also, in previous versions of macos, the OS did not prevent the user to execute.

Yes, but Gatekeeper was introduced in Mac OS X Lion (10.7.5), which was released about 10 years ago. So, few users use such old macOS that do not prevent the user to execute.

> It's difficult to decide whether this bug is a security issue, or whether it's simply a "Thunderbird does not yet enable the new feature to make it more difficult to execute attached applications".

Similar bugs have been treated as security issues before, e.g., [CVE-2019-17051](https://www.cve.org/CVERecord?id=CVE-2019-17051) (<https://www.cvedetails.com/cve/CVE-2019-17051/>). So, I think this is also regarded as a security issue.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1789061#c11)• 2 years ago |
|  | |

Yeah, I'd say this is a sec-low type issue.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1789061#c12)• 2 years ago |
|  | |

Tom, can you please assign CVE?

Flags: needinfo?(tom)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a384009_36541)• 2 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1789061#c13)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1789061&comment_id=16065549 "2 revisions") |
|  | |

Please review this suggested CVE wording.

```
CVE-??:
    title: Attachment files saved to disk on macOS could be executed without warning
    impact: low
    reporter: Koh M. Nakagawa
    description: |
      When saving or opening an email attachment on macOS, Thunderbird
did not set attribute com.apple.quarantine on the received file. If the
received file was an application and the user attempted to open it,
then the application was started immediately without asking the user
to confirm.
 the
    bugs:
      - url: 1789061

```

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1789061#c14)• 2 years ago |
|  | |

note: I've modified the previous comment and suggested wording.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a386237_578488)• 2 years ago |

Alias: CVE-2022-3155Flags: needinfo?(tom)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1789061#c15)• 2 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/98c8fc3033ef0509ee391cec57234f74f3ccca15>

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-thunderbird106](/buglist.cgi?f1=cf_status_thunderbird_106&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_106&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_106&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 106 Branch

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1789061#c16)• 2 years ago |
|  | |

Verified on Thunderbird Daily (2022-09-08).

Status: RESOLVED → VERIFIED

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1789061#c17)• 2 years ago |
|  | |

Comment on [attachment 9293022](/attachment.cgi?id=9293022 "Bug 1789061 - Update macOS Info.plist. r=kaie") [[details]](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie")

[Bug 1789061](/show_bug.cgi?id=1789061 "VERIFIED FIXED - Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.") - Update macOS Info.plist. r=kaie

[Approval Request Comment]

Regression caused by (bug #): N/A

User impact if declined: Users are potentially able to run emailed apps without a quarantine popup

Testing completed (on c-c, etc.): comm-central

Risk to taking this patch (and alternatives if risky):

Should be low risk, Firefox has been setting the quarantine attribute on created files for some time now.

[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Flags: approval-comm-esr102?
[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Flags: approval-comm-beta?

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1789061#c18)• 2 years ago |
|  | |

Comment on [attachment 9293022](/attachment.cgi?id=9293022 "Bug 1789061 - Update macOS Info.plist. r=kaie") [[details]](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie")

[Bug 1789061](/show_bug.cgi?id=1789061 "VERIFIED FIXED - Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.") - Update macOS Info.plist. r=kaie

[Triage Comment]

Approved for beta

[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Flags: approval-comm-beta? → approval-comm-beta+

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1789061#c19)• 2 years ago |
|  | |

Comment on [attachment 9293022](/attachment.cgi?id=9293022 "Bug 1789061 - Update macOS Info.plist. r=kaie") [[details]](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie")

[Bug 1789061](/show_bug.cgi?id=1789061 "VERIFIED FIXED - Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.") - Update macOS Info.plist. r=kaie

[Triage Comment]

Approved for esr102

[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Flags: approval-comm-esr102? → approval-comm-esr102+

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a1000797_63411)• 2 years ago |

[status-thunderbird105](/buglist.cgi?f1=cf_status_thunderbird_105&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_105&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_thunderbird_105&o1=equals&v1=wontfix)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1789061#c20)• 2 years ago |
|  | |

Comment on [attachment 9293022](/attachment.cgi?id=9293022 "Bug 1789061 - Update macOS Info.plist. r=kaie") [[details]](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie")

[Bug 1789061](/show_bug.cgi?id=1789061 "VERIFIED FIXED - Thunderbird for macOS (Version 102.2.1) contains a vulnerability to enable Gatekeeper bypass.") - Update macOS Info.plist. r=kaie

Didn't get into 105.0beta. Will be in 106.0b1 next week.

[Attachment #9293022](/attachment.cgi?id=9293022&action=edit "Bug 1789061 - Update macOS Info.plist. r=kaie") -
Flags: approval-comm-beta+

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1789061#c21)• 2 years ago |
| uplift | |

Thunderbird 102.3.0:

<https://hg.mozilla.org/releases/comm-esr102/rev/8048bc3bae99acd5bc30c20e3d5b13be295f9fed>

[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed)

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1789061#c22)• 1 year ago |
|  | |

Hello.

I plan to disclose the details of this vulnerability at [CODE BLUE 2023](https://codeblue.jp/2023/en/talks/?content=talks_3), but is it OK? Are there any restrictions to this?

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1789061#c23)• 1 year ago |
|  | |

I don't think so, this has been fixed on release for over a year.

|  | [Koh M. Nakagawa](/user_profile?user_id=712784)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1789061#c24)• 1 year ago |
|  | |

OK. Thank you.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1789061#c25)• 1 year ago |
|  | |

I agree, it's ok to disclose.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a35453317_1689)• 1 year ago |

Group: mail-core-security

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1789061#a54909638_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1789061&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Koh M. Nakagawa](/user_profile?user_id=712784)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


