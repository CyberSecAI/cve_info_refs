=== Content from plugins.trac.wordpress.org_1f4414f6_20250115_095504.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2817824%2Fwoo-wallet%2Ftrunk%3Fcontextall%3D1%26old%3D2816610%26old_path%3D%252Fwoo-wallet%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2816610/woo-wallet/trunk?old=2817824&old_path=%2Fwoo-wallet%2Ftrunk)

---

# Changes in [woo-wallet/trunk](/browser/woo-wallet/trunk?rev=2817824 "Show entry in browser") [[2816610:2817824]](/log/woo-wallet/trunk?rev=2817824&stop_rev=2816610 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[woo-wallet/trunk](/browser/woo-wallet/trunk?rev=2817824)
Files:

4 edited

* [includes/class-woo-wallet-ajax.php](/browser/woo-wallet/trunk/includes/class-woo-wallet-ajax.php?rev=2817824 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [includes/class-woo-wallet-payment-method.php](/browser/woo-wallet/trunk/includes/class-woo-wallet-payment-method.php?rev=2817824 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [readme.txt](/browser/woo-wallet/trunk/readme.txt?rev=2817824 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [woo-wallet.php](/browser/woo-wallet/trunk/woo-wallet.php?rev=2817824 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [woo-wallet/trunk/includes/class-woo-wallet-ajax.php](/changeset/2817824/woo-wallet/trunk/includes/class-woo-wallet-ajax.php?old=2816610&old_path=woo-wallet%2Ftrunk%2Fincludes%2Fclass-woo-wallet-ajax.php "Show the [2816610:2817824] differences restricted to woo-wallet/trunk/includes/class-woo-wallet-ajax.php")

  | [r2816610](/browser/woo-wallet/trunk/includes/class-woo-wallet-ajax.php?rev=2816610#L1 "Show revision 2816610 of this file in browser") | [r2817824](/browser/woo-wallet/trunk/includes/class-woo-wallet-ajax.php?rev=2817824#L1 "Show revision 2817824 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin ajax file |
  | 4 | 4 | \* |
  | 5 | 5 | \* @package WooWallet |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
  | 8 | 8 | if ( ! defined( 'ABSPATH' ) ) { |
  | 9 | 9 | exit; // Exit if accessed directly. |
  | 10 | 10 | } |
  | 11 | 11 | if ( ! class\_exists( 'Woo\_Wallet\_Ajax' ) ) { |
  | 12 | 12 | /\*\* |
  | 13 | 13 | \* Plugin Ajax class |
  | 14 | 14 | \*/ |
  | 15 | 15 | class Woo\_Wallet\_Ajax { |
  | 16 | 16 |  |
  | 17 | 17 | /\*\* |
  | 18 | 18 | \* The single instance of the class. |
  | 19 | 19 | \* |
  | 20 | 20 | \* @var Woo\_Wallet\_Ajax |
  | 21 | 21 | \* @since 1.1.10 |
  | 22 | 22 | \*/ |
  | 23 | 23 | protected static $\_instance = null; |
  | 24 | 24 |  |
  | 25 | 25 | /\*\* |
  | 26 | 26 | \* Main instance |
  | 27 | 27 | \* |
  | 28 | 28 | \* @return class object |
  | 29 | 29 | \*/ |
  | 30 | 30 | public static function instance() { |
  | 31 | 31 | if ( is\_null( self::$\_instance ) ) { |
  | 32 | 32 | self::$\_instance = new self(); |
  | 33 | 33 | } |
  | 34 | 34 | return self::$\_instance; |
  | 35 | 35 | } |
  | 36 | 36 |  |
  | 37 | 37 | /\*\* |
  | 38 | 38 | \* Class constructor |
  | 39 | 39 | \*/ |
  | 40 | 40 | public function \_\_construct() { |
  | 41 | 41 | add\_action( 'wp\_ajax\_woo\_wallet\_order\_refund', array( $this, 'woo\_wallet\_order\_refund' ) ); |
  | 42 | 42 | add\_action( 'wp\_ajax\_woocommerce\_wallet\_rated', array( $this, 'woocommerce\_wallet\_rated' ) ); |
  | 43 | 43 | add\_action( 'wp\_ajax\_woo-wallet-user-search', array( $this, 'woo\_wallet\_user\_search' ) ); |
  | 44 | 44 | add\_action( 'wp\_ajax\_woo\_wallet\_partial\_payment\_update\_session', array( $this, 'woo\_wallet\_partial\_payment\_update\_session' ) ); |
  | 45 | 45 | add\_action( 'wp\_ajax\_woo\_wallet\_refund\_partial\_payment', array( $this, 'woo\_wallet\_refund\_partial\_payment' ) ); |
  | 46 | 46 | add\_action( 'wp\_ajax\_woo-wallet-dismiss-promotional-notice', array( $this, 'woo\_wallet\_dismiss\_promotional\_notice' ) ); |
  | 47 | 47 | add\_action( 'wp\_ajax\_draw\_wallet\_transaction\_details\_table', array( $this, 'draw\_wallet\_transaction\_details\_table' ) ); |
  | 48 | 48 |  |
  | 49 | 49 | add\_action( 'woocommerce\_order\_after\_calculate\_totals', array( $this, 'recalculate\_order\_cashback\_after\_calculate\_totals' ), 10, 2 ); |
  | 50 | 50 |  |
  | 51 | 51 | add\_action( 'wp\_ajax\_terawallet\_export\_user\_search', array( $this, 'terawallet\_export\_user\_search' ) ); |
  | 52 | 52 |  |
  | 53 | 53 | add\_action( 'wp\_ajax\_terawallet\_do\_ajax\_transaction\_export', array( $this, 'terawallet\_do\_ajax\_transaction\_export' ) ); |
  | 54 | 54 |  |
  | 55 | 55 | add\_action( 'wp\_ajax\_lock\_unlock\_terawallet', array( $this, 'lock\_unlock\_terawallet' ) ); |
  | 56 | 56 | } |
  | 57 | 57 | /\*\* |
  | 58 | 58 | \* Lock / Unlock user wallet |
  | 59 | 59 | \* |
  | 60 | 60 | \* @return void |
  | 61 | 61 | \*/ |
  | 62 | 62 | public function lock\_unlock\_terawallet() { |
  | 63 | 63 | check\_ajax\_referer( 'lock-unlock-nonce', 'security' ); |
  | 64 | 64 | $user\_id = isset( $\_POST['user\_id'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['user\_id'] ) ) : 0; |
  | 65 | 65 | $type    = isset( $\_POST['type'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['type'] ) ) : ''; |
  |  | 66 | if ( ! current\_user\_can( 'edit\_user', $user\_id ) ) { |
  |  | 67 | wp\_die( -1 ); |
  |  | 68 | } |
  | 66 | 69 | if ( 'lock' === $type ) { |
  | 67 | 70 | update\_user\_meta( $user\_id, '\_is\_wallet\_locked', true ); |
  | 68 | 71 | wp\_send\_json\_success( |
  | 69 | 72 | array( |
  | 70 | 73 | 'type' => 'unlock', |
  | 71 | 74 | 'text' => \_\_( |
  | 72 | 75 | 'Unlock', |
  | 73 | 76 | 'woo-wallet' |
  | 74 | 77 | ), |
  | 75 | 78 | ) |
  | 76 | 79 | ); |
  | 77 | 80 | } else { |
  | 78 | 81 | delete\_user\_meta( $user\_id, '\_is\_wallet\_locked' ); |
  | 79 | 82 | wp\_send\_json\_success( |
  | 80 | 83 | array( |
  | 81 | 84 | 'type' => 'lock', |
  | 82 | 85 | 'text' => \_\_( |
  | 83 | 86 | 'Lock', |
  | 84 | 87 | 'woo-wallet' |
  | 85 | 88 | ), |
  | 86 | 89 | ) |
  | 87 | 90 | ); |
  | 88 | 91 | } |
  | 89 | 92 | } |
  | 90 | 93 | /\*\* |
  | 91 | 94 | \* Generate export CSV file. |
  | 92 | 95 | \*/ |
  | 93 | 96 | public function terawallet\_do\_ajax\_transaction\_export() { |
  | 94 | 97 | check\_ajax\_referer( 'terawallet-exporter-script', 'security' ); |
  | 95 | 98 | include\_once WOO\_WALLET\_ABSPATH . 'includes/export/class-terawallet-csv-exporter.php'; |
  | 96 | 99 | $step = isset( $\_POST['step'] ) ? absint( $\_POST['step'] ) : 1; |
  | 97 | 100 |  |
  | 98 | 101 | $exporter = new TeraWallet\_CSV\_Exporter(); |
  | 99 | 102 |  |
  | 100 | 103 | $exporter->set\_step( $step ); |
  | 101 | 104 |  |
  | 102 | 105 | if ( ! empty( $\_POST['selected\_columns'] ) ) { |
  | 103 | 106 | $exporter->set\_columns\_to\_export( wp\_unslash( $\_POST['selected\_columns'] ) ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized |
  | 104 | 107 | } |
  | 105 | 108 |  |
  | 106 | 109 | if ( ! empty( $\_POST['selected\_users'] ) ) { |
  | 107 | 110 | $exporter->set\_users\_to\_export( wp\_unslash( $\_POST['selected\_users'] ) ); // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.InputNotSanitized |
  | 108 | 111 | } |
  | 109 | 112 |  |
  | 110 | 113 | if ( ! empty( $\_POST['start\_date'] ) ) { |
  | 111 | 114 | $exporter->set\_start\_date( sanitize\_text\_field( wp\_unslash( $\_POST['start\_date'] ) ) ); |
  | 112 | 115 | } |
  | 113 | 116 |  |
  | 114 | 117 | if ( ! empty( $\_POST['end\_date'] ) ) { |
  | 115 | 118 | $exporter->set\_end\_date( sanitize\_text\_field( wp\_unslash( $\_POST['end\_date'] ) ) ); |
  | 116 | 119 | } |
  | 117 | 120 |  |
  | 118 | 121 | if ( ! empty( $\_POST['filename'] ) ) { |
  | 119 | 122 | $exporter->set\_filename( sanitize\_text\_field( wp\_unslash( $\_POST['filename'] ) ) ); |
  | 120 | 123 | } |
  | 121 | 124 | $exporter->write\_to\_csv(); |
  | 122 | 125 | $query\_args = array( |
  | 123 | 126 | 'nonce'    => wp\_create\_nonce( 'terawallet-transaction-csv' ), |
  | 124 | 127 | 'action'   => 'download\_export\_csv', |
  | 125 | 128 | 'filename' => $exporter->get\_filename(), |
  | 126 | 129 | ); |
  | 127 | 130 | if ( $exporter->get\_percent\_complete() >= 100 ) { |
  | 128 | 131 | wp\_send\_json\_success( |
  | 129 | 132 | array( |
  | 130 | 133 | 'step'       => 'done', |
  | 131 | 134 | 'percentage' => 100, |
  | 132 | 135 | 'url'        => add\_query\_arg( $query\_args, admin\_url( 'admin.php?page=terawallet-exporter' ) ), |
  | 133 | 136 | ) |
  | 134 | 137 | ); |
  | 135 | 138 | } else { |
  | 136 | 139 | wp\_send\_json\_success( |
  | 137 | 140 | array( |
  | 138 | 141 | 'step'       => ++$step, |
  | 139 | 142 | 'percentage' => $exporter->get\_percent\_complete(), |
  | 140 | 143 | 'columns'    => '', |
  | 141 | 144 | ) |
  | 142 | 145 | ); |
  | 143 | 146 | } |
  | 144 | 147 | } |
  | 145 | 148 |  |
  | 146 | 149 | /\*\* |
  | 147 | 150 | \* Search users for export transactions. |
  | 148 | 151 | \*/ |
  | 149 | 152 | public function terawallet\_export\_user\_search() { |
  | 150 | 153 | check\_ajax\_referer( 'search-user', 'security' ); |
  | 151 | 154 | $term    = isset( $\_POST['term'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['term'] ) ) : ''; |
  | 152 | 155 | $return  = array(); |
  | 153 | 156 | $blog\_id = isset( $\_POST['site\_id'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['site\_id'] ) ) : get\_current\_blog\_id(); |
  | 154 | 157 |  |
  | 155 | 158 | $users = get\_users( |
  | 156 | 159 | array( |
  | 157 | 160 | 'blog\_id'        => $blog\_id, |
  | 158 | 161 | 'search'         => '\*' . $term . '\*', |
  | 159 | 162 | 'search\_columns' => array( 'user\_login', 'user\_nicename', 'user\_email' ), |
  | 160 | 163 | ) |
  | 161 | 164 | ); |
  | 162 | 165 |  |
  | 163 | 166 | foreach ( $users as $user ) { |
  | 164 | 167 | $return[] = array( |
  | 165 | 168 | /\* translators: 1: user\_login, 2: user\_email \*/ |
  | 166 | 169 | 'label' => sprintf( \_x( '%1$s (%2$s)', 'user autocomplete result', 'woo-wallet' ), $user->user\_login, $user->user\_email ), |
  | 167 | 170 | 'value' => $user->ID, |
  | 168 | 171 | ); |
  | 169 | 172 | } |
  | 170 | 173 | wp\_send\_json( $return ); |
  | 171 | 174 | } |
  | 172 | 175 |  |
  | 173 | 176 | /\*\* |
  | 174 | 177 | \* Recalculate and send order cashback. |
  | 175 | 178 | \* |
  | 176 | 179 | \* @param Bool     $and\_taxes Description. |
  | 177 | 180 | \* @param WC\_Order $order order. |
  | 178 | 181 | \*/ |
  | 179 | 182 | public function recalculate\_order\_cashback\_after\_calculate\_totals( $and\_taxes, $order ) { |
  | 180 | 183 | $cashback\_amount = woo\_wallet()->cashback->calculate\_cashback( false, $order->get\_id(), true ); |
  | 181 | 184 | $transaction\_id  = get\_post\_meta( $order->get\_id(), '\_general\_cashback\_transaction\_id', true ); |
  | 182 | 185 | if ( $transaction\_id ) { |
  | 183 | 186 | update\_wallet\_transaction( $transaction\_id, $order->get\_customer\_id(), array( 'amount' => $cashback\_amount ), array( '%f' ) ); |
  | 184 | 187 | } |
  | 185 | 188 | } |
  | 186 | 189 |  |
  | 187 | 190 | /\*\* |
  | 188 | 191 | \* Wallet partial payment refund. |
  | 189 | 192 | \*/ |
  | 190 | 193 | public function woo\_wallet\_refund\_partial\_payment() { |
  | 191 | 194 | if ( ! current\_user\_can( 'edit\_shop\_orders' ) ) { |
  | 192 | 195 | wp\_die( -1 ); |
  | 193 | 196 | } |
  | 194 | 197 | $response               = array( 'success' => false ); |
  | 195 | 198 | $order\_id               = absint( filter\_input( INPUT\_POST, 'order\_id' ) ); |
  | 196 | 199 | $order                  = wc\_get\_order( $order\_id ); |
  | 197 | 200 | $partial\_payment\_amount = get\_order\_partial\_payment\_amount( $order\_id ); |
  | 198 | 201 | $transaction\_id         = woo\_wallet()->wallet->credit( $order->get\_customer\_id(), $partial\_payment\_amount, \_\_( 'Wallet refund #', 'woo-wallet' ) . $order->get\_order\_number() ); |
  | 199 | 202 | if ( $transaction\_id ) { |
  | 200 | 203 | $response['success'] = true; |
  | 201 | 204 | /\* translators: wallet amount \*/ |
  | 202 | 205 | $order->add\_order\_note( sprintf( \_\_( '%s refunded to customer wallet', 'woo-wallet' ), wc\_price( $partial\_payment\_amount, woo\_wallet\_wc\_price\_args( $order->get\_customer\_id() ) ) ) ); |
  | 203 | 206 | update\_post\_meta( $order\_id, '\_woo\_wallet\_partial\_payment\_refunded', true ); |
  | 204 | 207 | update\_post\_meta( $order\_id, '\_partial\_payment\_refund\_id', $transaction\_id ); |
  | 205 | 208 | do\_action( 'woo\_wallet\_partial\_order\_refunded', $order\_id, $transaction\_id ); |
  | 206 | 209 | } |
  | 207 | 210 | wp\_send\_json( $response ); |
  | 208 | 211 | } |
  | 209 | 212 |  |
  | 210 | 213 | /\*\* |
  | 211 | 214 | \* Process refund through wallet |
  | 212 | 215 | \* |
  | 213 | 216 | \* @throws Exception To return errors. |
  | 214 | 217 | \*/ |
  | 215 | 218 | public function woo\_wallet\_order\_refund() { |
  | 216 | 219 | ob\_start(); |
  | 217 | 220 | check\_ajax\_referer( 'order-item', 'security' ); |
  | 218 | 221 | if ( ! current\_user\_can( 'edit\_shop\_orders' ) ) { |
  | 219 | 222 | wp\_die( -1 ); |
  | 220 | 223 | } |
  | 221 | 224 | $order\_id               = isset( $\_POST['order\_id'] ) ? absint( $\_POST['order\_id'] ) : 0; |
  | 222 | 225 | $refund\_amount          = isset( $\_POST['refund\_amount'] ) ? wc\_format\_decimal( sanitize\_text\_field( wp\_unslash( $\_POST['refund\_amount'] ) ), wc\_get\_price\_decimals() ) : 0; |
  | 223 | 226 | $refunded\_amount        = isset( $\_POST['refunded\_amount'] ) ? wc\_format\_decimal( sanitize\_text\_field( wp\_unslash( $\_POST['refunded\_amount'] ) ), wc\_get\_price\_decimals() ) : 0; |
  | 224 | 227 | $refund\_reason          = isset( $\_POST['refund\_reason'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['refund\_reason'] ) ) : ''; |
  | 225 | 228 | $line\_item\_qtys         = isset( $\_POST['line\_item\_qtys'] ) ? array\_map( 'intval', json\_decode( sanitize\_text\_field( wp\_unslash( $\_POST['line\_item\_qtys'] ) ), true ) ) : array(); |
  | 226 | 229 | $line\_item\_totals       = isset( $\_POST['line\_item\_totals'] ) ? array\_map( 'floatval', json\_decode( sanitize\_text\_field( wp\_unslash( $\_POST['line\_item\_totals'] ) ), true ) ) : array(); |
  | 227 | 230 | $line\_item\_tax\_totals   = isset( $\_POST['line\_item\_tax\_totals'] ) ? array\_map( 'floatval', json\_decode( sanitize\_text\_field( wp\_unslash( $\_POST['line\_item\_tax\_totals'] ) ), true ) ) : array(); |
  | 228 | 231 | $api\_refund             = isset( $\_POST['api\_refund'] ) && 'true' === $\_POST['api\_refund']; |
  | 229 | 232 | $restock\_refunded\_items = isset( $\_POST['restock\_refunded\_items'] ) && 'true' === $\_POST['restock\_refunded\_items']; |
  | 230 | 233 | $refund                 = false; |
  | 231 | 234 | $response               = array(); |
  | 232 | 235 | try { |
  | 233 | 236 | $order      = wc\_get\_order( $order\_id ); |
  | 234 | 237 | $max\_refund = wc\_format\_decimal( $order->get\_total() - $order->get\_total\_refunded(), wc\_get\_price\_decimals() ); |
  | 235 | 238 |  |
  | 236 | 239 | if ( ( ! $refund\_amount && ( wc\_format\_decimal( 0, wc\_get\_price\_decimals() ) !== $refund\_amount ) ) || $max\_refund < $refund\_amount || 0 > $refund\_amount ) { |
  | 237 | 240 | throw new Exception( \_\_( 'Invalid refund amount', 'woocommerce' ) ); |
  | 238 | 241 | } |
  | 239 | 242 |  |
  | 240 | 243 | if ( wc\_format\_decimal( $order->get\_total\_refunded(), wc\_get\_price\_decimals() ) !== $refunded\_amount ) { |
  | 241 | 244 | throw new Exception( \_\_( 'Error processing refund. Please try again.', 'woocommerce' ) ); |
  | 242 | 245 | } |
  | 243 | 246 |  |
  | 244 | 247 | // Prepare line items which we are refunding. |
  | 245 | 248 | $line\_items = array(); |
  | 246 | 249 | $item\_ids   = array\_unique( array\_merge( array\_keys( $line\_item\_qtys ), array\_keys( $line\_item\_totals ) ) ); |
  | 247 | 250 |  |
  | 248 | 251 | foreach ( $item\_ids as $item\_id ) { |
  | 249 | 252 | $line\_items[ $item\_id ] = array( |
  | 250 | 253 | 'qty'          => 0, |
  | 251 | 254 | 'refund\_total' => 0, |
  | 252 | 255 | 'refund\_tax'   => array(), |
  | 253 | 256 | ); |
  | 254 | 257 | } |
  | 255 | 258 | foreach ( $line\_item\_qtys as $item\_id => $qty ) { |
  | 256 | 259 | $line\_items[ $item\_id ]['qty'] = max( $qty, 0 ); |
  | 257 | 260 | } |
  | 258 | 261 | foreach ( $line\_item\_totals as $item\_id => $total ) { |
  | 259 | 262 | $line\_items[ $item\_id ]['refund\_total'] = wc\_format\_decimal( $total ); |
  | 260 | 263 | } |
  | 261 | 264 | foreach ( $line\_item\_tax\_totals as $item\_id => $tax\_totals ) { |
  | 262 | 265 | $line\_items[ $item\_id ]['refund\_tax'] = array\_filter( array\_map( 'wc\_format\_decimal', $tax\_totals ) ); |
  | 263 | 266 | } |
  | 264 | 267 |  |
  | 265 | 268 | // Create the refund object. |
  | 266 | 269 | $refund = wc\_create\_refund( |
  | 267 | 270 | array( |
  | 268 | 271 | 'amount'         => $refund\_amount, |
  | 269 | 272 | 'reason'         => $refund\_reason, |
  | 270 | 273 | 'order\_id'       => $order\_id, |
  | 271 | 274 | 'line\_items'     => $line\_items, |
  | 272 | 275 | 'refund\_payment' => $api\_refund, |
  | 273 | 276 | 'restock\_items'  => $restock\_refunded\_items, |
  | 274 | 277 | ) |
  | 275 | 278 | ); |
  | 276 | 279 | if ( ! is\_wp\_error( $refund ) ) { |
  | 277 | 280 | $transaction\_id = woo\_wallet()->wallet->credit( $order->get\_customer\_id(), $refund\_amount, $refund\_reason ); |
  | 278 | 281 | if ( ! $transaction\_id ) { |
  | 279 | 282 | throw new Exception( \_\_( 'Refund not credited to customer', 'woo-wallet' ) ); |
  | 280 | 283 | } else { |
  | 281 | 284 | do\_action( 'woo\_wallet\_order\_refunded', $order, $refund, $transaction\_id ); |
  | 282 | 285 | } |
  | 283 | 286 | } |
  | 284 | 287 |  |
  | 285 | 288 | if ( is\_wp\_error( $refund ) ) { |
  | 286 | 289 | throw new Exception( $refund->get\_error\_message() ); |
  | 287 | 290 | } |
  | 288 | 291 |  |
  | 289 | 292 | if ( did\_action( 'woocommerce\_order\_fully\_refunded' ) ) { |
  | 290 | 293 | $response['status'] = 'fully\_refunded'; |
  | 291 | 294 | } |
  | 292 | 295 | } catch ( Exception $e ) { |
  | 293 | 296 | wp\_send\_json\_error( array( 'error' => $e->getMessage() ) ); |
  | 294 | 297 | } |
  | 295 | 298 | // wp\_send\_json\_success must be outside the try block not to break phpunit tests. |
  | 296 | 299 | wp\_send\_json\_success( $response ); |
  | 297 | 300 | } |
  | 298 | 301 |  |
  | 299 | 302 | /\*\* |
  | 300 | 303 | \* Mark wallet rated. |
  | 301 | 304 | \*/ |
  | 302 | 305 | public function woocommerce\_wallet\_rated() { |
  | 303 | 306 | if ( current\_user\_can( 'manage\_options' ) ) { |
  | 304 | 307 | update\_option( 'woocommerce\_wallet\_admin\_footer\_text\_rated', true ); |
  | 305 | 308 | } |
  | 306 | 309 | die; |
  | 307 | 310 | } |
  | 308 | 311 |  |
  | 309 | 312 | /\*\* |
  | 310 | 313 | \* Search users |
  | 311 | 314 | \*/ |
  | 312 | 315 | public function woo\_wallet\_user\_search() { |
  | 313 | 316 | check\_ajax\_referer( 'search-user', 'security' ); |
  | 314 | 317 | $return = array(); |
  | 315 | 318 | $term   = isset( $\_POST['term'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['term'] ) ) : ''; |
  | 316 | 319 | if ( apply\_filters( 'woo\_wallet\_user\_search\_exact\_match', true ) ) { |
  | 317 | 320 | $user = get\_user\_by( apply\_filters( 'woo\_wallet\_user\_search\_by', 'email' ), $term ); |
  | 318 | 321 | if ( $user && wp\_get\_current\_user()->user\_email !== $user->user\_email ) { |
  | 319 | 322 | $return[] = array( |
  | 320 | 323 | /\* translators: 1: user\_login, 2: user\_email \*/ |
  | 321 | 324 | 'label' => sprintf( \_x( '%1$s (%2$s)', 'user autocomplete result', 'woo-wallet' ), $user->user\_login, $user->user\_email ), |
  | 322 | 325 | 'value' => $user->ID, |
  | 323 | 326 | ); |
  | 324 | 327 | } |
  | 325 | 328 | } else { |
  | 326 | 329 | $blog\_id = isset( $\_POST['site\_id'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['site\_id'] ) ) : get\_current\_blog\_id(); |
  | 327 | 330 |  |
  | 328 | 331 | $users = get\_users( |
  | 329 | 332 | array( |
  | 330 | 333 | 'blog\_id'        => $blog\_id, |
  | 331 | 334 | 'search'         => '\*' . $term . '\*', |
  | 332 | 335 | 'exclude'        => array( get\_current\_user\_id() ), |
  | 333 | 336 | 'search\_columns' => array( 'user\_login', 'user\_nicename', 'user\_email' ), |
  | 334 | 337 | ) |
  | 335 | 338 | ); |
  | 336 | 339 |  |
  | 337 | 340 | foreach ( $users as $user ) { |
  | 338 | 341 | $return[] = array( |
  | 339 | 342 | /\* translators: 1: user\_login, 2: user\_email \*/ |
  | 340 | 343 | 'label' => sprintf( \_x( '%1$s (%2$s)', 'user autocomplete result', 'woo-wallet' ), $user->user\_login, $user->user\_email ), |
  | 341 | 344 | 'value' => $user->ID, |
  | 342 | 345 | ); |
  | 343 | 346 | } |
  | 344 | 347 | } |
  | 345 | 348 | wp\_send\_json( $return ); |
  | 346 | 349 | } |
  | 347 | 350 | /\*\* |
  | 348 | 351 | \* Update partial payment session. |
  | 349 | 352 | \* |
  | 350 | 353 | \* @return void |
  | 351 | 354 | \*/ |
  | 352 | 355 | public function woo\_wallet\_partial\_payment\_update\_session() { |
  | 353 | 356 | if ( isset( $\_POST['checked'] ) && 'true' === $\_POST['checked'] ) { // phpcs:ignore WordPress.Security.NonceVerification.Missing |
  | 354 | 357 | update\_wallet\_partial\_payment\_session( true ); |
  | 355 | 358 | } else { |
  | 356 | 359 | update\_wallet\_partial\_payment\_session(); |
  | 357 | 360 | } |
  | 358 | 361 | wp\_die(); |
  | 359 | 362 | } |
  | 360 | 363 | /\*\* |
  | 361 | 364 | \* Dismiss wallet promotonal message. |
  | 362 | 365 | \* |
  | 363 | 366 | \* @return void |
  | 364 | 367 | \*/ |
  | 365 | 368 | public function woo\_wallet\_dismiss\_promotional\_notice() { |
  | 366 | 369 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  | 367 | 370 | wp\_send\_json\_error( \_\_( 'You have no permission to do that', 'woo-wallet' ) ); |
  | 368 | 371 | } |
  | 369 | 372 |  |
  | 370 | 373 | if ( isset( $\_POST['nonce'] ) && ! wp\_verify\_nonce( sanitize\_text\_field( wp\_unslash( $\_POST['nonce'] ) ), 'woo\_wallet\_admin' ) ) { |
  | 371 | 374 | wp\_send\_json\_error( \_\_( 'Invalid nonce', 'woo-wallet' ) ); |
  | 372 | 375 | } |
  | 373 | 376 | update\_option( '\_woo\_wallet\_promotion\_dismissed', true ); |
  | 374 | 377 | wp\_send\_json\_success(); |
  | 375 | 378 | } |
  | 376 | 379 |  |
  | 377 | 380 | /\*\* |
  | 378 | 381 | \* Send wallet transaction AJAX response. |
  | 379 | 382 | \*/ |
  | 380 | 383 | public function draw\_wallet\_transaction\_details\_table() { |
  | 381 | 384 | check\_ajax\_referer( 'woo-wallet-transactions', 'security' ); |
  | 382 | 385 | $start  = isset( $\_POST['start'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['start'] ) ) : 0; |
  | 383 | 386 | $length = isset( $\_POST['length'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['length'] ) ) : 10; |
  | 384 | 387 | $search = isset( $\_POST['search'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $\_POST['search'] ) ) : ''; |
  | 385 | 388 | $args   = array( |
  | 386 | 389 | 'limit' => "$start, $length", |
  | 387 | 390 | ); |
  | 388 | 391 | if ( isset( $search['value'] ) && ! empty( $search['value'] ) ) { |
  | 389 | 392 | $args['where'] = array( |
  | 390 | 393 | array( |
  | 391 | 394 | 'key'      => 'date', |
  | 392 | 395 | 'value'    => $search['value'] . '%', |
  | 393 | 396 | 'operator' => 'LIKE', |
  | 394 | 397 | ), |
  | 395 | 398 | ); |
  | 396 | 399 | } |
  | 397 | 400 | $transactions = get\_wallet\_transactions( $args ); |
  | 398 | 401 | unset( $args['limit'] ); |
  | 399 | 402 | $records\_total = get\_wallet\_transactions\_count( get\_current\_user\_id() ); |
  | 400 | 403 |  |
  | 401 | 404 | $response = array( |
  | 402 | 405 | 'draw'            => isset( $\_POST['draw'] ) ? sanitize\_text\_field( wp\_unslash( $\_POST['draw'] ) ) : 1, |
  | 403 | 406 | 'recordsTotal'    => $records\_total, |
  | 404 | 407 | 'recordsFiltered' => count( get\_wallet\_transactions( $args ) ), |
  | 405 | 408 | 'data'            => array(), |
  | 406 | 409 | ); |
  | 407 | 410 | if ( $transactions ) { |
  | 408 | 411 | foreach ( $transactions as $transaction ) { |
  | 409 | 412 | $response['data'][] = apply\_filters( |
  | 410 | 413 | 'woo\_wallet\_transactons\_datatable\_row\_data', |
  | 411 | 414 | array( |
  | 412 | 415 | 'id'      => $transaction->transaction\_id, |
  | 413 | 416 | 'credit'  => 'credit' === $transaction->type ? wc\_price( apply\_filters( 'woo\_wallet\_amount', $transaction->amount, $transaction->currency, $transaction->user\_id ), woo\_wallet\_wc\_price\_args( $transaction->user\_id ) ) : ' - ', |
  | 414 | 417 | 'debit'   => 'debit' === $transaction->type ? wc\_price( apply\_filters( 'woo\_wallet\_amount', $transaction->amount, $transaction->currency, $transaction->user\_id ), woo\_wallet\_wc\_price\_args( $transaction->user\_id ) ) : ' - ', |
  | 415 | 418 | 'details' => $transaction->details, |
  | 416 | 419 | 'date'    => wc\_string\_to\_datetime( $transaction->date )->date\_i18n( wc\_date\_format() ), |
  | 417 | 420 | ), |
  | 418 | 421 | $transaction |
  | 419 | 422 | ); |
  | 420 | 423 | } |
  | 421 | 424 | } |
  | 422 | 425 | wp\_send\_json( $response ); |
  | 423 | 426 | } |
  | 424 | 427 |  |
  | 425 | 428 | } |
  | 426 | 429 |  |
  | 427 | 430 | } |
  | 428 | 431 | Woo\_Wallet\_Ajax::instance(); |
* ## [woo-wallet/trunk/includes/class-woo-wallet-payment-method.php](/changeset/2817824/woo-wallet/trunk/includes/class-woo-wallet-payment-method.php?old=2812783&old_path=woo-wallet%2Ftrunk%2Fincludes%2Fclass-woo-wallet-payment-method.php "Show the [2816610:2817824] differences restricted to woo-wallet/trunk/includes/class-woo-wallet-payment-method.php")

  | [r2816610](/browser/woo-wallet/trunk/includes/class-woo-wallet-payment-method.php?rev=2812783#L1 "Show revision 2816610 of this file in browser") | [r2817824](/browser/woo-wallet/trunk/includes/class-woo-wallet-payment-method.php?rev=2817824#L1 "Show revision 2817824 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 |  |
  | 3 | 3 | if ( ! defined( 'ABSPATH' ) ) { |
  | 4 | 4 | exit; // Exit if accessed directly. |
  | 5 | 5 | } |
  | 6 | 6 | if ( class\_exists( 'WC\_Payment\_Gateway' ) ) { |
  | 7 | 7 |  |
  | 8 | 8 | class Woo\_Gateway\_Wallet\_payment extends WC\_Payment\_Gateway { |
  | 9 | 9 |  |
  | 10 | 10 | /\*\* |
  | 11 | 11 | \* Class constructor |
  | 12 | 12 | \*/ |
  | 13 | 13 | public function \_\_construct() { |
  | 14 | 14 | $this->setup\_properties(); |
  | 15 | 15 | $this->supports = array( |
  | 16 | 16 | 'products', |
  | 17 | 17 | 'refunds', |
  | 18 | 18 | 'subscriptions', |
  | 19 | 19 | 'multiple\_subscriptions', |
  | 20 | 20 | 'subscription\_cancellation', |
  | 21 | 21 | 'subscription\_suspension', |
  | 22 | 22 | 'subscription\_reactivation', |
  | 23 | 23 | 'subscription\_amount\_changes', |
  | 24 | 24 | 'subscription\_date\_changes', |
  | 25 | 25 | 'subscription\_payment\_method\_change', |
  | 26 | 26 | 'subscription\_payment\_method\_change\_customer', |
  | 27 | 27 | 'subscription\_payment\_method\_change\_admin', |
  | 28 | 28 | ); |
  | 29 | 29 | // Load the settings. |
  | 30 | 30 | $this->init\_form\_fields(); |
  | 31 | 31 | $this->init\_settings(); |
  | 32 | 32 | // Get settings. |
  | 33 | 33 | $this->title        = $this->get\_option( 'title' ); |
  | 34 | 34 | $this->description  = $this->get\_option( 'description' ); |
  | 35 | 35 | $this->instructions = $this->get\_option( 'instructions' ); |
  | 36 | 36 |  |
  | 37 | 37 | add\_action( 'woocommerce\_update\_options\_payment\_gateways\_' . $this->id, array( $this, 'process\_admin\_options' ) ); |
  | 38 | 38 | /\* support for woocommerce subscription plugin \*/ |
  | 39 | 39 | add\_action( 'woocommerce\_scheduled\_subscription\_payment\_' . $this->id, array( $this, 'scheduled\_subscription\_payment' ), 10, 2 ); |
  | 40 | 40 |  |
  | 41 | 41 | add\_action( 'woocommerce\_pre\_payment\_complete', array( $this, 'woocommerce\_pre\_payment\_complete' ) ); |
  | 42 | 42 | } |
  | 43 | 43 |  |
  | 44 | 44 | /\*\* |
  | 45 | 45 | \* Setup general properties for the gateway. |
  | 46 | 46 | \*/ |
  | 47 | 47 | protected function setup\_properties() { |
  | 48 | 48 | $this->id                 = 'wallet'; |
  | 49 | 49 | $this->method\_title       = \_\_( 'Wallet', 'woo-wallet' ); |
  | 50 | 50 | $this->method\_description = \_\_( 'Have your customers pay with wallet.', 'woo-wallet' ); |
  | 51 | 51 | $this->has\_fields         = false; |
  | 52 | 52 | } |
  | 53 | 53 |  |
  | 54 | 54 | /\*\* |
  | 55 | 55 | \* Initialise Gateway Settings Form Fields. |
  | 56 | 56 | \*/ |
  | 57 | 57 | public function init\_form\_fields() { |
  | 58 | 58 | $this->form\_fields = array( |
  | 59 | 59 | 'enabled'      => array( |
  | 60 | 60 | 'title'       => \_\_( 'Enable/Disable', 'woo-wallet' ), |
  | 61 | 61 | 'label'       => \_\_( 'Enable wallet payments', 'woo-wallet' ), |
  | 62 | 62 | 'type'        => 'checkbox', |
  | 63 | 63 | 'description' => '', |
  | 64 | 64 | 'default'     => 'yes', |
  | 65 | 65 | ), |
  | 66 | 66 | 'title'        => array( |
  | 67 | 67 | 'title'       => \_\_( 'Title', 'woo-wallet' ), |
  | 68 | 68 | 'type'        => 'text', |
  | 69 | 69 | 'description' => \_\_( 'This controls the title which the user sees during checkout.', 'woo-wallet' ), |
  | 70 | 70 | 'default'     => \_\_( 'Wallet payment', 'woo-wallet' ), |
  | 71 | 71 | 'desc\_tip'    => true, |
  | 72 | 72 | ), |
  | 73 | 73 | 'description'  => array( |
  | 74 | 74 | 'title'       => \_\_( 'Description', 'woo-wallet' ), |
  | 75 | 75 | 'type'        => 'textarea', |
  | 76 | 76 | 'description' => \_\_( 'Payment method description that the customer will see on your checkout.', 'woo-wallet' ), |
  | 77 | 77 | 'default'     => \_\_( 'Pay with wallet.', 'woo-wallet' ), |
  | 78 | 78 | 'desc\_tip'    => true, |
  | 79 | 79 | ), |
  | 80 | 80 | 'instructions' => array( |
  | 81 | 81 | 'title'       => \_\_( 'Instructions', 'woo-wallet' ), |
  | 82 | 82 | 'type'        => 'textarea', |
  | 83 | 83 | 'description' => \_\_( 'Instructions that will be added to the thank you page.', 'woo-wallet' ), |
  | 84 | 84 | 'default'     => \_\_( 'Pay with wallet.', 'woo-wallet' ), |
  | 85 | 85 | 'desc\_tip'    => true, |
  | 86 | 86 | ), |
  | 87 | 87 | ); |
  | 88 | 88 | } |
  | 89 | 89 |  |
  | 90 | 90 | /\*\* |
  | 91 | 91 | \* Is gateway available |
  | 92 | 92 | \* |
  | 93 | 93 | \* @return boolean |
  | 94 | 94 | \*/ |
  | 95 | 95 | public function is\_available() { |
  | 96 | 96 | if ( is\_checkout() ) { |
  | 97 | 97 | return apply\_filters( 'woo\_wallet\_payment\_is\_available', ( parent::is\_available() && is\_full\_payment\_through\_wallet() && is\_user\_logged\_in() && ! is\_enable\_wallet\_partial\_payment() && ! is\_wallet\_account\_locked() ) ); |
  | 98 | 98 | } |
  | 99 | 99 | return parent::is\_available(); |
  | 100 | 100 | } |
  | 101 | 101 | /\*\* |
  | 102 | 102 | \* Display wallet balance as Icon. |
  | 103 | 103 | \* |
  | 104 | 104 | \* @return string |
  | 105 | 105 | \*/ |
  | 106 | 106 | public function get\_icon() { |
  | 107 | 107 | $current\_balance = woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id() ); |
  | 108 | 108 | return apply\_filters( 'woo\_wallet\_gateway\_icon', sprintf( \_\_( ' | Current Balance: <strong>%s</strong>', 'woo-wallet' ), $current\_balance ), $this->id ); |
  | 109 | 109 | } |
  | 110 | 110 |  |
  | 111 | 111 | /\*\* |
  | 112 | 112 | \* Is $order\_id a subscription? |
  | 113 | 113 | \* |
  | 114 | 114 | \* @param  int $order\_id order\_id. |
  | 115 | 115 | \* @return boolean |
  | 116 | 116 | \*/ |
  | 117 | 117 | protected function is\_subscription( $order\_id ) { |
  | 118 | 118 | return ( function\_exists( 'wcs\_order\_contains\_subscription' ) && ( wcs\_order\_contains\_subscription( $order\_id ) || wcs\_is\_subscription( $order\_id ) || wcs\_order\_contains\_renewal( $order\_id ) ) ); |
  | 119 | 119 | } |
  | 120 | 120 |  |
  | 121 | 121 | /\*\* |
  | 122 | 122 | \* Process wallet payment |
  | 123 | 123 | \* |
  | 124 | 124 | \* @param int $order\_id order\_id. |
  | 125 | 125 | \* @return array |
  | 126 | 126 | \*/ |
  | 127 | 127 | public function process\_payment( $order\_id ) { |
  | 128 | 128 | $order = wc\_get\_order( $order\_id ); |
  | 129 | 129 | if ( ( $order->get\_total( 'edit' ) > woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id(), 'edit' ) ) && apply\_filters( 'woo\_wallet\_disallow\_negative\_transaction', ( woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id(), 'edit' ) <= 0 || $order->get\_total( 'edit' ) > woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id(), 'edit' ) ), $order->get\_total( 'edit' ), woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id(), 'edit' ) ) ) { |
  | 130 | 130 | wc\_add\_notice( \_\_( 'Payment error: ', 'woo-wallet' ) . sprintf( \_\_( 'Your wallet balance is low. Please add %s to proceed with this transaction.', 'woo-wallet' ), wc\_price( $order->get\_total( 'edit' ) - woo\_wallet()->wallet->get\_wallet\_balance( get\_current\_user\_id(), 'edit' ), woo\_wallet\_wc\_price\_args( $order->get\_customer\_id() ) ) ), 'error' ); |
  | 131 | 131 | return; |
  | 132 | 132 | } |
  | 133 | 133 |  |
  | 134 | 134 | // Reduce stock levels. |
  | 135 | 135 | wc\_reduce\_stock\_levels( $order\_id ); |
  | 136 | 136 |  |
  | 137 | 137 | // Remove cart. |
  | 138 | 138 | WC()->cart->empty\_cart(); |
  | 139 | 139 |  |
  | 140 | 140 | // Complete order payment. |
  | 141 | 141 | $order->payment\_complete(); |
  | 142 | 142 |  |
  | 143 | 143 | // Return thankyou redirect. |
  | 144 | 144 | return array( |
  | 145 | 145 | 'result'   => 'success', |
  | 146 | 146 | 'redirect' => $this->get\_return\_url( $order ), |
  | 147 | 147 | ); |
  | 148 | 148 | } |
  | 149 | 149 | /\*\* |
  | 150 | 150 | \* Debit user wallet on WooCommerce payment complete. |
  | 151 | 151 | \* |
  | 152 | 152 | \* @param WC\_Order $order\_id order\_id. |
  | 153 | 153 | \* @throws Exception WooCommerce expeptions. |
  | 154 | 154 | \*/ |
  | 155 | 155 | public function woocommerce\_pre\_payment\_complete( $order\_id ) { |
  | 156 | 156 | $order = wc\_get\_order( $order\_id ); |
  | 157 | 157 | if ( 'wallet' === $order->get\_payment\_method( 'edit' ) && ! $order->get\_transaction\_id( 'edit' ) && $order->has\_status( apply\_filters( 'woocommerce\_valid\_order\_statuses\_for\_payment\_complete', array( 'on-hold', 'pending', 'failed', 'cancelled' ), $order ) ) ) { |
  | 158 | 158 | if ( woo\_wallet()->wallet->get\_wallet\_balance( $order->get\_customer\_id( 'edit' ), 'edit' ) >= $order->get\_total( 'edit' ) ) { |
  | 159 | 159 | $wallet\_response = woo\_wallet()->wallet->debit( $order->get\_customer\_id( 'edit' ), $order->get\_total( 'edit' ), apply\_filters( 'woo\_wallet\_order\_payment\_description', \_\_( 'For order payment #', 'woo-wallet' ) . $order->get\_order\_number(), $order ) ); |
  | 160 | 160 | if ( $wallet\_response ) { |
  | 161 | 161 | $order->set\_transaction\_id( $wallet\_response ); |
  | 162 | 162 | do\_action( 'woo\_wallet\_payment\_processed', $order\_id, $wallet\_response ); |
  | 163 | 163 | $order->save(); |
  | 164 | 164 | } else { |
  | 165 | 165 | throw new Exception( \_\_( 'Something went wrong with processing payment please try again.', 'woo-wallet' ) ); |
  | 166 | 166 | } |
  | 167 | 167 | } else { |
  | 168 | 168 | throw new Exception( \_\_( 'Insufficient wallet balance', 'woo-wallet' ) ); |
  | 169 | 169 | } |
  | 170 | 170 | } |
  | 171 | 171 | } |
  | 172 | 172 |  |
  | 173 | 173 | /\*\* |
  | 174 | 174 | \* Process a refund if supported. |
  | 175 | 175 | \* |
  | 176 | 176 | \* @param  int    $order\_id Order ID. |
  | 177 | 177 | \* @param  float  $amount Refund amount. |
  | 178 | 178 | \* @param  string $reason Refund reason. |
  | 179 | 179 | \* @return bool|WP\_Error |
  |  | 180 | \* @throws Exception WP\_Error Exceptions. |
  | 180 | 181 | \*/ |
  | 181 | 182 | public function process\_refund( $order\_id, $amount = null, $reason = '' ) { |
  | 182 | 183 | $order          = wc\_get\_order( $order\_id ); |
  | 183 | 184 | $refund\_reason  = $reason ? $reason : \_\_( 'Wallet refund #', 'woo-wallet' ) . $order->get\_order\_number(); |
  | 184 | 185 | $transaction\_id = woo\_wallet()->wallet->credit( $order->get\_customer\_id(), $amount, $refund\_reason ); |
  | 185 | 186 | if ( ! $transaction\_id ) { |
  | 186 | 187 | throw new Exception( \_\_( 'Refund not credited to customer', 'woo-wallet' ) ); |
  | 187 | 188 | } |
  | 188 | 189 | do\_action( 'woo\_wallet\_order\_refunded', $order, $amount, $transaction\_id ); |
  | 189 | 190 | return true; |
  | 190 | 191 | } |
  | 191 | 192 |  |
  | 192 | 193 | /\*\* |
  | 193 | 194 | \* Process renewal payment for subscription order |
  | 194 | 195 | \* |
  | 195 | 196 | \* @param int      $amount\_to\_charge amount\_to\_charge. |
  | 196 | 197 | \* @param WC\_Order $order order. |
  | 197 | 198 | \* @return void |
  | 198 | 199 | \*/ |
  | 199 | 200 | public function scheduled\_subscription\_payment( $amount\_to\_charge, $order ) { |
  | 200 | 201 | if ( get\_post\_meta( $order->get\_id(), '\_wallet\_scheduled\_subscription\_payment\_processed', true ) ) { |
  | 201 | 202 | return; |
  | 202 | 203 | } |
  | 203 | 204 | $order->payment\_complete(); |
  | 204 | 205 | update\_post\_meta( $order->get\_id(), '\_wallet\_scheduled\_subscription\_payment\_processed', true ); |
  | 205 | 206 | } |
  | 206 | 207 | } |
  | 207 | 208 | } |
* ## [woo-wallet/trunk/readme.txt](/changeset/2817824/woo-wallet/trunk/readme.txt?old=2816610&old_path=woo-wallet%2Ftrunk%2Freadme.txt "Show the [2816610:2817824] differences restricted to woo-wallet/trunk/readme.txt")

  | [r2816610](/browser/woo-wallet/trunk/readme.txt?rev=2816610#L1 "Show revision 2816610 of this file in browser") | [r2817824](/browser/woo-wallet/trunk/readme.txt?rev=2817824#L1 "Show revision 2817824 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === TeraWallet - For WooCommerce === |
  | 2 | 2 | Contributors: standalonetech, subratamal, moumitaadak |
  | 3 | 3 | Tags: woo wallet, woocommerce wallet, wp wallet, user wallet, refund, cashback, partial payment, wallet, wc wallet, woocommerce credits |
  | 4 |  | Requires PHP: ~~5.6~~ |
  | 5 |  | Requires at least: ~~4.4~~ |
  |  | 4 | Requires PHP: 7.2 |
  |  | 5 | Requires at least: 5.8 |
  | 6 | 6 | Tested up to: 6.1 |
  | 7 |  | Stable tag: 1.4.~~3~~ |
  |  | 7 | Stable tag: 1.4.4 |
  | 8 | 8 | Donate link: https://paypal.me/standalonetech |
  | 9 | 9 | License: GPLv3 |
  | 10 | 10 | License URI: https://www.gnu.org/licenses/gpl-3.0.html |
  | 11 | 11 |  |
  | 12 | 12 | A powerful, extendable WooCommerce wallet system which support payment, partial payment, cashback reward program as well as refund for your WooCommerce store. |
  | 13 | 13 |  |
  | 14 | 14 | == Description == |
  | 15 | 15 |  |
  | 16 | 16 | TeraWallet allows customers to store their money in a digital wallet. The customers can use the wallet money for purchasing products from the store. The customers can add money to their wallet using various payment methods set by the admin. The admin can set cashback rules according to cart price or product. The customers will receive their cashback amount in their wallet account. The admin can process refund to customer wallet. |
  | 17 | 17 |  |
  | 18 | 18 | [youtube https://www.youtube.com/watch?v=Fnpp8qxAWBw] |
  | 19 | 19 |  |
  | 20 | 20 | = Use case of TeraWallet = |
  | 21 | 21 | With this extension, the customers won't have to fill in the payment details every time. They can simply log in and pay for products using the wallet money. The customers will also get the advantage for earning cashback using the wallet money. The admin can process refund to the customer wallet. |
  | 22 | 22 |  |
  | 23 | 23 | = Features of TeraWallet = |
  | 24 | 24 | - Wallet system works just like any other payment method. |
  | 25 | 25 | - Set wallet system payment method title for the front-end. |
  | 26 | 26 | - The customers can use various payment methods to add money. |
  | 27 | 27 | - The admin can process refund using the wallet money. |
  | 28 | 28 | - Customers will earn cashback according to cart price, product or product category wise. |
  | 29 | 29 | - Customers can made partial payment. |
  | 30 | 30 | - Set cashback amount calculation using fixed or percent method. |
  | 31 | 31 | - Admin can export users wallet transactions. |
  | 32 | 32 | - Admin can setup low wallet balance notification email. |
  | 33 | 33 | - Admin can lock / unlock any user wallet. |
  | 34 | 34 | - From the backend, the admin can view the transaction history. |
  | 35 | 35 | - Customers receive notification emails for every wallet transaction. |
  | 36 | 36 | - The admin can adjust the wallet amount of any customer from the backend. |
  | 37 | 37 | - Users can transfer wallet amount to other user. |
  | 38 | 38 | - Shortcode `woo-wallet` which will display user wallet page. |
  | 39 | 39 | - Built with a REST API |
  | 40 | 40 | - Convert WooCommerce coupon into cashback. |
  | 41 | 41 | - Support WordPress Multisite Network |
  | 42 | 42 | - Supports multiple languages translations. |
  | 43 | 43 | - Supports WooCommerce Subscriptions. |
  | 44 | 44 | - Supports WooCommerce Multivendor Marketplace by WC Lovers. |
  | 45 | 45 | - Supports WC Marketplace. |
  | 46 | 46 | - Supports Dokan Multivendor Marketplace. |
  | 47 | 47 |  |
  | 48 | 48 | > Take a step forward and try our [demo](https://standalonetech.com/). |
  | 49 | 49 |  |
  | 50 | 50 | = Workflow of TeraWallet = |
  | 51 | 51 | After the plugin installation, the admin needs to do the payment method configuration. Set the title and select allowed payments for adding money. |
  | 52 | 52 | Now for enable cashback rules, navigate to WooWallet > Settings >  Credit. Now setup cashback rule according to your requirement. If cashback rule set to product wise then admin will have an option to add cashback rule for each product. |
  | 53 | 53 | On the front-end, the customers can log in to the store and go to wallet page from My Account. Enter the amount to add and then complete the checkout process just like any other product purchase. |
  | 54 | 54 |  |
  | 55 | 55 | = Translator Contributors = |
  | 56 | 56 | - [#fa\_IR](https://translate.wordpress.org/locale/fa/default/wp-plugins/woo-wallet) - [@rahimvaziri](https://wordpress.org/support/users/rahimvaziri/) |
  | 57 | 57 | - [#es\_ES](https://translate.wordpress.org/locale/es/default/wp-plugins/woo-wallet) - [@chipweb](https://wordpress.org/support/users/chipweb/) |
  | 58 | 58 |  |
  | 59 | 59 | == Installation == |
  | 60 | 60 |  |
  | 61 | 61 | = Minimum Requirements = |
  | 62 | 62 |  |
  | 63 | 63 | \* PHP version 5.2.4 or greater (PHP 5.6 or greater is recommended) |
  | 64 | 64 | \* MySQL version 5.0 or greater (MySQL 5.6 or greater is recommended) |
  | 65 | 65 | \* WordPress 4.4+ |
  | 66 | 66 | \* WooCommerce 3.0+ |
  | 67 | 67 |  |
  | 68 | 68 | = Automatic installation = |
  | 69 | 69 |  |
  | 70 | 70 | Automatic installation is the easiest option as WordPress handles the file transfers itself and you don’t need to leave your web browser. To do an automatic install of WooCommerce Wallet Payment, log in to your WordPress dashboard, navigate to the Plugins menu and click Add New. |
  | 71 | 71 |  |
  | 72 | 72 | In the search field type “WooCommerce Wallet Payment” and click Search Plugins. Once you’ve found our WooCommerce Wallet Payment plugin you can view details about it such as the point release, rating and description. Most importantly of course, you can install it by simply clicking “Install Now”. |
  | 73 | 73 |  |
  | 74 | 74 | = Manual installation = |
  | 75 | 75 |  |
  | 76 | 76 | The manual installation method involves downloading our plugin and uploading it to your webserver via your favourite FTP application. The WordPress codex contains [instructions on how to do this here](https://codex.wordpress.org/Managing\_Plugins#Manual\_Plugin\_Installation). |
  | 77 | 77 |  |
  | 78 | 78 | = Updating = |
  | 79 | 79 |  |
  | 80 | 80 | Automatic updates should work like a charm; as always though, ensure you backup your site just in case. |
  | 81 | 81 |  |
  | 82 | 82 | If on the off-chance you do encounter issues with the wallet endpoints pages after an update you simply need to flush the permalinks by going to WordPress > Settings > Permalinks and hitting 'save'. That should return things to normal. |
  | 83 | 83 |  |
  | 84 | 84 | == Frequently Asked Questions == |
  | 85 | 85 |  |
  | 86 | 86 | = Does this plugin work with newest WP version and also older versions? = |
  | 87 | 87 |  |
  | 88 | 88 | Yes, this plugin works fine with WordPress 4.9, It is also compatible for older WordPress versions upto 4.4. |
  | 89 | 89 |  |
  | 90 | 90 | = Up to which version of WooCommerce this plugin compatible with? = |
  | 91 | 91 |  |
  | 92 | 92 | This plugin is compatible with the latest version of WooCommerce. |
  | 93 | 93 |  |
  | 94 | 94 | = Will WooCommerce Wallet work with WordPress multisite network? = |
  | 95 | 95 |  |
  | 96 | 96 | Yes, WooCommerce Wallet plugin is fully compatible with Wordpress multisite. |
  | 97 | 97 |  |
  | 98 | 98 | = Where can I get support or talk to other users? = |
  | 99 | 99 |  |
  | 100 | 100 | If you get stuck, you can ask for help in the [WordPress Plugin Forum](https://wordpress.org/support/plugin/woo-wallet) or just email us at support@standalonetech.com. |
  | 101 | 101 |  |
  | 102 | 102 | = Where can I report bugs or contribute to the project? = |
  | 103 | 103 |  |
  | 104 | 104 | Bugs can be reported either in our support forum or preferably on the [GitHub repository](https://github.com/malsubrata/woo-wallet/issues). |
  | 105 | 105 |  |
  | 106 | 106 | = Where can I find the REST API documentation? = |
  | 107 | 107 |  |
  | 108 | 108 | You can find the documentation of our [Wallet REST API Docs](https://github.com/malsubrata/woo-wallet/wiki/API-V3). |
  | 109 | 109 |  |
  | 110 | 110 | = This plugin is awesome! Can I contribute? = |
  | 111 | 111 |  |
  | 112 | 112 | Yes you can! Join in on our [GitHub repository](https://github.com/malsubrata/woo-wallet) :) |
  | 113 | 113 |  |
  | 114 | 114 | == Screenshots == |
  | 115 | 115 |  |
  | 116 | 116 | 1. User wallet page. |
  | 117 | 117 | 2. Transfer wallet balance. |
  | 118 | 118 | 3. View transaction details. |
  | 119 | 119 | 4. All user balance details. |
  | 120 | 120 | 5. Admin view transaction details. |
  | 121 | 121 | 6. Admin adjust wallet balance. |
  | 122 | 122 | 7. WooCommerce wallet payment gateway. |
  | 123 | 123 | 8. WooCommerce refund. |
  | 124 | 124 | 9. Wallet actions. |
  | 125 | 125 |  |
  | 126 | 126 | == Changelog == |
  |  | 127 | = 1.4.4 - 2022-11-14 = |
  |  | 128 | \* Fix - Security issue on the function lock\_unlock\_terawallet. |
  |  | 129 |  |
  | 127 | 130 | = 1.4.3 - 2022-11-11 = |
  | 128 | 131 | \* Fix - Datatable ajax issue. |
  | 129 | 132 |  |
  | 130 | 133 | = 1.4.2 - 2022-11-11 = |
  | 131 | 134 | \* Fix - Mini wallet nav menu location. |
  | 132 | 135 |  |
  | 133 | 136 | = 1.4.1 - 2022-11-11 = |
  | 134 | 137 | \* Fix - Fix Cannot uncheck checkbox issue in plugin settings page. |
  | 135 | 138 |  |
  | 136 | 139 | = 1.4.0 - 2022-11-4 = |
  | 137 | 140 | \* Fix - Plugin CSRF issue ( Thanks Muhammad Daffa ). |
  | 138 | 141 | \* Add - Compatibility with WP 6.1 |
  | 139 | 142 |  |
  | 140 | 143 | = 1.3.24 - 2022-03-18 = |
  | 141 | 144 | \* Fix - Wallet payment process. |
  | 142 | 145 | \* Fix - Referral signup action. |
  | 143 | 146 | \* Tweak - Wallet pages will be removed from account page if user is bolocked. |
  | 144 | 147 | \* Add - REST API V3 [API Docs](https://github.com/malsubrata/woo-wallet/wiki/API-V3). |
  | 145 | 148 |  |
  | 146 | 149 | = 1.3.23 - 2022-02-17 = |
  | 147 | 150 | \* Fix - Compatibility with WooCommerce Subscription plugin. |
  | 148 | 151 | \* Fix - Referral order amount |
  | 149 | 152 | \* Fix - Cashback issue for guest user. |
  | 150 | 153 | \* Add - Support for order created via rest API. |
  | 151 | 154 |  |
  | 152 | 155 | = 1.3.22 - 2021-12-23 = |
  | 153 | 156 | \* Fix - Plugin title translation issue. |
  | 154 | 157 |  |
  | 155 | 158 | = 1.3.21 -2021-12-22 = |
  | 156 | 159 | \* Fix - Exporter column header. |
  | 157 | 160 | \* Fix - Incorrect wallet top-up this month widget. |
  | 158 | 161 | \* Tweak - Delete Transaction history without effecting User balance. |
  | 159 | 162 | \* Fix - Cashback coupon for Guest User. |
  | 160 | 163 | \* Fix - Referring signup bug. |
  | 161 | 164 | \* Add - Compatibility with Dokan > 3.3. |
  | 162 | 165 |  |
  | 163 | 166 | = 1.3.20 - 2021-11-26 = |
  | 164 | 167 | \* Fix - Wallet top-up issue. |
  | 165 | 168 | \* Fix - Extension page CSS issue. |
  | 166 | 169 |  |
  | 167 | 170 | = 1.3.19 - 2021-07-02 = |
  | 168 | 171 | \* Add - Now admin can setup low wallet balance notification email. |
  | 169 | 172 | \* Add - Admin can export wallet transactions. |
  | 170 | 173 | \* Add - Admin can lock / unlock user wallet. |
  | 171 | 174 |  |
  | 172 | 175 | = 1.3.18 - 2021-3-18 = |
  | 173 | 176 | \* Add - Now admin can see which user make credit / debit transaction. |
  | 174 | 177 | \* Fix - Cashback recalculation issue. |
  | 175 | 178 | \* Fix - Debit Round up issue for bulk action. |
  | 176 | 179 | \* Fix - Removed order again button from wallet rechargeable order details page. |
  | 177 | 180 | \* Tweak - Now referral bonus will be credited after user purchase something from the store. |
  | 178 | 181 | \* Dev - Added new filter `woo\_wallet\_calculate\_cashback\_on\_total` to set cashback on order total or subtotal. |
  | 179 | 182 |  |
  | 180 | 183 | = 1.3.17 - 2020-12-29 = |
  | 181 | 184 | \* Fix - Fix URL while searching users in balance details page. |
  | 182 | 185 | \* Fix - Redirect issue in adjust balance page. |
  | 183 | 186 | \* Fix - Decimal point issue in bulk credit, debit wallet balance. |
  | 184 | 187 | \* Fix - WooCommerce Analytics report. |
  | 185 | 188 |  |
  | 186 | 189 | = 1.3.16 - 2020-08-26 = |
  | 187 | 190 | \* Add - New wallet recharge state in dashboard widget. |
  | 188 | 191 | \* Tweak - Now cashback will be calculated on order total instead of order subtotal. |
  | 189 | 192 | \* Tweak - Excluded wallet rechargable orders from WooCommerce analytics page. |
  | 190 | 193 | \* Tweak - Database query result performance optimization. |
  | 191 | 194 | \* Fix - Translation issue and wp list table display issue for mobile. |
  | 192 | 195 | \* Fix - Redirection issue in wallet dashboard for wallet shortcode. |
  | 193 | 196 | \* Dev - Added hooks into WooCommerce product review action. |
  | 194 | 197 |  |
  | 195 | 198 | = 1.3.15 - 2020-04-22 = |
  | 196 | 199 | \* Add - AJAX datatable on wallet transaction details page. |
  | 197 | 200 | \* Add - Custom field in WP nav menu setting to display wallet icon and amount instead of menu title. |
  | 198 | 201 | \* Notice - Mini wallet display location settings will be removed on next update use WooCommerce endpoint menu item instead. |
  | 199 | 202 |  |
  | 200 | 203 | = 1.3.14 - 2020-03-07 = |
  | 201 | 204 | \* Add - Bulk credit debit option for admin #46. |
  | 202 | 205 | \* Fix - Current link attributes in wallet details page #45. |
  | 203 | 206 |  |
  | 204 | 207 | = 1.3.13 - 2020-02-08 = |
  | 205 | 208 | \* Fix - Wallet top-up issue. |
  | 206 | 209 |  |
  | 207 | 210 | = 1.3.12 - 2020-02-07 = |
  | 208 | 211 | \* Add - Mini wallet RTL support. |
  | 209 | 212 | \* Add - Support for WooCommerce subscription payment method change. |
  | 210 | 213 | \* Add - Copy to clipboard function in referral URL. |
  | 211 | 214 | \* Fix - Cashback recalculation function. |
  | 212 | 215 | \* Fix - Loading issue in wallet transfer searchbox. |
  | 213 | 216 | \* Tweak - `is\_full\_payment\_through\_wallet` function. |
  | 214 | 217 | \* Dev - Added `woo\_wallet\_cashback\_rules` filter. |
  | 215 | 218 | \* Dev - Added `created\_by` database column to `woo\_wallet\_transactions` table. |
  | 216 | 219 |  |
  | 217 | 220 | = 1.3.11 - 2019-11-13 = |
  | 218 | 221 | \* Add - Mini wallet shortcode. |
  | 219 | 222 | \* Fix - Cashback amount for product cart rule. |
  | 220 | 223 | \* Fix - Wallet endpoint issue for shortcode. |
  | 221 | 224 |  |
  | 222 | 225 | = 1.3.10 - 2019-09-11 = |
  | 223 | 226 | \* Add - Submit button at Wallet Top-Up widget. |
  | 224 | 227 | \* Fix - Cashback calculation issue for product category. |
  | 225 | 228 | \* Fix - Partial payment template. |
  | 226 | 229 | \* Fix - WooCommerce endpoint save issue. |
  | 227 | 230 | \* Tweak - Alter database column amount and balance. |
  | 228 | 231 |  |
  | 229 | 232 | = 1.3.9 - 2019-06-18 = |
  | 230 | 233 | \* New - Now admin can configure cashback for variable products. |
  | 231 | 234 |  |
  | 232 | 235 | = 1.3.8 - 2019-06-07 = |
  | 233 | 236 | \* Add - Role wise filter in wallet transaction page. |
  | 234 | 237 | \* Add - Hooks and Filters. |
  | 235 | 238 |  |
  | 236 | 239 | = 1.3.7 - 2019-05-05 = |
  | 237 | 240 | \* Add - Minimum transfer limit. |
  | 238 | 241 | \* Fix - Dokan withdrawal issue. |
  | 239 | 242 |  |
  | 240 | 243 | = 1.3.6 - 2019-04-19 = |
  | 241 | 244 | \* Updated - Plugin name change. |
  | 242 | 245 |  |
  | 243 | 246 | = 1.3.5 - 2019-04-18 = |
  | 244 | 247 | \* Add - Support for WC version 3.6. |
  | 245 | 248 | \* Add - Referral action. |
  | 246 | 249 | \* Fix - `wc\_format\_decimal` function use in partial payment. |
  | 247 | 250 | \* Remove - Deprecated WC functions. |
  | 248 | 251 |  |
  | 249 | 252 | = 1.3.4 - 2019-03-23 = |
  | 250 | 253 | \* Added - Compatibility with WooCommerce Germanized plugin. |
  | 251 | 254 | \* Add - Empty datatable info translation string |
  | 252 | 255 | \* Add - Fee amount in woowallet cart total function. |
  | 253 | 256 | \* Fix - Wallet transfer menu issue. |
  | 254 | 257 |  |
  | 255 | 258 | = 1.3.3 - 2019-03-04 = |
  | 256 | 259 | \* Fix - Plugin dependencies file. |
  | 257 | 260 |  |
  | 258 | 261 | = 1.3.2 - 2019-02-27 = |
  | 259 | 262 | \* Add - Now cart items will be restored after successful wallet top-up. |
  | 260 | 263 | \* Fix - Partial payment issues. |
  | 261 | 264 | \* Fix - Cashback calculation for variable product. |
  | 262 | 265 | \* Fix - Transaction date issue. |
  | 263 | 266 | \* Fix - Order by balance column in WooWallet balance details table. |
  | 264 | 267 | \* Tweak - Cashback logic. |
  | 265 | 268 | \* Tweak - Wallet funds transfer description. |
  | 266 | 269 |  |
  | 267 | 270 | = 1.3.1 - 2019-02-04 = |
  | 268 | 271 | \* Fix - Cashback issue. |
  | 269 | 272 |  |
  | 270 | 273 | = 1.3.0 - 2019-02-02 = |
  | 271 | 274 | \* Add - Now cashback will be credited if admin create order for customer. |
  | 272 | 275 | \* Add - Added wallet top-up widget. |
  | 273 | 276 | \* Fix - Disable partial payment if user balance is zero. |
  | 274 | 277 | \* Fix - Multiple ajax call for partial payment. |
  | 275 | 278 | \* Fix - Delete transaction records upon deletion of user. |
  | 276 | 279 | \* Tweak - Daily visit. |
  | 277 | 280 |  |
  | 278 | 281 | [See changelog for all versions](https://raw.githubusercontent.com/malsubrata/woo-wallet/master/changelog.txt). |
  | 279 | 282 |  |
  | 280 | 283 | == Upgrade Notice == |
  | 281 | 284 |  |
  | 282 | 285 | = 1.3 = |
* ## [woo-wallet/trunk/woo-wallet.php](/changeset/2817824/woo-wallet/trunk/woo-wallet.php?old=2816610&old_path=woo-wallet%2Ftrunk%2Fwoo-wallet.php "Show the [2816610:2817824] differences restricted to woo-wallet/trunk/woo-wallet.php")

  | [r2816610](/browser/woo-wallet/trunk/woo-wallet.php?rev=2816610#L1 "Show revision 2816610 of this file in browser") | [r2817824](/browser/woo-wallet/trunk/woo-wallet.php?rev=2817824#L1 "Show revision 2817824 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Name: TeraWallet |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/woo-wallet/ |
  | 5 | 5 | \* Description: The leading wallet plugin for WooCommerce with partial payment, refunds, cashbacks and what not! |
  | 6 | 6 | \* Author: StandaloneTech |
  | 7 | 7 | \* Author URI: https://standalonetech.com/ |
  | 8 |  | \* Version: 1.4.~~3~~ |
  |  | 8 | \* Version: 1.4.4 |
  | 9 | 9 | \* Requires at least: 4.4 |
  | 10 | 10 | \* Tested up to: 6.1 |
  | 11 | 11 | \* WC requires at least: 3.0 |
  | 12 |  | \* WC tested up to: 7.~~0~~ |
  |  | 12 | \* WC tested up to: 7.1 |
  | 13 | 13 | \* |
  | 14 | 14 | \* Text Domain: woo-wallet |
  | 15 | 15 | \* Domain Path: /languages/ |
  | 16 | 16 | \* |
  | 17 | 17 | \* |
  | 18 | 18 | \* This program is free software: you can redistribute it and/or modify |
  | 19 | 19 | \* it under the terms of the GNU General Public License as published by |
  | 20 | 20 | \* the Free Software Foundation, either version 3 of the License, or |
  | 21 | 21 | \* (at your option) any later version. |
  | 22 | 22 | \* |
  | 23 | 23 | \* This program is distributed in the hope that it will be useful, |
  | 24 | 24 | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
  | 25 | 25 | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the |
  | 26 | 26 | \* GNU General Public License for more details. |
  | 27 | 27 | \* |
  | 28 | 28 | \* You should have received a copy of the GNU General Public License |
  | 29 | 29 | \* along with this program. If not, see <http://www.gnu.org/licenses/>. |
  | 30 | 30 | \* |
  | 31 | 31 | \* @package WooWallet |
  | 32 | 32 | \*/ |
  | 33 | 33 |  |
  | 34 | 34 | if ( ! defined( 'ABSPATH' ) ) { |
  | 35 | 35 | exit; |
  | 36 | 36 | } |
  | 37 | 37 |  |
  | 38 | 38 | // Define WOO\_WALLET\_PLUGIN\_FILE. |
  | 39 | 39 | if ( ! defined( 'WOO\_WALLET\_PLUGIN\_FILE' ) ) { |
  | 40 | 40 | define( 'WOO\_WALLET\_PLUGIN\_FILE', \_\_FILE\_\_ ); |
  | 41 | 41 | } |
  | 42 | 42 |  |
  | 43 | 43 | // Define WOO\_WALLET\_ABSPATH. |
  | 44 | 44 | if ( ! defined( 'WOO\_WALLET\_ABSPATH' ) ) { |
  | 45 | 45 | define( 'WOO\_WALLET\_ABSPATH', dirname( WOO\_WALLET\_PLUGIN\_FILE ) . '/' ); |
  | 46 | 46 | } |
  | 47 | 47 |  |
  | 48 | 48 | // Define WOO\_WALLET\_PLUGIN\_VERSION. |
  | 49 | 49 | if ( ! defined( 'WOO\_WALLET\_PLUGIN\_VERSION' ) ) { |
  | 50 |  | define( 'WOO\_WALLET\_PLUGIN\_VERSION', '1.4.~~3~~' ); |
  |  | 50 | define( 'WOO\_WALLET\_PLUGIN\_VERSION', '1.4.4' ); |
  | 51 | 51 | } |
  | 52 | 52 |  |
  | 53 | 53 | // include dependencies file. |
  | 54 | 54 | if ( ! class\_exists( 'Woo\_Wallet\_Dependencies' ) ) { |
  | 55 | 55 | include\_once dirname( \_\_FILE\_\_ ) . '/includes/class-woo-wallet-dependencies.php'; |
  | 56 | 56 | } |
  | 57 | 57 |  |
  | 58 | 58 | // Include the main class. |
  | 59 | 59 | if ( ! class\_exists( 'WooWallet' ) ) { |
  | 60 | 60 | include\_once dirname( \_\_FILE\_\_ ) . '/includes/class-woo-wallet.php'; |
  | 61 | 61 | } |
  | 62 | 62 | /\*\* |
  | 63 | 63 | \* Returns the main instance of WooWallet. |
  | 64 | 64 | \* |
  | 65 | 65 | \* @since  1.1.0 |
  | 66 | 66 | \* @return WooWallet |
  | 67 | 67 | \*/ |
  | 68 | 68 | function woo\_wallet() { |
  | 69 | 69 | return WooWallet::instance(); |
  | 70 | 70 | } |
  | 71 | 71 |  |
  | 72 | 72 | $GLOBALS['woo\_wallet'] = woo\_wallet(); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2817824&old=2816610&new_path=%2Fwoo-wallet%2Ftrunk&old_path=%2Fwoo-wallet%2Ftrunk)
* [Zip Archive](?format=zip&new=2817824&old=2816610&new_path=%2Fwoo-wallet%2Ftrunk&old_path=%2Fwoo-wallet%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_3179cbf8_20250115_095505.html ===


# Vulnerability Advisories Continued

Wordfence is authorized by the Common Vulnerabilities and Exposures (CVE®) Program as a CNA, or CVE Numbering Authority. As a CNA, Wordfence assigns CVE IDs for new vulnerabilities in WordPress Core, WordPress Plugins and WordPress Themes.

Assigned CVE IDs and the vulnerability details are published below. For more information about submitting vulnerabilities to Wordfence for CVE ID assignment, please refer to our [vulnerability disclosure policy](https://www.wordfence.com/security/).

**\*\*This page is no longer maintained, please visit [Wordfence Intelligence](https://www.wordfence.com/threat-intel)  for the latest Information on Vulnerabilities.\*\***

---

## Chained Quiz <= 1.3.2.2 – Authenticated (Admin+) Stored Cross-Site Scripting via Mailchimp API Key

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4217](https://www.cve.org/CVERecord?id=CVE-2022-4216)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘api\_key’ parameter in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers with administrative privileges to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Chained Quiz <= 1.3.2.2 – Authenticated (Admin+) Stored Cross-Site Scripting via Facebook App ID

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4216](https://www.cve.org/CVERecord?id=CVE-2022-4216)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘facebook\_appid’ parameter in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers with administrative privileges to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via datef

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4208](https://www.cve.org/CVERecord?id=CVE-2022-4208)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘datef’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via pointsf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4209](https://www.cve.org/CVERecord?id=CVE-2022-4209)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘pointsf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via dnf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4210](https://www.cve.org/CVERecord?id=CVE-2022-4210)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘dnf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via emailf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4211](https://www.cve.org/CVERecord?id=CVE-2022-4211)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ’emailf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via ipf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4212](https://www.cve.org/CVERecord?id=CVE-2022-4212)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘ipf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.2 – Reflected Cross-Site Scripting via dn

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.2

**CVE ID:** [CVE-2022-4213](https://www.cve.org/CVERecord?id=CVE-2022-4213)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘dn’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.3 – Reflected Cross-Site Scripting via ip

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.3

**CVE ID:** [CVE-2022-4214](https://www.cve.org/CVERecord?id=CVE-2022-4214)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.4

**Recommended Remediation:** Update to version 1.3.2.4, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘ip’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.3 – Reflected Cross-Site Scripting via date

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.3

**CVE ID:** [CVE-2022-4215](https://www.cve.org/CVERecord?id=CVE-2022-4215)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.4

**Recommended Remediation:** Update to version 1.3.2.4, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘date’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Question Deletion

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4220](https://www.cve.org/CVERecord?id=CVE-2022-4220)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the list\_questions() function. This makes it possible for unauthenticated attackers to delete questions from quizzes via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Submitted Response Deletion

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4219](https://www.cve.org/CVERecord?id=CVE-2022-4219)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the manage() function. This makes it possible for unauthenticated attackers to delete submitted quiz responses via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Arbitrary Quiz Deletion and Copying

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4218](https://www.cve.org/CVERecord?id=CVE-2022-4218)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the list\_quizzes() function. This makes it possible for unauthenticated attackers to delete quizzes and copy quizzes via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Appointment Hour Booking <= 1.3.72 – CAPTCHA Bypass

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4036](https://www.cve.org/CVERecord?id=CVE-2022-4036)

**CVSS Score:** 5.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking plugin for WordPress is vulnerable to CAPTCHA bypass in versions up to, and including, 1.3.72. This is due to the use of insufficiently strong hashing algorithm on the CAPTCHA secret that is also displayed to the user via a cookie.

---

## Appointment Hour Booking <= 1.3.72 – Unauthenticated iFrame Injection via Appointment Form

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4035](https://www.cve.org/CVERecord?id=CVE-2022-4035)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking plugin for WordPress is vulnerable to iFrame Injection via the ‘email’ or general field parameters in versions up to, and including, 1.3.72 due to insufficient input sanitization and output escaping that makes injecting iFrame tags possible. This makes it possible for unauthenticated attackers to inject iFrames when submitting a booking that will execute whenever a user accesses the injected booking details page.

---

## Appointment Hour Booking <= 1.3.72 – CSV Injection

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4034](https://www.cve.org/CVERecord?id=CVE-2022-4034)

**CVSS Score:** 5.8 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking Plugin for WordPress is vulnerable to CSV Injection in versions up to, and including, 1.3.72. This makes it possible for unauthenticated attackers to embed untrusted input into content during booking creation that may be exported as a CSV file when a site’s administrator exports booking details. This can result in code execution when these files are downloaded and opened on a local system with a vulnerable configuration.

---

## Quiz and Survey Master <= 8.0.4 – Improper Input Validation

**Affected Plugin:** [Quiz and Survey Master](https://wordpress.org/plugins/quiz-master-next/)

**Plugin Slug:** quiz-master-next

**Affected Versions:** <= 8.0.4

**CVE ID:** [CVE-2022-4033](https://www.cve.org/CVERecord?id=CVE-2022-4033)

**CVSS Score:** 5.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 8.0.5

**Recommended Remediation:** Update to version 8.0.5, or newer patched version.

**Publication Date:** 2022-11-29

The Quiz and Survey Master plugin for WordPress is vulnerable to input validation bypass via the ‘question[id]’ parameter in versions up to, and including, 8.0.4 due to insufficient input validation that allows attackers to inject content other than the specified value (i.e. a number, file path, etc..). This makes it possible attackers to submit values other than the intended input type.

---

## Quiz and Survey Master <= 8.0.4 – Unauthenticated iFrame Injection via Paragraph and Short Answer

**Affected Plugin:** [Quiz and Survey Master](https://wordpress.org/plugins/quiz-master-next/)

**Plugin Slug:** quiz-master-next

**Affected Versions:** <= 8.0.4

**CVE ID:** [CVE-2022-4032](https://www.cve.org/CVERecord?id=CVE-2022-4032)

**CVSS Score:** 7.2 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 8.0.5

**Recommended Remediation:** Update to version 8.0.5, or newer patched version.

**Publication Date:** 2022-11-29

The Quiz and Survey Master plugin for WordPress is vulnerable to iFrame Injection via the ‘question[id]’ parameter in versions up to, and including, 8.0.4 due to insufficient input sanitization and output escaping that allowed iframe tags to be injected. This makes it possible for unauthenticated attackers to inject iFrames in pages that will execute whenever a user accesses an injected page.

---

## Simple:Press <= 6.8 – Authenticated (Admin+) Path Traversal to Arbitrary File Modification

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4031](https://www.cve.org/CVERecord?id=CVE-2022-4031)

**CVSS Score:** 3.1 (Low)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to arbitrary file modifications in versions up to, and including, 6.8 via the ‘file’ parameter which does not properly restrict files to be edited in the context of the plugin. This makes it possible with attackers, with high-level permissions such as an administrator, to supply paths to arbitrary files on the server that can be modified outside of the intended scope of the plugin.

---

## Simple:Press <= 6.8 – Authenticated (Subscriber+) Path Traversal to Arbitrary File Deletion

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4030](https://www.cve.org/CVERecord?id=CVE-2022-4030)

**CVSS Score:** 8.1 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Path Traversal in versions up to, and including, 6.8 via the ‘file’ parameter which can be manipulated during user avatar deletion. This makes it possible with attackers, with minimal permissions such as a subscriber, to supply paths to arbitrary files on the server that will subsequently be deleted. This can be used to delete the wp-config.php file that can allow an attacker to configure the site and achieve remote code execution.

---

## Simple:Press <= 6.8 – Reflected Cross-Site Scripting via Cookie Value

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4029](https://www.cve.org/CVERecord?id=CVE-2022-4029)

**CVSS Score:** 4.7 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘sforum\_[md5 hash of the WordPress URL]’ cookie value in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link. This would be highly complex to exploit as it would require the attacker to set the cookie a cookie for the targeted user.

---

## Simple:Press <= 6.8 – Authenticated Stored Cross-Site Scripting via Profile Signatures

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4028](https://www.cve.org/CVERecord?id=CVE-2022-4028)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘postitem’ parameter manipulated during the profile-save action when modifying a profile signature in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping that makes injecting object and embed tags possible. This makes it possible for authenticated attackers, with minimal permissions, such as a subscriber to inject arbitrary web scripts in pages when modifying a profile signature that will execute whenever a user accesses an injected page.

---

## Simple:Press <= 6.8 – Unauthenticated Stored Cross-Site Scripting via Forum Replies

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4027](https://www.cve.org/CVERecord?id=CVE-2022-4027)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘postitem’ parameter manipulated during a forum response in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping that makes injecting object and embed tags possible. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages when responding to forum threads that will execute whenever a user accesses an injected page.

---

## Theme and plugin translation for Polylang <= 3.2.16 – Missing Authorization

**Affected Plugin:** [Theme and plugin translation for Polylang](https://wordpress.org/plugins/theme-translation-for-polylang/)

**Theme Plugin:** theme-translation-for-polylang

**Affected Versions:** <= 3.2.16

**CVE ID:** [CVE-2022-4169](https://www.cve.org/CVERecord?id=CVE-2022-4169)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)

**Researcher/s:** Florent BESNARD

**Fully Patched Version:** 3.2.17

**Recommended Remediation:** Update to version 3.2.17, or newer patched version.

**Publication Date:** 2022-11-28

The Theme and plugin translation for Polylang is vulnerable to authorization bypass in versions up to, and including, 3.2.16 due to missing capability checks in the process\_polylang\_theme\_translation\_wp\_loaded() function. This makes it possible for unauthenticated attackers to update plugin and theme translation settings and to import translation strings.

---

## Betheme <= 26.5.1.4 – Authenticated (Contributor+) PHP Object Injection

**Affected Theme:** [Betheme](https://muffingroup.com/betheme/)

**Theme Slug:** betheme

**Affected Versions:** <= 26.1.4

**CVE ID:** [CVE-2022-3861](https://www.cve.org/CVERecord?id=CVE-2022-3861)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** 26.6

**Recommended Remediation:** Update to version 26.6, or newer patched version.

**Publication Date:** 2022-11-21

The Betheme theme for WordPress is vulnerable to PHP Object Injection in versions up to, and including, 26.5.1.4 via deserialization of untrusted input supplied via the import, mfn-items-import-page, and mfn-items-import parameters passed through the mfn\_builder\_import, mfn\_builder\_import\_page, importdata, importsinglepage, and importfromclipboard functions. This makes it possible for authenticated attackers, with contributor level permissions and above to inject a PHP Object. The additional presence of a POP chain would make it possible for attackers to execute code, retrieve sensitive data, delete files, etc..

---

## SVG Support 2.5  – 2.5.1 – Insecure Plugin Defaults to Cross-Site Scripting

**Affected Plugin:** [SVG Support](https://wordpress.org/plugins/svg-support/)

**Plugin Slug:** svg-support

**Affected Versions:** 2.5 – 2.5.1

**CVE ID:** [CVE-2022-4022](https://www.cve.org/CVERecord?id=CVE-2022-4022)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.5.2

**Recommended Remediation:** Update to version 2.5.2, or newer patched version.

**Publication Date:** 2022-11-16

The SVG Support plugin for WordPress defaults to insecure settings in version 2.5 and 2.5.1. SVG files containing malicious javascript are not sanitized. While version 2.5 adds the ability to sanitize image as they are uploaded, the plugin defaults to disable sanitization and does not restrict SVG upload to only administrators. This allows authenticated attackers, with author-level privileges and higher, to upload malicious SVG files that can be embedded in posts and pages by higher privileged users. Additionally, the embedded JavaScript is also triggered on visiting the image URL, which allows an attacker to execute malicious code in browsers visiting that URL.

---

## Permalink Manager Lite <= 2.2.20.1 – Cross-Site Request Forgery

**Affected Plugin:** [Permalink Manager Lite](https://wordpress.org/plugins/permalink-manager/)

**Plugin Slug:** permalink-manager

**Affected Versions:** <= 2.2.20.1

**CVE ID:** [CVE-2022-4021](https://www.cve.org/CVERecord?id=CVE-2022-4021)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.2.20.2

**Recommended Remediation:** Update to version 2.2.20.2, or newer patched version.

**Publication Date:** 2022-11-16

The Permalink Manager Lite plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.2.20.1. This is due to missing or incorrect nonce validation on the extra\_actions function. This makes it possible for unauthenticated attackers to change plugin settings including permalinks and site maps, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## TeraWallet – For WooCommerce <= 1.4.3 – Insecure Direct Object Reference

**Affected Plugin:** [TeraWallet – For WooCommerce](https://wordpress.org/plugins/woo-wallet/)

**Plugin Slug:** woo-wallet

**Affected Versions:** <= 1.4.3

**CVE ID:** [CVE-2022-3995](https://www.cve.org/CVERecord?id=CVE-2022-3995)

**CVSS Score:** 4.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 1.4.4

**Recommended Remediation:** Update to version 1.4.4, or newer patched version.

**Publication Date:** 2022-11-14

The TeraWallet plugin for WordPress is vulnerable to Insecure Direct Object Reference in versions up to, and including, 1.4.3. This is due to insufficient validation of the user-controlled key on the lock\_unlock\_terawallet AJAX action. This makes it possible for authenticated attackers, with subscriber-level permissions and above, to lock/unlock other users wallets.

---

## Photospace Gallery <= 2.3.5 – Authenticated (Subscriber+) Stored Cross-Site Scripting

**Affected Plugin:** [Photospace Gallery](https://wordpress.org/plugins/photospace)

**Plugin Slug:** photospace

**Affected Versions:** <= 2.3.5

**CVE ID:** [CVE-2022-3991](https://www.cve.org/CVERecord?id=CVE-2022-3991)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The Photospace Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via its settings parameters saved via the update() function in versions up to, and including, 2.3.5 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with subscriber-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Transposh WordPress Translation <= 1.0.8.1 – Authorization Bypass

**Affected Plugin:** [Transposh WordPress Translation](https://wordpress.org/plugins/transposh-translation-filter-for-wordpress)

**Plugin Slug:** transposh-translation-filter-for-wordpress

**Affected Versions:** <= 1.0.8.1

**CVE ID:** [CVE-2022-2536](https://www.cve.org/CVERecord?id=CVE-2022-2536)

**CVSS Score:** 7.5 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The Transposh WordPress Translation plugin for WordPress is vulnerable to unauthorized setting changes by unauthenticated users in versions up to, and including, 1.0.8.1. This is due to insufficient validation of settings on the ‘tp\_translation’ AJAX action which makes it possible for unauthenticated attackers to bypass any restrictions and influence the data shown on the site. Please note this is a separate issue from CVE-2022-2461. Notes from the researcher: When installed Transposh comes with a set of pre-configured options, one of these is the “Who can translate” setting under the “Settings” tab. However, this option is largely ignored, if Transposh has enabled its “autotranslate” feature (it’s enabled by default) and the HTTP POST parameter “sr0” is larger than 0. This is caused by a faulty validation in “wp/transposh\_db.php.”

---

## Feed Them Social – for Twitter feed, Youtube and more <= 2.9.9 – Authenticated (Subscriber+) Stored Cross-Site Scripting

**Affected Plugin:** [Feed Them Social – for Twitter feed, Youtube and more](https://wordpress.org/plugins/feed-them-social/)

**Plugin Slug:** feed-them-social

**Affected Versions:** <= 2.9.9

**CVE ID:** [CVE-2022-2940](https://www.cve.org/CVERecord?id=CVE-2022-2940)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.0.1

**Recommended Remediation:** Update to version 3.0.1, or newer patched version.

**Publication Date:** 2022-11-14

The Feed Them Social plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.9.9. This is due to missing or incorrect nonce validation on various functions such as fts\_instagram\_token\_ajax(). This makes it possible for unauthenticated attackers to trigger settings updates via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Feed Them Social – for Twitter feed, Youtube and more <= 2.9.9 – Cross-Site Request Forgery to Settings Update

**Affected Plugin:** [Feed Them Social – for Twitter feed, Youtube and more](https://wordpress.org/plugins/feed-them-social/)

**Plugin Slug:** feed-them-social

**Affected Versions:** <= 2.9.9

**CVE ID:** [CVE-2022-2942](https://www.cve.org/CVERecord?id=CVE-2022-2942)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.0.1

**Recommended Remediation:** Update to version 3.0.1, or newer patched version.

**Publication Date:** 2022-11-14

The Feed Them Social plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.9.9. This is due to missing or incorrect nonce validation on various functions such as fts\_instagram\_token\_ajax(). This makes it possible for unauthenticated attackers to trigger settings updates via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WordPress Countdown Widget <= 3.1.9.2 – Authenticated (Administrator+) Stored Cross-Site Scripting

**Affected Plugin:** [WordPress Countdown Widget](https://wordpress.org/plugins/wordpress-countdown-widget/)

**Plugin Slug:** wordpress-countdown-widget

**Affected Versions:** <= 3.1.9.2

**CVE ID:** [CVE-2022-2944](https://www.cve.org/CVERecord?id=CVE-2022-2944)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.1.9.3

**Recommended Remediation:** Update to version 3.1.9.3, or newer patched version.

**Publication Date:** 2022-11-14

The WordPress Countdown Widget plugin for WordPress is vulnerable to Stored Cross-Site Scripting via several parameters in versions up to, and including, 3.1.9.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Follow Me Plugin <= 3.1.1 – Cross-Site Request Forgery to Cross-Site Scripting

**Affected Plugin:** [Follow Me Plugin](https://wordpress.org/plugins/follow-me/)

**Plugin Slug:** follow-me

**Affected Versions:** <= 3.1.1

**CVE ID:** [CVE-2022-3240](https://www.cve.org/CVERecord?id=CVE-2022-3240)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The “Follow Me Plugin” plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 3.1.1. This is due to missing nonce validation on the FollowMeIgniteSocialMedia\_options\_page() function. This makes it possible for unauthenticated attackers to modify the plugin’s settings and inject malicious JavaScript via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WP Affiliate Platform <= 6.3.9 – Cross-Site Request Forgery

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3898](https://www.cve.org/CVERecord?id=CVE-2022-3898)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 6.3.9. This is due to missing or incorrect nonce validation on various functions including the affiliates\_menu method. This makes it possible for unauthenticated attackers to delete affiliate records, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WP Affiliate Platform <= 6.3.9 – Authenticated (Administrator+) Stored Cross-Site Scripting

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3897](https://www.cve.org/CVERecord?id=CVE-2022-3897)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Stored Cross-Site Scripting via several parameters in versions up to, and including, 6.3.9 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## WP Affiliate Platform <= 6.3.9 – Reflected Cross-Site Scripting

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3896](https://www.cve.org/CVERecord?id=CVE-2022-3896)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via $\_SERVER[“REQUEST\_URI”] in versions up to, and including, 6.3.9 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link. This is unlikely to work in modern browsers.

---

## Becustom <= 1.0.5.2 – Cross-Site Request Forgery

**Affected Plugin:** [Becustom](https://muffingroup.com/betheme/features/be-custom/)

**Plugin Slug:** becustom

**Affected Versions:** <= 1.0.5.2

**CVE ID:** [CVE-2022-3747](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3747)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** 1.0.5.3

**Recommended Remediation:** Update to version 1.0.5.3, or newer.

**Publication Date:** 2022-11-14

The Becustom plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.0.5.2. This is due to missing nonce validation when saving the plugin’s settings. This makes it possible for unauthenticated attackers to update the plugin’s settings like betheme\_url\_slug, replaced\_theme\_author, and betheme\_label to name a few, via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## VR Calendar <= 2.3.3 – Cross-Site Request Forgery

**Affected Plugin:** [VR Calendar](https://wordpress.org/plugins/vr-calendar-sync/)

**Plugin Slug:** vr-calendar-sync

**Affected Versions:** <= 2.3.3

**CVE ID:** [CVE-2022-3852](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3852)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.3.4

**Recommended Remediation:** Update to version 2.3.4, or newer.

**Publication Date:** 2022-11-03

The VR Calendar plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.3.3. This is due to missing or incorrect nonce validation on several functions. This makes it possible for unauthenticated attackers to delete, and modify calendars as well as the plugin settings, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Restaurant Menu – Food Ordering System – Table Reservation <= 2.3.0 – Missing Authorization on AJAX Actions

**Affected Plugin:** [Restaurant Menu – Food Ordering System – Table Reservation](https://wordpress.org/plugins/menu-ordering-reservations/)

**Plugin Slug:** menu-ordering-reservations

**Affected Versions:** <= 2.3.0

**CVE ID:** [CVE-2022-2696](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2696)

**CVSS Score:** 6.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

**Researcher/s:** ptsfence

**Fully Patched Version:** 2.3.1

**Recommended Remediation:** Update to version 2.3.1, or newer.

**Publication Date:** 2022-10-31

The Restaurant Menu – Food Ordering System – Table Reservation plugin for WordPress is vulnerable to authorization bypass via several AJAX actions in versions up to, and including 2.3.0 due to missing capability checks and missing nonce validation. This makes it possible for authenticated attackers with minimal permissions to perform a wide variety of actions such as modifying the plugin’s settings and modifying the ordering system preferences.

---

## Restaurant Menu – Food Ordering System – Table Reservation <= 2.3.1 – Cross-Site Request Forgery

**Affected Plugin:** [Restaurant Menu – Food Ordering System – Table Reservation](https://wordpress.org/plugins/menu-ordering-reservations/)

**Plugin Slug:** menu-ordering-reservations

**Affected Versions:** <= 2.3.1

**CVE ID:** [CVE-2022-3776](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3776)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** ptsfence

**Fully Patched Version:** 2.3.2

**Recommended Remediation:** Update to version 2.3.2, or newer.

**Publication Date:** 2022-10-31

The Restaurant Menu – Food Ordering System – Table Reservation plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.3.1. This is due to missing or incorrect nonce validation on several functions called via AJAX actions such as forms\_action, set\_option, & chosen\_options to name a few . This makes it possible for unauthenticated attackers to perform a variety of administrative actions like modifying forms, via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Limited Remote Code Execution via um\_populate\_dropdown\_options

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3384](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3384)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to Remote Code Execution in versions up to, and including, 2.5.0 via the populate\_dropdown\_options function that accepts user supplied input and passes it through call\_user\_func(). This is restricted to non-parameter PHP functions like phpinfo(); since user supplied parameters are not passed through the function. This makes it possible for authenticated attackers, with administrative privileges, to execute code on the server.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Remote Code Execution via Multi-Select

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3383](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3383)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to Remote Code Execution in versions up to, and including, 2.5.0 via the get\_option\_value\_from\_callback function that accepts user supplied input and passes it through call\_user\_func(). This makes it possible for authenticated attackers, with administrative capabilities, to execute code on the server.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Contributor+) Directory Traversal via Shortcodes

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3361](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3361)

**CVSS Score:** 4.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to directory traversal in versions up to, and including 2.5.0 due to insufficient input validation on the ‘template’ attribute used in shortcodes. This makes it possible for attackers with administrative privileges to supply arbitrary paths using traversal (../../) to access and include files outside of the intended directory. If an attacker can successfully upload a php file then remote code execution via inclusion may also be possible. Note: for users with less than administrative capabilities, /wp-admin access needs to be enabled for that user in order for this to be exploitable by those users.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Directory Traversal

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-2445](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2445)

**CVSS Score:** 4.7 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to directory traversal in versions up to, and including 2.5.0 due to insufficient input validation on the ‘pack’ parameter. This makes it possible for attackers with administrative privileges to supply arbitrary paths using traversal (../../) to access and include files outside of the intended directory. If an attacker can successfully upload a file with the exact name ‘init.php’ then remote code execution may also be possible.

---

## Web Stories <= 1.24.0 – Server Side Request Forgery

**Affected Plugin:** [Web Stories](https://wordpress.org/plugins/web-stories/)

**Plugin Slug:** web-stories

**Affected Versions:** <= 1.24.0

**CVE ID:** [CVE-2022-3708](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3708)

**CVSS Score:** 9.6 (Critical)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N)

**Researcher/s:** Aymen Borgi

**Fully Patched Version:** 1.25.0

**Recommended Remediation:** Update to version 1.25.0, or newer.

**Publication Date:** 2022-10-26

The Web Stories plugin for WordPress is vulnerable to Server-Side Request Forgery in versions up to, and including 1.24.0 due to insufficient validation of URLs supplied via the ‘url’ parameter found via the /v1/hotlink/proxy REST API Endpoint. This made it possible for authenticated users to make web requests to arbitrary locations originating from the web application and can be used to query and modify information from internal services.

---

## ImageMagick Engine <= 1.7.4 – Cross-Site Request Forgery to Remote Command Execution

**Affected Plugin:** ImageMagick Engine

**Plugin Slug:** imagemagick-engine

**Affected Versions:** <= 1.7.4

**CVE ID:** [CVE-2022-2441](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2441)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Rasoul Jahanshahi

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-10-17

The ImageMagick Engine plugin for WordPress is vulnerable to remote code execution via the ‘cli\_path’ parameter in versions up to, and including 1.7.4. This makes it possible for unauthenticated users to run arbitrary commands leading to remote command execution, granted they can trick a site administrator into performing an action such as clicking on a link. This makes it possible for an attacker to create and or modify files hosted on the server which can easily grant attackers backdoor access to the affected server.

---

## Log HTTP Requests <= 1.3.1 – Stored Cross-Site Scripting

**Affected Plugin:** [Log HTTP Requests](https://wordpress.org/plugins/log-http-requests/)

**Plugin Slug:** log-http-requests

**Affected Versions:** <= 1.3.1

**CVE ID:** [CVE-2022-3402](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3402)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Etan Imanol Castro Aldrete

**Fully Patched Version:** 1.3.2

**Recommended Remediation:** Update to version 1.3.2, or newer.

**Publication Date:** 2022-10-05

The Log HTTP Requests plugin for WordPress is vulnerable to Stored Cross-Site Scripting via logged HTTP requests in versions up to, and including, 1.3.1 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers who can trick a site’s administrator into performing an action like clicking on a link, or an authenticated user with access to a page that sends a request using user-supplied data via the server, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Bricks 1.2 – 1.5.3 – Remote Code Execution

**Affected Theme:** [Bricks](https://bricksbuilder.io/)

**Theme Slug:** bricks

**Affected Versions:** 1.2 to 1.5.3

**CVE ID:** [CVE-2022-3401](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3401)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Anonymous

**Fully Patched Version:** 1.5.4

**Recommended Remediation:** Update to version 1.5.4, or newer.

**Publication Date:** 2022-10-03

The Bricks theme for WordPress is vulnerable to remote code execution due to the theme allowing site editors to include executable code blocks in website content in versions 1.2 to 1.5.3. This, combined with the missing authorization vulnerability (CVE-2022-3400), makes it possible for authenticated attackers with minimal permissions, such as a subscriber, can edit any page, post, or template on the vulnerable WordPress website and inject a code execution block that can be used to achieve remote code execution.

---

## Bricks 1.0 – 1.5.3 – Missing Authorization to Arbitrary Content Creation/Modification

**Affected Theme:** [Bricks](https://bricksbuilder.io/)

**Theme Slug:** bricks

**Affected Versions:** 1.0 – 1.5.3

**CVE ID:** [CVE-2022-3400](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3400)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N)

**Researcher/s:** Anonymous

**Fully Patched Version:** 1.5.4

**Recommended Remediation:** Update to version 1.5.4, or newer.

**Publication Date:** 2022-10-03

The Bricks theme for WordPress is vulnerable to authorization bypass due to a missing capability check on the bricks\_save\_post AJAX action in versions 1.0 to 1.5.3. This makes it possible for authenticated attackers with minimal permissions, such as a subscriber, to edit any page, post, or template on the vulnerable WordPress website.

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


