- **Root cause of vulnerability:** Double-free in the CIFS (Common Internet File System) client within the Linux kernel. The `sess_free_buffer()` function was attempting to zero and free memory that had already been freed by its caller. Specifically, `memzero_explicit()` was being called on `sess_data::iov[1]` after it had already been freed.
- **Weaknesses/vulnerabilities present:** Double-free vulnerability due to incorrect memory management in the `sess_free_buffer()` function. This is a use-after-free condition due to the incorrect zeroing of already freed memory.
- **Impact of exploitation:** A double-free can lead to memory corruption, potentially leading to a crash or a more severe security vulnerability, such as the ability to execute arbitrary code. In this case, the vulnerability was reported as causing a crash.
- **Attack vectors:** The vulnerability is triggered when freeing the session buffer during CIFS authentication (NTLMSSP). The attacker would need to interact with the CIFS client in such a way that would trigger a session creation/deletion that would execute the vulnerable code path.
- **Required attacker capabilities/position:** An attacker needs to have the ability to interact with a CIFS server in a way that triggers the affected code path, such as connecting to a server with NTLMSSP authentication. An attacker might also need local access or be a user who can trigger these actions on a vulnerable system.