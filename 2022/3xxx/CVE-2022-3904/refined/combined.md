=== Content from wpscan.com_e8899dca_20250115_093542.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# MonsterInsights < 8.9.1 - Stored Cross-Site Scripting via Google Analytics

### Description

The plugin does not sanitize or escape page titles in the top posts/pages section, allowing an unauthenticated attacker to inject arbitrary web scripts into the titles by spoofing requests to google analytics.

### Proof of Concept

1. Open a WP page with the plugin and Google analytics installed and search for something that does not exist, let's say ?s=asdf
2. You will see a request being sent to this URL: https://region1.google-analytics.com/g/collect?v=2&tid=G-6S3DZKLR47&gtm=2oe9l0&\_p=381293519&gdid=dZGIzZG&cid=1787612615.1664091952&ul=pl-pl&sr=1440x900&\_z=ccd.v9B&\_s=1&sid=1664091952&sct=1&seg=0&dl=https%3A%2F%2Fwww.bugbountyexplained.com%2F%3Fs%3Dasdf&dt=asdf%20-%20Bug%20Bounty%20Reports%20Explained&en=page\_view&\_fv=1&\_nsi=1&\_ss=1&\_ee=1&ep.forceSSL=true&ep.link\_attribution=true&ep.page\_path=%2F%3Fs%3Dno-results%3Aasdf%26cat%3Dno-results
The dt parameter is the page's title which in this case is, after URL-decoding, asdf - Bug Bounty Reports Explained.
3. Send this request to Burp intruder or your tool of choice
4. Replace the dt parameter with URL-encoded payload. <img src=x onerror=alert(document.domain)> will do if you just want the popup, otherwise, you have to use XSS hunter.
5. Send this request to GA enough times so that it makes the top 10 of you pages ie. if the 10th page on your website has 100 views, send 101 requests, if the 10th page has 1000, send 1001... Also, increment the \_s parameter with each request.
6. Wait 24h - the results in the plugin only show after a day
7. Go to /wp-admin/admin.php?page=monsterinsights\_reports#/ on your website and under the Top Posts/Pages section will be your website with your payload firing.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

google-analytics-for-wordpress](https://a8cteam5105.wordpress.com/plugin/google-analytics-for-wordpress/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 8.9.1

### References

CVE
[CVE-2022-3904](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3904)

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[6.1 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Grzegorz Niedziela

Submitter
Grzegorz Niedziela

Submitter website
<https://www.bugbountyexplained.com/>

Submitter twitter
[https://twitter.com/gregxsunday](//twitter.com/gregxsunday)

Verified
Yes

WPVDB ID
[244d9ef1-335c-4f65-94ad-27c0c633f6ad](https://a8cteam5105.wordpress.com/vulnerability/244d9ef1-335c-4f65-94ad-27c0c633f6ad/)

### Timeline

Publicly Published
2022-12-23 (about 2 years ago)

Added
2022-12-26 (about 2 years ago)

Last Updated
2022-12-26 (about 2 years ago)

### Other

Published
Title

Published
2023-06-30
Title
[My Content Management < 1.7.7 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/a44bc190-307f-4150-8043-63dfa10c1065/)

Published
2021-11-23
Title
[HTML5 Responsive FAQ <= 2.8.5 - Admin+ Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/3caf0de0-57f2-4c87-8713-d00a7db9eeef/)

Published
2023-06-22
Title
[teachPress < 9.0.3 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/c358968f-84de-48b4-9b45-51a38f06f8b2/)

Published
2023-03-20
Title
[Cyberus Key < 1.1 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/af2f85c6-17ac-47a9-97c9-7511e0211a43/)

Published
2025-01-07
Title
[Surbma | Premium WP < 10.0 - Authenticated (Contributor+) Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/91066580-cd5f-45d7-a0da-ecaccb5498a6/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

