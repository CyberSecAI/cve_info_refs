- **Root cause of vulnerability:** The plugin lacks CSRF protection when saving settings and also fails to sanitize and escape user inputs.
- **Weaknesses/vulnerabilities present:**
    - Cross-Site Request Forgery (CSRF) vulnerability allows attackers to modify plugin settings without the user's consent.
    - Stored Cross-Site Scripting (XSS) vulnerability due to insufficient input sanitization and output escaping when rendering the plugin's settings and in frontend page/post where the shortcode is embedded.
-   **Impact of exploitation:** An attacker could execute arbitrary JavaScript code in the context of the victim's browser, potentially leading to:
    - Account takeover
    - Data theft
    - Defacement of the website.
-   **Attack vectors:**
    -   CSRF attack via a malicious HTML page or link that exploits a logged-in admin user's session to change the settings.
    -   XSS payload is injected in plugin settings that are stored in database and then triggered when viewing the settings page or frontend page/post.
-   **Required attacker capabilities/position:**
    -   The attacker needs to trick a logged-in administrator into visiting a malicious page, typically using social engineering techniques.
    -   The attacker doesn't need prior access or privileges on the target website, as the attack relies on the administrator's session.