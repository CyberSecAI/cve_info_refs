=== Content from packetstormsecurity.com_1ddded19_20250114_232529.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from wpscan.com_9c667b4f_20250114_232533.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Translatepress Multilinugal < 2.3.3 - Admin+ SQLi

### Description

The plugin is vulnerable to an authenticated SQL injection. By adding a new language (via the settings page) containing specific special characters, the backticks in the SQL query can be surpassed and a time-based blind payload can be injected.

### Proof of Concept

To exploit the vulnerability, someone must send a specifically crafted request adding a new language containing specific special characters, and then open another page and measure the response time to retrieve data. This can be automated via sqlmap.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

translatepress-multilingual](https://a8cteam5105.wordpress.com/plugin/translatepress-multilingual/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.3.3

### References

CVE
[CVE-2022-3141](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3141)

URL
<https://github.com/ehtec/translatepress-exploit>

URL
[https://medium.com/@elias.hohl/authenticated-sql-injection-vulnerability-in-translatepress-multilingual-wordpress-plugin-effc08eda514](https://medium.com/%40elias.hohl/authenticated-sql-injection-vulnerability-in-translatepress-multilingual-wordpress-plugin-effc08eda514)

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[6.8 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Elias Hohl

Submitter
Elias Hohl

Submitter website
<https://ehtec.co>

Submitter twitter
[EliasHohl](//twitter.com/EliasHohl)

Verified
Yes

WPVDB ID
[1fa355d1-cca8-4b27-9d21-0b420a2e1bf3](https://a8cteam5105.wordpress.com/vulnerability/1fa355d1-cca8-4b27-9d21-0b420a2e1bf3/)

### Timeline

Publicly Published
2022-07-23 (about 2 years ago)

Added
2022-09-06 (about 2 years ago)

Last Updated
2022-09-06 (about 2 years ago)

### Other

Published
Title

Published
2024-04-12
Title
[Realtyna Organic IDX plugin < 4.14.8 - Unauthenticated SQLi](https://a8cteam5105.wordpress.com/vulnerability/d22a60bc-b9c6-4a26-97cc-8e6ec0a15c1b/)

Published
2014-08-01
Title
[Zingiri Web Shop - Cookie SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/0149e7c7-6848-419c-9fef-fb4f62dd4f2e/)

Published
2024-02-02
Title
[SP Project & Document Manager < 4.70 - Authenticated (Contributor+) SQL Injection via Shortcode](https://a8cteam5105.wordpress.com/vulnerability/083e2909-7e74-42e6-af32-cfaea6e36829/)

Published
2023-06-05
Title
[Responsive CSS EDITOR <= 1.0 - Admin+ SQLi](https://a8cteam5105.wordpress.com/vulnerability/c0f73781-be7e-482e-91de-ad7991ad4bd5/)

Published
2024-01-12
Title
[PDF Invoices & Packing Slips for WooCommerce < 3.7.6 - Shop Manager+ SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/694832d6-8af9-4cc8-8e85-2e2f557a3aed/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from medium.com_3c27cbab_20250114_232531.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feffc08eda514&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fauthenticated-sql-injection-vulnerability-in-translatepress-multilingual-wordpress-plugin-effc08eda514&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fauthenticated-sql-injection-vulnerability-in-translatepress-multilingual-wordpress-plugin-effc08eda514&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Authenticated SQL injection vulnerability in “Translatepress Multilingual” Wordpress plugin

[![Elias Hohl](https://miro.medium.com/v2/resize:fill:88:88/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---byline--effc08eda514--------------------------------)

[Elias Hohl](/%40elias.hohl?source=post_page---byline--effc08eda514--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd2ad5aa4f9df&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40elias.hohl%2Fauthenticated-sql-injection-vulnerability-in-translatepress-multilingual-wordpress-plugin-effc08eda514&user=Elias+Hohl&userId=d2ad5aa4f9df&source=post_page-d2ad5aa4f9df--byline--effc08eda514---------------------post_header-----------)

5 min read·Jul 23, 2022

--

Listen

Share

While investigating Wordpress plugins, I stumbled upon “Translatepress Multilingual”, which is used to make Wordpress pages available in multiple languages and has 200,000 active installations.

[## Translate Multilingual sites - TranslatePress

### Experience a better way to translate your WordPress site and go multilingual, directly from the front-end using a…

wordpress.org](https://wordpress.org/plugins/translatepress-multilingual/?source=post_page-----effc08eda514--------------------------------)[## WordPress Translation Plugin - TranslatePress

### A WordPress translation plugin that anyone can use. Experience a better way of translating your WordPress site, with…

translatepress.com](https://translatepress.com/?source=post_page-----effc08eda514--------------------------------)

It is not so easy to find SQL injections in Wordpress plugins, as wordpress has a feature called “magic quotes”, which means it automatically applies the `addslashes` PHP function to all GET and POST input, escaping quotes and backslashes. Therefore, many of the classic SQL injection attacks cannot work against wordpress, as it is impossible to break out of quotes. Still, there are some scenarios when user input is not surrounded by quotes, for example when it is supposed to be an integer. Today, we will have a closer look at another case.

In the Translatepress source code, there are a couple of functions that look like this:

The language code taken from the input parsed by a function called `get_table_name` and in addition to the magic quotes protection, we also have to bypass `sanitize_text_field` .

The language code is prefixed with a constant string and a filter is applied. However, I could not find this filter, so this seems to have no effect.

When looking at the SQL query, you can see that the table name is only surrounded by backticks. However, neither `sanitize_text_field` nor the magic quotes escape backticks.

I fired up a brand new Wordpress instance using `docker-compose` as described in this tutorial: <https://docs.docker.com/samples/wordpress/>. If you want to try this, make sure to also use a new Wordpress instance, as the exploit will mess up your database.

I installed and activated the at the time latest version of Translatepress Multilingual, 2.3.2. Then, I went to the Translatepress settings page, added a random language, English (UK), and intercepted the request with Burp Suite. Time to start injecting some payloads!

I started with ``x=%23` , where `%23` refers to `#` , which is needed to comment out the rest of the query. This should trigger an error if we can escape the backticks.

![]()

And yes, we can see a couple of SQL syntax errors flooding the window where we ran `sudo docker-compose up` :

![]()

We can see from these errors that our payload gets inserted into multiple statements, namely `CREATE TABLE` , `CREATE_INDEX` and `CREATE FULLTEXT INDEX` . However, these commands seemed uncommon to achieve a useful SQL injection attack vector, so I kept looking.

I went to the “Pages” section, opened “Sample Page” and clicked “Translate”. An editor opened up where I could translate strings, and I noticed more error messages in the Wordpress log.

![]()

Note that this happened without submitting another payload. My previous payload got inserted in some other statements, e.g. `SELECT` . As we can control the full SQL query after the table name, I concluded it should be easy to utilize a time-based payload.

I copied the POST request that adds a language from Burp Suite to `translatepress_req.txt` :

![]()

I also copied the GET request where we can execute the payload in a `SELECT` statement to `translatepress_req_2.txt` :

![]()

Time to launch `sqlmap` to execute a so-called second-order attack (because we have different pages for submitting the payload and viewing the result). This is the right command to use, specifying a few non-default option to speed up the detection:

```
sqlmap -r translatepress_req.txt -p trp_settings%5Btranslation-languages%5D%5B%5D — dbms=mysql — second-req translatepress_req_2.txt — technique=T — level 5 — risk 3 — fresh-queries
```
![]()

Now it is possible to use `sqlmap` at the full extent to download tables, for example the `wp_users` table, or do whatever is possible in the context of your database configuration.

It might also be possible to exploit this vulnerability using a boolean-based blind or UNION technique. It did not work out of the box, probably because the payload is inserted in many statements and breaks at least one of the queries that are necessary to show proper output. I did not spend much time trying to improve this, as I already had a time-based PoC.

This exploit can only be executed by an authenticated user, as you need to add a new language. I don’t know the Translatepress ecosystem well enough to know if only the administrator can add languages, or also some other roles. This might also depend on installed addons and custom configurations.

It is also worth noting that above PoC might need to be modified a little when the Pro version of Translatepress is attacked. Both Pro and Free are vulnerable, as the code responsible for the sanitization is the same, but I have not actually tried this yet with a Pro installation.

Shortly after I reported this vulnerability to the vendor, they released a patched update (version 2.3.3) which is using a regular expression to block malicious language codes.

The vulnerability has been assigned CVE-2022–3141.

You can find this exploit also on Github:

[## GitHub - ehtec/translatepress-exploit: Authenticated SQL injection vulnerability in "Translatepress…

### Authenticated SQL injection vulnerability in "Translatepress Multilingual" Wordpress plugin - GitHub …

github.com](https://github.com/ehtec/translatepress-exploit?source=post_page-----effc08eda514--------------------------------)

If you want to read about more vulnerabilities I discover, make sure you follow me on LinkedIn, Medium & Twitter:

[## Elias Hohl | Linktree

### Cybersecurity Expert | Developer | Physicist

linktr.ee](https://linktr.ee/eliashohl?source=post_page-----effc08eda514--------------------------------)

If you run a company and are looking for an expert to make sure your web applications are secure, feel free to send an email to elias.hohl@ehtec.co to receive an offer.

[Sql Injection](/tag/sql-injection?source=post_page-----effc08eda514--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----effc08eda514--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----effc08eda514--------------------------------)[Wordpress Plugins](/tag/wordpress-plugins?source=post_page-----effc08eda514--------------------------------)[Exploit](/tag/exploit?source=post_page-----effc08eda514--------------------------------)

--

--

[![Elias Hohl](https://miro.medium.com/v2/resize:fill:96:96/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---post_author_info--effc08eda514--------------------------------)[![Elias Hohl](https://miro.medium.com/v2/resize:fill:128:128/1*nxGt_NshDaYQSvCTt14RaQ.png)](/%40elias.hohl?source=post_page---post_author_info--effc08eda514--------------------------------)Follow[## Written by Elias Hohl](/%40elias.hohl?source=post_page---post_author_info--effc08eda514--------------------------------)[27 Followers](/%40elias.hohl/followers?source=post_page---post_author_info--effc08eda514--------------------------------)·[2 Following](/%40elias.hohl/following?source=post_page---post_author_info--effc08eda514--------------------------------)

CEO CryptoSearchTools | IPhO Gold medalist & Austrian national trainer | Cybersecurity expert

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----effc08eda514--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----effc08eda514--------------------------------)[About](/about?autoplay=1&source=post_page-----effc08eda514--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----effc08eda514--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----effc08eda514--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----effc08eda514--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----effc08eda514--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----effc08eda514--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----effc08eda514--------------------------------)[Teams](/business?source=post_page-----effc08eda514--------------------------------)


