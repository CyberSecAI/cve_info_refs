Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the usage of unfiltered `request.params` instead of `safe_params` when generating a link on the "Maximum page reached" page in GitLab. This allows an attacker to inject arbitrary parameters, specifically `protocol` and `host` into the URL.

**Weaknesses/Vulnerabilities:**

*   **Cross-site Scripting (XSS):** By injecting a `javascript:` URL through the `protocol` and `host` parameters, an attacker can execute arbitrary JavaScript code in the victim's browser when the "Back to page" link is clicked.
*   **Inadequate Input Validation:** The application fails to properly sanitize or filter user-provided parameters, specifically within `request.params`, which is used to construct the URL for the back button.

**Impact of Exploitation:**

*   An attacker can execute arbitrary JavaScript on the victim's browser, enabling them to perform actions on behalf of the user within the GitLab instance. This could include:
    *   Data exfiltration: Stealing sensitive information or cookies
    *   Session hijacking: Taking over a user's session
    *   Phishing: Redirecting the user to a malicious page
    *   Altering content: Displaying fake messages or other information

**Attack Vectors:**

*   **Malicious URL:** The attacker crafts a malicious URL with injected parameters (`protocol=javascript`, `host=%250dalert(document.domain)//`), which when a victim navigates to it they will be presented with a "Maximum page reached" page with a malicious back button.
*   **User Interaction:** The victim must click on the "Back to page" link for the injected JavaScript to execute, thus a form of "click-jacking" is a requirement of the exploit.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to craft a URL with the malicious parameters and get a victim to navigate to it.
*   The vulnerability is more likely to be successfully exploited on self-hosted GitLab instances that do not have strict Content Security Policy (CSP) configurations.
*   The attacker does not need any special privileges on the instance to perform this attack.