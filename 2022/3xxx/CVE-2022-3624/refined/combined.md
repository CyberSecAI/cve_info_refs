=== Content from git.kernel.org_7886a80c_20250114_211504.html ===


| [cgit logo](/) | [index](/) : [kernel/git/klassert/ipsec-next.git](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/) | master testing |
| --- | --- | --- |
| Steffen Klassert's ipsec-next networking tree | Steffen Klassert |

| [about](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/about/)[summary](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/)[refs](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/refs/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)[log](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/log/)[tree](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/tree/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)[commit](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/commit/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)[diff](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/diff/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)[stats](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jay Vosburgh <jay.vosburgh@canonical.com> | 2022-08-10 22:06:53 -0700 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2022-08-11 08:51:05 -0700 |
| commit | [4f5d33f4f798b1c6d92b613f0087f639d9836971](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/commit/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971) ([patch](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/patch/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)) | |
| tree | [2ddaf199ed0da9b8e670ba44f50c69134f74994d](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/tree/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971) | |
| parent | [ae7107baa5bde3cea62778fd4515865fe50181f4](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/commit/?id=ae7107baa5bde3cea62778fd4515865fe50181f4) ([diff](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/diff/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971&id2=ae7107baa5bde3cea62778fd4515865fe50181f4)) | |
| download | [ipsec-next-4f5d33f4f798b1c6d92b613f0087f639d9836971.tar.gz](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/snapshot/ipsec-next-4f5d33f4f798b1c6d92b613f0087f639d9836971.tar.gz) | |

bonding: fix reference count leak in balance-alb modeCommit d5410ac7b0ba ("net:bonding:support balance-alb interface
with vlan to bridge") introduced a reference count leak by not releasing
the reference acquired by ip\_dev\_find(). Remedy this by insuring the
reference is released.
Fixes: d5410ac7b0ba ("net:bonding:support balance-alb interface with vlan to bridge")
Signed-off-by: Jay Vosburgh <jay.vosburgh@canonical.com>
Reviewed-by: Nikolay Aleksandrov <razor@blackwall.org>
Link: [https://lore.kernel.org/r/26758.1660194413@famine](https://lore.kernel.org/r/26758.1660194413%40famine)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/diff/?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)

| -rw-r--r-- | [drivers/net/bonding/bond\_alb.c](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/diff/drivers/net/bonding/bond_alb.c?id=4f5d33f4f798b1c6d92b613f0087f639d9836971) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/bonding/bond\_alb.c b/drivers/net/bonding/bond\_alb.cindex 60cb9a0225aa6d..b9dbad3a8af822 100644--- a/[drivers/net/bonding/bond\_alb.c](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/tree/drivers/net/bonding/bond_alb.c?id=ae7107baa5bde3cea62778fd4515865fe50181f4)+++ b/[drivers/net/bonding/bond\_alb.c](/pub/scm/linux/kernel/git/klassert/ipsec-next.git/tree/drivers/net/bonding/bond_alb.c?id=4f5d33f4f798b1c6d92b613f0087f639d9836971)@@ -668,8 +668,11 @@ static struct slave \*rlb\_arp\_xmit(struct sk\_buff \*skb, struct bonding \*bond)  dev = ip\_dev\_find(dev\_net(bond->dev), arp->ip\_src); if (dev) {- if (netif\_is\_bridge\_master(dev))+ if (netif\_is\_bridge\_master(dev)) {+ dev\_put(dev); return NULL;+ }+ dev\_put(dev); }  if (arp->op\_code == htons(ARPOP\_REPLY)) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:13:42 +0000


