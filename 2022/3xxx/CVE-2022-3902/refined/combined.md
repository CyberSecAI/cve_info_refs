=== Content from gitlab.com_84352579_20250114_214327.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Webhook secret tokens leaked in webhook logs

**[HackerOne report #1757999](https://hackerone.com/reports/1757999)** by `joaxcar` on 2022-11-01, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

#### Summary

Since this issue [#359989 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/359989 "Hide secret tokens in webhook settings form") was merged webhook secrets are hidden for maintainers of a project after they are saved. The UI and API gives no way of retrieving the secret after configuration. Just like hidden tokens in integrations. The issue states

> Use type="password" for the Secret token field input. We also have to make sure that the values are not exposed to the frontend

After the fix the input field only show a line of dots when trying to edit a webhook. But the webhook logs at the same page still contains the secret in plain text.

The docs states this about the secret

> You can specify a secret token to validate received payloads. The token is sent with the hook request in the X-Gitlab-Token HTTP header. Your webhook endpoint can check the token to verify that the request is legitimate.

This change to the input field of the UI was made intentionally to hide the secret from other maintainers (as they do not necessarily have access to the receiving service). The leaked token (LOW confidentiality) gives an unauthorized other maintainer the ability to spoof requests to the receiving server (LOW integrity). And the impacted service is the receiving service (Scope changed). This was my rating of this, feel free to edit it as see fit!

#### Steps to reproduce

1. Log in to gitlab
2. Create a new project
3. Go to <https://gitlab.com/GROUP/PROJECT/-/hooks> and configure a webhook. Make sure to add a secret
4. Click save
5. Scroll to the bottom of the page to the list of configured hooks.
6. Click edit on the new hook
7. You can now see that the secret is hidden
8. Scroll down and click "test", a test call will be made to the hook
9. Bellow the hook info there should now be a log entry, click the log entry
10. Scroll to the bottom of the log page to the request headers, there is the secret in plain text

#### Impact

The UI leaks secret tokens that should not be accessible after configuration

#### What is the current *bug* behavior?

Secret token headers are shown in webhook logs

#### What is the expected *correct* behavior?

The secret token header should be redacted in the logs

#### Relevant logs and/or screenshots

[![secret.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2f8efa39276788abd3f1fbef9a1178769986b174/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63343066323937612d633561312d343561642d626164322d3361613134646435613231392f7365637265742e706e67)

[![token.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/762db5580a6d960d2860d1e4481a9c401a7782c2/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35356366633635622d313636642d343739662d613438662d6132343365633538303766372f746f6b656e2e706e67)

#### Output of checks

This bug happens on GitLab.com

#### Impact

The UI leaks secret tokens that should not be accessible after configuration, allowing unauthorised maintainers to use the token

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [secret.png](https://h1.sec.gitlab.net/a/c40f297a-c5a1-45ad-bad2-3aa14dd5a219/secret.png)
* [token.png](https://h1.sec.gitlab.net/a/55cfc65b-166d-479f-a48f-a243ec5807f7/token.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_409a4d75_20250114_214326.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-3902.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-3902.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-3902.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-3902.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 20, 2023

  [6cf4af7e](/gitlab-org/cves/-/commit/6cf4af7e99ac4e35f59b0f511032a3a530ce6200)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/6cf4af7e99ac4e35f59b0f511032a3a530ce6200)
  ·
  6cf4af7e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 20, 2023

  6cf4af7e

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/6cf4af7e99ac4e35f59b0f511032a3a530ce6200)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 20, 2023

Loading


