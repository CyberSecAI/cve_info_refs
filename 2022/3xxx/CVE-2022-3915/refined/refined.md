- **Root cause of vulnerability:** The Dokan plugin fails to properly sanitize and escape a parameter before using it in a SQL query.
- **Weaknesses/vulnerabilities present:** SQL Injection (SQLi)
- **Impact of exploitation:** An attacker can execute arbitrary SQL queries, potentially leading to data exfiltration, modification, or deletion. In this specific example, the PoC demonstrates a time-based blind SQL injection using `SLEEP(5)`.
- **Attack vectors:** The vulnerability is accessed via an HTTP request to `wp-admin/admin-ajax.php` with the `dokan_json_search_products_and_variations` action. The `term` parameter is vulnerable to SQL injection.
- **Required attacker capabilities/position:** An unauthenticated user can exploit the vulnerability by crafting malicious requests to the vulnerable endpoint. The attacker needs to obtain a valid nonce value first, but this is available on the "Store List" page.