```
{
  "CVE-2022-3344": {
    "Metadata": {
      "CWE": "CWE-440",
      "Description": "A flaw was found in the KVM's AMD nested virtualization (SVM). A malicious L1 guest could purposely fail to intercept the shutdown of a cooperative nested guest (L2), possibly leading to a page fault and kernel panic in the host (L0).",
      "Severity": "Moderate"
    },
    "Root cause": "The `kvm_vcpu_reset` function resets the `vcpu->arch.hflags` without properly leaving the nested state, which leads to an inconsistent state of the vCPU.",
    "Vulnerabilities": [
      "Use-after-free in the SVM code when `svm_free_nested` frees the vmcb02 while it is still in use.",
       "Inconsistent vCPU state after reset due to not leaving nested mode."
    ],
    "Impact": "A malicious L1 guest can cause a kernel panic in the host (L0).",
    "Attack vector": "A malicious L1 guest can trigger a shutdown condition in a nested L2 guest which is not intercepted by L1.",
    "Attacker capabilities": "The attacker needs to control the L1 guest and the ability to trigger a shutdown within a nested L2 guest.",
    "Affected component": "KVM's AMD nested virtualization (SVM)",
        "Affected configurations": "Nested virtualization with AMD SVM"
  }
}
```