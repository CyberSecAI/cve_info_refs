```json
{
  "related_to_cve": true,
  "description": "A vulnerability exists in GitLab where retrying a job in a downstream pipeline allows the retrying user to take ownership of all the skipped jobs in any upstream pipeline, regardless of their permissions on the upstream project. This occurs because the `reset_source_bridge` method in `Ci::Pipeline` does not check the user's permissions in the upstream project before reassigning jobs.",
  "root_cause": "The `reset_source_bridge` method in `Ci::Pipeline` reassigns jobs in the upstream pipeline to the user retrying a job in the downstream pipeline without checking if the user has the necessary permissions to execute pipelines in the upstream project.",
  "vulnerabilities": [
    "Privilege escalation by granting CI execution rights in an upstream project to anyone with CI execution rights in a downstream project.",
     "Lack of permission checks when reassigning jobs across pipelines."
  ],
  "impact": "Users with CI permissions in a downstream project can gain control over jobs in upstream pipelines, potentially leading to unauthorized execution of CI jobs and other unintended consequences. For example, a user could take ownership of SaaS deployments, causing them to fail if the user lacks the required permissions to take actions normally performed by the release bot.",
    "attack_vectors": [
        "Retrying a failed job in a downstream pipeline that is triggered by an upstream pipeline.",
        "The vulnerability is triggered when the `reset_source_bridge` method is called during the retrying process."
    ],
  "attacker_capabilities": "The attacker needs to have CI execution permissions in a downstream project that is triggered by an upstream pipeline. They need to be able to retry a failed job in the downstream pipeline."
}
```