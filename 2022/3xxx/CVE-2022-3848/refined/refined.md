- **Root cause of vulnerability**: The plugin does not properly sanitize and escape the `wpsu_user_id` parameter before using it in a SQL query.
- **Weaknesses/vulnerabilities present**: SQL Injection (SQLi).
- **Impact of exploitation**: An attacker can inject arbitrary SQL queries, potentially leading to data exfiltration, modification, or denial of service. The provided proof of concept demonstrates a time-based blind SQLi vulnerability that can be used to test and exfiltrate data.
- **Attack vectors**: The vulnerability is exploited through an HTTP POST request to the `/wp-admin/admin-ajax.php` endpoint, with the `action` parameter set to `wpsu_get_user_assets` and the vulnerable `wpsu_user_id` parameter containing the SQL injection payload.
- **Required attacker capabilities/position**: The attacker needs to have at least admin level access to the WordPress site. They also need to enable the "Make User List Searchable (AJAX Based)" option in the plugin's settings before exploiting the SQLi.