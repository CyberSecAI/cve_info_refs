=== Content from discuss.hashicorp.com_eebe0cee_20250114_181955.html ===


[HashiCorp Discuss](/)

# [HCSEC-2022-26 - Nomad’s Event Stream Subscriber Using ACL Token with TTL Receive Updates Until Garbage Collected](/t/hcsec-2022-26-nomad-s-event-stream-subscriber-using-acl-token-with-ttl-receive-updates-until-garbage-collected/46168)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 28, 2022, 4:00pm

1

**Bulletin ID:** HCSEC-2022-26

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.4.0 up to 1.4.1; fixed in 1.4.2.

**Publication Date:** October 28, 2022

**Summary**

A vulnerability was identified in Nomad and Nomad Enterprise (“Nomad”) such that an event stream subscriber using an ACL token with an expiry TTL set would continue to receive events until the token was garbage collected. This vulnerability, CVE-2022-3867, was fixed in Nomad 1.4.2.

**Background**

Nomad’s [event stream](https://developer.hashicorp.com/nomad/api-docs/events) provides a way to subscribe to Job, Allocation, Evaluation, Deployment, and Node changes in near real time. Whenever a state change occurs in Nomad’s Finite State Machine (FSM) a set of events for each updated object are created.

**Details**

During internal testing it was observed that an ACL token with an expiry TTL set would continue to receive events until the token was garbage collected. This behavior may be used by a malicious operator or third party with authenticated access to continue to receive events beyond the time limit their token should be allowed to.

Nomad’s ACL token TTL verification logic has been modified to authorize the subscriber’s ACL token before sending each event down the stream.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.4.2, or newer.

See Nomad’s [Upgrading](https://www.nomadproject.io/docs/upgrade) for general guidance on this process.

**Acknowledgement**

This issue was identified by the Nomad engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Nomad 1.4.2, 1.3.7, and 1.2.14 released](https://discuss.hashicorp.com/t/nomad-1-4-2-1-3-7-and-1-2-14-released/46127)  [Release Notifications](/c/release-notifications/57) [nomad-release](https://discuss.hashicorp.com/tag/nomad-release) | 0 | 396 | October 27, 2022 |
| [HCSEC-2023-22 - Nomad Search API Leaks Information About CSI Plugins](https://discuss.hashicorp.com/t/hcsec-2023-22-nomad-search-api-leaks-information-about-csi-plugins/56272)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5700 | July 19, 2023 |
| [HCSEC-2023-21 - Nomad Caller ACL Token's Secret ID is Exposed to Sentinel](https://discuss.hashicorp.com/t/hcsec-2023-21-nomad-caller-acl-tokens-secret-id-is-exposed-to-sentinel/56271)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5589 | July 19, 2023 |
| [HCSEC-2023-08 - Nomad Job Submitter Privilege Escalation Using Workload Identity](https://discuss.hashicorp.com/t/hcsec-2023-08-nomad-job-submitter-privilege-escalation-using-workload-identity/51389)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 5258 | March 13, 2023 |
| [HCSEC-2023-13 - Nomad Unauthenticated Client Agent HTTP Request Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2023-13-nomad-unauthenticated-client-agent-http-request-privilege-escalation/52375)  [Security](/c/security/52) | 0 | 6042 | April 5, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


