The provided content relates to CVE-2022-3231.

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper sanitization of user-supplied input in the `title`, `notes`, and `recurring_day` fields within the scheduled maintenance feature of LibreNMS. Specifically, these fields were not being escaped before being displayed, allowing for the injection of malicious HTML.

**Weaknesses/vulnerabilities present:**
Cross-Site Scripting (XSS) vulnerability. The application was vulnerable to stored XSS, due to insufficient sanitization of user-provided data before rendering it in the UI.

**Impact of exploitation:**
An attacker could inject malicious JavaScript code that would be executed in the context of other users' browsers when they viewed the affected pages. This could lead to various malicious actions, including:
*   Session hijacking
*   Data theft
*   Redirecting users to malicious sites
*   Defacement of the application

**Attack vectors:**
An attacker could exploit this vulnerability by crafting a malicious payload and storing it in the `title`, `notes`, or `recurring_day` fields of a scheduled maintenance entry. When other users view this maintenance entry, the malicious script would be executed.

**Required attacker capabilities/position:**
The attacker needs to have the ability to create/modify scheduled maintenance entries. This likely means they need to be an authenticated user of the LibreNMS application with sufficient privileges.

**Additional details:**

*   The fix involves using `htmlentities()` to properly escape the `title`, `notes` and `recurring_day` fields.
*   The related commit on Github is 08050020861230ff96a6507b309cc172a9e70af8
*   The vulnerability was reported on huntr.dev, specifically with bounty id `bcb6ee68-1452-4fdb-932a-f1031d10984f`.