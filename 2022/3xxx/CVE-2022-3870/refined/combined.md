=== Content from gitlab.com_ac7858e6_20250114_193525.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users' avatar disclosure by user ID in enterprise and public GitLab instances (IDOR)

**[HackerOne report #1753423](https://hackerone.com/reports/1753423)** by `nocasis` on 2022-10-27, assigned to [@nmalcolm](/nmalcolm "Nick Malcolm"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

IDOR vulnerability allows downloading user avatars by their ID in enterprise and public GitLab instances without authorization which leads to privacy violations.

###### Vulnerable API request: [https://gitlab.com/uploads/-/system/user/avatar/{user\_id}/avatar.png](https://gitlab.com/uploads/-/system/user/avatar/%7Buser_id%7D/avatar.png)

##### Steps to reproduce

1. log in to your GitLab account and open the profile's user settings (<https://gitlab.com/-/profile>),
2. upload an avatar for your profile,
3. find your user ID in the profile settings (<https://gitlab.com/-/profile>) or on the main page with your profile activity (`https://gitlab.com/{account_name}`),
4. perform the following request in any tool(curl/burp/python/any browser) with the specified user ID and without any cookie or token: `https://gitlab.com/uploads/-/system/user/avatar/{user_id}/avatar.png`,
5. in the response you will see your avatar,
6. change the user ID in a vulnerable request to get the avatar of another person.

Since <https://gitlab.com> is a public service, it's not really interesting. But this vulnerability exists in **private**(**enterprise**) GitLab instances.

##### Steps to reproduce in enterprise instances

To reproduce the bug, you need to have your own GitLab instance. You need to replace `{company_domain}` with your GitLab domain in the following instruction.

1. iterate through user IDs (e.g. 1,2,3,...) with `https://{company_domain}/uploads/-/system/user/avatar/{user_id}/avatar.png` endpoint,
2. in responses you will see:
   * avatars of users, which can be corporate photos of people,
   * or status code 404 if the user didn't specify the profile avatar,
   * or status code 404 if the user does not exist.

##### Impact

An attacker can iterate through user IDs and get their avatars without authorization even in enterprise GitLab instances.

This can lead to the following consequences:

* An attacker can find more information about employees through their leaked avatars, primarily if photos were used and this is often the case in enterprise systems.
* An attacker can find out the number of engineers in the company.

##### Examples

You can see my avatar with that link: `https://gitlab.com/uploads/-/system/user/avatar/1323720/avatar.png`

##### What is the current *bug* behavior?

We can see users' avatars without authorization by a direct link with a guessable user ID even in enterprise GitLab instances.

##### What is the expected *correct* behavior?

At least in enterprise GitLab instances, an attacker must not see any company's private information(number of people, their private avatars) without authorization.

##### Relevant logs and/or screenshots

Example of request and response with an avatar.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/c997d9760ee5a655bc785263bf0237260a8836c0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66356432306363332d333565382d343266342d616339662d3363376165663466623330642f696d6167652e706e67)

#### Impact

An attacker can iterate through user IDs and get their avatars without authorization even in enterprise GitLab instances.

This can lead to the following consequences:

* An attacker can find more information about employees through their leaked avatars, primarily if photos were used and this is often the case in enterprise systems.
* An attacker can find out the number of engineers in the company.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/f5d20cc3-35e8-42f4-ac9f-3c7aef4fb30d/image.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_1f60d6d7_20250114_193524.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-3870.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-3870.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-3870.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-3870.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 10, 2023

  [bfe600ef](/gitlab-org/cves/-/commit/bfe600efbff650967277a5816b0065670964b84f)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/bfe600efbff650967277a5816b0065670964b84f)
  ·
  bfe600ef

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 10, 2023

  bfe600ef

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/bfe600efbff650967277a5816b0065670964b84f)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 10, 2023

Loading


