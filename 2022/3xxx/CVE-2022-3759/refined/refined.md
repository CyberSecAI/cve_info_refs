```json
{
  "vulnerability": {
    "root_cause": "The vulnerability lies in how GitLab processes CI job artifact zip files, specifically when handling dynamic child pipelines. The system validates the reported uncompressed size from the zip file's metadata but does not enforce the actual uncompressed size during extraction. This discrepancy allows an attacker to bypass the size checks.",
    "weaknesses": [
      "Insufficient validation of the actual uncompressed size of files extracted from zip archives.",
      "Reliance on metadata provided within the zip file without re-validation during file extraction.",
      "Use of `Zip::File#read` which does not check the entry sizes as opposed to `Zip::Entry#extract`.",
      "Lack of proper resource limits when reading data from zip files"
    ],
    "impact": "An attacker can cause a denial-of-service (DoS) by triggering an out-of-memory (OOM) kill on the Sidekiq worker. This occurs because the system attempts to allocate memory based on a tampered 'uncompressed size' value within the zip file metadata.",
    "attack_vectors": [
        "Upload a specially crafted zip file containing a large file with a small compressed size but a large uncompressed size specified in the metadata",
        "Trigger a CI pipeline that uses dynamic child pipelines, thus activating the vulnerable code path for artifact processing."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to create or modify CI pipelines and upload artifacts to a GitLab project. They require access to a GitLab instance with dynamic child pipelines enabled.",
    "details": "The `Gitlab::Ci::ArtifactFileReader` validates file size based on the `total_size` property of the artifact metadata. This property is derived from the zip file's metadata, which can be manipulated by an attacker. The system uses `Zip::File#read` to extract the file, which does not validate the actual extracted size against the reported uncompressed size. The vulnerable code tries to buffer the large file into memory, causing the OOM kill if the uncompressed file size exceeds the server's resources."
  }
}
```