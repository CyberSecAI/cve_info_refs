=== Content from git.kernel.org_1440c25b_20250114_204911.html ===


| [cgit logo](/) | [index](/) : [kernel/git/gregkh/char-misc.git](/pub/scm/linux/kernel/git/gregkh/char-misc.git/) | char-misc-linus char-misc-next char-misc-testing main master |
| --- | --- | --- |
| Char/Misc drivers development tree | Greg Kroah-Hartman |

| [about](/pub/scm/linux/kernel/git/gregkh/char-misc.git/about/?h=char-misc-next)[summary](/pub/scm/linux/kernel/git/gregkh/char-misc.git/?h=char-misc-next)[refs](/pub/scm/linux/kernel/git/gregkh/char-misc.git/refs/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)[log](/pub/scm/linux/kernel/git/gregkh/char-misc.git/log/?h=char-misc-next)[tree](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)[commit](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)[diff](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)[stats](/pub/scm/linux/kernel/git/gregkh/char-misc.git/stats/?h=char-misc-next) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Al Viro <viro@zeniv.linux.org.uk> | 2022-08-23 11:53:39 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-01 16:18:49 +0200 |
| commit | [9d64d2405f7d30d49818f6682acd0392348f0fdb](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb) ([patch](/pub/scm/linux/kernel/git/gregkh/char-misc.git/patch/?id=9d64d2405f7d30d49818f6682acd0392348f0fdb)) | |
| tree | [6d8cb5c4bbb9f09467672410dec0ce8fadf8c8fe](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb) | |
| parent | [eaf271ea844b8dea5256bd3c73e642ef13ce68a2](/pub/scm/linux/kernel/git/gregkh/char-misc.git/commit/?h=char-misc-next&id=eaf271ea844b8dea5256bd3c73e642ef13ce68a2) ([diff](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb&id2=eaf271ea844b8dea5256bd3c73e642ef13ce68a2)) | |
| download | [char-misc-9d64d2405f7d30d49818f6682acd0392348f0fdb.tar.gz](/pub/scm/linux/kernel/git/gregkh/char-misc.git/snapshot/char-misc-9d64d2405f7d30d49818f6682acd0392348f0fdb.tar.gz) | |

binderfs: rework superblock destructionSo far we relied on
.put\_super = binderfs\_put\_super()
to destroy info we stashed in sb->s\_fs\_info. This gave us the required ordering
between ->evict\_inode() and sb->s\_fs\_info destruction.
But the current implementation of binderfs\_fill\_super() has a memory leak in
the rare circumstance that d\_make\_root() fails because ->put\_super() is only
called when sb->s\_root is initialized. Fix this by removing ->put\_super() and
simply do all that work in binderfs\_kill\_super().
Reported-by: Dongliang Mu <mudongliangabcd@gmail.com>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
Signed-off-by: Christian Brauner (Microsoft) <brauner@kernel.org>
Link: [https://lore.kernel.org/r/20220823095339.853371-1-brauner@kernel.org](https://lore.kernel.org/r/20220823095339.853371-1-brauner%40kernel.org)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)

| -rw-r--r-- | [drivers/android/binderfs.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/diff/drivers/android/binderfs.c?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb) | 30 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 17 insertions, 13 deletions

| diff --git a/drivers/android/binderfs.c b/drivers/android/binderfs.cindex 44939ea1874f26..09b2ce7e4c3458 100644--- a/[drivers/android/binderfs.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/drivers/android/binderfs.c?h=char-misc-next&id=eaf271ea844b8dea5256bd3c73e642ef13ce68a2)+++ b/[drivers/android/binderfs.c](/pub/scm/linux/kernel/git/gregkh/char-misc.git/tree/drivers/android/binderfs.c?h=char-misc-next&id=9d64d2405f7d30d49818f6682acd0392348f0fdb)@@ -339,22 +339,10 @@ static int binderfs\_show\_options(struct seq\_file \*seq, struct dentry \*root) return 0; } -static void binderfs\_put\_super(struct super\_block \*sb)-{- struct binderfs\_info \*info = sb->s\_fs\_info;-- if (info && info->ipc\_ns)- put\_ipc\_ns(info->ipc\_ns);-- kfree(info);- sb->s\_fs\_info = NULL;-}- static const struct super\_operations binderfs\_super\_ops = { .evict\_inode = binderfs\_evict\_inode, .show\_options = binderfs\_show\_options, .statfs = simple\_statfs,- .put\_super = binderfs\_put\_super, };  static inline bool is\_binderfs\_control\_device(const struct dentry \*dentry)@@ -784,11 +772,27 @@ static int binderfs\_init\_fs\_context(struct fs\_context \*fc) return 0; } +static void binderfs\_kill\_super(struct super\_block \*sb)+{+ struct binderfs\_info \*info = sb->s\_fs\_info;++ /\*+ \* During inode eviction struct binderfs\_info is needed.+ \* So first wipe the super\_block then free struct binderfs\_info.+ \*/+ kill\_litter\_super(sb);++ if (info && info->ipc\_ns)+ put\_ipc\_ns(info->ipc\_ns);++ kfree(info);+}+ static struct file\_system\_type binder\_fs\_type = { .name = "binder", .init\_fs\_context = binderfs\_init\_fs\_context, .parameters = binderfs\_fs\_parameters,- .kill\_sb = kill\_litter\_super,+ .kill\_sb = binderfs\_kill\_super, .fs\_flags = FS\_USERNS\_MOUNT, }; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:47:48 +0000



=== Content from git.kernel.org_9d0c85d3_20250114_204911.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dongliang Mu <mudongliangabcd@gmail.com> | 2022-05-06 15:24:25 +0800 |
| --- | --- | --- |
| committer | Jiri Kosina <jkosina@suse.cz> | 2022-05-06 10:46:36 +0200 |
| commit | [fc4ef9d5724973193bfa5ebed181dba6de3a56db](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)) | |
| tree | [d72e367f8d76596c65a45e7e6acb537b7f3bab51](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db) | |
| parent | [1af20714fedad238362571620be0bd690ded05b6](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1af20714fedad238362571620be0bd690ded05b6) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db&id2=1af20714fedad238362571620be0bd690ded05b6)) | |
| download | [linux-fc4ef9d5724973193bfa5ebed181dba6de3a56db.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-fc4ef9d5724973193bfa5ebed181dba6de3a56db.tar.gz) | |

HID: bigben: fix slab-out-of-bounds Write in bigben\_probeThere is a slab-out-of-bounds Write bug in hid-bigbenff driver.
The problem is the driver assumes the device must have an input but
some malicious devices violate this assumption.
Fix this by checking hid\_device's input is non-empty before its usage.
Reported-by: syzkaller <syzkaller@googlegroups.com>
Signed-off-by: Dongliang Mu <mudongliangabcd@gmail.com>
Signed-off-by: Jiri Kosina <jkosina@suse.cz>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)

| -rw-r--r-- | [drivers/hid/hid-bigbenff.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/hid/hid-bigbenff.c?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/drivers/hid/hid-bigbenff.c b/drivers/hid/hid-bigbenff.cindex 74ad8bf98bfd5a..e8c5e3ac9fff15 100644--- a/[drivers/hid/hid-bigbenff.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/hid/hid-bigbenff.c?id=1af20714fedad238362571620be0bd690ded05b6)+++ b/[drivers/hid/hid-bigbenff.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/hid/hid-bigbenff.c?id=fc4ef9d5724973193bfa5ebed181dba6de3a56db)@@ -347,6 +347,12 @@ static int bigben\_probe(struct hid\_device \*hid, bigben->report = list\_entry(report\_list->next, struct hid\_report, list); + if (list\_empty(&hid->inputs)) {+ hid\_err(hid, "no inputs found\n");+ error = -ENODEV;+ goto error\_hw\_stop;+ }+ hidinput = list\_first\_entry(&hid->inputs, struct hid\_input, list); set\_bit(FF\_RUMBLE, hidinput->input->ffbit); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:47:49 +0000



=== Content from git.kernel.org_38d17f53_20250114_204911.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dongliang Mu <mudongliangabcd@gmail.com> | 2022-06-09 08:35:28 +0100 |
| --- | --- | --- |
| committer | Mauro Carvalho Chehab <mchehab@kernel.org> | 2022-06-20 10:30:37 +0100 |
| commit | [945a9a8e448b65bec055d37eba58f711b39f66f0](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=945a9a8e448b65bec055d37eba58f711b39f66f0) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)) | |
| tree | [a2e5b35c020d8bb997c8a69c1a0ed900686fdccf](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=945a9a8e448b65bec055d37eba58f711b39f66f0) | |
| parent | [5b9b598453d3ae5fa66d7ab591008373a89b91a0](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=5b9b598453d3ae5fa66d7ab591008373a89b91a0) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=945a9a8e448b65bec055d37eba58f711b39f66f0&id2=5b9b598453d3ae5fa66d7ab591008373a89b91a0)) | |
| download | [linux-945a9a8e448b65bec055d37eba58f711b39f66f0.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-945a9a8e448b65bec055d37eba58f711b39f66f0.tar.gz) | |

media: pvrusb2: fix memory leak in pvr\_probeThe error handling code in pvr2\_hdw\_create forgets to unregister the
v4l2 device. When pvr2\_hdw\_create returns back to pvr2\_context\_create,
it calls pvr2\_context\_destroy to destroy context, but mp->hdw is NULL,
which leads to that pvr2\_hdw\_destroy directly returns.
Fix this by adding v4l2\_device\_unregister to decrease the refcount of
usb interface.
Reported-by: syzbot+77b432d57c4791183ed4@syzkaller.appspotmail.com
Signed-off-by: Dongliang Mu <mudongliangabcd@gmail.com>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Mauro Carvalho Chehab <mchehab@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=945a9a8e448b65bec055d37eba58f711b39f66f0)

| -rw-r--r-- | [drivers/media/usb/pvrusb2/pvrusb2-hdw.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/media/usb/pvrusb2/pvrusb2-hdw.c?id=945a9a8e448b65bec055d37eba58f711b39f66f0) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/media/usb/pvrusb2/pvrusb2-hdw.c b/drivers/media/usb/pvrusb2/pvrusb2-hdw.cindex a9666373af6b94..92d6db1ad00f53 100644--- a/[drivers/media/usb/pvrusb2/pvrusb2-hdw.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/media/usb/pvrusb2/pvrusb2-hdw.c?id=5b9b598453d3ae5fa66d7ab591008373a89b91a0)+++ b/[drivers/media/usb/pvrusb2/pvrusb2-hdw.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/media/usb/pvrusb2/pvrusb2-hdw.c?id=945a9a8e448b65bec055d37eba58f711b39f66f0)@@ -2610,6 +2610,7 @@ struct pvr2\_hdw \*pvr2\_hdw\_create(struct usb\_interface \*intf, del\_timer\_sync(&hdw->encoder\_run\_timer); del\_timer\_sync(&hdw->encoder\_wait\_timer); flush\_work(&hdw->workpoll);+ v4l2\_device\_unregister(&hdw->v4l2\_dev); usb\_free\_urb(hdw->ctl\_read\_urb); usb\_free\_urb(hdw->ctl\_write\_urb); kfree(hdw->ctl\_read\_buffer); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:47:48 +0000


