=== Content from www.mozilla.org_d875bec4_20250114_192457.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-28

## Security Vulnerabilities fixed in Firefox 103

Announced
July 26, 2022
Impact
moderate
Products
Firefox
Fixed in

* Firefox 103

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36317: Long URL would hang Firefox for Android](#CVE-2022-36317)

Reporter
Irwan
Impact
moderate
##### Description

When visiting a website with an overly long URL, the user interface would start to hang. Due to session restore, this could lead to a permanent Denial of Service.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1759951](https://bugzilla.mozilla.org/show_bug.cgi?id=1759951)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-36315: Preload Cache Bypasses Subresource Integrity](#CVE-2022-36315)

Reporter
Hiroshige Hayashizaki
Impact
low
##### Description

When loading a script with Subresource Integrity, attackers with an injection capability could trigger the reuse of previously cached entries with incorrect, different integrity metadata.

##### References

* [Bug 1762520](https://bugzilla.mozilla.org/show_bug.cgi?id=1762520)

#### [#CVE-2022-36316: Performance API leaked whether a cross-site resource is redirecting](#CVE-2022-36316)

Reporter
Jannis Rautenstrauch
Impact
low
##### Description

When using the Performance API, an attacker was able to notice subtle differences between PerformanceEntries and thus learn whether the target URL had been subject to a redirect.

##### References

* [Bug 1768583](https://bugzilla.mozilla.org/show_bug.cgi?id=1768583)

#### [#CVE-2022-36320: Memory safety bugs fixed in Firefox 103](#CVE-2022-36320)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1759794%2C1760998)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_f4a3f339_20250114_192456.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1768583)
* [XML](/show_bug.cgi?ctype=xml&id=1768583)

Closed
[Bug 1768583](/show_bug.cgi?id=1768583)
(CVE-2022-36316)

Opened 3 years ago
Closed 3 years ago

# Fetch requests with mode cors and credentials leak whether the request redirected or not via performanceAPI

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Fetch requests with mode cors and credentials leak whether the request redirected or not via performanceAPI

## Categories

### (Core :: Performance, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Performance#Performance)

Performance
▾

Core :: Performance
User reports of Firefox performance issues, and bugs about Firefox performance issues where the correct component is not yet known.
The goal for bugs in this component is to identify the source of the performance issue, and to move the bug into the the right Bugzilla component where the fix needs to happen.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Performance&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Performance&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Performance)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 100

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

103 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox101 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=wontfix) |
| firefox102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix) |
| firefox103 | [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr102 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox101 |  | wontfix |
| firefox102 |  | wontfix |
| firefox103 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jannis, Assigned: sefeng)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/be236acca6c457384ec52ed3205531dd?d=mm&size=40)  [jannis](/user_profile?user_id=692537)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/3436c2d3cc76cfdad85dd8460e33b2d6?d=mm&size=40)  [fdoty](/user_profile?user_id=697742)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1770001](/show_bug.cgi?id=1770001 "RESOLVED FIXED - Update our TAO check function to align spec updates")

[xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")

Dependency [tree](/showdependencytree.cgi?id=1768583&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1768583)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-29915](/show_bug.cgi?id=1751678 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API")

## Details

### (Keywords: csectype-disclosure, sec-low, Whiteboard: [adv-main103+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-36316

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main103+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a3885184_551058 "3 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [fetch\_leak.html](/attachment.cgi?id=9275797)  [3 years ago](#c0)  [jannis](/user_profile?user_id=692537)   1.70 KB, text/html |  | [Details](/attachment.cgi?id=9275797&action=edit) |
| --- | --- | --- |
| [Bug 1768583 - Allow having a PerformanceResourceTiming entry for cross origin redirects r=#necko](/attachment.cgi?id=9276922)  [3 years ago](#c4)  [Sean Feng [:sefeng]](/user_profile?user_id=625922)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9276922&action=edit) | [Review](/attachment.cgi?id=9276922) |
| [Bug 1768583 - Fix misconfigured custom-cors-response.js r=#necko](/attachment.cgi?id=9276923)  [3 years ago](#c5)  [Sean Feng [:sefeng]](/user_profile?user_id=625922)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9276923&action=edit) | [Review](/attachment.cgi?id=9276923) |
| [Bug 1768583 - Update preload-error.sub.html.ini based on recent changes on PerformanceResourceTiming r=#necko](/attachment.cgi?id=9276924)  [3 years ago](#c6)  [Sean Feng [:sefeng]](/user_profile?user_id=625922)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9276924&action=edit) | [Review](/attachment.cgi?id=9276924) |
| [advisory.txt](/attachment.cgi?id=9286177)  [2 years ago](#c9)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   271 bytes, text/plain |  | [Details](/attachment.cgi?id=9286177&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [jannis](/user_profile?user_id=692537)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1768583#c0)• 3 years ago |
|  | |

Attached file
[fetch\_leak.html](attachment.cgi?id=9275797)
— [Details](attachment.cgi?id=9275797&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:100.0) Gecko/20100101 Firefox/100.0

Steps to reproduce:

1. Perform a fetch request to a cross-origin URL that redirects (mode: "cors", credentials: "include")
2. Check the outcome of `performanceAPI.getEntriesByName(redirect_url)`
3. Perform a fetch request to a cross-origin URL that does not redirect (mode: "cors", credentials: "include")
4. Check the outcome of `performanceAPI.getEntriesByName(no_redirect_url)`

Open the attached HTML document for an interactive example.

Actual results:

The browser does not create an performanceAPI entry for URLs that redirect, the browser creates an performanceAPI entry for URLs that do not redirect.

With this method one can perform XS-Leaks if a URL only redirects depending on some user state. While cross-origin redirects can also be detected using other methods (e.g., CSP and securitypolicyviolation), this method can also detects same-origin redirects.

Expected results:

No redirect information should be leaked cross-origin.

Either no entry should be created for both URLs (the behavior in WebKit), or a default entry should be created for both URLs (the behavior in Chromium).

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1768583#c1)• 3 years ago |
|  | |

Sean, is this still your wheelhouse?

Group: firefox-core-security → dom-core-securityComponent: Untriaged → PerformanceFlags: needinfo?(sefeng)Product: Firefox → CoreSee Also: → [CVE-2022-29915](/show_bug.cgi?id=1751678 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API")

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1768583#c2)• 3 years ago |
|  | |

Yeah it is, sorry I am being slow

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a51922_625922)• 3 years ago |

Assignee: nobody → sefeng

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a138542_1689)• 3 years ago |

Blocks: [xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1768583#c3)• 3 years ago |
|  | |

Apparently we don't [report entries](https://searchfox.org/mozilla-central/rev/b72e9d7d63bf499d1d8168291b93d4ec7fde236e/netwerk/protocol/http/HttpBaseChannel.cpp#4612) if it's a cross origin redirect.

I think with the latest Fetch integration, an opaque entry should be created for cross origin redirects. I'll make a patch for it.

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1768583#c4)• 3 years ago |
|  | |

Attached file
[Bug 1768583 - Allow having a PerformanceResourceTiming entry for cross origin redirects r=#necko](attachment.cgi?id=9276922)
— [Details](attachment.cgi?id=9276922&action=edit)

According to the latest Fetch spec, we should generate a opaque

PerformanceResourceTiming entry for cross origin redirects, rather than

not generating it at all.

Plus the timings for cross-origin redirects won't be leaked unless all

redirects pass the TAO check.

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1768583#c5)• 3 years ago |
|  | |

Attached file
[Bug 1768583 - Fix misconfigured custom-cors-response.js r=#necko](attachment.cgi?id=9276923)
— [Details](attachment.cgi?id=9276923&action=edit)

Credit goes to jgraham.

When running related tests, Firefox should load the file rather than

downloading it. However, it looks like we don't provide a

content-type for the file, so Firefox misinterprets the file.

Depends on D146580

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1768583#c6)• 3 years ago |
|  | |

Attached file
[Bug 1768583 - Update preload-error.sub.html.ini based on recent changes on PerformanceResourceTiming r=#necko](attachment.cgi?id=9276924)
— [Details](attachment.cgi?id=9276924&action=edit)

We used to not generating a PerformanceResourceTiming entry for

cross-origin redirects. And this makes some of the tests in

preload-error.sub.html to fail because the tests check the number

of entries.

Since we now start to generate these entries, the tests start to pass.

Depends on D146581

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a725906_625922)• 3 years ago |

Blocks: [1770001](/show_bug.cgi?id=1770001 "RESOLVED FIXED - Update our TAO check function to align spec updates")

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a740208_625922)• 3 years ago |

Flags: needinfo?(sefeng)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1768583#c7)• 3 years ago |
|  | |

Allow having a PerformanceResourceTiming entry for cross origin redirects r=necko-reviewers,dragana

<https://hg.mozilla.org/integration/autoland/rev/c93567bc36adb8282b775e05c8a0b965806469e9>

<https://hg.mozilla.org/mozilla-central/rev/c93567bc36ad>

Fix misconfigured custom-cors-response.js r=necko-reviewers,dragana

<https://hg.mozilla.org/integration/autoland/rev/baf4f0d7c0a0f4496bbb439e59c23fa22c50dcb1>

<https://hg.mozilla.org/mozilla-central/rev/baf4f0d7c0a0>

Update preload-error.sub.html.ini based on recent changes on PerformanceResourceTiming r=necko-reviewers,kershaw

<https://hg.mozilla.org/integration/autoland/rev/b78f7a65d677b396e1544f43210109df58a8d498>

<https://hg.mozilla.org/mozilla-central/rev/b78f7a65d677>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 103 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a3330556_75935)• 3 years ago |

[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=wontfix)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a3885184_551058)• 3 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1768583#c8)• 3 years ago |
|  | |

Similarly to [bug 1770001](/show_bug.cgi?id=1770001 "RESOLVED FIXED - Update our TAO check function to align spec updates"), this improves user privacy, however it's not that important, so we don't need to uplift it to 102.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a5486742_75935)• 3 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=-)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a6051042_428608)• 2 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main103+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a6051223_428608)• 2 years ago |

QA Whiteboard: [post-critsmash-triage][adv-main103+] → [post-critsmash-triage]Whiteboard: [adv-main103+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1768583#c9)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9286177)
— [Details](attachment.cgi?id=9286177&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a6136466_428608)• 2 years ago |

Alias: CVE-2022-36316

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1768583#a21765453_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1768583&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [jannis](/user_profile?user_id=692537)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


