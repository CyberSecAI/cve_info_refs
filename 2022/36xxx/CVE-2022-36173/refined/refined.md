The provided content is related to CVE-2022-36173.

**Root cause of vulnerability:**
The FreshService Agent software disables TLS certificate validation, allowing a Man-in-the-Middle (MitM) attacker to intercept and modify network traffic.

**Weaknesses/vulnerabilities present:**
- Improper TLS certificate validation (CWE-295) in FreshService Agent. The software overrides the HTTPS certificate check, accepting self-signed or invalid certificates.
- Hardcoded secrets (static SECRET_KEY and _salt) used for checksum calculation. These secrets can be easily extracted through reverse engineering of the CSharp code.
- Improper validation of integrity check value (CWE-354) due to usage of static secrets.

**Impact of exploitation:**
- Information disclosure: The agent sends device details, including sensitive information, which can be exposed to an attacker if the user is connected through an untrusted network.
- Remote code execution: The vulnerability allows an attacker to push malicious software updates and execute arbitrary code with root/SYSTEM privileges on the victim machine by spoofing update server responses.

**Attack vectors:**
- Man-in-the-middle (MitM) attack: An attacker positioned on the network can intercept traffic between the FreshService Agent and its server. This is especially feasible in public WiFi environments.
- Modification of update packages: Due to missing TLS verification and static secrets for checksum, the attacker can modify the update packages and trick the agent to download and execute malicious code.

**Required attacker capabilities/position:**
- Network access: The attacker must be able to intercept network traffic between the vulnerable agent and its server.
- Ability to perform MitM attacks: The attacker needs to set up a TLS interception proxy to intercept and modify communications.
- Ability to reverse engineer .NET applications to extract the hardcoded secrets.