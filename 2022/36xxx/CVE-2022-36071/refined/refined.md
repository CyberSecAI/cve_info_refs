Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2022-36071:

**Root Cause:**

The vulnerability stems from the ability to generate recovery codes for Two-Factor Authentication (TOTP) in SFTPGo before actually enabling two-factor authentication on the user's account.

**Weaknesses/Vulnerabilities:**

- **Premature Recovery Code Generation:** Recovery codes could be created before 2FA was enabled. This breaks the intended security mechanism.
- **Bypassing 2FA:** The generated recovery codes can be used to bypass 2FA after it has been enabled.

**Impact of Exploitation:**

- **Unauthorized Access:** An attacker who knows a user's password can generate recovery codes and use them to bypass the 2FA protection, gaining unauthorized access to the user's account.

**Attack Vectors:**

- **Password Compromise:** The attack requires the attacker to know the user's password.
- **Web Interface:** The recovery codes are generated through the SFTPGo web interface (WebAdmin/WebClient).

**Required Attacker Capabilities/Position:**

- **Valid User Credentials:** The attacker needs to know the username and password of a valid SFTPGo user.
- **Access to SFTPGo Web Interface:** The attacker needs to be able to access the SFTPGo WebAdmin or WebClient interface.

**Additional Notes:**

- The vulnerability was present in SFTPGo versions from v2.2.0 to v2.3.3.
- The vulnerability is fixed in v2.3.4.
- The fix involves restricting recovery code generation to only after two-factor authentication has been enabled and deleting recovery codes when 2FA is disabled.
- A workaround is to regenerate recovery codes after enabling two-factor authentication.
- The issue was tracked in GitHub issue #965.