- **Root cause of vulnerability:** Stack overflow in the `ap_version_check` function due to insecure use of `sscanf` with a greedy matching format specifier `%[^;]`.
- **Weaknesses/vulnerabilities present:** Stack overflow, format string vulnerability via `sscanf`. The `sscanf` function uses the format specifier `%[^;]` which reads all characters until a semicolon, without proper bounds checking which causes a stack buffer overflow when input exceeds the buffer size.
- **Impact of exploitation:** An attacker can achieve a stable root shell and cause a denial-of-service (DoS) by sending a crafted payload.
- **Attack vectors:** Sending a crafted HTTP POST request to `/goform/aspForm` with the `CMD=ap_version_check` and a long string in the `param` field, which overflows the buffer in the `ap_version_check` function.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the device's web interface. No authentication is mentioned, suggesting that the vulnerability is accessible without prior authorization.