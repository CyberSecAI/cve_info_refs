=== Content from jira.xwiki.org_cde89304_20250114_205437.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19549)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19549)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19549](/browse/XWIKI-19549)

# Page content, object properties and title leak on fully private wiki with xpages on the login action

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19549 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.2](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.2 "14.2 "), [13.10.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.4 "13.10.4 ")
* **Affects Version/s:**
  1.1.1
* **Component/s:**
  [Old Core](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Old+Core%22 "Old Core ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_guest](/issues/?jql=labels+%3D+attacker_guest "attacker_guest")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  High
* **Difficulty:**
  Unknown
* **Documentation:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-8h89-34w2-jpfm>
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

* Make the wiki fully closed, i.e., check "Prevent unregistered users from viewing pages, regardless of the page rights" and the similar checkbox for editing in the rights administration.
* Go to <server>/xwiki/bin/login/Main/?xpage=view

**Expected result:**

You are redirected to login.

**Actual result:**

The page including title and content are displayed.

Note that this applies to any page but no sheets are applied. This also works with xpage=preview and xpage=print.

This issue most likely affects all versions of XWiki, I was able to reproduce on XWiki Enterprise 1.1.1, the oldest version that has a demo package available.

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19576](/browse/XWIKI-19576)
XWikiPreferences vanish on newly created subwikis

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-21553](/browse/XWIKI-21553)
Document overwrite from edit through Rights UI

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

is duplicated by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-18602](/browse/XWIKI-18602)
Dataleak on fully-private Wiki on Delete page

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-8h89-34w2-jpfm)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

22/Mar/22 14:28

Updated:

21/Nov/23 18:20

Resolved:

25/Mar/22 13:29

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from github.com_66b30392_20250114_205434.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19549: Disallow template override for login, register and skin

[Browse files](/xwiki/xwiki-platform/tree/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb)
Browse the repository at this point in the history

```
* Also do not put a document without view rights into the context.
```

* Loading branch information

[![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Mar 24, 2022

1 parent
[3b50f39](/xwiki/xwiki-platform/commit/3b50f391880cced50129666a0fb0dc25a8ac3354)

commit 71a6d0b

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**99 additions**
and
**26 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki

  + xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java
    [XWiki.java](#diff-da4c9f1d1dde6d89b84570874b4444f9ba12b296ca5dcca2953c5cf18078856d)
  + web

    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginAction.java
      [LoginAction.java](#diff-31ab8b47ad11ea26a40688503d8b0d930512992c876bf1b9e9e9c7d201cc14dd)
    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginErrorAction.java
      [LoginErrorAction.java](#diff-b1ef515fb09414a79267fbbcacf0406cb2887dcd8980ebff099949cf6f1c2baf)
    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginSubmitAction.java
      [LoginSubmitAction.java](#diff-c96dbc7a376069c5806007178c906cd3787197b06cc0bcd3cb94cc019c2d4c77)
    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java
      [RegisterAction.java](#diff-b93c4776f99dcf87c89153a4f265aa20c43eb9e78fdc6c2e5ca1bb40ad70a8be)
    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/SkinAction.java
      [SkinAction.java](#diff-baba2759ba5250ab221575eaa172c2b5dc5d20084cbe0223b500771aa19ea9bc)

## There are no files selected for viewing

52 changes: 31 additions & 21 deletions

52
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java](#diff-da4c9f1d1dde6d89b84570874b4444f9ba12b296ca5dcca2953c5cf18078856d "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5917,31 +5917,41 @@ && getRightService().hasAccessLevel("view", XWikiRightService.GUEST\_USER\_FULLNAM |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | context.put("doc", doc); |
|  |  | context.put("cdoc", doc); |
|  |  | vcontext.put("doc", doc.newDocument(context)); |
|  |  | vcontext.put("cdoc", vcontext.get("doc")); |
|  |  | XWikiDocument tdoc; |
|  |  |  |
|  |  | // If the parameter language exists and is empty, it means we want to force loading the regular document |
|  |  | // not a translation. This should be handled later by doing a better separation between locale used in the UI |
|  |  | // and for loading the documents. |
|  |  | if ("".equals(context.getRequest().getParameter("language"))) { |
|  |  | tdoc = doc; |
|  |  | if (!"skin".equals(context.getAction()) && !this.getRightService().hasAccessLevel("view", |
|  |  | user.getFullName(), doc.getFullName(), context)) { |
|  |  | // If for some reason (e.g., login action) the user has rights for the action but no view right on the |
|  |  | // document, do not load the document into the context. |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | doc = context.getDoc(); |
|  |  | context.put("tdoc", doc); |
|  |  | context.put("cdoc", doc); |
|  |  | } else { |
|  |  | tdoc = doc.getTranslatedDocument(context); |
|  |  | } |
|  |  | context.put("doc", doc); |
|  |  | context.put("cdoc", doc); |
|  |  | vcontext.put("doc", doc.newDocument(context)); |
|  |  | vcontext.put("cdoc", vcontext.get("doc")); |
|  |  | XWikiDocument tdoc; |
|  |  |  |
|  |  | // If the parameter language exists and is empty, it means we want to force loading the regular document |
|  |  | // not a translation. This should be handled later by doing a better separation between locale used in the UI |
|  |  | // and for loading the documents. |
|  |  | if ("".equals(context.getRequest().getParameter("language"))) { |
|  |  | tdoc = doc; |
|  |  | } else { |
|  |  | tdoc = doc.getTranslatedDocument(context); |
|  |  | } |
|  |  |  |
|  |  | try { |
|  |  | String rev = (String) context.get("rev"); |
|  |  | if (StringUtils.isNotEmpty(rev)) { |
|  |  | tdoc = getDocument(tdoc, rev, context); |
|  |  | try { |
|  |  | String rev = (String) context.get("rev"); |
|  |  | if (StringUtils.isNotEmpty(rev)) { |
|  |  | tdoc = getDocument(tdoc, rev, context); |
|  |  | } |
|  |  | } catch (Exception ex) { |
|  |  | // Invalid version, just use the most recent one |
|  |  | } |
|  |  | } catch (Exception ex) { |
|  |  | // Invalid version, just use the most recent one |
|  |  | context.put("tdoc", tdoc); |
|  |  | vcontext.put("tdoc", tdoc.newDocument(context)); |
|  |  | } |
|  |  | context.put("tdoc", tdoc); |
|  |  | vcontext.put("tdoc", tdoc.newDocument(context)); |
|  |  |  |
|  |  | return true; |
|  |  | } |
| Expand Down | |  |

16 changes: 15 additions & 1 deletion

16
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginAction.java](#diff-31ab8b47ad11ea26a40688503d8b0d930512992c876bf1b9e9e9c7d201cc14dd "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,6 +37,8 @@ |
|  |  | @Singleton |
|  |  | public class LoginAction extends XWikiAction |
|  |  | { |
|  |  | private static final String LOGIN = "login"; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Default constructor. |
|  |  | \*/ |
| Expand All | | @@ -45,6 +47,18 @@ public LoginAction() |
|  |  | this.waitForXWikiInitialization = false; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public boolean action(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!LOGIN.equals(Utils.getPage(context.getRequest(), LOGIN))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | String.format("Template may not be overriden with 'xpage' in [%s] action.", LOGIN)); |
|  |  | } |
|  |  |  |
|  |  | return super.action(context); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String render(XWikiContext context) throws XWikiException |
|  |  | { |
| Expand All | | @@ -53,6 +67,6 @@ public String render(XWikiContext context) throws XWikiException |
|  |  | if (!"1".equals(context.getRequest().getParameter("loginLink"))) { |
|  |  | context.getResponse().setStatus(401); |
|  |  | } |
|  |  | return "login"; |
|  |  | return LOGIN; |
|  |  | } |
|  |  | } |

16 changes: 15 additions & 1 deletion

16
[...latform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginErrorAction.java](#diff-b1ef515fb09414a79267fbbcacf0406cb2887dcd8980ebff099949cf6f1c2baf "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginErrorAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginErrorAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,9 +37,23 @@ |
|  |  | @Singleton |
|  |  | public class LoginErrorAction extends XWikiAction |
|  |  | { |
|  |  | private static final String LOGIN = "login"; |
|  |  |  |
|  |  | @Override |
|  |  | public boolean action(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!LOGIN.equals(Utils.getPage(context.getRequest(), LOGIN))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | String.format("Template may not be overriden with 'xpage' in [%s] action.", LOGIN)); |
|  |  | } |
|  |  |  |
|  |  | return super.action(context); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String render(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | return "login"; |
|  |  | return LOGIN; |
|  |  | } |
|  |  | } |

16 changes: 15 additions & 1 deletion

16
[...atform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginSubmitAction.java](#diff-c96dbc7a376069c5806007178c906cd3787197b06cc0bcd3cb94cc019c2d4c77 "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginSubmitAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/LoginSubmitAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,13 +42,27 @@ |
|  |  | @Singleton |
|  |  | public class LoginSubmitAction extends XWikiAction |
|  |  | { |
|  |  | private static final String LOGIN = "login"; |
|  |  |  |
|  |  | @Override |
|  |  | public boolean action(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!LOGIN.equals(Utils.getPage(context.getRequest(), LOGIN))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | String.format("Template may not be overriden with 'xpage' in [%s] action.", LOGIN)); |
|  |  | } |
|  |  |  |
|  |  | return super.action(context); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String render(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | String msg = (String) context.get("message"); |
|  |  | if (StringUtils.isNotBlank(msg)) { |
|  |  | context.getResponse().setStatus(HttpServletResponse.SC\_FORBIDDEN); |
|  |  | } |
|  |  | return "login"; |
|  |  | return LOGIN; |
|  |  | } |
|  |  | } |

6 changes: 6 additions & 0 deletions

6
[...-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java](#diff-b93c4776f99dcf87c89153a4f265aa20c43eb9e78fdc6c2e5ca1bb40ad70a8be "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -62,6 +62,12 @@ public boolean action(XWikiContext context) throws XWikiException |
|  |  | XWikiRequest request = context.getRequest(); |
|  |  | XWikiResponse response = context.getResponse(); |
|  |  |  |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!REGISTER.equals(Utils.getPage(context.getRequest(), REGISTER))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | String.format("Template may not be overriden with 'xpage' in [%s] action.", REGISTER)); |
|  |  | } |
|  |  |  |
|  |  | String register = request.getParameter(REGISTER); |
|  |  | if (register != null && register.equals("1")) { |
|  |  | // CSRF prevention |
| Expand Down | |  |

19 changes: 17 additions & 2 deletions

19
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/SkinAction.java](#diff-baba2759ba5250ab221575eaa172c2b5dc5d20084cbe0223b500771aa19ea9bc "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/SkinAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/SkinAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -66,6 +66,7 @@ |
|  |  | @Singleton |
|  |  | public class SkinAction extends XWikiAction |
|  |  | { |
|  |  |  |
|  |  | /\*\* Logging helper. \*/ |
|  |  | private static final Logger LOGGER = LoggerFactory.getLogger(SkinAction.class); |
|  |  |  |
| Expand All | | @@ -83,14 +84,28 @@ public class SkinAction extends XWikiAction |
|  |  | \*/ |
|  |  | private static final String ENCODING = "UTF-8"; |
|  |  |  |
|  |  | private static final String DOCDOESNOTEXIST = "docdoesnotexist"; |
|  |  |  |
|  |  | @Override |
|  |  | public boolean action(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!DOCDOESNOTEXIST.equals(Utils.getPage(context.getRequest(), DOCDOESNOTEXIST))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | "Template may not be overriden with 'xpage' in [skin] action."); |
|  |  | } |
|  |  |  |
|  |  | return super.action(context); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String render(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | try { |
|  |  | return render(context.getRequest().getPathInfo(), context); |
|  |  | } catch (IOException e) { |
|  |  | context.getResponse().setStatus(404); |
|  |  | return "docdoesnotexist"; |
|  |  | return DOCDOESNOTEXIST; |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -177,7 +192,7 @@ public String render(String path, XWikiContext context) throws XWikiException, I |
|  |  | } |
|  |  | if (!found) { |
|  |  | context.getResponse().setStatus(404); |
|  |  | return "docdoesnotexist"; |
|  |  | return DOCDOESNOTEXIST; |
|  |  | } |
|  |  | return null; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `71a6d0b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a12bf365_20250114_205435.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9b7057d57a941592d763992d4299456300918208)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9b7057d57a941592d763992d4299456300918208)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/9b7057d57a941592d763992d4299456300918208)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19549: Disallow template override for login, register and skin

[Browse files](/xwiki/xwiki-platform/tree/9b7057d57a941592d763992d4299456300918208)
Browse the repository at this point in the history

```
* Also allow `registerinline` template for RegisterAction.
```

* Loading branch information

[![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Mar 25, 2022

1 parent
[71a6d0b](/xwiki/xwiki-platform/commit/71a6d0bb6f8ab718fcfaae0e9b8c16c2d69cd4bb)

commit 9b7057d

Showing
**1 changed file**
with
**9 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 9 additions & 3 deletions

12
[...-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java](#diff-b93c4776f99dcf87c89153a4f265aa20c43eb9e78fdc6c2e5ca1bb40ad70a8be "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/9b7057d57a941592d763992d4299456300918208/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/RegisterAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,9 @@ |
|  |  | \*/ |
|  |  | package com.xpn.xwiki.web; |
|  |  |  |
|  |  | import java.util.Arrays; |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import javax.inject.Named; |
|  |  | import javax.inject.Singleton; |
|  |  | import javax.script.ScriptContext; |
| Expand Down  Expand Up | | @@ -55,17 +58,20 @@ public class RegisterAction extends XWikiAction |
|  |  | /\*\* Space where the registration config and class are stored. \*/ |
|  |  | private static final String WIKI\_SPACE = "XWiki"; |
|  |  |  |
|  |  | /\*\* Allowed templates for this action. \*/ |
|  |  | private static final List<String> ALLOWED\_TEMPLATES = Arrays.asList(REGISTER, "registerinline"); |
|  |  |  |
|  |  | @Override |
|  |  | public boolean action(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | XWiki xwiki = context.getWiki(); |
|  |  | XWikiRequest request = context.getRequest(); |
|  |  | XWikiResponse response = context.getResponse(); |
|  |  |  |
|  |  | // Disallow template override with xpage parameter. |
|  |  | if (!REGISTER.equals(Utils.getPage(context.getRequest(), REGISTER))) { |
|  |  | // Limit template overrides with xpage to allowed templates. |
|  |  | if (!ALLOWED\_TEMPLATES.contains(Utils.getPage(context.getRequest(), REGISTER))) { |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | String.format("Template may not be overriden with 'xpage' in [%s] action.", REGISTER)); |
|  |  | String.format("Forbidden template override with 'xpage' in [%s] action.", REGISTER)); |
|  |  | } |
|  |  |  |
|  |  | String register = request.getParameter(REGISTER); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9b7057d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9b7057d57a941592d763992d4299456300918208) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ee039578_20250114_205436.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-8h89-34w2-jpfm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-8h89-34w2-jpfm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

# Authentication Bypass Using the Login Action in org.xwiki.platform:xwiki-platform-oldcore

High

[surli](/surli)
published
GHSA-8h89-34w2-jpfm
Sep 8, 2022

## Package

maven

 org.xwiki.platform:xwiki-platform-oldcore
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 13.10.4, < 14.2

## Patched versions

13.10.4, 14.2

## Description

### Impact

All rights checks that would normally prevent a user from viewing a document on a wiki can be bypassed using the login action and directly specified templates. This exposes title, content and comments of any document and properties of objects (class and property name must be known, though). This is also exploitable on [private wikis](https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Access%20Rights/#HPrivateWiki).

### Patches

This has been patched in versions 14.2 and 13.10.4 by properly checking view rights before loading documents and disallowing non-default templates in the login, registration and skin action.

### Workarounds

It would be possible to protect all templates individually by adding code to check access rights first, but due to the number of templates and the fact that some of them need to be used without view rights, this seems impractical.

### References

* <https://jira.xwiki.org/browse/XWIKI-19549>
* <https://jira.xwiki.org/browse/XWIKI-18602>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Jira XWiki.org](https://jira.xwiki.org/)
* Email us at security mailing-list

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2022-36092

### Weaknesses

[CWE-288](/advisories?query=cwe%3A288) [CWE-424](/advisories?query=cwe%3A424)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_3c144048_20250114_205437.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18602)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18602)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-18602](/browse/XWIKI-18602)

# Dataleak on fully-private Wiki on Delete page

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-18602 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Solved By
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.2](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.2 "14.2 "), [13.10.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.4 "13.10.4 ")
* **Affects Version/s:**
  1.1.1
* **Component/s:**
  [Security](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+Security "Security ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_view](/issues/?jql=labels+%3D+attacker_view "attacker_view")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  High
* **Difficulty:**
  Unknown
* **Similar issues:**

#### Description

Reproduction Steps:

* Prevent guest user from being able to view any page through Global Administration Rights settings
* Log out
* Go to : <server>/bin/loginsubmit/?xpage=delete

Result:

* Page title, author complete name are shown
* link containing its username is available in page source code
* Number of children and number of backlinks of current page are also displayed

Expected Result:

* On a fully-private Wiki, this particular page should not be accessible and these informations should not be accessible

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-18602?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-18602?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-18602?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-18602?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-18602?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-18602?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/65958.zip "Download all attachments as a ZIP file")

1. [![screenshot.png](https://jira.xwiki.org/secure/thumbnail/39213/_thumb_39213.png)](/secure/attachment/39213/screenshot.png "screenshot.png - Latest 23/Apr/21 18:18 - Guillaume COQUARD")[screenshot.png](/secure/attachment/39213/screenshot.png "screenshot.png - Latest 23/Apr/21 18:18 - Guillaume COQUARD")48 kB23/Apr/21 18:18
#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19549](/browse/XWIKI-19549)
Page content, object properties and title leak on fully private wiki with xpages on the login action

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-8h89-34w2-jpfm)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![gcoquard](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Guillaume COQUARD

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

#### Dates

Created:

23/Apr/21 18:18

Updated:

16/Jun/23 17:36

Resolved:

25/Mar/22 13:33

Date of First Response:

26/Apr/21 1:59 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


