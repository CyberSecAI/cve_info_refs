Based on the provided information, here's an analysis of CVE-2022-36070:

**Root Cause of Vulnerability:**

- The vulnerability stems from Poetry executing commands (specifically `git config` and potentially others) using the executable's name instead of its absolute path. This behavior is problematic on Windows due to its executable search order.

**Weaknesses/Vulnerabilities Present:**

- **Unsafe Executable Resolution:** On Windows, when an executable is called by name, the system searches for the executable in the current directory first, and then in the directories listed in the `PATH` environment variable.
- **Lack of Absolute Path Usage:** Poetry was not using absolute paths when executing external programs like `git`.

**Impact of Exploitation:**

- **Arbitrary Code Execution:** An attacker can place a malicious executable (e.g., `git.exe`) in the current directory. When Poetry executes `git` (or another vulnerable command) by name, Windows will first find and execute the malicious executable, leading to arbitrary code execution.
- **System Takeover:** Successful exploitation could result in complete system takeover, allowing the attacker to steal credentials, establish persistence, or pivot to other internal systems.

**Attack Vectors:**

- **Malicious Project Files:** An attacker could craft a project with a malicious `git.exe` in the project directory. When a user interacts with this project via Poetry (e.g., installing dependencies from a Git repository), the malicious `git.exe` is executed instead of the legitimate one.
- **Collaboration on Projects:** The vulnerability can be exploited when a user collaborates on a project containing malicious files, as the user would unknowingly execute the malicious `git.exe`.

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to place a malicious executable (e.g., `git.exe`) in the same directory as a project that is being used by Poetry
- The attacker would need the user to execute commands with Poetry that would trigger the vulnerability.

**Additional Notes:**

- This vulnerability is specific to Windows due to its executable search order.
- The vulnerability is not directly remotely exploitable, but requires user interaction.
- The fix involves ensuring that Poetry uses absolute paths when executing external programs.
- The vulnerability was fixed in poetry version 1.1.9.
- The provided content includes a fix for the issue where unsafe parameters could be passed to `git` commands which was done in poetry-core 203.

**CVE ID:** CVE-2022-36070
**CWE ID:** CWE-426