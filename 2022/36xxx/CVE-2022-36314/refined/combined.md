=== Content from www.mozilla.org_851b2aaa_20250115_090622.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-30

## Security Vulnerabilities fixed in Firefox ESR 102.1

Announced
July 26, 2022
Impact
moderate
Products
Firefox ESR
Fixed in

* Firefox ESR 102.1

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a9782967_20250115_090622.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-32

## Security Vulnerabilities fixed in Thunderbird 102.1

Announced
July 28, 2022
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 102.1

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Thunderbird for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-2505: Memory safety bugs fixed in Thunderbird 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_6f1faad7_20250115_090621.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1773894)
* [XML](/show_bug.cgi?ctype=xml&id=1773894)

Closed
[Bug 1773894](/show_bug.cgi?id=1773894)
(CVE-2022-36314)

Opened 3 years ago
Closed 3 years ago

# Capture NTLM hash via LNK file download on Windows

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Capture NTLM hash via LNK file download on Windows

## Categories

### (Toolkit :: Downloads API, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Downloads%20API#Downloads%20API)

Downloads API
▾

Toolkit :: Downloads API
For issues relating to the process of downloading files to disk, including for example progress calculation and timing, folder choice, file naming, and file system access.
Does NOT cover:
- The user interface (see Firefox :: Downloads Panel)
- Networking issues (see Core :: Networking)
- Choosing the handler application (see Firefox :: File Handling)
- Saving complete web pages (see Firefox :: File Handling)
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Downloads%20API&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Downloads%20API&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Downloads%20API)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

2

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

104 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix) |
| firefox103 | [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed) |
| firefox104 | [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | - | wontfix |
| firefox-esr102 | 103+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox102 |  | wontfix |
| firefox103 | + | fixed |
| firefox104 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: akucybersec, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0adde602a76ecc7384d21ff55c7e9cea?d=mm&size=40)  [akucybersec](/user_profile?user_id=708219)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[983857](/show_bug.cgi?id=983857 "RESOLVED DUPLICATE - Risky .lnk file download/upload handling.")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1750979](/show_bug.cgi?id=1750979 "NEW - Save link as doesn't respect the extension (for wsf, asp and lnk files, if there is no server-sent mimetype or it does not match)"), [1659731](/show_bug.cgi?id=1659731 "RESOLVED FIXED - Download LNK files with a different suffix?"), [CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=181332 "https://bugs.chromium.org/p/chromium/issues/detail?id=181332")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form][adv-main103+][adv-esr102.1+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-36314

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][adv-main103+][adv-esr102.1+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2589120_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#a2587935_1689 "3 years ago") | ? |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | ? |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a3070972_551058 "2 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Nightly issue](/attachment.cgi?id=9281395)  [3 years ago](#c9)  [akucybersec](/user_profile?user_id=708219)   400.12 KB, image/png |  | [Details](/attachment.cgi?id=9281395&action=edit) |
| --- | --- | --- |
| [Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs](/attachment.cgi?id=9282074)  [3 years ago](#c12)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9282074&action=edit) | [Review](/attachment.cgi?id=9282074) |
| [Bug 1773894, special-case some extensions when downloading them, r=gijs](/attachment.cgi?id=9283062)  [3 years ago](#c14)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c28 "3 years ago")  dmeehan : [approval-mozilla-esr102+](#c30 "3 years ago")  tjr : [sec-approval+](#c16 "3 years ago") | [Details](/attachment.cgi?id=9283062&action=edit) | [Review](/attachment.cgi?id=9283062) |
| [advisory.txt](/attachment.cgi?id=9286027)  [2 years ago](#c34)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   352 bytes, text/plain |  | [Details](/attachment.cgi?id=9286027&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1773894#c0)• 3 years ago |
|  | |

I don't know if this can be considered as a bug but I think this could be a security issue on Windows.

It's possible to download .lnk files with FireFox without any restriction and, using the IconLocation property of the link file, it's possible to capture the NTLM hash.

I made a video (not listed on YouTube, nobody can see it): <https://www.youtube.com/watch?v=Ml_jE-pwisI>

In this video I try to explain and show you the problem.

I've tried to replicate this using a public IP address and it works.

Mozilla Firefox version: 101.0.1 (64-bit)

Hope it helps.

Flags: sec-bounty?

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1773894#c1)• 3 years ago |
|  | |

Not sure if this is the right component - feel free to redirect.

From a quick glance, it looks like Windows can automatically take actions based on the contents of .lnk files, so it might be good to rename these files if users download them.

Component: Security → Downloads APIProduct: Firefox → Toolkit

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1773894#c2)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #1](/show_bug.cgi?id=1773894#c1 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> Not sure if this is the right component - feel free to redirect.
>
> From a quick glance, it looks like Windows can automatically take actions based on the contents of .lnk files, so it might be good to rename these files if users download them.

I think this component is appropriate.

If we take Chrome as example (as shown in the video), it automatically renames the LNK files in .download

Of course, this is more like a Windows problem since it's Windows that tries to authenticate using the credentials, but I think that FireFox should "help"!

After the review, can I publish the video or should I delete it?

Thank you for your time.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1773894#c3)• 3 years ago |
|  | |

Mike, is this basically the same root cause as [bug 1659731](/show_bug.cgi?id=1659731 "RESOLVED FIXED - Download LNK files with a different suffix?")?

Flags: needinfo?(mozilla)

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1773894#c4)• 3 years ago |
|  | |

Yes, same issue.

Flags: needinfo?(mozilla)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1773894#c5)• 3 years ago |
|  | |

(In reply to Mike Kaply [:mkaply] from [comment #4](/show_bug.cgi?id=1773894#c4 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> Yes, same issue.

Mike or Neil, do either of you have cycles to look into this? Although it's the same root issue as [bug 1659731](/show_bug.cgi?id=1659731 "RESOLVED FIXED - Download LNK files with a different suffix?"), I think this has gotten worse considering the driveby potential of maintaining the extension with the default download behaviour (save to disk).

Flags: needinfo?(mozilla)Flags: needinfo?(enndeakin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1773894#c6)• 3 years ago |
|  | |

(would be worth checking if this still reproduces with 102 given it includes [bug 1746052](/show_bug.cgi?id=1746052 "RESOLVED FIXED - Unify ways to select and validate filenames when saving"))

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1773894#c7)• 3 years ago |
|  | |

Is there anything I can do to help you troubleshooting this?

If you need anything, just ask, I'll reply as soon as possible.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1773894#c8)• 3 years ago |
|  | |

(In reply to akucybersec from [comment #7](/show_bug.cgi?id=1773894#c7 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> Is there anything I can do to help you troubleshooting this?
>
> If you need anything, just ask, I'll reply as soon as possible.

Does the issue also happen with nightly (<https://nightly.mozilla.org/> ) ?

Flags: needinfo?(akucybersec)

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1773894#c9)• 3 years ago |
|  | |

Attached image
[Nightly issue](attachment.cgi?id=9281395)
— [Details](attachment.cgi?id=9281395&action=edit)

Flags: needinfo?(akucybersec)

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1773894#c10)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1773894#c8 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> (In reply to akucybersec from [comment #7](/show_bug.cgi?id=1773894#c7 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))
>
> > Is there anything I can do to help you troubleshooting this?
> >
> > If you need anything, just ask, I'll reply as soon as possible.
>
> Does the issue also happen with nightly (<https://nightly.mozilla.org/> ) ?

It does! I attached an image.

Remember that the issue happens when the user downloads the .lnk file in a folder and he opens the folder.

If the folder is already open, maybe in background, sometimes it happens even if the users does NOT bring the folder on the foreground (this applies to the Desktop too, since the Desktop is always "open").

Hope it helps.

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1773894#c11)• 3 years ago |
|  | |

Unfortunately I don't have cycles right now.

Flags: needinfo?(mozilla)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a672435_6102)• 3 years ago |

Assignee: nobody → enndeakinStatus: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a672446_6102)• 3 years ago |

Points: --- → 2

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1773894#c12)• 3 years ago |
|  | |

Attached file
[Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs](attachment.cgi?id=9282074) (obsolete)
— [Details](attachment.cgi?id=9282074&action=edit)

This also fixes an issue where content types that have no primary extension associated with them end up with the wrong extension in some cases, which affected the newly added tests.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a871283_1689)• 3 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=181332>

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a1014829_240353)• 3 years ago |

Severity: -- → S3Priority: -- → P1

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1773894#c13)• 3 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:enndeakin, could you consider increasing the severity of this security bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#severity_high_security.py).

Flags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1773894#c14)• 3 years ago |
|  | |

Attached file
[Bug 1773894, special-case some extensions when downloading them, r=gijs](attachment.cgi?id=9283062)
— [Details](attachment.cgi?id=9283062&action=edit)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1773894#c15)• 3 years ago |
|  | |

Comment on [attachment 9283062](/attachment.cgi?id=9283062 "Bug 1773894, special-case some extensions when downloading them, r=gijs") [[details]](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs")

[Bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), special-case some extensions when downloading them, r=gijs

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Someone just needs to create a file with the right contents and the lnk extension for download, then get the user to drag it to their file system.

The issue also existed on Chrome at one point and we implement a similar fix, so someone could compare the code here.

This version of the patch doesn't include the tests and has a slightly more generic description.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Would require a different patch for code before [bug 1746052](/show_bug.cgi?id=1746052 "RESOLVED FIXED - Unify ways to select and validate filenames when saving").
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions. An automated test exists.
* **Is Android affected?**: Unknown
Flags: needinfo?(enndeakin)
[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: sec-approval?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a1275035_159069)• 3 years ago |

Severity: S3 → S2

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1773894#c16)• 3 years ago |
|  | |

Comment on [attachment 9283062](/attachment.cgi?id=9283062 "Bug 1773894, special-case some extensions when downloading them, r=gijs") [[details]](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs")

[Bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), special-case some extensions when downloading them, r=gijs

Approved to land an uplift

[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1773894#c17)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1773894&comment_id=15963396 "1 revision") |
|  | |

We can land the test mid-september.

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][reminder-test 2022-09-14]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1773894#c18)• 3 years ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #17](/show_bug.cgi?id=1773894#c17 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> We can land the patch mid-september.

Uh, I guess you mean the test patch? Or you meant mid-July?

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1773894#c19)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #18](/show_bug.cgi?id=1773894#c18 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> (In reply to Tom Ritter [:tjr] from [comment #17](/show_bug.cgi?id=1773894#c17 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))
>
> > We can land the patch mid-september.
>
> Uh, I guess you mean the test patch? Or you meant mid-July?

The patch containing the test. Sorry I a word.

Flags: needinfo?(tom)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1773894#c20)• 3 years ago |
|  | |

special-case some extensions when downloading them, r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/d7f24c995ed5df9ca9ca018f8f86b8c98374dcc7>

<https://hg.mozilla.org/mozilla-central/rev/d7f24c995ed5>

Group: firefox-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 104 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1773894#c21)• 3 years ago |
|  | |

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%3F)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2494492_695136)• 3 years ago |

[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1773894#c22)• 3 years ago |
|  | |

This grafts cleanly to Beta & ESR102 and can be nominated for uplift when you're ready. It'll need a rebased patch for ESR91, however.

[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox104](/buglist.cgi?f1=cf_tracking_firefox104&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=103%2B)Flags: needinfo?(enndeakin)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2587042_1689)• 3 years ago |

See Also: → [1750979](/show_bug.cgi?id=1750979 "NEW - Save link as doesn't respect the extension (for wsf, asp and lnk files, if there is no server-sent mimetype or it does not match)"), [1659731](/show_bug.cgi?id=1659731 "RESOLVED FIXED - Download LNK files with a different suffix?")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2587306_1689)• 3 years ago |

[Attachment #9282074](/attachment.cgi?id=9282074&action=edit "Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs") -
Attachment description: Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs → [Version with test] Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2587935_1689)• 3 years ago |

Flags: in-testsuite?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1773894#c24)• 3 years ago |
|  | |

Comment on [attachment 9283062](/attachment.cgi?id=9283062 "Bug 1773894, special-case some extensions when downloading them, r=gijs") [[details]](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs")

[Bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), special-case some extensions when downloading them, r=gijs

### Beta/Release Uplift Approval Request

* **User impact if declined**: Security issue that allows an attacker to access information about the user's system simply by having them download a specially crafted file.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Only affects files with specific extensions (lnk, location) that are not normally downloaded.
* **String changes made/needed**: None
* **Is Android affected?**: Unknown

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Security issue that allows an attacker to access information about the user's system simply by having them download a specially crafted file.
* **Fix Landed on Version**: 103
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Only affects files with specific extensions (lnk, location) that are not normally downloaded.
Flags: needinfo?(enndeakin)
[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: approval-mozilla-esr102?
[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: approval-mozilla-beta?

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1773894#c25)• 3 years ago |
|  | |

Without [bug 1746052](/show_bug.cgi?id=1746052 "RESOLVED FIXED - Unify ways to select and validate filenames when saving"), a patch for esr91 would be very different and would require changes in five or so different locations. Not sure how worth it would be for 2 months.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1773894#c26)• 3 years ago |
|  | |

Dan, given the rating of this bug, I think the question in [comment 25](/show_bug.cgi?id=1773894#c25 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows") should probably be answered by your team.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1773894#c27)• 3 years ago |
|  | |

We're lowering the severity here a little because of the manual steps and likely social engineering required (the user has to go open the .lnk later), and also because we think this is only useful when the attacker is on the same local domain. The impact is enough different (NTLM hash) that we are going to award a bounty, however, and not deny it on the basis of the two-year old duplicate [bug 1659731](/show_bug.cgi?id=1659731 "RESOLVED FIXED - Download LNK files with a different suffix?")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2589059_1689)• 3 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2589077_75935)• 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[103+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=103%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=-)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2589120_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1773894#c28)• 3 years ago |
|  | |

Comment on [attachment 9283062](/attachment.cgi?id=9283062 "Bug 1773894, special-case some extensions when downloading them, r=gijs") [[details]](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs")

[Bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), special-case some extensions when downloading them, r=gijs

Approved for 103.0b9, thanks.

[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1773894#c29)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/5f5608b95dad>

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a2704179_75935)• 3 years ago |

Flags: needinfo?(dveditz)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1773894#c30)• 3 years ago |
|  | |

Comment on [attachment 9283062](/attachment.cgi?id=9283062 "Bug 1773894, special-case some extensions when downloading them, r=gijs") [[details]](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs")

[Bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), special-case some extensions when downloading them, r=gijs

Approved for ESR102.1, thanks.

[Attachment #9283062](/attachment.cgi?id=9283062&action=edit "Bug 1773894, special-case some extensions when downloading them, r=gijs") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1773894#c31)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/d10832fe6c6d>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a3070972_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a3147911_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][reminder-test 2022-09-14] → [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+]

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1773894#c32)• 2 years ago |
|  | |

I'm sorry, just a question since this is my first time: I've noticed that I will receive a bounty for this submission.

Since it says "Awarded: 2022-07-12" and I did not receive any notification via email or something, I was wondering if everything's ok and I'll receive further details later.

Thanks.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1773894#c33)• 2 years ago |
|  | |

Someone `@mozilla.com` will reach out to your primary email address.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1773894#c34)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9286027)
— [Details](attachment.cgi?id=9286027&action=edit)

|  | [akucybersec](/user_profile?user_id=708219)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1773894#c35)• 2 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #33](/show_bug.cgi?id=1773894#c33 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"))

> Someone `@mozilla.com` will reach out to your primary email address.

Thank you!

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a3239044_428608)• 2 years ago |

Alias: CVE-2022-36314

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a3252630_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+] → [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+][adv-main102.1+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a3252718_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+][adv-main102.1+] → [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+][adv-esr102.1+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a18868036_1689)• 2 years ago |

Group: core-security-release

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1773894#c36)• 2 years ago |
|  | |

6 months ago, Tom Ritter [:tjr] placed a reminder on the bug using the whiteboard tag `[reminder-test 2022-09-14]` .

enndeakin, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(enndeakin)Whiteboard: [reporter-external] [client-bounty-form][reminder-test 2022-09-14][adv-main103+][adv-esr102.1+] → [reporter-external] [client-bounty-form][adv-main103+][adv-esr102.1+]

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1773894#c37)• 2 years ago |
|  | |

The test never landed but I updated it as part of [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read").

Flags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a19508372_6102)• 2 years ago |

Duplicate of this bug: [983857](/show_bug.cgi?id=983857 "RESOLVED DUPLICATE - Risky .lnk file download/upload handling.")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a19623675_1689)• 2 years ago |

See Also: → [CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a29443932_600971)• 2 years ago |

[Attachment #9282074](/attachment.cgi?id=9282074&action=edit "Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs") -
Attachment description: [Version with test] Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs → Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs
[Attachment #9282074](/attachment.cgi?id=9282074&action=edit "Bug 1773894, change lnk extension on Windows when downloading files so that they aren't handled by the system, r=gijs") -
Attachment is obsolete: true

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1773894#a62029206_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1773894&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [akucybersec](/user_profile?user_id=708219)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_d875bec4_20250115_090621.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-28

## Security Vulnerabilities fixed in Firefox 103

Announced
July 26, 2022
Impact
moderate
Products
Firefox
Fixed in

* Firefox 103

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36317: Long URL would hang Firefox for Android](#CVE-2022-36317)

Reporter
Irwan
Impact
moderate
##### Description

When visiting a website with an overly long URL, the user interface would start to hang. Due to session restore, this could lead to a permanent Denial of Service.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1759951](https://bugzilla.mozilla.org/show_bug.cgi?id=1759951)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-36315: Preload Cache Bypasses Subresource Integrity](#CVE-2022-36315)

Reporter
Hiroshige Hayashizaki
Impact
low
##### Description

When loading a script with Subresource Integrity, attackers with an injection capability could trigger the reuse of previously cached entries with incorrect, different integrity metadata.

##### References

* [Bug 1762520](https://bugzilla.mozilla.org/show_bug.cgi?id=1762520)

#### [#CVE-2022-36316: Performance API leaked whether a cross-site resource is redirecting](#CVE-2022-36316)

Reporter
Jannis Rautenstrauch
Impact
low
##### Description

When using the Performance API, an attacker was able to notice subtle differences between PerformanceEntries and thus learn whether the target URL had been subject to a redirect.

##### References

* [Bug 1768583](https://bugzilla.mozilla.org/show_bug.cgi?id=1768583)

#### [#CVE-2022-36320: Memory safety bugs fixed in Firefox 103](#CVE-2022-36320)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1759794%2C1760998)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


