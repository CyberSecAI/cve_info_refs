The provided content describes a directory traversal vulnerability in WUZHI CMS v4.1.0.

**Root cause of vulnerability:**
The vulnerability lies in the `dir()` function within `/coreframe/app/attachment/admin/index.php`. The function attempts to sanitize user-provided directory paths by removing `..\\`, `../`, `./`, and `.\\` sequences, and by replacing `%2F` and `//` with `/`. However, the filtering is insufficient, as it can be bypassed using sequences like `.....///` .

**Weaknesses/vulnerabilities present:**
- Insufficient input sanitization: The `str_replace` function does not adequately filter directory traversal sequences.
- Use of `glob`: The `glob` function is used with user-controlled input, allowing for the listing of arbitrary directories.

**Impact of exploitation:**
- Attackers can list files and directories on the server. This can lead to information disclosure of sensitive files, potentially exposing database credentials, configuration files, and source code.

**Attack vectors:**
- The vulnerability is triggered through the `dir` parameter in the URL request to `/index.php` with module `attachment`, function `index`, and `v=dir`.

**Required attacker capabilities/position:**
- The attacker needs to be authenticated as an administrator.
- The attacker can send a crafted HTTP request with the `dir` parameter containing directory traversal sequences to the vulnerable endpoint.