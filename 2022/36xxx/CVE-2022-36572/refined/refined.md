- **Root cause of vulnerability:** The application fails to properly sanitize user input passed through the `cmd` parameter, allowing for arbitrary function execution. Specifically, the `strict` function, intended to sanitize input, does not prevent the execution of functions such as `phpinfo()`.
- **Weaknesses/vulnerabilities present:** Unrestricted function execution vulnerability. The `cmd` parameter is directly invoked as a function in both versions (V1.0 and V1.1) after passing through a flawed sanitization routine.
- **Impact of exploitation:** An attacker can execute arbitrary PHP functions on the server, potentially leading to information disclosure (`phpinfo()`), remote code execution, and full compromise of the server.
- **Attack vectors:** Sending a POST request to the `admin.php` endpoint with the `cmd` parameter set to the desired PHP function. For example, `cmd=phpinfo`.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the vulnerable application endpoint and needs to have knowledge of the vulnerable endpoint URL and the parameter to exploit (`cmd`). The attacker must have access to a session to be authenticated.