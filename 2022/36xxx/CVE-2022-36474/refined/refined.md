The provided content relates to CVE-2022-36474.

**Root cause of vulnerability:**
The vulnerability lies within the `WlanWpsSet` function of the H3C B5 Mini B5MiniV100R005 router firmware. Specifically, the `sscanf` function is used with a format string `%d;%[^;];` to parse user-provided input. This greedy matching mechanism, where `%[^;]` attempts to read as many characters as possible until a semicolon is encountered, is insecure when the input size exceeds the buffer allocated for the parsed value.

**Weaknesses/vulnerabilities present:**
- Stack overflow: The primary vulnerability is a stack-based buffer overflow. This occurs when the input data parsed using `sscanf` exceeds the allocated buffer size on the stack. The lack of proper bounds checking allows writing beyond the buffer's boundaries, which can overwrite return addresses and other stack data.

**Impact of exploitation:**
- Denial of Service (DoS): By crafting a specific payload, attackers can cause a denial of service by crashing the device or interrupting its normal operation.
- Remote Code Execution (RCE): By overwriting the return address on the stack, attackers can redirect code execution to arbitrary locations in memory. This can lead to the execution of attacker-controlled code and potentially a root shell.

**Attack vectors:**
- The attack vector is through sending a crafted POST request to the `/goform/aspForm` endpoint with the `CMD` parameter set to `WlanWpsSet`, and a malicious `param` value.

**Required attacker capabilities/position:**
- The attacker needs network access to the vulnerable device, specifically the web interface.
- The attacker needs to know the vulnerable endpoint and parameters.
- No authentication is mentioned as required for this exploit.

**Additional Information:**

- The provided text includes a proof-of-concept (POC) exploit that can be used to trigger the stack overflow.
- The POC demonstrates a DoS attack.
- The content mentions the possibility of achieving remote code execution and gaining a root shell by further analyzing and crafting the payload.