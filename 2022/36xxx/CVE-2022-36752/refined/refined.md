The provided content relates to CVE-2022-36752.

**Root cause of vulnerability:**
The vulnerability is caused by an integer overflow when reading the RIFF header size of a WebP file. The size calculation `((uint32_t)(i[4] | (i[5] << 8) | (i[6] << 16) | (i[7] << 24))) + 8` could lead to a large value, exceeding the maximum size allowed by `malloc`. This caused the program to request an insufficient amount of memory which then lead to an out of bounds write.

**Weaknesses/vulnerabilities present:**
Integer overflow leading to insufficient memory allocation and an out-of-bounds write during the handling of a malformed WebP file.

**Impact of exploitation:**
An attacker can overwrite heap memory with attacker provided data. This could lead to arbitrary code execution, denial of service, or other undefined behavior.

**Attack vectors:**
The attack vector is a specially crafted WebP file, where the RIFF header size is crafted to trigger the integer overflow vulnerability.

**Required attacker capabilities/position:**
The attacker needs to be able to provide a specially crafted WebP file as input to the `png2webp` tool. This could be done by tricking a user into processing the malicious file, or through other means if `png2webp` is used in an automated processing system.

**Additional details:**
- The issue was reported and fixed in version `v1.0.5`.
- The fix includes a check to ensure the calculated size `l` does not exceed `SSIZE_MAX`, preventing the integer overflow when allocating memory via `malloc`.
- The original issue was triggered by a fuzzer (AFL++).
- The problematic code was located around line 319 of `png2webp.c` in the `w2p` function.
- The initial analysis of the out of bounds write by the reporter of the issue was incorrect, however the reporter did provide a crash file that could be used to demonstrate the issue.
- The vulnerability was initially present in version v1.0.4.