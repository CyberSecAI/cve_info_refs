=== Content from www.mozilla.org_d875bec4_20250114_200701.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-28

## Security Vulnerabilities fixed in Firefox 103

Announced
July 26, 2022
Impact
moderate
Products
Firefox
Fixed in

* Firefox 103

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36317: Long URL would hang Firefox for Android](#CVE-2022-36317)

Reporter
Irwan
Impact
moderate
##### Description

When visiting a website with an overly long URL, the user interface would start to hang. Due to session restore, this could lead to a permanent Denial of Service.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1759951](https://bugzilla.mozilla.org/show_bug.cgi?id=1759951)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-36315: Preload Cache Bypasses Subresource Integrity](#CVE-2022-36315)

Reporter
Hiroshige Hayashizaki
Impact
low
##### Description

When loading a script with Subresource Integrity, attackers with an injection capability could trigger the reuse of previously cached entries with incorrect, different integrity metadata.

##### References

* [Bug 1762520](https://bugzilla.mozilla.org/show_bug.cgi?id=1762520)

#### [#CVE-2022-36316: Performance API leaked whether a cross-site resource is redirecting](#CVE-2022-36316)

Reporter
Jannis Rautenstrauch
Impact
low
##### Description

When using the Performance API, an attacker was able to notice subtle differences between PerformanceEntries and thus learn whether the target URL had been subject to a redirect.

##### References

* [Bug 1768583](https://bugzilla.mozilla.org/show_bug.cgi?id=1768583)

#### [#CVE-2022-36320: Memory safety bugs fixed in Firefox 103](#CVE-2022-36320)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1759794%2C1760998)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_c288427c_20250114_200700.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1762520)
* [XML](/show_bug.cgi?ctype=xml&id=1762520)

Closed
[Bug 1762520](/show_bug.cgi?id=1762520)
(CVE-2022-36315)

Opened 3 years ago
Closed 3 years ago

# SRI bypass: When <link rel=preload integrity="sha512-correcthash"> preloads a resource with the hash1, subresource requests with integrity="sha256-wronghash" also succeeds

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

SRI bypass: When <link rel=preload integrity="sha512-correcthash"> preloads a resource with the hash1, subresource requests with integrity="sha256-wronghash" also succeeds

## Categories

### (Core :: DOM: Security, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 91

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

104 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix) |
| firefox103 | [-](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed) |
| firefox104 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr102 | 103+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox102 |  | wontfix |
| firefox103 | - | fixed |
| firefox104 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hiroshige, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/42602c8f8e8eacb89b652b91abe48f9e?d=mm&size=40)  [hiroshige](/user_profile?user_id=704107)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1759002](/show_bug.cgi?id=1759002 "NEW - Dynamically added CSP not respected for preloaded resource discovery"), [1751835](/show_bug.cgi?id=1751835 "NEW - New wpt failures in /preload/subresource-integrity.html"), [1761990](/show_bug.cgi?id=1761990 "NEW - New wpt failures in /preload/subresource-integrity.html")

[github.com/whatwg/html/pull/7738](https://github.com/whatwg/html/pull/7738 "https://github.com/whatwg/html/pull/7738")

## Details

### (Keywords: sec-low, Whiteboard: [domsecurity-backlog3][adv-main103+][adv-esr102.1+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-36315

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-backlog3][adv-main103+][adv-esr102.1+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a9347405_551058 "2 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb](/attachment.cgi?id=9284007)  [3 years ago](#c12)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c18 "3 years ago")  dmeehan : [approval-mozilla-esr102+](#c20 "3 years ago") | [Details](/attachment.cgi?id=9284007&action=edit) | [Review](/attachment.cgi?id=9284007) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9286176)  [2 years ago](#c22)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   258 bytes, text/plain |  | [Details](/attachment.cgi?id=9286176&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [hiroshige](/user_profile?user_id=704107)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1762520#c0)• 3 years ago |
|  | |

Steps to reproduce:

foo.js's SHA512 hash is correcthash512 and SHA256 hash is correcthash256, not wronghash256.

Run the following HTML:

<link rel="preload" as="script" href="foo.js" integrity="sha512-correcthash512">

<script src="foo.js" integrity="sha256-wronghash256"></script>

WPT version: Add the following sub test to the WPT /preload/subresource-integrity.html, inside the "if (supports\_sri) {" block, and run the test:

```
  SRIPreloadTest(
    true,
    false,
    `Same-origin ${destination} with wrong digest does not reuse preload with correct and stronger digest.`,
    2,
    destination,
    same_origin_prefix + destination + ext + `?${token()}`,
    {integrity: sha512},
    {integrity: "sha256-deadbeefQ15RYHFvsYdWumweeFAw0hJDTFt9seErghA="}
  )

```

Actual results:

<link rel=preload> is successfully loaded, firing load event.

<script> is also successfully loaded, firing load event, even though its integrity attribute is wrong (that should be integrity="sha256-correcthash256" to be successful).

WPT: the added subtest fails because the load events of the main requests are fired:

FAIL Same-origin script with wrong digest does not reuse preload with correct and stronger digest. assert\_unreached: Invalid subresource load succeeded. Reached unreachable code

I tested on Firefox 91.7.0esr on Linux.

So far I don't expect this is exploitable by attackers, but I'm filing this issue as an security issue just in case.

If an attacker can serve a malicious script as foo.js and inject <link rel=preload> with the SHA-512 of the malicious script, then SRI specified on <script> by the page author can be bypassed.

However, this needs injecting <link rel=preload> to the page, and if the attacker can inject <link>s, the attacker already can do more than the SRI bypassing.

I found this issue while reviewing <https://github.com/whatwg/html/pull/7738>, and this test case is stemming from:

<li><p>the user-agent has determined that <var>entry</var>'s <span data-x="preload integrity

metadata">integrity metadata</span>'s algorithm is more collision-resistant than

<var>integrityMetadata</var>'s algorithm <ref spec=SRI></p></li>

Expected results:

<link rel=preload> is successfully loaded, firing load event.

<script> fails, firing error event, because the integrity attribute doesn't match foo.js.

WPT: the added subtest should pass.

Chromium behaves like this.

I expect the WPT would fail on Safari, but due to another broader underlying issue.

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1762520#c1)• 3 years ago |
|  | |

This seems similar to not respecting CSP on the "actual fetch".

See Also: → [1759002](/show_bug.cgi?id=1759002 "NEW - Dynamically added CSP not respected for preloaded resource discovery")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a301126_1689)• 3 years ago |

Group: core-security → dom-core-securitySeverity: -- → S3Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Priority: -- → P3Whiteboard: [domsecurity-backlog3]

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1762520#c2)• 3 years ago |
|  | |

`ScriptLoader::LookupPreloadRequest` calls `SRIMetadata::CanTrustBeDelegatedTo`, which will always return true when the preload request used a strong hashing algorithm than the current request. Maybe it would be better to enforce that the preload request uses the same hash and algorithm? Added in [bug 1623953](/show_bug.cgi?id=1623953 "RESOLVED FIXED - [rel=preload] Make SRI work with preload-as-speculative-load feature").

Flags: needinfo?(honzab.moz)

|  | [hiroshige](/user_profile?user_id=704107)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1762520#c3)• 3 years ago |
|  | |

Can we discuss this issue publicly (now or later when the impl is fixed), in order to fix the spec as well?

<https://github.com/whatwg/html/pull/7738> merged this behavior into the spec (to reflect the current status anyway), and I'd like to amend the spec later.

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1762520#c4)• 3 years ago |
|  | |

Maybe don't actively call out the attack, but describe it as a robustness improvement? With that I think it should be okay to discuss this and improve the specification. Thanks for checking!

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1762520#c5)• 3 years ago |
|  | |

Redirect a needinfo that is pending on an inactive user to the triage owner.

:ckerschb, since the bug has recent activity, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).

Flags: needinfo?(honzab.moz) → needinfo?(ckerschb)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1762520#c6)• 3 years ago |
|  | |

(In reply to Release mgmt bot [:suhaib / :marco/ :calixte] from [comment #5](/show_bug.cgi?id=1762520#c5 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds"))

> Redirect a needinfo that is pending on an inactive user to the triage owner.

I am trying to ni? Honza again, maybe he has time to look at it eventually.

Flags: needinfo?(ckerschb) → needinfo?(honzab.moz)

|  | [hiroshige](/user_profile?user_id=704107)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1762520#c7)• 3 years ago |
|  | |

Thanks, I filed <https://github.com/whatwg/html/issues/7973>.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1762520#c8)• 3 years ago |
|  | |

Redirect a needinfo that is pending on an inactive user to the triage owner.

:freddy, since the bug has recent activity, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).

Flags: needinfo?(honzab.moz) → needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1762520#c9)• 3 years ago |
|  | |

(In reply to Tom Schuster (MoCo) from [comment #2](/show_bug.cgi?id=1762520#c2 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds"))

> `ScriptLoader::LookupPreloadRequest` calls `SRIMetadata::CanTrustBeDelegatedTo`, which will always return true when the preload request used a strong hashing algorithm than the current request. Maybe it would be better to enforce that the preload request uses the same hash and algorithm? Added in [bug 1623953](/show_bug.cgi?id=1623953 "RESOLVED FIXED - [rel=preload] Make SRI work with preload-as-speculative-load feature").

Looks like Honza is unavailable. I've worked on the SRI spec and took a cursory look at `SRIMetadata::CanTrustBeDelegatedTo`.

I believe the issue is not comparing the algorithm strength. The code assumes that no metadata is needed because the latest request does not have integrity metadata [here](https://searchfox.org/mozilla-central/rev/28ed523a3ed5dbf5f6b008cf1e28a9e8a8597b5e/dom/security/SRIMetadata.cpp#155-157).

However, it should reuse the one from preload instead.

This *seems* the right place to fix. Though I haven't dug any further. Does that answer your question, Tom?

Flags: needinfo?(fbraun)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a7557422_703078)• 3 years ago |

Assignee: nobody → tschuster

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1762520#c10)• 3 years ago |
|  | |

> I believe the issue is not comparing the algorithm strength. The code assumes that no metadata is needed because the latest request does not have integrity metadata here.
>
> However, it should reuse the one from preload instead.

I don't think that is true, at least not for the example from [comment 0](/show_bug.cgi?id=1762520#c0 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds"). The first (correct) hash is for the pre-load attribute and the second (wrong) hash is for the actual script/style load.

```
    {integrity: sha512},
    {integrity: "sha256-deadbeefQ15RYHFvsYdWumweeFAw0hJDTFt9seErghA="}

```

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a8143930_428608)• 3 years ago |

See Also: → [1751835](/show_bug.cgi?id=1751835 "NEW - New wpt failures in /preload/subresource-integrity.html")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a8143942_428608)• 3 years ago |

See Also: → [1761990](/show_bug.cgi?id=1761990 "NEW - New wpt failures in /preload/subresource-integrity.html")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a8144662_703078)• 3 years ago |

See Also: → <https://github.com/whatwg/html/pull/7738>

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1762520#c11)• 3 years ago |
|  | |

There is actually another test case that we should add. Firefox currently only tests if the subset of hashes in the current SRI metadata is contained in the other SRI. That means we will accept loads with a wrong hash as long as the preload also contains the wrong hash in addition to at least one correct hash.

```
SRIPreloadTest(
  true,
  false,
  `Same-origin ${destination} with wrong digest does not reuse preload with the wrong and a correct digest.`,
  2,
  destination,
  same_origin_prefix + destination + ext + `?${token()}`,
  {integrity: `${sha256} sha256-deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdead`},
  {integrity: "sha256-deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdead"}
)

```

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1762520#c12)• 3 years ago |
|  | |

Attached file
[Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb](attachment.cgi?id=9284007)
— [Details](attachment.cgi?id=9284007&action=edit)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1762520#c13)• 3 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/cec84442f4c7ea410ba4660d4429f90b0d72f480>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1762520#c14)• 3 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/cec84442f4c7>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 104 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a8775231_578488)• 3 years ago |

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=-)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1762520#c15)• 3 years ago |
|  | |

Looks like this grafts cleanly to Beta and ESR102. Did you want to nominate for uplift to both?

[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1762520#c16)• 3 years ago |
|  | |

Comment on [attachment 9284007](/attachment.cgi?id=9284007 "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") [[details]](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb")

[Bug 1762520](/show_bug.cgi?id=1762520 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds") - Update preload SRI checking for HTML spec change. r?freddyb

### Beta/Release Uplift Approval Request

* **User impact if declined**: It's possible for an attacker to bypass the sub-resource integrity attribute of a website. The actual security impact of this however is probably low.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The actual patch is quite simple and the feature itself is actually not widely used.
* **String changes made/needed**:
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Low risk patch security patch, early in the ESR cycle.
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
Flags: needinfo?(tschuster)
[Attachment #9284007](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") -
Flags: approval-mozilla-release?
[Attachment #9284007](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1762520#c17)• 3 years ago |
|  | |

The patch landed in nightly and beta is affected.

:tschuster, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox103` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(tschuster)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a8934484_75935)• 3 years ago |

Flags: needinfo?(tschuster)
[Attachment #9284007](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") -
Flags: approval-mozilla-release? → approval-mozilla-beta?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1762520#c18)• 3 years ago |
|  | |

Comment on [attachment 9284007](/attachment.cgi?id=9284007 "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") [[details]](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb")

[Bug 1762520](/show_bug.cgi?id=1762520 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds") - Update preload SRI checking for HTML spec change. r?freddyb

Approved for 103.0b9, thanks.

[Attachment #9284007](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1762520#c19)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/b12599aeb21a>

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1762520#c20)• 3 years ago |
|  | |

Comment on [attachment 9284007](/attachment.cgi?id=9284007 "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") [[details]](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb")

[Bug 1762520](/show_bug.cgi?id=1762520 "RESOLVED FIXED - SRI bypass: When <link rel=preload integrity=\"sha512-correcthash\"> preloads a resource with the hash1, subresource requests with integrity=\"sha256-wronghash\" also succeeds") - Update preload SRI checking for HTML spec change. r?freddyb

Approved for ESR102.1, thanks.

[Attachment #9284007](/attachment.cgi?id=9284007&action=edit "Bug 1762520 - Update preload SRI checking for HTML spec change. r?freddyb") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1762520#c21)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/a2adccae05a4>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a9347405_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a9434039_428608)• 2 years ago |

Whiteboard: [domsecurity-backlog3] → [domsecurity-backlog3][adv-main103+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1762520#c22)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9286176)
— [Details](attachment.cgi?id=9286176&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a9519498_428608)• 2 years ago |

Alias: CVE-2022-36315

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a25148478_1689)• 2 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762520#a29822003_1689)• 2 years ago |

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B)Whiteboard: [domsecurity-backlog3][adv-main103+] → [domsecurity-backlog3][adv-main103+][adv-esr102.1+]
You need to [log in](/show_bug.cgi?id=1762520&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom Schuster](/user_profile?user_id=703078)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


