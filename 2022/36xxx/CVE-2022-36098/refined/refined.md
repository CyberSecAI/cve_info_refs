Based on the provided information, here's an analysis of CVE-2022-36098:

**Root Cause of Vulnerability:**

The root cause is the insufficient escaping of parameters within the `mentions` macro in XWiki. Specifically, the `anchor` and `reference` fields of the macro were not properly sanitized, allowing the injection of arbitrary code. This was exploited through the HTML Converter of CKEditor, which allowed parsing and rendering of arbitrary XWiki syntax, even without edit rights.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Input Neutralization:** The primary vulnerability is the lack of proper input sanitization/escaping in the `mentions` macro. This allows users to inject malicious code through the `anchor` and `reference` fields.
*   **Code Injection:** The injected code can be arbitrary XWiki syntax, including Groovy scripts, which are executed on the server.
*   **Privilege Escalation:** A user with only view rights can, by exploiting this vulnerability, gain the ability to execute arbitrary code on the server, effectively escalating their privileges to programming rights.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Attackers can execute arbitrary code on the server, leading to various malicious activities, such as:
    *   Creating or modifying files on the server.
    *   Accessing sensitive information.
    *   Compromising the server's security.
    *   Potentially gaining full control of the server.
*   **Privilege Escalation:** A low-privileged user can gain programming rights through the vulnerability.
*   **Cross-Site Scripting (XSS):** Although not explicitly stated as XSS, the injected code can execute on the client-side as well (as mentioned "stored code is executed by anyone visiting the page with the mention").

**Attack Vectors:**

*   **Maliciously Crafted Mentions Macro:** An attacker injects malicious code within the `anchor` or `reference` fields of the `mentions` macro. This can be done in various places such as:
    *   Directly creating a page containing the macro.
    *   Inserting the malicious macro in user profiles.
    *   Inserting the malicious macro in a document that is then rendered via the CKEditor HTML Converter.

**Required Attacker Capabilities/Position:**

*   **Low Privileges:** The attacker requires only view rights or edit rights on a page or user profile.
*   **Knowledge of XWiki Syntax and Macros:** The attacker needs to know how to construct a malicious `mentions` macro using XWiki syntax and Groovy scripting.
*   **Access to XWiki Platform:** The attacker needs access to the XWiki platform and the ability to insert or render the malicious code.

**Additional Details:**

*   **Affected Versions:** XWiki versions 12.5-rc-1 and later are affected, up to the patched versions 13.10.6 and 14.4.
*   **Patches:** The vulnerability was fixed by escaping the `anchor`, `reference`, and `content` values using the `$escapetool.xml()` function in the `MentionsMacro.xml` file.
*   **Workaround:** Before the patch, a workaround was to manually edit the `XWiki.Mentions.MentionsMacro` to include the missing escaping.
*   **CVSS Score:** The vulnerability has a CVSS v3 base score of 10.0, indicating a critical severity.
*   **CWE:** The vulnerability is categorized as CWE-95, "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')".

**Summary:**

CVE-2022-36098 is a critical vulnerability in XWiki caused by improper input sanitization in the `mentions` macro. It allows low-privileged users to inject and execute arbitrary code on the server, leading to privilege escalation and potential compromise of the entire platform. This vulnerability is remotely exploitable over the network with low attack complexity and no user interaction.