Based on the provided information, here's an analysis of CVE-2022-36073:

**Root cause of vulnerability:**

The vulnerability stems from a flaw in the password and email change confirmation code within rubygems.org. Specifically, the system was incorrectly handling the `unconfirmed_email` field when generating confirmation tokens, leading to a state where an attacker could change their account email to an arbitrary, unowned email address without proper verification.

**Weaknesses/vulnerabilities present:**

- Insecure handling of the `unconfirmed_email` field during email change operations.
- The system did not properly clear or validate the `unconfirmed_email` when generating new confirmation tokens during password reset.

**Impact of exploitation:**

- An attacker could gain control of a user's account by changing its email address to one they control, even without confirming the new email.
- The attacker could then save API keys associated with the compromised account, allowing them to publish and yank versions of gems associated with that account.
- This could lead to supply chain attacks, denial of service, or other malicious activities on the RubyGems ecosystem.

**Attack vectors:**

1.  An attacker would first need to have an existing account on rubygems.org.
2.  The attacker would initiate a password reset or email change process.
3. Due to the flawed logic, they could then change their account email to an unowned email.
4. This would give the attacker control of the user account.

**Required attacker capabilities/position:**

- The attacker needs to have a valid account on rubygems.org.
- The attacker needs to be able to initiate password reset or email change for the account

**Additional details:**

- The vulnerability was fixed in commit `90c9e6a`.
- The fix involved ensuring that the `unconfirmed_email` is reset when generating a new confirmation token.
- Specifically, the `generate_confirmation_token` method in the `User` model was modified to reset `unconfirmed_email` by default, and a new method `_generate_confirmation_token_no_reset_unconfirmed_email` was introduced to generate the token without resetting the `unconfirmed_email` when required.
- Test cases were added to verify the fix by simulating the scenario described in the vulnerability and ensuring the `unconfirmed_email` is reset after password reset.