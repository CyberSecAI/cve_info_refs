=== Content from github.com_5578dcd7_20250114_181016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Fe074d226d9b2b96a0a1ba4349d1b73a802842986)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Fe074d226d9b2b96a0a1ba4349d1b73a802842986)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/e074d226d9b2b96a0a1ba4349d1b73a802842986)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19559: Refactor handling of users in oldcore

[Browse files](/xwiki/xwiki-platform/tree/e074d226d9b2b96a0a1ba4349d1b73a802842986)
Browse the repository at this point in the history

```
  * Add property for inactive users in XWikiContext
  * Ensure that all calls to checkAuth in XS goes through
    XWiki#checkAuth so that inactive users are handled
  * Improve code of XWiki#prepareDocuments to simplify it
  * Ensure that the login page is not displayed if a inactive user
    logged in, in XWikiCachingRightService
  * Improve a bit the code of the drawer to display the logout link in
    case of logged in inactive user
```

* Loading branch information

[![@surli](https://avatars.githubusercontent.com/u/1478232?s=40&v=4)](/surli)

[surli](/xwiki/xwiki-platform/commits?author=surli "View all commits by surli")
committed
Mar 31, 2022

1 parent
[70c64c2](/xwiki/xwiki-platform/commit/70c64c23f4404f33289458df2a08f7c4be022755)

commit e074d22

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**88 additions**
and
**59 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo

    - xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/drawer.vm
      [drawer.vm](#diff-97052b73aa6732071455b709190c5a5e65729555d3587e57882b79ea2f57e12d)
  + xwiki-platform-notifications/xwiki-platform-notifications-rest/src/main/java/org/xwiki/notifications/rest/internal

    - xwiki-platform-core/xwiki-platform-notifications/xwiki-platform-notifications-rest/src/main/java/org/xwiki/notifications/rest/internal/DefaultNotificationsResource.java
      [DefaultNotificationsResource.java](#diff-67766af6bba2fdfa50cac5dc00dfaab4a0b14e69716f417b156d7deb0cda42a3)
  + xwiki-platform-oldcore/src/main/java/com/xpn/xwiki

    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java
      [XWiki.java](#diff-da4c9f1d1dde6d89b84570874b4444f9ba12b296ca5dcca2953c5cf18078856d)
    - xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWikiContext.java
      [XWikiContext.java](#diff-d01364a3441e47aaf5b8406c8751cb890cd47978d6013b5df0434611aceba069)
    - api

      * xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/XWiki.java
        [XWiki.java](#diff-587d13376a3e9815a2fbbb7adc7053bd3ca6c150224107704a113a0e561fa86f)
    - user/api

      * xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/api/XWikiUser.java
        [XWikiUser.java](#diff-1ef60999abd1382c4450cd90da192bf97c2841d9d4cd2e1708033eeef396fb0c)
  + xwiki-platform-security/xwiki-platform-security-authorization/xwiki-platform-security-authorization-bridge/src/main/java/org/xwiki/security/authorization/internal

    - xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authorization/xwiki-platform-security-authorization-bridge/src/main/java/org/xwiki/security/authorization/internal/XWikiCachingRightService.java
      [XWikiCachingRightService.java](#diff-f3f5ad9cd93dab119467c8807c421fb567dfaf45e65a0e11573360efb7dd7cbd)

## There are no files selected for viewing

8 changes: 7 additions & 1 deletion

8
[...lamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/drawer.vm](#diff-97052b73aa6732071455b709190c5a5e65729555d3587e57882b79ea2f57e12d "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/drawer.vm")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-resources/src/main/resources/flamingo/drawer.vm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,9 +31,15 @@ |
|  |  | #largeUserAvatar($xcontext.user) |
|  |  | </a> |
|  |  | <div class="brand-links"> |
|  |  | #define ($logoutLink) |
|  |  | <a href="$xwiki.getURL('XWiki.XWikiLogout', 'logout', "xredirect=$escapetool.url($xwiki.relativeRequestURL)")" id="tmLogout" rel="nofollow">$services.icon.renderHTML('log-out') $escapetool.xml($services.localization.render('logout'))</a> |
|  |  | #end |
|  |  | #if ($xcontext.user != 'XWiki.XWikiGuest') |
|  |  | <a href="$xwiki.getURL($xcontext.user, 'view')" class="brand-user" id="tmUser">$!xwiki.getUserName($xcontext.user, false)</a> |
|  |  | <a href="$xwiki.getURL('XWiki.XWikiLogout', 'logout', "xredirect=$escapetool.url($xwiki.relativeRequestURL)")" id="tmLogout" rel="nofollow">$services.icon.renderHTML('log-out') $escapetool.xml($services.localization.render('logout'))</a> |
|  |  | $logoutLink |
|  |  | #elseif($xcontext.user == 'XWiki.XWikiGuest' && $xcontext.inactiveUserReference) |
|  |  | <a href="$xwiki.getURL($xcontext.inactiveUserReference, 'view')" class="brand-user" id="tmUser">$!xwiki.getUserName($xcontext.inactiveUserReference, false)</a> |
|  |  | $logoutLink |
|  |  | #else |
|  |  | <a href="$xwiki.getURL('XWiki.XWikiLogin', 'login', "xredirect=$escapetool.url($xwiki.relativeRequestURL)&loginLink=1")" id="tmLogin" rel="nofollow">$services.icon.renderHTML('log-in') $escapetool.xml($services.localization.render('login'))</a> |
|  |  | #if ($xwiki.hasAccessLevel('register', 'XWiki.XWikiPreferences')) |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[...est/src/main/java/org/xwiki/notifications/rest/internal/DefaultNotificationsResource.java](#diff-67766af6bba2fdfa50cac5dc00dfaab4a0b14e69716f417b156d7deb0cda42a3 "xwiki-platform-core/xwiki-platform-notifications/xwiki-platform-notifications-rest/src/main/java/org/xwiki/notifications/rest/internal/DefaultNotificationsResource.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-notifications/xwiki-platform-notifications-rest/src/main/java/org/xwiki/notifications/rest/internal/DefaultNotificationsResource.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -185,7 +185,7 @@ public Response getNotificationsCount(String useUserPreferences, String userId, |
|  |  | { |
|  |  | // Build the response |
|  |  | Response.ResponseBuilder response; |
|  |  | XWikiUser xWikiUser = getXWikiContext().getWiki().getAuthService().checkAuth(getXWikiContext()); |
|  |  | XWikiUser xWikiUser = getXWikiContext().getWiki().checkAuth(getXWikiContext()); |
|  |  | if (xWikiUser == null) { |
|  |  | response = Response.status(Status.UNAUTHORIZED); |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -215,7 +215,7 @@ public String getNotificationsRSS(String useUserPreferences, String userId, Stri |
|  |  | String tags, String currentWiki) throws Exception |
|  |  | { |
|  |  | // Build the response |
|  |  | XWikiUser xWikiUser = getXWikiContext().getWiki().getAuthService().checkAuth(getXWikiContext()); |
|  |  | XWikiUser xWikiUser = getXWikiContext().getWiki().checkAuth(getXWikiContext()); |
|  |  | DocumentReference userIdDoc = this.documentReferenceResolver.resolve(userId); |
|  |  | if (xWikiUser == null || !userIdDoc.equals(xWikiUser.getUserReference())) { |
|  |  | getXWikiContext().getResponse().sendError(HttpServletResponse.SC\_UNAUTHORIZED); |
| Expand Down | |  |

107 changes: 54 additions & 53 deletions

107
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java](#diff-da4c9f1d1dde6d89b84570874b4444f9ba12b296ca5dcca2953c5cf18078856d "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWiki.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4322,9 +4322,23 @@ public void prepareResources(XWikiContext context) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Authenticate the user from the context and check if the user is disabled or not. |
|  |  | \* If the user is disabled, the method returns {@code null} but set the reference of the authenticated user in the |
|  |  | \* context with the {@link XWikiContext#INACTIVE\_USER\_REFERENCE} property. |
|  |  | \* |
|  |  | \* @param context the context used to authenticate the user. |
|  |  | \* @return an {@link XWikiUser} if the user is authenticated and enabled, else {@code null}. |
|  |  | \* @throws XWikiException in case of problem when dealing with the authentication. |
|  |  | \*/ |
|  |  | public XWikiUser checkAuth(XWikiContext context) throws XWikiException |
|  |  | { |
|  |  | return getAuthService().checkAuth(context); |
|  |  | XWikiUser user = getAuthService().checkAuth(context); |
|  |  | if (user != null && user.isDisabled(context)) { |
|  |  | context.put(XWikiContext.INACTIVE\_USER\_REFERENCE, user.getUserReference()); |
|  |  | user = null; |
|  |  | } |
|  |  | return user; |
|  |  | } |
|  |  |  |
|  |  | public boolean checkAccess(String action, XWikiDocument doc, XWikiContext context) throws XWikiException |
| Expand Down  Expand Up | | @@ -5864,70 +5878,26 @@ public boolean prepareDocuments(XWikiRequest request, XWikiContext context, Velo |
|  |  | boolean hasAccess = checkAccess(context.getAction(), doc, context); |
|  |  |  |
|  |  | XWikiUser user; |
|  |  | XWikiUser inactiveUser = null; |
|  |  | if (context.getUserReference() == null && context.get(XWikiContext.INACTIVE\_USER\_REFERENCE) != null) { |
|  |  | inactiveUser = new XWikiUser((DocumentReference) context.get(XWikiContext.INACTIVE\_USER\_REFERENCE)); |
|  |  | } |
|  |  | if (context.getUserReference() != null) { |
|  |  | user = new XWikiUser(context.getUserReference()); |
|  |  | } else { |
|  |  | user = new XWikiUser(context.getUser()); |
|  |  | } |
|  |  |  |
|  |  | if (inactiveUser != null && context.getAction().equals("view")) { |
|  |  | this.handleInactiveUserViewAction(inactiveUser, context, reference, vcontext); |
|  |  | } |
|  |  | // We need to check rights before we look for translations |
|  |  | // Otherwise we don't have the user language |
|  |  | if (!hasAccess) { |
|  |  | else if (!hasAccess) { |
|  |  | Object[] args = { doc.getFullName(), user.getUser() }; |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI\_ACCESS, XWikiException.ERROR\_XWIKI\_ACCESS\_DENIED, |
|  |  | "Access to document {0} has been denied to user {1}", null, args); |
|  |  | // User is disabled: the mail address is marked as checked |
|  |  | } else if (user.isDisabled(context) && user.isEmailChecked(context)) { |
|  |  | String action = context.getAction(); |
|  |  | /\* |
|  |  | \* Allow inactive users to see skins, ressources, SSX, JSX and downloads they could have seen as guest. The |
|  |  | \* rational behind this behaviour is that inactive users should be able to access the same UI that guests |
|  |  | \* are used to see, including custom icons, panels, and so on... |
|  |  | \*/ |
|  |  | if (!((action.equals("skin") && (doc.getSpace().equals("skins") || doc.getSpace().equals("resources"))) |
|  |  | || ((action.equals("skin") || action.equals("download") || action.equals("ssx") || action.equals("jsx")) |
|  |  | && getRightService().hasAccessLevel("view", XWikiRightService.GUEST\_USER\_FULLNAME, |
|  |  | doc.getPrefixedFullName(), context)) |
|  |  | || ((action.equals("view") && doc.getFullName().equals("XWiki.AccountValidation"))))) { |
|  |  | Object[] args = { user.getUser() }; |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI\_USER, XWikiException.ERROR\_XWIKI\_USER\_DISABLED, |
|  |  | "User {0} account is disabled", null, args); |
|  |  | } |
|  |  | // User actually needs to activate his mail address. |
|  |  | } else if (user.isDisabled(context) && !user.isEmailChecked(context)) { |
|  |  | boolean allow = false; |
|  |  | String action = context.getAction(); |
|  |  | /\* |
|  |  | \* Allow inactive users to see skins, ressources, SSX, JSX and downloads they could have seen as guest. The |
|  |  | \* rational behind this behaviour is that inactive users should be able to access the same UI that guests |
|  |  | \* are used to see, including custom icons, panels, and so on... |
|  |  | \*/ |
|  |  | if ((action.equals("skin") && (doc.getSpace().equals("skins") || doc.getSpace().equals("resources"))) |
|  |  | || ((action.equals("skin") || action.equals("download") || action.equals("ssx") || action.equals("jsx")) |
|  |  | && getRightService().hasAccessLevel("view", XWikiRightService.GUEST\_USER\_FULLNAME, |
|  |  | doc.getPrefixedFullName(), context)) |
|  |  | || ((action.equals("view") && doc.getFullName().equals("XWiki.AccountValidation")))) { |
|  |  | allow = true; |
|  |  | } else { |
|  |  | String allowed = getConfiguration().getProperty("xwiki.inactiveuser.allowedpages", ""); |
|  |  | if (context.getAction().equals("view") && !allowed.equals("")) { |
|  |  | String[] allowedList = StringUtils.split(allowed, " ,"); |
|  |  | for (String element : allowedList) { |
|  |  | if (element.equals(doc.getFullName())) { |
|  |  | allow = true; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | if (!allow) { |
|  |  | Object[] args = { context.getUser() }; |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI\_USER, XWikiException.ERROR\_XWIKI\_USER\_INACTIVE, |
|  |  | "User {0} account is inactive", null, args); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (!"skin".equals(context.getAction()) |
| Expand Down  Expand Up | | @@ -5969,6 +5939,37 @@ && getRightService().hasAccessLevel("view", XWikiRightService.GUEST\_USER\_FULLNAM |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | private void handleInactiveUserViewAction(XWikiUser inactiveUser, XWikiContext context, DocumentReference reference, |
|  |  | VelocityContext vcontext) throws XWikiException |
|  |  | { |
|  |  | if (inactiveUser.isEmailChecked(context)) { |
|  |  | Object[] args = { inactiveUser.getUser() }; |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI\_USER, XWikiException.ERROR\_XWIKI\_USER\_DISABLED, |
|  |  | "User {0} account is disabled", null, args); |
|  |  | } else if (!reference.getLocalDocumentReference().equals(XWikiUser.ACCOUNT\_VALIDATION\_DOCUMENT\_REFERENCE)) { |
|  |  | String allowed = getConfiguration().getProperty("xwiki.inactiveuser.allowedpages", ""); |
|  |  | boolean allow = false; |
|  |  | if (!StringUtils.isEmpty(allowed)) { |
|  |  | XWikiDocument doc = this.getDocument(reference, context); |
|  |  | String[] allowedList = StringUtils.split(allowed, " ,"); |
|  |  | for (String element : allowedList) { |
|  |  | if (element.equals(doc.getFullName())) { |
|  |  | allow = true; |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (!allow) { |
|  |  | Object[] args = { inactiveUser.getUser() }; |
|  |  | setPhonyDocument(reference, context, vcontext); |
|  |  | throw new XWikiException(XWikiException.MODULE\_XWIKI\_USER, XWikiException.ERROR\_XWIKI\_USER\_INACTIVE, |
|  |  | "User {0} account is inactive", null, args); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @since 8.3M1 |
|  |  | \*/ |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWikiContext.java](#diff-d01364a3441e47aaf5b8406c8751cb890cd47978d6013b5df0434611aceba069 "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWikiContext.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/XWikiContext.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -101,6 +101,16 @@ public class XWikiContext extends Hashtable<Object, Object> |
|  |  | @Deprecated |
|  |  | public static final String KEY\_LEGACY\_VELOCITYCONTEXT = "vcontext"; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The reference of a logged-in inactive user: in such case the context user reference is guest, so we store |
|  |  | \* the actual logged-in user with that key. |
|  |  | \* |
|  |  | \* @since 14.3RC1 |
|  |  | \* @since 13.10.5 |
|  |  | \*/ |
|  |  | @Unstable |
|  |  | public static final String INACTIVE\_USER\_REFERENCE = "inactiveUserReference"; |
|  |  |  |
|  |  | /\*\* Logging helper object. \*/ |
|  |  | protected static final Logger LOGGER = LoggerFactory.getLogger(XWikiContext.class); |
|  |  |  |
| Expand Down | |  |

10 changes: 8 additions & 2 deletions

10
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/XWiki.java](#diff-587d13376a3e9815a2fbbb7adc7053bd3ca6c150224107704a113a0e561fa86f "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/XWiki.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/api/XWiki.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2910,7 +2910,7 @@ public String getCounter(String name) |
|  |  | \*/ |
|  |  | public XWikiUser checkAuth() throws XWikiException |
|  |  | { |
|  |  | return this.context.getWiki().getAuthService().checkAuth(this.context); |
|  |  | return this.context.getWiki().checkAuth(this.context); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -2925,7 +2925,13 @@ public XWikiUser checkAuth() throws XWikiException |
|  |  | \*/ |
|  |  | public XWikiUser checkAuth(String username, String password, String rememberme) throws XWikiException |
|  |  | { |
|  |  | return this.context.getWiki().getAuthService().checkAuth(username, password, rememberme, this.context); |
|  |  | XWikiUser user = |
|  |  | this.context.getWiki().getAuthService().checkAuth(username, password, rememberme, this.context); |
|  |  | if (user.isDisabled(this.context)) { |
|  |  | this.context.put(XWikiContext.INACTIVE\_USER\_REFERENCE, user.getUserReference()); |
|  |  | user = null; |
|  |  | } |
|  |  | return user; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[...-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/api/XWikiUser.java](#diff-1ef60999abd1382c4450cd90da192bf97c2841d9d4cd2e1708033eeef396fb0c "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/api/XWikiUser.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/api/XWikiUser.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,6 +29,7 @@ |
|  |  | import org.xwiki.model.reference.DocumentReference; |
|  |  | import org.xwiki.model.reference.DocumentReferenceResolver; |
|  |  | import org.xwiki.model.reference.EntityReferenceSerializer; |
|  |  | import org.xwiki.model.reference.LocalDocumentReference; |
|  |  | import org.xwiki.model.reference.WikiReference; |
|  |  |  |
|  |  | import com.xpn.xwiki.XWiki; |
| Expand Down  Expand Up | | @@ -58,6 +59,9 @@ public class XWikiUser |
|  |  | \*/ |
|  |  | public static final String EMAIL\_CHECKED\_PROPERTY = "email\_checked"; |
|  |  |  |
|  |  | public static final LocalDocumentReference ACCOUNT\_VALIDATION\_DOCUMENT\_REFERENCE = |
|  |  | new LocalDocumentReference(XWiki.SYSTEM\_SPACE, "AccountValidation"); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @see com.xpn.xwiki.internal.model.reference.CurrentMixedStringDocumentReferenceResolver |
|  |  | \*/ |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[...dge/src/main/java/org/xwiki/security/authorization/internal/XWikiCachingRightService.java](#diff-f3f5ad9cd93dab119467c8807c421fb567dfaf45e65a0e11573360efb7dd7cbd "xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authorization/xwiki-platform-security-authorization-bridge/src/main/java/org/xwiki/security/authorization/internal/XWikiCachingRightService.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/e074d226d9b2b96a0a1ba4349d1b73a802842986/xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authorization/xwiki-platform-security-authorization-bridge/src/main/java/org/xwiki/security/authorization/internal/XWikiCachingRightService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -280,7 +280,9 @@ public boolean checkAccess(String action, XWikiDocument doc, XWikiContext contex |
|  |  | // implementation, so code that simply want to verify if a user can delete (but is not actually deleting) |
|  |  | // has to call checkAccess. This happen really often, and this why we should not redirect to login on failed |
|  |  | // delete, since it would prevent most user to do anything. |
|  |  | if (context.getUserReference() == null && !DELETE\_ACTION.equals(action) && !LOGIN\_ACTION.equals(action)) { |
|  |  | // Also we don't show the login if an inactive user logged in. |
|  |  | if (context.getUserReference() == null && !DELETE\_ACTION.equals(action) && !LOGIN\_ACTION.equals(action) |
|  |  | && context.get(XWikiContext.INACTIVE\_USER\_REFERENCE) == null) { |
|  |  | LOGGER.debug("Redirecting unauthenticated user to login, since it have been denied [{}] on [{}].", |
|  |  | right, entityReference); |
|  |  | showLogin(context); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e074d22`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2Fe074d226d9b2b96a0a1ba4349d1b73a802842986) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_b282a8a4_20250114_181018.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19559)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19559)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19559](/browse/XWIKI-19559)

# The fact that a user is inactive is far from being taken into account everywhere

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19559 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [13.10.5](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.5 "13.10.5 "), [14.3-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.3-rc-1 "14.3-rc-1 ")
* **Affects Version/s:**
  1.1 M3
* **Component/s:**
  [Old Core](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Old+Core%22 "Old Core ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_account](/issues/?jql=labels+%3D+attacker_account "attacker_account")
  + [bugfixingday](/issues/?jql=labels+%3D+bugfixingday "bugfixingday")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Integration
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

Currently, a disabled user is still authenticated and set in the standard context and only really taken into account in XWiki#prepareDocuments which generate an exception for all actions but only

```
if (!((action.equals("skin") && (doc.getSpace().equals("skins") || doc.getSpace().equals("resources")))
                || ((action.equals("skin") || action.equals("download") || action.equals("ssx") || action.equals("jsx"))
                    && getRightService().hasAccessLevel("view", XWikiRightService.GUEST_USER_FULLNAME,
                        doc.getPrefixedFullName(), context))
                || ((action.equals("view") && doc.getFullName().equals("XWiki.AccountValidation"))))) {

```

But it's not taken into account in the REST API (or all resource reference handler which require an authenticated user) which means the user can pretty much do anything it wants (including enabling itself I think, unless there is a listener to protect that).

IMO, the user should be authenticated but should not be set as context user and instead be set in a special property storing the disabled user so that things related to disabled user can check it. That way, the access is safe by default (most of the code will see the context as not being authenticated) and only if you want to do something special with disabled user (like a process to be granted access again) you still have the info.

Reproduction steps:

* Create a user Foo and disable it
* Send following request with Foo authentication headers:
  ```
  curl -X PUT -i 'http://localhost:8080/xwiki/rest/wikis/xwiki/spaces/XWiki/pages/Foo/objects/XWiki.XWikiUsers/0/properties/active' --data 1

  ```
* Login with Foo on the wiki

Expected result:

* Foo should still be disabled and the CURL request should not work

Obtained result:

* Foo is now enabled

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19645](/browse/XWIKI-19645)
Manual user account validation using a validation key does not succeed due to a NPE

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19696](/browse/XWIKI-19696)
Disabled users can access and download attachments from wiki pages

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=13510&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[XWIKI-12654](/browse/XWIKI-12654)
Add UI to activate/deactivate users

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Github Security advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-jgc8-gvcx-9vfx)

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![tmortagne](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Thomas Mortagne

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

23/Mar/22 18:01

Updated:

08/Sep/22 14:34

Resolved:

31/Mar/22 17:23

Date of First Response:

24/Mar/22 11:11 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from github.com_c44cb4d9_20250114_181017.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-jgc8-gvcx-9vfx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-jgc8-gvcx-9vfx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

# Improper Authorization check for inactive users in org.xwiki.platform:xwiki-platform-oldcore

High

[surli](/surli)
published
GHSA-jgc8-gvcx-9vfx
Sep 8, 2022

## Package

maven

org.xwiki.platform:xwiki-platform-oldcore
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 13.10.5, < 14.3RC1

## Patched versions

13.10.5, 14.3RC1

## Description

### Impact

Some resources are missing a check for inactive (not yet activated or disabled) users in XWiki, including the REST service: so a disabled user can enable themselves using a REST call. On the same way some resources handler created by extensions are not protected by default: so an inactive users could perform actions for such extensions.

This issue exists since at least version 1.1 of XWiki for instance configured with the email activation required for new users. Now it's more critical for newer versions (>= 11.3RC1) since we provided the capability to disable user without deleting them, and we encouraged using that feature.

### Patches

This issue has been patched in XWiki 14.3RC1 and XWiki 13.10.5.

### Workarounds

There is no workaround for this other than upgrading XWiki.

### References

* <https://jira.xwiki.org/browse/XWIKI-19559>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Jira XWiki.org](https://jira.xwiki.org)
* Email us at security mailing-list

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N

### CVE ID

CVE-2022-36090

### Weaknesses

[CWE-285](/advisories?query=cwe%3A285)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


