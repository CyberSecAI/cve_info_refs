```
{
  "vulnerability_details": {
    "root_cause": "An out-of-bounds write occurs when parsing Mach-O files due to an incorrect size check. Specifically, in the `reconstruct_chained_fixup` function, the code calculates a `page_index` and uses it to access the `cur_seg->page_start` array without properly checking if the index is within the allocated size for page_start. The size of `page_start` is calculated using `cur_seg->page_count`, but the code compares `page_index` with `maxsize = cur_seg->page_count * sizeof(ut16)`, not `cur_seg->page_count` itself before accessing the array.",
    "weaknesses": [
      "CWE-787: Out-of-bounds Write"
    ],
    "impact": "An attacker can execute arbitrary code on the user's machine by opening a crafted Mach-O file.",
    "attack_vectors": "The vulnerability is triggered by opening a malicious Mach-O file.",
    "required_capabilities": "An attacker needs to craft a malicious Mach-O file that triggers the out-of-bounds write in the `reconstruct_chained_fixup` function when parsed by rizin."
  },
  "affected_versions": "<=0.4.0",
  "patched_versions": "0.4.1",
  "references": [
    "https://github.com/rizinorg/rizin/commit/348b1447d1452f978b69631d6de5b08dd3bdf79d",
    "https://github.com/rizinorg/rizin/issues/2956",
     "https://github.com/rizinorg/rizin/commit/7323e64d68ecccfb0ed3ee480f704384c38676b2",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-36041"
  ],
    "additional_notes": "The vulnerability was identified through fuzzing and reported by m4drat. The fix was implemented in commit 7323e64 and further refined in later commits. The affected code is located in `librz/bin/format/mach0/mach0.c`."
}
```