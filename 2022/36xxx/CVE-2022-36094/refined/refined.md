Based on the provided information, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability is due to insufficient sanitization of the filename when displaying the attachment history. Specifically, the filename is rendered without proper escaping in the title of the attachment history page (`viewattachrev.vm`) and the image alt tag.

**Weaknesses/vulnerabilities present:**

*   **Cross-Site Scripting (XSS):** A persistent XSS vulnerability exists because an attacker can inject malicious JavaScript code into the filename of an attachment. This code is then executed when a user views the attachment history.

**Impact of exploitation:**

*   **Privilege Escalation:** An attacker with write access to a user profile can inject JavaScript. When a user with higher privileges (e.g., programming rights) views the attachment history, the injected JavaScript executes with their rights, potentially leading to privilege escalation.
*   **Arbitrary JavaScript Execution:** Any user who views the attachment history of a maliciously named file will execute the attacker's JavaScript code. This could allow the attacker to perform actions on behalf of the user, such as stealing session cookies, performing unauthorized actions, or redirecting to malicious sites.
*   **Denial of Service (Low):** While not a primary impact, the injected JavaScript could potentially disrupt the functionality of the page.

**Attack vectors:**

*   **File Upload:** The attacker uploads a file with a malicious filename containing JavaScript code.
*   **Attachment History View:** The attacker relies on other users viewing the attachment history.

**Required attacker capabilities/position:**

*   **Write Access:** The attacker needs write access to a wiki page to upload an attachment with a malicious filename. This can be a standard user account with the ability to edit content.
*   **User Interaction:** The vulnerability is triggered when another user views the attachment history of the maliciously named attachment. Therefore, user interaction is required for exploitation.

**Additional details:**

*   The vulnerable code is located in the `viewattachrev.vm` template.
*   The fix involves escaping the filename using `$escapetool.xml()` when rendering the title and image alt tag.
*   The vulnerability is fixed in XWiki versions 13.10.6 and 14.3-rc-1.
*   The GitHub Security Advisory for this vulnerability is [GHSA-mxf2-4r22-5hq9](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mxf2-4r22-5hq9).
*   The vulnerability is tracked in the XWiki JIRA issue [XWIKI-19612](https://jira.xwiki.org/browse/XWIKI-19612).
*   The CVSS score for this vulnerability is 8.9 (High) with a vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L