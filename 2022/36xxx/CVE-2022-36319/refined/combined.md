=== Content from www.mozilla.org_d88091a1_20250115_090504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-29

## Security Vulnerabilities fixed in Firefox ESR 91.12

Announced
July 26, 2022
Impact
moderate
Products
Firefox ESR
Fixed in

* Firefox ESR 91.12

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_6777f65d_20250115_090504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-31

## Security Vulnerabilities fixed in Thunderbird 91.12

Announced
July 28, 2022
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 91.12

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a9782967_20250115_090504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-32

## Security Vulnerabilities fixed in Thunderbird 102.1

Announced
July 28, 2022
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 102.1

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Thunderbird for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-2505: Memory safety bugs fixed in Thunderbird 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d875bec4_20250115_090503.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-28

## Security Vulnerabilities fixed in Firefox 103

Announced
July 26, 2022
Impact
moderate
Products
Firefox
Fixed in

* Firefox 103

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36317: Long URL would hang Firefox for Android](#CVE-2022-36317)

Reporter
Irwan
Impact
moderate
##### Description

When visiting a website with an overly long URL, the user interface would start to hang. Due to session restore, this could lead to a permanent Denial of Service.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1759951](https://bugzilla.mozilla.org/show_bug.cgi?id=1759951)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-36315: Preload Cache Bypasses Subresource Integrity](#CVE-2022-36315)

Reporter
Hiroshige Hayashizaki
Impact
low
##### Description

When loading a script with Subresource Integrity, attackers with an injection capability could trigger the reuse of previously cached entries with incorrect, different integrity metadata.

##### References

* [Bug 1762520](https://bugzilla.mozilla.org/show_bug.cgi?id=1762520)

#### [#CVE-2022-36316: Performance API leaked whether a cross-site resource is redirecting](#CVE-2022-36316)

Reporter
Jannis Rautenstrauch
Impact
low
##### Description

When using the Performance API, an attacker was able to notice subtle differences between PerformanceEntries and thus learn whether the target URL had been subject to a redirect.

##### References

* [Bug 1768583](https://bugzilla.mozilla.org/show_bug.cgi?id=1768583)

#### [#CVE-2022-36320: Memory safety bugs fixed in Firefox 103](#CVE-2022-36320)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1759794%2C1760998)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_feedd457_20250115_090503.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1737722)
* [XML](/show_bug.cgi?ctype=xml&id=1737722)

Closed
[Bug 1737722](/show_bug.cgi?id=1737722)
(CVE-2022-36319)

Opened 3 years ago
Closed 3 years ago

# Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position

## Categories

### (Firefox :: Security, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Security#Security)

Security
▾

Firefox :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

104 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox-esr91 | [103+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=103%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox-esr102 | [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox93 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix) |
| firefox94 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix) |
| firefox95 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=wontfix) |
| firefox96 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix) |
| firefox102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix) |
| firefox103 | [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=verified) |
| firefox104 | [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr91 | 103+ | verified |
| firefox-esr102 | 103+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox93 |  | wontfix |
| firefox94 |  | wontfix |
| firefox95 |  | wontfix |
| firefox96 |  | wontfix |
| firefox102 |  | wontfix |
| firefox103 | + | verified |
| firefox104 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: tnikkel)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0646a42110a02dd585f200f270716852?d=mm&size=40)  [tnikkel](/user_profile?user_id=255010)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fe2c2192f4fabf01f2d2e700631bb8fe?d=mm&size=40)  [manuel](/user_profile?user_id=688976)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

### (Regressed 1 open bug, Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1792447](/show_bug.cgi?id=1792447 "NEW - Mousewheel input stops working within iframes using CSS perspective with certain matrix3D values")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1675547](/show_bug.cgi?id=1675547 "RESOLVED FIXED - Better handle hit-testing when inactive scrollframes intersect OOPIFs")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+][adv-esr102.1+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-36319

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+][adv-esr102.1+]

QA Whiteboard:

[qa-triaged][post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a21835833_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (13 files)

| [launcher.zip](/attachment.cgi?id=9247667)  [3 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   7.39 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9247667&action=edit) |
| --- | --- | --- |
| [Firefox - Redirect Mouse Position to Allow Permission on Windows 10.mp4](/attachment.cgi?id=9247668)  [3 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   185.07 KB, video/mp4 |  | [Details](/attachment.cgi?id=9247668&action=edit) |
| [Firefox - Redirect Mouse Input to Allow Permission on KDE X11.mp4](/attachment.cgi?id=9247670)  [3 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   319.91 KB, video/mp4 |  | [Details](/attachment.cgi?id=9247670&action=edit) |
| [launcher-webextension.zip](/attachment.cgi?id=9247723)  [3 years ago](#c3)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   7.66 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9247723&action=edit) |
| [Firefox - Redirect Mouse Input to Add WebExtension on Windows 10.mp4](/attachment.cgi?id=9247724)  [3 years ago](#c4)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   156.47 KB, video/mp4 |  | [Details](/attachment.cgi?id=9247724&action=edit) |
| [launcher-scaling-100.zip](/attachment.cgi?id=9247748)  [3 years ago](#c5)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   4.36 KB, application/zip |  | [Details](/attachment.cgi?id=9247748&action=edit) |
| [Firefox - Redirect Mouse Input to Install WebExtension on Windows 10 (scaling 100%).mp4](/attachment.cgi?id=9247752)  [3 years ago](#c6)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   168.23 KB, video/mp4 |  | [Details](/attachment.cgi?id=9247752&action=edit) |
| [launcher-mozregression-20180502.zip](/attachment.cgi?id=9248098)  [3 years ago](#c13)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.14 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9248098&action=edit) |
| [Firefox 61.0a1 - Redirect Mouse Event Coordinate Away.mp4](/attachment.cgi?id=9248099)  [3 years ago](#c14)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   615.10 KB, video/mp4 |  | [Details](/attachment.cgi?id=9248099&action=edit) |
| [compare.txt](/attachment.cgi?id=9248231)  [3 years ago](#c15)  [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)   6.92 KB, text/plain |  | [Details](/attachment.cgi?id=9248231&action=edit) |
| [Bug 1737722. r?botond](/attachment.cgi?id=9275430)  [3 years ago](#c18)  [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c26 "3 years ago")  dmeehan : [approval-mozilla-esr102+](#c26 "3 years ago") | [Details](/attachment.cgi?id=9275430&action=edit) | [Review](/attachment.cgi?id=9275430) |
| [Bug 1737722. esr91. r?botond](/attachment.cgi?id=9285574)  [3 years ago](#c24)  [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-esr91+](#c30 "3 years ago") | [Details](/attachment.cgi?id=9285574&action=edit) | [Review](/attachment.cgi?id=9285574) |
| [advisory.txt](/attachment.cgi?id=9286179)  [2 years ago](#c34)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   201 bytes, text/plain |  | [Details](/attachment.cgi?id=9286179&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1737722#c0)• 3 years ago |
|  | |

Attached file
[launcher.zip](attachment.cgi?id=9247667)
— [Details](attachment.cgi?id=9247667&action=edit)

After using `overflow-block: hidden` combined with large `transform: scale` surprisingly the mouse input will be redirected to another position (including on Toolbar, Permission panel). I found the redirect click position can be controlled through `scale` number to click "Allow" on the permission panel while the visible cursor position still on the HTML page.

As the testcase using `scale` to redirect the mouse input, the mouse redirect position may different across OS (i.e. not hitting the permission panel), I have adjusted the scale number on the testcase to work (as on PoC video) on the following device (with Fission enabled):

## Tested on:

* Firefox 95.0a1 (2021-10-25) on Arch Linux (X11) (2560x1440)
* Firefox 95.0a1 (2021-10-25) on Windows 10 (Laptop with 1920x1080 screen and VirtualBox VM with 2560x1440 guest screen)

## Steps to reproduce:

1. Extract attached launcher.zip
2. Visit attached launcher-windows.bundle.html or launcher-kdex11.bundle.html
3. Click "Launch" button
4. Move cursor to "Download" image, the "Allow" button on permission panel will be highlighted
5. While the "Allow" button highlighted
6. Click the "Download" image
7. Location permission is now allowed
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1737722#c1)• 3 years ago |
|  | |

Attached video
[Firefox - Redirect Mouse Position to Allow Permission on Windows 10.mp4](attachment.cgi?id=9247668)
— [Details](attachment.cgi?id=9247668&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1737722#c2)• 3 years ago |
|  | |

Attached video
[Firefox - Redirect Mouse Input to Allow Permission on KDE X11.mp4](attachment.cgi?id=9247670)
— [Details](attachment.cgi?id=9247670&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1737722#c3)• 3 years ago |
|  | |

Attached file
[launcher-webextension.zip](attachment.cgi?id=9247723)
— [Details](attachment.cgi?id=9247723&action=edit)

It is also possible to redirect mouse input to "Add" WebExtension while cursor on "Download" image. The WebExtension install PoC is attached in launcher-webextension.zip.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1737722#c4)• 3 years ago |
|  | |

Attached video
[Firefox - Redirect Mouse Input to Add WebExtension on Windows 10.mp4](attachment.cgi?id=9247724)
— [Details](attachment.cgi?id=9247724&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1737722#c5)• 3 years ago |
|  | |

Attached file
[launcher-scaling-100.zip](attachment.cgi?id=9247748)
— [Details](attachment.cgi?id=9247748&action=edit)

Okay, it turns out the OS Display Scaling is the big factor, all above testcase is reproduced on OS scaling 125%, when I change the display scaling to 100% the entire behavior is different.

I've adjusted the `scale` to be able to reproduce on OS scaling 100%, also tested works on same device above. I see after changing resolution on guest machine (auto-resize guest display) the testcase still works the same.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1737722#c6)• 3 years ago |
|  | |

Attached video
[Firefox - Redirect Mouse Input to Install WebExtension on Windows 10 (scaling 100%).mp4](attachment.cgi?id=9247752)
— [Details](attachment.cgi?id=9247752&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a67242_1689)• 3 years ago |

See Also: → [CVE-2021-43546](/show_bug.cgi?id=1737751 "VERIFIED FIXED - users with zoomed cursors vulnerable to spoofed cursors leaking into the addressbar")

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1737722#c7)• 3 years ago |
|  | |

This is a totally different issue from [bug 1737751](/show_bug.cgi?id=1737751 "VERIFIED FIXED - users with zoomed cursors vulnerable to spoofed cursors leaking into the addressbar"). This is probably math errors in APZ with really big transforms causing mouse events to go outside the content area or such. Botond / Hiro, perhaps you know where stuff might be going wrong?

Flags: needinfo?(hikezoe.birchill)Flags: needinfo?(botond)

|  | [Hiroyuki Ikezoe (:hiro)](/user_profile?user_id=131213) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1737722#c8)• 3 years ago |
|  | |

Though I can't reproduce this issue on my Linux box with 200% scaled display (I don't even see the download image), it looks an our webrender hit testing issue. If Botond is hard to take time on this, I will jump in.

One thing I don't yet quite understand is, the permission popup window is not apz-aware one, how we pick it. Even if APZ picked a wrong target, I assume it's the newly opened browser window, then the browser window chooses the popup? That's a plausible scenario I can think of.

I wonder whether this issue also happens with the old non webrender backend.

|  | [Hiroyuki Ikezoe (:hiro)](/user_profile?user_id=131213) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1737722#c9)• 3 years ago |
|  | |

Oops, I forgot saying, I did CC Timothy, he might have some insights on this.

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1737722#c10)• 3 years ago |
|  | |

Fission is required for me to reproduce. Webrender is also required for me to reproduce (if I use nightly 2021-06-01 where I can disable webrender).

Regression from [bug 1675547](/show_bug.cgi?id=1675547 "RESOLVED FIXED - Better handle hit-testing when inactive scrollframes intersect OOPIFs"). I'm guessing there is a scroll frame we activate in the dialog so that apz can target it? Whereas before that change it was not active, so apz could not target it. So the bug was likely present before that bug, and could manifest if a dialog had an already active scroll frame in it.

Webrender still seems required though, if I turn on fission, webrender off, and activate all scroll frames for nonwr on then I can't reproduce.

Confirmed that flipping apz.wr.activate\_all\_scroll\_frames\_when\_fission to false fixes the problem.

Confirmed that setting apz.wr.activate\_all\_scroll\_frames to true allows me to reproduce when fission is disabled.

Regressed by: [1675547](/show_bug.cgi?id=1675547 "RESOLVED FIXED - Better handle hit-testing when inactive scrollframes intersect OOPIFs")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a87384_546015)• 3 years ago |

Has Regression Range: --- → yesKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1737722#c11)• 3 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1675547](/show_bug.cgi?id=1675547 "RESOLVED FIXED - Better handle hit-testing when inactive scrollframes intersect OOPIFs")

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected)
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1737722#c12)• 3 years ago |
|  | |

The scrollframe that gets activated is the body of the page in the test case. And indeed I can reproduce the bug without fission if I do something to make that scrollframe active first.

We untransform the mouse coords before passing them to the root presshell in the parent process here

<https://searchfox.org/mozilla-central/rev/f8576fec48d866c5f988baaf1fa8d2f8cce2a82f/gfx/layers/apz/src/APZCTreeManager.cpp#1553>

the transforms there are

transformToApzc

[7.8287222038397886e-08 0 0 0]

[0 7.8287222038397886e-08 0 0]

[0 0 1 0]

[883.99981689453125 74.155632019042969 0 1]

transformToGecko

[12773476 0 0 0]

[0 12773476 0 0]

[0 0 1 0]

[-11291751424 -947225216 0 1]

outTransform

[0.99999994039535522 0 0 0]

[0 0.99999994039535522 0 0]

[0 0 1 0]

[-1024 0 0 1]

So it's as if we have a 1024 pixel async scroll offset permanently. I haven't worked out in detail how we get these matrices but the large scales involved seem like they could generate these, with the -1024 coming about because of float inaccuracies?

When we build the display list for GetFrameForPoint to find the targeted frame I guess we walk into the placeholders for open menupopups (like we do for other out of flow content like fixed or abs pos) and so we can target things in the popup with an event that was sent to the main widget, and the root frame of it.

I haven't thought about how to fix this very much yet, but possible ideas so far:

1. treat apzcs with scales too big or too small as if the transform is non-invertible, ie they are dead to events etc. We'd have to come up with some kind of assurance that the limits work to avoid this problem and also don't affect real content.
2. do the required computations somehow to avoid the floating point inaccuracies. Is this always possible? Don't we eventually have to hit a limit?
3. something else.

The old layers hit testing code did seem to manage to avoid this (although it might just be luck), so perhaps looking into that might be useful. It could also be a dead end as the webrender hit testing is quite different and necessarily (for fission) more precise.

Even if we fix this large/small scale issue wouldn't it be possible for a page to create a long-lasting async scroll offset to cause mouse events in the content area to target chrome? The page could for example ask for a smooth scroll and then immediately enter an infinite busy loop. Or the page could be designed in such a way that the user wants to scroll down the right amount while the page is already in an infinite busy loop.

Even outside of attacker scenarios, if there is an async scroll offset of 100 on a scrollable subframe, and the user clicks in the subframe, but within 100 pixels of the scrollport of the subframe, the click will get moved 100 pixels to be outside of the subframe scrollport. More generally, anytime that we untransform using the targeted apzc A1 but then when we dispatch the event and find the frame target T, and T is not a descendant of A1 we will send the event to the wrong place.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1737722#c13)• 3 years ago |
|  | |

Attached file
[launcher-mozregression-20180502.zip](attachment.cgi?id=9248098)
— [Details](attachment.cgi?id=9248098&action=edit)

I can only reproduce the issue when WebRender is enabled, it turns out I also able to reproduce on Fission disabled.

By using `overflow-y: hidden` combined with transform `scale` or `matrix` it also works to move the mouse coordinate.

When using mozregression with prefs `gfx.webrender.enabled: true` then visit attached launcher-mozregression-20180502.zip testcase, I can reproduce the issue from FF build date 2018-05-02, after the popup launched, right-clicking the page will show the context menu away from the cursor position.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1737722#c14)• 3 years ago |
|  | |

Attached video
[Firefox 61.0a1 - Redirect Mouse Event Coordinate Away.mp4](attachment.cgi?id=9248099)
— [Details](attachment.cgi?id=9248099&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a159512_1689)• 3 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: [CVE-2021-43546](/show_bug.cgi?id=1737751 "VERIFIED FIXED - users with zoomed cursors vulnerable to spoofed cursors leaking into the addressbar") →

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1737722#c15)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1737722&comment_id=15633000 "1 revision") |
|  | |

Attached file
[compare.txt](attachment.cgi?id=9248231)
— [Details](attachment.cgi?id=9248231&action=edit)

The first two matrices in [comment 12](/show_bug.cgi?id=1737722#c12 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position") are actually inverses of each other, however the 883.99981689453125 in the first matrix can't be represented accurately enough by a float so that the -1024 doesn't show up in the product. It should be 883.999893529, note how it starts differing after 7 digits, ie float precision.

So that might lead to a solution: if the transform matrix of an apzc times it's inverse is too far from the identity then we don't allow it to produce a hit.

I looked at why layers isn't affected and I think it's just dumb luck: when testing if the apzc for the body element is a hit we determine that it is not (which is incorrect) and so we hit the html element and we avoid any big scales.

Attached the hit testing tree and hittest comparing layers and webrender.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a258986_75935)• 3 years ago |

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix)

|  | [Botond Ballo [:botond]](/user_profile?user_id=474533) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1737722#c16)• 3 years ago |
|  | |

Thanks Timothy for investigating!

(In reply to Timothy Nikkel (:tnikkel) from [comment #15](/show_bug.cgi?id=1737722#c15 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> The first two matrices in [comment 12](/show_bug.cgi?id=1737722#c12 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position") are actually inverses of each other, however the 883.99981689453125 in the first matrix can't be represented accurately enough by a float so that the -1024 doesn't show up in the product. It should be 883.999893529, note how it starts differing after 7 digits, ie float precision.
>
> So that might lead to a solution: if the transform matrix of an apzc times it's inverse is too far from the identity then we don't allow it to produce a hit.

This approach sounds promising to me.

(In reply to Timothy Nikkel (:tnikkel) from [comment #12](/show_bug.cgi?id=1737722#c12 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> Even if we fix this large/small scale issue wouldn't it be possible for a page to create a long-lasting async scroll offset to cause mouse events in the content area to target chrome? The page could for example ask for a smooth scroll and then immediately enter an infinite busy loop. Or the page could be designed in such a way that the user wants to scroll down the right amount while the page is already in an infinite busy loop.
>
> Even outside of attacker scenarios, if there is an async scroll offset of 100 on a scrollable subframe, and the user clicks in the subframe, but within 100 pixels of the scrollport of the subframe, the click will get moved 100 pixels to be outside of the subframe scrollport. More generally, anytime that we untransform using the targeted apzc A1 but then when we dispatch the event and find the frame target T, and T is not a descendant of A1 we will send the event to the wrong place.

My understanding is that [FlushRepaintsToClearScreenToGeckoTransform()](https://searchfox.org/mozilla-central/rev/7588d077255c5732f72c466e71d7a38d97385dd5/gfx/layers/apz/src/APZCTreeManager.cpp#2442), which is called when receiving a mouse-down among other scenarios, is intended to address this issue in the case where it arises from an actual async transform (rather than an inaccuracy introduced by multiplying a CSS transform by its inverse).

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1737722#c17)• 3 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1675547](/show_bug.cgi?id=1675547 "RESOLVED FIXED - Better handle hit-testing when inactive scrollframes intersect OOPIFs")

[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected)

|  | [Botond Ballo [:botond]](/user_profile?user_id=474533) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a1375362_474533)• 3 years ago |

Flags: needinfo?(botond)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a7499279_690067)• 3 years ago |

[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=wontfix)
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a7578783_575867)• 3 years ago |

Type: task → defect

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1737722#c18)• 3 years ago |
|  | |

Attached file
[Bug 1737722. r?botond](attachment.cgi?id=9275430)
— [Details](attachment.cgi?id=9275430&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a16628799_600971)• 3 years ago |

Assignee: nobody → tnikkelStatus: NEW → ASSIGNED

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1737722#c19)• 3 years ago |
|  | |

(In reply to Timothy Nikkel (:tnikkel) from [comment #12](/show_bug.cgi?id=1737722#c12 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> When we build the display list for GetFrameForPoint to find the targeted frame I guess we walk into the placeholders for open menupopups (like we do for other out of flow content like fixed or abs pos) and so we can target things in the popup with an event that was sent to the main widget, and the root frame of it.

Just wanted to clarify this point (if not for anyone else at least for myself). We don't walk into popup out of flows when building a display list for hit testing.

<https://searchfox.org/mozilla-central/rev/8bd5597baef9be63fc4689a69e550d607dc68444/layout/generic/nsIFrame.cpp#4131>

In PresShell::EventHandler::ComputeRootFrameToHandleEvent we call ComputeRootFrameToHandleEventWithPopup

<https://searchfox.org/mozilla-central/rev/8bd5597baef9be63fc4689a69e550d607dc68444/layout/base/PresShell.cpp#7725>

which eventually iterates the list of open popups

<https://searchfox.org/mozilla-central/rev/8bd5597baef9be63fc4689a69e550d607dc68444/layout/base/nsLayoutUtils.cpp#1765>

to see if one of them is where the event should be handled.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1737722#c20)• 3 years ago |
|  | |

Backed out for causing build bustages in WRHitTester.cpp:

<https://hg.mozilla.org/integration/autoland/rev/3a0817ff4dc34ecc5495b0556295c768fa8f4f73>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=retry%2Ctestfailed%2Cbusted%2Cexception%2Cusercancel&revision=121326268074712ac379a9a6a9308e08ce110e1f>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=383003066&repo=autoland>

> gfx/layers/apz/src/WRHitTester.cpp:154:66: error: too few arguments to function call, expected 2, have 1

Flags: needinfo?(tnikkel)

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a21512127_255010)• 3 years ago |

Flags: needinfo?(tnikkel)Flags: needinfo?(hikezoe.birchill)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1737722#c21)• 3 years ago |
|  | |

r=botond

<https://hg.mozilla.org/integration/autoland/rev/7e14d6a790b288a98eb4a9190e9b737e9e7f01e2>

<https://hg.mozilla.org/mozilla-central/rev/7e14d6a790b2>

Status: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 104 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a21835833_1689)• 3 years ago |

Flags: sec-bounty?Flags: sec-bounty+Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1737722#c22)• 3 years ago |
|  | |

Is this ready for uplift requests? Note that ESR91 will need a bit of rebasing due to [bug 1729118](/show_bug.cgi?id=1729118 "RESOLVED FIXED - Move APZ's internal hit test implementation from APZCTreeManager to test code").

Group: firefox-core-security → core-security-release
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix)
[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=%2B)
[tracking-firefox104](/buglist.cgi?f1=cf_tracking_firefox104&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=103%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F)Flags: needinfo?(tnikkel)

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1737722#c23)• 3 years ago |
|  | |

Comment on [attachment 9275430](/attachment.cgi?id=9275430 "Bug 1737722. r?botond") [[details]](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond")

[Bug 1737722](/show_bug.cgi?id=1737722 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). r?botond

### Beta/Release Uplift Approval Request

* **User impact if declined**: attacker could user move mouse input
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: patch only has an effect with huge transforms that real content should never hit
* **String changes made/needed**:
* **Is Android affected?**: No

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec mod, low risk
* **User impact if declined**: attacker could user move mouse input
* **Fix Landed on Version**: 104
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: patch only has an effect with huge transforms that real content should never hit
Flags: needinfo?(tnikkel)
[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-esr102?
[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-beta?

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1737722#c24)• 3 years ago |
|  | |

Attached file
[Bug 1737722. esr91. r?botond](attachment.cgi?id=9285574)
— [Details](attachment.cgi?id=9285574&action=edit)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a22667941_553429)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1737722#c25)• 3 years ago |
|  | |

A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party.

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1737722#c26)• 3 years ago |
|  | |

Comment on [attachment 9275430](/attachment.cgi?id=9275430 "Bug 1737722. r?botond") [[details]](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond")

[Bug 1737722](/show_bug.cgi?id=1737722 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). r?botond

Approved for 103.0 RC1 and ESR102.1, thanks.

[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-esr102?
[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-esr102+
[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-beta?
[Attachment #9275430](/attachment.cgi?id=9275430&action=edit "Bug 1737722. r?botond") -
Flags: approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1737722#c27)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/9ddbcae66c05>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1737722#c28)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/aa21861b548a>

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a22716737_600971)• 3 years ago |

[Attachment #9285574](/attachment.cgi?id=9285574&action=edit "Bug 1737722. esr91. r?botond") -
Attachment description: Bug 1737722. ers91. r?botond → Bug 1737722. esr91. r?botond

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1737722#c29)• 3 years ago |
|  | |

Comment on [attachment 9285574](/attachment.cgi?id=9285574 "Bug 1737722. esr91. r?botond") [[details]](/attachment.cgi?id=9285574&action=edit "Bug 1737722. esr91. r?botond")

[Bug 1737722](/show_bug.cgi?id=1737722 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). esr91. r?botond

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec mod, low risk
* **User impact if declined**: attacker could user move mouse input
* **Fix Landed on Version**: 104
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: patch only has an effect with huge transforms that real content should never hit
[Attachment #9285574](/attachment.cgi?id=9285574&action=edit "Bug 1737722. esr91. r?botond") -
Flags: approval-mozilla-esr91?

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a22919228_551058)• 2 years ago |

QA Whiteboard: [qa-triaged] → [qa-triaged][post-critsmash-triage]

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a22937103_695136)• 2 years ago |

[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F) → [103+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=103%2B)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1737722#c30)• 2 years ago |
|  | |

Comment on [attachment 9285574](/attachment.cgi?id=9285574 "Bug 1737722. esr91. r?botond") [[details]](/attachment.cgi?id=9285574&action=edit "Bug 1737722. esr91. r?botond")

[Bug 1737722](/show_bug.cgi?id=1737722 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). esr91. r?botond

Approved for ESR91.12, thanks.

[Attachment #9285574](/attachment.cgi?id=9285574&action=edit "Bug 1737722. esr91. r?botond") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1737722#c31)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/1278c4a14c3b>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1737722#c32)• 2 years ago |
|  | |

Hi Irvan! Can you please help us verifying this bug on the fixed builds?

* [latest Nightly 104.0a1](https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central/)
* [103.0 RC1](https://archive.mozilla.org/pub/firefox/candidates/103.0-candidates/build1/)
* [ESR91.12](https://archive.mozilla.org/pub/firefox/candidates/91.12.0esr-candidates/build1/)
* [ESR102.1](https://archive.mozilla.org/pub/firefox/candidates/102.0.1esr-candidates/build1/)

Unfortunately, I am not able to reproduce the issue even though I've tried with the test cases from [comment 0](/show_bug.cgi?id=1737722#c0 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position") and [comment 13](/show_bug.cgi?id=1737722#c13 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). I had fission enabled as well as webreneder on an affected Nightly build (2021-10-15), but the "Download" image was not displayed on my Win 10 x64 machine.

Flags: needinfo?(susah.yak)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a23006107_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form][adv-main103+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a23007232_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][adv-main103+] → [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+]

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1737722#c33)• 2 years ago |
|  | |

(In reply to Ciprian Georgiu [:ciprian\_georgiu], Release Desktop QA from [comment #32](/show_bug.cgi?id=1737722#c32 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> Hi Irvan! Can you please help us verifying this bug on the fixed builds?
>
> * [latest Nightly 104.0a1](https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central/)
> * [103.0 RC1](https://archive.mozilla.org/pub/firefox/candidates/103.0-candidates/build1/)
> * [ESR91.12](https://archive.mozilla.org/pub/firefox/candidates/91.12.0esr-candidates/build1/)
> * [ESR102.1](https://archive.mozilla.org/pub/firefox/candidates/102.0.1esr-candidates/build1/)
>
> Unfortunately, I am not able to reproduce the issue even though I've tried with the test cases from [comment 0](/show_bug.cgi?id=1737722#c0 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position") and [comment 13](/show_bug.cgi?id=1737722#c13 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). I had fission enabled as well as webreneder on an affected Nightly build (2021-10-15), but the "Download" image was not displayed on my Win 10 x64 machine.

Alright, I'm currently checking this now.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1737722#c34)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9286179)
— [Details](attachment.cgi?id=9286179&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1737722#c35)• 2 years ago |
|  | |

(In reply to Ciprian Georgiu [:ciprian\_georgiu], Release Desktop QA from [comment #32](/show_bug.cgi?id=1737722#c32 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> Hi Irvan! Can you please help us verifying this bug on the fixed builds?
>
> * [latest Nightly 104.0a1](https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central/)
> * [103.0 RC1](https://archive.mozilla.org/pub/firefox/candidates/103.0-candidates/build1/)
> * [ESR91.12](https://archive.mozilla.org/pub/firefox/candidates/91.12.0esr-candidates/build1/)
> * [ESR102.1](https://archive.mozilla.org/pub/firefox/candidates/102.0.1esr-candidates/build1/)
>
> Unfortunately, I am not able to reproduce the issue even though I've tried with the test cases from [comment 0](/show_bug.cgi?id=1737722#c0 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position") and [comment 13](/show_bug.cgi?id=1737722#c13 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"). I had fission enabled as well as webreneder on an affected Nightly build (2021-10-15), but the "Download" image was not displayed on my Win 10 x64 machine.

On Windows 11 the "Download" image is disappear after [Bug 1757647 - Implement Windows 11 overlay scrollbars is applied](https://bugzilla.mozilla.org/show_bug.cgi?id=1757647), to make "Download" image re-appear we can toggle `widget.windows.overlay-scrollbars.enabled` from `true` to `false`.

On Linux the "Download" image is disappear after scrollbar is refactored on pushlog <https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=d02c31423ae04546ab8dd3c2fa107a03fb66b629&tochange=ef94ce8ed301e54b5df8b578d7f1d5bdfead2c0d>, unfortunately there are no prefs switch to undo the patch, but we can also test by right click into the page, after single tap to the page then right click the context menu will appear on different location if it still reproducible.

When verifying the bug on Windows 11 with resolution 1920x1080 on 125% scale using testcase on [comment 0](/show_bug.cgi?id=1737722#c0 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"), I verified it has been fixed on following build:

* Firefox 104.0a1 (2022-07-19) (64-bit)
* Firefox 103.0 (64-bit)
* Firefox 102.1.0esr (64-bit)
* Firefox 91.12.0esr (64-bit) (`webrender.enabled` to `true`)

I also verified the bug is no longer reproducible on Linux platform using Firefox Nightly 104.0a1 (2022-07-19) (64-bit) by right click into the page.

The Firefox ESR102.1 download link that you refer is point to Firefox ESR102.0.1 version released on 11-Jul-2022 which still reproducible. I think it's typo which has to refer to ESR102.1.0 link which is fixed on that build.

Status: RESOLVED → VERIFIEDFlags: needinfo?(susah.yak)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a23091427_428608)• 2 years ago |

Alias: CVE-2022-36319

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1737722#c36)• 2 years ago |
|  | |

Thank you very much, Irvan!

(In reply to Irvan Kurniawan (:sourc7) from [comment #35](/show_bug.cgi?id=1737722#c35 "VERIFIED FIXED - Redirect Mouse Input to Attacker Controlled Position while Visible Cursor Remain on Original Position"))

> The Firefox ESR102.1 download link that you refer is point to Firefox ESR102.0.1 version released on 11-Jul-2022 which still reproducible. I think it's typo which has to refer to ESR102.1.0 link which is fixed on that build.

Indeed, I wanted to point out the download link from ESR102.1.

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=verified)
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a23105043_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+] → [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+][adv-main102.1+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a23105122_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+][adv-main102.1+] → [reporter-external] [client-bounty-form][adv-main103+][adv-esr91.12+][adv-esr102.1+]

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a29118782_255010)• 2 years ago |

Regressions: [1792447](/show_bug.cgi?id=1792447 "NEW - Mousewheel input stops working within iframes using CSS perspective with certain matrix3D values")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a38720416_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1737722#a81881162_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1737722&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_851b2aaa_20250115_090504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-30

## Security Vulnerabilities fixed in Firefox ESR 102.1

Announced
July 26, 2022
Impact
moderate
Products
Firefox ESR
Fixed in

* Firefox ESR 102.1

#### [#CVE-2022-36319: Mouse Position spoofing with CSS transforms](#CVE-2022-36319)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When combining CSS properties for overflow and transform, the mouse cursor could interact with different coordinates than displayed.

##### References

* [Bug 1737722](https://bugzilla.mozilla.org/show_bug.cgi?id=1737722)

#### [#CVE-2022-36318: Directory indexes for bundled resources reflected URL parameters](#CVE-2022-36318)

Reporter
Gijs Kruitbosch
Impact
moderate
##### Description

When visiting directory listings for `chrome://` URLs as source text, some parameters were reflected.

##### References

* [Bug 1771774](https://bugzilla.mozilla.org/show_bug.cgi?id=1771774)

#### [#CVE-2022-36314: Opening local ".lnk" files could cause unexpected network loads](#CVE-2022-36314)

Reporter
akucybersec
Impact
moderate
##### Description

When opening a Windows shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system.
This bug only affects Firefox for Windows. Other operating systems are unaffected.\*

##### References

* [Bug 1773894](https://bugzilla.mozilla.org/show_bug.cgi?id=1773894)

#### [#CVE-2022-2505: Memory safety bugs fixed in Firefox 103 and 102.1](#CVE-2022-2505)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 102. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 103 and 102.1](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1769739%2C1772824)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


