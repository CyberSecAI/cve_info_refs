=== Content from github.com_c0401894_20250115_094936.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fsecurity%2Fadvisories%2FGHSA-8gw7-4j42-w388)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fsecurity%2Fadvisories%2FGHSA-8gw7-4j42-w388)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sigstore%2Fcosign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[cosign](/sigstore/cosign)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fcosign) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fsigstore%2Fcosign)
* [Star
   4.6k](/login?return_to=%2Fsigstore%2Fcosign)

* [Code](/sigstore/cosign)
* [Issues
  232](/sigstore/cosign/issues)
* [Pull requests
  19](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects
  0](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

Additional navigation options

* [Code](/sigstore/cosign)
* [Issues](/sigstore/cosign/issues)
* [Pull requests](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

# Vulnerabilities with blob verification

Moderate

[cpanato](/cpanato)
published
GHSA-8gw7-4j42-w388
Sep 14, 2022

## Package

cosign
(sigstore)

## Affected versions

<=1.11.1

## Patched versions

1.12.0

## Description

## Summary

A number of vulnerabilities have been found in `cosign verify-blob`, where Cosign would successfully verify an artifact when verification should have failed.

## Vulnerability 1: Bundle mismatch causes invalid verification.

### Summary

A cosign bundle can be crafted to successfully verify a blob even if the embedded rekorBundle does not reference the given signature.

### Details

Cosign supports "bundles" which intend to allow offline verification of the signature and rekor inclusion. By using the --bundle flag in cosign sign-blob, cosign will create a JSON file called a "bundle". These bundles include three fields: base64Signature, cert, and rekorBundle. The desired behavior is that the verification of these bundles would:

* verify the provided blob using the included signature and certificate
* verify the rekorBundle SET
* verify the rekorBundle payload references the given artifact.

It appears that step three is not being performed, allowing "any old rekorBundle" to pass validation, even if the rekorBundle payload does not reference the provided blob or the certificate and signature in the rekorBundle do not match those at the top level.

### Steps to reproduce

Enable keyless signing:

```
export COSIGN_EXPERIMENTAL=1

```

Create two random blobs:

```
dd bs=1 count=50 </dev/urandom >blob1
dd bs=1 count=50 </dev/urandom >blob2

```

Sign each blob:

```
cosign sign-blob blob1 --bundle bundle1
cosign sign-blob blob2 --bundle bundle2

```

Create a falsified bundle including the base64Signature and cert fields from bundle1 and the rekorBundle from bundle2:

```
jq --slurpfile bundle2 bundle2 '.rekorBundle = $bundle2[0].rekorBundle' bundle1 > invalidBundle

```

Now, the falsified bundle can be used to verify blob1:

```
$ cosign verify-blob blob1 --bundle invalidBundle
tlog entry verified offline
Verified OK

```
### Patches

Users should update to the latest version of Cosign, `1.12.0`.

### Workaround

If you extract the signature and certificate from the `bundle`, you may use it for verification as follows and avoid using an invalid bundle:

```
$ cosign verify-blob blob1 --signature $(jq -r '.base64Signature' bundle1) --certificate $(jq -r '.cert' bundle1)

```

Note that this will make a network call to Rekor to fetch the Rekor entry. However, you may then be subject to Vulnerability 4.

## Vulnerability 2: Certificate Identities are not checked in some cases

### Summary

When providing identity flags, the email and issuer of a certificate is not checked when verifying a Rekor bundle, and the GitHub Actions identity is never checked.

### Details

Users who provide an offline Rekor bundle (`--bundle`) when verifying a blob using `cosign verify-blob` and include flags that check identity such as `--certificate-email` and `--certificate-oidc-issuer` are impacted. Additionally, users who provide the GitHub Actions verification flags such as `--certificate-github-workflow-name` when running `cosign verify-blob` without a bundle, key reference, or certificate are impacted.

When providing these flags, Cosign ignored their values. If a certificate's identity did not match the provided flags, Cosign would still successfully verify the blob.

### Patches

Users should update to the latest version of Cosign, `1.12.0`.

### Workarounds

There are no workarounds, users should update.

## Vulnerability 3: Invalid Rekor bundle without the experimental flag will result in successful verification

### Summary

Providing an invalid Rekor bundle without the experimental flag results in a successful verification.

### Details

Users who provide an offline Rekor bundle (`--bundle`) that was invalid (invalid signed entry timestamp, expired certificate, or malformed) when verifying a blob with `cosign verify-blob` and do not set the `COSIGN_EXPERIMENTAL=1` flag are impacted.

When an invalid bundle was provided, Cosign would fallback to checking Rekor log inclusion by requesting proof of inclusion from the log. However, without the `COSIGN_EXPERIMENTAL` flag, Cosign would exit early and successfully verify the blob.

### Patches

Users should update to the latest version of Cosign, `1.12.0`.

### Workarounds

There are no workarounds, users should update.

## Vulnerability 4: Invalid transparency log entry will result in successful verification

### Summary

An invalid transparency log entry will result in immediate success for verification.

### Details

Users who provide a signature and certificate to `verify-blob` will fetch the associated Rekor entry for verification. If the returned entry was invalid (invalid signed entry timestamp, invalid inclusion proof, malformed entry with missing verification), then `cosign` [exits](https://github.com/sigstore/cosign/blob/42c6e2a6dd9d92d19077c8e6b7d66d155a5ea28c/cmd/cosign/cli/verify/verify_blob.go#L357) early and succeeds unconditionally.

### Patches

Users should update to the latest version of Cosign, `1.12.0`.

### Workarounds

There are no workarounds, users should update.

## For more information

If you have any questions or comments about this advisory:

* Open an issue in [cosign](https://github.com/sigstore/cosign)
* Send us a message on [Slack](https://sigstore.slack.com/).

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N

### CVE ID

CVE-2022-36056

### Weaknesses

No CWEs

### Credits

* [![@codysoyland](https://avatars.githubusercontent.com/u/45020?s=40&v=4)](/codysoyland)
  [codysoyland](/codysoyland)
  Analyst
* [![@asraa](https://avatars.githubusercontent.com/u/5194569?s=40&v=4)](/asraa)
  [asraa](/asraa)
  Analyst
* [![@haydentherapper](https://avatars.githubusercontent.com/u/8418760?s=40&v=4)](/haydentherapper)
  [haydentherapper](/haydentherapper)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_24dcb34d_20250115_094934.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fcommit%2F80b79ed8b4d28ccbce3d279fd273606b5cddcc25)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fcommit%2F80b79ed8b4d28ccbce3d279fd273606b5cddcc25)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sigstore%2Fcosign)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[cosign](/sigstore/cosign)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fcosign) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fsigstore%2Fcosign)
* [Star
   4.6k](/login?return_to=%2Fsigstore%2Fcosign)

* [Code](/sigstore/cosign)
* [Issues
  232](/sigstore/cosign/issues)
* [Pull requests
  19](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects
  0](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

Additional navigation options

* [Code](/sigstore/cosign)
* [Issues](/sigstore/cosign/issues)
* [Pull requests](/sigstore/cosign/pulls)
* [Discussions](/sigstore/cosign/discussions)
* [Actions](/sigstore/cosign/actions)
* [Projects](/sigstore/cosign/projects)
* [Security](/sigstore/cosign/security)
* [Insights](/sigstore/cosign/pulse)

## Commit

[Permalink](/sigstore/cosign/commit/80b79ed8b4d28ccbce3d279fd273606b5cddcc25)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-8gw7-4j42-w388](https://github.com/advisories/GHSA-8gw7-4j42-w388 "GHSA-8gw7-4j42-w388")

[Browse files](/sigstore/cosign/tree/80b79ed8b4d28ccbce3d279fd273606b5cddcc25)
Browse the repository at this point in the history

```
* wip

Signed-off-by: Asra Ali <asraa@google.com>

more tests

Signed-off-by: Asra Ali <asraa@google.com>

finish tests

Signed-off-by: Asra Ali <asraa@google.com>

Add explicit testcase for failure in verifytlogentry

Signed-off-by: Asra Ali <asraa@google.com>

add testing for invalid provided bundle fails

Signed-off-by: Asra Ali <asraa@google.com>

update

Signed-off-by: Asra Ali <asraa@google.com>

address hayden comments

Signed-off-by: Asra Ali <asraa@google.com>

update

Signed-off-by: Asra Ali <asraa@google.com>

* fix: verify RekorBundle payload references blob

Co-authored-by: Cody Soyland <codysoyland@github.com>
Co-authored-by: Asra Ali <asraa@google.com>

* Add test for invalid blob signature causing error

Signed-off-by: Hayden Blauzvern <hblauzvern@google.com>

* Add tests for checking identity flags

Signed-off-by: Hayden Blauzvern <hblauzvern@google.com>

* address bob's comment

Signed-off-by: Asra Ali <asraa@google.com>

* add comment on intoto multisig

Signed-off-by: Asra Ali <asraa@google.com>

Signed-off-by: Asra Ali <asraa@google.com>
Signed-off-by: Hayden Blauzvern <hblauzvern@google.com>
Co-authored-by: Cody Soyland <codysoyland@github.com>
Co-authored-by: Hayden Blauzvern <hblauzvern@google.com>
```

* Loading branch information

[![@asraa](https://avatars.githubusercontent.com/u/5194569?s=40&v=4)](/asraa) [![@codysoyland](https://avatars.githubusercontent.com/u/45020?s=40&v=4)](/codysoyland) [![@haydentherapper](https://avatars.githubusercontent.com/u/8418760?s=40&v=4)](/haydentherapper)

3 people

authored
Sep 14, 2022

1 parent
[01492c6](/sigstore/cosign/commit/01492c677405e5d47c4f4a9905fd26a4b4a2d757)

commit 80b79ed

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**1,452 additions**
and
**236 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* cmd/cosign/cli/verify

  + cmd/cosign/cli/verify/verify\_blob.go
    [verify\_blob.go](#diff-0e4161831ebe72270d047175df7dd5fef3f1acbc317784eb68bcb77cf5ab9c34)
  + cmd/cosign/cli/verify/verify\_blob\_test.go
    [verify\_blob\_test.go](#diff-29007b577f66b9fca944d7d87e89d87a1027754f251a7e41feac1e61809b6cc4)
* internal/pkg/cosign/rekor

  + mock

    - internal/pkg/cosign/rekor/mock/mock\_rekor\_client.go
      [mock\_rekor\_client.go](#diff-af27976963ea538e9dc4608cc7e4b7c38ad4387e0980e467a4044cbe2d6abdee)
  + internal/pkg/cosign/rekor/signer\_test.go
    [signer\_test.go](#diff-4c6baca0002fc86b4d9a3b58ac5c7b7ab7ba197f1c654c27be2bcbd1847f6a24)
* pkg/cosign

  + pkg/cosign/verify.go
    [verify.go](#diff-8a85c8e688d61e16b8af8e09832ed2bef89c1163b0e9601a8363c782c387c006)
  + pkg/cosign/verify\_test.go
    [verify\_test.go](#diff-18658ff68b123ed5ee981044d3b0ca36237a2a32cf7a9215c1c2f5f9d6c60b74)
* test

  + test/cert\_utils.go
    [cert\_utils.go](#diff-015c97ca0ae494db04bb2cf2a20712a1a9a937ab45bc908a978c1d748dabbf88)

## There are no files selected for viewing

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `80b79ed`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign%2Fcommit%2F80b79ed8b4d28ccbce3d279fd273606b5cddcc25) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


