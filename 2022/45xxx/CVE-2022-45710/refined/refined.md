- **Root cause of vulnerability:** A buffer overflow vulnerability exists in the `formSetDebugCfg` function of IP-COM M50 routers. The function uses `sprintf` to copy the parameters `pEnable`, `pLevel`, and `pModule` into a local variable on the stack without proper bounds checking.
- **Weaknesses/vulnerabilities present:** The primary vulnerability is a stack-based buffer overflow. The use of `sprintf` without length limits allows an attacker to overwrite adjacent memory, including the function's return address.
- **Impact of exploitation:** By overwriting the return address, an attacker can redirect the program's execution flow to malicious code, allowing them to gain control of the router.
- **Attack vectors:** The vulnerability is triggered by manipulating the `pEnable`, `pLevel`, or `pModule` parameters passed to the `formSetDebugCfg` function. This is likely achieved through an interface (web, API, etc.) where these parameters can be modified.
- **Required attacker capabilities/position:** The attacker needs to be able to send requests to the vulnerable `formSetDebugCfg` function, with the ability to manipulate the `pEnable`, `pLevel`, or `pModule` parameters with a payload that causes the overflow. This implies a position with network access to the vulnerable device and the ability to interact with the interface that uses the function.