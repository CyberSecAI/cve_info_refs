=== Content from bugzilla.mozilla.org_5379c3f4_20250114_215729.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1658869)
* [XML](/show_bug.cgi?ctype=xml&id=1658869)

Closed
[Bug 1658869](/show_bug.cgi?id=1658869)
(CVE-2022-45410)

Opened 4 years ago
Closed 2 years ago

# SameSite policy bypassed with Service Worker FetchEvent

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

SameSite policy bypassed with Service Worker FetchEvent

## Categories

### (Core :: DOM: Service Workers, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Service%20Workers#DOM%3A%20Service%20Workers)

DOM: Service Workers
▾

Core :: DOM: Service Workers
This component covers the [Service Worker](https://github.com/slightlyoff/ServiceWorker/) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Service%20Workers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

107 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix) |
| firefox105 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=wontfix) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=verified) |
| firefox108 | --- | [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr102 | 107+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 |  | wontfix |
| firefox99 |  | wontfix |
| firefox100 |  | wontfix |
| firefox105 |  | wontfix |
| firefox106 |  | wontfix |
| firefox107 | + | verified |
| firefox108 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: kiding, Assigned: edenchuang)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3afcbed8f1748e0ae0da0bc4cabddcaf?d=mm&size=40)  [edenchuang](/user_profile?user_id=516138)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1919b10e4f52e00a8b1345972561b63c?d=mm&size=40)  [kiding](/user_profile?user_id=668351)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

23 people

## References

### ( [URL](https://prong-glory-novel.glitch.me "https://prong-glory-novel.glitch.me") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1729022](/show_bug.cgi?id=1729022 "RESOLVED DUPLICATE - SameSite Cookies leaked in cross-site request through service worker"), [1783550](/show_bug.cgi?id=1783550 "RESOLVED DUPLICATE - Universal CSRF Bypass With SameSite=Strict (When Angular Service Worker Is Running)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[prong-glory-novel.glitch.me](https://prong-glory-novel.glitch.me "https://prong-glory-novel.glitch.me")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1115847 "https://bugs.chromium.org/p/chromium/issues/detail?id=1115847")

[github.com/whatwg/fetch/pull/1345](https://github.com/whatwg/fetch/pull/1345 "https://github.com/whatwg/fetch/pull/1345")

[github.com/httpwg/http-extensions/iss...](https://github.com/httpwg/http-extensions/issues/1288 "https://github.com/httpwg/http-extensions/issues/1288")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage][adv-main107+][adv-esr102.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-45410

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage][adv-main107+][adv-esr102.5+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a20436980_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [freddy](/user_profile?user_id=428608) | [in-testsuite](#c26 "2 years ago") | ? |
| --- | --- | --- |
| [freddy](/user_profile?user_id=428608) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [x.jpg](/attachment.cgi?id=9169764)  [4 years ago](#c0)  [kiding](/user_profile?user_id=668351)   481.85 KB, image/jpeg |  | [Details](/attachment.cgi?id=9169764&action=edit) |
| --- | --- | --- |
| [Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers](/attachment.cgi?id=9275861)  [3 years ago](#c13)  [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-esr102+](#c31 "2 years ago") | [Details](/attachment.cgi?id=9275861&action=edit) | [Review](/attachment.cgi?id=9275861) |
| [106 vs 107.png](/attachment.cgi?id=9298583)  [2 years ago](#c21)  [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754)   968.63 KB, image/png |  | [Details](/attachment.cgi?id=9298583&action=edit) |
| [advisory.txt](/attachment.cgi?id=9302878)  [2 years ago](#c34)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   353 bytes, text/plain |  | [Details](/attachment.cgi?id=9302878&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [kiding](/user_profile?user_id=668351)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1658869#c0)• 4 years ago |
|  | |

Attached image
[x.jpg](attachment.cgi?id=9169764)
— [Details](attachment.cgi?id=9169764&action=edit)

It seems Firefox ignores SameSite policy by sending protected cookies when: a request is intercepted by a service worker FetchEvent, then fired from within its context. As developers willingly opt to implement FetchEvent mainly for caching purposes, this behavior undermines CSRF protection expected from setting up SameSite attribute.

I've set up a simple demo page at <https://prong-glory-novel.glitch.me>. The site responds with Set-Cookie the "None" "Lax" "Strict" cookies, then echos the Cookie header value in each response. Without a service worker registered, "cross-site page with a link back here" works as expected; "Lax" sent only for GET method, "Strict" not sent for neither GET nor POST. Once the worker registered however, the page will always show all three cookie values sent in the request, indicating SameSite policy is not being enforced.

rfc6265bis 5.2.2.2. states two different scenarios for service workers: 1. Requests which simply pass through a Service Worker, 2. Requests which are initiated by the Service Worker itself. It seems Firefox handles the above case in the latter way, presumably because there is a direct call to fetch() is involved. However, I believe they should be handled in the former way; The worker cannot manipulate the Request object in any way, and all it can do with the object is to hand it over to the network or drop it. In my opinion, it is natural to think the request is actually originated from a top-navigation document, so it should be treated like so.

Tested with 81.0a1 (2020-08-12) (64-bit) on macOS 10.15.6. Cross-reported to Chromium as Chrome exhibits the same behavior. Safari only sends "None" which I suppose is a different problem in itself.

Once thing Firefox-specific pecularity is that Developer Tools *says* it's sending the right cookies while it is absolutely not. See the attachment.

—

김동성 ᛫ Dongsung Kim ᛫ <https://kidi.ng>

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1658869#c1)• 4 years ago |
|  | |

Anne, do you know who is the right person to look into this?

Group: firefox-core-security → dom-core-securityType: task → defectComponent: Security → DOM: NetworkingFlags: needinfo?(annevk)Product: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a40301_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a464755_151407)• 4 years ago |

Severity: -- → S3Component: DOM: Networking → DOM: Service WorkersFlags: needinfo?(ytausky)Flags: needinfo?(bugmail)Flags: needinfo?(annevk)Priority: -- → P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a20436980_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1658869#c2)• 4 years ago |
|  | |

Jens, could you please ask asuth for progress on this?

Flags: needinfo?(jstutte)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1658869#c3)• 4 years ago |
|  | |

Given other priorities, we won't be able to get to this immediately. keeping :asuth' and :ytausky's needinfos, though.

Flags: needinfo?(jstutte)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a31484696_151407)• 3 years ago |

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1658869#c4)• 3 years ago |
|  | |

(didn't mean to clear my needinfo, was trying to add someone as a CC and didn't realize the side-effect was happening)

Flags: needinfo?(bugmail)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1658869#c6)• 3 years ago |
|  | |

For some reason I never saw this bug, but what Chrome and Firefox do is correct per the specification. When `fetch()` is invoked the service worker takes ownership of the request. This is indeed rather terrible and is discussed at <https://github.com/httpwg/http-extensions/issues/1288>, but there's no clear way that this can work well. Service workers defeat CSRF. We might have a discussion about this at the next W3C TPAC.

Reporter, could you please share the Chromium bug number? Or copy annevankesteren@gmail.com there? It would be useful to know what they are thinking with regards to this.

|  | [kiding](/user_profile?user_id=668351)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1658869#c7)• 3 years ago |
|  | |

Sure, it's <https://bugs.chromium.org/p/chromium/issues/detail?id=1115847>.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a34345831_1689)• 3 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1658869#c8)• 3 years ago |
|  | |

Standards-wise we figured out a new model whereby the origin of a request is sometimes preserved: <https://github.com/whatwg/fetch/pull/1345>. (The URL list is preserved as well to not undo any tainting of the origin.)

That means this is now a security bug that we can and should fix.

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a40960483_646284)• 3 years ago |

Flags: needinfo?(ytausky) → needinfo?(jstutte)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a41590717_646284)• 3 years ago |

Assignee: nobody → echuangFlags: needinfo?(jstutte)

|  | [kiding](/user_profile?user_id=668351)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1658869#c9)• 3 years ago |
|  | |

Chromium Team moved the bug forward and disclosed with a CVE attached.

Is it possible to reserve a new CVE number that can track this bug? I reckon Firefox Developer Tools' "pecularity" makes this a bit different from Chromium's.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1658869#c10)• 3 years ago |
|  | |

(In reply to kiding from [comment #9](/show_bug.cgi?id=1658869#c9 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> Chromium Team moved the bug forward and disclosed with a CVE attached.

Can you link to the chromium bug? ( <https://github.com/whatwg/fetch/pull/1345> doesn't appear to list one)

> Is it possible to reserve a new CVE number that can track this bug? I reckon Firefox Developer Tools' "pecularity" makes this a bit different from Chromium's.

I believe in our processes, CVEs normally get assigned when the associated bug is fixed; passing this question to Dan to confirm.

Flags: needinfo?(kiding)Flags: needinfo?(dveditz)

|  | [kiding](/user_profile?user_id=668351)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1658869#c11)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1658869#c10 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> Can you link to the chromium bug? ( <https://github.com/whatwg/fetch/pull/1345> doesn't appear to list one)

It’s the same one mentioned in [comment #7](/show_bug.cgi?id=1658869#c7 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"): <https://bugs.chromium.org/p/chromium/issues/detail?id=1115847>.

Flags: needinfo?(kiding)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1658869#c12)• 3 years ago |
|  | |

> I believe in our processes, CVEs normally get assigned when the associated bug is fixed; passing this question to Dan to confirm.

Yes, we assign them when registering the vulnerability info with MITRE. And since they publish what we send them, we don't do that until bugs are fixed and we're in the release end-game.

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Flags: needinfo?(dveditz)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1115847>,
<https://github.com/whatwg/fetch/pull/1345>,
<https://github.com/httpwg/http-extensions/issues/1288>

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1658869#c13)• 3 years ago |
|  | |

Attached file
[Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers](attachment.cgi?id=9275861)
— [Details](attachment.cgi?id=9275861&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a57237317_406194)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][secdom:spec]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1658869#c14)• 3 years ago |
|  | |

The reporter is letting us know that this is part of a talk that will be presented at DEFCON30, i.e., we are expecting this to be public by mid August.

AFAIU, this is still pending a resolution in the specification though?

Whiteboard: [reporter-external] [client-bounty-form] [verif?][secdom:spec] → [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1658869#c15)• 2 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #14](/show_bug.cgi?id=1658869#c14 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> The reporter is letting us know that this is part of a talk that will be presented at DEFCON30, i.e., we are expecting this to be public by mid August.
>
> AFAIU, this is still pending a resolution in the specification though?

The chromium ticket is fixed, and the fetch spec ticket is also closed. Eden, are you still working on the patch?

Flags: needinfo?(echuang)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1658869#c16)• 2 years ago |
|  | |

Eden is on a leave. Andrew, can you help here?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a61726178_151407)• 2 years ago |

Assignee: echuang → bugmailStatus: NEW → ASSIGNEDFlags: needinfo?(echuang)Flags: needinfo?(bugmail)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a62755198_516138)• 2 years ago |

Assignee: bugmail → echuang

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a64634869_600971)• 2 years ago |

[Attachment #9275861](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") -
Attachment description: Bug 1658869 - Saving FetchEvent.request's origianl principal and ContentPolicyType for SameSite cookie checking. r=#dom-worker-reviewers → Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1658869#c18)• 2 years ago |
|  | |

Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=dom-worker-reviewers,dragana,jesup

<https://hg.mozilla.org/integration/autoland/rev/6bca2bb22edf29579ee3d8754ba0a954fb0b7ffc>

<https://hg.mozilla.org/mozilla-central/rev/6bca2bb22edf>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 107 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1658869#c19)• 2 years ago |
|  | |

Pretty late in the cycle to uplift to Beta for 106 at this point. Let's aim to get it on ESR next cycle though. Eden, can you please attach a rebased patch for ESR102 when you get a chance and request approval? Thanks!

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix)
[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=wontfix)
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)
[tracking-firefox107](/buglist.cgi?f1=cf_tracking_firefox107&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B)Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1658869#c20)• 2 years ago |
|  | |

Comment on [attachment 9275861](/attachment.cgi?id=9275861 "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers")

[Bug 1658869](/show_bug.cgi?id=1658869 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent") - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Third-party pages could get first-party same-site cookies through ServiceWorker.
* **User impact if declined**: When fetch() through the FetchEvent.request or NavigationPreload, the same-site cookie policy would not work correctly. Same-site cookies would leak to the third-party pages.
* **Fix Landed on Version**: 107
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch adds some new members of InternalRequest and loadInfo. It doesn't change the logic for the old code.
Flags: needinfo?(echuang)
[Attachment #9275861](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-esr102?

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a68269224_553429)• 2 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14] → [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage]]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a68343749_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1658869#c21)• 2 years ago |
|  | |

Attached image
[106 vs 107.png](attachment.cgi?id=9298583)
— [Details](attachment.cgi?id=9298583&action=edit)

Tried reproducing the issue in order to be able to verify it (tried on two different systems) by following the info and test site provided in [Comment 0](/show_bug.cgi?id=1658869#c0 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent").

From what I tried so far, I couldn't see any difference between 106.0 and latest 107.0a1 (with fix), I'll attach a screenshot. Am I missing something? Can you eventually provide some exact STR, and what should we be paying attention to in order to know that now it behaves correctly? Thank you!

Flags: needinfo?(echuang)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1658869#c22)• 2 years ago |
|  | |

Comment on [attachment 9275861](/attachment.cgi?id=9275861 "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers")

[Bug 1658869](/show_bug.cgi?id=1658869 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent") - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers

This needs a rebased patch for ESR.

[Attachment #9275861](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-esr102?

|  | [kiding](/user_profile?user_id=668351)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1658869#c23)• 2 years ago |
|  | |

Catalin, I had to change some of the demo page for the presentation, sorry! Here is how to reproduce the bug.

1. Visit <https://prong-glory-novel.glitch.me>
2. Open the caret, click the “register” button.
3. Visit <https://goofy-voracious-spatula.glitch.me>
4. Click the “Navigate using GET” link.
5. The page should say: Your browser sent: `cookie: none-cookie=1; lax-cookie=2`
6. Repeat 3.
7. Click the “Navigate using POST” link.
8. The page should say: Your browser sent: `cookie: none-cookie=1`

I did my own testing that confirms it works as expected on 108.0a1, and does not work on 106.0beta.

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1658869#c24)• 2 years ago |
|  | |

Thanks Kiding, that did the trick. It shows as expected following your STR. Tests were performed on Firefox 108.0a1 (2022-10-17). Tests were performed on macOS 13, Ubuntu 22.04 and WIndows 11.

[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=verified)
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified)Flags: needinfo?(echuang)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1658869#c25)• 2 years ago |
|  | |

(In reply to kiding from [comment #23](/show_bug.cgi?id=1658869#c23 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> Catalin, I had to change some of the demo page for the presentation, sorry! Here is how to reproduce the bug.
>
> 1. Visit <https://prong-glory-novel.glitch.me>
> 2. Open the caret, click the “register” button.
> 3. Visit <https://goofy-voracious-spatula.glitch.me>
> 4. Click the “Navigate using GET” link.
> 5. The page should say: Your browser sent: `cookie: none-cookie=1; lax-cookie=2`
> 6. Repeat 3.
> 7. Click the “Navigate using POST” link.
> 8. The page should say: Your browser sent: `cookie: none-cookie=1`

We should consider turning this into an automated test.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1658869#c26)• 2 years ago |
|  | |

Eden, please write a test (here or in a follow-up bug) according to the steps above.

Flags: needinfo?(echuang)Flags: in-testsuite?

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1658869#c27)• 2 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #26](/show_bug.cgi?id=1658869#c26 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> Eden, please write a test (here or in a follow-up bug) according to the steps above.

testing/web-platform/tests/service-workers/service-worker/same-site-cookies.https.html covers the situation, so that is the reason why I did not write a test for it.

Flags: needinfo?(echuang)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1658869#c28)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #22](/show_bug.cgi?id=1658869#c22 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> Comment on [attachment 9275861](/attachment.cgi?id=9275861 "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers")
>
> [Bug 1658869](/show_bug.cgi?id=1658869 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent") - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers
>
> This needs a rebased patch for ESR.

I did the rebase, probably need rebase again.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1658869#c29)• 2 years ago |
|  | |

(In reply to Eden Chuang[:edenchuang] from [comment #28](/show_bug.cgi?id=1658869#c28 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> I did the rebase, probably need rebase again.

Sorry, I missed that it got updated in Phab. For the future, it's less confusing to submit a new revision for the rebase rather than overwriting the one that already landed elsewhere.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a68800088_75935)• 2 years ago |

[Attachment #9275861](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-esr102?

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1658869#c30)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #29](/show_bug.cgi?id=1658869#c29 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))

> (In reply to Eden Chuang[:edenchuang] from [comment #28](/show_bug.cgi?id=1658869#c28 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent"))
>
> > I did the rebase, probably need rebase again.
>
> Sorry, I missed that it got updated in Phab. For the future, it's less confusing to submit a new revision for the rebase rather than overwriting the one that already landed elsewhere.

Sorry for the confusion. Will submit a new revision next time.

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1658869#c31)• 2 years ago |
|  | |

Comment on [attachment 9275861](/attachment.cgi?id=9275861 "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers")

[Bug 1658869](/show_bug.cgi?id=1658869 "VERIFIED FIXED - SameSite policy bypassed with Service Worker FetchEvent") - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers

Approved for 102.5esr.

[Attachment #9275861](/attachment.cgi?id=9275861&action=edit "Bug 1658869 - Propagate the InterceptedHttpChannel information to fetch's channel casued by FetchEvent.request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1658869#c32)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/24a443c8697c>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1658869#c33)• 2 years ago |
|  | |

Verified the fix as well on Firefox ESR102.5.0 (treeherder build). Tests were performed on macOS 13, Ubuntu 22.04 and Windows 11.

Status: RESOLVED → VERIFIED
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a70795852_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage]] → [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage][adv-main107+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1658869#c34)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9302878)
— [Details](attachment.cgi?id=9302878&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a70812636_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage][adv-main107+] → [reporter-external] [client-bounty-form] [verif?][secdom:spec][disclosure at DEFCON 30, to be held in Aug 11-14][post-critsmash-triage][adv-main107+][adv-esr102.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a71150232_578488)• 2 years ago |

Alias: CVE-2022-45410

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a89340562_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658869#a119790924_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1658869&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [kiding](/user_profile?user_id=668351)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_18bdcdd2_20250114_215733.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-47

## Security Vulnerabilities fixed in Firefox 107

Announced
November 15, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 107

This advisory was updated December 13, 2022 to add CVE-2022-46882 and CVE-2022-46883. Both fixes were included in the original release of Firefox 107, but did not appear in the advisory published at that time.

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45407: Loading fonts on workers was not thread-safe](#CVE-2022-45407)

Reporter
Armin Ebert
Impact
high
##### Description

If an attacker loaded a font using `FontFace()` on a background worker, a use-after-free could have occurred, leading to a potentially exploitable crash.

##### References

* [Bug 1793314](https://bugzilla.mozilla.org/show_bug.cgi?id=1793314)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45413: SameSite=Strict cookies could have been sent cross-site via intent URLs](#CVE-2022-45413)

Reporter
Axel Chong
Impact
moderate
##### Description

Using the `S.browser_fallback_url parameter` parameter, an attacker could redirect a user to a URL and cause SameSite=Strict cookies to be sent.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1791201](https://bugzilla.mozilla.org/show_bug.cgi?id=1791201)

#### [#CVE-2022-40674: Use-after-free vulnerability in expat](#CVE-2022-40674)

Reporter
Rhodri James
Impact
moderate
##### Description

A flaw in XML parsing could have led to a use-after-free causing a potentially exploitable crash.
*In official releases of Firefox this vulnerability is mitigated by wasm sandboxing; versions managed by Linux distributions may have other settings.*

##### References

* [Bug 1791598](https://bugzilla.mozilla.org/show_bug.cgi?id=1791598)

#### [#CVE-2022-45415: Downloaded file may have been saved with malicious extension](#CVE-2022-45415)

Reporter
Jefferson Scher and Jayateertha Guruprasad
Impact
moderate
##### Description

When downloading an HTML file, if the title of the page was formatted as a filename with a malicious extension, Firefox may have saved the file with that extension, leading to possible system compromise if the downloaded file was later ran.

##### References

* [Bug 1793551](https://bugzilla.mozilla.org/show_bug.cgi?id=1793551)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45417: Service Workers in Private Browsing Mode may have been written to disk](#CVE-2022-45417)

Reporter
Kagami
Impact
moderate
##### Description

Service Workers did not detect Private Browsing Mode correctly in all cases, which could have led to Service Workers being written to disk for websites visited in Private Browsing Mode. This would not have persisted them in a state where they would run again, but it would have leaked Private Browsing Mode details to disk.

##### References

* [Bug 1794508](https://bugzilla.mozilla.org/show_bug.cgi?id=1794508)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-45419: Deleting a security exception did not take effect immediately](#CVE-2022-45419)

Reporter
Ronald Crane
Impact
low
##### Description

If the user added a security exception for an invalid TLS certificate, opened an ongoing TLS connection with a server that used that certificate, and then deleted the exception, Firefox would have kept the connection alive, making it seem like the certificate was still trusted.

##### References

* [Bug 1716082](https://bugzilla.mozilla.org/show_bug.cgi?id=1716082)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Using tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

#### [#CVE-2022-46883: Memory safety bugs fixed in Firefox 107](#CVE-2022-46883)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Yulia Startsev, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 106. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1584674%2C1791152%2C1792241%2C1792984%2C1793127%2C1794645)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_575173ab_20250114_215737.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-48

## Security Vulnerabilities fixed in Firefox ESR 102.5

Announced
November 15, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.5

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_4786c028_20250114_215741.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-49

## Security Vulnerabilities fixed in Thunderbird 102.5

Announced
November 15, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Thunderbird has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Thunderbird on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Thunderbird 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


