```
{
  "vulnerability": {
    "root_cause": "The 'social' user profile field type in Moodle performed insufficient escaping on some fields.",
    "weaknesses": [
      "Insufficient output sanitization",
      "Stored Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker could inject and execute arbitrary HTML and script code in user's browser within the context of the vulnerable Moodle website.",
    "attack_vectors": "By injecting malicious code into 'social' user profile fields.",
    "required_capabilities": "An attacker needs to be able to edit or create a user profile and populate social profile fields."
  },
  "affected_versions": [
    "4.0 to 4.0.4",
    "3.11 to 3.11.10"
  ],
  "fixed_versions": [
    "4.0.5",
    "3.11.11"
  ],
    "workaround": "Update 'social' user profile fields so their visibility is set to 'not visible', until the patch is applied."
}
```