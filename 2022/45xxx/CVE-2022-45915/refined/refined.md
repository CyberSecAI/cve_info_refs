```
{
  "cve": "CVE-2022-45915",
  "description": "ILIAS utilizes several third-party programs to perform tasks like creating PDF files or scanning uploaded files for known viruses. These are called using the PHP exec() function. In several instances, the arguments passed to the exec() function contain user input that is not properly sanitized.\nBy performing malicious configuration steps or uploading dangerous files, an attacker can execute arbitrary system commands with the rights of the web server user (www-data). The privilege required for the different instances of command injection range from low rights to admin rights.",
  "vulnerability_details": {
    "root_cause": "Improper sanitization of user-controlled input passed to the PHP `exec()` function.",
    "weaknesses": [
      "OS Command Injection",
      "Insufficient Input Validation",
      "Use of `exec()` with unsanitized input"
     ],
    "impact": "Arbitrary system command execution with the privileges of the web server user (www-data). This can lead to full system compromise.",
    "attack_vectors": [
      {
        "description": "ZIP archive upload",
        "details": "An attacker can embed malicious commands in the directory or file names within a ZIP archive. When uploaded and extracted, these commands are executed by the server during virus scanning.",
        "required_capabilities": "Normal user access with rights to submit assessments."
       },
      {
        "description": "Media object creation",
         "details":"An attacker can place a file with a malicious name inside an \"Upload Directory\". When creating a media object based on that file, the command is executed by the server during virus scanning.",
        "required_capabilities": "User rights to create media objects."
      },
     {
       "description":"PDF document creation",
       "details": "An attacker with admin rights can configure the path to the preferred PDF renderer. By injecting malicious commands into this path, they can execute commands when a PDF export is triggered.",
       "required_capabilities": "Admin rights."
      }
    ]
  },
  "affected_versions": "<= 7.15",
  "fixed_versions": "7.16",
  "references": [
    "https://sec-consult.com/vulnerability-lab/",
    "https://seclists.org/fulldisclosure/2022/Dec/6",
    "https://packetstormsecurity.com/files/169676/ILIAS-eLearning-Platform-7.14-Command-Injection-XSS-LFI-Open-Redirect.html"
  ]
}
```