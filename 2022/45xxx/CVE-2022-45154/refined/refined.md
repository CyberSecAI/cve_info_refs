```
{
  "vulnerability": {
    "root_cause": "The `supportconfig` utility in SUSE Linux Enterprise products fails to properly sanitize specific password entries in `/etc/iscsi/iscsid.conf` and `/etc/target/lio_setup.sh` files before including them in the support archive. Specifically, passwords defined using `node.session.auth.password_in` and `discovery.sendtargets.auth.password_in` in `iscsid.conf` , and passwords set using `echo -n <password> > /sys/kernel/config/target/iscsi/discovery_auth/password_mutual` and `echo -n <password> > /sys/kernel/config/target/iscsi/discovery_auth/password` in `lio_setup.sh` are not replaced with `*REMOVED BY SUPPORTCONFIG*`.",
    "weaknesses": [
      "Information Exposure",
      "Inadequate Data Sanitization"
    ],
    "impact": "Sensitive information, such as iSCSI passwords, can be unintentionally included in support archives, potentially exposing them to unauthorized parties.",
    "attack_vectors": "An attacker who gains access to the `supportconfig` archive or is able to intercept its transmission could obtain the exposed passwords.",
    "required_capabilities": "An attacker would need access to a support archive generated by `supportconfig` that contains the unsanitized password information."
  },
  "affected_configurations": [
    {
      "component": "supportutils",
      "versions": [
        "3.1.21-150300.7.35.15.1 and potentially earlier versions on SLES 15",
        "3.0.10-95.51.1 and potentially earlier versions on SLES 12"
      ],
      "systems": [
        "SUSE Linux Enterprise Server 12",
        "SUSE Linux Enterprise Server 15",
        "SUSE Linux Enterprise High Performance Computing 12 and 15",
	"SUSE Linux Enterprise Server for SAP Applications 12 and 15",
        "SUSE Enterprise Storage 7",
        "SUSE CaaS Platform 4.0",
        "openSUSE Leap 15.4 and 15.5",
        "SUSE Linux Enterprise Micro for Rancher 5.3 and 5.4",
        "SUSE Linux Enterprise Micro 5.3, 5.4, 5.1, 5.2 and 5.5",
        "Basesystem Module 15-SP4 and 15-SP5",
	"SUSE Manager Proxy 4.2",
	"SUSE Manager Retail Branch Server 4.2",
	"SUSE Manager Server 4.2",
        "SUSE Enterprise Storage 7.1"
       ]
    }
   ],
  "patches": [
    "The vulnerability was fixed in the `supportutils` package by adding additional `sed` commands to replace the vulnerable passwords before the archive is created.",
        "Patches were released as SUSE-SU-2023:2465-1, SUSE-SU-2023:3803-1 and SUSE-SU-2023:3822-1/2"
  ],
  "additional_information": "The issue was addressed by modifying the `_sanitize_file` function in `supportconfig.rc` to include additional `sed` commands that replace the vulnerable passwords with the string `*REMOVED BY SUPPORTCONFIG*`. The fix was applied to multiple SUSE products and versions."
}
```