=== Content from github.com_de5aca8a_20250115_084746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyrathon%2Ftrophies%2Fsecurity%2Fadvisories%2FGHSA-r2mm-2f4c-6243)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyrathon%2Ftrophies%2Fsecurity%2Fadvisories%2FGHSA-r2mm-2f4c-6243)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=hyrathon%2Ftrophies)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hyrathon](/hyrathon)
/
**[trophies](/hyrathon/trophies)**
Public

* [Notifications](/login?return_to=%2Fhyrathon%2Ftrophies) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fhyrathon%2Ftrophies)
* [Star
   0](/login?return_to=%2Fhyrathon%2Ftrophies)

* [Code](/hyrathon/trophies)
* [Issues
  0](/hyrathon/trophies/issues)
* [Pull requests
  0](/hyrathon/trophies/pulls)
* [Actions](/hyrathon/trophies/actions)
* [Projects
  0](/hyrathon/trophies/projects)
* [Security](/hyrathon/trophies/security)
* [Insights](/hyrathon/trophies/pulse)

Additional navigation options

* [Code](/hyrathon/trophies)
* [Issues](/hyrathon/trophies/issues)
* [Pull requests](/hyrathon/trophies/pulls)
* [Actions](/hyrathon/trophies/actions)
* [Projects](/hyrathon/trophies/projects)
* [Security](/hyrathon/trophies/security)
* [Insights](/hyrathon/trophies/pulse)

# Heap Overflow in json.h(json\_parse\_key())

Moderate

[hyrathon](/hyrathon)
published
GHSA-r2mm-2f4c-6243
Dec 30, 2022

## Package

json.h

## Affected versions

before 692679a34c1957db47ebd6852a76c8cfca4a56e4

## Patched versions

692679a34c1957db47ebd6852a76c8cfca4a56e4

## Description

Heap Overflow in json\_parse\_key()

In json\_parse\_key(), there is a heap out-of-bound write. The bug can be triggered with an invocation of json\_parse\_ex() with specific flags combination. The root cause of this vulnerability is that the parameter string transferred to json\_parse\_key() is not properly sanitized, and it is pointed to out-of-bound position assigned by upper layer function.

Here is the output of Google ASAN when the vulnerability is triggerred:

# The flags is 0xd6d7d6d6247bff7f

==5286==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61f000000c58 at pc 0x5651b3173086 bp 0x7ffcafde8e10 sp 0x7ffcafde8e08

WRITE of size 8 at 0x61f000000c58 thread T0

#0 0x5651b3173085 in json\_parse\_key /home/hyrathon/Desktop/jsonh/./json.h:1576:22

#1 0x5651b3174e8b in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1694:11

#2 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#3 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#4 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#5 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#6 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#7 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#8 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#9 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#10 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#11 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#12 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#13 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#14 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#15 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#16 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#17 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#18 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#19 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#20 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#21 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#22 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#23 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#24 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#25 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#26 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#27 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#28 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#29 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#30 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#31 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#32 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#33 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#34 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#35 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#36 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#37 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#38 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#39 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#40 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#41 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#42 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#43 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#44 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#45 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#46 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#47 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#48 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#49 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#50 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#51 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#52 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#53 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#54 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#55 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#56 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#57 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#58 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#59 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#60 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#61 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#62 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#63 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#64 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#65 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#66 0x5651b3176ad9 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1955:7

#67 0x5651b317ad4b in json\_parse\_array /home/hyrathon/Desktop/jsonh/./json.h:1809:5

#68 0x5651b3176ed5 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1962:7

#69 0x5651b31758f0 in json\_parse\_object /home/hyrathon/Desktop/jsonh/./json.h:1719:5

#70 0x5651b31761c8 in json\_parse\_value /home/hyrathon/Desktop/jsonh/./json.h:1940:5

#71 0x5651b317ec85 in json\_parse\_ex /home/hyrathon/Desktop/jsonh/./json.h:2129:3

#72 0x5651b3195192 in main /home/hyrathon/Desktop/jsonh/fuzz.c:29:5

#73 0x7f1945b88d8f in \_\_libc\_start\_call\_main csu/../sysdeps/nptl/libc\_start\_call\_main.h:58:16

#74 0x7f1945b88e3f in \_\_libc\_start\_main csu/../csu/libc-start.c:392:3

#75 0x5651b30a3314 in \_start (/home/hyrathon/Desktop/jsonh/san+0x33314) (BuildId: a0e983e1c9c38a8763824dc5481f79d22fe8c82a)

0x61f000000c58 is located 14 bytes to the right of 3018-byte region [0x61f000000080,0x61f000000c4a)

allocated by thread T0 here:

#0 0x5651b312615e in \_\_interceptor\_malloc (/home/hyrathon/Desktop/jsonh/san+0xb615e) (BuildId: a0e983e1c9c38a8763824dc5481f79d22fe8c82a)

#1 0x5651b317df15 in json\_parse\_ex /home/hyrathon/Desktop/jsonh/./json.h:2088:18

#2 0x5651b3195192 in main /home/hyrathon/Desktop/jsonh/fuzz.c:29:5

#3 0x7f1945b88d8f in \_\_libc\_start\_call\_main csu/../sysdeps/nptl/libc\_start\_call\_main.h:58:16

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/hyrathon/Desktop/jsonh/./json.h:1576:22 in json\_parse\_key

Shadow bytes around the buggy address:

0x0c3e7fff8130: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x0c3e7fff8140: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x0c3e7fff8150: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x0c3e7fff8160: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

0x0c3e7fff8170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

=>0x0c3e7fff8180: 00 00 00 00 00 00 00 00 00 02 fa[fa]fa fa fa fa

0x0c3e7fff8190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c3e7fff81a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c3e7fff81b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c3e7fff81c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

0x0c3e7fff81d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

Addressable: 00

Partially addressable: 01 02 03 04 05 06 07

Heap left redzone: fa

Freed heap region: fd

Stack left redzone: f1

Stack mid redzone: f2

Stack right redzone: f3

Stack after return: f5

Stack use after scope: f8

Global redzone: f9

Global init order: f6

Poisoned by user: f7

Container overflow: fc

Array cookie: ac

Intra object redzone: bb

ASan internal: fe

Left alloca redzone: ca

Right alloca redzone: cb

==5286==ABORTING

The input to trigger this bug is attached. The first 8 bytes are the flags for json\_parse\_ex() and the rest is the content(src). Please use address sanitizer to reproduce the bug, as non-crash overflow is hard to detect or locate without shadow memory.

Version: latest commit ([sheredom/json.h@bdcf2e1](https://github.com/sheredom/json.h/commit/bdcf2e1912aa4c0127f755f5f6271c539d6cbf9f))

Also I will attach another input that can trigger similar bug in json\_parse\_key().

[crash-another.zip](https://github.com/sheredom/json.h/files/10000510/crash-another.zip)

### Severity

Moderate

### CVE ID

CVE-2022-45493

### Weaknesses

[CWE-122](/advisories?query=cwe%3A122)

### Credits

* [![@hyrathon](https://avatars.githubusercontent.com/u/1890309?s=40&v=4)](/hyrathon)
  [hyrathon](/hyrathon)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


