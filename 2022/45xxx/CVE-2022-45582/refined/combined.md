=== Content from bugs.launchpad.net_ee22f037_20250114_222056.html ===

[Log in / Register](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Blogin)

[![](https://launchpadlibrarian.net/62132867/os64.png)](https://launchpad.net/horizon)

## [OpenStack Dashboard (Horizon)](https://launchpad.net/horizon)

* [Overview](https://launchpad.net/horizon)
* [Code](https://code.launchpad.net/horizon)
* [Bugs](https://bugs.launchpad.net/horizon)
* [Blueprints](https://blueprints.launchpad.net/horizon)
* [Translations](https://translations.launchpad.net/horizon)
* [Answers](https://answers.launchpad.net/horizon)

# Open redirect / phishing attack via "success\_url" parameter in OpenStack

Bug #1982676 reported by
[Phan NguyÃªn Long](https://launchpad.net/~phannguyenlong)
on 2022-07-24

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Dashboard (Horizon)](https://bugs.launchpad.net/horizon) | Fix Released | High | [Vishal Manchanda](https://launchpad.net/~vishalmanchanda) |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Won't Fix | Undecided | Unassigned |  |

### Bug Description

The "success\_url" param is used when updating the project snapshot and it lacks sanitizing the input URL that allows an attacker to redirect the user to another website.

For instance, the URL below will redirect you to <https://hacker.com>:

<https://xxx.com/project/snapshots/a54c1d97-d354-4171-9602-52fdf0949e83/update/?success_url=https://hacker.com>

The attacker can send this link to the user and when they click on the "Update" button the request and response will look like this:

[+] Request

POST /project/snapshots/a54c1d97-d354-4171-9602-52fdf0949e83/update/?success\_url=https%3A%2F%2Fhacker.coom HTTP/1.1

Host: xxx.com

Cookie: \_ga\_0CPB5J3KQB=GS1.1.1656302247.2.0.1656302247.0; \_ga=GA1.1.2043123211.1656300031; login\_region=default; login\_domain=""; theme=default; sessionid=yl7fjfh7dhpwduodbxb4mjxng46qowgh; csrftoken=j5WQq7woP7OJGKnbTAa6cbQ8zyEgUhWjIZRu4vDMNgbFbNIl5bAe7V2PESYSbUYI; recent\_project=dfcf9f80229f400a9e7ac53782be9e39

User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:91.0) Gecko/20100101 Firefox/91.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8

Accept-Language: en-US,en;q=0.5

<====================>SNIP<====================>

csrfmiddlewaretoken=9wp8nOC21UvAGFxqG0qa1DjRsdKg26P0yqkM1cJqZ3SwbISASBQiWnvyxx4SjJRp&name=snapshot+for+%3Cscript%3Ealert%281%29%3C%2Fscript%3E+%22+%27%5Cu0022%C3%A2%5Cx04&description=

[+] Response

HTTP/1.1 302 Found

date: Tue, 12 Jul 2022 10:14:38 GMT

server: Apache/2.4.41 (Ubuntu)

location: <https://hacker.com>

content-length: 0

x-horizon-location: <https://hacker.com>

x-frame-options: SAMEORIGIN

vary: Accept-Language,Cookie

content-language: en

<====================>SNIP<====================>

Impact: The attacker can trick redirect users to the cloned website to steal information, a so-called Phishing Attack.

CWE-601: URL Redirection to Untrusted Site ('Open Redirect')

<http://cwe.mitre.org/data/definitions/601.html>

I have tested it on OpenStack Xena so the Horizon dashboard could be between version 20.0.0 to 20.1.2. I haven't tested the bug on other versions.

Unfortunately, I have discovered this bug when pen-testing a black box project so I do not have the log file. Hope my information helps you to understand the bug.

See [original description](comments/0)

Tags:

[in-stable-wallaby](/horizon/%2Bbugs?field.tag=in-stable-wallaby)
[in-stable-xena](/horizon/%2Bbugs?field.tag=in-stable-xena)
[in-stable-zed](/horizon/%2Bbugs?field.tag=in-stable-zed)

[Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong)
on 2022-07-24

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2022-07-24: |  |  | [#1](/horizon/%2Bbug/1982676/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete

security advisory task has been added while the core security

reviewers for the affected project or projects confirm the bug and

discuss the scope of any vulnerability along with potential

solutions.

Since this report concerns a possible security risk, an incomplete
security advisory task has been added while the core security
reviewers for the affected project or projects confirm the bug and
discuss the scope of any vulnerability along with potential
solutions.

| **description**: | updated |
| --- | --- |
| Changed in ossa: | |
| **status**: | New â†’ Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-07-26: |  |  | [#2](/horizon/%2Bbug/1982676/comments/2) |
| --- | --- | --- | --- |

May I ask for any updates on the bug?

May I ask for any updates on the bug?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Akihiro Motoki (amotoki)](https://launchpad.net/~amotoki) wrote on 2022-07-27: |  |  | [#3](/horizon/%2Bbug/1982676/comments/3) |
| --- | --- | --- | --- |

I confirmed it.

Using "success\_url" parameter in an URL was introduced in commit a436b12acc85d474f4e71404de771d7143421eed and the corresponding gerrit review is [https://review.opendev.org/c/openstack/horizon/+/270461](https://review.opendev.org/c/openstack/horizon/%2B/270461) .

The affected version is horizon 12.0.0 and later (up to the master).

The URL parameter "success\_url" is used to control a page shown after succeeding the snapshot update operation, but passing the full URL is not a good way to achieve the goal. Horizon should not depend on an URL passed from users. It should be decided internally.

Perhaps a fix would be to define a subclass of [1] instead of using "success\_url" from request.GET.

[1] <https://opendev.org/openstack/horizon/src/branch/master/openstack_dashboard/dashboards/project/snapshots/views.py#L83>

I confirmed it.
Using "success\_url" parameter in an URL was introduced in commit a436b12acc85d474f4e71404de771d7143421eed and the corresponding gerrit review is https://review.opendev.org/c/openstack/horizon/+/270461 .
The affected version is horizon 12.0.0 and later (up to the master).
The URL parameter "success\_url" is used to control a page shown after succeeding the snapshot update operation, but passing the full URL is not a good way to achieve the goal. Horizon should not depend on an URL passed from users. It should be decided internally.
Perhaps a fix would be to define a subclass of [1] instead of using "success\_url" from request.GET.
[1] https://opendev.org/openstack/horizon/src/branch/master/openstack\_dashboard/dashboards/project/snapshots/views.py#L83

| Changed in horizon: | |
| --- | --- |
| **status**: | New â†’ Confirmed |
| **importance**: | Undecided â†’ High |
| **assignee**: | nobody â†’ Akihiro Motoki (amotoki) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-07-30: |  |  | [#4](/horizon/%2Bbug/1982676/comments/4) |
| --- | --- | --- | --- |

Thanks a lot for your confirmation. Please notify me when the bug fix is released so we can disclose this bug.

Thanks a lot for your confirmation. Please notify me when the bug fix is released so we can disclose this bug.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-08-26: |  |  | [#5](/horizon/%2Bbug/1982676/comments/5) |
| --- | --- | --- | --- |

Hi team,

It has been a few weeks since I report this bug. How is it going? Has the fixed been released so we can disclose this report?

Thanks for your time.

Hi team,
It has been a few weeks since I report this bug. How is it going? Has the fixed been released so we can disclose this report?
Thanks for your time.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vishal Manchanda (vishalmanchanda)](https://launchpad.net/~vishalmanchanda) wrote on 2022-08-26: |  |  | [#6](/horizon/%2Bbug/1982676/comments/6) |
| --- | --- | --- | --- |

* [patch.txt](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Battachment/5611853/%2Bfiles/patch.txt)
  [Edit](/horizon/%2Bbug/1982676/%2Battachment/5611853)
  (1.6 KiB,
  text/plain)

@phannguyenlong, Hi I have attached a fix here, please let me know if it fixes this issue?

@phannguyenlong, Hi I have attached a fix here, please let me know if it fixes this issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-08-30: |  |  | [#7](/horizon/%2Bbug/1982676/comments/7) |
| --- | --- | --- | --- |

Dear Team,

It seems to me that the bug has been fixed successfully.

Dear Team,
It seems to me that the bug has been fixed successfully.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-09-05: |  |  | [#8](/horizon/%2Bbug/1982676/comments/8) |
| --- | --- | --- | --- |

Hi Team,

Can we disclose and public this issue so that I can ask for CVE for it?

Hi Team,
Can we disclose and public this issue so that I can ask for CVE for it?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2022-09-05: |  |  | [#9](/horizon/%2Bbug/1982676/comments/9) |
| --- | --- | --- | --- |

Vishal: Is it the Horizon team's assessment that this defect represents a severe enough risk to warrant stable branch backports and a coordinated publication of a security advisory? If not, then we can switch it to public immediately and the fix can just be pushed normally into Gerrit.

Vishal: Is it the Horizon team's assessment that this defect represents a severe enough risk to warrant stable branch backports and a coordinated publication of a security advisory? If not, then we can switch it to public immediately and the fix can just be pushed normally into Gerrit.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2022-09-13: |  |  | [#10](/horizon/%2Bbug/1982676/comments/10) |
| --- | --- | --- | --- |

Any update so far?

Any update so far?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vishal Manchanda (vishalmanchanda)](https://launchpad.net/~vishalmanchanda) wrote on 2022-09-14: |  |  | [#11](/horizon/%2Bbug/1982676/comments/11) |
| --- | --- | --- | --- |

fungi: yeah, it looks like a security issue to me and we should fix and merge it asap in master and stable branches. I am waiting for the horizon CoreSec team and the author of this bug to review the patch I added in #6.

fungi: yeah, it looks like a security issue to me and we should fix and merge it asap in master and stable branches. I am waiting for the horizon CoreSec team and the author of this bug to review the patch I added in #6.

| Changed in horizon: | |
| --- | --- |
| **assignee**: | Akihiro Motoki (amotoki) â†’ Vishal Manchanda (vishalmanchanda) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2022-09-14: |  |  | [#12](/horizon/%2Bbug/1982676/comments/12) |
| --- | --- | --- | --- |

The author seems to indicate in comment #7 (two weeks ago) that the supplied patch works to mitigate the vulnerability. Let me know if you plan to reach out to the Horizon reviewers, or if I should do so, as they don't appear to have weighed in yet. At this point it's taken so long that we've probably missed the opportunity to avoid releasing Zed without this bug.

Given the long times between providing a fix and reviewing it so far, the Horizon team's priority for this problem seems to be very low, which is why I asked whether we should just go ahead and make it public as soon as possible, rather than spending even more time trying to coordinate supplying backported patches to downstream stakeholders in private and scheduling an advisory (which would add at least another week after all the backports are ready).

The author seems to indicate in comment #7 (two weeks ago) that the supplied patch works to mitigate the vulnerability. Let me know if you plan to reach out to the Horizon reviewers, or if I should do so, as they don't appear to have weighed in yet. At this point it's taken so long that we've probably missed the opportunity to avoid releasing Zed without this bug.
Given the long times between providing a fix and reviewing it so far, the Horizon team's priority for this problem seems to be very low, which is why I asked whether we should just go ahead and make it public as soon as possible, rather than spending even more time trying to coordinate supplying backported patches to downstream stakeholders in private and scheduling an advisory (which would add at least another week after all the backports are ready).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Radomir Dopieralski (deshipu)](https://launchpad.net/~deshipu) wrote on 2022-09-14: |  |  | [#13](/horizon/%2Bbug/1982676/comments/13) |
| --- | --- | --- | --- |

The proposed patch mitigates the issue by removing the redirect entirely, which of course works, but degrades the user experience. We can merge it as a stopgap solution, but a correct long-term fix would be to validate the url before redirecting, like we do here:

<https://github.com/openstack/horizon/blob/master/horizon/workflows/views.py#L96-L102>

The proposed patch mitigates the issue by removing the redirect entirely, which of course works, but degrades the user experience. We can merge it as a stopgap solution, but a correct long-term fix would be to validate the url before redirecting, like we do here:
https://github.com/openstack/horizon/blob/master/horizon/workflows/views.py#L96-L102

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2022-09-14: |  |  | [#14](/horizon/%2Bbug/1982676/comments/14) |
| --- | --- | --- | --- |

After further discussion with Vishal Manchanda, the risk implied by this bug is minor enough that the most expedient solution will be to go public with it now and follow our lower-effort public security process: <https://security.openstack.org/vmt-process.html#process>

Please push the proposed fix(es) to Gerrit and mention this report in the commit message, so it can be reviewed there with full context.

After further discussion with Vishal Manchanda, the risk implied by this bug is minor enough that the most expedient solution will be to go public with it now and follow our lower-effort public security process: https://security.openstack.org/vmt-process.html#process
Please push the proposed fix(es) to Gerrit and mention this report in the commit message, so it can be reviewed there with full context.

| **information type**: | Private Security â†’ Public Security |
| --- | --- |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-09-14:  [**Fix proposed to horizon (master)**](/horizon/%2Bbug/1982676/comments/15) |  |  | [#15](/horizon/%2Bbug/1982676/comments/15) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: [https://review.opendev.org/c/openstack/horizon/+/857740](https://review.opendev.org/c/openstack/horizon/%2B/857740)

Fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/horizon/+/857740

| Changed in horizon: | |
| --- | --- |
| **status**: | Confirmed â†’ In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-10-21:  [**Fix merged to horizon (master)**](/horizon/%2Bbug/1982676/comments/16) |  |  | [#16](/horizon/%2Bbug/1982676/comments/16) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/horizon/+/857740](https://review.opendev.org/c/openstack/horizon/%2B/857740)

Committed: <https://opendev.org/openstack/horizon/commit/79d139594290779b2f74ca894332aa7f2f7e4735>

Submitter: "Zuul (22348)"

Branch: master

commit 79d139594290779b2f74ca894332aa7f2f7e4735

Author: manchandavishal <email address hidden>

Date: Wed Sep 14 22:17:58 2022 +0530

Fix success\_url parameter issue for Edit Snapshot

The "success\_url" param is used when updating the project snapshot

Â Â Â Â [1] and it lacks sanitizing the input URL that allows an attacker to

Â Â Â Â redirect the user to another website. This patch update 'Updateview'

Â Â Â Â class to not use the "sucess\_url" method.

Closes-bug: #1982676

[1] <https://github.com/openstack/horizon/blob/master/openstack_dashboard/dashboards/project/snapshots/views.py#L109>

Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b

Reviewed: https://review.opendev.org/c/openstack/horizon/+/857740
Committed: https://opendev.org/openstack/horizon/commit/79d139594290779b2f74ca894332aa7f2f7e4735
Submitter: "Zuul (22348)"
Branch: master
commit 79d139594290779b2f74ca894332aa7f2f7e4735
Author: manchandavishal <manchandavishal143@gmail.com>
Date: Wed Sep 14 22:17:58 2022 +0530
Fix success\_url parameter issue for Edit Snapshot
The "success\_url" param is used when updating the project snapshot
[1] and it lacks sanitizing the input URL that allows an attacker to
redirect the user to another website. This patch update 'Updateview'
class to not use the "sucess\_url" method.
Closes-bug: #1982676
[1] https://github.com/openstack/horizon/blob/master/openstack\_dashboard/dashboards/project/snapshots/views.py#L109
Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b

| Changed in horizon: | |
| --- | --- |
| **status**: | In Progress â†’ Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-10-29:  [**Fix proposed to horizon (stable/zed)**](/horizon/%2Bbug/1982676/comments/17) |  |  | [#17](/horizon/%2Bbug/1982676/comments/17) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/zed

Review: [https://review.opendev.org/c/openstack/horizon/+/862899](https://review.opendev.org/c/openstack/horizon/%2B/862899)

Fix proposed to branch: stable/zed
Review: https://review.opendev.org/c/openstack/horizon/+/862899

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-10-29:  [**Fix proposed to horizon (stable/yoga)**](/horizon/%2Bbug/1982676/comments/18) |  |  | [#18](/horizon/%2Bbug/1982676/comments/18) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/yoga

Review: [https://review.opendev.org/c/openstack/horizon/+/862900](https://review.opendev.org/c/openstack/horizon/%2B/862900)

Fix proposed to branch: stable/yoga
Review: https://review.opendev.org/c/openstack/horizon/+/862900

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-10-29:  [**Fix proposed to horizon (stable/xena)**](/horizon/%2Bbug/1982676/comments/19) |  |  | [#19](/horizon/%2Bbug/1982676/comments/19) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/xena

Review: [https://review.opendev.org/c/openstack/horizon/+/862901](https://review.opendev.org/c/openstack/horizon/%2B/862901)

Fix proposed to branch: stable/xena
Review: https://review.opendev.org/c/openstack/horizon/+/862901

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-10-29:  [**Fix proposed to horizon (stable/wallaby)**](/horizon/%2Bbug/1982676/comments/20) |  |  | [#20](/horizon/%2Bbug/1982676/comments/20) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/wallaby

Review: [https://review.opendev.org/c/openstack/horizon/+/862902](https://review.opendev.org/c/openstack/horizon/%2B/862902)

Fix proposed to branch: stable/wallaby
Review: https://review.opendev.org/c/openstack/horizon/+/862902

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-11-02:  [**Fix merged to horizon (stable/wallaby)**](/horizon/%2Bbug/1982676/comments/21) |  |  | [#21](/horizon/%2Bbug/1982676/comments/21) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/horizon/+/862902](https://review.opendev.org/c/openstack/horizon/%2B/862902)

Committed: <https://opendev.org/openstack/horizon/commit/beed6bf6f6f83df9972db5fb539d64175ce12ce9>

Submitter: "Zuul (22348)"

Branch: stable/wallaby

commit beed6bf6f6f83df9972db5fb539d64175ce12ce9

Author: manchandavishal <email address hidden>

Date: Wed Sep 14 22:17:58 2022 +0530

Fix success\_url parameter issue for Edit Snapshot

The "success\_url" param is used when updating the project snapshot

Â Â Â Â [1] and it lacks sanitizing the input URL that allows an attacker to

Â Â Â Â redirect the user to another website. This patch update 'Updateview'

Â Â Â Â class to not use the "sucess\_url" method.

Closes-bug: #1982676

[1] <https://github.com/openstack/horizon/blob/master/openstack_dashboard/dashboards/project/snapshots/views.py#L109>

Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b

Â Â Â Â (cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

Reviewed: https://review.opendev.org/c/openstack/horizon/+/862902
Committed: https://opendev.org/openstack/horizon/commit/beed6bf6f6f83df9972db5fb539d64175ce12ce9
Submitter: "Zuul (22348)"
Branch: stable/wallaby
commit beed6bf6f6f83df9972db5fb539d64175ce12ce9
Author: manchandavishal <manchandavishal143@gmail.com>
Date: Wed Sep 14 22:17:58 2022 +0530
Fix success\_url parameter issue for Edit Snapshot
The "success\_url" param is used when updating the project snapshot
[1] and it lacks sanitizing the input URL that allows an attacker to
redirect the user to another website. This patch update 'Updateview'
class to not use the "sucess\_url" method.
Closes-bug: #1982676
[1] https://github.com/openstack/horizon/blob/master/openstack\_dashboard/dashboards/project/snapshots/views.py#L109
Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b
(cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

| **tags**: | added: in-stable-wallaby |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-11-04:  [**Fix included in openstack/horizon 19.4.0**](/horizon/%2Bbug/1982676/comments/22) |  |  | [#22](/horizon/%2Bbug/1982676/comments/22) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/horizon 19.4.0 release.

This issue was fixed in the openstack/horizon 19.4.0 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2023-02-14: |  |  | [#23](/horizon/%2Bbug/1982676/comments/23) |
| --- | --- | --- | --- |

Since the bug is fixed and released, could you please request a CVE and put it on OpenStack Security Advisories (OSSA) to notify other users and follow the process here (<https://security.openstack.org/vmt-process.html>).

Since the bug is fixed and released, could you please request a CVE and put it on OpenStack Security Advisories (OSSA) to notify other users and follow the process here (https://security.openstack.org/vmt-process.html).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2023-02-14: |  |  | [#24](/horizon/%2Bbug/1982676/comments/24) |
| --- | --- | --- | --- |

The fix for horizon's stable/yoga branch doesn't appear to pass testing yet, and the fixes for stable/zed and stable/xena still need to be reviewed and approved by horizon developers as well. Once that is done, we can proceed with issuing an advisory.

The fix for horizon's stable/yoga branch doesn't appear to pass testing yet, and the fixes for stable/zed and stable/xena still need to be reviewed and approved by horizon developers as well. Once that is done, we can proceed with issuing an advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Phan NguyÃªn Long (phannguyenlong)](https://launchpad.net/~phannguyenlong) wrote on 2023-02-15: |  |  | [#25](/horizon/%2Bbug/1982676/comments/25) |
| --- | --- | --- | --- |

Thanks for your reply, please notify me when you processing the next step.

Thanks a lot!

Thanks for your reply, please notify me when you processing the next step.
Thanks a lot!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2023-03-07:  [**Fix included in openstack/horizon 23.1.0**](/horizon/%2Bbug/1982676/comments/26) |  |  | [#26](/horizon/%2Bbug/1982676/comments/26) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/horizon 23.1.0 release.

This issue was fixed in the openstack/horizon 23.1.0 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2023-04-10:  [**Fix merged to horizon (stable/xena)**](/horizon/%2Bbug/1982676/comments/27) |  |  | [#27](/horizon/%2Bbug/1982676/comments/27) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/horizon/+/862901](https://review.opendev.org/c/openstack/horizon/%2B/862901)

Committed: <https://opendev.org/openstack/horizon/commit/2f600272bfffb3024e6f06a369f9b4768dd1a0b0>

Submitter: "Zuul (22348)"

Branch: stable/xena

commit 2f600272bfffb3024e6f06a369f9b4768dd1a0b0

Author: manchandavishal <email address hidden>

Date: Wed Sep 14 22:17:58 2022 +0530

Fix success\_url parameter issue for Edit Snapshot

The "success\_url" param is used when updating the project snapshot

Â Â Â Â [1] and it lacks sanitizing the input URL that allows an attacker to

Â Â Â Â redirect the user to another website. This patch update 'Updateview'

Â Â Â Â class to not use the "sucess\_url" method.

Closes-bug: #1982676

[1] <https://github.com/openstack/horizon/blob/master/openstack_dashboard/dashboards/project/snapshots/views.py#L109>

Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b

Â Â Â Â (cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

Reviewed: https://review.opendev.org/c/openstack/horizon/+/862901
Committed: https://opendev.org/openstack/horizon/commit/2f600272bfffb3024e6f06a369f9b4768dd1a0b0
Submitter: "Zuul (22348)"
Branch: stable/xena
commit 2f600272bfffb3024e6f06a369f9b4768dd1a0b0
Author: manchandavishal <manchandavishal143@gmail.com>
Date: Wed Sep 14 22:17:58 2022 +0530
Fix success\_url parameter issue for Edit Snapshot
The "success\_url" param is used when updating the project snapshot
[1] and it lacks sanitizing the input URL that allows an attacker to
redirect the user to another website. This patch update 'Updateview'
class to not use the "sucess\_url" method.
Closes-bug: #1982676
[1] https://github.com/openstack/horizon/blob/master/openstack\_dashboard/dashboards/project/snapshots/views.py#L109
Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b
(cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

| **tags**: | added: in-stable-xena |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2023-04-13:  [**Fix included in openstack/horizon 20.1.4**](/horizon/%2Bbug/1982676/comments/28) |  |  | [#28](/horizon/%2Bbug/1982676/comments/28) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/horizon 20.1.4 release.

This issue was fixed in the openstack/horizon 20.1.4 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2023-08-01:  [**Fix included in openstack/horizon 22.1.1**](/horizon/%2Bbug/1982676/comments/29) |  |  | [#29](/horizon/%2Bbug/1982676/comments/29) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/horizon 22.1.1 release.

This issue was fixed in the openstack/horizon 22.1.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-02-09:  [**Fix merged to horizon (stable/zed)**](/horizon/%2Bbug/1982676/comments/30) |  |  | [#30](/horizon/%2Bbug/1982676/comments/30) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/horizon/+/862899](https://review.opendev.org/c/openstack/horizon/%2B/862899)

Committed: <https://opendev.org/openstack/horizon/commit/93b36289730e74351eb4366ce31d23cc85839f96>

Submitter: "Zuul (22348)"

Branch: stable/zed

commit 93b36289730e74351eb4366ce31d23cc85839f96

Author: manchandavishal <email address hidden>

Date: Wed Sep 14 22:17:58 2022 +0530

Fix success\_url parameter issue for Edit Snapshot

The "success\_url" param is used when updating the project snapshot

Â Â Â Â [1] and it lacks sanitizing the input URL that allows an attacker to

Â Â Â Â redirect the user to another website. This patch update 'Updateview'

Â Â Â Â class to not use the "sucess\_url" method.

Closes-bug: #1982676

[1] <https://github.com/openstack/horizon/blob/master/openstack_dashboard/dashboards/project/snapshots/views.py#L109>

Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b

Â Â Â Â (cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

Reviewed: https://review.opendev.org/c/openstack/horizon/+/862899
Committed: https://opendev.org/openstack/horizon/commit/93b36289730e74351eb4366ce31d23cc85839f96
Submitter: "Zuul (22348)"
Branch: stable/zed
commit 93b36289730e74351eb4366ce31d23cc85839f96
Author: manchandavishal <manchandavishal143@gmail.com>
Date: Wed Sep 14 22:17:58 2022 +0530
Fix success\_url parameter issue for Edit Snapshot
The "success\_url" param is used when updating the project snapshot
[1] and it lacks sanitizing the input URL that allows an attacker to
redirect the user to another website. This patch update 'Updateview'
class to not use the "sucess\_url" method.
Closes-bug: #1982676
[1] https://github.com/openstack/horizon/blob/master/openstack\_dashboard/dashboards/project/snapshots/views.py#L109
Change-Id: Ied142440965b1a722e7a4dd1be3b1be3b3e1644b
(cherry picked from commit 79d139594290779b2f74ca894332aa7f2f7e4735)

| **tags**: | added: in-stable-zed |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-03-05:  [**Fix included in openstack/horizon 23.0.1**](/horizon/%2Bbug/1982676/comments/31) |  |  | [#31](/horizon/%2Bbug/1982676/comments/31) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/horizon 23.0.1 release.

This issue was fixed in the openstack/horizon 23.0.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-10-01: |  |  | [#32](/horizon/%2Bbug/1982676/comments/32) |
| --- | --- | --- | --- |

Given this bug report is over 2 years old and took a year in public just to get into stable point releases, it doesn't seem to rise to the level of urgency where we'd issue an OSSA. As such, I'm closing the Security Advisory task as Won't Fix, but if there are any dissenting opinions I'm happy to reopen and revisit that decision.

Given this bug report is over 2 years old and took a year in public just to get into stable point releases, it doesn't seem to rise to the level of urgency where we'd issue an OSSA. As such, I'm closing the Security Advisory task as Won't Fix, but if there are any dissenting opinions I'm happy to reopen and revisit that decision.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete â†’ Won't Fix |

[See full activity log](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/horizon/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/horizon/%2Bbug/1982676/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [patch.txt](https://bugs.launchpad.net/horizon/%2Bbug/1982676/%2Battachment/5611853/%2Bfiles/patch.txt)
  [Edit](/horizon/%2Bbug/1982676/%2Battachment/5611853 "Change attachment details")

* [Add attachment](/horizon/%2Bbug/1982676/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from lists.debian.org_c2c7737c_20250114_222058.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3678-1] horizon security update - CORRECTED ANNOUNCEMENT

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3678-1] horizon security update - CORRECTED ANNOUNCEMENT
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Fri, 1 Dec 2023 01:56:23 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZWkvN7wYZjVZ2Dqg%40debian.org)Â [ZWkvN7wYZjVZ2Dqg@debian.org](msg00000.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3678-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
December 30, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : horizon
Version        : 3:14.0.2-3+deb10u3
CVE ID         : CVE-2022-45582

[ NB: The original message sent included the wrong DLA reference ID.
This message corrects the reference ID in the subject line.  Everything
else about the content of the former message, including the CVE
identified as fixed and the version of the package in which it is fixed,
remains the same. ]

Phan NguyÃªn Long discovered an Open Redirect vulnerability in horizon, a
web application to control an OpenStack cloud, which could lead to
phishing.

For Debian 10 buster, this problem has been fixed in version
3:14.0.2-3+deb10u3.

We recommend that you upgrade your horizon packages.

For the detailed security status of horizon please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/horizon>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpwtJ8bdmwv6.pgp)**

*Description:* PGP signature

---



=== Content from github.com_c20916e2_20250114_222058.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fhorizon%2Fblob%2Fmaster%2Fhorizon%2Fworkflows%2Fviews.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenstack%2Fhorizon%2Fblob%2Fmaster%2Fhorizon%2Fworkflows%2Fviews.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openstack%2Fhorizon)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openstack](/openstack)
/
**[horizon](/openstack/horizon)**
Public

* [Notifications](/login?return_to=%2Fopenstack%2Fhorizon) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fopenstack%2Fhorizon)
* [Star
   1.4k](/login?return_to=%2Fopenstack%2Fhorizon)

* [Code](/openstack/horizon)
* [Pull requests
  0](/openstack/horizon/pulls)
* [Actions](/openstack/horizon/actions)
* [Security](/openstack/horizon/security)
* [Insights](/openstack/horizon/pulse)

Additional navigation options

* [Code](/openstack/horizon)
* [Pull requests](/openstack/horizon/pulls)
* [Actions](/openstack/horizon/actions)
* [Security](/openstack/horizon/security)
* [Insights](/openstack/horizon/pulse)

## Files

Â master
## Breadcrumbs

1. [horizon](/openstack/horizon/tree/master)
2. /[horizon](/openstack/horizon/tree/master/horizon)
3. /[workflows](/openstack/horizon/tree/master/horizon/workflows)
/
# views.py

Copy path Blame  Blame
## Latest commit

## History

[History](/openstack/horizon/commits/master/horizon/workflows/views.py)227 lines (191 loc) Â· 8.45 KBÂ master
## Breadcrumbs

1. [horizon](/openstack/horizon/tree/master)
2. /[horizon](/openstack/horizon/tree/master/horizon)
3. /[workflows](/openstack/horizon/tree/master/horizon/workflows)
/
# views.py

Top
## File metadata and controls

* Code
* Blame

227 lines (191 loc) Â· 8.45 KB[Raw](https://github.com/openstack/horizon/raw/refs/heads/master/horizon/workflows/views.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227# Copyright 2012 Nebula, Inc.## Licensed under the Apache License, Version 2.0 (the "License"); you may# not use this file except in compliance with the License. You may obtain# a copy of the License at## http://www.apache.org/licenses/LICENSE-2.0## Unless required by applicable law or agreed to in writing, software# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the# License for the specific language governing permissions and limitations# under the License.
import copyimport json
from django import formsfrom django import httpfrom django import shortcutsfrom django.utils import http as utils\_httpfrom django.views import generic
from horizon import exceptionsfrom horizon.forms import views as hz\_viewsfrom horizon.forms.views import ADD\_TO\_FIELD\_HEADERfrom horizon import messagesfrom horizon.utils import http as http\_utils
class WorkflowView(hz\_views.ModalBackdropMixin, generic.TemplateView): """A generic view which handles the intricacies of workflow processing.
 .. attribute:: workflow\_class
 The :class:`~horizon.workflows.Workflow` class which this view handles. Required.
 .. attribute:: template\_name
 The template to use when rendering this view via standard HTTP requests. Required.
 .. attribute:: ajax\_template\_name
 The template to use when rendering the workflow for AJAX requests. In general the default common template should be used. Defaults to ``"horizon/common/\_workflow.html"``.
 .. attribute:: context\_object\_name
 The key which should be used for the workflow object in the template context. Defaults to ``"workflow"``.
 """ workflow\_class = None template\_name = 'horizon/common/\_workflow\_base.html' context\_object\_name = "workflow" ajax\_template\_name = 'horizon/common/\_workflow.html' step\_errors = {}
 def \_\_init\_\_(self): super().\_\_init\_\_() if not self.workflow\_class: raise AttributeError("You must set the workflow\_class attribute " "on %s." % self.\_\_class\_\_.\_\_name\_\_)
 def get\_initial(self): """Returns initial data for the workflow.
 Defaults to using the GET parameters to allow pre-seeding of the workflow context values. """ return copy.copy(self.request.GET)
 def get\_workflow(self): """Returns the instantiated workflow class.""" extra\_context = self.get\_initial() entry\_point = self.request.GET.get("step", None) workflow = self.workflow\_class(self.request, context\_seed=extra\_context, entry\_point=entry\_point) return workflow
 def get\_context\_data(self, \*\*kwargs): """Returns the template context, including the workflow class.
 This method should be overridden in subclasses to provide additional context data to the template. """ context = super().get\_context\_data(\*\*kwargs) workflow = self.get\_workflow() workflow.verify\_integrity() context[self.context\_object\_name] = workflow
 redirect\_to = self.request.GET.get(workflow.redirect\_param\_name) # Make sure the requested redirect is safe if (redirect\_to and not utils\_http.url\_has\_allowed\_host\_and\_scheme( url=redirect\_to, allowed\_hosts=[self.request.get\_host()])): redirect\_to = None context['REDIRECT\_URL'] = redirect\_to
 context['layout'] = self.get\_layout() # For consistency with Workflow class context['modal'] = 'modal' in context['layout']
 if ADD\_TO\_FIELD\_HEADER in self.request.META: context['add\_to\_field'] = self.request.META[ADD\_TO\_FIELD\_HEADER] return context
 def get\_layout(self): """Returns classes for the workflow element in template.
 The returned classes are determied based on the workflow characteristics. """ if http\_utils.is\_ajax(self.request): layout = ['modal', ] else: layout = ['static\_page', ]
 if self.workflow\_class.wizard: layout += ['wizard', ]
 return layout
 def get\_template\_names(self): """Returns the template name to use for this request.""" if http\_utils.is\_ajax(self.request): template = self.ajax\_template\_name else: template = self.template\_name return template
 def get\_object\_id(self, obj): return getattr(obj, "id", None)
 def get\_object\_display(self, obj): return getattr(obj, "name", None)
 def add\_error\_to\_step(self, error\_msg, step): self.step\_errors[step] = error\_msg
 def set\_workflow\_step\_errors(self, context): workflow = context['workflow'] for step in self.step\_errors: error\_msg = self.step\_errors[step] workflow.add\_error\_to\_step(error\_msg, step)
 def get(self, request, \*args, \*\*kwargs): """Handler for HTTP GET requests.""" try: context = self.get\_context\_data(\*\*kwargs) except exceptions.NotAvailable: exceptions.handle(request) self.set\_workflow\_step\_errors(context) return self.render\_to\_response(context)
 def validate\_steps(self, request, workflow, start, end): """Validates the workflow steps from ``start`` to ``end``, inclusive.
 Returns a dict describing the validation state of the workflow. """ errors = {} for step in workflow.steps[start:end + 1]: if not step.action.is\_valid(): errors[step.slug] = dict( (field, [str(error) for error in errors]) for (field, errors) in step.action.errors.items()) return { 'has\_errors': bool(errors), 'workflow\_slug': workflow.slug, 'errors': errors, }
 def post(self, request, \*args, \*\*kwargs): """Handler for HTTP POST requests.""" context = self.get\_context\_data(\*\*kwargs) workflow = context[self.context\_object\_name] try: # Check for the VALIDATE\_STEP\* headers, if they are present # and valid integers, return validation results as JSON, # otherwise proceed normally. validate\_step\_start = int(self.request.META.get( 'HTTP\_X\_HORIZON\_VALIDATE\_STEP\_START', '')) validate\_step\_end = int(self.request.META.get( 'HTTP\_X\_HORIZON\_VALIDATE\_STEP\_END', '')) except ValueError: # No VALIDATE\_STEP\* headers, or invalid values. Just proceed # with normal workflow handling for POSTs. pass else: # There are valid VALIDATE\_STEP\* headers, so only do validation # for the specified steps and return results. data = self.validate\_steps(request, workflow, validate\_step\_start, validate\_step\_end) return http.HttpResponse(json.dumps(data), content\_type="application/json") if not workflow.is\_valid(): return self.render\_to\_response(context) try: success = workflow.finalize() except forms.ValidationError: return self.render\_to\_response(context) except Exception: success = False exceptions.handle(request) if success: msg = workflow.format\_status\_message(workflow.success\_message) messages.success(request, msg) else: msg = workflow.format\_status\_message(workflow.failure\_message) messages.error(request, msg) if "HTTP\_X\_HORIZON\_ADD\_TO\_FIELD" in self.request.META: field\_id = self.request.META["HTTP\_X\_HORIZON\_ADD\_TO\_FIELD"] response = http.HttpResponse(content\_type="text/plain") if workflow.object: data = [self.get\_object\_id(workflow.object), self.get\_object\_display(workflow.object)] response.content = json.dumps(data) response["X-Horizon-Add-To-Field"] = field\_id return response next\_url = self.request.POST.get(workflow.redirect\_param\_name) return shortcuts.redirect(next\_url or workflow.get\_success\_url())

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from lists.debian.org_e0873763_20250114_222058.html ===


---

[[Date Prev](msg00032.html)][[Date Next](msg00034.html)]
[[Thread Prev](msg00032.html)][[Thread Next](msg00034.html)]
[[Date Index](maillist.html#00033)]
[[Thread Index](threads.html#00033)]

# [SECURITY] [DLA 3676-1] horizon security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3676-1] horizon security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Thu, 30 Nov 2023 23:59:28 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZWkT0L4-ocq_yWSr%40debian.org)Â [ZWkT0L4-ocq\_yWSr@debian.org](msg00033.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3676-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
November 30, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : horizon
Version        : 3:14.0.2-3+deb10u3
CVE ID         : CVE-2022-45582

Phan NguyÃªn Long discovered an Open Redirect vulnerability in horizon, a
web application to control an OpenStack cloud, which could lead to
phishing.

For Debian 10 buster, this problem has been fixed in version
3:14.0.2-3+deb10u3.

We recommend that you upgrade your horizon packages.

For the detailed security status of horizon please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/horizon>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpEeCHJZH87r.pgp)**

*Description:* PGP signature

---


