=== Content from bugzilla.mozilla.org_63251886_20250115_080659.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1762078)
* [XML](/show_bug.cgi?ctype=xml&id=1762078)

Closed
[Bug 1762078](/show_bug.cgi?id=1762078)
(CVE-2022-45403)

Opened 3 years ago
Closed 2 years ago

# ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests

## Categories

### (Core :: DOM: Service Workers, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Service%20Workers#DOM%3A%20Service%20Workers)

DOM: Service Workers
▾

Core :: DOM: Service Workers
This component covers the [Service Worker](https://github.com/slightlyoff/ServiceWorker/) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Service%20Workers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

108 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed) |
| firefox108 | [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 107+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox106 |  | wontfix |
| firefox107 | + | fixed |
| firefox108 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: karlt, Assigned: joshuacmarshall)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/496249e89eff71e303675e6e66a087ae?d=mm&size=40)  [joshuacmarshall](/user_profile?user_id=706794)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/15d034eb5ed480cb10a8a9e41e8b9f13?d=mm&size=40)  [karlt](/user_profile?user_id=274246)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker")

[1733981](/show_bug.cgi?id=1733981 "RESOLVED FIXED - CORS: Allow particular Range header values without a preflight")

Dependency [tree](/showdependencytree.cgi?id=1762078&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1762078)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1803205](/show_bug.cgi?id=1803205 "RESOLVED WONTFIX - Service Worker fetch event no longer firing for audio")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-31736](/show_bug.cgi?id=1735923 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers")

## Details

### (Keywords: csectype-sop, sec-high, Whiteboard: [post-critsmash-triage][adv-main107+][adv-esr102.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-45403

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main107+][adv-esr102.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dmeehan](/user_profile?user_id=695136) | [in-testsuite](#c48 "2 years ago") | + |
| --- | --- | --- |
| [dmeehan](/user_profile?user_id=695136) | in-testsuite | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a18641601_553429 "2 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [Bug 1762078 - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers](/attachment.cgi?id=9276873)  [3 years ago](#c11)  [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9276873&action=edit) | [Review](/attachment.cgi?id=9276873) |
| --- | --- | --- |
| [Bug 1762078 - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers](/attachment.cgi?id=9276874)  [3 years ago](#c12)  [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c28 "2 years ago")  tjr : [sec-approval+](#c23 "2 years ago") | [Details](/attachment.cgi?id=9276874&action=edit) | [Review](/attachment.cgi?id=9276874) |
| [Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!](/attachment.cgi?id=9298501)  [2 years ago](#c19)  [Joshua Marshall](/user_profile?user_id=706794)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-release+](#c47 "2 years ago")  tjr : [sec-approval+](#a18287553_578488 "2 years ago") | [Details](/attachment.cgi?id=9298501&action=edit) | [Review](/attachment.cgi?id=9298501) |
| [Patch for esr102](/attachment.cgi?id=9301605)  [2 years ago](#c26)  [Joshua Marshall](/user_profile?user_id=706794)   6.32 KB, patch | dmeehan : [approval-mozilla-esr102+](#c31 "2 years ago") | [Details](/attachment.cgi?id=9301605&action=edit) | [Diff](/attachment.cgi?id=9301605&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1762078&attachment=9301605) |
| [WIP: Bug 1762078 - Lint python file. Fix video file.](/attachment.cgi?id=9301849)  [2 years ago](#c34)  [Joshua Marshall](/user_profile?user_id=706794)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9301849&action=edit) | [Review](/attachment.cgi?id=9301849) |
| [WIP: Bug 1762078 - Remove problematic file.](/attachment.cgi?id=9302030)  [2 years ago](#c38)  [Joshua Marshall](/user_profile?user_id=706794)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9302030&action=edit) | [Review](/attachment.cgi?id=9302030) |
| [advisory.txt](/attachment.cgi?id=9302885)  [2 years ago](#c45)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   353 bytes, text/plain |  | [Details](/attachment.cgi?id=9302885&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1762078#c0)• 3 years ago |
|  | |

(In reply to Anne (:annevk) from [bug 1735923 comment 7](/show_bug.cgi?id=1735923#c7 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> 1. Jake's fundamental fix is essentially not allowing mixing of non-opaque and opaque responses in media elements.

[Bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") covers a current exposure there.

> Arguably one problem here is that the cross-origin request is still made. It seems like it should be possible to network error earlier when we detect a cross-origin request after we've started using same-origin responses.

That's this bug.

> 2. There's another solution to this problem outside of media elements, which is that we fix Resource Timing along the lines suggested in <https://github.com/w3c/resource-timing/issues/165>,

Firefox already [adds ResourceTiming entries](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/netwerk/protocol/http/HttpBaseChannel.cpp#5094) for both 206 and 416 responses.

> but it's not clear to me that it could not be exploited in other ways. E.g., it seems timing the cross-origin response might also give the attacker some information about whether it's a 206 or 416.

This bug.

> (There's also <https://github.com/whatwg/fetch/pull/1311> about exposing network errors to Resource Timing as well [...].)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1762078#c1)• 3 years ago |
|  | |

Anne, if [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") were addressed, then would the remaining known/expected issue be only the timing of responses leaking information about the resource, such as its length?

This issue exists to some extent to without ServiceWorker and just the no-cors media element request, where timing might provide an estimate of length or existence.

Do you have any more details of a solution in mind that you could fill in here?

Once a service worker synthesizes a response to cross-origin request, were you thinking along the lines of one of these?

1. The media element would then no longer send cross origin requests.

   The ServiceWorker would have no way to complete the response.

   (The ServiceWorker could still cache cross-origin responses, with support from a fix to [bug 1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker"), and respond with those, if it does not synthesize any response.)
2. `fetch()` would then network error before sending requests in response to the cross-origin `FetchEvent`, and [HTTP fetch](https://fetch.spec.whatwg.org/#http-fetch) error on a null response from `FetchEvent`.

   The first part at least might be tricky given responses are async, but perhaps the Request could be neutered so that it (or its clone) could never be used to generate a Response.

   The ServiceWorker has the opportunity to synthesize another response.

   Presumably (possibly cached) cross-origin responses would continue to be rejected by media element ([bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)")).
Flags: needinfo?(annevk)See Also: → [CVE-2022-31736](/show_bug.cgi?id=1735923 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers")

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1762078#c2)• 3 years ago |
|  | |

Our defense model for passing Range requests to ServiceWorker seems largely based on assuming media element is not going to make requests that might leak too much information.

Allowing the ServiceWorker to synthesize a response makes this easier to defeat.

A ServiceWorker synthesized response to a cross-origin request feels like an unauthorized redirect. Is this usually OK because the ServiceWorker is always same-origin with the entity making the request?

For option 1 (and [bug 1762068 comment 2](/show_bug.cgi?id=1762068#c2 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)")), is there a good way for media element to identify a synthesized response?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a78720_406194)• 3 years ago |

Group: media-core-security, core-security → dom-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a82278_1689)• 3 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1762078#c3)• 3 years ago |
|  | |

I think if [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") were addressed, not making the request at all would mainly be defense-in-depth. Attackers can create such requests although until [bug 1733981](/show_bug.cgi?id=1733981 "RESOLVED FIXED - CORS: Allow particular Range header values without a preflight") is addressed this might be harder in Firefox.

The model I have in mind for media elements is that they make an initial request and then multiple subsequent requests. The final redirected URL of the initial request is what is used by subsequent requests. (This matches Chrome as far as I can tell.) If subsequent requests redirect, terminate. (This used to match Chrome, but they changed things. Reportedly they're flexible on this though.)

That's how you'd do requests. Then for responses you'd keep track of their origin and the moment you get a response from a different origin you'd terminate.

Upon reflection though it seems hard to prevent a "malicious" request being made. If the attacker always supplies synthetic responses for a cross-origin URL, the request would go out to the service worker which could then forward it. As you mention in [comment 1](/show_bug.cgi?id=1762078#c1 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") that would get quite messy to avoid and it's not clear it would even stick given that we are making the `Range` header available to attackers.

The only other thing I can think of is that synthetic responses would not be allowed for "no-cors" media elements that make requests across the origin boundary. You could still use cached responses however assuming the URLs match up. It's not clear how web compatible that would be.

What do you think?

Flags: needinfo?(annevk)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a570349_646284)• 3 years ago |

Severity: -- → S2Priority: -- → P1

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a639516_516138)• 3 years ago |

Assignee: nobody → echuang

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1762078#c4)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1762078&comment_id=15852030 "1 revision") |
|  | |

(In reply to Anne (:annevk) from [comment #3](/show_bug.cgi?id=1762078#c3 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> The model I have in mind for media elements is that they make an initial request and then multiple subsequent requests. The final redirected URL of the initial request is what is used by subsequent requests. (This matches Chrome as far as I can tell.)

This is somewhat consistent with Gecko behavior, but the final redirected path of [each subsequent request is used](https://searchfox.org/mozilla-central/rev/73a6abf1aaedbf7613fa90a7f459a8c0dfe5f0ce/dom/media/ChannelMediaResource.cpp#398) for its next request.

> If subsequent requests redirect, terminate. (This used to match Chrome, but they changed things. Reportedly they're flexible on this though.)
>
> That's how you'd do requests. Then for responses you'd keep track of their origin and the moment you get a response from a different origin you'd terminate.

In Gecko, subsequent responses will terminate only [when origins differ](https://searchfox.org/mozilla-central/rev/66b43502bdbe4b62cbc8b0c8ff10efc5707352e4/dom/media/ChannelMediaResource.cpp#807).

If the cross-origin server (rather than the service worker) chooses to redirect to a different path but same (cross-)origin, then I'm not aware of a problem with that.

I'm uncomfortable with allowing service workers to coerce a mixture of same-cross-origin but different-path opaque responses by emulating a path redirect through returning an opaque response from a fetch with different path.

A cached response from a ServiceWorker with a different path would currently be treated by media element like a redirect.

AFAIK that is not possible to abuse until ServiceWorker can pass on the Range headers ([bug 1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker")), but I haven't investigated whether a 200 OK response to a different-path request would overwrite the media resource from a 206 Partial Content initial response or whether it might lead to problematic mixing of different opaque resources.

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1762078#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1762078&comment_id=15852031 "2 revisions") |
|  | |

(In reply to Anne (:annevk) from [comment #3](/show_bug.cgi?id=1762078#c3 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> The only other thing I can think of is that synthetic responses would not be allowed for "no-cors" media elements that make requests across the origin boundary. You could still use cached responses however assuming the URLs match up. It's not clear how web compatible that would be.

Media elements have their own fallback mechanisms for network failures (Source child elements and/or MediaSource), so I don't know of a good additional use case for synthetic responses for cross-origin "no-cors" requests.

The key question is web-compatibility, and I don't know the answer to that.

As for the benefits of disallowing such responses, the area of risk addressed would be in preventing use of synthesized responses to make media elements generate specific no-cors Range requests, which might not otherwise be available but could then be passed on to `fetch()` when we add support for passing on Range headers ([bug 1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker")).

It would not address either of these risks:

* Unsanctioned cross-path redirects mixing same-cross-origin opaque resources.
* Sending media element requests to ServiceWorker is exposing a lower bound on the length of the opaque cross-origin resource. Addressing this would require that no-cors cross-origin requests (or at least parts of them) are not readable by ServiceWorker.

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1762078#c6)• 3 years ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #5](/show_bug.cgi?id=1762078#c5 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> As for the benefits of disallowing such responses, the area of risk addressed would be in preventing use of synthesized responses to make media elements generate specific no-cors Range requests, which might not otherwise be available but could then be passed on to `fetch()` when we add support for passing on Range headers ([bug 1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker")).

I considered verifying Partial Content response byte ranges against the requested ranges as an alternative solution with the same benefits. To be effective, however, the body provided would also need to match up, but erroring on an incomplete stream could be problematic, as we [intentionally don't do that currently](https://hg.mozilla.org/mozilla-central/rev/2ab43146677cf5bb9f2b4cdc8bab8355fcfeedc0#l4.280) and restarts on incomplete bodies were [explicitly added](https://bugzilla.mozilla.org/show_bug.cgi?id=1418430) despite [questionable validity of such responses](https://github.com/whatwg/html/pull/7782#issuecomment-1095664520).

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1762078#c7)• 3 years ago |
|  | |

IIUC a synthetic response from the `Response` constructor is not a filtered response.

The [main fetch algorithm](https://fetch.spec.whatwg.org/#concept-main-fetch) says that when 'request’s mode is "no-cors"' and noCorsResponse is not a filtered response, the algorithm should "Return a new response whose status is noCorsResponse’s status."

Such a response would have no body or headers, and so such synthetic responses are already effectively blocked by the spec (unless I've missed something that would turn the response into a filtered response).

That's not how Firefox behaves though, [nor Chrome](https://bugs.chromium.org/p/chromium/issues/detail?id=990849).

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1762078#c8)• 3 years ago |
|  | |

I am not sure if my understanding of the above discussion is correct.

It seems that the media element could send a series range of requests that request same-cross-origin resources. And these requests could be intercepted by a ServiceWorker.

When the cross-origin resource is requested, we should return a NetworkError response for such cross-origin resources, since the opaque and non-opaque mixed response is not allowed according to the first point of <https://bugzilla.mozilla.org/show_bug.cgi?id=1735923#c7>.

And we have a patch <https://phabricator.services.mozilla.com/D143865> which is handled in the media element.

However, it could return NetworkError much earlier in ServiceWorker code. Two options are proposed by Karl in [comment 1](/show_bug.cgi?id=1762078#c1 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests").

But the statement in [comment 3](/show_bug.cgi?id=1762078#c3 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") "That's how you'd do requests. Then for responses you'd keep track of their origin and the moment you get a response from a different origin you'd terminate." confuses me a little bit where should this be done? in ServiceWorker code or Media element code?

We probably can decide if should we return NetworkError when by checking the response sent to FetchEvent.respondWith, but is it the correct point to handle this? Because it would become a special case response handling in ServiceWorker.

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1762078#c9)• 3 years ago |
|  | |

Hi Eden, any progress here? Thanks!

Flags: needinfo?(echuang)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1762078#c10)• 3 years ago |
|  | |

The discussion here has not yet converged on a clear plan. There are risks ([comment 3](/show_bug.cgi?id=1762078#c3 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests")) but actual likely exploits are not identified. The risks should at least be reconsidered before addressing [bug 1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker") and [bug 1733981](/show_bug.cgi?id=1733981 "RESOLVED FIXED - CORS: Allow particular Range header values without a preflight"), but applying mitigations now might be easier than after more sites might depend on the current behavior.

The most effective reduction in risks would be to skip passing no-cors cross-origin range requests to ServiceWorker at all.

Perhaps trying that on nightly might be a first step here?

Blocks: [1733981](/show_bug.cgi?id=1733981 "RESOLVED FIXED - CORS: Allow particular Range header values without a preflight")

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1762078#c11)• 3 years ago |
|  | |

Attached file
[Bug 1762078 - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers](attachment.cgi?id=9276873) (obsolete)
— [Details](attachment.cgi?id=9276873&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a4186324_600971)• 3 years ago |

[Attachment #9276873](/attachment.cgi?id=9276873&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") -
Attachment is obsolete: true

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1762078#c12)• 3 years ago |
|  | |

Attached file
[Bug 1762078 - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers](attachment.cgi?id=9276874)
— [Details](attachment.cgi?id=9276874&action=edit)

|  | [Eden Chuang[:edenchuang]](/user_profile?user_id=516138) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a4187693_516138)• 3 years ago |

Flags: needinfo?(echuang)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a8006014_706794)• 3 years ago |

Assignee: echuang → jmarshallStatus: NEW → ASSIGNED

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1762078#c13)• 3 years ago |
|  | |

(In reply to Karl Tomlinson (back July 25 :karlt) from [comment #10](/show_bug.cgi?id=1762078#c10 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> The most effective reduction in risks would be to skip passing no-cors cross-origin range requests to ServiceWorker at all.
>
> Perhaps trying that on nightly might be a first step here?

Going to implement this.

Assignee: jmarshall → bugmail

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1762078#c14)• 2 years ago |
|  | |

Hi Andrew, any news here? Thank you!

Flags: needinfo?(bugmail)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a10425788_706794)• 2 years ago |

Assignee: bugmail → jmarshall

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a10430705_151407)• 2 years ago |

Flags: needinfo?(bugmail)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a10889471_706794)• 2 years ago |

Depends on: [1782835](/show_bug.cgi?id=1782835 "RESOLVED FIXED - Implement addition of accept-encoding:identity as per fetch spec")

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a13291940_706794)• 2 years ago |

No longer depends on: [1782835](/show_bug.cgi?id=1782835 "RESOLVED FIXED - Implement addition of accept-encoding:identity as per fetch spec")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1762078#c15)• 2 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/822f257fe8707522d26a810d194d13a99aed362e>

Backed out for causing wpt failures related to service workers:

<https://hg.mozilla.org/integration/autoland/rev/dcd1d755604f367a20c90958be67328a1a70ed2b>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=BKKvwENFSiKQty2eQZcDXQ.0&resultStatus=success%2Ctestfailed%2Cbusted%2Cexception%2Crunnable&revision=822f257fe8707522d26a810d194d13a99aed362e>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=392813804&repo=autoland>

> TEST-UNEXPECTED-TIMEOUT | /fetch/range/sw.https.window.html | Defer range header filter tests to service worker - Test timed out
>
> followed by more failure lines

Flags: needinfo?(jmarshall)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1762078#c16)• 2 years ago |
|  | |

This passes for me:

$ ./mach wpt testing/web-platform/tests/content-security-policy/gen/top.meta/worker-src-self/sharedworker-classic.https.html

Flags: needinfo?(jmarshall) → needinfo?(aryx.bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1762078#c17)• 2 years ago |
|  | |

Unfortunately tests passing locally but not in CI is common. :aryx did the backout as a code sheriff per policy and it's on us to dig into figuring out why the failure happened (or unexpected successes! WPT tests can get in general if the expectations don't match with what happens.) Setting a needinfo on me to try and provide some context on this.

Flags: needinfo?(aryx.bugmail) → needinfo?(bugmail)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1762078#c18)• 2 years ago |
|  | |

The test [failed on all platforms except on Windows debug and Linux asan opt](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=success%2Ctestfailed%2Cbusted%2Cexception%2Crunnable&searchStr=web-platform&test_paths=fetch%2Frange&revision=d2d7ad3741c8c1d5e37cde2fa70b827409c8355e) because it [doesn't run for the latter](https://searchfox.org/mozilla-central/rev/e94c6cb9649bfe4e6a3888460f41bcd4fe30a6ca/testing/web-platform/meta/fetch/range/sw.https.window.js.ini).

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1762078#c19)• 2 years ago |
|  | |

Attached file
[Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!](attachment.cgi?id=9298501)
— [Details](attachment.cgi?id=9298501&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1762078#c20)• 2 years ago |
|  | |

Blocking SerivceWorker interception for no\_cors cross-origin range request. r=dom-worker-reviewers,karlt

<https://hg.mozilla.org/integration/autoland/rev/47a7f8cc08213c60a6fc0c294c18b803fa69d2aa>

<https://hg.mozilla.org/mozilla-central/rev/47a7f8cc0821>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 108 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1762078#c21)• 2 years ago |
|  | |

This is rated sec-high and AFAICT affects more than just Nightly. As such, it should have gone through the sec-approval process before landing.

<https://firefox-source-docs.mozilla.org/bug-mgmt/processes/security-approval.html>

Please fill out the form retroactively so we can assess what needs to happen here for the branches.

[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fix-optional)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)Flags: needinfo?(jmarshall)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1762078#c22)• 2 years ago |
|  | |

Comment on [attachment 9276874](/attachment.cgi?id=9276874 "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. The concern is that the timing of ResourceTiming entries (influenced by a nefarious service worker) could be used to determine the size of an opaque cross-origin resource. But this patch only prevents service workers from intercepting the request--timing isn't mentioned.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: This change should be easy to backport to any revision needing it.
* **How likely is this patch to cause regressions; how much testing does it need?**:
* **Is Android affected?**: Yes
Flags: needinfo?(jmarshall)
[Attachment #9276874](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") -
Flags: sec-approval?

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18108388_706794)• 2 years ago |

[Attachment #9298501](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18154415_75935)• 2 years ago |

[tracking-firefox107](/buglist.cgi?f1=cf_tracking_firefox107&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox107&o1=equals&v1=%2B)
[tracking-firefox108](/buglist.cgi?f1=cf_tracking_firefox108&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1762078#c23)• 2 years ago |
|  | |

Comment on [attachment 9276874](/attachment.cgi?id=9276874 "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers

So we've landed the patch and some test annotations and e want to land some test updates that show the interception doesn't work but doesn't explain why that's important. We can land those tests now, and uplift everything when ready.

[Attachment #9276874](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18287553_578488)• 2 years ago |

[Attachment #9298501](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") -
Flags: sec-approval? → sec-approval+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18641601_553429)• 2 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1762078#c24)• 2 years ago |
|  | |

Please nominate this for Beta and ESR102 approval when you get a chance.

Flags: needinfo?(jmarshall)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1762078#c25)• 2 years ago |
|  | |

Comment on [attachment 9276874](/attachment.cgi?id=9276874 "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers

### Beta/Release Uplift Approval Request

* **User impact if declined**: Possible security hole involving resource timing, allowing an attacker to determine the length of opaque cross-origin media elements. (Test is <https://phabricator.services.mozilla.com/D159315>, landing shortly.)
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change just prevents service workers from intercepting cross-origin no-cors media requests. I believe the risk is low.
* **String changes made/needed**:
* **Is Android affected?**: Yes
Flags: needinfo?(jmarshall)
[Attachment #9276874](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-beta?

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18815342_706794)• 2 years ago |

[Attachment #9298501](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") -
Flags: approval-mozilla-beta?

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1762078#c26)• 2 years ago |
|  | |

Attached patch

[Patch for esr102](attachment.cgi?id=9301605&action=diff)
— [Details](attachment.cgi?id=9301605&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1762078&attachment=9301605)

ESR Approval Request Comment

[Feature/Bug causing the regression]:

[User impact if declined]:

[Is this code covered by automated tests?]:

[Has the fix been verified in Nightly?]:

[Needs manual test from QE? If yes, steps to reproduce]:

[List of other uplifts needed for the feature/fix]:

[Is the change risky?]:

[Why is the change risky/not risky?]:

[String changes made/needed]:

See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1762078#c27)• 2 years ago |
|  | |

Comment on [attachment 9301605](/attachment.cgi?id=9301605 "Patch for esr102") [[details]](/attachment.cgi?id=9301605&action=edit "Patch for esr102") [[diff]](/attachment.cgi?id=9301605&action=diff "Patch for esr102") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1762078&attachment=9301605)

Patch for esr102

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Possible security hole involving resource timing, allowing an attacker to determine the length of opaque cross-origin media elements. (Test is <https://phabricator.services.mozilla.com/D159315>, landing shortly.)
* **Fix Landed on Version**: 77cf4980fc9f
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change just prevents service workers from intercepting cross-origin no-cors media requests. I believe the risk is low.
[Attachment #9301605](/attachment.cgi?id=9301605&action=edit "Patch for esr102") -
Flags: approval-mozilla-esr102?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1762078#c28)• 2 years ago |
|  | |

Comment on [attachment 9276874](/attachment.cgi?id=9276874 "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") [[details]](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Blocking SerivceWorker interception for no\_cors cross-origin range request. r=#dom-worker-reviewers

Approved for 107.0b9

[Attachment #9276874](/attachment.cgi?id=9276874&action=edit "Bug 1762078 - Blocking SerivceWorker interception for no_cors cross-origin range request. r=#dom-worker-reviewers") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1762078#c29)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/de41ff951322>

[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fix-optional) → [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1762078#c30)• 2 years ago |
|  | |

<https://bugzilla.mozilla.org/attachment.cgi?id=9298501> is still pending landing in central. Required before uplifting to beta.

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1762078#c31)• 2 years ago |
|  | |

Comment on [attachment 9301605](/attachment.cgi?id=9301605 "Patch for esr102") [[details]](/attachment.cgi?id=9301605&action=edit "Patch for esr102") [[diff]](/attachment.cgi?id=9301605&action=diff "Patch for esr102") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1762078&attachment=9301605)

Patch for esr102

Approved for 102.5esr.

[Attachment #9301605](/attachment.cgi?id=9301605&action=edit "Patch for esr102") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1762078#c32)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/3589b2870511>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1762078#c33)• 2 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/1840f6c848d9db0d801094b3809d9d77c6dbf469>

Backed out from autoland for linting failures: <https://hg.mozilla.org/integration/autoland/rev/aace7a9cb4c0c2e34b17ddb9efaa7f50dfa7f27f>

Push with failures (black and flake8): <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=WrdbyU81QRaMSc0jr7G7jw.0&resultStatus=retry%2Ctestfailed%2Cbusted%2Cexception%2Cusercancel&revision=1840f6c848d9db0d801094b3809d9d77c6dbf469>

Flags: needinfo?(jmarshall)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1762078#c34)• 2 years ago |
|  | |

Attached file
[WIP: Bug 1762078 - Lint python file. Fix video file.](attachment.cgi?id=9301849) (obsolete)
— [Details](attachment.cgi?id=9301849&action=edit)

Depends on D159315

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1762078#c35)• 2 years ago |
|  | |

A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party. (Or: if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1762078#c36)• 2 years ago |
|  | |

(In reply to Release mgmt bot [:suhaib / :marco/ :calixte] from [comment #35](/show_bug.cgi?id=1762078#c35 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> A patch has been attached on this bug, which was already closed. Filing a separate bug will ensure better tracking. If this was not by mistake and further action is needed, please alert the appropriate party. (Or: if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message)

Should we exclude security bugs from this nag? It is a common and wanted pattern to fix it first and make/land a test later for security bugs.

Flags: needinfo?(smujahid)

|  | [Suhaib Mujahid [:suhaib]](/user_profile?user_id=702054) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1762078#c37)• 2 years ago |
|  | |

I checked the numbers and it seems that the tool commented on 5 security bugs since it was added (i.e., April 2022).

Previously, :dholbert suggested softening the comment language (which we did in [#1538](https://github.com/mozilla/relman-auto-nag/issues/1538)), but if you think this is not enough, we code go further and exclude cases where the patch is only touching test files (Marco's suggestion in [#1538](https://github.com/mozilla/relman-auto-nag/issues/1538#issuecomment-1183465035)). If this is still not enough, we could consider disabling these comments for security bugs.

:jstutte, please let me know what you think.

Flags: needinfo?(smujahid) → needinfo?(jstutte)

|  | [Joshua Marshall](/user_profile?user_id=706794)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1762078#c38)• 2 years ago |
|  | |

Attached file
[WIP: Bug 1762078 - Remove problematic file.](attachment.cgi?id=9302030) (obsolete)
— [Details](attachment.cgi?id=9302030&action=edit)

Depends on D159315

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18997352_600971)• 2 years ago |

[Attachment #9302030](/attachment.cgi?id=9302030&action=edit "WIP: Bug 1762078 - Remove problematic file.") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a18997374_600971)• 2 years ago |

[Attachment #9301849](/attachment.cgi?id=9301849&action=edit "WIP: Bug 1762078 - Lint python file.  Fix video file.") -
Attachment is obsolete: true

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1762078#c39)• 2 years ago |
|  | |

Ensure service workers don't intercept crossorigin media requests r=edenchuang

<https://hg.mozilla.org/integration/autoland/rev/510df507ca0e92605a0682e94e52f85e5e40f186>

<https://hg.mozilla.org/mozilla-central/rev/510df507ca0e>

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1762078#c40)• 2 years ago |
|  | |

Comment on [attachment 9298501](/attachment.cgi?id=9298501 "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") [[details]](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Ensure service workers don't intercept crossorigin media requests r=edenchuang!

Switching beta uplift request to release, 107 is now in RC.

Keeping on the radar for potential uplift later for a ride-along.

[Attachment #9298501](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") -
Flags: approval-mozilla-beta? → approval-mozilla-release?

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1762078#c41)• 2 years ago |
|  | |

(In reply to Suhaib Mujahid [:suhaib] from [comment #37](/show_bug.cgi?id=1762078#c37 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> I checked the numbers and it seems that the tool commented on 5 security bugs since it was added (i.e., April 2022).
>
> Previously, :dholbert suggested softening the comment language (which we did in [#1538](https://github.com/mozilla/relman-auto-nag/issues/1538)), but if you think this is not enough, we code go further and exclude cases where the patch is only touching test files (Marco's suggestion in [#1538](https://github.com/mozilla/relman-auto-nag/issues/1538#issuecomment-1183465035)). If this is still not enough, we could consider disabling these comments for security bugs.
>
> :jstutte, please let me know what you think.

Thanks for looking into this! I think, Marco's suggestion would be fine if we could extend it also to uplifts (sometimes we need to rebase and create a new attachment). The sequence of events on closing security bugs can be slightly confusing for a bot, though. So maybe having just a hint in the comment (at least if it is subject to sec-approval) that we can ignore the message in this and that case would be fine, too.

(clearing the old ni?s as a drive by)

Flags: needinfo?(smujahid)Flags: needinfo?(jstutte)Flags: needinfo?(jmarshall)Flags: needinfo?(bugmail)

|  | [Suhaib Mujahid [:suhaib]](/user_profile?user_id=702054) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1762078#c42)• 2 years ago |
|  | |

(In reply to Jens Stutte [:jstutte] from [comment #41](/show_bug.cgi?id=1762078#c41 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> So maybe having just a hint in the comment (at least if it is subject to sec-approval) that we can ignore the message in this and that case would be fine, too.

We have the following hint in the bot's comment:

> if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message

What would you suggest to improve the hint?

Flags: needinfo?(smujahid)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1762078#c43)• 2 years ago |
|  | |

(In reply to Suhaib Mujahid [:suhaib] from [comment #42](/show_bug.cgi?id=1762078#c42 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> We have the following hint in the bot's comment:
>
> > if the patch doesn't change behavior -- e.g. landing a test case, or fixing a typo -- then feel free to disregard this message
>
> What would you suggest to improve the hint?

I'd propose a slightly different message for bugs with sec-approval (maybe with a link to that process to make clear that this does not override it), just to show to the reader that we know about that case. A nag should help to re-enforce an existing process, without that specificity it might just feel "wrong" to nag at all to the reader and one must spend some extra cycles to understand "do I need to take action here or not?". But it is just a nuance, of course. Thanks

Flags: needinfo?(smujahid)

|  | [Suhaib Mujahid [:suhaib]](/user_profile?user_id=702054) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1762078#c44)• 2 years ago |
|  | |

(In reply to Jens Stutte [:jstutte] from [comment #43](/show_bug.cgi?id=1762078#c43 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> I'd propose a slightly different message for bugs with sec-approval (maybe with a link to that process to make clear that this does not override it), just to show to the reader that we know about that case.

I filed an issue to follow up on this: <https://github.com/mozilla/relman-auto-nag/issues/1748>

> A nag should help to re-enforce an existing process, without that specificity it might just feel "wrong" to nag at all to the reader and one must spend some extra cycles to understand "do I need to take action here or not?". But it is just a nuance, of course. Thanks

I totally agree with you.

Flags: needinfo?(smujahid)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a19500167_578488)• 2 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main107+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1762078#c45)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9302885)
— [Details](attachment.cgi?id=9302885&action=edit)

It would be great if you could double check this description.

Flags: needinfo?(karlt)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a19516912_578488)• 2 years ago |

Whiteboard: [post-critsmash-triage][adv-main107+] → [post-critsmash-triage][adv-main107+][adv-esr102.5+]

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1762078#c46)• 2 years ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #45](/show_bug.cgi?id=1762078#c45 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests"))

> It would be great if you could double check this description.

That's probably close enough. At least a lower bound on the size/length of cross-origin resources could sometimes be leaked, even without timing information. Whether timing information can make that information more precise hasn't been demonstrated.

Consider s/could/might/g.

Flags: needinfo?(karlt)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a19854487_578488)• 2 years ago |

Alias: CVE-2022-45403

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1762078#c47)• 2 years ago |
|  | |

Comment on [attachment 9298501](/attachment.cgi?id=9298501 "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") [[details]](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!")

[Bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") - Ensure service workers don't intercept crossorigin media requests r=edenchuang!

Approved for 107.0.1

[Attachment #9298501](/attachment.cgi?id=9298501&action=edit "Bug 1762078 - Ensure service workers don't intercept crossorigin media requests r=edenchuang!") -
Flags: approval-mozilla-release? → approval-mozilla-release+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1762078#c48)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-release/rev/b07dc4ddfbc7>

Flags: in-testsuite+

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a21604517_274246)• 2 years ago |

Regressions: [1803205](/show_bug.cgi?id=1803205 "RESOLVED WONTFIX - Service Worker fetch event no longer firing for audio")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1762078#a38044851_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1762078&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Eden Chuang[:edenchuang]](/user_profile?user_id=516138)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_4786c028_20250115_080704.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-49

## Security Vulnerabilities fixed in Thunderbird 102.5

Announced
November 15, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Thunderbird has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Thunderbird on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Thunderbird 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_18bdcdd2_20250115_080701.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-47

## Security Vulnerabilities fixed in Firefox 107

Announced
November 15, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 107

This advisory was updated December 13, 2022 to add CVE-2022-46882 and CVE-2022-46883. Both fixes were included in the original release of Firefox 107, but did not appear in the advisory published at that time.

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45407: Loading fonts on workers was not thread-safe](#CVE-2022-45407)

Reporter
Armin Ebert
Impact
high
##### Description

If an attacker loaded a font using `FontFace()` on a background worker, a use-after-free could have occurred, leading to a potentially exploitable crash.

##### References

* [Bug 1793314](https://bugzilla.mozilla.org/show_bug.cgi?id=1793314)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45413: SameSite=Strict cookies could have been sent cross-site via intent URLs](#CVE-2022-45413)

Reporter
Axel Chong
Impact
moderate
##### Description

Using the `S.browser_fallback_url parameter` parameter, an attacker could redirect a user to a URL and cause SameSite=Strict cookies to be sent.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1791201](https://bugzilla.mozilla.org/show_bug.cgi?id=1791201)

#### [#CVE-2022-40674: Use-after-free vulnerability in expat](#CVE-2022-40674)

Reporter
Rhodri James
Impact
moderate
##### Description

A flaw in XML parsing could have led to a use-after-free causing a potentially exploitable crash.
*In official releases of Firefox this vulnerability is mitigated by wasm sandboxing; versions managed by Linux distributions may have other settings.*

##### References

* [Bug 1791598](https://bugzilla.mozilla.org/show_bug.cgi?id=1791598)

#### [#CVE-2022-45415: Downloaded file may have been saved with malicious extension](#CVE-2022-45415)

Reporter
Jefferson Scher and Jayateertha Guruprasad
Impact
moderate
##### Description

When downloading an HTML file, if the title of the page was formatted as a filename with a malicious extension, Firefox may have saved the file with that extension, leading to possible system compromise if the downloaded file was later ran.

##### References

* [Bug 1793551](https://bugzilla.mozilla.org/show_bug.cgi?id=1793551)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45417: Service Workers in Private Browsing Mode may have been written to disk](#CVE-2022-45417)

Reporter
Kagami
Impact
moderate
##### Description

Service Workers did not detect Private Browsing Mode correctly in all cases, which could have led to Service Workers being written to disk for websites visited in Private Browsing Mode. This would not have persisted them in a state where they would run again, but it would have leaked Private Browsing Mode details to disk.

##### References

* [Bug 1794508](https://bugzilla.mozilla.org/show_bug.cgi?id=1794508)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-45419: Deleting a security exception did not take effect immediately](#CVE-2022-45419)

Reporter
Ronald Crane
Impact
low
##### Description

If the user added a security exception for an invalid TLS certificate, opened an ongoing TLS connection with a server that used that certificate, and then deleted the exception, Firefox would have kept the connection alive, making it seem like the certificate was still trusted.

##### References

* [Bug 1716082](https://bugzilla.mozilla.org/show_bug.cgi?id=1716082)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Using tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

#### [#CVE-2022-46883: Memory safety bugs fixed in Firefox 107](#CVE-2022-46883)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Yulia Startsev, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 106. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1584674%2C1791152%2C1792241%2C1792984%2C1793127%2C1794645)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_575173ab_20250115_080703.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-48

## Security Vulnerabilities fixed in Firefox ESR 102.5

Announced
November 15, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.5

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Use tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


