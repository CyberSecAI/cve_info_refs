=== Content from bugzilla.mozilla.org_a186c37f_20250114_215113.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1793551)
* [XML](/show_bug.cgi?ctype=xml&id=1793551)

Closed
[Bug 1793551](/show_bug.cgi?id=1793551)
(CVE-2022-45415)

Opened 2 years ago
Closed 2 years ago

# Create arbitrary binary(.hta,.exe,.bat,.vb)/file when web page is downloaded/saved in firefox browser

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Create arbitrary binary(.hta,.exe,.bat,.vb)/file when web page is downloaded/saved in firefox browser

## Categories

### (Firefox :: Downloads Panel, defect, P2)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Downloads%20Panel#Downloads%20Panel)

Downloads Panel
▾

Firefox :: Downloads Panel
For issues with the Downloads Panel, the new download manager of Firefox that lives in the navigation toolbar.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Downloads%20Panel&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Downloads%20Panel&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Downloads%20Panel)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

108 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | --- | [verified](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=verified) |
| firefox108 | --- | [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 107+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox106 |  | wontfix |
| firefox107 |  | verified |
| firefox108 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jayateertha043, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4a26e11b866aec2917f69a7a9b73a8fb?d=mm&size=40)  [jayateertha043](/user_profile?user_id=651342)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1793551&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1793551)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main107+][adv-esr102.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-45415

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main107+][adv-esr102.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1934569_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [index.html](/attachment.cgi?id=9297079)  [2 years ago](#c0)  [Jayateertha Guruprasad](/user_profile?user_id=651342)   1.02 KB, text/html |  | [Details](/attachment.cgi?id=9297079&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9302916)  [2 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   348 bytes, text/plain |  | [Details](/attachment.cgi?id=9302916&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1793551#c0)• 2 years ago |
|  | |

Attached file
[index.html](attachment.cgi?id=9297079)
— [Details](attachment.cgi?id=9297079&action=edit)

## Products affected:

Latest Firefox for Windows as on 04/10/22

### POC:

See this Video POC - <https://youtu.be/5PBJ1MlikFk>

1. Host malicious webpage (index.html) [See attached file].
2. Click save as to download the website to view offline or press (ctrl + s).
3. Save the file & open downloaded file

### Impact

1. Create arbitrary files instead of html file, which might result in code execution when opened.

### Fix

1. Sanitize filename properly & append .html to filename created from title tag by default as done by major browsers such as Google Chrome.
Flags: sec-bounty?

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1793551#c1)• 2 years ago |
|  | |

Hi team,

Hope this is eligible for bounty.

Incase eligible kindly nominate this for bounty, I am not sure of the bounty nomination process followed by firefox.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a27771_406194)• 2 years ago |

Component: Security → Untriaged

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1793551#c2)• 2 years ago |
|  | |

(In reply to Jayateertha Guruprasad from [comment #1](/show_bug.cgi?id=1793551#c1 "VERIFIED FIXED - Create arbitrary binary(.hta,.exe,.bat,.vb)/file when web page is downloaded/saved in firefox browser"))

> Incase eligible kindly nominate this for bounty, I am not sure of the bounty nomination process followed by firefox.

Setting the sec-bounty? flag like you did is sufficient for it to be considered.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a136040_1689)• 2 years ago |

Status: UNCONFIRMED → NEWComponent: Untriaged → Downloads PanelEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1793551#c3)• 2 years ago |
|  | |

This is basically a dupe of [bug 1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD"), but with security impact. :-(

Depends on: [1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a284354_159069)• 2 years ago |

Severity: -- → S2Priority: -- → P2

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1793551#c4)• 2 years ago |
|  | |

Hi team,

I don't think this is the exact same bug, I have not seen that before and have reported by my own research.

After going through bug (1778597)[[https://bugzilla.mozilla.org/show\_bug.cgi?id=1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD")] , I assume that bug is about ending the extensions with TLD (.com, .in etc), and no where talks about the security impact or the exploit I mentioned in my report, although the fix might be same. (Appending .html/.htm at the end).

CVE's can be assigned only for reports with security impact or affecting security triads (Confidentiality, Integrity, Availability).

So, I would like to know if my report is eligible for a CVE rather than (1778597)[[https://bugzilla.mozilla.org/show\_bug.cgi?id=1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD")] which also seems to be internally reported if I am not wrong.

Thanks and Regards

**Jayateertha G**

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1793551#c5)• 2 years ago |
|  | |

Also just a suggestion, Kindly make ([https://bugzilla.mozilla.org/show\_bug.cgi?id=1778597)[bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1778597)%5Bbug) 1778597] as private so that, as that report might give an idea of exploit to other researchers.

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1793551#c6)• 2 years ago |
|  | |

Hi team,

Any updates on this issue ?

Please feel free to contact me if you need any assistance reproducing the issue or anything else required from my side.

Thanks and Regards

Jayateertha G

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1793551#c7)• 2 years ago |
|  | |

(In reply to Jayateertha Guruprasad from [comment #4](/show_bug.cgi?id=1793551#c4 "VERIFIED FIXED - Create arbitrary binary(.hta,.exe,.bat,.vb)/file when web page is downloaded/saved in firefox browser"))

> I don't think this is the exact same bug,

It's the window/document title ending in `.foo` resulting in a `.foo` file extension when saving the page. I don't see any difference.

> no where talks about the security impact or the exploit I mentioned in my report,

If you were wanting to drop a file on the user's machine you could just start a download when clicking on the page, which is probably an easier thing to convince the user to do than to use "save page as" and then open the result, and also allows controlling the full contents of the result.

> CVE's can be assigned only for reports with security impact or affecting security triads (Confidentiality, Integrity, Availability).
>
> So, I would like to know if my report is eligible for a CVE rather than (1778597)[[https://bugzilla.mozilla.org/show\_bug.cgi?id=1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD")]

--> Tom ?

> which also seems to be internally reported

Not really, jscher is a volunteer contributor, not an employee.

(In reply to Jayateertha Guruprasad from [comment #6](/show_bug.cgi?id=1793551#c6 "VERIFIED FIXED - Create arbitrary binary(.hta,.exe,.bat,.vb)/file when web page is downloaded/saved in firefox browser"))

> Any updates on this issue ?

Please do not comment just to ask for updates. Any updates will be on the bug and unless you changed your bugzilla settings you'll get email for them. If there are no updates on the bug then there are no updates.

Flags: needinfo?(tom)

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1793551#c8)• 2 years ago |
|  | |

Thanks for the info, as I have not reported much in bugzilla, there were many flags which were confusing.

I didn't know, if I set the flags right or would recieve update.

Thanks and Regards

Jayateertha G

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1793551#c9)• 2 years ago |
|  | |

Presently the report is a sec-moderate, so yes, when it is fixed it will receive a CVE. If it is a duplicate, we typically include all of the reporters who have meaningfully contributed new information to the report, so in this case although [Bug 1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD") was filed first, you were the first (AFAICT) to detail the security impact of it, so you would both be credited. A decision about rewarding a bounty is similar.

Flags: needinfo?(tom)

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1793551#c10)• 2 years ago |
|  | |

Team,

Thanks very much for your valuable reply.

Will wait for the bug to be fixed.

Thanks and Regards

Jayateertha G

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1793551#c11)• 2 years ago |
|  | |

I believe this should have been fixed now by [bug 1778597](/show_bug.cgi?id=1778597 "VERIFIED FIXED - Save Page As suggests erroneous file extension if page title ends with a TLD").

Status: NEW → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1793551#c12)• 2 years ago |
|  | |

Hi team ,

I would like to retest the reported vulnerability, kindly share the retest build url.

Also as the reported vulnerability is said to be fixed, may I know about the CVE and bounty process.

Thanks very much for the quick fix and response.

Thanks and Regards

Jayateertha G

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a1441327_651342)• 2 years ago |

Flags: needinfo?(mak)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a1458344_75935)• 2 years ago |

Assignee: nobody → enndeakinGroup: firefox-core-security → core-security-release
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected)
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)Target Milestone: --- → 108 Branch

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1793551#c13)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hi team ,

Any updates on my previous comment ?

Thanks and Regards

Jayateertha G

Flags: needinfo?(tom)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1793551#c14)• 2 years ago |
|  | |

Updates will be posted to the bug when available

Flags: needinfo?(mak)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a1856727_578488)• 2 years ago |

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1793551#c15)• 2 years ago |
|  | |

Sorry, I don't think Marco noticed Neil's comment. You can test this on Firefox Nightly - <https://www.mozilla.org/en-US/firefox/channel/desktop/#nightly> The next time we meet to process bug bounties, this will be in the queue, it will typically take 1-2 weeks for a decision, as we meet weekly.

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1793551#c16)• 2 years ago |
|  | |

Thanks very much @Tom ,

will retest and let you know soon.

Also will wait for the CVE/Bounty decision.

Thanks and Regards

Jayateertha G

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a1934569_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a2368910_553429)• 2 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Jayateertha Guruprasad](/user_profile?user_id=651342)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1793551#c17)• 2 years ago |
|  | |

Hi team,

Sorry for late update, was in vacation last week.

I have retested in the latest nightly build for windows,

The issue seems to have been fixed! 🎊

Kindly let me know when the bounty process is initiated/CVE published.

Thanks and Regards

Jayateertha G

|  | [Virgil Sangerean](/user_profile?user_id=694333) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1793551#c18)• 2 years ago |
|  | |

Reproduced issue on 107.0b8 Firefox.

Issue is verified-fixed in 108.0a1 Nightly build: 2022-11-01-21-36-59-mozilla-central.

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a2542853_695136)• 2 years ago |

[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed)

|  | [Virgil Sangerean](/user_profile?user_id=694333) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1793551#c19)• 2 years ago |
|  | |

Verified fixed in Firefox 107.0b9.

Status: RESOLVED → VERIFIED
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a3229460_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main107+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1793551#c20)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9302916)
— [Details](attachment.cgi?id=9302916&action=edit)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a3332893_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a3582327_578488)• 2 years ago |

Alias: CVE-2022-45415

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a13737235_1689)• 2 years ago |

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [107+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=107%2B)Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main107+] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main107+][adv-esr102.5+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a21772656_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1793551#a52225606_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1793551&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jayateertha Guruprasad](/user_profile?user_id=651342)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_18bdcdd2_20250114_215115.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-47

## Security Vulnerabilities fixed in Firefox 107

Announced
November 15, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 107

This advisory was updated December 13, 2022 to add CVE-2022-46882 and CVE-2022-46883. Both fixes were included in the original release of Firefox 107, but did not appear in the advisory published at that time.

#### [#CVE-2022-45403: Service Workers might have learned size of cross-origin media files](#CVE-2022-45403)

Reporter
Anne van Kesteren and Karl Tomlinson
Impact
high
##### Description

Service Workers should not be able to infer information about opaque cross-origin responses; but timing information for cross-origin media combined with Range requests might have allowed them to determine the presence or length of a media file.

##### References

* [Bug 1762078](https://bugzilla.mozilla.org/show_bug.cgi?id=1762078)

#### [#CVE-2022-45404: Fullscreen notification bypass](#CVE-2022-45404)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popup and `window.print()` calls, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1790815](https://bugzilla.mozilla.org/show_bug.cgi?id=1790815)

#### [#CVE-2022-45405: Use-after-free in InputStream implementation](#CVE-2022-45405)

Reporter
Atte Kettunen
Impact
high
##### Description

Freeing arbitrary `nsIInputStream`'s on a different thread than creation could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1791314](https://bugzilla.mozilla.org/show_bug.cgi?id=1791314)

#### [#CVE-2022-45406: Use-after-free of a JavaScript Realm](#CVE-2022-45406)

Reporter
Samuel Groß
Impact
high
##### Description

If an out-of-memory condition occurred when creating a JavaScript global, a JavaScript realm may be deleted while references to it lived on in a BaseShape. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1791975](https://bugzilla.mozilla.org/show_bug.cgi?id=1791975)

#### [#CVE-2022-45407: Loading fonts on workers was not thread-safe](#CVE-2022-45407)

Reporter
Armin Ebert
Impact
high
##### Description

If an attacker loaded a font using `FontFace()` on a background worker, a use-after-free could have occurred, leading to a potentially exploitable crash.

##### References

* [Bug 1793314](https://bugzilla.mozilla.org/show_bug.cgi?id=1793314)

#### [#CVE-2022-45408: Fullscreen notification bypass via windowName](#CVE-2022-45408)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of popups that reuse windowName, an attacker can cause a window to go fullscreen without the user seeing the notification prompt, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1793829](https://bugzilla.mozilla.org/show_bug.cgi?id=1793829)

#### [#CVE-2022-45409: Use-after-free in Garbage Collection](#CVE-2022-45409)

Reporter
Gary Kwong
Impact
high
##### Description

The garbage collector could have been aborted in several states and zones and `GCRuntime::finishCollection` may not have been called, leading to a use-after-free and potentially exploitable crash

##### References

* [Bug 1796901](https://bugzilla.mozilla.org/show_bug.cgi?id=1796901)

#### [#CVE-2022-45410: ServiceWorker-intercepted requests bypassed SameSite cookie policy](#CVE-2022-45410)

Reporter
Dongsung Kim
Impact
moderate
##### Description

When a ServiceWorker intercepted a request with `FetchEvent`, the origin of the request was lost after the ServiceWorker took ownership of it. This had the effect of negating SameSite cookie protections. This was addressed in the spec and then in browsers.

##### References

* [Bug 1658869](https://bugzilla.mozilla.org/show_bug.cgi?id=1658869)

#### [#CVE-2022-45411: Cross-Site Tracing was possible via non-standard override headers](#CVE-2022-45411)

Reporter
scarlet
Impact
moderate
##### Description

Cross-Site Tracing occurs when a server will echo a request back via the Trace method, allowing an XSS attack to access to authorization headers and cookies inaccessible to JavaScript (such as cookies protected by HTTPOnly). To mitigate this attack, browsers placed limits on `fetch()` and XMLHttpRequest; however some webservers have implemented non-standard headers such as `X-Http-Method-Override` that override the HTTP method, and made this attack possible again. Firefox has applied the same mitigations to the use of this and similar headers.

##### References

* [Bug 1790311](https://bugzilla.mozilla.org/show_bug.cgi?id=1790311)

#### [#CVE-2022-45412: Symlinks may resolve to partially uninitialized buffers](#CVE-2022-45412)

Reporter
Armin Ebert
Impact
moderate
##### Description

When resolving a symlink such as `file:///proc/self/fd/1`, an error message may be produced where the symlink was resolved to a string containing unitialized memory in the buffer.
*This bug only affects Firefox on Unix-based operated systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1791029](https://bugzilla.mozilla.org/show_bug.cgi?id=1791029)

#### [#CVE-2022-45413: SameSite=Strict cookies could have been sent cross-site via intent URLs](#CVE-2022-45413)

Reporter
Axel Chong
Impact
moderate
##### Description

Using the `S.browser_fallback_url parameter` parameter, an attacker could redirect a user to a URL and cause SameSite=Strict cookies to be sent.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1791201](https://bugzilla.mozilla.org/show_bug.cgi?id=1791201)

#### [#CVE-2022-40674: Use-after-free vulnerability in expat](#CVE-2022-40674)

Reporter
Rhodri James
Impact
moderate
##### Description

A flaw in XML parsing could have led to a use-after-free causing a potentially exploitable crash.
*In official releases of Firefox this vulnerability is mitigated by wasm sandboxing; versions managed by Linux distributions may have other settings.*

##### References

* [Bug 1791598](https://bugzilla.mozilla.org/show_bug.cgi?id=1791598)

#### [#CVE-2022-45415: Downloaded file may have been saved with malicious extension](#CVE-2022-45415)

Reporter
Jefferson Scher and Jayateertha Guruprasad
Impact
moderate
##### Description

When downloading an HTML file, if the title of the page was formatted as a filename with a malicious extension, Firefox may have saved the file with that extension, leading to possible system compromise if the downloaded file was later ran.

##### References

* [Bug 1793551](https://bugzilla.mozilla.org/show_bug.cgi?id=1793551)

#### [#CVE-2022-45416: Keystroke Side-Channel Leakage](#CVE-2022-45416)

Reporter
Erik Kraft, Martin Schwarzl, and Andrew McCreight
Impact
moderate
##### Description

Keyboard events reference strings like "KeyA" that were at fixed, known, and widely-spread addresses. Cache-based timing attacks such as Prime+Probe could have possibly figured out which keys were being pressed.

##### References

* [Bug 1793676](https://bugzilla.mozilla.org/show_bug.cgi?id=1793676)

#### [#CVE-2022-45417: Service Workers in Private Browsing Mode may have been written to disk](#CVE-2022-45417)

Reporter
Kagami
Impact
moderate
##### Description

Service Workers did not detect Private Browsing Mode correctly in all cases, which could have led to Service Workers being written to disk for websites visited in Private Browsing Mode. This would not have persisted them in a state where they would run again, but it would have leaked Private Browsing Mode details to disk.

##### References

* [Bug 1794508](https://bugzilla.mozilla.org/show_bug.cgi?id=1794508)

#### [#CVE-2022-45418: Custom mouse cursor could have been drawn over browser UI](#CVE-2022-45418)

Reporter
Hafiizh
Impact
moderate
##### Description

If a custom mouse cursor is specified in CSS, under certain circumstances the cursor could have been drawn over the browser UI, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795815](https://bugzilla.mozilla.org/show_bug.cgi?id=1795815)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-45419: Deleting a security exception did not take effect immediately](#CVE-2022-45419)

Reporter
Ronald Crane
Impact
low
##### Description

If the user added a security exception for an invalid TLS certificate, opened an ongoing TLS connection with a server that used that certificate, and then deleted the exception, Firefox would have kept the connection alive, making it seem like the certificate was still trusted.

##### References

* [Bug 1716082](https://bugzilla.mozilla.org/show_bug.cgi?id=1716082)

#### [#CVE-2022-45420: Iframe contents could be rendered outside the iframe](#CVE-2022-45420)

Reporter
Suhwan Song of SNU CompSec Lab
Impact
low
##### Description

Using tables inside of an iframe, an attacker could have caused iframe contents to be rendered outside the boundaries of the iframe, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1792643](https://bugzilla.mozilla.org/show_bug.cgi?id=1792643)

#### [#CVE-2022-45421: Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](#CVE-2022-45421)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight and Gabriele Svelto reported memory safety bugs present in Firefox 106 and Firefox ESR 102.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107 and Firefox ESR 102.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1767920%2C1789808%2C1794061)

#### [#CVE-2022-46883: Memory safety bugs fixed in Firefox 107](#CVE-2022-46883)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Yulia Startsev, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 106. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 107](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1584674%2C1791152%2C1792241%2C1792984%2C1793127%2C1794645)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


