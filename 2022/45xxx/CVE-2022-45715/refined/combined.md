=== Content from hackmd.io_f26dd993_20250115_094836.html ===


# ip-com-5
vendor:IP-COM
product:M50
version:V15.11.0.33(10768)
type:Buffer Overflow
author:Yifeng Li, Wolin Zhuang;
## Vulnerability description
We found an buffer overflow vulnerability in IP-COM Technology IP-COM’s M50 routers with firmware which was released recently, allows control “pLanPortRange” or "pWanPortRange" to attack it.
## Buffer Overflow vulnerability
In formSetPortMapping function, the parameter “pLanPortRange” and "pWanPortRange" is directly strncpy to a local variable placed on the stack, which overrides the return address of the function, causing buffer overflow, and so on, we also can control the “pLanPortRange” or "pWanPortRange" to attack it.
![](https://i.imgur.com/unZLPXb.png)
![](https://i.imgur.com/lcZqhW0.png)
## PoC
### Buffer Overflow
We set the value of “pLanPortRange” or "pWanPortRange" as aaaaaaaaaaaaaaaaaaaaaaaaa…… and the router will cause buffer overflow.

×
### Sign in

Email

Password

[Forgot password](https://hackmd.io/settings/forgotPassword)

or

By clicking below, you agree to our [terms of service](https://hackmd.io/s/terms).

[Sign in via Facebook](https://hackmd.io/auth/facebook)
[Sign in via Twitter](https://hackmd.io/auth/twitter)
[Sign in via GitHub](https://hackmd.io/auth/github)
[Sign in via Dropbox](https://hackmd.io/auth/dropbox)
![](https://hackmd.io/images/wallet.svg)
Sign in with Wallet

Wallet
(

)
Connect another wallet

New to HackMD? [Sign up](https://hackmd.io/join)


