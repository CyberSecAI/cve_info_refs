Based on the provided content, here's the breakdown of CVE-2022-45045:

**Root cause of vulnerability:**

*   The vulnerability lies in the upgrade logic of a custom protocol used on port 34567 of Xiongmai devices. Specifically, the way the device processes commands received during the upgrade process.

**Weaknesses/vulnerabilities present:**

*   **Command Injection**: The device executes shell commands embedded within the "upgrade" command's JSON payload without proper sanitization.
*   **Authentication Bypass**: Although authentication is technically required to exploit this vulnerability, default credentials (admin:) or credentials leaked through other vulnerabilities such as CVE-2017-7577, make authentication easily bypassed by an attacker.
*   **Insecure Upgrade Process**: The upgrade process does not properly validate the upgrade files.
*   **Lack of input sanitization**: The `system()` function is called on data received from a remote authenticated user without sanitizing, leading to remote command execution.

**Impact of exploitation:**

*   **Remote Command Execution (RCE)**: Successful exploitation allows an attacker to execute arbitrary operating system commands on the vulnerable device. This can lead to full system compromise.
*   **Botnet Recruitment**:  Exploited devices are often recruited into botnets, being used for further attacks.
*   **Persistence**: Attackers can use the vulnerability to open telnetd on a specified port for a backdoor, and execute sleep commands to maintain control, while preventing other attackers from exploiting the device.

**Attack vectors:**

*   **Network**: The vulnerability is exploited over the network, via a custom protocol on port 34567.
*   **Remote**: The attacker can be remote and doesn't require any physical access to the device.

**Required attacker capabilities/position:**

*   **Network Access:** The attacker needs to have network access to the device's port 34567.
*   **Authentication Credentials:**  The attacker needs valid credentials to authenticate to the device on port 34567. This is made easier due to default credentials, or credential leaks via other vulnerabilities like CVE-2017-7577.
*   **Understanding of the custom protocol:** The attacker needs to be able to format their commands into the custom protocol expected by the service on port 34567.

**Additional Information**

*   The content details that this vulnerability has been actively exploited in the wild, including details of specific botnet campaigns and IPs used to carry out attacks.
*   The vulnerability existed from 2016 to at least 2022, with a partial mitigation introduced in 2020 that checks for the string "telnetd" in command, and requires the presence of file system files and a digital signature, although the signature is not properly enforced.
*  The article describes a honeypot capture of an attack exploiting this vulnerability.
*   The vulnerability is described to be used in conjunction with an information disclosure exploit(CVE-2017-7577) in order to extract credentials.
*   The content mentions Shodan and Censys data, highlighting the difficulty of mapping vulnerable devices due to port 34567 using a custom protocol.
*   The content provides details about the vendor, Xiongmai, and how they handle firmware updates and related files.