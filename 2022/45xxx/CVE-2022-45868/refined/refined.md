```json
[
  {
    "cve": "CVE-2022-45868",
    "source": "github.com_65616946_20250115_221824.html",
    "vulnerability": "The web-based admin console in H2 Database Engine through 2.1.214 can be started via the CLI with the argument -webAdminPassword, which allows the user to specify the password in cleartext for the web admin console. Consequently, a local user (or an attacker that has obtained local access through some means) would be able to discover the password by listing processes and their arguments.",
    "affected_versions": ">= 1.4.198, < 2.2.220",
    "patched_versions": "2.2.220",
    "references": [
      "https://nvd.nist.gov/vuln/detail/CVE-2022-45868",
      "https://github.com/h2database/h2database/blob/96832bf5a97cdc0adc1f2066ed61c54990d66ab5/h2/src/main/org/h2/server/web/WebServer.java#L346-L347",
      "https://sites.google.com/sonatype.com/vulnerabilities/sonatype-2022-6243",
      "https://github.com/h2database/h2database/pull/3833",
      "https://github.com/h2database/h2database/commit/581ed18ff9d6b3761d851620ed88a3994a351a0d",
      "https://github.com/h2database/h2database/issues/3686",
      "https://github.com/advisories/GHSA-22wj-vf5f-wrvj",
      "https://github.com/h2database/h2database/releases/tag/version-2.2.220"
    ],
     "cvss": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "weaknesses": [
      "CWE-200",
      "CWE-312"
    ],
        "attack_vector": "Local",
    "attack_complexity": "Low",
    "privileges_required": "Low",
    "user_interaction": "None",
    "scope": "Unchanged",
     "confidentiality": "High",
    "integrity": "High",
    "availability": "High",
    "epss_score":"0.042%"
  },
  {
    "cve": "CVE-2022-45868",
      "source": "github.com_addda0ab_20250115_091622.html",
      "vulnerability": "The `-webAdminPassword` argument allows specifying the web admin console password in cleartext via the CLI.  A local user or an attacker with local access can discover the password by listing processes and their arguments."
  },
  {
    "cve":"CVE-2022-45868",
    "source": "github.com_964bd3df_20250115_221836.html",
    "vulnerability":"Disallow plain webAdminPassword values to force usage of hashes"
  },
   {
    "cve":"CVE-2022-45868",
    "source": "github.com_c03c2992_20250115_091625.html",
    "vulnerability":"The webAdminPassword command line parameter allows to set the web admin password in clear text. It was decided that this is not an actual vulnerability, and should not be fixed. However, due to external pressure, the maintainers changed the behavior in version 2.2.220, requiring a salted hash instead of plaintext." ,
    "impact": "The maintainers are not willing to spend more time on this because this is not a vulnerability of the H2 database, and is due to improper usage. A local attacker can get the password from the command line arguments."
    ,
    "fix":"The maintainers addressed the issue by disallowing clear-text passwords. The `webAdminPassword` setting now only accepts salted hashes.",
   "attacker_position": "local"
  },
  {
      "cve":"CVE-2022-45868",
      "source": "github.com_70493245_20250115_091626.html",
      "vulnerability":"The `webAdminPassword` setting allowed both clear-text passwords and hashes of salted passwords from the beginning, but there were no documented methods for generation of such hashes. Clear-text passwords from all sources are not accepted any more, and the `main()` method rejects this parameter to make these strange people happy.",
        "fix":"A new public method was added and documented for creating password hashes. `runTool()` method still allows this parameter to be passed (now only with salted hash), but `main()` method rejects this parameter."
    },
    {
      "cve":"CVE-2022-45868",
      "source":"sites.google.com_219c2677_20250115_091628.html",
      "vulnerability":"H2 has a web-based admin console that can be started via the CLI. One of the arguments is -webAdminPassword, which allows the user to specify the password in plaintext for the web admin console. Consequently, a malicious local user or an attacker that has obtained local access through some means would be able to get the password for the H2 web admin console by looking at the running processes.",
       "affected_versions": "From 1.4.198 to the latest (from the time of this report, version 2.1.214 is also vulnerable)",
     "cvss": "8.4 CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "weaknesses": [
        "CWE-200"
      ],
        "attack_vector": "Local",
          "attack_complexity": "Low",
            "privileges_required": "None",
    "user_interaction": "None",
    "scope": "Unchanged",
     "confidentiality": "High",
    "integrity": "High",
    "availability": "High",
     "poc": "A docker container can be built with a plaintext password. Once the container is running, the password can be discovered using `docker exec --user guest h2poc ps -aux`.",
        "impact": "Any user on a system running H2 that has been started with the webAdminPassword argument can get the administrator password and escalate their privileges to perform any action on the system that the owner of the H2 process would be able to.",
    "maintainer_answer": "This is not a vulnerability of H2 Console, this is an example of how not to use it. Passwords should never be passed on the command line and every qualified DBA or system administrator is expected to know that.",
    "fix": "removing the -webAdminPassword as a valid CLI argument or reading the CLI arguments and after that set the values provided by the loadProperties() function."
  }
]
```