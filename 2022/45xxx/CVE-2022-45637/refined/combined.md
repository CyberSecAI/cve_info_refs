=== Content from github.com_1bba1729_20250115_085153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWithSecureLabs%2Fmegafeis-palm%2Ftree%2Fmain%2FCVE-2022-45637)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWithSecureLabs%2Fmegafeis-palm%2Ftree%2Fmain%2FCVE-2022-45637)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=WithSecureLabs%2Fmegafeis-palm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[WithSecureLabs](/WithSecureLabs)
/
**[megafeis-palm](/WithSecureLabs/megafeis-palm)**
Public

* [Notifications](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm)
* [Star
   1](/login?return_to=%2FWithSecureLabs%2Fmegafeis-palm)

* [Code](/WithSecureLabs/megafeis-palm)
* [Issues
  0](/WithSecureLabs/megafeis-palm/issues)
* [Pull requests
  0](/WithSecureLabs/megafeis-palm/pulls)
* [Actions](/WithSecureLabs/megafeis-palm/actions)
* [Projects
  0](/WithSecureLabs/megafeis-palm/projects)
* [Security](/WithSecureLabs/megafeis-palm/security)
* [Insights](/WithSecureLabs/megafeis-palm/pulse)

Additional navigation options

* [Code](/WithSecureLabs/megafeis-palm)
* [Issues](/WithSecureLabs/megafeis-palm/issues)
* [Pull requests](/WithSecureLabs/megafeis-palm/pulls)
* [Actions](/WithSecureLabs/megafeis-palm/actions)
* [Projects](/WithSecureLabs/megafeis-palm/projects)
* [Security](/WithSecureLabs/megafeis-palm/security)
* [Insights](/WithSecureLabs/megafeis-palm/pulse)

## Files

 main
## Breadcrumbs

1. [megafeis-palm](/WithSecureLabs/megafeis-palm/tree/main)
/
# CVE-2022-45637

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/WithSecureLabs/megafeis-palm/commits/main/CVE-2022-45637) main
## Breadcrumbs

1. [megafeis-palm](/WithSecureLabs/megafeis-palm/tree/main)
/
# CVE-2022-45637

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/WithSecureLabs/megafeis-palm/tree/main) | | |
| [CVE-2022-45637\_PoC.py](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/CVE-2022-45637_PoC.py "CVE-2022-45637_PoC.py") | | [CVE-2022-45637\_PoC.py](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/CVE-2022-45637_PoC.py "CVE-2022-45637_PoC.py") |  |  |
| [README.md](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/README.md "README.md") | | [README.md](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/README.md "README.md") |  |  |
| [requirements.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/requirements.txt "requirements.txt") | | [requirements.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/requirements.txt "requirements.txt") |  |  |
| [verification\_codes.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/verification_codes.txt "verification_codes.txt") | | [verification\_codes.txt](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45637/verification_codes.txt "verification_codes.txt") |  |  |
| View all files | | |

## [README.md](#readme)

# CVE-2022-45637: Insecure Password Reset Code Expiry Mechanism for Megafeis Smart Locks

## The Issue

During testing of the DBD+ application's functionality, I discovered that the app did not expire password reset codes after 60 seconds as it was indicating on the UI. I also noticed that there was no rate-limiting on password reset requests with incorrect verification codes. These two flaws in the password reset mechanism could allow attackers to initiate password resets on target accounts and bruteforce the verification code until a successful reset is achieved.

As discussed in [CVE-2022-45636](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45636), since the lock-management API handles all user account operations and verifies request authenticity with an easily forgeable signing key, an attacker with the ability to create signing keys could simply cycle through a list of possible verification codes and eventually change a legitimate user's password to an attacker-known value.

To demonstrate an attacker's ability to perform successful bruteforce attacks on other users resulting in account takeovers, I have developed a PoC which automates this process. The only piece of required information is the target user's email address or phone number, which can be trivially acquired by chaining the information disclosure vulnerability discussed in [CVE-2022-45634](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45634).

## Proof-of-Concept

### Pre-Requisites

* Installed DBD+ app (for exploitation of [CVE-2022-45634](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45634))
* Valid target DBD+ account username or phone number
* CVE-2022-45637\_PoC.py - `git clone https://github.com/WithSecureLabs/megafeis-palm.git`
* Script dependencies - `pip3 install -r requirements.txt`

### Usage

```
Usage: python3 CVE-2022-45637_PoC.py <p (phone number) or e (email address)> <victim_email/phone>

```

Phone Number Example: `python3 CVE-2022-45637_PoC.py p 28112345670`

Email Address Example: `python3 CVE-2022-45637_PoC.py e target@test.com`

### Demo

#### Step 1: Discover a MEGAFEIS Smart Lock's Administrator

To find the email address or phone number of a target lock's owner, we will use the information disclosure vulnerability discussed in [CVE-2022-45634](/WithSecureLabs/megafeis-palm/blob/main/CVE-2022-45634). Open the DBD+ app and tap the "Add" button. Once a lock advertising its model number is found, tap on it and the application should prompt you to ask for unlock access from the lock's administrator. Requesting access is unnecessary, but be sure to record the email address or phone number as it will be needed in the next step.

[![DBD+ App Discovery Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/dbd_app_discovery_screen.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/dbd_app_discovery_screen.png)[![DBD+ App Permission Request Screen](/WithSecureLabs/megafeis-palm/raw/main/screenshots/request_permission_screen.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/request_permission_screen.png)

#### Step 2: Perform Account Takeover

Once you have the target account's email address or phone number, download the PoC script and install the dependencies. Now execute the script with the correct arguments as shown below. Be sure to input a **4+ character password** when the script prompts you for it.

[![Account Takeover PoC Execution](/WithSecureLabs/megafeis-palm/raw/main/screenshots/poc2_execution.png)](/WithSecureLabs/megafeis-palm/blob/main/screenshots/poc2_execution.png)

Once the account takeover is complete, you should be able to log in to the target account with the password you specified during execution.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


