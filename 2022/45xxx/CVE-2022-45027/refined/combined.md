=== Content from zxsecurity.co.nz_afd817f4_20250114_232318.html ===


* [Skip to content](#main_content)
* [Skip to site menu](#footer_kitchen_sink)

Menu

# [ZX Security](/)

## How can we help you?

* [Cloud Security](/services/cloud-security/)
* [Cyber Strategy and Risk](/services/cyber-strategy-and-risk/)
* [Penetration Testing](/services/penetration-testing/)
* [Training](/services/training/)

## Browse the rest of our site

* [Research](/research/)
* [Events](/events/)
* [About](/about/)
* [Contact](/contact/)

---

You are hereâ¦

1. [Home](/)
2. [Research](../../)
3. [Advisories](../)
# perfSONAR â Multiple issues

Daniel Nemeth found a Server-Side Request Forgery vulnerability via the *host* header that could be used to scan the internal network.
Moreover, an arbitrary file read vulnerability was identified, which could allow an attacker to grep for any strings in a given file.

Authored by Dan Nemeth

Published on
31st January 2023

## Introduction

During a recent engagement, Daniel Nemeth found multiple security vulnerabilities in perfSONAR (up to v4.4.5), such as a Server-Side Request Forgery (SSRF) and a file read vulnerability, which could be used for user enumeration. This post outlines the technical details of these vulnerabilities.

## What is perfSONAR?

> perfSONAR is a network measurement toolkit designed to provide federated coverage of paths and help to establish end-to-end usage expectations. There are thousands of perfSONAR instances deployed worldwide, many of which are available for open testing of key measures of network performance.
> <https://www.perfsonar.net/gtk_whatis.html#perfsonar>

perfSONAR uses pScheduler to manage the execution of network measurement tasks. To create a new task, you need to contact the pScheduler server either through the command-line interface or the pScheduler API.

## Arbitrary File Read Vulnerability - CVE-2022-45213

### The http test type

[pScheduler supports several type of tests](https://docs.perfsonar.net/pscheduler_intro.html#term-Tool), including *http*, which could be used to measure HTTP response time.

By default, one could send the following JSON to the pScheduler API to create an *http* task:

```
{"schema":1,
  "test":{
    "type" : "http",
      "spec":{
          "url":"https://zxsecurity.co.nz",
      }
  },
  "schedule":{}
}

```

This task would query https://zxsecurity.co.nz and display all kinds of details about the connection, but not the actual HTTP response, sadly.

### Enumerating local users for fun

After some trials, it was discovered that the *url* parameter also accepted the *file:* scheme, and not just the standard *http://*.
Okay, so potentially we can instruct pScheduler to read files, that is good. But what can we do with it, if the response was not displayed?

As the documentation states, the *http* task accepts a *âparse* parameter, which should contain the âstring to parse forâ in the HTTP response.
This means that a local file could be queried and parsed itsâ content!

By modifying the JSON above, it was possible to query the content of a file on the server and parse for a string in it.
The following was the PoC can be used to query */etc/passwd* and see if it contains *root*:

```
{"schema":1,
  "test":{
    "type" : "http",
      "spec":{
         "url":"file:/etc/passwd",
         "parse":"root"
      }
  },
  "schedule":{}
}

```

After the test finished, the following results came back, showing that the string *root* was found in */etc/passwd*:

![Task result showing that root user existed on the target server ](/assets/img/advisories/perfsonar_http_fileread.png)

## Server-Side Request Forgery (SSRF) Vulnerability - CVE-2022-45027

### What is an SSRF?

A Server-Side Request Forgery vulnerability allows an attacker to force the back-end server to issue a request to an arbitrary server. Most of the time the arbitrary server would be something inside the internal network, which would be otherwise unreachable to the attacker.

### Discovery of the SSRF

It was found that by modifying the *Host* header when creating a task, the pScheduler server reached out to our ZX Burp Collaborator server:

```
POST /pscheduler/tasks HTTP/1.1
Host: b1dlb7ki5ikc6dqpga66d9r0lrrif96xv.burpoutloud.zxsecurity.co.nz
...

{"schema":1,
  "test":{
      "type" : "rtt",
      "spec":{"dest":"zxsecurity.co.nz","count":3}
  },
 "schedule": {}
}

```

The received response:

```
HTTP/1.1 500 INTERNAL SERVER ERROR
...
Internal problem; see system logs.

```

Checking our Burp Collaborator serverâs access log revealed that the server accessed it:
![ZX Burp Collaborator server access log](/assets/img/advisories/perfsonar_ssrf_zx_collab.png)

### Port-scanning the internal network for fun

After discovering the vulnerability, it was possible to port-scan the internal network of the pScheduler server based on the serverâs response.

When trying to connect to a closed port, the *connection refused* error message was returned:
![Closed port](/assets/img/advisories/perfsonar_ssrf1.png)

An opened port however returned a different error message, such as *gnutls\_handshake() failed: an unexpected TLS packet was received*.
![Opened port](/assets/img/advisories/perfsonar_ssrf2.png)

## Vulnerability Disclosure Timeline:

* 04/11/2022 - Vulnerability reported to perfSONAR. They confirmed that the vulnerabilities are being addressed in the next release, 4.4.6.
* 09/11/2022 - Version 4.4.6 Released.
* 09/12/2022 - CVE-2022-45213 and CVE-2022-45027 Reserved.
* 31/01/2023 - Blog published.

## Sidebar

### Insights

[View all insights](/research/insights/)

#### Green Team Tree Planting at Åwhiro Bay

26th June 2023

ZX Green Team gets muddy planting native trees.

[View insight: Green Team Tree Planting at Åwhiro Bay](/research/insights/green-team-june-planting-day/)

### Events

[View all events](/events/)

#### BSides San Francisco

4 May

to
5 May 2024

CityView at SF Metreon

BSidesSF is an Information / Security conference that's different. Presenters at BSides SF conferences are engaging the participants and getting the discussions started on the "Next Big Thing", not preaching at you from the podium about last month's news.

[View event: BSides San Francisco](/events/#event_2024-bsides-sf)

---

---

### Take the next step

Talk to us today

[Say hi!](/contact/)

## All pages

### [ZX Security â Full spectrum IT security services](/)

* [Services](/services/)
  + [Cloud Security](/services/cloud-security/)
  + [Cyber Strategy and Risk](/services/cyber-strategy-and-risk/)
  + [Penetration Testing](/services/penetration-testing/)
  + [Training](/services/training/)
* [Research](/research/)
  + [Advisories](/research/advisories/)
  + [Insights](/research/insights/)
  + [Maturity models](/research/maturity-models/)
  + [Tools](/research/tools/)
* [Community](/events/)
  + [Events](/events/)
  + [Hacking for Heroes](/about/social-responsibility/hacking-for-heroes/)
  + [Green Team](/about/social-responsibility/green-team/)
* [About](/about/)
  + [Our people](/about/people/)
  + [Careers](/about/careers/)
  + [Certifications](/about/#section_certifications)
  + [Social responsibility](/about/social-responsibility/)
* [Contact us](/contact/)
  + info@bastionsecurity.co.nz
  + [linkedin/bastion-security-group-ltd](https://www.linkedin.com/company/bastion-security-group-ltd)
  + [github/zxsecurity](https://github.com/zxsecurity)
  + Level 8, 10 Brandon Street, Wellington 6011, New Zealand

---

## Using this site

* [Privacy statement](/privacy/)
* [Vulnerability Disclosure Guidelines](/disclosure/)



=== Content from www.perfsonar.net_5b63bf8f_20250114_232318.html ===


Toggle navigation

[![perfSONAR Logo](./images/logos/perfsonar/perfsonar-logo-white-full.svg)](./index.html)

* Nav
* [News](news.html)
* [Releases](docs_releasenotes.html)
* [Documentation](https://docs.perfsonar.net)

* Get to Know perfSONAR
  + [perfSONAR Home](index.html "perfSONAR Home")
  + [What is it?](gtk_whatis.html "What is it?")
  + [Who Uses it?](gtk_whouses.html "Who Uses it?")
  + [How Does it Work?](gtk_how.html "How Does it Work?")
  + [Why Use it?](gtk_why.html "Why Use it?")
  + [Who Develops it?](gtk_whodevelops.html "Who Develops it?")
  + [Comparison with Other Systems](gtk_comparison.html "Comparison with Other Systems")
* Deployment
  + [Downloading](deployment_download.html "Downloading")
  + [Deployment Models](deployment_models.html "Deployment Models")
  + [Node Placement](deployment_placement.html "Node Placement")
  + [Local Deployment](deployment_local.html "Local Deployment")
  + [Security](deployment_security.html "Security")
* Documentation
  + [perfSONAR Documentation](https://docs.perfsonar.net "perfSONAR Documentation")
  + [FAQ](https://docs.perfsonar.net/FAQ "FAQ")
  + [Release Notes](docs_releasenotes.html "Release Notes")
* Resources
  + [Announcements Mailing List](https://lists.internet2.edu/sympa/info/perfsonar-announce "Announcements Mailing List")
  + [User Mailing List](https://lists.internet2.edu/sympa/info/perfsonar-user "User Mailing List")
  + [Lookup Service Dashboard](http://stats.perfsonar.net "Lookup Service Dashboard")
  + [YouTube](https://www.youtube.com/perfSONARProject "YouTube")
  + [GitHub](https://github.com/perfsonar "GitHub")
  + [Publications and Presentations](resources_publications.html "Publications and Presentations")
  + [Introduction to Network Metrics](resources_metrics.html "Introduction to Network Metrics")
  + [Using and Interpreting perfSONAR](resources_using.html "Using and Interpreting perfSONAR")
  + [ESnet FasterData](http://fasterdata.es.net/performance-testing/perfsonar "ESnet FasterData")
  + [Network Startup Resource Center](https://learn.nsrc.org/perfsonar "Network Startup Resource Center")
* About
  + [History](about_history.html "History")
  + [Latest News](news.html "Latest News")
  + [News Archive](news_archive.html "News Archive")
  + [Use Cases](use_cases.html "Use Cases")
  + [Licenses](about_license.html "Licenses")
  + [Logo and Usage](about_logo.html "Logo and Usage")
  + [Privacy Policy](about_privacy.html "Privacy Policy")
  + [Contact Us](about_contact.html "Contact Us")
* Development Collaboration
  + [About the Collaboration](collab_about.html "About the Collaboration")
  + [Framework](collab_framework.html "Framework")
  + [Mission Statement](collab_mission.html "Mission Statement")
  + [Requirements Gathering](collab_requirements.html "Requirements Gathering")
  + [Project Roadmap](collab_roadmap.html "Project Roadmap")

# perfSONAR 4.4.6 Release Notes

Released November 9, 2022

## Features/Highlighted Changes

### pScheduler Fixes

* Fixed issue where pScheduler server would look at HTTP request header when determining the local address during participant discovery. (Fixes CVE-2022-45027.)
* Removed the ability to use the “parse” option with `file://` URLs. (Fixes CVE-2022-45213.)

### Graphs Fixes

* The JavaScript frontend will now enforce the URL whitelist in graphs.json. This matches the current behavior of the backend CGI scripts.

## Raw changes

Updated components:

* [graphs](https://github.com/perfsonar/graphs/compare/v4.4.5...v4.4.6)
* [pscheduler](https://github.com/perfsonar/pscheduler/compare/v4.4.5...v4.4.6)

**Tags:**

---

perfSONAR is developed by a [partnership](collab_about.html) of these institutions:

[![ESNet Logo](images/logos/esnet.svg)](https://www.es.net)

[![GÉANT Logo](images/logos/geant.svg)](https://www.geant.net)

[![Indiana University Logo](images/logos/indiana.svg)](https://www.iu.edu)

[![Internet2 Logo](images/logos/internet2.svg)](https://www.internet2.edu)

[![RNP Logo](images/logos/rnp.png)](https://www.rnp.br/en)

[![University of Michigan Logo](images/logos/umich.svg)](https://www.umich.edu)

©2005-2024 The perfSONAR Project and contributors.
  ·
[License](about_license.html)
  ·
[Privacy](about_privacy.html)


