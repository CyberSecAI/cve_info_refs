=== Content from bugzilla.nasm.us_93779b2c_20250115_082836.html ===


Bugzilla – Bug 3392819
SEGV output/outaout.c:566 in aout\_add\_gotoff\_reloc
Last modified: 2023-04-24 10:05:25 PDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/en/html/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=3392819&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3392819&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

Self-registration is disabled due to spam issue (mail gorcunov@gmail.com or hpa@zytor.com to create an account)

[**Bug 3392819**](show_bug.cgi?id=3392819)
- SEGV output/outaout.c:566 in aout\_add\_gotoff\_reloc

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
SEGV output/outaout.c:566 in aout\_add\_gotoff\_reloc

| | [Status](page.cgi?id=fields.html#bug_status): | OPEN | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | NASM | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=NASM "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Assembler ([show other bugs](buglist.cgi?component=Assembler&product=NASM&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.16.xx | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | Medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | nobody | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-10-20 01:33 PDT by 13579and24680 | | --- | --- | | Modified: | 2023-04-24 10:05 PDT ([History](show_activity.cgi?id=3392819)) | | CC List: | 6 users (show)  13579and24680 Archana.Polampalli chang.seok.bae gorcunov hpa nasm-bugs | |  | | | [Obtained from:](page.cgi?id=fields.html#cf_build "Please indicate where you obtained and/or built your version of NASM.") | Built from git using configure | | [Generated by:](page.cgi?id=fields.html#cf_robot "Was this bug report generated by an automatic tool, such as a memory leak detector or fuzzer, *without* including a human validation description or analysis of the problem?") | --- | | [Bug category:](page.cgi?id=fields.html#cf_category "The general category of this bug oor request.") |  | | [Breaks existing code:](page.cgi?id=fields.html#cf_breaks "This bug report breaks existing code in production or under development.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**poc from fuzzer and afl-tmin**](attachment.cgi?id=411858 "View the content of the attachment") (71 bytes, text/plain)  [2022-10-20 01:33 PDT](#attach_411858 "Go to the comment associated with the attachment"), 13579and24680 | [Details](attachment.cgi?id=411858&action=edit) | | [Add an attachment](attachment.cgi?bugid=3392819&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3392819&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3392819#c0)  13579and24680    2022-10-20 01:33:37 PDT  ``` Created [attachment 411858](attachment.cgi?id=411858 "poc from fuzzer and afl-tmin") [[details]](attachment.cgi?id=411858&action=edit "poc from fuzzer and afl-tmin") poc from fuzzer and afl-tmin  Hello, I found a segfault when fuzz nasm ELF.  ------------------------------------------------------------------ normal execute  $ ./nasm -f aoutb poc poc:3: error: invalid combination of opcode and operands poc:6: warning: 64-bit unsigned relocation zero-extended from 32 bits [-w+zext-reloc] poc:6: error: `..gotoff' relocations require a non-global symbol in the section Segmentation fault  ------------------------------------------------------------------- compile with asan (report)  $ ./nasm -f aoutb poc poc:3: error: invalid combination of opcode and operands poc:6: warning: 64-bit unsigned relocation zero-extended from 32 bits [-w+zext-reloc] poc:6: error: `..gotoff' relocations require a non-global symbol in the section AddressSanitizer:DEADLYSIGNAL ================================================================= ==3053570==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000030 (pc 0x55a10486efa4 bp 0x7fff95281d40 sp 0x7fff95281d00 T0) ==3053570==The signal is caused by a READ memory access. ==3053570==Hint: address points to the zero page.     #0 0x55a10486efa3 in aout_add_gotoff_reloc output/outaout.c:566     #1 0x55a10486f4b0 in aout_out output/outaout.c:633     #2 0x55a1048bfbaf in nasm_do_legacy_output output/legacy.c:123     #3 0x55a10481a16c in out asm/assemble.c:459     #4 0x55a10481ae43 in out_imm asm/assemble.c:548     #5 0x55a104821fc9 in gencode asm/assemble.c:1955     #6 0x55a10481d147 in assemble asm/assemble.c:908     #7 0x55a104809ae5 in process_insn asm/nasm.c:1613     #8 0x55a10480a33c in assemble_file asm/nasm.c:1737     #9 0x55a10480586d in main asm/nasm.c:717     #10 0x7eff23a1a082 in __libc_start_main ../csu/libc-start.c:308     #11 0x55a104802ccd in _start (/home/a13579/nasm.asan+0x111ccd)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV output/outaout.c:566 in aout_add_gotoff_reloc ==3053570==ABORTING  ------------------------------------------------------------------- git log  $ git log --oneline -1 a8ff6bf7 (HEAD -> master, origin/master, origin/HEAD) Merge pull request #37 from hjl-tools/hjl/dwarf32 ```  [Comment 1](show_bug.cgi?id=3392819#c1)  13579and24680    2023-03-29 02:09:54 PDT  ``` Use CVE-2022-44369 ```  [Comment 2](show_bug.cgi?id=3392819#c2)  Polampalli, Archana    2023-04-24 09:12:11 PDT  ``` (In reply to 13579and24680 from [comment #1](show_bug.cgi?id=3392819#c1)) > Use CVE-2022-44369  Hi,  Colud you please confirm, is a8ff6bf7 (HEAD -> master, origin/master, origin/HEAD) Merge pull request #37 from hjl-tools/hjl/dwarf   fixes the CVE-2022-44369  Thanks in advance ```  [Comment 3](show_bug.cgi?id=3392819#c3)  13579and24680    2023-04-24 10:01:48 PDT  ``` I still can crash nasm with the poc after I checkout the commit.   # git log the commit ------------------------------------------- $ git checkout a8ff6bf7 $ git log --oneline -1 a8ff6bf7 (HEAD) Merge pull request #37 from hjl-tools/hjl/dwarf32  $ ./nasm -f aoutb poc poc:3: error: invalid combination of opcode and operands poc:6: warning: 64-bit unsigned relocation zero-extended from 32 bits [-w+zext-reloc] poc:6: error: `..gotoff' relocations require a non-global symbol in the section [1]    3620463 segmentation fault (core dumped)  ./nasm -f aoutb poc   # newest version ------------------------------------------------------------------------- $ git log --oneline -1 a916e412 (HEAD -> master, origin/master, origin/HEAD) Merge remote-tracking branch 'github/nasm-2.16.xx'  $ ./nasm -f aoutb poc            poc:3: error: invalid combination of opcode and operands poc:6: warning: 64-bit unsigned relocation zero-extended from 32 bits [-w+zext-reloc] poc:6: error: `..gotoff' relocations require a non-global symbol in the section [1]    3553577 segmentation fault (core dumped)  ./nasm -f aoutb poc ```  [Comment 4](show_bug.cgi?id=3392819#c4)  Polampalli, Archana    2023-04-24 10:05:25 PDT  ``` Thank You for quick response ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3392819)
* - [XML](show_bug.cgi?ctype=xml&id=3392819)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3392819)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=3392819&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3392819&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


