- **Root cause of vulnerability:** The vulnerability stems from improper input validation in the `ImageDisplayServlet`. While a check for directory traversal is present, URL decoding is performed after this check. This allows attackers to bypass the check by URL-encoding path components.

- **Weaknesses/vulnerabilities present:**
    - CWE-23: Relative Path Traversal: The application fails to properly sanitize user-provided input, allowing attackers to access files outside the intended directory.
    - Improper input validation: The application validates the path before decoding, allowing for bypass using encoded path components.

- **Impact of exploitation:**
    - Attackers can retrieve arbitrary local files from the server.
    - The provided PoC demonstrates retrieval of the database configuration file, potentially revealing sensitive information such as database credentials.

- **Attack vectors:**
    - The vulnerability can be exploited by directly accessing the backend Tomcat server.
    - Attackers can send a crafted HTTP request to `ImageDisplayServlet` with URL-encoded path components to bypass the directory traversal check.

- **Required attacker capabilities/position:**
    - The attacker needs to be able to reach the Tomcat listener over the network.
    - The attacker needs knowledge of the file system structure to specify the path to the files they want to retrieve.