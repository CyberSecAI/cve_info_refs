=== Content from www.videolan.org_bbf27e14_20250114_183911.html ===

[![VideoLAN association](//images.videolan.org/images/logoRed.png)](//www.videolan.org/)
Toggle navigation

* [VideoLAN](//www.videolan.org/videolan/)
  + [Team & Organization](//www.videolan.org/videolan/)
  + [Consulting Services & Partners](//www.videolan.org/videolan/partners.html)
  + [Events](//www.videolan.org/videolan/events/)
  + [Legal](//www.videolan.org/legal.html)
  + [Press center](//www.videolan.org/press/)
  + [Contact us](//www.videolan.org/contact.html)
* [VLC](//www.videolan.org/vlc/)
  + [Download](//www.videolan.org/vlc/)
  + [Features](//www.videolan.org/vlc/features.html)
  + [Customize](//www.videolan.org/vlc/skins.html)
  + [Get Goodies](//www.videolan.org/goodies.html)
* [Projects](//www.videolan.org/projects/)
  + [DVBlast](//www.videolan.org/projects/dvblast.html)
  + [x264](//www.videolan.org/developers/x264.html)
  + [x262](//www.videolan.org/developers/x262.html)
  + [x265](//www.videolan.org/developers/x265.html)
  + [multicat](//www.videolan.org/projects/multicat.html)
  + [dav1d](//www.videolan.org/projects/dav1d.html)
  + [VLC Skin Editor](//www.videolan.org/vlc/skineditor.html)
  + [VLC media player](//www.videolan.org/vlc/)
  + [libVLC](//www.videolan.org/vlc/libvlc.html)
  + [libdvdcss](//www.videolan.org/developers/libdvdcss.html)
  + [libdvdnav](//www.videolan.org/developers/libdvdnav.html)
  + [libdvdread](//www.videolan.org/developers/libdvdnav.html)
  + [libbluray](//www.videolan.org/developers/libbluray.html)
  + [libdvbpsi](//www.videolan.org/developers/libdvbpsi.html)
  + [libaacs](//www.videolan.org/developers/libaacs.html)
  + [libdvbcsa](//www.videolan.org/developers/libdvbcsa.html)
  + [biTStream](//www.videolan.org/developers/bitstream.html)
  + [vlc-unity](//www.videolan.org/developers/unity.html)
  + [All Projects](//www.videolan.org/projects/)
* [Contribute](//www.videolan.org/contribute.html)
  + [Getting started](//www.videolan.org/contribute.html)
  + [Donate](//www.videolan.org/contribute.html#money)
  + [Report a bug](//www.videolan.org/support/#bugs)
* [Support](//www.videolan.org/support/)

* donate
* donate
* [Donate](//www.videolan.org/contribute.html#money)
  + donate
  + donate

VideoLAN, a project and a [non-profit organization.](//www.videolan.org/videolan/)

# Security Bulletin VLC 3.0.18

```

Summary           : Multiple vulnerabilities fixed in VLC media player
Date              : November 2022
Affected versions : VLC media player 3.0.17 and earlier
ID                : VideoLAN-SB-VLC-3018

```
## Details

A denial of service could be triggered with a wrong mp4 file (div by 0) (#27202)

Fix crashes with multiple files due to double free (#26930)

A denial of service could be triggered with wrong oog file (null pointer dereference) (#27294)

Potential buffer overflow in the vnc module could trigger remote code execution if a malicious vnc URL is deliberately played (#27335, CVE-2022-41325)

## Impact

If successful, a malicious third party could trigger either a crash of VLC or an arbitratry code execution with the privileges of the target user.

While these issues in themselves are most likely to just crash the player, we can't exclude that they could be combined to leak user informations or
remotely execute code. ASLR and DEP help reduce the likelyness of code execution, but may be bypassed.

We have not seen exploits performing code execution through these vulnerability

## Threat mitigation

Exploitation of those issues requires the user to explicitly open a specially crafted file or stream.

## Workarounds

The user should refrain from opening files from untrusted third parties
or accessing untrusted remote sites (or disable the VLC browser plugins),
until the patch is applied.

## Solution

VLC media player **3.0.18** addresses the issue.

## Credits

The vnc module vulnerability was reported and fixed by 0xMitsurugi from Synacktiv (#27335, CVE-2022-41325)

## References

The VideoLAN project
[http://www.videolan.org/](//www.videolan.org/)

VLC official GIT repository
[http://git.videolan.org/?p=vlc.git](http://git.videolan.org/?p=vlc/vlc-3.0.git)

[![Association VideoLAN](//images.videolan.org/images/logoGrey.png)](//www.videolan.org/)

VLC media player

* [VLC](//www.videolan.org/vlc/)
* [VLC for Windows](//www.videolan.org/vlc/download-windows.html)
* [VLC for Mac OS X](//www.videolan.org/vlc/download-macosx.html)
* [VLC for Ubuntu](//www.videolan.org/vlc/download-ubuntu.html)
* [VLC for Android](//www.videolan.org/vlc/download-android.html)
* [VLC for iOS](//www.videolan.org/vlc/download-ios.html)
* [Skins](//www.videolan.org/vlc/skins.html)
* [Extensions](https://addons.videolan.org/browse/cat/323/ord/latest/)
* [Features](//www.videolan.org/vlc/features.html)
* [Screenshots](//www.videolan.org/vlc/screenshots.html)
* [VLC Skin Editor](//www.videolan.org/vlc/skineditor.html)

All Projects

* [VideoLan Movie Creator](//www.videolan.org/vlmc/)
* [DVBlast](//www.videolan.org/projects/dvblast.html)
* [x264](//www.videolan.org/developers/x264.html)
* [x262](//www.videolan.org/developers/x262.html)
* [x265](//www.videolan.org/developers/x265.html)
* [multicat](//www.videolan.org/projects/multicat.html)
* [dav1d](//www.videolan.org/projects/dav1d.html)
* [VLMa](//www.videolan.org/projects/vlma/)
* [libVLC](//www.videolan.org/vlc/libvlc.html)
* [libdvdcss](//www.videolan.org/developers/libdvdcss.html)
* [libdvdnav](//www.videolan.org/developers/libdvdnav.html)
* [libdvdread](//www.videolan.org/developers/libdvdnav.html)
* [libbluray](//www.videolan.org/developers/libbluray.html)
* [libdvbpsi](//www.videolan.org/developers/libdvbpsi.html)
* [libaacs](//www.videolan.org/developers/libaacs.html)
* [libdvbcsa](//www.videolan.org/developers/libdvbcsa.html)
* [biTStream](//www.videolan.org/developers/bitstream.html)
* [vlc-unity](//www.videolan.org/developers/unity.html)

Community

* [Wiki](https://wiki.videolan.org/)
* [Forums](https://forum.videolan.org/)
* [Mailing-Lists](//www.videolan.org/support/lists.php)
* [FAQ](//www.videolan.org/support/faq.html)
* [Donate money](//www.videolan.org/contribute.html#money)
* [Donate time](//www.videolan.org/contribute.html)
* [Get Goodies](//www.videolan.org/goodies.html)

VideoLAN

* [Project and Organization](//www.videolan.org/videolan/)
* [Team](//www.videolan.org/videolan/team/)
* [Legal](//www.videolan.org/legal.html)
* [Contact us](//www.videolan.org/contact.html)
* [Partners](//www.videolan.org/videolan/partners.html)
* [Mirrors](//www.videolan.org/videolan/mirrors.html)
* [Press center](//www.videolan.org/press/)
* [Events](//www.videolan.org/videolan/events/)
* [Security center](//www.videolan.org/security/)
* [Get Involved](//www.videolan.org/contribute.html)
* [News](//www.videolan.org/news.html)

[Legal](/legal.html)
| [Report Trademark Abuse](/contact.html)

VideoLAN, VLC, VLC media player and x264 are trademarks internationally registered by the [VideoLAN non-profit organization.](/videolan/)

VideoLAN software is licensed under various open-source licenses: use and distribution are defined by each software license.

Design by [Made By Argon](https://www.madebyargon.com). Some icons are licensed under the [CC BY-SA 3.0+](https://creativecommons.org/licenses/by-sa/3.0/us/).

The VLC cone icon was designed by Richard ÃƒÂ˜iestad. Icons for VLMC, DVBlast and x264 designed by [Roman Khramov](http://cuberto.com/).



=== Content from www.debian.org_b0a575f3_20250114_183908.html ===


---

[[Date Prev](msg00267.html)][[Date Next](msg00269.html)]
[[Thread Prev](msg00267.html)][[Thread Next](msg00269.html)]
[[Date Index](maillist.html#00268)]
[[Thread Index](threads.html#00268)]

# [SECURITY] [DSA 5297-1] vlc security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5297-1] vlc security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 6 Dec 2022 21:12:41 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/Y4%2BwSfc3ysoYu6kh%40seger.debian.org)Â [Y4+wSfc3ysoYu6kh@seger.debian.org](msg00268.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5297-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 06, 2022                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : vlc
CVE ID         : CVE-2022-41325

A buffer overflow was discovered in the VNC module of the VLC media
player, which could result in the execution of arbitrary code.

For the stable distribution (bullseye), this problem has been fixed in
version 3.0.18-0+deb11u1.

We recommend that you upgrade your vlc packages.

For the detailed security status of vlc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/vlc>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmOPsBAACgkQEMKTtsN8
TjZ6NhAAgYn57L8YdkWKMZc+/yNZ7kFLJZZaKTDDkvyDgtiWofEQ2vm4/093IDfN
hKkccozzfQL/YyeOybqaKo2GcKYt7vyfji7MtXZH/+YXlpH0t/xzf98pBkY/aV/U
w0oBo7ZtTfIiVsb62Ao0w/i87kV4Kwm79UNt6jaIqAfYuhGtgjkH1mr/ME8ez5Ab
UUiRydXr+8WktqSHd7qWH4E56ZAqnDlPAPDDuUtj1t5l7iNsxKfMO3eC7xGrE1St
Sdlr+MQrEcupaoQHgLyPRgZBEJrNu3MvfvevpuAH32md/oCvHf8U5uekmMu+/icE
dZYQ8+DJgI8gyldeiOTveu7n2uXbhLHSlc8OE+Y5QANqboHG1vsb9cEPuUGmITCF
t7rUQIF6c6h75/qmZVMXgK7dv0Kfmni/uHOpTeO66X0jgDatvEIfTeZPT3w+VwT0
tnk/GR/DKARROLxG6qvDbJ60waMIa0gD+tuFkX7oGjo1144qMT6mijQdZosYc+uy
R6EhLGVo2D5xnAzGMeX5supA4UX0L7CJzBfZbKvE+jD0GPvevT1NzKmNvnhKSKBF
g5hIcKNX7OT/KQFYw28Zen182ac0XODoYFnVt6VyXfSrAsem4VGeoAIG5xQYcjKU
BKyR5+GMGvdOcSOUsu1ozD/bq8BjJzLDASiZICGTZSVnrMf4wK4=
=WOoU
-----END PGP SIGNATURE-----

```

---



=== Content from twitter.com_0df6fc38_20250114_183903.html ===



=== Content from www.synacktiv.com_3351414e_20250114_183909.html ===
VLC : Integer overflow in vnc module
<= 3.0.18 CVE-2022-41325

Security advisory
2022-11-30

0xMitsurugi

www.synacktiv.com

5 Boulevard Montmartre 75002 Paris

Vulnerability description

Presentation of VLC

VLC   media   player   (previously   the   VideoLAN   Client   and   commonly   known   as   simply   VLC)   is   a   free   and   open-source,
portable, cross-platform media player software and streaming media server developed by the VideoLAN project.

VLC can display a vnc video stream by using its URI:

vlc vnc://ip_address_of_server:port/

The issue

The vulnerability resides in VNC module.

If an attacker has control over a VNC server, it can trick VLC into allocating a memory buffer shorter than expected. The
attacker then have a powerful relative "write-what-where"  primitive.  He  can crash VLC, or  execute arbitrary code under
conditions.

NOTE: Although vnc support is made through a third-party library (libvncClient), the affected code is in VLC.

Affected versions

Version 3.0.17.4 and earlier are affected.

CVE

CVE-2022-41325 assigned by MITRE,
CVSS: 7.8

Timeline

Date

2022-09-19

2022-09-19

2022-09-23

Action

Ticket opened in VLC tracker

Developers proposed a patch fixing the vulnerability

CVE-2022-41325 assigned by MITRE

2022-11-30

Publication of 3.0.18

 2/5

Technical description and POC

Availability of the bug

The ./configure script tries to compile support for VNC by default:

$ ./configure --help | grep vnc
  --enable-vnc            (VNC/rfb client support) [default=auto]
$

you can check support of vnc in VLC by typing:

$ vlc --list | grep vnc
VLC media player 3.0.17.4 Vetinari (revision 3.0.13-8-g41878ff4f2)
  vnc                    AccÃ¨s client VNC
$

The bug

The bug resides in the function mallocFrameBufferHandler in modules/access/vnc.c:

static rfbBool mallocFrameBufferHandler( rfbClient* p_client ) {
    (...)
    /* Set up framebuffer */
    p_sys->i_framebuffersize = i_width * i_height * i_depth / 8;     [1]

    /* Reuse unsent block */
    if ( p_sys->p_block )
        p_sys->p_block = block_Realloc( p_sys->p_block, 0, p_sys->i_framebuffersize );
    else
        p_sys->p_block = block_Alloc( p_sys->i_framebuffersize );    [2]
    (...)

Variables are typed:

â€¢

â€¢

â€¢

â€¢

p_sys->i_framebuffer is an int

i_width is an int. VNC protocol force it by design to be an uint16

i_height is an int. VNC protocol force it by design to be an uint16

i_depth can value 32 at max

The calculation in [1] "i_width * i_height * i_depth / 8" can overflow the int size of p_sys->i_framebuffersize, and result value
can be truncated.

Proof of concept

i_width, i_height and i_depth are given by the VNC server, and are used without any verification. If we create a vnc screen
sized as:

â€¢

 width: 0x4004

 3/5

â€¢

â€¢

 height: 0xfff1

 depth: 32 bpp

we have:

0x4004*0xfff1*32/8 = 0x10000ff10 which will be truncated to 0xff10

The block_alloc() will alloc a 0xff10 bytes buffer which is smaller than expected to store data sent by the VNC server.

NOTE: the block_alloc function checks that the size to allocate is smaller than 2^27. This is why we choose those specific
values for height and width. Any other values can work, as long as the int truncation produces a number smaller than 2^27.

The VNC server can update portions of the screen, from the entire buffer to a small rectangle, or even each pixel by sending
packets to VLC. It's trivial to write any byte outside the buffer allocated in memory of VLC, ranging from start of buffer
allocated to buffer + 2^32 bytes.

For example, by sending an RFB pixel coded on 4 bytes such as 0x41414141 at coordinates X=0x4000, Y=0x3, a write will
be performed in memory past the end of the buffer:

0x4000*3*4 = 0x30000

which is after the boundary of the 0xff10 buffer allocated. This can result in unexpected behavior.

In theory, command execution is possible by rewriting chosen section of data, However, with a stack randomized, a heap
randomized and a binary compiled with PIE exploitation is very unlikely.

 4/5

Patch

VLC team fixed the vulnerability with the commit:

 https://code.videolan.org/videolan/vlc/-/commit/4fcace61801f418786c42487c6b06b693ee87666

The patch adds a check to verify that the buffer has not overflowed:

static rfbBool mallocFrameBufferHandler( rfbClient* p_client )
(...)
    assert(!(p_client->width & ~0xffff)); // fits in 16 bits
    uint16_t i_width = p_client->width;
    assert(!(p_client->height & ~0xffff)); // fits in 16 bits
    uint16_t i_height = p_client->height;
    uint8_t i_bits_per_pixel = p_client->format.bitsPerPixel;
    assert((i_bits_per_pixel & 0x7) == 0); // multiple of 8
(...)
    /* Set up framebuffer */
    if (mul_overflow(i_width, i_height * (i_bits_per_pixel / 8), &p_sys-
>i_framebuffersize)) {
        msg_Err(p_demux, "VNC framebuffersize overflow");
        return FALSE;
    }
(...)

the mul_overflow() function explicitly checks that the multiplication wonâ€™t overflow.

 5/5


