```
{
  "vulnerability": {
    "root_cause": "An integer overflow vulnerability exists in the `pretty.c::format_and_pad_commit()` function when processing padding operators within `git log --format` and `git archive` via `export-subst`. A `size_t` is improperly stored as an `int`, leading to an offset calculation error during a `memcpy()` call.",
    "weaknesses": [
      "CWE-122: Heap-based Buffer Overflow"
    ],
    "impact": "The integer overflow leads to arbitrary heap writes, potentially resulting in remote code execution.",
    "attack_vectors": [
      "Directly by a user running `git log --format=...`.",
      "Indirectly through `git archive` via `export-subst` mechanism in a crafted repository."
    ],
    "required_attacker_capabilities": "Ability to craft git commands or a malicious repository with specially crafted `.gitattributes` files, triggering the integer overflow in the padding logic of the commit formatting engine.",
    "details": "The vulnerability is triggered during the processing of padding operators (e.g., `%<(`, `%<|(`, `%>(`, `%>>(`, or `%><(`) in the `pretty.c::format_and_pad_commit()` function. A `size_t` value is incorrectly handled as an `int`. When this integer is used to calculate an offset for a `memcpy()` operation, it can result in an out-of-bounds write to the heap. The vulnerability can be triggered via `git log --format` command or `git archive` with `export-subst` attribute in .gitattributes."
  },
  "affected_versions": "Versions <= v2.30.6, v2.31.5, v2.32.4, v2.33.5, v2.34.5, v2.35.5, v2.36.3, v2.37.4, v2.38.2, v2.39.0 are vulnerable.",
    "patched_versions": "Versions >= v2.30.7, v2.31.6, v2.32.5, v2.33.6, v2.34.6, v2.35.6, v2.36.4, v2.37.5, v2.38.3, v2.39.1 are patched."
}
```