- **Root cause of vulnerability:** A heap-based buffer overflow occurs in the `DELETE_FILE` command handler of the `m2m` binary due to insufficient size checking when composing a command string. The allocated buffer size is based on a provided length, while the actual string copied into it can be larger.
- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow (CWE-122). The size of the allocated memory for the command string is calculated using the provided `data_len` value, but the actual data written into this buffer could be larger causing a heap overflow due to the `sprintf` function writing past the allocated boundary.
- **Impact of exploitation:** An attacker can cause a denial of service or potentially achieve arbitrary code execution by overflowing the heap buffer.
- **Attack vectors:** A specially crafted UDP network request sent to the `m2m` service. The crafted request exploits the `DELETE_FILE` command with a `data_len` value smaller than the actual data present in the M2M packet data entry.
- **Required attacker capabilities/position:** An attacker needs to be able to send a network request to the vulnerable device on the port used by the `m2m` service. No authentication is required to exploit this vulnerability.