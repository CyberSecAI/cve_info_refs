```
{
  "vulnerability": {
    "root_cause": "The `func` CLI tool trusts builder images based on a prefix match of the image name. This allows an attacker to create a malicious builder image that shares a prefix with a trusted registry, thus tricking func into using it.",
    "weaknesses": [
      "Insufficient validation of builder image names.",
       "Trusting builder images based on prefix matching instead of exact or validated references."
    ],
    "impact": "A malicious or compromised third-party buildpack can expose registry credentials or the local docker socket to a malicious `lifecycle` container. This could lead to unauthorized access to container registries, or local privilege escalation by running containers through the local docker daemon.",
    "attack_vectors": [
      "Publish a malicious builder image using a prefix from the list of trusted image prefixes.",
      "A victim then uses a function template (that references the malicious builder) to create a new function project.",
       "The attacker updates the builder tag to point to a builder image which references a malicious lifecycle image.",
       "When the victim next performs a `func build` operation, the attacker's `lifecycle` image will be run with either mounted registry credentials for the destination, cache, and run image repositories or access to the local docker daemon."
    ],
     "required_attacker_capabilities": "The attacker needs to be able to publish a container image to a registry, and create a function builder that shares a prefix with the trusted builder prefixes."
  }
}
```