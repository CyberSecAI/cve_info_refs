```
{
  "CVE-2022-41973": {
    "description": "The symlink attack (CVE-2022-41973) was introduced in May 2018 (version 0.7.7) by commit 65d0a63 (\"functions to indicate mapping failure in /dev/shm\"); the vulnerable code was hardened significantly in May 2020 (version 0.8.5) by commit 40ee3ea (\"simplify failed wwid code\"), but it remains exploitable nonetheless.",
    "root_cause": "The `multipathd` daemon operates insecurely within `/dev/shm`, a world-writable directory, due to the use of `linkat` and `unlinkat` in the `mark_failed_wwid()` function. This allows a local attacker to create arbitrary directories or files by exploiting symlink attacks.",
    "weaknesses": [
      "The daemon uses insecure operations within a world-writable directory, specifically by creating files and directories under `/dev/shm/multipath`.",
      "Incorrect symlink handling during the creation of failed_wwids directory and wwid files.",
      "The vulnerability is present because intermediate components of a path are not protected when following symlinks.",
         "The vulnerability was introduced by commit 65d0a63 in May 2018."

    ],
    "impact": "A local attacker can leverage this vulnerability to create arbitrary directories or files with root privileges in any location of the filesystem. This can lead to a local privilege escalation, potentially allowing a complete system takeover by combining it with other vulnerabilities.",
    "attack_vectors": [
       "Local access is required.",
       "An attacker can create a symlink at `/dev/shm/multipath` pointing to a location of their choice.",
       "An attacker can exploit the authorization bypass vulnerability (CVE-2022-41974) to trigger the vulnerable code."

    ],
    "attacker_capabilities": "A local user with the ability to create symlinks and execute commands with multipathd's client functionality can trigger the vulnerability. Requires being able to send privileged commands to `multipathd` via the authorization bypass vulnerability."
  }
}
```