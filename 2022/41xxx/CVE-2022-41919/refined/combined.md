=== Content from github.com_44433856_20250115_091022.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fsecurity%2Fadvisories%2FGHSA-3fjj-p79j-c9hh)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fsecurity%2Fadvisories%2FGHSA-3fjj-p79j-c9hh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=fastify%2Ffastify)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fastify](/fastify)
/
**[fastify](/fastify/fastify)**
Public

* [Notifications](/login?return_to=%2Ffastify%2Ffastify) You must be signed in to change notification settings
* [Fork
  2.3k](/login?return_to=%2Ffastify%2Ffastify)
* [Star
   32.8k](/login?return_to=%2Ffastify%2Ffastify)

* [Code](/fastify/fastify)
* [Issues
  64](/fastify/fastify/issues)
* [Pull requests
  31](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects
  0](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

Additional navigation options

* [Code](/fastify/fastify)
* [Issues](/fastify/fastify/issues)
* [Pull requests](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

# Incorrect Content-Type parsing can lead to CSRF attack

Moderate

[mcollina](/mcollina)
published
GHSA-3fjj-p79j-c9hh
Nov 21, 2022

## Package

npm

fastify
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>=4.0.0 <= 4.10.1
>=3.0.0 <= 3.29.3

## Patched versions

v4.10.2
v3.29.4

## Description

### Impact

The attacker can use the incorrect `Content-Type` to bypass the `Pre-Flight` checking of `fetch`. `fetch()` requests with Content-Type’s [essence](https://mimesniff.spec.whatwg.org/#mime-type-essence) as "application/x-www-form-urlencoded", "multipart/form-data", or "text/plain", could potentially be used to invoke routes that only accepts `application/json` content type, thus bypassing any [CORS protection](https://fetch.spec.whatwg.org/#simple-header), and therefore they could lead to a Cross-Site Request Forgery attack.

### Patches

For `4.x` users, please update to at least `4.10.2`.

For `3.x` users, please update to at least `3.29.4`.

### Workarounds

Implement Cross-Site Request Forgery protection using [`@fastify/csrf`](https://www.npmjs.com/package/%40fastify/csrf).

### References

Check out the HackerOne report: <https://hackerone.com/reports/1763832>.

### For more information

[Fastify security policy](https://github.com/fastify/fastify/security/policy)

### Severity

Moderate

4.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N

### CVE ID

CVE-2022-41919

### Weaknesses

[CWE-352](/advisories?query=cwe%3A352)

### Credits

* [![@Ry0taK](https://avatars.githubusercontent.com/u/49341894?s=40&v=4)](/Ry0taK)
  [Ry0taK](/Ry0taK)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a60e9811_20250115_091021.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fcommit%2F62dde76f1f7aca76e38625fe8d983761f26e6fc9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fcommit%2F62dde76f1f7aca76e38625fe8d983761f26e6fc9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fastify%2Ffastify)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fastify](/fastify)
/
**[fastify](/fastify/fastify)**
Public

* [Notifications](/login?return_to=%2Ffastify%2Ffastify) You must be signed in to change notification settings
* [Fork
  2.3k](/login?return_to=%2Ffastify%2Ffastify)
* [Star
   32.8k](/login?return_to=%2Ffastify%2Ffastify)

* [Code](/fastify/fastify)
* [Issues
  64](/fastify/fastify/issues)
* [Pull requests
  31](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects
  0](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

Additional navigation options

* [Code](/fastify/fastify)
* [Issues](/fastify/fastify/issues)
* [Pull requests](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

## Commit

[Permalink](/fastify/fastify/commit/62dde76f1f7aca76e38625fe8d983761f26e6fc9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-3fjj-p79j-c9hh](https://github.com/advisories/GHSA-3fjj-p79j-c9hh "GHSA-3fjj-p79j-c9hh")

[Browse files](/fastify/fastify/tree/62dde76f1f7aca76e38625fe8d983761f26e6fc9)
Browse the repository at this point in the history

```
* fix: content-type spoofing

* refactor: improve performance
```

* Loading branch information

[![@climba03003](https://avatars.githubusercontent.com/u/23028015?s=40&v=4)](/climba03003)

[climba03003](/fastify/fastify/commits?author=climba03003 "View all commits by climba03003")
authored
Nov 21, 2022

1 parent
[6fc06c1](/fastify/fastify/commit/6fc06c12c5021cf41ce632bcc902ad66637d15b3)

commit 62dde76

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**293 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + lib/contentTypeParser.js
    [contentTypeParser.js](#diff-40e49c52c74253254f63de155bd3c7183d0d81936d8f272cfd6775b6af65bdb5)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* test

  + test/content-parser.test.js
    [content-parser.test.js](#diff-f3f27b86ead8fd18bca64e17524d1ad609681a08b74b0d371ef3fca878bc1878)
  + test/custom-parser.test.js
    [custom-parser.test.js](#diff-295c12fb69295a8515f17f7712531c4ed95cea8ea971e546dcbb8fc9267e3ece)

## There are no files selected for viewing

81 changes: 75 additions & 6 deletions

81
[lib/contentTypeParser.js](#diff-40e49c52c74253254f63de155bd3c7183d0d81936d8f272cfd6775b6af65bdb5 "lib/contentTypeParser.js")

Show comments

[View file](/fastify/fastify/blob/62dde76f1f7aca76e38625fe8d983761f26e6fc9/lib/contentTypeParser.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,8 @@ |
|  |  |  |
|  |  | const { AsyncResource } = require('async\_hooks') |
|  |  | const lru = require('tiny-lru').lru |
|  |  | // TODO: find more perforamant solution |
|  |  | const { parse: parseContentType } = require('content-type') |
|  |  |  |
|  |  | const secureJson = require('secure-json-parse') |
|  |  | const { |
| Expand Down  Expand Up | | @@ -33,7 +35,7 @@ function ContentTypeParser (bodyLimit, onProtoPoisoning, onConstructorPoisoning) |
|  |  | this.customParsers = new Map() |
|  |  | this.customParsers.set('application/json', new Parser(true, false, bodyLimit, this[kDefaultJsonParse])) |
|  |  | this.customParsers.set('text/plain', new Parser(true, false, bodyLimit, defaultPlainTextParser)) |
|  |  | this.parserList = ['application/json', 'text/plain'] |
|  |  | this.parserList = [new ParserListItem('application/json'), new ParserListItem('text/plain')] |
|  |  | this.parserRegExpList = [] |
|  |  | this.cache = lru(100) |
|  |  | } |
| Expand Down  Expand Up | | @@ -66,7 +68,7 @@ ContentTypeParser.prototype.add = function (contentType, opts, parserFn) { |
|  |  | this.customParsers.set('', parser) |
|  |  | } else { |
|  |  | if (contentTypeIsString) { |
|  |  | this.parserList.unshift(contentType) |
|  |  | this.parserList.unshift(new ParserListItem(contentType)) |
|  |  | } else { |
|  |  | this.parserRegExpList.unshift(contentType) |
|  |  | } |
| Expand Down  Expand Up | | @@ -97,11 +99,20 @@ ContentTypeParser.prototype.getParser = function (contentType) { |
|  |  | const parser = this.cache.get(contentType) |
|  |  | if (parser !== undefined) return parser |
|  |  |  |
|  |  | const parsed = safeParseContentType(contentType) |
|  |  |  |
|  |  | // dummyContentType always the same object |
|  |  | // we can use === for the comparsion and return early |
|  |  | if (parsed === dummyContentType) { |
|  |  | return this.customParsers.get('') |
|  |  | } |
|  |  |  |
|  |  | // eslint-disable-next-line no-var |
|  |  | for (var i = 0; i !== this.parserList.length; ++i) { |
|  |  | const parserName = this.parserList[i] |
|  |  | if (contentType.indexOf(parserName) !== -1) { |
|  |  | const parser = this.customParsers.get(parserName) |
|  |  | const parserListItem = this.parserList[i] |
|  |  | if (compareContentType(parsed, parserListItem)) { |
|  |  | const parser = this.customParsers.get(parserListItem.name) |
|  |  | // we set request content-type in cache to reduce parsing of MIME type |
|  |  | this.cache.set(contentType, parser) |
|  |  | return parser |
|  |  | } |
| Expand All | | @@ -110,8 +121,9 @@ ContentTypeParser.prototype.getParser = function (contentType) { |
|  |  | // eslint-disable-next-line no-var |
|  |  | for (var j = 0; j !== this.parserRegExpList.length; ++j) { |
|  |  | const parserRegExp = this.parserRegExpList[j] |
|  |  | if (parserRegExp.test(contentType)) { |
|  |  | if (compareRegExpContentType(contentType, parsed.type, parserRegExp)) { |
|  |  | const parser = this.customParsers.get(parserRegExp.toString()) |
|  |  | // we set request content-type in cache to reduce parsing of MIME type |
|  |  | this.cache.set(contentType, parser) |
|  |  | return parser |
|  |  | } |
| Expand Down  Expand Up | | @@ -346,6 +358,63 @@ function removeAllContentTypeParsers () { |
|  |  | this[kContentTypeParser].removeAll() |
|  |  | } |
|  |  |  |
|  |  | // dummy here to prevent repeated object creation |
|  |  | const dummyContentType = { type: '', parameters: Object.create(null) } |
|  |  |  |
|  |  | function safeParseContentType (contentType) { |
|  |  | try { |
|  |  | return parseContentType(contentType) |
|  |  | } catch (err) { |
|  |  | return dummyContentType |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function compareContentType (contentType, parserListItem) { |
|  |  | if (parserListItem.isEssence) { |
|  |  | // we do essence check |
|  |  | return contentType.type.indexOf(parserListItem) !== -1 |
|  |  | } else { |
|  |  | // when the content-type includes parameters |
|  |  | // we do a full-text search |
|  |  | // reject essence content-type before checking parameters |
|  |  | if (contentType.type.indexOf(parserListItem.type) === -1) return false |
|  |  | for (const key of parserListItem.parameterKeys) { |
|  |  | // reject when missing parameters |
|  |  | if (!(key in contentType.parameters)) return false |
|  |  | // reject when parameters do not match |
|  |  | if (contentType.parameters[key] !== parserListItem.parameters[key]) return false |
|  |  | } |
|  |  | return true |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function compareRegExpContentType (contentType, essenceMIMEType, regexp) { |
|  |  | if (regexp.source.indexOf(';') === -1) { |
|  |  | // we do essence check |
|  |  | return regexp.test(essenceMIMEType) |
|  |  | } else { |
|  |  | // when the content-type includes parameters |
|  |  | // we do a full-text match |
|  |  | return regexp.test(contentType) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function ParserListItem (contentType) { |
|  |  | this.name = contentType |
|  |  | // we pre-calculate all the needed information |
|  |  | // before content-type comparsion |
|  |  | const parsed = safeParseContentType(contentType) |
|  |  | this.type = parsed.type |
|  |  | this.parameters = parsed.parameters |
|  |  | this.parameterKeys = Object.keys(parsed.parameters) |
|  |  | this.isEssence = contentType.indexOf(';') === -1 |
|  |  | } |
|  |  |  |
|  |  | // used in ContentTypeParser.remove |
|  |  | ParserListItem.prototype.toString = function () { |
|  |  | return this.name |
|  |  | } |
|  |  |  |
|  |  | module.exports = ContentTypeParser |
|  |  | module.exports.helpers = { |
|  |  | buildContentTypeParser, |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/fastify/fastify/blob/62dde76f1f7aca76e38625fe8d983761f26e6fc9/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -176,6 +176,7 @@ |
|  |  | "@fastify/fast-json-stringify-compiler": "^4.1.0", |
|  |  | "abstract-logging": "^2.0.1", |
|  |  | "avvio": "^8.2.0", |
|  |  | "content-type": "^1.0.4", |
|  |  | "find-my-way": "^7.3.0", |
|  |  | "light-my-request": "^5.6.1", |
|  |  | "pino": "^8.5.0", |
| Expand Down | |  |

214 changes: 214 additions & 0 deletions

214
[test/content-parser.test.js](#diff-f3f27b86ead8fd18bca64e17524d1ad609681a08b74b0d371ef3fca878bc1878 "test/content-parser.test.js")

Show comments

[View file](/fastify/fastify/blob/62dde76f1f7aca76e38625fe8d983761f26e6fc9/test/content-parser.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -395,3 +395,217 @@ test('Safeguard against malicious content-type / 3', async t => { |
|  |  |  |
|  |  | t.same(response.statusCode, 415) |
|  |  | }) |
|  |  |  |
|  |  | test('Safeguard against content-type spoofing - string', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser('text/plain', function (request, body, done) { |
|  |  | t.pass('should be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  | fastify.addContentTypeParser('application/json', function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'text/plain; content-type="application/json"' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('Safeguard against content-type spoofing - regexp', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser(/text\/plain/, function (request, body, done) { |
|  |  | t.pass('should be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  | fastify.addContentTypeParser(/application\/json/, function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'text/plain; content-type="application/json"' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type match parameters - string 1', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser('text/plain; charset=utf8', function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  | fastify.addContentTypeParser('application/json; charset=utf8', function (request, body, done) { |
|  |  | t.pass('should be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; charset=utf8' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type match parameters - string 2', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser('application/json; charset=utf8; foo=bar', function (request, body, done) { |
|  |  | t.pass('should be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  | fastify.addContentTypeParser('text/plain; charset=utf8; foo=bar', function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; foo=bar; charset=utf8' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type match parameters - regexp', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser(/application\/json; charset=utf8/, function (request, body, done) { |
|  |  | t.pass('should be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; charset=utf8' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type fail when parameters not match - string 1', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser('application/json; charset=utf8; foo=bar', function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | const response = await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; charset=utf8' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  |  |
|  |  | t.same(response.statusCode, 415) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type fail when parameters not match - string 2', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser('application/json; charset=utf8; foo=bar', function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | const response = await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; charset=utf8; foo=baz' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  |  |
|  |  | t.same(response.statusCode, 415) |
|  |  | }) |
|  |  |  |
|  |  | test('content-type fail when parameters not match - regexp', async t => { |
|  |  | t.plan(1) |
|  |  |  |
|  |  | const fastify = Fastify() |
|  |  | fastify.removeAllContentTypeParsers() |
|  |  | fastify.addContentTypeParser(/application\/json; charset=utf8; foo=bar/, function (request, body, done) { |
|  |  | t.fail('shouldn\'t be called') |
|  |  | done(null, body) |
|  |  | }) |
|  |  |  |
|  |  | fastify.post('/', async () => { |
|  |  | return 'ok' |
|  |  | }) |
|  |  |  |
|  |  | const response = await fastify.inject({ |
|  |  | method: 'POST', |
|  |  | path: '/', |
|  |  | headers: { |
|  |  | 'content-type': 'application/json; charset=utf8' |
|  |  | }, |
|  |  | body: '' |
|  |  | }) |
|  |  |  |
|  |  | t.same(response.statusCode, 415) |
|  |  | }) |

6 changes: 3 additions & 3 deletions

6
[test/custom-parser.test.js](#diff-295c12fb69295a8515f17f7712531c4ed95cea8ea971e546dcbb8fc9267e3ece "test/custom-parser.test.js")

Show comments

[View file](/fastify/fastify/blob/62dde76f1f7aca76e38625fe8d983761f26e6fc9/test/custom-parser.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1053,7 +1053,7 @@ test('The charset should not interfere with the content type handling', t => { |
|  |  | url: getUrl(fastify), |
|  |  | body: '{"hello":"world"}', |
|  |  | headers: { |
|  |  | 'Content-Type': 'application/json charset=utf-8' |
|  |  | 'Content-Type': 'application/json; charset=utf-8' |
|  |  | } |
|  |  | }, (err, response, body) => { |
|  |  | t.error(err) |
| Expand Down  Expand Up | | @@ -1236,7 +1236,7 @@ test('contentTypeParser should add a custom parser with RegExp value', t => { |
|  |  | url: getUrl(fastify), |
|  |  | body: '{"hello":"world"}', |
|  |  | headers: { |
|  |  | 'Content-Type': 'weird-content-type+json' |
|  |  | 'Content-Type': 'weird/content-type+json' |
|  |  | } |
|  |  | }, (err, response, body) => { |
|  |  | t.error(err) |
| Expand Down  Expand Up | | @@ -1266,7 +1266,7 @@ test('contentTypeParser should add multiple custom parsers with RegExp values', |
|  |  | done(null, 'xml') |
|  |  | }) |
|  |  |  |
|  |  | fastify.addContentTypeParser(/.\*\+myExtension$/, function (req, payload, done) { |
|  |  | fastify.addContentTypeParser(/.\*\+myExtension$/i, function (req, payload, done) { |
|  |  | let data = '' |
|  |  | payload.on('data', chunk => { data += chunk }) |
|  |  | payload.on('end', () => { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `62dde76`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fcommit%2F62dde76f1f7aca76e38625fe8d983761f26e6fc9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_16251c54_20250115_091025.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## @fastify/csrfTypeScript icon, indicating that this package has built-in type declarations

8.0.0Â â¢Â PublicÂ â¢Â Published 5 days ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [3 Dependents](?activeTab=dependents)
* [13 Versions](?activeTab=versions)

# CSRF

[![CI](https://github.com/fastify/csrf/actions/workflows/ci.yml/badge.svg?branch=master)](https://github.com/fastify/csrf/actions/workflows/ci.yml)
[![NPM version](https://camo.githubusercontent.com/fc607e1dad60afdbe1e98beb5cf14530ef3b027ed1fe7e69be0aa2a4f0a026d7/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f40666173746966792f637372662e7376673f7374796c653d666c6174)](https://www.npmjs.com/package/%40fastify/csrf)
[![neostandard javascript style](https://camo.githubusercontent.com/f2603803000581b0f47cfa9679b6c98bae990dd3ba4948bfae4a3aa062475a12/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64655f7374796c652d6e656f7374616e646172642d627269676874677265656e3f7374796c653d666c6174)](https://github.com/neostandard/neostandard)

Logic behind CSRF token creation and verification.

Read [Understanding-CSRF](https://github.com/pillarjs/understanding-csrf)
for more information on CSRF. Use this module to create custom CSRF middleware.

Looking for a CSRF framework for your favorite framework that uses this
module?

* Express/connect: [csurf](https://www.npmjs.com/package/csurf) or
  [alt-xsrf](https://www.npmjs.com/package/alt-xsrf)
* Koa: [koa-csrf](https://www.npmjs.com/package/koa-csrf) or
  [koa-atomic-session](https://www.npmjs.com/package/koa-atomic-session)

This module is a fork of <https://github.com/pillarjs/csrf> at f0d66c91ea4be6d30a03bd311ed9518951d9c3e4.

### Install

```
$ npm i @fastify/csrf
```

### TypeScript

This module includes a [TypeScript](https://www.typescriptlang.org/)
declaration file to enable auto-complete in compatible editors and type
information for TypeScript projects.

## API

```
const Tokens = require('@fastify/csrf')
```

### new Tokens([options])

Create a new token generation/verification instance. The `options` argument is
optional and will just use all defaults if missing.

#### Options

Tokens accept these properties in the options object.

##### algorithm

The hash-algorithm to generate the token. Defaults to `sha256`.

##### saltLength

The length of the internal salt to use, in characters. Internally, the salt
is a base 62 string. Defaults to `8` characters.

##### secretLength

The length of the secret to generate, in bytes. Note that the secret is
passed around base-64 encoded and that this length refers to the underlying
bytes, not the length of the base-64 string. Defaults to `18` bytes.

##### userInfo

Require user-specific information in `tokens.create()` and
`tokens.verify()`.

##### hmacKey

When set, the `hmacKey` is used to generate the cryptographic HMAC hash instead of the default hash function.

##### validity

The maximum validity of the token to generate, in milliseconds. Note that the epoch is
passed around base-36 encoded. Defaults to `0` milliseconds (disabled).

#### tokens.create(secret[, userInfo])

Create a new CSRF token attached to the given `secret`. The `secret` is a
string, typically generated from the `tokens.secret()` or `tokens.secretSync()`
methods. This token is what you should add into HTML `<form>` blocks and
expect the user's browser to provide back.

```
const secret = tokens.secretSync()
const token = tokens.create(secret)
```

The `userInfo` parameter can be used to protect against cookie tossing
attacks (and similar) when the application is deployed with untrusted
subdomains. It will encode some user-specific information within the
token. It is used only if `userInfo: true` is passed to the
constructor.

#### tokens.secret(callback)

Asynchronously create a new `secret`, which is a string. The secret is to
be kept on the server, typically stored in a server-side session for the
user. The secret should be at least per user.

```
tokens.secret(function (err, secret) {
  if (err) throw err
  // Do something with the secret
})
```

#### tokens.secret()

Asynchronously create a new `secret` and return a `Promise`. Please see
`tokens.secret(callback)` documentation for full details.

**Note**: To use promises in Node.js *prior to 0.12*, promises must be
"polyfilled" using `global.Promise = require('bluebird')`.

```
tokens.secret().then(function (secret) {
  // Do something with the secret
})
```

#### tokens.secretSync()

A synchronous version of `tokens.secret(callback)`. Please see
`tokens.secret(callback)` documentation for full details.

```
const secret = tokens.secretSync()
```

#### tokens.verify(secret, token[, userInfo])

Check whether a CSRF token is valid for the given `secret`, returning
a Boolean.

```
if (!tokens.verify(secret, token)) {
  throw new Error('invalid token!')
}
```

The `userInfo` parameter is required if `userInfo: true` was configured
during initialization. The user-specific information must match what was
passed in `tokens.create()`.

## License

Licensed under [MIT](https://github.com/fastify/csrf/blob/HEAD/LICENSE).

## Readme

### Keywords

* [csrf](/search?q=keywords:csrf)
* [tokens](/search?q=keywords:tokens)
## Package Sidebar

### Install

`npm i @fastify/csrf`

### Repository

[Gitgithub.com/fastify/csrf](https://github.com/fastify/csrf)

### Homepage

[github.com/fastify/csrf#readme](https://github.com/fastify/csrf#readme)

[**Fund** this package](https://github.com/sponsors/fastify)
### DownloadsWeekly Downloads

19,985

### Version

8.0.0

### License

MIT

### Unpacked Size

44.4 kB

### Total Files

23

### Last publish

5 days ago

### Collaborators

* [![starptech](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci81ZmFkNDM3Mjg5MDAyMDk0MDJkMzI0YmI0NDE0Yjk4Yj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.mBXyPuSWuISynmu4PLjhkZ8cewNw49NpUHnEPUUUy-I "starptech")](/~starptech)
* [![simoneb](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8wODM3ZWE4OTA5N2Q1OTgwYTU1ZTE4MzdmYjFlZmY0MD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.nyXnHupqId7-EIrjjvX-NyLC-_l-pAgBvN1LCtUEbI8 "simoneb")](/~simoneb)
* [![coopflow](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lZTQ0Y2ZmYTlhYzhhOGEyNGMyYjU0MWQ1ODAzYjJjOT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.SFzUu2OeMoWQRit3YDj2hX1brmx9RUxmPx7DsS9jb3M "coopflow")](/~coopflow)
* [![delvedor](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xZGI1NjcwN2I4MThhY2U1NTBkYTExMjNhOGFkMTMwND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.tydKB-LwVqmiCk4E1fcHtivdE-0rIQc_7Qvw7OcljfA "delvedor")](/~delvedor)
* [![matteo.collina](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9jM2ZjNzM3MGJjMDk1MWZiYTk0NGI3YjhjYWM1YjljYz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.2735RDAi_avZ7jDl8X5eYXkrSEO_pVfVGcD6dGYgrMg "matteo.collina")](/~matteo.collina)
* [![allevo](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xYjE2OGY0Yzg1M2Q0ZmQ5NDRhMGM1OTc2YTYyOGNkOD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.i3rw4d--aCuu0CrzokfEaNxTlSAnK0uBLafobHW0OPY "allevo")](/~allevo)
* [![jsumners](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci80MTQ1MjkyZGZhZWFjNTYwNjY1NDE0ZTU1MzNiZjVmMT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.iwWdcj800jsJCgZeIAnxus-GpHR4-E32IHqSvGuE1o4 "jsumners")](/~jsumners)
* [![zekth](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84OGExMTg5MzExNDZkNmY3OWE3OTM4OTgwZTIxYjYyNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.n8N9BpkFspG5V3Xfp3HGsckULYYtcfCe5bF9db2apNQ "zekth")](/~zekth)
* [![rafaelgss](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85NTE0YTM1MWZkMjNiYzg5NTQxNDUyOWUzNmZkNDA1YT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.hYfuLdMsyT9vNxfSsAdfLELYXXohS_stFVw345bX46E "rafaelgss")](/~rafaelgss)
* [![eomm](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mOTFjZjM4Y2I5NGIxMDk0MGM0MzU0OGZhYzY2NDJkYT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.CxEYabe4AMTOLn7D1AVhYRrW5zj-GvTS55MOFFQ_gc4 "eomm")](/~eomm)
* [![fox1t](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83YmE5NGIzNjY3YWIzMTQ4MzgyZGJhYTkxZjE2ZTZjMT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.uVWjKYSyFmmG_Ze5gW30y7o5znqMEv2h95jahXXCuYk "fox1t")](/~fox1t)
* [![airhorns](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mZDAwMGU2YTE2MzFlNGNmNWE3Y2U5NzRhMjI0MDgwMz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.w7TE4Z1_RelenFMSWijFGvNXNSqdq7S8BvbLYAu6Kb4 "airhorns")](/~airhorns)
* [![kibertoad](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82MTcyYjU3MjE3MGYxZThhYjRiZDAwYmZmNWE3NGZiND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Z6Ftf09FpS88a7ApgCGAKwz35qcNtQCM4ZpAaH5X47s "kibertoad")](/~kibertoad)
* [![climba03003](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82NTNmYmFmNmYzNTIxNjI0NmJjOTc2ZmE0NjI5OTg2Mj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.16iLdTRUO9uiC86eCl9fTd-8oL_wUJrOxm9pm_0deh4 "climba03003")](/~climba03003)
* [![galvez](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mNjJkNjg1ZWRkMzczZTc0MDIyYjFiYzY4MDE3NzFlNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0._HfCAL2VYtCgppFiq3ilh9VmLeK-cP-SAG43E4cTtvs "galvez")](/~galvez)
* [![simenb](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9mZjQ4MTBlNTI2ZjUxMWI4YzFiZjc3ZmZmODU1ZTkwZj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.pzvSUbS3IeATUyt04IRSWnk333cgC1GLlPAkmZCHeGg "simenb")](/~simenb)
* [![gurgunday](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kOTZjZTcyOGE4NWRmNjE2MjY2ZDQ3NDUxNDRhZDYwYj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.f4r3R2497PmZYFDMvwsXUQISgscppuFvO0hUcso6tng "gurgunday")](/~gurgunday)
* [![metcoder95](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zZWRjMzllNjZhZTczZWU1NTljOTdmMDZjMDA1NjNlNT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.4KPbmbqb43zOoCIC-QyoEBjKE70eMj8bLtb5LJA6szE "metcoder95")](/~metcoder95)
* [![fdawgs](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82YzBiN2Y0ZGFjZjM2ZDJlNThjYWZjYTQwYzkzYjA4ZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.-OqmUF07SLOEdKOx9LZPnn1iDb1YwyIh50G5XUD_H_o "fdawgs")](/~fdawgs)
[**Try** on RunKit](https://runkit.com/npm/%40fastify/csrf)[**Report** malware](/support?inquire=security&security-inquire=malware&package=%40fastify%2Fcsrf&version=8.0.0)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)


