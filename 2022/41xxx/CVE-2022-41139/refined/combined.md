=== Content from github.com_03e65773_20250114_183632.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetaredteam%2Fexternal-disclosures%2Fsecurity%2Fadvisories%2FGHSA-7344-4pg9-qf45)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetaredteam%2Fexternal-disclosures%2Fsecurity%2Fadvisories%2FGHSA-7344-4pg9-qf45)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=metaredteam%2Fexternal-disclosures)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[metaredteam](/metaredteam)
/
**[external-disclosures](/metaredteam/external-disclosures)**
Public

* [Notifications](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures)
* [Star
   27](/login?return_to=%2Fmetaredteam%2Fexternal-disclosures)

* [Code](/metaredteam/external-disclosures)
* [Pull requests
  0](/metaredteam/external-disclosures/pulls)
* [Security](/metaredteam/external-disclosures/security)
* [Insights](/metaredteam/external-disclosures/pulse)

Additional navigation options

* [Code](/metaredteam/external-disclosures)
* [Pull requests](/metaredteam/external-disclosures/pulls)
* [Security](/metaredteam/external-disclosures/security)
* [Insights](/metaredteam/external-disclosures/pulse)

# Stored XSS in MITRE CALDERA Debrief Plugin - Gist Contact

High

[l50](/l50)
published
GHSA-7344-4pg9-qf45
Sep 22, 2022

## Package

CALDERA
(MITRE)

## Affected versions

< CALDERA v4.0.0

## Patched versions

CALDERA v4.1.0

DEBRIEF
(MITRE)

< commit 7ea5d726538a27bdc33613b1c23d822f73935c6f

commit d815b603cbc639e9de509ca1331446cb3bb075aa

## Description

## Vulnerability Description:

A third stored cross-site scripting (XSS) vulnerability was discovered in the gist contact configuration field of [MITRE CALDERA](https://github.com/mitre/caldera). We confirmed it was possible as the `blue` user to attack the `red` user provided through the [Docker Compose CALDERA deployment](https://github.com/mitre/caldera#docker-deployment). More specifically, we were able to introduce an attack as the `blue` user that resulted in the `red` user (once they triggered the vuln) to execute arbitrary commands on agents that are part of an operation.

Successful exploitation of this vulnerability can provide an attacker with the means to escalate their privileges within the application and the ability to run arbitrary code on any enrolled systems.

The vulnerability was tested on [mitre/caldera@a1f6a91](https://github.com/mitre/caldera/commit/a1f6a919cbee846412fb273d357ccf7eea7de800).

## Proof of Concept:

1. Create a Caldera test environment
2. Login to Caldera with the red user
3. Click Configuration
4. Set app.contact.gist to `"><img src=x onerror=prompt(document.domain)>`
5. Click **Update**
6. Click **debrief**
7. Move your mouse over the C2 Server icon
8. Observe prompt

## Fix:

**Remediation strategy provided by [Jonathan (Jay) Yee](https://github.com/yee-jonathan) from the MITRE Caldera development team:**

This specific vulnerability in debrief was patched in [mitre/debrief@d815b60](https://github.com/mitre/debrief/commit/d815b603cbc639e9de509ca1331446cb3bb075aa)

The debrief plugin commit was also pinned to the latest release, [caldera v4.1.0](https://github.com/mitre/caldera/tree/4.1.0)

Users running caldera versions older than v4.1.0 are urged to update the `debrief` plugin to the latest version:

`git submodule update --remote --force plugins/debrief`

Patched plugin: [Patched commit](https://github.com/mitre/debrief/commit/d815b603cbc639e9de509ca1331446cb3bb075aa)

## Timeline:

**Reported:** September 19th, 2022

**Acknowledged:** September 21st, 2022

**Fixed:** September 21st, 2022

### Severity

High

### CVE ID

CVE-2022-41139

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20) [CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@l50](https://avatars.githubusercontent.com/u/4031126?s=40&v=4)](/l50)
  [l50](/l50)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


