=== Content from github.com_48036628_20250114_202354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairbnb%2Foptica%2Fsecurity%2Fadvisories%2FGHSA-cf87-4h6x-phh6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairbnb%2Foptica%2Fsecurity%2Fadvisories%2FGHSA-cf87-4h6x-phh6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=airbnb%2Foptica)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airbnb](/airbnb)
/
**[optica](/airbnb/optica)**
Public

* [Notifications](/login?return_to=%2Fairbnb%2Foptica) You must be signed in to change notification settings
* [Fork
  32](/login?return_to=%2Fairbnb%2Foptica)
* [Star
   133](/login?return_to=%2Fairbnb%2Foptica)

* [Code](/airbnb/optica)
* [Issues
  0](/airbnb/optica/issues)
* [Pull requests
  2](/airbnb/optica/pulls)
* [Actions](/airbnb/optica/actions)
* [Projects
  0](/airbnb/optica/projects)
* [Security](/airbnb/optica/security)
* [Insights](/airbnb/optica/pulse)

Additional navigation options

* [Code](/airbnb/optica)
* [Issues](/airbnb/optica/issues)
* [Pull requests](/airbnb/optica/pulls)
* [Actions](/airbnb/optica/actions)
* [Projects](/airbnb/optica/projects)
* [Security](/airbnb/optica/security)
* [Insights](/airbnb/optica/pulse)

# Remote Code Execution in Optica

High

[deni](/deni)
published
GHSA-cf87-4h6x-phh6
Nov 22, 2022

## Package

Optica
(Ruby)

## Affected versions

< 0.10.2

## Patched versions

0.10.2

## Description

On the 26th of July 2022, the GitHub Security Lab reported to Airbnb a remote code execution (RCE) vulnerability in Optica that allowed unauthenticated attackers to execute arbitrary code via specially crafted JSON payloads.

A patched version of Optica was released 28th of July 2022.

### Impact

Specially crafted JSON payloads may lead to RCE (remote code execution) on the attacked system running Optica.

### Patches

The vulnerability was patched in v. 0.10.2, where the call to the function `oj.load` was changed to `oj.safe_load`.

### Workarounds

None, it is recommended that users upgrade to the newest version.

### References

* <https://github.com/ohler55/oj/blob/develop/pages/Security.md>
* <https://www.rubydoc.info/gems/oj/3.0.2/Oj.safe_load>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in the Optica repository
* Email us at bugbounty@airbnb.com

### Severity

High

### CVE ID

CVE-2022-41875

### Weaknesses

No CWEs

### Credits

* [![@p-](https://avatars.githubusercontent.com/u/176818?s=40&v=4)](/p-)
  [p-](/p-)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7d190381_20250114_202504.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fohler55%2Foj%2Fblob%2Fdevelop%2Fpages%2FSecurity.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fohler55%2Foj%2Fblob%2Fdevelop%2Fpages%2FSecurity.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ohler55%2Foj)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ohler55](/ohler55)
/
**[oj](/ohler55/oj)**
Public

* [Notifications](/login?return_to=%2Fohler55%2Foj) You must be signed in to change notification settings
* [Fork
  254](/login?return_to=%2Fohler55%2Foj)
* [Star
   3.2k](/login?return_to=%2Fohler55%2Foj)

* [Code](/ohler55/oj)
* [Issues
  12](/ohler55/oj/issues)
* [Pull requests
  0](/ohler55/oj/pulls)
* [Discussions](/ohler55/oj/discussions)
* [Actions](/ohler55/oj/actions)
* [Security](/ohler55/oj/security)
* [Insights](/ohler55/oj/pulse)

Additional navigation options

* [Code](/ohler55/oj)
* [Issues](/ohler55/oj/issues)
* [Pull requests](/ohler55/oj/pulls)
* [Discussions](/ohler55/oj/discussions)
* [Actions](/ohler55/oj/actions)
* [Security](/ohler55/oj/security)
* [Insights](/ohler55/oj/pulse)

## Files

 develop
## Breadcrumbs

1. [oj](/ohler55/oj/tree/develop)
2. /[pages](/ohler55/oj/tree/develop/pages)
/
# Security.md

Copy path Blame  Blame
## Latest commit

## History

[History](/ohler55/oj/commits/develop/pages/Security.md)20 lines (18 loc) · 1.3 KB develop
## Breadcrumbs

1. [oj](/ohler55/oj/tree/develop)
2. /[pages](/ohler55/oj/tree/develop/pages)
/
# Security.md

Top
## File metadata and controls

* Preview
* Code
* Blame

20 lines (18 loc) · 1.3 KB[Raw](https://github.com/ohler55/oj/raw/refs/heads/develop/pages/Security.md)
# Security and Optimization

Two settings in Oj are useful for parsing but do expose a vulnerability if used
from an untrusted source. Symbolized keys can cause memory to be filled with
previous versions of ruby. Ruby 2.1 and below does not garbage collect
Symbols. The same is true for auto defining classes in all versions of ruby;
memory will also be exhausted if too many classes are automatically
defined. Auto defining is a useful feature during development and from trusted
sources but it allows too many classes to be created in the object load mode and
auto defined is used with an untrusted source. The `Oj.safe_load()` method
sets and uses the most strict and safest options. It should be used by
developers who find it difficult to understand the options available in Oj.

The options in Oj are designed to provide flexibility to the developer. This
flexibility allows Objects to be serialized and deserialized. No methods are
ever called on these created Objects but that does not stop the developer from
calling methods on them. As in any system, check your inputs before working with
them. Taking an arbitrary `String` from a user and evaluating it is never a good
idea from an unsecure source. The same is true for `Object` attributes as they
are not more than `String`s. Always check inputs from untrusted sources.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.rubydoc.info_03b1617f_20250114_202601.html ===


[Libraries](/gems) »
oj (3.0.2)
»
[Index](/gems/oj/3.0.2/index) »
[Oj](/gems/oj/3.0.2/Oj "Oj (module)")
»
safe\_load

# Method: Oj.safe\_load

Defined in:
ext/oj/oj.c

### .**safe\_load**(doc) ⇒ Object

Loads a JSON document in strict mode with :auto\_define and :symbol\_keys turned off. This function should be safe to use with JSON received on an unprotected public interface.

* **doc** [*String\_*|*IO*] JSON String or IO to load.

Returns [*Hash*|*Array*|*String*|*Fixnum*|*Bignum*|*BigDecimal*|*nil*|*True*|*False*]

| ```    891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 ``` | ``` # File 'ext/oj/oj.c', line 891  static VALUE safe_load(VALUE self, VALUE doc) {     struct _ParseInfo	pi;     VALUE		args[1];      parse_info_init(&pi);     pi.err_class = Qnil;     pi.max_depth = 0;     pi.options = oj_default_options;     pi.options.auto_define = No;     pi.options.sym_key = No;     pi.options.mode = StrictMode;     oj_set_strict_callbacks(&pi);     *args = doc;      return oj_pi_parse(1, args, &pi, 0, 0, 1); } ``` |
| --- | --- |

Generated on Tue Jan 14 20:25:41 2025 by
[yard](http://yardoc.org "Yay! A Ruby Documentation Tool")
0.9.36 (ruby-3.3.5).


