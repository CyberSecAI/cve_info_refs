=== Content from savannah.gnu.org_4911c910_20250114_191301.html ===


* [![Back to Savannah Homepage](/images/Savannah.theme/floating.png)](/)
* Not Logged in
* [Login](/account/login.php?uri=%2Fbugs%2F%3F63103 "Login page - you must have registered an account first")
* [New User](/account/register.php "Account registration form")
* This Page
* [Language](/i18n.php?lang_uri=%2Fbugs%2F%3F63103 "Choose website language")
* [Clean Reload](/bugs/index.php?reload=1&func=detailitem&item_id=63103 "Reload the page without risk of reposting data")
* Search
* Area to search in
  Groups
  People
  Support
  Bugs
  Tasks
  Patches
* Hosted Projects
* [Hosting requirements](/register/requirements.php)
* [Register New Project](/register/ "Register your project at Savannah")
* [Full List](/search/index.php?type_of_search=soft&words=%%% "Browse the full list of hosted projects")
* [Contributors Wanted](/people/ "Browse the list of request for contributions")
* [Statistics](/stats/ "Browse statistics about Savannah")
* Site Help
* [User Docs: FAQ](/maintenance/FrontPage/)
* [User Docs: In Depth Guide](/maintenance/back-page/ "In-depth Documentation dedicated to any users, including group admins")
* [Get Support](/support/?group=administration "Get help from the Admins of Savannah, when documentation is not enough")
* [Contact Savannah](/contact.php "Contact address of Savannah Admins")
* GNU Project
* [Help GNU](//www.gnu.org/help/help.html)
* [All GNU Packages](//www.gnu.org/software/software.html)
* [Dev Resources](//www.gnu.org/software/devel.html)
* [License List](//www.gnu.org/licenses/license-list.html)
* [GNU Mirrors](//www.gnu.org/prep/ftp.html)
* [![Support freedom](/images/Savannah.theme/thin-image.png)

  Help us protect your freedom and the rights of computer
  users everywhere by becoming a member of the FSF.

  **Join Now!**](//www.fsf.org/associate/support_freedom/join_fsf?referrer=2442)
* Free Software Foundation
* [Coming Events](//www.fsf.org/events/)
* [Free Software Directory](//www.fsf.org/directory/)
* [Cryptographic software legal notice](//savannah.gnu.org/maintenance/SavannahCryptographicRestrictions)
* [Copyright infringement notification](//www.fsf.org/about/dmca-notice)
* Related Forges
* [Savannah Non-GNU](//savannah.nongnu.org/)
* [Puszcza](//puszcza.gnu.org.ua/)

# bugThe oSIP library - Bugs: bug #63103, osip\_body\_parse\_header len integer...

 Group

* [Main](/projects/osip/ "Group main page at Savannah")
  + [Main](/projects/osip/)
  + [View members](/project/memberlist.php?group=osip)
  + [Search](/project/search.php?group=osip)
* [Homepage](http://www.gnu.org/software/osip/ "Browse group home page (outside of Savane)")
* [Download](/files/?group=osip "Visit download area: files released")
* [Support](/support/?group=osip "Tech Support Tracker: post, search and manage support requests")
  + [Submit new](/support/?group=osip&func=additem)
  + [Browse](/support/?group=osip)
  + [Reset to open](/support/?group=osip&func=browse&set=open)
  + [Digest](/support/?group=osip&func=digest)
  + [Dependencies](/support/dependencies.php?group=osip)
  + ~~Export~~
  + [Get statistics](/support/reporting.php?group=osip)
  + [Search](/support/?group=osip&func=search)
* [Mailing lists](/mail/?group=osip "List existing mailing lists")
* [Source code](/projects/osip/#devtools "Source code management")
  + [Use CVS](/cvs/?group=osip "CVS Repository")
  + [Browse Web Pages Repository](http://web.cvs.savannah.gnu.org/viewvc/?root=osip)
  + [Use Subversion](/svn/?group=osip "Subversion Repository")
  + [Browse Subversion repository](http://svn.savannah.gnu.org/viewcvs/?root=osip)
  + [Use Git](/git/?group=osip "Git Repository")
  + [Browse Git repository](//git.savannah.gnu.org/cgit/osip.git)
* [Bugs](/bugs/?group=osip "Bug Tracker: report, search and track bugs")
  + [Submit new](/bugs/?group=osip&func=additem)
  + [Browse](/bugs/?group=osip)
  + [Reset to open](/bugs/?group=osip&func=browse&set=open)
  + [Digest](/bugs/?group=osip&func=digest)
  + [Dependencies](/bugs/dependencies.php?group=osip)
  + ~~Export~~
  + [Get statistics](/bugs/reporting.php?group=osip)
  + [Search](/bugs/?group=osip&func=search)
* [Tasks](/task/?group=osip "Task Manager: post, search and manage tasks")
  + ~~Submit new~~
  + [Browse](/task/?group=osip)
  + [Reset to open](/task/?group=osip&func=browse&set=open)
  + [Digest](/task/?group=osip&func=digest)
  + [Dependencies](/task/dependencies.php?group=osip)
  + ~~Export~~
  + [Get statistics](/task/reporting.php?group=osip)
  + [Search](/task/?group=osip&func=search)
* [Patches](/patch/?group=osip "Patch Manager: post, search and manage patches")
  + ~~Submit new~~
  + [Browse](/patch/?group=osip)
  + [Reset to open](/patch/?group=osip&func=browse&set=open)
  + [Digest](/patch/?group=osip&func=digest)
  + [Dependencies](/patch/dependencies.php?group=osip)
  + ~~Export~~
  + [Get statistics](/patch/reporting.php?group=osip)
  + [Search](/patch/?group=osip&func=search)
* [News](/news/?group=osip "Read latest News, post News")
  + [Browse](/news/?group=osip)
  + [Atom feed](/news/atom.php?group=osip)
  + ~~Submit~~
  + ~~Manage~~

# *[bug #63103](?63103)*: osip\_body\_parse\_header len integer overflow (5.3.0) [CVE-2022-41550]

| Submitter: | [Marco Bartoli <wsx>](/users/wsx) |  | |
| --- | --- | --- | --- |
| Submitted: | Sun 25 Sep 2022 04:28:15 PM UTC |  | |
|  |  |  | |
|  | | | |
| Category: | None | Severity: | 3 - Normal |
| Item Group: | None | Status: | Fixed |
| Privacy: | Public | Assigned to: | aymeric |
| Open/Closed: | Closed |

\* Mandatory Fields
## [Post a Comment](#postcomment)

 Add a New Comment [![](/images/Savannah.theme/misc/edit.png)Rich Markup](/markup-test.php)

## [Discussion](#discussion)

|
|  |
| [Wed 12 Oct 2022 05:02:14 PM UTC, comment #5:](#comment5) Quote  To be complete:   When **end\_of\_line** is NULL: (end\_of\_line - 2) - colon\_index < 2 may be true.   This will ends up crashing and explains why there was a crash when compiling with "-m32" | [Aymeric MOIZARD <aymeric>](/users/aymeric) Group administrator |
| [Wed 28 Sep 2022 01:35:22 PM UTC, comment #4:](#comment4) Quote  The other places are false positive. The use-case should never happen because those methods are called after removing LWS.   In msg\_osip\_body\_parse, LWS wasn't removed (they are not allowed here)   The current code should be safe.   I will think about adding the return anyway in the 2 files you mentioned.   Thanks | [Aymeric MOIZARD <aymeric>](/users/aymeric) Group administrator |
| [Tue 27 Sep 2022 06:04:30 PM UTC, comment #3:](#comment3) Quote  Thanks for the fast fix.   Yes I did not analyze completely what was happening in the caller (osip\_body\_parse\_header) so I assumed it was an overflow from there, that's why I said probably.   I verified and the fix is correct! Not exiting on the error value -2 made osip\_clrncpy crash because of an overflow achieved with garbage data.   I checked around the codebase and it seems this bug is replicated two other times, not sure if it's triggerable but better fix those too.   <https://git.savannah.gnu.org/cgit/osip.git/tree/src/osipparser2/osip_message_parse.c#n590>   <https://git.savannah.gnu.org/cgit/osip.git/tree/src/osipparser2/osip_message_parse.c#n388> | [Marco Bartoli <wsx>](/users/wsx) |
| [Tue 27 Sep 2022 09:26:33 AM UTC, comment #2:](#comment2) Quote  Hi Marco,   Thanks a lot for your report.   I made a fix, available there:   <https://git.savannah.gnu.org/cgit/osip.git/commit/?id=f77f16c832c3c37589c2b749f01b644dc44a55b5>   The change doesn't look to match **exactly** your report: the bug appeared on the line after osip\_clrncpy for me.   Can you please check the newest fix?   Regards  Aymeric | [Aymeric MOIZARD <aymeric>](/users/aymeric) Group administrator |
| [Sun 25 Sep 2022 04:56:37 PM UTC, comment #1:](#comment1) Quote  pwndbg> bt  #0  0x5656a1b7 in osip\_clrncpy ()  #1  0x5655adde in osip\_body\_parse\_header ()  #2  0x5655b057 in osip\_body\_parse\_mime ()  #3  0x5655ab82 in osip\_message\_set\_body\_mime ()  #4  0x56564844 in msg\_osip\_body\_parse ()  #5  0x56564c6d in \_osip\_message\_parse ()  #6  0x56564d2f in osip\_message\_parse ()  #7  0x56577511 in test\_message ()  #8  0x5657737b in main ()  #9  0xf7c1f129 in ?? () from /usr/lib32/libc.so.6  #10 0xf7c1f1fd in \_\_libc\_start\_main () from /usr/lib32/libc.so.6  #11 0x5655636b in \_start () at ../sysdeps/i386/start.S:111  pwndbg> disass $pc, $pc+16  Dump of assembler code from 0x5656a1b7 to 0x5656a1c7:  => 0x5656a1b7 <osip\_clrncpy+181>:       movzx  eax,BYTE PTR [eax]     0x5656a1ba <osip\_clrncpy+184>:       cmp    al,0x20     0x5656a1bc <osip\_clrncpy+186>:       je     0x5656a17c <osip\_clrncpy+122>     0x5656a1be <osip\_clrncpy+188>:       mov    eax,DWORD PTR [ebp-0x18]     0x5656a1c1 <osip\_clrncpy+191>:       movzx  eax,BYTE PTR [eax]     0x5656a1c4 <osip\_clrncpy+194>:       cmp    al,0xd     0x5656a1c6 <osip\_clrncpy+196>:       je     0x5656a17c <osip\_clrncpy+122>  End of assembler dump.  pwndbg> info reg  eax            0xfffffffd          -3  ecx            0x0                 0  edx            0xf7fc14c0          -134474560  ebx            0x5657fff4          1448607732  esp            0xffffd070          0xffffd070  ebp            0xffffd088          0xffffd088  esi            0xffffd340          -11456  edi            0xf7ffcb80          -134231168  eip            0x5656a1b7          0x5656a1b7 <osip\_clrncpy+181>  eflags         0x10282             [ SF IF RF ]  cs             0x23                35  ss             0x2b                43  ds             0x2b                43  es             0x2b                43  fs             0x0                 0  gs             0x63                99 | [Marco Bartoli <wsx>](/users/wsx) |
| [Sun 25 Sep 2022 04:28:15 PM UTC, **original submission:**](#comment0) Quote  Hello, I would like to report an integer overflow I found fuzzing the SIP parsing function of the latest version (5.3.0).   osip\_clrncpy pend pointer overflows adding the length to the src ptr, this wrong len probably comes from some overflows in osip\_body\_parse\_header.  The program crashes when it tries to read from the overflown pend.   ```  init pend=0xfffffffd == (len=135081942 + src=0xf7f2d028 - 1) pbeg=0xf7f2d028  ```   To reproduce the bug, change the torture file size limit to use 200000 instead of 100000 and compile it for 32bit (-m32).   ```  ./torture crash1\_5.3.0\_report  ```   Thanks and looking forward for a feedback,  Marco `wsx` Bartoli | [Marco Bartoli <wsx>](/users/wsx) |

## [Attached Files](#attached)

(Note: upload size limit is set to 16384 kB, after insertion of
the required escape characters.)

 Attach Files:

Comment:

Attached Files
[file #53752:  crash1\_5.3.0\_report](https://file.savannah.gnu.org/file/crash1_5.3.0_report?file_id=53752) added by [wsx](/users/wsx) (132KiB - application/octet-stream - Testcase to crash 32bit parse)

## [Dependencies](#dependencies)

Depends on the following items: None found

Items that depend on this one: None found

## [Mail Notification Carbon-Copy List](#cc)

Carbon-Copy List- -email is unavailable- added by [aymeric](/users/aymeric) (Posted a comment)- -email is unavailable- added by [wsx](/users/wsx) (Submitted the item)
## [Votes](#votes)

There are 0 votes so far. Votes easily highlight which items people would like to see resolved
in priority, independently of the priority of the item set by tracker
managers.

Only logged-in users can vote.

Please enter the title of [George Orwell](https://en.wikipedia.org/wiki/George_Orwell)'s famous
dystopian book (it's a date):

## [History](#history)

Follow 5 latest changes.

| Date | Changed by | Updated Field | Previous Value | => | Replaced by |
| --- | --- | --- | --- | --- | --- |
| 2022-10-12 | [aymeric](/users/aymeric) | Summary | osip\_body\_parse\_header len integer overflow (5.3.0) |  | osip\_body\_parse\_header len integer overflow (5.3.0) [CVE-2022-41550] |
| 2022-09-28 | [aymeric](/users/aymeric) | Open/Closed | Open |  | Closed |
| 2022-09-27 | [aymeric](/users/aymeric) | Status | None |  | Fixed |
|  |  | Assigned to | None |  | aymeric |
| 2022-09-25 | [wsx](/users/wsx) | Attached File | - |  | Added crash1\_5.3.0\_report, #53752 |

[![Back to the top](/images/Savannah.theme/arrows/top.orig.png)](#top)

Copyright © 2025 Free Software Foundation, Inc.

Verbatim copying and distribution of this entire article
is permitted in any medium, provided this notice is preserved.

The [Levitating,
Meditating, Flute-playing Gnu](//www.gnu.org/graphics/meditate.html) logo is a GNU GPL'ed image provided
by the Nevrax Design Team.

[Page source code](//git.savannah.nongnu.org/cgit/administration/savane.git/plain//frontend/php/bugs/index.php?id=04e1be7c5875649835636cff39891da2b16ab95a)

Powered by Savane 3.14-04e1.
[Corresponding source code](https://savannah.gnu.org/source/savane-04e1be7c5875649835636cff39891da2b16ab95a.tar.gz)


