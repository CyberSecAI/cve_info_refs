The provided content relates to CVE-2022-41766.

**Root Cause of Vulnerability:**
The vulnerability arises from the "alreadyrolled" message within the rollback functionality of MediaWiki. When a page is moved by a user, resulting in a null revision, and that user's revision is then suppressed (revision deleted), the "alreadyrolled" message can inadvertently reveal the suppressed username when a rollback action is attempted. This occurs when using the rollback action from the history page.

**Weaknesses/Vulnerabilities:**
- Information Leakage: The primary vulnerability is the leaking of a revision deleted username through the "alreadyrolled" message when a rollback is attempted on a page with a suppressed null revision.
- Improper Handling of Suppressed Usernames: The system fails to properly anonymize or handle suppressed usernames when generating the "alreadyrolled" message.

**Impact of Exploitation:**
- Disclosure of Suppressed Usernames: An attacker can potentially discover the identities of users whose revisions have been suppressed, compromising their privacy.
- Undermining Revision Deletion: The leak undermines the purpose of revision deletion, which is intended to hide sensitive user information from public view.

**Attack Vectors:**
- Rollback Action from History: The attack vector involves using the rollback functionality via the history page on a page that has a suppressed null revision.
- Specific Actions: This vulnerability is triggered by specific sequences of actions: a move creating a null revision, followed by revision deletion/suppression of that user, and then a rollback attempt.

**Required Attacker Capabilities/Position:**
- Rollback Permissions: The attacker must have rollback permissions on the wiki to trigger the vulnerability. The user does not need to be an admin.
- Knowledge of Vulnerable Pages: The attacker needs to identify pages with suppressed null revisions.
- Access to the Wiki: The attacker needs to be a user on the affected MediaWiki instance.

**Additional Details:**

- The vulnerability was introduced in a refactor [https://gerrit.wikimedia.org/r/c/mediawiki/core/+/675236](https://gerrit.wikimedia.org/r/c/mediawiki/core/%2B/675236)
- Patches were created to address the issue by hiding suppressed usernames from the rollback error messages.
- The fix involves replacing the username with a generic "rev-deleted-user" message when a suppressed user is involved.
- Different patches were created for different MediaWiki releases (REL1_35, REL1_37, REL1_38, REL1_39, and master) due to differences in code and presence of `getAuthority()` function.
- The vulnerability is considered to have a low-risk rating.