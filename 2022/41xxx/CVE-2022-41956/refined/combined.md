=== Content from securitylab.github.com_bb5f765e_20250114_182014.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 7, 2023
# GHSL-2022-100: Path traversal vulnerability and remote code execution (RCE) vulnerability in Autolab - CVE-2022-41955,CVE-2022-41956

[![Author avatar](https://avatars.githubusercontent.com/u/176818)
Peter Stöckli](https://github.com/p-)

## Coordinated Disclosure Timeline

* 2022-11-21: Notified Autolab maintainers via email.
* 2022-11-21: Received initial acknowledgments by the Autolab team.
* 2022-11-21: The Autolab team started working on the fixes.
* 2022-01-13: Vulnerabilities were fixed and advisories were published [1](https://github.com/autolab/Autolab/security/advisories/GHSA-g7x7-mgrv-f24x), [2](https://github.com/autolab/Autolab/security/advisories/GHSA-x5r3-vf3p-3269).

## Summary

Two vulnerabilities were found in Autolab:

* Issue 1: File disclosure due to path traversal (`GHSL-2022-100`) - A path traversal vulnerability exists in Autolab’s remote handin feature.
* Issue 2: Authenticated Remote Code Execution (`GHSL-2022-124`) - A remote code execution vulnerability exists in the plagiarism checker functionality of Autolab.

These issues are listed in detail below.

## Product

Autolab

## Tested Version

[v2.9.0](https://github.com/autolab/Autolab/releases/tag/v2.9.0)

## Details

### Issue 1: File disclosure due to path traversal (`GHSL-2022-100`)

Autolab provides the possibility to allow submissions of students via a so-called remote handin feature. Handins submitted with this feature are copied from a path that is accessible to the running Autolab instance. In practice the remote handin path will probably be located in a directory of a shared drive. The endpoint for such submissions allows unauthenticated attackers to hand-in assignments for registered users using paths outside of their submission directory. The value of the [`submit`](https://github.com/autolab/Autolab/blob/524d4bb896e6d47e469e621b5d44c8cc36b90cd2/app/controllers/assessment/handin.rb#L131) parameter is passed to the [`saveHandin`](https://github.com/autolab/Autolab/blob/524d4bb896e6d47e469e621b5d44c8cc36b90cd2/app/controllers/assessment/handin.rb#L145) module method without futher sanitization or verification. The contents of the corresponding files of the submitted file paths could then be viewed by users viewing “their” submissions.

#### Proof of Concept

Preconditions:

1. Remote handin path needs to be set
2. Handin directory inside remote handin path for a user must exist in the form: `<email>_remote_handin_<assessment-name>` (This seems to be a general precondition for making the remote handin feature work)
3. At least one email address of a user that is registered to any course and assigment

The attacker then simply needs to construct an URL in this form and call it via GET request:

```
http://<autolab-host>/courses/<course-name>/assessments/<assessment-name>/local_submit?user=<registered-user-email>&submit=../../../../../<path-to-existing-file>

```

E.g.:

```
http://127.0.0.1/courses/Mycourse/assessments/mylab/local_submit?user=student@host.test&submit=../../../../../etc/passwd

```

Afterwards the attacker can view or download the contents of the desired file (e.g., `/etc/passwd`) in the “Handin History” of the assessment.

#### Impact

This issue may lead to `Information Disclosure`.

#### Resources

* [Submissions via Andrew File System (AFS)](https://github.com/autolab/Autolab/issues/126)

### Issue 2: Authenticated Remote Code Execution (`GHSL-2022-124`)

Autolab provides the functionality to check submissions for plagiarism using [MOSS (Measure Of Software Similarity)](https://docs.autolabproject.com/features/moss/). The Moss Cheat Checker can be run by instructors with sufficient permissions. The parameters [`max_lines`](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L397) and [`language_selection`](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L399) both flow unsanitized through several ([1](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L402), [2](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L403), [3](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L414)) different join operations before flowing into a [command execution sink](https://github.com/autolab/Autolab/blob/9da0c435346d638bfc7d08dce7d42403cac5c7c5/app/controllers/courses_controller.rb#L415). Using this vulnerability an attacker might gain control over the server running Autolab.

This vulnerability was discovered with the help of CodeQL’s [Uncontrolled command line](https://codeql.github.com/codeql-query-help/ruby/rb-command-line-injection/) query.

#### Proof of Concept

Preconditions:

1. Attacker needs to be logged in as instructor
2. There needs to be an existing course where the instructor has access permissions

This vulnerability can simply be exploited by using a browser and navigating to:

```
http://<autolab-host>/courses/<course-name>/moss

```

After selecting an assignment, the checkbox “Max Lines” needs to be enabled and instead of providing a valid number of lines a shell command such as `| touch /tmp/pwned.txt |` can be provided. (Which will then create the file `/tmp/pwned.txt` after clicking “GO!”).

To manipulate the `language_selection` parameter in the same way a browser inspection tools or a tool like `curl` can be used to manufacture the desired requests.

#### Impact

This issue may lead to Remote Code Execution (RCE).

#### Resources

* [Uncontrolled command line](https://codeql.github.com/codeql-query-help/ruby/rb-command-line-injection/)

## CVE

* CVE-2022-41955: RCE via MOSS functionality
* CVE-2022-41956: File disclosure via remote handin feature

## Credit

This issue was discovered and reported by GHSL team member [@p- (Peter Stöckli)](https://github.com/p-).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-100` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_b5b694f7_20250114_182012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fsecurity%2Fadvisories%2FGHSA-g7x7-mgrv-f24x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fsecurity%2Fadvisories%2FGHSA-g7x7-mgrv-f24x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=autolab%2FAutolab)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[autolab](/autolab)
/
**[Autolab](/autolab/Autolab)**
Public

* [Notifications](/login?return_to=%2Fautolab%2FAutolab) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2Fautolab%2FAutolab)
* [Star
   771](/login?return_to=%2Fautolab%2FAutolab)

* [Code](/autolab/Autolab)
* [Issues
  147](/autolab/Autolab/issues)
* [Pull requests
  14](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects
  0](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

Additional navigation options

* [Code](/autolab/Autolab)
* [Issues](/autolab/Autolab/issues)
* [Pull requests](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

# File disclosure via remote handin feature

Moderate

[damianhxy](/damianhxy)
published
GHSA-g7x7-mgrv-f24x
Jan 13, 2023

## Package

Autolab

## Affected versions

<= 2.9.0

## Patched versions

2.10.0

## Description

### Impact

A file disclosure vulnerability was discovered in Autolab's remote handin feature, whereby users are able to hand-in assignments using paths outside their submission directory. Users can then view the submission to view the file's contents.

### Patches

The vulnerability has been patched in v2.10.0.

### Workarounds

Ensure that the field for the remote handin feature is empty (Edit Assessment > Advanced > Remote handin path), and that you are not running Autolab as `root` (or any user that has write access to `/`).

Alternatively, disable the remote handin feature if it is unneeded by replacing the body of `local_submit` in `app/controllers/assessment/handin.rb` with `render(plain: "Feature disabled", status: :bad_request) && return`.

### References

* [Rails Path Traversal](https://www.stackhawk.com/blog/rails-path-traversal-guide-examples-and-prevention/)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in <https://github.com/autolab/Autolab/>
* Email us at autolab-dev@andrew.cmu.edu

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2022-41956

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@p-](https://avatars.githubusercontent.com/u/176818?s=40&v=4)](/p-)
  [p-](/p-)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.stackhawk.com_1e583fcc_20250114_182016.html ===
[![StackHawk](data:image/svg+xml;base64...)](/)

* Product![Caret Down](data:image/svg+xml;base64...)
  ##### BLOG

  ### How Does StackHawk Work?

  StackHawk helps teams ship secure software faster and eliminate disruptive fix processes.

  [Read Now![Right Arrow Icon](data:image/svg+xml;base64...)](/blog/how-does-stackhawk-work/)
  ### Our Product

  [+ ![Explore Stackhawk](data:image/png;base64...)
    #### Explore Stackhawk

    Purpose-built for todays modern engineering teams](/product/)[+ ![Watch a Demo](data:image/png;base64...)
    #### Watch a Demo

    See StackHawk in flight](/demo/)[+ ![Getting Started](data:image/png;base64...)
    #### Getting Started

    Gain AppSec insights from expert articles and fix guides](https://docs.stackhawk.com/getting-started/)
* Solutions![Caret Down](data:image/svg+xml;base64...)![API Discovery](data:image/png;base64...)
  ### API Discovery

  Find every API in your attack surface in 15 minutes. Quickly bring them under test with automated prioritization for the most critical APIs and gain complete oversight of your attack surface.

  [Get Started for Free![Right Arrow Icon](data:image/svg+xml;base64...)](https://auth.stackhawk.com/signup)
  ### Solutions

  [+ #### API Discovery

    Discover every API in your attack surface](/solutions/api-discovery/)[+ #### Oversight

    Centralized API & Application Security Management](/solutions/oversight/)[+ #### Modern DAST

    Automate application and API security testing in CI/CD workflows](/solutions/dast/)[+ #### Getting Started With AppSec

    Test early, test often, and deliver secure applications](/solutions/getting-started-with-appsec/)[+ #### DevSecOps

    Application security at the speed of DevOps](/solutions/devsecops/)[+ #### API Security Testing

    Ship secure APIs with automated testing in CI/CD](/solutions/api-security-testing/)[+ #### Developer-First AppSec

    Scale application security through engineering](/solutions/developer-centric-application-security/)[+ #### OWASP Top 10

    Testing for OWASP top 10, automated in CI/CD](/solutions/owasp-top-10/)[+ #### GraphQL Security Testing

    Check for GraphQL vulnerabilities on every pull request](/solutions/graphql-security-testing/)[+ #### gRPC Security Testing

    Keep your gRPC services secure with automated security testing](/solutions/gRPC/)
* Integrations![Caret Down](data:image/svg+xml;base64...)
  ### Integrate with your existing tools and workflows

  Purpose-built to integrate with the third-party tools, workflows, and processes in your developer environment.

  [See all integrations![Right Arrow Icon](data:image/svg+xml;base64...)](/integrations/)
  ### Integrations

  [+ ![GitHub](data:image/png;base64...)
    #### GitHub

    Integrate security testing in developer workflows ![Right Arrow Icon](data:image/svg+xml;base64...)](/github/)[+ ![Snyk](data:image/png;base64...)
    #### Snyk

    Correlate Dynamic DAST and SAST Results ![Right Arrow Icon](data:image/svg+xml;base64...)](/snyk/)[+ ![AWS](data:image/png;base64...)
    #### AWS

    Integrate into your AWS Environment ![Right Arrow Icon](data:image/svg+xml;base64...)](/partners/aws/)[+ ![Atlassian](data:image/png;base64...)
    #### Atlassian

    StackHawk data can be viewed in the new Security tab in Jira ![Right Arrow Icon](data:image/svg+xml;base64...)](/atlassian/)[+ ![Microsoft](data:image/svg+xml;base64...)
    #### Microsoft

    Integrate security testing in your Microsoft ecosystem ![Right Arrow Icon](data:image/svg+xml;base64...)](/partners/microsoft/)
* Customers![Caret Down](data:image/svg+xml;base64...)
  ### Our Hawksome Customers

  "With StackHawk, our scanning timeframes have decreased from days and hours to minutes."

  [Read More![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/)
  ### Explore Featured Stories

  [+ ![Change.org](data:image/svg+xml;base64...)

    Change.org Brings in Dev-First Security Solutions to Improve Security Posture ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/change-org/)[+ ![One Medical](data:image/svg+xml;base64...)

    One Medical Automates Application Security Testing with StackHawk ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/one-medical/)[+ ![Planetly](data:image/svg+xml;base64...)

    Planetly Selects StackHawk Over Building Internal Service ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/planetly/)[+ ![Breathe Life](data:image/svg+xml;base64...)

    Breathe Life Deploys StackHawk and Snyk for a Dev-Centric Application Security Program ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/breathe-life/)
* Docs![Caret Down](data:image/svg+xml;base64...)![StackHawk + GitHub](data:image/svg+xml;base64...)
  ### StackHawk + GitHub

  Begin your StackHawk journey to safer, faster, and more secure software.

  [Start the Tutorial![Right Arrow Icon](data:image/svg+xml;base64...)](https://docs.stackhawk.com/getting-started/javaspringvulny-gh-actions/intro.html#automate-tests-with-github-actions-tutorial)
  ### Hawkdocs

  [+ ![Getting Started](data:image/svg+xml;base64...)
    #### Getting Started

    Learn how to start scanning your application or API](https://docs.stackhawk.com/getting-started/)[+ ![StackHawk API](data:image/svg+xml;base64...)
    #### StackHawk API

    Explore the StackHawk API and start integrating today](https://apidocs.stackhawk.com/reference/createapplication)[+ ![Integrations](data:image/svg+xml;base64...)
    #### Integrations

    Integrate with the most popular developer tools](https://docs.stackhawk.com/workflow-integrations/)[+ ![StackHawk Platform](data:image/svg+xml;base64...)
    #### StackHawk Platform

    Identify, investigate, and triage security bugs in one place](https://docs.stackhawk.com/web-app/)[+ ![Authentication](data:image/svg+xml;base64...)
    #### Authentication

    Effectively scan authenticated routes and API endpoints in your application](https://docs.stackhawk.com/hawkscan/authenticated-scanning/)[Read More Docs![Right Arrow Icon](data:image/svg+xml;base64...)](https://docs.stackhawk.com/)
[* Pricing](/pricing/)* Resources![Caret Down](data:image/svg+xml;base64...)
  ##### BLOG

  ### Dynamic Application Security Testing: Overview and Tooling

  DAST is a form of testing running applications & APIs to find security bugs.

  [Read Now![Right Arrow Icon](data:image/svg+xml;base64...)](/blog/dynamic-application-security-testing-overview/)
  ### Resources

  [+ ![Maturity Model](data:image/png;base64...)
    #### Maturity Model

    The Shift-Left Maturity Model](/resources/shift-left-maturity-model/)[+ ![Watch a Demo](data:image/svg+xml;base64...)
    #### Watch a Demo

    See StackHawk in flight](/demo/)[+ ![Blog](data:image/svg+xml;base64...)
    #### Blog

    Gain AppSec insights from expert articles and fix guides](/blog/)[+ ![Getting Started](data:image/svg+xml;base64...)
    #### Getting Started

    Get up and running with StackHawk CLI and HawkScan in minutes](https://docs.stackhawk.com/getting-started/)[+ ![Press Room](data:image/svg+xml;base64...)
    #### Press Room

    Catch up on the latest news in the Nest](/press/)[+ ![About](data:image/svg+xml;base64...)
    #### About

    Kaakaww!! Meet the our Hawksome team and check out our job board](/about/)
[* Sign In](https://auth.stackhawk.com/login)[Start Free Trial](https://auth.stackhawk.com/signup)![Hamburger Icon](data:image/svg+xml;base64...)
# Rails Path Traversal Guide: Examples and Prevention

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![stackhawk]()![stackhawk](https://images.ctfassets.net/nx13ojx82pll/2tME18Zz0zJWJEELygWySD/e84e4bc45c8e5a516de565e9c48a680c/stackhawk.png?w=113&h=113&q=80&fm=png)

StackHawk|July 27, 2021

In this post, you'll learn what the path traversal vulnerability is and how to prevent it in the case of the Ruby on Rails application.

Cyberattacks are happening pretty much constantly these days. Even if you follow general security best practices, there are many language- and framework-specific vulnerabilities that attackers can try to exploit. One of these vulnerabilities is the so-called path traversal vulnerability.Â

In this post, you'll learn what the path traversal vulnerability is and how to prevent it in the case of the Ruby on Rails application.

## What's Path Traversal Vulnerability?

A path traversal vulnerability, sometimes also called a directory traversal attack, is a type of vulnerability that allows attackers to access files to which they shouldn't have access. For example, an attacker may try to access the **/etc/passwd** file on your host operating system.Â

This vulnerability happens when your web application doesn't properly validate the paths that the user is requesting. For now, we'll focus on path traversal in the context of the Rails framework.

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![Rails Path Traversal Guide: Examples and Prevention image]()![Rails Path Traversal Guide: Examples and Prevention image](https://images.ctfassets.net/nx13ojx82pll/15MMK9yDgRafrC8Wr20mXU/9b4ea4050cd72afddb19500ce01aceec/rails-path-traversal-guide-examples-and-prevention-picture-1.png?w=924&h=1164&q=80&fm=png)
## Path Traversal in Rails

In order to understand how path traversal can happen in Rails, we need to first understand how Rails handles paths in general. There are three most common ways of serving files in Rails.Â

First, we have assets pipeline files. These are all the CSS, JavaScript, and image files that Rails needs for rendering the HTML code. For example, your website logo is a good candidate to be in the assets directory. Anything that's there will have a Rails-generated path assigned. So you don't access these files directly (as in **www.example.com/assets/logo.jpg**), but you let Rails generate and use a path for you.Â

Next, we have the Rails public directory. This is a folder where you can put any file that you need to serve to clients. So, for example, if you need a **marketing1.jpg** file accessible as **www.example.com/marketing1.jpg**, you can just put it into the public directory. It's worth noting here that serving files from the public directory can be done by Rails itself but can also be offloaded to a web server (for example, [Apache](https://httpd.apache.org/) or [NGINX](https://www.nginx.com/)).Â

Lastly, we have dedicated libraries for serving images on your website. Depending on your Rails version, this could be handled by third-party libraries (such as [Paperclip](https://github.com/thoughtbot/paperclip) or [CarrierWave](https://github.com/carrierwaveuploader/carrierwave)) or, in the case of the latest Rails versions, natively by [Active Storage](https://edgeguides.rubyonrails.org/active_storage_overview.html).Â

Now, all of these different options for getting the path of a specific file will give you different results. And the possibility of a path traversal vulnerability differs for all of them. So let's get back to the topic of this post. What does the path traversal attack actually look like?

## Path Traversal

You know already that publicly available files in your Rails application are located in the same folder as the rest of your application. Our goal is to only show the users the files they're supposed to see. For instance, the contents of the public folder. But you wouldn't like users to see your Gemfile or environment configuration files.

Let's look at an example. When a user opens **www.example.com/example.jpg**, Rails looks for **example.jpg** in the **/app/public** folder. But just two directories higher is your Gemfile (**/Gemfile**).Â

So you want to avoid the situation where a user simply opens **www.example.com/../../Gemfile** and is able to see your Gemfile. That's path traversal vulnerability: the ability to manipulate a URL in order to read files that shouldn't be read. Fortunately, it's not that simple, and Rails, by default, protects you from such obvious misusages.Â

However, attackers can try different ways of forcing Rails to go up or down directories. For example, using URL-encoding characters:Â

`https://www.example.com/%2e%2e/%2e%2e/Gemfile`

**%2e** is a URL-encoded version of a dot ( . ); therefore, effectively we're asking for the same path as before: **../../Gemfile.** This is just an example. Fortunately, Rails will protect you from that too.Â

But while Rails is smart enough to protect you from most attempts, it's not bulletproof. So let's talk about preventing path traversal.

## Prevention

The good news is that because of the way Rails works (you barely write raw code but you use Rails methods and helpers), you don't need to do anything specific to protect yourself from path traversal vulnerability. As we mentioned before, commonly used methods in Rails already protect you from path traversal.Â

The problem may arise when you don't use native Rails path-generation mechanisms or you start generating paths from user input. So the most important prevention mechanism is to not build any custom path-handling logic yourself and use Rails-native methods instead.

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![Rails Path Traversal Guide: Examples and Prevention image]()![Rails Path Traversal Guide: Examples and Prevention image](https://images.ctfassets.net/nx13ojx82pll/4HAMBXzwPqitEcwWUZxBiR/6eb2291be4c6950b47c1ec94eae1fd17/rails-path-traversal-guide-examples-and-prevention-picture-2.png?w=1558&h=1038&q=80&fm=png)
### Vulnerable Rails

The bad news is some of the built-in Rails libraries or gems can have this vulnerability. One of the most common examples is [CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0130), found in actionpack.Â

On the other hand, if you're building a very custom application, you may find yourself in a situation where you need to, for example, integrate your application with some legacy system. Sometimes such integrations require you to handle files and directories on the file system in a non-Rails-native way.Â

### Watch Out for User Input

One of the best ways to create a path traversal vulnerability in your application is to directly use the user input as a variable for path generation. In many cases, this bypasses default Rails security mechanisms, allowing attackers to manipulate a path that you never intended them to.

If your use case requires getting user input for building a path, make sure to **validate and sanitize** that input before using it as a variable for path methods.

### Non-Root

Another good practice that can help you avoid a path traversal vulnerability is to run your application as a non-root user. In the case of a path traversal vulnerability, this will still allow attackers to get access to the application directory but will at least prevent them from accessing **/etc** or **/root** directories on your host machine.Â

### Gems

Last but not least: gems. We all love gems. They drastically simplify Ruby on Rails applications development. However, they can sometimes be buggy. While the most commonly used gems are safe (or at least patched quickly in case of a found vulnerability), you should be careful when installing gems that are really old or that haven't been updated for a long time and don't have much information about them on the internet. Sometimes it's better to write a little bit of extra code yourself instead of using a gem that was last updated 10 years ago.

## Summary

When it comes to the path traversal vulnerability, the bottom line is that it's a very exotic attack vector, and Rails, by default, protects you from it. However, that doesn't mean that you're safe and don't need to worry about it. By using user input without validation or when using very old Rails versions, you can still become compromised. Path traversal, in the worst-case scenario, can give an attacker full access to your machine (if, for example, they manage to read the private SSH key of the root user). Therefore, it's always a good idea to keep your Rails version up to date.Â

But even if you follow security best practices, there's always a chance that you'll leave one small vulnerable line of code or won't update your Rails in time. To avoid becoming exposed, you'd benefit from keeping security scanning as part of your CI/CD pipeline and having a continuous overview of your security posture. For that, you can use [StackHawk.](https://www.stackhawk.com/) It's a modern application security tool that can help you avoid not only path traversal but many other vulnerabilities too. And if you want to learn more about application security testing, feel free to read [this post](https://www.stackhawk.com/blog/dynamic-application-security-testing-overview/).Â

*This post was written by Dawid Ziolkowski.* [*Dawid*](https://medium.com/%40dawid.ziolkowski) *has 10 years of experience as a Network/System Engineer at the beginning, DevOps in between, Cloud Native Engineer recently. Heâs worked for an IT outsourcing company, a research institute, telco, a hosting company, and a consultancy company, so heâs gathered a lot of knowledge from different perspectives. Nowadays heâs helping companies move to cloud and/or redesign their infrastructure for a more Cloud Native approach.*

---

StackHawkÂ Â |Â Â July 27, 2021
#### Read More

[![](data:image/png;base64...)![Add AppSec to Your CircleCI Pipeline With the StackHawk Orb]()![Add AppSec to Your CircleCI Pipeline With the StackHawk Orb](https://images.ctfassets.net/nx13ojx82pll/1l6NnEXw6fDC4JMKmuMki3/516d829c0a2b15af29638cf23b814260/add-appsec-to-circle-ci-pipeline-thumbnail.png?w=704&h=252&q=100&fm=png)

Add AppSec to Your CircleCI Pipeline With the StackHawk Orb](/blog/add-appsec-to-circle-ci-pipeline/)[![](data:image/png;base64...)![Application Security is Broken. Here is How We Intend to Fix It.]()![Application Security is Broken. Here is How We Intend to Fix It.](https://images.ctfassets.net/nx13ojx82pll/6jDrn6T3XfilS5PE7D4xSD/40c9d679644758a59329957d9d898e7e/application-security-is-broken-thumbnail.png?w=704&h=252&q=100&fm=png)

Application Security is Broken. Here is How We Intend to Fix It.](/blog/application-security-is-broken/)[![](data:image/png;base64...)![Using StackHawk in GitLab Know Before You Go (Live)]()![Using StackHawk in GitLab Know Before You Go (Live)](https://images.ctfassets.net/nx13ojx82pll/7lFuyRreSjawJ34hP6T8cd/b92944668516f1cb2fc643db472b7e11/using-stackhawk-in-gitlab-know-before-you-go-live-thumbnail.png?w=704&h=252&q=100&fm=png)

Using StackHawk in GitLab Know Before You Go (Live)](/blog/using-stackhawk-in-gitlab-know-before-you-go-live/)![Open Source Stackhawk Logo](data:image/svg+xml;base64...)
#### Product

* [Overview](/product/)
* [Watch a Demo](/demo/)
* [Pricing](/pricing/)
* [Sign In](https://auth.stackhawk.com/signup)
#### Resources

* [Blog](/blog/)
* [Press Room](/press/)
* [Documentation](https://docs.stackhawk.com)
* [Getting Started](https://docs.stackhawk.com/getting-started/)
#### Company

* [Customers](/customers/)
* [Team](/about/#team)
* [Jobs](/jobs/)We're Hiring
* [Security](/security/)
#### Get In Touch

* [Contact Us](/contact/)
* hello@stackhawk.com
* StackHawk Inc.
  1580 N. Logan St Ste 660
  PMB 36969
  Denver, CO 80203
* Follow
* [Visit Stackhawk's X Account](https://twitter.com/stackhawk)[Visit Stackhawk's Linkedin Company Profile](https://www.linkedin.com/company/stackhawk/mycompany/)[Visit Stackhawk's Facebook Account](https://www.facebook.com/StackHawk/)[Visit Stackhawk's Github Account](https://github.com/kaakaww)

---

Â©2025 StackHawk Inc., All Rights Reserved

|[Terms](/terms-of-service/)|[Privacy](/privacy-policy/)|[Sitemap](/sitemap/)

Crafted in Colorado


