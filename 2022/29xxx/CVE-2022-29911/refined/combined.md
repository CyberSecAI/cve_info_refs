=== Content from www.mozilla.org_223a0e60_20250114_192242.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-16

## Security Vulnerabilities fixed in Firefox 100

Announced
May 3, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 100

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29910: Firefox for Android forgot HTTP Strict Transport Security settings](#CVE-2022-29910)

Reporter
Mark B
Impact
moderate
##### Description

When closed or sent to the background, Firefox for Android would not properly record and persist HSTS settings.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1757138](https://bugzilla.mozilla.org/show_bug.cgi?id=1757138)

#### [#CVE-2022-29915: Leaking cross-origin redirect through the Performance API](#CVE-2022-29915)

Reporter
Sohom Datta
Impact
low
##### Description

The Performance API did not properly hide the fact whether a request cross-origin resource has observed redirects.

##### References

* [Bug 1751678](https://bugzilla.mozilla.org/show_bug.cgi?id=1751678)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

#### [#CVE-2022-29918: Memory safety bugs fixed in Firefox 100](#CVE-2022-29918)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1744043%2C1747178%2C1753535%2C1754017%2C1755847%2C1756172%2C1757477%2C1758223%2C1760160%2C1761481%2C1761771)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d507fd06_20250114_192240.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1761981)
* [XML](/show_bug.cgi?ctype=xml&id=1761981)

Closed
[Bug 1761981](/show_bug.cgi?id=1761981)
(CVE-2022-29911)

Opened 3 years ago
Closed 3 years ago

# Firefox sandbox iframe can execute scripts without allow-scripts directive

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox sandbox iframe can execute scripts without allow-scripts directive

## Categories

### (Core :: DOM: Core & HTML, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

101 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 100+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 |  | wontfix |
| firefox99 |  | wontfix |
| firefox100 | + | fixed |
| firefox101 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: trungpaaa, Assigned: nika, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/65709f329b0590cdd3cdad74d0236285?d=mm&size=40)  [trungpaaa](/user_profile?user_id=703945)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

NeedInfo From:

 [nika](/user_profile?user_id=534482)

[2 years ago](#c26)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### ( [URL](https://marked.js.org/demo/?text=[click me](javascript%3Aalert(location)) "https://marked.js.org/demo/?text=[click me](javascript%3Aalert(location))") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[marked.js.org/demo/?text=[click me](j...](https://marked.js.org/demo/?text=[click me](javascript%3Aalert(location)) "https://marked.js.org/demo/?text=[click me](javascript%3Aalert(location))")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-26384](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank"), [CVE-2022-34468](/show_bug.cgi?id=1768537 "VERIFIED FIXED - CSP sandbox header without `allow-scripts` can be bypassed via retargeted javascript: URI")

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-29911

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1223588_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [in-testsuite](#a692133_578488 "3 years ago") | ? |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | in-testsuite | ? |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a1886371_553429 "3 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Bug 1761981, r=smaug!](/attachment.cgi?id=9270290)  [3 years ago](#c2)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c11 "3 years ago")  diannaS : [approval-mozilla-esr91+](#c13 "3 years ago")  tjr : [sec-approval+](#c5 "3 years ago") | [Details](/attachment.cgi?id=9270290&action=edit) | [Review](/attachment.cgi?id=9270290) |
| --- | --- | --- |
| [Bug 1761981 - tests, r=smaug!](/attachment.cgi?id=9270291)  [3 years ago](#c3)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9270291&action=edit) | [Review](/attachment.cgi?id=9270291) |
| [Bug 1761981 - fix unexpected-pass wpts, r=smaug!](/attachment.cgi?id=9271122)  [3 years ago](#c8)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9271122&action=edit) | [Review](/attachment.cgi?id=9271122) |
| [advisory.txt](/attachment.cgi?id=9274257)  [3 years ago](#c15)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   219 bytes, text/plain |  | [Details](/attachment.cgi?id=9274257&action=edit) |
| [advisory.txt](/attachment.cgi?id=9275792)  [3 years ago](#c19)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   233 bytes, text/plain |  | [Details](/attachment.cgi?id=9275792&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Trung Pham](/user_profile?user_id=703945)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1761981#c0)• 3 years ago |
|  | |

When an iframe with the sandbox attribute set to allow-same-origin and allow-top-navigation/allow-top-navigation-by-user-activation (the below snippet), the embedded document can execute the script in the context of the parent document when users click on a javascript URL even if the sandbox attribute does not contain the allow-scripts directive.

```
<iframe sandbox="allow-same-origin allow-top-navigation-by-user-activation" srcdoc="<a target='_top' href='javascript:alert(location)'>alert</a>">

```

While I understand that it's logical to allow the embedded document to change the top.location to a javascript URL in this case, it would break the sandbox protection and make it no more secure than not using the sandbox attribute at all (e.g the embedded document can remove the sandbox attribute or reload itself in a new iframe).

It seems Chromium and Safari don't allow this behavior. I also think that is a more reasonable approach because normal users wouldn't expect an iframe without the allow-scripts directive to execute arbitrary scripts.

I noticed the behavior when trying the live demo of a markdown library (<https://github.com/markedjs/marked>).

The untrusted HTML is sandboxed inside an iframe with the sandbox attribute set to "allow-same-origin allow-top-navigation-by-user-activation": [https://marked.js.org/demo/?text=[click](https://marked.js.org/demo/?text=%5Bclick) me](javascript%3Aalert(location))

The application basically does the following:

```
<iframe id="previewIframe" sandbox="allow-same-origin allow-top-navigation" srcdoc="<base target='_parent'>"></iframe>
<script>
        var parsedMarkdown = "<a href=javascript:alert(location)>click me</a>";
        previewIframe.addEventListener("load", function(){
                previewIframe.contentDocument.body.innerHTML = parsedMarkdown;
        });
</script>

```

This issue might be related to <https://bugzilla.mozilla.org/show_bug.cgi?id=785310>

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a3469_159069)• 3 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: SecurityProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a113501_1689)• 3 years ago |

URL: [https://marked.js.org/demo/?text=[cli...](https://marked.js.org/demo/?text=[click me](javascript%3Aalert(location)))

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1761981#c1)• 3 years ago |
|  | |

Nika: unfortunately the fix for [bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") missed this case (it's an existing window, so copying the sandbox state isn't appropriate). I bet you could target some other named frame as well, though that would only rarely be useful.

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(nika)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)See Also: → [CVE-2022-26384](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a170766_1689)• 3 years ago |

Component: DOM: Security → DOM: Core & HTML

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a175750_151147)• 3 years ago |

Assignee: nobody → nikaSeverity: -- → S2Priority: -- → P1

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1761981#c2)• 3 years ago |
|  | |

Attached file
[Bug 1761981, r=smaug!](attachment.cgi?id=9270290)
— [Details](attachment.cgi?id=9270290&action=edit)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1761981#c3)• 3 years ago |
|  | |

Attached file
[Bug 1761981 - tests, r=smaug!](attachment.cgi?id=9270291)
— [Details](attachment.cgi?id=9270291&action=edit)

Depends on D142596

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a192647_534482)• 3 years ago |

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1761981#c4)• 3 years ago |
|  | |

Comment on [attachment 9270290](/attachment.cgi?id=9270290 "Bug 1761981, r=smaug!") [[details]](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"), r=smaug!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch likely makes it fairly obvious to a familiar attacker what the issue might be, and the test paints a fairly clear bulls-eye on the issue. We may want to land the tests desperately.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I would expect that this patch directly applies to all branches which [bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") has been uplifted to.
* **How likely is this patch to cause regressions; how much testing does it need?**: I think it is fairly unlikely to cause regressions, as it's a fairly limited change.
[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: sec-approval?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a258916_534482)• 3 years ago |

[Attachment #9270291](/attachment.cgi?id=9270291&action=edit "Bug 1761981 - tests, r=smaug!") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a270279_75935)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1761981#c5)• 3 years ago |
|  | |

Comment on [attachment 9270290](/attachment.cgi?id=9270290 "Bug 1761981, r=smaug!") [[details]](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"), r=smaug!

Approved to land

[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1761981#c6)• 3 years ago |
|  | |

Comment on [attachment 9270291](/attachment.cgi?id=9270291 "Bug 1761981 - tests, r=smaug!") [[details]](/attachment.cgi?id=9270291&action=edit "Bug 1761981 - tests, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive") - tests, r=smaug!

Clearing sec-approval; we can land the test on or after May 16

[Attachment #9270291](/attachment.cgi?id=9270291&action=edit "Bug 1761981 - tests, r=smaug!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a692133_578488)• 3 years ago |

Flags: in-testsuite?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1761981#c7)• 3 years ago |
|  | |

Comment on [attachment 9270290](/attachment.cgi?id=9270290 "Bug 1761981, r=smaug!") [[details]](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"), r=smaug!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential iframe sandbox tag violation
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Fairly straightforward change already landed on Nightly
* **String changes made/needed**: N/A

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potential iframe sandbox tag violation
* **Fix Landed on Version**: 101
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Fairly straightforward change already landed on Nightly
[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: approval-mozilla-beta?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a702941_534482)• 3 years ago |

[Attachment #9270291](/attachment.cgi?id=9270291&action=edit "Bug 1761981 - tests, r=smaug!") -
Flags: approval-mozilla-beta?

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1761981#c8)• 3 years ago |
|  | |

Attached file
[Bug 1761981 - fix unexpected-pass wpts, r=smaug!](attachment.cgi?id=9271122)
— [Details](attachment.cgi?id=9271122&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1761981#c9)• 3 years ago |
|  | |

r=smaug

<https://hg.mozilla.org/integration/autoland/rev/3150596d4d85b114272cc68916b7fcd5220ee480>

<https://hg.mozilla.org/mozilla-central/rev/3150596d4d85>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 101 Branch

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1761981#c10)• 3 years ago |
|  | |

fix unexpected-pass wpts

<https://hg.mozilla.org/integration/autoland/rev/6ed148583fbc65aa43dd228137b3df115666b2cc>

<https://hg.mozilla.org/mozilla-central/rev/6ed148583fbc>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a775104_75935)• 3 years ago |

[Attachment #9270291](/attachment.cgi?id=9270291&action=edit "Bug 1761981 - tests, r=smaug!") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a776969_75935)• 3 years ago |

[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1761981#c11)• 3 years ago |
|  | |

Comment on [attachment 9270290](/attachment.cgi?id=9270290 "Bug 1761981, r=smaug!") [[details]](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"), r=smaug!

Approved for 100.0b3

[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1761981#c12)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/387aa3589869>

<https://hg.mozilla.org/releases/mozilla-beta/rev/534ced26118c>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a779272_690067)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a1223588_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1761981#c13)• 3 years ago |
|  | |

Comment on [attachment 9270290](/attachment.cgi?id=9270290 "Bug 1761981, r=smaug!") [[details]](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!")

[Bug 1761981](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"), r=smaug!

Approved for 91.9esr.

[Attachment #9270290](/attachment.cgi?id=9270290&action=edit "Bug 1761981, r=smaug!") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a1886371_553429)• 3 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1761981#c14)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/d7e099f6fc71ba0170d26243dccca08fb6267815>

<https://hg.mozilla.org/releases/mozilla-esr91/rev/ef64358e527c39caf3f301a76d1c8ce692e34131>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a2336913_690067)• 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a2580218_428608)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1761981#c15)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9274257) (obsolete)
— [Details](attachment.cgi?id=9274257&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a2656187_428608)• 3 years ago |

Alias: CVE-2022-29911

|  | [Trung Pham](/user_profile?user_id=703945)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1761981#c16)• 3 years ago |
|  | |

@freddy: someone asked me about this issue because they thought it was mistakenly treated as a bug.

`allow-top-navigation` and `allow-top-navigation-by-user-activation` directives are used to allow top-level navigations so "Firefox did not properly protect against top-level navigations" seems a bit confusing. Maybe It would be better to clarify that the bug could lead to script execution in violation of the sandbox (without `allow-scripts`).

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1761981#c17)• 3 years ago |
|  | |

Indeed, the advisory was a bit oddly formulated. I'm not sure if and how we can change advisory texts if they are incorrect. Tom, do you know?

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1761981#c18)• 3 years ago |
|  | |

Will touch base outside the bug.

Flags: needinfo?(tom)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1761981#c19)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9275792)
— [Details](attachment.cgi?id=9275792&action=edit)

[Attachment #9274257](/attachment.cgi?id=9274257&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a4336442_1689)• 3 years ago |

See Also: → [CVE-2022-34468](/show_bug.cgi?id=1768537 "VERIFIED FIXED - CSP sandbox header without `allow-scripts` can be bypassed via retargeted javascript: URI")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a6065383_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder 2022-05-16]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a6924183_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder 2022-05-16] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder-test 2022-05-16]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a25365976_1689)• 2 years ago |

Group: core-security-release

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1761981#c20)• 2 years ago |
|  | |

7 months ago, Tom Ritter [:tjr] placed a reminder on the bug using the whiteboard tag `[reminder-test 2022-05-16]` .

nika, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(nika)Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder-test 2022-05-16] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+][adv-esr91.9+]

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1761981#c21)• 2 years ago |
|  | |

I don't know why this reminder was added, redirecting the ni? back to :tjr

Flags: needinfo?(nika) → needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1761981#c22)• 2 years ago |
|  | |

It was to land <https://phabricator.services.mozilla.com/D142597>

Flags: needinfo?(tom)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1761981#c23)• 2 years ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #22](/show_bug.cgi?id=1761981#c22 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive"))

> It was to land <https://phabricator.services.mozilla.com/D142597>

Bouncing this back because it seems to have gotten lost again - I think the test still needs to land here. :-)

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a37428565_534482)• 2 years ago |

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1761981#c24)• 2 years ago |
|  | |

Rebased and set to land.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1761981#c25)• 2 years ago |
|  | |

Pushed by nlayzell@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/324defc46b66>
tests, r=smaug

|  | [Cosmin Sabou [:CosminS]](/user_profile?user_id=600699) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1761981#c26)• 2 years ago |
|  | |

Backed out for mochitest plain failures on test\_top\_navigation\_no\_script.html

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=324defc46b66e3f2c283992e92a564f89da77dae&selectedTaskRun=Mo7ICk5AQ82jaePfRJlahA.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=418164345&repo=autoland>

Backout link: <https://hg.mozilla.org/integration/autoland/rev/89697e87849d85931ae6281d4213a9ab882eabf2>

Flags: needinfo?(nika)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1761981#a68528267_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1761981&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_affb0dd0_20250114_192243.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-17

## Security Vulnerabilities fixed in Firefox ESR 91.9

Announced
May 3, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.9

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_6cb0cbee_20250114_192244.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-18

## Security Vulnerabilities fixed in Thunderbird 91.9

Announced
May 3, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-1520: Incorrect security status shown after viewing an attached email](#CVE-2022-1520)

Reporter
Thunderbird team
Impact
low
##### Description

When viewing an email message A, which contains an attached message B, where B is encrypted or digitally signed or both, Thunderbird may show an incorrect encryption or signature status. After opening and viewing the attached message B, when returning to the display of message A, the message A might be shown with the security status of message B.

##### References

* [Bug 1745019](https://bugzilla.mozilla.org/show_bug.cgi?id=1745019)

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Thunderbird would allow them to cover the fullscreen notification UI, which could enable browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could obtain permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Thunderbird would behave slightly differently for already known resources, when loading CSS resources through resolving CSS variables. This could be used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29913: Speech Synthesis feature not properly disabled](#CVE-2022-29913)

Reporter
Andrew McCreight
Impact
moderate
##### Description

The parent process would not properly check whether the Speech Synthesis feature is enabled, when receiving instructions from a child process.

##### References

* [Bug 1764778](https://bugzilla.mozilla.org/show_bug.cgi?id=1764778)

#### [#CVE-2022-29917: Memory safety bugs fixed in Thunderbird 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


