```
{
  "CVE-2022-29021": {
    "Root cause of vulnerability": "The `razer_attr_write_matrix_custom_frame` function in the `razerkbd` driver does not validate the size of the input buffer before copying it to the `arguments` buffer using `memcpy`. The size of the copy is determined by the `row_length` which is calculated based on user-controlled `start_col` and `stop_col` parameters. An attacker can provide values for these that will result in row_length exceeding the size of the destination buffer.",
    "Weaknesses/vulnerabilities present": [
      "Buffer Overflow: A buffer overflow exists in the `memcpy` operation within the `razer_chroma_extended_matrix_set_custom_frame2` function. The size of the copy is calculated based on user-provided input, without proper validation, leading to a potential overflow of the `report.arguments` buffer.",
        "Lack of input validation: The driver does not validate the size of the input buffer, row_length, before using it as the copy size in memcpy."

    ],
    "Impact of exploitation": "An attacker can cause a Denial-of-Service by crashing the driver. If the driver is not compiled with `FORTIFY_SOURCE` enabled, exploitation could lead to arbitrary code execution in the kernel by overwriting other data within memory after an information leak.",
    "Attack vectors": "A local attacker can write to the `/sys/bus/hid/devices/.../matrix_custom_frame` file with a crafted input, triggering the buffer overflow. The file is accessible to users with read and write permissions to the device file.",
    "Required attacker capabilities/position": "The attacker needs to have local access to the system and have read and write permissions to the sysfs file corresponding to the razerkbd device. This can be a regular unprivileged user."
  }
}
```