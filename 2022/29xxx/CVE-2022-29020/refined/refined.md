- **Root cause of vulnerability:** Lack of proper input sanitization when updating user profile pictures. Specifically, the application doesn't sanitize the URL provided for the profile picture, allowing malicious JavaScript code to be injected.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability. The application allows a user to inject arbitrary JavaScript code into their profile picture URL.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of other users' browsers when they view the profile with the malicious image URL. This can lead to various attacks, such as session hijacking, defacement, or redirection to malicious sites.
- **Attack vectors:** The attacker manipulates the profile picture URL when updating their profile settings, injecting a malicious payload like `1" onerror=alert('xss') class="1`.
- **Required attacker capabilities/position:** The attacker needs to be an authenticated user of the application with the ability to modify their profile settings, specifically the profile picture URL.