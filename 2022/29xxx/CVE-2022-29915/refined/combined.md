=== Content from www.mozilla.org_223a0e60_20250114_210046.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-16

## Security Vulnerabilities fixed in Firefox 100

Announced
May 3, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 100

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29910: Firefox for Android forgot HTTP Strict Transport Security settings](#CVE-2022-29910)

Reporter
Mark B
Impact
moderate
##### Description

When closed or sent to the background, Firefox for Android would not properly record and persist HSTS settings.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1757138](https://bugzilla.mozilla.org/show_bug.cgi?id=1757138)

#### [#CVE-2022-29915: Leaking cross-origin redirect through the Performance API](#CVE-2022-29915)

Reporter
Sohom Datta
Impact
low
##### Description

The Performance API did not properly hide the fact whether a request cross-origin resource has observed redirects.

##### References

* [Bug 1751678](https://bugzilla.mozilla.org/show_bug.cgi?id=1751678)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

#### [#CVE-2022-29918: Memory safety bugs fixed in Firefox 100](#CVE-2022-29918)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1744043%2C1747178%2C1753535%2C1754017%2C1755847%2C1756172%2C1757477%2C1758223%2C1760160%2C1761481%2C1761771)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_723b2b6d_20250114_210046.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1751678)
* [XML](/show_bug.cgi?ctype=xml&id=1751678)

Closed
[Bug 1751678](/show_bug.cgi?id=1751678)
(CVE-2022-29915)

Opened 3 years ago
Closed 3 years ago

# Detecting cross-origin redirects using the performance API

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Detecting cross-origin redirects using the performance API

## Categories

### (Core :: Performance, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Performance#Performance)

Performance
▾

Core :: Performance
User reports of Firefox performance issues, and bugs about Firefox performance issues where the correct component is not yet known.
The goal for bugs in this component is to identify the source of the performance issue, and to move the bug into the the right Bugzilla component where the fix needs to happen.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Performance&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Performance&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Performance)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

100 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 |  | wontfix |
| firefox99 |  | wontfix |
| firefox100 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dattasohom1, Assigned: sefeng)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/01ab6a1eb1221f51dab203ab8708be88?d=mm&size=40)  [dattasohom1](/user_profile?user_id=647404)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/3436c2d3cc76cfdad85dd8460e33b2d6?d=mm&size=40)  [fdoty](/user_profile?user_id=697742)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1754171](/show_bug.cgi?id=1754171 "RESOLVED DUPLICATE - Resource Timing values leak opaque response redirect status")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1754171](/show_bug.cgi?id=1754171 "RESOLVED DUPLICATE - Resource Timing values leak opaque response redirect status"), [CVE-2022-36316](/show_bug.cgi?id=1768583 "RESOLVED FIXED - Fetch requests with mode cors and credentials leak whether the request redirected or not via performanceAPI")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1290150 "https://bugs.chromium.org/p/chromium/issues/detail?id=1290150")

## Details

### (Keywords: privacy, reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-29915

[Keywords:](/describekeywords.cgi)

[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4956032_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a4976502_75935 "3 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [index.html](/attachment.cgi?id=9260357)  [3 years ago](#c0)  [Sohom Datta](/user_profile?user_id=647404)   1.00 KB, text/html |  | [Details](/attachment.cgi?id=9260357&action=edit) |
| --- | --- | --- |
| [Bug 1751678 - Make FetchStart uses StarTime when TAO check fails for PerformanceResourceTiming r=smaug](/attachment.cgi?id=9268265)  [3 years ago](#c6)  [Sean Feng [:sefeng]](/user_profile?user_id=625922)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9268265&action=edit) | [Review](/attachment.cgi?id=9268265) |
| [advisory.txt](/attachment.cgi?id=9274261)  [3 years ago](#c11)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   191 bytes, text/plain |  | [Details](/attachment.cgi?id=9274261&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Sohom Datta](/user_profile?user_id=647404)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1751678#c0)• 3 years ago |
|  | |

Attached file
[index.html](attachment.cgi?id=9260357)
— [Details](attachment.cgi?id=9260357&action=edit)

Found this while digging around while reporting a similar bug in Chrome. When advanced tracking protection is turned off, we can detect whether or not a cross-origin URL is a redirect using the difference of `performance.getEntriesByName(...)[0].fetchStart - performance.getEntriesByName(...)[0].startTime`.

Reproduction steps:

1. Download the attached index.html file.
2. Run a python HTTP server by running `python -m http.server` in the same directory as the index.html file.
3. Open <http://localhost:8000/index.html> in Firefox
4. Open the javascript console
5. <https://google.com> should be correctly identified as a redirect, whereas, <https://www.google.com> should be identified as a URL without a redirect.
Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a11198_159069)• 3 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Core & HTMLProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a21636_406194)• 3 years ago |

Summary: Decting cross-origin redirects using the performance API → Detecting cross-origin redirects using the performance API

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a24711_39966)• 3 years ago |

Component: DOM: Core & HTML → Performance

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1751678#c1)• 3 years ago |
|  | |

NI myself for taking a look

Flags: needinfo?(sefeng)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1751678#c2)• 3 years ago |
|  | |

Not sure what you mean by "advanced tracking protection is turned off"... is that just a typo for "enhanced" (ETP is disabled for the site) or do you mean it happens in "Standard" ETP as opposed to "strict" (advanced?) ETP? Odds are the first, but it's good to be clear.

Please let us know the link to the Chromium issue. I'm sure we can't see it if you've filed it as a security bug, but it's handy to be able to tie the issues later and double-check.

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(dattasohom1)Keywords: [privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Sohom Datta](/user_profile?user_id=647404)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1751678#c3)• 3 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #2](/show_bug.cgi?id=1751678#c2 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"))

> Not sure what you mean by "advanced tracking protection is turned off"... is that just a typo for "enhanced" (ETP is disabled for the site) or do you mean it happens in "Standard" ETP as opposed to "strict" (advanced?) ETP? Odds are the first, but it's good to be clear.

It was a typo for "Enhanced Tracking Protection" :)

That being said, I appear to have misinterpreted the following warning `Request to access cookie or storage on “<URL>” was blocked because it came from a tracker and content blocking is enabled.` as the PoC not working. The exploit detects redirects with ETP enabled also. ETP is probably blocking `'credential': 'include'` in my `index.html` PoC which caused the misunderstanding.

> Please let us know the link to the Chromium issue. I'm sure we can't see it if you've filed it as a security bug, but it's handy to be able to tie the issues later and double-check.

<https://bugs.chromium.org/p/chromium/issues/detail?id=1290150> is the bug (it is filed a security bug, yeah)

Flags: needinfo?(dattasohom1)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a1321908_406194)• 3 years ago |

See Also: → [1754171](/show_bug.cgi?id=1754171 "RESOLVED DUPLICATE - Resource Timing values leak opaque response redirect status")

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1751678#c4)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1751678&comment_id=15790373 "1 revision") |
|  | |

Chrome apparently landed a fix recently

[https://chromium.googlesource.com/chromium/src/+/e96b9f57d8d9e32bf9cb748524735d7903271755%5E%21/](https://chromium.googlesource.com/chromium/src/%2B/e96b9f57d8d9e32bf9cb748524735d7903271755%5E%21/)

That includes also some changes to a wpt, so perhaps we have even a test for this.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a2697634_39966)• 3 years ago |

Severity: -- → S3Priority: -- → P3

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1751678#c6)• 3 years ago |
|  | |

Attached file
[Bug 1751678 - Make FetchStart uses StarTime when TAO check fails for PerformanceResourceTiming r=smaug](attachment.cgi?id=9268265)
— [Details](attachment.cgi?id=9268265&action=edit)

Given the recent Fetch spec updates, Step 8.1 in

<https://fetch.spec.whatwg.org/#finalize-and-report-timing> specifies

that start time(StartTime) and post-redirect start time(FetchStart) should

be start time when TAO check fails.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4506261_600971)• 3 years ago |

Assignee: nobody → sefengStatus: NEW → ASSIGNED

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4506496_625922)• 3 years ago |

Flags: needinfo?(sefeng)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1751678#c7)• 3 years ago |
|  | |

Make FetchStart uses StarTime when TAO check fails for PerformanceResourceTiming r=smaug

<https://hg.mozilla.org/integration/autoland/rev/c02b29bea3fc334e7567776ea41a508eef74bdea>

<https://hg.mozilla.org/mozilla-central/rev/c02b29bea3fc>

Status: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 100 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4848564_578488)• 3 years ago |

[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4955775_1689)• 3 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1290150>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4956032_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a4976502_75935)• 3 years ago |

Group: dom-core-security → core-security-release
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Flags: in-testsuite+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a5529768_553429)• 3 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1751678#c8)• 3 years ago |
|  | |

I tried to reproduce the issue on Firefox 98.0a1 (2022-01-24), and got this response:

* <https://google.com/> is a redirect? index.html:10:25
* <https://www.google.com/> is not a redirect

On the latest Beta, 100.0b8, with the steps from [Comment 0](/show_bug.cgi?id=1751678#c0 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"), is displayed:

* <https://google.com/> is not a redirect index.html:13:25
* <https://www.google.com/> is not a redirect

From [Comment 0](/show_bug.cgi?id=1751678#c0 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"), it doesn't look like the expected result. Is there anything that I'm missing, or is this the expected behavior?

Flags: needinfo?(dattasohom1)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a7892215_75935)• 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)

|  | [Sohom Datta](/user_profile?user_id=647404)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1751678#c9)• 3 years ago |
|  | |

(In reply to Mihai Boldan, QA [:mboldan] from [comment #8](/show_bug.cgi?id=1751678#c8 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"))

> I tried to reproduce the issue on Firefox 98.0a1 (2022-01-24), and got this response:
>
> * <https://google.com/> is a redirect? index.html:10:25
> * <https://www.google.com/> is not a redirect
>
> On the latest Beta, 100.0b8, with the steps from [Comment 0](/show_bug.cgi?id=1751678#c0 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"), is displayed:
>
> * <https://google.com/> is not a redirect index.html:13:25
> * <https://www.google.com/> is not a redirect
>
> From [Comment 0](/show_bug.cgi?id=1751678#c0 "VERIFIED FIXED - Detecting cross-origin redirects using the performance API"), it doesn't look like the expected result. Is there anything that I'm missing, or is this the expected behavior?

That is the expected behaviour (being unable to detect if a redirect has occured in the newer version)

Flags: needinfo?(dattasohom1)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1751678#c10)• 3 years ago |
|  | |

Thanks Sohom Datta for the confirmation.

Based on the comments from above, I'm marking this issue as Verified Fixed.

Status: RESOLVED → VERIFIEDFlags: qe-verify+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a8037166_551058)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a8122609_428608)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main100+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1751678#c11)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9274261)
— [Details](attachment.cgi?id=9274261&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a8198007_428608)• 3 years ago |

Alias: CVE-2022-29915

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a9157669_159069)• 3 years ago |

See Also: → [CVE-2022-36316](/show_bug.cgi?id=1768583 "RESOLVED FIXED - Fetch requests with mode cors and credentials leak whether the request redirected or not via performanceAPI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a18643759_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1751678#a74069929_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1751678&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Sohom Datta](/user_profile?user_id=647404)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


