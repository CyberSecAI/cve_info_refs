=== Content from bugzilla.mozilla.org_04c1bd0f_20250115_091717.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1757138)
* [XML](/show_bug.cgi?ctype=xml&id=1757138)

Closed
[Bug 1757138](/show_bug.cgi?id=1757138)
(CVE-2022-29910)

Opened 3 years ago
Closed 3 years ago

# HSTS policy "forgotten" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

HSTS policy "forgotten" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)

## Categories

### (Core :: Security: PSM, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20PSM#Security%3A%20PSM)

Security: PSM
▾

Core :: Security: PSM
The TLS configuration layer between Gecko and NSS. Handles certificate discovery, verification, and revocation checking.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20PSM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20PSM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20PSM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

100 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 |  | wontfix |
| firefox99 |  | wontfix |
| firefox100 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mfburdett, Assigned: keeler)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [keeler](/user_profile?user_id=349244)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9f46cb0218527b061f5e28ebf81191ab?d=mm&size=40)  [mfburdett](/user_profile?user_id=331260)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [keeler](/user_profile?user_id=349244)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [psm-assigned][post-critsmash-triage][adv-main100+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-29910

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[psm-assigned][post-critsmash-triage][adv-main100+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [btot](/user_profile?user_id=553429) | [qe-verify](#a2780716_553429 "3 years ago") | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1757138 - atomically write DataStorage data and kick off a write when backgrounded r?agi!,jschanck!](/attachment.cgi?id=9267297)  [3 years ago](#c16)  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9267297&action=edit) | [Review](/attachment.cgi?id=9267297) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9274255)  [3 years ago](#c18)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   281 bytes, text/plain |  | [Details](/attachment.cgi?id=9274255&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mark burdett](/user_profile?user_id=331260)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1757138#c0)• 3 years ago |
|  | |

Steps to reproduce:

1. Navigate to <http://radio.indymedia.org> in Android Firefox 97.2.0 (Build #2015863827)
2. Navigate to <https://radio.indymedia.org> which has HSTS header (Strict-Transport-Security: max-age=63072000; includeSubDomains; preload)
3. At this point, HSTS appears to work (HTTP request directs to HTTPS)
4. Use other apps for a while or reboot phone
5. Return to Firefox and visit <http://radio.indymedia.org> and it loads; however the browser should have redirected me to <https://radio.indymedia.org>

Actual results:

HTTP website loaded again despite HSTS policy

Expected results:

Automatic redirect to HTTPS

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1757138#c1)• 3 years ago |
|  | |

Sounds like a platform problem. Sending to GV to evaluate if this is something they should handle or networking.

Component: Security: Android → GeneralProduct: Fenix → GeckoView

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1757138#c2)• 3 years ago |
|  | |

Dana, any guesses about what part of our Android browser might be responsible? Thanks.

Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1757138#c3)• 3 years ago |
|  | |

I would check if the `SiteSecurityServiceState.txt` file in the profile directory has an entry corresponding to that site. It only gets written out every 5 minutes and at shutdown, but if that doesn't happen, the data won't be saved.

Flags: needinfo?(dkeeler)

|  | [mark burdett](/user_profile?user_id=331260)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1757138#c4)• 3 years ago |
|  | |

Is there a procedure to view profile files such as SiteSecurityServiceState.txt on a non-rooted device? If so I could look at this file where I saw the issue.

Meanwhile I did some playing around in a rooted Android emulator device running Fennec F-Droid 97.1.1, and yes there are situations where the SiteSecurityServiceState.txt is not saved, e.g. when rebooting device or force quitting the app. Would it be possible to save the SiteSecurityServiceState.txt as soon as HSTS is encountered? Admittedly, this might only be an issue in edge cases like rebooting (unless there is some scenario like the file isn't saved due to power-saving preventing background tasks from running).

I also found another fairly minor edge case that if the site is not present in SiteSecurityServiceState.txt, then loading the HTTPS page from cache (the page had both HSTS header and Cache-Control header allowing caching) will not apply the HSTS policy; only when the HTTPS page is reloaded from the site will the HSTS policy will be applied. This leads to the unexpected situation where the page with HSTS policy is cached but the HSTS policy itself was lost.

|  | [Emily Toop (:fluffyemily)](/user_profile?user_id=540010) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1757138#c5)• 3 years ago |
|  | |

Agi, is there work that needs to be done in GV for this?

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1757138#c6)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #3](/show_bug.cgi?id=1757138#c3 "RESOLVED FIXED - HSTS policy \"forgotten\" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)"))

> I would check if the `SiteSecurityServiceState.txt` file in the profile directory has an entry corresponding to that site. It only gets written out every 5 minutes and at shutdown, but if that doesn't happen, the data won't be saved.

This... doesn't sound ideal on mobile. Our sessions can easily be shorter than 5 minutes and we don't have a shutdown hook. Dana is there any chance we could lower this timeout or hook it to an event that fires on mobile? `application-background` perhaps? <https://searchfox.org/mozilla-central/search?q=application-background&path=>

Flags: needinfo?(agi) → needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1757138#c7)• 3 years ago |
|  | |

Hooking it to an event would be difficult. We can shorten the timeout. What would you like it to be?

Flags: needinfo?(dkeeler)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1757138#c8)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #7](/show_bug.cgi?id=1757138#c7 "RESOLVED FIXED - HSTS policy \"forgotten\" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)"))

> Hooking it to an event would be difficult. We can shorten the timeout. What would you like it to be?

I would say 30s should be sufficient. I'm not sure if there's any specific trade-off.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1757138#c9)• 3 years ago |
|  | |

The trade-off is how often the platform writes out a 50-100K file. If it's okay to do that every 30s, then that's what we can do.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a1090107_1689)• 3 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1757138#c10)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #9](/show_bug.cgi?id=1757138#c9 "RESOLVED FIXED - HSTS policy \"forgotten\" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)"))

> The trade-off is how often the platform writes out a 50-100K file. If it's okay to do that every 30s, then that's what we can do.

I think that would be better than *not* writing it, but could you explain to me why it would be hard to handle `application-background` here: <https://searchfox.org/mozilla-central/source/security/manager/ssl/DataStorage.cpp#763-775>? it seems like it would be very similar to the existing block (minus the shutdown stuff).

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a1090768_421286)• 3 years ago |

Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1757138#c11)• 3 years ago |
|  | |

My initial thought was that we didn't have a straightforward way to ensure that the background task that writes the file runs before responding to the notification finishes, but since there's `TaskQueue::AwaitIdle()`, it seems like that should work (as long as we're okay with blocking the main thread? (and if we're not, then there's definitely no way to do this)).

Flags: needinfo?(dkeeler)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1757138#c12)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1757138&comment_id=15807610 "1 revision") |
|  | |

> My initial thought was that we didn't have a straightforward way to ensure that the background task that writes the file runs before responding to the notification finishes

I don't think we need that guarantee, a best effort to start writing to disk when we get the notification is enough. The last app to be active is always highly prioritized on Android, so the chance that we get killed immediately after receiving `application-background` is very low.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1757138#c13)• 3 years ago |
|  | |

Can the app still run when it's in the background? We don't want a half-written security state file - that would be worse than not adding new entries to it (we could lose existing entries).

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1757138#c14)• 3 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #13](/show_bug.cgi?id=1757138#c13 "RESOLVED FIXED - HSTS policy \"forgotten\" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)"))

> Can the app still run when it's in the background? We don't want a half-written security state file - that would be worse than not adding new entries to it (we could lose existing entries).

It can yes, but by being in the background the likelihood of being killed is higher than when in the foreground. Blocking `application-background` won't change that, by the time we get the notification we're already in the background (there is no way for an app to block being put in the background).

This is also a problem for saving the file on a timer, as I understand we're not really checking whether we're in foreground or not when the timer fires, so there is the possibility of being killed while writing the file.

The only way to avoid being killed (up to a reasonable point) is to display a blocking notification, which elevates the app to foreground priority, but this seems overkill for this case.

Could we make writing the file atomic? E.g. by creating a temp file and then renaming it for the real one when finished writing it?

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1757138#c15)• 3 years ago |
|  | |

(In reply to Agi Sferro | :agi | [slow ni? rn sorry] | ⏰ PST | he/him from [comment #14](/show_bug.cgi?id=1757138#c14 "RESOLVED FIXED - HSTS policy \"forgotten\" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)"))

> by the time we get the notification we're already in the background

Oh, I see. Well, I guess it doesn't matter, then.

> Could we make writing the file atomic? E.g. by creating a temp file and then renaming it for the real one when finished writing it?

Yeah that's probably a good idea anyway.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a1179060_349244)• 3 years ago |

Assignee: nobody → dkeelerGroup: mobile-core-security → core-securitySeverity: -- → S3Component: General → Security: PSMPriority: -- → P1Product: GeckoView → CoreWhiteboard: [psm-assigned]

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1757138#c16)• 3 years ago |
|  | |

Attached file
[Bug 1757138 - atomically write DataStorage data and kick off a write when backgrounded r?agi!,jschanck!](attachment.cgi?id=9267297)
— [Details](attachment.cgi?id=9267297&action=edit)

DataStorage writes should be atomic to avoid losing data if writing is

interrupted. Additionally, on mobile, if the app is backgrounded, it is more

likely to be killed, so an asynchronous write should be kicked off to hopefully

avoid losing data.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1757138#c17)• 3 years ago |
|  | |

atomically write DataStorage data and kick off a write when backgrounded r=agi,jschanck

<https://hg.mozilla.org/integration/autoland/rev/adf6bf264f34df3973456103341763ae5bd9c600>

<https://hg.mozilla.org/mozilla-central/rev/adf6bf264f34>

Group: core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 100 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a2220321_75935)• 3 years ago |

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a2780716_553429)• 3 years ago |

Flags: qe-verify+Whiteboard: [psm-assigned] → [psm-assigned][post-critsmash-triage]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a5366165_428608)• 3 years ago |

Summary: HSTS policy "forgotten" (HTTP request in next browsing session does not redirect to HTTPS) → HSTS policy "forgotten" on Firefox for Android (HTTP request in next browsing session does not redirect to HTTPS)Whiteboard: [psm-assigned][post-critsmash-triage] → [psm-assigned][post-critsmash-triage][adv-main100+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1757138#c18)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9274255)
— [Details](attachment.cgi?id=9274255&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a5442149_428608)• 3 years ago |

Alias: CVE-2022-29910

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757138#a15887959_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1757138&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_223a0e60_20250115_091718.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-16

## Security Vulnerabilities fixed in Firefox 100

Announced
May 3, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 100

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29910: Firefox for Android forgot HTTP Strict Transport Security settings](#CVE-2022-29910)

Reporter
Mark B
Impact
moderate
##### Description

When closed or sent to the background, Firefox for Android would not properly record and persist HSTS settings.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1757138](https://bugzilla.mozilla.org/show_bug.cgi?id=1757138)

#### [#CVE-2022-29915: Leaking cross-origin redirect through the Performance API](#CVE-2022-29915)

Reporter
Sohom Datta
Impact
low
##### Description

The Performance API did not properly hide the fact whether a request cross-origin resource has observed redirects.

##### References

* [Bug 1751678](https://bugzilla.mozilla.org/show_bug.cgi?id=1751678)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

#### [#CVE-2022-29918: Memory safety bugs fixed in Firefox 100](#CVE-2022-29918)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1744043%2C1747178%2C1753535%2C1754017%2C1755847%2C1756172%2C1757477%2C1758223%2C1760160%2C1761481%2C1761771)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


