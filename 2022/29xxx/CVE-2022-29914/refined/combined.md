=== Content from www.mozilla.org_6cb0cbee_20250114_204325.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-18

## Security Vulnerabilities fixed in Thunderbird 91.9

Announced
May 3, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-1520: Incorrect security status shown after viewing an attached email](#CVE-2022-1520)

Reporter
Thunderbird team
Impact
low
##### Description

When viewing an email message A, which contains an attached message B, where B is encrypted or digitally signed or both, Thunderbird may show an incorrect encryption or signature status. After opening and viewing the attached message B, when returning to the display of message A, the message A might be shown with the security status of message B.

##### References

* [Bug 1745019](https://bugzilla.mozilla.org/show_bug.cgi?id=1745019)

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Thunderbird would allow them to cover the fullscreen notification UI, which could enable browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could obtain permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Thunderbird would behave slightly differently for already known resources, when loading CSS resources through resolving CSS variables. This could be used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29913: Speech Synthesis feature not properly disabled](#CVE-2022-29913)

Reporter
Andrew McCreight
Impact
moderate
##### Description

The parent process would not properly check whether the Speech Synthesis feature is enabled, when receiving instructions from a child process.

##### References

* [Bug 1764778](https://bugzilla.mozilla.org/show_bug.cgi?id=1764778)

#### [#CVE-2022-29917: Memory safety bugs fixed in Thunderbird 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_223a0e60_20250114_204322.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-16

## Security Vulnerabilities fixed in Firefox 100

Announced
May 3, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 100

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29910: Firefox for Android forgot HTTP Strict Transport Security settings](#CVE-2022-29910)

Reporter
Mark B
Impact
moderate
##### Description

When closed or sent to the background, Firefox for Android would not properly record and persist HSTS settings.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1757138](https://bugzilla.mozilla.org/show_bug.cgi?id=1757138)

#### [#CVE-2022-29915: Leaking cross-origin redirect through the Performance API](#CVE-2022-29915)

Reporter
Sohom Datta
Impact
low
##### Description

The Performance API did not properly hide the fact whether a request cross-origin resource has observed redirects.

##### References

* [Bug 1751678](https://bugzilla.mozilla.org/show_bug.cgi?id=1751678)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

#### [#CVE-2022-29918: Memory safety bugs fixed in Firefox 100](#CVE-2022-29918)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1744043%2C1747178%2C1753535%2C1754017%2C1755847%2C1756172%2C1757477%2C1758223%2C1760160%2C1761481%2C1761771)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2c548fa5_20250114_204320.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1746448)
* [XML](/show_bug.cgi?ctype=xml&id=1746448)

Closed
[Bug 1746448](/show_bug.cgi?id=1746448)
(CVE-2022-29914)

Opened 3 years ago
Closed 3 years ago

# Reuse popup window using same windowName able to overlap fullscreen notification

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Reuse popup window using same windowName able to overlap fullscreen notification

## Categories

### (Core :: DOM: Core & HTML, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

101 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox99 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 100+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox99 |  | wontfix |
| firefox100 | + | verified |
| firefox101 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: edgar)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f65ba150a7cf6313efc23c96c9206cd8?d=mm&size=40)  [edgar](/user_profile?user_id=455480)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1764318](/show_bug.cgi?id=1764318 "RESOLVED FIXED - Add test for bug 1746448")

Dependency [tree](/showdependencytree.cgi?id=1746448&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1746448)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form][adv-main100+][adv-esr91.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-29914

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][adv-main100+][adv-esr91.9+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a11323342_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [reusepopup.html](/attachment.cgi?id=9255739)  [3 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   970 bytes, text/html |  | [Details](/attachment.cgi?id=9255739&action=edit) |
| --- | --- | --- |
| [Firefox - Reuse Popup to Overlap Fullscreen Notification.mp4](/attachment.cgi?id=9255741)  [3 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   154.22 KB, video/mp4 |  | [Details](/attachment.cgi?id=9255741&action=edit) |
| [PoC (make spoofDelay longer to have this work on non-Windows platforms)](/attachment.cgi?id=9256805)  [3 years ago](#c5)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.15 KB, text/html |  | [Details](/attachment.cgi?id=9256805&action=edit) |
| [Bug 1746448; r?smaug](/attachment.cgi?id=9271908)  [3 years ago](#c9)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c14 "3 years ago")  diannaS : [approval-mozilla-esr91+](#c16 "3 years ago")  tjr : [sec-approval+](#c11 "3 years ago") | [Details](/attachment.cgi?id=9271908&action=edit) | [Review](/attachment.cgi?id=9271908) |
| [advisory.txt](/attachment.cgi?id=9274260)  [3 years ago](#c19)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   204 bytes, text/plain |  | [Details](/attachment.cgi?id=9274260&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1746448#c0)• 3 years ago |
|  | |

Attached file
[reusepopup.html](attachment.cgi?id=9255739) (obsolete)
— [Details](attachment.cgi?id=9255739&action=edit)

After launching a popup in the same `windowName` Firefox will reuse the same popup window instead of launching a new one. Interestingly when combining this method with `requestFullscreen` the reused popup window able to show in top of the fullscreen notification.

Mozregression show it is regression of [Bug 1712038 - Exit fullscreen only when the focus change will raise the window](https://bugzilla.mozilla.org/show_bug.cgi?id=1712038). On the good build Firefox will exit the fullscreen with following console.warn `Exited fullscreen because a window was focused.`

## Steps to reproduce:

1. Visit attached reusepopup.html
2. Click "Launch Popup"
3. Click "Reuse Popup Spoof"
4. Fullscreen notification will be overlapped with reused popup window
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1746448#c1)• 3 years ago |
|  | |

Attached video
[Firefox - Reuse Popup to Overlap Fullscreen Notification.mp4](attachment.cgi?id=9255741)
— [Details](attachment.cgi?id=9255741&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a4653_159069)• 3 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Core & HTMLProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1746448#c2)• 3 years ago |
|  | |

I wasn't able to reproduce on OSX Nightly.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1746448#c3)• 3 years ago |
|  | |

Edgar, when you are back could you take a look? Thanks.

Flags: needinfo?(echen)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1746448#c4)• 3 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #2](/show_bug.cgi?id=1746448#c2 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"))

> I wasn't able to reproduce on OSX Nightly.

I able to reproduce this on Windows 11 and Arch Linux KDE, but on Ubuntu 21.01 it prevent the window stealing and show OS toast "Mozilla Firefox is ready" instead of switch to the child window.

I forgot to mention to click "Reuse Popup Spoof" in the main window instead of child window, therefore I will attach the revised testcase to hide the button in the child window.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1746448#c5)• 3 years ago |
|  | |

Attached file
[PoC (make spoofDelay longer to have this work on non-Windows platforms)](attachment.cgi?id=9256805)
— [Details](attachment.cgi?id=9256805&action=edit)

[Attachment #9255739](/attachment.cgi?id=9255739&action=edit "reusepopup.html") -
Attachment is obsolete: true

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1746448#c6)• 3 years ago |
|  | |

I could not reproduce on OSX, either, it seems somehow focus would switch back to the window that requests fullscreen on OSX.

I think the main point is that when the `window.open` would reuse the existing window, we don't check the user activation. Compared to Chrome, it blocks the `window.open` if there is no valid user activation (in this case, `requestFullscreen()` call consumes the transient user activation) even if an existing window is reused. I think we could just follow Chrome's behavior which also makes more sense.

Assignee: nobody → echenFlags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a1720358_455480)• 3 years ago |

Severity: -- → S2Priority: -- → P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a2960168_1689)• 3 years ago |

Summary: Reuse popup window using same windowName able to overlap fullscreen notification → Reuse popup window using same windowName able to overlap fullscreen notification (not on mac)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a2960246_1689)• 3 years ago |

Flags: needinfo?(dveditz)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1746448#c7)• 3 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #6](/show_bug.cgi?id=1746448#c6 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"))

> I think the main point is that when the `window.open` would reuse the existing window, we don't check the user activation. Compared to Chrome, it blocks the `window.open` if there is no valid user activation (in this case, `requestFullscreen()` call consumes the transient user activation) even if an existing window is reused. I think we could just follow Chrome's behavior which also makes more sense.

I checked the spec again, spec doesn't check the user activation if the existing window is reused, see <https://html.spec.whatwg.org/multipage/browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name>. And Safari doesn't check the user activation, either.

After a second thought, even we follow Chrome's behavior, the issue isn't fixed completely, a user could still bring the existing window foreground via `window.open` (if it is called within a valid user activation), so it seems we should exit fullscreen in this case instead. I also check Chrome and Safari, both of them exit fullscreen after `window.open` would bring an existing window foreground.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1746448#c8)• 3 years ago |
|  | |

There were two reasons I couldn't reproduce this on Mac:

1. I forgot I had disabled moveTo() and resizeTo() because they are used for evil (pref `dom.disable_window_move_resize`)
2. the spoofDelay was too short. When changed to the same as Windows it worked like Windows

> [We should] exit fullscreen after window.open would bring an existing window foreground.

Or exit fullscreen if window.open() is called, regardless of its effects. Also if any other window gets focus or is raised (we already do that, right?)

Eliciting two clicks isn't all that hard if you can catch the user's attention -- the first click is the bigger hurdle. This isn't as clean as previous ways to slip into fullscreen unnoticed, but I'm reluctantly calling it sec-high anyway because sec-moderate undersells it.

Flags: needinfo?(dveditz)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a9977482_1689)• 3 years ago |

Summary: Reuse popup window using same windowName able to overlap fullscreen notification (not on mac) → Reuse popup window using same windowName able to overlap fullscreen notification

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a9977562_1689)• 3 years ago |

[Attachment #9256805](/attachment.cgi?id=9256805&action=edit "PoC (make spoofDelay longer to have this work on non-Windows platforms)") -
Attachment description: reusepopup.html → PoC (make spoofDelay longer to have this work on non-Windows platforms)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1746448#c9)• 3 years ago |
|  | |

Attached file
[Bug 1746448; r?smaug](attachment.cgi?id=9271908)
— [Details](attachment.cgi?id=9271908&action=edit)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a10096029_455480)• 3 years ago |

Blocks: [1764318](/show_bug.cgi?id=1764318 "RESOLVED FIXED - Add test for bug 1746448")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1746448#c10)• 3 years ago |
|  | |

Comment on [attachment 9271908](/attachment.cgi?id=9271908 "Bug 1746448; r?smaug") [[details]](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug")

[Bug 1746448](/show_bug.cgi?id=1746448 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"); r?smaug

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch likely makes it obvious what the issue might be.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I would expect that this patch could apply to all branches directly.
* **How likely is this patch to cause regressions; how much testing does it need?**: I think it is unlikely to cause a regression, it only affect the case that `window.open` would reuse a existing window, and other browser behave the same.
[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1746448#c11)• 3 years ago |
|  | |

Comment on [attachment 9271908](/attachment.cgi?id=9271908 "Bug 1746448; r?smaug") [[details]](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug")

[Bug 1746448](/show_bug.cgi?id=1746448 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"); r?smaug

Approved to land and uplift

[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1746448#c12)• 3 years ago |
|  | |

r=smaug

<https://hg.mozilla.org/integration/autoland/rev/4a033d94dbf5eb85632c0ef649681689c3522c26>

<https://hg.mozilla.org/mozilla-central/rev/4a033d94dbf5>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 101 Branch

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1746448#c13)• 3 years ago |
|  | |

Comment on [attachment 9271908](/attachment.cgi?id=9271908 "Bug 1746448; r?smaug") [[details]](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug")

[Bug 1746448](/show_bug.cgi?id=1746448 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"); r?smaug

### Beta/Release Uplift Approval Request

* **User impact if declined**: Fullscreen notification might be hidden by a popup window and user might be spoofed.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Follows the STR in <https://bugzilla.mozilla.org/show_bug.cgi?id=1746448#c0>.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I think it is unlikely to cause a regression, it only affect the case that window.open would reuse a existing window, and other browser behave the same.
* **String changes made/needed**: None

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: Fullscreen notification might be hidden by a popup window and user might be spoofed.
* **Fix Landed on Version**: 101
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I think it is unlikely to cause a regression, it only affect the case that window.open would reuse a existing window, and other browser behave the same.
[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: approval-mozilla-esr91?
[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: approval-mozilla-beta?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a10869549_455480)• 3 years ago |

Flags: qe-verify+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1746448#c14)• 3 years ago |
|  | |

Comment on [attachment 9271908](/attachment.cgi?id=9271908 "Bug 1746448; r?smaug") [[details]](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug")

[Bug 1746448](/show_bug.cgi?id=1746448 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"); r?smaug

Approved for 100.0b9

[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1746448#c15)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/f9e8783bbbed>

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a11218501_75935)• 3 years ago |

[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)
[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1746448#c16)• 3 years ago |
|  | |

Comment on [attachment 9271908](/attachment.cgi?id=9271908 "Bug 1746448; r?smaug") [[details]](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug")

[Bug 1746448](/show_bug.cgi?id=1746448 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"); r?smaug

Approved for 91.9esr

[Attachment #9271908](/attachment.cgi?id=9271908&action=edit "Bug 1746448; r?smaug") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1746448#c17)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/de5f87f2171d>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a11289781_500622)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a11323342_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1746448#c18)• 3 years ago |
|  | |

I've managed to reproduce this bug using STR from [comment 0](/show_bug.cgi?id=1746448#c0 "VERIFIED FIXED - Reuse popup window using same windowName able to overlap fullscreen notification"), on Ubuntu 18.04 x64 and Win 11 (on an affected Nightly build, 97.0a1, 20211206215435).

The issue is verified as fixed on the latest builds: 91.9.0 Esr, 100.0 Release and 101.0a1 Nightly

Status: RESOLVED → VERIFIED
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a11470845_428608)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form][adv-main100+][adv-esr91.9+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1746448#c19)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9274260)
— [Details](attachment.cgi?id=9274260&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a11546502_428608)• 3 years ago |

Alias: CVE-2022-29914

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a34256244_1689)• 2 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a38174815_1689)• 2 years ago |

See Also: → [CVE-2023-37207](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746448#a77418369_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1746448&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_affb0dd0_20250114_204323.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-17

## Security Vulnerabilities fixed in Firefox ESR 91.9

Announced
May 3, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.9

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


