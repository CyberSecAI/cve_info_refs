The provided content relates to CVE-2022-29780.

**Root cause of vulnerability:**
The vulnerability stems from an issue in the `njs_array_prototype_sort` function within the njs library. Specifically, the issue arises when the size of the array is modified within the comparison function used by `Array.prototype.sort()`. This occurs because the sorting algorithm does not handle changes to the array length during comparison, leading to an out-of-bounds write during the `memcpy` operation in the sort function.

**Weaknesses/vulnerabilities present:**
- The core weakness lies in the `njs_array_prototype_sort` function's lack of proper handling of array length modifications within the comparator function. The vulnerability occurs in the `memcpy` function that is used during the array sorting process.

**Impact of exploitation:**
- The impact of this vulnerability is a segmentation fault (SEGV) due to a write memory access violation. This can lead to denial of service conditions.

**Attack vectors:**
- The attack vector is through JavaScript code that uses the `Array.prototype.sort()` method with a comparison function that alters the length of the array being sorted.

**Required attacker capabilities/position:**
- The attacker needs to be able to execute JavaScript code that can utilize the vulnerable function. The attacker does not necessarily need access to the underlying system. They can exploit this vulnerability by having code executed by a server using the vulnerable njs library.

**Additional details:**
The provided information includes a Proof of Concept (PoC) that demonstrates the vulnerability and a stack trace showing the crash. The code change in commit `8b39afd` addresses the issue by adding a check (`njs_is_fast_array(this)`) to ensure that the fast path optimization within the `njs_array_prototype_sort` function is not taken if the array is no longer considered a fast array.