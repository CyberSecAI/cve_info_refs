=== Content from github.com_0b501662_20250114_204737.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Fgithub-action-merge-dependabot%2Fcommit%2F309f39539c5d918d8a47075587aa8720a9c127f7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Fgithub-action-merge-dependabot%2Fcommit%2F309f39539c5d918d8a47075587aa8720a9c127f7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fastify%2Fgithub-action-merge-dependabot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fastify](/fastify)
/
**[github-action-merge-dependabot](/fastify/github-action-merge-dependabot)**
Public

* [Notifications](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot)
* [Star
   161](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot)

* [Code](/fastify/github-action-merge-dependabot)
* [Issues
  9](/fastify/github-action-merge-dependabot/issues)
* [Pull requests
  3](/fastify/github-action-merge-dependabot/pulls)
* [Actions](/fastify/github-action-merge-dependabot/actions)
* [Security](/fastify/github-action-merge-dependabot/security)
* [Insights](/fastify/github-action-merge-dependabot/pulse)

Additional navigation options

* [Code](/fastify/github-action-merge-dependabot)
* [Issues](/fastify/github-action-merge-dependabot/issues)
* [Pull requests](/fastify/github-action-merge-dependabot/pulls)
* [Actions](/fastify/github-action-merge-dependabot/actions)
* [Security](/fastify/github-action-merge-dependabot/security)
* [Insights](/fastify/github-action-merge-dependabot/pulse)

## Commit

[Permalink](/fastify/github-action-merge-dependabot/commit/309f39539c5d918d8a47075587aa8720a9c127f7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-v5vr-h3xq-8v6w](https://github.com/fastify/github-action-merge-dependabot/security/advisories/GHSA-v5vr-h3xq-8v6w "GHSA-v5vr-h3xq-8v6w")

[Browse files](/fastify/github-action-merge-dependabot/tree/309f39539c5d918d8a47075587aa8720a9c127f7)
Browse the repository at this point in the history

```
* fix: add pr commit author check

* chore: update prettier settings

* chore: update prettier settings

* feat: add verify commit signatures

* chore: revert prettier

* test: add action test

* refactor: remove commits fallback

* test: add verify test

* feat: add spawn gpg

* Fixing PR comments: Moved import from func to global; Iterate with hwp; Added GPG information to ReadMe

* Removing Key from files

* Fixing node_modules

* different approach to validating the commit. Checking that the commit is verified, the author is dependabot[bot], the committer is GitHub

* Adding fixes to tests

* Fix for the tests

* eslint, naming and removal of magic text

* chore: formatting

* Refactored tests

* Removed unecessary async function. Iterating through very small amounts of commits.Renamed file for consistency

* removed unecessary dependency

Co-authored-by: marceloFerreira90 <marcelo.ferreira@nearform.com>
Co-authored-by: marceloFerreira90 <marcyff2@gmail.com>
Co-authored-by: Simone Busoli <simone.busoli@gmail.com>
```

* Loading branch information

[![@ianlnf](https://avatars.githubusercontent.com/u/102812633?s=40&v=4)](/ianlnf) [![@marceloFerreira90](https://avatars.githubusercontent.com/u/63242303?s=40&v=4)](/marceloFerreira90) [![@simoneb](https://avatars.githubusercontent.com/u/20181?s=40&v=4)](/simoneb)

4 people

authored
May 26, 2022

1 parent
[15c528e](/fastify/github-action-merge-dependabot/commit/15c528e680ed5843e5f9cde6c46e60212c075150)

commit 309f395

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**797 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dist

  + dist/105.index.js
    [105.index.js](#diff-7d2342db71bc1cca253c22dbdd2b126103b22306a77c75fe146aee445419be9a)
  + dist/index.js
    [index.js](#diff-3d2b59189eeedc2d428ddd632e97658fe310f587f7cb63b01f9b98ffc11c0197)
* src

  + src/action.js
    [action.js](#diff-3eff2eb784c259a70aa99b331bdf2de36ef13b78240a7789e3e530e0f639f817)
  + src/getDependabotDetails.js
    [getDependabotDetails.js](#diff-9a82d1a62fcaafe275d41ccaa8879cbd658619ea07627195760420f5ca56c7c6)
  + src/github-client.js
    [github-client.js](#diff-50bb836a72a49f164b145b8c7c76fe6b45d66b6c55f434b010c1e1f898cd2510)
  + src/verifyCommitSignatures.js
    [verifyCommitSignatures.js](#diff-318d12571e5aca27e845b0368a3128e54c6f065ecb0d3cd53a154b6cd8ee0331)
* test

  + test/action.test.js
    [action.test.js](#diff-a366808112af47ed7a3c234972ff8cf7a22dbf2ef43e4df1f9da96fb1ec62e65)
  + test/github-client.test.js
    [github-client.test.js](#diff-5656afbb67a52f279e037a81673de76900e17823c5472b746c8fcaf3c084a13a)
  + test/verifyCommitSignatures.test.js
    [verifyCommitSignatures.test.js](#diff-fbb3f7b1a61ff09b31fb6f694392e1be2623dc2de503d718a46eafd94c88e3b3)

## There are no files selected for viewing

315 changes: 315 additions & 0 deletions

315
[dist/105.index.js](#diff-7d2342db71bc1cca253c22dbdd2b126103b22306a77c75fe146aee445419be9a "dist/105.index.js")

Show comments

[View file](/fastify/github-action-merge-dependabot/blob/309f39539c5d918d8a47075587aa8720a9c127f7/dist/105.index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,315 @@ |
|  |  | "use strict"; |
|  |  | exports.id = 105; |
|  |  | exports.ids = [105]; |
|  |  | exports.modules = { |
|  |  |  |
|  |  | /\*\*\*/ 8770: |
|  |  | /\*\*\*/ ((module, \_\_unused\_webpack\_exports, \_\_webpack\_require\_\_) => { |
|  |  |  |
|  |  |  |
|  |  | const fs = \_\_webpack\_require\_\_(7147); |
|  |  | const os = \_\_webpack\_require\_\_(2037); |
|  |  |  |
|  |  | const tempDirectorySymbol = Symbol.for('\_\_RESOLVED\_TEMP\_DIRECTORY\_\_'); |
|  |  |  |
|  |  | if (!global[tempDirectorySymbol]) { |
|  |  | Object.defineProperty(global, tempDirectorySymbol, { |
|  |  | value: fs.realpathSync(os.tmpdir()) |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | module.exports = global[tempDirectorySymbol]; |
|  |  |  |
|  |  |  |
|  |  | /\*\*\*/ }), |
|  |  |  |
|  |  | /\*\*\*/ 4105: |
|  |  | /\*\*\*/ ((\_\_unused\_webpack\_\_\_webpack\_module\_\_, \_\_webpack\_exports\_\_, \_\_webpack\_require\_\_) => { |
|  |  |  |
|  |  | // ESM COMPAT FLAG |
|  |  | \_\_webpack\_require\_\_.r(\_\_webpack\_exports\_\_); |
|  |  |  |
|  |  | // EXPORTS |
|  |  | \_\_webpack\_require\_\_.d(\_\_webpack\_exports\_\_, { |
|  |  | "rootTemporaryDirectory": () => (/\* reexport \*/ temp\_dir), |
|  |  | "temporaryDirectory": () => (/\* binding \*/ temporaryDirectory), |
|  |  | "temporaryDirectoryTask": () => (/\* binding \*/ temporaryDirectoryTask), |
|  |  | "temporaryFile": () => (/\* binding \*/ temporaryFile), |
|  |  | "temporaryFileTask": () => (/\* binding \*/ temporaryFileTask), |
|  |  | "temporaryWrite": () => (/\* binding \*/ temporaryWrite), |
|  |  | "temporaryWriteSync": () => (/\* binding \*/ temporaryWriteSync), |
|  |  | "temporaryWriteTask": () => (/\* binding \*/ temporaryWriteTask) |
|  |  | }); |
|  |  |  |
|  |  | // EXTERNAL MODULE: external "node:fs" |
|  |  | var external\_node\_fs\_ = \_\_webpack\_require\_\_(7561); |
|  |  | // EXTERNAL MODULE: external "node:fs/promises" |
|  |  | var promises\_ = \_\_webpack\_require\_\_(3977); |
|  |  | // EXTERNAL MODULE: external "node:path" |
|  |  | var external\_node\_path\_ = \_\_webpack\_require\_\_(9411); |
|  |  | // EXTERNAL MODULE: external "node:stream" |
|  |  | var external\_node\_stream\_ = \_\_webpack\_require\_\_(4492); |
|  |  | // EXTERNAL MODULE: external "node:util" |
|  |  | var external\_node\_util\_ = \_\_webpack\_require\_\_(7261); |
|  |  | // EXTERNAL MODULE: external "util" |
|  |  | var external\_util\_ = \_\_webpack\_require\_\_(3837); |
|  |  | // EXTERNAL MODULE: external "crypto" |
|  |  | var external\_crypto\_ = \_\_webpack\_require\_\_(6113); |
|  |  | ;// CONCATENATED MODULE: ./node\_modules/crypto-random-string/index.js |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | const randomBytesAsync = (0,external\_util\_.promisify)(external\_crypto\_.randomBytes); |
|  |  |  |
|  |  | const urlSafeCharacters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-.\_~'.split(''); |
|  |  | const numericCharacters = '0123456789'.split(''); |
|  |  | const distinguishableCharacters = 'CDEHKMPRTUWXY012458'.split(''); |
|  |  | const asciiPrintableCharacters = '!"#$%&\'()\*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^\_`abcdefghijklmnopqrstuvwxyz{|}~'.split(''); |
|  |  | const alphanumericCharacters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'.split(''); |
|  |  |  |
|  |  | const generateForCustomCharacters = (length, characters) => { |
|  |  | // Generating entropy is faster than complex math operations, so we use the simplest way |
|  |  | const characterCount = characters.length; |
|  |  | const maxValidSelector = (Math.floor(0x10000 / characterCount) \* characterCount) - 1; // Using values above this will ruin distribution when using modular division |
|  |  | const entropyLength = 2 \* Math.ceil(1.1 \* length); // Generating a bit more than required so chances we need more than one pass will be really low |
|  |  | let string = ''; |
|  |  | let stringLength = 0; |
|  |  |  |
|  |  | while (stringLength < length) { // In case we had many bad values, which may happen for character sets of size above 0x8000 but close to it |
|  |  | const entropy = external\_crypto\_.randomBytes(entropyLength); |
|  |  | let entropyPosition = 0; |
|  |  |  |
|  |  | while (entropyPosition < entropyLength && stringLength < length) { |
|  |  | const entropyValue = entropy.readUInt16LE(entropyPosition); |
|  |  | entropyPosition += 2; |
|  |  | if (entropyValue > maxValidSelector) { // Skip values which will ruin distribution when using modular division |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | string += characters[entropyValue % characterCount]; |
|  |  | stringLength++; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return string; |
|  |  | }; |
|  |  |  |
|  |  | const generateForCustomCharactersAsync = async (length, characters) => { |
|  |  | // Generating entropy is faster than complex math operations, so we use the simplest way |
|  |  | const characterCount = characters.length; |
|  |  | const maxValidSelector = (Math.floor(0x10000 / characterCount) \* characterCount) - 1; // Using values above this will ruin distribution when using modular division |
|  |  | const entropyLength = 2 \* Math.ceil(1.1 \* length); // Generating a bit more than required so chances we need more than one pass will be really low |
|  |  | let string = ''; |
|  |  | let stringLength = 0; |
|  |  |  |
|  |  | while (stringLength < length) { // In case we had many bad values, which may happen for character sets of size above 0x8000 but close to it |
|  |  | const entropy = await randomBytesAsync(entropyLength); // eslint-disable-line no-await-in-loop |
|  |  | let entropyPosition = 0; |
|  |  |  |
|  |  | while (entropyPosition < entropyLength && stringLength < length) { |
|  |  | const entropyValue = entropy.readUInt16LE(entropyPosition); |
|  |  | entropyPosition += 2; |
|  |  | if (entropyValue > maxValidSelector) { // Skip values which will ruin distribution when using modular division |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | string += characters[entropyValue % characterCount]; |
|  |  | stringLength++; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return string; |
|  |  | }; |
|  |  |  |
|  |  | const generateRandomBytes = (byteLength, type, length) => external\_crypto\_.randomBytes(byteLength).toString(type).slice(0, length); |
|  |  |  |
|  |  | const generateRandomBytesAsync = async (byteLength, type, length) => { |
|  |  | const buffer = await randomBytesAsync(byteLength); |
|  |  | return buffer.toString(type).slice(0, length); |
|  |  | }; |
|  |  |  |
|  |  | const allowedTypes = new Set([ |
|  |  | undefined, |
|  |  | 'hex', |
|  |  | 'base64', |
|  |  | 'url-safe', |
|  |  | 'numeric', |
|  |  | 'distinguishable', |
|  |  | 'ascii-printable', |
|  |  | 'alphanumeric' |
|  |  | ]); |
|  |  |  |
|  |  | const createGenerator = (generateForCustomCharacters, generateRandomBytes) => ({length, type, characters}) => { |
|  |  | if (!(length >= 0 && Number.isFinite(length))) { |
|  |  | throw new TypeError('Expected a `length` to be a non-negative finite number'); |
|  |  | } |
|  |  |  |
|  |  | if (type !== undefined && characters !== undefined) { |
|  |  | throw new TypeError('Expected either `type` or `characters`'); |
|  |  | } |
|  |  |  |
|  |  | if (characters !== undefined && typeof characters !== 'string') { |
|  |  | throw new TypeError('Expected `characters` to be string'); |
|  |  | } |
|  |  |  |
|  |  | if (!allowedTypes.has(type)) { |
|  |  | throw new TypeError(`Unknown type: ${type}`); |
|  |  | } |
|  |  |  |
|  |  | if (type === undefined && characters === undefined) { |
|  |  | type = 'hex'; |
|  |  | } |
|  |  |  |
|  |  | if (type === 'hex' || (type === undefined && characters === undefined)) { |
|  |  | return generateRandomBytes(Math.ceil(length \* 0.5), 'hex', length); // Need 0.5 byte entropy per character |
|  |  | } |
|  |  |  |
|  |  | if (type === 'base64') { |
|  |  | return generateRandomBytes(Math.ceil(length \* 0.75), 'base64', length); // Need 0.75 byte of entropy per character |
|  |  | } |
|  |  |  |
|  |  | if (type === 'url-safe') { |
|  |  | return generateForCustomCharacters(length, urlSafeCharacters); |
|  |  | } |
|  |  |  |
|  |  | if (type === 'numeric') { |
|  |  | return generateForCustomCharacters(length, numericCharacters); |
|  |  | } |
|  |  |  |
|  |  | if (type === 'distinguishable') { |
|  |  | return generateForCustomCharacters(length, distinguishableCharacters); |
|  |  | } |
|  |  |  |
|  |  | if (type === 'ascii-printable') { |
|  |  | return generateForCustomCharacters(length, asciiPrintableCharacters); |
|  |  | } |
|  |  |  |
|  |  | if (type === 'alphanumeric') { |
|  |  | return generateForCustomCharacters(length, alphanumericCharacters); |
|  |  | } |
|  |  |  |
|  |  | if (characters.length === 0) { |
|  |  | throw new TypeError('Expected `characters` string length to be greater than or equal to 1'); |
|  |  | } |
|  |  |  |
|  |  | if (characters.length > 0x10000) { |
|  |  | throw new TypeError('Expected `characters` string length to be less or equal to 65536'); |
|  |  | } |
|  |  |  |
|  |  | return generateForCustomCharacters(length, characters.split('')); |
|  |  | }; |
|  |  |  |
|  |  | const cryptoRandomString = createGenerator(generateForCustomCharacters, generateRandomBytes); |
|  |  |  |
|  |  | cryptoRandomString.async = createGenerator(generateForCustomCharactersAsync, generateRandomBytesAsync); |
|  |  |  |
|  |  | /\* harmony default export \*/ const crypto\_random\_string = (cryptoRandomString); |
|  |  |  |
|  |  | ;// CONCATENATED MODULE: ./node\_modules/unique-string/index.js |
|  |  |  |
|  |  |  |
|  |  | function uniqueString() { |
|  |  | return crypto\_random\_string({length: 32}); |
|  |  | } |
|  |  |  |
|  |  | // EXTERNAL MODULE: ./node\_modules/temp-dir/index.js |
|  |  | var temp\_dir = \_\_webpack\_require\_\_(8770); |
|  |  | ;// CONCATENATED MODULE: ./node\_modules/tempy/node\_modules/is-stream/index.js |
|  |  | function isStream(stream) { |
|  |  | return stream !== null |
|  |  | && typeof stream === 'object' |
|  |  | && typeof stream.pipe === 'function'; |
|  |  | } |
|  |  |  |
|  |  | function isWritableStream(stream) { |
|  |  | return isStream(stream) |
|  |  | && stream.writable !== false |
|  |  | && typeof stream.\_write === 'function' |
|  |  | && typeof stream.\_writableState === 'object'; |
|  |  | } |
|  |  |  |
|  |  | function isReadableStream(stream) { |
|  |  | return isStream(stream) |
|  |  | && stream.readable !== false |
|  |  | && typeof stream.\_read === 'function' |
|  |  | && typeof stream.\_readableState === 'object'; |
|  |  | } |
|  |  |  |
|  |  | function isDuplexStream(stream) { |
|  |  | return isWritableStream(stream) |
|  |  | && isReadableStream(stream); |
|  |  | } |
|  |  |  |
|  |  | function isTransformStream(stream) { |
|  |  | return isDuplexStream(stream) |
|  |  | && typeof stream.\_transform === 'function'; |
|  |  | } |
|  |  |  |
|  |  | ;// CONCATENATED MODULE: ./node\_modules/tempy/index.js |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | const pipeline = (0,external\_node\_util\_.promisify)(external\_node\_stream\_.pipeline); // TODO: Use `node:stream/promises` when targeting Node.js 16. |
|  |  |  |
|  |  | const getPath = (prefix = '') => external\_node\_path\_.join(temp\_dir, prefix + uniqueString()); |
|  |  |  |
|  |  | const writeStream = async (filePath, data) => pipeline(data, external\_node\_fs\_.createWriteStream(filePath)); |
|  |  |  |
|  |  | async function runTask(temporaryPath, callback) { |
|  |  | try { |
|  |  | return await callback(temporaryPath); |
|  |  | } finally { |
|  |  | await promises\_.rm(temporaryPath, {recursive: true, force: true}); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function temporaryFile({name, extension} = {}) { |
|  |  | if (name) { |
|  |  | if (extension !== undefined && extension !== null) { |
|  |  | throw new Error('The `name` and `extension` options are mutually exclusive'); |
|  |  | } |
|  |  |  |
|  |  | return external\_node\_path\_.join(temporaryDirectory(), name); |
|  |  | } |
|  |  |  |
|  |  | return getPath() + (extension === undefined || extension === null ? '' : '.' + extension.replace(/^\./, '')); |
|  |  | } |
|  |  |  |
|  |  | const temporaryFileTask = async (callback, options) => runTask(temporaryFile(options), callback); |
|  |  |  |
|  |  | function temporaryDirectory({prefix = ''} = {}) { |
|  |  | const directory = getPath(prefix); |
|  |  | external\_node\_fs\_.mkdirSync(directory); |
|  |  | return directory; |
|  |  | } |
|  |  |  |
|  |  | const temporaryDirectoryTask = async (callback, options) => runTask(temporaryDirectory(options), callback); |
|  |  |  |
|  |  | async function temporaryWrite(fileContent, options) { |
|  |  | const filename = temporaryFile(options); |
|  |  | const write = isStream(fileContent) ? writeStream : promises\_.writeFile; |
|  |  | await write(filename, fileContent); |
|  |  | return filename; |
|  |  | } |
|  |  |  |
|  |  | const temporaryWriteTask = async (fileContent, callback, options) => runTask(await temporaryWrite(fileContent, options), callback); |
|  |  |  |
|  |  | function temporaryWriteSync(fileContent, options) { |
|  |  | const filename = temporaryFile(options); |
|  |  | external\_node\_fs\_.writeFileSync(filename, fileContent); |
|  |  | return filename; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | /\*\*\*/ }) |
|  |  |  |
|  |  | }; |
|  |  | ; |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `309f395`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Fgithub-action-merge-dependabot%2Fcommit%2F309f39539c5d918d8a47075587aa8720a9c127f7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1089644a_20250114_204738.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Fgithub-action-merge-dependabot%2Fsecurity%2Fadvisories%2FGHSA-v5vr-h3xq-8v6w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Fgithub-action-merge-dependabot%2Fsecurity%2Fadvisories%2FGHSA-v5vr-h3xq-8v6w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=fastify%2Fgithub-action-merge-dependabot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fastify](/fastify)
/
**[github-action-merge-dependabot](/fastify/github-action-merge-dependabot)**
Public

* [Notifications](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot)
* [Star
   161](/login?return_to=%2Ffastify%2Fgithub-action-merge-dependabot)

* [Code](/fastify/github-action-merge-dependabot)
* [Issues
  9](/fastify/github-action-merge-dependabot/issues)
* [Pull requests
  3](/fastify/github-action-merge-dependabot/pulls)
* [Actions](/fastify/github-action-merge-dependabot/actions)
* [Security](/fastify/github-action-merge-dependabot/security)
* [Insights](/fastify/github-action-merge-dependabot/pulse)

Additional navigation options

* [Code](/fastify/github-action-merge-dependabot)
* [Issues](/fastify/github-action-merge-dependabot/issues)
* [Pull requests](/fastify/github-action-merge-dependabot/pulls)
* [Actions](/fastify/github-action-merge-dependabot/actions)
* [Security](/fastify/github-action-merge-dependabot/security)
* [Insights](/fastify/github-action-merge-dependabot/pulse)

# No verification of commits origin in dependabot PR

Moderate

[simoneb](/simoneb)
published
GHSA-v5vr-h3xq-8v6w
May 27, 2022

## Package

 github-action-merge-dependabot
(github-actions)

## Affected versions

<=3.1.5

## Patched versions

3.2.0

## Description

### Impact

github-action-merge-dependabot does not check if a the commit created by dependabot is verified with the proper gpg key. There is just a check if the actor is set to dependabot[bot] to determine if the pr is a legit PR. Theoretically an owner of a seemingly valid and legit action in the pipeline can check if the PR is created by dependabot and if his own action has enough permissions to modify the PR in the pipeline. If so, he can modify the PR by adding a second seemingly valid and legit commit to the PR, as you can set arbitrarily the username and email in for commits in git. As the bot only checks if the actor is valid, it would pass the malicious changes through and merge it automatically, without getting noticed by project maintainers. Probably it would be not possible to determine where the malicious commit came in the first place, as it would only say "dependabot[bot" and the corresponding email-address.

In my opinion actions should be not trusted and auto merging PRs should be as safe as possible

### Patches

*Has the problem been patched? What versions should users upgrade to?*

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

### References

<https://hackerone.com/bugs?report_id=1564530>

### Severity

Moderate

### CVE ID

CVE-2022-29220

### Weaknesses

[CWE-283](/advisories?query=cwe%3A283)

### Credits

* [![@Uzlopak](https://avatars.githubusercontent.com/u/5059100?s=40&v=4)](/Uzlopak)
  [Uzlopak](/Uzlopak)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


