```
{
  "vulnerability": {
    "root_cause": "The vulnerability arises from the lack of proper validation of resource handles provided by users in eager mode operations. When an empty resource handle is supplied, it leads to a null pointer dereference within the TensorFlow codebase.",
    "weaknesses": [
      "Missing input validation",
      "Null pointer dereference"
    ],
    "impact": "Undefined behavior, which can include crashes or other unexpected program behavior. In the specific example provided, using an empty list as a resource handle in `tf.raw_ops.QueueIsClosedV2(handle=[])` or an empty tuple as a resource handle in `tf.summary.flush(writer=())` would trigger the vulnerability.",
    "attack_vectors": "The vulnerability is triggered through API calls in eager mode with invalid resource handles. Specifically, providing an empty list or tuple as a resource handle to operations like `tf.raw_ops.QueueIsClosedV2` or `tf.summary.flush` can trigger the issue.",
    "required_attacker_capabilities": "An attacker needs the ability to execute TensorFlow operations with user-controlled resource handles. This generally means the attacker is in control of the program's input or can manipulate the program state such that the resource handles passed to these operations are invalid."
  },
  "affected_versions": [
    "Versions prior to 2.9.0"
  ],
  "patched_versions": [
    "2.6.4",
    "2.7.2",
    "2.8.1",
    "2.9.0"
  ],
  "additional_notes": "The issue was introduced by the migration to TF 2.x eager mode. In graph mode, these calls would have been impossible. The fix involves adding a check to ensure that the resource handles are not empty and return an error when an empty handle is provided. Patches were applied to the mentioned versions, and a more detailed fix was applied in commit `a5b89cd68c02329d793356bda85d079e9e69b4e7`. In `tf.summary.flush` the fix was applied in commit `dbdd98c37bc25249e8f288bd30d01e118a7b4498`"
}
```