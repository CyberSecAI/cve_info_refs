- **Root cause of vulnerability**: The `util_set_serial_mac` function constructs a command using `vsnprintf` with a user-supplied string from the `serial` parameter. This command is then passed to `popen` for execution, leading to OS command injection.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78) due to insufficient sanitization of user-supplied input in the `serial` parameter before being used in a system command.
- **Impact of exploitation**: Arbitrary command execution as root on the affected device. This could lead to complete compromise of the device.
- **Attack vectors**: An attacker can send a crafted HTTP POST request to the `/action/factorySerialMacPost` endpoint with a malicious `serial` parameter.
- **Required attacker capabilities/position**: The attacker needs network access to the vulnerable device and the ability to send HTTP requests. Authentication is not required to access the vulnerable endpoint, due to a prior vulnerability (TALOS-2022-1554).