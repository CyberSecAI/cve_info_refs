```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from the server assuming that the uncompressed length provided by the user is correct during LZ4 decompression of CQL frames. If the user provides a fake length greater than the real one, the decompression buffer will not be fully overwritten, leaving part of it uninitialized.",
    "weaknesses": [
      "The server does not properly validate the user-provided uncompressed length before decompression.",
      "The server returns an incorrect size of the decompressed buffer, leading to undefined behavior."
    ],
    "impact": "This vulnerability can be exploited for authentication bypass or information disclosure, potentially leading to unauthorized access and sensitive data leaks. Specifically:\n\n1.  An attacker without a user account can bypass authentication if other clients are using LZ4 compression.\n2.  An attacker with an existing user account can read parts of uninitialized memory containing other users' passwords or fragments of queries/results, leading to authorization bypass and sensitive information disclosure.",
    "attack_vectors": [
      "Network: The vulnerability is triggered by sending a crafted CQL frame to the server over the network.",
      "Exploitation can occur through the CQL port if the attacker is able to make a connection."
    ],
    "attacker_capabilities": "An attacker requires network access to the CQL port. For authentication bypass, the attacker does not need a user account. For authorization bypass and information disclosure, the attacker needs a user account with access to the CQL port. In both scenarios, an ability to manipulate the uncompressed size during decompression is also required."
  },
  "affected_versions": {
    "Scylla Enterprise": [
      "< 2020.1",
      "2020.1.x < 2020.1.14",
      "2021.1.x < 2021.1.12"
    ],
    "Scylla OSS": [
      "<= 4.5",
      "4.6.x < 4.6.7",
      "5.0.x < 5.0.3"
    ]
  },
    "fixed_versions": {
    "Scylla Enterprise": [
      "2020.1.14",
      "2021.1.12",
      "2022.1.0"
     ],
    "Scylla OSS": [
     "4.6.7",
      "5.0.3"
    ]
  },
  "cvss_metrics": {
    "attack_vector": "Network",
    "attack_complexity": "High",
    "privileges_required": "None",
    "user_interaction": "None",
    "scope": "Unchanged",
    "confidentiality": "High",
    "integrity": "High",
    "availability": "High",
        "base_score": 8.1,
    "vector_string": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
  }
}
```