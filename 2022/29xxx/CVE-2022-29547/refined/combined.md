=== Content from phabricator.wikimedia.org_5b6e8c66_20250115_091140.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT306174)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T306174
# add to extension supplement for CreateRedirect Auth issues (CVE-2022-29547)Closed, Resolved[Public](/policy/explain/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/view/)Actions

* [Edit Task](/maniphest/task/edit/306174/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/306174/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Protect as security issue](/wmf/escalate-task/306174/)
* [Award Token](/token/give/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)
* [Flag For Later](/flag/edit/PHID-TASK-p3h7ry6cfnf7bsr6m2mm/)

Assigned To

|  | [sbassett](/p/sbassett/) |
| --- | --- |

Authored By

|  | [RhinosF1](/p/RhinosF1/) |
| --- | --- |
| Apr 14 2022, 11:13 AM2022-04-14 11:13:01 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Vuln-MissingAuthz](/tag/vuln-missingauthz/) [(Tracked)](/project/board/1343/)
* [MediaWiki-extensions-CreateRedirect](/tag/mediawiki-extensions-createredirect/)
* [User-RhinosF1](/tag/user-rhinosf1/) [(Done)](/project/board/4159/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [edwardspec](/p/edwardspec/) |
| --- | --- |

|  | [Reception123](/p/Reception123/) |
| --- | --- |

|  | [RhinosF1](/p/RhinosF1/) |
| --- | --- |

|  | [Samwilson](/p/Samwilson/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

Making public since was reported public and pushed through gerrit.

Please request a CVE & add to next supplement for the issues reported in [https://www.mediawiki.org/wiki/Extension\_talk:CreateRedirect](https://www.mediawiki.org/wiki/Extension_talk%3ACreateRedirect) & <https://phabricator.miraheze.org/T9061> that were fixed with [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/+/780567](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/%2B/780567)

This extension had insufficient permissions checks.

# Related Objects

* Mentions

Mentioned In [T305209: Write and send supplementary release announcement for extensions and skins with security patches (1.35.7/1.37.3/1.38.2)](/T305209) Mentioned Here [T305209: Write and send supplementary release announcement for extensions and skins with security patches (1.35.7/1.37.3/1.38.2)](/T305209)
### Event Timeline

[RhinosF1](/p/RhinosF1/) created this task.[Apr 14 2022, 11:13 AM2022-04-14 11:13:01 (UTC+0)](#7854872)Restricted Application added a project: [User-RhinosF1](/tag/user-rhinosf1/).  · [View Herald Transcript](/herald/transcript/4721207/)[Apr 14 2022, 11:13 AM2022-04-14 11:13:02 (UTC+0)](#7854882)Restricted Application added subscribers: [Reception123](/p/Reception123/), [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/4721207/)[dmehus](/p/dmehus/) moved this task from [Radar](/project/board/4159/) to [Miraheze-Linked](/project/board/4159/) on the [User-RhinosF1](/tag/user-rhinosf1/) board.[Apr 17 2022, 4:38 AM2022-04-17 04:38:37 (UTC+0)](#7859573)[sbassett](/p/sbassett/) mentioned this in [T305209: Write and send supplementary release announcement for extensions and skins with security patches (1.35.7/1.37.3/1.38.2)](/T305209).[Apr 18 2022, 4:12 PM2022-04-18 16:12:01 (UTC+0)](#7861347)[sbassett](/p/sbassett/) closed this task as Resolved.[Apr 18 2022, 4:27 PM2022-04-18 16:27:53 (UTC+0)](#7861434)[sbassett](/p/sbassett/) claimed this task.[sbassett](/p/sbassett/) added a project: [SecTeam-Processed](/tag/secteam-processed/).[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[sbassett](/p/sbassett/) subscribed.Comment Actions

Hey [@RhinosF1](/p/RhinosF1/) -

I've got this tracked for the next supplemental security release here: [T305209](/T305209). We'll plan to request a CVE for it by the end of this quarter (June 2022) though if anybody else would like to handle that sooner, that's fine. Looks like the backports are all merged as well, so that's good. I'm going to resolve this for now since I don't believe there's anything else actionable at this time.

[Maintenance\_bot](/p/Maintenance_bot/) moved this task from [Miraheze-Linked](/project/board/4159/) to [Done](/project/board/4159/) on the [User-RhinosF1](/tag/user-rhinosf1/) board.[Apr 18 2022, 4:29 PM2022-04-18 16:29:29 (UTC+0)](#7861450)[RhinosF1](/p/RhinosF1/) added a comment.[Apr 18 2022, 4:30 PM2022-04-18 16:30:28 (UTC+0)](#7861455)Comment Actions

That's fine. I'm only used to GitHub's CVE process. If there's anyway we can help you, do let me know.

[sbassett](/p/sbassett/) added a comment.Edited · [Apr 18 2022, 5:12 PM2022-04-18 17:12:09 (UTC+0)](#7861603)Comment Actions
> In [T306174#7861455](/T306174#7861455), [@RhinosF1](/p/RhinosF1/) wrote:
>
> That's fine. I'm only used to GitHub's CVE process. If there's anyway we can help you, do let me know.

tbh, the [Security-Team](/tag/security-team/) typically just uses <https://cveform.mitre.org/>. We had talked about becoming a [CNA](https://www.cve.org/ProgramOrganization/CNAs) at one point, but never did.

[RhinosF1](/p/RhinosF1/) renamed this task from Request CVE & add to extension supplement for CreateRedirect Auth issues to add to extension supplement for CreateRedirect Auth issues (CVE-REQUESTED).[Apr 18 2022, 5:22 PM2022-04-18 17:22:10 (UTC+0)](#7861626)[RhinosF1](/p/RhinosF1/) added a comment.[Apr 18 2022, 5:28 PM2022-04-18 17:28:05 (UTC+0)](#7861635)Comment Actions

Mitre ref CVE Request 1252146 for CVE ID Request

[RhinosF1](/p/RhinosF1/) renamed this task from add to extension supplement for CreateRedirect Auth issues (CVE-REQUESTED) to add to extension supplement for CreateRedirect Auth issues (CVE-2022-29547).[Apr 21 2022, 5:57 AM2022-04-21 05:57:31 (UTC+0)](#7870269)Comment Actions

[@sbassett](/p/sbassett/): assigned

[Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_9664b584_20250115_091136.html ===




=== Content from phabricator.miraheze.org_14f9bc98_20250115_091138.html ===
Page Menu[HomeMiraheze](/)

* SearchConfigure Global Search

[Log In](https://issue-tracker.miraheze.org/auth/start/?next=%2FT9061)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T9061
# CreateRedirect has weak (no?) permissions checksClosed, Resolved[Public](/policy/explain/PHID-TASK-6zrwl6oftsiskuyhmsvc/view/)Actions

* [Edit Task](/maniphest/task/edit/9061/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/9061/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Flag For Later](/flag/edit/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
* [Award Token](/token/give/PHID-TASK-6zrwl6oftsiskuyhmsvc/)

Assigned To

|  | Unknown Object (User) |
| --- | --- |

Authored By

|  | [Dmehus](/p/Dmehus/) |
| --- | --- |
| Apr 11 2022, 02:422022-04-11 02:42:13 (UTC+0) |

Tags

* [Security](/tag/security/) [(Backlog)](/project/board/58/)
* [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) [(Short Term)](/project/board/62/)
* [Trust & Safety](/tag/trust_safety/) [(External)](/project/board/67/)
* [Extensions](/tag/extensions/) [(Security Review Needed)](/project/board/17/)
Referenced FilesNoneSubscribers

|  | [Dmehus](/p/Dmehus/) |
| --- | --- |

|  | [John](/p/John/) |
| --- | --- |

|  | [Lens0021](/p/Lens0021/) |
| --- | --- |

|  | [Majavah](/p/Majavah/) |
| --- | --- |

|  | [• Naleksuh](/p/Naleksuh/) |
| --- | --- |

|  | [Owen](/p/Owen/) |
| --- | --- |

|  | [Raidarr](/p/Raidarr/) |
| --- | --- |

[View All 11 Subscribers](/subscriptions/list/PHID-TASK-6zrwl6oftsiskuyhmsvc/)
# Description

**Wiki(s) affected:** wikiweewiki (for now; to be added as discovered and confirmed)

**Issue:** [This global block](https://wikiwee.miraheze.org/wiki/Special%3AContributions/148.74.235.89), despite being not only a block of anonymous users but logged in users as well, has **no effect** on the LTA's ability to edit on the wiki today. For greater clarity, this LTA is the same LTA that discovered a bug with the [CreateWiki](/tag/createwiki/) extension and was able to overwrite certain data in certain wiki request columns until the bug was patched ([T9018](/T9018))

I had a Wikimedia Steward (AmandaNP) and [@Agent\_Isai](/p/Agent_Isai/) check the Special:ListGroupRights and Special:Version special pages with me to see if I missed anything glaringly obvious. ipblock-exempt is not assigned to \* nor was that IP address locally whitelisted, so doesn't appear to be the case. This Miraheze LTA is also globally blocked on the Wikimedia network of wikis as crosswiki abuse.

In addition, I also double-checked via the CheckUser extension on that wiki to see if the XFF header information was *different* than the blocked IP. It was not.

It would not surprise me and [@Agent\_Isai](/p/Agent_Isai/) in the least if the LTA has discovered a new bug with the [GlobalBlocking](https://www.mediawiki.org/wiki/Extension%3AGlobalBlocking#Configuration) extension, but I wanted to check with the MediaWiki SRE team to confirm there are no configuration issues with Miraheze's configuration:

1. Is $wgApplyGlobalBlocks set to true, correctly, on *all* Miraheze wikis except for metawiki?
2. Is $wgGlobalBlockingBlockXFF set to true or false? If the *latter*, as a Steward, I would certainly endorse setting this to true
3. Does every wiki have a globalblocking SQL table or have we specified a different SQL table via $wgGlobalBlockingDatabase and have all database users been given the following permissions, SELECT, UPDATE, INSERT, DELETE, at *minimum*?
4. Are there any other identifiable configuration errors?

If no issues with the above points, are there any other known or unknown extension conflicts that could be giving us grief and causing an issue? My initial thought focused on [this extension](https://www.mediawiki.org/wiki/Extension%3ANewSignupPage). No particular reason, other than I'd not seen it and noticed that Bukkit (no need to add him to this task, please) had granted the bypasstoscheck user right to the founder group but mainly because of the extension's interactions with **Special:CreateAccount**.

A thorough and rigorous extension conflict check should be done, if possible.

Finally, if *still* nothing, can you provide additional details useful for raising a GlobalBlocking bug report to Wikimedia?

Thanks so much! :)

# Revisions and Commits

| [R9 MediaWiki configuration](/source/mediawiki-configuration/) | | | |
| --- | --- | --- | --- |
|  | R9:78d689240eff [T9061: disable create redirect](/R9%3A78d689240eff685378a53fb602798dabf56b9ac2) |

# Related Objects

* Mentions

Mentioned In [R9:78d689240eff: T9061: disable create redirect](/R9%3A78d689240eff685378a53fb602798dabf56b9ac2) Mentioned Here [T1140: Request for New Extensions for calexitwiki](/T1140)
[T9018: POST request does not check registered status for RequestWiki comments](/T9018)
### Event Timeline

[Dmehus](/p/Dmehus/) created this task.[Apr 11 2022, 02:422022-04-11 02:42:13 (UTC+0)](#183434)[Dmehus](/p/Dmehus/) triaged this task as High priority.[Herald](/herald/) added subscribers: Unknown Object (User), [RhinosF1](/p/RhinosF1/), [Void](/p/Void/), [Reception123](/p/Reception123/).  · [View Herald Transcript](/herald/transcript/116492/)[Apr 11 2022, 02:422022-04-11 02:42:13 (UTC+0)](#183443)

[Dmehus](/p/Dmehus/) added a subscriber: [Raidarr](/p/Raidarr/).Edited · [Apr 11 2022, 02:442022-04-11 02:44:17 (UTC+0)](#183444)Comment Actions

Adding [@Raidarr](/p/Raidarr/) this way since I can't added him via the "Change subscribers" field

Unknown Object (User) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-hd4bebj4rh4n6x3/)".[Apr 11 2022, 02:462022-04-11 02:46:09 (UTC+0)](#183446)Unknown Object (User) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-pckkj322okglk3v/)".[Dmehus](/p/Dmehus/) renamed this task from Investigate why global block for 148.74.235.89 not effective on `wikiweewiki` to Investigate why global block for 148.74.235.89 not effective on wikiweewiki.[Apr 11 2022, 02:472022-04-11 02:47:36 (UTC+0)](#183448)[Dmehus](/p/Dmehus/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-g57pbm2h2bizfdm/)[Dmehus](/p/Dmehus/) moved this task from [Backlog](/project/board/67/) to [External](/project/board/67/) on the [Trust & Safety](/tag/trust_safety/) board.[Apr 11 2022, 02:502022-04-11 02:50:45 (UTC+0)](#183450)[Dmehus](/p/Dmehus/) moved this task from [Backlog](/project/board/62/) to [Short Term](/project/board/62/) on the [Technology-Team (MediaWiki)](/tag/technology-team_mediawiki/) board.[Dmehus](/p/Dmehus/) moved this task from [Backlog](/project/board/17/) to [Actions Needed (Review)](/project/board/17/) on the [Extensions](/tag/extensions/) board.[Dmehus](/p/Dmehus/) moved this task from [Backlog](/project/board/16/) to [In Progress](/project/board/16/) on the [Configuration](/tag/configuration/) board.Unknown Object (User) added a comment.[Apr 11 2022, 03:002022-04-11 03:00:19 (UTC+0)](#183454)Comment Actions

I thought this could've happened if the globalblock-whitelist right was given, but according to Special:ListGroupRights, \* does not have that. So that doesn't seem to be the case, and I'm personally not certain how this was done, unless I'm missing something here.

Unknown Object (User) moved this task from [Actions Needed (Review)](/project/board/17/) to [Deployed Extension Bugs](/project/board/17/) on the [Extensions](/tag/extensions/) board.Edited · [Apr 11 2022, 03:002022-04-11 03:00:47 (UTC+0)](#183455)Unknown Object (User) removed a project: [Configuration](/tag/configuration/).Comment Actions

Also why would bypasstoscheck have absolutely anything to do with GlobalBlocking? I don't see how, and it seems extremely unlikely it would, since that is for sign up pages, and this issue is an anonymous user.

[Dmehus](/p/Dmehus/) added a comment.Edited · [Apr 11 2022, 03:122022-04-11 03:12:01 (UTC+0)](#183458)Comment Actions
> In [T9061#183454](/T9061#183454), [@Universal\_Omega](/p/Universal_Omega/) wrote:
>
> I thought this could've happened if the globalblock-whitelist right was given, but according to Special:ListGroupRights, \* does not have that. So that doesn't seem to be the case, and I'm personally not certain how this was done, unless I'm missing something here.

Yeah, that was my first thought also, or if the global block was disabled locally

> In [T9061#183455](/T9061#183455), [@Universal\_Omega](/p/Universal_Omega/) wrote:
>
> Also why would bypasstoscheck have absolutely anything to do with GlobalBlocking? I don't see how, and it seems extremely unlikely it would, since that is for sign up pages, and this issue is an anonymous user.

Not specifically *that* user right, per se, but my thought was since NewSignupPage extension is enabled on that wiki and interacts with one's ability to create accounts, it's *possible* it's a conflict with that extension, but it could be some other extension conflict also.

Unknown Object (User) edited projects, added [MediaWiki](/tag/mediawiki/); removed [Extensions](/tag/extensions/).[Apr 11 2022, 03:312022-04-11 03:31:56 (UTC+0)](#183459)Comment Actions

If this turns out to be an actual issue, something to check is if ApiEditPage actually checks for global blocks. Which means this may potentially be a core vulnerability, if it is one.

[Dmehus](/p/Dmehus/) added a subscriber: [Owen](/p/Owen/).[Apr 11 2022, 04:032022-04-11 04:03:34 (UTC+0)](#183461)Comment Actions

This may or may not be of interest to [@Owen](/p/Owen/), but adding him nonetheless in his Trust and Safety and Board capacities, so he can at least *view* the task, for a question I've asked him in our #trust-safety channel on Discord

[Dmehus](/p/Dmehus/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-bzlpryii5d5tyqi/)[Apr 11 2022, 04:102022-04-11 04:10:17 (UTC+0)](#183463)

[Reception123](/p/Reception123/) added a comment.[Apr 11 2022, 14:402022-04-11 14:40:50 (UTC+0)](#183507)Comment Actions

[@Dmehus](/p/Dmehus/)

1. It is yes, this can be seen via LS.php
2. Is set to true by default and unmodified for MH
3. Yes, 'mhglobal' is the global blocking DB
4. Those are the only two settings we have different than the defaults.

[Reception123](/p/Reception123/) added a comment.[Apr 11 2022, 14:412022-04-11 14:41:53 (UTC+0)](#183509)Comment Actions

The issue will have to be tested on a test wiki by applying a global block to an IP and identifying potential extensions and them being disabled/enabled until we can conclude which one is causing it.

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 11 2022, 15:112022-04-11 15:11:19 (UTC+0)](#183514)Comment Actions
> In [T9061#183454](/T9061#183454), [@Universal\_Omega](/p/Universal_Omega/) wrote:
>
> I thought this could've happened if the globalblock-whitelist right was given, but according to Special:ListGroupRights, \* does not have that. So that doesn't seem to be the case, and I'm personally not certain how this was done, unless I'm missing something here.

That's already been tried before and mitigated against.

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 11 2022, 15:152022-04-11 15:15:40 (UTC+0)](#183515)Comment Actions
> In [T9061#183509](/T9061#183509), [@Reception123](/p/Reception123/) wrote:
>
> The issue will have to be tested on a test wiki by applying a global block to an IP and identifying potential extensions and them being disabled/enabled until we can conclude which one is causing it.

Why not check eval.php first <https://github.com/wikimedia/mediawiki-extensions-GlobalBlocking/blob/master/includes/GlobalBlocking.php#L78> and the User::UserCan methods might give some insight

[Dmehus](/p/Dmehus/) added a comment.[Apr 12 2022, 01:372022-04-12 01:37:49 (UTC+0)](#183551)Comment Actions
> In [T9061#183509](/T9061#183509), [@Reception123](/p/Reception123/) wrote:
>
> The issue will have to be tested on a test wiki by applying a global block to an IP and identifying potential extensions and them being disabled/enabled until we can conclude which one is causing it.

Yeah... I wouldn't prefer to do extension testing on Public Test Wiki, though. This is one of those times when it'd be *really* still be helpful to have an SRE testing wiki within the existing CentralAuth-linked production wikis.

[Dmehus](/p/Dmehus/) added a comment.[Apr 12 2022, 01:382022-04-12 01:38:32 (UTC+0)](#183552)Comment Actions
> In [T9061#183507](/T9061#183507), [@Reception123](/p/Reception123/) wrote:
>
> [@Dmehus](/p/Dmehus/)
>
> 1. It is yes, this can be seen via LS.php
> 2. Is set to true by default and unmodified for MH
> 3. Yes, 'mhglobal' is the global blocking DB
> 4. Those are the only two settings we have different than the defaults.

Thanks. That's what I thought.

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 12 2022, 08:072022-04-12 08:07:42 (UTC+0)](#183596)Comment Actions
> In [T9061#183551](/T9061#183551), [@Dmehus](/p/Dmehus/) wrote:
> > In [T9061#183509](/T9061#183509), [@Reception123](/p/Reception123/) wrote:
> >
> > The issue will have to be tested on a test wiki by applying a global block to an IP and identifying potential extensions and them being disabled/enabled until we can conclude which one is causing it.
>
> Yeah... I wouldn't prefer to do extension testing on Public Test Wiki, though. This is one of those times when it'd be *really* still be helpful to have an SRE testing wiki within the existing CentralAuth-linked production wikis.

We can run all permission checks and see what's effecting them via eval.php. There's no need to test it on a wiki at all.

[RhinosF1](/p/RhinosF1/) added a subscriber: [Majavah](/p/Majavah/).[Apr 13 2022, 14:282022-04-13 14:28:55 (UTC+0)](#183760)

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 13 2022, 15:212022-04-13 15:21:37 (UTC+0)](#183761)Comment Actions
```
rhinos@mwtask111:~$ sudo -u www-data php /srv/mediawiki/w/maintenance/eval.php --wiki=wikiweewiki
> $title = \TitleFactory::makeTitle('', 'Main_Page', '', '')

Deprecated: Non-static method TitleFactory::makeTitle() should not be called statically in /srv/mediawiki/w/maintenance/eval.php(84) : eval()'d code on line 1

>  $user = \MediaWiki\MediaWikiServices::getInstance()->getUserFactory()->newAnonymous( '148.74.235.89' )

> var_dump(\MediaWiki\MediaWikiServices::getInstance()->getPermissionManager()->userCan('move', $user, $title));
bool(false)

> var_dump($title->isMainPage())
bool(true)
```

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 13 2022, 15:432022-04-13 15:43:46 (UTC+0)](#183762)Comment Actions

nothing to do with GlobalBlock at all

Restricted Repository Identity mentioned this in [R9:78d689240eff: T9061: disable create redirect](/R9%3A78d689240eff685378a53fb602798dabf56b9ac2).[Apr 13 2022, 15:442022-04-13 15:44:23 (UTC+0)](#183763)[RhinosF1](/p/RhinosF1/) added a commit: [R9:78d689240eff: T9061: disable create redirect](/R9%3A78d689240eff685378a53fb602798dabf56b9ac2).[Apr 13 2022, 15:442022-04-13 15:44:53 (UTC+0)](#183764)

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 13 2022, 15:472022-04-13 15:47:03 (UTC+0)](#183765)Comment Actions

[@Samwilson](/p/Samwilson/): It looks like create redirect is at fault. I can move the Main\_Page without being able to edit it and the user used that. It looks like you are one of 2 project members. Can you look into this?

[RhinosF1](/p/RhinosF1/) renamed this task from Investigate why global block for 148.74.235.89 not effective on wikiweewiki to CreateRedirect has weak (no?) permissions checks.[Apr 13 2022, 15:492022-04-13 15:49:10 (UTC+0)](#183767)[RhinosF1](/p/RhinosF1/) added a subscriber: [Samwilson](/p/Samwilson/).[Samwilson](/p/Samwilson/) added a comment.[Apr 14 2022, 06:052022-04-14 06:05:26 (UTC+0)](#183831)Comment Actions

I'm not a member, just watching that project.

I was interested in it because I wanted an easy way to create redirects, so suggested creating a toolbar button in that extension. The [author wasn't keen](https://www.mediawiki.org/wiki/Extension_talk%3ACreateRedirect#Toolbar_button_to_create_inward_redirect.3F), so in the end I've gone and made [Extension:RedirectManager](https://www.mediawiki.org/wiki/Extension%3ARedirectManager). That extension does (I think!) handle permissions correctly.

[RhinosF1](/p/RhinosF1/) added a comment.Edited · [Apr 14 2022, 06:512022-04-14 06:51:57 (UTC+0)](#183832)Comment Actions

Given the risk with the currently layout and how much nicer [@Samwilson](/p/Samwilson/)'s looks, if it passed security review, I'd consider replacing CreateRedirect with it.

[Samwilson](/p/Samwilson/) added a comment.[Apr 14 2022, 10:572022-04-14 10:57:16 (UTC+0)](#183835)Comment Actions

I mentioned the CreateRedirect error on its talk page (sorry, I didn't realise this was a hidden security task! I shouldn't've advertised it publicly), and it looks like the issue has been fixed: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/+/780567](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/%2B/780567)

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 14 2022, 11:092022-04-14 11:09:38 (UTC+0)](#183836)Comment Actions

No problem.

[@Dmehus](/p/Dmehus/): any issues to making public?

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 14 2022, 11:132022-04-14 11:13:20 (UTC+0)](#183837)Comment Actions

I filed <https://phabricator.wikimedia.org/T306174> for getting a CVE

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 14 2022, 11:142022-04-14 11:14:13 (UTC+0)](#183838)Comment Actions

[@Universal\_Omega](/p/Universal_Omega/): I'd appreciate a security review / opinion on the below as this doesn't fill me with great confidence.

> In [T9061#183832](/T9061#183832), [@RhinosF1](/p/RhinosF1/) wrote:
>
> Given the risk with the currently layout and how much nicer [@Samwilson](/p/Samwilson/)'s looks, if it passed security review, I'd consider replacing CreateRedirect with it.

[RhinosF1](/p/RhinosF1/) lowered the priority of this task from High to Low.[Apr 14 2022, 11:142022-04-14 11:14:34 (UTC+0)](#183839)[RhinosF1](/p/RhinosF1/) edited projects, added [Extensions](/tag/extensions/); removed [MediaWiki](/tag/mediawiki/).[RhinosF1](/p/RhinosF1/) moved this task from [Deployed Extension Bugs](/project/board/17/) to [Security Review Needed](/project/board/17/) on the [Extensions](/tag/extensions/) board.Comment Actions

Note: [T1140#25572](/T1140#25572) is original review

[Reception123](/p/Reception123/) added a comment.[Apr 14 2022, 11:402022-04-14 11:40:24 (UTC+0)](#183845)Comment Actions

My view is that if RedirectManager is very similar to CreateRedirect and does not present the issues that CR does we should replace it.

Pinging [@Agent\_Isai](/p/Agent_Isai/) for his views regarding the community aspects. I'd probably assume a notice with enough time for the community to comment should be sufficient?

Unknown Object (User) removed subscribers: [Samwilson](/p/Samwilson/), [Majavah](/p/Majavah/), [Owen](/p/Owen/).[Apr 14 2022, 20:082022-04-14 20:08:42 (UTC+0)](#183891)Comment Actions
> In [T9061#183845](/T9061#183845), [@Reception123](/p/Reception123/) wrote:
>
> My view is that if RedirectManager is very similar to CreateRedirect and does not present the issues that CR does we should replace it.

Indeed, they do appear to be similar but a key difference between both is that CreateRedirect offers a standalone special page while RedirectManager offers it as an plugin to WikiEditor.

> I'd probably assume a notice with enough time for the community to comment should be sufficient?

Definitely. A notice can be posted on the CN though I don't know if it'd be possible potentially to get a list of wikis that used this feature to perhaps reach out to them too?

Unknown Object (User) added subscribers: [Samwilson](/p/Samwilson/), [Majavah](/p/Majavah/), [Owen](/p/Owen/).[Apr 14 2022, 20:092022-04-14 20:09:19 (UTC+0)](#183893)Comment Actions

Technical mishap ;)

[Raidarr](/p/Raidarr/) added a comment.[Apr 14 2022, 20:192022-04-14 20:19:42 (UTC+0)](#183895)Comment Actions

As possible I strongly encourage interfacing with the local wikis. I suspect a lot of traffic that would benefit from an announcement, simply does not pass through Meta or its CN.

Unknown Object (User) closed this task as Resolved.[Apr 14 2022, 20:452022-04-14 20:45:55 (UTC+0)](#183898)Unknown Object (User) claimed this task.Comment Actions

Extension patched upstream, and updated for us, I will do another full review of the extension, and then hopefully re-enable it.

Unknown Object (User) added a comment.[Apr 14 2022, 20:462022-04-14 20:46:32 (UTC+0)](#183901)Comment Actions

Is this task ok to be made public?

[RhinosF1](/p/RhinosF1/) added a comment.[Apr 14 2022, 20:472022-04-14 20:47:01 (UTC+0)](#183902)Comment Actions

No objectionw

Unknown Object (User) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-7maaq7wto5a6rd5/)" to "Public (No Login Required)".[Apr 14 2022, 21:312022-04-14 21:31:08 (UTC+0)](#183905)Unknown Object (User) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-fysv7s6xvtmzrsj/)" to "All Users".[Lens0021](/p/Lens0021/) subscribed.[Apr 15 2022, 08:402022-04-15 08:40:23 (UTC+0)](#183965)

[Dmehus](/p/Dmehus/) added a subscriber: [John](/p/John/).[Apr 17 2022, 04:262022-04-17 04:26:30 (UTC+0)](#184207)Comment Actions
> In [T9061#183836](/T9061#183836), [@RhinosF1](/p/RhinosF1/) wrote:
>
> No problem.
>
> [@Dmehus](/p/Dmehus/): any issues to making public?

No objections if [@John](/p/John/) and [@Owen](/p/Owen/) have no issues making it public

Unknown Object (User) added a comment.[Apr 17 2022, 04:282022-04-17 04:28:13 (UTC+0)](#184209)Comment Actions
> In [T9061#184207](/T9061#184207), [@Dmehus](/p/Dmehus/) wrote:
> > In [T9061#183836](/T9061#183836), [@RhinosF1](/p/RhinosF1/) wrote:
> >
> > No problem.
> >
> > [@Dmehus](/p/Dmehus/): any issues to making public?
>
> No objections if [@John](/p/John/) and [@Owen](/p/Owen/) have no issues making it public

It already is now.

[Dmehus](/p/Dmehus/) added a comment.[Apr 17 2022, 04:312022-04-17 04:31:36 (UTC+0)](#184210)Comment Actions
> In [T9061#183765](/T9061#183765), [@RhinosF1](/p/RhinosF1/) wrote:
>
> [@Samwilson](/p/Samwilson/): It looks like create redirect is at fault. I can move the Main\_Page without being able to edit it and the user used that. It looks like you are one of 2 project members. Can you look into this?

[@RhinosF1](/p/RhinosF1/) Thanks for looking into this! Not surprised it was an issue with another extension

[Dmehus](/p/Dmehus/) added a comment.[Apr 17 2022, 04:322022-04-17 04:32:43 (UTC+0)](#184211)Comment Actions
> In [T9061#184209](/T9061#184209), [@Universal\_Omega](/p/Universal_Omega/) wrote:
> > In [T9061#184207](/T9061#184207), [@Dmehus](/p/Dmehus/) wrote:
> > > In [T9061#183836](/T9061#183836), [@RhinosF1](/p/RhinosF1/) wrote:
> > >
> > > No problem.
> > >
> > > [@Dmehus](/p/Dmehus/): any issues to making public?
> >
> > No objections if [@John](/p/John/) and [@Owen](/p/Owen/) have no issues making it public
>
> It already is now.

Yeah, I mean, I don't know what the protocol is on making [Trust & Safety](/tag/trust_safety/) tagged tasks public, but yeah, I guess if SRE is fine with it, that's fine.

[Dmehus](/p/Dmehus/) added a comment.[Apr 17 2022, 04:362022-04-17 04:36:03 (UTC+0)](#184213)Comment Actions
> In [T9061#183835](/T9061#183835), [@Samwilson](/p/Samwilson/) wrote:
>
> I mentioned the CreateRedirect error on its talk page (sorry, I didn't realise this was a hidden security task! I shouldn't've advertised it publicly), and it looks like the issue has been fixed: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/+/780567](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/CreateRedirect/%2B/780567)

[@Samwilson](/p/Samwilson/) No problem! Nothing was especially security sensitive really, and it's apparently been fixed, so that's great. Thanks for looking into this and for communicating with the developer for us. :)

[• Naleksuh](/p/Naleksuh/) subscribed.[Apr 17 2022, 04:472022-04-17 04:47:24 (UTC+0)](#184216)Comment Actions

I was directed to this task over IRC. It appears to already be closed, and have little relevance to me at all. What is going on here?

Unknown Object (User) added a comment.[Apr 17 2022, 05:232022-04-17 05:23:12 (UTC+0)](#184218)Comment Actions
> In [T9061#184216](/T9061#184216), [@Naleksuh](/p/Naleksuh/) wrote:
>
> I was directed to this task over IRC. It appears to already be closed, and have little relevance to me at all. What is going on here?

You must've been directed to the wrong task, I'd assume? T9071 is probably what they meant to direct you to, I'm assuming, based off conversation I have observed. But that task is currently private.

[Dmehus](/p/Dmehus/) added a comment.[Apr 17 2022, 07:292022-04-17 07:29:00 (UTC+0)](#184224)Comment Actions
> In [T9061#184218](/T9061#184218), [@Universal\_Omega](/p/Universal_Omega/) wrote:
> > In [T9061#184216](/T9061#184216), [@Naleksuh](/p/Naleksuh/) wrote:
> >
> > I was directed to this task over IRC. It appears to already be closed, and have little relevance to me at all. What is going on here?
>
> You must've been directed to the wrong task, I'd assume? T9071 is probably what they meant to direct you to, I'm assuming, based off conversation I have observed. But that task is currently private.

No, I thought Naleksuh might be interested in the task, so sent him this link.

Unknown Object (User) added a comment.[Apr 17 2022, 07:482022-04-17 07:48:08 (UTC+0)](#184226)Comment Actions
> In [T9061#184224](/T9061#184224), [@Dmehus](/p/Dmehus/) wrote:
> > In [T9061#184218](/T9061#184218), [@Universal\_Omega](/p/Universal_Omega/) wrote:
> > > In [T9061#184216](/T9061#184216), [@Naleksuh](/p/Naleksuh/) wrote:
> > >
> > > I was directed to this task over IRC. It appears to already be closed, and have little relevance to me at all. What is going on here?
> >
> > You must've been directed to the wrong task, I'd assume? T9071 is probably what they meant to direct you to, I'm assuming, based off conversation I have observed. But that task is currently private.
>
> No, I thought Naleksuh might be interested in the task, so sent him this link.

Ok

[Log In to Comment](/login/?next=%2FT9061)
