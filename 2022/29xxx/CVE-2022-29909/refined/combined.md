=== Content from www.mozilla.org_223a0e60_20250115_101108.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-16

## Security Vulnerabilities fixed in Firefox 100

Announced
May 3, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 100

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29910: Firefox for Android forgot HTTP Strict Transport Security settings](#CVE-2022-29910)

Reporter
Mark B
Impact
moderate
##### Description

When closed or sent to the background, Firefox for Android would not properly record and persist HSTS settings.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1757138](https://bugzilla.mozilla.org/show_bug.cgi?id=1757138)

#### [#CVE-2022-29915: Leaking cross-origin redirect through the Performance API](#CVE-2022-29915)

Reporter
Sohom Datta
Impact
low
##### Description

The Performance API did not properly hide the fact whether a request cross-origin resource has observed redirects.

##### References

* [Bug 1751678](https://bugzilla.mozilla.org/show_bug.cgi?id=1751678)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

#### [#CVE-2022-29918: Memory safety bugs fixed in Firefox 100](#CVE-2022-29918)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1744043%2C1747178%2C1753535%2C1754017%2C1755847%2C1756172%2C1757477%2C1758223%2C1760160%2C1761481%2C1761771)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_810abb5b_20250115_101107.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1755081)
* [XML](/show_bug.cgi?ctype=xml&id=1755081)

Closed
[Bug 1755081](/show_bug.cgi?id=1755081)
(CVE-2022-29909)

Opened 3 years ago
Closed 3 years ago

# Cross-origin embeds/objects can obtain permissions of the top-level origin

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Cross-origin embeds/objects can obtain permissions of the top-level origin

## Categories

### (Core :: DOM: Security, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S1

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

101 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox98 | [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 100+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 | + | wontfix |
| firefox99 | + | wontfix |
| firefox100 | + | fixed |
| firefox101 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: arminius, Assigned: farre)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3cca6b6cc3855653ab1b17e9df3aa8e1?d=mm&size=40)  [arminius](/user_profile?user_id=526160)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

### (Blocks 1 open bug, Regressed 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1595491](/show_bug.cgi?id=1595491 "RESOLVED FIXED - Make <embed> and <object> behave more like <iframe>")

[permissions-policy](/show_bug.cgi?id=1531012 "NEW - [meta] Permissions Policy tracking")

Dependency [tree](/showdependencytree.cgi?id=1755081&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1755081)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1904794](/show_bug.cgi?id=1904794 "ASSIGNED - Intermittent dom/security/featurepolicy/test/mochitest/test_nested.html | single tracking bug")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-38473](/show_bug.cgi?id=1771685 "VERIFIED FIXED - Cross-origin frames can obtain top-level permissions b/c XSLT transform resets FeaturePolicy")

## Details

### (4 keywords, Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-29909

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a5169982_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [in-testsuite](#a4642349_578488 "3 years ago") | ? |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | in-testsuite | ? |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a5742809_553429 "3 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 2 obsolete files)

| [poc.zip](/attachment.cgi?id=9263578)  [3 years ago](#c1)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   1.01 KB, application/zip |  | [Details](/attachment.cgi?id=9263578&action=edit) |
| --- | --- | --- |
| [Proof of concept: load this HTML file in a cross-origin <iframe>](/attachment.cgi?id=9263635)  [3 years ago](#c3)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   437 bytes, text/html |  | [Details](/attachment.cgi?id=9263635&action=edit) |
| [poc\_testcase\_mochitest.patch](/attachment.cgi?id=9263642)  [3 years ago](#c4)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   2.93 KB, patch |  | [Details](/attachment.cgi?id=9263642&action=edit) | [Diff](/attachment.cgi?id=9263642&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1755081&attachment=9263642) |
| [WIP: Bug 1755081 - featurepolicy for object/embed r?farre](/attachment.cgi?id=9266035)  [3 years ago](#c11)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9266035&action=edit) | [Review](/attachment.cgi?id=9266035) |
| [WIP: Bug 1755081 - test case r=farre](/attachment.cgi?id=9266036)  [3 years ago](#c13)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9266036&action=edit) | [Review](/attachment.cgi?id=9266036) |
| [Mochitest: FeaturePolicy delegation to nested BCs](/attachment.cgi?id=9266361)  [3 years ago](#c15)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   2.55 KB, patch |  | [Details](/attachment.cgi?id=9266361&action=edit) | [Diff](/attachment.cgi?id=9266361&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1755081&attachment=9266361) |
| [Bug 1755081 - Add tests for more containers. r=smaug!](/attachment.cgi?id=9267341)  [3 years ago](#c16)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9267341&action=edit) | [Review](/attachment.cgi?id=9267341) |
| [Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!](/attachment.cgi?id=9269672)  [3 years ago](#c20)  [Andreas Farre [:farre]](/user_profile?user_id=566192)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c26 "3 years ago")  RyanVM : [approval-mozilla-release-](#a6288313_75935 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c32 "3 years ago")  tjr : [sec-approval+](#c22 "3 years ago") | [Details](/attachment.cgi?id=9269672&action=edit) | [Review](/attachment.cgi?id=9269672) |
| [advisory.txt](/attachment.cgi?id=9274253)  [3 years ago](#c34)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   272 bytes, text/plain |  | [Details](/attachment.cgi?id=9274253&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1755081#c0)• 3 years ago |
|  | |

Documents in nested cross-origin browsing contexts can obtain permissions granted to the top-level origin. This could e.g. be a 3rd-party `<iframe>` accessing the webcam after permission had been given to the parent site, or prompting for geolocation access in the parent's name.

The attack is based on exploiting faulty `FeaturePolicy` inheritance by inserting a non-`<iframe>` embedder (e.g. `<embed>`) in the ancestor chain.

### Attack scenario

* The user has granted a permanent microphone permission to `voicechat.example`.
* `voicechat.example` embeds a cross-origin advertisement via `<iframe src="https://advertiser.example">`.
* Once loaded, `advertiser.example` can access the microphone without user interaction.

If permission had not been granted yet, `advertiser.example` may also prompt for it. The dialog will then still appear as a request by `voicechat.example` and not the attacker. (It's by design that the prompt always requests as the top-level origin.)

### Proof of concept

(These are identical to the attached `poc.zip`.)

`https://site.example/site.html`:

```
<iframe src="https://attacker.example/attacker_parent.html"></iframe>

```

`https://attacker.example/attacker_parent.html`:

```
<embed src="attacker_child.html"></embed>

```

`https://attacker.example/attacker_child.html`:

```
<button id="ask">access microphone</button>
<div id="info"></div>
<script>
  ask.onclick = async function() {
    const stream = await navigator.mediaDevices.getUserMedia({audio: true});
    info.textContent = `origin ${origin} got ${stream}`;
  }
</script>

```

A click on "access microphone" will give `attacker.example` access based on the current permissions for `site.example`. However, it should have been neither promted for nor granted, because the request originates from a cross-origin frame without special permissions.

I'll follow up with more details.

Flags: sec-bounty?

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1755081#c1)• 3 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9263578) (obsolete)
— [Details](attachment.cgi?id=9263578&action=edit)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1755081#c2)• 3 years ago |
|  | |

Here's more background on the root cause.

For a number of permission types, the delegation to child frames is governed by the [Feature Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Feature_Policy).

[`PermissionDelegateHandler.cpp`](https://searchfox.org/mozilla-central/rev/89015dc2d9df7d1c15a7eea31859d28df6460ba9/extensions/permissions/PermissionDelegateHandler.cpp#30):

```
    {"geolocation", u"geolocation", DelegatePolicy::eDelegateUseFeaturePolicy},
    ...
    {"camera", u"camera", DelegatePolicy::eDelegateUseFeaturePolicy},
    {"microphone", u"microphone", DelegatePolicy::eDelegateUseFeaturePolicy},
    {"screen", u"display-capture", DelegatePolicy::eDelegateUseFeaturePolicy},

```

[`PermissionDelegateHandler.h`](https://searchfox.org/mozilla-central/rev/89015dc2d9df7d1c15a7eea31859d28df6460ba9/extensions/permissions/PermissionDelegateHandler.h#102):

```
    /* Permission is delegated using Feature Policy. Permission is denied by
     * default in cross origin iframe and the iframe only could get/set
     * permission if there's allow attribute set in iframe. e.g allow =
     * "geolocation" */
    eDelegateUseFeaturePolicy,

```

A nested cross-origin frame can only make use of these features if the permission was delegated from their parent. So when a document is initialized, it tries to inherit the parent policy in [`Document::InitFeaturePolicy()`](https://searchfox.org/mozilla-central/rev/89015dc2d9df7d1c15a7eea31859d28df6460ba9/dom/base/Document.cpp#3777):

```
nsresult Document::InitFeaturePolicy(nsIChannel* aChannel) {
  MOZ_ASSERT(mFeaturePolicy, "we should only call init once");

  mFeaturePolicy->ResetDeclaredPolicy();

  mFeaturePolicy->SetDefaultOrigin(NodePrincipal());

  RefPtr<mozilla::dom::FeaturePolicy> parentPolicy = GetParentFeaturePolicy();
  if (parentPolicy) {
    // Let's inherit the policy from the parent HTMLIFrameElement if it exists.
    mFeaturePolicy->InheritPolicy(parentPolicy);
    mFeaturePolicy->SetSrcOrigin(parentPolicy->GetSrcOrigin());
  }
...

```

However, if [`GetParentFeaturePolicy()`](https://searchfox.org/mozilla-central/rev/89015dc2d9df7d1c15a7eea31859d28df6460ba9/dom/base/Document.cpp#3738) returns null, the policy remains at its origin's default. This can happen when the embedder is not an `HTMLIFrameElement` (e.g. with `HTMLEmbedElement`).

```
already_AddRefed<dom::FeaturePolicy> Document::GetParentFeaturePolicy() {
  BrowsingContext* browsingContext = GetBrowsingContext();
  if (!browsingContext) {
    return nullptr;
  }
  if (!browsingContext->IsContentSubframe()) {
    return nullptr;
  }

  HTMLIFrameElement* iframe =
      HTMLIFrameElement::FromNodeOrNull(browsingContext->GetEmbedderElement());
  if (iframe) {
    return do_AddRef(iframe->FeaturePolicy());
  }

  if (XRE_IsParentProcess()) {
    return do_AddRef(browsingContext->Canonical()->GetContainerFeaturePolicy());
  }

```

So a cross-origin non-`<iframe>` document would keep its default feature policy instead of inheriting a limited one. And since the origin check to ultimately grant (or prompt the user for) access to the feature (e.g. when `geolocation.getCurrentLocation()` is called) is going to be performed against the *top-level* origin, the document now acts with the top-level context's permission state.

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1755081#c3)• 3 years ago |
|  | |

Attached file
[Proof of concept: load this HTML file in a cross-origin <iframe>](attachment.cgi?id=9263635)
— [Details](attachment.cgi?id=9263635&action=edit)

[Attachment #9263578](/attachment.cgi?id=9263578&action=edit "poc.zip") -
Attachment is obsolete: true

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1755081#c4)• 3 years ago |
|  | |

Attached patch

[poc\_testcase\_mochitest.patch](attachment.cgi?id=9263642&action=diff)
— [Details](attachment.cgi?id=9263642&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1755081&attachment=9263642)

Here's the PoC in the guise of a mochitest.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a237652_428608)• 3 years ago |

Blocks: [1595491](/show_bug.cgi?id=1595491 "RESOLVED FIXED - Make <embed> and <object> behave more like <iframe>")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a237888_1689)• 3 years ago |

Severity: -- → S1Status: UNCONFIRMED → NEW
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F)
[tracking-firefox99](/buglist.cgi?f1=cf_tracking_firefox99&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%3F)Ever confirmed: trueKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Priority: -- → P1Summary: Cross-origin frames can obtain permissions of the top-level origin → Cross-origin embeds/objects can obtain permissions of the top-level originWhiteboard: [domsecurity-active]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a237902_1689)• 3 years ago |

Group: core-security → dom-core-security

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a299777_24572)• 3 years ago |

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B)
[tracking-firefox99](/buglist.cgi?f1=cf_tracking_firefox99&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1755081#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1755081&comment_id=15779702 "1 revision") |
|  | |

Andreas (:farre) said he will look into a bit and see what's up around `FeaturePolicy` code.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a1444386_1689)• 3 years ago |

Severity: S1 → S3Priority: P1 → --

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a1444553_363267)• 3 years ago |

Whiteboard: [domsecurity-active]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1755081#c6)• 3 years ago |
|  | |

Andreas, please see [comment 5](/show_bug.cgi?id=1755081#c5 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin")

Component: DOM: Security → DOM: Core & HTMLFlags: needinfo?(afarre)

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a1446083_566192)• 3 years ago |

Assignee: nobody → afarreFlags: needinfo?(afarre)

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1755081#c7)• 3 years ago |
|  | |

Yeah, this is missing functionality. The spec states that container policies[1] is inherited, but we only consider iframes, not all containers. So, `HTMLEmbedElement` and `HTMLObjectElement` doesn't have a `FeaturePolicy`-getter as in `HTMLIFrameElement`[2]. I'm moving this to DOM: Security, since that's where the Permissions Policy feature lives. Is that ok with you Christoph?

Fixing this would need adding a `FeaturePolicy`-member, getter and initialization to HTMLEmbedElement and HTMLObjectElement, as well as adding those cases to `Document::GetParentFeaturePolicy()`.

[1] <https://w3c.github.io/webappsec-permissions-policy/#container-policies>

[2] <https://searchfox.org/mozilla-central/source/dom/html/HTMLIFrameElement.h#159>

Assignee: afarre → nobodyComponent: DOM: Core & HTML → DOM: SecurityFlags: needinfo?(ckerschb)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a1514206_102998)• 3 years ago |

Blocks: [permissions-policy](/show_bug.cgi?id=1531012 "NEW - [meta] Permissions Policy tracking")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1755081#c8)• 3 years ago |
|  | |

I'll give it a shot.

Assignee: nobody → fbraunStatus: NEW → ASSIGNEDFlags: needinfo?(ckerschb)

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1755081#c9)• 3 years ago |
|  | |

(In reply to Andreas Farre [:farre] from [comment #7](/show_bug.cgi?id=1755081#c7 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin"))

> Fixing this would need adding a `FeaturePolicy`-member, getter and initialization to HTMLEmbedElement and HTMLObjectElement, as well as adding those cases to `Document::GetParentFeaturePolicy()`.

I guess some kind of common base class would do as well, I guess. A bit cleaner, and would only need one case in `GetParentFeaturePolicy` if the base-class is convertible from the node.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1755081#c10)• 3 years ago |
|  | |

My initial understanding was based on the assumption that there are just missing functions that can be copied over, but that's not entirely it.

I currently encounter some assumptions from the implementation that I don't fully get:

AFAIU, they are more deeply rooted into the fact that the HTMLIframeElement is a nsGenericHTMLFrameElement but the HTMLObjectElement is reusing code for... image loads? E.g., there is no `mFrameLoader` and querying the DocShell and BrowsingContext is arcane magic to me at this point.

Given how much legacy we are facing with object & embed elements, I also wonder if it would make sense to hack around this and just disallow all permissioned-APIs within object & embed elements instead?

Anyway, I'll upload a WIP patch with some comments and questions and would appreciate working with you on this, Andreas.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1755081#c11)• 3 years ago |
|  | |

Attached file
[WIP: Bug 1755081 - featurepolicy for object/embed r?farre](attachment.cgi?id=9266035)
— [Details](attachment.cgi?id=9266035&action=edit)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1755081#c12)• 3 years ago |
|  | |

So, we shouldn't honor the `allow` attribute on `embed`/`object` elements (and note that `embed` uses `src`, but `object` uses `data`, and neither has `srcdoc`). So indeed anything permission-related that has to be delegated will not work from a cross-origin document embedded through `embed` or `object`. Same-origin should still work though.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1755081#c13)• 3 years ago |
|  | |

Attached file
[WIP: Bug 1755081 - test case r=farre](attachment.cgi?id=9266036) (obsolete)
— [Details](attachment.cgi?id=9266036&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1755081#c14)• 3 years ago |
|  | |

Yes, I fully agree and do not plan to introduce new attributes on those elements.

I may have left some of that in, accidentally.

Given how things currently work, we do need to pass *some* info down to the embedded Document to tell it, that's currently subject to a policy. (In the future, we'd probably like this to be properly Site-Isolated and perform the check by asking the parent instead).

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1755081#c15)• 3 years ago |
|  | |

Attached patch

[Mochitest: FeaturePolicy delegation to nested BCs](attachment.cgi?id=9266361&action=diff)
— [Details](attachment.cgi?id=9266361&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1755081&attachment=9266361)

I've attached another mochitest that might be more convenient for patch development. This one directly checks the feature policy delegation on different types of embedders and nesting levels.

(The earlier testcase ([attachment 9263642](/attachment.cgi?id=9263642 "poc_testcase_mochitest.patch") [[details]](/attachment.cgi?id=9263642&action=edit "poc_testcase_mochitest.patch") [[diff]](/attachment.cgi?id=9263642&action=diff "poc_testcase_mochitest.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1755081&attachment=9263642)) is a wrapper for the entire PoC, i.e. demonstrates a practical scenario where the attack is launched from a cross-origin `<iframe>`.)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1755081#c16)• 3 years ago |
|  | |

Attached file
[Bug 1755081 - Add tests for more containers. r=smaug!](attachment.cgi?id=9267341)
— [Details](attachment.cgi?id=9267341&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a2375127_600971)• 3 years ago |

[Attachment #9266035](/attachment.cgi?id=9266035&action=edit "WIP: Bug 1755081 - featurepolicy for object/embed r?farre") -
Attachment description: WIP: Bug 1755081 - featurepolicy for object/embed r?farre → Bug 1755081 - featurepolicy for object/embed r?farre

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a2375151_600971)• 3 years ago |

[Attachment #9266036](/attachment.cgi?id=9266036&action=edit "WIP: Bug 1755081 - test case r=farre") -
Attachment is obsolete: true

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a2649571_363267)• 3 years ago |

Priority: -- → P1

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a2654043_363267)• 3 years ago |

Whiteboard: [domsecurity-active]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a2688866_75935)• 3 years ago |

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1755081#c17)• 3 years ago |
|  | |

:freddy does this need to go out with 99 or can it wait until 100?

We are the final week of beta for 99,

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1755081#c18)• 3 years ago |
|  | |

I'm making some progress, but it's unlikely this will make it. I was on sick leave last week and have to take my PTO before it expires this & next week. I'll try to nudge things along, but there seem to be some issues...

Flags: needinfo?(fbraun)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a3422452_695136)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=wontfix)
[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a3428115_600971)• 3 years ago |

[Attachment #9267341](/attachment.cgi?id=9267341&action=edit "Bug 1755081 - Add tests for more containers. r=smaug!") -
Attachment description: Bug 1755081 - tests r?farre → WIP: Bug 1755081 - tests r?farre

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a3428131_600971)• 3 years ago |

[Attachment #9266035](/attachment.cgi?id=9266035&action=edit "WIP: Bug 1755081 - featurepolicy for object/embed r?farre") -
Attachment description: Bug 1755081 - featurepolicy for object/embed r?farre → WIP: Bug 1755081 - featurepolicy for object/embed r?farre

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1755081#c19)• 3 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:freddy, could you consider increasing the severity of this security bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#severity_high_security.py).

Flags: needinfo?(fbraun)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a3862517_600971)• 3 years ago |

[Attachment #9267341](/attachment.cgi?id=9267341&action=edit "Bug 1755081 - Add tests for more containers. r=smaug!") -
Attachment description: WIP: Bug 1755081 - tests r?farre → Bug 1755081 - Add tests for more containers. r=smaug!

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1755081#c20)• 3 years ago |
|  | |

Attached file
[Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!](attachment.cgi?id=9269672)
— [Details](attachment.cgi?id=9269672&action=edit)

Depends on D140817

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a4008184_566192)• 3 years ago |

Assignee: fbraun → afarre

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1755081#c21)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: There is a follow-up testcase in <https://phabricator.services.mozilla.com/D140817> that tests the bug, so pretty easy.

The test does more or less describe exactly how to exploit this issue though.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: Patches apply cleanly on beta and esr91 and the test in D140817 passes as well. Haven't tested release, but I'm assuming that same goes for that branch.
* **How likely is this patch to cause regressions; how much testing does it need?**: The code added to nsObjectLoadingContent is fairly similar to what nsHTMLIFrame already has, and the extra steps in Document::GetParentFeaturePolicy() are hopefully trivial enough.
[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: sec-approval?

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a4014674_566192)• 3 years ago |

[Attachment #9267341](/attachment.cgi?id=9267341&action=edit "Bug 1755081 - Add tests for more containers. r=smaug!") -
Flags: sec-approval?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a4438102_428608)• 3 years ago |

Severity: S3 → S1Flags: needinfo?(fbraun)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1755081#c22)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

Approved to land and request uplift

[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1755081#c23)• 3 years ago |
|  | |

Comment on [attachment 9267341](/attachment.cgi?id=9267341 "Bug 1755081 - Add tests for more containers. r=smaug!") [[details]](/attachment.cgi?id=9267341&action=edit "Bug 1755081 - Add tests for more containers. r=smaug!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Add tests for more containers. r=smaug!

Clearing sec-approval, we can land the tests on or after May 16

[Attachment #9267341](/attachment.cgi?id=9267341&action=edit "Bug 1755081 - Add tests for more containers. r=smaug!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a4642349_578488)• 3 years ago |

Flags: in-testsuite?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1755081#c24)• 3 years ago |
|  | |

Allow more containers to participate in FeaturePolicy r=smaug,ckerschb

<https://hg.mozilla.org/integration/autoland/rev/ca23a4fb182d5a4b20e54898ce76b9495c23ce89>

<https://hg.mozilla.org/mozilla-central/rev/ca23a4fb182d>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 101 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a5169982_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1755081#c25)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Possible use of permission policy protected features
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Behavior is similar to how iframe does this. Automated test is pending.
* **String changes made/needed**:
[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-release?
[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-beta?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1755081#c26)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

Approved for 100.0b6

[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1755081#c27)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/1d40eef1b07e>

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1755081#c28)• 3 years ago |
|  | |

Documenting that ESR-91 is affected: this feature was enabled in Release for Firefox 74 in [bug 1617219](/show_bug.cgi?id=1617219 "VERIFIED FIXED - Enable Feature Policy & Permission Delegation for Release 74")

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [100+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=100%2B)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a5742809_553429)• 3 years ago |

Flags: qe-verify-Whiteboard: [domsecurity-active] → [domsecurity-active][post-critsmash-triage]

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1755081#c29)• 3 years ago |
|  | |

Need info for myself to remember landing the test.

Flags: needinfo?(afarre)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1755081#c30)• 3 years ago |
|  | |

Is this ready for an ESR91 approval request? We need to build the RC build this week. It grafts cleanly as-landed.

Flags: needinfo?(afarre)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a6273683_75935)• 3 years ago |

Flags: needinfo?(afarre)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a6273693_75935)• 3 years ago |

[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a6288313_75935)• 3 years ago |

[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-release? → approval-mozilla-release-

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1755081#c31)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Possible use of permission policy protected features
* **Fix Landed on Version**: 101
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Behavior is similar to how iframe does this. Automated test is pending.
Flags: needinfo?(afarre)
[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1755081#c32)• 3 years ago |
|  | |

Comment on [attachment 9269672](/attachment.cgi?id=9269672 "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") [[details]](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!")

[Bug 1755081](/show_bug.cgi?id=1755081 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin") - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!

Approved for 91.9esr.

[Attachment #9269672](/attachment.cgi?id=9269672&action=edit "Bug 1755081 - Allow more containers to participate in FeaturePolicy r=smaug!,ckerschb!") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1755081#c33)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/df568c5e2f37>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a6525643_428608)• 3 years ago |

Whiteboard: [domsecurity-active][post-critsmash-triage] → [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1755081#c34)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9274253)
— [Details](attachment.cgi?id=9274253&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a6601736_428608)• 3 years ago |

Alias: CVE-2022-29909

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a9256572_526160)• 3 years ago |

See Also: → [CVE-2022-38473](/show_bug.cgi?id=1771685 "VERIFIED FIXED - Cross-origin frames can obtain top-level permissions b/c XSLT transform resets FeaturePolicy")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a10011099_578488)• 3 years ago |

Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+] → [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder 2022-05-16]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a10871885_578488)• 3 years ago |

Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder 2022-05-16] → [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder-test 2022-05-16]

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1755081#c35)• 3 years ago |
|  | |

Test landed: <https://hg.mozilla.org/integration/autoland/rev/138b555d219f584ecb2dbf09bbee4713674d53a8>

Backed out for causing mochitest failures in test\_nested.html:

<https://hg.mozilla.org/integration/autoland/rev/41cd304ad950ac66f7496ff2995467df09acb8b3>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=R12FHO08Q320cZZzijNDzg.0&searchStr=linux%2C18.04%2Cx64%2Cwebrender%2Cdebug%2Cmochitests%2Cwith%2Ccross-origin%2Cand%2Cfission%2Cenabled%2Ctest-linux1804-64-qr%2Fdebug-mochitest-plain-xorig%2C9&revision=abb9371221360a90228fa480693e5d5cdba60312>

Failure log link: <https://treeherder.mozilla.org/logviewer?job_id=384082302&repo=autoland>

Failure line: TEST-UNEXPECTED-FAIL | dom/security/featurepolicy/test/mochitest/test\_nested.html | permission delegation to <iframe src="[https://example.org/tests/dom/security/featurepolicy/test/mochitest/empty.html"></iframe>](https://example.org/tests/dom/security/featurepolicy/test/mochitest/empty.html%22%3E%EF%BF%BD/iframe%3E) - false == true - got false, expected true (operator ==)

Flags: needinfo?(afarre)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a29311625_1689)• 2 years ago |

Group: core-security-release

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1755081#c36)• 2 years ago |
|  | |

7 months ago, Tom Ritter [:tjr] placed a reminder on the bug using the whiteboard tag `[reminder-test 2022-05-16]` .

farre, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(afarre)Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+][reminder-test 2022-05-16] → [domsecurity-active][post-critsmash-triage][adv-main100+][adv-esr91.9+]

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1755081#c37)• 10 months ago |
|  | |

Pushed by afarre@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/8de460cdc4ed>
Add tests for more containers. r=smaug

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a66758593_566192)• 10 months ago |

Flags: needinfo?(afarre)

|  | [pstanciu](/user_profile?user_id=741343) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1755081#c38)• 10 months ago |
|  | |

Backed out for causing permision failures in test\_nested.html

* [Backout link](https://hg.mozilla.org/integration/autoland/rev/7675162f4735f9c6d059df42bab11114e768429e)
* [Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=KNrUaivHSPKINH72MmhWcg.0&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=8de460cdc4edb192fcd73a7d8dfdecb41ae8e1bc)
* [Failure Log](https://treeherder.mozilla.org/logviewer?job_id=452180444&repo=autoland)
Flags: needinfo?(afarre)

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1755081#c39)• 8 months ago |
|  | |

This test will land alongside the tests in [bug 1890748](/show_bug.cgi?id=1890748 "RESOLVED FIXED").

Flags: needinfo?(afarre)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a72473843_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1755081#c40)• 7 months ago |
|  | |

(In reply to Andreas Farre [:farre] from [comment #39](/show_bug.cgi?id=1755081#c39 "RESOLVED FIXED - Cross-origin embeds/objects can obtain permissions of the top-level origin"))

> This test will land alongside the tests in [bug 1890748](/show_bug.cgi?id=1890748 "RESOLVED FIXED").

It looks like [bug 1890748](/show_bug.cgi?id=1890748 "RESOLVED FIXED") landed -- maybe/probably this test can re-land now, too?

(It sounds like maybe you intended to re-land this as part of the same stack, but it doesn't look like that happened, unless the test was moved/renamed.)

Flags: needinfo?(afarre)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1755081#c41)• 7 months ago |
|  | |

Pushed by afarre@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/a91356b00527>
Add tests for more containers. r=smaug

|  | [Treeherder Bug Filer](/user_profile?user_id=573381) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a74777690_573381)• 7 months ago |

Regressions: [1904794](/show_bug.cgi?id=1904794 "ASSIGNED - Intermittent dom/security/featurepolicy/test/mochitest/test_nested.html | single tracking bug")

|  | [Sandor Molnar[:smolnar]](/user_profile?user_id=670045) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1755081#c42)• 7 months ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/a91356b00527>

|  | [Andreas Farre [:farre]](/user_profile?user_id=566192)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1755081#a75286671_566192)• 7 months ago |

Flags: needinfo?(afarre)
You need to [log in](/show_bug.cgi?id=1755081&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Armin Ebert [:arminius]](/user_profile?user_id=526160)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_affb0dd0_20250115_101109.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-17

## Security Vulnerabilities fixed in Firefox ESR 91.9

Announced
May 3, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.9

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Firefox would have allowed them to cover the fullscreen notification UI, which could have enabled browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could have obtained permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Firefox behaved slightly differently for already known resources when loading CSS resources involving CSS variables. This could have been used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe Sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29917: Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Andrew McCreight, Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 99 and Firefox ESR 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 100 and Firefox ESR 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620%2C1764778)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_6cb0cbee_20250115_101110.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-18

## Security Vulnerabilities fixed in Thunderbird 91.9

Announced
May 3, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-1520: Incorrect security status shown after viewing an attached email](#CVE-2022-1520)

Reporter
Thunderbird team
Impact
low
##### Description

When viewing an email message A, which contains an attached message B, where B is encrypted or digitally signed or both, Thunderbird may show an incorrect encryption or signature status. After opening and viewing the attached message B, when returning to the display of message A, the message A might be shown with the security status of message B.

##### References

* [Bug 1745019](https://bugzilla.mozilla.org/show_bug.cgi?id=1745019)

#### [#CVE-2022-29914: Fullscreen notification bypass using popups](#CVE-2022-29914)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When reusing existing popups Thunderbird would allow them to cover the fullscreen notification UI, which could enable browser spoofing attacks.

##### References

* [Bug 1746448](https://bugzilla.mozilla.org/show_bug.cgi?id=1746448)

#### [#CVE-2022-29909: Bypassing permission prompt in nested browsing contexts](#CVE-2022-29909)

Reporter
Armin Ebert
Impact
high
##### Description

Documents in deeply-nested cross-origin browsing contexts could obtain permissions granted to the top-level origin, bypassing the existing prompt and wrongfully inheriting the top-level permissions.

##### References

* [Bug 1755081](https://bugzilla.mozilla.org/show_bug.cgi?id=1755081)

#### [#CVE-2022-29916: Leaking browser history with CSS variables](#CVE-2022-29916)

Reporter
Mateusz Sionkowski
Impact
high
##### Description

Thunderbird would behave slightly differently for already known resources, when loading CSS resources through resolving CSS variables. This could be used to probe the browser history.

##### References

* [Bug 1760674](https://bugzilla.mozilla.org/show_bug.cgi?id=1760674)

#### [#CVE-2022-29911: iframe sandbox bypass](#CVE-2022-29911)

Reporter
Trung Pham
Impact
high
##### Description

An improper implementation of the new iframe sandbox keyword `allow-top-navigation-by-user-activation` could lead to script execution without `allow-scripts` being present.

##### References

* [Bug 1761981](https://bugzilla.mozilla.org/show_bug.cgi?id=1761981)

#### [#CVE-2022-29912: Reader mode bypassed SameSite cookies](#CVE-2022-29912)

Reporter
Matheus Vrech
Impact
moderate
##### Description

Requests initiated through reader mode did not properly omit cookies with a SameSite attribute.

##### References

* [Bug 1692655](https://bugzilla.mozilla.org/show_bug.cgi?id=1692655)

#### [#CVE-2022-29913: Speech Synthesis feature not properly disabled](#CVE-2022-29913)

Reporter
Andrew McCreight
Impact
moderate
##### Description

The parent process would not properly check whether the Speech Synthesis feature is enabled, when receiving instructions from a child process.

##### References

* [Bug 1764778](https://bugzilla.mozilla.org/show_bug.cgi?id=1764778)

#### [#CVE-2022-29917: Memory safety bugs fixed in Thunderbird 91.9](#CVE-2022-29917)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Tom Ritter and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684739%2C1706441%2C1753298%2C1762614%2C1762620)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


