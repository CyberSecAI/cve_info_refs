```json
{
  "CVE-2022-29622": {
    "Description": "An arbitrary file upload vulnerability in formidable v3.2.4 allows attackers to execute arbitrary code via a crafted filename. NOTE: some third parties dispute this issue because the product has common use cases in which uploading arbitrary files is the desired behavior. Also, there are configuration options in all versions that can change the default behavior of how files are handled.",
    "Root cause of vulnerability": "The vulnerability stems from how the `formidable` library handles file extensions when the `keepExtensions` option is enabled. Specifically, the `_getExtension` function, which attempts to extract the file extension, is flawed. It incorrectly identifies the extension based on the position of the first dot (`.`) in the filename instead of the last dot, leading to potential misinterpretation of the file type. For example, a file named `data-<test@example.com>.txt` could be incorrectly identified as having a `.com` extension.",
    "Weaknesses/vulnerabilities": [
      "Improper file extension handling",
      "Incorrect use of indexOf vs lastIndexOf when extracting file extension"
    ],
    "Impact of exploitation": "Attackers could potentially upload files with malicious extensions (e.g., `.com`, `.exe`) that, when processed by a vulnerable application, could be executed, leading to arbitrary code execution. However, it is important to note that the vulnerable component is not the file upload itself, but instead, the sanitization and handling of the filename, specifically the file extension.",
      "Attack vectors": [
          "File upload via web interface",
          "Manipulated filename through other means"
      ],
    "Required attacker capabilities/position": [
      "Ability to upload files to a vulnerable application",
      "Ability to craft a filename that exploits the file extension parsing vulnerability",
      "Knowledge of the target file system"
    ],
      "Additional details": "The vulnerability is not an arbitrary code execution in `formidable` itself. Rather, it's the possibility of code execution in applications using `formidable` if they blindly trust and execute files based on the extracted file extensions (e.g. saving the file with the name that includes the malicious extension, and then running the file using its name or letting the OS run it automatically due to the extension).\n\nSome discussion threads mention the usage of `hexoid` to generate random file names which, while not cryptographically secure, provided a level of protection against direct overwriting, with further discussions mentioning the use of `cuid` for better randomness.\n\nThe vulnerability is not valid in scenarios where the application does not allow uploaded files to be named via their client filenames or if the filename is validated and sanitized before being used. \n\nThe CVE was determined to be invalid and was removed from the various vulnerability databases."
  }
}
```