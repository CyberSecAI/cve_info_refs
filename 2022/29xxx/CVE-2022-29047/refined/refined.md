The provided content is related to CVE-2022-29047.

**Root cause of vulnerability:**

The Pipeline: Deprecated Groovy Libraries Plugin did not properly restrict library retrieval when using the `library` step with a `retriever` argument pointing to a library in the current build's repository and branch. This lack of protection allowed untrusted users to modify pipeline behavior by changing the library behavior in their pull request.

**Weaknesses/vulnerabilities present:**

- Insufficient access control on library retrieval within the plugin

**Impact of exploitation:**

- Attackers can modify the pipeline behavior by changing the library behavior in their pull request, effectively bypassing intended access control mechanisms.
- Attackers can potentially execute malicious code or disrupt the pipeline process

**Attack vectors:**

- An attacker submits a pull request with a modified library.
- The pipeline uses the `library` step with a `retriever` argument pointing to the current buildâ€™s repository and branch.

**Required attacker capabilities/position:**

- Attackers need the ability to submit pull requests (or equivalent)
- Attackers do not need to be able to commit directly to the configured SCM
- The pipeline is configured to not trust the attackers' branch directly.