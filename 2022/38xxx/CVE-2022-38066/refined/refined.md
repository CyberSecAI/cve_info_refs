- **Root cause of vulnerability:** The `start_snmpd` function in the `rc` binary of the Siretta QUARTZ-GOLD router constructs the `/etc/snmpd.conf` file. It includes user-defined custom OIDs as `exec` entries in the configuration file. The values for these OIDs are retrieved from `nvram` and are not properly sanitized before being written to the configuration file. This allows an attacker to inject arbitrary OS commands by setting the values of `custom_oid1` through `custom_oid5`.

- **Weaknesses/vulnerabilities present:** OS Command Injection (CWE-78) due to improper sanitization of user-provided input when creating the SNMP configuration file.

- **Impact of exploitation:** Arbitrary command execution on the router, leading to potential complete compromise of the device. An attacker can execute any command with the privileges of the user running the SNMP daemon.

- **Attack vectors:** An attacker can send a specially crafted HTTP POST request to the routerâ€™s web interface to set the `custom_oid` values with malicious commands. After this, when the custom OID is queried via SNMP, the injected command will be executed.

- **Required attacker capabilities/position:** The attacker must have network access to the router and possess valid credentials to authenticate with the web interface to modify SNMP settings.