=== Content from trac.mplayerhq.hu_28538588_20250114_200415.html ===


[![MPlayer - The Movie Player](https://mplayerhq.hu/mplayer-logo.png)](https://mplayerhq.hu/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/query)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ← [Previous Ticket](/ticket/2402 "Ticket #2402")
* [Next Ticket](/ticket/2404 "Ticket #2404") →

---

Opened [2 years ago](/timeline?from=2022-08-23T09%3A28%3A01Z&precision=second "See timeline at Aug 23, 2022, 9:28:01 AM")

Closed [2 years ago](/timeline?from=2022-08-26T16%3A23%3A27Z&precision=second "See timeline at Aug 26, 2022, 4:23:27 PM")

## [#2403](/ticket/2403) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# A heap-buffer-overflow occurred in function read\_avi\_header() of libmpdemux/aviheader.c

| Reported by: | [ylzs](/query?reporter=ylzs&status=!closed) | Owned by: | [beastd](/query?owner=beastd&status=!closed) |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [undetermined](/query?component=undetermined&status=!closed) |
| Version: | [HEAD](/query?status=!closed&version=HEAD) | Severity: | [major](/query?severity=major&status=!closed) |
| Keywords: |  | Cc: |  |
| Blocked By: |  | Blocking: |  |
| Reproduced by developer: | [no](/query?reproduced=0&status=!closed) | Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |

## Description [(last modified by ylzs)](/ticket/2403?action=diff&version=2 "2022-08-24 08:09:43.536841+00:00")

Version: SVN-r38374-13.0.1

Build command: ../configure --disable-ffmpeg\_a && make (compiling with asan)

Summary of the bug: An heap-buffer-overflow is found in fucnction read\_avi\_header () which affects mencoder and mplayer The attached file can reproduce this issue (ASAN-recompilation is needed).

How to reproduce:

1.Command: ./mencoder -ovc lavc -oac lavc -o /dev/null ./testcase

> ./mplayer ./testcase

2.Result:

```
MPlayer SVN-r38374-9 (C) 2000-2022 MPlayer Team

Playing /home/jlx/crashes/id^%000059,sig^%06,src^%001757,time^%15822098,execs^%776566,op^%havoc,rep^%2.
libavformat version 58.29.100 (external)
AVI file format detected.
[aviheader] Video stream found, -vid 0
[aviheader] Audio stream found, -aid 1

MPlayer interrupted by signal 11 in module: demux_open
- MPlayer crashed by bad usage of CPU/FPU/RAM.
  Recompile MPlayer with --enable-debug and make a 'gdb' backtrace and
  disassembly. Details in DOCS/HTML/en/bugreports_what.html#bugreports_crash.
- MPlayer crashed. This shouldn't happen.
  It can be a bug in the MPlayer code _or_ in your drivers _or_ in your
  gcc version. If you think it's MPlayer's fault, please read
  DOCS/HTML/en/bugreports.html and follow the instructions there. We can't and
  won't help unless you provide this information when reporting a possible bug.

```
```
MPlayer SVN-r38374-13.0.1 (C) 2000-2022 MPlayer Team

Playing /home/jlx/crashes/id^%000059,sig^%06,src^%001757,time^%15822098,execs^%776566,op^%havoc,rep^%2.
libavformat version 58.29.100 (external)
AVI file format detected.
[aviheader] Video stream found, -vid 0
=================================================================
==7938==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000002db0 at pc 0x55c64191557c bp 0x7ffcdbc68090 sp 0x7ffcdbc68088
READ of size 4 at 0x602000002db0 thread T0
    #0 0x55c64191557b in read_avi_header /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:364:12
    #1 0x55c641948cbe in demux_open_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:464:3
    #2 0x55c641948cbe in demux_open_hack_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:885:14
    #3 0x55c641921f37 in demux_open /home/jlx/good_mplayer/mplayer/libmpdemux/demuxer.c:1294:10
    #4 0x55c6416232ed in main /home/jlx/good_mplayer/mplayer/mplayer.c:3383:22
    #5 0x7fa5a6c780b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16

0x602000002db0 is located 31 bytes to the right of 1-byte region [0x602000002d90,0x602000002d91)
allocated by thread T0 here:
    #0 0x55c6415c81cd in malloc (/home/jlx/good_mplayer/asan_mplayer/mplayer+0x3431cd)
    #1 0x55c64190a934 in read_avi_header /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:358:26
    #2 0x55c641948cbe in demux_open_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:464:3
    #3 0x55c641948cbe in demux_open_hack_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:885:14
    #4 0x55c641921f37 in demux_open /home/jlx/good_mplayer/mplayer/libmpdemux/demuxer.c:1294:10
    #5 0x55c6416232ed in main /home/jlx/good_mplayer/mplayer/mplayer.c:3383:22
    #6 0x7fa5a6c780b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:364:12 in read_avi_header
Shadow bytes around the buggy address:
  0x0c047fff8560: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8570: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8580: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8590: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff85a0: fa fa 00 00 fa fa 00 00 fa fa 06 fa fa fa fd fd
=>0x0c047fff85b0: fa fa 01 fa fa fa[fa]fa fa fa fa fa fa fa fa fa
  0x0c047fff85c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff85d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff85e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff85f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7938==ABORTING

```
```
MEncoder SVN-r38374-13.0.1 (C) 2000-2022 MPlayer Team
success: format: 0  data: 0x0 - 0x2aa3
libavformat version 58.29.100 (external)
AVI file format detected.
[aviheader] Video stream found, -vid 0
=================================================================
==6848==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000004370 at pc 0x55e9886b95dc bp 0x7fffc79a7df0 sp 0x7fffc79a7de8
READ of size 4 at 0x602000004370 thread T0
    #0 0x55e9886b95db in read_avi_header /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:364:12
    #1 0x55e9886ecd1e in demux_open_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:464:3
    #2 0x55e9886ecd1e in demux_open_hack_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:885:14
    #3 0x55e9886c5f97 in demux_open /home/jlx/good_mplayer/mplayer/libmpdemux/demuxer.c:1294:10
    #4 0x55e9884711f3 in main /home/jlx/good_mplayer/mplayer/mencoder.c:707:11
    #5 0x7f4b98de10b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16

0x602000004370 is located 31 bytes to the right of 1-byte region [0x602000004350,0x602000004351)
allocated by thread T0 here:
    #0 0x55e98843e43d in malloc (/home/jlx/good_mplayer/asan_mplayer/mencoder+0x1a643d)
    #1 0x55e9886ae994 in read_avi_header /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:358:26
    #2 0x55e9886ecd1e in demux_open_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:464:3
    #3 0x55e9886ecd1e in demux_open_hack_avi /home/jlx/good_mplayer/mplayer/libmpdemux/demux_avi.c:885:14
    #4 0x55e9886c5f97 in demux_open /home/jlx/good_mplayer/mplayer/libmpdemux/demuxer.c:1294:10
    #5 0x55e9884711f3 in main /home/jlx/good_mplayer/mplayer/mencoder.c:707:11
    #6 0x7f4b98de10b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/jlx/good_mplayer/mplayer/libmpdemux/aviheader.c:364:12 in read_avi_header
Shadow bytes around the buggy address:
  0x0c047fff8810: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8820: fa fa 06 fa fa fa 06 fa fa fa 04 fa fa fa 04 fa
  0x0c047fff8830: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8840: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8850: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
=>0x0c047fff8860: fa fa 00 00 fa fa fd fd fa fa 01 fa fa fa[fa]fa
  0x0c047fff8870: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8880: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8890: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff88a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff88b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==6848==ABORTING

```

### Attachments (1)

[testcase](/attachment/ticket/2403/testcase "View attachment")[​](/raw-attachment/ticket/2403/testcase "Download")
(10.7 KB
) - added by ylzs [2 years ago](/timeline?from=2022-08-23T09%3A29%3A08Z&precision=second "See timeline at Aug 23, 2022, 9:29:08 AM").

Download all attachments as:
[.zip](/zip-attachment/ticket/2403/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### by ylzs, [2 years ago](/timeline?from=2022-08-23T09%3A29%3A08Z&precision=second "See timeline at Aug 23, 2022, 9:29:08 AM")

| Attachment: | [*testcase*](/attachment/ticket/2403/testcase)[​](/raw-attachment/ticket/2403/testcase "Download") added |
| --- | --- |

### [comment:1](#comment:1) by ylzs, [2 years ago](/timeline?from=2022-08-24T08%3A08%3A50Z&precision=second "See timeline at Aug 24, 2022, 8:08:50 AM")

| Description: | modified ([diff](/ticket/2403?action=diff&version=1)) |
| --- | --- |

### [comment:2](#comment:2) by ylzs, [2 years ago](/timeline?from=2022-08-24T08%3A09%3A43Z&precision=second "See timeline at Aug 24, 2022, 8:09:43 AM")

| Description: | modified ([diff](/ticket/2403?action=diff&version=2)) |
| --- | --- |

### [comment:3](#comment:3) by reimar, [2 years ago](/timeline?from=2022-08-26T16%3A23%3A27Z&precision=second "See timeline at Aug 26, 2022, 4:23:27 PM")

| Resolution: | → fixed |
| --- | --- |
| Status: | new → closed |

Fixed by r38388.

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/2403?format=rss)
* [Comma-delimited Text](/ticket/2403?format=csv)
* [Tab-delimited Text](/ticket/2403?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from lists.debian.org_6d9e1485_20250114_200413.html ===


---

[[Date Prev](msg00041.html)][[Date Next](msg00043.html)]
[[Thread Prev](msg00041.html)][[Thread Next](msg00043.html)]
[[Date Index](maillist.html#00042)]
[[Thread Index](threads.html#00042)]

# [SECURITY] [DLA 3255-1] mplayer security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3255-1] mplayer security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sat, 31 Dec 2022 12:41:46 +0000 (UTC)
* *Message-id*: <[[🔎]](/msgid-search/alpine.DEB.2.21.2212311236020.8533%40postfach.intern.alteholz.me) [alpine.DEB.2.21.2212311236020.8533@postfach.intern.alteholz.me](msg00042.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3255-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                    Thorsten Alteholz
December 31, 2022                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : mplayer
Version        : 2:1.3.0-8+deb10u1
CVE ID         : CVE-2022-38850 CVE-2022-38851 CVE-2022-38855
                 CVE-2022-38858 CVE-2022-38860 CVE-2022-38861
                 CVE-2022-38863 CVE-2022-38864 CVE-2022-38865
                 CVE-2022-38866

```
Several issues have been found in mplayer, a movie player for Unix-like
systems.
They are basically related to buffer overflows, divide by zero or out of
bounds read in different parts of the code.
```

For Debian 10 buster, these problems have been fixed in version
2:1.3.0-8+deb10u1.

We recommend that you upgrade your mplayer packages.

For the detailed security status of mplayer please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mplayer>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAmOwLgpfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEcSSw//YnUhGZQ3yL66mxKWiDvH3UmetHiRucR93NvU7aEXBeexDIg5QwSTiOgk
AaLIHg/Y5eLJ0XhAk7ID//JIb6xBSpyCUYxesvPpJAagmHwTzndxzcoPFtMXlPxT
MTUUPfJ3H7577J6hTI6XOS83m9TOjkRlTv13UA62snwGNaHnCtlMGrR4QYEv9HW4
sGCdzbI94oAeRP62am4cPsg8zH7z6A2a1T6PObSSrPjN/imBFj+Yt2KmygY8LPAo
j26TlnywgNnclHqfQJ4E3SECwbhNEW5cmLezZ4uky7TnLvzXUG+0Xv13h9v3coOm
LnHXC6QBAFFizgA8ntfo9rwtTHp7asUxoe0+qXS/XDBhK+2calGYS5VA+58hESOz
QP9Zdj/Qu3YlWaz3sThEECePNmU2KZI9yNWKjywr8EIXIncgsEKGfM7TDzXmPE3p
+KBS9yv6KzShSBUGpXEv8ZK7K8RQyieIBWy9AljJzWVndejd5yEgoRJPJNpYZOd3
Tp5bbRRedLio277bMR+FOj571nnSALOIRWS/IuY3KaE/UPGbf7qjSxR5II1i3Bwb
ZD6Ub215L0tIeUAkF3JHiJfSBIPRuCgBqq6Ga7NIb3rWP1QOnHEE+37kx7w76txf
hzmJygl/2gxIW+2YGyRynbR4BgcHx1xsJqbdlxaZfb9RSLi2VRE=
=KrDp
-----END PGP SIGNATURE-----

```

---


