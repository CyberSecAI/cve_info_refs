```
{
  "CVE-2022-38153": {
    "Description": "In wolfSSL 5.3.0 man-in-the-middle attackers or a malicious server can crash TLS 1.2 clients during a handshake. If an attacker injects a large ticket (above 256 bytes) into a NewSessionTicket message in a TLS 1.2 handshake, and the client has a non-empty session cache, the session cache frees a pointer which points to non-allocated memory, causing the client to crash with a “free(): invalid pointer”. Note: It is likely that this is also exploitable in TLS 1.3 handshakes between a client and a malicious server. With TLS 1.3 it is not possible to exploit this as a man-in-the-middle. This bug was discovered using the novel symbolic-model-guided fuzzer tlspuffin.",
    "Root cause of vulnerability": "The vulnerability stems from a flaw in the `AddSessionToCache` function of wolfSSL when handling session tickets and the session cache. A shared global state of session cache was the root cause for the issue, and the lifetime of the session cache should be bound to the TLS context.",
    "Weaknesses/vulnerabilities present": "Use of a shared global state for the session cache across multiple invocations of the library, incorrect handling of memory allocation when a large ticket is received causing `cacheTicBuff` to point to a static buffer (_staticTicket) which is later freed.",
     "Impact of exploitation": "Denial of service (DoS) attack. A client crash due to an invalid free operation.",
    "Attack vectors": "Man-in-the-middle (MitM) attacks on TLS 1.2 clients, or by a malicious server in both TLS 1.2 and 1.3.",
    "Required attacker capabilities/position": "Attacker must be able to inject a modified `NewSessionTicket` message with a large ticket (over 256 bytes) into a TLS handshake. For TLS 1.2, a MitM position is required. For TLS 1.3, a malicious server is required."
  }
}
```