=== Content from www.openwall.com_3d90ed7e_20250114_193512.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <aca73c02-b870-1824-8cd2-515bbaaeebfc@protonmail.com>
Date: Fri, 02 Sep 2022 16:13:36 +0000
From: Art Manion <zmanion@...tonmail.com>
To: oss-security@...ts.openwall.com
Subject: JBIG2 integer overflow fixed in Xpdf 4.04, Poppler 22.09.0

Xpdf 4.04 (released 2022-04-18, CVE-2022-38171):

   <<https://www.cve.org/CVERecord?id=CVE-2022-38171>>

   <<https://gist.github.com/zmanion/b2ed0d1a0cec163ecd07d5e3d9740dc6>>

Poppler 22.09.0 (released 2022-09-01, CVE-2022-38784):

   <<https://www.cve.org/CVERecord?id=CVE-2022-38784>>

   <<https://gitlab.freedesktop.org/poppler/poppler/-/blob/master/NEWS>>

   <<https://gitlab.freedesktop.org/poppler/poppler/-/merge_requests/1261/diffs?commit_id=27354e9d9696ee2bc063910a6c9a6b27c5184a52>>

The lineage of this bug includes a variant used as part of the FORCEDENTRY exploit chain (targeting Apple devices).  The bug readily crashes affected software, code execution is not straightforward and would depend heavily on the context in which affected software is used.

FORCEDENTRY was first discussed publicly in 2021, it took some time to track down the affected OSS components.  Lots of packages are downstream of Xpdf and Poppler.

Crashing test case, use at your own risk:

   <<https://github.com/jeffssh/CVE-2021-30860>>

For background, Apple CoreGraphics fixes released in September 2021 (CVE-2021-30860):

   <<https://www.cve.org/CVERecord?id=CVE-2021-30860>>

   <<https://support.apple.com/en-ca/HT212807>>

   <<https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html>>

Regards,

  - Art

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_7ddf077d_20250115_114719.html ===
# Xpdf JBIG2 integer overflow ([CVE-2022-38171](https://www.cve.org/CVERecord?id=CVE-2022-38171)) and lineage
Released in September 2021, [CVE-2021-30860](https://www.cve.org/CVERecord?id=CVE-2022-30860) fixes an Xpdf integer (then heap) overflow in various Apple operating systems, documented by Apple as affecting CoreGraphics (e.g., [https://support.apple.com/en-us/HT212807](https://support.apple.com/en-us/HT212807)).
Per Google Project Zero's [December 2021 write up](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html) of FORCEDENTRY:
> Most of the CoreGraphics PDF decoder appears to be Apple proprietary code, but the JBIG2 implementation is from Xpdf, the source code for which is freely available.
[CVE-2022-38171](https://www.cve.org/CVERecord?id=CVE-2022-38171) is the ~upstream instance of this vulnerability in Xpdf, fixed in April 2022 in Xpdf 4.04.
Poppler forked an older version of Xpdf 2005 and may backports some changes.
> [Poppler](https://poppler.freedesktop.org/) is a PDF rendering library based on the xpdf-3.0 code base.
[Fixed](https://gitlab.freedesktop.org/poppler/poppler/-/merge\_requests/1261/diffs?commit\_id=27354e9d9696ee2bc063910a6c9a6b27c5184a52) in Poppler [22.09.0](https://gitlab.freedesktop.org/poppler/poppler/-/commit/4602cac96104b74037862e223bb774be26bfd67c) as [CVE-2022-38784](https://www.cve.org/CVERecord?id=CVE-2022-38784).
Plenty of distros include Poppler, Xpdf, and downstream packages. [Notified](https://www.openwall.com/lists/oss-security/2022/09/02/11) oss-security list on 2022-09-02.
This [exploit](https://github.com/jeffssh/CVE-2021-30860) crashes Xpdf (<4.04), Poppler (<22.09.0), and other downstream software. Exploiting the vulnerability to run arbitrary code is context dependent. The Apple instance of the vulnerability (CVE-2021-30860) is used as one link in the FORCEDENTRY exploit chain, to create a weird machine used to set up the next (IMTranscoderAgent) sandbox escape.
Observations:
\* The lack of sufficient CVE IDs and other documentation caused a lot of downstream Xpdf users to not notice the vulnerability or the fix.
\* CVE IDs lack a formal ability to relate to each other (and to other vulnerability identifiers), see [https://github.com/CVEProject/Board-Discussions/issues/10](https://github.com/CVEProject/Board-Discussions/issues/10).
```diff
#
# Fix for CVE-2022-38171 in Xpdf 4.04
#
cd $(mktemp -d)
wget https://dl.xpdfreader.com/xpdf-4.04.tar.gz # this will become https://dl.xpdfreader.com/old/xpdf-4.04.tar.gz
wget https://dl.xpdfreader.com/old/xpdf-4.03.tar.gz
for file in $(ls xpdf\*.tar.gz); do tar xzf $file; done
diff -u xpdf-4.03/CHANGES xpdf-4.04/CHANGES | grep JBIG2
+ # Fixed an integer overflow security hole in the JBIG2 decoder.
diff -u xpdf-4.03/xpdf/JBIG2Stream.cc xpdf-4.04/xpdf/JBIG2Stream.cc
@@ -2042,7 +2057,14 @@
for (i = 0; i < nRefSegs; ++i) {
if ((seg = findSegment(refSegs[i]))) {
if (seg->getType() == jbig2SegSymbolDict) {
- numSyms += ((JBIG2SymbolDict \*)seg)->getSize();
+ Guint segSize = ((JBIG2SymbolDict \*)seg)->getSize();
+ if (segSize > INT\_MAX || numSyms > INT\_MAX - segSize) {
+ error(errSyntaxError, getPos(),
+ "Too many symbols in JBIG2 text region");
+ delete codeTables;
+ return;
+ }
+ numSyms += segSize;
} else if (seg->getType() == jbig2SegCodeTable) {
codeTables->append(seg);
}
```
Or, see this [diff](https://github.com/zmanion/Xpdf/compare/4.03...4.04#diff-a319aeb36a561c1d57b3ecc78f541c4d4ca29dcbf85621f5193f3062df7a88a9R2057).


=== Content from googleprojectzero.blogspot.com_13ed546b_20250114_193515.html ===


# [Project Zero](https://googleprojectzero.blogspot.com/)

News and updates from the Project Zero team at Google

## Wednesday, December 15, 2021

### A deep dive into an NSO zero-click iMessage exploit: Remote Code Execution

Posted by Ian Beer & Samuel Groß of Google Project Zero

We want to thank Citizen Lab for sharing a sample of the FORCEDENTRY exploit with us, and Apple’s Security Engineering and Architecture (SEAR) group for collaborating with us on the technical analysis. The editorial opinions reflected below are solely Project Zero’s and do not necessarily reflect those of the organizations we collaborated with during this research.

Earlier this year, Citizen Lab managed to capture an NSO iMessage-based zero-click exploit being used to target a Saudi activist. In this two-part blog post series we will describe for the first time how an in-the-wild zero-click iMessage exploit works.

Based on our research and findings, we assess this to be one of the most technically sophisticated exploits we've ever seen, further demonstrating that the capabilities NSO provides rival those previously thought to be accessible to only a handful of nation states.

The vulnerability discussed in this blog post was fixed on September 13, 2021 in [iOS 14.8](https://support.apple.com/en-us/HT212807) as CVE-2021-30860.

NSO

[NSO](https://en.wikipedia.org/wiki/NSO_Group)[Group](https://en.wikipedia.org/wiki/NSO_Group) is one of the [highest-profile providers of "access-as-a-service"](https://www.atlanticcouncil.org/in-depth-research-reports/report/countering-cyber-proliferation-zeroing-in-on-access-as-a-service/), selling packaged hacking solutions which [enable nation state actors without a home-grown offensive cyber capability to "pay-to-play"](https://www.atlanticcouncil.org/in-depth-research-reports/issue-brief/surveillance-technology-at-the-fair/), vastly expanding the number of nations with such cyber capabilities.

For years, groups like Citizen Lab and Amnesty International have been tracking the use of NSO's mobile spyware package "Pegasus". Despite NSO's claims that they "[[evaluate] the potential for adverse human rights impacts arising from the misuse of NSO products](https://www.nsogroup.com/governance/human-rights-policy/)" Pegasus has been linked to [the hacking of the New York Times journalist Ben Hubbard by the Saudi regime](https://citizenlab.ca/2020/01/stopping-the-press-new-york-times-journalist-targeted-by-saudi-linked-pegasus-spyware-operator/), [hacking of human rights defenders in Morocco](https://www.amnesty.org/en/latest/research/2019/10/morocco-human-rights-defenders-targeted-with-nso-groups-spyware/) and [Bahrain](https://citizenlab.ca/2021/08/bahrain-hacks-activists-with-nso-group-zero-click-iphone-exploits/), [the targeting of Amnesty International staff](https://www.amnesty.org/en/latest/research/2018/08/amnesty-international-among-targets-of-nso-powered-campaign/) and dozens of other cases.

Last month the United States added NSO to the "Entity List", severely restricting the ability of US companies to do business with NSO and [stating in a press release](https://www.commerce.gov/news/press-releases/2021/11/commerce-adds-nso-group-and-other-foreign-companies-entity-list) that "[NSO's tools] enabled foreign governments to conduct transnational repression, which is the practice of authoritarian governments targeting dissidents, journalists and activists outside of their sovereign borders to silence dissent."

Citizen Lab was able to recover these Pegasus exploits from an iPhone and therefore this analysis covers NSO's capabilities against iPhone. We are aware that NSO sells similar zero-click capabilities which target Android devices; Project Zero does not have samples of these exploits but if you do, please reach out.

From One to Zero

In previous cases such as the [Million Dollar Dissident from 2016](https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/), targets were sent links in SMS messages:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvP0VlEQXC6TZWOu-zPOWC-Pnyy3uqOJpwPeP3Y_rz-ZO_MvrqjiMtMwxzIz_E8NdNyrV_Fvx-RRApoMxAPrYQcHO4eiico20He9zMm3UT5-j84CCRZDJq5hjMmeIKd0aLMsflCkfrfVHp1z1PbQmYPFX6UlVtn6_gF8P6iTQaAHL3EQ6iKs4VDdEZ/s870/image2%281%29.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvP0VlEQXC6TZWOu-zPOWC-Pnyy3uqOJpwPeP3Y_rz-ZO_MvrqjiMtMwxzIz_E8NdNyrV_Fvx-RRApoMxAPrYQcHO4eiico20He9zMm3UT5-j84CCRZDJq5hjMmeIKd0aLMsflCkfrfVHp1z1PbQmYPFX6UlVtn6_gF8P6iTQaAHL3EQ6iKs4VDdEZ/s870/image2%281%29.jpg)

Screenshots of Phishing SMSs reported to Citizen Lab in 2016

source: <https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/>

The target was only hacked when they clicked the link, a technique known as a one-click exploit. Recently, however, it has been documented that NSO is offering their clients zero-click exploitation technology, where even very technically savvy targets who might not click a phishing link are completely unaware they are being targeted. In the zero-click scenario no user interaction is required. Meaning, the attacker doesn't need to send phishing messages; the exploit just works silently in the background. Short of not using a device, there is no way to prevent exploitation by a zero-click exploit; it's a weapon against which there is no defense.

One weird trick

The initial entry point for Pegasus on iPhone is iMessage. This means that a victim can be targeted just using their phone number or AppleID username.

iMessage has native support for GIF images, the typically small and low quality animated images popular in meme culture. You can send and receive GIFs in iMessage chats and they show up in the chat window. Apple wanted to make those GIFs loop endlessly rather than only play once, so very early on in the [iMessage parsing and processing pipeline](https://googleprojectzero.blogspot.com/2021/01/a-look-at-imessage-in-ios-14.html) (after a message has been received but well before the message is shown), iMessage calls the following method in the IMTranscoderAgent process (outside the "BlastDoor" sandbox), passing any image file received with the extension .gif:

  [IMGIFUtils copyGifFromPath:toDestinationPath:error]

Looking at the selector name, the intention here was probably to just copy the GIF file before editing the loop count field, but the semantics of this method are different. Under the hood it uses the CoreGraphics APIs to render the source image to a new GIF file at the destination path. And just because the source filename has to end in .gif, that doesn't mean it's really a GIF file.

The ImageIO library, [as detailed in a previous Project Zero blogpost](https://googleprojectzero.blogspot.com/2020/04/fuzzing-imageio.html), is used to guess the correct format of the source file and parse it, completely ignoring the file extension. Using this "fake gif" trick, over 20 image codecs are suddenly part of the iMessage zero-click attack surface, including some very obscure and complex formats, remotely exposing probably hundreds of thousands of lines of code.

Note: Apple inform us that they have restricted the available ImageIO formats reachable from IMTranscoderAgent starting in iOS 14.8.1 (26 October 2021), and completely removed the GIF code path from IMTranscoderAgent starting in iOS 15.0 (20 September 2021), with GIF decoding taking place entirely within BlastDoor.

A PDF in your GIF

NSO uses the "fake gif" trick to target a vulnerability in the CoreGraphics PDF parser.

PDF was a popular target for exploitation around a decade ago, due to its ubiquity and complexity. Plus, the availability of javascript inside PDFs made development of reliable exploits far easier. The CoreGraphics PDF parser doesn't seem to interpret javascript, but NSO managed to find something equally powerful inside the CoreGraphics PDF parser...

Extreme compression

In the late 1990's, bandwidth and storage were much more scarce than they are now. It was in that environment that the [JBIG2](https://en.wikipedia.org/wiki/JBIG2) standard emerged. JBIG2 is a domain specific image codec designed to compress images where pixels can only be black or white.

It was developed to achieve extremely high compression ratios for scans of text documents and was implemented and used in high-end office scanner/printer devices like the XEROX WorkCenter device shown below. If you used the scan to pdf functionality of a device like this a decade ago, your PDF likely had a JBIG2 stream in it.[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj3gos8L_dEuVS2ltgPw-T3WxC6COMIyYoq4DlSN8Z8XgNueXzXBBlQF_BusBrKSJowwIu0OouJLMwZwPZyMiORoXCShUtbb65C3ZkKU9Tzo8ANc5862ImuSa9v1pjcjxR2v4T-UdpMYlV7DEsVgr43Mj3yAjHn_EXcxVxXFhxHqq1QXoEdP3S1JnRm/s700/image10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj3gos8L_dEuVS2ltgPw-T3WxC6COMIyYoq4DlSN8Z8XgNueXzXBBlQF_BusBrKSJowwIu0OouJLMwZwPZyMiORoXCShUtbb65C3ZkKU9Tzo8ANc5862ImuSa9v1pjcjxR2v4T-UdpMYlV7DEsVgr43Mj3yAjHn_EXcxVxXFhxHqq1QXoEdP3S1JnRm/s700/image10.png)

A Xerox WorkCentre 7500 series multifunction printer, which used JBIG2

for its scan-to-pdf functionality

source: <https://www.office.xerox.com/en-us/multifunction-printers/workcentre-7545-7556/specifications>

The PDFs files produced by those scanners were exceptionally small, perhaps only a few kilobytes. There are two novel techniques which JBIG2 uses to achieve these extreme compression ratios which are relevant to this exploit:

Technique 1: Segmentation and substitution

Effectively every text document, especially those written in languages with small alphabets like English or German, consists of many repeated letters (also known as glyphs) on each page. JBIG2 tries to segment each page into glyphs then uses simple pattern matching to match up glyphs which look the same:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2YXgDQeGK1E3GixB5S11rI1e7Xqi3cQJKuL4ZklPLYw8U1hbbEDXGOyCfcqqhoQT2evw5kHYC3Ba9RWx21XHknWvjxFKg5te5-K19ZYaoTR2wD4AmBw_c-9RXNUuonuD2TT21aTlvihuC_i_t3GgYFjw2pzL7YshGF7BZa4bq-i44V63NN6Pv7yzy/s352/image4%284%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2YXgDQeGK1E3GixB5S11rI1e7Xqi3cQJKuL4ZklPLYw8U1hbbEDXGOyCfcqqhoQT2evw5kHYC3Ba9RWx21XHknWvjxFKg5te5-K19ZYaoTR2wD4AmBw_c-9RXNUuonuD2TT21aTlvihuC_i_t3GgYFjw2pzL7YshGF7BZa4bq-i44V63NN6Pv7yzy/s352/image4%284%29.png)

Simple pattern matching can find all the shapes which look similar on a page,

in this case all the 'e's

JBIG2 doesn't actually know anything about glyphs and it isn't doing OCR (optical character recognition.) A JBIG encoder is just looking for connected regions of pixels and grouping similar looking regions together. The compression algorithm is to simply substitute all sufficiently-similar looking regions with a copy of just one of them:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2k3SPN7fikk3DnL-5YdWTK6_n1JTjvlb6qC-4tVnHeqU16cM6VWYjmMzNL9ZwMK0MXOhWITS_P0kgsx3YFHDaI2Rd5R8f1CM55ccmCBROIlyymNW2jSSCRWCpddWLuIzhGG6uB8PDKcDg5IpWW7NjdvVPZRFme3Hk4EHHmXZwEJYoohHgaVa31w0u/s327/image1%285%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2k3SPN7fikk3DnL-5YdWTK6_n1JTjvlb6qC-4tVnHeqU16cM6VWYjmMzNL9ZwMK0MXOhWITS_P0kgsx3YFHDaI2Rd5R8f1CM55ccmCBROIlyymNW2jSSCRWCpddWLuIzhGG6uB8PDKcDg5IpWW7NjdvVPZRFme3Hk4EHHmXZwEJYoohHgaVa31w0u/s327/image1%285%29.png)

Replacing all occurrences of similar glyphs with a copy of just one often yields a document which is still quite legible and enables very high compression ratios

In this case the output is perfectly readable but the amount of information to be stored is significantly reduced. Rather than needing to store all the original pixel information for the whole page you only need a compressed version of the "reference glyph" for each character and the relative coordinates of all the places where copies should be made. The decompression algorithm then treats the output page like a canvas and "draws" the exact same glyph at all the stored locations.

There's a significant issue with such a scheme: it's far too easy for a poor encoder to accidentally swap similar looking characters, and this can happen with interesting consequences. [D. Kriesel's blog has some motivating examples](http://www.dkriesel.com/en/blog/2013/0802_xerox-workcentres_are_switching_written_numbers_when_scanning) where PDFs of scanned invoices have different figures or PDFs of scanned construction drawings end up with incorrect measurements. These aren't the issues we're looking at, but they are one significant reason why JBIG2 is not a common compression format anymore.

Technique 2: Refinement coding

As mentioned above, the substitution based compression output is lossy. After a round of compression and decompression the rendered output doesn't look exactly like the input. But JBIG2 also supports lossless compression as well as an intermediate "less lossy" compression mode.

It does this by also storing (and compressing) the difference between the substituted glyph and each original glyph. Here's an example showing a difference mask between a substituted character on the left and the original lossless character in the middle:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-7RiEuIp4vanQlf6nxJf1tfbuA7B61DISNjLlNxXrvSqFnqxcvSLPN6_60h2ypZdjDKHtNmCN3Nr5W66JaLw_j5iSxxntOZ0eXFB2wEQHfUjs_9LIwmckCXdTzurtKgpwyaWkGfInvM35YC3kp_K4qyJYxV4HDEf0E9W_Zqt3OelULvnfSlWAc2Kw/s267/image3%285%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-7RiEuIp4vanQlf6nxJf1tfbuA7B61DISNjLlNxXrvSqFnqxcvSLPN6_60h2ypZdjDKHtNmCN3Nr5W66JaLw_j5iSxxntOZ0eXFB2wEQHfUjs_9LIwmckCXdTzurtKgpwyaWkGfInvM35YC3kp_K4qyJYxV4HDEf0E9W_Zqt3OelULvnfSlWAc2Kw/s267/image3%285%29.png)

Using the XOR operator on bitmaps to compute a difference image

In this simple example the encoder can store the difference mask shown on the right, then during decompression the difference mask can be XORed with the substituted character to recover the exact pixels making up the original character. There are some more tricks outside of the scope of this blog post to further compress that difference mask using the intermediate forms of the substituted character as a "context" for the compression.

Rather than completely encoding the entire difference in one go, it can be done in steps, with each iteration using a logical operator (one of AND, OR, XOR or XNOR) to set, clear or flip bits. Each successive refinement step brings the rendered output closer to the original and this allows a level of control over the "lossiness" of the compression. The implementation of these refinement coding steps is very flexible and they are also able to "read" values already present on the output canvas.

A JBIG2 stream

Most of the CoreGraphics PDF decoder appears to be Apple proprietary code, but the JBIG2 implementation is from Xpdf, [the source code for which is freely available](https://www.xpdfreader.com/download.html).

The JBIG2 format is a series of segments, which can be thought of as a series of drawing commands which are executed sequentially in a single pass. The CoreGraphics JBIG2 parser supports 19 different segment types which include operations like defining a new page, decoding a huffman table or rendering a bitmap to given coordinates on the page.

Segments are represented by the class JBIG2Segment and its subclasses JBIG2Bitmap and JBIG2SymbolDict.

A JBIG2Bitmap represents a rectangular array of pixels. Its data field points to a backing-buffer containing the rendering canvas.

A JBIG2SymbolDict groups JBIG2Bitmaps together. The destination page is represented as a JBIG2Bitmap, as are individual glyphs.

JBIG2Segments can be referred to by a segment number and the GList vector type stores pointers to all the JBIG2Segments. To look up a segment by segment number the GList is scanned sequentially.

The vulnerability

The vulnerability is a classic integer overflow when collating referenced segments:

| Guint numSyms; // (1)    numSyms = 0;  for (i = 0; i < nRefSegs; ++i) {  if ((seg = findSegment(refSegs[i]))) {  if (seg->getType() == jbig2SegSymbolDict) {  numSyms += ((JBIG2SymbolDict \*)seg)->getSize();  // (2)  } else if (seg->getType() == jbig2SegCodeTable) {  codeTables->append(seg);  }  } else {  error(errSyntaxError, getPos(),  "Invalid segment reference in JBIG2 text region");  delete codeTables;  return;  }  }  ...  // get the symbol bitmaps  syms = (JBIG2Bitmap \*\*)gmallocn(numSyms, sizeof(JBIG2Bitmap \*)); // (3)    kk = 0;  for (i = 0; i < nRefSegs; ++i) {  if ((seg = findSegment(refSegs[i]))) {  if (seg->getType() == jbig2SegSymbolDict) {  symbolDict = (JBIG2SymbolDict \*)seg;  for (k = 0; k < symbolDict->getSize(); ++k) {  syms[kk++] = symbolDict->getBitmap(k); // (4)  }  }  }  } |
| --- |

numSyms is a 32-bit integer declared at (1). By supplying carefully crafted reference segments it's possible for the repeated addition at (2) to cause numSyms to overflow to a controlled, small value.

That smaller value is used for the heap allocation size at (3) meaning syms points to an undersized buffer.

Inside the inner-most loop at (4) JBIG2Bitmap pointer values are written into the undersized syms buffer.

Without another trick this loop would write over 32GB of data into the undersized syms buffer, certainly causing a crash. To avoid that crash the heap is groomed such that the first few writes off of the end of the syms buffer corrupt the GList backing buffer. This GList stores all known segments and is used by the findSegments routine to map from the segment numbers passed in refSegs to JBIG2Segment pointers. The overflow causes the JBIG2Segment pointers in the GList to be overwritten with JBIG2Bitmap pointers at (4).

Conveniently since JBIG2Bitmap inherits from JBIG2Segment the seg->getType() virtual call succeed even on devices where Pointer Authentication is enabled (which is used to perform a weak type check on virtual calls) but the returned type will now not be equal to jbig2SegSymbolDict thus causing further writes at (4) to not be reached and bounding the extent of the memory corruption.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9fFsg7COjTu5Aq2rV9CTyka-eczC_BvD3wrGUP3XL5W9RHoGOKElzDMbDWLrgp1BJfRvEjcw36ZdMgbA2iwnjj0jqDKGBS94UL2tdcH0evSr66V5uGUrhra3PlGyKvCznPT2rSUL3ZegDR-FXRbKw6SJFzNrgubTbAzKXKVrga6h-B3VcHFqOU9zx/s506/image6%282%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9fFsg7COjTu5Aq2rV9CTyka-eczC_BvD3wrGUP3XL5W9RHoGOKElzDMbDWLrgp1BJfRvEjcw36ZdMgbA2iwnjj0jqDKGBS94UL2tdcH0evSr66V5uGUrhra3PlGyKvCznPT2rSUL3ZegDR-FXRbKw6SJFzNrgubTbAzKXKVrga6h-B3VcHFqOU9zx/s506/image6%282%29.png)

A simplified view of the memory layout when the heap overflow occurs showing the undersized-buffer below the GList backing buffer and the JBIG2Bitmap

Boundless unbounding

Directly after the corrupted segments GList, the attacker grooms the JBIG2Bitmap object which represents the current page (the place to where current drawing commands render).

JBIG2Bitmaps are simple wrappers around a backing buffer, storing the buffer’s width and height (in bits) as well as a line value which defines how many bytes are stored for each line.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0hdaagzsqy4Esf9vjf9KS6euQUhDYTUMu9xDO8q4nxUCbVjpLmxBCJkixLWpg8YETgQNC-2DYLlPss0Eo46knC-qDRI0dLEcOHPvjbwGfaF_E_7EimexamWDy68_id27V2y9k0J2moeJg94okQoOtrMyejAg7bYepIgtdcgNH7NRz7Ne-mWeWs1QA/s1070/image7%282%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0hdaagzsqy4Esf9vjf9KS6euQUhDYTUMu9xDO8q4nxUCbVjpLmxBCJkixLWpg8YETgQNC-2DYLlPss0Eo46knC-qDRI0dLEcOHPvjbwGfaF_E_7EimexamWDy68_id27V2y9k0J2moeJg94okQoOtrMyejAg7bYepIgtdcgNH7NRz7Ne-mWeWs1QA/s1070/image7%282%29.png)

The memory layout of the JBIG2Bitmap object showing the segnum, w, h and line fields which are corrupted during the overflow

By carefully structuring refSegs they can stop the overflow after writing exactly three more JBIG2Bitmap pointers after the end of the segments GList buffer. This overwrites the vtable pointer and the first four fields of the JBIG2Bitmap representing the current page. Due to the nature of the iOS address space layout these pointers are very likely to be in the second 4GB of virtual memory, with addresses between 0x100000000 and 0x1ffffffff. Since all iOS hardware is little endian (meaning that the w and line fields are likely to be overwritten with 0x1 — the most-significant half of a JBIG2Bitmap pointer) and the segNum and h fields are likely to be overwritten with the least-significant half of such a pointer, a fairly random value depending on heap layout and ASLR somewhere between 0x100000 and 0xffffffff.

This gives the current destination page JBIG2Bitmap an unknown, but very large, value for h. Since that h value is used for bounds checking and is supposed to reflect the allocated size of the page backing buffer, this has the effect of "unbounding" the drawing canvas. This means that subsequent JBIG2 segment commands can read and write memory outside of the original bounds of the page backing buffer.

The heap groom also places the current page's backing buffer just below the undersized syms buffer, such that when the page JBIG2Bitmap is unbounded, it's able to read and write its own fields:

---

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidgMVssjmRf7_LhtPKH-MCSJdXOZk5t6EAm-FLazQh5ssP2ksV4kIlzxSIOGz5Elrm8ROuBz92K4-Jthwu4WYa8vN61EgdpB5dbtuCULDRFhqK1TkPOE8xl63p9MAIgf1dNwYKgkYMwlgoNEFcvdDmXy6GdlcRQ5ESrN8d3bAYIEse7dGPQc3cbo8h/s550/image5%282%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidgMVssjmRf7_LhtPKH-MCSJdXOZk5t6EAm-FLazQh5ssP2ksV4kIlzxSIOGz5Elrm8ROuBz92K4-Jthwu4WYa8vN61EgdpB5dbtuCULDRFhqK1TkPOE8xl63p9MAIgf1dNwYKgkYMwlgoNEFcvdDmXy6GdlcRQ5ESrN8d3bAYIEse7dGPQc3cbo8h/s550/image5%282%29.png)

The memory layout showing how the unbounded bitmap backing buffer is able to reference the JBIG2Bitmap object and modify fields in it as it is located after the backing buffer in memory

By rendering 4-byte bitmaps at the correct canvas coordinates they can write to all the fields of the page JBIG2Bitmap and by carefully choosing new values for w, h and line, they can write to arbitrary offsets from the page backing buffer.

At this point it would also be possible to write to arbitrary absolute memory addresses if you knew their offsets from the page backing buffer. But how to compute those offsets? Thus far, this exploit has proceeded in a manner very similar to a "canonical" scripting language exploit which in Javascript might end up with an unbounded ArrayBuffer object with access to memory. But in those cases the attacker has the ability to run arbitrary Javascript which can obviously be used to compute offsets and perform arbitrary computations. How do you do that in a single-pass image parser?

My other compression format is turing-complete!

As mentioned earlier, the sequence of steps which implement JBIG2 refinement are very flexible. Refinement steps can reference both the output bitmap and any previously created segments, as well as render output to either the current page or a segment. By carefully crafting the context-dependent part of the refinement decompression, it's possible to craft sequences of segments where only the refinement combination operators have any effect.

In practice this means it is possible to apply the AND, OR, XOR and XNOR logical operators between memory regions at arbitrary offsets from the current page's JBIG2Bitmap backing buffer. And since that has been unbounded… it's possible to perform those logical operations on memory at arbitrary out-of-bounds offsets:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFkcS4JjzhV7pzJ5kVEmFj7WLW5Zzdc0JkYDaQBhVYIDayiYOksOID0LFOFGr9qQA44qwe3LRN9KNqOelKIflmcTDnR3k6qrtfvJ4wsoTDyuM59nmE6DGM_n_wOUMNY8HoLybtywIMq2-VdeFVwHHc9aDe0tkExa4hfvXKJ6o_m2QYT2LXp4NGDNJI/s551/image9%281%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFkcS4JjzhV7pzJ5kVEmFj7WLW5Zzdc0JkYDaQBhVYIDayiYOksOID0LFOFGr9qQA44qwe3LRN9KNqOelKIflmcTDnR3k6qrtfvJ4wsoTDyuM59nmE6DGM_n_wOUMNY8HoLybtywIMq2-VdeFVwHHc9aDe0tkExa4hfvXKJ6o_m2QYT2LXp4NGDNJI/s551/image9%281%29.png)

The memory layout showing how logical operators can be applied out-of-bounds

It's when you take this to its most extreme form that things start to get really interesting. What if rather than operating on glyph-sized sub-rectangles you instead operated on single bits?

You can now provide as input a sequence of JBIG2 segment commands which implement a sequence of logical bit operations to apply to the page. And since the page buffer has been unbounded those bit operations can operate on arbitrary memory.

With a bit of back-of-the-envelope scribbling you can convince yourself that with just the available AND, OR, XOR and XNOR logical operators you can in fact compute any computable function - the simplest proof being that you can create a logical NOT operator by XORing with 1 and then putting an AND gate in front of that to form a NAND gate:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBpKF2iKJhndHIFtGm9xUBVjpXOM4GYcwSdNyfuUvwI-883zmbnhi_Ch6CR4XEaA6D2uaGkU3g8rNocZS_ZlWXD8rTSRGTgYact6ar43k8ywMZG6hnjDz8Yr3pC3Fh4W3dggIA_XriPw1Vc6myG-18TPe8Ffj_NGuywLqz4tpdlrbMAso-CBZcM_4X/s265/image8%282%29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBpKF2iKJhndHIFtGm9xUBVjpXOM4GYcwSdNyfuUvwI-883zmbnhi_Ch6CR4XEaA6D2uaGkU3g8rNocZS_ZlWXD8rTSRGTgYact6ar43k8ywMZG6hnjDz8Yr3pC3Fh4W3dggIA_XriPw1Vc6myG-18TPe8Ffj_NGuywLqz4tpdlrbMAso-CBZcM_4X/s265/image8%282%29.png)

An AND gate connected to one input of an XOR gate. The other XOR gate input is connected to the constant value 1 creating an NAND.

A NAND gate is an example of a universal logic gate; one from which all other gates can be built and from which a circuit can be [built to compute any computable function](https://www.nand2tetris.org/).

Practical circuits

JBIG2 doesn't have scripting capabilities, but when combined with a vulnerability, it does have the ability to emulate circuits of arbitrary logic gates operating on arbitrary memory. So why not just use that to build your own computer architecture and script that!? That's exactly what this exploit does. Using over 70,000 segment commands defining logical bit operations, they define a small computer architecture with features such as registers and a full 64-bit adder and comparator which they use to search memory and perform arithmetic operations. It's not as fast as Javascript, but it's fundamentally computationally equivalent.

The bootstrapping operations for the sandbox escape exploit are written to run on this logic circuit and the whole thing runs in this weird, emulated environment created out of a single decompression pass through a JBIG2 stream. It's pretty incredible, and at the same time, pretty terrifying.

In a future post (currently being finished), we'll take a look at exactly how they escape the IMTranscoderAgent sandbox.

Posted by
Anonymous

at

[9:00 AM](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4838136820032157985&postID=5073082417618502919&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5073082417618502919&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5073082417618502919&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5073082417618502919&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5073082417618502919&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5073082417618502919&target=pinterest "Share to Pinterest")

#### No comments:

#### Post a Comment

[Newer Post](https://googleprojectzero.blogspot.com/2022/01/zooming-in-on-zero-click-exploits.html "Newer Post")

[Older Post](https://googleprojectzero.blogspot.com/2021/12/this-shouldnt-have-happened.html "Older Post")

[Home](https://googleprojectzero.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://googleprojectzero.blogspot.com/feeds/5073082417618502919/comments/default)

## Search This Blog

|  |  |
| --- | --- |

## Pages

* [About Project Zero](https://googleprojectzero.blogspot.com/p/about-project-zero.html)
* [Working at Project Zero](https://googleprojectzero.blogspot.com/p/working-at-project-zero.html)
* [0day "In the Wild"](https://googleprojectzero.blogspot.com/p/0day.html)
* [0day Exploit Root Cause Analyses](https://googleprojectzero.github.io/0days-in-the-wild/rca.html)
* [Vulnerability Disclosure FAQ](https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html)

## Archives

* ►
  [2024](https://googleprojectzero.blogspot.com/2024/)
  (12)
  + ►
    [December](https://googleprojectzero.blogspot.com/2024/12/)
    (3)
  + ►
    [November](https://googleprojectzero.blogspot.com/2024/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2024/10/)
    (2)
  + ►
    [June](https://googleprojectzero.blogspot.com/2024/06/)
    (3)
  + ►
    [April](https://googleprojectzero.blogspot.com/2024/04/)
    (2)

* ►
  [2023](https://googleprojectzero.blogspot.com/2023/)
  (11)
  + ►
    [November](https://googleprojectzero.blogspot.com/2023/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2023/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2023/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2023/08/)
    (4)
  + ►
    [April](https://googleprojectzero.blogspot.com/2023/04/)
    (1)
  + ►
    [March](https://googleprojectzero.blogspot.com/2023/03/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2023/01/)
    (2)

* ►
  [2022](https://googleprojectzero.blogspot.com/2022/)
  (17)
  + ►
    [December](https://googleprojectzero.blogspot.com/2022/12/)
    (1)
  + ►
    [November](https://googleprojectzero.blogspot.com/2022/11/)
    (3)
  + ►
    [October](https://googleprojectzero.blogspot.com/2022/10/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2022/08/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2022/06/)
    (3)
  + ►
    [May](https://googleprojectzero.blogspot.com/2022/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2022/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2022/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2022/02/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2022/01/)
    (1)

* ▼
  [2021](https://googleprojectzero.blogspot.com/2021/)
  (24)
  + ▼
    [December](https://googleprojectzero.blogspot.com/2021/12/)
    (2)
    - [A deep dive into an NSO zero-click iMessage exploi...](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html)
    - [This shouldn't have happened: A vulnerability post...](https://googleprojectzero.blogspot.com/2021/12/this-shouldnt-have-happened.html)
  + ►
    [October](https://googleprojectzero.blogspot.com/2021/10/)
    (3)
  + ►
    [September](https://googleprojectzero.blogspot.com/2021/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2021/08/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2021/06/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2021/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2021/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2021/03/)
    (1)
  + ►
    [February](https://googleprojectzero.blogspot.com/2021/02/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2021/01/)
    (10)

* ►
  [2020](https://googleprojectzero.blogspot.com/2020/)
  (36)
  + ►
    [December](https://googleprojectzero.blogspot.com/2020/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2020/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2020/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2020/09/)
    (4)
  + ►
    [August](https://googleprojectzero.blogspot.com/2020/08/)
    (5)
  + ►
    [July](https://googleprojectzero.blogspot.com/2020/07/)
    (8)
  + ►
    [June](https://googleprojectzero.blogspot.com/2020/06/)
    (2)
  + ►
    [April](https://googleprojectzero.blogspot.com/2020/04/)
    (3)
  + ►
    [February](https://googleprojectzero.blogspot.com/2020/02/)
    (4)
  + ►
    [January](https://googleprojectzero.blogspot.com/2020/01/)
    (5)

* ►
  [2019](https://googleprojectzero.blogspot.com/2019/)
  (27)
  + ►
    [December](https://googleprojectzero.blogspot.com/2019/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2019/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2019/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2019/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2019/08/)
    (11)
  + ►
    [May](https://googleprojectzero.blogspot.com/2019/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2019/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2019/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2019/02/)
    (2)
  + ►
    [January](https://googleprojectzero.blogspot.com/2019/01/)
    (2)

* ►
  [2018](https://googleprojectzero.blogspot.com/2018/)
  (22)
  + ►
    [December](https://googleprojectzero.blogspot.com/2018/12/)
    (7)
  + ►
    [November](https://googleprojectzero.blogspot.com/2018/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2018/10/)
    (4)
  + ►
    [September](https://googleprojectzero.blogspot.com/2018/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2018/08/)
    (3)
  + ►
    [July](https://googleprojectzero.blogspot.com/2018/07/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2018/06/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2018/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2018/04/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2018/01/)
    (1)

* ►
  [2017](https://googleprojectzero.blogspot.com/2017/)
  (19)
  + ►
    [December](https://googleprojectzero.blogspot.com/2017/12/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2017/10/)
    (3)
  + ►
    [September](https://googleprojectzero.blogspot.com/2017/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2017/08/)
    (2)
  + ►
    [July](https://googleprojectzero.blogspot.com/2017/07/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2017/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2017/04/)
    (6)
  + ►
    [March](https://googleprojectzero.blogspot.com/2017/03/)
    (1)
  + ►
    [February](https://googleprojectzero.blogspot.com/2017/02/)
    (2)

* ►
  [2016](https://googleprojectzero.blogspot.com/2016/)
  (17)
  + ►
    [December](https://googleprojectzero.blogspot.com/2016/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2016/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2016/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2016/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2016/08/)
    (1)
  + ►
    [July](https://googleprojectzero.blogspot.com/2016/07/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2016/06/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2016/03/)
    (3)
  + ►
    [February](https://googleprojectzero.blogspot.com/2016/02/)
    (2)
  + ►
    [January](https://googleprojectzero.blogspot.com/2016/01/)
    (1)

* ►
  [2015](https://googleprojectzero.blogspot.com/2015/)
  (33)
  + ►
    [December](https://googleprojectzero.blogspot.com/2015/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2015/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2015/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2015/09/)
    (4)
  + ►
    [August](https://googleprojectzero.blogspot.com/2015/08/)
    (6)
  + ►
    [July](https://googleprojectzero.blogspot.com/2015/07/)
    (5)
  + ►
    [June](https://googleprojectzero.blogspot.com/2015/06/)
    (4)
  + ►
    [May](https://googleprojectzero.blogspot.com/2015/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2015/04/)
    (1)
  + ►
    [March](https://googleprojectzero.blogspot.com/2015/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2015/02/)
    (3)
  + ►
    [January](https://googleprojectzero.blogspot.com/2015/01/)
    (2)

* ►
  [2014](https://googleprojectzero.blogspot.com/2014/)
  (11)
  + ►
    [December](https://googleprojectzero.blogspot.com/2014/12/)
    (1)
  + ►
    [November](https://googleprojectzero.blogspot.com/2014/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2014/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2014/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2014/08/)
    (2)
  + ►
    [July](https://googleprojectzero.blogspot.com/2014/07/)
    (3)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).



=== Content from www.xpdfreader.com_413f36d8_20250114_193512.html ===

[![](img/xpdf-icon.png)XpdfReader](index.html)
![](img/menu-btn.png)

* [About](about.html)* [Download](download.html)* [Support](support.html)* [Forum](http://forum.xpdfreader.com/)* [XpdfWidget](XpdfWidget.html)* [Open Source](opensource.html)* [Contact](contact.html)* Close menu

# Xpdf Security Fixes

Reported security bugs in Xpdf:

* CVE-2018-7173: fixed in 4.01 [JBIG2Stream.cc]
* CVE-2018-7174: PDF object loop in XRef::readXRef; fixed in 4.01
  [XRef.cc] - [bug
  description](security-bug/object-loops.html)
* CVE-2018-7175: fixed in 4.01 [JPXStream.cc]
* CVE-2018-7452: fixed in 4.01 [JPXStream.cc]
* CVE-2018-7453: PDF object loop in AcroForm::scanField; fixed in
  4.05 - [bug description](security-bug/object-loops.html)
* CVE-2018-7454: fixed in 4.01 [XFAForm.cc]
* CVE-2018-7455: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8100: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8101: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8102: fixed in 4.01 [JBIG2Stream.cc]
* CVE-2018-8103: fixed in 4.01 [JBIG2Stream.cc]
* CVE-2018-8104: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8105: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8106: fixed in 4.01 [JPXStream.cc]
* CVE-2018-8107: fixed in 4.01 [JPXStream.cc]
* CVE-2018-11033: fixed in 4.00
* CVE-2018-16368: fixed in 4.01 [Splash.cc]
* CVE-2018-16369: PDF object loop in AcroForm::scanField; fixed in
  4.05 - [bug description](security-bug/object-loops.html)
* CVE-2018-18454: fixed in 4.01 [Stream.cc]
* CVE-2018-18455: fixed in 4.01 [GfxState.cc]
* CVE-2018-18456: fixed in 4.01 [Gfx.cc]
* CVE-2018-18457: fixed in 4.01 [Stream.cc]
* CVE-2018-18458: fixed in 4.01 [Stream.cc]
* CVE-2018-18459: fixed in 4.01 [Stream.cc]
* CVE-2018-18650: reporting an out-of-memory errors is the proper response
* CVE-2018-18651: fixed in 4.01 [Catalog.cc]
* CVE-2019-9587: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2019-9588: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2019-9589: fixed in 4.02 [PSOutputDev.cc]
* CVE-2019-9877: fixed in 4.02 [Lexer.cc]
* CVE-2019-10020 / CVE-2019-10021 / CVE-2019-10024 / CVE-2019-10025: fixed in 4.02 [Gfx.cc]
* CVE-2019-12360: fixed in 4.02 [FoFiTrueType.cc]
* CVE-2019-12493: fixed in 4.02 [GfxState.cc]
* CVE-2019-12515: fixed in 4.02 [Gfx.cc]
* CVE-2019-12957: fixed in 4.02 [FoFiType1C.cc]
* CVE-2019-12958: fixed in 4.02 [FoFiType1C.cc]
* CVE-2019-13281: fixed in 4.02 [Stream.cc]
* CVE-2019-13282: fixed in 4.02 [Function.cc]
* CVE-2019-13283: fixed in 4.02 [FoFiType1.cc]
* CVE-2019-13286: fixed in 4.02 [JBIG2Stream.cc]
* CVE-2019-13287: fixed in 4.02 [Gfx.cc]
* CVE-2019-13288: PDF object loop in Parser::makeStream /
  Object::fetch; fixed in 4.02 -
  [bug description](security-bug/object-loops.html)
* CVE-2019-13289: fixed in 4.02 [JBIG2Stream.cc]
* CVE-2019-13291: fixed in 4.02 [Stream.cc]
* CVE-2019-14288 / CVE-2019-14289: fixed in 4.02 [JBIG2Stream.cc]
* CVE-2019-14290 / CVE-2019-14291 / CVE-2019-14292 / CVE-2019-14293:
  fixed in 4.02 [GfxState.cc]
* CVE-2019-14294: fixed in 4.02 [JPXStream.cc, JPXStream.h]
* CVE-2019-15860: old bug in 2.00, no longer relevant
* CVE-2019-16088: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2020-25725: fixed in 4.03 [SplashOutputDev.cc]
* CVE-2020-35376: fixed in 4.03 [FoFiType1C.cc]
* CVE-2022-24106: logic bug in DCT (JPEG) decoder led to invalid
  memory access; reported by Shin Ando @ Ricera Security; fixed in
  4.04 [Stream.cc]
* CVE-2022-24107: logic bug in JPX (JPEG 2000) decoder led to integer
  overflow; reported by Shin Ando @ Ricera Security; fixed in 4.04
  [JPXStream.cc]
* CVE-2022-30524: logic bug in text extractor led to invalid memory
  access; reported by elvadisas; fixed in 4.05 [TextOutputDev.cc]
* CVE-2022-30775: integer overflow in rasterizer; reported by
  elvadisas; fixed in 4.05 [SplashOutputDev.cc]
* CVE-2022-33108: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2022-36561: PDF object loop in AcroForm::scanField; fixed in
  4.05 - [bug description](security-bug/object-loops.html)
* CVE-2022-38171: JBIG decoder bug; related to CVE-2021-30860; fixed
  in 4.04 [JBIG2Stream.cc]
* CVE-2022-38222: logic bug in JBIG2 decoder; reported by Han Zheng
  (NCNIPC of China, Hexhive); fixed in 4.05 [JBIG2Stream.cc]
* CVE-2022-38334: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2022-38928: missing bounds check in CFF font converter caused
  null pointer dereference; reported by cyth; fixed in 4.05
  [FoFiType1C.cc]
* CVE-2022-41842: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2022-41843: missing bounds check in CFF font parser caused
  invalid memory access; reported by Yuhang Huang (NCNIPC of China),
  Han Zheng (NCNIPC of China, Hexhive), Wanying Cao, Jiayu Zhao
  (NCNIPC of China); fixed in 4.05 [FoFiType1C.cc]
* CVE-2022-41844: PDF object loop in AcroForm::scanField; fixed in
  4.05 - [bug description](security-bug/object-loops.html)
* CVE-2022-43071: PDF object loop in Catalog::readPageLabelTree2;
  fixed in 4.05 - [bug
  description](security-bug/object-loops.html)
* CVE-2022-43295: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2022-45586: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2022-45587: PDF object loop in Catalog::countPageTree; fixed in
  4.05 [Catalog.cc] -
  [bug description](security-bug/object-loops.html)
* CVE-2023-2662: Divide-by-zero in Xpdf 4.04 due to bad color space
  object; fixed in 4.05 -
  [bug description](security-bug/CVE-2023-2662.html)
* CVE-2023-2663: PDF object loop in Catalog::readPageLabelTree2; fixed
  in 4.05 - [bug
  description](security-bug/object-loops.html)
* CVE-2023-2664: PDF object loop in Catalog::readEmbeddedFileTree;
  fixed in 4.05 - [bug
  description](security-bug/object-loops.html)
* CVE-2023-3044: Divide-by-zero in Xpdf 4.04 due to very large page
  size; fixed in 4.05 - [bug
  description](security-bug/CVE-2023-3044.html)
* CVE-2023-3436: Deadlock in Xpdf 4.04 due to PDF object stream
  references; fixed in 4.05 -
  [bug description](security-bug/CVE-2023-3436.html)
* CVE-2024-2971: Out-of-bounds array write in Xpdf 4.05 due to
  negative object number in indirect reference; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-2971.html)
* CVE-2024-3247: PDF object loop in object stream; will be fixed in
  4.06 - [bug description](security-bug/object-loops.html)
* CVE-2024-3248: PDF object loop in Catalog::readFileAttachmentAnnots;
  will be fixed in 4.06 - [bug
  description](security-bug/object-loops.html)
* CVE-2024-3900: Out-of-bounds stack array write in Xpdf 4.05 due to
  missing zero check; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-3900.html)
* CVE-2024-4141: Out-of-bounds array write in Xpdf 4.05 due to
  incorrect bounds check; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-4141.html)
* CVE-2024-4568: PDF object loop in PSOutputDev::setupResources;
  will be fixed in 4.06 - [bug
  description](security-bug/object-loops.html)
* CVE-2024-4976: Out-of-bounds array write due to missing object type
  check; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-4976.html)
* CVE-2024-7866: PDF object loop in Gfx::drawForm; will be fixed in
  4.06 - [bug description](security-bug/object-loops.html)
* CVE-2024-7867: Integer overflow and divide-by-zero due to extremely
  large coordinates in page boxes; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-7867.html)
* CVE-2024-7868: Invalid memory read due to uninitialized variable in
  DCT decoder; will be fixed in 4.06 -
  [bug description](security-bug/CVE-2024-7868.html)

Copyright 2025 Glyph & Cog, LLC



=== Content from github.com_2a0ad00b_20250114_193515.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzmanion%2FVulnerabilities%2Fblob%2Fmain%2FCVE-2022-38171.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzmanion%2FVulnerabilities%2Fblob%2Fmain%2FCVE-2022-38171.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=zmanion%2FVulnerabilities)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zmanion](/zmanion)
/
**[Vulnerabilities](/zmanion/Vulnerabilities)**
Public

* [Notifications](/login?return_to=%2Fzmanion%2FVulnerabilities) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fzmanion%2FVulnerabilities)
* [Star
   1](/login?return_to=%2Fzmanion%2FVulnerabilities)

* [Code](/zmanion/Vulnerabilities)
* [Issues
  0](/zmanion/Vulnerabilities/issues)
* [Pull requests
  0](/zmanion/Vulnerabilities/pulls)
* [Discussions](/zmanion/Vulnerabilities/discussions)
* [Actions](/zmanion/Vulnerabilities/actions)
* [Projects
  0](/zmanion/Vulnerabilities/projects)
* [Security](/zmanion/Vulnerabilities/security)
* [Insights](/zmanion/Vulnerabilities/pulse)

Additional navigation options

* [Code](/zmanion/Vulnerabilities)
* [Issues](/zmanion/Vulnerabilities/issues)
* [Pull requests](/zmanion/Vulnerabilities/pulls)
* [Discussions](/zmanion/Vulnerabilities/discussions)
* [Actions](/zmanion/Vulnerabilities/actions)
* [Projects](/zmanion/Vulnerabilities/projects)
* [Security](/zmanion/Vulnerabilities/security)
* [Insights](/zmanion/Vulnerabilities/pulse)

## Files

 main
## Breadcrumbs

1. [Vulnerabilities](/zmanion/Vulnerabilities/tree/main)
/
# CVE-2022-38171.md

Copy path Blame  Blame
## Latest commit

## History

[History](/zmanion/Vulnerabilities/commits/main/CVE-2022-38171.md)57 lines (44 loc) · 3.48 KB main
## Breadcrumbs

1. [Vulnerabilities](/zmanion/Vulnerabilities/tree/main)
/
# CVE-2022-38171.md

Top
## File metadata and controls

* Preview
* Code
* Blame

57 lines (44 loc) · 3.48 KB[Raw](https://github.com/zmanion/Vulnerabilities/raw/refs/heads/main/CVE-2022-38171.md)
# Xpdf JBIG2 integer overflow ([CVE-2022-38171](https://www.cve.org/CVERecord?id=CVE-2022-38171)) and lineage

Released in September 2021, [CVE-2021-30860](https://www.cve.org/CVERecord?id=CVE-2022-30860) fixes an Xpdf integer (then heap) overflow in various Apple operating systems, documented by Apple as affecting CoreGraphics (e.g., <https://support.apple.com/en-us/HT212807>).

Per Google Project Zero's [December 2021 write up](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html) of FORCEDENTRY:

> Most of the CoreGraphics PDF decoder appears to be Apple proprietary code, but the JBIG2 implementation is from Xpdf, the source code for which is freely available.

[CVE-2022-38171](https://www.cve.org/CVERecord?id=CVE-2022-38171) is the ~upstream instance of this vulnerability in Xpdf, fixed in April 2022 in Xpdf 4.04.

Poppler forked an older version of Xpdf 2005 and may backports some changes.

> [Poppler](https://poppler.freedesktop.org/) is a PDF rendering library based on the xpdf-3.0 code base.

[Fixed](https://gitlab.freedesktop.org/poppler/poppler/-/merge_requests/1261/diffs?commit_id=27354e9d9696ee2bc063910a6c9a6b27c5184a52) in Poppler [22.09.0](https://gitlab.freedesktop.org/poppler/poppler/-/commit/4602cac96104b74037862e223bb774be26bfd67c) as [CVE-2022-38784](https://www.cve.org/CVERecord?id=CVE-2022-38784).

Plenty of distros include Poppler, Xpdf, and downstream packages. [Notified](https://www.openwall.com/lists/oss-security/2022/09/02/11) oss-security list on 2022-09-02.

This [exploit](https://github.com/jeffssh/CVE-2021-30860) crashes Xpdf (<4.04), Poppler (<22.09.0), and other downstream software. Exploiting the vulnerability to run arbitrary code is context dependent. The Apple instance of the vulnerability (CVE-2021-30860) is used as one link in the FORCEDENTRY exploit chain, to create a weird machine used to set up the next (IMTranscoderAgent) sandbox escape.

Observations:

* The lack of sufficient CVE IDs and other documentation caused a lot of downstream Xpdf users to not notice the vulnerability or the fix.
* CVE IDs lack a formal ability to relate to each other (and to other vulnerability identifiers), see [CVEProject/Board-Discussions#10](https://github.com/CVEProject/Board-Discussions/issues/10).

```
#
# Fix for CVE-2022-38171 in Xpdf 4.04
#
cd $(mktemp -d)
wget https://dl.xpdfreader.com/xpdf-4.04.tar.gz # this will become https://dl.xpdfreader.com/old/xpdf-4.04.tar.gz
wget https://dl.xpdfreader.com/old/xpdf-4.03.tar.gz
for file in $(ls xpdf*.tar.gz); do tar xzf $file; done

diff -u xpdf-4.03/CHANGES xpdf-4.04/CHANGES | grep JBIG2
+ # Fixed an integer overflow security hole in the JBIG2 decoder.

diff -u xpdf-4.03/xpdf/JBIG2Stream.cc xpdf-4.04/xpdf/JBIG2Stream.cc
<snip>
@@ -2042,7 +2057,14 @@
   for (i = 0; i < nRefSegs; ++i) {
     if ((seg = findSegment(refSegs[i]))) {
       if (seg->getType() == jbig2SegSymbolDict) {
-	numSyms += ((JBIG2SymbolDict *)seg)->getSize();
+	Guint segSize = ((JBIG2SymbolDict *)seg)->getSize();
+	if (segSize > INT_MAX || numSyms > INT_MAX - segSize) {
+	  error(errSyntaxError, getPos(),
+		"Too many symbols in JBIG2 text region");
+	  delete codeTables;
+	  return;
+	}
+	numSyms += segSize;
       } else if (seg->getType() == jbig2SegCodeTable) {
 	codeTables->append(seg);
       }
<snip>
```

Or, see this [diff](https://github.com/zmanion/Xpdf/compare/4.03...4.04#diff-a319aeb36a561c1d57b3ecc78f541c4d4ca29dcbf85621f5193f3062df7a88a9R2057).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ba85f4d0_20250114_193514.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjeffssh%2FCVE-2021-30860)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjeffssh%2FCVE-2021-30860)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=jeffssh%2FCVE-2021-30860)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jeffssh](/jeffssh)
/
**[CVE-2021-30860](/jeffssh/CVE-2021-30860)**
Public

* [Notifications](/login?return_to=%2Fjeffssh%2FCVE-2021-30860) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Fjeffssh%2FCVE-2021-30860)
* [Star
   95](/login?return_to=%2Fjeffssh%2FCVE-2021-30860)

Collection of materials relating to FORCEDENTRY

[95
stars](/jeffssh/CVE-2021-30860/stargazers) [24
forks](/jeffssh/CVE-2021-30860/forks) [Branches](/jeffssh/CVE-2021-30860/branches) [Tags](/jeffssh/CVE-2021-30860/tags) [Activity](/jeffssh/CVE-2021-30860/activity)
 [Star](/login?return_to=%2Fjeffssh%2FCVE-2021-30860)

 [Notifications](/login?return_to=%2Fjeffssh%2FCVE-2021-30860) You must be signed in to change notification settings

* [Code](/jeffssh/CVE-2021-30860)
* [Issues
  0](/jeffssh/CVE-2021-30860/issues)
* [Pull requests
  0](/jeffssh/CVE-2021-30860/pulls)
* [Actions](/jeffssh/CVE-2021-30860/actions)
* [Projects
  0](/jeffssh/CVE-2021-30860/projects)
* [Security](/jeffssh/CVE-2021-30860/security)
* [Insights](/jeffssh/CVE-2021-30860/pulse)

Additional navigation options

* [Code](/jeffssh/CVE-2021-30860)
* [Issues](/jeffssh/CVE-2021-30860/issues)
* [Pull requests](/jeffssh/CVE-2021-30860/pulls)
* [Actions](/jeffssh/CVE-2021-30860/actions)
* [Projects](/jeffssh/CVE-2021-30860/projects)
* [Security](/jeffssh/CVE-2021-30860/security)
* [Insights](/jeffssh/CVE-2021-30860/pulse)

# jeffssh/CVE-2021-30860

    master[Branches](/jeffssh/CVE-2021-30860/branches)[Tags](/jeffssh/CVE-2021-30860/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[6 Commits](/jeffssh/CVE-2021-30860/commits/master/) | | |
| [docker](/jeffssh/CVE-2021-30860/tree/master/docker "docker") | | [docker](/jeffssh/CVE-2021-30860/tree/master/docker "docker") |  |  |
| [calc.gif](/jeffssh/CVE-2021-30860/blob/master/calc.gif "calc.gif") | | [calc.gif](/jeffssh/CVE-2021-30860/blob/master/calc.gif "calc.gif") |  |  |
| [poc.pdf](/jeffssh/CVE-2021-30860/blob/master/poc.pdf "poc.pdf") | | [poc.pdf](/jeffssh/CVE-2021-30860/blob/master/poc.pdf "poc.pdf") |  |  |
| View all files | | |

## About

Collection of materials relating to FORCEDENTRY

[Activity](/jeffssh/CVE-2021-30860/activity)
### Stars

[**95**
stars](/jeffssh/CVE-2021-30860/stargazers)
### Watchers

[**5**
watching](/jeffssh/CVE-2021-30860/watchers)
### Forks

[**24**
forks](/jeffssh/CVE-2021-30860/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fjeffssh%2FCVE-2021-30860&report=jeffssh+%28user%29)

## [Releases](/jeffssh/CVE-2021-30860/releases)

No releases published

## [Packages 0](/users/jeffssh/packages?repo_name=CVE-2021-30860)

No packages published

## Languages

* [Python
  77.8%](/jeffssh/CVE-2021-30860/search?l=python)
* [Objective-C
  19.5%](/jeffssh/CVE-2021-30860/search?l=objective-c)
* [Swift
  2.7%](/jeffssh/CVE-2021-30860/search?l=swift)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


