=== Content from trac.mplayerhq.hu_0321fbcd_20250115_093434.html ===


[![MPlayer - The Movie Player](https://mplayerhq.hu/mplayer-logo.png)](https://mplayerhq.hu/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/query)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ← [Previous Ticket](/ticket/2398 "Ticket #2398")
* [Next Ticket](/ticket/2400 "Ticket #2400") →

---

Opened [2 years ago](/timeline?from=2022-08-23T08%3A22%3A39Z&precision=second "See timeline at Aug 23, 2022, 8:22:39 AM")

Closed [2 years ago](/timeline?from=2022-08-26T20%3A26%3A06Z&precision=second "See timeline at Aug 26, 2022, 8:26:06 PM")

## [#2399](/ticket/2399) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# A Division by zero occurred in the function config () of llibmpcodecs/vf\_scale.c

| Reported by: | [ylzs](/query?reporter=ylzs&status=!closed) | Owned by: | [beastd](/query?owner=beastd&status=!closed) |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [mencoder](/query?component=mencoder&status=!closed) |
| Version: | [unspecified](/query?status=!closed&version=unspecified) | Severity: | [major](/query?severity=major&status=!closed) |
| Keywords: |  | Cc: |  |
| Blocked By: |  | Blocking: |  |
| Reproduced by developer: | [no](/query?reproduced=0&status=!closed) | Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |

## Description [(last modified by ylzs)](/ticket/2399?action=diff&version=2 "2022-08-23 08:32:34.185235+00:00")

Version: SVN-r38374-13.0.1

Build command: ../configure --disable-ffmpeg\_a && make (compiling with asan)

Summary of the bug: An division by zero is found in fucnction config () which affects mencoder. The attached file can reproduce this issue (ASAN-recompilation is needed).

How to reproduce:

1.Command: ./mencoder -ovc lavc -oac lavc -o /dev/null ./testcase

2.Result:

```
MEncoder SVN-r38374-13.0.1 (C) 2000-2022 MPlayer Team
success: format: 0  data: 0x0 - 0x60c
libavformat version 58.29.100 (external)
libavformat file format detected.
[mov,mp4,m4a,3gp,3g2,mj2 @ 0x7fcbe8798600]overread end of atom 'colr' by 10 bytes
[mov,mp4,m4a,3gp,3g2,mj2 @ 0x7fcbe8798600]reached eof, corrupted STCO atom
[mov,mp4,m4a,3gp,3g2,mj2 @ 0x7fcbe8798600]error reading header
LAVF_header: av_open_input_stream() failed
ISO: File Type Major Brand: Original QuickTime
Quicktime/MOV file format detected.
MOV: durmap and chunkmap sample count differ (1 vs 232)
[mov] Video stream found, -vid 0
[mov] Audio stream found, -aid 1
VIDEO:  []  224x2  0bpp  13.000 fps    0.0 kbps ( 0.0 kbyte/s)
[V] filefmt:7  fourcc:0x0  size:224x2  fps:13.000  ftime:=0.0769
libavcodec version 58.54.100 (external)
Opening video filter: [expand osd=1]
Expand: -1 x -1, -1 ; -1, osd: 1, aspect: 0.000000, round: 1
==========================================================================
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
[rawvideo @ 0x7fcbe7d194c0]Invalid pixel format.
Could not open codec.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
RAW: depth 0 not supported
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [raw] RAW Uncompressed Video
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
Movie-Aspect is inf:1 - prescaling to correct movie aspect.
[swscaler @ 0x7fcbe886f000]bicubic scaler, from yuyv422 to yuv420p using MMXEXT
[swscaler @ 0x7fcbe886f000]using unscaled yuyv422 -> yuv420p special converter
AddressSanitizer:DEADLYSIGNAL
=================================================================
==24938==ERROR: AddressSanitizer: FPE on unknown address 0x55f9c11790cb (pc 0x55f9c11790cb bp 0x7ffe2ad52ee0 sp 0x7ffe2ad52d80 T0)
    #0 0x55f9c11790cb in config /home/jlx/good_mplayer/mplayer/libmpcodecs/vf_scale.c:401:49
    #1 0x55f9c10bb8a3 in vf_config_wrapper /home/jlx/good_mplayer/mplayer/libmpcodecs/vf.c:663:9

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: FPE /home/jlx/good_mplayer/mplayer/libmpcodecs/vf_scale.c:401:49 in config
==24938==ABORTING

```

3.Debugging with gdb

```
Breakpoint 1, config (vf=0x5560a56df640, width=224, height=<optimized out>, d_width=224, d_height=0, flags=0, outfmt=844715353) at libmpcodecs/vf_scale.c:401
401                     d_width = vf->priv->h * d_width / d_height;
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
───────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────
 RAX  0x1c0
 RBX  0x0
 RCX  0x400
 RDX  0x0
 RDI  0x0
 RSI  0xe0
 R8   0x0
 R9   0x7ffc5a17a3b0 —▸ 0x7f202bf1b4a0 (_IO_file_jumps) ◂— 0x0
 R10  0x4
 R11  0x246
 R12  0xe0
 R13  0x32315659
 R14  0x2
 R15  0x5560a56df640 —▸ 0x5560a43f7ca0 (vf_info_scale) —▸ 0x5560a43cee8b ◂— 'software scaling'
 RBP  0xe0
 RSP  0x7ffc5a17beb0 ◂— 0x0
 RIP  0x5560a4238612 (config+1218) ◂— cdq
─────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────
 ► 0x5560a4238612 <config+1218>    cdq
   0x5560a4238613 <config+1219>    idiv   ebx
    ↓
   0x5560a4238613 <config+1219>    idiv   ebx

─────────────────────────────────────────────────────────────────────[ SOURCE (CODE) ]──────────────────────────────────────────────────────────────────────
In file: /home/jlx/good_mplayer/mplayer/libmpcodecs/vf_scale.c
   396
   397     if(!opt_screen_size_x && !opt_screen_size_y && !(screen_size_xy >= 0.001)){
   398         // Compute new d_width and d_height, preserving aspect
   399         // while ensuring that both are >= output size in pixels.
   400         if (vf->priv->h * d_width > vf->priv->w * d_height) {
 ► 401                 d_width = vf->priv->h * d_width / d_height;
   402                 d_height = vf->priv->h;
   403         } else {
   404                 d_height = vf->priv->w * d_height / d_width;
   405                 d_width = vf->priv->w;
   406         }
─────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────
00:0000│ rsp  0x7ffc5a17beb0 ◂— 0x0
01:0008│      0x7ffc5a17beb8 ◂— 0x1
02:0010│      0x7ffc5a17bec0 ◂— 0x2000000e0
03:0018│      0x7ffc5a17bec8 —▸ 0x5560a43cb59b ◂— 'Planar YV12'
04:0020│      0x7ffc5a17bed0 ◂— 0x100400000000
05:0028│      0x7ffc5a17bed8 —▸ 0x5560a56df8c0 —▸ 0x5560a56df980 —▸ 0x5560a56df9c0 ◂— 0x3ff0000000000000
06:0030│      0x7ffc5a17bee0 ◂— 0x0
07:0038│      0x7ffc5a17bee8 ◂— 0xec39eef7e8469000
───────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────
 ► f 0     5560a4238612 config+1218
   f 1     5560a4210cc7 vf_config_wrapper+135
   f 2     5560a420d2fb mpcodecs_config_vo+811
   f 3     5560a4207b5b init_video.constprop+555
   f 4     5560a4208305 init_best_video_codec+565
   f 5     5560a41c5254 main+8228
   f 6     7f202bd550b3 __libc_start_main+243
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

```

### Attachments (1)

[testcase](/attachment/ticket/2399/testcase "View attachment")[​](/raw-attachment/ticket/2399/testcase "Download")
(1.5 KB
) - added by ylzs [2 years ago](/timeline?from=2022-08-23T08%3A55%3A00Z&precision=second "See timeline at Aug 23, 2022, 8:55:00 AM").

Download all attachments as:
[.zip](/zip-attachment/ticket/2399/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### [comment:1](#comment:1) by ylzs, [2 years ago](/timeline?from=2022-08-23T08%3A24%3A47Z&precision=second "See timeline at Aug 23, 2022, 8:24:47 AM")

| Severity: | critical → major |
| --- | --- |

### [comment:2](#comment:2) by ylzs, [2 years ago](/timeline?from=2022-08-23T08%3A32%3A34Z&precision=second "See timeline at Aug 23, 2022, 8:32:34 AM")

| Description: | modified ([diff](/ticket/2399?action=diff&version=2)) |
| --- | --- |

### by ylzs, [2 years ago](/timeline?from=2022-08-23T08%3A55%3A00Z&precision=second "See timeline at Aug 23, 2022, 8:55:00 AM")

| Attachment: | [*testcase*](/attachment/ticket/2399/testcase)[​](/raw-attachment/ticket/2399/testcase "Download") added |
| --- | --- |

### [comment:3](#comment:3) by reimar, [2 years ago](/timeline?from=2022-08-26T20%3A26%3A06Z&precision=second "See timeline at Aug 26, 2022, 8:26:06 PM")

| Resolution: | → fixed |
| --- | --- |
| Status: | new → closed |

Probably fixed by r38390.

But I don't think this has anything to do with ASAN, and the issue is not reproducible on e.g. ARM architecture where there is no signal triggered by division by 0, so I cannot confirm if it's fixed.

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/2399?format=rss)
* [Comma-delimited Text](/ticket/2399?format=csv)
* [Tab-delimited Text](/ticket/2399?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from lists.debian.org_6d9e1485_20250115_093434.html ===


---

[[Date Prev](msg00041.html)][[Date Next](msg00043.html)]
[[Thread Prev](msg00041.html)][[Thread Next](msg00043.html)]
[[Date Index](maillist.html#00042)]
[[Thread Index](threads.html#00042)]

# [SECURITY] [DLA 3255-1] mplayer security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3255-1] mplayer security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sat, 31 Dec 2022 12:41:46 +0000 (UTC)
* *Message-id*: <[[🔎]](/msgid-search/alpine.DEB.2.21.2212311236020.8533%40postfach.intern.alteholz.me) [alpine.DEB.2.21.2212311236020.8533@postfach.intern.alteholz.me](msg00042.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3255-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                    Thorsten Alteholz
December 31, 2022                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : mplayer
Version        : 2:1.3.0-8+deb10u1
CVE ID         : CVE-2022-38850 CVE-2022-38851 CVE-2022-38855
                 CVE-2022-38858 CVE-2022-38860 CVE-2022-38861
                 CVE-2022-38863 CVE-2022-38864 CVE-2022-38865
                 CVE-2022-38866

```
Several issues have been found in mplayer, a movie player for Unix-like
systems.
They are basically related to buffer overflows, divide by zero or out of
bounds read in different parts of the code.
```

For Debian 10 buster, these problems have been fixed in version
2:1.3.0-8+deb10u1.

We recommend that you upgrade your mplayer packages.

For the detailed security status of mplayer please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mplayer>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAmOwLgpfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEcSSw//YnUhGZQ3yL66mxKWiDvH3UmetHiRucR93NvU7aEXBeexDIg5QwSTiOgk
AaLIHg/Y5eLJ0XhAk7ID//JIb6xBSpyCUYxesvPpJAagmHwTzndxzcoPFtMXlPxT
MTUUPfJ3H7577J6hTI6XOS83m9TOjkRlTv13UA62snwGNaHnCtlMGrR4QYEv9HW4
sGCdzbI94oAeRP62am4cPsg8zH7z6A2a1T6PObSSrPjN/imBFj+Yt2KmygY8LPAo
j26TlnywgNnclHqfQJ4E3SECwbhNEW5cmLezZ4uky7TnLvzXUG+0Xv13h9v3coOm
LnHXC6QBAFFizgA8ntfo9rwtTHp7asUxoe0+qXS/XDBhK+2calGYS5VA+58hESOz
QP9Zdj/Qu3YlWaz3sThEECePNmU2KZI9yNWKjywr8EIXIncgsEKGfM7TDzXmPE3p
+KBS9yv6KzShSBUGpXEv8ZK7K8RQyieIBWy9AljJzWVndejd5yEgoRJPJNpYZOd3
Tp5bbRRedLio277bMR+FOj571nnSALOIRWS/IuY3KaE/UPGbf7qjSxR5II1i3Bwb
ZD6Ub215L0tIeUAkF3JHiJfSBIPRuCgBqq6Ga7NIb3rWP1QOnHEE+37kx7w76txf
hzmJygl/2gxIW+2YGyRynbR4BgcHx1xsJqbdlxaZfb9RSLi2VRE=
=KrDp
-----END PGP SIGNATURE-----

```

---


