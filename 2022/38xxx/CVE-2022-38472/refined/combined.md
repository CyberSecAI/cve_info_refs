=== Content from www.mozilla.org_3f324b9c_20250114_232417.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-34

## Security Vulnerabilities fixed in Firefox ESR 102.2

Announced
August 23, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.2

#### [#CVE-2022-38472: Address bar spoofing via XSLT error handling](#CVE-2022-38472)

Reporter
Armin Ebert
Impact
high
##### Description

An attacker could have abused XSLT error handling to associate attacker-controlled content with another origin which was displayed in the address bar. This could have been used to fool the user into submitting data intended for the spoofed origin.

##### References

* [Bug 1769155](https://bugzilla.mozilla.org/show_bug.cgi?id=1769155)

#### [#CVE-2022-38473: Cross-origin XSLT Documents would have inherited the parent's permissions](#CVE-2022-38473)

Reporter
Armin Ebert
Impact
high
##### Description

A cross-origin iframe referencing an XSLT document would inherit the parent domain's permissions (such as microphone or camera access).

##### References

* [Bug 1771685](https://bugzilla.mozilla.org/show_bug.cgi?id=1771685)

#### [#CVE-2022-38476: Data race and potential use-after-free in PK11\_ChangePW](#CVE-2022-38476)

Reporter
Marian Laza
Impact
low
##### Description

A data race could occur in the `PK11_ChangePW` function, potentially leading to a use-after-free vulnerability. In Firefox, this lock protected the data when a user changed their master password.

##### References

* [Bug 1760998](https://bugzilla.mozilla.org/show_bug.cgi?id=1760998)

#### [#CVE-2022-38477: Memory safety bugs fixed in Firefox 104 and Firefox ESR 102.2](#CVE-2022-38477)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developer Nika Layzell and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 103 and Firefox ESR 102.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 104 and Firefox ESR 102.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760611%2C1770219%2C1771159%2C1773363)

#### [#CVE-2022-38478: Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](#CVE-2022-38478)

Reporter
Mozilla developers and community
Impact
high
##### Description

Members the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 103, Firefox ESR 102.1, and Firefox ESR 91.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1770630%2C1776658)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_91012136_20250114_232415.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-33

## Security Vulnerabilities fixed in Firefox 104

Announced
August 23, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 104

#### [#CVE-2022-38472: Address bar spoofing via XSLT error handling](#CVE-2022-38472)

Reporter
Armin Ebert
Impact
high
##### Description

An attacker could have abused XSLT error handling to associate attacker-controlled content with another origin which was displayed in the address bar. This could have been used to fool the user into submitting data intended for the spoofed origin.

##### References

* [Bug 1769155](https://bugzilla.mozilla.org/show_bug.cgi?id=1769155)

#### [#CVE-2022-38473: Cross-origin XSLT Documents would have inherited the parent's permissions](#CVE-2022-38473)

Reporter
Armin Ebert
Impact
high
##### Description

A cross-origin iframe referencing an XSLT document would inherit the parent domain's permissions (such as microphone or camera access).

##### References

* [Bug 1771685](https://bugzilla.mozilla.org/show_bug.cgi?id=1771685)

#### [#CVE-2022-38474: Recording notification not shown when microphone was recording on Android](#CVE-2022-38474)

Reporter
Agi Sferro
Impact
low
##### Description

A website that had permission to access the microphone could record audio without the audio notification being shown. This bug does not allow the attacker to bypass the permission prompt - it only affects the notification shown once permission has been granted.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1719511](https://bugzilla.mozilla.org/show_bug.cgi?id=1719511)

#### [#CVE-2022-38475: Attacker could write a value to a zero-length array](#CVE-2022-38475)

Reporter
Christian Holler
Impact
low
##### Description

An attacker could have written a value to the first element in a zero-length JavaScript array. Although the array was zero-length, the value was not written to an invalid memory address.

##### References

* [Bug 1773266](https://bugzilla.mozilla.org/show_bug.cgi?id=1773266)

#### [#CVE-2022-38477: Memory safety bugs fixed in Firefox 104 and Firefox ESR 102.2](#CVE-2022-38477)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developer Nika Layzell and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 103 and Firefox ESR 102.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 104 and Firefox ESR 102.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760611%2C1770219%2C1771159%2C1773363)

#### [#CVE-2022-38478: Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](#CVE-2022-38478)

Reporter
Mozilla developers and community
Impact
high
##### Description

Members the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 103, Firefox ESR 102.1, and Firefox ESR 91.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1770630%2C1776658)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ecf6c238_20250114_232418.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-36

## Security Vulnerabilities fixed in Thunderbird 102.2

Announced
August 23, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-38472: Address bar spoofing via XSLT error handling](#CVE-2022-38472)

Reporter
Armin Ebert
Impact
high
##### Description

An attacker could have abused XSLT error handling to associate attacker-controlled content with another origin which was displayed in the address bar. This could have been used to fool the user into submitting data intended for the spoofed origin.

##### References

* [Bug 1769155](https://bugzilla.mozilla.org/show_bug.cgi?id=1769155)

#### [#CVE-2022-38473: Cross-origin XSLT Documents would have inherited the parent's permissions](#CVE-2022-38473)

Reporter
Armin Ebert
Impact
high
##### Description

A cross-origin iframe referencing an XSLT document would inherit the parent domain's permissions (such as microphone or camera access).

##### References

* [Bug 1771685](https://bugzilla.mozilla.org/show_bug.cgi?id=1771685)

#### [#CVE-2022-38476: Data race and potential use-after-free in PK11\_ChangePW](#CVE-2022-38476)

Reporter
Marian Laza
Impact
low
##### Description

A data race could occur in the `PK11_ChangePW` function, potentially leading to a use-after-free vulnerability. In Thunderbird, this lock protected the data when a user changed their master password.

##### References

* [Bug 1760998](https://bugzilla.mozilla.org/show_bug.cgi?id=1760998)

#### [#CVE-2022-38477: Memory safety bugs fixed in Thunderbird 102.2](#CVE-2022-38477)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developer Nika Layzell and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760611%2C1770219%2C1771159%2C1773363)

#### [#CVE-2022-38478: Memory safety bugs fixed in Thunderbird 102.2, and Thunderbird 91.13](#CVE-2022-38478)

Reporter
Mozilla developers and community
Impact
high
##### Description

Members the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.1 and Thunderbird 91.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.2, and Thunderbird 91.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1770630%2C1776658)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_04c02831_20250114_232414.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1769155)
* [XML](/show_bug.cgi?ctype=xml&id=1769155)

Closed
[Bug 1769155](/show_bug.cgi?id=1769155)
(CVE-2022-38472)

Opened 3 years ago
Closed 2 years ago

# XSLT error handler may set up error document in incorrect context

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

XSLT error handler may set up error document in incorrect context

## Categories

### (Core :: XSLT, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XSLT#XSLT)

XSLT
▾

Core :: XSLT
For bugs on Mozilla's XSLT support. See the [project
page](http://www.mozilla.org/projects/xslt) for tips on testcases and commonly encountered legacy problems.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XSLT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XSLT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XSLT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

105 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [104+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=104%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox-esr102 | [104+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=104%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox103 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=wontfix) |
| firefox104 | [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed) |
| firefox105 | [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 104+ | fixed |
| firefox-esr102 | 104+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox103 |  | wontfix |
| firefox104 | + | fixed |
| firefox105 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: arminius, Assigned: peterv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3cca6b6cc3855653ab1b17e9df3aa8e1?d=mm&size=40)  [arminius](/user_profile?user_id=526160)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-34470](/show_bug.cgi?id=1765951 "VERIFIED FIXED - heap-use-after-free in nsSHistory")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [adv-main104+][adv-esr91.13+][adv-esr102.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-38472

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main104+][adv-esr91.13+][adv-esr102.2+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c32 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a9377315_551058 "2 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (11 files)

| [testcase3-nofission.html](/attachment.cgi?id=9276348)  [3 years ago](#c1)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   902 bytes, text/html |  | [Details](/attachment.cgi?id=9276348&action=edit) |
| --- | --- | --- |
| [testcase3-nofission-screenshot.png](/attachment.cgi?id=9276349)  [3 years ago](#c2)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   23.39 KB, image/png |  | [Details](/attachment.cgi?id=9276349&action=edit) |
| [Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!](/attachment.cgi?id=9280681)  [3 years ago](#c10)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c27 "2 years ago")  RyanVM : [approval-mozilla-esr102+](#c36 "2 years ago")  tjr : [sec-approval+](#c17 "3 years ago") | [Details](/attachment.cgi?id=9280681&action=edit) | [Review](/attachment.cgi?id=9280681) |
| [Bug 1769155 - Deal with document replacement. r?smaug!](/attachment.cgi?id=9280682)  [3 years ago](#c11)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#a6976520_690067 "2 years ago")  RyanVM : [approval-mozilla-esr102+](#a7076677_75935 "2 years ago")  tjr : [sec-approval+](#c18 "3 years ago") | [Details](/attachment.cgi?id=9280682&action=edit) | [Review](/attachment.cgi?id=9280682) |
| [Bug 1769155 - testcase. r?smaug!](/attachment.cgi?id=9284556)  [3 years ago](#c15)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9284556&action=edit) | [Review](/attachment.cgi?id=9284556) |
| [Bug 1769155 - Deal with document replacement.](/attachment.cgi?id=9288178)  [2 years ago](#c33)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr91+](#c38 "2 years ago") | [Details](/attachment.cgi?id=9288178&action=edit) | [Review](/attachment.cgi?id=9288178) |
| [testcase4-desktop-navigateto.html](/attachment.cgi?id=9289600)  [2 years ago](#c41)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   1.42 KB, text/html |  | [Details](/attachment.cgi?id=9289600&action=edit) |
| [testcase5-android.html](/attachment.cgi?id=9289601)  [2 years ago](#c42)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   1.53 KB, text/html |  | [Details](/attachment.cgi?id=9289601&action=edit) |
| [testcase5-android.png](/attachment.cgi?id=9289602)  [2 years ago](#c43)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   180.96 KB, image/png |  | [Details](/attachment.cgi?id=9289602&action=edit) |
| [testcase5-android.webm](/attachment.cgi?id=9289603)  [2 years ago](#c44)  [Armin Ebert [:arminius]](/user_profile?user_id=526160)   7.93 MB, video/webm |  | [Details](/attachment.cgi?id=9289603&action=edit) |
| [advisory.txt](/attachment.cgi?id=9290152)  [2 years ago](#c46)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   308 bytes, text/plain |  | [Details](/attachment.cgi?id=9290152&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1769155#c0)• 3 years ago |
|  | |

The XSLT processor may act on the wrong context when reporting an error, thus possibly substitute the wrong document with an (attacker-controlled) error document. This can cause a state where different documents (of potentially different origins) refer to the same outer window.

With fission disabled, this can also fully spoof the displayed location / `window.location`.

### Testcase 1

`http://localhost/testcase1.xml`:

```
<?xml-stylesheet type="application/xml" href="#sheet"?>
<stylesheet id="sheet" version="1.0" xmlns="http://www.w3.org/1999/XSL/Transform">
<template match="/">
    <script xmlns="http://www.w3.org/1999/xhtml">
        window.location = 'data:image/png,x'
        alert()
    </script>
</template>
</stylesheet>

```

**Expected:** Upon load, we should be redirected to `data:image/png,x`, an `ImageDocument` on a nullprincipal.

**Actual result:** We're redirected to `data:image/png,x`, but the document is an `XMLDocument` on the origin `localhost`.

What happens:

* The XSLT processor executes the contained sheet and inserts a `<script>` element as per the `<template>` rule.
* The script runs immediately (while the XSLT processor is still active) and initiates relocation to the `data:` image URI.
* The `alert()` modal suspends the XSLT processor, keeping it from completing normally.
* When the location change cancels the XSLT processor, the newly created error document replaces new image document *after* the redirect.

Corresponding DOMLeak log:

```
[Child 2141987: Main Thread]: D/DOMLeakOuter DOMWINDOW 614000009e40 created outer=nullptr
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 61900014a580 created outer=614000009e40
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 61900014a580 SetNewDocument about:blank
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 61900014fa80 created outer=614000009e40
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 61900014fa80 SetNewDocument http://localhost/testcase1.xml
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 6190001b7680 created outer=614000009e40
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 6190001b7680 SetNewDocument data:image/png,x
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 619000247780 created outer=614000009e40
[Child 2141987: Main Thread]: D/DOMLeakInner DOMWINDOW 619000247780 SetNewDocument http://localhost/testcase1.xml

```
### Testcase 2

This behavior can also be leveraged to reach div. invalid states and crashes, e.g.:

```
<?xml-stylesheet type="application/xml" href="#sheet"?>
<stylesheet id="sheet" version="1.0" xmlns="http://www.w3.org/1999/XSL/Transform">
<template match="/">
    <script xmlns="http://www.w3.org/1999/xhtml">
        location.reload()
        alert()
    </script>
</template>
</stylesheet>

```

This crashes e.g. once you relocate, insert an `<iframe>`, or un- and refocus the window.

### Details

When an error occurs while processing an XSLT sheet, it's handled in `txMozillaXSLTProcessor::reportError()`. Here, a new XML document is created for the error report. It replaces the current one and uses a new inner window.

Trace to illustrate how an XSLT error leads to a new `nsGlobalWindowInner`:

```
#0  nsGlobalWindowInner::nsGlobalWindowInner(nsGlobalWindowOuter*, mozilla::dom::WindowGlobalChild*) (this=0x7fc418bd7800, aOuterWindow=0x7fc447ba6bc0, aActor=0x0) at /builds/worker/checkouts/gecko/dom/base/nsGlobalWindowInner.cpp:938
#1  0x00007fc4349f76f3 in nsGlobalWindowInner::Create(nsGlobalWindowOuter*, bool, mozilla::dom::WindowGlobalChild*) (aOuterWindow=0x7fc447ba6bc0, aIsChrome=false, aActor=0x0) at /builds/worker/checkouts/gecko/dom/base/nsGlobalWindowInner.cpp:7805
#2  0x00007fc434a18542 in nsGlobalWindowOuter::SetNewDocument(mozilla::dom::Document*, nsISupports*, bool, mozilla::dom::WindowGlobalChild*) (this=0x7fc447ba6bc0, aDocument=0x7fc421842200, aState=0x0, aForceReuseInnerWindow=false, aActor=0x0) at /builds/worker/checkouts/gecko/dom/base/nsGlobalWindowOuter.cpp:2217
#3  0x00007fc4393eedeb in nsDocumentViewer::SetDocumentInternal(mozilla::dom::Document*, bool) (this=0x7fc41be88040, aDocument=0x7fc421842200, aForceReuseInnerWindow=false) at /builds/worker/checkouts/gecko/layout/base/nsDocumentViewer.cpp:1883
#4  0x00007fc4393ee9ae in nsDocumentViewer::SetDocument(mozilla::dom::Document*) (this=0x7fc41be88040, aDocument=0x7fc421842200) at /builds/worker/checkouts/gecko/layout/base/nsDocumentViewer.cpp:1834
#5  0x00007fc4388beb8f in nsXMLContentSink::OnTransformDone(nsresult, mozilla::dom::Document*) (this=0x7fc4192ef000, aResult=nsresult::NS_ERROR_FAILURE, aResultDocument=0x7fc421842200) at /builds/worker/checkouts/gecko/dom/xml/nsXMLContentSink.cpp:354
#6  0x00007fc43892d5fd in txMozillaXSLTProcessor::notifyError() (this=0x7fc41f44d1c0) at /builds/worker/checkouts/gecko/dom/xslt/xslt/txMozillaXSLTProcessor.cpp:1028
#7  0x00007fc43891fa5a in txMozillaXSLTProcessor::reportError(nsresult, char16_t const*, char16_t const*) (this=0x7fc41f44d1c0, aResult=nsresult::NS_ERROR_FAILURE, aErrorText=0x7fc41f4b2408 u"XML Parsing Error: syntax error\nLocation: data:,x\nLine Number 1, Column 1:", aSourceText=0x7ffdecb80e04 u"x\n^") at /builds/worker/checkouts/gecko/dom/xslt/xslt/txMozillaXSLTProcessor.cpp:958

```

Note that this is different to the handling of a non-XSLT XML parsing error which gets handled in `nsXMLContentSink::ReportError()`. In that case, the current node tree is just swapped out for a `<parsererror>` node (i.e. the DOM changes, but no new document is created). So I don't believe this bug extends to "regular" XML error pages.

Flags: sec-bounty?

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1769155#c1)• 3 years ago |
|  | |

Attached file
[testcase3-nofission.html](attachment.cgi?id=9276348)
— [Details](attachment.cgi?id=9276348&action=edit)

### Testcase 3

This is an extension of testcase 1 to demonstrate a location spoof with *fission disabled*. Here, a new attacker-controlled window is opened where `window.location == https://www.mozilla.org/` (and also displayed in the address bar).

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1769155#c2)• 3 years ago |
|  | |

Attached image
[testcase3-nofission-screenshot.png](attachment.cgi?id=9276349)
— [Details](attachment.cgi?id=9276349&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a678_406194)• 3 years ago |

Group: core-security → dom-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a503164_1689)• 3 years ago |

See Also: → [CVE-2022-34470](/show_bug.cgi?id=1765951 "VERIFIED FIXED - heap-use-after-free in nsSHistory")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a503599_1689)• 3 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1769155#c3)• 3 years ago |
|  | |

Peter's comment on [bug 1765951 comment 9](/show_bug.cgi?id=1765951#c9 "VERIFIED FIXED - heap-use-after-free in nsSHistory"):

"I'm going to move the XSLT issues to a separate bug, I could only ever trigger a `null-crash` with those."

NI for assessing downgreading the security level for the `null-crash`.

Flags: needinfo?(dveditz)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1769155#c4)• 3 years ago |
|  | |

This was rated sec-high because [comment 1](/show_bug.cgi?id=1769155#c1 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") says this can be used for spoofing.

Flags: needinfo?(dveditz)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1769155#c5)• 3 years ago |
|  | |

The severity field is not set for this bug.

:edgar, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1769155#c6)• 3 years ago |
|  | |

As this is rated sec-high.

Severity: -- → S2Flags: needinfo?(echen)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1769155#c7)• 3 years ago |
|  | |

(In reply to Armin Ebert [:arminius] from [comment #1](/show_bug.cgi?id=1769155#c1 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context"))

> This is an extension of testcase 1 to demonstrate a location spoof with *fission disabled*. Here, a new attacker-controlled window is opened where `window.location == https://www.mozilla.org/` (and also displayed in the address bar).

I can't reproduce this, with or without Fission. All I see is Mozilla's website with the correct URL in the address bar and a bunch of 'SecurityError: Permission denied to access property "origin" on cross-origin object'.

On ESR91 I also briefly see the blob URL in the address bar, but the page displays "origin=null location=about:blank". After that it shows Mozilla's website with the correct URL in the address bar.

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1769155#c8)• 3 years ago |
|  | |

(In reply to Peter Van der Beken [:peterv] from [comment #7](/show_bug.cgi?id=1769155#c7 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context"))

> I can't reproduce this, with or without Fission. All I see is Mozilla's website with the correct URL in the address bar and a bunch of 'SecurityError: Permission denied to access property "origin" on cross-origin object'.

The 3rd testcase still works for me on latest nightly which I'm running with `MOZ_FORCE_DISABLE_FISSION=1 ./m-c-20220607155748-opt/firefox` on Linux.

Could you also check that the testcase was served from `http:` and not `file:`?

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1769155#c9)• 3 years ago |
|  | |

Still can't reproduce that, I simply end up on <https://www.mozilla.org/> displaying the Mozilla website.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1769155#c10)• 3 years ago |
|  | |

Attached file
[Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!](attachment.cgi?id=9280681)
— [Details](attachment.cgi?id=9280681&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a2477655_600971)• 3 years ago |

Assignee: nobody → petervStatus: NEW → ASSIGNED

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1769155#c11)• 3 years ago |
|  | |

Attached file
[Bug 1769155 - Deal with document replacement. r?smaug!](attachment.cgi?id=9280682)
— [Details](attachment.cgi?id=9280682&action=edit)

Depends on D148914

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1769155#c12)• 3 years ago |
|  | |

(In reply to Peter Van der Beken [:peterv] from [comment #9](/show_bug.cgi?id=1769155#c9 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context"))

> Still can't reproduce that, I simply end up on <https://www.mozilla.org/> displaying the Mozilla website.

I can confirm the spoof when running Firefox with `MOZ_FORCE_DISABLE_FISSION=1`. Let me know if you need someone to help testing, though it looks as if there is a way forward here.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1769155#c13)• 3 years ago |
|  | |

There are some r+ patches which didn't land and no activity in this bug for 2 weeks.

:peterv, could you have a look please?

If you still have some work to do, you can add an action "Plan Changes" in Phabricator.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#not_landed.py).

Flags: needinfo?(peterv)Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1769155#c14)• 3 years ago |
|  | |

Up to peterv to handle this. Clearing needinfo.

Flags: needinfo?(bugs)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1769155#c15)• 3 years ago |
|  | |

Attached file
[Bug 1769155 - testcase. r?smaug!](attachment.cgi?id=9284556)
— [Details](attachment.cgi?id=9284556&action=edit)

Depends on D148915

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a5232577_24295)• 3 years ago |

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1769155#c16)• 3 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Doesn't seem super hard, it's clear that the problem is related to XSLT and loading a new document somehow before the transform is done.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Patch will probably just apply to older branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions, we just check for the weird conditions that led to the crashes/spoofing.
* **Is Android affected?**: Yes
[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: sec-approval?

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a5232825_24295)• 3 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: sec-approval?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1769155#c17)• 2 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

approved to land and uplift when ready

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1769155#c18)• 2 years ago |
|  | |

Comment on [attachment 9280682](/attachment.cgi?id=9280682 "Bug 1769155 - Deal with document replacement. r?smaug!") [[details]](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Deal with document replacement. r?smaug!

approved to land and uplift when ready

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1769155#c19)• 2 years ago |
|  | |

Comment on [attachment 9284556](/attachment.cgi?id=9284556 "Bug 1769155 - testcase. r?smaug!") [[details]](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - testcase. r?smaug!

approved to land 10/5 or after

[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6538451_578488)• 2 years ago |

Whiteboard: [reminder-test 2022-10-5]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1769155#c20)• 2 years ago |
|  | |

Peter's out, so I'll try to land the non-test patches.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1769155#c21)• 2 years ago |
|  | |

Null-check win in setter for IsActiveBrowserWindowInternal. r=smaug

<https://hg.mozilla.org/integration/autoland/rev/5fadf2d065b996976b2f95204019afdef102cdc4>

<https://hg.mozilla.org/mozilla-central/rev/5fadf2d065b9>

Deal with document replacement. r=smaug

<https://hg.mozilla.org/integration/autoland/rev/2a1edefefb10670bcfc3790993a711e8367939d1>

<https://hg.mozilla.org/mozilla-central/rev/2a1edefefb10>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 105 Branch

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6651014_406194)• 2 years ago |

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected)
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1769155#c22)• 2 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-high
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This should only change behavior in weird situations where crashing or spoofing might occur
* **String changes made/needed**: none
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr102?
[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-beta?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6651111_406194)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-beta? approval-mozilla-esr102?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr102?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1769155#c23)• 2 years ago |
|  | |

Comment on [attachment 9284556](/attachment.cgi?id=9284556 "Bug 1769155 - testcase. r?smaug!") [[details]](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - testcase. r?smaug!

Oops, I don't want to land the test in backports...

[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6664844_75935)• 2 years ago |

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected) → ---
[tracking-firefox104](/buglist.cgi?f1=cf_tracking_firefox104&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B)
[tracking-firefox105](/buglist.cgi?f1=cf_tracking_firefox105&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [104+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=104%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [104+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=104%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1769155#c24)• 2 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

This is going to need rebased patches for ESR91, unfortunately.

Flags: needinfo?(peterv)
[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6664930_75935)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1769155#c25)• 2 years ago |
|  | |

Looks like [bug 1732410](/show_bug.cgi?id=1732410 "RESOLVED FIXED - Wait for focus before proceeding for enumerateDevices() Promises.") is what caused this to need to be rebased for ESR91.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1769155#c26)• 2 years ago |
|  | |

Thinking about this some more, the null check is just fixing a safe crash, so I don't think we don't really need to backport it to ESR91. The sec-high is for the spoof which is the other patch.

Flags: needinfo?(peterv)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1769155#c27)• 2 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

Approved for 104.0b5

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6976520_690067)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1769155#c28)• 2 years ago |
|  | |

Comment on [attachment 9280682](/attachment.cgi?id=9280682 "Bug 1769155 - Deal with document replacement. r?smaug!") [[details]](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Deal with document replacement. r?smaug!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6976638_406194)• 2 years ago |

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6976639_406194)• 2 years ago |

[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr102?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a6976664_406194)• 2 years ago |

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1769155#c29)• 2 years ago |
|  | |

Comment on [attachment 9284556](/attachment.cgi?id=9284556 "Bug 1769155 - testcase. r?smaug!") [[details]](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - testcase. r?smaug!

Apparently I'm failing at flags today.

[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr102?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1769155#c30)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ff6265fcfc00>

<https://hg.mozilla.org/releases/mozilla-beta/rev/3312eb7bfc89>

[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=fixed)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1769155#c31)• 2 years ago |
|  | |

Comment on [attachment 9280682](/attachment.cgi?id=9280682 "Bug 1769155 - Deal with document replacement. r?smaug!") [[details]](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Deal with document replacement. r?smaug!

Ryan said this patch doesn't work on ESR91 either so I'll upload a new patch for it.

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1769155#c32)• 2 years ago |
|  | |

Downgrading the severity because Fission is used in the latest desktop and ESR releases, so this spoofing only applies on top of systems known vulnerable to the problems that Fission addresses.

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1769155#c33)• 2 years ago |
|  | |

Attached file
[Bug 1769155 - Deal with document replacement.](attachment.cgi?id=9288178)
— [Details](attachment.cgi?id=9288178&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1769155#c34)• 2 years ago |
|  | |

The only real change I had to make in the patch was changing the check for the "rootElement not in doc?" assertion to match the ESR91 code.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1769155#c35)• 2 years ago |
|  | |

Comment on [attachment 9288178](/attachment.cgi?id=9288178 "Bug 1769155 - Deal with document replacement.") [[details]](/attachment.cgi?id=9288178&action=edit "Bug 1769155 - Deal with document replacement.")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Deal with document replacement.

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9288178](/attachment.cgi?id=9288178&action=edit "Bug 1769155 - Deal with document replacement.") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7072436_406194)• 2 years ago |

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7072437_406194)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?
[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7072449_406194)• 2 years ago |

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7072455_406194)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7072459_406194)• 2 years ago |

[Attachment #9284556](/attachment.cgi?id=9284556&action=edit "Bug 1769155 - testcase. r?smaug!") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1769155#c36)• 2 years ago |
|  | |

Comment on [attachment 9280681](/attachment.cgi?id=9280681 "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") [[details]](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!

Approved for 102.2esr.

[Attachment #9280681](/attachment.cgi?id=9280681&action=edit "Bug 1769155 - Null-check win in setter for IsActiveBrowserWindowInternal. r?smaug!") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a7076677_75935)• 2 years ago |

[Attachment #9280682](/attachment.cgi?id=9280682&action=edit "Bug 1769155 - Deal with document replacement. r?smaug!") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1769155#c37)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/5371a6a9823d>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/411467b6ab5e>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1769155#c38)• 2 years ago |
|  | |

Comment on [attachment 9288178](/attachment.cgi?id=9288178 "Bug 1769155 - Deal with document replacement.") [[details]](/attachment.cgi?id=9288178&action=edit "Bug 1769155 - Deal with document replacement.")

[Bug 1769155](/show_bug.cgi?id=1769155 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context") - Deal with document replacement.

Approved for 91.13esr.

[Attachment #9288178](/attachment.cgi?id=9288178&action=edit "Bug 1769155 - Deal with document replacement.") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1769155#c39)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/7d69277b335b>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1769155#c40)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #32](/show_bug.cgi?id=1769155#c32 "RESOLVED FIXED - XSLT error handler may set up error document in incorrect context"))

> Downgrading the severity because Fission is used in the latest desktop and ESR releases, so this spoofing only applies on top of systems known vulnerable to the problems that Fission addresses.

I believe in this case the impact is higher than the initial testcases suggested: On desktop, the bug can be escalated to work on Fission-enabled builds. On FF for Android, the bug as-is allows to fully spoof the address bar, security UI and Android-native password autofill.

1. Desktop + Fission

The spoofing isn't limited to non-fission builds per se, but hinges on whether navigating to the new location triggers a process switch. So even with Fission, `https://some.sub.domain.site.com:1234` can pose as `https://accounts.site.com` because navigation between subdomains and/or ports happens in-process. Same for `sandbox`ed iframes with `data:` URIs, etc. which aren't process-isolated either.

Now, one way to extended this to arbitrary URLs is by making a cross-process navigation terminate early on a native `about:...` error page that loads *before* the process switch would have occurred, but already displays the intended target URL.

Testcase 4 demonstrates this idea using `CSP: navigate-to 'none'`. It spoofs `https://addons.mozilla.org` by injecting the attacker-controlled XML error document into the `about:neterror?e=cspBlocked` page that blocks the navigation attempt. (`navigate-to` is currently still behind `security.csp.enableNavigateTo`, but other error pages are generally suitable too, e.g. the "unsafe content type" error when navigating to a jar: URI like `jar:https://addons.mozilla.org/!/`.)

2. Android

On current Fenix 103.2 with default settings an attacker can spoof any URL in the address bar, including security indicators and Android-native password autofill. The attached webm shows testcase 5 on Android pose as a "secure and verified" connection to `https://accounts.firefox.com` and Google autofill inserting stored credentials for the spoofed origin. (I also replicated this outside the emulator on a Pixel 6 phone).

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1769155#c41)• 2 years ago |
|  | |

Attached file
[testcase4-desktop-navigateto.html](attachment.cgi?id=9289600)
— [Details](attachment.cgi?id=9289600&action=edit)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1769155#c42)• 2 years ago |
|  | |

Attached file
[testcase5-android.html](attachment.cgi?id=9289601)
— [Details](attachment.cgi?id=9289601&action=edit)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1769155#c43)• 2 years ago |
|  | |

Attached image
[testcase5-android.png](attachment.cgi?id=9289602)
— [Details](attachment.cgi?id=9289602&action=edit)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1769155#c44)• 2 years ago |
|  | |

Attached video
[testcase5-android.webm](attachment.cgi?id=9289603)
— [Details](attachment.cgi?id=9289603&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a8274245_578488)• 2 years ago |

Whiteboard: [reminder-test 2022-10-5] → [reminder-test 2022-10-5][adv-main104+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1769155#c45)• 2 years ago |
|  | |

Thank you for the additional testcases. We agree this is more severe and will increase the bounty amount

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1769155#c46)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9290152)
— [Details](attachment.cgi?id=9290152&action=edit)

|  | [Armin Ebert [:arminius]](/user_profile?user_id=526160)  Reporter |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1769155#c47)• 2 years ago |
|  | |

Thanks for the quick review and bounty!

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a8436791_578488)• 2 years ago |

Whiteboard: [reminder-test 2022-10-5][adv-main104+] → [reminder-test 2022-10-5][adv-main104+][adv-esr91.13+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a8436837_578488)• 2 years ago |

Whiteboard: [reminder-test 2022-10-5][adv-main104+][adv-esr91.13+] → [reminder-test 2022-10-5][adv-main104+][adv-esr91.13+][adv-esr102.2+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a8542589_578488)• 2 years ago |

Alias: CVE-2022-38472

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a9377315_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a21534648_1689)• 2 years ago |

Group: core-security-release

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1769155#c48)• 2 years ago |
|  | |

5 months ago, Tom Ritter [:tjr] placed a reminder on the bug using the whiteboard tag `[reminder-test 2022-10-5]` .

peterv, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(peterv)Whiteboard: [reminder-test 2022-10-5][adv-main104+][adv-esr91.13+][adv-esr102.2+] → [adv-main104+][adv-esr91.13+][adv-esr102.2+]

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a64695671_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1769155#a65106318_24295)• 7 months ago |

Flags: needinfo?(peterv)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1769155#c49)• 7 months ago |
|  | |

Pushed by pvanderbeken@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/ef7d00e0039c>
testcase. r=smaug

|  | [Sandor Molnar[:smolnar]](/user_profile?user_id=670045) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1769155#c50)• 7 months ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/ef7d00e0039c>

You need to [log in](/show_bug.cgi?id=1769155&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Armin Ebert [:arminius]](/user_profile?user_id=526160)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_2c0ff3a2_20250114_232417.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-35

## Security Vulnerabilities fixed in Firefox ESR 91.13

Announced
August 23, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.13

#### [#CVE-2022-38472: Address bar spoofing via XSLT error handling](#CVE-2022-38472)

Reporter
Armin Ebert
Impact
high
##### Description

An attacker could have abused XSLT error handling to associate attacker-controlled content with another origin which was displayed in the address bar. This could have been used to fool the user into submitting data intended for the spoofed origin.

##### References

* [Bug 1769155](https://bugzilla.mozilla.org/show_bug.cgi?id=1769155)

#### [#CVE-2022-38473: Cross-origin XSLT Documents would have inherited the parent's permissions](#CVE-2022-38473)

Reporter
Armin Ebert
Impact
high
##### Description

A cross-origin iframe referencing an XSLT document would inherit the parent domain's permissions (such as microphone or camera access).

##### References

* [Bug 1771685](https://bugzilla.mozilla.org/show_bug.cgi?id=1771685)

#### [#CVE-2022-38478: Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](#CVE-2022-38478)

Reporter
Mozilla developers and community
Impact
high
##### Description

Members the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 103, Firefox ESR 102.1, and Firefox ESR 91.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 104, Firefox ESR 102.2, and Firefox ESR 91.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1770630%2C1776658)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_1c571751_20250114_232419.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-37

## Security Vulnerabilities fixed in Thunderbird 91.13

Announced
August 23, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.13

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-38472: Address bar spoofing via XSLT error handling](#CVE-2022-38472)

Reporter
Armin Ebert
Impact
high
##### Description

An attacker could have abused XSLT error handling to associate attacker-controlled content with another origin which was displayed in the address bar. This could have been used to fool the user into submitting data intended for the spoofed origin.

##### References

* [Bug 1769155](https://bugzilla.mozilla.org/show_bug.cgi?id=1769155)

#### [#CVE-2022-38473: Cross-origin XSLT Documents would have inherited the parent's permissions](#CVE-2022-38473)

Reporter
Armin Ebert
Impact
high
##### Description

A cross-origin iframe referencing an XSLT document would inherit the parent domain's permissions (such as microphone or camera access).

##### References

* [Bug 1771685](https://bugzilla.mozilla.org/show_bug.cgi?id=1771685)

#### [#CVE-2022-38478: Memory safety bugs fixed in Thunderbird 102.2, and Thunderbird 91.13](#CVE-2022-38478)

Reporter
Mozilla developers and community
Impact
high
##### Description

Members the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.1 and Thunderbird 91.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.2 and Thunderbird 91.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1770630%2C1776658)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


