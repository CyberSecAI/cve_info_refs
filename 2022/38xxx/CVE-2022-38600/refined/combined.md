=== Content from trac.mplayerhq.hu_6678924a_20250114_192001.html ===


[![MPlayer - The Movie Player](https://mplayerhq.hu/mplayer-logo.png)](https://mplayerhq.hu/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/query)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ← [Previous Ticket](/ticket/2389 "Ticket #2389")
* [Next Ticket](/ticket/2391 "Ticket #2391") →

---

Opened [2 years ago](/timeline?from=2022-08-18T08%3A30%3A08Z&precision=second "See timeline at Aug 18, 2022, 8:30:08 AM")

Closed [2 years ago](/timeline?from=2022-08-26T12%3A35%3A49Z&precision=second "See timeline at Aug 26, 2022, 12:35:49 PM")

## [#2390](/ticket/2390) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# memory leak in vf.c and vf\_vo.c

| Reported by: | [ylzs](/query?reporter=ylzs&status=!closed) | Owned by: | [beastd](/query?owner=beastd&status=!closed) |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [vf](/query?component=vf&status=!closed) |
| Version: | [unspecified](/query?status=!closed&version=unspecified) | Severity: | [normal](/query?severity=normal&status=!closed) |
| Keywords: |  | Cc: |  |
| Blocked By: |  | Blocking: |  |
| Reproduced by developer: | [no](/query?reproduced=0&status=!closed) | Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |

## Description

Summary of the bug: Found a .viv file for mplayer where asan reports a memory leak.

How to reproduce:Use the attached file to reproduce this issue (ASAN-recompilation are required)

version: SVN-r38374-13.0.1

kernel version:ubuntu 20.04; Linux 5.15.0-46-generic

complier version:clang 13.0.1-2ubuntu2~20.04.1

mplayer and ASAN output:

Player SVN-r38374-13.0.1 (C) 2000-2022 MPlayer Team

Playing /home/ldy/sample/useful/03-KimagureOrangeRoad.viv.

libavformat version 58.29.100 (external)

VIVO file format detected.

VIDEO: [viv2] 320x240 24bpp 10.000 fps 0.0 kbps ( 0.0 kbyte/s)

[gl] using extended formats. Use -vo gl:nomanyfmts if playback fails.

==========================================================================

Requested video codec family [vivo] (vfm=vfw) not available.

Enable it at compilation.

Cannot find codec matching selected -vo and video format 0x32766976.

==========================================================================

Clip info:

> title: <No Title>
>
> author: NV
>
> copyright: <No Copyright>
>
> encoder: VivoActive VideoNow 3.0 for Windows

Load subtitles in /home/ldy/sample/useful/

==========================================================================

Requested audio codec family [vivoaudio] (afm=acm) not available.

Enable it at compilation.

Opening audio decoder: [ffmpeg] FFmpeg/libavcodec audio decoders

libavcodec version 58.54.100 (external)

Cannot find codec 'siren' in libavcodec...

ADecoder init failed :(

ADecoder init failed :(

Cannot find codec for audio format 0x112.

Audio: no sound

Video: no video

Exiting... (End of file)

=================================================================

==3993864==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 576 byte(s) in 1 object(s) allocated from:

> #0 0x55ac7b1e06dd in malloc (/home/ldy/good\_mplayer/asan\_playr/mplayer+0x33e6dd)
>
> [#1](/ticket/1 "#1: defect: ao alsa is noisy since it was \"unified\" (closed: fixed)") 0x55ac7b42992e in vf\_open\_plugin /home/ldy/good\_mplayer/mplayer/libmpcodecs/vf.c:478:8

Indirect leak of 24 byte(s) in 1 object(s) allocated from:

> #0 0x55ac7b1e0872 in interceptor\_calloc (/home/ldy/good\_mplayer/asan\_playr/mplayer+0x33e872)
>
> [#1](/ticket/1 "#1: defect: ao alsa is noisy since it was \"unified\" (closed: fixed)") 0x55ac7b50a2cd in vf\_open /home/ldy/good\_mplayer/mplayer/libmpcodecs/vf\_vo.c:215:14

SUMMARY: AddressSanitizer: 600 byte(s) leaked in 2 allocation(s).

### Attachments (1)

[sample.viv](/attachment/ticket/2390/sample.viv "View attachment")[​](/raw-attachment/ticket/2390/sample.viv "Download")
(974.3 KB
) - added by ylzs [2 years ago](/timeline?from=2022-08-18T08%3A31%3A39Z&precision=second "See timeline at Aug 18, 2022, 8:31:39 AM").

Download all attachments as:
[.zip](/zip-attachment/ticket/2390/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### by ylzs, [2 years ago](/timeline?from=2022-08-18T08%3A31%3A39Z&precision=second "See timeline at Aug 18, 2022, 8:31:39 AM")

| Attachment: | [*sample.viv*](/attachment/ticket/2390/sample.viv)[​](/raw-attachment/ticket/2390/sample.viv "Download") added |
| --- | --- |

### [comment:1](#comment:1) by ylzs, [2 years ago](/timeline?from=2022-08-18T08%3A32%3A56Z&precision=second "See timeline at Aug 18, 2022, 8:32:56 AM")

| Severity: | blocker → normal |
| --- | --- |

### [comment:2](#comment:2) by ylzs, [2 years ago](/timeline?from=2022-08-18T08%3A59%3A55Z&precision=second "See timeline at Aug 18, 2022, 8:59:55 AM")

Is this a Bug?

### [comment:3](#comment:3) by reimar, [2 years ago](/timeline?from=2022-08-26T12%3A35%3A49Z&precision=second "See timeline at Aug 26, 2022, 12:35:49 PM")

| Resolution: | → fixed |
| --- | --- |
| Status: | new → closed |

It's only an issue in the error handling code, so not a bug that matters in practical use much.

But r38380 handles it.

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/2390?format=rss)
* [Comma-delimited Text](/ticket/2390?format=csv)
* [Tab-delimited Text](/ticket/2390?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>


