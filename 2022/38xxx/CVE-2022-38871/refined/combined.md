=== Content from github.com_9b93d939_20250115_102207.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffree5gc%2Ffree5gc%2Fissues%2F198)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffree5gc%2Ffree5gc%2Fissues%2F198)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=free5gc%2Ffree5gc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[free5gc](/free5gc)
/
**[free5gc](/free5gc/free5gc)**
Public

* [Notifications](/login?return_to=%2Ffree5gc%2Ffree5gc) You must be signed in to change notification settings
* [Fork
  635](/login?return_to=%2Ffree5gc%2Ffree5gc)
* [Star
   2k](/login?return_to=%2Ffree5gc%2Ffree5gc)

* [Code](/free5gc/free5gc)
* [Issues
  16](/free5gc/free5gc/issues)
* [Pull requests
  1](/free5gc/free5gc/pulls)
* [Actions](/free5gc/free5gc/actions)
* [Wiki](/free5gc/free5gc/wiki)
* [Security](/free5gc/free5gc/security)
* [Insights](/free5gc/free5gc/pulse)

Additional navigation options

* [Code](/free5gc/free5gc)
* [Issues](/free5gc/free5gc/issues)
* [Pull requests](/free5gc/free5gc/pulls)
* [Actions](/free5gc/free5gc/actions)
* [Wiki](/free5gc/free5gc/wiki)
* [Security](/free5gc/free5gc/security)
* [Insights](/free5gc/free5gc/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffree5gc%2Ffree5gc%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffree5gc%2Ffree5gc%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Bugs] AMF breaks due to malformed NAS message #198

Closed

[p1-bmu](/p1-bmu) opened this issue
Apr 26, 2021
· 4 comments

Closed

# [[Bugs] AMF breaks due to malformed NAS message](#top) #198

[p1-bmu](/p1-bmu) opened this issue
Apr 26, 2021
· 4 comments

## Comments

[![@p1-bmu](https://avatars.githubusercontent.com/u/42937885?s=80&v=4)](/p1-bmu)

Copy link

### **[p1-bmu](/p1-bmu)** commented [Apr 26, 2021](#issue-867719689)

| Describe the bug While testing the free5gc AMF for some NAS basic security features and fuzzing, I could trigger several crashes, while sending malformed NAS message. This means those issues are relatively exposed as they can be trigger by any 5G subscriber, in the principle. Here, all memory issues due to mishandled NAS messages and IE structures are caught by the GO memory runtime, which protects the binary for potential exploitable cases. To Reproduce No easy way to reproduce with available open-source tools. A modification of a gNB / UE emulator can be done to send malformed NAS messages. Expected behavior An attacker could leverage this to cause excessive downtime and resource consumption against a pool of AMF. As much as possible, crashing the binary should be avoided when decoding subscriber's provided NAS signaling message. During the decoding process, verifications should be made to ensure the messages are valid ; in case of invalid or malformed messages, it should be dropped and the corresponding UE context should be deleted. Environment (please complete the following information):  * free5GC Version: v3.0.5 * OS: Ubuntu 20.04 * Kernel version: 5.4.0-62-generic * go version: go1.14.4 linux/amd64  Trace FileConfiguration File No specific configuration is required. PCAP File No specific pcap file is provided. If required, pcap corresponding some specific crashes can be provided. Log File The following part lists some GOLANG stacktraces and corresponding malformed NAS and IE cases.  When a IE with TLV structure (type 4 or 6) is provided, but without the expected length, free5gc crashes, e.g. with an empty 5GSID:  ``` 2021-03-08T12:18:12Z [INFO][AMF][GMM][AMF_UE_NGAP_ID:31] Handle Registration Request panic: runtime error: index out of range [0] with length 0  goroutine 7 [running]: github.com/free5gc/amf/gmm.HandleRegistrationRequest(0xc00011b080, 0xe3727a, 0xb, 0xf, 0xc0002cd790, 0xc0004e3530, 0xb75bb2)         /home/p1sec/free5gc/NFs/amf/gmm/handler.go:425 +0x1969 github.com/free5gc/amf/gmm.DeRegistered(0xc0005a0600, 0xe373b9, 0xb, 0xc0005a0900)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:30 +0x3ef github.com/free5gc/fsm.(*FSM).SendEvent(0xc00009ab20, 0xc0005a0600, 0xe373b9, 0xb, 0xc0005a0900, 0x0, 0xcb6ba0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:95 +0x22d github.com/free5gc/amf/nas.Dispatch(0xc00011b080, 0xe3727a, 0xb, 0xf, 0xc00047f980, 0x20, 0xc00047f980)         /home/p1sec/free5gc/NFs/amf/nas/dispatch.go:22 +0x251 github.com/free5gc/amf/nas.HandleNAS(0xc0005d8a20, 0xf, 0xc000230f20, 0x11, 0x20)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:39 +0x178 github.com/free5gc/amf/ngap.HandleInitialUEMessage(0xc0005a4080, 0xc000248ce0)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:1003 +0x4dc github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc00013fbe0, 0xc00029e000, 0x3c, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:47 +0x3bb github.com/free5gc/amf/ngap/service.handleConnection(0xc00013fbe0, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```  Or a UE Security Capabilities:  ``` panic: runtime error: index out of range [1] with length 0  goroutine 49 [running]: github.com/free5gc/nas/nasType.(*UESecurityCapability).GetIA2_128_5G(...)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nasType/NAS_UESecurityCapability.go:197 github.com/free5gc/amf/context.(*AmfUe).SelectSecurityAlg(0xc000118580, 0xc000385af8, 0x1, 0x8, 0xc000385b00, 0x1, 0x8)         /home/p1sec/free5gc/NFs/amf/context/amf_ue.go:501 +0x226 github.com/free5gc/amf/gmm.SecurityMode(0xc00006f710, 0xe37356, 0xb, 0xc0003e7200)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:221 +0xfb3 github.com/free5gc/fsm.(*FSM).SendEvent(0xc000386b50, 0xc00006f710, 0xe3efd6, 0x16, 0xc0003e7200, 0x0, 0x0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:100 +0x2f4 github.com/free5gc/amf/gmm.HandleAuthenticationResponse(0xc000118580, 0xe3727a, 0xb, 0xc0004e1b20, 0x1, 0x20)         /home/p1sec/free5gc/NFs/amf/gmm/handler.go:1900 +0xdd8 github.com/free5gc/amf/gmm.Authentication(0xc00006f710, 0xe373b9, 0xb, 0xc0003e6390)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:165 +0x5ce github.com/free5gc/fsm.(*FSM).SendEvent(0xc000386b50, 0xc00006f710, 0xe373b9, 0xb, 0xc0003e6390, 0xc0004e1a60, 0xcb6ba0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:95 +0x22d github.com/free5gc/amf/nas.Dispatch(0xc000118580, 0xe3727a, 0xb, 0x2e, 0xc0004e1b00, 0x20, 0xc0004e1b00)         /home/p1sec/free5gc/NFs/amf/nas/dispatch.go:22 +0x251 github.com/free5gc/amf/nas.HandleNAS(0xc0003d3e60, 0x2e, 0xc00026e3c0, 0x15, 0x20)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:39 +0x178 github.com/free5gc/amf/ngap.HandleUplinkNasTransport(0xc000123e80, 0xc0004e09e0)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:233 +0x701 github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc000402120, 0xc0000c8000, 0x41, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:49 +0x527 github.com/free5gc/amf/ngap/service.handleConnection(0xc000402120, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```  This happens also with an oversized IE value, e.g. with 5G MM Capabilities:  ``` 2021-03-08T13:49:59Z [INFO][AMF][NGAP][172.27.128.253:38412] Handle Initial UE Message panic: runtime error: slice bounds out of range [:32] with length 13  goroutine 7 [running]: github.com/free5gc/nas/nasMessage.(*RegistrationRequest).DecodeRegistrationRequest(0xc000295e10, 0xc0001c1558)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nasMessage/NAS_RegistrationRequest.go:195 +0x1b57 github.com/free5gc/nas.(*Message).GmmMessageDecode(0xc00047c0a0, 0xc0001c1558, 0x10000000000000b, 0xc0001c12d0)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nas.go:201 +0x2de github.com/free5gc/nas.(*Message).PlainNasDecode(0xc00047c0a0, 0xc0001c1558, 0xc0001c1510, 0x2)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nas.go:175 +0x58 github.com/free5gc/amf/nas/nas_security.Decode(0xc0004ed600, 0xe3727a, 0xb, 0xc0003926c0, 0x3b, 0x40, 0x11, 0xc0004d4500, 0xcad660)         /home/p1sec/free5gc/NFs/amf/nas/nas_security/security.go:136 +0x452 github.com/free5gc/amf/nas.HandleNAS(0xc000408240, 0xf, 0xc0003926c0, 0x3b, 0x40)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:33 +0xaa github.com/free5gc/amf/ngap.HandleInitialUEMessage(0xc00030e180, 0xc000312ea0)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:1003 +0x4dc github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc000277d70, 0xc0005f8000, 0x66, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:47 +0x3bb github.com/free5gc/amf/ngap/service.handleConnection(0xc000277d70, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```   Providing malformed 5GSID can trigger several additional crashes in the `GutiToString` or `SuciToString` functions: ``` 2021-03-08T12:22:45Z [INFO][AMF][GMM][AMF_UE_NGAP_ID:12] Handle Registration Request panic: runtime error: slice bounds out of range [:4] with capacity 1  goroutine 7 [running]: github.com/free5gc/nas/nasConvert.GutiToString(0xc000479530, 0x1, 0x1, 0xc000479530, 0x0, 0x0, 0x0, 0x0)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nasConvert/MobileIdentity5GS.go:98 +0x386 github.com/free5gc/amf/gmm.HandleRegistrationRequest(0xc0005bb080, 0xe3727a, 0xb, 0xf, 0xc000351110, 0xc000743530, 0xb75bb2)         /home/p1sec/free5gc/NFs/amf/gmm/handler.go:435 +0x111d github.com/free5gc/amf/gmm.DeRegistered(0xc000452120, 0xe373b9, 0xb, 0xc0004526f0)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:30 +0x3ef github.com/free5gc/fsm.(*FSM).SendEvent(0xc000386ab0, 0xc000452120, 0xe373b9, 0xb, 0xc0004526f0, 0x0, 0xcb6ba0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:95 +0x22d github.com/free5gc/amf/nas.Dispatch(0xc0005bb080, 0xe3727a, 0xb, 0xf, 0xc00000cca0, 0x20, 0xc00000cca0)         /home/p1sec/free5gc/NFs/amf/nas/dispatch.go:22 +0x251 github.com/free5gc/amf/nas.HandleNAS(0xc0003d5e60, 0xf, 0xc0002e86c0, 0x12, 0x20)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:39 +0x178 github.com/free5gc/amf/ngap.HandleInitialUEMessage(0xc0000ca180, 0xc000316180)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:1003 +0x4dc github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc00013fda0, 0xc0004d2000, 0x3d, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:47 +0x3bb github.com/free5gc/amf/ngap/service.handleConnection(0xc00013fda0, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```  or  ``` 2021-03-08T12:27:02Z [INFO][AMF][GMM][AMF_UE_NGAP_ID:53] Handle Registration Request panic: runtime error: index out of range [2] with length 1  goroutine 49 [running]: github.com/free5gc/nas/nasConvert.SuciToString(0xc0002dcb20, 0x1, 0x1, 0xc0002dcb20, 0x0, 0x0, 0x0)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nasConvert/MobileIdentity5GS.go:36 +0xaa9 github.com/free5gc/amf/gmm.HandleRegistrationRequest(0xc000113080, 0xe3727a, 0xb, 0xf, 0xc000281450, 0xc000075530, 0xb75bb2)         /home/p1sec/free5gc/NFs/amf/gmm/handler.go:431 +0xd9c github.com/free5gc/amf/gmm.DeRegistered(0xc000069f20, 0xe373b9, 0xb, 0xc0003d2780)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:30 +0x3ef github.com/free5gc/fsm.(*FSM).SendEvent(0xc000304b00, 0xc000069f20, 0xe373b9, 0xb, 0xc0003d2780, 0x0, 0xcb6ba0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:95 +0x22d github.com/free5gc/amf/nas.Dispatch(0xc000113080, 0xe3727a, 0xb, 0xf, 0xc000628b60, 0x20, 0xc000628b60)         /home/p1sec/free5gc/NFs/amf/nas/dispatch.go:22 +0x251 github.com/free5gc/amf/nas.HandleNAS(0xc0003de000, 0xf, 0xc000480240, 0x12, 0x20)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:39 +0x178 github.com/free5gc/amf/ngap.HandleInitialUEMessage(0xc0004c0180, 0xc0000981a0)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:1003 +0x4dc github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc00009a140, 0xc00054e000, 0x3d, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:47 +0x3bb github.com/free5gc/amf/ngap/service.handleConnection(0xc00009a140, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```  or  ``` 2021-03-08T13:29:29Z [INFO][AMF][GMM][AMF_UE_NGAP_ID:1] Handle Registration Request panic: runtime error: index out of range [4] with length 4  goroutine 33 [running]: github.com/free5gc/nas/nasConvert.SuciToString(0xc00054a588, 0x4, 0x4, 0xc00054a588, 0x0, 0x0, 0x0)         /home/p1sec/go/pkg/mod/github.com/free5gc/nas@v1.0.0/nasConvert/MobileIdentity5GS.go:53 +0xa81 github.com/free5gc/amf/gmm.HandleRegistrationRequest(0xc00054e000, 0xe3727a, 0xb, 0xf, 0xc0005540d0, 0xc0004e5530, 0xb75bb2)         /home/p1sec/free5gc/NFs/amf/gmm/handler.go:431 +0xd9c github.com/free5gc/amf/gmm.DeRegistered(0xc00048cba0, 0xe373b9, 0xb, 0xc00048ced0)         /home/p1sec/free5gc/NFs/amf/gmm/sm.go:30 +0x3ef github.com/free5gc/fsm.(*FSM).SendEvent(0xc0002d6670, 0xc00048cba0, 0xe373b9, 0xb, 0xc00048ced0, 0x0, 0xcb6ba0)         /home/p1sec/go/pkg/mod/github.com/free5gc/fsm@v1.0.0/fsm.go:95 +0x22d github.com/free5gc/amf/nas.Dispatch(0xc00054e000, 0xe3727a, 0xb, 0xf, 0xc00053afa0, 0x20, 0xc00053afa0)         /home/p1sec/free5gc/NFs/amf/nas/dispatch.go:22 +0x251 github.com/free5gc/amf/nas.HandleNAS(0xc0004c2240, 0xf, 0xc00049a940, 0x15, 0x20)         /home/p1sec/free5gc/NFs/amf/nas/handler.go:39 +0x178 github.com/free5gc/amf/ngap.HandleInitialUEMessage(0xc0004b2000, 0xc000508880)         /home/p1sec/free5gc/NFs/amf/ngap/handler.go:1003 +0x4dc github.com/free5gc/amf/ngap.Dispatch(0xfab8c0, 0xc000304170, 0xc00051e000, 0x40, 0x2000)         /home/p1sec/free5gc/NFs/amf/ngap/dispatcher.go:47 +0x3bb github.com/free5gc/amf/ngap/service.handleConnection(0xc000304170, 0x2000, 0xe6a348, 0xe6a350)         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:204 +0x700 created by github.com/free5gc/amf/ngap/service.listenAndServe         /home/p1sec/free5gc/NFs/amf/ngap/service/service.go:136 +0xc43  ```   Finally, it seems using any kind of LADN Indicator within the 5G Registration Request message leads to the AMF getting stuck, consuming CPU and memory forever, and not responding on the SCTP socket anymore. The process gets finally killed by the Linux kernel. For instance sending a NAS Registration Request with the following LADN Indicator structure:  ``` ### LADNInd ###  <T : 116>  <L : 8>  <V : 0x0000000000000000>  ```  Leads to this situation:  ``` [4410188.716481] Out of memory: Killed process 1955374 (amf) total-vm:19664848kB, anon-rss:7375620kB, file-rss:0kB, shmem-rss:0kB, UID:1000 pgtables:22604kB oom_score_adj:0 [4410189.087583] oom_reaper: reaped process 1955374 (amf), now anon-rss:40kB, file-rss:0kB, shmem-rss:0kB  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@anilpetnakota](https://avatars.githubusercontent.com/u/112419693?s=80&v=4)](/anilpetnakota)

Copy link

### **[anilpetnakota](/anilpetnakota)** commented [Sep 5, 2023](#issuecomment-1706602368)

| any fix available for this? |
| --- |

All reactions

Sorry, something went wrong.

[![@brianchennn](https://avatars.githubusercontent.com/u/46628572?s=80&u=433d838602d7484853822b0a362bae1ae436b374&v=4)](/brianchennn)

Copy link

Contributor

### **[brianchennn](/brianchennn)** commented [Sep 11, 2023](#issuecomment-1713451190)

| [@anilpetnakota](https://github.com/anilpetnakota) The member of free5gc team, [@BENHSU0723](https://github.com/BENHSU0723), will reproduce this issue this week. I recommend you updating to the latest version v3.3.0 and see whether this issue still exists. |
| --- |

All reactions

Sorry, something went wrong.

[![@BENHSU0723](https://avatars.githubusercontent.com/u/66531635?s=80&u=a2a2c33dbce5d11a663abfa7aa5a5eb8915894d9&v=4)](/BENHSU0723)

Copy link

### **[BENHSU0723](/BENHSU0723)** commented [Sep 13, 2023](#issuecomment-1717002775)

| Hello, I'm currently addressing this issue. As of now, it seems that all error handling has been addressed in the latest version of [free5gc(v3.3.0)](https://github.com/free5gc/free5gc/tree/v3.3.0), except for the UE Security Capabilities. I'll be fixing the issue related to UE Security Capabilities in the next few days. Also, [@p1-bmu](https://github.com/p1-bmu) could you please confirm if you are testing the Registration Request with LADN Indicator using [UERANSIM](https://github.com/aligungr/UERANSIM)? It appears that UERANSIM does not write or use this parameter by default. |
| --- |

All reactions

Sorry, something went wrong.

[![@p1-bmu](https://avatars.githubusercontent.com/u/42937885?s=80&v=4)](/p1-bmu)

Copy link

Author

### **[p1-bmu](/p1-bmu)** commented [Sep 13, 2023](#issuecomment-1718055832)

| Thanks for working on this.On my side, this corresponds to a project I did more than 2 years ago, and I don't have the right setup straight available: I cannot guarantee I will be able to check in the forthcoming weeks. |
| --- |

All reactions

Sorry, something went wrong.

[![@BENHSU0723](https://avatars.githubusercontent.com/u/66531635?s=40&u=a2a2c33dbce5d11a663abfa7aa5a5eb8915894d9&v=4)](/BENHSU0723)
[BENHSU0723](/BENHSU0723)
mentioned this issue
[Dec 1, 2023](#ref-pullrequest-2020744123)

[fix the issue198, add error handle of UE Security Capabilities
free5gc/nas#24](/free5gc/nas/pull/24)
 Merged

[![@brianchennn](https://avatars.githubusercontent.com/u/46628572?s=40&u=433d838602d7484853822b0a362bae1ae436b374&v=4)](/brianchennn)
[brianchennn](/brianchennn)
closed this as [completed](/free5gc/free5gc/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 4, 2023](#event-11135860847)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ffree5gc%2Ffree5gc%2Fissues%2F198)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@p1-bmu](https://avatars.githubusercontent.com/u/42937885?s=52&v=4)](/p1-bmu) [![@brianchennn](https://avatars.githubusercontent.com/u/46628572?s=52&v=4)](/brianchennn) [![@BENHSU0723](https://avatars.githubusercontent.com/u/66531635?s=52&v=4)](/BENHSU0723) [![@anilpetnakota](https://avatars.githubusercontent.com/u/112419693?s=52&v=4)](/anilpetnakota)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


