```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by a missing null check before dereferencing a pointer to a node in the graph.",
    "weaknesses": [
      "Null pointer dereference"
    ],
    "impact": "A specially crafted SavedModel file can cause a null pointer dereference during graph optimization, leading to a denial of service.",
    "attack_vectors": [
      "A malformed SavedModel file can trigger the vulnerability during the graph optimization process."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to provide a specially crafted SavedModel file which is then loaded, and optimized. This typically would mean that the attacker can supply model files to the application."
  },
  "cve": "CVE-2022-23589",
  "additional_details": {
    "description": "The vulnerability occurs in two places: constant folding and `IsIdentityConsumingSwitch`. In constant folding, the code attempts to retrieve nodes based on inputs without checking if they exist, leading to a dereference of a null pointer. Similarly, in the `IsIdentityConsumingSwitch` function, the code attempts to access a node based on a tensor ID without checking for its existence first, also leading to a null pointer dereference. The vulnerability is triggered when a SavedModel with missing or invalid nodes is loaded and optimized, triggering a null pointer dereference. The fix involves adding null checks to ensure that a node is not dereferenced before verifying its existence. This will prevent the crash if the graph structure is not as expected.",
     "affected_code_locations": [
        {
          "file": "tensorflow/core/grappler/optimizers/constant_folding.cc",
          "line_numbers": [
            3505,
            3506,
            3507,
            3508,
            3509,
            3510,
             3511
           ]
        },
        {
         "file": "tensorflow/core/grappler/mutable_graph_view.cc",
          "line_numbers": [
            68,
            69,
            70,
            71,
            72,
            73,
            74
          ]
        }
      ]
  }
}
```