Based on the provided information, here's an analysis of CVE-2022-23077:

**Root Cause of Vulnerability:**

The vulnerability stems from a failure to properly sanitize the `redirectTo` parameter in the login page URL, allowing for the injection of malicious JavaScript code. Specifically, the application was not effectively neutralizing user-supplied input during the generation of the web page, leading to a DOM-based Cross-Site Scripting (XSS) vulnerability.

**Weaknesses/Vulnerabilities Present:**

*   **DOM-based XSS:** The primary vulnerability is a DOM-based XSS. This occurs when the application's client-side JavaScript code processes user input and uses it to modify the DOM in an unsafe way.
*   **Insufficient Input Sanitization:** The application uses `DOMPurify.sanitize()`, but this was not enough to prevent the exploit. The vulnerability was in how the redirect was handled after sanitization, specifically with double slashes and dots.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** An attacker can inject malicious JavaScript code, which will be executed in the victim's browser when they log in.
*   **Session Hijacking:**  The injected JavaScript could be used to steal cookies and session tokens, potentially allowing the attacker to hijack the victim's account.
*   **Data Theft/Manipulation:** The attacker can steal sensitive information or manipulate data within the user's session.
*   **Redirect to Malicious Sites:** The attacker could redirect the user to a malicious site after login.

**Attack Vectors:**

*   **Login Page URL Manipulation:** The attack vector is the `redirectTo` parameter in the login page URL. An attacker crafts a URL with a malicious JavaScript payload in this parameter.

**Required Attacker Capabilities/Position:**

*   **Knowledge of Vulnerability:** The attacker must know that the `redirectTo` parameter is vulnerable to XSS.
*   **Ability to Craft Malicious URL:**  The attacker must be able to create a crafted URL with a malicious JavaScript payload.
*   **User Interaction:** The attack requires the user to click on the malicious link and attempt to log in using the vulnerable URL. The XSS will execute after the successful login.

**Technical Details from the provided Content:**

*   The fix implemented was to remove backslashes (`\`), double forward slashes (`//`) and dots (`.`) from the sanitized string before redirection.
    ```
    let sanitizedString = DOMPurify.sanitize(redirect).replace(/\\|\/\/|\./g, '');
    ```
*   The vulnerable code was located in `website/client/src/components/auth/registerLoginReset.vue` within the `sanitizeRedirect` function.
*   The vulnerable versions of Habitica are v4.119.0 through v4.232.2.
*   The fix is available in Habitica version v4.233.0

**Additional Notes:**

*   The vulnerability is triggered *after* a successful login, making it less likely to be noticed immediately and potentially more impactful as the user is now logged into their account.
*   The provided PoC code is `?redirectTo=javascript:alert(document.cookie)` demonstrating the basic XSS payload that could be injected via the `redirectTo` parameter.

This analysis provides more detail than a typical CVE description, particularly concerning the code location and how the vulnerability was patched.