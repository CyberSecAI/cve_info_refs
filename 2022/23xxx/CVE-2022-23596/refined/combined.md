=== Content from github.com_61031e3a_20250115_092723.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fsecurity%2Fadvisories%2FGHSA-m6cj-93v6-cvr5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fsecurity%2Fadvisories%2FGHSA-m6cj-93v6-cvr5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=junrar%2Fjunrar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[junrar](/junrar)
/
**[junrar](/junrar/junrar)**
Public

* [Notifications](/login?return_to=%2Fjunrar%2Fjunrar) You must be signed in to change notification settings
* [Fork
  77](/login?return_to=%2Fjunrar%2Fjunrar)
* [Star
   292](/login?return_to=%2Fjunrar%2Fjunrar)

* [Code](/junrar/junrar)
* [Issues
  1](/junrar/junrar/issues)
* [Pull requests
  7](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

Additional navigation options

* [Code](/junrar/junrar)
* [Issues](/junrar/junrar/issues)
* [Pull requests](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

# A carefully crafted RAR archive can trigger an infinite loop while extracting

Low

[gotson](/gotson)
published
GHSA-m6cj-93v6-cvr5
Jan 31, 2022

## Package

maven

com.github.junrar:junrar
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<7.5.3

## Patched versions

7.5.3

## Description

### Impact

A carefully crafted RAR archive can trigger an infinite loop while extracting said archive. The impact depends solely on how the application uses the library, and whether files can be provided by malignant users.

### Patches

The problem is partially patched in 7.4.1

### Workarounds

None

### References

[#73](https://github.com/junrar/junrar/issues/73)

[#81](https://github.com/junrar/junrar/issues/81)

### Severity

Low

### CVE ID

CVE-2022-23596

### Weaknesses

No CWEs

### Credits

* [![@occia](https://avatars.githubusercontent.com/u/14798217?s=40&v=4)](/occia)
  [occia](/occia)
  Analyst
* [![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=40&v=4)](/ZanderHuang)
  [ZanderHuang](/ZanderHuang)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a94a3a31_20250115_092722.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fissues%2F73)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fissues%2F73)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=junrar%2Fjunrar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[junrar](/junrar)
/
**[junrar](/junrar/junrar)**
Public

* [Notifications](/login?return_to=%2Fjunrar%2Fjunrar) You must be signed in to change notification settings
* [Fork
  77](/login?return_to=%2Fjunrar%2Fjunrar)
* [Star
   292](/login?return_to=%2Fjunrar%2Fjunrar)

* [Code](/junrar/junrar)
* [Issues
  1](/junrar/junrar/issues)
* [Pull requests
  7](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

Additional navigation options

* [Code](/junrar/junrar)
* [Issues](/junrar/junrar/issues)
* [Pull requests](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjunrar%2Fjunrar%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjunrar%2Fjunrar%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [BUG]A carefully crafted RAR archive can trigger an infinite loop while parsing. #73

Closed

[Han0nly](/Han0nly) opened this issue
Jan 27, 2022
· 10 comments

Closed

# [[BUG]A carefully crafted RAR archive can trigger an infinite loop while parsing.](#top) #73

[Han0nly](/Han0nly) opened this issue
Jan 27, 2022
· 10 comments

Labels
[bug](/junrar/junrar/labels/bug)
[released](/junrar/junrar/labels/released)

## Comments

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issue-1115731408) • edited Loading

| **Describe the bug** A carefully crafted RAR archive can trigger an infinite loop while parsing the file. This could be used to mount a denial of service attack against services that use junrar.  **To Reproduce**  ``` String encodedString = "UmFyIRoHAM+Qcw4AAAAAKgAAAAAXF3QggE4ASwEAACICAAADZXUl9710qkIdNC4ApIEAAF9fTUlDT1NYXC5fYXBwbGUpdG91Y2gtaWNvbi03MC1wcmVjb21wb3NlZC5wbmcJ3RFMy9WBV2REVHpele6iC2cnv5JltbeqElgNF1pFjxFEQOWXhHq2ScsnIV5jb21wb3NlZC6Qcw4AAAAAKgAAAGREVA+VZ3qi7l4nv5Jly7W3qhJYDZDaRcURs78ajbZ7SWjLJyFah8afvQIAAADEvXYBRXwAQAUBBgAAAAAAAC/jZmlgun4oIP1Z4AG7ybwKgFwrlLrUKiSxjkiGPQFX/wAAL/8A////////+SVUCUzV3REly4FXZEReVHqV7qJYZyezxAAAAAAAAL+SZbVft6ruqo0QWkWPEUSMA5dA5QCE+3q2AAAAAAAAAgBJyyMhXocAAAAAAIefGkfCXwV8FHoKlbPhXgA//O5fgDAhAQAAAAAAAABuZphoBm71hnkO4GbmYGm6fs7f/VkAAAACAAFXqLsj6Xd3d3d3d3d3d3dgd3d3d3d3d3d3d3d3V3d3d3d3d3d3d3d3d3d3d3d3d3dzd3V3d3fTd3d3OJIAAABSAHIhGgcAz5BzAAANAAAAAAAAABcXdHkASwEAACICAAAD////////////////////+////////z1ldSV3dw=="; byte[] decodedBytes = Base64.getDecoder().decode(encodedString); InputStream inputStream = new ByteArrayInputStream(decodedBytes);  final Archive archive = new Archive(inputStream); while (true) { 	FileHeader fileHeader = archive.nextFileHeader(); 	if (fileHeader == null) { 		break; 	} 	archive.extractFile(fileHeader, OutputStream.nullOutputStream());  }  ```  **Expected behavior** Infinite loop.  **File** [loop-913d3158487310b1b4b74086ab888f5ed56a8493.zip](https://github.com/junrar/junrar/files/7947329/loop-913d3158487310b1b4b74086ab888f5ed56a8493.zip)  **Environment (please complete the following information):**   * OS: Mac OS 12.1 & Ubuntu Linux 16.04 (4.15.0-163-generic) * Junrar version: 7.4.0   **Additional context** It seems this PoC can reach [this while loop] (   [junrar/src/main/java/com/github/junrar/unpack/vm/RarVM.java](https://github.com/junrar/junrar/blob/dc3d299b1596e8750f386021d6b4efde6c84bceb/src/main/java/com/github/junrar/unpack/vm/RarVM.java#L227-L629)  Lines 227 to 629 in [dc3d299](/junrar/junrar/commit/dc3d299b1596e8750f386021d6b4efde6c84bceb)   |  | while (true) { | | --- | --- | |  | VMPreparedCommand cmd = preparedCode.get(IP); | |  | int op1 = getOperand(cmd.getOp1()); | |  | int op2 = getOperand(cmd.getOp2()); | |  | switch (cmd.getOpCode()) { | |  | case VM\_MOV: | |  | setValue(cmd.isByteMode(), mem, op1, getValue(cmd.isByteMode(), | |  | mem, op2)); // SET\_VALUE(Cmd->ByteMode,Op1,GET\_VALUE(Cmd->ByteMode,Op2)); | |  | break; | |  | case VM\_MOVB: | |  | setValue(true, mem, op1, getValue(true, mem, op2)); | |  | break; | |  | case VM\_MOVD: | |  | setValue(false, mem, op1, getValue(false, mem, op2)); | |  | break; | |  |  | |  | case VM\_CMP: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int result = value1 - getValue(cmd.isByteMode(), mem, op2); | |  |  | |  | if (result == 0) { | |  | flags = VMFlags.VM\_FZ.getFlag(); | |  | } else { | |  | flags = (result > value1) ? 1 : 0 | (result & VMFlags.VM\_FS | |  | .getFlag()); | |  | } | |  | } | |  | break; | |  |  | |  | case VM\_CMPB: { | |  | int value1 = getValue(true, mem, op1); | |  | int result = value1 - getValue(true, mem, op2); | |  | if (result == 0) { | |  | flags = VMFlags.VM\_FZ.getFlag(); | |  | } else { | |  | flags = (result > value1) ? 1 : 0 | (result & VMFlags.VM\_FS | |  | .getFlag()); | |  | } | |  | } | |  | break; | |  | case VM\_CMPD: { | |  | int value1 = getValue(false, mem, op1); | |  | int result = value1 - getValue(false, mem, op2); | |  | if (result == 0) { | |  | flags = VMFlags.VM\_FZ.getFlag(); | |  | } else { | |  | flags = (result > value1) ? 1 : 0 | (result & VMFlags.VM\_FS | |  | .getFlag()); | |  | } | |  | } | |  | break; | |  |  | |  | case VM\_ADD: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int result = (int) ((((long) value1 + (long) getValue(cmd | |  | .isByteMode(), mem, op2))) & 0xffffffff); | |  | if (cmd.isByteMode()) { | |  | result &= 0xff; | |  | flags = (result < value1) ? 1 | |  | : 0 | (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : ((result & 0x80) != 0) ? VMFlags.VM\_FS | |  | .getFlag() : 0); | |  | // Flags=(Result<Value1)|(Result==0 ? VM\_FZ:((Result&0x80) ? | |  | // VM\_FS:0)); | |  | } else { | |  | flags = (result < value1) ? 1 | |  | : 0 | (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())); | |  | } | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  |  | |  | case VM\_ADDB: | |  | setValue(true, mem, op1, | |  | (int) ((long) getValue(true, mem, op1) & 0xFFffFFff | |  | + (long) getValue(true, mem, op2) & 0xFFffFFff)); | |  | break; | |  | case VM\_ADDD: | |  | setValue( | |  | false, | |  | mem, | |  | op1, | |  | (int) ((long) getValue(false, mem, op1) & 0xFFffFFff | |  | + (long) getValue(false, mem, op2) & 0xFFffFFff)); | |  | break; | |  |  | |  | case VM\_SUB: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int result = (int) ((long) value1 & 0xffFFffFF | |  | - (long) getValue(cmd.isByteMode(), mem, op2) & 0xFFffFFff); | |  | flags = (result == 0) ? VMFlags.VM\_FZ.getFlag() | |  | : (result > value1) ? 1 : 0 | (result & VMFlags.VM\_FS | |  | .getFlag()); | |  | setValue(cmd.isByteMode(), mem, op1, result); // (Cmd->ByteMode,Op1,Result); | |  | } | |  | break; | |  |  | |  | case VM\_SUBB: | |  | setValue(true, mem, op1, | |  | (int) ((long) getValue(true, mem, op1) & 0xFFffFFff | |  | - (long) getValue(true, mem, op2) & 0xFFffFFff)); | |  | break; | |  | case VM\_SUBD: | |  | setValue( | |  | false, | |  | mem, | |  | op1, | |  | (int) ((long) getValue(false, mem, op1) & 0xFFffFFff | |  | - (long) getValue(false, mem, op2) & 0xFFffFFff)); | |  | break; | |  |  | |  | case VM\_JZ: | |  | if ((flags & VMFlags.VM\_FZ.getFlag()) != 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JNZ: | |  | if ((flags & VMFlags.VM\_FZ.getFlag()) == 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_INC: { | |  | int result = (int) ((long) getValue(cmd.isByteMode(), mem, op1) & 0xFFffFFff + 1); | |  | if (cmd.isByteMode()) { | |  | result &= 0xff; | |  | } | |  |  | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | } | |  | break; | |  |  | |  | case VM\_INCB: | |  | setValue( | |  | true, | |  | mem, | |  | op1, | |  | (int) ((long) getValue(true, mem, op1) & 0xFFffFFff + 1)); | |  | break; | |  | case VM\_INCD: | |  | setValue(false, mem, op1, (int) ((long) getValue(false, mem, | |  | op1) & 0xFFffFFff + 1)); | |  | break; | |  |  | |  | case VM\_DEC: { | |  | int result = (int) ((long) getValue(cmd.isByteMode(), mem, op1) & 0xFFffFFff - 1); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | } | |  | break; | |  |  | |  | case VM\_DECB: | |  | setValue( | |  | true, | |  | mem, | |  | op1, | |  | (int) ((long) getValue(true, mem, op1) & 0xFFffFFff - 1)); | |  | break; | |  | case VM\_DECD: | |  | setValue(false, mem, op1, (int) ((long) getValue(false, mem, | |  | op1) & 0xFFffFFff - 1)); | |  | break; | |  |  | |  | case VM\_JMP: | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | case VM\_XOR: { | |  | int result = getValue(cmd.isByteMode(), mem, op1) | |  | ^ getValue(cmd.isByteMode(), mem, op2); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_AND: { | |  | int result = getValue(cmd.isByteMode(), mem, op1) | |  | & getValue(cmd.isByteMode(), mem, op2); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_OR: { | |  | int result = getValue(cmd.isByteMode(), mem, op1) | |  | | getValue(cmd.isByteMode(), mem, op2); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_TEST: { | |  | int result = getValue(cmd.isByteMode(), mem, op1) | |  | & getValue(cmd.isByteMode(), mem, op2); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : result | |  | & VMFlags.VM\_FS.getFlag(); | |  | } | |  | break; | |  | case VM\_JS: | |  | if ((flags & VMFlags.VM\_FS.getFlag()) != 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JNS: | |  | if ((flags & VMFlags.VM\_FS.getFlag()) == 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JB: | |  | if ((flags & VMFlags.VM\_FC.getFlag()) != 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JBE: | |  | if ((flags & (VMFlags.VM\_FC.getFlag() | VMFlags.VM\_FZ.getFlag())) != 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JA: | |  | if ((flags & (VMFlags.VM\_FC.getFlag() | VMFlags.VM\_FZ.getFlag())) == 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_JAE: | |  | if ((flags & VMFlags.VM\_FC.getFlag()) == 0) { | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | } | |  | break; | |  | case VM\_PUSH: | |  | R[7] -= 4; | |  | setValue(false, mem, R[7] & VM\_MEMMASK, getValue(false, mem, | |  | op1)); | |  | break; | |  | case VM\_POP: | |  | setValue(false, mem, op1, getValue(false, mem, R[7] | |  | & VM\_MEMMASK)); | |  | R[7] += 4; | |  | break; | |  | case VM\_CALL: | |  | R[7] -= 4; | |  | setValue(false, mem, R[7] & VM\_MEMMASK, IP + 1); | |  | setIP(getValue(false, mem, op1)); | |  | continue; | |  | case VM\_NOT: | |  | setValue(cmd.isByteMode(), mem, op1, ~getValue( | |  | cmd.isByteMode(), mem, op1)); | |  | break; | |  | case VM\_SHL: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int value2 = getValue(cmd.isByteMode(), mem, op2); | |  | int result = value1 << value2; | |  | flags = (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())) | |  | | (((value1 << (value2 - 1)) & 0x80000000) != 0 ? VMFlags.VM\_FC | |  | .getFlag() | |  | : 0); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_SHR: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int value2 = getValue(cmd.isByteMode(), mem, op2); | |  | int result = value1 >>> value2; | |  | flags = (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())) | |  | | ((value1 >>> (value2 - 1)) & VMFlags.VM\_FC.getFlag()); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_SAR: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int value2 = getValue(cmd.isByteMode(), mem, op2); | |  | int result = ((int) value1) >>> value2; | |  | flags = (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())) | |  | | ((value1 >>> (value2 - 1)) & VMFlags.VM\_FC.getFlag()); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_NEG: { | |  | int result = -getValue(cmd.isByteMode(), mem, op1); | |  | flags = result == 0 ? VMFlags.VM\_FZ.getFlag() : VMFlags.VM\_FC | |  | .getFlag() | |  | | (result & VMFlags.VM\_FS.getFlag()); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  |  | |  | case VM\_NEGB: | |  | setValue(true, mem, op1, -getValue(true, mem, op1)); | |  | break; | |  | case VM\_NEGD: | |  | setValue(false, mem, op1, -getValue(false, mem, op1)); | |  | break; | |  | case VM\_PUSHA: { | |  | for (int i = 0, SP = R[7] - 4; i < regCount; i++, SP -= 4) { | |  | setValue(false, mem, SP & VM\_MEMMASK, R[i]); | |  | } | |  | R[7] -= regCount \* 4; | |  | } | |  | break; | |  | case VM\_POPA: { | |  | for (int i = 0, SP = R[7]; i < regCount; i++, SP += 4) { | |  | R[7 - i] = getValue(false, mem, SP & VM\_MEMMASK); | |  | } | |  | } | |  | break; | |  | case VM\_PUSHF: | |  | R[7] -= 4; | |  | setValue(false, mem, R[7] & VM\_MEMMASK, flags); | |  | break; | |  | case VM\_POPF: | |  | flags = getValue(false, mem, R[7] & VM\_MEMMASK); | |  | R[7] += 4; | |  | break; | |  | case VM\_MOVZX: | |  | setValue(false, mem, op1, getValue(true, mem, op2)); | |  | break; | |  | case VM\_MOVSX: | |  | setValue(false, mem, op1, (byte) getValue(true, mem, op2)); | |  | break; | |  | case VM\_XCHG: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | setValue(cmd.isByteMode(), mem, op1, getValue(cmd.isByteMode(), | |  | mem, op2)); | |  | setValue(cmd.isByteMode(), mem, op2, value1); | |  | } | |  | break; | |  | case VM\_MUL: { | |  | int result = (int) (((long) getValue(cmd.isByteMode(), mem, op1) | |  | & 0xFFffFFff | |  | \* (long) getValue(cmd.isByteMode(), mem, op2) & 0xFFffFFff) & 0xFFffFFff); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_DIV: { | |  | int divider = getValue(cmd.isByteMode(), mem, op2); | |  | if (divider != 0) { | |  | int result = getValue(cmd.isByteMode(), mem, op1) / divider; | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | } | |  | break; | |  | case VM\_ADC: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int FC = (flags & VMFlags.VM\_FC.getFlag()); | |  | int result = (int) ((long) value1 & 0xFFffFFff | |  | + (long) getValue(cmd.isByteMode(), mem, op2) | |  | & 0xFFffFFff + (long) FC & 0xFFffFFff); | |  | if (cmd.isByteMode()) { | |  | result &= 0xff; | |  | } | |  |  | |  | flags = (result < value1 || result == value1 && FC != 0) ? 1 | |  | : 0 | (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  | case VM\_SBB: { | |  | int value1 = getValue(cmd.isByteMode(), mem, op1); | |  | int FC = (flags & VMFlags.VM\_FC.getFlag()); | |  | int result = (int) ((long) value1 & 0xFFffFFff | |  | - (long) getValue(cmd.isByteMode(), mem, op2) | |  | & 0xFFffFFff - (long) FC & 0xFFffFFff); | |  | if (cmd.isByteMode()) { | |  | result &= 0xff; | |  | } | |  | flags = (result > value1 || result == value1 && FC != 0) ? 1 | |  | : 0 | (result == 0 ? VMFlags.VM\_FZ.getFlag() | |  | : (result & VMFlags.VM\_FS.getFlag())); | |  | setValue(cmd.isByteMode(), mem, op1, result); | |  | } | |  | break; | |  |  | |  | case VM\_RET: | |  | if (R[7] >= VM\_MEMSIZE) { | |  | return (true); | |  | } | |  | setIP(getValue(false, mem, R[7] & VM\_MEMMASK)); | |  | R[7] += 4; | |  | continue; | |  |  | |  | case VM\_STANDARD: | |  | ExecuteStandardFilter(VMStandardFilters.findFilter(cmd.getOp1() | |  | .getData())); | |  | break; | |  | case VM\_PRINT: | |  | break; | |  | } | |  | IP++; | |  | --maxOpCount; | |  | } |    ) but never break. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=80&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)

Copy link

Member

### **[gotson](/gotson)** commented [Jan 27, 2022](#issuecomment-1022815417)

| How did you find out, if I may ask? |
| --- |

All reactions

Sorry, something went wrong.

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

Author

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issuecomment-1022816280) • edited Loading

| How did you find out, if I may ask?  Hi [@gotson](https://github.com/gotson), We found this sample using a testing technique called fuzzing. |
| --- |

 👍
1
 gotson reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=80&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)

Copy link

Member

### **[gotson](/gotson)** commented [Jan 27, 2022](#issuecomment-1022817037)

| It doesn't seem the provided file is even a rar file, no ?  ``` unrar t loop-913d3158487310b1b4b74086ab888f5ed56a8493                                                Thu Jan 27 11:36:52 2022  UNRAR 6.10 freeware      Copyright (c) 1993-2022 Alexander Roshal  Corrupt header is found Main archive header is corrupt  Testing archive loop-913d3158487310b1b4b74086ab888f5ed56a8493  Unexpected end of archive No files to extract  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

Author

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issuecomment-1022818878)

| Hi [@gotson](https://github.com/gotson) , this infinite loop PoC file we provided here is indeed a broken RAR file. We use fuzzing to iteratively mutate some valid RAR files to test the junrar. |
| --- |

All reactions

Sorry, something went wrong.

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=80&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)

Copy link

Member

### **[gotson](/gotson)** commented [Jan 27, 2022](#issuecomment-1022819908)

| Thanks, i manage to reproduce in the tests, will have a look. |
| --- |

 👍
1
 Han0nly reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=40&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)
[gotson](/gotson)
closed this as [completed](/junrar/junrar/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[7b16b3d](/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)`
[Jan 27, 2022](#event-5960960830)

[github-actions](/apps/github-actions) bot
pushed a commit
that referenced
this issue
[Jan 27, 2022](#ref-commit-d058d84)
[![@semantic-release-bot](https://avatars.githubusercontent.com/u/32174276?s=40&u=8f06e06a49d30dc120cfc2aa06e01172847e36f1&v=4)](/semantic-release-bot)

`[chore(release): 7.4.1 [skip ci]](/junrar/junrar/commit/d058d84a8b400964a71e0e61315d2eaf01618e25 "chore(release): 7.4.1 [skip ci]

## [7.4.1](https://github.com/junrar/junrar/compare/v7.4.0...v7.4.1) (2022-01-27)

### Bug Fixes

* invalid subheader type would throw npe and make the extract loop ([7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)), closes [#73](https://github.com/junrar/junrar/issues/73)")`
…

`[d058d84](/junrar/junrar/commit/d058d84a8b400964a71e0e61315d2eaf01618e25)`

```
## [7.4.1]([v7.4.0...v7.4.1](https://github.com/junrar/junrar/compare/v7.4.0...v7.4.1)) (2022-01-27)

### Bug Fixes

* invalid subheader type would throw npe and make the extract loop ([[7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)]([7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7))), closes [[#73](https://github.com/junrar/junrar/issues/73)]([#73](https://github.com/junrar/junrar/issues/73))
```

[github-actions](/apps/github-actions) bot
pushed a commit
that referenced
this issue
[Jan 27, 2022](#ref-commit-1c59d9d)
[![@semantic-release-bot](https://avatars.githubusercontent.com/u/32174276?s=40&u=8f06e06a49d30dc120cfc2aa06e01172847e36f1&v=4)](/semantic-release-bot)

`[chore(release): 7.4.1 [skip ci]](/junrar/junrar/commit/1c59d9d0739f565feb550b4630b7ab88767c430e "chore(release): 7.4.1 [skip ci]

## [7.4.1](https://github.com/junrar/junrar/compare/v7.4.0...v7.4.1) (2022-01-27)

### Bug Fixes

* invalid subheader type would throw npe and make the extract loop ([7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)), closes [#73](https://github.com/junrar/junrar/issues/73)")`
…

`[1c59d9d](/junrar/junrar/commit/1c59d9d0739f565feb550b4630b7ab88767c430e)`

```
## [7.4.1]([v7.4.0...v7.4.1](https://github.com/junrar/junrar/compare/v7.4.0...v7.4.1)) (2022-01-27)

### Bug Fixes

* invalid subheader type would throw npe and make the extract loop ([[7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)]([7b16b3d](https://github.com/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7))), closes [[#73](https://github.com/junrar/junrar/issues/73)]([#73](https://github.com/junrar/junrar/issues/73))
```

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

Contributor

### **[github-actions](/apps/github-actions) bot** commented [Jan 27, 2022](#issuecomment-1022840708)

| 🎉 This issue has been resolved in version 7.4.1 🎉  The release is available on:   * `v7.4.1` * [GitHub release](https://github.com/junrar/junrar/releases/tag/v7.4.1)   Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot 📦🚀 |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[released](/junrar/junrar/labels/released)
label
[Jan 27, 2022](#event-5961037515)

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=40&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)
[gotson](/gotson)
added
the
[bug](/junrar/junrar/labels/bug)
label
[Jan 27, 2022](#event-5961041269)

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

Author

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issuecomment-1022859149)

| Hi [@gotson](https://github.com/gotson) , are you willing to help us to request a CVE ID through [GitHub Security Advisories](https://github.com/junrar/junrar/security/advisories) for this bug, which can cause Denial of Service. You can follow [this tutorial](https://authzed.com/blog/using-github-to-manage-your-first-cve/) to manage your bug fixing and alert any downstream dependencies of the issue so they can patch immediately if using the broken release. Thanks for your help! |
| --- |

All reactions

Sorry, something went wrong.

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=80&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)

Copy link

Member

### **[gotson](/gotson)** commented [Jan 27, 2022](#issuecomment-1022997042)

| Hi [@gotson](https://github.com/gotson) , are you willing to help us to request a CVE ID through [GitHub Security Advisories](https://github.com/junrar/junrar/security/advisories) for this bug, which can cause Denial of Service. You can follow [this tutorial](https://authzed.com/blog/using-github-to-manage-your-first-cve/) to manage your bug fixing and alert any downstream dependencies of the issue so they can patch immediately if using the broken release. Thanks for your help!  Thanks, it's a new process to me, but that's actually a good idea. |
| --- |

 👍
1
 Han0nly reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

Author

### **[Han0nly](/Han0nly)** commented [Mar 24, 2022](#issuecomment-1077728656) • edited Loading

| Hi [@gotson](https://github.com/gotson) , I found some files which can also trigger this infinite loop. I have tested these on the latest version (7.5.0) [loops.zip](https://github.com/junrar/junrar/files/8342701/loops.zip). |
| --- |

All reactions

Sorry, something went wrong.

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=80&u=64b13da8f5eddd000ed214ecc0e65efd750c5688&v=4)](/gotson)

Copy link

Member

### **[gotson](/gotson)** commented [Mar 25, 2022](#issuecomment-1078567675)

| Hi [@gotson](https://github.com/gotson) , I found some files which can also trigger this infinite loop. I have tested these on the latest version (7.5.0) [loops.zip](https://github.com/junrar/junrar/files/8342701/loops.zip).  Please open a new issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@junrar](https://avatars.githubusercontent.com/u/2277828?s=40&v=4)](/junrar)
[junrar](/junrar)
locked as **resolved** and limited conversation to collaborators
[Mar 25, 2022](#event-6303977174)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fissues%2F73).

Assignees

No one assigned

Labels

[bug](/junrar/junrar/labels/bug)
[released](/junrar/junrar/labels/released)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=52&v=4)](/gotson) [![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=52&v=4)](/Han0nly)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_726931a0_20250115_092720.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fcommit%2F7b16b3d90b91445fd6af0adfed22c07413d4fab7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fcommit%2F7b16b3d90b91445fd6af0adfed22c07413d4fab7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=junrar%2Fjunrar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[junrar](/junrar)
/
**[junrar](/junrar/junrar)**
Public

* [Notifications](/login?return_to=%2Fjunrar%2Fjunrar) You must be signed in to change notification settings
* [Fork
  77](/login?return_to=%2Fjunrar%2Fjunrar)
* [Star
   292](/login?return_to=%2Fjunrar%2Fjunrar)

* [Code](/junrar/junrar)
* [Issues
  1](/junrar/junrar/issues)
* [Pull requests
  7](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

Additional navigation options

* [Code](/junrar/junrar)
* [Issues](/junrar/junrar/issues)
* [Pull requests](/junrar/junrar/pulls)
* [Discussions](/junrar/junrar/discussions)
* [Actions](/junrar/junrar/actions)
* [Security](/junrar/junrar/security)
* [Insights](/junrar/junrar/pulse)

## Commit

[Permalink](/junrar/junrar/commit/7b16b3d90b91445fd6af0adfed22c07413d4fab7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: invalid subheader type would throw npe and make the extract loop

[Browse files](/junrar/junrar/tree/7b16b3d90b91445fd6af0adfed22c07413d4fab7)
Browse the repository at this point in the history

```
closes [#73](https://github.com/junrar/junrar/issues/73)
```

* Loading branch information

[![@gotson](https://avatars.githubusercontent.com/u/2139133?s=40&v=4)](/gotson)

[gotson](/junrar/junrar/commits?author=gotson "View all commits by gotson")
committed
Jan 27, 2022

1 parent
[306bb60](/junrar/junrar/commit/306bb60eed59f90103bf3e9f2446472f2357fb84)

commit 7b16b3d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**6 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/com/github/junrar

    - src/main/java/com/github/junrar/Archive.java
      [Archive.java](#diff-39e19eabb4c5d4cbb5d8bb58f6ef136c026285c43931335f9fda6b5ef8335cb9)
  + test

    - java/com/github/junrar

      * src/test/java/com/github/junrar/AbnormalFilesTest.java
        [AbnormalFilesTest.java](#diff-13cd81c6511d74fc6c17c490a9c28eb90cacd00b952cf573560b467e1da9d1e1)
    - resources/com/github/junrar/abnormal

      * src/test/resources/com/github/junrar/abnormal/loop.rar
        [loop.rar](#diff-fbf976bb98b63e8ecd210420c5328890a7c9f71c52b1b88ad053874e7e446e51)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[src/main/java/com/github/junrar/Archive.java](#diff-39e19eabb4c5d4cbb5d8bb58f6ef136c026285c43931335f9fda6b5ef8335cb9 "src/main/java/com/github/junrar/Archive.java")

Show comments

[View file](/junrar/junrar/blob/7b16b3d90b91445fd6af0adfed22c07413d4fab7/src/main/java/com/github/junrar/Archive.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,6 +45,7 @@ |
|  |  | import com.github.junrar.rarfile.RARVersion; |
|  |  | import com.github.junrar.rarfile.SignHeader; |
|  |  | import com.github.junrar.rarfile.SubBlockHeader; |
|  |  | import com.github.junrar.rarfile.SubBlockHeaderType; |
|  |  | import com.github.junrar.rarfile.UnixOwnersHeader; |
|  |  | import com.github.junrar.rarfile.UnrarHeadertype; |
|  |  | import com.github.junrar.unpack.ComprDataIO; |
| Expand Down  Expand Up | | @@ -449,7 +450,9 @@ private void readHeaders(final long fileLength) throws IOException, RarException |
|  |  | final SubBlockHeader subHead = new SubBlockHeader(blockHead, |
|  |  | subHeadbuffer); |
|  |  | subHead.print(); |
|  |  | switch (subHead.getSubType()) { |
|  |  | SubBlockHeaderType subType = subHead.getSubType(); |
|  |  | if (subType == null) break; |
|  |  | switch (subType) { |
|  |  | case MAC\_HEAD: { |
|  |  | final byte[] macHeaderbuffer = safelyAllocate(MacInfoHeader.MacInfoHeaderSize, MAX\_HEADER\_SIZE); |
|  |  | rawData.readFully(macHeaderbuffer, macHeaderbuffer.length); |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/test/java/com/github/junrar/AbnormalFilesTest.java](#diff-13cd81c6511d74fc6c17c490a9c28eb90cacd00b952cf573560b467e1da9d1e1 "src/test/java/com/github/junrar/AbnormalFilesTest.java")

Show comments

[View file](/junrar/junrar/blob/7b16b3d90b91445fd6af0adfed22c07413d4fab7/src/test/java/com/github/junrar/AbnormalFilesTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -58,7 +58,8 @@ public void extractFromStream(String filePath, Class<?> expectedException) throw |
|  |  | private static Stream<Arguments> provideFilesAndExpectedExceptionType() { |
|  |  | return Stream.of( |
|  |  | Arguments.of("abnormal/corrupt-header.rar", CorruptHeaderException.class), |
|  |  | Arguments.of("abnormal/mainHeaderNull.rar", BadRarArchiveException.class) |
|  |  | Arguments.of("abnormal/mainHeaderNull.rar", BadRarArchiveException.class), |
|  |  | Arguments.of("abnormal/loop.rar", CorruptHeaderException.class) |
|  |  | ); |
|  |  | } |
|  |  | } |

Binary file added
BIN
+529 Bytes

[src/test/resources/com/github/junrar/abnormal/loop.rar](#diff-fbf976bb98b63e8ecd210420c5328890a7c9f71c52b1b88ad053874e7e446e51 "src/test/resources/com/github/junrar/abnormal/loop.rar")

Show comments

[View file](/junrar/junrar/blob/7b16b3d90b91445fd6af0adfed22c07413d4fab7/src/test/resources/com/github/junrar/abnormal/loop.rar)
Edit file

Delete file

Binary file not shown.

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7b16b3d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjunrar%2Fjunrar%2Fcommit%2F7b16b3d90b91445fd6af0adfed22c07413d4fab7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


