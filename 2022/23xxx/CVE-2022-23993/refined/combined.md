=== Content from github.com_e2dd47a1_20250114_203218.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2Fpfsense%2Fcommit%2F5d82cce0d615a76b738798577a28a15803e59aeb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2Fpfsense%2Fcommit%2F5d82cce0d615a76b738798577a28a15803e59aeb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pfsense%2Fpfsense)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pfsense](/pfsense)
/
**[pfsense](/pfsense/pfsense)**
Public

* [Notifications](/login?return_to=%2Fpfsense%2Fpfsense) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fpfsense%2Fpfsense)
* [Star
   5k](/login?return_to=%2Fpfsense%2Fpfsense)

* [Code](/pfsense/pfsense)
* [Pull requests
  39](/pfsense/pfsense/pulls)
* [Actions](/pfsense/pfsense/actions)
* [Projects
  0](/pfsense/pfsense/projects)
* [Security](/pfsense/pfsense/security)
* [Insights](/pfsense/pfsense/pulse)

Additional navigation options

* [Code](/pfsense/pfsense)
* [Pull requests](/pfsense/pfsense/pulls)
* [Actions](/pfsense/pfsense/actions)
* [Projects](/pfsense/pfsense/projects)
* [Security](/pfsense/pfsense/security)
* [Insights](/pfsense/pfsense/pulse)

## Commit

[Permalink](/pfsense/pfsense/commit/5d82cce0d615a76b738798577a28a15803e59aeb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Clean up pkg filter text before use. Fixes #12725

[Browse files](/pfsense/pfsense/tree/5d82cce0d615a76b738798577a28a15803e59aeb)
Browse the repository at this point in the history

```
Also remove unnecessary echos of the value.
```

* Loading branch information

[![@jim-p](https://avatars.githubusercontent.com/u/174434?s=40&v=4)](/jim-p)

[jim-p](/pfsense/pfsense/commits?author=jim-p "View all commits by jim-p")
committed
Jan 25, 2022

1 parent
[c83b195](/pfsense/pfsense/commit/c83b195f258f472ce1d45305b56352bdd36cdbc0)

commit 5d82cce

Showing
**1 changed file**
with
**3 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

9 changes: 3 additions & 6 deletions

9
[src/usr/local/www/pkg.php](#diff-7bcf4c5fbe96fdd69865559af571aa10ea1535f8996dcf5f1fd3a3a511ced55a "src/usr/local/www/pkg.php")

Show comments

[View file](/pfsense/pfsense/blob/5d82cce0d615a76b738798577a28a15803e59aeb/src/usr/local/www/pkg.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -434,10 +434,11 @@ function save\_changes\_to\_xml(xml) { |
|  |  | if ($sf['name'] == $\_REQUEST['pkg\_filter\_type']) { |
|  |  | $filter\_fieldname = $sf['fieldname']; |
|  |  | #Use a default regex on sortable fields when none is declared |
|  |  | $pkg\_filter = cleanup\_regex\_pattern(htmlspecialchars(strip\_tags($\_REQUEST['pkg\_filter']))); |
|  |  | if ($sf['regex']) { |
|  |  | $filter\_regex = str\_replace("%FILTERTEXT%", $\_REQUEST['pkg\_filter'], trim($sf['regex'])); |
|  |  | $filter\_regex = str\_replace("%FILTERTEXT%", $pkg\_filter, trim($sf['regex'])); |
|  |  | } else { |
|  |  | $filter\_regex = "/{$\_REQUEST['pkg\_filter']}/i"; |
|  |  | $filter\_regex = "/{$pkg\_filter}/i"; |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand All | | @@ -452,7 +453,6 @@ function save\_changes\_to\_xml(xml) { |
|  |  | $fieldname = $ip[xml\_safe\_fieldname($column['fieldname'])]; |
|  |  | if ($column['fieldname'] == $filter\_fieldname) { |
|  |  | if ($filter\_regex) { |
|  |  | //echo "$filter\_regex - $fieldname<p/>"; |
|  |  | preg\_match($filter\_regex, $fieldname, $filter\_matches); |
|  |  | break; |
|  |  | } |
| Expand Down  Expand Up | | @@ -603,7 +603,4 @@ function save\_changes\_to\_xml(xml) { |
|  |  |  |
|  |  | </form> |
|  |  | <?php |
|  |  | echo "<!-- filter\_fieldname: {$filter\_fieldname} -->"; |
|  |  | echo "<!-- filter\_regex: {$filter\_regex} -->"; |
|  |  |  |
|  |  | include("foot.inc"); ?> |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5d82cce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpfsense%2Fpfsense%2Fcommit%2F5d82cce0d615a76b738798577a28a15803e59aeb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.netgate.com_1573f897_20250114_203217.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
pfSense-SA-22\_04.webgui Security Advisory
pfSense
Topic: XSS vulnerability in the WebGUI
Category: pfSense Base System
Module: webgui
Announced: 2022-01-25
Credits: Fabien MAISONNETTE (https://fr.linkedin.com/in/fabdotnet)
CVE ID: CVE-2022-23993
Affects: pfSense Plus software versions < 22.01
pfSense CE software versions < 2.6.0
Corrected: 2022-01-25 13:38:21 UTC (pfSense Plus master)
2022-01-25 13:51:24 UTC (pfSense Plus 22.01)
2022-01-25 13:38:21 UTC (pfSense CE master)
2022-01-25 13:51:24 UTC (pfSense CE 2.6.0)
0. Revision History
v1.1 2022-03-08 Updated solution information
v1.0 2022-01-25 Initial SA draft
I. Background
pfSense® software is a free network firewall distribution based on the
FreeBSD operating system. The pfSense software distribution includes third-
party free software packages for additional functionality, and provides most of
the functionality of common commercial firewalls.
pfSense® Plus is the productized version of pfSense software from Netgate®,
previously referred to as pfSense Factory Edition (FE). It is available to
Netgate appliance and CSP customers.
The majority of users of pfSense software have never installed or used a stock
FreeBSD system. Unlike similar GNU/Linux-based firewall distributions, there
is no need for any UNIX knowledge. The command line is never used, and there
is no need to ever manually edit any rule sets. Instead, pfSense software
includes a web interface for the configuration of all included components.
Users familiar with commercial firewalls will quickly understand the web
interface, while those unfamiliar with commercial-grade firewalls may encounter
a short learning curve.
II. Problem Description
A Cross-Site Scripting (XSS) vulnerability was found in pkg.php, a component of
the pfSense Plus and pfSense CE software GUI. This problems is present on
pfSense Plus version 21.05.2, pfSense CE version 2.5.2, and earlier versions of
both.
The page did not sanitize the contents of the pkg\_filter parameter nor did it
encode the output when it included the value of that parameter in the page,
leading to a possible XSS.
III. Impact
Due to the lack of proper encoding on the affected parameters susceptible to
XSS, arbitrary JavaScript could be executed in the user's browser. The user's
session cookie or other information from the session may be compromised.
IV. Workaround
To help mitigate the problem on older releases, use one or more
of the following:
\* Limit access to the affected pages to trusted administrators only.
\* Do not log into the firewall with the same browser used for non-
administrative web browsing.
V. Solution
Users can upgrade to pfSense Plus software version 22.01 or later when
available, or pfSense CE software version 2.6.0 or later. This upgrade may be
performed in the web interface or from the console.
See https://docs.netgate.com/pfsense/en/latest/install/upgrade-guide.html
Users on pfSense Plus version 21.05.2 or pfSense pfSense CE version 2.5.2 may
apply the fix from the recommended patches list in the System Patches package.
Users may also manually apply the relevant revisions below using the System
Patches package on pfSense pfSense Plus version 21.05.2 or pfSense CE version
2.5.2 and possibly on earlier versions.
See https://docs.netgate.com/pfsense/en/latest/development/system-patches.html
VI. Correction details
The following list contains the correction revision commit ID for each
affected item.
Branch/path Revision
- - -------------------------------------------------------------------------
pfSense/master 5d82cce0d615a76b738798577a28a15803e59aeb
pfSense/RELENG\_2\_6\_0 a9bdbd97984ff2ddefbceb2fe062fbe3a1c42d88
plus/plus-master 5d82cce0d615a76b738798577a28a15803e59aeb
plus/plus-RELENG\_22\_01 a9bdbd97984ff2ddefbceb2fe062fbe3a1c42d88
- - -------------------------------------------------------------------------
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE40XvjEU56XSUPIMdE7mH/ZIU+NoFAmInWhoACgkQE7mH/ZIU
+NoYQhAA3k8fWFWI3SVAFY9OPMMcU1HYwGLQix1BT2iYFxldIqwzT66k83k/MtTI
FaSlAGx7kDKQp0tLEWfqPDS94a9/YZSL84P1+0lmWK23fZKjK0MKdya5wZS75Yqq
SR5Ug0y/AOHe/07oowOON0+Ktqfq87ajKkrvA5xK9ZCOtZCPxh8OB6Ge+aFOVQZ7
FaDAshXSjkOUx99FhW5gxhn8hu00n9911uo275TxOY6qdWhp/AhW+3jJB4sFX36F
lf9ZJ2YECVWfHKjFieKIgXOZ6cXZOnxKF07S0JjwXc8IPocrOo3+Lik/+jgKK1EU
865OV4tuo0vme31AQrKcm5MJe9y1jBP/XKHbDKyWaW/POY5ixn5aeuDTMj33iYS0
VRISLf38URYv45fYSYUvo2FIat5MTjureQnTdfoJBOYIqDVvnCM22qozHgOj7S4P
N62wdl7yz3Y/q4Glod8F+Ldacv2fuOtLREnr4E1XaVIfuC2Mgb2wySng5hRb9kuY
invRvyHvFzVLAQ6H4znyyBu1VAAeR+YFpfzxty2I2IhfScw2RmcejirSUjpFo7A0
o9KjZ7GkcT2Tc+PQmi+dniZVurjREdXpAUjq41ZfeMHlr6ENNWs/U79xfEAMfrGI
WFN0CXASLNNQGt8KfO5Sq3y+C+0jSRB+w4GVZE8XdTJcV9F4K6I=
=ZQL1
-----END PGP SIGNATURE-----

