=== Content from github.com_0a168088_20250114_232302.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftreq%2Fsecurity%2Fadvisories%2FGHSA-fhpf-pp6p-55qc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftreq%2Fsecurity%2Fadvisories%2FGHSA-fhpf-pp6p-55qc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=twisted%2Ftreq)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[twisted](/twisted)
/
**[treq](/twisted/treq)**
Public

* [Notifications](/login?return_to=%2Ftwisted%2Ftreq) You must be signed in to change notification settings
* [Fork
  140](/login?return_to=%2Ftwisted%2Ftreq)
* [Star
   589](/login?return_to=%2Ftwisted%2Ftreq)

* [Code](/twisted/treq)
* [Issues
  55](/twisted/treq/issues)
* [Pull requests
  2](/twisted/treq/pulls)
* [Actions](/twisted/treq/actions)
* [Projects
  0](/twisted/treq/projects)
* [Wiki](/twisted/treq/wiki)
* [Security](/twisted/treq/security)
* [Insights](/twisted/treq/pulse)

Additional navigation options

* [Code](/twisted/treq)
* [Issues](/twisted/treq/issues)
* [Pull requests](/twisted/treq/pulls)
* [Actions](/twisted/treq/actions)
* [Projects](/twisted/treq/projects)
* [Wiki](/twisted/treq/wiki)
* [Security](/twisted/treq/security)
* [Insights](/twisted/treq/pulse)

# Unsafe handling of user-specified cookies in treq

Moderate

[twm](/twm)
published
GHSA-fhpf-pp6p-55qc
Jan 30, 2022

## Package

pip

treq
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<22.1.0

## Patched versions

22.1.0

## Description

### Impact

Treq's request methods (`treq.get`, `treq.post`, `HTTPClient.request`, `HTTPClient.get`, etc.) accept cookies as a dictionary, for example:

```
treq.get('https://example.com/', cookies={'session': '1234'})
```

Such cookies are not bound to a single domain, and are therefore sent to *every* domain ("supercookies"). This can potentially cause sensitive information to leak upon an HTTP redirect to a different domain., e.g. should `https://example.com` redirect to `http://cloudstorageprovider.com` the latter will receive the cookie `session`.

### Patches

Treq 2021.1.0 and later bind cookies given to request methods (`treq.request`, `treq.get`, `HTTPClient.request`, `HTTPClient.get`, etc.) to the origin of the *url* parameter.

### Workarounds

Instead of passing a dictionary as the *cookies* argument, pass a `http.cookiejar.CookieJar` instance with properly domain- and scheme-scoped cookies in it:

```
from http.cookiejar import CookieJar
from requests.cookies import create_cookie

jar = CookieJar()
jar.add_cookie(
    create_cookie(
        name='session',
        value='1234',
        domain='example.com',
        secure=True,
    ),
)
client = HTTPClient(cookies=jar)
client.get('https://example.com/')
```
### References

* Originally reported at [huntr.dev](https://huntr.dev/bounties/3c9204fc-a3d1-4441-8599-924c5f57e7ae/?token=06d930e37046c914bcb037e85cc227dc7b510b475989fc69837566562ba899277d46b0fb4b1e21cdcb6ddc1b7d9b1ded632cf3a3551ecb89afca16a63b34641284b50479d5195bba2ac09b116f3dd4fad27f54404c2de922c05c8c8b744aec27bb4d4d198cb8b3abf479af0c2d5fbaa10412da7922594ac3eb39)
* A related issue in the handling of HTTP basic authentication was addressed in Twisted 22.1 ([GHSA-92x2-jw7w-xvvx](https://github.com/twisted/twisted/security/advisories/GHSA-92x2-jw7w-xvvx), [CVE-2022-21712](https://github.com/advisories/GHSA-92x2-jw7w-xvvx "CVE-2022-21712")).

### Severity

Moderate

### CVE ID

CVE-2022-23607

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@glyph](https://avatars.githubusercontent.com/u/716529?s=40&v=4)](/glyph)
  [glyph](/glyph)
  Analyst

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from lists.debian.org_8b62b9c2_20250114_232303.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 2954-1] python-treq security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2954-1] python-treq security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Fri, 18 Mar 2022 06:46:27 -0400 (EDT)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/164760034185.695155.1110900786804304308%40copycat)Â [164760034185.695155.1110900786804304308@copycat](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2954-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
March 18, 2022                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : python-treq
Version        : 15.1.0-1+deb9u1
CVE ID         : CVE-2022-23607
Debian Bug     : #1005041

It was discovered that there was an information disclosure issue in
python-treq, a high-level library/API for making HTTP requests using
the Twisted network programming library. HTTP cookies were not bound
to a single domain and were instead sent to every domain.

For Debian 9 "Stretch", this problem has been fixed in version
15.1.0-1+deb9u1.

We recommend that you upgrade your python-treq packages.

For the detailed security status of python-treq please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/python-treq>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmI0YtIACgkQHpU+J9Qx
HljrrRAAs4oTsXufgSjgnR/Py/nsKBKQM5WLY00EqPWgi7B4RXyDVnSpk3jkG0Ty
OWvHH2gp3zvK6TmTfBuGhrgOhoiqEmjQAmiP3Nf+90xUY9nIL3V2X7/zenf8Pp3s
IuRH+A59vMOVGNantsrs1oHs7lXO7jEjM+f52G2Wi7V04ZKIh0aQNkbdRAyHGaVw
1AzpYGHOS1QSNz7jsWjColmSkNkE0W0RG/dwvaCsCjWva/4pT4gvgcuLox3oCdEp
ARegun3BXGmmux5IoK78Hg22gzcUTY8ckg7pSYNDQkXEbOIWttxuB3A2bkXXr2x5
SeI6ThRFfFWeDcmJnY2K1SwW0MRJ0uUfXEj+WmCf9pTyFC8dfJmMFbEcXlwNtimp
wP43UMVqVwsrL9VYAjh16kDMCRj7Pq40/l0osWYfm/OdZnn5h6Nf4HxW2WKwZfAS
vG4tlIlrjRh8LINu/Fd/XRCWmRe9AfUDHfgQe+iS7vG/nJ8lYMwojlXzOmyYOvPh
H9rxaKXpWmsoB9CzYIRgrEcBdpkzBHtM6D9fhpREgl05zI+eJlfbifuvfzEztHVi
1JkjageF3LsIkoV4uc2EWFtaYGsf3F8ceBnmgAg75Fl+Z402J/PglPnsMUuTcWRx
HIaLTUIKZVIh088J/sVHb9FFvki7com6UMbJ6WIVSL8JRVTfmb4=
=3qWQ
-----END PGP SIGNATURE-----

```

---


