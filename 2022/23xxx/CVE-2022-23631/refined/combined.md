=== Content from github.com_6b417fed_20250114_212528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflightcontrolhq%2Fsuperjson%2Fsecurity%2Fadvisories%2FGHSA-5888-ffcr-r425)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflightcontrolhq%2Fsuperjson%2Fsecurity%2Fadvisories%2FGHSA-5888-ffcr-r425)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=flightcontrolhq%2Fsuperjson)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flightcontrolhq](/flightcontrolhq)
/
**[superjson](/flightcontrolhq/superjson)**
Public

* [Notifications](/login?return_to=%2Fflightcontrolhq%2Fsuperjson) You must be signed in to change notification settings
* [Fork
  95](/login?return_to=%2Fflightcontrolhq%2Fsuperjson)
* [Star
   4.3k](/login?return_to=%2Fflightcontrolhq%2Fsuperjson)

* [Code](/flightcontrolhq/superjson)
* [Issues
  20](/flightcontrolhq/superjson/issues)
* [Pull requests
  15](/flightcontrolhq/superjson/pulls)
* [Actions](/flightcontrolhq/superjson/actions)
* [Security](/flightcontrolhq/superjson/security)
* [Insights](/flightcontrolhq/superjson/pulse)

Additional navigation options

* [Code](/flightcontrolhq/superjson)
* [Issues](/flightcontrolhq/superjson/issues)
* [Pull requests](/flightcontrolhq/superjson/pulls)
* [Actions](/flightcontrolhq/superjson/actions)
* [Security](/flightcontrolhq/superjson/security)
* [Insights](/flightcontrolhq/superjson/pulse)

# Prototype Pollution leading to Remote Code Execution

Critical

[flybayer](/flybayer)
published
GHSA-5888-ffcr-r425
Feb 9, 2022

## Package

npm

blitz
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 0.45.3

## Patched versions

0.45.3

npm

superjson
([npm](/advisories?query=ecosystem%3Anpm))

< 1.8.1

1.8.1

## Description

### Impact

This is critical vulnerability, as it allows to run arbitrary code on any server using superjson input, including a Blitz.js server, without prior authentication or knowledge. Attackers gain full control over the server so they could steal and manipulate data or attack further systems. The only requirement is that the server implements at least one endpoint which uses superjson during request processing. In the case of Blitz.js, it would be at least one RPC call.

### Patches

This has been patched in superjson 1.8.1 and Blitz.js 0.45.3.

If you are unable to upgrade to Blitz.js 0.45.3 in a timely manner, you can instead upgrade only superjson to version 1.8.1 using yarn resolutions are similar. Blitz versions < 0.45.3 are only affected because they used superjson versions < 1.8.1.

### Workarounds

None

### For more information

If you have any questions or comments about this advisory:

* Open an issue in <https://github.com/blitz-js/superjson>
* Email us at b@bayer.ws

### References

* <https://www.sonarsource.com/blog/blitzjs-prototype-pollution/>

### Severity

Critical

### CVE ID

CVE-2022-23631

### Weaknesses

[CWE-94](/advisories?query=cwe%3A94) [CWE-1321](/advisories?query=cwe%3A1321)

### Credits

* [![@paul-gerste-sonarsource](https://avatars.githubusercontent.com/u/79814126?s=40&v=4)](/paul-gerste-sonarsource)
  [paul-gerste-sonarsource](/paul-gerste-sonarsource)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d9d44ee9_20250114_212527.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5888-ffcr-r425)

**CVE-2022-23631**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5888-ffcr-r425)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-23631](/advisories/GHSA-5888-ffcr-r425)

## Prototype Pollution leading to Remote Code Execution in superjson

Critical severity

GitHub Reviewed

Published
Feb 9, 2022
in
[flightcontrolhq/superjson](/flightcontrolhq/superjson)
•
Updated Nov 1, 2023

[Vulnerability details](/advisories/GHSA-5888-ffcr-r425)
[Dependabot alerts
0](/advisories/GHSA-5888-ffcr-r425/dependabot)

## Package

npm

blitz
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 0.45.3

## Patched versions

0.45.3

npm

superjson
([npm](/advisories?query=ecosystem%3Anpm))

< 1.8.1

1.8.1

## Description

### Impact

This is critical vulnerability, as it allows to run arbitrary code on any server using superjson input, including a Blitz.js server, without prior authentication or knowledge. Attackers gain full control over the server so they could steal and manipulate data or attack further systems. The only requirement is that the server implements at least one endpoint which uses superjson during request processing. In the case of Blitz.js, it would be at least one RPC call.

### Patches

This has been patched in superjson 1.8.1 and Blitz.js 0.45.3.

If you are unable to upgrade to Blitz.js 0.45.3 in a timely manner, you can instead upgrade only superjson to version 1.8.1 using yarn resolutions are similar. Blitz versions < 0.45.3 are only affected because they used superjson versions < 1.8.1.

### Workarounds

None

### For more information

If you have any questions or comments about this advisory:

* Open an issue in <https://github.com/blitz-js/superjson>
* Email us at b@bayer.ws

### References

* <https://www.sonarsource.com/blog/blitzjs-prototype-pollution/>

### References

* [GHSA-5888-ffcr-r425](https://github.com/flightcontrolhq/superjson/security/advisories/GHSA-5888-ffcr-r425 "GHSA-5888-ffcr-r425")
* <https://nvd.nist.gov/vuln/detail/CVE-2022-23631>
* <https://www.sonarsource.com/blog/blitzjs-prototype-pollution/>
* [GHSA-5888-ffcr-r425](https://github.com/advisories/GHSA-5888-ffcr-r425 "GHSA-5888-ffcr-r425")

[![@flybayer](https://avatars.githubusercontent.com/u/8813276?s=40&v=4)](/flybayer)
[flybayer](/flybayer)
published to
[flightcontrolhq/superjson](/flightcontrolhq/superjson/security/advisories/GHSA-5888-ffcr-r425)
Feb 9, 2022

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-23631)
Feb 9, 2022

Published to the GitHub Advisory Database
Feb 9, 2022

Reviewed
Feb 9, 2022

Last updated
Nov 1, 2023

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.613%
 (79th percentile)

### Weaknesses

[CWE-94](/advisories?query=cwe%3A94) [CWE-1321](/advisories?query=cwe%3A1321)

### CVE ID

CVE-2022-23631

### GHSA ID

GHSA-5888-ffcr-r425

### Source code

[blitz-js/superjson](https://github.com/blitz-js/superjson)

### Credits

* [![@paul-gerste-sonarsource](https://avatars.githubusercontent.com/u/79814126?s=40&v=4)](/paul-gerste-sonarsource)
  [paul-gerste-sonarsource](/paul-gerste-sonarsource)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-5888-ffcr-r425/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.sonarsource.com_7b1472b1_20250114_212529.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Remote Code Execution via Prototype Pollution in Blitz.js

![](data:image/svg+xml;charset=utf-8...)![Paul Gerste photo]()![Paul Gerste photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e712603b-cf90-4c56-a666-cd2691b3def2/404b3fe2-4818-41dc-bbe0-9cae851eb542_Paul_Gerste.jpg?w=800&h=800&auto=format&fit=crop)

Paul Gerste

Vulnerability Researcher

July 12, 2022

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We recently discovered a Prototype Pollution vulnerability in Blitz.js leading to Remote Code Execution. Learn about this bug class and how to avoid it in your code!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49864ed0-3025-46f8-9dd0-26e0205e9592/cover-9400fc20-8a70-424a-b1ab-6fa8bff9b8cc_Blitz-JS_Vulnerability%25402x.png?w=2400&h=1256&auto=format&fit=crop)![We recently discovered a Prototype Pollution vulnerability in Blitz.js leading to Remote Code Execution. Learn about this bug class and how to avoid it in your code!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49864ed0-3025-46f8-9dd0-26e0205e9592/cover-9400fc20-8a70-424a-b1ab-6fa8bff9b8cc_Blitz-JS_Vulnerability%25402x.png?w=2400&h=1256&auto=format&fit=crop)

Third-party dependencies are an easy way for developers to add functionality to their applications. This is great for productivity, but it also adds more attack surface and potential for bugs. While relying on battle-proven libraries is better than re-inventing the wheel, it is also important to check this hidden part of your code base for security vulnerabilities.

As part of our commitment to helping secure the open-source world, we decided to take a look at Blitz.js, an upcoming full-stack React framework. It is based on Next.js and includes features such as authentication, an API layer, and code generation out of the box. Promising to be a batteries-included software stack, it gained 11,000 stars on GitHub.

We identified a critical vulnerability in Blitz.js that allowed attackers to take over most instances. In this article, we first give an introduction to a bug class named Prototype Pollution. Then we describe the technical details of the vulnerability we discovered, its impact, and how you can prevent it in your code.

## Impact

We discovered a Prototype Pollution vulnerability (CVE-2022-23631) in the serialization library `superjson` used in the RPC layer of Blitz.js. It leads to Remote Code Execution on the server, and unauthenticated attackers can exploit it over the internet. A Blitz.js-based application is vulnerable if it implements at least one RPC call.

The issue has been fixed in `superjson` 1.8.1 and Blitz.js 0.45.3, so we recommend updating your dependencies to these versions or higher.

## Technical Details

In this section, we will first explain how prototypes work in JavaScript and what Prototype Pollution is. Then will show a real-world example of this in Blitz.js. Finally, we will give recommendations on how to avoid Prototype Pollution vulnerabilities in your JavaScript code.

### What is Prototype Pollution?

In JavaScript, classes are implemented using so-called *prototypes*. Any object's prototype is accessible via the `__proto__` property, e.g. the following is true: `"abc".__proto__ === String.prototype`. An object inherits all properties from its prototype, which is why `"abc".substring(1)` works: the string inherits the substring function from its prototype, `String.prototype`.

Prototypes are regular objects, which means that they can be modified. Adding a property to a prototype will cause all existing objects of that type to also have this property:

```
const obj1 = {};
obj1.__proto__.x = 1;
console.log(obj1.x === 1); // true
const obj2 = {};
console.log(obj2.x === 1); // true
```

When the JavaScript interpreter encounters the expression `obj.x` it first looks for `x` in `obj` itself, then in `obj.__proto__`, then in `obj.__proto__.__proto__`, and so on. It uses the first one it finds and throws an error if it can't find `x` in any of `obj`'s prototypes. As this demonstrates, prototypes can be chained, just like classes can have multiple levels of ancestors. [This MDN article](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain#prototype_and_object.getprototypeof "This MDN article") explains JavaScript's inheritance in more detail if you are interested.

Prototype Pollution occurs when attackers can gain control over properties of a prototype. A vulnerable code pattern where this can happen is, for instance, `obj[a][b] = c`: if the attacker controls the values of `a`, `b` and `c`, they can set "`__proto__`" for `a`, the property name for `b`, and the property value for `c`. This will cause all objects to have a new property, which can significantly influence the target application.

A common pattern in JavaScript code is to use plain objects to pass optional arguments to a function. In the following example, the function `doTask` receives an object that can contain several optional arguments:

```
function doTask(name, options) {
    if (options.delay) {
        // handle delay
    }
    if (options.priority) {
        // handle priority
    }

    // do the task
}

doTask('dQw4w9WgXcQ', {
    delay: 100,
});
```

Setting a new property on the *Object* prototype would result in all these argument objects having that new property, changing the program's behavior. In the example above, it would be possible to set a new `priority` property on the *Object* prototype, causing all tasks to be processed with that priority.

### Prototype Pollution in superjson (CVE-2022-23631)

One of the features of Blitz.js is its easy integration of RPC calls. It implements a so-called *Zero-API* layer, meaning that a piece of business logic can simply be implemented as a function, and a client can call this function without needing to write API code. When the call is made on the client, Blitz.js will transparently make an RPC call to the server, wait for the response and then return it as the result of the function call.

For the deserialization of RPC call arguments, Blitz.js has implemented its own extended version of JSON called `superjson`. It adds support for more data types, such as dates and regexes, and allows circular dependencies. The latter is implemented by reading a list of assignment operations from a special metadata property and then applying these operations to the data. Let's take the following JSON as an example:

```
{
  "json": {
    "brands": [
      { "name": "Sonar" }
    ],
    "products": [
      { "name": "SonarQube",  "brand": null }
    ]
  },
  "meta": {
    "referentialEqualities": {
      "brands.0": ["products.0.brand"]
    }
  }
}
```

The `referentialEqualities` mapping tells superjson to do the following assignment on the value of `json`:

```
products[0].brand = brands[0];
```

These assignment operations work with any path within the data. Since the path of the assignment's destination can contain any property names, this introduces a Prototype Pollution vulnerability. An attacker could use the path `__proto__.x` to set the `x` property on `Object.prototype` to any value from the data they also control.

### Prototype Pollution to RCE

To exploit the Prototype Pollution, an attacker needs to find gadgets that lead to arbitrary code execution or other interesting behavior. We will now look at the three gadgets that make up the final exploit.

**Gadget 1: From zero to require()**

Since Blitz.js is based on Next.js, it uses the same routing mechanism. At build time, a *pages manifest* is created that contains a mapping between HTTP and filesystem paths.

When a request arrives, the server will check if the mapping contains an entry that matches the request's path. If there is an entry, it will use its filesystem path and load the JavaScript file it references. That file contains the code that renders the page on that path. The following is an example `pages-manifest.json`:

```
{
  "/api/rpc/signup": "pages/api/rpc/signup.js",
  "/forgot-password": "pages/forgot-password.html"
}
```

The file is loaded using the `require()` function of Node.js, and the file path is not checked to be within a certain directory. The manifest is loaded from a JSON file, meaning that the resulting object inherits from `Object.prototype`. This makes the page routing functionality a Prototype Pollution gadget that allows executing any local JavaScript file by inserting a new mapping into the manifest.

**Gadget 2: From require() to spawn()**

To turn this into arbitrary code execution, an attacker either needs the ability to create files on the server or another gadget to chain with the first one. Since Blitz.js does not have any upload functionality by default, we need to look for existing files with interesting behavior.

The file has to be present in every Blitz.js instance, so looking at Blitz.js itself and its dependencies makes the most sense. One interesting file is the Blitz.js CLI wrapper script. It will spawn the actual CLI script in a new process and exit. However, the command is fixed, and the arguments are not controllable, so how can attackers use this?

**Gadget 3: From spawn() to arbitrary code execution**

Spawning a new process is a known Prototype Pollution gadget that was made popular by Michał Bentkowski when he used it to [exploit Kibana](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/ "exploit Kibana").

Indeed, the `spawn()` function receives optional arguments via an object: This can be used to set the environment variables for the child process with the env property. This can be used to set `NODE_OPTIONS` to set more command-line arguments for the node process. Some arguments are not allowed, such as `--eval`, but `--require` can be used to include any file. This seems to be the same primitive as the very first gadget allows, but there is a difference. Since a new process is spawned, there are some new files on the file system. The file `/proc/self/environ` contains the current process's environment variables which are already attacker-controlled through the `env` option.

The regular way of abusing this is to insert a new environment variable *before* the `NODE_OPTIONS` one that contains JavaScript code and has a trailing comment to avoid syntax errors. However, Node.js seems to handle the `NODE_OPTIONS` differently now, putting it always first in the `environ` file.

**Improving gadget 3**

To bypass this, attackers can use two more options of the `spawn()` function: `argv0` and `shell`. The first one, `argv0`, controls the first element in the list of arguments passed to the new process. Usually, this is equivalent to the binary that is executed. The whole list of arguments is reflected in the file `/proc/self/cmdline` so the first element will be at the beginning. If the attacker changes the value of `NODE_OPTIONS` to `--require /proc/self/cmdline` and puts their payload in `argv0`, this should work, right?

Almost, but there is one final hurdle. Because the first argument was changed, the process can not be spawned because it is not a valid command or file path. This can be bypassed with the `shell` option of the `spawn()` function. It can be set to the path of a binary that will then be used to spawn the command within a shell. On Linux, the shell is prepended to the command and its arguments like this: `/bin/myshell -c "command arg1 arg2 arg3"`

To set `shell` to the path of the node executable, the attacker can use `/proc/self/exe` without knowing the actual path. The final result is that a node process will be spawned as follows:

```
execve("/proc/self/exe", ["console.log('pwned!');//", "-c", "node …"], { NODE_OPTIONS: "--require /proc/self/cmdline" })
```

**Chaining them together**

The final exploit works like this:

1. The attacker sends a request that abuses the Prototype Pollution issue in the RPC layer to add properties to the Object prototype.
2. This creates a new entry pointing to the Blitz.js CLI wrapper script in the pages manifest. It also sets `argv0`, `env`, and `shell` for the `spawn()` call in step 3.
3. The attacker triggers the chain by sending a request to the URL of the newly created pages manifest entry. This causes the CLI wrapper script to be executed, spawning a new process with the attacker-controlled `argv0`, `env`, and `shell` options. This finally executes the attacker's payload in a new process.

![](data:image/svg+xml;charset=utf-8...)![The final exploit chain]()![The final exploit chain](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/d4f473ec-00fa-447a-8c3b-09ea28caed49/body-cbf57e86-df17-409f-aedd-64adae813684_Blitz.js%2BExploit.drawio%2B%25281%2529.png?w=953&h=552&auto=format&fit=crop)
## Patch

To fix the root cause of this issue, Blitz.js blocked some property names from being used in a path, namely `__proto__`, `constructor`, and `prototype`. Without these properties, it is not possible to reach and poison a prototype object. This can be generalized to a JavaScript security rule of thumb: when using untrusted inputs to access or modify the properties of an object, always make sure that these three property names are blocked.

Another option is to use `Object.create(null)` instead of a plain object literal (`{}`) where possible. The returned object does not inherit from `Object.prototype`, so it is also not possible to reach that prototype, regardless of any untrusted property names being used for access:

```
const obj = Object.create(null);
Object.prototype.x = 1;
console.log(obj.x === 1); // false
console.log(obj.__proto__); // undefined
```

If you want to harden your code base and make the exploitation of Prototype Pollution issues more difficult, there are some ways to do so, but they each come with their drawbacks. The first measure is to make `Object.prototype` immutable by calling `Object.freeze(Object.prototype)` as early as possible. The disadvantages are that you would have to repeat that for every class and that some older libraries would break because they modify prototypes.

The second measure only applies to Node.js, not JavaScript running in a browser. If you start the Node.js process with the `--disable-proto=delete flag`, then the `__proto__` property will not exist anymore, and the only way to set an object's prototype is via functions such as `Reflect.setPrototypeOf()`. As with the previous measure, libraries could break because of this. Also, it is still possible to reach an object's prototype via `obj.constructor.prototype`, so these property names should still be blocked when validating user-controlled property names.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2022-02-07 | We report the issue to the Blitz.js maintainers |
| 2022-02-07 | The maintainers confirm the issue |
| 2022-02-10 | A patch is released with superjson 1.8.1 and Blitz.js 0.45.3 |

## Summary

In this publication, we covered the technical details behind a Prototype Pollution vulnerability in Blitz.js; a full-stack React framework. Attackers can use the vulnerability to execute code on servers that run applications based on vulnerable versions of Blitz.js. We also presented ways to prevent such issues in your JavaScript code.

If you are using Blitz.js or superjson in your application, we strongly recommend updating to the fixed versions mentioned above. Finally, we want to thank the maintainers of Blitz.js and superjson for their fast replies and patches.

## Related Blog Posts

* [https://blog.sonarsource.com/nodebb-remote-code-execution-with-one-shot/](https://blog.sonarsource.com/nodebb-remote-code-execution-with-one-shot/ "https://blog.sonarsource.com/nodebb-remote-code-execution-with-one-shot/")
* [https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/](https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/ "https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/")
* [https://blog.sonarsource.com/path-traversal-vulnerabilities-in-icinga-web/](https://blog.sonarsource.com/path-traversal-vulnerabilities-in-icinga-web/ "https://blog.sonarsource.com/path-traversal-vulnerabilities-in-icinga-web/")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


