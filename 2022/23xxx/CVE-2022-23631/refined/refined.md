```json
{
  "vulnerability": {
    "root_cause": "The `superjson` library, used by Blitz.js for deserializing RPC call arguments, allows prototype pollution due to the way it handles referential equalities. It uses a mapping of assignment operations to apply to the data. The path of the assignment destination can contain any property names, including `__proto__`, allowing an attacker to modify the prototype of objects.",
    "weaknesses": [
      "Prototype Pollution (CWE-1321)",
      "Improper Control of Generation of Code ('Code Injection') (CWE-94)"
    ],
    "impact": "Remote Code Execution (RCE). An attacker can gain full control over the server, enabling them to steal or manipulate data, or attack other systems.",
    "attack_vectors": "The vulnerability can be exploited by sending a crafted request to a server that uses `superjson` during request processing (e.g. Blitz.js RPC call). The crafted request includes malicious payload in the form of manipulated `referentialEqualities` mapping within the metadata, leading to prototype pollution.",
      "required_attacker_capabilities": "The attacker needs to send a specially crafted request to an endpoint that utilizes superjson. No prior authentication is required."
  },
    "additional_details": {
    "exploit_chain": "The exploit involves a chain of three gadgets:\n\n1.  **Prototype Pollution to Pages Manifest Manipulation:** By exploiting the prototype pollution vulnerability in superjson, the attacker can inject a new route into the pages manifest (pages-manifest.json), mapping a specific HTTP path to a local javascript file (e.g., Blitz.js CLI wrapper script).\n\n2.  **Pages Manifest to Node.js require():** Accessing the newly created route will trigger the loading of the specified local javascript file using `require()` of Node.js.\n\n3.  **Node.js require() to Remote Code Execution:**  The Blitz.js CLI wrapper script has a vulnerability in how it spawns a new process using `spawn()` function. By controlling the environment variables via the `env` property, and also `argv0` and `shell` parameters, an attacker can achieve arbitrary code execution. The `NODE_OPTIONS` is used to include a file, and by using `/proc/self/cmdline`, the attacker injects the payload via `argv0`."
  }
}
```