Based on the provided information, here's an analysis of CVE-2022-23520:

**Root Cause of Vulnerability:**
- The vulnerability is due to an incomplete fix for a previous vulnerability, CVE-2022-32209, in the `Rails::Html::Sanitizer`. This incomplete fix allows for a cross-site scripting (XSS) vulnerability under certain configurations.

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Scripting (XSS):** The core vulnerability is that, in specific configurations, the sanitization logic of `Rails::Html::Sanitizer` is insufficient, allowing malicious HTML/JavaScript code to be injected into web pages. This occurs when the application developer overrides the sanitizer's allowed tags.

**Impact of Exploitation:**
- An attacker can inject malicious content into web pages viewed by other users. This content can be in the form of JavaScript code that can be used to steal user session information, redirect users to malicious websites, or deface web pages, leading to a loss of confidentiality, integrity, and potentially availability.

**Attack Vectors:**
- The attacker injects malicious HTML/JavaScript code into a field that is then processed by the Rails HTML sanitizer.
- This injection only succeeds if the application has overridden the default allowed tags of the sanitizer to include both "select" and "style" elements.

**Required Attacker Capabilities/Position:**
- The attacker must be able to input data that is then processed by the vulnerable `Rails::Html::Sanitizer`.
- The attacker does not need to be in any privileged position; they simply need to be able to interact with the application.
- The vulnerability only exists if a specific configuration has been set in the web application, which involves overriding the sanitizer's allowed tags to include both "select" and "style" tags.

**Additional Details:**
- The vulnerability was reported by Dominic Breuker.
- The fix is included in version 1.4.4 of the `rails-html-sanitizer` gem.
- The vulnerability is classified as moderate severity.
- The issue is related to CWE-79, Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').
- The vulnerability is present in all versions of the gem before the patched version (1.4.4)