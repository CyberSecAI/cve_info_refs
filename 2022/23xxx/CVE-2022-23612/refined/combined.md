=== Content from github.com_c2c964b2_20250114_220543.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fblob%2Fee3373a7a775bfdfa263e2e912c72e64342fb4f0%2Fweb%2Fsrc%2Fmain%2Fjava%2Forg%2Fopenmrs%2Fweb%2Ffilter%2FStartupFilter.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fblob%2Fee3373a7a775bfdfa263e2e912c72e64342fb4f0%2Fweb%2Fsrc%2Fmain%2Fjava%2Forg%2Fopenmrs%2Fweb%2Ffilter%2FStartupFilter.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openmrs%2Fopenmrs-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openmrs](/openmrs)
/
**[openmrs-core](/openmrs/openmrs-core)**
Public

* [Notifications](/login?return_to=%2Fopenmrs%2Fopenmrs-core) You must be signed in to change notification settings
* [Fork
  3.7k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)
* [Star
   1.4k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)

* [Code](/openmrs/openmrs-core)
* [Pull requests
  40](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

Additional navigation options

* [Code](/openmrs/openmrs-core)
* [Pull requests](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

## Files

 ee3373a
## Breadcrumbs

1. [openmrs-core](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0)
2. /[web](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web)
3. /[src](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src)
4. /[main](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main)
5. /[java](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java)
6. /[org](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org)
7. /[openmrs](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs)
8. /[web](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web)
9. /[filter](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter)
/
# StartupFilter.java

Copy path Blame  Blame
## Latest commit

## History

[History](/openmrs/openmrs-core/commits/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter/StartupFilter.java)415 lines (374 loc) · 15.2 KB ee3373a
## Breadcrumbs

1. [openmrs-core](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0)
2. /[web](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web)
3. /[src](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src)
4. /[main](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main)
5. /[java](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java)
6. /[org](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org)
7. /[openmrs](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs)
8. /[web](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web)
9. /[filter](/openmrs/openmrs-core/tree/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter)
/
# StartupFilter.java

Top
## File metadata and controls

* Code
* Blame

415 lines (374 loc) · 15.2 KB[Raw](https://github.com/openmrs/openmrs-core/raw/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter/StartupFilter.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415/\*\* \* This Source Code Form is subject to the terms of the Mozilla Public License, \* v. 2.0. If a copy of the MPL was not distributed with this file, You can \* obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under \* the terms of the Healthcare Disclaimer located at http://openmrs.org/license. \* \* Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS \* graphic logo is a trademark of OpenMRS Inc. \*/package org.openmrs.web.filter;
import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.lang.annotation.Annotation;import java.lang.reflect.Field;import java.nio.charset.StandardCharsets;import java.util.Collections;import java.util.HashMap;import java.util.List;import java.util.Locale;import java.util.Map;import java.util.Properties;
import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletContext;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;
import org.apache.commons.lang3.ArrayUtils;import org.apache.velocity.VelocityContext;import org.apache.velocity.app.VelocityEngine;import org.apache.velocity.runtime.RuntimeConstants;import org.apache.velocity.runtime.log.CommonsLogLogChute;import org.apache.velocity.tools.Scope;import org.apache.velocity.tools.ToolContext;import org.apache.velocity.tools.ToolManager;import org.apache.velocity.tools.config.DefaultKey;import org.apache.velocity.tools.config.FactoryConfiguration;import org.apache.velocity.tools.config.ToolConfiguration;import org.apache.velocity.tools.config.ToolboxConfiguration;import org.codehaus.jackson.map.ObjectMapper;import org.openmrs.OpenmrsCharacterEscapes;import org.openmrs.api.APIException;import org.openmrs.api.context.Context;import org.openmrs.util.\*;import org.openmrs.web.WebConstants;import org.openmrs.web.filter.initialization.InitializationFilter;import org.openmrs.web.filter.update.UpdateFilter;import org.openmrs.web.filter.util.FilterUtil;import org.openmrs.web.filter.util.LocalizationTool;import org.slf4j.Logger;import org.slf4j.LoggerFactory;
/\*\* \* Abstract class used when a small wizard is needed before Spring, jsp, etc has been started up. \* \* @see UpdateFilter \* @see InitializationFilter \*/public abstract class StartupFilter implements Filter {  private static final Logger log = LoggerFactory.getLogger(StartupFilter.class);  protected static VelocityEngine velocityEngine = null;  public static final String AUTO\_RUN\_OPENMRS = "auto\_run\_openmrs";  /\*\* \* Set by the {@link #init(FilterConfig)} method so that we have access to the current \* {@link ServletContext} \*/ protected FilterConfig filterConfig = null;  /\*\* \* Records errors that will be displayed to the user \*/ protected Map<String, Object[]> errors = new HashMap<>();  /\*\* \* Messages that will be displayed to the user \*/ protected Map<String, Object[]> msgs = new HashMap<>();  /\*\* \* Used for configuring tools within velocity toolbox \*/ private ToolContext toolContext = null;  /\*\* \* The web.xml file sets this {@link StartupFilter} to be the first filter for all requests. \* \* @see javax.servlet.Filter#doFilter(javax.servlet.ServletRequest, javax.servlet.ServletResponse, \* javax.servlet.FilterChain) \*/ @Override public final void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { if (skipFilter((HttpServletRequest) request)) { chain.doFilter(request, response); } else {  HttpServletRequest httpRequest = (HttpServletRequest) request; HttpServletResponse httpResponse = (HttpServletResponse) response;  String servletPath = httpRequest.getServletPath(); // for all /images and /initfilter/scripts files, write the path // (the "/initfilter" part is needed so that the openmrs\_static\_context-servlet.xml file doesn't // get instantiated early, before the locale messages are all set up) if (servletPath.startsWith("/images") || servletPath.startsWith("/initfilter/scripts")) { servletPath = servletPath.replaceFirst("/initfilter", "/WEB-INF/view"); // strip out the /initfilter part // writes the actual image file path to the response File file = new File(filterConfig.getServletContext().getRealPath(servletPath)); if (httpRequest.getPathInfo() != null) { file = new File(file, httpRequest.getPathInfo()); }  InputStream imageFileInputStream = null; try { imageFileInputStream = new FileInputStream(file); OpenmrsUtil.copyFile(imageFileInputStream, httpResponse.getOutputStream()); } catch (FileNotFoundException e) { log.error("Unable to find file: " + file.getAbsolutePath()); } finally { if (imageFileInputStream != null) { try { imageFileInputStream.close(); } catch (IOException io) { log.warn("Couldn't close imageFileInputStream: " + io); } } } } else if (servletPath.startsWith("/scripts")) { log.error( "Calling /scripts during the initializationfilter pages will cause the openmrs\_static\_context-servlet.xml to initialize too early and cause errors after startup. Use '/initfilter" + servletPath + "' instead."); } // for anything but /initialsetup else if (!httpRequest.getServletPath().equals("/" + WebConstants.SETUP\_PAGE\_URL) && !httpRequest.getServletPath().equals("/" + AUTO\_RUN\_OPENMRS)) { // send the user to the setup page httpResponse.sendRedirect("/" + WebConstants.WEBAPP\_NAME + "/" + WebConstants.SETUP\_PAGE\_URL); } else {  if ("GET".equals(httpRequest.getMethod())) { doGet(httpRequest, httpResponse); } else if ("POST".equals(httpRequest.getMethod())) { // only clear errors before POSTS so that redirects can show errors too. errors.clear(); msgs.clear(); doPost(httpRequest, httpResponse); } } // Don't continue down the filter chain otherwise Spring complains // that it hasn't been set up yet. // The jsp and servlet filter are also on this chain, so writing to // the response directly here is the only option } }  /\*\* \* Convenience method to set up the velocity context properly \*/ private void initializeVelocity() { if (velocityEngine == null) { velocityEngine = new VelocityEngine();  Properties props = new Properties(); props.setProperty(RuntimeConstants.RUNTIME\_LOG, "startup\_wizard\_vel.log"); // Linux requires setting logging properties to initialize Velocity Context. props.setProperty(RuntimeConstants.RUNTIME\_LOG\_LOGSYSTEM\_CLASS, "org.apache.velocity.runtime.log.CommonsLogLogChute"); props.setProperty(CommonsLogLogChute.LOGCHUTE\_COMMONS\_LOG\_NAME, "initial\_wizard\_velocity");  // so the vm pages can import the header/footer props.setProperty(RuntimeConstants.RESOURCE\_LOADER, "class"); props.setProperty("class.resource.loader.description", "Velocity Classpath Resource Loader"); props.setProperty("class.resource.loader.class", "org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader");  try { velocityEngine.init(props); } catch (Exception e) { log.error("velocity init failed, because: " + e); } } }  /\*\* \* Called by {@link #doFilter(ServletRequest, ServletResponse, FilterChain)} on GET requests \* \* @param httpRequest \* @param httpResponse \*/ protected abstract void doGet(HttpServletRequest httpRequest, HttpServletResponse httpResponse) throws IOException, ServletException;  /\*\* \* Called by {@link #doFilter(ServletRequest, ServletResponse, FilterChain)} on POST requests \* \* @param httpRequest \* @param httpResponse \*/ protected abstract void doPost(HttpServletRequest httpRequest, HttpServletResponse httpResponse) throws IOException, ServletException;  /\*\* \* All private attributes on this class are returned to the template via the velocity context and \* reflection \* \* @param templateName the name of the velocity file to render. This name is prepended with \* {@link #getTemplatePrefix()} \* @param referenceMap \* @param httpResponse \*/ protected void renderTemplate(String templateName, Map<String, Object> referenceMap, HttpServletResponse httpResponse) throws IOException { // first we should get velocity tools context for current client request (within // his http session) and merge that tools context with basic velocity context if (referenceMap == null) { return; }  Object locale = referenceMap.get(FilterUtil.LOCALE\_ATTRIBUTE); ToolContext velocityToolContext = getToolContext( locale != null ? locale.toString() : Context.getLocale().toString()); VelocityContext velocityContext = new VelocityContext(velocityToolContext);  for (Map.Entry<String, Object> entry : referenceMap.entrySet()) { velocityContext.put(entry.getKey(), entry.getValue()); }  Object model = getUpdateFilterModel();  // put each of the private varibles into the template for convenience for (Field field : model.getClass().getDeclaredFields()) { try { field.setAccessible(true); velocityContext.put(field.getName(), field.get(model)); } catch (IllegalArgumentException | IllegalAccessException e) { log.error("Error generated while getting field value: " + field.getName(), e); } }  String fullTemplatePath = getTemplatePrefix() + templateName; InputStream templateInputStream = getClass().getClassLoader().getResourceAsStream(fullTemplatePath); if (templateInputStream == null) { throw new IOException("Unable to find " + fullTemplatePath); }  velocityContext.put("errors", errors); velocityContext.put("msgs", msgs);  // explicitly set the content type for the response because some servlet containers are assuming text/plain httpResponse.setContentType("text/html");  try { velocityEngine.evaluate(velocityContext, httpResponse.getWriter(), this.getClass().getName(), new InputStreamReader(templateInputStream, StandardCharsets.UTF\_8)); } catch (Exception e) { throw new APIException("Unable to process template: " + fullTemplatePath, e); } }  /\*\* \* @see javax.servlet.Filter#init(javax.servlet.FilterConfig) \*/ @Override public void init(FilterConfig filterConfig) throws ServletException { this.filterConfig = filterConfig; initializeVelocity(); }  /\*\* \* @see javax.servlet.Filter#destroy() \*/ @Override public void destroy() { }  /\*\* \* This string is prepended to all templateNames passed to \* {@link #renderTemplate(String, Map, HttpServletResponse)} \* \* @return string to prepend as the path for the templates \*/ protected String getTemplatePrefix() { return "org/openmrs/web/filter/"; }  /\*\* \* The model that is used as the backer for all pages in this startup wizard. Should never return \* null. \* \* @return the stored formbacking/model object \*/ protected abstract Object getUpdateFilterModel();  /\*\* \* If this returns true, this filter fails early and quickly. All logic is skipped and startup and \* usage continue normally. \* \* @return true if this filter can be skipped \*/ public abstract boolean skipFilter(HttpServletRequest request);
 /\*\* \* Convenience method to read the last 5 log lines from the MemoryAppender \*  \* The log lines will be added to the "logLines" key \*  \* @param result A map to be returned as a JSON document \*/ protected void addLogLinesToResponse(Map<String, Object> result) { MemoryAppender appender = OpenmrsUtil.getMemoryAppender(); if (appender != null) { List<String> logLines = appender.getLogLines();  // truncate the list to the last five so we don't overwhelm jquery if (logLines.size() > 5) { logLines = logLines.subList(logLines.size() - 5, logLines.size()); }  result.put("logLines", logLines); } else { result.put("logLines", Collections.emptyList()); } }  /\*\* \* Convenience method to convert the given object to a JSON string. Supports Maps, Lists, Strings, \* Boolean, Double \* \* @param object object to convert to json \* @return JSON string to be eval'd in javascript \*/ protected String toJSONString(Object object) { ObjectMapper mapper = new ObjectMapper(); mapper.getJsonFactory().setCharacterEscapes(new OpenmrsCharacterEscapes()); try { return mapper.writeValueAsString(object); } catch (IOException e) { log.error("Failed to convert object to JSON"); throw new APIException(e); } }  /\*\* \* Gets tool context for specified locale parameter. If context does not exists, it creates new \* context, configured for that locale. Otherwise, it changes locale property of \* {@link LocalizationTool} object, that is being contained in tools context \* \* @param locale the string with locale parameter for configuring tools context \* @return the tool context object \*/ public ToolContext getToolContext(String locale) { Locale systemLocale = LocaleUtility.fromSpecification(locale); //Defaults to en if systemLocale is null or invalid e.g en\_GBs if (systemLocale == null || !ArrayUtils.contains(Locale.getAvailableLocales(), systemLocale)) { systemLocale = Locale.ENGLISH; } // If tool context has not been configured yet if (toolContext == null) { // first we are creating manager for tools, factory for configuring tools  // and empty configuration object for velocity tool box ToolManager velocityToolManager = new ToolManager(); FactoryConfiguration factoryConfig = new FactoryConfiguration(); // since we are using one tool box for all request within wizard // we should propagate toolbox's scope on all application  ToolboxConfiguration toolbox = new ToolboxConfiguration(); toolbox.setScope(Scope.APPLICATION); // next we are directly configuring custom localization tool by // setting its class name, locale property etc. ToolConfiguration localizationTool = new ToolConfiguration(); localizationTool.setClassname(LocalizationTool.class.getName()); localizationTool.setProperty(ToolContext.LOCALE\_KEY, systemLocale); localizationTool.setProperty(LocalizationTool.BUNDLES\_KEY, "messages"); // and finally we are adding just configured tool into toolbox // and creating tool context for this toolbox toolbox.addTool(localizationTool); factoryConfig.addToolbox(toolbox); velocityToolManager.configure(factoryConfig); toolContext = velocityToolManager.createContext(); toolContext.setUserCanOverwriteTools(true); } else { // if it already has been configured, we just pull out our custom localization tool  // from tool context, then changing its locale property and putting this tool back to the context // First, we need to obtain the value of default key annotation of our localization tool // class using reflection Annotation annotation = LocalizationTool.class.getAnnotation(DefaultKey.class); DefaultKey defaultKeyAnnotation = (DefaultKey) annotation; String key = defaultKeyAnnotation.value(); // LocalizationTool localizationTool = (LocalizationTool) toolContext.get(key); localizationTool.setLocale(systemLocale); toolContext.put(key, localizationTool); } return toolContext; }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lgtm.com_604c96e2_20250114_220550.html ===

[Skip to content](#start-of-content)
[Skip to sidebar](#sidebar)

/
[Blog](https://github.blog/)

* [Changelog](https://github.blog/changelog/)
* [Docs](https://docs.github.com/)
* [Customer stories](https://github.com/customer-stories)

[Use Copilot for free](https://github.com/features/copilot?utm_source=topnav&utm_medium=blog&utm_campaign=copilotfree)
[Contact sales](https://github.com/enterprise/contact?ref_cta=contact20sales&ref_loc=banner&ref_page=blog)

* [AI & ML](https://github.blog/ai-and-ml/)
  + [AI & ML](https://github.blog/ai-and-ml/)

    Learn about artificial intelligence and machine learning across the GitHub ecosystem and the wider industry.

    - [Generative AI](https://github.blog/ai-and-ml/generative-ai/)

      Learn how to build with generative AI.
    - [GitHub Copilot](https://github.blog/ai-and-ml/github-copilot/)

      Change how you work with GitHub Copilot.
    - [LLMs](https://github.blog/ai-and-ml/llms/)

      Everything developers need to know about LLMs.
    - [Machine learning](https://github.blog/ai-and-ml/machine-learning/)

      Machine learning tips, tricks, and best practices.
  + ![](https://github.blog/wp-content/uploads/2024/06/AI-DarkMode-4.png?resize=800%2C425)[How AI code generation works](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)

    Explore the capabilities and benefits of AI code generation and how it can improve your developer experience.

    Learn more
* [Developer skills](https://github.blog/developer-skills/)
  + [Developer skills](https://github.blog/developer-skills/)

    Resources for developers to grow in their skills and careers.

    - [Application development](https://github.blog/developer-skills/application-development/)

      Insights and best practices for building apps.
    - [Career growth](https://github.blog/developer-skills/career-growth/)

      Tips & tricks to grow as a professional developer.
    - [GitHub](https://github.blog/developer-skills/github/)

      Improve how you use GitHub at work.
    - [GitHub Education](https://github.blog/developer-skills/github-education/)

      Learn how to move into your first professional role.
    - [Programming languages & frameworks](https://github.blog/developer-skills/programming-languages-and-frameworks/)

      Stay current on what’s new (or new again).
  + ![](https://github.blog/wp-content/uploads/2024/05/Enterprise-DarkMode-3.png?resize=800%2C425)[Get started with GitHub documentation](https://docs.github.com/en/get-started)

    Learn how to start building, shipping, and maintaining software with GitHub.

    Learn more
* [Engineering](https://github.blog/engineering/)
  + [Engineering](https://github.blog/engineering/)

    Get an inside look at how we’re building the home for all developers.

    - [Architecture & optimization](https://github.blog/engineering/architecture-optimization/)

      Discover how we deliver a performant and highly available experience across the GitHub platform.
    - [Engineering principles](https://github.blog/engineering/engineering-principles/)

      Explore best practices for building software at scale with a majority remote team.
    - [Infrastructure](https://github.blog/engineering/infrastructure/)

      Get a glimpse at the technology underlying the world’s leading AI-powered developer platform.
    - [Platform security](https://github.blog/engineering/platform-security/)

      Learn how we build security into everything we do across the developer lifecycle.
    - [User experience](https://github.blog/engineering/user-experience/)

      Find out what goes into making GitHub the home for all developers.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.42.45 AM.png?resize=800%2C425)[How we use GitHub to be more productive, collaborative, and secure](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)

    Our engineering and security teams do some incredible work. Let’s take a look at how we use GitHub to be more productive, build collaboratively, and shift security left.

    Learn more
* [Enterprise software](https://github.blog/enterprise-software/)
  + [Enterprise software](https://github.blog/enterprise-software/)

    Explore how to write, build, and deploy enterprise software at scale.

    - [Automation](https://github.blog/enterprise-software/automation/)

      Automating your way to faster and more secure ships.
    - [CI/CD](https://github.blog/enterprise-software/ci-cd/)

      Guides on continuous integration and delivery.
    - [Collaboration](https://github.blog/enterprise-software/collaboration/)

      Tips, tools, and tricks to improve developer collaboration.
    - [DevOps](https://github.blog/enterprise-software/devops/)

      DevOps resources for enterprise engineering teams.
    - [DevSecOps](https://github.blog/enterprise-software/devsecops/)

      How to integrate security into the SDLC.
    - [Governance & compliance](https://github.blog/enterprise-software/governance-and-compliance/)

      Ensuring your builds stay clean.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.43.47 AM.png?resize=800%2C425)[How enterprise engineering teams can successfully adopt AI](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)

    Learn how to bring AI to your engineering teams and maximize the value that you get from it.

    Learn more
* [News & insights](https://github.blog/news-insights/)
  + [News & insights](https://github.blog/news-insights/)

    Keep up with what’s new and notable from inside GitHub.

    - [Company news](https://github.blog/news-insights/company-news/)

      An inside look at news and product updates from GitHub.
    - [Product](https://github.blog/news-insights/product-news/)

      The latest on GitHub’s platform, products, and tools.
    - [Octoverse](https://github.blog/news-insights/octoverse/)

      Insights into the state of open source on GitHub.
    - [Policy](https://github.blog/news-insights/policy-news-and-insights/)

      The latest policy and regulatory changes in software.
    - [Research](https://github.blog/news-insights/research/)

      Data-driven insights around the developer ecosystem.
    - [The library](https://github.blog/news-insights/the-library/)

      Older news and updates from GitHub.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.44.23 AM.png?resize=800%2C425)[Unlocking the power of unstructured data with RAG](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)

    Learn how to use retrieval-augmented generation (RAG) to capture more insights.

    Learn more
* [Open Source](https://github.blog/open-source/)
  + [Open Source](https://github.blog/open-source/)

    Everything open source on GitHub.

    - [Git](https://github.blog/open-source/git/)

      The latest Git updates.
    - [Maintainers](https://github.blog/open-source/maintainers/)

      Spotlighting open source maintainers.
    - [Social impact](https://github.blog/open-source/social-impact/)

      How open source is driving positive change.
    - [Gaming](https://github.blog/open-source/gaming/)

      Explore open source games on GitHub.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.46.23 AM.png?resize=800%2C425)[An introduction to innersource](https://resources.github.com/software-development/innersource/)

    Organizations worldwide are incorporating open source methodologies into the way they build and ship their own software.

    Learn more
* [Security](https://github.blog/security/)
  + [Security](https://github.blog/security/)

    Stay up to date on everything security.

    - [Application security](https://github.blog/security/application-security/)

      Application security, explained.
    - [Supply chain security](https://github.blog/security/supply-chain-security/)

      Demystifying supply chain security.
    - [Vulnerability research](https://github.blog/security/vulnerability-research/)

      Updates from the GitHub Security Lab.
    - [Web application security](https://github.blog/security/web-application-security/)

      Helpful tips on securing web applications.
  + ![](https://github.blog/wp-content/uploads/2024/07/Screenshot-2024-07-23-at-8.47.04 AM.png?resize=800%2C425)[The enterprise guide to AI-powered DevSecOps](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

    Learn about core challenges in DevSecOps, and how you can start addressing them with AI and automation.

    Learn more

Search

## Categories

* [AI & ML](https://github.blog/ai-and-ml/)
  + Back[AI & ML](https://github.blog/ai-and-ml/)

    Learn about artificial intelligence and machine learning across the GitHub ecosystem and the wider industry.

    - [Generative AI](https://github.blog/ai-and-ml/generative-ai/)

      Learn how to build with generative AI.
    - [GitHub Copilot](https://github.blog/ai-and-ml/github-copilot/)

      Change how you work with GitHub Copilot.
    - [LLMs](https://github.blog/ai-and-ml/llms/)

      Everything developers need to know about LLMs.
    - [Machine learning](https://github.blog/ai-and-ml/machine-learning/)

      Machine learning tips, tricks, and best practices.
  + [How AI code generation works](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)

    Explore the capabilities and benefits of AI code generation and how it can improve your developer experience.

    [Learn more](https://github.blog/ai-and-ml/generative-ai/how-ai-code-generation-works/)
* [Developer skills](https://github.blog/developer-skills/)
  + Back[Developer skills](https://github.blog/developer-skills/)

    Resources for developers to grow in their skills and careers.

    - [Application development](https://github.blog/developer-skills/application-development/)

      Insights and best practices for building apps.
    - [Career growth](https://github.blog/developer-skills/career-growth/)

      Tips & tricks to grow as a professional developer.
    - [GitHub](https://github.blog/developer-skills/github/)

      Improve how you use GitHub at work.
    - [GitHub Education](https://github.blog/developer-skills/github-education/)

      Learn how to move into your first professional role.
    - [Programming languages & frameworks](https://github.blog/developer-skills/programming-languages-and-frameworks/)

      Stay current on what’s new (or new again).
  + [Get started with GitHub documentation](https://docs.github.com/en/get-started)

    Learn how to start building, shipping, and maintaining software with GitHub.

    [Learn more](https://docs.github.com/en/get-started)
* [Engineering](https://github.blog/engineering/)
  + Back[Engineering](https://github.blog/engineering/)

    Get an inside look at how we’re building the home for all developers.

    - [Architecture & optimization](https://github.blog/engineering/architecture-optimization/)

      Discover how we deliver a performant and highly available experience across the GitHub platform.
    - [Engineering principles](https://github.blog/engineering/engineering-principles/)

      Explore best practices for building software at scale with a majority remote team.
    - [Infrastructure](https://github.blog/engineering/infrastructure/)

      Get a glimpse at the technology underlying the world’s leading AI-powered developer platform.
    - [Platform security](https://github.blog/engineering/platform-security/)

      Learn how we build security into everything we do across the developer lifecycle.
    - [User experience](https://github.blog/engineering/user-experience/)

      Find out what goes into making GitHub the home for all developers.
  + [How we use GitHub to be more productive, collaborative, and secure](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)

    Our engineering and security teams do some incredible work. Let’s take a look at how we use GitHub to be more productive, build collaboratively, and shift security left.

    [Learn more](https://github.blog/engineering/how-we-use-github-to-be-more-productive-collaborative-and-secure/)
* [Enterprise software](https://github.blog/enterprise-software/)
  + Back[Enterprise software](https://github.blog/enterprise-software/)

    Explore how to write, build, and deploy enterprise software at scale.

    - [Automation](https://github.blog/enterprise-software/automation/)

      Automating your way to faster and more secure ships.
    - [CI/CD](https://github.blog/enterprise-software/ci-cd/)

      Guides on continuous integration and delivery.
    - [Collaboration](https://github.blog/enterprise-software/collaboration/)

      Tips, tools, and tricks to improve developer collaboration.
    - [DevOps](https://github.blog/enterprise-software/devops/)

      DevOps resources for enterprise engineering teams.
    - [DevSecOps](https://github.blog/enterprise-software/devsecops/)

      How to integrate security into the SDLC.
    - [Governance & compliance](https://github.blog/enterprise-software/governance-and-compliance/)

      Ensuring your builds stay clean.
  + [How enterprise engineering teams can successfully adopt AI](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)

    Learn how to bring AI to your engineering teams and maximize the value that you get from it.

    [Learn more](https://resources.github.com/artificial-intelligence/how-enterprise-engineering-teams-can-successfully-adopt-ai/)
* [News & insights](https://github.blog/news-insights/)
  + Back[News & insights](https://github.blog/news-insights/)

    Keep up with what’s new and notable from inside GitHub.

    - [Company news](https://github.blog/news-insights/company-news/)

      An inside look at news and product updates from GitHub.
    - [Product](https://github.blog/news-insights/product-news/)

      The latest on GitHub’s platform, products, and tools.
    - [Octoverse](https://github.blog/news-insights/octoverse/)

      Insights into the state of open source on GitHub.
    - [Policy](https://github.blog/news-insights/policy-news-and-insights/)

      The latest policy and regulatory changes in software.
    - [Research](https://github.blog/news-insights/research/)

      Data-driven insights around the developer ecosystem.
    - [The library](https://github.blog/news-insights/the-library/)

      Older news and updates from GitHub.
  + [Unlocking the power of unstructured data with RAG](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)

    Learn how to use retrieval-augmented generation (RAG) to capture more insights.

    [Learn more](https://github.blog/ai-and-ml/llms/unlocking-the-power-of-unstructured-data-with-rag/)
* [Open Source](https://github.blog/open-source/)
  + Back[Open Source](https://github.blog/open-source/)

    Everything open source on GitHub.

    - [Git](https://github.blog/open-source/git/)

      The latest Git updates.
    - [Maintainers](https://github.blog/open-source/maintainers/)

      Spotlighting open source maintainers.
    - [Social impact](https://github.blog/open-source/social-impact/)

      How open source is driving positive change.
    - [Gaming](https://github.blog/open-source/gaming/)

      Explore open source games on GitHub.
  + [An introduction to innersource](https://resources.github.com/software-development/innersource/)

    Organizations worldwide are incorporating open source methodologies into the way they build and ship their own software.

    [Learn more](https://resources.github.com/software-development/innersource/)
* [Security](https://github.blog/security/)
  + Back[Security](https://github.blog/security/)

    Stay up to date on everything security.

    - [Application security](https://github.blog/security/application-security/)

      Application security, explained.
    - [Supply chain security](https://github.blog/security/supply-chain-security/)

      Demystifying supply chain security.
    - [Vulnerability research](https://github.blog/security/vulnerability-research/)

      Updates from the GitHub Security Lab.
    - [Web application security](https://github.blog/security/web-application-security/)

      Helpful tips on securing web applications.
  + [The enterprise guide to AI-powered DevSecOps](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

    Learn about core challenges in DevSecOps, and how you can start addressing them with AI and automation.

    [Learn more](https://resources.github.com/security/the-enterprise-guide-to-ai-powered-devsecops/)

* [Changelog](https://github.blog/changelog/)
* [Docs](https://docs.github.com/)
* [Customer stories](https://github.com/customer-stories)

[Contact sales](https://github.com/enterprise/contact?ref_cta=contact20sales&ref_loc=banner&ref_page=blog)
[Use Copilot for free](https://github.com/features/copilot?utm_source=topnav&utm_medium=blog&utm_campaign=copilotfree)

[Home](https://github.blog/) / [News & insights](https://github.blog/news-insights/) / [Product](https://github.blog/news-insights/product-news/)
# The next step for LGTM.com: GitHub code scanning!

Today, GitHub code scanning has all of LGTM.com’s key features—and more! The time has therefore come to announce the plan for the gradual deprecation of LGTM.com.

![Screenshot of the legacy view of LGTM.com](https://github.blog/wp-content/uploads/2022/08/lgtm1.png?resize=1545%2C850)

[Bas van Schaik](https://github.blog/author/sjgithub/ "Posts by Bas van Schaik")·[@sj](https://github.com/sj)

August 15, 2022
|

3 minutes

* Share:

Three years ago, [the team that built LGTM.com joined GitHub](https://github.blog/2019-09-18-github-welcomes-semmle/). From that moment on, we have worked tirelessly to natively integrate its underlying CodeQL analysis technology into GitHub. In 2020, GitHub code scanning was [launched](https://github.blog/2020-05-06-new-from-satellite-2020-github-codespaces-github-discussions-securing-code-in-private-repositories-and-more/#security) in public beta, and later that year it became [generally available](https://github.blog/2020-09-30-code-scanning-is-now-available/) for everyone. GitHub code scanning is powered by the very same analysis engine: CodeQL.

We’ve since continued to invest in CodeQL and GitHub code scanning. Today, GitHub code scanning has all of LGTM.com’s key features—and [more](https://github.blog/changelog/label/code-scanning/)! The time has therefore come to announce the plan for the gradual deprecation of LGTM.com.

### End of August 2022: no more user sign-ups and new repositories

Starting at the end of August, LGTM.com will no longer accept new user sign-ups. It will also no longer be possible to add new repositories for analysis to LGTM.com. Existing users will continue to be able to log in and use LGTM.com, and the analysis of existing repositories will continue to work. However, [historical analysis](https://lgtm.com/help/lgtm/viewing-history-of-project) will no longer be performed–only new commits will be analyzed.

### October: help migrate repositories to GitHub code scanning

We will do our best to help migrate repositories that actively use LGTM.com to flag potential security issues in their pull requests. For those repositories, we will create pull requests that add a [GitHub Actions workflow that runs code scanning](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/setting-up-code-scanning-for-a-repository#setting-up-code-scanning-manually). Once that configuration file is merged, the repository’s source code (and future pull requests) will be scanned by GitHub code scanning. GitHub code scanning will flag any potential security issues [in pull requests](https://github.blog/changelog/2022-06-02-users-can-view-and-comment-on-code-scanning-alerts-on-the-conversation-tab-in-a-pull-request/) and on the repository’s [security tab](https://docs.github.com/en/code-security/code-scanning/automatically-scanning-your-code-for-vulnerabilities-and-errors/managing-code-scanning-alerts-for-your-repository). Once that’s all working as it should, you can disable the LGTM.com integration.

Some repositories make use of advanced LGTM.com build and analysis configurations. In such cases, we might not be able to automatically propose a GitHub Actions workflow to set up code scanning. We will notify such repositories directly.

### End of November: new commits and pull requests are no longer analyzed

At the end of November, LGTM.com will stop fetching new commits for the repositories that it analyzes. It will also stop analyzing pull requests on GitHub.com. Repositories that still use LGTM.com’s pull request analysis in the week(s) leading up to this deprecation phase will be reminded through a message in the pull request comments that are posted by LGTM.com.

### 16th of December: LGTM.com will be shut down

From the 16th of December, LGTM.com will no longer be available. This includes but is not limited to:

* [LGTM.com code quality badges](https://lgtm.com/help/lgtm/adding-badges-to-project-readme-files)
* The LGTM query console (including historical results)
* The LGTM documentation
* All LGTM.com APIs

## So long and thanks for all the fish!

On behalf of the entire LGTM.com team, we’d like to thank you all for joining us on this wonderful journey. From launching LGTM.com back in 2017, all the way through [GitHub’s acquisition of Semmle in 2019](https://github.blog/2019-09-18-github-welcomes-semmle/), the subsequent [launch of GitHub code scanning](https://github.blog/2020-05-06-new-from-satellite-2020-github-codespaces-github-discussions-securing-code-in-private-repositories-and-more/#security), and all the [improvements we’ve since shipped](https://github.blog/changelog/label/code-scanning/): it’s been an absolutely amazing journey. Thank you!

---

## FAQ

### How do I get started with GitHub code scanning?

GitHub is committed to helping build safer and more secure software without compromising on the developer experience. To learn more or enable GitHub’s security features in repositories, like code scanning or Dependabot, check out the [getting started guide](https://docs.github.com/en/code-security/getting-started/github-security-features).

### I love the LGTM.com query console—can I continue to use it?

If you are an active user of the LGTM.com query console and are not yet part of our beta program to test this functionality on GitHub, please leave us a note [here](https://github.com/orgs/community/discussions/29534).

### Where can I ask questions or leave feedback?

Please join our GitHub Discussion on this topic [here](https://github.com/orgs/community/discussions/29534)!

### How can I download data from LGTM.com before it goes offline?

Please take a look at the [large number of APIs](https://lgtm.com/help/lgtm/api/api-for-lgtm) that are available on LGTM.com.

## Written by

![Bas van Schaik](https://avatars.githubusercontent.com/u/5082246?v=4&s=200)

### [Bas van Schaik](https://github.blog/author/sjgithub/)

[@sj](https://github.com/sj)

## Related posts

![](https://github.blog/wp-content/uploads/2024/06/Collaboration-LightMode-2-2.png?resize=400%2C212)
[News & insights](https://github.blog/news-insights/)
### [Inside the research: How GitHub Copilot impacts the nature of work for open source maintainers](https://github.blog/news-insights/policy-news-and-insights/inside-the-research-github-copilot/)

An interview with economic researchers analyzing the causal effect of GitHub Copilot on how open source maintainers work.

[Kevin Xu](https://github.blog/author/khxu/ "Posts by Kevin Xu")

![A designed hero image that says “OpenAI o1 is now available in Copilot Chat and GitHub Models.” This means that GitHub Copilot and GitHub Models users now have access to the latest frontier AI model from OpenAI.](https://github.blog/wp-content/uploads/2024/12/Blog-Header_Copliot-01-3.png?resize=400%2C212)
[Company news](https://github.blog/news-insights/company-news/)
### [OpenAI’s latest o1 model now available in GitHub Copilot and GitHub Models](https://github.blog/news-insights/openais-o1-model-available-in-copilot-chat-and-github-models/)

The December 17 release of OpenAI’s o1 model is now available in GitHub Copilot and GitHub Models, bringing advanced coding capabilities to your workflows.

[Cassidy Williams](https://github.blog/author/cassidoo/ "Posts by Cassidy Williams")

![](https://github.blog/wp-content/uploads/2024/12/copilot-free-header.png?resize=400%2C212)
[News & insights](https://github.blog/news-insights/)
### [Announcing 150M developers and a new free tier for GitHub Copilot in VS Code](https://github.blog/news-insights/product-news/github-copilot-in-vscode-free/)

Come and join 150M developers on GitHub that can now code with Copilot for free in VS Code.

[Thomas Dohmke](https://github.blog/author/ashtom/ "Posts by Thomas Dohmke")

## Explore more from GitHub

![Docs](https://github.blog/wp-content/uploads/2024/07/Icon-Circle.svg)
### Docs

Everything you need to master GitHub, all in one place.

[Go to Docs](https://docs.github.com/)

![The ReadME Project](https://github.blog/wp-content/uploads/2022/05/readme.svg)
### The ReadME Project

Stories and voices from the developer community.

[Learn more](https://github.com/readme)

![GitHub Actions](https://github.blog/wp-content/uploads/2022/05/actions.svg)
### GitHub Actions

Native CI/CD alongside code hosted in GitHub.

[Learn more](https://github.com/features/actions)

![Work at GitHub!](https://github.blog/wp-content/uploads/2022/05/careers.svg)
### Work at GitHub!

Check out our current job openings.

[Apply now](https://www.github.careers/careers-home)

## We do newsletters, too

Discover tips, technical guides, and best practices in our biweekly newsletter just for devs.

Your email address

Subscribe

Yes please, I’d like GitHub and affiliates to use my information for personalized communications, targeted advertising and campaign effectiveness. See the [GitHub Privacy Statement](https://github.com/site/privacy) for more details.

Subscribe

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Enterprise](https://github.com/enterprise)
* [Customer Stories](https://github.com/customer-stories?type=enterprise)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com/)
## Platform

* [Developer API](https://developer.github.com/)
* [Partners](https://partner.github.com/)
* [Atom](https://atom.io/)
* [Electron](https://www.electronjs.org/)
* [GitHub Desktop](https://desktop.github.com/)
## Support

* [Docs](https://docs.github.com/)
* [Community Forum](https://github.community/)
* [Training](https://services.github.com/)
* [Status](https://www.githubstatus.com/)
* [Contact](https://support.github.com/)
## Company

* [About](https://github.com/about)
* [Blog](https://github.blog/)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Shop](https://shop.github.com/)

* [LinkedIn icon

  GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram icon

  GitHub on Instagram](https://www.instagram.com/github/)
* [YouTube icon

  GitHub on YouTube](https://www.youtube.com/github)
* [X icon

  GitHub on X](https://twitter.com/github)
* [TikTok icon

  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch icon

  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub icon

  GitHub’s organization on GitHub](https://github.com/github)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_52a64fc1_20250114_220546.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fcommit%2Fdb8454bf19a092a78d53ee4dba2af628b730a6e7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fcommit%2Fdb8454bf19a092a78d53ee4dba2af628b730a6e7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openmrs%2Fopenmrs-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openmrs](/openmrs)
/
**[openmrs-core](/openmrs/openmrs-core)**
Public

* [Notifications](/login?return_to=%2Fopenmrs%2Fopenmrs-core) You must be signed in to change notification settings
* [Fork
  3.7k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)
* [Star
   1.4k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)

* [Code](/openmrs/openmrs-core)
* [Pull requests
  40](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

Additional navigation options

* [Code](/openmrs/openmrs-core)
* [Pull requests](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

## Commit

[Permalink](/openmrs/openmrs-core/commit/db8454bf19a092a78d53ee4dba2af628b730a6e7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug

[Browse files](/openmrs/openmrs-core/tree/db8454bf19a092a78d53ee4dba2af628b730a6e7)
Browse the repository at this point in the history

* Loading branch information

[![@ibacher](https://avatars.githubusercontent.com/u/52504170?s=40&v=4)](/ibacher)

[ibacher](/openmrs/openmrs-core/commits?author=ibacher "View all commits by ibacher")
committed
Jan 28, 2022

1 parent
[f7c818c](/openmrs/openmrs-core/commit/f7c818c57ba7cfa59506bbce71597601ead362c9)

commit db8454b

Showing
**1 changed file**
with
**16 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

33 changes: 16 additions & 17 deletions

33
[web/src/main/java/org/openmrs/web/filter/StartupFilter.java](#diff-7c64d9f61d4d4e2ddba92920d7cf63ec96091b308d43904956b3846bc0c26d80 "web/src/main/java/org/openmrs/web/filter/StartupFilter.java")

Show comments

[View file](/openmrs/openmrs-core/blob/db8454bf19a092a78d53ee4dba2af628b730a6e7/web/src/main/java/org/openmrs/web/filter/StartupFilter.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,8 @@ |
|  |  | import java.lang.annotation.Annotation; |
|  |  | import java.lang.reflect.Field; |
|  |  | import java.nio.charset.StandardCharsets; |
|  |  | import java.nio.file.Path; |
|  |  | import java.nio.file.Paths; |
|  |  | import java.util.Collections; |
|  |  | import java.util.HashMap; |
|  |  | import java.util.List; |
| Expand Down  Expand Up | | @@ -116,30 +118,27 @@ public final void doFilter(ServletRequest request, ServletResponse response, Fil |
|  |  | // (the "/initfilter" part is needed so that the openmrs\_static\_context-servlet.xml file doesn't |
|  |  | // get instantiated early, before the locale messages are all set up) |
|  |  | if (servletPath.startsWith("/images") || servletPath.startsWith("/initfilter/scripts")) { |
|  |  | servletPath = servletPath.replaceFirst("/initfilter", "/WEB-INF/view"); // strip out the /initfilter part |
|  |  | // strip out the /initfilter part |
|  |  | servletPath = servletPath.replaceFirst("/initfilter", "/WEB-INF/view"); |
|  |  | // writes the actual image file path to the response |
|  |  | File file = new File(filterConfig.getServletContext().getRealPath(servletPath)); |
|  |  | Path filePath = Paths.get(filterConfig.getServletContext().getRealPath(servletPath)).normalize(); |
|  |  | Path fullFilePath = filePath; |
|  |  | if (httpRequest.getPathInfo() != null) { |
|  |  | file = new File(file, httpRequest.getPathInfo()); |
|  |  | fullFilePath = fullFilePath.resolve(httpRequest.getPathInfo()); |
|  |  | if (!(fullFilePath.normalize().startsWith(filePath))) { |
|  |  | log.warn("Detected attempted directory traversal in request for {}", httpRequest.getPathInfo()); |
|  |  | return; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | InputStream imageFileInputStream = null; |
|  |  | try { |
|  |  | imageFileInputStream = new FileInputStream(file); |
|  |  | try (InputStream imageFileInputStream = new FileInputStream(fullFilePath.normalize().toFile())) { |
|  |  | OpenmrsUtil.copyFile(imageFileInputStream, httpResponse.getOutputStream()); |
|  |  | } |
|  |  | catch (FileNotFoundException e) { |
|  |  | log.error("Unable to find file: " + file.getAbsolutePath()); |
|  |  | log.error("Unable to find file: {}", filePath, e); |
|  |  | } |
|  |  | finally { |
|  |  | if (imageFileInputStream != null) { |
|  |  | try { |
|  |  | imageFileInputStream.close(); |
|  |  | } |
|  |  | catch (IOException io) { |
|  |  | log.warn("Couldn't close imageFileInputStream: " + io); |
|  |  | } |
|  |  | } |
|  |  | catch (IOException e) { |
|  |  | log.warn("An error occurred while handling file {}", filePath, e); |
|  |  | } |
|  |  | } else if (servletPath.startsWith("/scripts")) { |
|  |  | log.error( |
| Expand Down  Expand Up | | @@ -193,7 +192,7 @@ private void initializeVelocity() { |
|  |  | velocityEngine.init(props); |
|  |  | } |
|  |  | catch (Exception e) { |
|  |  | log.error("velocity init failed, because: " + e); |
|  |  | log.error("velocity init failed, because: {}", e, e); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `db8454b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fcommit%2Fdb8454bf19a092a78d53ee4dba2af628b730a6e7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dfff6343_20250114_220548.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fsecurity%2Fadvisories%2FGHSA-8rgr-ww69-jv65)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenmrs%2Fopenmrs-core%2Fsecurity%2Fadvisories%2FGHSA-8rgr-ww69-jv65)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=openmrs%2Fopenmrs-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openmrs](/openmrs)
/
**[openmrs-core](/openmrs/openmrs-core)**
Public

* [Notifications](/login?return_to=%2Fopenmrs%2Fopenmrs-core) You must be signed in to change notification settings
* [Fork
  3.7k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)
* [Star
   1.4k](/login?return_to=%2Fopenmrs%2Fopenmrs-core)

* [Code](/openmrs/openmrs-core)
* [Pull requests
  40](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

Additional navigation options

* [Code](/openmrs/openmrs-core)
* [Pull requests](/openmrs/openmrs-core/pulls)
* [Actions](/openmrs/openmrs-core/actions)
* [Security](/openmrs/openmrs-core/security)
* [Insights](/openmrs/openmrs-core/pulse)

# Directory Traversal in OpenMRS Startup Filter

High

[gracepotma](/gracepotma)
published
GHSA-8rgr-ww69-jv65
Feb 22, 2022

## Package

openmrs
(N/A)

## Affected versions

>= 1.6

## Patched versions

2.1.5, 2.2.1, 2.3.5, 2.4.5, 2.5.3

## Description

### Impact

Arbitrary file exfiltration due to failure to sanitize request when satisfying GET requests for `/images` & `/initfilter/scripts`. This can allow an attacker to access any file on a system running OpenMRS that is accessible to the user id OpenMRS is running under.

Vulnerability location:

* <https://lgtm.com/projects/g/openmrs/openmrs-core/snapshot/fb1335c925ca4c94be5a546707b90d2c1efa4dcc/files/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123>
* [openmrs-core/web/src/main/java/org/openmrs/web/filter/StartupFilter.java](https://github.com/openmrs/openmrs-core/blob/ee3373a7a775bfdfa263e2e912c72e64342fb4f0/web/src/main/java/org/openmrs/web/filter/StartupFilter.java#L123)

  Line 123
  in
  [ee3373a](/openmrs/openmrs-core/commit/ee3373a7a775bfdfa263e2e912c72e64342fb4f0)

  |  | file = new File(file, httpRequest.getPathInfo()); |
  | --- | --- |

```
			if (servletPath.startsWith("/images") || servletPath.startsWith("/initfilter/scripts")) {
				servletPath = servletPath.replaceFirst("/initfilter", "/WEB-INF/view"); // strip out the /initfilter part
				// writes the actual image file path to the response
				File file = new File(filterConfig.getServletContext().getRealPath(servletPath));
				if (httpRequest.getPathInfo() != null) {
					file = new File(file, httpRequest.getPathInfo()); // VULNERABILITY: `httpRequest.getPathInfo()` is user controlled and can contain `../../..` path traversal payloads
				}

				InputStream imageFileInputStream = null;
				try {
					imageFileInputStream = new FileInputStream(file);
					OpenmrsUtil.copyFile(imageFileInputStream, httpResponse.getOutputStream()); // VULNERABILITY: Attacker controlled path file is returned
				}
```
### Patches

Affected implementations should update to the latest patch version of OpenMRS Core for the minor version they use. These are:

* 2.1.5
* 2.2.1
* 2.3.5
* 2.4.5
* 2.5.3

Patch that fixes this vulnerability can be found here: [db8454b#diff-7c64d9f61d4d4e2ddba92920d7cf63ec96091b308d43904956b3846bc0c26d80R128](https://github.com/openmrs/openmrs-core/commit/db8454bf19a092a78d53ee4dba2af628b730a6e7#diff-7c64d9f61d4d4e2ddba92920d7cf63ec96091b308d43904956b3846bc0c26d80R128)

### Workarounds and Mitigation

As a general rule, this vulnerability is already mitigated by Tomcat's URL normalization in Tomcat 7.0.28+. Implementers on older versions of Tomcat should consider upgrading their Tomcat instance as well as their OpenMRS instance.

### For more information

If you have any questions or comments about this advisory:

* Email us at security@openmrs.org

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2022-23612

### Weaknesses

No CWEs

### Credits

* [![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&v=4)](/JLLeitschuh)
  [JLLeitschuh](/JLLeitschuh)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


