The provided content describes a Broken Access Control vulnerability in the RuoYi project.

**Root cause of vulnerability:**

The vulnerability stems from the `/system/user/resetPwd` endpoint not properly validating the user's permissions before resetting another user's password. The application relies on the UI to enforce data scope restrictions, but the API does not enforce the same restrictions, leading to privilege escalation.

**Weaknesses/vulnerabilities present:**

*   **Broken Access Control:** The application fails to enforce proper access controls on the `/system/user/resetPwd` endpoint, allowing a user to reset the password of another user outside their data scope (department).
*   **Inconsistent data scope enforcement:** The Web UI enforces data scope by showing only users within the same department, while the API does not have this check.

**Impact of exploitation:**

*   An attacker (in this case, user `test1`) can reset the password of another user (`test3`) that they do not have the permissions to manage via the Web UI. This allows the attacker to potentially gain unauthorized access to the account of the targeted user, leading to unauthorized data access, modification, and deletion.

**Attack vectors:**

*   The attack vector involves crafting a POST request to the `/system/user/resetPwd` endpoint with the `userId` and `loginName` of the target user. The attacker needs to know the userId and loginName of the user they wish to reset the password of.

**Required attacker capabilities/position:**

*   The attacker must have a valid user account (`test1`) within the application, meaning they need to be an authenticated user.
* The attacker needs to be able to access the `/system/user/resetPwd` endpoint, which is publicly accessible.
*   The attacker needs to know or be able to obtain the userId and loginName of the target user (`test3`). While the UI might not show these users, the IDs are sequential and can be obtained.