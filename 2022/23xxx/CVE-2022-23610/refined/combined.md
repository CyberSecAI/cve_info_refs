=== Content from github.com_79e8abc4_20250115_084951.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-server%2Fsecurity%2Fadvisories%2FGHSA-9jg9-9g37-4424)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-server%2Fsecurity%2Fadvisories%2FGHSA-9jg9-9g37-4424)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=wireapp%2Fwire-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wireapp](/wireapp)
/
**[wire-server](/wireapp/wire-server)**
Public

* [Notifications](/login?return_to=%2Fwireapp%2Fwire-server) You must be signed in to change notification settings
* [Fork
  325](/login?return_to=%2Fwireapp%2Fwire-server)
* [Star
   2.6k](/login?return_to=%2Fwireapp%2Fwire-server)

* [Code](/wireapp/wire-server)
* [Issues
  44](/wireapp/wire-server/issues)
* [Pull requests
  94](/wireapp/wire-server/pulls)
* [Discussions](/wireapp/wire-server/discussions)
* [Actions](/wireapp/wire-server/actions)
* [Security](/wireapp/wire-server/security)
* [Insights](/wireapp/wire-server/pulse)

Additional navigation options

* [Code](/wireapp/wire-server)
* [Issues](/wireapp/wire-server/issues)
* [Pull requests](/wireapp/wire-server/pulls)
* [Discussions](/wireapp/wire-server/discussions)
* [Actions](/wireapp/wire-server/actions)
* [Security](/wireapp/wire-server/security)
* [Insights](/wireapp/wire-server/pulse)

# Improper Verification of Cryptographic Signature

Critical

[comawill](/comawill)
published
GHSA-9jg9-9g37-4424
Mar 16, 2022

## Package

wire-server
(wire)

## Affected versions

<=2022-01-18 or <=2.122.0

## Patched versions

>=2022-01-27 or >=2.123.0

## Description

### Impact

It was possible to craft DSA Signatures to bypass SAML SSO and impersonate any Wire user with SAML credentials. In teams with SAML, but without SCIM, it was possible to create new accounts with fake SAML credentials.

#### Details

Under certain conditions that can be established by an attacker, an upstream library for parsing, rendering, signing, and validating SAML XML data was accepting public keys as trusted that were provided by the attacker in the signature. As a consequence, the attacker could login as any user in any Wire team with SAML SSO enabled. If SCIM was not enabled, the attacker could also create new users with new SAML NameIDs.

#### How to reproduce

wire only accepts RSA certificates and signatures; DSA and other methods are ignored or rejected from the SAML XML metadata. However, if an attacker provides a DSA public key in the signature itself, it will be bypassed around the Wire application logic and handed to the [`hsaml2`](https://github.com/dylex/hsaml2) library. `hsaml2` maintains a [pair of an optional RSA and an optional DSA key](https://github.com/dylex/hsaml2/blob/5dc4c86c877006da5a59ed08f15f7f633961cd35/SAML2/XML/Signature.hs#L104-L107). Wire worked under the assumption that one could pass hsam2 an RSA key and an empty slot for the DSA key. However, this has the effect that [the DSA key from the signature itself will be added to the pair](https://github.com/dylex/hsaml2/blob/5dc4c86c877006da5a59ed08f15f7f633961cd35/SAML2/XML/Signature.hs#L206). DSA has precedence over RSA, so the signature validation will be successful if (and only if) the attacker provided a DSA public key matching the own signature.

In order to exploit this vulnerability, the attacker needs to know the SSO login code (distributed to all team members with SAML credentials and visible in the Team Management app), the SAML EntityID identifying the IdP (a URL not considered sensitive, but usually hard to guess, also visible in Team Management), and the SAML NameID of the user (usually an email address or a nick).

Wire is using [a fork of hsaml2](https://github.com/wireapp/hsaml2), but our fork had the same problem. [We made sure](https://github.com/dylex/hsaml2/pull/15) that the upstream hsaml2 received our patches to resolve this vulnerability.

### Patches

* The issue has been fixed in wire-server **2022-01-27** and is already deployed on all Wire managed services.
* On premise instances of wire-server need to be updated to **2022-01-27**, so that their backends are no longer affected.

### Workarounds

* No workaround known

### Mitigations

#### For cloud teams using SAML IdP

If you are an admin of a team running in the Wire cloud, you are running on the latest release and are not vulnerable any more. In addition, if you have a SAML IdP configured, in order to identify and check for any potential breaches in the past, you can choose to instruct all team members to check the device list and remove all suspicious / unknown devices. Our instruction ["How can I verify my own devices?"](https://support.wire.com/hc/en-us/articles/207693005-How-can-I-verify-my-own-devices-) shows an easy way of identifying all of your devices.

#### For on-prem Installations using SAML IdP

If you are an **on-prem site admin** and have deployed a patched version (>2022-01-27), you can additionally remove cookies on your system and force all or some users to login within the next 15 minutes (or whenever they come back online). **This will cause interruptions to ongoing calls.**

This can be done in two ways:

##### 1. Reset all cookies for all users

Open a `cqlsh` on brig's cassandra and type:

```
truncate brig.user_cookies;

```
##### 2. Reset only cookies of users authenticated with SAML (in environments with many non-SAML Teams)

Use a list of users to reset the cookies only for these users on brig's cassandra:

```
delete from brig.user_cookies where user in (c0d64244-8ab4-11ec-8fda-37788be3a4e2, ...);

```

You can either download the member CSV lists in the team management app as the team admin of those teams using SAML and extract the userIDs, or you can generate the list via `cqlsh` (cassandra for spar and galley).

Extract all TeamIDs which use SAML by running the following CQL query on spar's Cassandra:

```
copy spar.idp (team) TO 'teams_with_idp.csv' with header=true;

```

Get a list of all team members in these teams:

```
-- to get users from selected teams:
select user from galley.team_member where team in (f2207d98-8ab3-11ec-b689-07fc1fd409c9, ...);
-- to get all users and cross-reference the two CSV files locally to get to the members of the relevant teams:
copy galley.team_member (team, user) TO 'users_with_idp.csv' with header=true;

```
### References

* [hsaml2](https://github.com/dylex/hsaml2)
* [Wire's fork of hsaml2](https://github.com/wireapp/hsaml2)

### For more information

If you have any questions or comments about this advisory feel free to email us at vulnerability-report@wire.com

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

### CVE ID

CVE-2022-23610

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_eddcf63d_20250115_084950.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-server%2Freleases%2Ftag%2Fv2022-01-27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-server%2Freleases%2Ftag%2Fv2022-01-27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=wireapp%2Fwire-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wireapp](/wireapp)
/
**[wire-server](/wireapp/wire-server)**
Public

* [Notifications](/login?return_to=%2Fwireapp%2Fwire-server) You must be signed in to change notification settings
* [Fork
  325](/login?return_to=%2Fwireapp%2Fwire-server)
* [Star
   2.6k](/login?return_to=%2Fwireapp%2Fwire-server)

* [Code](/wireapp/wire-server/tree/v2022-01-27)
* [Issues
  44](/wireapp/wire-server/issues)
* [Pull requests
  94](/wireapp/wire-server/pulls)
* [Discussions](/wireapp/wire-server/discussions)
* [Actions](/wireapp/wire-server/actions)
* [Security](/wireapp/wire-server/security)
* [Insights](/wireapp/wire-server/pulse)

Additional navigation options

* [Code](/wireapp/wire-server/tree/v2022-01-27)
* [Issues](/wireapp/wire-server/issues)
* [Pull requests](/wireapp/wire-server/pulls)
* [Discussions](/wireapp/wire-server/discussions)
* [Actions](/wireapp/wire-server/actions)
* [Security](/wireapp/wire-server/security)
* [Insights](/wireapp/wire-server/pulse)

1. [Releases](/wireapp/wire-server/releases)
2. [v2022-01-27](/wireapp/wire-server/releases/tag/v2022-01-27)

# 2022-01-27

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wireapp/wire-server/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2022-01-27)

 Loading

[View all tags](/wireapp/wire-server/tags)

![@fisx](https://avatars.githubusercontent.com/u/10210727?s=40&v=4)
[fisx](/fisx)
released this
28 Jan 09:27

·
[2898 commits](/wireapp/wire-server/compare/v2022-01-27...master)
to master
since this release

[v2022-01-27](/wireapp/wire-server/tree/v2022-01-27)

[`13a6a83`](/wireapp/wire-server/commit/13a6a830a77abe3b40ee0a55df4a0ab2ade1cfdc)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Release notes

* The `nginz` chart now configures nginx to only allow cross-origin requests from an explicit allow list of subdomains. By default these are:

  ```
  nginz:
    nginx_conf:
      allowlisted_origins:
      - webapp
      - teams
      - account
  ```

  If you changed the names of these services, you must adjust those names in the nginz config as well. ([#1630](https://github.com/wireapp/wire-server/pull/1630))
* Backend now separates conversation access control for guests and services. The old access roles are still supported but it is encouraged to upgrade clients since mapping between the old access roles and the new access roles is not isomorphic. For more details refer to the API changes below or the Swagger docs.

  Old clients are fully supported; if new clients and old clients are mixed, to old clients, either guests of services may appear to be enable if they are not, which may lead to error messages (confusing but harmless). ([#2035](https://github.com/wireapp/wire-server/pull/2035))

## API changes

* Endpoints that recently have accepted `access_role` in their payload will now accept `access_role_v2` as well which will take precedence over `access_role`. See Swagger docs for how values are mapped. Endpoints that recently have returned `access_role` in their payload will now additionally return the `access_role_v2` field. ([#2035](https://github.com/wireapp/wire-server/pull/2035))

## Features

* Conversation access roles now distinguish between guests and services. ([#2035](https://github.com/wireapp/wire-server/pull/2035))

## Bug fixes and other updates

* There is now an explicit CORS allow list for *all* endpoints. In previous releases, all subdomains were accepted, however they must now be listed explicitly. This is a **breaking change**, as now only known Javascript applications may access the backend. ([#1630](https://github.com/wireapp/wire-server/pull/1630))
* Prevent 500s when SFTs are not reachable from Backend ([#2077](https://github.com/wireapp/wire-server/pull/2077))

## Internal changes

* Bump hsaml2 package version ([#2075](https://github.com/wireapp/wire-server/pull/2075))
* Separate Spar.Data module into smaller Cassandra interpreters ([#2064](https://github.com/wireapp/wire-server/pull/2064))
* Fix some HLint issues in libs/wire-api. ([#2065](https://github.com/wireapp/wire-server/pull/2065))
* Fix broken build process of package "old-time" for some environments ([#2056](https://github.com/wireapp/wire-server/pull/2056))
* Refresh license headers ([#2062](https://github.com/wireapp/wire-server/pull/2062))
* Rename Spar.Sem.ScimTokenStore.GetByTeam to LookupByTeam ([#2068](https://github.com/wireapp/wire-server/pull/2068))
* (Try syntax change in config file that breaks nginz ([#2073](https://github.com/wireapp/wire-server/pull/2073), reverted in [a4a6193](https://github.com/wireapp/wire-server/commit/a4a6193f94946fdf40efacff12773a92789a552d)))

## Federation changes

* Tag several federation tests cases for the M2 release ([#2045](https://github.com/wireapp/wire-server/pull/2045))

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


