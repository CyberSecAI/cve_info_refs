=== Content from github.com_e388c4bf_20250115_100946.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkevinboone%2Fepub2txt2%2Fissues%2F17)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkevinboone%2Fepub2txt2%2Fissues%2F17)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=kevinboone%2Fepub2txt2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kevinboone](/kevinboone)
/
**[epub2txt2](/kevinboone/epub2txt2)**
Public

* [Notifications](/login?return_to=%2Fkevinboone%2Fepub2txt2) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2Fkevinboone%2Fepub2txt2)
* [Star
   205](/login?return_to=%2Fkevinboone%2Fepub2txt2)

* [Code](/kevinboone/epub2txt2)
* [Issues
  2](/kevinboone/epub2txt2/issues)
* [Pull requests
  0](/kevinboone/epub2txt2/pulls)
* [Actions](/kevinboone/epub2txt2/actions)
* [Projects
  0](/kevinboone/epub2txt2/projects)
* [Security](/kevinboone/epub2txt2/security)
* [Insights](/kevinboone/epub2txt2/pulse)

Additional navigation options

* [Code](/kevinboone/epub2txt2)
* [Issues](/kevinboone/epub2txt2/issues)
* [Pull requests](/kevinboone/epub2txt2/pulls)
* [Actions](/kevinboone/epub2txt2/actions)
* [Projects](/kevinboone/epub2txt2/projects)
* [Security](/kevinboone/epub2txt2/security)
* [Insights](/kevinboone/epub2txt2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkevinboone%2Fepub2txt2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkevinboone%2Fepub2txt2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Bug Report]stack-buffer-overflow in Function epub2txt\_do\_file() AT src/epub2txt.c #17

Closed

[Asteriska001](/Asteriska001) opened this issue
Jan 22, 2022
· 4 comments

Closed

# [[Bug Report]stack-buffer-overflow in Function epub2txt\_do\_file() AT src/epub2txt.c](#top) #17

[Asteriska001](/Asteriska001) opened this issue
Jan 22, 2022
· 4 comments

## Comments

[![@Asteriska001](https://avatars.githubusercontent.com/u/15817126?s=80&u=935f7cfcc7f08f6e777f6b317609b4196588ef87&v=4)](/Asteriska001)

Copy link

### **[Asteriska001](/Asteriska001)** commented [Jan 22, 2022](#issue-1111573021)

| Description A stack-buffer-overflow was discovered in epub2txt2. The issue is being triggered in function xhtml\_translate\_entity() at src/xhtml.c:576 Version Version 2.02 (Lastest) Environment Ubuntu 18.04, 64bit ReproduceCommand ``` git clone the Lastest Version firstly. make && make install ./epub2txt poc  ```  [image](https://user-images.githubusercontent.com/15817126/150640450-2db08fc2-b37f-47fc-a963-532f09e88412.png)  POC file at the bottom of this report. With ASAN Note: You can use ASAN for more direct verification.  ``` Compile program with address sanitizer with this command: VERSION := 2.02 CC      := gcc CFLAGS  := -Wall -fPIC -fPIE LDLAGS  := -pie  DESTDIR := PREFIX  := /usr BINDIR  := /bin MANDIR  := /share/man APPNAME := epub2txt  TARGET	:= epub2txt  SOURCES := $(shell find src/ -type f -name *.c) OBJECTS := $(patsubst src/%,build/%,$(SOURCES:.c=.o)) DEPS	:= $(OBJECTS:.o=.deps)  $(TARGET): $(OBJECTS) 	$(CC) -fsanitize=address -o $(TARGET) $(LDFLAGS) $(OBJECTS)   build/%.o: src/%.c 	@mkdir -p build/ 	$(CC) $(CFLAGS) -fsanitize=address -g -DVERSION=\"$(VERSION)\" -DAPPNAME=\"$(APPNAME)\" -MD -MF $(@:.o=.deps) -c -o $@ $<   clean: 	$(RM) -r build/ $(TARGET)   install: 	install -D -m 755 $(APPNAME) $(DESTDIR)/$(PREFIX)/$(BINDIR)/$(APPNAME) 	install -D -m 644 man1/epub2txt.1 $(DESTDIR)/$(PREFIX)/$(MANDIR)/man1/epub2txt.1  uninstall: 	rm -f $(DESTDIR)/$(PREFIX)/$(BINDIR)/$(APPNAME) 	rm -f $(DESTDIR)/$(PREFIX)/$(MANDIR)/man1/epub2txt.1  -include $(DEPS)  .PHONY: clean install   ``` ASAN Report ``` warning [./input/id:000029,sig:11,src:000553,time:174169875,op:havoc,rep:4]:  3 extra bytes at beginning or within zipfile   (attempting to process anyway) file #1:  bad zipfile offset (local header sig):  3   (attempting to re-compensate) /tmp/epub2txt14993/OEBPS/cover.xml  bad CRC aa74ee30  (should be 4874d916)   error:  invalid compressed data to inflate /tmp/epub2txt14993/OEBPS/images/GeographyofBli-cover.jpg file #8:  bad zipfile offset (local header sig):  163411   (attempting to re-compensate) file #8:  bad zipfile offset (local header sig):  163411 file #9:  bad zipfile offset (local header sig):  181495 /tmp/epub2txt14993/OEBPS/GeographyofBli_toc.html  bad CRC 0938f2f2  (should be 64dedce7) /tmp/epub2txt14993/OEBPS/GeographyofBli_copyright.html  bad CRC 5d8cbd1a  (should be 9b5bfa5d) /tmp/epub2txt14993/OEBPS/GeographyofBli_body_split_001.html  bad CRC 1a36209f  (should be 81fec8f3) ================================================================= ==14993==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffffcb14 at pc 0x7ffff6e7e3a6 bp 0x7fffffffca60 sp 0x7fffffffc208 WRITE of size 305 at 0x7fffffffcb14 thread T0     #0 0x7ffff6e7e3a5  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x663a5)     #1 0x55555558000e in xhtml_translate_entity src/xhtml.c:576     #2 0x555555580b34 in xhtml_to_stdout src/xhtml.c:789     #3 0x555555580680 in xhtml_file_to_stdout src/xhtml.c:700     #4 0x555555560476 in epub2txt_do_file src/epub2txt.c:494     #5 0x55555555d3c9 in main src/main.c:187     #6 0x7ffff6a48bf6 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21bf6)     #7 0x55555555c219 in _start (/home/nisl1/nisl8121/Asteriska/fuzz/projects/epub2txt2-master/valid/epub2txt+0x8219)  Address 0x7fffffffcb14 is located in stack of thread T0 at offset 116 in frame     #0 0x55555557fad4 in xhtml_translate_entity src/xhtml.c:532    This frame has 2 object(s):     [32, 36) 'v'     [96, 116) 'out' <== Memory access at offset 116 overflows this variable HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext       (longjmp and C++ exceptions *are* supported) SUMMARY: AddressSanitizer: stack-buffer-overflow (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x663a5)  Shadow bytes around the buggy address:   0x10007fff7910: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7920: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7930: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7940: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7950: 00 00 00 00 f1 f1 f1 f1 04 f2 f2 f2 f2 f2 f2 f2 =>0x10007fff7960: 00 00[04]f2 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7970: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff7980: 00 00 f1 f1 f1 f1 f8 f2 f2 f2 00 00 00 00 00 00   0x10007fff7990: 00 00 00 00 00 00 00 00 f1 f1 f1 f1 00 f2 f2 f2   0x10007fff79a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x10007fff79b0: 00 00 00 00 00 00 f1 f1 f1 f1 f8 f2 f2 f2 f2 f2 Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==14993==ABORTING   ``` POC [POC](https://github.com/Asteriska8/Poc_Fuzzing/blob/main/epub2txt.poc)  Any issue plz contact with me: admin@hack.best OR: twitter: @Asteriska8 |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Mohad0](https://avatars.githubusercontent.com/u/57649205?s=40&v=4)](/Mohad0)
[Mohad0](/Mohad0)
mentioned this issue
[Jan 23, 2022](#ref-issue-1111992124)

[nvm
#18](/kevinboone/epub2txt2/issues/18)

Closed

[![@kevinboone](https://avatars.githubusercontent.com/u/10417502?s=80&u=a1fdf278a35c99c219e1a3eeb9e228b634f58761&v=4)](/kevinboone)

Copy link

Owner

### **[kevinboone](/kevinboone)** commented [Jan 24, 2022](#issuecomment-1020013662)

| I'm unsure what work is required here. I'm not remotely surprised that epub2txt is prone to buffer-overrun situations, but I'm not sure what the significance is. This isn't a utility that's going to be run unattended as a server process, so I don't see how these buffer-overruns are exploitable in any practical way. If I have misunderstood, feel free to correct me. |
| --- |

All reactions

Sorry, something went wrong.

[![@Asteriska001](https://avatars.githubusercontent.com/u/15817126?s=80&u=935f7cfcc7f08f6e777f6b317609b4196588ef87&v=4)](/Asteriska001)

Copy link

Author

### **[Asteriska001](/Asteriska001)** commented [Jan 25, 2022](#issuecomment-1020881801)

| I'm unsure what work is required here. I'm not remotely surprised that epub2txt is prone to buffer-overrun situations, but I'm not sure what the significance is. This isn't a utility that's going to be run unattended as a server process, so I don't see how these buffer-overruns are exploitable in any practical way. If I have misunderstood, feel free to correct me.  Hi Kevin, The epub2txt2 is a great utility so that it enjoys the popularity and is already available for a number of Linux distributions, with a number of users' employment. And this vulnerability allows a stack-based buffer overflow via a crafted EPUB document, and if the attacker spread some crafted or poisoned EPUB documents that could do harm to the system to the internet or the victim's computer,so it's risky. |
| --- |

All reactions

Sorry, something went wrong.

[![@kevinboone](https://avatars.githubusercontent.com/u/10417502?s=80&u=a1fdf278a35c99c219e1a3eeb9e228b634f58761&v=4)](/kevinboone)

Copy link

Owner

### **[kevinboone](/kevinboone)** commented [Jan 25, 2022](#issuecomment-1021129942)

| Thank you for reporting this problem. I had carelessly assumed that all XHTML documents in an EPUB would be well-formed. I had used a strcpy() call into a buffer of fixed length. I believe this is fixed in the latest push -- please let me know if you think otherwise. |
| --- |

All reactions

Sorry, something went wrong.

[![@Asteriska001](https://avatars.githubusercontent.com/u/15817126?s=80&u=935f7cfcc7f08f6e777f6b317609b4196588ef87&v=4)](/Asteriska001)

Copy link

Author

### **[Asteriska001](/Asteriska001)** commented [Jan 25, 2022](#issuecomment-1021291374)

| Nice work :). This vulnerability was fixed. Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@Asteriska001](https://avatars.githubusercontent.com/u/15817126?s=40&u=935f7cfcc7f08f6e777f6b317609b4196588ef87&v=4)](/Asteriska001)
[Asteriska001](/Asteriska001)
closed this as [completed](/kevinboone/epub2txt2/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 25, 2022](#event-5950621190)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkevinboone%2Fepub2txt2%2Fissues%2F17)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@kevinboone](https://avatars.githubusercontent.com/u/10417502?s=52&v=4)](/kevinboone) [![@Asteriska001](https://avatars.githubusercontent.com/u/15817126?s=52&v=4)](/Asteriska001)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


