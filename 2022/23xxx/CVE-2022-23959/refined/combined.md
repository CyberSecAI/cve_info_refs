=== Content from docs.varnish-software.com_83abc03f_20250115_091526.html ===

[![Varnish Software logo](/images/varnish_software_logo.png)](/ "Varnish Software documentation")[Search](/search)

---

# Varnish HTTP/1 Request Smuggling [Security](/security)

* [Impact](#impact)
* [Status](#status)
  + [Affected software versions](#affected-software-versions)
  + [Resolved in](#resolved-in)
* [Solution](#solution)
  + [Upgrading on RedHat and derivatives](#upgrading-on-redhat-and-derivatives)
  + [Upgrading on Ubuntu and Debian](#upgrading-on-ubuntu-and-debian)
* [Workaround](#workaround)
* [Identification](#identification)
* [Timeline](#timeline)
* [References](#references)
Published January 25, 2022.

A request smuggling attack can be performed on HTTP/1 connections on
Varnish Cache and Varnish Enterprise servers. The smuggled request would
be treated as an additional request by the Varnish server, go through
normal VCL processing, and injected as a spurious response on the client
connection.

This problem was discovered and reported to us by James Kettle, Director
of Research at PortSwigger. We wish to thank him for the responsible
disclosure.

# Impact

The potential impact is information disclosure and cache poisoning.

# Status

## Affected software versions

* Varnish Enterprise 6.0 series up to and including 6.0.9r3.
* Varnish Enterprise 4.1 series up to and including 4.1.11r5.
* Varnish Cache 6.0 LTS series up to and including 6.0.9.
* All versions of Varnish Cache 4.1 LTS series.
* Varnish Cache releases 1.x, 2.x, 3.x, 4.x, 5.x, 6.0.x, 6.1.x, 6.2.x,
  6.3.x, 6.4.x, 6.5.x, 6.6.0, 6.6.1, 7.0.0, 7.0.1.

## Resolved in

* Varnish Enterprise 6.0.9r4 (released 2021-12-21)
* Varnish Enterprise 4.1.11r6 (released 2022-01-07)
* Varnish Cache 6.6.2 (released 2022-01-25)
* Varnish Cache 7.0.2 (released 2022-01-25)
* Varnish Cache 6.0 LTS version 6.0.10 (released 2022-01-25)

# Solution

The recommended solution is to upgrade Varnish to one of the versions
where this issue has been resolved, and then ensure that Varnish is
restarted.

## Upgrading on RedHat and derivatives

You should already have configured the Varnish Enterprise repository, so a
normal upgrade will be enough:

```
sudo yum update varnish-plus
sudo systemctl restart varnish

```

Verify that the version that is installed is recent:

```
rpm -q varnish-plus
varnish-plus-6.0.9r4-1.el7.x86_64

```
## Upgrading on Ubuntu and Debian

You should already have configured the Varnish Enterprise repository, so a
normal upgrade should be enough:

```
sudo apt-get update
sudo apt-get install --only-upgrade varnish-plus
sudo systemctl restart varnish

```

Verify that the version that is installed is recent:

```
dpkg -l varnish-plus
[...]
ii  varnish-plus                6.0.9r4-1~xenial   amd64              A supercharged version of the popular web cache, Varnish Cache

```
# Workaround

If upgrading Varnish is not possible, it is possible to mitigate the
problem by ensuring that the Varnish Server does not allow connection
reuse on HTTP/1 client connections once a request body has been seen on
the connection. To deploy the workaround, put the following VCL
configuration towards the top of the VCL configuration::

```
sub vsv8 {
    if ((req.http.Content-Length || req.http.Transfer-Encoding) &&
      req.proto != "HTTP/2.0") {
        set resp.http.Connection = "close";
    }
}

sub vcl_synth { call vsv8; }
sub vcl_deliver { call vsv8; }

```
# Identification

Smuggled requests will show in the logs generated by Varnish as normal
requests. It may be possible to identify the smuggled requests by
comparing the Varnish logs with logs from any proxy software between the
Varnish server and the client.

# Timeline

**2021-12-17**

* Independent security researcher contacts the Varnish Cache project about
  a potential problem.

**2021-12-18**

* Problem is confirmed, preliminary patch and test case developed.

**2021-12-21**

* Varnish Software released patched Varnish Enterprise version 6.0.9r4 to
  address the issue.

**2022-01-07**

* Varnish Software released patched Varnish Enterprise version 4.1.11r6 to
  address the issue.

**2022-01-25**

* Public disclosure and updated open source packages.

# References

* [CVE-2022-23959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23959)
* [Varnish Cache VSV00008 announcement](https://www.varnish-cache.org/security/VSV00008.html)

---

**Manuals**

[Varnish Enterprise](/varnish-enterprise/)

[Varnish Cloud](/varnish-cloud/)

[Varnish Controller](/varnish-controller/)

[Varnish High Availability](/varnish-high-availability/)

[Varnish Custom Statistics](/varnish-custom-statistics/)

[Varnish WAF](/varnish-waf/)

[Varnish Broadcaster](/varnish-broadcaster/)

[Varnish Helm Chart](/varnish-helm/)

[Packages](/packages)

[Docker](/docker)

**News**

[Varnish Controller 6.6.4](/releases/varnish-controller-6.6.4/)

[Varnish Controller 6.6.3](/releases/varnish-controller-6.6.3/)

[Varnish Enterprise 6.0.13r10](/releases/varnish-enterprise-6.0.13r10/)

[Varnish Controller 6.6.2](/releases/varnish-controller-6.6.2/)

[Varnish Controller 6.6.1](/releases/varnish-controller-6.6.1/)

*[News archive](/news)*

Cookie Settings
[Privacy Policy](https://www.varnish-software.com/privacy-policy/)
[Contact Us](https://www.varnish-software.com/contact-us/)
[Press](https://www.varnish-software.com/press/)
[Branding](https://www.varnish-software.com/branding/)

Â®Varnish Software, Wallingatan 12, 111 60 Stockholm, Organization nr. 556805-6203



=== Content from www.debian.org_a2c064c7_20250115_091531.html ===


---

[[Date Prev](msg00054.html)][[Date Next](msg00056.html)]
[[Thread Prev](msg00054.html)][[Thread Next](msg00056.html)]
[[Date Index](maillist.html#00055)]
[[Thread Index](threads.html#00055)]

# [SECURITY] [DSA 5088-1] varnish security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5088-1] varnish security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Thu, 03 Mar 2022 20:50:31 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/87mti64xyw.fsf%40mid.deneb.enyo.de)Â [87mti64xyw.fsf@mid.deneb.enyo.de](msg00055.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5088-1                   security@debian.org
<https://www.debian.org/security/>                           Florian Weimer
March 03, 2022                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : varnish
CVE ID         : CVE-2021-36740 CVE-2022-23959
Debian Bug     : 991040 1004433

Brief introduction

CVE-2021-36740

    Martin Blix Grydeland discovered that Varnish is vulnerable to
    request smuggling attacks if the HTTP/2 protocol is enabled.

CVE-2022-23959

    James Kettle discovered a request smuggling attack against the
    HTTP/1 protocol implementation in Varnish.

For the oldstable distribution (buster), these problems have been fixed
in version 6.1.1-1+deb10u3.

For the stable distribution (bullseye), these problems have been fixed in
version 6.5.1-1+deb11u2.

We recommend that you upgrade your varnish packages.

For the detailed security status of varnish please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/varnish>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEyNPZz/qecFY/MvpUv3v/BALVJL4FAmIhF70ACgkQv3v/BALV
JL6sKAf/di/upNLJLi+nOCzJpEKWpkxZS0DRowL01MtHZyHqJlYzRA//B4Jj4e+3
IhTHdtKka8IH1AsjyOkfM7B70/Er/xtJBxceAiA7gMxpXaxtr8HqKjnx4ugs3t6E
ky63WpbrJKICTVtT/vqxVaJYnptPzsSMGpzzrIx7y7HrcYNZXJ67dfxHtyVvp6Te
5rOyDxql17mqJnZxgeAec3g0lXY7zRsD5/KGSN9QHx+HId9/eF9xss8cew1BM49C
w5DOv9wfZpjtT+NtS9NFoeTuxXmAa+WYGXu0MBob612BhL2Ux9ALqvx3StfQ0EMF
jmQWVbUUlYr0NnJ/XSFS2hAFN7aG7w==
=hu0U
-----END PGP SIGNATURE-----

```

---



=== Content from lists.fedoraproject.org_08fe5bec_20250115_091529.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT.mbox.gz?message=UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/#UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT)

# [SECURITY] Fedora 35 Update: varnish-6.6.2-2.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

15 Feb
2022

15 Feb
'22

8:28 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-2f14ec7663
2022-02-16 01:25:55.828264
--------------------------------------------------------------------------------

Name : varnish
Product : Fedora 35
Version : 6.6.2
Release : 2.fc35
URL : <https://www.varnish-cache.org/>
Summary : High-performance HTTP accelerator
Description :
This is Varnish Cache, a high-performance HTTP accelerator.

Varnish Cache stores web pages in memory so web servers donï¿½ï¿½ï¿½t have to
create the same web page over and over again. Varnish Cache serves
pages much faster than any application server; giving the website a
significant speed up.

Documentation wiki and additional information about Varnish Cache is
available on: <https://www.varnish-cache.org/>

--------------------------------------------------------------------------------
Update Information:

New upstream release varnish-6.6.2. A security release. Includes fix for
CVE-2022-23959
--------------------------------------------------------------------------------
ChangeLog:

\* Mon Feb 7 2022 Ingvar Hagelund ingvar@redpill-linpro.com - 6.6.2-2
- Rebuild with side-tag to co-build varnish-modules
\* Wed Jan 26 2022 Ingvar Hagelund ingvar@redpill-linpro.com - 6.6.2-1
- New upstream release. A security release.
- Includes fix for CVE-2022-23959 aka VSV00008, rhbz#2045033
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2045031 - CVE-2022-23959 varnish: HTTP/1 request smuggling vulnerability
<https://bugzilla.redhat.com/show_bug.cgi?id=2045031>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-2f14ec7663' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT/#UMMDMQWNAE3BTSZUHXQHVAMZC5TLHLYT)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.debian.org_f6d93b51_20250115_091527.html ===


---

[[Date Prev](msg00013.html)][[Date Next](msg00015.html)]
[[Thread Prev](msg00013.html)][[Thread Next](msg00015.html)]
[[Date Index](maillist.html#00014)]
[[Thread Index](threads.html#00014)]

# [SECURITY] [DLA 2920-1] varnish security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2920-1] varnish security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 14 Feb 2022 01:33:52 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/a860735767d05a510040696c9a787f5b3914a1f0.camel%40debian.org)Â [a860735767d05a510040696c9a787f5b3914a1f0.camel@debian.org](msg00014.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2920-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
February 14, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : varnish
Version        : 5.0.0-7+deb9u3
CVE ID         : CVE-2022-23959
Debian Bug     : 1004433

James Kettle discovered that a request smuggling attack can be performed on
HTTP/1 connections on Varnish servers, high-performance web accelerators. The
smuggled request would be treated as an additional request by the Varnish
server which may lead to information disclosure and cache poisoning.

For Debian 9 stretch, this problem has been fixed in version
5.0.0-7+deb9u3.

We recommend that you upgrade your varnish packages.

For the detailed security status of varnish please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/varnish>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpccpBsh_1Dj.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from varnish-cache.org_27c9f83a_20250115_091529.html ===

# VSV00008 Varnish HTTP/1 Request Smuggling Vulnerability[Â¶](#vsv00008-varnish-http-1-request-smuggling-vulnerability "Permalink to this heading")

[CVE-2022-23959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23959)

Date: 2022-01-25

A request smuggling attack can be performed on HTTP/1 connections on
Varnish Cache servers. The smuggled request would be treated as an
additional request by the Varnish server, go through normal VCL
processing, and injected as a spurious response on the client connection.

## Identifying smuggled requests[Â¶](#identifying-smuggled-requests "Permalink to this heading")

Smuggled requests will show in the logs generated by Varnish as normal
requests. It may be possible to identify the smuggled requests by
comparing the Varnish logs with logs from any proxy software between the
Varnish server and the client.

## Versions affected[Â¶](#versions-affected "Permalink to this heading")

* Varnish Cache releases 1.x, 2.x, 3.x, 4.x, 5.x, 6.0.x, 6.1.x, 6.2.x,
  6.3.x, 6.4.x, 6.5.x, 6.6.0, 6.6.1, 7.0.0, 7.0.1.
* Varnish Cache 6.0 LTS series up to and including 6.0.9.
* All versions of Varnish Cache 4.1 LTS series.

## Versions not affected[Â¶](#versions-not-affected "Permalink to this heading")

* Varnish Cache 6.6.2 (released 2022-01-25)
* Varnish Cache 7.0.2 (released 2022-01-25)
* Varnish Cache 6.0 LTS version 6.0.10 (released 2022-01-25)
* GitHub Varnish Cache master branch at commit 1020be7e886399a4e94407ae0dfbfd1475cc5756

## Mitigation[Â¶](#mitigation "Permalink to this heading")

If upgrading Varnish is not possible, it is possible to mitigate the
problem by ensuring that the Varnish Server does not allow connection
reuse on HTTP/1 client connections once a request body has been seen on
the connection. To deploy the workaround, put the following VCL
configuration towards the top of the VCL configuration:

```
sub vsv8 {
    if ((req.http.Content-Length || req.http.Transfer-Encoding) &&
      req.proto != "HTTP/2.0") {
        set resp.http.Connection = "close";
    }
}

sub vcl_synth { call vsv8; }
sub vcl_deliver { call vsv8; }

```

## Credits[Â¶](#credits "Permalink to this heading")

This problem was discovered and reported to us by James Kettle, Director
of Research at PortSwigger. We wish to thank him for the responsible
disclosure.

[![Logo](../_static/varnish-bunny.png)](../index.html)

### Index

---

* [Download](../releases/index.html)
* [VMODS](../vmods/index.html) &
  [Extras](../extras/index.html)
* [Get help](../support/index.html)
* [Mailing Lists](/lists/mailman/listinfo)
* [Security](index.html)
* [Documentation](../docs/index.html)
* [trunk](../docs/trunk/index.html)
  | [7.6 (current)](../docs/7.6/index.html)
  | [7.5 (previous)](../docs/7.5/index.html)
  | [6.0 (supported)](../docs/6.0/index.html)
  | [other versions](../docs/index.html)
* [Varnish Book (PDF)](https://info.varnish-software.com/resources/varnish-6-by-example-book)
* [4.0](http://book.varnish-software.com/4.0/)
  | [3.0](http://book.varnish-software.com/3.0/)
* [Github project](https://github.com/varnishcache/varnish-cache)
* [Tips and tricks](../tips/index.html)
* [Tutorials](../tutorials/index.html)
* [Varnish Business](../business/index.html)
* [Project organization](../organization/index.html)
* [VTEST](/vtest)
  | [GCOV](/gcov)

### Our VM is sponsored by:

[![](../_static/NetActuate.png)](https://www.netactuate.net)
### â€¦and:

[![](../_static/FreeBSD.gif)](https://www.freebsd.org)

Â©2016-2024, The Varnish Cache Contributors.
|
Powered by [Sphinx 5.3.0](https://www.sphinx-doc.org/)
& [Alabaster 0.7.16](https://alabaster.readthedocs.io)


