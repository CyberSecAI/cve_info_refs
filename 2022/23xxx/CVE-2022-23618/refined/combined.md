=== Content from github.com_493aa789_20250115_093428.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-jp55-vvmf-63mv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-jp55-vvmf-63mv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

# URL Redirection to Untrusted Site ('Open Redirect')

Moderate

[tmortagne](/tmortagne)
published
GHSA-jp55-vvmf-63mv
Feb 9, 2022

## Package

maven

org.xwiki.platform:xwiki-platform-oldcore
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 12.10.7, < 13.3RC1

## Patched versions

12.10.7, 13.3RC1

## Description

### Impact

There's no protection against URL redirection to untrusted site, in particular some well known parameters (xredirect) can be used to perform such redirections.

### Patches

The problem has been patched in XWiki 12.10.7 and XWiki 13.3RC1.

### Workarounds

There's no known workaround for this issue.

### References

<https://jira.xwiki.org/browse/XWIKI-10309>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [JIRA](https://jira.xwiki.org)
* Email us at Security ML

### Severity

Moderate

4.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N

### CVE ID

CVE-2022-23618

### Weaknesses

[CWE-601](/advisories?query=cwe%3A601)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8fad46d9_20250115_093427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F5251c02080466bf9fb55288f04a37671108f8096)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F5251c02080466bf9fb55288f04a37671108f8096)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  554](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  139](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/5251c02080466bf9fb55288f04a37671108f8096)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-10309: Check URL domains based on a whitelist ([#1592](https://github.com/xwiki/xwiki-platform/pull/1592))

[Browse files](/xwiki/xwiki-platform/tree/5251c02080466bf9fb55288f04a37671108f8096)
Browse the repository at this point in the history

```
Introduce a new property for listing the trusted domains and API to
check an URL against that list and the aliases used in subwikis.

  * Add new property url.trustedDomains in xwiki.properties
  * Add new API in URLConfiguration to retrieve this configuration value
  * Create a new URLSecurityManager responsible to check if an URL can
    be trusted based on this property and on the subwikis configurations
  * Introduce a new listener to invalidate the cache of
    URLSecurityManager whenever a XWikiServerClass xobject is
added/updated/deleted
  * Move URL API implementations to URL default module
  * Add a new property url.enableTrustedDomains as a global switch off the
    checks on domains to avoid breaking behaviours on existing instances
  * Add a constant property in URLSecurityManager to be set in
    ExecutionContext to allow temporary switch off the check for
extensions
  * Use both those switches in DefaultURLSecurityManager to prevent
    performing the check when needed
```

* Loading branch information

[![@surli](https://avatars.githubusercontent.com/u/1478232?s=40&v=4)](/surli)

[surli](/xwiki/xwiki-platform/commits?author=surli "View all commits by surli")
authored
Apr 15, 2021

1 parent
[5ce100d](/xwiki/xwiki-platform/commit/5ce100d7c6a63a095d4da485084e62184c9ff3f6)

commit 5251c02

 Show file tree

 Hide file tree

Showing
**40 changed files**
with
**640 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-oldcore/src/main/java/com/xpn/xwiki

    - user/impl/xwiki

      * xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/impl/xwiki/MyFormAuthenticator.java
        [MyFormAuthenticator.java](#diff-7411a4c190b512d69c95f88b031a313227a37d7e0559627ce3089aa5cb627728)
    - web

      * xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiAction.java
        [XWikiAction.java](#diff-5d46c91b2f8a3b5b3ef7171c89146984b42318794be6079f6f1097c2d7f5d656)
      * xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiServletResponse.java
        [XWikiServletResponse.java](#diff-c445f288d5d63424f56ef13f65514ab4e174a72e979b53b88197c2b7def267cf)
  + xwiki-platform-url

    - xwiki-platform-core/xwiki-platform-url/pom.xml
      [pom.xml](#diff-5881e822b7c5eaa5f06a94bf6d56600cad2b8c2a966b981293247d158d721134)
    - xwiki-platform-url-api

      * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/pom.xml
        [pom.xml](#diff-befc92e9da3819ecc5ccfcd5c86516d83cecf21ca2a03e49331f3b54ff6a8fd9)
      * src/main/java/org/xwiki/url

        + xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLConfiguration.java
          [URLConfiguration.java](#diff-4465a1ea4960c25f65c5cd75162cdc9261dc294963d5430c022e47b10abd35e1)
        + xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLSecurityManager.java
          [URLSecurityManager.java](#diff-4b2af3f5d8f656c10cc16e12e516e160c08e81ff6067e7e32cd55df4ea5dc7e2)
    - xwiki-platform-url-default

      * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/pom.xml
        [pom.xml](#diff-bd3c50bca98fb44bb8e0e4fa54690e4c26f835ec45e82addd01ffd6133eb2d83)
      * src

        + main

          - java/org/xwiki/url/internal

            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceReferenceSerializer.java
              [AbstractExtendedURLResourceReferenceSerializer.java](#diff-6043058efe3b33da7876230b1afdd47d5cf8b3d1eb99b02d0740125089a17e92)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceTypeResolver.java
              [AbstractExtendedURLResourceTypeResolver.java](#diff-fd6aa57727f901f93f1ce68365af375bcf2f7f45bbafd6cce100a64b32972440)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractParentResourceReferenceResolver.java
              [AbstractParentResourceReferenceResolver.java](#diff-b3d99176a9e15866444f91c0c3a08b58fa650083b4b92510f1b36177c958bb64)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractResourceReferenceResolver.java
              [AbstractResourceReferenceResolver.java](#diff-d9bea8b6e056741b96ffa7627c6e55b24f705a5537db0d68bcce30cac150eb0d)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceResolver.java
              [DefaultResourceReferenceResolver.java](#diff-a9e26014efbb35535e95a52f1d455452221a826160aa3dc090f370d8bc998e07)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceSerializer.java
              [DefaultResourceReferenceSerializer.java](#diff-7724247969084781f30e1271c0180c3b95d610b76c438fad99dc68b0385d3b65)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceTypeResolver.java
              [DefaultResourceTypeResolver.java](#diff-c0f11052f3c3903258705427ed25f214778894a6d17cb56e840c6d7582312c41)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultStringResourceTypeResolver.java
              [DefaultStringResourceTypeResolver.java](#diff-1200962dfce195f67ba2d5277edd92c87d2fdc33bff7a4673be3e1a1e429f8a6)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLConfiguration.java
              [DefaultURLConfiguration.java](#diff-d9393b4abeea1b84f8574806fdec18c977d16615093bf094199e3367325d4dd0)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLContextManager.java
              [DefaultURLContextManager.java](#diff-05cde76f25aa542f680d69b59b347f9a033f204707e337d13c4b0637cce1a64e)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLSecurityManager.java
              [DefaultURLSecurityManager.java](#diff-05fd30b593c2494dfdf1d6ba520e82107d25cbad2829742791023e8b0e2fe6ce)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/GenericResourceReferenceResolver.java
              [GenericResourceReferenceResolver.java](#diff-acd617aa97caac688180dabcc8bce9b41d629f538403f16ff517eb82e8c07564)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/GenericStringResourceTypeResolver.java
              [GenericStringResourceTypeResolver.java](#diff-6da1a499213800c6e218a2745127ed48f5b5957f25b65f3e22c11d1d02f2d512)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/ParentResourceReference.java
              [ParentResourceReference.java](#diff-84234891129246f9abf498da93cb2348c921587471a2094847b06f5a69e1ff47)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/RelativeExtendedURL.java
              [RelativeExtendedURL.java](#diff-0ff671f65fbd87fc1c69805c84a4231decb058163d172bd093a4e3ba4e25f986)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/URLExecutionContextInitializer.java
              [URLExecutionContextInitializer.java](#diff-3ac7763d363fa2520cd03890521a32edae6b0225a1ccc1bec760761bb3b436df)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/URLStringEntityReferenceResolver.java
              [URLStringEntityReferenceResolver.java](#diff-b6a9b05cab6a2a2162996f92f73541dea9907892079488185c68b83b6c2ae634)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/URLStringEntityReferenceSerializer.java
              [URLStringEntityReferenceSerializer.java](#diff-e7216f8d43c8f54f15a142f4a00801bc1cf98868a1dd7b2c3534ddf84373ad00)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/URLSymbolScheme.java
              [URLSymbolScheme.java](#diff-d6a7088a6e9b1cb243d31f23a3f5023bb3cf3d9fd2a1483ac1e07eba55380c69)
            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/XWikiServerClassListener.java
              [XWikiServerClassListener.java](#diff-f768ccb2d066180370b812b1f8c8555fcf5e6c76482f6922d47fea905bebc668)
          - resources/META-INF

            * xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/resources/META-INF/components.txt
              [components.txt](#diff-deb263f3b6b4ce4dd9ff70cd9752d734f1a900e66f8f1090e2b40f8b8fa1b4b7)
        + test/java/org/xwiki/url/internal

          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/AbstractParentResourceReferenceResolverTest.java
            [AbstractParentResourceReferenceResolverTest.java](#diff-f2b90baca9ab72846f5b968707d5d23dcd0d946fdf142f03732d2c8e371e2999)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/DefaultURLConfigurationTest.java
            [DefaultURLConfigurationTest.java](#diff-f6e590a000e59eeb566c9d178427ff1f329635561e5bf9ca38c64dbe6f519d8e)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/DefaultURLSecurityManagerTest.java
            [DefaultURLSecurityManagerTest.java](#diff-528862504e1e7e19612594e493b8f50dae7df133945fff43648312b76e1141fb)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/RelativeExtendedURLTest.java
            [RelativeExtendedURLTest.java](#diff-b065cfa8afe66d61ac0855f9e96e3ed104cd580363acd0db4b73bf6c74b86c81)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/URLExecutionContextInitializerTest.java
            [URLExecutionContextInitializerTest.java](#diff-1df7ef2e4a801901489734e54500607829f30f8244913524b7b0c305bf0979d0)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/URLStringEntityReferenceResolverTest.java
            [URLStringEntityReferenceResolverTest.java](#diff-915daa6a20c343329f738b5ddee3787f99dc2de87f7122f57056ba5cebdcf91b)
          - xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/test/java/org/xwiki/url/internal/URLStringEntityReferenceSerializerTest.java
            [URLStringEntityReferenceSerializerTest.java](#diff-3a15de0933ff44179f4c414ad631d197abbe95e3bc06fecb5212ea18e10a9ca7)
    - xwiki-platform-url-schemes

      * xwiki-platform-url-scheme-filesystem

        + xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-schemes/xwiki-platform-url-scheme-filesystem/pom.xml
          [pom.xml](#diff-749aa314d63d1bc116115b0887be5da6e2fb550df2570b1a14159eba94130474)
      * xwiki-platform-url-scheme-reference

        + xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-schemes/xwiki-platform-url-scheme-reference/pom.xml
          [pom.xml](#diff-306085a2e2e9f4563b4a90d4d379ac6f6b86b309b51c18442b676614330fb39c)
      * xwiki-platform-url-scheme-standard

        + xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-schemes/xwiki-platform-url-scheme-standard/pom.xml
          [pom.xml](#diff-41468b3b811e69076b453c0189028295ad86bdf3661c1289357efe607c361edc)
* xwiki-platform-tools/xwiki-platform-tool-configuration-resources/src/main/resources

  + xwiki-platform-tools/xwiki-platform-tool-configuration-resources/src/main/resources/xwiki.properties.vm
    [xwiki.properties.vm](#diff-dcbdc74dfba4049080f6ecbf5b078d266e04d4c7c48cd9cc1d266ad4590bb969)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[...iki-platform-oldcore/src/main/java/com/xpn/xwiki/user/impl/xwiki/MyFormAuthenticator.java](#diff-7411a4c190b512d69c95f88b031a313227a37d7e0559627ce3089aa5cb627728 "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/impl/xwiki/MyFormAuthenticator.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/user/impl/xwiki/MyFormAuthenticator.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,6 +41,8 @@ |
|  |  | import org.xwiki.security.authentication.AuthenticationFailureManager; |
|  |  | import com.xpn.xwiki.internal.user.UserAuthenticatedEventNotifier; |
|  |  |  |
|  |  | import com.xpn.xwiki.web.XWikiResponse; |
|  |  |  |
|  |  | public class MyFormAuthenticator extends FormAuthenticator implements XWikiAuthenticator |
|  |  | { |
|  |  | private static final Logger LOGGER = LoggerFactory.getLogger(MyFormAuthenticator.class); |
| Expand Down  Expand Up | | @@ -244,8 +246,8 @@ public boolean processLogin(String username, String password, String rememberme, |
|  |  |  |
|  |  | Boolean bAjax = (Boolean) context.get("ajax"); |
|  |  | if ((bAjax == null) || (!bAjax.booleanValue())) { |
|  |  | String continueToURL = getContinueToURL(request); |
|  |  | // This is the url that the user was initially accessing before being prompted for login. |
|  |  | String continueToURL = getContinueToURL(request); |
|  |  | response.sendRedirect(response.encodeRedirectURL(continueToURL)); |
|  |  | } |
|  |  | } else { |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiAction.java](#diff-5d46c91b2f8a3b5b3ef7171c89146984b42318794be6079f6f1097c2d7f5d656 "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiAction.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiAction.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -981,6 +981,12 @@ protected boolean sendGlobalRedirect(XWikiResponse response, String url, XWikiCo |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Perform a redirect to the given URL. |
|  |  | \* @param response the response to use to perform the redirect |
|  |  | \* @param url the location of the redirect |
|  |  | \* @throws XWikiException in case of IOException when performing the redirect. |
|  |  | \*/ |
|  |  | protected void sendRedirect(XWikiResponse response, String url) throws XWikiException |
|  |  | { |
|  |  | try { |
| Expand Down | |  |

20 changes: 20 additions & 0 deletions

20
[...orm-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiServletResponse.java](#diff-c445f288d5d63424f56ef13f65514ab4e174a72e979b53b88197c2b7def267cf "xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiServletResponse.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/XWikiServletResponse.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,8 +21,10 @@ |
|  |  |  |
|  |  | import java.io.IOException; |
|  |  | import java.io.PrintWriter; |
|  |  | import java.net.URL; |
|  |  | import java.util.Collection; |
|  |  | import java.util.Locale; |
|  |  | import java.util.regex.Pattern; |
|  |  |  |
|  |  | import javax.servlet.ServletOutputStream; |
|  |  | import javax.servlet.http.Cookie; |
| Expand All | | @@ -31,10 +33,12 @@ |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  | import org.xwiki.url.URLSecurityManager; |
|  |  |  |
|  |  | public class XWikiServletResponse implements XWikiResponse |
|  |  | { |
|  |  | private static final Logger LOGGER = LoggerFactory.getLogger(XWikiServletResponse.class); |
|  |  | private static final Pattern ABSOLUTE\_URL\_PATTERN = Pattern.compile("[a-z0-9]+://.\*"); |
|  |  |  |
|  |  | private HttpServletResponse response; |
|  |  |  |
| Expand Down  Expand Up | | @@ -66,9 +70,25 @@ public void sendRedirect(String redirect) throws IOException |
|  |  | LOGGER.warn("Possible HTTP Response Splitting attack, attempting to redirect to [{}]", redirect); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | // check for trusted domains, only if the given location is an absolute URL. |
|  |  | if (ABSOLUTE\_URL\_PATTERN.matcher(redirect).matches()) { |
|  |  | if (!getURLSecurityManager().isDomainTrusted(new URL(redirect))) { |
|  |  | LOGGER.warn( |
|  |  | "Possible phishing attack, attempting to redirect to [{}], this request has been blocked. " |
|  |  | + "If the request was legitimate, add the domain related to this request in the list " |
|  |  | + "of trusted domains in the configuration.", redirect); |
|  |  | return; |
|  |  | } |
|  |  | } |
|  |  | this.response.sendRedirect(redirect); |
|  |  | } |
|  |  |  |
|  |  | private URLSecurityManager getURLSecurityManager() |
|  |  | { |
|  |  | return Utils.getComponent(URLSecurityManager.class); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void setContentType(String type) |
|  |  | { |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[xwiki-platform-core/xwiki-platform-url/pom.xml](#diff-5881e822b7c5eaa5f06a94bf6d56600cad2b8c2a966b981293247d158d721134 "xwiki-platform-core/xwiki-platform-url/pom.xml")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ |
|  |  | <!-- Sorted Alphabetically --> |
|  |  | <module>xwiki-platform-url-api</module> |
|  |  | <module>xwiki-platform-url-container</module> |
|  |  | <module>xwiki-platform-url-default</module> |
|  |  | <module>xwiki-platform-url-schemes</module> |
|  |  | </modules> |
|  |  | </project> |

4 changes: 1 addition & 3 deletions

4
[xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/pom.xml](#diff-befc92e9da3819ecc5ccfcd5c86516d83cecf21ca2a03e49331f3b54ff6a8fd9 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/pom.xml")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,9 +32,7 @@ |
|  |  | <packaging>jar</packaging> |
|  |  | <description>Allows configuration of the URL scheme used by XWiki to parse/serialize URLs</description> |
|  |  | <properties> |
|  |  | <!-- The reason for this low TPC value is because this module is tested using integration tests in the various |
|  |  | URL Scheme modules --> |
|  |  | <xwiki.jacoco.instructionRatio>0.45</xwiki.jacoco.instructionRatio> |
|  |  | <xwiki.jacoco.instructionRatio>0.85</xwiki.jacoco.instructionRatio> |
|  |  | <!-- Name to display by the Extension Manager --> |
|  |  | <xwiki.extension.name>URL API</xwiki.extension.name> |
|  |  | </properties> |
| Expand Down | |  |

30 changes: 30 additions & 0 deletions

30
[...iki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLConfiguration.java](#diff-4465a1ea4960c25f65c5cd75162cdc9261dc294963d5430c022e47b10abd35e1 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLConfiguration.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLConfiguration.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,7 +19,11 @@ |
|  |  | \*/ |
|  |  | package org.xwiki.url; |
|  |  |  |
|  |  | import java.util.Collections; |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import org.xwiki.component.annotation.Role; |
|  |  | import org.xwiki.stability.Unstable; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Configuration options for the URL module. |
| Expand Down  Expand Up | | @@ -47,4 +51,30 @@ default boolean useResourceLastModificationDate() |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Specify the list of domains that are considered as trusted by the administrators of the wiki: those domains can |
|  |  | \* be used safely for redirections from the wiki or for performing other requests on them. |
|  |  | \* @return the list of trusted domains that can be used in the wiki. |
|  |  | \* @since 13.3RC1 |
|  |  | \* @since 12.10.7 |
|  |  | \*/ |
|  |  | @Unstable |
|  |  | default List<String> getTrustedDomains() |
|  |  | { |
|  |  | return Collections.emptyList(); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Define if the trusted domains check should be performed or not. This option is provided only to allow bypassing |
|  |  | \* security checks globally on the wiki in case of problems. |
|  |  | \* @return {@code true} if the security check on domains should be performed. {@code false} otherwise. |
|  |  | \* @since 13.3RC1 |
|  |  | \* @since 12.10.7 |
|  |  | \*/ |
|  |  | @Unstable |
|  |  | default boolean isTrustedDomainsEnabled() |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  | } |

56 changes: 56 additions & 0 deletions

56
[...i-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLSecurityManager.java](#diff-4b2af3f5d8f656c10cc16e12e516e160c08e81ff6067e7e32cd55df4ea5dc7e2 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLSecurityManager.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/URLSecurityManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,56 @@ |
|  |  | /\* |
|  |  | \* See the NOTICE file distributed with this work for additional |
|  |  | \* information regarding copyright ownership. |
|  |  | \* |
|  |  | \* This is free software; you can redistribute it and/or modify it |
|  |  | \* under the terms of the GNU Lesser General Public License as |
|  |  | \* published by the Free Software Foundation; either version 2.1 of |
|  |  | \* the License, or (at your option) any later version. |
|  |  | \* |
|  |  | \* This software is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | \* Lesser General Public License for more details. |
|  |  | \* |
|  |  | \* You should have received a copy of the GNU Lesser General Public |
|  |  | \* License along with this software; if not, write to the Free |
|  |  | \* Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA |
|  |  | \* 02110-1301 USA, or see the FSF site: http://www.fsf.org. |
|  |  | \*/ |
|  |  | package org.xwiki.url; |
|  |  |  |
|  |  | import java.net.URL; |
|  |  |  |
|  |  | import org.xwiki.component.annotation.Role; |
|  |  | import org.xwiki.stability.Unstable; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Dedicated component to perform security checks on URLs. |
|  |  | \* |
|  |  | \* @version $Id$ |
|  |  | \* @since 13.3RC1 |
|  |  | \* @since 12.10.7 |
|  |  | \*/ |
|  |  | @Role |
|  |  | @Unstable |
|  |  | public interface URLSecurityManager |
|  |  | { |
|  |  | /\*\* |
|  |  | \* Constant to be used in {@link org.xwiki.context.ExecutionContext} with the value {@code "true"} to bypass a |
|  |  | \* check of {@link #isDomainTrusted(URL)}. |
|  |  | \*/ |
|  |  | String BYPASS\_DOMAIN\_SECURITY\_CHECK\_CONTEXT\_PROPERTY = "bypassDomainSecurityCheck"; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Check if the given {@link URL} can be trusted based on the trusted domains of the wiki. |
|  |  | \* This method check on both the list of trusted domains given by the configuration |
|  |  | \* (see {@link URLConfiguration#getTrustedDomains()}) and the list of aliases used by the wiki descriptors. |
|  |  | \* Note that this method always returns {@code true} if {@link URLConfiguration#isTrustedDomainsEnabled()} returns |
|  |  | \* {@code true}. Also the method will return {@code true} whenever the {@link org.xwiki.context.ExecutionContext} |
|  |  | \* contains a property named {@link #BYPASS\_DOMAIN\_SECURITY\_CHECK\_CONTEXT\_PROPERTY} with the value {@code "true"}. |
|  |  | \* |
|  |  | \* @param urlToCheck the URL for which we want to know if the domain is trusted or not. |
|  |  | \* @return {@code true} if the URL domain can be trusted or if the check is skipped, {@code false} otherwise |
|  |  | \*/ |
|  |  | boolean isDomainTrusted(URL urlToCheck); |
|  |  | } |

63 changes: 63 additions & 0 deletions

63
[xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/pom.xml](#diff-bd3c50bca98fb44bb8e0e4fa54690e4c26f835ec45e82addd01ffd6133eb2d83 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/pom.xml")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/pom.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,63 @@ |
|  |  | <?xml version="1.0" encoding="UTF-8"?> |
|  |  |  |
|  |  | <!-- |
|  |  | \* See the NOTICE file distributed with this work for additional |
|  |  | \* information regarding copyright ownership. |
|  |  | \* |
|  |  | \* This is free software; you can redistribute it and/or modify it |
|  |  | \* under the terms of the GNU Lesser General Public License as |
|  |  | \* published by the Free Software Foundation; either version 2.1 of |
|  |  | \* the License, or (at your option) any later version. |
|  |  | \* |
|  |  | \* This software is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | \* Lesser General Public License for more details. |
|  |  | \* |
|  |  | \* You should have received a copy of the GNU Lesser General Public |
|  |  | \* License along with this software; if not, write to the Free |
|  |  | \* Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA |
|  |  | \* 02110-1301 USA, or see the FSF site: http://www.fsf.org. |
|  |  | --> |
|  |  |  |
|  |  | <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4\_0\_0.xsd"> |
|  |  | <modelVersion>4.0.0</modelVersion> |
|  |  | <parent> |
|  |  | <groupId>org.xwiki.platform</groupId> |
|  |  | <artifactId>xwiki-platform-url</artifactId> |
|  |  | <version>13.3-SNAPSHOT</version> |
|  |  | </parent> |
|  |  | <artifactId>xwiki-platform-url-default</artifactId> |
|  |  | <name>XWiki Platform - URL - Default</name> |
|  |  | <packaging>jar</packaging> |
|  |  | <description>Default implementations of the API defined in xwiki-platform-url-api</description> |
|  |  | <properties> |
|  |  | <!-- The reason for this low TPC value is because this module is tested using integration tests in the various |
|  |  | URL Scheme modules --> |
|  |  | <xwiki.jacoco.instructionRatio>0.31</xwiki.jacoco.instructionRatio> |
|  |  | </properties> |
|  |  | <dependencies> |
|  |  | <dependency> |
|  |  | <groupId>org.xwiki.platform</groupId> |
|  |  | <artifactId>xwiki-platform-url-api</artifactId> |
|  |  | <version>${project.version}</version> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>org.xwiki.platform</groupId> |
|  |  | <artifactId>xwiki-platform-oldcore</artifactId> |
|  |  | <version>${project.version}</version> |
|  |  | </dependency> |
|  |  | <dependency> |
|  |  | <groupId>org.xwiki.platform</groupId> |
|  |  | <artifactId>xwiki-platform-wiki-api</artifactId> |
|  |  | <version>${project.version}</version> |
|  |  | </dependency> |
|  |  | <!-- Testing Dependencies --> |
|  |  | <dependency> |
|  |  | <groupId>org.xwiki.commons</groupId> |
|  |  | <artifactId>xwiki-commons-tool-test-component</artifactId> |
|  |  | <version>${commons.version}</version> |
|  |  | <scope>test</scope> |
|  |  | </dependency> |
|  |  | </dependencies> |
|  |  | </project> |

0

[...tendedURLResourceReferenceSerializer.java → ...tendedURLResourceReferenceSerializer.java](#diff-6043058efe3b33da7876230b1afdd47d5cf8b3d1eb99b02d0740125089a17e92 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceReferenceSerializer.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceReferenceSerializer.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceReferenceSerializer.java)
Edit file

Delete file

File renamed without changes.

0

[...tractExtendedURLResourceTypeResolver.java → ...tractExtendedURLResourceTypeResolver.java](#diff-fd6aa57727f901f93f1ce68365af375bcf2f7f45bbafd6cce100a64b32972440 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceTypeResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceTypeResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractExtendedURLResourceTypeResolver.java)
Edit file

Delete file

File renamed without changes.

0

[...tractParentResourceReferenceResolver.java → ...tractParentResourceReferenceResolver.java](#diff-b3d99176a9e15866444f91c0c3a08b58fa650083b4b92510f1b36177c958bb64 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/AbstractParentResourceReferenceResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractParentResourceReferenceResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractParentResourceReferenceResolver.java)
Edit file

Delete file

File renamed without changes.

0

[...al/AbstractResourceReferenceResolver.java → ...al/AbstractResourceReferenceResolver.java](#diff-d9bea8b6e056741b96ffa7627c6e55b24f705a5537db0d68bcce30cac150eb0d "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/AbstractResourceReferenceResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractResourceReferenceResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/AbstractResourceReferenceResolver.java)
Edit file

Delete file

File renamed without changes.

0

[...nal/DefaultResourceReferenceResolver.java → ...nal/DefaultResourceReferenceResolver.java](#diff-a9e26014efbb35535e95a52f1d455452221a826160aa3dc090f370d8bc998e07 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceResolver.java)
Edit file

Delete file

File renamed without changes.

0

[...l/DefaultResourceReferenceSerializer.java → ...l/DefaultResourceReferenceSerializer.java](#diff-7724247969084781f30e1271c0180c3b95d610b76c438fad99dc68b0385d3b65 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceSerializer.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceSerializer.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceReferenceSerializer.java)
Edit file

Delete file

File renamed without changes.

0

[...internal/DefaultResourceTypeResolver.java → ...internal/DefaultResourceTypeResolver.java](#diff-c0f11052f3c3903258705427ed25f214778894a6d17cb56e840c6d7582312c41 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultResourceTypeResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceTypeResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultResourceTypeResolver.java)
Edit file

Delete file

File renamed without changes.

0

[...al/DefaultStringResourceTypeResolver.java → ...al/DefaultStringResourceTypeResolver.java](#diff-1200962dfce195f67ba2d5277edd92c87d2fdc33bff7a4673be3e1a1e429f8a6 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultStringResourceTypeResolver.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultStringResourceTypeResolver.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultStringResourceTypeResolver.java)
Edit file

Delete file

File renamed without changes.

15 changes: 15 additions & 0 deletions

15
[...url/internal/DefaultURLConfiguration.java → ...url/internal/DefaultURLConfiguration.java](#diff-d9393b4abeea1b84f8574806fdec18c977d16615093bf094199e3367325d4dd0 "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultURLConfiguration.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLConfiguration.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLConfiguration.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,9 @@ |
|  |  | \*/ |
|  |  | package org.xwiki.url.internal; |
|  |  |  |
|  |  | import java.util.Collections; |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import javax.inject.Inject; |
|  |  | import javax.inject.Provider; |
|  |  | import javax.inject.Singleton; |
| Expand Down  Expand Up | | @@ -60,4 +63,16 @@ public boolean useResourceLastModificationDate() |
|  |  | { |
|  |  | return this.configuration.get().getProperty(PREFIX + "useResourceLastModificationDate", true); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public List<String> getTrustedDomains() |
|  |  | { |
|  |  | return this.configuration.get().getProperty(PREFIX + "trustedDomains", Collections.emptyList()); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public boolean isTrustedDomainsEnabled() |
|  |  | { |
|  |  | return this.configuration.get().getProperty(PREFIX + "trustedDomainsEnabled", true); |
|  |  | } |
|  |  | } |

0

[...rl/internal/DefaultURLContextManager.java → ...rl/internal/DefaultURLContextManager.java](#diff-05cde76f25aa542f680d69b59b347f9a033f204707e337d13c4b0637cce1a64e "xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-api/src/main/java/org/xwiki/url/internal/DefaultURLContextManager.java → xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLContextManager.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/5251c02080466bf9fb55288f04a37671108f8096/xwiki-platform-core/xwiki-platform-url/xwiki-platform-url-default/src/main/java/org/xwiki/url/internal/DefaultURLContextManager.java)
Edit file

Delete file

File renamed without changes.

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5251c02`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F5251c02080466bf9fb55288f04a37671108f8096) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_4805d84a_20250115_093430.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-10309)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-10309)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-10309](/browse/XWIKI-10309)

# Phishing Through URL Redirection

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-10309 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Fix Version/s:**
  [13.3-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.3-rc-1 "13.3-rc-1 "), [12.10.7](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+12.10.7 "12.10.7 ")
* **Affects Version/s:**
  6.0-rc-1
* **Component/s:**
  [Old Core](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Old+Core%22 "Old Core ")
* **Labels:**
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_view](/issues/?jql=labels+%3D+attacker_view "attacker_view")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Development Priority:**
  Low
* **Difficulty:**
  Hard
* **Documentation:**
  <https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Configuration/#HTrusteddomains> <https://snippets.xwiki.org/xwiki/bin/view/Extension/Redirect#HDescription>
* **Documentation in Release Notes:**
  <https://www.xwiki.org/xwiki/bin/view/ReleaseNotes/Data/XWiki/13.3RC1/Entry006/> <https://www.xwiki.org/xwiki/bin/view/ReleaseNotes/Data/XWiki/12.10.7#HPreventredirectionstountrusteddomains>
* **Pull Request Status:**
  Pull Request accepted
* **Similar issues:**

#### Description

The xredirect parameter allows specifying any URL, including to an external host. Given that xredirect is an internal parameter controlling where to go after performing an action in XWiki, it should only accept local URLs.

To reproduce, open /bin/Main/UserDirectory?customize=true&action=reset& xredirect=<http://demo.testfire.net> and see the phishing site.

#### Attachments

#### Issue Links

is duplicated by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-14986](/browse/XWIKI-14986)
Don't redirect to external URLs

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[OIDC-105](/browse/OIDC-105)
Enforce redirection in case trusted domain are not properly configured

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

relates to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19994](/browse/XWIKI-19994)
Redirect parameter xredirect in login/logout can link to external site

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-jp55-vvmf-63mv)

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![sdumitriu](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Sergiu Dumitriu

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

#### Dates

Created:

06/May/14 22:50

Updated:

07/Sep/22 11:39

Resolved:

19/Apr/21 15:17

Date of First Response:

26/Feb/15 4:39 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


