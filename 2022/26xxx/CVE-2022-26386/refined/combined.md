=== Content from bugzilla.mozilla.org_bfdb0bbf_20250114_222604.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1752396)
* [XML](/show_bug.cgi?ctype=xml&id=1752396)

Closed
[Bug 1752396](/show_bug.cgi?id=1752396)
(CVE-2022-26386)

Opened 3 years ago
Closed 3 years ago

# Temporary file creation moved from /tmp/mozilla\_${USER}0 to /tmp. Potential security risk

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Temporary file creation moved from /tmp/mozilla\_${USER}0 to /tmp. Potential security risk

## Categories

### (Firefox :: Downloads Panel, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Downloads%20Panel#Downloads%20Panel)

Downloads Panel
▾

Firefox :: Downloads Panel
For issues with the Downloads Panel, the new download manager of Firefox that lives in the navigation toolbar.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Downloads%20Panel&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Downloads%20Panel&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Downloads%20Panel)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 91

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox97 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=unaffected) |
| firefox98 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=unaffected) |
| firefox99 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr91 | 98+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox97 |  | unaffected |
| firefox98 |  | unaffected |
| firefox99 |  | unaffected |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: attila, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/360f4ba3903437de2b8d45ca3370d545?d=mm&size=40)  [attila](/user_profile?user_id=700232)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0d674a646529b0795088d7a8075fbaea?d=mm&size=40)  [mak](/user_profile?user_id=240353)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1710933](/show_bug.cgi?id=1710933 "RESOLVED FIXED - LaunchWithApplication download should be moved to the \"Downloads\" folder when finished")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, privacy, sec-low, Whiteboard: [adv-esr91.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-26386

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-esr91.7+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1752396, r?mtigley](/attachment.cgi?id=9263163)  [3 years ago](#c6)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr91+](#c8 "3 years ago") | [Details](/attachment.cgi?id=9263163&action=edit) | [Review](/attachment.cgi?id=9263163) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9266125)  [3 years ago](#c11)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   490 bytes, text/plain |  | [Details](/attachment.cgi?id=9266125&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [attila](/user_profile?user_id=700232)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1752396#c0)• 3 years ago |
|  | |

User Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:91.0) Gecko/20100101 Firefox/91.0

Steps to reproduce:

Firefox used to create a folder /tmp/mozilla\_${USER}0 where it stored all temporary files (mostly downloads for display). Somewhen between 78 and 91 this was abolished and now all downloaded files end up in /tmp/.

This is a potential security risk!

/tmp/mozilla\_${USER}0 was 0700, i.e. nobody but the $USER could create files in it. Now, with files being created in /tmp, an attacker can not only guess a filename but, by monitoring web traffic, actually knows what file is created next. This is a variant of the insecure temporary file creation attack, where the attacker doesn't even has to guess.

Actual results:

Downloaded temporary files end up in /tmp

Expected results:

Downloaded temporary files should not end up in /tmp/but in a sub-directory that is owned by the user and write protected for everyone else.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1752396#c1)• 3 years ago |
|  | |

There was some related work in [bug 1726537](/show_bug.cgi?id=1726537 "VERIFIED FIXED - Unexpected extra folder created when downloading files") and [bug 1726732](/show_bug.cgi?id=1726732 "RESOLVED FIXED - Bug 1714107 regressed bug 377630 (Filename disclosure in /tmp)"), but both of those landed in the 93 cycle, so I would expect both 92 and 93 (and later releases) to still use the subfolder approach. Certainly the relevant code is still there. It seems you're reporting this with 91 (esr?), on Linux - is that right? If so, can you check:

1. if this reproduces with a clean Firefox profile ( <https://support.mozilla.org/en-US/kb/profile-manager-create-remove-switch-firefox-profiles> ; and if not, what configuration changes are needed to get into a state where this reproduces)
2. if this reproduces with a non-snap/flatpak build from mozilla.org (ie an official build, rather than one from your linux distro) ?

If you can reproduce in both cases, please can you provide more details about the exact steps you're using (ie how are you downloading what file)?

If you have time, you could probably narrow down when/how this broke using [mozregression](https://mozilla.github.io/mozregression/).

Flags: needinfo?(attila)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1752396#c2)• 3 years ago |
|  | |

This really does sound like a duplicate of [bug 1726732](/show_bug.cgi?id=1726732 "RESOLVED FIXED - Bug 1714107 regressed bug 377630 (Filename disclosure in /tmp)"), but that bug is supposedly fixed and the regression was not shipped. Would not have affected Firefox 91 though.

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a530438_1689)• 3 years ago |

Keywords: [privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a530496_1689)• 3 years ago |

Component: Untriaged → Downloads Panel

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1752396#c3)• 3 years ago |
|  | |

I think the answer is that this actually regressed with [bug 1710933](/show_bug.cgi?id=1710933 "RESOLVED FIXED - LaunchWithApplication download should be moved to the \"Downloads\" folder when finished"), not [bug 1714107](/show_bug.cgi?id=1714107 "RESOLVED FIXED - File opened by an application should be saved to user configured directory instead of always saving to Downloads folder"). I ran mozregression and confirmed. So 91 esr is affected but no other supported releases are.

Ryan, what do you want us to do here? Can we back out 1710933 on esr, or do a selective fix of 1710933, or do we just not address this on 91esr because it's ESR and any changes carry risk, and this is a sec-low?

Status: UNCONFIRMED → NEW
[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=unaffected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=unaffected)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=unaffected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Ever confirmed: trueFlags: needinfo?(attila) → needinfo?(ryanvm)Regressed by: [1710933](/show_bug.cgi?id=1710933 "RESOLVED FIXED - LaunchWithApplication download should be moved to the \"Downloads\" folder when finished")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1752396#c4)• 3 years ago |
|  | |

Depends on how simple the fix is :-). [Bug 1710933](/show_bug.cgi?id=1710933 "RESOLVED FIXED - LaunchWithApplication download should be moved to the \"Downloads\" folder when finished") doesn't backout cleanly from ESR91 and I honestly don't have a good way of assessing whether it'd be more risky trying to come up with a working backout vs. creating an actual fix. And I think the answer to that question would influence the answer as to whether or not we should try to address this or not.

Flags: needinfo?(ryanvm) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1752396#c5)• 3 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #4](/show_bug.cgi?id=1752396#c4 "VERIFIED FIXED - Temporary file creation moved from /tmp/mozilla_${USER}0 to /tmp. Potential security risk"))

> Depends on how simple the fix is :-). [Bug 1710933](/show_bug.cgi?id=1710933 "RESOLVED FIXED - LaunchWithApplication download should be moved to the \"Downloads\" folder when finished") doesn't backout cleanly from ESR91 and I honestly don't have a good way of assessing whether it'd be more risky trying to come up with a working backout vs. creating an actual fix. And I think the answer to that question would influence the answer as to whether or not we should try to address this or not.

AFAICT the backout only doesn't work because of the test it added, which got modified to include a single extra pref env push (see <https://hg.mozilla.org/releases/mozilla-esr91/log/tip/uriloader/exthandler/tests/mochitest/browser_launched_app_save_directory.js> and specifically <https://hg.mozilla.org/releases/mozilla-esr91/diff/4ebb5912bb0efbe2cccbc56887cdd5b580761461/uriloader/exthandler/tests/mochitest/browser_launched_app_save_directory.js> ). But the test file can just be removed. Then the remaining question would be if any other tests fail, which from a quick local check is not the case. So I guess I'll put up the backout patch.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1752396#c6)• 3 years ago |
|  | |

Attached file
[Bug 1752396, r?mtigley](attachment.cgi?id=9263163)
— [Details](attachment.cgi?id=9263163&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a1133474_600971)• 3 years ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1752396#c7)• 3 years ago |
|  | |

Comment on [attachment 9263163](/attachment.cgi?id=9263163 "Bug 1752396, r?mtigley") [[details]](/attachment.cgi?id=9263163&action=edit "Bug 1752396, r?mtigley")

[Bug 1752396](/show_bug.cgi?id=1752396 "VERIFIED FIXED - Temporary file creation moved from /tmp/mozilla_${USER}0 to /tmp. Potential security risk"), r?mtigley

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-low privacy issue; many distros ship esr-based builds
* **User impact if declined**: see above
* **Fix Landed on Version**: 93 (but this is a backout of a patch that is 91-specific)
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Nearly straight backout, minus the change in the test the backout deletes.
[Attachment #9263163](/attachment.cgi?id=9263163&action=edit "Bug 1752396, r?mtigley") -
Flags: approval-mozilla-esr91?

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a1184225_575867)• 3 years ago |

Has Regression Range: --- → yes

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1752396#c8)• 3 years ago |
|  | |

Comment on [attachment 9263163](/attachment.cgi?id=9263163 "Bug 1752396, r?mtigley") [[details]](/attachment.cgi?id=9263163&action=edit "Bug 1752396, r?mtigley")

[Bug 1752396](/show_bug.cgi?id=1752396 "VERIFIED FIXED - Temporary file creation moved from /tmp/mozilla_${USER}0 to /tmp. Potential security risk"), r?mtigley

Simple backout to fix a bug introduced by the original patch. Approved for 91.7esr.

[Attachment #9263163](/attachment.cgi?id=9263163&action=edit "Bug 1752396, r?mtigley") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1752396#c9)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/bb298c7c5613>

Status: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a1566102_75935)• 3 years ago |

Group: firefox-core-security → core-security-release

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a2825651_500622)• 3 years ago |

Flags: qe-verify+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a2827359_551058)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1752396#c10)• 3 years ago |
|  | |

I’ve managed to reproduce this issue with 91.6.0esr on Ubuntu 20.04.

Verified fixed with 91.7.0esr on Ubuntu 20.04.

Status: RESOLVED → VERIFIED
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1752396#c11)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9266125)
— [Details](attachment.cgi?id=9266125&action=edit)

AFAICT this affects Mac and Linux only.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a2939133_578488)• 3 years ago |

Whiteboard: [adv-esr91.7+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a3014998_578488)• 3 years ago |

Alias: CVE-2022-26386

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752396#a18354072_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1752396&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [:Gijs (he/him)](/user_profile?user_id=159069)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_dff76c19_20250114_222605.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-11

## Security Vulnerabilities fixed in Firefox ESR 91.7

Announced
March 8, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.7

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Firefox for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Firefox for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_32b21c23_20250114_222606.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-12

## Security Vulnerabilities fixed in Thunderbird 91.7

Announced
March 8, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Thunderbird verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Thunderbird would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Thunderbird for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Thunderbird for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


