=== Content from assura.atlassian.net_1d89e85b_20250114_231926.html ===


[![Custom logo](/wiki/download/attachments/32771/atl.site.logo?version=4&modificationDate=1649113047672&cacheVersion=1&api=v2)![Custom icon](/wiki/download/attachments/32771/atl.site.logo?version=4&modificationDate=1649113047672&cacheVersion=1&api=v2)](/wiki)SpacesApps[Templates](/wiki/templates)Create[![](/wiki/download/attachments/1809612809/VULNS?version=2&modificationDate=1651000263553&cacheVersion=1&api=v2)
## Vulnerability Research](/wiki/spaces/VULNS/overview?homepageId=1809613050)

* [All content](/wiki/spaces/VULNS/pages)
* [Calendars](/wiki/spaces/VULNS/calendars)
* [Space settings](/wiki/spaces/VULNS/settings/home)

Shortcuts

* [Assura Website](https://www.assurainc.com)[Assura Website](https://www.assurainc.com) This trigger is hidden
* [Assura Blog](https://www.assurainc.com)[Assura Blog](https://www.assurainc.com) This trigger is hidden

ContentResults will update as you type.

* [•Responsible Vulnerability Disclosure Policy](/wiki/spaces/VULNS/pages/1809416195/Responsible%2BVulnerability%2BDisclosure%2BPolicy)
* [•CVE-2021-43969 Quicklert for Digium Switchvox Version 10 Build 1043 – Blind SQL Injection with Out-of-Band Interaction (DNS)](/wiki/spaces/VULNS/pages/1808990227/CVE-2021-43969%2BQuicklert%2Bfor%2BDigium%2BSwitchvox%2BVersion%2B10%2BBuild%2B1043%2BBlind%2BSQL%2BInjection%2Bwith%2BOut-of-Band%2BInteraction%2BDNS)
* [•CVE-2021-43970 Quicklert for Digium Switchvox Version 10 Build 1043 – Arbitrary File Upload Results in Remote Code Execution](/wiki/spaces/VULNS/pages/1808924702/CVE-2021-43970%2BQuicklert%2Bfor%2BDigium%2BSwitchvox%2BVersion%2B10%2BBuild%2B1043%2BArbitrary%2BFile%2BUpload%2BResults%2Bin%2BRemote%2BCode%2BExecution)
* [•CVE-2022-26959 Northstar Club Management software version 6.3 - Full, Blind/Time-based SQL Injection](/wiki/spaces/VULNS/pages/1842675717/CVE-2022-26959%2BNorthstar%2BClub%2BManagement%2Bsoftware%2Bversion%2B6.3%2B-%2BFull%2BBlind%2BTime-based%2BSQL%2BInjection)
* [•CVE-2022-34002 Personnel Data Systems (PDS) Vista 7 - Local File Inclusion](/wiki/spaces/VULNS/pages/1843134469/CVE-2022-34002%2BPersonnel%2BData%2BSystems%2BPDS%2BVista%2B7%2B-%2BLocal%2BFile%2BInclusion)

[Vulnerability Research](/wiki/spaces/VULNS/overview?homepageId=1809613050)/CVE-2022-26959 Northstar Club Management software version 6.3 - Full, Blind/Time-based SQL Injection
# CVE-2022-26959 Northstar Club Management software version 6.3 - Full, Blind/Time-based SQL Injection

* ![](/wiki/aa-avatar/5ea0a6131f32260c13fc3c68)Nick Berrie
* ![](/wiki/aa-avatar/5c8fbe752a28712decf89b82)Joshua Cole
Owned by [Nick Berrie](/wiki/people/5ea0a6131f32260c13fc3c68?ref=confluence&src=profilecard), created with a templateLast updated: [Aug 31, 2022](/wiki/pages/diffpagesbyversion.action?pageId=1842675717&selectedPageVersions=5&selectedPageVersions=6) by [Joshua Cole](/wiki/people/5c8fbe752a28712decf89b82?ref=confluence&src=profilecard)3 min readLoading data...

## **Summary**

| **Name** | Full, Blind/Time-based SQL Injection in Northstar Club Management v6.3 |
| --- | --- |
| **Product** | Global Northstar Club Management Software |
| **Affected Versions** | v6.3 |
| **State** | Public |
| **Release Date** | 2022-01-08 |

## **Vulnerability**

| **Type** | SQL Injection |
| --- | --- |
| **Rule** | CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')  [CWE - CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') (4.16)](https://cwe.mitre.org/data/definitions/89.html) |
| **Remote?** | Yes |
| **Authentication Required?** | No |
| **CVSS v3 Vector** | AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H |
| **CVSS v3 Base Score** | 10 |
| **Exploit Available?** | No, but manually exploitable. |
| **CVE ID(s)** | [CVE -CVE-2022-26959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26959) |

## **Description**

Assura discovered two full (read/write) Blind/Time-based SQL injection vulnerabilities in the Northstar Club Management version 6.3 application. The vulnerabilities exist in the *userName* parameter of the *processlogin.jsp* page in the */northstar/Portal/* directoryand the *userID* parameter of the *login.jsp* page in the */northstar/iphone/* directory.

Exploitation of the SQL injection vulnerabilities allows full access to the database which contains critical data for organization’s that make full use of the software suite. This data includes ACH information, user profiles including name, address, ACH and/or credit card information, and much more.

## **Proof-of-Concept**

This proof-of-concept is a simple time-delay demonstration to preserve the security of the client environment in which this vulnerability was discovered.

A proxy is not required to prove this vulnerability, it can be proven simply in the web browser by using the same payload below in the username field.

1. Proxy web browser traffic on a local system using a tool such as Burp Suite.
2. Navigate to */northstar/Portal*.
3. Fill in the username and password fields with arbitrary data.
4. Submit the form.
5. In Burp Suite, find the POST request to */northstar/Portal/processlogin.jsp*.

   1. Right-click and select **Send to Repeater**
6. In the Repeater tab for the POST request, follow the steps below to demonstrate that you can sleep the database.

   1. Send the POST request as is to obtain the normal server response time in the bottom right corner of the Burp Suite response.

      Open ![](https://media-cdn.atlassian.com/file/1c2c506e-7cd8-4ed7-bfc5-6d6b027f6586/image/cdn?allowAnimated=true&client=030e74e0-7c76-473d-8ad1-46430d18618f&collection=contentId-1842675717&height=514&max-age=2592000&mode=full-fit&source=mediaCard&token=eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiIwMzBlNzRlMC03Yzc2LTQ3M2QtOGFkMS00NjQzMGQxODYxOGYiLCJhY2Nlc3MiOnsidXJuOmZpbGVzdG9yZTpjb2xsZWN0aW9uOmNvbnRlbnRJZC0xODQyNjc1NzE3IjpbInJlYWQiXX0sImV4cCI6MTczNjg5OTY0NSwibmJmIjoxNzM2ODk2NzY1fQ.F4V8VoU-Pr7upOB6rVxmnt8oJ6KPPbCLNwWKYieN-7k&width=760)
   2. Append the following payload to the *userName* parameter then send the POST request again.

      `'%2b(select*from(select(sleep(5)))a)%2b'`
   3. Observe that the server response time was delayed by 5 seconds, demonstrating that you successfully executed a sleep within the database.

      Open ![](https://media-cdn.atlassian.com/file/e18769b1-d73b-4c2b-8bc1-faa7b6ba489c/image/cdn?allowAnimated=true&client=030e74e0-7c76-473d-8ad1-46430d18618f&collection=contentId-1842675717&height=515&max-age=2592000&mode=full-fit&source=mediaCard&token=eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiIwMzBlNzRlMC03Yzc2LTQ3M2QtOGFkMS00NjQzMGQxODYxOGYiLCJhY2Nlc3MiOnsidXJuOmZpbGVzdG9yZTpjb2xsZWN0aW9uOmNvbnRlbnRJZC0xODQyNjc1NzE3IjpbInJlYWQiXX0sImV4cCI6MTczNjg5OTY0NSwibmJmIjoxNzM2ODk2NzY1fQ.F4V8VoU-Pr7upOB6rVxmnt8oJ6KPPbCLNwWKYieN-7k&width=760)
7. To further exploit this vulnerability, users can simply right-click the request in Burp Suite, select **Copy to File** then use that request file along with [sqlmap.py](https://github.com/sqlmapproject/sqlmap "https://github.com/sqlmapproject/sqlmap") with default configurations to fully compromise the database.

## **Exploit**

There is no pre-packaged exploit for this vulnerability although it can easily be reproduced manually or using publicly available tools such as [sqlmap.py](https://github.com/sqlmapproject/sqlmap "https://github.com/sqlmapproject/sqlmap").

## **Mitigation**

Global Northstar has removed the */northstar/iphone/login.jsp* from some client instances where this vulnerable Java Server Page was found. The company has yet to address the SQL injection vulnerability in the */northstar/Portal/processlogin.jsp* page demonstrated above.

Clients who find themselves vulnerable to this issue should:

1. Continue to insist that Global Northstar address the vulnerabilities within their software.
2. Deploy a Web Application Firewall (WAF) that has the ability to detect and block SQL injection attacks.

## **Credits**

This vulnerability was discovered by Nick Berrie ([https://www.linkedin.com/in/nick-berrie/](https://www.linkedin.com/in/nick-berrie/ "https://www.linkedin.com/in/nick-berrie/")), Technical Director of Assura’s Offensive Security Operations department at Assura, Inc.

## **References**

| **Vendor Page** | <https://www.globalnorthstar.com/> |
| --- | --- |
| **CVE Description** | [CVE -CVE-2022-26959](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26959) |

## **Timeline**

* 2022-03-08: Vulnerability discovered
* 2022-03-12: CVE #s issued by MITRE
* 2022-03-15: Vendor responds to Client acknowledging receipt of vulnerability notice.
* 2022-08-18: Vendor confirmed patch is in progress but not yet available. Assura will update when notified that a patch is available.
* 2022-08-31: Public disclosure later than 90 days in Assura’s responsible disclosure policy.

### Related Vulnerabilities

* Page:
  [CVE-2021-43969 Quicklert for Digium Switchvox Version 10 Build 1043 – Blind SQL Injection with Out-of-Band Interaction (DNS)](/wiki/spaces/VULNS/pages/1808990227/CVE-2021-43969%2BQuicklert%2Bfor%2BDigium%2BSwitchvox%2BVersion%2B10%2BBuild%2B1043%2BBlind%2BSQL%2BInjection%2Bwith%2BOut-of-Band%2BInteraction%2BDNS)
  (Vulnerability Research)
  + [sqli](/wiki/label/sqli)
  + [quicklert](/wiki/label/quicklert)
  + [vuln](/wiki/label/vuln)
* Page:
  [CVE-2021-43970 Quicklert for Digium Switchvox Version 10 Build 1043 – Arbitrary File Upload Results in Remote Code Execution](/wiki/spaces/VULNS/pages/1808924702/CVE-2021-43970%2BQuicklert%2Bfor%2BDigium%2BSwitchvox%2BVersion%2B10%2BBuild%2B1043%2BArbitrary%2BFile%2BUpload%2BResults%2Bin%2BRemote%2BCode%2BExecution)
  (Vulnerability Research)
  + [rfi](/wiki/label/rfi)
  + [vuln](/wiki/label/vuln)
  + [quicklert](/wiki/label/quicklert)
* Page:
  [CVE-2022-26959 Northstar Club Management software version 6.3 - Full, Blind/Time-based SQL Injection](/wiki/spaces/VULNS/pages/1842675717/CVE-2022-26959%2BNorthstar%2BClub%2BManagement%2Bsoftware%2Bversion%2B6.3%2B-%2BFull%2BBlind%2BTime-based%2BSQL%2BInjection)
  (Vulnerability Research)
  + [vuln](/wiki/label/vuln)
  + [northstar](/wiki/label/northstar)
  + [sqli](/wiki/label/sqli)
* Page:
  [CVE-2022-34002 Personnel Data Systems (PDS) Vista 7 - Local File Inclusion](/wiki/spaces/VULNS/pages/1843134469/CVE-2022-34002%2BPersonnel%2BData%2BSystems%2BPDS%2BVista%2B7%2B-%2BLocal%2BFile%2BInclusion)
  (Vulnerability Research)
  + [vuln](/wiki/label/vuln)
  + [pds](/wiki/label/pds)
  + [vista](/wiki/label/vista)

[vuln](/wiki/label/VULNS/vuln)[sqli](/wiki/label/VULNS/sqli)[northstar](/wiki/label/VULNS/northstar)

Copyright 2022 Assura, Inc. All rights reserved.

{"serverDuration": 40, "requestCorrelationId": "04d2e1661f814ed7b91b9512d497672b"}

