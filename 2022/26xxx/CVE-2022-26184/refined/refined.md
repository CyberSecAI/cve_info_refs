```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2022-26184",
      "root_cause": "The vulnerability stems from how Poetry, a Python package manager, handles git commands. When installing packages from Git repositories, Poetry directly passes user-controlled Git repository URLs to the `git clone` command. This allows for argument injection.",
      "weaknesses": [
        "Argument Injection"
      ],
      "impact": "An attacker can inject arbitrary git commands by providing a malicious git URL, leading to arbitrary code execution on the victim's machine.",
      "attack_vectors": "The attack vector involves a malicious git repository URL provided in a dependency specification. When Poetry attempts to clone this repository, the injected arguments are passed to git. For example, a malicious URL like '--upload-pack=payload.sh' will inject the upload-pack option to git.",
       "required_attacker_capabilities": "An attacker needs to control the git URL used in a project's dependency specifications, either by publishing a malicious package or by compromising a git repository."
    },
    {
       "cve_id": "CVE-2022-26184",
        "root_cause": "On Windows, the vulnerability is due to how Poetry resolves the `git` executable. It searches for `git.exe` in the current working directory before looking at the system's PATH variable. This is an untrusted search path vulnerability.",
        "weaknesses": [
         "Untrusted Search Path"
       ],
       "impact": "An attacker can place a malicious `git.exe` file in the current working directory, and it will be executed instead of the legitimate git command when Poetry is run in that directory, resulting in arbitrary code execution on the victim's machine.",
       "attack_vectors": "The attack vector involves placing a malicious `git.exe` file in a directory where a user runs Poetry to clone a git repo. This could be achieved through social engineering or by inserting it in a project's files.",
        "required_attacker_capabilities": "The attacker needs to have the ability to introduce a malicious `git.exe` executable in the same directory where a user is executing `poetry install` or a similar command that triggers git operations."
    }
  ]
}
```