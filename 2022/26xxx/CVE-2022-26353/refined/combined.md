=== Content from www.debian.org_e2e6c6fa_20250114_222111.html ===


---

[[Date Prev](msg00100.html)][[Date Next](msg00102.html)]
[[Thread Prev](msg00100.html)][[Thread Next](msg00102.html)]
[[Date Index](maillist.html#00101)]
[[Thread Index](threads.html#00101)]

# [SECURITY] [DSA 5133-1] qemu security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5133-1] qemu security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 9 May 2022 20:44:24 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220509204424.GA24666%40seger.debian.org)Â [20220509204424.GA24666@seger.debian.org](msg00101.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5133-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
May 09, 2022                          <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : qemu
CVE ID         : CVE-2022-26353 CVE-2022-26354 CVE-2021-4206
                 CVE-2021-4207 CVE-2022-0358

Multiple security issues were discovered in QEMU, a fast processor
emulator, which could result in denial of service or the execution of
arbitrary code.

For the stable distribution (bullseye), this problem has been fixed in
version 1:5.2+dfsg-11+deb11u2.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmJ5fBwACgkQEMKTtsN8
TjbjqhAAgVEMkmD0tl7hl9xZ5G8kCSQV4wLPII4g3a2BVUu4BSDWrc7KA/B6k/Sz
qrB3up4bHiFBkCAsX02gVWZrL9n7yM9Al0WYhDKB0lE4qcd7hATUxemwx2GGXCUY
SxM+8u+s2Np9SAKh/K0hl58dACIO/sO1uyDMTZaWdi3uEvit6+2MpLGbkXFfZp+m
FoQtdDLILwNjAnCu4gY1yPgvELWjhoQq5up/R83MCbuB6lij6CrSawi8xhIKhruH
wOLIEamamdS2LGRzeRf6WyghTGjmbrGbsavoDZtLFOSBfU0QomxDSNhn7yFySlU0
vApw5ThkB9HSkIuB7TOY/LxclibG915f6JtheqGAlUpIvtiAOU2+J4sCNamCOGW6
U0klFVysNMbXrhCs7HoezrQmHCBrrnvThjrb4XXgcgEk+WAMY0oJi1XwhP+rXvTU
26dA3AcyoO37rYBdFNW1EYohvA2Gf33LTDfVMYD92FZZweMf8WlCtrCVr9oJJnCY
iTGGFTpDD4v8BfxKbQHba6IAXRVPoCsNArJzEShfO7s/jD2QEGShCXFIk+EowUa3
5jJwA1wt8YWFF1i9wvcExZwdDjmLrIL+QnRmI9K/FmiZDTKUwG/PAk12ooYygDgp
Wa6hq0J006Sj9rGzgGcVSBFRyunajmebSeOs61PQjvM7QRVBelo=
=qmjs
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_a9cedf15_20250114_222109.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# QEMU: Multiple Vulnerabilities â€” GLSA **202208-27**

Multiple vulnerabilities have been discovered in QEMU, the worst of which could result in remote code execution (guest sandbox escape).

### Affected packages

| Package | **app-emulation/qemu** on all architectures |
| --- | --- |
| Affected versions | < **7.0.0** |
| Unaffected versions | >= **7.0.0** |

### Background

QEMU is a generic and open source machine emulator and virtualizer.

### Description

Multiple vulnerabilities have been discovered in QEMU.Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All QEMU users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/qemu-7.0.0"

```
### References

* [CVE-2020-15859](https://nvd.nist.gov/vuln/detail/CVE-2020-15859)
* [CVE-2020-15863](https://nvd.nist.gov/vuln/detail/CVE-2020-15863)
* [CVE-2020-16092](https://nvd.nist.gov/vuln/detail/CVE-2020-16092)
* [CVE-2020-35504](https://nvd.nist.gov/vuln/detail/CVE-2020-35504)
* [CVE-2020-35505](https://nvd.nist.gov/vuln/detail/CVE-2020-35505)
* [CVE-2020-35506](https://nvd.nist.gov/vuln/detail/CVE-2020-35506)
* [CVE-2020-35517](https://nvd.nist.gov/vuln/detail/CVE-2020-35517)
* [CVE-2021-3409](https://nvd.nist.gov/vuln/detail/CVE-2021-3409)
* [CVE-2021-3416](https://nvd.nist.gov/vuln/detail/CVE-2021-3416)
* [CVE-2021-3527](https://nvd.nist.gov/vuln/detail/CVE-2021-3527)
* [CVE-2021-3544](https://nvd.nist.gov/vuln/detail/CVE-2021-3544)
* [CVE-2021-3545](https://nvd.nist.gov/vuln/detail/CVE-2021-3545)
* [CVE-2021-3546](https://nvd.nist.gov/vuln/detail/CVE-2021-3546)
* [CVE-2021-3582](https://nvd.nist.gov/vuln/detail/CVE-2021-3582)
* [CVE-2021-3607](https://nvd.nist.gov/vuln/detail/CVE-2021-3607)
* [CVE-2021-3608](https://nvd.nist.gov/vuln/detail/CVE-2021-3608)
* [CVE-2021-3611](https://nvd.nist.gov/vuln/detail/CVE-2021-3611)
* [CVE-2021-3682](https://nvd.nist.gov/vuln/detail/CVE-2021-3682)
* [CVE-2021-3713](https://nvd.nist.gov/vuln/detail/CVE-2021-3713)
* [CVE-2021-3748](https://nvd.nist.gov/vuln/detail/CVE-2021-3748)
* [CVE-2021-3750](https://nvd.nist.gov/vuln/detail/CVE-2021-3750)
* [CVE-2021-3929](https://nvd.nist.gov/vuln/detail/CVE-2021-3929)
* [CVE-2021-3930](https://nvd.nist.gov/vuln/detail/CVE-2021-3930)
* [CVE-2021-3947](https://nvd.nist.gov/vuln/detail/CVE-2021-3947)
* [CVE-2021-4145](https://nvd.nist.gov/vuln/detail/CVE-2021-4145)
* [CVE-2021-4158](https://nvd.nist.gov/vuln/detail/CVE-2021-4158)
* [CVE-2021-4206](https://nvd.nist.gov/vuln/detail/CVE-2021-4206)
* [CVE-2021-4207](https://nvd.nist.gov/vuln/detail/CVE-2021-4207)
* [CVE-2021-20203](https://nvd.nist.gov/vuln/detail/CVE-2021-20203)
* [CVE-2021-20257](https://nvd.nist.gov/vuln/detail/CVE-2021-20257)
* [CVE-2021-20263](https://nvd.nist.gov/vuln/detail/CVE-2021-20263)
* [CVE-2022-0358](https://nvd.nist.gov/vuln/detail/CVE-2022-0358)
* [CVE-2022-26353](https://nvd.nist.gov/vuln/detail/CVE-2022-26353)
* [CVE-2022-26354](https://nvd.nist.gov/vuln/detail/CVE-2022-26354)

**Release date**

August 14, 2022

**Latest revision**

August 14, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [733448](https://bugs.gentoo.org/show_bug.cgi?id=733448)
* [736605](https://bugs.gentoo.org/show_bug.cgi?id=736605)
* [773220](https://bugs.gentoo.org/show_bug.cgi?id=773220)
* [775713](https://bugs.gentoo.org/show_bug.cgi?id=775713)
* [780816](https://bugs.gentoo.org/show_bug.cgi?id=780816)
* [792624](https://bugs.gentoo.org/show_bug.cgi?id=792624)
* [807055](https://bugs.gentoo.org/show_bug.cgi?id=807055)
* [810544](https://bugs.gentoo.org/show_bug.cgi?id=810544)
* [820743](https://bugs.gentoo.org/show_bug.cgi?id=820743)
* [835607](https://bugs.gentoo.org/show_bug.cgi?id=835607)
* [839762](https://bugs.gentoo.org/show_bug.cgi?id=839762)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from gitlab.com_d009698f_20250114_222108.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
abe300d9**

authored
Mar 08, 2022
by
**[![Jason Wang's avatar](https://secure.gravatar.com/avatar/84fc00b985b91bfa000fb92ba5dc5e688f6b687fd8c32e18629693e61015eb8d?s=96&d=identicon "Jason Wang")](/jasowang)
[Jason Wang](/jasowang)**

[Browse files](/qemu-project/qemu/-/tree/abe300d9d894f7138e1af7c8e9c88c04bfe98b37)

### virtio-net: fix map leaking on error during receive

```

Commit [bedd7e93](/qemu-project/qemu/-/commit/bedd7e93d01961fcb16a97ae45d93acf357e11f6 "virtio-net: fix use after unmap/free for sg") ("virtio-net: fix use after unmap/free for sg")
tries to fix the use after free of the sg by caching the virtqueue
elements in an array and unmap them at once after receiving the
packets, But it forgot to unmap the cached elements on error which
will lead to leaking of mapping and other unexpected results.

Fixing this by detaching the cached elements on error. This addresses
CVE-2022-26353.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/48f97a947d052fc8127943a3cc09e10f990a87f9821949c59f11104ffcf9c0ac?s=32&d=identicon)Victor Tom <vv474172261@gmail.com>
Cc: qemu-stable@nongnu.org
Fixes: CVE-2022-26353
Fixes: [bedd7e93](/qemu-project/qemu/-/commit/bedd7e93d01961fcb16a97ae45d93acf357e11f6 "virtio-net: fix use after unmap/free for sg") ("virtio-net: fix use after unmap/free for sg")
Reviewed-by: [![MST's avatar](https://secure.gravatar.com/avatar/9c8bd3b6373c44aa7d9db881fb056686b6e57ae5fce9b0acc4876583e5f7c47b?s=64&d=identicon "MST")](https://gitlab.com/mstredhat "mst@redhat.com")[Michael S. Tsirkin](https://gitlab.com/mstredhat "mst@redhat.com") <mst@redhat.com>
Signed-off-by: [![Jason Wang's avatar](https://secure.gravatar.com/avatar/84fc00b985b91bfa000fb92ba5dc5e688f6b687fd8c32e18629693e61015eb8d?s=64&d=identicon "Jason Wang")](https://gitlab.com/jasowang "jasowang@redhat.com")[Jason Wang](https://gitlab.com/jasowang "jasowang@redhat.com") <jasowang@redhat.com>
```

parent
[352998df](/qemu-project/qemu/-/commit/352998df1c53b366413690d95b35f76d0721ebed)

Loading

Loading

Loading

* [Changes
  1](/qemu-project/qemu/-/commit/abe300d9d894f7138e1af7c8e9c88c04bfe98b37)

[Hide whitespace changes](/qemu-project/qemu/-/commit/abe300d9d894f7138e1af7c8e9c88c04bfe98b37?action=show&controller=projects%2Fcommit&id=abe300d9d894f7138e1af7c8e9c88c04bfe98b37&namespace_id=qemu-project&project_id=qemu&w=1)
[Inline](/qemu-project/qemu/-/commit/abe300d9d894f7138e1af7c8e9c88c04bfe98b37?view=inline)
[Side-by-side](/qemu-project/qemu/-/commit/abe300d9d894f7138e1af7c8e9c88c04bfe98b37?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from security.netapp.com_c0fc025a_20250114_222110.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
Ã¦Â—Â¥Ã¦ÂœÂ¬Ã¨ÂªÂž

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2022 QEMU Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20220425-0003)

## March 2022 QEMU Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close Ã—

#### Subscribe to NTAP-20220425-0003 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20220425-0003 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close Ã—

#### Unsubscribe from NTAP-20220425-0003 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20220425-0003 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20220425-0003
**Version:**
1.0

**Last updated:**
04/25/2022

**Status:**
Final.

**CVEs:** CVE-2022-26353, CVE-2022-26354, CVE-2021-20257

Overview
#### Summary

Multiple NetApp products incorporate QEMU. QEMU versions through 6.2.0 are susceptible to vulnerabilities which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2021-20257](https://nvd.nist.gov/vuln/detail/CVE-2021-20257) | 6.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H |
| [CVE-2022-26353](https://nvd.nist.gov/vuln/detail/CVE-2022-26353) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-26354](https://nvd.nist.gov/vuln/detail/CVE-2022-26354) | 3.2 (LOW) | CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://lists.gnu.org/archive/html/qemu-devel/2021-02/msg07428.html>
* <https://lists.nongnu.org/archive/html/qemu-devel/2022-03/msg02438.html>

Affected Products
#### Affected Products

None.

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 6500N
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BeeGFS CSI Driver
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Data Sense
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Manager
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series BeeGFS Collection
* NetApp E-Series Host Collection
* NetApp E-Series Performance Analyzer
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire BIOS
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp SolidFire, Enterprise SDS & HCI Storage Node (Element Software)
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* NextGen API
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP Tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* SANtricity Storage Plugin for vCenter
* SANtricity Unified Manager
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapDrive for Unix
* SnapManager for Hyper-V
* SnapManager for Oracle
* SnapManager for Oracle Windows
* SnapManager for SAP
* SolidFire Storage Replication Adapter
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20220425-0003>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20220425 | Initial Public Release, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppÃ¢Â€Â™s current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Ã‚Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 Â©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.nongnu.org_7199a285_20250114_222109.html ===


| | **qemu-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=qemu-devel)

---

[[Date Prev](msg02437.html)][[Date Next](msg02439.html)][[Thread Prev](msg02435.html)][[Thread Next](msg02443.html)][[Date Index](index.html#02438)][[Thread Index](threads.html#02438)]

## [PATCH] virtio-net: fix map leaking on error during receive

---

| **From**: | Jason Wang |
| --- | --- |

| **Subject**: | [PATCH] virtio-net: fix map leaking on error during receive |
| **Date**: | Tue, 8 Mar 2022 13:56:42 +0800 |

---

```
Commit bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
tries to fix the use after free of the sg by caching the virtqueue
elements in an array and unmap them at once after receiving the
packets, But it forgot to unmap the cached elements on error which
will lead to leaking of mapping and other unexpected results.

Fixing this by detaching the cached elements on error. This addresses
CVE-2022-26353.

Reported-by: Victor Tom <vv474172261@gmail.com>
Cc: qemu-stable@nongnu.org
Fixes: bedd7e93d0196 ("virtio-net: fix use after unmap/free for sg")
Signed-off-by: Jason Wang <jasowang@redhat.com>
---
 hw/net/virtio-net.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/hw/net/virtio-net.c b/hw/net/virtio-net.c
index cf8ab0f8af..65b61c836c 100644
--- a/hw/net/virtio-net.c
+++ b/hw/net/virtio-net.c
@@ -1867,6 +1867,7 @@ static ssize_t virtio_net_receive_rcu(NetClientState *nc,
const uint8_t *buf,

 err:
     for (j = 0; j < i; j++) {
+        virtqueue_detach_element(q->rx_vq, elems[j], lens[j]);
         g_free(elems[j]);
     }

--
2.25.1

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg02443.html)] |
| --- | --- | --- |

* **[PATCH] virtio-net: fix map leaking on error during receive**,
  *Jason Wang*Â **<=**
  + **[Re: [PATCH] virtio-net: fix map leaking on error during receive](msg02443.html)**, *Michael S. Tsirkin*, 2022/03/08
    - **[Re: [PATCH] virtio-net: fix map leaking on error during receive](msg02444.html)**, *Jason Wang*, 2022/03/08

---

* Prev by Date:
  **[Re: Question about atomics](msg02437.html)**
* Next by Date:
  **[Re: [PATCH v5 00/15] vDPA shadow virtqueue](msg02439.html)**
* Previous by thread:
  **[Question about atomics](msg02435.html)**
* Next by thread:
  **[Re: [PATCH] virtio-net: fix map leaking on error during receive](msg02443.html)**
* Index(es):
  + [**Date**](index.html#02438)
  + [**Thread**](threads.html#02438)


