Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2022-26007

**Description:**

*   **Root Cause:** The vulnerability is due to a command injection flaw in the `factory` command within the console interface of the InHand Networks InRouter302. Specifically, the router's console uses the `system()` function to execute commands based on user input without proper sanitization.
*   **Weaknesses/Vulnerabilities:** The `factory` command, a leftover debug command, takes user-supplied input after the `iwpriv` keyword. This input is then directly used to construct a shell command, without sufficient checks, using `sprintf` and passed to `system()`, leading to command injection.
*   **Impact of Exploitation:** Successful exploitation allows an attacker to execute arbitrary OS commands with root privileges on the router. This can lead to a complete compromise of the device, including data theft, denial of service, or using it as a pivot point in a network attack.
*   **Attack Vectors:** An attacker can exploit the vulnerability by sending a crafted `factory` command via the router's console interface after authenticating as a privileged user.
*   **Required Attacker Capabilities/Position:**
    *   The attacker must have privileged user credentials for the router's console interface.
    *   Alternatively, an attacker could chain this vulnerability with another vulnerability (TALOS-2022-1472), which allows privilege escalation from a lower-privileged user to a privileged user.
    *   Network access to the router's management interface is required.

**Technical Details:**

*   The vulnerable code snippet involves the following:
    ```c
    int factory_functionality(undefined4 param_1,char *command_line_provided)
    {
    [...]
        if ((command_line_provided == (char *)0x0) || (*command_line_provided == '\0')) {
            is_command = -2;
        }
        else {
            second_arg = command_line_provided;
            first_arg = (char *)maybe_get_next_token(second_arg);
            [...]
            is_command = strncmp(first_arg,"iwpriv",6);
            if (is_command != 0) {
                return 0;
            }
            if (*second_arg == '\"') {
                second_arg = second_arg + 1;
            }
            second_arg_ = second_arg;
            [...]
            sprintf(command_line_buff,"iwpriv %s",second_arg_);
            system(command_line_buff);
        }
        [...]
    }
    ```
*   The `factory` command parses user input after the command itself. It expects the first token after `factory` to be the literal string `iwpriv`. The second token is then appended to `iwpriv ` and the resulting string is executed as a shell command using `system`.
*   The vulnerability can be triggered using the following command: `factory iwpriv \`/bin/sh$IFS1>&2\``

**Additional Notes:**

*   The vulnerability is present in InHand Networks InRouter302 V3.5.4.
*   The vendor has released a patch to address the vulnerability.
*   The CVSS score for this vulnerability is 9.1, however, when chained with TALOS-2022-1472, it reaches 9.9 due to the lower privileged access required.