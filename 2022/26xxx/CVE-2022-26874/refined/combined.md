=== Content from blog.sonarsource.com_90136952_20250115_093144.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Horde Webmail 5.2.22 - Account Takeover via Email

![](data:image/svg+xml;charset=utf-8...)![Simon Scannell photo]()![Simon Scannell photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/39a5ba27-50e6-46a9-915d-4c21a2205308/05747622-11af-457d-a883-8ad3b3fb7aaf_simon.jpg?w=1080&h=1080&auto=format&fit=crop)

Simon Scannell

Vulnerability Researcher

February 22, 2022

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We recently discovered a code vulnerability in Horde Webmail that can be used by attackers to take over email accounts by sending a malicious email.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/89bb4a56-cfb5-4249-9c2d-1f628b10adc6/cover-0a359c54-1bf6-4318-b255-5e9ffd2bba1b_RD-154%2BHorde%2BStored%2BXSS%25402x.png?w=2400&h=1256&auto=format&fit=crop)![We recently discovered a code vulnerability in Horde Webmail that can be used by attackers to take over email accounts by sending a malicious email.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/89bb4a56-cfb5-4249-9c2d-1f628b10adc6/cover-0a359c54-1bf6-4318-b255-5e9ffd2bba1b_RD-154%2BHorde%2BStored%2BXSS%25402x.png?w=2400&h=1256&auto=format&fit=crop)

Horde Webmail is a free, enterprise-ready, and browser-based communication suite developed by the Horde project. It is a popular webmail solution for universities and government agencies to exchange sensitive email messages on a daily basis. It is also shipped as part of the popular hosting solution cPanel that is used by many enterprises to manage their website.

We discovered a code vulnerability in Horde that allows an attacker to gain full access to the email account of a victim when it loads the preview of a harmless-looking email attachment. This gives the attacker access to all sensitive and perhaps secret information a victim has stored in their email account and could allow them to gain further access to the internal services of an organization.

Although we reported this vulnerability almost 6 months ago, there is currently no official patch available. Hence, we provide recommendations on how to mitigate this code vulnerability at the end of this blog post. This can be done easily by disabling the affected feature, which does not have a big impact on the usability of the software. By releasing the vulnerability and patch details, we hope to raise visibility and to enable administrators to secure their servers.

## Impact

This Stored XSS vulnerability was introduced with the commit [325a7ae](https://github.com/horde/Mime_Viewer/commit/325a7ae2663dd9c50e85fe515033454669f16f28 "325a7ae"), 9 years ago. It likely affects all the Horde instances deployed as of today and works under default configurations.

An attacker can craft an OpenOffice document that when transformed to XHTML by Horde for preview can execute a malicious JavaScript payload. The vulnerability triggers when a targeted user views an attached OpenOffice document in the browser. As a result, an attacker can steal all emails the victim has sent and received.

By default, Horde ships with an admin panel, which allows admins to execute arbitrary system commands on a Horde instance through the administrative interface. If an attacker succeeds in targeting an administrator with a personalized, malicious email, they could abuse this privileged access to take over the entire webmail server.

## Technical Details

In the following sections, we go into detail about an unusual XSS vulnerability that occurs due to a relaxed matching rule in an XSLT document.

### Background: OpenOffice documents and XSLT transformations

An OpenOffice document is a ZIP file containing XML documents, as well as other files needed to render a document, such as images. When Horde is asked to convert an OpenOffice document to HTML for its previsualization, it uses XSLT (eXtensible Stylesheet Language Transformations) to convert the XML files contained within the OpenOffice document.

XSLT documents are XML documents containing directives that instruct an XSLT processor on how to convert an input XML document into HTML markup. Let’s learn about some directives to gain a better understanding of XSLT and the root cause of the vulnerability discussed in this blog post.

The following snippet shows the declaration of an XSL stylesheet and uses the `<xsl:output>` directive to declare that `html` code will be produced by this stylesheet:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="html" />
...
```

Another important directive is the `<xsl:template>` directive. In the following example, the template is always processed as it is run when matched against the root element of an XML document:

```
<xsl:template match="/">
<html>
   <body>
       <h1>
           <xsl:value-of select="/BlogPost/Title"/>
       </h1>
   </body>
</html>
</xsl:template>
```

In the example of the `<xsl:template>` above, the `<html>`, `<body>` and `<h1>` tags are not processed and become a part of the final HTML document that is produced.

However, the value of the `<h1>` tag is dynamically generated. An XPath query is used to select the value of a Title element within the input XML document to be rendered. This is done with the `<xsl:value-of select="/BlogPost/Title"/>` directive.

Let’s assume the following XML document, which holds information about a blog post, was to be rendered:

```
<?xml version="1.0"?>
<BlogPost>
 <Title>A Blog Post about XSLT vulnerabilities</Title>
 <Authors>
   <Author>Foo</Author>
   <Author>Bar</Author>
 </Authors>
 <Content>Lorem Ipsum</Content>
</BlogPost>
```

In this case, the resulting HTML would look like the following, as the value of the `<h1>` tag is dynamically produced:

```
<html>
   <body>
       <h1>
           A Blog Post about XSLT vulnerabilities
       </h1>
   </body>
</html>
```

With this background knowledge in mind, let’s look at how an XSS vulnerability could arise when translating XML documents into HTML.

### Stored XSS vulnerability in crafted OpenOffice document

When Horde is asked to render an OpenOffice document for a user, it utilizes the `opendoc2xhtml.xsl` stylesheet file developed by the OpenOffice project. The following code snippet shows how this XSL document is loaded and then used to transform the attacker-controlled `content.xml` file:

**Horde/Mime/Viewer/Ooo.php**

```
       $xslt = new XSLTProcessor();
       $xsl = new DOMDocument();
       $xsl->load(realpath(__DIR__ . '/Ooo/export/xhtml/opendoc2xhtml.xsl'));
       $xslt->importStylesheet($xsl);
       $xslt->setParameter('http://www.w3.org/1999/XSL/Transform', array(
           'metaFileURL' => 'file://' . $tmpdir . 'meta.xml',
           'stylesFileURL' => 'file://' . $tmpdir . 'styles.xml',
           'java' => false,
       ));
       $xml = new DOMDocument();
       $xml->load(realpath($tmpdir . 'content.xml'));
       $result = $xslt->transformToXml($xml);
       if (!$result) {
           $result = libxml_get_last_error()->message;
       }

       return array(
           $this->_mimepart->getMimeId() => array(
               'data' => $result,
               'status' => array(),
               'type' => 'text/html; charset=UTF-8'
           )
       );
   }
```

Once the XML file has been converted, it is simply returned to the user **without** any further sanitization after the conversion from OpenOffice document to XHTML. This means that if an attacker could craft an OpenOffice document that leads to JavaScript injection in the resulting XHTML, then a XSS vulnerability occurs.

#### Finding an injection point in an XSLT stylesheet

In a previous example, we used the `<xsl:value-of>` directive to query the value of a user-controlled XML element and embed it into outputted HTML code. By default, this directive escapes its output and thus won’t allow XSS. The same escaping applies to attributes, which means we can’t inject attributes into HTML elements.

The vulnerability we discovered comes from an injection point where no escaping is applied, which is shown in the following snippet:

```
<xsl:template match="draw:object[math:math]">
   <math xmlns="http://www.w3.org/1998/Math/MathML">
       <xsl:apply-templates select="math:math/math:semantics/*" mode="math"/>
   </math>
</xsl:template>
```

The logic of it could be read as: for all `<draw:object>` elements which have a `<math:math>` element, apply all templates that have their mode attribute set to math. These templates should operate on all children of a `<math:semantics>` child. This is because of the `*` in the XPath query.

In practice, this means that this template is executed when the attacker-controlled OpenOffice document contains the following tags:

```
<draw:object><math:math><math:semantics>...</math:semantics></math:math></draw:object>
```

The following template operates on any child of the previously shown elements:

```
<xsl:template match="*" mode="math">
   <xsl:element name="{local-name()}" namespace="http://www.w3.org/1998/Math/MathML">
       <xsl:apply-templates select="@*|node()" mode="math"/>
   </xsl:element>
</xsl:template>
```

It uses the `<xsl:elements>` directive to dynamically create a new HTML tag. The name of the tag becomes the tag that is currently operated on, which is determined by the `local-name()` function. As the parent template passed any element to this template, as instructed by the `*` in the XPath query, an attacker can create arbitrary HTML elements, including `<script>` tags.

The ability to create arbitrary HTML tags leads to the ability of an attacker to craft an OpenOffice document containing the following markup:

```
<draw:object><math:math><math:semantics><p>XSS payload: </p><script>alert(‘xss’);</script>
```

When a victim then views such an OpenOffice document attachment, the XSS payload triggers and gives an attacker full access to their session. This means the attacker can steal all emails and, in a worst-case scenario, even execute arbitrary system commands if the victim has the administrator role.

### Patch

As there is no official patch available at the time of writing, we recommend disabling the rendering of OpenOffice attachments. To do so, administrators can edit the `config/mime_drivers.php` file in the content root of their Horde installation.

As shown in the snippet below, add the `'disable' => true` configuration option to the OpenOffice mime handler:

```
/* OpenOffice.org/StarOffice document display. */
'ooo' => array(
   'disable' => true,      // <---- HERE
   'handles' => array(
       'application/vnd.stardivision.calc',
       'application/vnd.stardivision.draw',

       // ...
```

Users will still be able to download the OpenOffice documents and view them locally, but Horde won’t attempt to render it in the browser. With this, the vulnerable feature is not used and the Horde instance is protected against exploitation of this vulnerability.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-08-26 | We report the XSS issue to the vendor and inform them of our 90-day disclosure policy |
| 2021-08-31 | The vendor confirms the vulnerability |
| 2021-09-23 | We ask the Vendor for a status update (no reply) |
| 2021-10-28 | We ask the Vendor for a status update (no reply) |
| 2022-02-17 | We inform the vendor of the upcoming release |

## Summary

In this blog post, we presented an unusual XSS vulnerability in the Horde webmailer. The vulnerability allows an attacker to craft a malicious OpenOffice document that, when previewed as an email attachment, enables an attacker to steal all emails from the victim. Since there is no official patch available yet, we highly recommend all Horde users to disable the affected feature as described in this blog post.

In general, we recommend developers to always sanitize HTML documents after they have been produced by XSLT rendering, especially when the conversion is performed by a third party library or stylesheet. The most modern way of doing this would be to use a library such as [DOMPurify](https://github.com/cure53/DOMPurify "DOMPurify") to ensure that only secure HTML elements are produced by the OpenOffice document.

## Related Blog Posts

* [Zimbra Webmail compromise via email](https://blog.sonarsource.com/zimbra-webmail-compromise-via-email "Zimbra Webmail compromise via email")
* [MyBB from Stored XSS to RCE](https://blog.sonarsource.com/mybb-stored-xss-to-rce "MyBB from Stored XSS to RCE")
* [SmartStoreNET - Malicious Message leading to E-Commerce Takeover](https://blog.sonarsource.com/smartstorenet-malicious-message-leading-to-e-commerce-takeover "SmartStoreNET - Malicious Message leading to E-Commerce Takeover")
* [WordPress Stored XSS vulnerability](https://blog.sonarsource.com/wordpress-stored-xss-vulnerability "WordPress Stored XSS vulnerability")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from lists.debian.org_306378df_20250115_093148.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3924-1] php-horde-mime-viewer security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3924-1] php-horde-mime-viewer security update
* *From*: Tobias Frost <tobi@debian.org>
* *Date*: Sat, 19 Oct 2024 17:44:10 +0200
* *Message-id*: <[[🔎]](/msgid-search/ZxPTysAtpBvQaxyg%40isildor2.loewenhoehle.ip) [ZxPTysAtpBvQaxyg@isildor2.loewenhoehle.ip](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3924-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Tobias Frost
October 19, 2024                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : php-horde-mime-viewer
Version        : 2.2.4+debian0-2~deb11u1
CVE ID         : CVE-2022-26874
Debian Bug     :

It was discovered that there was a potential XSS vulnerability in
php-horde-mime-viewer, a MIME viewer library for the Horde groupware
platform.

For Debian 11 bullseye, this problem has been fixed in version
2.2.4+debian0-2~deb11u1.

We recommend that you upgrade your php-horde-mime-viewer packages.

For the detailed security status of php-horde-mime-viewer please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/php-horde-mime-viewer>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpWeLvY2BSq8.pgp)**

*Description:* PGP signature

---



=== Content from lists.debian.org_570b8617_20250115_093146.html ===


---

[[Date Prev](msg00006.html)][[Date Next](msg00008.html)]
[[Thread Prev](msg00006.html)][[Thread Next](msg00008.html)]
[[Date Index](maillist.html#00007)]
[[Thread Index](threads.html#00007)]

# [SECURITY] [DLA 3045-1] php-horde-mime-viewer security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3045-1] php-horde-mime-viewer security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Mon, 6 Jun 2022 12:21:52 -0400 (EDT)
* *Message-id*: <[[🔎]](/msgid-search/165453236045.190297.14014696724866828637%40copycat) [165453236045.190297.14014696724866828637@copycat](msg00007.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3045-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
June 06, 2022                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : php-horde-mime-viewer
Version        : 2.2.1-1+deb9u1
CVE ID         : CVE-2022-26874

It was discovered that there was a potential XSS vulnerability in
php-horde-mime-viewer, a MIME viewer library for the Horde groupware
platform.

For Debian 9 "Stretch", this problem has been fixed in version
2.2.1-1+deb9u1.

We recommend that you upgrade your php-horde-mime-viewer packages.

For the detailed security status of php-horde-mime-viewer please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/php-horde-mime-viewer>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmKeKQQACgkQHpU+J9Qx
HlgXvA/9GHhVUXkQ9kWKrP/UzO/PDT1mLBpeuGm4VxUvisc7Zit0Ta1HWrxBM9Ct
t1JxurEEe4c/Ss+FmeQq2f5Dv9dp9XrKT9xKompWv0DBT0RwevLOTa0Hyz7GoPDU
zSy2Vlhsonup3D9EpKqKLTxVc2ehsp2ztTLXMfZKql9ZhsARiS3ttHdNbHmhFTNx
PzNsP2okbmXBMDBrn1c1/iq5silrjXmIfXuYAlzVvIfbVrGISLwnd49IK5ruOG9E
f+NFe6KQqTewn61YzX/hHRuKrpEmkGR3ZU35gCP0icQzjXM7HT2+wdPxw9u1w9+H
lUZngGYh4nxpen1zxbO7H2KbtNlyHiD9Ile/Zi5UKbs9cAN2Y2Nxwavckt3fsJqM
alw4RHf9LoDuMNsoRtamWenQESf9aMJwApkcnU3mMoPbLLAMT3Fzr6dmVgMgBaiv
mdL0x9KECIrOlYE8JLPdmd/CctWUb7RsB6gEEj0+1JWHpWvCOF441yvVMda0RVcv
3ioJS8WPBGtyaAWjfsH24InynEEK4uheHCZIxEZsDpPp4o5F+f0pH2kS0B4+lYvK
89MgIRgsmySSvDkaRBbdltW874okytpXF5NVX+lTsnQyyQCE9zY4VfQ+xxrq5D8u
ZfqAA4xYGEX8Dv/mkC2ZMukGtr9dVQYgqEZwRgApL4ULfHxSvWI=
=vM3h
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_040bb49e_20250115_093145.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhorde%2FMime_Viewer%2Fcommit%2F02b46cec1a7e8f1a6835b628850cd56b85963bb5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhorde%2FMime_Viewer%2Fcommit%2F02b46cec1a7e8f1a6835b628850cd56b85963bb5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=horde%2FMime_Viewer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[horde](/horde)
/
**[Mime\_Viewer](/horde/Mime_Viewer)**
Public

* [Notifications](/login?return_to=%2Fhorde%2FMime_Viewer) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fhorde%2FMime_Viewer)
* [Star
   1](/login?return_to=%2Fhorde%2FMime_Viewer)

* [Code](/horde/Mime_Viewer)
* [Pull requests
  0](/horde/Mime_Viewer/pulls)
* [Actions](/horde/Mime_Viewer/actions)
* [Projects
  0](/horde/Mime_Viewer/projects)
* [Security](/horde/Mime_Viewer/security)
* [Insights](/horde/Mime_Viewer/pulse)

Additional navigation options

* [Code](/horde/Mime_Viewer)
* [Pull requests](/horde/Mime_Viewer/pulls)
* [Actions](/horde/Mime_Viewer/actions)
* [Projects](/horde/Mime_Viewer/projects)
* [Security](/horde/Mime_Viewer/security)
* [Insights](/horde/Mime_Viewer/pulse)

## Commit

[Permalink](/horde/Mime_Viewer/commit/02b46cec1a7e8f1a6835b628850cd56b85963bb5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[jan] Fix XSS vulnerability in Open Document mime viewer with differe…

[Browse files](/horde/Mime_Viewer/tree/02b46cec1a7e8f1a6835b628850cd56b85963bb5)
Browse the repository at this point in the history

```
…nt code path (Reported by: Mahdi Pasche <pasche@b1-systems.de>).
```

* Loading branch information

[![@yunosh](https://avatars.githubusercontent.com/u/379318?s=40&v=4)](/yunosh)

[yunosh](/horde/Mime_Viewer/commits?author=yunosh "View all commits by yunosh")
committed
Mar 2, 2022

1 parent
[2157555](/horde/Mime_Viewer/commit/21575555b1757b5508f18b567d3c6a7d3d1b5ddf)

commit 02b46ce

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**7 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* doc/Horde/Mime/Viewer

  + doc/Horde/Mime/Viewer/changelog.yml
    [changelog.yml](#diff-1efdb5cfd758e0d71cf1daaad501172573528b778cc4f4ccc529d58b8baef95b)
* lib/Horde/Mime/Viewer

  + lib/Horde/Mime/Viewer/Ooo.php
    [Ooo.php](#diff-918c21401143f590536e0f042103090ef13f9f7d24188b5420327147525dd00e)

## There are no files selected for viewing

5 changes: 3 additions & 2 deletions

5
[doc/Horde/Mime/Viewer/changelog.yml](#diff-1efdb5cfd758e0d71cf1daaad501172573528b778cc4f4ccc529d58b8baef95b "doc/Horde/Mime/Viewer/changelog.yml")

Show comments

[View file](/horde/Mime_Viewer/blob/02b46cec1a7e8f1a6835b628850cd56b85963bb5/doc/Horde/Mime/Viewer/changelog.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,8 +8,9 @@ |
|  |  | license: |
|  |  | identifier: LGPL-2.1 |
|  |  | uri: http://www.horde.org/licenses/lgpl21 |
|  |  | notes: |+ |
|  |  |  |
|  |  | notes: | |
|  |  | [jan] Fix XSS vulnerability in Open Document mime viewer with different code path (Reported by: Mahdi Pasche <pasche@b1-systems.de>). |
|  |  | |+ |
|  |  | 2.2.3: |
|  |  | api: 2.1.0 |
|  |  | state: |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[lib/Horde/Mime/Viewer/Ooo.php](#diff-918c21401143f590536e0f042103090ef13f9f7d24188b5420327147525dd00e "lib/Horde/Mime/Viewer/Ooo.php")

Show comments

[View file](/horde/Mime_Viewer/blob/02b46cec1a7e8f1a6835b628850cd56b85963bb5/lib/Horde/Mime/Viewer/Ooo.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -98,7 +98,10 @@ protected function \_render() |
|  |  | } elseif ($file['name'] == 'content.xml') { |
|  |  | return array( |
|  |  | $this->\_mimepart->getMimeId() => array( |
|  |  | 'data' => str\_replace(array\_keys($tags), array\_values($tags), $content), |
|  |  | 'data' => Horde\_Text\_Filter::filter( |
|  |  | str\_replace(array\_keys($tags), array\_values($tags), $content), |
|  |  | 'xss' |
|  |  | ), |
|  |  | 'status' => array(), |
|  |  | 'type' => 'text/html; charset=UTF-8' |
|  |  | ) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `02b46ce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhorde%2FMime_Viewer%2Fcommit%2F02b46cec1a7e8f1a6835b628850cd56b85963bb5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_3d104474_20250115_093147.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3089-1] php-horde-mime-viewer security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3089-1] php-horde-mime-viewer security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Wed, 31 Aug 2022 08:21:34 +0100
* *Message-id*: <[[🔎]](/msgid-search/166192995307.493764.15891875415268597636%40copycat) [166192995307.493764.15891875415268597636@copycat](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3089-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
August 31, 2022                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : php-horde-mime-viewer
Version        : 2.2.2-3+deb10u1
CVE ID         : CVE-2022-26874

It was discovered that there was a potential XSS vulnerability in
php-horde-mime-viewer, a MIME viewer library for the Horde groupware
platform.

For Debian 10 buster, this problem has been fixed in version
2.2.2-3+deb10u1.

We recommend that you upgrade your php-horde-mime-viewer packages.

For the detailed security status of php-horde-mime-viewer please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/php-horde-mime-viewer>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmMPCd4ACgkQHpU+J9Qx
HlgCSw/9GByZFew7Zts80STlVlIZnOd9AvevjphlkO5kl8HrhCOUmATOxAaq/Ru2
lLv7/SgXVKrw0bvIk67zQxFsm+dARFk5l/Mj3csnrx2uF+R2qZDD1oXGhUqXxZVc
AnenB+AF7N5CuyrsEo95tN16nTBlT7nfUaSQb4gsgdBgKNT7k2R4XemBvfpP6V0Y
kl3HVMnD/COz43MEQ+C324xBuMxFdHWWFB03duJK0Fk9xNC6VjQtnNphJzOp/Fwp
Y3KS45cAWfanffoAzsxardmUpeFeSNITBDlYGwFMZkMigFz0ye2R3rtBX7yM7x0t
defxEj9F0joWX7a20jUt45aK388vrftlr0k0/h/Z8fadJp1RRQ3iGzg5kwi2Uaa/
rK/t21OTTZAWVG44KfSO5bQjWnVsEUcQAdWw8dIyVtjMkTKBpjUYcWWVE1TUWJt8
UsSvktTknHN+gHozOa0uCFvljKzHBp3rt3pVHMzfBajeZeNX5u07ThQ9XAyWWHPw
tVYUyXfniuFZ1uJQHjdNzyTnIM3/g6H4zVecf62RGeXPFbuLBC4yk8q5LTH0Jq0A
xps5A+eq3bYizZ08qBFua1M+bKwNEVqK2GUhFQvMizaVZJnISMX/ZnPh60i39dQb
DG/yVyZvSAKsev69yrhbXvcugKQ/Ir069dTMjW8LeK/12gvjrKw=
=Nr2m
-----END PGP SIGNATURE-----

```

---


