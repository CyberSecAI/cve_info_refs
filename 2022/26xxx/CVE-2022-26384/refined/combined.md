=== Content from bugzilla.mozilla.org_0bf0576c_20250115_092340.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1744352)
* [XML](/show_bug.cgi?ctype=xml&id=1744352)

Closed
[Bug 1744352](/show_bug.cgi?id=1744352)
(CVE-2022-26384)

Opened 3 years ago
Closed 3 years ago

# Sandboxed iFrame XSS - javascript URI's run with target \_blank

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Sandboxed iFrame XSS - javascript URI's run with target \_blank

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

99 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox97 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified) |
| firefox99 | [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 98+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox97 |  | wontfix |
| firefox98 | + | verified |
| firefox99 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: emcmanus, Assigned: nika)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/681c8259984f9962924c3da2775799c7?d=mm&size=40)  [emcmanus](/user_profile?user_id=697152)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### ( [URL](https://emcmanus.github.io/xss.html "https://emcmanus.github.io/xss.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1744490](/show_bug.cgi?id=1744490 "RESOLVED DUPLICATE - iframe sandbox bypass with javascript URL and target _blank")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[emcmanus.github.io/xss.html](https://emcmanus.github.io/xss.html "https://emcmanus.github.io/xss.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1756999](/show_bug.cgi?id=1756999 "NEW - Empty address bar is displayed instead of blocking after Executing javascript in the domain of a sandboxed iframe"), [CVE-2022-29911](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive")

[CVE-2020-15653](/show_bug.cgi?id=1521542 "VERIFIED FIXED - iframe sandbox can be escaped with rel=noopener/noreferrer when \"allow-popups\" specified, or in general with fission")

## Details

### (Keywords: csectype-sop, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey][adv-main98+][adv-esr91.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-26384

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey][adv-main98+][adv-esr91.7+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c12 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a5947480_75935 "3 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug](/attachment.cgi?id=9262937)  [3 years ago](#c7)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c19 "3 years ago") | [Details](/attachment.cgi?id=9262937&action=edit) | [Review](/attachment.cgi?id=9262937) |
| --- | --- | --- |
| [Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug](/attachment.cgi?id=9262939)  [3 years ago](#c8)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#a7027791_24572 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#a7097709_75935 "3 years ago") | [Details](/attachment.cgi?id=9262939&action=edit) | [Review](/attachment.cgi?id=9262939) |
| [Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8](/attachment.cgi?id=9265068)  [3 years ago](#c17)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr91+](#c25 "3 years ago") | [Details](/attachment.cgi?id=9265068&action=edit) | [Review](/attachment.cgi?id=9265068) |
| [advisory.txt](/attachment.cgi?id=9266088)  [3 years ago](#c31)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   306 bytes, text/plain |  | [Details](/attachment.cgi?id=9266088&action=edit) |
| [advisory.txt](/attachment.cgi?id=9266126)  [3 years ago](#c32)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   298 bytes, text/plain |  | [Details](/attachment.cgi?id=9266126&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1744352#c0)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1744352&comment_id=15682402 "1 revision") |
|  | |

(Thank you Firefox developers for all your hard work! The world needs Firefox.)

I believe the following is an XSS vulnerability present in the current release channel. By specifying target="blank" you can execute javascript in the domain of a sandboxed iframe, even though allow-scripts is not specified.

This behavior is blocked by Edge, Chrome, and Safari. Demo: <https://emcmanus.github.io/xss.html>

Expected result:

* Sandboxed iframes should not execute JS unless `allow-scripts` is specified
* Firefox should block the `javascript:` uri
* Firefox behavior should match other browsers

Actual result:

* Javascript runs in the current domain, even though `allow-scripts` is not specified
* Edge, Safari and Chrome block this behavior
* It does not matter whether you use src or srcdoc

I believe a related bug was patched in Firefox 79: <https://www.mozilla.org/en-US/security/advisories/mfsa2020-30/#CVE-2020-15653>

Here is the source of the demo:

```
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='content-type' content='text/html; charset=UTF-8'>
  </head>
  <body>
    <iframe sandbox="allow-same-origin allow-popups" srcdoc="<a href=&quot;javascript:alert(document.domain)&quot; target=&quot;_blank&quot;>click me</a>"></iframe>
  </body>
</html>

```
Flags: sec-bounty?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a206910_428608)• 3 years ago |

Group: firefox-core-security → core-securityType: task → defectComponent: Security → DOM: SecurityKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[wsec-xss](/buglist.cgi?keywords=wsec-xss&resolution=---)Product: Firefox → CoreWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1744352#c2)• 3 years ago |
|  | |

Reminds me of [bug 1738418](/show_bug.cgi?id=1738418 "RESOLVED FIXED - <embed/object> frames bypass parent's CSP `sandbox` header directive"), I'll take this.

Assignee: nobody → fbraun

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1744352#c3)• 3 years ago |
|  | |

I started looking at the patch from [bug 1521542](/show_bug.cgi?id=1521542 "VERIFIED FIXED - iframe sandbox can be escaped with rel=noopener/noreferrer when \"allow-popups\" specified, or in general with fission") and came to the conclusion that this is likely fixed in `ContentChild::ProvideWindowCommon()` too, but I also wanted to start with a test to ensure this is the right direction..

However, when looking at existing tests in dom/html/test. It's a bit tricky to make this work with calling `ok()` (or `postMessage`) on the opener, since the new, `_blank` context does not seem to have an opener?!

I'll keep looking.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a211817_428608)• 3 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1744352#c4)• 3 years ago |
|  | |

It's hard to tell simply by comparing to chrome behavior because they always block `javascript:` links targeted at a new window regardless of sandboxing.

Things that could be OK:

* the sandbox has allow-same-origin (a running script being same-origin could be fine)
* the sandbox allows popups

Things we get wrong:

* the sandbox does NOT have `allow-popups-to-escape-sandbox`
* the sandbox does NOT have `allow-scripts`

Javascript urls are weird creatures and this bug might just beunique to that case, but to be sure: do we have tests that ensure popups from a sandbox are themselves properly sandboxed and, with this collection of attributes, can't run scripts?

> However, when looking at existing tests in dom/html/test. It's a bit tricky to make this work with calling ok() (or postMessage) on the opener, since the new, \_blank context does not seem to have an opener?!

See [bug 1522083](/show_bug.cgi?id=1522083 "RESOLVED FIXED - Make target=_blank on a/area elements imply rel=noopener by default"), and also

<https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-target>

<https://github.com/whatwg/html/issues/4078>

You should be able to set an explicit `rel="opener"`

Group: core-security → dom-core-securityComponent: DOM: Security → DOM: Core & HTML

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1744352#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1744352&comment_id=15686065 "1 revision") |
|  | |

> do we have tests that ensure popups ...

And I guess we need to make sure window.open() and target=\_blank are treated the same wrt inheriting the sandbox properties.

These cases should all be covered by WPT, except the case in this bug because we're the only browser engine left that opens javascript links in a new window so no point in writing cross-browser tests for it. (Maybe Internet Explorer still does, too?). Even Brendan's own browser doesn't try to bring that behavior back -- time to throw in the towel? Would certainly stop a bunch of unique-to-Firefox exploit attempts.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a2638580_455480)• 3 years ago |

Severity: -- → S3

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1744352#c6)• 3 years ago |
|  | |

Nika has looked at this, and wrote a patch. I think she's trying to figure out exactly how to test it.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1744352#c7)• 3 years ago |
|  | |

Attached file
[Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug](attachment.cgi?id=9262937)
— [Details](attachment.cgi?id=9262937&action=edit)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1744352#c8)• 3 years ago |
|  | |

Attached file
[Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug](attachment.cgi?id=9262939)
— [Details](attachment.cgi?id=9262939&action=edit)

Depends on D138209

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a5789401_406194)• 3 years ago |

Assignee: fbraun → nika

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1744352#c9)• 3 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/b3a8f99f0044f5a4c7c44878d67c3de880b68340>

<https://hg.mozilla.org/integration/autoland/rev/1a7d29ce984cc34ea7c3932f7b11976794177647>

Backed out for causing failures at test\_javascript\_sandboxed\_popup.html:

<https://hg.mozilla.org/integration/autoland/rev/80065f2457a7024113287320b483adf15bce8752>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel&revision=1a7d29ce984cc34ea7c3932f7b11976794177647&selectedTaskRun=Q5xgKgmZROGoqISWEoL9Sg.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=367256583&repo=autoland>

```
TEST-UNEXPECTED-FAIL | docshell/test/mochitest/test_javascript_sandboxed_popup.html | Test timed out. -

```

after start.

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a5856392_534482)• 3 years ago |

Flags: needinfo?(nika)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1744352#c10)• 3 years ago |
|  | |

Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug

<https://hg.mozilla.org/integration/autoland/rev/a4c83abc85ffa4eaeba778334e80f7fd07a7a62c>

<https://hg.mozilla.org/mozilla-central/rev/a4c83abc85ff>

Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug

<https://hg.mozilla.org/integration/autoland/rev/1d92ad59b6416da7c2a34e7c98d393c0e7725a8c>

<https://hg.mozilla.org/mozilla-central/rev/1d92ad59b641>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 99 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a5947480_75935)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B)
[tracking-firefox99](/buglist.cgi?f1=cf_tracking_firefox99&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B)Flags: in-testsuite+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1744352#c11)• 3 years ago |
|  | |

The patch landed in nightly and beta is affected.

:nika, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(nika)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6363996_553429)• 3 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] → [reporter-external] [client-bounty-form][post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6984034_1689)• 3 years ago |

See Also: → [CVE-2020-15653](/show_bug.cgi?id=1521542 "VERIFIED FIXED - iframe sandbox can be escaped with rel=noopener/noreferrer when \"allow-popups\" specified, or in general with fission")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1744352#c12)• 3 years ago |
|  | |

We rated this "moderate" incorrectly (thinking of CSP bypasses), but sandboxing is more fundamentally and relied on more broadly on the web. raising to sec-high

Flags: sec-bounty? → sec-bounty+Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[wsec-xss](/buglist.cgi?keywords=wsec-xss&resolution=---) → [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1744352#c13)• 3 years ago |
|  | |

This needs an uplift to beta and ESR. We're running out of betas (this might be the last week?), please do it soon.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1744352#c14)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1744352&comment_id=15787776 "1 revision") |
|  | |

Comment on [attachment 9262937](/attachment.cgi?id=9262937 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") [[details]](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Note, the patch applies to esr91 with --fuzz=3
* **User impact if declined**: Executing javascript in the domain of a sandboxed iframe, even though allow-scripts is not specified
* **Fix Landed on Version**: 99
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Passing around the flags from the original browsing context to the new one should be relatively safe.

### Beta/Release Uplift Approval Request

* **User impact if declined**:
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String changes made/needed**: NA
[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-esr91?
[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6987024_39966)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1744352#c15)• 3 years ago |
|  | |

Comment on [attachment 9262937](/attachment.cgi?id=9262937 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") [[details]](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug

sorry, fuzz didn't do the right thing here after all

[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-esr91?
[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6988900_39966)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1744352#c16)• 3 years ago |
|  | |

Comment on [attachment 9262937](/attachment.cgi?id=9262937 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") [[details]](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug

### Beta/Release Uplift Approval Request

* **User impact if declined**: Executing javascript in the domain of a sandboxed iframe, even though allow-scripts is not specified

(This patch applies cleanly to beta, but does not to esr)

* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Passing around the flags from the original browsing context to the new one should be relatively safe.
* **String changes made/needed**: NA
[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6988991_39966)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1744352#c17)• 3 years ago |
|  | |

Attached file
[Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8](attachment.cgi?id=9265068)
— [Details](attachment.cgi?id=9265068&action=edit)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1744352#c18)• 3 years ago |
|  | |

Comment on [attachment 9265068](/attachment.cgi?id=9265068 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8") [[details]](/attachment.cgi?id=9265068&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Executing javascript in the domain of a sandboxed iframe, even though allow-scripts is not specified
* **Fix Landed on Version**: 99
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Passing around the flags from the original browsing context to the new one should be relatively safe.
[Attachment #9265068](/attachment.cgi?id=9265068&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8") -
Flags: approval-mozilla-esr91?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6997775_39966)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-esr91?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a6997890_406194)• 3 years ago |

Flags: needinfo?(nika)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1744352#c19)• 3 years ago |
|  | |

Comment on [attachment 9262937](/attachment.cgi?id=9262937 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") [[details]](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug

Approved for 98 beta 9, last beta, thanks.

[Attachment #9262937](/attachment.cgi?id=9262937&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts, r=smaug") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7027791_24572)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1744352#c20)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/eec6832670df>

<https://hg.mozilla.org/releases/mozilla-beta/rev/018fa9318ce0>

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7031323_553429)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1744352#c21)• 3 years ago |
|  | |

Verified as fixed on Windows 10 x64, macOS 11.6 and on Ubuntu 20.04 x64.

Comparing the results on Microsoft Edge and Chrome where the new tab loaded from the demo provided in the description redirect the user to about:blank#blocked instead of an empty address bar provided on Firefox.

Is this intended? Are there any intentions to change that?

Thanks.

Flags: needinfo?(nika)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7049745_583007)• 3 years ago |

[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1744352#c22)• 3 years ago |
|  | |

Maybe Olli can answer the question sooner than Nika.

Flags: needinfo?(bugs)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1744352#c23)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1744352) to reply.

Flags: needinfo?(nika)Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage] → [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey]

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1744352#c24)• 3 years ago |
|  | |

We don't show blocked, no.

Could you file a followup bug to do so.

Flags: needinfo?(bugs)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1744352#c25)• 3 years ago |
|  | |

Comment on [attachment 9265068](/attachment.cgi?id=9265068 "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8") [[details]](/attachment.cgi?id=9265068&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8")

[Bug 1744352](/show_bug.cgi?id=1744352 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank") - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8

Approved for 91.7esr.

[Attachment #9265068](/attachment.cgi?id=9265068&action=edit "Bug 1744352 - Part 1: Ensure we set InitialSandboxFlags when opening or replacing toplevel BrowsingContexts (for esr), r=mccr8") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7097709_75935)• 3 years ago |

[Attachment #9262939](/attachment.cgi?id=9262939&action=edit "Bug 1744352 - Part 2: Add test for sandboxing javascript uris in pop-ups, r=smaug") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1744352#c26)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/f7139e7249fe>

<https://hg.mozilla.org/releases/mozilla-esr91/rev/a6c71a2cac3c>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1744352#c27)• 3 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #24](/show_bug.cgi?id=1744352#c24 "VERIFIED FIXED - Sandboxed iFrame XSS - javascript URI's run with target _blank"))

> We don't show blocked, no.
>
> Could you file a followup bug to do so.

Logged [bug 1756999](/show_bug.cgi?id=1756999 "NEW - Empty address bar is displayed instead of blocking after Executing javascript in the domain of a sandboxed iframe").

Thanks.

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7140433_583007)• 3 years ago |

See Also: → [1756999](/show_bug.cgi?id=1756999 "NEW - Empty address bar is displayed instead of blocking after Executing javascript in the domain of a sandboxed iframe")

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1744352#c28)• 3 years ago |
|  | |

Should we consider the new bug a security issue also?

Thanks.

Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1744352#c29)• 3 years ago |
|  | |

That isn't a security issue, just somewhat minor UI issue, IMO.

Flags: needinfo?(bugs)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7233597_534482)• 3 years ago |

Flags: needinfo?(nika)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1744352#c30)• 3 years ago |
|  | |

Verified as fixed on Windows 10 x64, macOS 11.6 and on Ubuntu 20.04 x64.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7663032_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey] → [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey][adv-main98+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1744352#c31)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9266088) (obsolete)
— [Details](attachment.cgi?id=9266088&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7676853_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey][adv-main98+] → [reporter-external] [client-bounty-form][post-critsmash-triage][sec-survey][adv-main98+][adv-esr91.7+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1744352#c32)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9266126)
— [Details](attachment.cgi?id=9266126&action=edit)

[Attachment #9266088](/attachment.cgi?id=9266088&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a7753079_578488)• 3 years ago |

Alias: CVE-2022-26384

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a10104301_1689)• 3 years ago |

See Also: → [CVE-2022-29911](/show_bug.cgi?id=1761981 "RESOLVED FIXED - Firefox sandbox iframe can execute scripts without allow-scripts directive")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a23091523_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1744352#a78518375_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1744352&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_1c2f4f59_20250115_092340.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-10

## Security Vulnerabilities fixed in Firefox 98

Announced
March 8, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 98

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26382: Autofill Text could be exfiltrated via side-channel attacks](#CVE-2022-26382)

Reporter
Young Min Kim
Impact
moderate
##### Description

While the text displayed in Autofill tooltips cannot be directly read by JavaScript, the text was rendered using page fonts. Side-channel attacks on the text by using specially crafted fonts could have lead to this text being inferred by the webpage.

##### References

* [Bug 1741888](https://bugzilla.mozilla.org/show_bug.cgi?id=1741888)

#### [#CVE-2022-26385: Use-after-free in thread shutdown](#CVE-2022-26385)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

In unusual circumstances, an individual thread may outlive the thread's manager during shutdown. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1747526](https://bugzilla.mozilla.org/show_bug.cgi?id=1747526)

#### [#CVE-2022-0843: Memory safety bugs fixed in Firefox 98](#CVE-2022-0843)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers Kershaw Chang, Ryan VanderMeulen, and Randell Jesup reported memory safety bugs present in Firefox 97. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 98](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746523%2C1749062%2C1749164%2C1749214%2C1749610%2C1750032%2C1752100%2C1752405%2C1753612%2C1754508)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_32b21c23_20250115_092342.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-12

## Security Vulnerabilities fixed in Thunderbird 91.7

Announced
March 8, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Thunderbird verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Thunderbird would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Thunderbird for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Thunderbird for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_dff76c19_20250115_092341.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-11

## Security Vulnerabilities fixed in Firefox ESR 91.7

Announced
March 8, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.7

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Firefox for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Firefox for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


