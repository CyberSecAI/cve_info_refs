The provided content is related to CVE-2022-26954.

**Root cause of vulnerability:**
The root cause of this vulnerability lies in inconsistent implementation of the `Url.IsLocalUrl` check for the `returnUrl` parameter in several controller methods, and a flaw in the custom `NopRedirectResultExecutor` class. Specifically, the `NopRedirectResultExecutor` class URL-decodes the `returnUrl` parameter, and uses it directly in the `Location` header of an HTTP redirect response, which allows for bypassing the intended `IsLocalUrl` security checks.

**Weaknesses/vulnerabilities present:**
1.  **Inconsistent use of `IsLocalUrl`:** Several controller methods lack proper validation of the `returnUrl` parameter before performing a redirect.
2.  **Flaw in `NopRedirectResultExecutor`:** The custom `NopRedirectResultExecutor` class decodes the provided URL and uses it directly in redirect responses, allowing an attacker to bypass the `IsLocalUrl` check with a double-encoded URL.

**Impact of exploitation:**
Successful exploitation allows an attacker to craft malicious URLs that, when clicked, redirect a user to an attacker-controlled website. This can lead to phishing attacks where an attacker can obtain sensitive user information.

**Attack vectors:**
The attack vector involves crafting malicious URLs with a `returnUrl` parameter that contains a double-encoded redirect URL. The vulnerability is present in methods such as:
  - `ChangePassword` in `CustomerController.cs`
  - `SignInCustomerAsync` in `CustomerRegistrationService.cs`
  - `SuccessfulAuthentication` in `ExternalAuthenticationService.cs`

**Required attacker capabilities/position:**
An attacker needs to be able to craft and send HTTP requests to the application with malicious `returnUrl` parameters. No authentication is required to trigger the open redirect via the mentioned vulnerable methods.