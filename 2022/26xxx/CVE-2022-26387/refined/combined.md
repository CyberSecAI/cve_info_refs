=== Content from bugzilla.mozilla.org_4c472347_20250114_212449.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1752979)
* [XML](/show_bug.cgi?ctype=xml&id=1752979)

Closed
[Bug 1752979](/show_bug.cgi?id=1752979)
(CVE-2022-26387)

Opened 3 years ago
Closed 3 years ago

# TOCTOU flaw when verifying addon signatures: actual install might have different content

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

TOCTOU flaw when verifying addon signatures: actual install might have different content

## Categories

### (Toolkit :: Add-ons Manager, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S1

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

98 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox96 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix) |
| firefox97 | [-](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | [blocking](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=blocking) | [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified) |
| firefox99 | --- | [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 98+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox96 |  | wontfix |
| firefox97 | - | wontfix |
| firefox98 | blocking | verified |
| firefox99 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dveditz, Assigned: robwu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1752888](/show_bug.cgi?id=1752888 "VERIFIED FIXED - Confirming install prompt for trusted addon may execute arbitrary privileged code instead")

Dependency [tree](/showdependencytree.cgi?id=1752979&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1752979)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[mozilla-hub.atlassian.net/browse/WEBE...](https://mozilla-hub.atlassian.net/browse/WEBEXT-413 "https://mozilla-hub.atlassian.net/browse/WEBEXT-413")

## Details

### (Keywords: sec-high, Whiteboard: [sec-survey][adv-main98+][adv-esr91.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-26387

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][adv-main98+][adv-esr91.7+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c20 "3 years ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [Bug 1752979 - Check damaged files](/attachment.cgi?id=9261987)  [3 years ago](#c2)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr91+](#c16 "3 years ago")  dveditz : [sec-approval+](#c6 "3 years ago") | [Details](/attachment.cgi?id=9261987&action=edit) | [Review](/attachment.cgi?id=9261987) |
| --- | --- | --- |
| [Bug 1752979 - Tests for file changes during addon installs](/attachment.cgi?id=9261988)  [3 years ago](#c3)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9261988&action=edit) | [Review](/attachment.cgi?id=9261988) |
| [not-ublock.xpi](/attachment.cgi?id=9263745)  [3 years ago](#c14)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   555 bytes, application/x-xpinstall |  | [Details](/attachment.cgi?id=9263745&action=edit) |
| [advisory.txt](/attachment.cgi?id=9266121)  [3 years ago](#c19)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   297 bytes, text/plain |  | [Details](/attachment.cgi?id=9266121&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1752979#c0)• 3 years ago |
|  | |

The primary flaw of [bug 1752888](/show_bug.cgi?id=1752888 "VERIFIED FIXED - Confirming install prompt for trusted addon may execute arbitrary privileged code instead") is a TOCTOU violation when verifying add-on signatures. We initially validate the signature and read enough metadata to show the install permission prompt, but apparently release the file at that point and are none-the-wiser if it gets swapped out with a tampered version before we install it.

This appears to be especially problematic when installing from a local file because we do this right in-place, where the triggering content knows exactly where it is. For add-ons installed from the web we download it to a temp file somewhere to process. It still has the TOCTOU problem, but it's harder to find.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a14963_447061)• 3 years ago |

Assignee: nobody → robStatus: NEW → ASSIGNED

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1752979#c1)• 3 years ago |
|  | |

While [bug 1752888](/show_bug.cgi?id=1752888 "VERIFIED FIXED - Confirming install prompt for trusted addon may execute arbitrary privileged code instead") shows a PoC for local installations, the issue also applies to non-local installs. PoC description: Extensions can realistically exploit this if the user chooses the tempdir as the download destination. The extension API [offers the ability to overwrite files within the download directory](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads/FilenameConflictAction). It is also possible to determine the random file name (e.g. [bug 1598946](/show_bug.cgi?id=1598946 "ASSIGNED"), or simply by blindly writing up to 47k files because [there are only 36 \* 36 \* 36 possibilities for the file name](https://searchfox.org/mozilla-central/rev/b70bc09685763c44a8e56e4e04cb741fa020701a/toolkit/mozapps/extensions/internal/XPIInstall.jsm#778-780)). Together, it is possible for extensions to hijack arbitrary extension installs and updates (and escalate privileges by hijacking the installation of a privileged add-on).

I am going to fix this bug by verifying the xpi content right before it's being installed. That is, before actually installing the add-on in its final location, but after copying the xpi file from its original location (local file for local installs, a temp file for non-local installs) to a staging directory ([between `stageInstall` and `installAddon`](https://searchfox.org/mozilla-central/rev/b70bc09685763c44a8e56e4e04cb741fa020701a/toolkit/mozapps/extensions/internal/XPIInstall.jsm#1754,1771)).

I have considered but decided against the following alternatives:

* Keep the downloaded data in memory.
  + Issues: Implementation complexity and increased memory usage, for a potentially long while in case of updates in the background.
* Copy the local file to a temporary location [like we do for web installations](https://searchfox.org/mozilla-central/rev/b70bc09685763c44a8e56e4e04cb741fa020701a/toolkit/mozapps/extensions/internal/XPIInstall.jsm#2240-2241).
  + Issues: while it fixes privilege escalation via local installs ([bug 1752888](/show_bug.cgi?id=1752888 "VERIFIED FIXED - Confirming install prompt for trusted addon may execute arbitrary privileged code instead")), it does not fix the issue for web installs (explained above).
* Copy the local file to [the staging directory](https://searchfox.org/mozilla-central/rev/b70bc09685763c44a8e56e4e04cb741fa020701a/toolkit/mozapps/extensions/internal/XPIInstall.jsm#3093-3118) before installing.
  + Issues: Implementation complexity due to the re-use of the staging directory as a temp dir, e.g. ensuring that temp files are not mistakenly interpreted as an actually staged installation. Still susceptible to TOCTOU if the xpi in the staging directory is overwritten. Furthermore, there is also a separate issue with lingering files ([bug 1753110](/show_bug.cgi?id=1753110 "NEW - Lingering tmpaddon files in the OS temporary folder when an add-on has an update")), so taking this approach will cause the profile directory to accumulate junk over time (especially if we use this approach not only for local installs, but also web installs).
Severity: -- → S1
[tracking-firefox97](/buglist.cgi?f1=cf_tracking_firefox97&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%3F)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F)Priority: -- → P1See Also: → <https://mozilla-hub.atlassian.net/browse/WEBEXT-413>

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a113101_24572)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F) → [blocking](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=blocking)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a117358_75935)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)
[tracking-firefox97](/buglist.cgi?f1=cf_tracking_firefox97&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=-)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1752979#c2)• 3 years ago |
|  | |

Attached file
[Bug 1752979 - Check damaged files](attachment.cgi?id=9261987)
— [Details](attachment.cgi?id=9261987&action=edit)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1752979#c3)• 3 years ago |
|  | |

Attached file
[Bug 1752979 - Tests for file changes during addon installs](attachment.cgi?id=9261988)
— [Details](attachment.cgi?id=9261988&action=edit)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1752979#c4)• 3 years ago |
|  | |

Comment on [attachment 9261987](/attachment.cgi?id=9261987 "Bug 1752979 - Check damaged files") [[details]](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files")

[Bug 1752979](/show_bug.cgi?id=1752979 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") - Check damaged files

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. From the patch it is clear that there is a possibility of a content mismatch (which is a security problem), but it is not immediately obvious what the impact is. A skilled and motivated attacker may eventually be able to figure out that there is a TOCTOU in the install flow that could be used to bypass security checks. This patch on its own does not offer enough information to construct a full exploit (other gadgets are needed).
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All, including release and ESR
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: There is a rebase conflict due to a refactor that replaced `OS.File` with `IOUtils` ([bug 1733540](/show_bug.cgi?id=1733540 "RESOLVED FIXED - Replace OS.File with IOUtils in XPIInstall.jsm, and drop usage of osfile.jsm")). Either approach is fine (`IOUtils.copy` already exists since Firefox 81), and I locally confirmed that the new test still passes with the patches applied on top of the ESR91 branch.
* **How likely is this patch to cause regressions; how much testing does it need?**: There is a very small risk of regressions. The functionality is covered by unit tests (both old and new ones). The most significant change of the patch is the verification of the file hash immediately before an add-on is installed in the profile. This builds on top of existing optional content verification logic that is already reached in practice (by all installations off AMO), which gives great confidence that the hash can be assumed to be reliable. I have also audited relevant code paths to minimize the chance of regressions.
[Attachment #9261987](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files") -
Flags: sec-approval?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1752979#c5)• 3 years ago |
|  | |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a150823_1689)• 3 years ago |

[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F) → [98+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=98%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1752979#c6)• 3 years ago |
|  | |

Comment on [attachment 9261987](/attachment.cgi?id=9261987 "Bug 1752979 - Check damaged files") [[details]](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files")

[Bug 1752979](/show_bug.cgi?id=1752979 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") - Check damaged files

sec-approval=dveditz.

DO NOT land the companion test patch until after we ship the fix.

[Attachment #9261987](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1752979#c7)• 3 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/c4339dd5c34f8b56fa479d303ce54062b43851a0>

Backed out for causing multiple mochitest failures:

<https://hg.mozilla.org/integration/autoland/rev/0d1ebe4f9d6eec169c1c1da3582fdcf88eed547f>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=c4339dd5c34f8b56fa479d303ce54062b43851a0>

[Mochitest failures](https://treeherder.mozilla.org/logviewer?job_id=366595869&repo=autoland&lineNumber=2095)

[Telemetry failures](https://treeherder.mozilla.org/logviewer?job_id=366599453&repo=autoland)

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1752979#c8)• 3 years ago |
|  | |

I believe that the failure (NS\_ERROR\_FILE\_IS\_LOCKED) is caused by the file still being open after reading the hash.

I re-used the existing logic from <https://searchfox.org/mozilla-central/rev/8b46752d1e583b2f817c451f93ba515fb865554d/toolkit/mozapps/extensions/internal/XPIInstall.jsm#2036-2038>, but it looks like that was already missing a `fis.close()` call before. I've updated the patch, will run it on Windows and then retry.

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1752979#c9)• 3 years ago |
|  | |

Comment on [attachment 9261987](/attachment.cgi?id=9261987 "Bug 1752979 - Check damaged files") [[details]](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files")

[Bug 1752979](/show_bug.cgi?id=1752979 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") - Check damaged files

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Users would be vulnerable to privilege escalation.
* **Fix Landed on Version**: 98. This should land on ESR91 when 98 enters release.
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch blocks unsupported (i.e. vulnerable) behavior and is covered by unit tests.
[Attachment #9261987](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files") -
Flags: approval-mozilla-esr91?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1752979#c10)• 3 years ago |
|  | |

Check damaged files r=mixedpuppy

<https://hg.mozilla.org/integration/autoland/rev/a82e15f5c31956ffccce3fd7a4e824e6083c586c>

<https://hg.mozilla.org/mozilla-central/rev/a82e15f5c319>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 98 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a295562_75935)• 3 years ago |

[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1752979#c11)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1752979) to reply.

Flags: needinfo?(rob)Whiteboard: [sec-survey]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a869504_551058)• 3 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1752979#c12)• 3 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Rob, could you confirm how QA can verify this? Would the following steps work?

1. save the rally XPI file and another XPI file locally
2. drag/drop the rally XPI file to the tabstrip
3. while the install prompt is up in Firefox, move the other XPI file into the place of the rally XPI file
4. accept the install prompt in Firefox
5. the xpi file shouldn't be installed.
Flags: qe-verify+

|  | [Alex Cornestean](/user_profile?user_id=651196) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1752979#c13)• 3 years ago |
|  | |

Hello @Gijs

I’ve attempted to verify the fix using the STR from [Comment 12](/show_bug.cgi?id=1752979#c12 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") however I’ve come across a small problem, in the sense that the STR don’t seem to be valid or I did not understand them correctly.

To verify the fix I’ve done the following, according to the STR:

1. downloaded the latest Mozilla Rally and uBlock Origin .xpis from AMO and put them in 2 separate folders on my machine
2. dragged and dropped the Mozilla Rally .xpi onto the browser window to install it. The install panel is displayed. I do NOT click the “Add” button yet.
3. I move the uBlock Origin .xpi from its folder to the one where the Mozilla Rally .xpi is located. Also, I move the Mozilla Rally .xpi from its original folder to the one where uBlock used to be in. So I swapped the .xpis locations.
4. I click “Add” on the install panel in the browser
5. A panel with “Mozilla Rally could not be installed because Firefox cannot modify the needed file.” is displayed and the add-on install does not proceed.

This behavior occurs on the latest Beta (98.0b4/20220213185901) and Nightly (99.0a1/20220213214259), however it occurs on the latest Release (97.0/20220202182137) as well, where the fix should not have landed. Tested on Windows 10 x64 for the moment.

Would you be able to clarify whether what I’m doing is correct as per your suggestion in [Comment 12](/show_bug.cgi?id=1752979#c12 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content")? Or if the provided STR are not valid to verify this?

Thank you !

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a1138856_553429)• 3 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1752979#c14)• 3 years ago |
|  | |

Attached file
[not-ublock.xpi](attachment.cgi?id=9263745)
— [Details](attachment.cgi?id=9263745&action=edit)

STR:

1. Download uBlock Origin's XPI file, e.g. saved as `addon.xpi` in your Downloads directory.
2. Open the XPI file in Firefox, e.g. by drag & drop, or by opening the `file:`-URL of the xpi file.
3. When the permission prompt appears, replace the `addon.xpi` from step 1 with the attached file (rename `not-ublock.xpi` to `addon.xpi`).
4. Confirm the installation in Firefox.
5. Open the console and look at the output.

Expected:

* The extension installation should not happen.
* With the fix, step 4 will trigger a doorhanger with the message "... could not be installed because Firefox cannot modify the needed file",
* With the fix, step 5 shows "Failed to install /path/to/addon.xpi from file:///path/to/addon.xpi to ...: Refusing to stage add-on because it has been damaged"

Actual (before the fix):

* The installation continued with the modified xpi file (`not-ublock.xpi`). The console contains "=== LOG === This is not uBlock Origin === LOG ==="
Flags: needinfo?(rob)Flags: needinfo?(gijskruitbosch+bugs)

|  | [Alex Cornestean](/user_profile?user_id=651196) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1752979#c15)• 3 years ago |
|  | |

Hello and thank you @Rob for the STR !

I managed to verify the fix based on the STR from [Comment 14](/show_bug.cgi?id=1752979#c14 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") on the latest Nightly (99.0a1/20220214213941) and Beta (98.0b4/20220213185901) under Windows 10 x64 and Ubuntu 16.04 LTS.

Proceeding with the STR, on the latest Nightly and Beta, the following occur as expected:

* the extension installation does not happen
* a doorhanger stating that “... could not be installed because Firefox cannot modify the needed file" is displayed
* the console logs "Failed to install /path/to/addon.xpi from file:///path/to/addon.xpi to ...: Refusing to stage add-on because it has been damaged"

  , confirming the fix.

Also tested against the latest Release ( 97.0/20220202182137) where the fix is not present, and as per the above “Actual (before the fix)”, the installation of the dummy extensions continues and the console logs “=== LOG === This is not uBlock Origin === LOG ===”.

Status: RESOLVED → VERIFIED
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=verified)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1752979#c16)• 3 years ago |
|  | |

Comment on [attachment 9261987](/attachment.cgi?id=9261987 "Bug 1752979 - Check damaged files") [[details]](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files")

[Bug 1752979](/show_bug.cgi?id=1752979 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") - Check damaged files

Approved for 91.7esr.

[Attachment #9261987](/attachment.cgi?id=9261987&action=edit "Bug 1752979 - Check damaged files") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1752979#c17)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/537e1fca9a43>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)Flags: in-testsuite?

|  | [Alex Cornestean](/user_profile?user_id=651196) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1752979#c18)• 3 years ago |
|  | |

Hello,

I verified the fix based on the STR from [Comment 14](/show_bug.cgi?id=1752979#c14 "VERIFIED FIXED - TOCTOU flaw when verifying addon signatures: actual install might have different content") on the latest ESR (91.7.0esr/20220228225400) under Windows 10 x64 and Ubuntu 16.04 LTS.

Proceeding with the STR, on the latest ESR, the following occur as expected:

* the extension installation does not happen
* a doorhanger stating that “... could not be installed because Firefox cannot modify the needed file" is displayed
* the console logs "Failed to install /path/to/addon.xpi from file:///path/to/addon.xpi to ...: Refusing to stage add-on because it has been damaged"

  , confirming the fix.
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a2534648_578488)• 3 years ago |

Whiteboard: [sec-survey] → [sec-survey][adv-main98+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1752979#c19)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9266121)
— [Details](attachment.cgi?id=9266121&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a2548479_578488)• 3 years ago |

Whiteboard: [sec-survey][adv-main98+] → [sec-survey][adv-main98+][adv-esr91.7+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a2624741_578488)• 3 years ago |

Alias: CVE-2022-26387

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1752979#c20)• 3 years ago |
|  | |

Tests for file changes during addon installs r=mixedpuppy

<https://hg.mozilla.org/integration/autoland/rev/d8df5666ec7dab641fc5f321fac71d63229ca867>

<https://hg.mozilla.org/mozilla-central/rev/d8df5666ec7d>

Flags: in-testsuite? → in-testsuite+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a9675503_553429)• 3 years ago |

QA Whiteboard: [post-critsmash-triage][qa-triaged] → [post-critsmash-triage]Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1752979#a17963167_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1752979&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rob Wu [:robwu]](/user_profile?user_id=447061)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_dff76c19_20250114_212450.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-11

## Security Vulnerabilities fixed in Firefox ESR 91.7

Announced
March 8, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.7

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Firefox for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Firefox for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_32b21c23_20250114_212451.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-12

## Security Vulnerabilities fixed in Thunderbird 91.7

Announced
March 8, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Thunderbird verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Thunderbird would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26386: Temporary files downloaded to /tmp and accessible by other local users](#CVE-2022-26386)

Reporter
attila
Impact
low
##### Description

Previously Thunderbird for macOS and Linux would download temporary files to a user-specific directory in `/tmp`, but this behavior was changed to download them to `/tmp` where they could be affected by other local users. This behavior was reverted to the original, user-specific directory.
*This bug only affects Thunderbird for macOS and Linux. Other operating systems are unaffected.*

##### References

* [Bug 1752396](https://bugzilla.mozilla.org/show_bug.cgi?id=1752396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_1c2f4f59_20250114_212449.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-10

## Security Vulnerabilities fixed in Firefox 98

Announced
March 8, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 98

#### [#CVE-2022-26383: Browser window spoof using fullscreen mode](#CVE-2022-26383)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When resizing a popup after requesting fullscreen access, the popup would not display the fullscreen notification.

##### References

* [Bug 1742421](https://bugzilla.mozilla.org/show_bug.cgi?id=1742421)

#### [#CVE-2022-26384: iframe allow-scripts sandbox bypass](#CVE-2022-26384)

Reporter
Ed McManus
Impact
high
##### Description

If an attacker could control the contents of an iframe sandboxed with `allow-popups` but not `allow-scripts`, they were able to craft a link that, when clicked, would lead to JavaScript execution in violation of the sandbox.

##### References

* [Bug 1744352](https://bugzilla.mozilla.org/show_bug.cgi?id=1744352)

#### [#CVE-2022-26387: Time-of-check time-of-use bug when verifying add-on signatures](#CVE-2022-26387)

Reporter
Armin Ebert
Impact
high
##### Description

When installing an add-on, Firefox verified the signature before prompting the user; but while the user was confirming the prompt, the underlying add-on file could have been modified and Firefox would not have noticed.

##### References

* [Bug 1752979](https://bugzilla.mozilla.org/show_bug.cgi?id=1752979)

#### [#CVE-2022-26381: Use-after-free in text reflows](#CVE-2022-26381)

Reporter
Mozilla Fuzzing Team and Hossein Lotfi of Trend Micro Zero Day Initiative
Impact
high
##### Description

An attacker could have caused a use-after-free by forcing a text reflow in an SVG object leading to a potentially exploitable crash.

##### References

* [Bug 1736243](https://bugzilla.mozilla.org/show_bug.cgi?id=1736243)

#### [#CVE-2022-26382: Autofill Text could be exfiltrated via side-channel attacks](#CVE-2022-26382)

Reporter
Young Min Kim
Impact
moderate
##### Description

While the text displayed in Autofill tooltips cannot be directly read by JavaScript, the text was rendered using page fonts. Side-channel attacks on the text by using specially crafted fonts could have lead to this text being inferred by the webpage.

##### References

* [Bug 1741888](https://bugzilla.mozilla.org/show_bug.cgi?id=1741888)

#### [#CVE-2022-26385: Use-after-free in thread shutdown](#CVE-2022-26385)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

In unusual circumstances, an individual thread may outlive the thread's manager during shutdown. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1747526](https://bugzilla.mozilla.org/show_bug.cgi?id=1747526)

#### [#CVE-2022-0843: Memory safety bugs fixed in Firefox 98](#CVE-2022-0843)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers Kershaw Chang, Ryan VanderMeulen, and Randell Jesup reported memory safety bugs present in Firefox 97. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 98](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746523%2C1749062%2C1749164%2C1749214%2C1749610%2C1750032%2C1752100%2C1752405%2C1753612%2C1754508)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


