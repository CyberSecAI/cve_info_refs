- **Root cause of vulnerability**: The `unescape` function in `cgi.c` of Asuswrt and Asuswrt-Merlin New Gen firmware incorrectly assumes that there are always at least two characters following a '%' character in a URL-encoded string. If a '%' character is followed by fewer than two characters, it leads to an out-of-bounds read and potentially an out-of-bounds write.
- **Weaknesses/vulnerabilities present**: Out-of-bounds read and write. Specifically, the `strlcpy` function at `[4]` reads out of bounds if the '%' character is followed by fewer than 2 characters. The `strncpy` at `[5]` can remove the null terminator, leading to a potential out-of-bounds write in subsequent iterations of the loop.
- **Impact of exploitation**: Memory corruption can occur. The specific impact is not detailed beyond memory corruption, but it can lead to denial of service or potentially arbitrary code execution.
- **Attack vectors**: Sending a specially crafted HTTP request with a malformed URL-encoded string. The crafted string includes a '%' character followed by less than two characters.
- **Required attacker capabilities/position**: The attacker needs to be able to send a network request to the vulnerable device to trigger the vulnerability.