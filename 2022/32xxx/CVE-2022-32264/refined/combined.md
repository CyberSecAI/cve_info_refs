=== Content from jvn.jp_0df92fae_20250115_094413.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/06/15  Last Updated:2022/06/15
# JVN#20930118 FreeBSD vulnerable to denial-of-service (DoS)

## Overview

FreeBSD contains a denial-of-service (DoS) vulnerability.

## Products Affected

* FreeBSD versions prior to 7.0

## Description

FreeBSD contains a denial-of-service (DoS) vulnerability ([CWE-400](//cwe.mitre.org/data/definitions/400.html)) due to improper handling of TSopt on TCP connections.

## Impact

A remote attacker may be able to cause a denial-of-service (DoS) condition.

## Solution

**Update the software**

Update the software to the latest version according to the information provided by the developer.

This vulnerability was fixed in 2006 September 25 by the following FreeBSD commit.

* commit 4dc630cdd2f7a790604d2724ecb19c6aa95130a7
* Author: John-Mark Gurney <jmg@FreeBSD.org>
* Date:   Mon Sep 25 07:22:39 2006 +0000

## Vendor Status

| Vendor | Link |
| --- | --- |
| FreeBSD | [The FreeBSD Project](https://www.freebsd.org/) |
|  | [commit 4dc630cdd2f7a790604d2724ecb19c6aa95130a7](https://cgit.freebsd.org/src/commit/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7) |

## References

## JPCERT/CC Addendum

This JVN publication was delayed to 2022/6/15 after the developer's fix was published.

This vulnerability was reported to IPA in 2006. JPCERT/CC then started to coordinate with the developers, but the coordination had been delayed for a long time after that.

In April 2022, the developer contacted JPCERT/CC that the vulnerability had been fixed on September 25, 2006, and JPCERT/CC resumed coordination with the developer for the JVN publication, leading to this publication.

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
Base Score:
5.3

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:N/C:N/I:N/A:P
Base Score:
5.0

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2022-32264](https://www.cve.org/CVERecord?id=CVE-2022-32264) |
| JVN iPedia | [JVNDB-2022-000045](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000045) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.



=== Content from cgit.freebsd.org_202f24e7_20250115_094416.html ===


| [cgit logo](/) | [index](/) : [src](/src/ "src") | main releng/1 releng/10.0 releng/10.1 releng/10.2 releng/10.3 releng/10.4 releng/11.0 releng/11.1 releng/11.2 releng/11.3 releng/11.4 releng/12.0 releng/12.1 releng/12.2 releng/12.3 releng/12.4 releng/13.0 releng/13.1 releng/13.2 releng/13.3 releng/13.4 releng/14.0 releng/14.1 releng/14.2 releng/2.0 releng/2.0.5 releng/4.10 releng/4.11 releng/4.3 releng/4.4 releng/4.5 releng/4.6 releng/4.7 releng/4.8 releng/4.9 releng/5.0 releng/5.1 releng/5.2 releng/5.3 releng/5.4 releng/5.5 releng/6.0 releng/6.1 releng/6.2 releng/6.3 releng/6.4 releng/7.0 releng/7.1 releng/7.2 releng/7.3 releng/7.4 releng/8.0 releng/8.1 releng/8.2 releng/8.3 releng/8.4 releng/9.0 releng/9.1 releng/9.2 releng/9.3 stable/10 stable/11 stable/12 stable/13 stable/14 stable/2.1 stable/2.2 stable/3 stable/4 stable/5 stable/6 stable/7 stable/8 stable/9 vendor/CSRG vendor/Juniper/libxo vendor/Linux/ath-common vendor/Linux/ath10k vendor/Linux/ath11k vendor/Linux/ath12k vendor/Linux/iwlwifi vendor/Linux/mt76 vendor/Linux/rtw88 vendor/Linux/rtw89 vendor/NetBSD/blacklist vendor/NetBSD/bmake vendor/NetBSD/libc-pwcache vendor/NetBSD/libc-vis vendor/NetBSD/libedit vendor/NetBSD/libexecinfo vendor/NetBSD/lukemftp vendor/NetBSD/lukemftpd vendor/NetBSD/misc vendor/NetBSD/mknod vendor/NetBSD/mtree vendor/NetBSD/softfloat vendor/NetBSD/sort vendor/NetBSD/tests vendor/NetBSD/unvis vendor/NetBSD/vis vendor/NetBSD/xlint vendor/OpenBSD vendor/SGI vendor/acpica vendor/alpine-hal vendor/alsa vendor/altq vendor/amd vendor/apr vendor/apr-util vendor/arm-optimized-routines vendor/atf vendor/ath vendor/bc vendor/bearssl vendor/bind vendor/bind4 vendor/bind9 vendor/bind9-9.3 vendor/bind9-9.4 vendor/bind9-9.6 vendor/bind9-9.8 vendor/binutils vendor/bionic-x86\_64-string vendor/blocklist vendor/bsddialog vendor/bsnmp vendor/byacc vendor/bzip2 vendor/ck vendor/clang vendor/clang-60 vendor/clang-70 vendor/clang-80 vendor/clang-90 vendor/com\_err vendor/compiler-rt vendor/compiler-rt-60 vendor/compiler-rt-70 vendor/compiler-rt-80 vendor/compiler-rt-90 vendor/cortex-strings vendor/csup vendor/ctfdump vendor/device-tree vendor/dhcpcd vendor/dialog vendor/dma vendor/dtc vendor/dtracetoolkit vendor/edk2 vendor/ee vendor/elftoolchain vendor/ena-com vendor/expat vendor/ext2fs vendor/ficl vendor/file vendor/flex vendor/gcc vendor/gdb vendor/gdtoa vendor/global vendor/google/capsicum-test vendor/google/googletest vendor/got/diff vendor/gperf vendor/groff vendor/heimdal vendor/heirloom-doctools vendor/hostapd vendor/hyperv vendor/illumos vendor/ipfilter vendor/ipfilter-sys vendor/ipfilter-sys-old vendor/isc-dhcp vendor/jemalloc vendor/kerberosIV vendor/krb5 vendor/kyua vendor/ldns vendor/ldns-host vendor/less vendor/lib9p vendor/libarchive vendor/libbegemot vendor/libc++ vendor/libc++-60 vendor/libc++-70 vendor/libc++-80 vendor/libc++-90 vendor/libcbor vendor/libcxxrt vendor/libder vendor/libdes vendor/libdivsufsort vendor/libecc vendor/libevent vendor/libfdt vendor/libfido2 vendor/libgmp vendor/libpam vendor/libpcap vendor/libreadline vendor/libregex vendor/libucl vendor/libuwx vendor/libyaml vendor/lld vendor/lld-60 vendor/lld-70 vendor/lld-80 vendor/lld-90 vendor/lldb vendor/lldb-60 vendor/lldb-70 vendor/lldb-80 vendor/lldb-90 vendor/llvm vendor/llvm-60 vendor/llvm-70 vendor/llvm-80 vendor/llvm-90 vendor/llvm-libunwind vendor/llvm-libunwind-80 vendor/llvm-libunwind-90 vendor/llvm-openmp vendor/llvm-openmp-80 vendor/llvm-openmp-90 vendor/llvm-project/main vendor/llvm-project/master vendor/llvm-project/release-10.x vendor/llvm-project/release-11.x vendor/llvm-project/release-12.x vendor/llvm-project/release-13.x vendor/llvm-project/release-14.x vendor/llvm-project/release-15.x vendor/llvm-project/release-16.x vendor/llvm-project/release-17.x vendor/llvm-project/release-18.x vendor/llvm-project/release-19.x vendor/llvm-project/release-8.x vendor/llvm-project/release-9.x vendor/lomac vendor/lua vendor/lutok vendor/mandoc vendor/misc-GNU/awk vendor/misc-GNU/bc vendor/misc-GNU/bison vendor/misc-GNU/cpio vendor/misc-GNU/cvs vendor/misc-GNU/diff vendor/misc-GNU/grep vendor/misc-GNU/misc vendor/misc-GNU/patch vendor/misc-GNU/sort vendor/misc-GNU/texinfo vendor/mrouted vendor/ncftp vendor/ncurses vendor/netcat vendor/ngatm vendor/ntp vendor/ntpd vendor/nve vendor/nvi vendor/octeon-sdk vendor/one-true-awk vendor/openbsm vendor/opencsd vendor/openpam vendor/openresolv vendor/opensolaris vendor/openssh vendor/openssl vendor/openssl-0.9.8 vendor/openssl-1.0.1 vendor/openssl-1.0.2 vendor/openssl-1.1.1 vendor/openssl-3.0 vendor/openzfs/legacy vendor/openzfs/master vendor/openzfs/zfs-2.1-release vendor/openzfs/zfs-2.2-release vendor/opie vendor/pam\_modules vendor/pcg-c vendor/pciids vendor/perl5 vendor/pf vendor/pf-sys vendor/pjdfstest vendor/pnglite vendor/pppd vendor/qcamain\_open\_hal vendor/rarpd vendor/resolver vendor/rpcgen vendor/sendmail vendor/serf vendor/skein vendor/smbfs vendor/softdep vendor/softupdates vendor/spleen vendor/sqlite3 vendor/ssleay vendor/stallion vendor/subversion vendor/sym vendor/tcl vendor/tcp\_wrappers vendor/tcpdump vendor/tcsh vendor/terminus vendor/testfloat vendor/tnftp vendor/top vendor/traceroute vendor/tre vendor/tzcode vendor/tzdata vendor/tzdb vendor/unbound vendor/unifdef vendor/v4l vendor/voxware vendor/wireguard-tools vendor/wpa vendor/wpa\_supplicant vendor/x86emu vendor/xe vendor/xz vendor/xz-embedded vendor/zlib vendor/zstd |
| --- | --- | --- |
| FreeBSD source tree |  |

| [about](/src/about/)[summary](/src/)[refs](/src/refs/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)[log](/src/log/)[tree](/src/tree/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)[commit](/src/commit/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)[diff](/src/diff/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | John-Mark Gurney <jmg@FreeBSD.org> | 2006-09-25 07:22:39 +0000 |
| --- | --- | --- |
| committer | John-Mark Gurney <jmg@FreeBSD.org> | 2006-09-25 07:22:39 +0000 |
| commit | [4dc630cdd2f7a790604d2724ecb19c6aa95130a7](/src/commit/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7) ([patch](/src/patch/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)) | |
| tree | [3612b2c08f6d5a51c1e46b025d56c7e7fbba1338](/src/tree/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7) | |
| parent | [33fabe46dad0224b9166b4ae2efc86c19017eb20](/src/commit/?id=33fabe46dad0224b9166b4ae2efc86c19017eb20) ([diff](/src/diff/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7&id2=33fabe46dad0224b9166b4ae2efc86c19017eb20)) | |

if min is greater than max, prefer max over min... I managed to get aretransmit timer that was going to take 19 days to trigger...
Reviewed by: silby
Notes
Notes:
svn path=/head/; revision=162612
[Diffstat](/src/diff/?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)

| -rw-r--r-- | [sys/netinet/tcp\_timer.h](/src/diff/sys/netinet/tcp_timer.h?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/sys/netinet/tcp\_timer.h b/sys/netinet/tcp\_timer.hindex 4b32cbbc522e..1e1c239c7ff1 100644--- a/[sys/netinet/tcp\_timer.h](/src/tree/sys/netinet/tcp_timer.h?id=33fabe46dad0224b9166b4ae2efc86c19017eb20)+++ b/[sys/netinet/tcp\_timer.h](/src/tree/sys/netinet/tcp_timer.h?id=4dc630cdd2f7a790604d2724ecb19c6aa95130a7)@@ -133,7 +133,7 @@ static const char \*tcptimers[] = (tv) = (value) + tcp\_rexmit\_slop; \ if ((u\_long)(tv) < (u\_long)(tvmin)) \ (tv) = (tvmin); \- else if ((u\_long)(tv) > (u\_long)(tvmax)) \+ if ((u\_long)(tv) > (u\_long)(tvmax)) \ (tv) = (tvmax); \ } while(0) |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-15 09:44:15 +0000


