Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The vulnerability is a Second-Order SQL Injection in Piwigo. The application improperly handles user-supplied input during search queries. Specifically, it allows a malicious user to inject SQL code that is stored and later executed within an administrative context.

**Weaknesses/Vulnerabilities:**
*   **SQL Injection:** The primary vulnerability is SQL injection, where attacker-controlled data is used to construct SQL queries without proper sanitization or parameterization. This allows the attacker to modify the queries.
*   **Second-Order:** The SQL injection is second-order. The malicious code is initially injected into a search table, and then gets executed when the administrator visits a crafted URL. This means that the injection and the exploitation of the vulnerability occur in different steps.
*   **Lack of Input Sanitization:** The application doesn't sanitize or validate the input provided for search terms.

**Impact of Exploitation:**
*   **Database Access:** An attacker can gain access to the MySQL database by exploiting this vulnerability.
*   **Data Breaches:** Sensitive information, such as user passwords, can be extracted from the database. In the provided example, it shows the extraction of administrator password.
*   **Privilege Escalation:** By gaining access to the database, an attacker can potentially escalate privileges, modify data, or perform other malicious activities.

**Attack Vectors:**
*   **Search Function:** The initial attack vector is the search functionality, where the attacker crafts a malicious search query.
*   **Malicious URL:** The attacker crafts a special URL which, when opened by an administrator, triggers the execution of the previously injected SQL code.

**Required Attacker Capabilities/Position:**
*   **Access to the Piwigo application:** An attacker needs to have access to the Piwigo application's search functionality.
*   **Ability to Craft SQL Injection Payloads:** The attacker needs to be capable of creating malicious SQL queries that can be stored and later executed.
*   **Ability to Trick Administrator:** The attacker needs a way to make the administrator click on a crafted link that triggers the malicious SQL injection.

**Additional Details:**
*   The provided example shows the steps to inject a payload that extracts the administrator's password, showcasing the impact of the vulnerability.
*   The attacker needs to know or brute force an ID to retrieve the injected data from piwigo\_search table.
*   The vulnerability is present in Piwigo versions up to and including 12.2.0.