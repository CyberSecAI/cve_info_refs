=== Content from github.com_07995409_20250114_203428.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fpull%2F2015)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fpull%2F2015)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=RamonSilva20%2Fmapos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RamonSilva20](/RamonSilva20)
/
**[mapos](/RamonSilva20/mapos)**
Public

* [Notifications](/login?return_to=%2FRamonSilva20%2Fmapos) You must be signed in to change notification settings
* [Fork
  622](/login?return_to=%2FRamonSilva20%2Fmapos)
* [Star
   922](/login?return_to=%2FRamonSilva20%2Fmapos)

* [Code](/RamonSilva20/mapos)
* [Issues
  13](/RamonSilva20/mapos/issues)
* [Pull requests
  3](/RamonSilva20/mapos/pulls)
* [Discussions](/RamonSilva20/mapos/discussions)
* [Actions](/RamonSilva20/mapos/actions)
* [Projects
  0](/RamonSilva20/mapos/projects)
* [Security](/RamonSilva20/mapos/security)
* [Insights](/RamonSilva20/mapos/pulse)

Additional navigation options

* [Code](/RamonSilva20/mapos)
* [Issues](/RamonSilva20/mapos/issues)
* [Pull requests](/RamonSilva20/mapos/pulls)
* [Discussions](/RamonSilva20/mapos/discussions)
* [Actions](/RamonSilva20/mapos/actions)
* [Projects](/RamonSilva20/mapos/projects)
* [Security](/RamonSilva20/mapos/security)
* [Insights](/RamonSilva20/mapos/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRamonSilva20%2Fmapos%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRamonSilva20%2Fmapos%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add True for all the post and get inputs #2015

 Closed

[enferas](/enferas)
wants to merge
1
commit into
[RamonSilva20:master](/RamonSilva20/mapos/tree/master "RamonSilva20/mapos:master")
from
[enferas:master](/enferas/mapos/tree/master "enferas/mapos:master")

 Closed

# [Add True for all the post and get inputs](#top) #2015

[enferas](/enferas)
wants to merge
1
commit into
[RamonSilva20:master](/RamonSilva20/mapos/tree/master "RamonSilva20/mapos:master")
from
[enferas:master](/enferas/mapos/tree/master "enferas/mapos:master")

[Conversation
2](/RamonSilva20/mapos/pull/2015)
[Commits
1](/RamonSilva20/mapos/pull/2015/commits)
[Checks
0](/RamonSilva20/mapos/pull/2015/checks)
[Files changed](/RamonSilva20/mapos/pull/2015/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![enferas](https://avatars.githubusercontent.com/u/10528985?s=60&v=4)](/enferas)

Copy link

### @enferas **[enferas](/enferas)** commented [Dec 29, 2022](#issue-1514031029)

Signed-off-by: AL-KASSAR f.al-kassar@sap.com

I added TRUE for all the inputs, then all the inputs will be sanitized against XSS vulnerabilities. [POST in CI](https://codeigniter.com/userguide3/libraries/input.html#CI_Input::post)

Sorry, something went wrong.

All reactions

`[Add True for all the post and get inputs](/RamonSilva20/mapos/pull/2015/commits/8039b056632bc3d7000fff84a4328d394cd4f6da "Add True for all the post and get inputs
Signed-off-by: AL-KASSAR <f.al-kassar@sap.com>")`
 …

`[8039b05](/RamonSilva20/mapos/pull/2015/commits/8039b056632bc3d7000fff84a4328d394cd4f6da)`

```
Signed-off-by: AL-KASSAR <f.al-kassar@sap.com>
```

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=40&u=306bd5db1ff98fab763546b43495f436b1e1095e&v=4)](/enferas)
[enferas](/enferas)
mentioned this pull request
[Dec 29, 2022](#ref-issue-1510430085)

[Multiple possible XSS vulnerabilities
#2010](/RamonSilva20/mapos/issues/2010)

Closed

[![Pr3d4dor](https://avatars.githubusercontent.com/u/13210429?s=60&v=4)](/Pr3d4dor)

**[Pr3d4dor](/Pr3d4dor)**
approved these changes
[Jan 26, 2023](#pullrequestreview-1271395780)

 [View reviewed changes](/RamonSilva20/mapos/pull/2015/files/8039b056632bc3d7000fff84a4328d394cd4f6da)

[![@Pr3d4dor](https://avatars.githubusercontent.com/u/13210429?s=80&u=dc318350a47cf6b357424df5f57752660e866a4b&v=4)](/Pr3d4dor)

Copy link

Collaborator

### **[Pr3d4dor](/Pr3d4dor)** commented [Jan 26, 2023](#issuecomment-1405279232)

| Thanks [@enferas](https://github.com/enferas), I would suggest to change all "TRUE" to "true" to maintain the PSR2 and PSR12 standards. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Feb 26, 2023](#issuecomment-1445232119)

| Esta PR está obsoleta porque está aberta há 30 dias sem atividade. Remova o rótulo ou esse comentário ou essa issue será fechada em 5 dias |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[Stale](/RamonSilva20/mapos/labels/Stale)
label
[Feb 26, 2023](#event-8608697534)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
closed this
[Mar 3, 2023](#event-8655476301)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fpull%2F2015)

Reviewers

[![@Pr3d4dor](https://avatars.githubusercontent.com/u/13210429?s=40&v=4)](/Pr3d4dor) [Pr3d4dor](/Pr3d4dor)

Pr3d4dor approved these changes

Assignees

No one assigned

Labels

[Stale](/RamonSilva20/mapos/labels/Stale)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=52&v=4)](/enferas) [![@Pr3d4dor](https://avatars.githubusercontent.com/u/13210429?s=52&v=4)](/Pr3d4dor)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_371c4fe6_20250114_203427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fissues%2F2010)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fissues%2F2010)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=RamonSilva20%2Fmapos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RamonSilva20](/RamonSilva20)
/
**[mapos](/RamonSilva20/mapos)**
Public

* [Notifications](/login?return_to=%2FRamonSilva20%2Fmapos) You must be signed in to change notification settings
* [Fork
  622](/login?return_to=%2FRamonSilva20%2Fmapos)
* [Star
   922](/login?return_to=%2FRamonSilva20%2Fmapos)

* [Code](/RamonSilva20/mapos)
* [Issues
  13](/RamonSilva20/mapos/issues)
* [Pull requests
  3](/RamonSilva20/mapos/pulls)
* [Discussions](/RamonSilva20/mapos/discussions)
* [Actions](/RamonSilva20/mapos/actions)
* [Projects
  0](/RamonSilva20/mapos/projects)
* [Security](/RamonSilva20/mapos/security)
* [Insights](/RamonSilva20/mapos/pulse)

Additional navigation options

* [Code](/RamonSilva20/mapos)
* [Issues](/RamonSilva20/mapos/issues)
* [Pull requests](/RamonSilva20/mapos/pulls)
* [Discussions](/RamonSilva20/mapos/discussions)
* [Actions](/RamonSilva20/mapos/actions)
* [Projects](/RamonSilva20/mapos/projects)
* [Security](/RamonSilva20/mapos/security)
* [Insights](/RamonSilva20/mapos/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FRamonSilva20%2Fmapos%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FRamonSilva20%2Fmapos%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Multiple possible XSS vulnerabilities #2010

Closed

[enferas](/enferas) opened this issue
Dec 25, 2022
· 4 comments

Closed

# [Multiple possible XSS vulnerabilities](#top) #2010

[enferas](/enferas) opened this issue
Dec 25, 2022
· 4 comments

Labels
[bug](/RamonSilva20/mapos/labels/bug)
[Stale](/RamonSilva20/mapos/labels/Stale)

## Comments

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=80&u=306bd5db1ff98fab763546b43495f436b1e1095e&v=4)](/enferas)

Copy link

### **[enferas](/enferas)** commented [Dec 25, 2022](#issue-1510430085)

| Hello,  I would like to report for some XSS vulnerabilities.  For example,  'telefone' is saved in the DB, then it is retrieved and printed in the view.  In file mapos-master\application\controllers\Clientes.php  ``` $data = [     //...     'telefone' => $this->input->post('telefone'),     //... ]; if ($this->clientes_model->edit('clientes', $data, 'idClientes', $this->input->post('idClientes')) == true) {       //....   } ```  ```     public function edit($table, $data, $fieldID, $ID)     {         $this->db->where($fieldID, $ID);         $this->db->update($table, $data);          if ($this->db->affected_rows() >= 0) {             return true;         }          return false;     } ```  In file mapos-master\application\controllers\Relatorios.php  ``` $data['clientes'] = $this->Relatorios_model->clientesCustom($dataInicial, $dataFinal, $this->input->get('tipocliente')); //... $data['topo'] = $this->load->view('relatorios/imprimir/imprimirTopo', $data, true); ```  ``` public function clientesCustom($dataInicial = null, $dataFinal = null, $tipo = null) {     $whereData = '';     if ($dataInicial != null) {         $whereData .= "AND dataCadastro >= " . $this->db->escape($dataInicial);     }     if ($dataFinal != null) {         $whereData .= "AND dataCadastro <= " . $this->db->escape($dataFinal);     }     if ($tipo != null) {         $whereData .= "AND fornecedor = " . $this->db->escape($tipo);     }     $query = "SELECT * FROM clientes WHERE dataCadastro $whereData ORDER BY nomeCliente";      return $this->db->query($query, [$dataInicial, $dataFinal])->result(); } ```  In file  ```  <?php foreach ($clientes as $c) : ?>  <td align="center"><?= $c->telefone ?></td> ```  Another example,  In file mapos-master\application\views\arquivos\arquivos.php  ``` <input type="text" name="pesquisa" id="pesquisa" placeholder="Digite o nome do documento para pesquisar" class="span12" value="<?= $this->input->get('pesquisa') ?>"> ```  If you agree with the vulnerabilities, I will report the other vulnerabilities. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=40&u=306bd5db1ff98fab763546b43495f436b1e1095e&v=4)](/enferas)
[enferas](/enferas)
added
the
[bug](/RamonSilva20/mapos/labels/bug)
label
[Dec 25, 2022](#event-8108815378)

[![@RamonSilva20](https://avatars.githubusercontent.com/u/12385697?s=80&u=ef1337216ad86864942d53c2e72fa069c4b16183&v=4)](/RamonSilva20)

Copy link

Owner

### **[RamonSilva20](/RamonSilva20)** commented [Dec 25, 2022](#issuecomment-1364754335)

| Hello.  Thank you for the warning.  The sanitization is done by the framework.  Were you able to inject a script? |
| --- |

All reactions

Sorry, something went wrong.

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=80&u=306bd5db1ff98fab763546b43495f436b1e1095e&v=4)](/enferas)

Copy link

Author

### **[enferas](/enferas)** commented [Dec 26, 2022](#issuecomment-1365235649) • edited Loading

| Thank you for your response.  The default configuration in CodeIgniter after running the composer doesn't do the sanitization.  So after running the command `composer install --no-dev`, I checked the configuration and I found.  ``` /* |-------------------------------------------------------------------------- | Global XSS Filtering |-------------------------------------------------------------------------- | | Determines whether the XSS filter is always active when GET, POST or | COOKIE data is encountered | | WARNING: This feature is DEPRECATED and currently available only |          for backwards compatibility purposes! | */ $config['global_xss_filtering'] = FALSE; ```  Thus, if the developer run the composer then use the application without changing the configuration, he will face many XSS vulnerabilities in the application.  The other option is to force that the sanitization should be applied at the input. [Post in CI](https://codeigniter.com/userguide3/libraries/input.html#CI_Input::post)  ``` $this->input->post('key', TRUE); // XSS Clean $this->input->post('key', FALSE); // No XSS filter ```  Finally, CodeIgniter mention that Global XSS Filtering is DEPRECATED and it is better to apply the sanitization at the output not the input. [XSS filtering in CI](https://www.codeigniter.com/userguide3/libraries/input.html?highlight=xss#xss-filtering)  Important: The ‘global\_xss\_filtering’ setting is DEPRECATED and kept solely for backwards-compatibility purposes. XSS escaping should be performed on output, not input! |
| --- |

All reactions

Sorry, something went wrong.

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=80&u=306bd5db1ff98fab763546b43495f436b1e1095e&v=4)](/enferas)

Copy link

Author

### **[enferas](/enferas)** commented [Dec 29, 2022](#issuecomment-1367570203) • edited Loading

| [@RamonSilva20](https://github.com/RamonSilva20)  Hello,  If you agree with me that if the user will run the composer then the xss filer configuration will be FALSE. For this reason, I provide the current pull request which will sanitize all the input even if global\_xss\_filtering is FALSE.  [#2015](https://github.com/RamonSilva20/mapos/pull/2015) |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Jan 29, 2023](#issuecomment-1407517452)

| Esta issue está obsoleta porque está aberta há 30 dias sem atividade. Remova o rótulo ou esse comentário ou essa issue será fechada em 5 dias |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[Stale](/RamonSilva20/mapos/labels/Stale)
label
[Jan 29, 2023](#event-8380719039)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
closed this as [completed](/RamonSilva20/mapos/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 4, 2023](#event-8437276951)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FRamonSilva20%2Fmapos%2Fissues%2F2010)

Assignees

No one assigned

Labels

[bug](/RamonSilva20/mapos/labels/bug)
[Stale](/RamonSilva20/mapos/labels/Stale)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=52&v=4)](/enferas) [![@RamonSilva20](https://avatars.githubusercontent.com/u/12385697?s=52&v=4)](/RamonSilva20)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_f12ee08d_20250114_203425.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@enferas](https://avatars.githubusercontent.com/u/10528985?s=64&v=4)](/enferas)

# [enferas](/enferas)/**[XSS\_in\_mapos.md](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8)**

Created
December 25, 2022 22:28

Show Gist options

* [Download ZIP](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8/archive/06a1798a6cc734ddfabe7dc5f8e3c6d3e8180889.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/enferas/7c7f0a3c6cb30939d9039043c0b86ea8.js&quot;&gt;&lt;/script&gt;
* Save enferas/7c7f0a3c6cb30939d9039043c0b86ea8 to your computer and use it in GitHub Desktop.

[Code](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8)
[Revisions
1](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/enferas/7c7f0a3c6cb30939d9039043c0b86ea8.js&quot;&gt;&lt;/script&gt;

Save enferas/7c7f0a3c6cb30939d9039043c0b86ea8 to your computer and use it in GitHub Desktop.

[Download ZIP](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8/archive/06a1798a6cc734ddfabe7dc5f8e3c6d3e8180889.zip)

XSS\_in\_mapos

 [Raw](/enferas/7c7f0a3c6cb30939d9039043c0b86ea8/raw/06a1798a6cc734ddfabe7dc5f8e3c6d3e8180889/XSS_in_mapos.md)

[**XSS\_in\_mapos.md**](#file-xss_in_mapos-md)

Link: <https://github.com/RamonSilva20/mapos>

Multiple XSS vulnerabilities.

For example,

'telefone' is saved in the DB, then it is retrieved and printed in the view.

In file mapos-master\application\controllers\Clientes.php

```
$data = [
    //...
    'telefone' => $this->input->post('telefone'),
    //...
];
if ($this->clientes_model->edit('clientes', $data, 'idClientes', $this->input->post('idClientes')) == true) {
      //....
  }
```

```
    public function edit($table, $data, $fieldID, $ID)
    {
        $this->db->where($fieldID, $ID);
        $this->db->update($table, $data);

        if ($this->db->affected_rows() >= 0) {
            return true;
        }

        return false;
    }
```

In file mapos-master\application\controllers\Relatorios.php

```
$data['clientes'] = $this->Relatorios_model->clientesCustom($dataInicial, $dataFinal, $this->input->get('tipocliente'));
//...
$data['topo'] = $this->load->view('relatorios/imprimir/imprimirTopo', $data, true);
```

```
public function clientesCustom($dataInicial = null, $dataFinal = null, $tipo = null)
{
    $whereData = '';
    if ($dataInicial != null) {
        $whereData .= "AND dataCadastro >= " . $this->db->escape($dataInicial);
    }
    if ($dataFinal != null) {
        $whereData .= "AND dataCadastro <= " . $this->db->escape($dataFinal);
    }
    if ($tipo != null) {
        $whereData .= "AND fornecedor = " . $this->db->escape($tipo);
    }
    $query = "SELECT * FROM clientes WHERE dataCadastro $whereData ORDER BY nomeCliente";

    return $this->db->query($query, [$dataInicial, $dataFinal])->result();
}
```

In file

```
 <?php foreach ($clientes as $c) : ?>
 <td align="center"><?= $c->telefone ?></td>
```

Another example,

In file mapos-master\application\views\arquivos\arquivos.php

```
<input type="text" name="pesquisa" id="pesquisa" placeholder="Digite o nome do documento para pesquisar" class="span12" value="<?= $this->input->get('pesquisa') ?>">
```

If you agree with the vulnerabilities, I will report the other vulnerabilities.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fenferas%2F7c7f0a3c6cb30939d9039043c0b86ea8)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


