```json
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "content": [
    {
      "type": "docs.joinmastodon.org_edf923af_20250115_212254.html",
      "text": "  \n\n\n* [What is Mastodon?](/)\n* Using Mastodon\n  + [Signing up for an account](/user/signup/)\n  + [Setting up your profile](/user/profile/)\n  + [Posting to your profile](/user/posting/)\n  + [Using the network features](/user/network/)\n  + [Dealing with unwanted content](/user/moderating/)\n  + [Promoting yourself and others](/user/discoverability/)\n  + [Set your preferences](/user/preferences/)\n  + [More settings](/user/contacts/)\n  + [Using Mastodon externally](/user/external/)\n  + [Moving or leaving accounts](/user/moving/)\n  + [Running your own server](/user/run-your-own/)\n* Running Mastodon\n  + [Preparing your machine](/admin/prerequisites/)\n  + [Installing from source](/admin/install/)\n  + [Configuring your environment](/admin/config/)\n  + [Configuring full-text search](/admin/elasticsearch/)\n  + [Installing optional features](/admin/optional/)\n    - [Object storage](/admin/optional/object-storage/)\n    - [Onion services](/admin/optional/tor/)\n    - [Captcha](/admin/optional/captcha/)\n    - [Single Sign On](/admin/optional/sso/)\n  + [Setting up your new instance](/admin/setup/)\n  + [Using the admin CLI](/admin/tootctl/)\n  + [Upgrading to a new release](/admin/upgrading/)\n  + [Backing up your server](/admin/backups/)\n  + [Migrating to a new machine](/admin/migrating/)\n  + [Scaling up your server](/admin/scaling/)\n  + [Moderation actions](/admin/moderation/)\n  + [Troubleshooting errors](/admin/troubleshooting/)\n    - [Database index corruption](/admin/troubleshooting/index-corruption/)\n  + [Roles](/admin/roles/)\n* Developing Mastodon apps\n  + [Getting started with the API](/client/intro/)\n  + [Playing with public data](/client/public/)\n  + [Obtaining client app access](/client/token/)\n  + [Logging in with an account](/client/authorized/)\n  + [Libraries and implementations](/client/libraries/)\n* Contributing to Mastodon\n  + [Technical overview](/dev/overview/)\n  + [Setting up a dev environment](/dev/setup/)\n  + [Code structure](/dev/code/)\n  + [Routes](/dev/routes/)\n  + [Bug bounties and responsible disclosure](/dev/disclosure/)\n* Spec compliance\n  + [ActivityPub](/spec/activitypub/)\n  + [WebFinger](/spec/webfinger/)\n  + [Security](/spec/security/)\n  + [Microformats](/spec/microformats/)\n  + [OAuth](/spec/oauth/)\n  + [Bearcaps](/spec/bearcaps/)\n* REST API\n  + [Datetime formats](/api/datetime-format/)\n  + [Guidelines and best practices](/api/guidelines/)\n  + [OAuth Tokens](/api/oauth-tokens/)\n  + [OAuth Scopes](/api/oauth-scopes/)\n  + [Rate limits](/api/rate-limits/)\n* API Methods\n  + [apps](/methods/apps/)\n    - [oauth](/methods/oauth/)\n    - [emails](/methods/emails/)\n  + [accounts](/methods/accounts/)\n    - [bookmarks](/methods/bookmarks/)\n    - [favourites](/methods/favourites/)\n    - [mutes](/methods/mutes/)\n    - [blocks](/methods/blocks/)\n    - [domain_blocks](/methods/domain_blocks/)\n    - [filters](/methods/filters/)\n    - [reports](/methods/reports/)\n    - [follow_requests](/methods/follow_requests/)\n    - [endorsements](/methods/endorsements/)\n    - [featured_tags](/methods/featured_tags/)\n    - [preferences](/methods/preferences/)\n    - [followed_tags](/methods/followed_tags/)\n    - [suggestions](/methods/suggestions/)\n    - [tags](/methods/tags/)\n  + [profile](/methods/profile/)\n  + [statuses](/methods/statuses/)\n    - [media](/methods/media/)\n    - [polls](/methods/polls/)\n    - [scheduled_statuses](/methods/scheduled_statuses/)\n  + [timelines](/methods/timelines/)\n    - [conversations](/methods/conversations/)\n    - [lists](/methods/lists/)\n    - [markers](/methods/markers/)\n    - [streaming](/methods/streaming/)\n  + [grouped notifications](/methods/grouped_notifications/)\n  + [notifications](/methods/notifications/)\n    - [push](/methods/push/)\n  + [search](/methods/search/)\n  + [instance](/methods/instance/)\n    - [trends](/methods/trends/)\n    - [directory](/methods/directory/)\n    - [custom_emojis](/methods/custom_emojis/)\n    - [announcements](/methods/announcements/)\n  + [admin](/methods/admin/)\n    - [accounts](/methods/admin/accounts/)\n    - [canonical_email_blocks](/methods/admin/canonical_email_blocks/)\n    - [dimensions](/methods/admin/dimensions/)\n    - [domain_allows](/methods/admin/domain_allows/)\n    - [domain_blocks](/methods/admin/domain_blocks/)\n    - [email_domain_blocks](/methods/admin/email_domain_blocks/)\n    - [ip_blocks](/methods/admin/ip_blocks/)\n    - [measures](/methods/admin/measures/)\n    - [reports](/methods/admin/reports/)\n    - [retention](/methods/admin/retention/)\n    - [trends](/methods/admin/trends/)\n  + [proofs](/methods/proofs/)\n  + [oembed](/methods/oembed/)\n* API Entities\n  + [Account](/entities/Account/)\n  + [AccountWarning](/entities/AccountWarning/)\n  + [Admin::Account](/entities/Admin_Account/)\n  + [Admin::CanonicalEmailBlock](/entities/Admin_CanonicalEmailBlock/)\n  + [Admin::Cohort](/entities/Admin_Cohort/)\n  + [Admin::Dimension](/entities/Admin_Dimension/)\n  + [Admin::DomainAllow](/entities/Admin_DomainAllow/)\n  + [Admin::DomainBlock](/entities/Admin_DomainBlock/)\n  + [Admin::EmailDomainBlock](/entities/Admin_EmailDomainBlock/)\n  + [Admin::Ip](/entities/Admin_Ip/)\n  + [Admin::IpBlock](/entities/Admin_IpBlock/)\n  + [Admin::Measure](/entities/Admin_Measure/)\n  + [Admin::Report](/entities/Admin_Report/)\n  + [Announcement](/entities/Announcement/)\n  + [Appeal](/entities/Appeal/)\n  + [Application](/entities/Application/)\n  + [Context](/entities/Context/)\n  + [Conversation](/entities/Conversation/)\n  + [CustomEmoji](/entities/CustomEmoji/)\n  + [DomainBlock](/entities/DomainBlock/)\n  + [Error](/entities/Error/)\n  + [ExtendedDescription](/entities/ExtendedDescription/)\n  + [FamiliarFollowers](/entities/FamiliarFollowers/)\n  + [FeaturedTag](/entities/FeaturedTag/)\n  + [Filter](/entities/Filter/)\n  + [FilterKeyword](/entities/FilterKeyword/)\n  + [FilterResult](/entities/FilterResult/)\n  + [FilterStatus](/entities/FilterStatus/)\n  + [IdentityProof](/entities/IdentityProof/)\n  + [Instance](/entities/Instance/)\n  + [List](/entities/List/)\n  + [Marker](/entities/Marker/)\n  + [MediaAttachment](/entities/MediaAttachment/)\n  + [Notification](/entities/Notification/)\n  + [NotificationPolicy](/entities/NotificationPolicy/)\n  + [NotificationRequest](/entities/NotificationRequest/)\n  + [Poll](/entities/Poll/)\n  + [Preferences](/entities/Preferences/)\n  + [PreviewCard](/entities/PreviewCard/)\n  + [PreviewCardAuthor](/entities/PreviewCardAuthor/)\n  + [Reaction](/entities/Reaction/)\n  + [Relationship](/entities/Relationship/)\n  + [RelationshipSeveranceEvent](/entities/RelationshipSeveranceEvent/)\n  + [Report](/entities/Report/)\n  + [Role](/entities/Role/)\n  + [Rule](/entities/Rule/)\n  + [ScheduledStatus](/entities/ScheduledStatus/)\n  + [Search](/entities/Search/)\n  + [Status](/entities/Status/)\n  + [StatusEdit](/entities/StatusEdit/)\n  + [StatusSource](/entities/StatusSource/)\n  + [Suggestion](/entities/Suggestion/)\n  + [Tag](/entities/Tag/)\n  + [Token](/entities/Token/)\n  + [Translation](/entities/Translation/)\n  + [V1::Filter](/entities/V1_Filter/)\n  + [V1::Instance](/entities/V1_Instance/)\n  + [V1::NotificationPolicy](/entities/V1_NotificationPolicy/)\n  + [WebPushSubscription](/entities/WebPushSubscription/)\n# Moderation actions\n\nActions that can be taken against unwanted users or domains.\n\n* + [Moderating individual users](#individual-moderation)\n    - [Sensitive](#sensitive-user)\n    - [Freeze](#freeze-user)\n    - [Limit](#limit-user)\n    - [Suspend](#suspend-user)\n  + [Moderating entire websites](#server-wide-moderation)\n    - [Reject media](#reject-media)\n    - [Limit](#limit-server)\n    - [Suspend](#suspend-server)\n  + [Spam-fighting measures](#spam-fighting-measures)\n    - [Blocking by e-mail server](#blocking-by-e-mail-server)\n    - [Blocking by IP](#blocking-by-ip)\n    - [Webhooks for moderation-level events](#report-events-webhook)\n## Moderating individual users\n\nModeration in Mastodon is always applied locally, i.e. as seen from the particular server. An admin or moderator on one server cannot affect a user on another server, they can only affect the local copy on their own server.\n\nAs of v3.5.0, all default user moderation decisions will notify the affected user by email. The user can access an appeal page, where they can submit one appeal within 20 days of the decision. Moderators can approve or reject the appeal.\n\n### Sensitive\n\nWhen an account is marked as sensitive, all media that the user posts will be automatically [marked as sensitive](https://docs.joinmastodon.org/user/posting/#cw).\n\n### Freeze\n\nA Mastodon account can be frozen. This prevents the user from doing anything with the account, but all of the content is still there untouched. This limitation is reversible; the account can be unfrozen at any time. This limitation is only available for local users on your server.\n\nWhen a user’s account is frozen, they are redirected to their **Account Settings** page, where the following message is displayed:\n\n> You can no longer login to your account or use it in any other way, but your profile and other data remains intact.\n\nWhen the user’s account is unfrozen, normal functionality resumes.\n\n### Limit\n\nPreviously known as “silencing”. A limited account is hidden from all other users on that instance, except for its followers. All of the content is still there, and it can still be found via search, mentions, and following, but the content is invisible publicly.\n\nAt this moment, limit does not affect federation. A locally limited account is *not* limited automatically on other servers. Account limitations are reversible.\n\n### Suspend\n\nA Mastodon suspension means the account is effectively deleted. The account no longer appears in search, the profile page is gone, and all of the posts, uploads, followers, and all other data are removed publicly. However, all the data is available in the admin back-end for a period of 30 days from suspension. This is to give the user an opportunity to work with instance admins to resolve any potential issues and have the account re-instated.\n\nIf the account is reinstated within the 30-day period, all data is once again accessible publicly without any adverse effects. If the 30-day period lapses, **all** that user’s data is purged from the instance. Admins also have the option to immediately delete the user’s account data at any point during the 30 days.\n\nOnce the data has been deleted, whether that is after the 30-day period, or if an admin has force deleted it, the account can still be un-suspended. However, the account will have no data (statuses, profile information, avatar or header image) associated with it.\n\nFor remote accounts, suspending will make them unfollow any local account. Those relationships are not restored in case the remote account is unsuspended, even within the 30-day time window.\n\n## Moderating entire websites\n\nBecause individually moderating a large volume of users from a misbehaving server can be exhausting, it is possible to pre-emptively moderate against all users from that particular server using a so-called **domain block**, which comes with several different levels of severity.\n\n### Reject media\n\nWith this option active, no files from the server will be processed locally. That includes avatars, headers, emojis and media attachments.\n\n### Limit\n\nEquivalent to [limiting](/admin/moderation/#limit-user) all past and future accounts from the server. Previously known as “silencing”.\n\n### Suspend\n\nEquivalent to [suspending](/admin/moderation/#suspend-user) all past and future accounts from the server. No content from the server will be stored locally except for usernames.\n\nSuspending a server will remove all existing follow relationships between local accounts and accounts on the suspended server. They will not be restored in case the remote server is un-suspended later.\n\n## Spam-fighting measures\n\nThere are a few baseline measures for preventing spam in Mastodon:\n\n* Signing up requires confirming an e-mail address\n* Signing up is rate-limited by IP\n\nHowever, dedicated spammers will get through that. The other measure you can employ is **e-mail domain blacklisting**. During sign-up, Mastodon resolves the given e-mail address for an A or MX record, i.e. the IP address of the e-mail server, and checks that IP address against a dynamically stored blacklist.\n\n### Blocking by e-mail server\n\nSpammers will often use different e-mail domains so it looks like they are using a lot of different e-mail servers that would all be difficult to blacklist separately. However, sometimes all of those domains resolve to a single e-mail server IP. If you see a lot of spammers signing up at the same time, you can check for this, either using an online DNS lookup tool, or the Linux `dig` utility, e.g. `dig example.com` will return all DNS A records for that Domain. If you notice the IP is the same for all domains, you can add it to the e-mail domain blacklist.\n\n### Blocking by IP\n\nIt is not possible to block visitors by IP address in Mastodon itself, and it is not a foolproof strategy. IPs are sometimes shared by a lot of different people and sometimes change hands. However, it is possible to block visitors by IP address in Linux using a firewall. Here is an example using `iptables` and `ipset`:\n\n```\n# Install ipset\nsudo apt install ipset\n# Create blacklist named \"spambots\"\nsudo ipset create spambots nethash\n# Add 1.2.3.4 to the blacklist\nsudo ipset add spambots 1.2.3.4\n# Add firewall rule based on the blacklist\nsudo iptables -I INPUT 1 -m set --match-set spambots src -j DROP\n\n```\n\nBe careful not to lock yourself out of your machine.\n\n### Webhooks for moderation-level events\n\nWebhooks can be created to facilitate automation through the moderation API by notifying applications about system events in real-time. This also enables integrations with chat apps like Discord, IRC and Slack, helping moderator coordination.\n\nThe X-Hub-Signature header adopted from the WebSub spec can be optionally used to verify that the payloads are authentic.\n\nEvents currently supported:\n\n* account.approved\n* account.created\n* account.updated\n* report.created\n* report.updated\n* status.created\n* status.updated\n\n#### Example payload:\n\n```\n\n{\n   \"event\":\"report.created\",\n   \"created_at\":\"2023-10-26T13:34:00.351Z\",\n   \"object\":{\n      \"id\":\"8437\",\n      \"action_taken\":false,\n      \"action_taken_at\":null,\n      \"category\":\"violation\",\n      \"comment\":\"\",\n      \"forwarded\":true,\n      \"created_at\":\"2023-10-26T13:34:00.348Z\",\n      \"updated_at\":\"2023-10-26T13:34:00.348Z\",\n      \"account\":{\n         \"id\":\"123456789\",\n         \"username\":\"bobisaburger\",\n         \"domain\":null,\n         \"created_at\":\"2023-07-13T04:39:22.493Z\",\n         \"email\":\"bobisaburger@emailservice.com\",\n         \"ip\":\"12.34.56.78\",\n         \"confirmed\":true,\n         \"suspended\":false,\n         \"silenced\":false,\n         \"sensitized\":false,\n         \"disabled\":false,\n         \"approved\":true,\n         \"locale\":\"en\",\n         \"invite_request\":\"I would love to be a member of your instance!\",\n         \"ips\":[\n            {\n               \"ip\":\"12.34.56.78\",\n               \"used_at\":\"2023-07-13T04:45:31.835Z\"\n            },\n            {\n               \"ip\":\"98.76.54.32\",\n               \"used_at\":\"2023-07-13T04:39:22.722Z\"\n            }\n         ],\n         \"account\":{\n            \"id\":\"123456789\",\n            \"username\":\"bobisaburger\",\n            \"acct\":\"bobisaburger\",\n            \"display_name\":\"bobisaburger\",\n            \"locked\":false,\n            \"bot\":false,\n            \"discoverable\":null,\n            \"group\":false,\n            \"created_at\":\"2023-07-13T00:00:00.000Z\",\n            \"note\":\"\",\n            \"url\":\"https://mastodonwebsite/@bobisaburger\",\n            \"uri\":\"https://mastodonwebsite/users/bobisaburger\",\n            \"avatar\":\"https://locationofavatar.com/image.jpg\",\n            \"avatar_static\":\"https://locationofavatar.com/image.jpg\",\n            \"header\":\"locationofheader.com/image.jpg\",\n            \"header_static\":\"locationofheader.com/image.jpg\",\n            \"followers_count\":100,\n            \"following_count\":200,\n            \"statuses_count\":9,\n            \"last_status_at\":\"2023-08-05\",\n            \"noindex\":true,\n            \"emojis\":[\n\n            ],\n            \"roles\":[\n\n            ],\n            \"fields\":[\n\n            ]\n         },\n         \"role\":{\n            \"id\":\"-99\",\n            \"name\":\"\",\n            \"permissions\":\"65536\",\n            \"color\":\"\",\n            \"highlighted\":false\n         }\n      },\n      \"target_account\":{\n         \"id\":\"123454321\",\n         \"username\":\"cheeseperson\",\n         \"domain\":\"someothermastodonsite.com\",\n         \"created_at\":\"2023-08-20T00:00:00.000Z\",\n         \"email\":null,\n         \"ip\":null,\n         \"confirmed\":null,\n         \"suspended\":false,\n         \"silenced\":false,\n         \"sensitized\":false,\n         \"disabled\":null,\n         \"approved\":null,\n         \"locale\":null,\n         \"invite_request\":null,\n         \"ips\":null,\n         \"account\":{\n            \"id\":\"123454321\",\n            \"username\":\"cheeseperson\",\n            \"acct\":\"cheeseperson@someothermastodonsite.com\",\n            \"display_name\":\"cheeseperson\",\n            \"locked\":false,\n            \"bot\":false,\n            \"discoverable\":false,\n            \"group\":false,\n            \"created_at\":\"2023-08-20T00:00:00.000Z\",\n            \"note\":\"\",\n            \"url\":\"https://someothermastodonsite.com/@cheeseperson\",\n            \"uri\":\"https://someothermastodonsite.com/users/cheeseperson\",\n            \"avatar\":\"https://someothermastadonsite.com/avatars/original/missing.png\",\n            \"avatar_static\":\"https://someothermastadonsite.com/avatars/original/missing.png\",\n            \"header\":\"locationofheader.com/image.jpg\",\n            \"header_static\":\"locationofheader.com/image.jpg\",\n            \"followers_count\":2,\n            \"following_count\":2,\n            \"statuses_count\":95,\n            \"last_status_at\":\"2023-10-26\",\n            \"emojis\":[\n\n            ],\n            \"fields\":[\n\n            ]\n         },\n         \"role\":null\n      },\n      \"assigned_account\":null,\n      \"action_taken_by_account\":null,\n      \"statuses\":[\n         {\n            \"id\":\"12345678987654321\",\n            \"created_at\":\"2023-10-26T11:29:13.000Z\",\n            \"in_reply_to_id\":\"1918282746465\",\n            \"in_reply_to_account_id\":\"101010101010\",\n            \"sensitive\":false,\n            \"spoiler_text\":\"\",\n            \"visibility\":\"public\",\n            \"language\":\"de\",\n            \"uri\":\"https://someothermastodonsite.com/users/cheeseperson/statuses/111301083360371621\",\n            \"url\":\"https://someothermastodonsite.com/@cheeseperson/111301083360371621\",\n            \"replies_count\":0,\n            \"reblogs_count\":0,\n            \"favourites_count\":0,\n            \"edited_at\":\"2023-10-26T11:30:31.000Z\",\n            \"content\":\"<p>Here is some content</p>\",\n            \"reblog\":null,\n            \"account\":{\n               \"id\":\"123454321\",\n               \"username\":\"cheeseperson\",\n               \"acct\":\"cheeseperson@someothermastodonsite.com\",\n               \"display_name\":\"cheeseperson\",\n               \"locked\":false,\n               \"bot\":false,\n               \"discoverable\":false,\n               \"group\":false,\n               \"created_at\":\"2023-08-20T00:00:00.000Z\",\n               \"note\":\"\",\n               \"url\":\"https://someothermastodonsite.com/@cheeseperson\",\n               \"uri\":\"https://someothermastodonsite.com/users/cheeseperson\",\n               \"avatar\":\"https://someothermastadonsite.com/avatars/original/missing.png\",\n               \"avatar_static\":\"https://someothermastadonsite.com/avatars/original/missing.png\",\n               \"header\":\"locationofheader.com/image.jpg\",\n               \"header_static\":\"locationofheader.com/image.jpg\",\n               \"followers_count\":2,\n               \"following_count\":2,\n               \"statuses_count\":95,\n               \"last_status_at\":\"2023-10-26\",\n               \"emojis\":[\n\n               ],\n               \"fields\":[\n\n               ]\n            },\n            \"media_attachments\":[\n\n            ],\n            \"mentions\":[\n               {\n                  \"id\":\"101010101010\",\n                  \"username\":\"thirdperson\",\n                  \"url\":\"https://thirdpersonsinstance.com/@thirdperson\",\n                  \"acct\":\"thirdperson@emailwebsite.com\"\n               }\n            ],\n            \"tags\":[\n\n            ],\n            \"emojis\":[\n\n            ],\n            \"card\":null,\n            \"poll\":null\n         }\n      ],\n      \"rules\":[\n         {\n            \"id\":\"2\",\n            \"text\":\"Don't be a meanie!\"\n         }\n      ]\n   }\n}\n\n```\n\nLast updated December 7, 2023 · [Improve this page](https://github.com/mastodon/documentation/tree/main/content/en/admin/moderation.md)\nAlso available in:\n[简体中文](/zh-cn/admin/moderation/)\n\n## Sponsored by\n\n[![Dotcom-Monitor](/assets/sponsors/dotcom-monitor-logo.png)](https://www.dotcom-monitor.com/es/)[![LoadView](/assets/sponsors/LoadView-logo.png)](https://www.loadview-testing.com/products/jmeter-load-testing/)[![Stephen Tures](/assets/sponsors/stephen-tures.jpg)](http://www.stevetures.com/)[![Swayable](/assets/sponsors/swayable.jpeg)](https://swayable.com)[![SponsorMotion](/assets/sponsors/SponsorMotion.png)](https://www.sponsormotion.com/)\n\n[Join Mastodon](https://joinmastodon.org) · [Blog](https://blog.joinmastodon.org) ·\n\n[View source](https://github.com/mastodon/documentation/tree/main/content/en/admin/moderation.md) · [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/) · [Imprint](https://joinmastodon.org/imprint)"
    },
    {
      "type": "github.com_24f7cfc3_20250115_212250.html",
      "text": "# Moderator identity disclosure in Mastodon when approving appeal of sensitive marked statuses\n## Advisory Info\n- Vendor: [Mastodon gGmbH](https://github.com/mastodon)\n- Product: [Mastodon](https://github.com/mastodon/mastodon)\n- Affected Versions: >= 3.5.0 < 3.5.3\n- Patched Versions: 3.5.3\n- Vendor Publication Date: 2022-05-26\n## Vulnerability Info\n- Weakness: [CWE-200: Exposure of Sensitive Information to an Unauthorized Actor](https://cwe.mitre.org/data/definitions/200.html)\n- CVE: [CVE-2022-48364](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48364)\n## Summary\nMastodon [v3.5.0](https://github.com/mastodon/mastodon/releases/tag/v3.5.0) introduced the ability for users to [appeal](https://docs.joinmastodon.org/admin/moderation/#individual-moderation) moderation actions taken by moderators on their instance.\n\nEach Mastodon instance has a special account that represents the instance (often referred to as the representative account or [instance actor](https://github.com/mastodon/mastodon/issues/10453)) which is based on the instance's [domain name](https://docs.joinmastodon.org/admin/config/#local_domain) (`LOCAL_DOMAIN`).\n\nThe appeals feature in Mastodon uses the representative account to prevent the identity of the acting moderator from being revealed in the edit histories of the appealed posts they approve or deny.\n\nBetween Mastodon versions 3.5.0 and 3.5.3, the `undo_mark_statuses_as_sensitive` method in [approve_appeal_service.rb](https://github.com/mastodon/mastodon/blob/25d3dc4373531071f444d8e44e44cd21970cb373/app/services/approve_appeal_service.rb#L56) used the logged-in user context `@current_account.id` instead of the representative account context `representative_account.id` in the call to `UpdateStatusService`:\n```diff\ndiff --git a/app/services/approve_appeal_service.rb b/app/services/approve_appeal_service.rb\nindex 37a08b46e386..96aaaa7d078b 100644\n--- a/app/services/approve_appeal_service.rb\n+++ b/app/services/approve_appeal_service.rb\n@@ -52,8 +52,9 @@ def undo_delete_statuses!\n   end\n \n   def undo_mark_statuses_as_sensitive!\n+    representative_account = Account.representative\n     @strike.statuses.includes(:media_attachments).each do |status|\n-      UpdateStatusService.new.call(status, @current_account.id, sensitive: false) if status.with_media?\n+      UpdateStatusService.new.call(status, representative_account.id, sensitive: false) if status.with_media?\n     end\n   end\n```\nThis resulted in moderator identity disclosure when a moderator or admin approved the appeal of a user whose media post was marked as sensitive. The user who performed the reversal would have been recorded in the edit history for the post which can be viewed by anyone who can see the post.\n## Steps to Reproduce\n1. As a user on a Mastodon instance (herein `https://instance`), make a status update with a photo or video attached.\n2. As a moderator or admin on the same instance, open the status update in the admin panel and select \"Report\" followed by \"Mark as sensitive\".\n3. As the poster, browse to [https://instance/disputes/strikes](https://instance/disputes/strikes), select the strike, and submit the appeal form.\n4. As the moderator, browse to [https://instance/admin/disputes/appeals?status=pending](https://instance/admin/disputes/appeals?status=pending), select the appeal, and approve it.\n5. As either user, browse to the status update and select the \"Edited\" dropdown. Observe that the acting moderator's identity is shown in the edit history instead of the representative account's identity.\n## Impact\nMastodon users whose media posts were marked as sensitive by moderators and later successfully appealed would have been able to identify the user who performed the reversal.\n## Recommendations\nIf you run a Mastodon server, you should update to Mastodon version 3.5.3 or above. Other ActivityPub server implementations are not affected.\n## Timeline\n- 2022-04-20: Vulnerability discovered\n- 2022-04-20: Vulnerability reported to vendor\n- 2022-04-21: Vendor acknowledged receipt of advisory\n- 2022-05-26: Vendor committed fix ([PR #18525](https://github.com/mastodon/mastodon/pull/18525))\n- 2022-05-26: Vendor released fix ([v3.5.3](https://github.com/mastodon/mastodon/releases/tag/v3.5.3))\n- 2022-05-26: Vendor disclosed via release changelog"
    },
    {
      "type": "github.com_94d96a89_20250115_212254.html",
      "text": "# Search code, repositories, users, issues, pull requests...\n\nSearch\n\nClear\n\n[Search syntax tips](https://docs.github.com/search