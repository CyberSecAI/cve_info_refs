- **Root cause of vulnerability:** The Checkmk server, when using the Agent updater, logs the host secret to the `cmk-update-agent.log` file. This file is not protected and usually world-readable.
- **Weaknesses/vulnerabilities present:**
    - Exposure of sensitive information: The host secret, which is used to download new agents, is logged in a world-readable log file.
    - Indirect exposure of other secrets: The downloaded agent package contains plugin configurations that might include other sensitive information like database credentials.
- **Impact of exploitation:** An attacker who gains access to the log file can use the host secret to download the current agent package, potentially gaining access to other secrets contained within the agent configuration files.
- **Attack vectors:** Local access to the Checkmk server file system is required to read the `cmk-update-agent.log` file.
- **Required attacker capabilities/position:** An attacker needs local file system access on the Checkmk server and the ability to read files on the system. The vulnerability is exploitable by a user with low privileges (PR:L).