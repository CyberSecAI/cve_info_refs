=== Content from sisl.lab.uic.edu_0bc40803_20250115_080559.html ===


[University of Illinois Chicago](https://www.uic.edu/)
Search the site

Toggle Menu

Search

[University of Illinois Chicago](https://www.uic.edu/)

[Systems and Internet Security Lab](https://sisl.lab.uic.edu)

* [Projects](/projects/)
  Expand Projects menu

  + [CHESS](/projects/chess/)
  + [MARPLE](/projects/marple/)
  + [CSFV](/projects/csfv/)
  + [ESP-IGERT](/projects/esp-igert-2/)
  + [MALDIVES](/projects/maldives/)
* [People](/people/)
* [Publications](/publications/)
* [News](/news/)
* [Contact](/contact/)

* [Computer Science](https://www.cs.uic.edu/)
* [College of Engineering](https://engineering.uic.edu/)

* [UIC.edu](http://uic.edu)
* [Campus Map](http://maps.uic.edu/)

Search

[## Systems and Internet Security Lab

## UIC Computer Science](https://sisl.lab.uic.edu)

[View Menu
Down arrow icon](#menu-secondary)

1. [Systems and Internet Security Lab](https://sisl.lab.uic.edu)
2. [Projects](https://sisl.lab.uic.edu/projects/)
3. [CHESS](https://sisl.lab.uic.edu/projects/chess/)
4. Stored Cross Site Scripting Vulnerabilities in Hospital Management System Gurukul v4.0 #3

# Stored Cross Site Scripting Vulnerabilities in Hospital Management System Gurukul v4.0 #3

## Cross site scripting in Hospital Management System Gurukul v4.0 [Heading link](#cross-site-scripting-in-hospital-management-system-gurukul-v4-0) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

Multiple **stored cross site scripting vulnerabilities** are present in [Hospital Management System Gurukul v4.0](https://phpgurukul.com/hospital-management-system-in-php/)

The files **doctor/view-patient.php**, **admin/view-patient.php**and **view-medhistory.php** share a common piece of code where several **POST** **parameters** are directly used into the INSERT SQL query without any kind of escaping or sanitization.

```
    /* ... */

if(isset($_POST['submit']))
{
```
```
    $vid=$_GET['viewid'];
    $bp=$_POST['bp'];
    $bs=$_POST['bs'];
    $weight=$_POST['weight'];
    $temp=$_POST['temp'];
    $pres=$_POST['pres'];

    $query.=mysqli_query($con,"insert tblmedicalhistory(PatientID,BloodPressure,BloodSugar,Weight,Temperature,MedicalPres)
value('$vid','$bp','$bs','$weight','$temp','$pres')");
```
```

    /* ... */
```

In the same files, the data that was inserted by the above-mentioned query is retrieved from the database and added to the current page.

```

    /* ...*/

while ($row=mysqli_fetch_array($ret)) {

    echo $cnt;
    echo $row['BloodPressure'];
    echo $row['Weight'];
    echo $row['BloodSugar'];
    echo $row['Temperature'];
    echo $row['MedicalPres'];
    echo $row['CreationDate'];

    /* ... */

```

The vulnerable parameters through which the attack can be carried out are **bp**, **bs**, **weight**, **temp** and **pres** POST parameters.

The following is one of the possible exploitation using the **pres POST parameter**.

```
POST /hospitalmanagementsystemproject4/hospital/hms/doctor/view-patient.php?viewid=3 HTTP/1.1
Host: localhost
Content-Length: 94
Cache-Control: max-age=0
sec-ch-ua: "Chromium";v="105", "Not)A;Brand";v="8"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Linux"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/hospitalmanagementsystemproject4/hospital/hms/doctor/view-patient.php?viewid=3
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=lrqh66ialqjgfot5rcq90bnvjj
Connection: close

bp=120%2F85&bs=12&weight=70kg&temp=36&pres=[url-encoded-script]&submit=

```

An attacker can easily inject malicious Javascript into the database and steal session cookies from users and administrators.

These vulnerabilities were found by Riccardo Nannini using the CLAY project developed at SISL lab in UIC and have been assigned CVE-2022-42206.

## [Projects](https://sisl.lab.uic.edu/projects/)

[Back to main content](#red-main)

* [CHESS](/projects/chess/)
* [MARPLE](/projects/marple/)
* [CSFV](/projects/csfv/)
* [ESP-IGERT](/projects/esp-igert-2/)
* [MALDIVES](/projects/maldives/)

 [University of Illinois Chicago](https://www.uic.edu/)

## Contact

## Social Media Accounts

## UIC.edu links

* **[UIC.edu](https://uic.edu/)**
* [Academic Calendar](https://catalog.uic.edu/ucat/academic-calendar/)
* [Athletics](https://uicflames.com/)
* [Campus Directory](https://www.uic.edu/apps/departments-az/search)
* [Disability Resources](https://disabilityresources.uic.edu/)
* [Emergency Information](https://emergency.uic.edu/)
* [Event Calendar](https://today.uic.edu/events)
* [Job Openings](https://uic.edu/about/job-opportunities)
* [Library](https://library.uic.edu/)
* [Maps](https://maps.uic.edu/)
* [UIC Safe Mobile App](https://ready.uic.edu/digital-materials/uic-safe-mobile-app/)
* [UIC Today](https://today.uic.edu/)
* [UI Health](https://uihealth.uic.edu/)
* [Veterans Affairs](https://dos.uic.edu/student-veterans-affairs/)
* [Report a Concern](https://reportaconcern.uic.edu/)

Powered by Red 3.0.51
© 2025 The Board of Trustees of the University of Illinois |
[Privacy Statement](https://www.vpaa.uillinois.edu/resources/web_privacy)

## Campuses

* [University of Illinois System](https://www.uillinois.edu/)
* [Urbana-Champaign](https://illinois.edu/)
* [Springfield](https://www.uis.edu/)
* [Chicago](https://www.uic.edu/)


