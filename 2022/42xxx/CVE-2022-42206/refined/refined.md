- **Root cause of vulnerability:** The application directly uses POST parameters within an SQL INSERT query without any escaping or sanitization. This allows an attacker to inject malicious code. The data inserted is later retrieved and displayed on the page without sanitization, enabling cross-site scripting (XSS).
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code into the database, which will be executed when a user views the affected page. This can lead to session cookie theft and other malicious actions.
- **Attack vectors:** By sending a crafted POST request to vulnerable files, an attacker can inject malicious script through the `bp`, `bs`, `weight`, `temp`, and `pres` POST parameters.
- **Required attacker capabilities/position:** The attacker must be able to send a POST request to the vulnerable pages with crafted input.