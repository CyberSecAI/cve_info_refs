- **Root cause of vulnerability**: The application fails to sanitize user-controlled input before inserting it into the database and displaying it on subsequent pages. Specifically, the `add-patient.php` file directly uses POST parameters in an SQL INSERT query without proper escaping or sanitization.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerabilities exist due to the lack of input sanitization. The vulnerable parameters are `patname`, `patemail`, `gender`, `pataddress`, and `medhis`.
- **Impact of exploitation**: An attacker can inject malicious JavaScript code into the database via the vulnerable parameters. This code will be executed in the browsers of users and administrators who view the affected pages. This can lead to session hijacking, information theft (e.g. cookies), or other malicious activities.
- **Attack vectors**: The attack vector is through HTTP POST requests to the `add-patient.php` file. By crafting a malicious payload in the POST parameters, especially `medhis`, an attacker can inject malicious javascript into the database.
- **Required attacker capabilities/position**: An attacker needs to be able to submit POST requests to the `add-patient.php` script. No specific authentication is mentioned, it can be assumed that a user with access to the add patient page can conduct the attack.