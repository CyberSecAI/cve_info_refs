=== Content from www.zerodayinitiative.com_9e151b8e_20250114_182523.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

October 21st, 2022
## Linux Kernel nftables Uninitialized Variable Information Disclosure Vulnerability

### ZDI-22-1457ZDI-CAN-18540

| CVE ID | [CVE-2022-42432](https://www.cve.org/CVERecord?id=CVE-2022-42432) |
| --- | --- |
| CVSS SCORE | 5.1, [AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:L](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:L) |
| AFFECTED VENDORS | [Linux](https://www.linux.org/) |
| AFFECTED PRODUCTS | Kernel |
| VULNERABILITY DETAILS | This vulnerability allows local attackers to disclose sensitive information on affected installations of the Linux Kernel. An attacker must first obtain the ability to execute high-privileged code on the target system in order to exploit this vulnerability.  The specific flaw exists within the nft\_osf\_eval function. The issue results from the lack of proper initialization of memory prior to accessing it. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of the kernel. |
| ADDITIONAL DETAILS | Linux has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2022-09-06 - Vulnerability reported to vendor * 2022-10-21 - Coordinated public release of advisory |
| CREDIT | Gwangun Jung at THEORI |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from patchwork.ozlabs.org_dea1aa4b_20250114_182522.html ===

Toggle navigation

[Patchwork](/)
Netfilter Development

* [Patches](/project/netfilter-devel/list/)
* [Bundles](/project/netfilter-devel/bundles/)
* [About this project](/project/netfilter-devel/)

* [Login](/user/login/)
* [Register](/register/)
* [Mail settings](/mail/)

1675185

[diff](/project/netfilter-devel/patch/20220907082618.1193201-1-pablo%40netfilter.org/raw/ "Download patch diff")
[mbox](/project/netfilter-devel/patch/20220907082618.1193201-1-pablo%40netfilter.org/mbox/ "Download patch mbox")
[series](/series/317228/mbox/ "Download patch mbox with dependencies")
# [nf] netfilter: nfnetlink\_osf: fix possible bogus match in nf\_osf\_find()

| Message ID | 20220907082618.1193201-1-pablo@netfilter.org |
| --- | --- |
| State | Accepted, archived |
| Delegated to: | Pablo Neira |
| Headers | show ``` Return-Path: <netfilter-devel-owner@vger.kernel.org> X-Original-To: incoming@patchwork.ozlabs.org Delivered-To: patchwork-incoming@legolas.ozlabs.org Authentication-Results: legolas.ozlabs.org;  spf=pass (sender SPF authorized) smtp.mailfrom=vger.kernel.org  (client-ip=2620:137:e000::1:20; helo=out1.vger.email;  envelope-from=netfilter-devel-owner@vger.kernel.org; receiver=<UNKNOWN>) Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20]) 	by legolas.ozlabs.org (Postfix) with ESMTP id 4MMwMT1P2Cz1yhd 	for <incoming@patchwork.ozlabs.org>; Wed,  7 Sep 2022 18:26:29 +1000 (AEST) Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand         id S229621AbiIGI00 (ORCPT <rfc822;incoming@patchwork.ozlabs.org>);         Wed, 7 Sep 2022 04:26:26 -0400 Received: from lindbergh.monkeyblade.net ([23.128.96.19]:39912 "EHLO         lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org         with ESMTP id S229464AbiIGI00 (ORCPT         <rfc822;netfilter-devel@vger.kernel.org>);         Wed, 7 Sep 2022 04:26:26 -0400 Received: from mail.netfilter.org (mail.netfilter.org [217.70.188.207])         by lindbergh.monkeyblade.net (Postfix) with ESMTP id 07D7495AEF         for <netfilter-devel@vger.kernel.org>;  Wed,  7 Sep 2022 01:26:23 -0700 (PDT) From: Pablo Neira Ayuso <pablo@netfilter.org> To: netfilter-devel@vger.kernel.org Subject: [PATCH nf] netfilter: nfnetlink_osf: fix possible bogus match in  nf_osf_find() Date: Wed,  7 Sep 2022 10:26:18 +0200 Message-Id: <20220907082618.1193201-1-pablo@netfilter.org> X-Mailer: git-send-email 2.30.2 MIME-Version: 1.0 Content-Transfer-Encoding: 8bit X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,SPF_HELO_NONE,         SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham autolearn_force=no         version=3.4.6 X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on         lindbergh.monkeyblade.net Precedence: bulk List-ID: <netfilter-devel.vger.kernel.org> X-Mailing-List: netfilter-devel@vger.kernel.org ``` |
| Series | [[nf] netfilter: nfnetlink\_osf: fix possible bogus match in nf\_osf\_find()](/project/netfilter-devel/list/?series=317228) | expand   * [nf] netfilter: nfnetlink\_osf: fix possible bogus match in nf\_osf\_find() |

## Commit Message

[Pablo Neira Ayuso](/project/netfilter-devel/list/?submitter=1315)
Sept. 7, 2022, 8:26 a.m. UTC
```

nf_osf_find() incorrectly returns true on mismatch, this leads to
copying uninitialized memory area in nft_osf which can be used to leak
stale kernel stack data to userspace.

Fixes: 22c7652cdaa8 ("netfilter: nft_osf: Add version option support")
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
---
 net/netfilter/nfnetlink_osf.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

```

1675185

[diff](/project/netfilter-devel/patch/20220907082618.1193201-1-pablo%40netfilter.org/raw/ "Download patch diff")
[mbox](/project/netfilter-devel/patch/20220907082618.1193201-1-pablo%40netfilter.org/mbox/ "Download patch mbox")
[series](/series/317228/mbox/ "Download patch mbox with dependencies")
## Patch

```

diff --git a/net/netfilter/nfnetlink_osf.c b/net/netfilter/nfnetlink_osf.c
index 0fa2e2030427..ee6840bd5933 100644
--- a/net/netfilter/nfnetlink_osf.c
+++ b/net/netfilter/nfnetlink_osf.c
@@ -269,6 +269,7 @@  bool nf_osf_find(const struct sk_buff *skb,
 	struct nf_osf_hdr_ctx ctx;
 	const struct tcphdr *tcp;
 	struct tcphdr _tcph;
+	bool found = false;

 	memset(&ctx, 0, sizeof(ctx));

@@ -283,10 +284,11 @@  bool nf_osf_find(const struct sk_buff *skb,

 		data->genre = f->genre;
 		data->version = f->version;
+		found = true;
 		break;
 	}

-	return true;
+	return found;
 }
 EXPORT_SYMBOL_GPL(nf_osf_find);

```

[patchwork](http://jk.ozlabs.org/projects/patchwork/)
patch tracking system | version 2.2.0. | [about patchwork](/about/)


