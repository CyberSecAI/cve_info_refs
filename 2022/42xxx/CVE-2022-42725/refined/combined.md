=== Content from github.com_139c7171_20250114_203846.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2Ff4907ef6a17a189d56ab0a9da4b53190b061ad75)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2Ff4907ef6a17a189d56ab0a9da4b53190b061ad75)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=linuxmint%2Fwarpinator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[warpinator](/linuxmint/warpinator)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fwarpinator) You must be signed in to change notification settings
* [Fork
  85](/login?return_to=%2Flinuxmint%2Fwarpinator)
* [Star
   1.3k](/login?return_to=%2Flinuxmint%2Fwarpinator)

* [Code](/linuxmint/warpinator)
* [Issues
  62](/linuxmint/warpinator/issues)
* [Pull requests
  0](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

Additional navigation options

* [Code](/linuxmint/warpinator)
* [Issues](/linuxmint/warpinator/issues)
* [Pull requests](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

## Commit

[Permalink](/linuxmint/warpinator/commit/f4907ef6a17a189d56ab0a9da4b53190b061ad75)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

transfers: Use g\_file\_query\_exists() instead of g\_file\_test().

[Browse files](/linuxmint/warpinator/tree/f4907ef6a17a189d56ab0a9da4b53190b061ad75)
Browse the repository at this point in the history

```
When checking for existing files, g_file_test (and os.path.exists)
both follow symbolic links, whereas g_file_query_exists() notices
the link itself.

In both cases the link (and not the link's target) would have been
overwritten, but now the recipient will know about it.
```

* Loading branch information

[![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=40&v=4)](/mtwebster)

[mtwebster](/linuxmint/warpinator/commits?author=mtwebster "View all commits by mtwebster")
committed
Sep 20, 2022

1 parent
[5244c33](/linuxmint/warpinator/commit/5244c33d4c109ede9607b9d94461650410e2cddc)

commit f4907ef

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[src/util.py](#diff-c1055598f6b9a20cb1e01a08bba1db12b0b4dd8ceab91696ea6df74354081725 "src/util.py")

Show comments

[View file](/linuxmint/warpinator/blob/f4907ef6a17a189d56ab0a9da4b53190b061ad75/src/util.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -263,7 +263,8 @@ def files\_exist(base\_names): |
|  |  | for name in base\_names: |
|  |  | path = os.path.join(prefs.get\_save\_path(), name) |
|  |  | logging.debug("(server side) Checking if file or folder %s already exists." % (path,)) |
|  |  | if GLib.file\_test(path, GLib.FileTest.EXISTS): |
|  |  | file = Gio.File.new\_for\_path(path) |
|  |  | if file.query\_exists(None): |
|  |  | return True |
|  |  |  |
|  |  | return False |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f4907ef`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2Ff4907ef6a17a189d56ab0a9da4b53190b061ad75) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_c2a0ba6d_20250114_203836.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2022/10/23/2) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Y1aKsQY3KEVt0aAl@kasco.suse.de>
Date: Mon, 24 Oct 2022 14:53:05 +0200
From: Matthias Gerstner <mgerstner@...e.de>
To: oss-security@...ts.openwall.com
Subject: Warpinator remote file creation / overwrite security issue
 (CVE-2022-42725)

Hello list,

this report is about a remote file creation / overwrite issue I found in
Warpinator [1]. The release under review for this report was Warpinator
version 1.2.13.

1) About Warpinator
===================

Warpinator is a graphical application to easily transfer files between
hosts on a local network in a decentralized manner. To find other users
on the network a zeroconf protocol is used.

2) Connection Setup and Trust Model
===================================

The main connection between two instances of Warpinator is established
using SSL. To establish trust a shared symmetric key derived from what
is called a "group code" is used. Each instance of Warpinator provides a
randomly generated public SSL certificate in an encrypted form over the
network. It is encrypted symmetrically based on the group code via the
libsodium "SecretBox" API. According to libsodium documentation [2] this
API employs the following cryptographic algorithms:

Encryption: XSalsa20 stream cipher
Authentication: Poly1305 MAC

Although it seems unusual to make the public SSL certificate actually
secret in this approach it seems safe in so far as without it no one
will be able to establish the encrypted SSL connection. Once the SSL
connection is established no further authentication or authenticity
checks happen in the Warpinator RPC protocol.

An issue with the group code, though, is that is has the default value
of "Warpinator". The project's README of the reviewed version states:

    Do not leave it as the default "Warpinator".

During runtime the application does not undertake any efforts to bring
this to the user's attention, but starts to operate using the default
group code right away. A user has to consciously change this group code
in the settings dialog to achieve a trusted setup. Therefore I fear
there is a high risk of users keeping this default setup and thus
possibly trusting arbitrary other instances of Warpinator on the same
network.

This could allow malicious actors on the same network to act as a
man-in-the-middle to intercept transferred data. The authenticity of the
randomly generated SSL certificates used is not verified otherwise by
Warpinator as far as I can see, so the group code is the only means of
establishing trust between Warpinator instances.

3) File Creation / Overwrite Issue (CVE-2022-42725)
===================================================

I noticed that Warpinator does not manage to confine uploaded data
properly to the configured upload directory (~/Warpinator by default).
Warpinator trusts the remote Warpinator instance regarding the path
names and other metadata that are transferred. Furthermore the
file information displayed in confirmation dialogs is not necessarily
reflecting what the peer is actually sending.

The following code change allows a simple demonstration of this:

  diff --git a/src/transfers.py b/src/transfers.py
  index 0996738..dc27433 100644
  --- a/src/transfers.py
  +++ b/src/transfers.py
  @@ -138,7 +138,7 @@ class FileSender(GObject.Object):
                           else:
                               time = None

  -                        yield warp_pb2.FileChunk(relative_path=file.relative_path,
  +                        yield warp_pb2.FileChunk(relative_path="../.bashrc",
                                                    file_type=file.file_type,
                                                    chunk=b.get_data(),
                                                    file_mode=file.file_mode,

This patch simply unconditionally changes the `relative_path` field
reported during uploads to "../.bashrc". If a file is sent from a
malicious Warpinator instance using this changed code then the uploaded
file content will appear on the victim's system in $HOME/.bashrc,
without the user being aware of this from GUI messages. It will solely
be confusing, because the uploaded file will not appear under the
expected name. This way a malicious remote Warpinator instance can
achieve full remote code execution in the context of the user account
running Warpinator on the victim's system.

There is a configuration setting in Warpinator "Require approval when
files would be overwritten", which is active by default. The check for
file overwrite actually happens before the actual file and relative_path
are transferred, thus this setting does not prevent the described
attack.

Should a user decide to disable another setting "Require approval before
accepting files" then the described attack would even work fully
unattended, without any interactive confirmation by the victim user. The
only precondition is that the attacker knows the correct group code to
interact with the victim.

To get by the confirmation dialog a likely scenario would be social
engineering attacks where the attacker suggests to send over a file
using Warpinator but actually overwrites arbitrary data of the victim's
user account.

4) Bugfix
=========

Upstream implemented some first aid changes for the file overwrite issue
in [3], [4], [5], [6]. This should prevent the naive attack outlined in
this report. There are remaining concerns, however:

- Warpinator implements a complex file transfer protocol that even
  allows to create complete directory trees including symlinks on the
  remote node. Also Warpinator employs thread pools for processing
  incoming requests potentially in parallel, thus it could be possible
  to circumvent the added security checks by exploiting race conditions
  (e.g. creating a symlink in one file transfer that is followed in
  another). I did not further explore these possibilities.
- To my knowledge the issue with the default group code described in 2)
  is still not addressed. Changing the group code is vital to reduce the
  potential attack surface. The interactive workflow of Warpinator
  should foster this, or not set a default group code at all.

I want to thank Warpinator upstream for looking into the issue and
dealing with my report. Upstream is still investigating and discussing
how to best address the remaining concerns. The initial fixes and CVE
assignment are already public for a while now so we decided to publish
the full report. As far as I am aware there is no release available yet
containing these initial fixes.

5) Timeline
===========

2022-09-01: a routine review [7] was requested for addition of Warpinator
            to openSUSE Tumbleweed.
2022-09-15: I discovered the file overwrite issue described in this
            report and started getting into contact with upstream.
2022-09-16: I sent the full report to the Warpinator main developer and
            Linux Mint security contact. I offered coordinated
	    disclosure.
2022-09-22: I reviewed the initial patches by upstream and upstream
            published them on GitHub. No formal coordinated disclosure
	    process has been setup.
2022-10-06: A colleague from the SUSE security team requested a CVE from
            Mitre to track this issue.
2022-10-19: No final solution has been found yet in discussions with
            upstream to address the remaining concerns. We gave some
	    ideas as input but also asked to publish the full
	    vulnerability report soon to make the community fully aware.

[1]: <https://github.com/linuxmint/warpinator>
[2]: <https://libsodium.gitbook.io/doc/secret-key_cryptography/secretbox>
[3]: <https://github.com/linuxmint/warpinator/commit/5244c33d4c109ede9607b9d94461650410e2cddc>
[4]: <https://github.com/linuxmint/warpinator/commit/f4907ef6a17a189d56ab0a9da4b53190b061ad75>
[5]: <https://github.com/linuxmint/warpinator/commit/8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94>
[6]: <https://github.com/linuxmint/warpinator/commit/95124fd4468683dd69ddd7b3da0e9906ce6beae2>
[7]: <https://bugzilla.suse.com/show_bug.cgi?id=1203037>

Best Regards

Matthias

--
Matthias Gerstner <matthias.gerstner@...e.de>
Security Engineer
<https://www.suse.com/security>
GPG Key ID: 0x14C405C971923553

SUSE Software Solutions Germany GmbH
HRB 36809, AG Nürnberg
Geschäftsführer: Ivo Totev, Andrew Myers, Andrew McDonald, Boudien Moerman

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_1c950c29_20250114_203844.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F95124fd4468683dd69ddd7b3da0e9906ce6beae2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F95124fd4468683dd69ddd7b3da0e9906ce6beae2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=linuxmint%2Fwarpinator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[warpinator](/linuxmint/warpinator)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fwarpinator) You must be signed in to change notification settings
* [Fork
  85](/login?return_to=%2Flinuxmint%2Fwarpinator)
* [Star
   1.3k](/login?return_to=%2Flinuxmint%2Fwarpinator)

* [Code](/linuxmint/warpinator)
* [Issues
  62](/linuxmint/warpinator/issues)
* [Pull requests
  0](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

Additional navigation options

* [Code](/linuxmint/warpinator)
* [Issues](/linuxmint/warpinator/issues)
* [Pull requests](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

## Commit

[Permalink](/linuxmint/warpinator/commit/95124fd4468683dd69ddd7b3da0e9906ce6beae2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

transfers: Use Pathlib.Path instead of GFile for path safety check.

[Browse files](/linuxmint/warpinator/tree/95124fd4468683dd69ddd7b3da0e9906ce6beae2)
Browse the repository at this point in the history

```
Pathlib.Path will resolve both links and relative paths to their
absolute paths - GFile treated links as real paths, so directory
links could potentially escape the incoming folder.

Follow-up to [5244c33](https://github.com/linuxmint/warpinator/commit/5244c33d4c109ede9607b9d94461650410e2cddc)
```

* Loading branch information

[![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=40&v=4)](/mtwebster)

[mtwebster](/linuxmint/warpinator/commits?author=mtwebster "View all commits by mtwebster")
committed
Sep 20, 2022

1 parent
[8bfd2f8](/linuxmint/warpinator/commit/8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94)

commit 95124fd

Showing
**1 changed file**
with
**7 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

11 changes: 7 additions & 4 deletions

11
[src/transfers.py](#diff-94332b33f4e055ae2e2feb52e43e3220a9513917bbb5cb52056a96b5b61e0f9a "src/transfers.py")

Show comments

[View file](/linuxmint/warpinator/blob/95124fd4468683dd69ddd7b3da0e9906ce6beae2/src/transfers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | import stat |
|  |  | import shutil |
|  |  | import gettext |
|  |  | from pathlib import Path |
|  |  |  |
|  |  | from gi.repository import GLib, Gio, GObject |
|  |  |  |
| Expand Down  Expand Up | | @@ -167,7 +168,7 @@ class FileReceiver(GObject.Object): |
|  |  | def \_\_init\_\_(self, op): |
|  |  | super(FileReceiver, self).\_\_init\_\_() |
|  |  | self.save\_path = prefs.get\_save\_path() |
|  |  | self.save\_path\_file = Gio.File.new\_for\_path(self.save\_path) |
|  |  | self.save\_path\_obj = Path(self.save\_path).resolve() |
|  |  | self.op = op |
|  |  | self.preserve\_perms = prefs.preserve\_permissions() and util.save\_folder\_is\_native\_fs() |
|  |  | self.preserve\_timestamp = prefs.preserve\_timestamp() and util.save\_folder\_is\_native\_fs() |
| Expand Down  Expand Up | | @@ -210,10 +211,12 @@ def receive\_data(self, s): |
|  |  | self.current\_mtime\_usec = s.time.mtime\_usec |
|  |  |  |
|  |  | if not self.current\_gfile: |
|  |  | # Check for valid path (pathlib.Path resolves both relative and symbolically-linked paths) |
|  |  | test\_path = Path(path).resolve() |
|  |  | if not test\_path.is\_relative\_to(self.save\_path\_obj): |
|  |  | raise Exception(\_("Resolved path is not valid: %s -> %s") % (path, str(test\_path))) |
|  |  |  |
|  |  | self.current\_gfile = Gio.File.new\_for\_path(path) |
|  |  | # Check for valid path (GFile resolves paths upon creation). |
|  |  | if self.save\_path\_file.get\_relative\_path(self.current\_gfile) is None: |
|  |  | raise Exception(\_("Resolved path is not valid: %s -> %s") % (path, self.current\_gfile.get\_path())) |
|  |  |  |
|  |  | if s.file\_type == FileType.DIRECTORY: |
|  |  | os.makedirs(path, exist\_ok=True) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `95124fd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F95124fd4468683dd69ddd7b3da0e9906ce6beae2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_816aa48d_20250114_203842.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=linuxmint%2Fwarpinator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[warpinator](/linuxmint/warpinator)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fwarpinator) You must be signed in to change notification settings
* [Fork
  85](/login?return_to=%2Flinuxmint%2Fwarpinator)
* [Star
   1.3k](/login?return_to=%2Flinuxmint%2Fwarpinator)

* [Code](/linuxmint/warpinator)
* [Issues
  62](/linuxmint/warpinator/issues)
* [Pull requests
  0](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

Additional navigation options

* [Code](/linuxmint/warpinator)
* [Issues](/linuxmint/warpinator/issues)
* [Pull requests](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

## Commit

[Permalink](/linuxmint/warpinator/commit/8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

transfers: Always remove existing files before beginning a transfer.

[Browse files](/linuxmint/warpinator/tree/8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94)
Browse the repository at this point in the history

```
The user must approve overwriting, or they've must have allowed it
via preferences. Either way, if we've made it this far, we can get
rid of existing files before starting the transfer.

This eliminates the risk of any existing symbolic directory links
potentially being followed outside of the download directory, which
would not be detected by [5244c33](https://github.com/linuxmint/warpinator/commit/5244c33d4c109ede9607b9d94461650410e2cddc).
```

* Loading branch information

[![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=40&v=4)](/mtwebster)

[mtwebster](/linuxmint/warpinator/commits?author=mtwebster "View all commits by mtwebster")
committed
Sep 20, 2022

1 parent
[f4907ef](/linuxmint/warpinator/commit/f4907ef6a17a189d56ab0a9da4b53190b061ad75)

commit 8bfd2f8

Showing
**1 changed file**
with
**12 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

26 changes: 12 additions & 14 deletions

26
[src/transfers.py](#diff-94332b33f4e055ae2e2feb52e43e3220a9513917bbb5cb52056a96b5b61e0f9a "src/transfers.py")

Show comments

[View file](/linuxmint/warpinator/blob/8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94/src/transfers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -180,18 +180,17 @@ def \_\_init\_\_(self, op): |
|  |  | self.current\_mtime = 0 |
|  |  | self.current\_mtime\_usec = 0 |
|  |  |  |
|  |  | if op.existing: |
|  |  | for name in op.top\_dir\_basenames: |
|  |  | try: |
|  |  | path = os.path.join(self.save\_path, name) |
|  |  | if os.path.isdir(path): # file not found is ok |
|  |  | shutil.rmtree(path) |
|  |  | else: |
|  |  | os.remove(path) |
|  |  | except FileNotFoundError: |
|  |  | pass |
|  |  | except Exception as e: |
|  |  | logging.warning("Problem removing existing files. Transfer may not succeed: %s" % e) |
|  |  | for name in op.top\_dir\_basenames: |
|  |  | try: |
|  |  | path = os.path.join(self.save\_path, name) |
|  |  | if os.path.isdir(path): # file not found is ok |
|  |  | shutil.rmtree(path) |
|  |  | else: |
|  |  | os.remove(path) |
|  |  | except FileNotFoundError: |
|  |  | pass |
|  |  | except Exception as e: |
|  |  | logging.warning("Problem removing existing files. Transfer may not succeed: %s" % e) |
|  |  |  |
|  |  | # We write files top-down. If we're preserving permissions and we receive |
|  |  | # a folder in some hierarchy that is not writable, we won't be able to create |
| Expand Down  Expand Up | | @@ -222,8 +221,7 @@ def receive\_data(self, s): |
|  |  | make\_symbolic\_link(self.op, path, s.symlink\_target) |
|  |  | else: |
|  |  | if self.current\_stream == None: |
|  |  | flags = Gio.FileCreateFlags.REPLACE\_DESTINATION |
|  |  | self.current\_stream = self.current\_gfile.replace(None, False, flags, None) |
|  |  | self.current\_stream = self.current\_gfile.create(Gio.FileCreateFlags.NONE, None) |
|  |  |  |
|  |  | if not s.chunk: |
|  |  | return |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8bfd2f8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F8bfd2f8b3f1b0c0f0a5a6d275702d107b9e08a94) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_932b0756_20250114_203840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F5244c33d4c109ede9607b9d94461650410e2cddc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F5244c33d4c109ede9607b9d94461650410e2cddc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=linuxmint%2Fwarpinator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[warpinator](/linuxmint/warpinator)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fwarpinator) You must be signed in to change notification settings
* [Fork
  85](/login?return_to=%2Flinuxmint%2Fwarpinator)
* [Star
   1.3k](/login?return_to=%2Flinuxmint%2Fwarpinator)

* [Code](/linuxmint/warpinator)
* [Issues
  62](/linuxmint/warpinator/issues)
* [Pull requests
  0](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

Additional navigation options

* [Code](/linuxmint/warpinator)
* [Issues](/linuxmint/warpinator/issues)
* [Pull requests](/linuxmint/warpinator/pulls)
* [Actions](/linuxmint/warpinator/actions)
* [Security](/linuxmint/warpinator/security)
* [Insights](/linuxmint/warpinator/pulse)

## Commit

[Permalink](/linuxmint/warpinator/commit/5244c33d4c109ede9607b9d94461650410e2cddc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

transfers: Don't allow a received file to be saved outside of the

[Browse files](/linuxmint/warpinator/tree/5244c33d4c109ede9607b9d94461650410e2cddc)
Browse the repository at this point in the history

```
transfer folder.

Since relative paths are valid for GFiles, we need to make sure
they resolve as descendants of the incoming transfer folder.
```

* Loading branch information

[![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=40&v=4)](/mtwebster)

[mtwebster](/linuxmint/warpinator/commits?author=mtwebster "View all commits by mtwebster")
committed
Sep 20, 2022

1 parent
[c28609c](/linuxmint/warpinator/commit/c28609cef4765a97a85ac1d8930a10324e00454b)

commit 5244c33

Showing
**1 changed file**
with
**7 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[src/transfers.py](#diff-94332b33f4e055ae2e2feb52e43e3220a9513917bbb5cb52056a96b5b61e0f9a "src/transfers.py")

Show comments

[View file](/linuxmint/warpinator/blob/5244c33d4c109ede9607b9d94461650410e2cddc/src/transfers.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  | import logging |
|  |  | import stat |
|  |  | import shutil |
|  |  | import gettext |
|  |  |  |
|  |  | from gi.repository import GLib, Gio, GObject |
|  |  |  |
| Expand All | | @@ -12,6 +13,8 @@ |
|  |  | import prefs |
|  |  | import warp\_pb2 |
|  |  |  |
|  |  | \_ = gettext.gettext |
|  |  |  |
|  |  | FILE\_INFOS = ",".join([ |
|  |  | "standard::size", |
|  |  | "standard::allocated-size", |
| Expand Down  Expand Up | | @@ -164,6 +167,7 @@ class FileReceiver(GObject.Object): |
|  |  | def \_\_init\_\_(self, op): |
|  |  | super(FileReceiver, self).\_\_init\_\_() |
|  |  | self.save\_path = prefs.get\_save\_path() |
|  |  | self.save\_path\_file = Gio.File.new\_for\_path(self.save\_path) |
|  |  | self.op = op |
|  |  | self.preserve\_perms = prefs.preserve\_permissions() and util.save\_folder\_is\_native\_fs() |
|  |  | self.preserve\_timestamp = prefs.preserve\_timestamp() and util.save\_folder\_is\_native\_fs() |
| Expand Down  Expand Up | | @@ -208,6 +212,9 @@ def receive\_data(self, s): |
|  |  |  |
|  |  | if not self.current\_gfile: |
|  |  | self.current\_gfile = Gio.File.new\_for\_path(path) |
|  |  | # Check for valid path (GFile resolves paths upon creation). |
|  |  | if self.save\_path\_file.get\_relative\_path(self.current\_gfile) is None: |
|  |  | raise Exception(\_("Resolved path is not valid: %s -> %s") % (path, self.current\_gfile.get\_path())) |
|  |  |  |
|  |  | if s.file\_type == FileType.DIRECTORY: |
|  |  | os.makedirs(path, exist\_ok=True) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5244c33`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2Fwarpinator%2Fcommit%2F5244c33d4c109ede9607b9d94461650410e2cddc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_8e1f6cf7_20250114_203838.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2023/04/25/2) [[next>]](../../../2023/04/29/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZEj04rd7LMiLwsKH@kasco.suse.de>
Date: Wed, 26 Apr 2023 11:54:38 +0200
From: Matthias Gerstner <mgerstner@...e.de>
To: oss-security@...ts.openwall.com
Subject: Warpinator: Remote file deletion vulnerability (CVE-2023-29380)

Hi list,

this report is about a remote file deletion vulnerability in Warpinator
[1].

Introduction
============

I already reviewed and found issues in Warpinator a while ago [2]. The
openSUSE packager for Warpinator asked me for a follow-up review after
updating to upstream release 1.4.3 which contained the fixes for
CVE-2022-42725.

In the course of the review I found another vulnerability which is
described in detail in the next section.

The Vulnerability
=================

In the code base of version 1.4.3 the sender of a file also sends a list
of `top_dir_basenames` to the peer. While there is now a verification of
the `relative_path` on the receiving side, the `top_dir_basenames` are
not verified at all. In `FileReceiver.__init__()` the following code is
found:

```
    for name in op.top_dir_basenames:
        try:
            path = os.path.join(self.save_path, name)
            if os.path.isdir(path): # file not found is ok
                shutil.rmtree(path)
            else:
                os.remove(path)
        except FileNotFoundError:
            pass
        except Exception as e:
            logging.warning("Problem removing existing files.  Transfer may not succeed: %s" % e)
```

If the sender is passing a string like "../" as part of
`top_dir_basenames` then this code will delete the complete parent
directory of the download directory (by default ~/Warpinator) and thus
the complete home directory of the receiving party. Any other files
under control of the receiving party are similarly endangered by this
remote DoS / integrity attack.

This can happen automatically if the receiving side is running
Warpinator in trusted mode, both parties share the same non-default
group key and unconfirmed file overwrites are allowed. If this is not
the case then the receiving side will see a confirmation popup like

    X wants to send `../´

This message might not be very suspecting for an average end user. Other
strings can be used here as well like an absolute path to the user's
home directory, which could be interpreted as correct, or overlooked.

I investigated whether the fact that this allows to delete the download
directory completely could lead to a follow-up vulnerability to allow
overwriting files in other paths again. This seems not to be possible
though.  The check of the `relative_path()` is stable enough to prevent
this even if the download directory does not exist at all.

Affectedness
============

The problematic handling of `top_dir_basenames` was first introduced in
upstream version 1.0.7.

Bugfixes
========

The remote file deletion vulnerability has been fixed upstream via
commit 9aae768 [3].

The fact that this vulnerability escaped both upstream's and my own
review efforts during handling of CVE-2022-4272 confirmed earlier
concerns I had about relying on a single line of defense in the
Warpinator codebase. I recommended to upstream to use an isolation
technique like Linux mount namespaces to prevent escapes from the
destined download directory. In the light of this new security issue I
additionally or alternatively recommended a redesign of the codebase to
better separate trusted and untrusted codepaths.

Upstream used the 90 days embargo time we offered to implement isolation
mechanisms either based on Linux namespaces through the Bubblewrap tool,
or based on the Linux kernel's landlock security module. Only if none of
both can be established, Warpinator will run in a legacy mode. In
this case the user will be warned about the weakened security.

The new Warpinator major version release 1.6.0 contains both the bugfix
for this the remote file deletion issue as well as the added security
layers.

Timeline
========

2023-01-25: I reported the newly found issue to upstream and offered
            coordinated disclosure.
2023-03-08: Upstream shared the core changes listed above with us, I
            reviewed them and gave feedback.
2023-04-05: I received CVE-2023-29380 from Mitre to track the file
            deletion issue and shared it with upstream.
2023-04-25: Upstream needed additional time for testing and integration.
            The 90 days maximum embargo period we offer ends and with
	    the 1.6.0 release being available we agreed on the
	    publication of all available information.

References
==========

[1]: <https://github.com/linuxmint/warpinator>
[2]: <https://seclists.org/oss-sec/2022/q4/38>
[3]: <https://github.com/linuxmint/warpinator/commit/9aae768522b7bbb09c836419893802a02221d663>

Best Regards

--
Matthias Gerstner <matthias.gerstner@...e.de>
Security Engineer
<https://www.suse.com/security>
GPG Key ID: 0x14C405C971923553

SUSE Software Solutions Germany GmbH
HRB 36809, AG Nürnberg
Geschäftsführer: Ivo Totev, Andrew Myers, Andrew McDonald, Boudien Moerman

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


