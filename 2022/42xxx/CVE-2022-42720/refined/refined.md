```
{
  "cveId": "CVE-2022-42720",
  "description": "A use-after-free vulnerability was discovered in bss_ref_get in net/wireless/scan.c in the mac80211 subsystem of the Linux kernel. This occurs due to multiple refcounting bugs related to multi-BSSID. Specifically, in `bss_ref_get()`, if a BSS has a `hidden_beacon_bss`, the bss pointer is overwritten before checking for the transmitted BSS. Additionally, in `cfg80211_bss_update()`, the `transmitted_bss` pointer is copied from `tmp` into `new` and then unreferenced erroneously if `new` is released. Finally, in `cfg80211_inform_single_bss_data()`, if adding to the non-transmitted list fails, the BSS is unlinked and returned, resulting in a returned entry without a reference.",
  "vulnerability": {
    "rootCause": "Multiple refcounting bugs related to multi-BSSID handling in the mac80211 subsystem.",
    "weaknesses": [
      "Use-after-free",
      "Incorrect pointer handling",
      "Refcounting errors"
    ],
    "impact": "Denial of service or execution of arbitrary code.",
    "attackVectors": [
      "Sending malformed 802.11 Beacon frames"
    ],
    "requiredCapabilities": "An attacker needs to be able to inject malformed WLAN frames to trigger the vulnerability. It is assumed that the attacker can send the frames over the air and does not need physical access to the target machine.",
    "additionalDetails": "The vulnerability can be triggered by sending crafted beacon frames."
  },
  "affectedSystems": [
    "Linux kernel versions prior to the fix",
        "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S",
        "Fedora 35",
        "Fedora 36",
        "Fedora 37",
         "Debian 10"
  ],
  "references": [
    "https://git.kernel.org/pub/scm/linux/kernel/git/wireless/wireless.git/commit/?id=0b7808818cb9df6680f98996b8e9a439fa7bcc2f",
        "https://security.netapp.com/advisory/ntap-20230203-0008",
        "https://bugzilla.redhat.com/show_bug.cgi?id=2134451",
        "https://www.debian.org/security/2022/dsa-5257",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GGHENNMLCWIQV2LLA56BJNFIUZ7WB4IY/",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S2KTU5LFZNQS7YNGE56MT46VHMXL3DD2/",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VNN3VFQPECS6D4PS6ZWD7AFXTOSJDSSR/",
    "https://lore.kernel.org/all/ff7256bc-418b-e833-18d8-bc9700f6d77e@seemoo.tu-darmstadt.de/",
    "https://lists.debian.org/debian-lts-announce/2022/11/msg00001.html",
        "https://bugzilla.suse.com/show_bug.cgi?id=1204059"
  ]
}
```