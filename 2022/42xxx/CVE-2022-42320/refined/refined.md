```
{
  "vulnerability": {
    "root_cause": "Access rights for Xenstore nodes are managed per domid. When a domain is removed, its Xenstore nodes might still retain access rights that include the removed domain's domid. Normally, this isn't a problem as these access rights are corrected upon subsequent writes to the node. However, there exists a small window of opportunity when a new domain is created with the same domid as a recently removed domain where the old access rights are still valid. This allows the new domain to access nodes that were intended for the removed domain if another domain writes to the node before the new domain is fully registered with Xenstore by dom0.",
    "weaknesses": [
      "Incomplete cleanup of Xenstore node access rights on domain destruction",
      "Race condition during domain creation and Xenstore node access"
    ],
    "impact": "A new guest domain can potentially access resources belonging to a previous domain with the same domid. Depending on the software and configuration, this could result in denial of service, information leaks, or privilege escalation.",
    "attack_vectors": [
      "A malicious guest domain gains access to another guest's Xenstore nodes due to incorrect permission handling when a domain is deleted and a new one is created with the same domID.",
	  "The vulnerability requires another domain to write to the node before the new domain is fully registered with Xenstore."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to control a guest domain and have it be assigned the same domid as a recently deleted domain. Additionally, another domain needs to write to the node in the vulnerable time window."
  },
  "affected_configurations": [
        "All versions of Xen are vulnerable in principle.",
        "Only systems using the C variant of Xenstore (xenstored or xenstore-stubdom) are vulnerable.",
        "Systems using the Ocaml variant of Xenstore (oxenstored) are not vulnerable.",
		"Vulnerable systems are only those running software where one domain is granted access to another's xenstore nodes, without complete cleanup of those nodes on domain destruction. No such software is enabled in default configurations of upstream Xen."
    ],
    "additional_notes": "Upstream Xen, without additional management software (in host or guest(s)), is not vulnerable in the default (host and guest) configuration."
}
```