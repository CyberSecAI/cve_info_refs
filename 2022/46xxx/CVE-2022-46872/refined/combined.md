=== Content from security.gentoo.org_e9026659_20250115_085453.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202305-13**

Multiple vulnerabilities have been discovered in Mozilla Thunderbird, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.7.0"

```

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.7.0"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885815](https://bugs.gentoo.org/show_bug.cgi?id=885815)
* [891217](https://bugs.gentoo.org/show_bug.cgi?id=891217)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from security.gentoo.org_7af359bc_20250115_085453.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202305-06**

Multiple vulnerabilities have been discovered in Mozilla Firefox, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-102.7.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-102.7.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-109.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-109.0:rapid"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46873](https://nvd.nist.gov/vuln/detail/CVE-2022-46873)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46879](https://nvd.nist.gov/vuln/detail/CVE-2022-46879)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23597](https://nvd.nist.gov/vuln/detail/CVE-2023-23597)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23600](https://nvd.nist.gov/vuln/detail/CVE-2023-23600)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23604](https://nvd.nist.gov/vuln/detail/CVE-2023-23604)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)
* [CVE-2023-23606](https://nvd.nist.gov/vuln/detail/CVE-2023-23606)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885813](https://bugs.gentoo.org/show_bug.cgi?id=885813)
* [891213](https://bugs.gentoo.org/show_bug.cgi?id=891213)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_fe4f7b71_20250115_085454.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-52

## Security Vulnerabilities fixed in Firefox ESR 102.6

Announced
December 13, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.6

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e2902d9d_20250115_085453.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1799156)
* [XML](/show_bug.cgi?ctype=xml&id=1799156)

Closed
[Bug 1799156](/show_bug.cgi?id=1799156)
(CVE-2022-46872)

Opened 2 years ago
Closed 2 years ago

# Potential Linux arbitrary read sandbox bypass using clipboard

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Potential Linux arbitrary read sandbox bypass using clipboard

## Categories

### (Core :: DOM: Copy & Paste and Drag & Drop, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)

DOM: Copy & Paste and Drag & Drop
▾

Core :: DOM: Copy & Paste and Drag & Drop
All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

109 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox106 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=unaffected) |
| firefox107 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=unaffected) |
| firefox108 | [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified) |
| firefox109 | [+](/buglist.cgi?f1=cf_tracking_firefox109&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 108+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox106 |  | unaffected |
| firefox107 |  | unaffected |
| firefox108 | + | verified |
| firefox109 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nika, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process")

[1701319](/show_bug.cgi?id=1701319 "RESOLVED FIXED - Add GTK platform support for pasting files")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-23598](/show_bug.cgi?id=1800425 "VERIFIED FIXED - Arbitrary file exposure with Drag&Drop on GTK (maybe only across Firefox instances?)")

[1699743](/show_bug.cgi?id=1699743 "RESOLVED FIXED - clipboardData.items does not support pasting files correctly")

[1798548](/show_bug.cgi?id=1798548 "RESOLVED FIXED - Add test for pasting a real file")

## Details

### (Keywords: csectype-sandbox-escape, regression, sec-high, Whiteboard: [post-critsmash-triage] [adv-main108+] [adv-esr102.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-46872

[Keywords:](/describekeywords.cgi)

[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage] [adv-main108+] [adv-esr102.6+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [diannaS](/user_profile?user_id=690067) | [in-testsuite](#c20 "2 years ago") | + |
| --- | --- | --- |
| [diannaS](/user_profile?user_id=690067) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika](/attachment.cgi?id=9302349)  [2 years ago](#c6)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c19 "2 years ago")  tjr : [sec-approval+](#c14 "2 years ago") | [Details](/attachment.cgi?id=9302349&action=edit) | [Review](/attachment.cgi?id=9302349) |
| --- | --- | --- |
| [Bug 1799156 - Use a pref for the GTK clipboard moz-file code. r?nika](/attachment.cgi?id=9302665)  [2 years ago](#c8)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9302665&action=edit) | [Review](/attachment.cgi?id=9302665) |
| [Bug 1799156 - Test for writing unknown clipboard type. r?nika](/attachment.cgi?id=9303072)  [2 years ago](#c10)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#a2100759_690067 "2 years ago")  RyanVM : [approval-mozilla-esr102+](#a2335278_75935 "2 years ago") | [Details](/attachment.cgi?id=9303072&action=edit) | [Review](/attachment.cgi?id=9303072) |
| [Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika](/attachment.cgi?id=9305990)  [2 years ago](#c23)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#c25 "2 years ago") | [Details](/attachment.cgi?id=9305990&action=edit) | [Review](/attachment.cgi?id=9305990) |
| [advisory.txt](/attachment.cgi?id=9307380)  [2 years ago](#c30)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   304 bytes, text/plain |  | [Details](/attachment.cgi?id=9307380&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1799156#c0)• 2 years ago |
|  | |

While reviewing <https://phabricator.services.mozilla.com/D160944?id=643029>, I noticed a potential mechanism to read arbitrary files from a compromised content process on Linux. I am unsure if a similar mechanism exists on other platforms.

In that patch, :evilpie adds a new automation-only case to `nsClipboard::SelectionGetEvent` to allow writing to the `"text/uri-list"` MIME type. This is gated to be automation-only because if a `file://` URI is put into the `text/uri-list` MIME type, we'll read said file from the disk and send its contents to the content process (currently only for images, but after [bug 1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process"), if `dom.events.dataTransfer.mozFile.enabled` is enabled, we will send down arbitrary files). As is noted in the patch, writing this would allow content processes to read arbitrary files.

Unfortunately, I think it is already possible to write a valid `text/uri-list` entry, even without that patch. The fallback case below (<https://searchfox.org/mozilla-central/rev/eddb810ffd5499f0984123fe4bfea6064ebad3c8/widget/gtk/nsClipboard.cpp#913-945>), is nearly identical to the new code, except that it passes the data through `nsPrimitiveHelpers::CreateDataFromPrimitive`. This method will only pass through narrow strings if the MIME type is `kTextMime` or `kCustomTypesMime` (<https://searchfox.org/mozilla-central/rev/eddb810ffd5499f0984123fe4bfea6064ebad3c8/widget/nsPrimitiveHelpers.cpp#128-129>), and will pass through the `nsString` otherwise.

This means the only thing preventing setting up the read is that we can only write wide strings, while the OS is expecting narrow strings. Unfortunately I don't think there's any validation between IPC and this code that the wide string is valid utf-16, so it's likely possible for a compromised content process to fill the wide string's data with a valid `file:///` URI narrow string, and get us to read an arbitrary file from the clipboard (as we don't tell the OS the string width we're passing in).

I don't know what the solution here is, but my current impression is that we probably want to at least restrict content processes to a minimal allow-list of MIME types which they can access, and validate it both when reading and writing.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a133_406194)• 2 years ago |

Group: core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a219_406194)• 2 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1799156#c1)• 2 years ago |
|  | |

One potential approach to doing the validation structurally would be changing how `IPCDataTransferItem` (<https://searchfox.org/mozilla-central/rev/eddb810ffd5499f0984123fe4bfea6064ebad3c8/dom/ipc/DOMTypes.ipdlh#140-153>) works under the hood to map values over with the enum being for the known MIME type, and the data format being fixed for each MIME type. Not the most elegant solution, but does mean that there's less risk of emergent dynamic behaviour or unchecked strings in the IPC layer.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1799156#c2)• 2 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process")

:evilpie, since you are the author of the regressor, [bug 1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process"), could you take a look? Also, could you set the severity field?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#needinfo_regression_author.py).

[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=unaffected)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=unaffected)
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)Flags: needinfo?(evilpies)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1799156#c3)• 2 years ago |
|  | |

I am not sure if this is true, but I think we might be able to restrict MIME types send from the child to parent to the [knownFormats](https://searchfox.org/mozilla-central/rev/eddb810ffd5499f0984123fe4bfea6064ebad3c8/dom/events/DataTransfer.cpp#891) plus `kCustomTypesMime`. I think we don't have any code running with a system principal in the child that sets arbitrary mimes.

However there might be some situation where we roundtrip stuff through the content process for drag&drop?

Flags: needinfo?(evilpies)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a1233_393835)• 2 years ago |

Regressed by: [1701319](/show_bug.cgi?id=1701319 "RESOLVED FIXED - Add GTK platform support for pasting files")
No longer regressed by: [1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process")

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a1268_393835)• 2 years ago |

Regressed by: [1308007](/show_bug.cgi?id=1308007 "RESOLVED FIXED - [e10s] Pasted file objects not correctly transmitted to content process")

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1799156#c4)• 2 years ago |
|  | |

(In reply to Tom Schuster [:evilpie] from [comment #3](/show_bug.cgi?id=1799156#c3 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard"))

> I am not sure if this is true, but I think we might be able to restrict MIME types send from the child to parent to the [knownFormats](https://searchfox.org/mozilla-central/rev/eddb810ffd5499f0984123fe4bfea6064ebad3c8/dom/events/DataTransfer.cpp#891) plus `kCustomTypesMime`. I think we don't have any code running with a system principal in the child that sets arbitrary mimes.
>
> However there might be some situation where we roundtrip stuff through the content process for drag&drop?

That at least seems like a good place to start looking. If it turns out that we do round-trip stuff through the child which we shouldn't, we'll have to deal with that as well though. Unfortunately with our poor test coverage for this, it'll be quite difficult to do something here without lots of manual QA most likely. Perhaps we should have the validation be behind a seperate pref for each of drag & drop and clipboard, so that it can be easily flipped for one or the other if we find issues?

My old dragndrop test site (<https://mystor.github.io/dragndrop/>) is probably out-of-date with expectations at this point, but perhaps we can use it to compare the most obvious cases to make sure they work together? The main other thing I'd be worried about is something like dragging a tab over web content causing some sort of issue, as I think we use a custom MIME for tabs, but I'd hope we don't bounce it through content.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1799156#c5)• 2 years ago |
|  | |

If we want a short term fix, we could put the GTK code also behind the `dom.events.dataTransfer.mozFile.enabled` pref for now, considering that I don't think we use it for anything right now.

Of course to actually enable this feature we would have to fix the bug. I am going to try and implement my idea in [comment 3](/show_bug.cgi?id=1799156#c3 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") and see how much breaks.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1799156#c6)• 2 years ago |
|  | |

Attached file
[Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika](attachment.cgi?id=9302349)
— [Details](attachment.cgi?id=9302349&action=edit)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1799156#c7)• 2 years ago |
|  | |

FYI soft code freeze is in 2 days (2022-11-10) for fx108.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1799156#c8)• 2 years ago |
|  | |

Attached file
[Bug 1799156 - Use a pref for the GTK clipboard moz-file code. r?nika](attachment.cgi?id=9302665) (obsolete)
— [Details](attachment.cgi?id=9302665&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a417698_600971)• 2 years ago |

Assignee: nobody → tschusterStatus: NEW → ASSIGNED

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1799156#c9)• 2 years ago |
|  | |

(In reply to Dianna Smith [:diannaS] from [comment #7](/show_bug.cgi?id=1799156#c7 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard"))

> FYI soft code freeze is in 2 days (2022-11-10) for fx108.

I won't be able to come up with a complete fix for this in one day. I attached a patch that should mitigate the bug by never allowing reading files on the clipboard unless a specific pref is set.

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a507636_434964)• 2 years ago |

Severity: -- → S2

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a600023_600971)• 2 years ago |

[Attachment #9302349](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") -
Attachment description: WIP: Bug 1799156 - Restrict the clipboard mimes from the child → Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1799156#c10)• 2 years ago |
|  | |

Attached file
[Bug 1799156 - Test for writing unknown clipboard type. r?nika](attachment.cgi?id=9303072)
— [Details](attachment.cgi?id=9303072&action=edit)

Based on <https://phabricator.services.mozilla.com/D160944>

Depends on D161487

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1799156#c11)• 2 years ago |
|  | |

I didn't push this to try because of the sec-high status, but I ran a handful of tests locally. But even with a green try I wouldn't be certain that there aren't any regressions, because especially drag&drop has poor test coverage.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a600180_600971)• 2 years ago |

[Attachment #9302665](/attachment.cgi?id=9302665&action=edit "Bug 1799156 - Use a pref for the GTK clipboard moz-file code. r?nika") -
Attachment is obsolete: true

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1799156#c12)• 2 years ago |
|  | |

We still need to spend some time to verify that the remaining MIME types are even safe. Especially `kFilePromise` seems dangerous.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a857927_703078)• 2 years ago |

See Also: → [CVE-2023-23598](/show_bug.cgi?id=1800425 "VERIFIED FIXED - Arbitrary file exposure with Drag&Drop on GTK (maybe only across Firefox instances?)")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1799156#c13)• 2 years ago |
|  | |

Comment on [attachment 9302349](/attachment.cgi?id=9302349 "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - Filter unknown DataTransferItem flavors. r?nika

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not immediately, but this does make clear where to search for bugs. Sadly <https://phabricator.services.mozilla.com/D160944> would be a big help here.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Hard to say, but most obvious uses of the clipboard and Drag&Drop should continue to work. This definitely needs some manual testing.
* **Is Android affected?**: No
[Attachment #9302349](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1799156#c14)• 2 years ago |
|  | |

Comment on [attachment 9302349](/attachment.cgi?id=9302349 "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - Filter unknown DataTransferItem flavors. r?nika

Approved to land and uplift when ready

[Attachment #9302349](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a1210658_578488)• 2 years ago |

Whiteboard: [reminder-test 2023-02-01]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a1299604_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox108](/buglist.cgi?f1=cf_tracking_firefox108&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B)
[tracking-firefox109](/buglist.cgi?f1=cf_tracking_firefox109&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox109&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1799156#c15)• 2 years ago |
|  | |

Filter unknown DataTransferItem flavors. r=nika

<https://hg.mozilla.org/integration/autoland/rev/fa555f33a567ab18ff823448c06268ed301c1205>

<https://hg.mozilla.org/mozilla-central/rev/fa555f33a567>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 109 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1799156#c16)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:tschuster, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox108` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(tschuster)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1799156#c17)• 2 years ago |
|  | |

FYI, this is going to need a rebased patch for ESR102. It grafts cleanly to Beta.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1799156#c18)• 2 years ago |
|  | |

Comment on [attachment 9302349](/attachment.cgi?id=9302349 "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - Filter unknown DataTransferItem flavors. r?nika

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potentially steal files for users on Linux
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: All the normal drag & drop and clipboard QA
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: So far no reported regressions
* **String changes made/needed**:
* **Is Android affected?**: No
Flags: needinfo?(tschuster)
[Attachment #9302349](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2075213_703078)• 2 years ago |

[Attachment #9303072](/attachment.cgi?id=9303072&action=edit "Bug 1799156 - Test for writing unknown clipboard type. r?nika") -
Flags: approval-mozilla-beta?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1799156#c19)• 2 years ago |
|  | |

Comment on [attachment 9302349](/attachment.cgi?id=9302349 "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - Filter unknown DataTransferItem flavors. r?nika

Approved for 108.0b8

[Attachment #9302349](/attachment.cgi?id=9302349&action=edit "Bug 1799156 - Filter unknown DataTransferItem flavors. r?nika") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2100759_690067)• 2 years ago |

[Attachment #9303072](/attachment.cgi?id=9303072&action=edit "Bug 1799156 - Test for writing unknown clipboard type. r?nika") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1799156#c20)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/24de4b09b7c6>

<https://hg.mozilla.org/releases/mozilla-beta/rev/9f4ea6617bb2>

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1799156#c21)• 2 years ago |
|  | |

Hi Tom, just a reminder that we need a rebased patch for ESR102 when you're able.

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1799156#c22)• 2 years ago |
|  | |

Sorry. I had some trouble with building ESR.

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1799156#c23)• 2 years ago |
|  | |

Attached file
[Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika](attachment.cgi?id=9305990)
— [Details](attachment.cgi?id=9305990&action=edit)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1799156#c24)• 2 years ago |
|  | |

Comment on [attachment 9305990](/attachment.cgi?id=9305990 "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9305990&action=edit "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - ESR: Filter unknown DataTransferItem flavors. r?nika

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potentially steal files from users using Linux
* **Fix Landed on Version**: 108
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: So far no reported regressions
[Attachment #9305990](/attachment.cgi?id=9305990&action=edit "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1799156#c25)• 2 years ago |
|  | |

Comment on [attachment 9305990](/attachment.cgi?id=9305990 "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika") [[details]](/attachment.cgi?id=9305990&action=edit "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika")

[Bug 1799156](/show_bug.cgi?id=1799156 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard") - ESR: Filter unknown DataTransferItem flavors. r?nika

Approved for 102.6esr.

[Attachment #9305990](/attachment.cgi?id=9305990&action=edit "Bug 1799156 - ESR: Filter unknown DataTransferItem flavors. r?nika") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2335278_75935)• 2 years ago |

[Attachment #9303072](/attachment.cgi?id=9303072&action=edit "Bug 1799156 - Test for writing unknown clipboard type. r?nika") -
Flags: approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1799156#c26)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/48049cc5b3a8>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/001b8447fd9c>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1799156#c27)• 2 years ago |
|  | |

Looks like the test was landed by accident with the Beta uplift. I went ahead and pushed it to autoland since it's in the open anyway.

<https://hg.mozilla.org/integration/autoland/rev/81566e40a34ffee83c7cc27deb4b2891228f3117>

Whiteboard: [reminder-test 2023-02-01]

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1799156#c28)• 2 years ago |
|  | |

Test for writing unknown clipboard type. r=nika

<https://hg.mozilla.org/integration/autoland/rev/81566e40a34ffee83c7cc27deb4b2891228f3117>

<https://hg.mozilla.org/mozilla-central/rev/81566e40a34f>

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2664976_553429)• 2 years ago |

Flags: qe-verify+Whiteboard: [post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2746550_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1799156#c29)• 2 years ago |
|  | |

QA ran a set of specific Copy & Paste/Drag & Drop test cases as part of the FX 102.6esr build validation (across all platforms) - details [here](https://testrail.stage.mozaws.net/index.php?/reports/view/6128) and an additional check on FX 108 (Ubuntu 22). No issues were encountered.

These tests and some exploratory ones will also be run across platforms as part of Nightly 109 regression testing. The conclusions will be added at the end of the week, once our test round is completed.

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2940101_578488)• 2 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage] [adv-main108+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1799156#c30)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9307380)
— [Details](attachment.cgi?id=9307380&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a2951821_578488)• 2 years ago |

Whiteboard: [post-critsmash-triage] [adv-main108+] → [post-critsmash-triage] [adv-main108+] [adv-esr102.6+]

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1799156#c31)• 2 years ago |
|  | |

QA ran several Copy & Paste/Drag & Drop test cases as part of the [Nightly 109 regression testing](https://testrail.stage.mozaws.net/index.php?/reports/view/6146) as per [comment 29](/show_bug.cgi?id=1799156#c29 "VERIFIED FIXED - Potential Linux arbitrary read sandbox bypass using clipboard"). No new issues were encountered.

Status: RESOLVED → VERIFIED
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a3028196_578488)• 2 years ago |

Alias: CVE-2022-46872

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1799156#a22050591_1689)• 1 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1799156&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom Schuster](/user_profile?user_id=703078)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3013c27e_20250115_085454.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-51

## Security Vulnerabilities fixed in Firefox 108

Announced
December 13, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 108

#### [#CVE-2022-46871: libusrsctp library out of date](#CVE-2022-46871)

Reporter
Mozilla Developers
Impact
high
##### Description

An out of date library (libusrsctp) contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1795697](https://bugzilla.mozilla.org/show_bug.cgi?id=1795697)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46873: Firefox did not implement the CSP directive unsafe-hashes](#CVE-2022-46873)

Reporter
Pete Freitag
Impact
moderate
##### Description

Because Firefox did not implement the `unsafe-hashes` CSP directive, an attacker who was able to inject markup into a page otherwise protected by a Content Security Policy may have been able to inject executable script. This would be severely constrained by the specified Content Security Policy of the document.

##### References

* [Bug 1644790](https://bugzilla.mozilla.org/show_bug.cgi?id=1644790)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could have potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46877: Fullscreen notification bypass](#CVE-2022-46877)

Reporter
Hafiizh
Impact
low
##### Description

By confusing the browser, the fullscreen notification could have been delayed or suppressed, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795139](https://bugzilla.mozilla.org/show_bug.cgi?id=1795139)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

#### [#CVE-2022-46879: Memory safety bugs fixed in Firefox 108](#CVE-2022-46879)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Lukas Bernhard, Gabriele Svelto, Randell Jesup, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736224%2C1793407%2C1794249%2C1795845%2C1797682%2C1797720%2C1798494%2C1799479)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d85592cd_20250115_085454.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-53

## Security Vulnerabilities fixed in Thunderbird 102.6

Announced
December 13, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.6

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

*Note*: CVE-2022-46874 was originally included in these advisories for Thunderbird 102.6, but a patch (specific to Thunderbird) was omitted, resulting in it actually being fixed in Thunderbird 102.6.1

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Thunderbird for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Thunderbird 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


