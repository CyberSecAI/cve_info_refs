=== Content from www.mozilla.org_d85592cd_20250115_085027.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-53

## Security Vulnerabilities fixed in Thunderbird 102.6

Announced
December 13, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.6

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

*Note*: CVE-2022-46874 was originally included in these advisories for Thunderbird 102.6, but a patch (specific to Thunderbird) was omitted, resulting in it actually being fixed in Thunderbird 102.6.1

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Thunderbird for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Thunderbird 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_7af359bc_20250115_085023.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202305-06**

Multiple vulnerabilities have been discovered in Mozilla Firefox, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-102.7.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-102.7.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-109.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-109.0:rapid"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46873](https://nvd.nist.gov/vuln/detail/CVE-2022-46873)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46879](https://nvd.nist.gov/vuln/detail/CVE-2022-46879)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23597](https://nvd.nist.gov/vuln/detail/CVE-2023-23597)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23600](https://nvd.nist.gov/vuln/detail/CVE-2023-23600)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23604](https://nvd.nist.gov/vuln/detail/CVE-2023-23604)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)
* [CVE-2023-23606](https://nvd.nist.gov/vuln/detail/CVE-2023-23606)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885813](https://bugs.gentoo.org/show_bug.cgi?id=885813)
* [891213](https://bugs.gentoo.org/show_bug.cgi?id=891213)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_3921f6bb_20250115_085025.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-40

## Security Vulnerabilities fixed in Firefox 105

Announced
September 20, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 105

This advisory was updated December 13, 2022 to add CVE-2022-46880. This fix was included in the original release of Firefox 105, but did not appear in the advisory published at that time.

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.
*Note*: This advisory was added on December 13th, 2022 after we better understood the impact of the issue. The fix was included in the original release of Firefox 105.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40961: Stack-buffer overflow when initializing Graphics](#CVE-2022-40961)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

During startup, a graphics driver with an unexpected name could lead to a stack-buffer overflow causing a potentially exploitable crash.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1784588](https://bugzilla.mozilla.org/show_bug.cgi?id=1784588)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Firefox on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-40962: Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 104 and Firefox ESR 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_e9026659_20250115_085024.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202305-13**

Multiple vulnerabilities have been discovered in Mozilla Thunderbird, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.7.0"

```

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.7.0"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885815](https://bugs.gentoo.org/show_bug.cgi?id=885815)
* [891217](https://bugs.gentoo.org/show_bug.cgi?id=891217)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_fe4f7b71_20250115_085026.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-52

## Security Vulnerabilities fixed in Firefox ESR 102.6

Announced
December 13, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.6

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_919af888_20250115_085023.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1749292)
* [XML](/show_bug.cgi?ctype=xml&id=1749292)

Closed
[Bug 1749292](/show_bug.cgi?id=1749292)
(CVE-2022-46880)

Opened 3 years ago
Closed 2 years ago

# Use-after-free in mozilla::gl::GLContext::raw\_fDrawElementsInstanced

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Use-after-free in mozilla::gl::GLContext::raw\_fDrawElementsInstanced

## Categories

### (Core :: Graphics: CanvasWebGL, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20CanvasWebGL#Graphics%3A%20CanvasWebGL)

Graphics: CanvasWebGL
▾

Core :: Graphics: CanvasWebGL
Bugs with the WebGL Canvas Context.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20CanvasWebGL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

105 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 108+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox98 |  | wontfix |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: attekett, Assigned: jgilbert)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6e1d9fb30a393b4b29162e824f2b7321?d=mm&size=40)  [attekett](/user_profile?user_id=420648)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1768190](/show_bug.cgi?id=1768190 "VERIFIED FIXED - Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /gfx/2d/Logging.h:754")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1749292&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1749292)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1755448](/show_bug.cgi?id=1755448 "RESOLVED DUPLICATE - High address SEGV and Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION")

## Details

### (5 keywords, Whiteboard: [fixed by bug 1768190][bugmon:bisected,confirmed][adv-esr102.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-46880

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[fixed by bug 1768190][bugmon:bisected,confirmed][adv-esr102.6+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c22 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [heap-use-after-free-interceptormemcpy-GLContextrawfDrawElementsInstanced.zip](/attachment.cgi?id=9258310)  [3 years ago](#c0)  [Atte Kettunen](/user_profile?user_id=420648)   318.04 KB, application/zip |  | [Details](/attachment.cgi?id=9258310&action=edit) |
| --- | --- | --- |
| [testcase.zip](/attachment.cgi?id=9260692)  [3 years ago](#c8)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   300.47 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9260692&action=edit) |
| [SEGV-0x7f03955126990.html](/attachment.cgi?id=9263267)  [3 years ago](#c12)  [Atte Kettunen](/user_profile?user_id=420648)   2.13 KB, text/html |  | [Details](/attachment.cgi?id=9263267&action=edit) |
| [advisory.txt](/attachment.cgi?id=9307419)  [2 years ago](#c25)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   148 bytes, text/plain |  | [Details](/attachment.cgi?id=9307419&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1749292#c0)• 3 years ago |
|  | |

Attached file
[heap-use-after-free-interceptormemcpy-GLContextrawfDrawElementsInstanced.zip](attachment.cgi?id=9258310) (obsolete)
— [Details](attachment.cgi?id=9258310&action=edit)

Tested on:

OS: Ubuntu 20.04 running in VMware Workstation 16 VM.

Firefox: Downloaded with fuzzfetch

`fuzzfetch --target firefox --os Linux --asan --fuzzing -n firefox`

`[2022-01-10 04:29:30] Identified task: https://firefox-ci-tc.services.mozilla.com/api/index/v1/task/gecko.v2.mozilla-central.latest.firefox.linux64-fuzzing-asan-opt [2022-01-10 04:29:30] > Task ID: Mm64vHQPRmii0o0Mq2DOHQ [2022-01-10 04:29:30] > Rank: 1641807422 [2022-01-10 04:29:30] > Changeset: b81970e39db444fa9a70eaf2e656f3e48c18a7c1 [2022-01-10 04:29:30] > Build ID: 20220110093702 [2022-01-10 04:29:32] > Downloading: https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/Mm64vHQPRmii0o0Mq2DOHQ/artifacts/public/build/target.tar.bz2`

I couldn't reproduce the issue with debug build. I think there is some race condition that is not reachable with my laptop and debug build.

Sorry for the complex test case, but reducing it any further caused the test case to go unrealiable.

The test case is based on WebGL 2.0.0 conformance-suite gles3 frameblitter test(<https://github.com/KhronosGroup/WebGL/blob/main/conformance-suites/2.0.0/deqp/functional/gles3/framebufferblit/default_framebuffer_02.html> )

and requires group of files from the test suite. I have added all the required files to the attached .zip. Same files are included in the Firefox source checkout in /dom/canvas/test/webgl-conf/checkout/deqp/. As reproducing additionally requires a custom http-server, I thought that it would be easier to include all the files in a single .zip.

.zip includes:

20220110-044334\_ffp\_logs\_cu0dh2z3: ffpuppet logs

deqp: required test files

goog: Google Closure library used by the conformance test suite

js : Additional js files from the test suite

firefox-ffpuppet-run.log: ffpuppet stdout/stderr

heap-use-after-free-interceptormemcpy0.html: The repro-file

prefs.js: Firefox prefs.js file, not required, but included to ensure reproducability

report.txt: This file

repro-server.py: python server that serves included files via http and 'no-cache'

On my machine the issue has reproduced reliably, but requires firefox to be run with xvfb.

You can find ffpuppet run log from the attached .zip file.

Reproducing:

```
# 0. cd to the folder extracted from the zip
# 1. Start python server
python repro-server.py 8000 &
# 2. Run firefox with ffpuppet and included prefs.js
ffpuppet ~/Downloads/firefox/firefox -u http://localhost:8000/heap-use-after-free-interceptormemcpy0.html -p ./prefs.js --xvfb -d
# 3. Wait. On my laptop the issue reproduced typically in ~23s, or multiple of 23s, but under 2min.

```

ASAN-trace:

```
==1162948==ERROR: AddressSanitizer: heap-use-after-free on address 0x61200026ee40 at pc 0x55e691fc1354 bp 0x7fff2e8fff00 sp 0x7fff2e8ff6c0
READ of size 64 at 0x61200026ee40 thread T0 (Isolated Web Co)
    #0 0x55e691fc1353 in __interceptor_memcpy /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5
    #1 0x7fc24cf54554  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x811554)
    #2 0x7fc24cf54aa9  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x811aa9)
    #3 0x7fc24cf54ec9  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x811ec9)
    #4 0x7fc24cf55746  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x812746)
    #5 0x7fc24cf6dc3a  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x82ac3a)
    #6 0x7fc24c90e768  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x1cb768)
    #7 0x7fc24c90d225  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x1ca225)
    #8 0x7fc24c8f84a9  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x1b54a9)
    #9 0x7fc24c9d7c58  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x294c58)
    #10 0x7fc24c9d8f46  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x295f46)
    #11 0x7fc26a28289f in mozilla::gl::GLContext::raw_fDrawElementsInstanced(unsigned int, int, unsigned int, void const*, int) /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:2521:5
    #12 0x7fc26a271b98 in mozilla::gl::GLContext::fDrawElementsInstanced(unsigned int, int, unsigned int, void const*, int) /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:2504:5
    #13 0x7fc26a271478 in mozilla::WebGLContext::DrawElementsInstanced(unsigned int, int, unsigned int, long, int)
...
0x61200026ee40 is located 0 bytes inside of 268-byte region [0x61200026ee40,0x61200026ef4c)
freed by thread T0 (Isolated Web Co) here:
    #0 0x55e6920254c2 in __interceptor_free /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x7fc24c94f55f  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x20c55f)

previously allocated by thread T0 (Isolated Web Co) here:
    #0 0x55e692026197 in __interceptor_posix_memalign /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cpp:210:3
    #1 0x7fc24c94f63d  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x20c63d)

SUMMARY: AddressSanitizer: heap-use-after-free /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5 in __interceptor_memcpy

```

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a14924_406194)• 3 years ago |

Group: core-security → gfx-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1749292#c1)• 3 years ago |
|  | |

This was allocated, freed, and accessed from the driver -- probably not a Firefox bug? What version of the driver are you using? The "graphics" section of about:support on your machine would be very helpful here.

If it *is* the driver there's not a lot we could do except add it to our blacklist

Flags: needinfo?(attekett)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1749292#c2)• 3 years ago |
|  | |

Is your test profile "old" enough to have a populated blocklist for graphics drivers? Maybe we've already blocked this one but your test is getting around it.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a206989_1689)• 3 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1749292#c3)• 3 years ago |
|  | |

I can repro on Ubuntu 20.04 with a clean profile (using ffpuppet). Driver version is `Version: 21.0.3-0ubuntu0.3~20.04.5`

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1749292#c4)• 3 years ago |
|  | |

about:support Graphics info from ffpuppet launched Firefox:

```
Graphics
--------

Features
Compositing: WebRender
Asynchronous Pan/Zoom: wheel input enabled; scrollbar drag enabled; keyboard enabled; autoscroll enabled; smooth pinch-zoom enabled
WebGL 1 Driver WSI Info: EGL_VENDOR: Mesa Project EGL_VERSION: 1.4 EGL_EXTENSIONS: EGL_ANDROID_blob_cache EGL_ANDROID_native_fence_sync EGL_CHROMIUM_sync_control EGL_EXT_buffer_age EGL_EXT_image_dma_buf_import EGL_EXT_image_dma_buf_import_modifiers EGL_EXT_swap_buffers_with_damage EGL_KHR_cl_event2 EGL_KHR_config_attribs EGL_KHR_create_context EGL_KHR_create_context_no_error EGL_KHR_fence_sync EGL_KHR_get_all_proc_addresses EGL_KHR_gl_colorspace EGL_KHR_gl_renderbuffer_image EGL_KHR_gl_texture_2D_image EGL_KHR_gl_texture_3D_image EGL_KHR_gl_texture_cubemap_image EGL_KHR_image EGL_KHR_image_base EGL_KHR_image_pixmap EGL_KHR_no_config_context EGL_KHR_reusable_sync EGL_KHR_surfaceless_context EGL_KHR_swap_buffers_with_damage EGL_EXT_pixel_format_float EGL_KHR_wait_sync EGL_MESA_configless_context EGL_MESA_drm_image EGL_MESA_image_dma_buf_export EGL_MESA_query_driver EGL_NOK_texture_from_pixmap EGL_WL_bind_wayland_display EGL_EXTENSIONS(nullptr): EGL_EXT_device_base EGL_EXT_device_enumeration EGL_EXT_device_query EGL_EXT_platform_base EGL_KHR_client_get_all_proc_addresses EGL_EXT_client_extensions EGL_KHR_debug EGL_EXT_platform_device EGL_EXT_platform_wayland EGL_KHR_platform_wayland EGL_EXT_platform_x11 EGL_KHR_platform_x11 EGL_MESA_platform_xcb EGL_MESA_platform_gbm EGL_KHR_platform_gbm EGL_MESA_platform_surfaceless IsWebglOutOfProcessEnabled: 0
WebGL 1 Driver Renderer: VMware, Inc. -- SVGA3D; build: RELEASE; LLVM;
WebGL 1 Driver Version: 4.1 (Compatibility Profile) Mesa 21.0.3
WebGL 1 Driver Extensions: GL_ARB_multisample GL_EXT_abgr GL_EXT_bgra GL_EXT_blend_color GL_EXT_blend_minmax GL_EXT_blend_subtract GL_EXT_copy_texture GL_EXT_subtexture GL_EXT_texture_object GL_EXT_vertex_array GL_EXT_compiled_vertex_array GL_EXT_texture GL_EXT_texture3D GL_IBM_rasterpos_clip GL_ARB_point_parameters GL_EXT_draw_range_elements GL_EXT_packed_pixels GL_EXT_point_parameters GL_EXT_rescale_normal GL_EXT_separate_specular_color GL_EXT_texture_edge_clamp GL_SGIS_generate_mipmap GL_SGIS_texture_border_clamp GL_SGIS_texture_edge_clamp GL_SGIS_texture_lod GL_ARB_framebuffer_sRGB GL_ARB_multitexture GL_EXT_framebuffer_sRGB GL_IBM_multimode_draw_arrays GL_IBM_texture_mirrored_repeat GL_ARB_texture_cube_map GL_ARB_texture_env_add GL_ARB_transpose_matrix GL_EXT_blend_func_separate GL_EXT_fog_coord GL_EXT_multi_draw_arrays GL_EXT_secondary_color GL_EXT_texture_env_add GL_EXT_texture_filter_anisotropic GL_EXT_texture_lod_bias GL_INGR_blend_func_separate GL_NV_blend_square GL_NV_light_max_exponent GL_NV_texgen_reflection GL_NV_texture_env_combine4 GL_S3_s3tc GL_SUN_multi_draw_arrays GL_ARB_texture_border_clamp GL_ARB_texture_compression GL_EXT_framebuffer_object GL_EXT_texture_compression_s3tc GL_EXT_texture_env_combine GL_EXT_texture_env_dot3 GL_MESA_window_pos GL_NV_packed_depth_stencil GL_NV_texture_rectangle GL_ARB_depth_texture GL_ARB_occlusion_query GL_ARB_shadow GL_ARB_texture_env_combine GL_ARB_texture_env_crossbar GL_ARB_texture_env_dot3 GL_ARB_texture_mirrored_repeat GL_ARB_window_pos GL_ATI_fragment_shader GL_EXT_stencil_two_side GL_EXT_texture_cube_map GL_NV_depth_clamp GL_NV_fog_distance GL_NV_half_float GL_APPLE_packed_pixels GL_ARB_draw_buffers GL_ARB_fragment_program GL_ARB_fragment_shader GL_ARB_shader_objects GL_ARB_vertex_program GL_ARB_vertex_shader GL_ATI_draw_buffers GL_ATI_texture_env_combine3 GL_ATI_texture_float GL_EXT_shadow_funcs GL_EXT_stencil_wrap GL_MESA_pack_invert GL_NV_primitive_restart GL_ARB_depth_clamp GL_ARB_fragment_program_shadow GL_ARB_half_float_pixel GL_ARB_occlusion_query2 GL_ARB_point_sprite GL_ARB_shading_language_100 GL_ARB_sync GL_ARB_texture_non_power_of_two GL_ARB_vertex_buffer_object GL_ATI_blend_equation_separate GL_EXT_blend_equation_separate GL_OES_read_format GL_ARB_color_buffer_float GL_ARB_pixel_buffer_object GL_ARB_texture_compression_rgtc GL_ARB_texture_float GL_ARB_texture_rectangle GL_EXT_packed_float GL_EXT_pixel_buffer_object GL_EXT_texture_compression_dxt1 GL_EXT_texture_compression_rgtc GL_EXT_texture_rectangle GL_EXT_texture_sRGB GL_EXT_texture_shared_exponent GL_ARB_framebuffer_object GL_EXT_framebuffer_blit GL_EXT_framebuffer_multisample GL_EXT_packed_depth_stencil GL_ARB_vertex_array_object GL_ATI_separate_stencil GL_EXT_draw_buffers2 GL_EXT_draw_instanced GL_EXT_gpu_program_parameters GL_EXT_gpu_shader4 GL_EXT_texture_array GL_EXT_texture_integer GL_EXT_texture_sRGB_decode GL_EXT_timer_query GL_OES_EGL_image GL_EXT_texture_buffer_object GL_AMD_texture_texture4 GL_ARB_copy_buffer GL_ARB_depth_buffer_float GL_ARB_draw_instanced GL_ARB_half_float_vertex GL_ARB_instanced_arrays GL_ARB_map_buffer_range GL_ARB_texture_buffer_object GL_ARB_texture_rg GL_ARB_texture_swizzle GL_ARB_vertex_array_bgra GL_EXT_texture_swizzle GL_EXT_vertex_array_bgra GL_NV_conditional_render GL_AMD_conservative_depth GL_AMD_draw_buffers_blend GL_ARB_ES2_compatibility GL_ARB_blend_func_extended GL_ARB_compatibility GL_ARB_debug_output GL_ARB_draw_buffers_blend GL_ARB_draw_elements_base_vertex GL_ARB_explicit_attrib_location GL_ARB_fragment_coord_conventions GL_ARB_provoking_vertex GL_ARB_sample_shading GL_ARB_sampler_objects GL_ARB_seamless_cube_map GL_ARB_shader_texture_lod GL_ARB_tessellation_shader GL_ARB_texture_buffer_object_rgb32 GL_ARB_texture_cube_map_array GL_ARB_texture_gather GL_ARB_texture_multisample GL_ARB_texture_query_lod GL_ARB_texture_rgb10_a2ui GL_ARB_uniform_buffer_object GL_ARB_vertex_type_2_10_10_10_rev GL_EXT_provoking_vertex GL_EXT_texture_snorm GL_MESA_texture_signed_rgba GL_NV_copy_image GL_ARB_draw_indirect GL_ARB_get_program_binary GL_ARB_gpu_shader5 GL_ARB_gpu_shader_fp64 GL_ARB_robustness GL_ARB_separate_shader_objects GL_ARB_shader_bit_encoding GL_ARB_shader_precision GL_ARB_shader_subroutine GL_ARB_timer_query GL_ARB_transform_feedback2 GL_ARB_transform_feedback3 GL_ARB_vertex_attrib_64bit GL_ARB_viewport_array GL_EXT_direct_state_access GL_EXT_vertex_attrib_64bit GL_AMD_multi_draw_indirect GL_ANGLE_texture_compression_dxt3 GL_ANGLE_texture_compression_dxt5 GL_ARB_compressed_texture_pixel_storage GL_ARB_conservative_depth GL_ARB_internalformat_query GL_ARB_map_buffer_alignment GL_ARB_shading_language_420pack GL_ARB_shading_language_packing GL_ARB_texture_storage GL_ARB_transform_feedback_instanced GL_EXT_framebuffer_multisample_blit_scaled GL_EXT_transform_feedback GL_AMD_shader_trinary_minmax GL_ARB_ES3_compatibility GL_ARB_arrays_of_arrays GL_ARB_clear_buffer_object GL_ARB_copy_image GL_ARB_explicit_uniform_location GL_ARB_fragment_layer_viewport GL_ARB_invalidate_subdata GL_ARB_multi_draw_indirect GL_ARB_program_interface_query GL_ARB_texture_buffer_range GL_ARB_texture_query_levels GL_ARB_texture_storage_multisample GL_ARB_vertex_attrib_binding GL_KHR_debug GL_KHR_texture_compression_astc_ldr GL_ARB_buffer_storage GL_ARB_clear_texture GL_ARB_internalformat_query2 GL_ARB_multi_bind GL_ARB_shading_language_include GL_EXT_shader_integer_mix GL_ARB_direct_state_access GL_ARB_get_texture_sub_image GL_KHR_context_flush_control GL_ARB_parallel_shader_compile GL_KHR_no_error GL_KHR_texture_compression_astc_sliced_3d GL_MESA_shader_integer_functions GL_ARB_texture_filter_anisotropic GL_KHR_parallel_shader_compile GL_EXT_EGL_image_storage GL_EXT_EGL_sync
WebGL 1 Extensions: ANGLE_instanced_arrays EXT_blend_minmax EXT_color_buffer_half_float EXT_float_blend EXT_frag_depth EXT_shader_texture_lod EXT_sRGB EXT_texture_compression_rgtc EXT_texture_filter_anisotropic MOZ_debug OES_element_index_uint OES_fbo_render_mipmap OES_standard_derivatives OES_texture_float OES_texture_float_linear OES_texture_half_float OES_texture_half_float_linear OES_vertex_array_object WEBGL_color_buffer_float WEBGL_compressed_texture_astc WEBGL_compressed_texture_etc WEBGL_compressed_texture_s3tc WEBGL_compressed_texture_s3tc_srgb WEBGL_debug_renderer_info WEBGL_debug_shaders WEBGL_depth_texture WEBGL_draw_buffers WEBGL_lose_context
WebGL 2 Driver WSI Info: EGL_VENDOR: Mesa Project EGL_VERSION: 1.4 EGL_EXTENSIONS: EGL_ANDROID_blob_cache EGL_ANDROID_native_fence_sync EGL_CHROMIUM_sync_control EGL_EXT_buffer_age EGL_EXT_image_dma_buf_import EGL_EXT_image_dma_buf_import_modifiers EGL_EXT_swap_buffers_with_damage EGL_KHR_cl_event2 EGL_KHR_config_attribs EGL_KHR_create_context EGL_KHR_create_context_no_error EGL_KHR_fence_sync EGL_KHR_get_all_proc_addresses EGL_KHR_gl_colorspace EGL_KHR_gl_renderbuffer_image EGL_KHR_gl_texture_2D_image EGL_KHR_gl_texture_3D_image EGL_KHR_gl_texture_cubemap_image EGL_KHR_image EGL_KHR_image_base EGL_KHR_image_pixmap EGL_KHR_no_config_context EGL_KHR_reusable_sync EGL_KHR_surfaceless_context EGL_KHR_swap_buffers_with_damage EGL_EXT_pixel_format_float EGL_KHR_wait_sync EGL_MESA_configless_context EGL_MESA_drm_image EGL_MESA_image_dma_buf_export EGL_MESA_query_driver EGL_NOK_texture_from_pixmap EGL_WL_bind_wayland_display EGL_EXTENSIONS(nullptr): EGL_EXT_device_base EGL_EXT_device_enumeration EGL_EXT_device_query EGL_EXT_platform_base EGL_KHR_client_get_all_proc_addresses EGL_EXT_client_extensions EGL_KHR_debug EGL_EXT_platform_device EGL_EXT_platform_wayland EGL_KHR_platform_wayland EGL_EXT_platform_x11 EGL_KHR_platform_x11 EGL_MESA_platform_xcb EGL_MESA_platform_gbm EGL_KHR_platform_gbm EGL_MESA_platform_surfaceless IsWebglOutOfProcessEnabled: 0
WebGL 2 Driver Renderer: VMware, Inc. -- SVGA3D; build: RELEASE; LLVM;
WebGL 2 Driver Version: 4.1 (Core Profile) Mesa 21.0.3
WebGL 2 Driver Extensions: GL_AMD_conservative_depth GL_AMD_draw_buffers_blend GL_AMD_multi_draw_indirect GL_AMD_shader_trinary_minmax GL_AMD_texture_texture4 GL_ANGLE_texture_compression_dxt3 GL_ANGLE_texture_compression_dxt5 GL_ARB_ES2_compatibility GL_ARB_ES3_compatibility GL_ARB_arrays_of_arrays GL_ARB_blend_func_extended GL_ARB_buffer_storage GL_ARB_clear_buffer_object GL_ARB_clear_texture GL_ARB_compressed_texture_pixel_storage GL_ARB_conservative_depth GL_ARB_copy_buffer GL_ARB_copy_image GL_ARB_debug_output GL_ARB_depth_buffer_float GL_ARB_depth_clamp GL_ARB_direct_state_access GL_ARB_draw_buffers GL_ARB_draw_buffers_blend GL_ARB_draw_elements_base_vertex GL_ARB_draw_indirect GL_ARB_draw_instanced GL_ARB_explicit_attrib_location GL_ARB_explicit_uniform_location GL_ARB_fragment_coord_conventions GL_ARB_fragment_layer_viewport GL_ARB_fragment_shader GL_ARB_framebuffer_object GL_ARB_framebuffer_sRGB GL_ARB_get_program_binary GL_ARB_get_texture_sub_image GL_ARB_gpu_shader5 GL_ARB_gpu_shader_fp64 GL_ARB_half_float_pixel GL_ARB_half_float_vertex GL_ARB_instanced_arrays GL_ARB_internalformat_query GL_ARB_internalformat_query2 GL_ARB_invalidate_subdata GL_ARB_map_buffer_alignment GL_ARB_map_buffer_range GL_ARB_multi_bind GL_ARB_multi_draw_indirect GL_ARB_occlusion_query2 GL_ARB_parallel_shader_compile GL_ARB_pixel_buffer_object GL_ARB_point_sprite GL_ARB_program_interface_query GL_ARB_provoking_vertex GL_ARB_robustness GL_ARB_sample_shading GL_ARB_sampler_objects GL_ARB_seamless_cube_map GL_ARB_separate_shader_objects GL_ARB_shader_bit_encoding GL_ARB_shader_objects GL_ARB_shader_precision GL_ARB_shader_subroutine GL_ARB_shader_texture_lod GL_ARB_shading_language_420pack GL_ARB_shading_language_include GL_ARB_shading_language_packing GL_ARB_sync GL_ARB_tessellation_shader GL_ARB_texture_buffer_object GL_ARB_texture_buffer_object_rgb32 GL_ARB_texture_buffer_range GL_ARB_texture_compression_rgtc GL_ARB_texture_cube_map_array GL_ARB_texture_filter_anisotropic GL_ARB_texture_float GL_ARB_texture_gather GL_ARB_texture_multisample GL_ARB_texture_non_power_of_two GL_ARB_texture_query_levels GL_ARB_texture_query_lod GL_ARB_texture_rectangle GL_ARB_texture_rg GL_ARB_texture_rgb10_a2ui GL_ARB_texture_storage GL_ARB_texture_storage_multisample GL_ARB_texture_swizzle GL_ARB_timer_query GL_ARB_transform_feedback2 GL_ARB_transform_feedback3 GL_ARB_transform_feedback_instanced GL_ARB_uniform_buffer_object GL_ARB_vertex_array_bgra GL_ARB_vertex_array_object GL_ARB_vertex_attrib_64bit GL_ARB_vertex_attrib_binding GL_ARB_vertex_buffer_object GL_ARB_vertex_shader GL_ARB_vertex_type_2_10_10_10_rev GL_ARB_viewport_array GL_ATI_blend_equation_separate GL_ATI_texture_float GL_EXT_EGL_image_storage GL_EXT_EGL_sync GL_EXT_abgr GL_EXT_blend_equation_separate GL_EXT_draw_buffers2 GL_EXT_draw_instanced GL_EXT_framebuffer_blit GL_EXT_framebuffer_multisample GL_EXT_framebuffer_multisample_blit_scaled GL_EXT_framebuffer_object GL_EXT_framebuffer_sRGB GL_EXT_packed_depth_stencil GL_EXT_packed_float GL_EXT_pixel_buffer_object GL_EXT_provoking_vertex GL_EXT_shader_integer_mix GL_EXT_texture_array GL_EXT_texture_compression_dxt1 GL_EXT_texture_compression_rgtc GL_EXT_texture_compression_s3tc GL_EXT_texture_filter_anisotropic GL_EXT_texture_integer GL_EXT_texture_sRGB GL_EXT_texture_sRGB_decode GL_EXT_texture_shared_exponent GL_EXT_texture_snorm GL_EXT_texture_swizzle GL_EXT_timer_query GL_EXT_transform_feedback GL_EXT_vertex_array_bgra GL_EXT_vertex_attrib_64bit GL_IBM_multimode_draw_arrays GL_KHR_context_flush_control GL_KHR_debug GL_KHR_no_error GL_KHR_parallel_shader_compile GL_KHR_texture_compression_astc_ldr GL_KHR_texture_compression_astc_sliced_3d GL_MESA_pack_invert GL_MESA_shader_integer_functions GL_MESA_texture_signed_rgba GL_NV_conditional_render GL_NV_copy_image GL_NV_depth_clamp GL_NV_packed_depth_stencil GL_OES_EGL_image GL_S3_s3tc
WebGL 2 Extensions: EXT_color_buffer_float EXT_float_blend EXT_texture_compression_rgtc EXT_texture_filter_anisotropic MOZ_debug OES_texture_float_linear WEBGL_compressed_texture_astc WEBGL_compressed_texture_etc WEBGL_compressed_texture_s3tc WEBGL_compressed_texture_s3tc_srgb WEBGL_debug_renderer_info WEBGL_debug_shaders WEBGL_lose_context
Window Protocol: x11
Desktop Environment: gnome
Target Frame Rate: 60
GPU #1
Active: Yes
Description: SVGA3D; build: RELEASE; LLVM;
Vendor ID: 0x15ad
Device ID: 0x0405
Driver Vendor: mesa/vmwgfx
Driver Version: 21.0.3.0
RAM: 0

```
Flags: needinfo?(attekett)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a812507_1689)• 3 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1749292#c5)• 3 years ago |
|  | |

The severity field is not set for this bug.

:jgilbert, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1749292#c6)• 3 years ago |
|  | |

Well this is pretty much a nightmare to dig into. :(

Severity: -- → S3Flags: needinfo?(jgilbert)Priority: -- → P2

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1749292#c7)• 3 years ago |
|  | |

(In reply to Kelsey Gilbert [:jgilbert] (previously Jeff) from [comment #6](/show_bug.cgi?id=1749292#c6 "RESOLVED FIXED - Use-after-free in mozilla::gl::GLContext::raw_fDrawElementsInstanced"))

> Well this is pretty much a nightmare to dig into. :(

Would a Pernosco session be helpful?

Flags: needinfo?(jgilbert)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1749292#c8)• 3 years ago |
|  | |

Attached file
[testcase.zip](attachment.cgi?id=9260692)
— [Details](attachment.cgi?id=9260692&action=edit)

Here is a Grizzly (and bugmon) compatible version of the testcase. It is unreduce but I can likely reduce it a bit if necessary.

To reproduce via Grizzly Replay:

```
$ pip install fuzzfetch grizzly-framework
$ python -m fuzzfetch -a --fuzzing -n firefox
$ python -m grizzly.replay ./firefox/firefox testcase.zip --xvfb

```
[Attachment #9258310](/attachment.cgi?id=9258310&action=edit "heap-use-after-free-interceptormemcpy-GLContextrawfDrawElementsInstanced.zip") -
Attachment is obsolete: true

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a1319562_486634)• 3 years ago |

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)Keywords: [bugmon](/buglist.cgi?keywords=bugmon&resolution=---)

|  | [Bugmon [:jkratzer for issues]](/user_profile?user_id=676404) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1749292#c9)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1749292&comment_id=15749111 "1 revision") |
|  | |

**Bugmon Analysis**

Verified bug as reproducible on mozilla-central 20220126034745-504105450146.

The bug appears to have been introduced in the following build range:

> Start: 2cc060f28173df859489d115bd7497442826547f (20210505041336)
>
> End: 3a418c38c3e4c53139813cc4a2371a8610bb57f0 (20210504235604)
>
> Pushlog: <https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=2cc060f28173df859489d115bd7497442826547f&tochange=3a418c38c3e4c53139813cc4a2371a8610bb57f0>

Whiteboard: [bugmon:bisected,confirmed]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1749292#c10)• 3 years ago |
|  | |

Nothing that looks explicitly canvas related in that range. There are a few WebRender-related patches.

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1749292#c11)• 3 years ago |
|  | |

(In reply to Tyson Smith [:tsmith] from [comment #7](/show_bug.cgi?id=1749292#c7 "RESOLVED FIXED - Use-after-free in mozilla::gl::GLContext::raw_fDrawElementsInstanced"))

> (In reply to Kelsey Gilbert [:jgilbert] (previously Jeff) from [comment #6](/show_bug.cgi?id=1749292#c6 "RESOLVED FIXED - Use-after-free in mozilla::gl::GLContext::raw_fDrawElementsInstanced"))
>
> > Well this is pretty much a nightmare to dig into. :(
>
> Would a Pernosco session be helpful?

Unlikely, but it wouldn't hurt. Looks like a bug buried in the driver.

Flags: needinfo?(jgilbert)

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1749292#c12)• 3 years ago |
|  | |

Attached file
[SEGV-0x7f03955126990.html](attachment.cgi?id=9263267)
— [Details](attachment.cgi?id=9263267&action=edit)

Maybe this can help, I think this SEGV I'm seeing on my fuzzing is also related to this issue.

On ASAN opt build it shows up as a SEGV to a high address, with lowest bytes always 2699, but without stack.

```
=================================================================
==288052==ERROR: AddressSanitizer: SEGV on unknown address 0x7fd2034b2699 (pc 0x7fd2034b67a1 bp 0x60e0000b7778 sp 0x7fffd900b3c8 T0)
==288052==The signal is caused by a WRITE memory access.

```

On ASAN debug build it reproduces as:

```
==288304==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fea0cded150 bp 0x7fffa620f850 sp 0x7fffa620f830 T0)
==288304==The signal is caused by a WRITE memory access.
==288304==Hint: address points to the zero page.
    #0 0x7fea0cded150 in mozilla::gfx::Log<1, mozilla::gfx::CriticalLogger>::WriteLog(std::string const&) /builds/worker/checkouts/gecko/gfx/2d/Logging.h:752:9
    #1 0x7fea0cdecf9e in mozilla::gfx::Log<1, mozilla::gfx::CriticalLogger>::Flush() /builds/worker/checkouts/gecko/gfx/2d/Logging.h:277:7
    #2 0x7fea0cdec8d5 in mozilla::gfx::Log<1, mozilla::gfx::CriticalLogger>::~Log() /builds/worker/checkouts/gecko/gfx/2d/Logging.h:270:12
    #3 0x7fea0d0ae81a in mozilla::gl::GLContext::AfterGLCall_Debug(char const*) const /builds/worker/checkouts/gecko/gfx/gl/GLContext.cpp:2604:7
    #4 0x7fea12a24287 in mozilla::gl::GLContext::AfterGLCall(char const*) const /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:684:7
    #5 0x7fea12a24287 in mozilla::gl::GLContext::raw_fDrawArrays(unsigned int, int, int) /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:1077:5
    #6 0x7fea12a24287 in mozilla::gl::GLContext::fDrawArrays(unsigned int, int, int) /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:1090:5
    #7 0x7fea12a23392 in mozilla::WebGLContext::DrawArraysInstanced(unsigned int, int, int, int) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextDraw.cpp:719:13
    #8 0x7fea12874bcf in mozilla::HostWebGLContext::DrawArraysInstanced(unsigned int, int, int, int) const /builds/worker/checkouts/gecko/dom/canvas/HostWebGLContext.h:738:15

```

In stderr-log:

```
ATTENTION: default value of option mesa_glthread overridden by environment.
Initializing context 0x60b00008f5c0 surface 0x61800001e880 on display 0x61b000091480
GL_VENDOR: Mesa/X.org
mVendor: Unknown
GL_RENDERER: llvmpipe (LLVM 12.0.0, 256 bits)
mRenderer: Unknown
mIsMesa: 1
[Child 288304, Main Thread] WARNING: robust_buffer_access_behavior marked as unsupported: file /builds/worker/checkouts/gecko/gfx/gl/GLContextFeatures.cpp:632
[2022-02-10T11:41:20Z WARN  webrender::renderer] asking to enable_gpu_markers but no supporting extension was found
JavaScript warning: file:////SEGV-0x7f03955126990, line 68: WebGL warning: drawArraysInstanced: Drawing without vertex attrib 0 array enabled forces the browser to do expensive emulation work when running on desktop OpenGL platforms, for example on Mac. It is preferable to always draw with vertex attrib 0 array enabled, by using bindAttribLocation to bind some always-used attribute to location 0.
[gl:0x61e00001e080] void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error.
Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /builds/worker/checkouts/gecko/gfx/2d/Logging.h:751
#01: ???[/firefox-debug/libxul.so +0xf2ad10c]
#02: ???[/firefox-debug/libxul.so +0xf2acf9f]

```

This issue is easier to reproduce, with a single file, when using ffpuppet and xvfb:

```
ffpuppet ~/Downloads/firefox/firefox -u ~/SEGV-0x7f03955126990.html --xvfb

```

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1749292#c13)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1749292&comment_id=15773491 "1 revision") |
|  | |

That's a fatal assert in that debug build, not a uaf or anything.

That should probably be filed separately, (edit) probably sec if the opt build is crashing too.

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1749292#c14)• 3 years ago |
|  | |

I'll file separately, Monday.

Even without being catched as an UAF, I suspect these cases are related. The assert is thrown in the same function where the execution switches to driver in the UAF trace, and crash on opt build.

I don't know if the same assert would be triggered with the UAF repro, as I have not been able to reproduce the UAF on a debug build.

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1749292#c15)• 3 years ago |
|  | |

Filed the SEGV as a separate issue: [bug #1755448](/show_bug.cgi?id=1755448 "RESOLVED DUPLICATE - High address SEGV and Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a3231116_1689)• 3 years ago |

See Also: → [1755448](/show_bug.cgi?id=1755448 "RESOLVED DUPLICATE - High address SEGV and Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1749292#c16)• 3 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:jgilbert, could you consider increasing the severity of this security bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#severity_high_security.py).

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1749292#c17)• 3 years ago |
|  | |

For this I think S3 is fine.

Flags: needinfo?(jgilbert)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a6846409_279663)• 3 years ago |

Keywords: [stalled](/buglist.cgi?keywords=stalled&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a21883014_578488)• 2 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1749292#c18)• 2 years ago |
|  | |

`stalled` is not an appropriate state when we have a reproducible testcase. It means we're stuck waiting for more information, not that we don't have someone with the time to dig into the problem.

If we think this is not a Firefox bug we still have things we can and need to do on our end. For example, report the driver bug upstream so it can be fixed, or blocklist that driver (or versions of it), or wallpaper over the problem by not sending triggering input to the driver.

Keywords: [stalled](/buglist.cgi?keywords=stalled&resolution=---)

|  | [Jim Blandy :jimb](/user_profile?user_id=298765) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a23876501_298765)• 2 years ago |

Assignee: nobody → jimb

|  | [Bugmon [:jkratzer for issues]](/user_profile?user_id=676404) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1749292#c19)• 2 years ago |
|  | |

Testcase crashes using the initial build (mozilla-central 20220110093702-b81970e39db4) but not with tip (mozilla-central 20221105092350-4dfcb6e877c9.)

The bug appears to have been fixed in the following build range:

> Start: f26b25c10ec6c4ddc3b76ff6e87aa1abf86edbf9 (20220802050105)
>
> End: 63f3dba2a24f1c2990d97ae2de956f4b753a7503 (20220802055846)
>
> Pushlog: <https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=f26b25c10ec6c4ddc3b76ff6e87aa1abf86edbf9&tochange=63f3dba2a24f1c2990d97ae2de956f4b753a7503>

jimb, can you confirm that the above bisection range is responsible for fixing this issue?

Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.

Flags: needinfo?(jimb)Keywords: [bugmon](/buglist.cgi?keywords=bugmon&resolution=---)

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1749292#c20)• 2 years ago |
|  | |

FYI, if the fix was the commit for [Bug #1768190](/show_bug.cgi?id=1768190 "VERIFIED FIXED - Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /gfx/2d/Logging.h:754"),

that assert looks same to what I reported

related to this issue as [Bug #1755448](/show_bug.cgi?id=1755448 "RESOLVED DUPLICATE - High address SEGV and Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION").

|  | [Jim Blandy :jimb](/user_profile?user_id=298765) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1749292#c21)• 2 years ago |
|  | |

I'm unable to reproduce the original bug, either at the current changeset or at the original (mozilla-central 20220110093702-b81970e39db4), under Wayland or X11 sessions, using --headless or --xvfb.

[Bug 1768190](/show_bug.cgi?id=1768190 "VERIFIED FIXED - Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /gfx/2d/Logging.h:754") seems like a plausible candidate for fixing this. Since Bugmon claims it could reproduce it but can no longer do so, I think this is fine to close.

Status: NEW → RESOLVEDClosed: 2 years agoFlags: needinfo?(jimb)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1749292#c22)• 2 years ago |
|  | |

I'm not sure how much this bug contributed to the fix in the end, but it does highlight that the innocuous-looking "fuzzblocker" Jason reported was actually UAF.

Depends on: [1768190](/show_bug.cgi?id=1768190 "VERIFIED FIXED - Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /gfx/2d/Logging.h:754")Flags: sec-bounty? → sec-bounty+Whiteboard: [bugmon:bisected,confirmed] → fixed by bug 1768190[bugmon:bisected,confirmed]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1749292#c23)• 2 years ago |
|  | |

I guess we should backport [bug 1768190](/show_bug.cgi?id=1768190 "VERIFIED FIXED - Assertion failure: [GFX1]: void mozilla::gl::GLContext::raw_fDrawArrays(GLenum, GLint, GLsizei): Generated unexpected GL_INVALID_OPERATION error, at /gfx/2d/Logging.h:754") to ESR102 then?

Assignee: jimb → jgilbertGroup: gfx-core-security → core-security-release
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)Flags: needinfo?(dveditz)Target Milestone: --- → 105 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1749292#c24)• 2 years ago |
|  | |

Yeah, we should do that.

[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B)Flags: needinfo?(dveditz)Whiteboard: fixed by bug 1768190[bugmon:bisected,confirmed] → [fixed by bug 1768190][bugmon:bisected,confirmed]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a27999363_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1749292#c25)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9307419)
— [Details](attachment.cgi?id=9307419&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a28713525_578488)• 2 years ago |

Whiteboard: [fixed by bug 1768190][bugmon:bisected,confirmed] → [fixed by bug 1768190][bugmon:bisected,confirmed][adv-esr102.6+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a28783282_578488)• 2 years ago |

Alias: CVE-2022-46880

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a75271619_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1749292#a84649784_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1749292&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Atte Kettunen](/user_profile?user_id=420648)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


