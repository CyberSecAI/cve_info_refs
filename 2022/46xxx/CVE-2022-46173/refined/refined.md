Based on the provided content, here's an analysis of CVE-2022-46173:

**Root cause of vulnerability:**

- The vulnerability stems from an issue in how the smart contract result (SCR) transactions are looked up and cached during the processing of cross-shard relayed transactions with smart contract deploy data. Specifically, if a transaction was sent with more gas than required, the resulting SCR transaction (which should return the leftover gas) might be added to a cache that the processing unit wouldn't consider, leading to a failure in processing.

**Weaknesses/vulnerabilities present:**

- Incorrect correlation between transaction caches and the processing component.
- The system relied on finding the SCR in a specific cache.
- When the SCR was not present in the expected cache, the node stopped notarizing metachain blocks

**Impact of exploitation:**

- Nodes stop notarizing metachain blocks
- The node stops processing, this can lead to a denial of service of the blockchain

**Attack vectors:**

- Sending cross-shard relayed transactions with smart contract deploy data with more gas than needed.

**Required attacker capabilities/position:**

- An attacker needs to be able to send transactions to the network.
- The attacker does not need specific access to the system other than the ability to send a transaction that could trigger this specific condition.

**Additional notes:**

- The fix for this issue involves extending the SCR transaction search to all other caches if it is not found in the expected sharded-cache.
- The vulnerability affects versions <= v1.3.48 of elrond-go, and the patch is included in versions >= v1.3.50.