Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the lack of proper sanitization of the `id_order` parameter in the `PDFMandate::mandatePDF()` method (or `pdftot::MandatePDF()` in older versions) of the `totadministrativemandate` module for PrestaShop.
*   Specifically, the `id_order` parameter, obtained from the HTTP request, is directly inserted into an SQL query without using `pSQL()` (PrestaShop's sanitization method)

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:** The primary vulnerability is a blind SQL injection. This occurs because the unsanitized `id_order` parameter is used in an SQL query, allowing an attacker to inject malicious SQL code.

**Impact of Exploitation:**

*   **Obtain Admin Access:** An attacker could potentially use the SQL injection to gain administrative access to the PrestaShop installation.
*   **Data Removal:** An attacker could also remove data from the associated PrestaShop database through malicious SQL queries.

**Attack Vectors:**

*   **HTTP Request:** The attack vector is through a crafted HTTP request to the `pdftot.php` file of the `totadministrativemandate` module.
*   **Vulnerable Parameter:** The vulnerable parameter is `id_order`.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker must be an authenticated user of the PrestaShop store.
*   **Network Access:** The attacker needs to have network access to send HTTP requests to the target PrestaShop server.

**Technical Details:**

*   The vulnerability exists in versions of the module from 1.2.1 to prior to 1.7.2.
*   The vulnerable code is located in the `pdfmandate15.php` and `pdfmandate16.php` files.
*   The provided patch demonstrates how the vulnerability is fixed by using `pSQL()` to sanitize the `reference` value before constructing the SQL query.

**Additional Recommendations:**

*   The advisory suggests upgrading the module to version 1.7.2 or higher
*   Upgrading PrestaShop to 1.7.8.8 or later to disable multi-query executions (separated by ";"), preventing an attacker from executing multiple queries at once through a single injection point.
*   Changing the default database prefix (`ps_`) to a longer arbitrary prefix is advised.