- **Root cause of vulnerability**: Malicious messages crafted by users can be executed as scripts when the user navigates to the drafts page, resulting in a self-XSS.
- **Weaknesses/vulnerabilities present**: Self-Cross-Site Scripting (Self-XSS). The vulnerability occurs because user-provided content is not properly sanitized/escaped before being rendered on the drafts page. This can lead to arbitrary JavaScript execution within the user's browser.
- **Impact of exploitation**: If the site's Content Security Policy (CSP) has been modified or disabled from Discourse's default settings, the self-XSS can escalate to a full XSS, potentially allowing the attacker to gain control of the user's account or perform actions on behalf of the user.
- **Attack vectors**: Network, by crafting a malicious message.
- **Required attacker capabilities/position**: The attacker needs to be able to craft a malicious message within the Discourse application, and the victim user has to navigate to the drafts page. They must also have a low privilege account and user interaction is required for the exploit to be successful. The vulnerability is exploitable if the Content Security Policy has been weakened.