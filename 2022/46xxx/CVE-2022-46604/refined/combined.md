=== Content from packetstormsecurity.com_b00877d4_20250114_193731.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from medium.com_ad7363f1_20250114_193742.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3290eddc54e7&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Ffile-extention-bypass-in-responsive-filemanager-9-5-5-leading-to-rce-authenticated-3290eddc54e7&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Ffile-extention-bypass-in-responsive-filemanager-9-5-5-leading-to-rce-authenticated-3290eddc54e7&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# File extension bypass in Responsive FileManager ≤9.9.5 leading to RCE (authenticated)

[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:88:88/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---byline--3290eddc54e7--------------------------------)

[Konstantin Burov](/%40_sadshade?source=post_page---byline--3290eddc54e7--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6ba332e183f&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40_sadshade%2Ffile-extention-bypass-in-responsive-filemanager-9-5-5-leading-to-rce-authenticated-3290eddc54e7&user=Konstantin+Burov&userId=c6ba332e183f&source=post_page-c6ba332e183f--byline--3290eddc54e7---------------------post_header-----------)

2 min read·Dec 2, 2022

--

Listen

Share

![]()

On one of the penetration testing projects, I came across an old version of Responsive FileManager — 9.9.2. All public exploits were for version 9.14 and below, but they do not work on this version, so I had to find a new one. In this short write-up you will learn how to use it.

The vulnerability was tested on versions 9.9.2 and 9.9.5. I did not find any mention of this vulnerability on the web and in the official repository on github.com. All I found was one line about fixing the vulnerability in version 9.9.6, with thanks to securitum.pl in the changelog.

![]()

When creating a file, three parameters are passed to RFM: `path`, `path_thumb`, and `new_content`, e.g.

`path=1.txt&path_thumb=../thumbs/.txt&name=1.txt&new_content=sometext`

You can use curl to create a text file:

![]()

When you tried create file with restricted extension like `.php` you will fail. However RFM checks only `name` parameter, and not `path` that is actually file name with path. And you can change it to `.php`, set appropriate content ang get the shell.

Like this:

![]()

There is no need to PoC or functional exploit for this bug, just use curl.

`curl -s “http://<HOSTNAME>/filemanager/execute.php?action=create_file” \
 -d “path=cmd.php&path_thumb=../thumbs/.txt&name=1.txt&new_content=<URL_ENCODED_CONTENT>” -H “Cookie: PHPSESSID=<VALID_COOKIE>”`

To fix this bug, just update RFM to version 9.9.6

That’s all, thanks for reading!

**Upd**: CVE-2022–46604 assigned

[Rce](/tag/rce?source=post_page-----3290eddc54e7--------------------------------)[Exploit](/tag/exploit?source=post_page-----3290eddc54e7--------------------------------)[PHP](/tag/php?source=post_page-----3290eddc54e7--------------------------------)[File Manager](/tag/file-manager?source=post_page-----3290eddc54e7--------------------------------)

--

--

[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:96:96/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---post_author_info--3290eddc54e7--------------------------------)[![Konstantin Burov](https://miro.medium.com/v2/resize:fill:128:128/2*acf68pemKtYyddOB-7nwdg.jpeg)](/%40_sadshade?source=post_page---post_author_info--3290eddc54e7--------------------------------)Follow[## Written by Konstantin Burov](/%40_sadshade?source=post_page---post_author_info--3290eddc54e7--------------------------------)[22 Followers](/%40_sadshade/followers?source=post_page---post_author_info--3290eddc54e7--------------------------------)·[5 Following](/%40_sadshade/following?source=post_page---post_author_info--3290eddc54e7--------------------------------)

PenTester, Information Security Engineer, <https://linkedin.com/in/burovlkdn>

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----3290eddc54e7--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----3290eddc54e7--------------------------------)[About](/about?autoplay=1&source=post_page-----3290eddc54e7--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3290eddc54e7--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----3290eddc54e7--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----3290eddc54e7--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3290eddc54e7--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3290eddc54e7--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----3290eddc54e7--------------------------------)[Teams](/business?source=post_page-----3290eddc54e7--------------------------------)



=== Content from github.com_91af5359_20250114_193737.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftrippo%2FResponsiveFilemanager%2Fblob%2Fv9.9.6%2Fchangelog.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftrippo%2FResponsiveFilemanager%2Fblob%2Fv9.9.6%2Fchangelog.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=trippo%2FResponsiveFilemanager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 15, 2024. It is now read-only.

[trippo](/trippo)
/
**[ResponsiveFilemanager](/trippo/ResponsiveFilemanager)**
Public archive

* [Notifications](/login?return_to=%2Ftrippo%2FResponsiveFilemanager) You must be signed in to change notification settings
* [Fork
  363](/login?return_to=%2Ftrippo%2FResponsiveFilemanager)
* [Star
   814](/login?return_to=%2Ftrippo%2FResponsiveFilemanager)

* [Code](/trippo/ResponsiveFilemanager/tree/v9.9.6)
* [Issues
  263](/trippo/ResponsiveFilemanager/issues)
* [Pull requests
  3](/trippo/ResponsiveFilemanager/pulls)
* [Actions](/trippo/ResponsiveFilemanager/actions)
* [Projects
  0](/trippo/ResponsiveFilemanager/projects)
* [Wiki](/trippo/ResponsiveFilemanager/wiki)
* [Security](/trippo/ResponsiveFilemanager/security)
* [Insights](/trippo/ResponsiveFilemanager/pulse)

Additional navigation options

* [Code](/trippo/ResponsiveFilemanager/tree/v9.9.6)
* [Issues](/trippo/ResponsiveFilemanager/issues)
* [Pull requests](/trippo/ResponsiveFilemanager/pulls)
* [Actions](/trippo/ResponsiveFilemanager/actions)
* [Projects](/trippo/ResponsiveFilemanager/projects)
* [Wiki](/trippo/ResponsiveFilemanager/wiki)
* [Security](/trippo/ResponsiveFilemanager/security)
* [Insights](/trippo/ResponsiveFilemanager/pulse)

## Files

 v9.9.6
## Breadcrumbs

1. [ResponsiveFilemanager](/trippo/ResponsiveFilemanager/tree/v9.9.6)
/
# changelog.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/trippo/ResponsiveFilemanager/commits/v9.9.6/changelog.txt)343 lines (270 loc) · 12.2 KB v9.9.6
## Breadcrumbs

1. [ResponsiveFilemanager](/trippo/ResponsiveFilemanager/tree/v9.9.6)
/
# changelog.txt

Top
## File metadata and controls

* Code
* Blame

343 lines (270 loc) · 12.2 KB[Raw](https://github.com/trippo/ResponsiveFilemanager/raw/refs/tags/v9.9.6/changelog.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343Responsive Filemanager Changelog
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.6\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- fixed a security vulnerability- code refactoring removed thumb path to ajax calls- improve file/folder permission layout and fixed a error- fixed a problem with image editor- added vitnamese language
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.5\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- fixed a Adobe Creative SDK issue- fixed a problem when you edit multiple image in the same session- fixed a problem with security issue in some server configurations- added maxSize config to Adobe Creative SDK export image (default now is 1400)
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.4\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- Upgrade Aviary Image Editor with new Adobe Creative SDK without size limitation- Add files and folders counter on each folder- Fixed a problem with folder selection on relative url
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.3\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- Fixed the problem with undefined windowParent- Fixed a problem with selection on CKeditor- Added bootstrap modal default support
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.2\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- added file selection directly from dropzone upload area (you can now select file directly after upload)- folder selection in context menu (you can now select also a folder)- responsive filemanager modal open on tinyMCE (the dimension of modal depend on window dimension)- utf8 translitteration fix
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.1\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- bugfix
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.9.0\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- add compatibility with CKEditor (thanks to dennis.buijs)- fix ordering and filtering bugs (in js and php)- Refactoring of configuration and language files (thanks to rkgrep)- updated libraries via bower dependency management (thanks to rkgrep)- added Assets compilation via gulp for developing (thanks to rkgrep)- added Hebrew lang (sagie212)
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.8.1\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- add compatibility with free full resolution with aviary image editor- convert all include(); with include ‘’;- fix a problem with lowercase automatically change
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.8\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- added pdf, openoffice files preview with customized viewer.js- added other office file preview with google preview- fixed ordering bug- improved layout style- added copy to clipboard button on show url dialog- fixed a bug when download a file- fixed a bug in relative path images creation- adding custom convert\_spaces [by fungio]
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.7.3\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*- Fix a problem with lazy load and filters- add option to remember text filter in session
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.7.2\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Major \*\*\*\*\*- Added mime type lib for downloads- Added lazy loading feature- Added options for auto and max image resizing- Lang. updates- Added touch devices support for drag&drop- Added support for returning relative URL-s- Bugfixes
\*\*\*\*\* Detailed \*\*\*\*\*- Added mime type lib for downloads All downloads no should load successfuly
- Added lazy loading feature Images will only load when in the viewport so when you are in a crowded folder it will load faster
- Added options for auto and max image resizing In the past all images that was resized either with max\_image or auto resize was cropped. Now the user can specify to crop,exact,landscape or portrait options. The max image size can be overridden by auto resize option
- Added support for returning relative URL-s Relative URL-s can be returned when selecting files from the filemanager: a 'relative\_url' GET parameter should be added to the request with a value of "1" when opening RFM. Otherwise returned URL-s will be absolute.
- Bugfixes Fixed css bugs Fixed drag&drop bugs Removed 'default' access keys for security
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.6.0\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Major \*\*\*\*\*- Cross domain feature- Add in config.php a option to replace all spaces with \_- Encoding of Export URL- Code refactoring
\*\*\*\*\* Detailed \*\*\*\*\*- Cross domain feature:To enable cross-domain file selector, where files are hosted on one server (for example, serverA.com) and URL is being sent to another (for example, serverB.com), include crossdomain=1 in the URL.For example, to instantiate image picker, use the following URL: http://serverA.com/[path to filemanager]/filemanager/dialog.php?type=1&field\_id=fieldID&crossdomain=1Then on serverB.com, the following code can be used to retrieve the URL after file selection is made. Please note, that the code is written for jQuery with FancyBox plug-in.
//// Handles message from ResponsiveFilemanager//function OnMessage(e){ var event = e.originalEvent; // Make sure the sender of the event is trusted if(event.data.sender === 'responsivefilemanager'){ if(event.data.field\_id){ var fieldID=event.data.field\_id; var url=event.data.url; $('#'+fieldID).val(url).trigger('change'); $.fancybox.close();
 // Delete handler of the message from ResponsiveFilemanager $(window).off('message', OnMessage); } }}
// Handler for a message from ResponsiveFilemanager$(‘.opener-class).on('click',function(){ $(window).on('message', OnMessage);});
FILE MANAGER AS TINYMCE PLUG-INThere is extra parameter needed filemanager\_crossdomain when calling tinymce.init(), please see below.tinymce.init({ ... filemanager\_crossdomain: true, external\_filemanager\_path:"http://path/secondaryserver/filemanager/", external\_plugins: { "filemanager" : "http://path/secondaryserver/filemanager/plugin.min.js"}, ...});
- Convert\_spaces options: enable the conversion of spaces to \_ in file and folder name
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.5.0\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Major \*\*\*\*\*- File permission changing- Language Changing- View/edit/create text files- Fixes
NOTE: Changed upload button's icon!
\*\*\*\*\* Detailed \*\*\*\*\*- File permission changing (OFF BY DEFAULT!) Now you can change the files/folders permission with a slick window. To access the window first you must activate it in the config file. After you activated it you can reach it from the rigth click menu. You can configure the permission with both text and checkboxes. If you entered a wrong format/number the initial state will be restored. When changing permissions for folders there will be more options for recursive changing (No/only files/only folders/both). If you set the permission wrong there will be errors.
 NOTE! If you don't know what you are doing then leave as it is bacause you can cause trouble. Usually files are 644 and folders are 755 You CANNOT set the sticky bit!
- Language Changing You can now change the language dynamicly from the menu. The button is located next to the refresh button (a globe icon)  If adding new language, it should be added to the languages.php file as  well for it to show up.  I tried to identify all language codes and add the name on there own language but I might messed up so please check it and correct it if necessary. (Because I'm only a human and speak only 2 languages)
- View/edit/create text files You can now view/edit/create text based files like .txt.
 To view a file's content just click on the preview (eye) icon. To edit a file rigth click on it and select "Edit file's content" To create a new file just click on the "+ file" icon (old upload button)
 When creating a new file you must specify it's extension. All valid extensions for edit/create are listed in the config file ($editable\_text\_file\_exts)
- Fixes Fixed some css overflow errors Removed lang\_View from menu because it was overflowing Removed hr.php lang because it's the same as hr\_HR.php Changed upload buttons icon to accomodate the "new file" addition
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.4.1\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Major \*\*\*\*\*- Security Access Keys- More Tinymce settings- Tinymce 3.\* support- Added image resize options- Bugfixes
\*\*\*\*\* Detailed \*\*\*\*\*- Security Access Keys If 'USE\_ACCESS\_KEYS' are set to true only those will access RF whose url contains the access key (akey) like: <input type="button" href="../filemanager/dialog.php?akey=myPrivateKey">
 Allowed access keys are defined in the config as well. $access\_keys must be an array so you can add multiple. Your access key should NEVER be 'key' and keep in mind they are CASE SENSITIVE! For recommended key generation read the comments in the config file.
 If there's no access key supplied with the url or it's not in the $access\_key array you will get 'Access Denied' and you cannot continue.
 For tinymce a new variable was added: "filemanager\_access\_key"
 Tinymce config example:
 tinyinit ... external\_filemanager\_path:"../filemanager", filemanager\_access\_key: "myPrivateKey", ...
 This is a bit of additional security so no one can access your filesystem.
- More Tinymce settings - Added 'filemanager\_subfolder' param so you can now define the starting folder in tinymce eg: 'filemanager\_subfolder:"subfolder/"'
- Bugfixes - Fixed audio/video player bug - Fix in remember last position - Show url context link in all files and folder - Fixed a problem with old thumbnails on renaming - Fixed a copy past issue - Fixed Standalone Mode not using the field\_id passed in mixed use cases
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* RFM 9.4.0\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Major \*\*\*\*\*- Cut/copy/paste support- Drag&drop support- Few new icons- Code refactor- Bugfixes
\*\*\*\*\* Detailed \*\*\*\*\*- Cut/copy/paste You can configure the actions in config.php file and disable/ limit them if needed. When right clicking on a folder/file there will be options for copy and cut  (and paste if files on clipboard and righ clicked on a file) There's icon for paste to this dir and clear clipboard after the 'new dir' icons They will grey out if there's nothing on the clipboard.
- Drag&drop Now you can drag n drop files/folders to other folders  (this will overwrite existing files if encountered any!)
- Icons Added new icons for the new functions All are legit made by me or get from free icon sites
- Code Refator - Added bunch of comments and change a lot of codes.
 - Changed all $\_SESSION vars to be in a separet array  eg.:$\_SESSION["verify"] -> $\_SESSION['RF']["verify"] So now there won't be any problem with big projecfts integrating RF
 - Added the lang file url to $\_SESSION['RF']['language\_file'] Now it can be included easily
 - Added a lot of new lang. lines and feedback info New lines added to every language (in english) so translation can go smoothly (There are places where i added %s to lang lines which will be swapped with an action name , commented out what will be inserted at runtime)
 - Added timeout when closing upload tab
- Bugfixes - Corrected issue #69 Dropzone spritemap.png problem Now when loading a language it will search for the appropiate spritemaps. If none found will fallback to english All spritemaps should follow the language code naming eg: For hu\_HU: spritemap\_hu\_HU.png spritemap@2x\_hu\_HU.png
 (might consider moving them in a separte folder in the future)
 - Fixed issue #71 The uploaded file exceeds the max size allowed Now when uploading it properly check for max post size It is dealt with in config.php after definning the max upload size and if it's bigger  than server's ini it will revert it back to it.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a8b33f48_20250114_193735.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftrippo%2FResponsiveFilemanager%2Fblob%2Fv9.9.5%2Ffilemanager%2Fexecute.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftrippo%2FResponsiveFilemanager%2Fblob%2Fv9.9.5%2Ffilemanager%2Fexecute.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=trippo%2FResponsiveFilemanager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 15, 2024. It is now read-only.

[trippo](/trippo)
/
**[ResponsiveFilemanager](/trippo/ResponsiveFilemanager)**
Public archive

* [Notifications](/login?return_to=%2Ftrippo%2FResponsiveFilemanager) You must be signed in to change notification settings
* [Fork
  363](/login?return_to=%2Ftrippo%2FResponsiveFilemanager)
* [Star
   814](/login?return_to=%2Ftrippo%2FResponsiveFilemanager)

* [Code](/trippo/ResponsiveFilemanager/tree/v9.9.5)
* [Issues
  263](/trippo/ResponsiveFilemanager/issues)
* [Pull requests
  3](/trippo/ResponsiveFilemanager/pulls)
* [Actions](/trippo/ResponsiveFilemanager/actions)
* [Projects
  0](/trippo/ResponsiveFilemanager/projects)
* [Wiki](/trippo/ResponsiveFilemanager/wiki)
* [Security](/trippo/ResponsiveFilemanager/security)
* [Insights](/trippo/ResponsiveFilemanager/pulse)

Additional navigation options

* [Code](/trippo/ResponsiveFilemanager/tree/v9.9.5)
* [Issues](/trippo/ResponsiveFilemanager/issues)
* [Pull requests](/trippo/ResponsiveFilemanager/pulls)
* [Actions](/trippo/ResponsiveFilemanager/actions)
* [Projects](/trippo/ResponsiveFilemanager/projects)
* [Wiki](/trippo/ResponsiveFilemanager/wiki)
* [Security](/trippo/ResponsiveFilemanager/security)
* [Insights](/trippo/ResponsiveFilemanager/pulse)

## Files

 v9.9.5
## Breadcrumbs

1. [ResponsiveFilemanager](/trippo/ResponsiveFilemanager/tree/v9.9.5)
2. /[filemanager](/trippo/ResponsiveFilemanager/tree/v9.9.5/filemanager)
/
# execute.php

Copy path Blame  Blame
## Latest commit

## History

[History](/trippo/ResponsiveFilemanager/commits/v9.9.5/filemanager/execute.php)executable file·432 lines (375 loc) · 15.3 KB v9.9.5
## Breadcrumbs

1. [ResponsiveFilemanager](/trippo/ResponsiveFilemanager/tree/v9.9.5)
2. /[filemanager](/trippo/ResponsiveFilemanager/tree/v9.9.5/filemanager)
/
# execute.php

Top
## File metadata and controls

* Code
* Blame

executable file·432 lines (375 loc) · 15.3 KB[Raw](https://github.com/trippo/ResponsiveFilemanager/raw/refs/tags/v9.9.5/filemanager/execute.php)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432<?php$config = include 'config/config.php';//TODO switch to arrayextract($config, EXTR\_OVERWRITE);
include 'include/utils.php';
if ($\_SESSION['RF']["verify"] != "RESPONSIVEfilemanager"){ response('forbiden', 403)->send(); exit;}
$thumb\_pos = strpos($\_POST['path\_thumb'], $thumbs\_base\_path);
if ($thumb\_pos !=0 || strpos($\_POST['path\_thumb'],'../',strlen($thumbs\_base\_path)+$thumb\_pos)!==FALSE || strpos($\_POST['path'],'/')===0 || strpos($\_POST['path'],'../')!==FALSE || strpos($\_POST['path'],'./')===0){ response('wrong path')->send(); exit;}
if (isset($\_SESSION['RF']['language\_file']) && file\_exists($\_SESSION['RF']['language\_file'])){ //TODO Very bad practice require\_once $\_SESSION['RF']['language\_file'];}else{ response('Language file is missing!', 500)->send(); exit;}
$base = $current\_path;$path = $current\_path.$\_POST['path'];$cycle = TRUE;$max\_cycles = 50;$i = 0;while($cycle && $i<$max\_cycles){ $i++; if ($path == $base) $cycle=FALSE;
 if (file\_exists($path."config.php")) { require\_once $path."config.php"; $cycle = FALSE; } $path = fix\_dirname($path)."/"; $cycle = FALSE;}
$path = $current\_path.$\_POST['path'];$path\_thumb = $\_POST['path\_thumb'];if (isset($\_POST['name'])){ $name = fix\_filename($\_POST['name'],$transliteration,$convert\_spaces, $replace\_with); if (strpos($name,'../') !== FALSE) { response('wrong name', 400)->send(); exit; }}
$info = pathinfo($path);if (isset($info['extension']) && !(isset($\_GET['action']) && $\_GET['action']=='delete\_folder') && !in\_array(strtolower($info['extension']), $ext) && $\_GET['action'] != 'create\_file'){ response('wrong extension', 400)->send(); exit;}
if (isset($\_GET['action'])){ switch($\_GET['action']) { case 'delete\_file': if ($delete\_files){ unlink($path); if (file\_exists($path\_thumb)) unlink($path\_thumb);
 $info=pathinfo($path); if ($relative\_image\_creation){ foreach($relative\_path\_from\_current\_pos as $k=>$path) { if ($path!="" && $path[strlen($path)-1]!="/") $path.="/";
 if (file\_exists($info['dirname']."/".$path.$relative\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$relative\_image\_creation\_name\_to\_append[$k].".".$info['extension'])) { unlink($info['dirname']."/".$path.$relative\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$relative\_image\_creation\_name\_to\_append[$k].".".$info['extension']); } } }
 if ($fixed\_image\_creation) { foreach($fixed\_path\_from\_filemanager as $k=>$path) { if ($path!="" && $path[strlen($path)-1] != "/") $path.="/";
 $base\_dir=$path.substr\_replace($info['dirname']."/", '', 0, strlen($current\_path)); if (file\_exists($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension'])) { unlink($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension']); } } } } break; case 'delete\_folder': if ($delete\_folders){ if (is\_dir($path\_thumb)) { deleteDir($path\_thumb); }
 if (is\_dir($path)) { deleteDir($path); if ($fixed\_image\_creation) { foreach($fixed\_path\_from\_filemanager as $k=>$paths){ if ($paths!="" && $paths[strlen($paths)-1] != "/") $paths.="/";
 $base\_dir=$paths.substr\_replace($path, '', 0, strlen($current\_path)); if (is\_dir($base\_dir)) deleteDir($base\_dir); } } } } break; case 'create\_folder': if ($create\_folders) { create\_folder(fix\_path($path,$transliteration,$convert\_spaces, $replace\_with),fix\_path($path\_thumb,$transliteration,$convert\_spaces, $replace\_with)); } break; case 'rename\_folder': if ($rename\_folders){ $name=fix\_filename($name,$transliteration,$convert\_spaces, $replace\_with); $name=str\_replace('.','',$name);
 if (!empty($name)){ if (!rename\_folder($path,$name,$transliteration,$convert\_spaces)) { response(trans('Rename\_existing\_folder'), 403)->send(); exit; }
 rename\_folder($path\_thumb,$name,$transliteration,$convert\_spaces); if ($fixed\_image\_creation){ foreach($fixed\_path\_from\_filemanager as $k=>$paths){ if ($paths!="" && $paths[strlen($paths)-1] != "/") $paths.="/";
 $base\_dir=$paths.substr\_replace($path, '', 0, strlen($current\_path)); rename\_folder($base\_dir,$name,$transliteration,$convert\_spaces); } } } else { response(trans('Empty\_name'), 400)->send(); exit; } } break; case 'create\_file': if ($create\_text\_files === FALSE) { response(sprintf(trans('File\_Open\_Edit\_Not\_Allowed'), strtolower(trans('Edit'))), 403)->send(); exit; }
 if (!isset($editable\_text\_file\_exts) || !is\_array($editable\_text\_file\_exts)){ $editable\_text\_file\_exts = array(); }
 // check if user supplied extension if (strpos($name, '.') === FALSE){ response(trans('No\_Extension').' '.sprintf(trans('Valid\_Extensions'), implode(', ', $editable\_text\_file\_exts)), 400)->send(); exit; }
 // correct name $old\_name = $name; $name=fix\_filename($name,$transliteration,$convert\_spaces, $replace\_with); if (empty($name)) { response(trans('Empty\_name'), 400)->send(); exit; }
 // check extension $parts = explode('.', $name); if (!in\_array(end($parts), $editable\_text\_file\_exts)) { response(trans('Error\_extension').' '.sprintf(trans('Valid\_Extensions'), implode(', ', $editable\_text\_file\_exts)), 400)->send(); exit; }
 // correct paths $path = str\_replace($old\_name, $name, $path); $path\_thumb = str\_replace($old\_name, $name, $path\_thumb);
 // file already exists if (file\_exists($path)) { response(trans('Rename\_existing\_file'), 403)->send(); exit; }
 $content = $\_POST['new\_content'];
 if (@file\_put\_contents($path, $content) === FALSE) { response(trans('File\_Save\_Error'), 500)->send(); exit; } else { if (is\_function\_callable('chmod') !== FALSE){ chmod($path, 0644); } response(trans('File\_Save\_OK'))->send(); exit; }
 break; case 'rename\_file': if ($rename\_files){ $name=fix\_filename($name,$transliteration,$convert\_spaces, $replace\_with); if (!empty($name)) { if (!rename\_file($path,$name,$transliteration)) { response(trans('Rename\_existing\_file'), 403)->send(); exit; }
 rename\_file($path\_thumb,$name,$transliteration);
 if ($fixed\_image\_creation) { $info=pathinfo($path);
 foreach($fixed\_path\_from\_filemanager as $k=>$paths) { if ($paths!="" && $paths[strlen($paths)-1] != "/") $paths.="/";
 $base\_dir = $paths.substr\_replace($info['dirname']."/", '', 0, strlen($current\_path)); if (file\_exists($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension'])) { rename\_file($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension'],$fixed\_image\_creation\_name\_to\_prepend[$k].$name.$fixed\_image\_creation\_to\_append[$k],$transliteration); } } } } else { response(trans('Empty\_name'), 400)->send(); exit; } } break; case 'duplicate\_file': if ($duplicate\_files) { $name=fix\_filename($name,$transliteration,$convert\_spaces, $replace\_with); if (!empty($name)) { if (!duplicate\_file($path,$name)) { response(trans('Rename\_existing\_file'), 403)->send(); exit; }
 duplicate\_file($path\_thumb,$name);
 if ($fixed\_image\_creation) { $info=pathinfo($path); foreach($fixed\_path\_from\_filemanager as $k=>$paths) { if ($paths!="" && $paths[strlen($paths)-1] != "/") $paths.= "/";
 $base\_dir=$paths.substr\_replace($info['dirname']."/", '', 0, strlen($current\_path));
 if (file\_exists($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension'])) { duplicate\_file($base\_dir.$fixed\_image\_creation\_name\_to\_prepend[$k].$info['filename'].$fixed\_image\_creation\_to\_append[$k].".".$info['extension'],$fixed\_image\_creation\_name\_to\_prepend[$k].$name.$fixed\_image\_creation\_to\_append[$k]); } } } } else { response(trans('Empty\_name'), 400)->send(); exit; } } break; case 'paste\_clipboard': if ( ! isset($\_SESSION['RF']['clipboard\_action'], $\_SESSION['RF']['clipboard']['path'], $\_SESSION['RF']['clipboard']['path\_thumb']) || $\_SESSION['RF']['clipboard\_action'] == '' || $\_SESSION['RF']['clipboard']['path'] == '' || $\_SESSION['RF']['clipboard']['path\_thumb'] == '') { response()->send(); exit; }
 $action = $\_SESSION['RF']['clipboard\_action']; $data = $\_SESSION['RF']['clipboard']; $data['path'] = $current\_path.$data['path']; $pinfo = pathinfo($data['path']);
 // user wants to paste to the same dir. nothing to do here... if ($pinfo['dirname'] == rtrim($path, '/')) { response()->send(); exit; }
 // user wants to paste folder to it's own sub folder.. baaaah. if (is\_dir($data['path']) && strpos($path, $data['path']) !== FALSE){ response()->send(); exit; }
 // something terribly gone wrong if ($action != 'copy' && $action != 'cut'){ response('no action', 400)->send(); exit; }
 // check for writability if (is\_really\_writable($path) === FALSE || is\_really\_writable($path\_thumb) === FALSE){ response(trans('Dir\_No\_Write').'<br/>'.str\_replace('../','',$path).'<br/>'.str\_replace('../','',$path\_thumb), 403)->send(); exit; }
 // check if server disables copy or rename if (is\_function\_callable(($action == 'copy' ? 'copy' : 'rename')) === FALSE){ response(sprintf(trans('Function\_Disabled'), ($action == 'copy' ? lcfirst(trans('Copy')) : lcfirst(trans('Cut')))), 403)->send(); exit; }
 if ($action == 'copy') { rcopy($data['path'], $path); rcopy($data['path\_thumb'], $path\_thumb); } elseif ($action == 'cut') { rrename($data['path'], $path); rrename($data['path\_thumb'], $path\_thumb);
 // cleanup if (is\_dir($data['path']) === TRUE){ rrename\_after\_cleaner($data['path']); rrename\_after\_cleaner($data['path\_thumb']); } }
 // cleanup $\_SESSION['RF']['clipboard']['path'] = NULL; $\_SESSION['RF']['clipboard']['path\_thumb'] = NULL; $\_SESSION['RF']['clipboard\_action'] = NULL;
 break; case 'chmod': $mode = $\_POST['new\_mode']; $rec\_option = $\_POST['is\_recursive']; $valid\_options = array('none', 'files', 'folders', 'both'); $chmod\_perm = (is\_dir($path) ? $chmod\_dirs : $chmod\_files);
 // check perm if ($chmod\_perm === FALSE) { response(sprintf(trans('File\_Permission\_Not\_Allowed'), (is\_dir($path) ? lcfirst(trans('Folders')) : lcfirst(trans('Files')) )), 403)->send(); exit; }
 // check mode if (!preg\_match("/^[0-7]{3}$/", $mode)){ response(trans('File\_Permission\_Wrong\_Mode'), 400)->send(); exit; }
 // check recursive option if (!in\_array($rec\_option, $valid\_options)){ response("wrong option", 400)->send(); exit; }
 // check if server disabled chmod if (is\_function\_callable('chmod') === FALSE){ response(sprintf(trans('Function\_Disabled'), 'chmod'), 403)->send(); exit; }
 $mode = "0".$mode; $mode = octdec($mode);
 rchmod($path, $mode, $rec\_option);
 break; case 'save\_text\_file': $content = $\_POST['new\_content']; // $content = htmlspecialchars($content); not needed // $content = stripslashes($content);
 // no file if (!file\_exists($path)) { response(trans('File\_Not\_Found'), 404)->send(); exit; }
 // not writable or edit not allowed if (!is\_writable($path) || $edit\_text\_files === FALSE) { response(sprintf(trans('File\_Open\_Edit\_Not\_Allowed'), strtolower(trans('Edit'))), 403)->send(); exit; }
 if (@file\_put\_contents($path, $content) === FALSE) { response(trans('File\_Save\_Error'), 500)->send(); exit; } else { response(trans('File\_Save\_OK'))->send(); exit; }
 break; default: response('wrong action', 400)->send(); exit; }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


