```
{
  "cve": "CVE-2022-46874",
  "description": "A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could potentially led to user confusion and the execution of malicious code.",
  "affected_products": [
    "Firefox",
    "Thunderbird"
  ],
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from how Firefox and Thunderbird handle filenames during drag and drop operations on Windows. The application truncates filenames to a maximum length (initially 128 characters), which can lead to the removal of the actual file extension, and potentially be replaced with a malicious extension.",
    "weaknesses": [
      "Insufficient filename sanitization",
      "Improper truncation of file names",
	  "Lack of proper extension handling during drag and drop operations"
    ],
    "impact": "The vulnerability could lead to the execution of malicious code due to user confusion. An attacker could craft a file with a long name and a misleading extension (e.g., `file.txt.exe`). The filename gets truncated to `file.txt`, resulting in `file.txt.exe` becoming `file.txt`, making the user believe it's a harmless file while being an executable.",
    "attack_vectors": [
      "Drag and drop of files",
      "Email attachments"
    ],
    "required_attacker_capabilities": "The attacker needs the ability to create a file with a long filename that includes a misleading file extension. They then need to be able to deliver this file to a user via email or other means, and have the user drag the file into the vulnerable application (Firefox or Thunderbird) for the truncation to occur. No code execution is performed by the application itself."
  },
  "additional_details": {
    "truncation_limit": "Initially, the truncation limit was 128 characters. The fix implemented a limit of 85 characters to account for multi-byte UTF-8 characters. Filenames longer than 85 characters are truncated, keeping the last 10 characters and the first 74 characters separated by ellipsis.",
	"affected_os": "The vulnerability was originally identified on Windows, but is also present on other operating systems, as evidenced by the fact that the fix was applied in the core components.",
	"fix": "The fix involves sanitizing file names by truncating filenames while preserving the extension. It ensures that the file extension is not truncated, thus preventing the user from being tricked into executing a malicious file."
   }
}
```