=== Content from www.mozilla.org_fe4f7b71_20250114_185430.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-52

## Security Vulnerabilities fixed in Firefox ESR 102.6

Announced
December 13, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.6

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_7af359bc_20250114_185428.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202305-06**

Multiple vulnerabilities have been discovered in Mozilla Firefox, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-102.7.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-102.7.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-109.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-109.0:rapid"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46873](https://nvd.nist.gov/vuln/detail/CVE-2022-46873)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46879](https://nvd.nist.gov/vuln/detail/CVE-2022-46879)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23597](https://nvd.nist.gov/vuln/detail/CVE-2023-23597)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23600](https://nvd.nist.gov/vuln/detail/CVE-2023-23600)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23604](https://nvd.nist.gov/vuln/detail/CVE-2023-23604)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)
* [CVE-2023-23606](https://nvd.nist.gov/vuln/detail/CVE-2023-23606)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885813](https://bugs.gentoo.org/show_bug.cgi?id=885813)
* [891213](https://bugs.gentoo.org/show_bug.cgi?id=891213)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_c3d45aec_20250114_185432.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-54

## Security Vulnerabilities fixed in Thunderbird 102.6.1

Announced
December 20, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.6.1

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could potentially led to user confusion and the execution of malicious code.
*Note*: This issue was originally included in the advisories for Thunderbird 102.6, but a patch (specific to Thunderbird) was omitted, resulting in it actually being fixed in Thunderbird 102.6.1

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b1a759df_20250114_185426.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1746139)
* [XML](/show_bug.cgi?ctype=xml&id=1746139)

Closed
[Bug 1746139](/show_bug.cgi?id=1746139)
(CVE-2022-46874)

Opened 3 years ago
Closed 2 years ago

# Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop

## Categories

### (Core :: Widget: Win32, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Widget%3A%20Win32#Widget%3A%20Win32)

Widget: Win32
▾

Core :: Widget: Win32
Mapping of cross platform widget interfaces to Win32 platform APIs.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Widget%3A%20Win32)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows 10

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

108 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=wontfix) |
| thunderbird\_esr102 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed) |
| firefox-esr102 | [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox106 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix) |
| firefox107 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix) |
| firefox108 | [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr91 |  | wontfix |
| thunderbird\_esr102 | + | fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 108+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox106 |  | wontfix |
| firefox107 |  | wontfix |
| firefox108 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: pfiatde, Assigned: mkmelin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/18eb16a976feb4b40d839c5e9036bc3a?d=mm&size=40)  [mkmelin](/user_profile?user_id=101158)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/dca0467e34a9c6d34fd379afefb229f6?d=mm&size=40)  [pfiatde](/user_profile?user_id=697845)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/605ee8cd1c9a74704916c7bdc4e4865d?d=mm&size=40)  [rkraesig](/user_profile?user_id=699639)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

### (Regressed 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1906455](/show_bug.cgi?id=1906455 "NEW - Dragging a URL to windows file system can create files with too long filenames"), [1806730](/show_bug.cgi?id=1806730 "VERIFIED FIXED - Dragging a URL to desktop fails with long page title (252 or more characters) since Firefox 108"), [1829981](/show_bug.cgi?id=1829981 "VERIFIED FIXED - Firefox saves file names so long they cannot be readily deleted on Windows 10")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1882263](/show_bug.cgi?id=1882263 "RESOLVED INVALID - shortened subject when saving to disk")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage][adv-main108+][adv-esr102.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-46874

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage][adv-main108+][adv-esr102.6+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c2 "3 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a33465068_578488 "2 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a30761573_553429 "2 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 2 obsolete files)

| [Thunderbird\_DragAndDropoutput.gif](/attachment.cgi?id=9255446)  [3 years ago](#c0)  [Matthias Zoellner](/user_profile?user_id=697845)   2.84 MB, image/gif |  | [Details](/attachment.cgi?id=9255446&action=edit) |
| --- | --- | --- |
| [Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz](/attachment.cgi?id=9269188)  [3 years ago](#c17)  [u695164](/user_profile?user_id=695164)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr102+](#c42 "2 years ago") | [Details](/attachment.cgi?id=9269188&action=edit) | [Review](/attachment.cgi?id=9269188) |
| [FileLink attachement for getFlavourData](/attachment.cgi?id=9269395)  [3 years ago](#c19)  [u695164](/user_profile?user_id=695164)   48.10 KB, image/png |  | [Details](/attachment.cgi?id=9269395&action=edit) |
| [Bug 1746139 - Sanitize file names from untrusted sources. r=mkmelin](/attachment.cgi?id=9269426)  [3 years ago](#c22)  [u695164](/user_profile?user_id=695164)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9269426&action=edit) | [Review](/attachment.cgi?id=9269426) |
| [Thunderbird\_draganddrop-2022-07-20\_07.42.42.gif](/attachment.cgi?id=9286188)  [2 years ago](#c27)  [Matthias Zoellner](/user_profile?user_id=697845)   1.66 MB, image/gif |  | [Details](/attachment.cgi?id=9286188&action=edit) |
| [Thunderbird\_tldr-2022-07-19\_21.16.46\_redacted.gif](/attachment.cgi?id=9286202)  [2 years ago](#c28)  [Matthias Zoellner](/user_profile?user_id=697845)   2.48 MB, image/gif |  | [Details](/attachment.cgi?id=9286202&action=edit) |
| [Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca](/attachment.cgi?id=9297533)  [2 years ago](#c35)  [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9297533&action=edit) | [Review](/attachment.cgi?id=9297533) |
| [advisory.txt](/attachment.cgi?id=9307362)  [2 years ago](#c43)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   322 bytes, text/plain |  | [Details](/attachment.cgi?id=9307362&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1746139#c0)• 3 years ago |
|  | |

Attached image
[Thunderbird\_DragAndDropoutput.gif](attachment.cgi?id=9255446) (obsolete)
— [Details](attachment.cgi?id=9255446&action=edit)

If a long file name is drag and dropped from an email, thunderbird under windows is cutting the filename at 128 chars.

Thunderbird Version: 91.4.0 (64-Bit) under Windows 10 64bit

This allows an attacker to craft a file like:

totally\_not\_malicious\_file\_with\_more\_then\_128\_characters\_definetly\_no\_problem\_here\_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.exe.pdf

Which seems to the user to be a PDF file, but after the drop is cut to .exe and therefore executable under windows. This might result in accidential execution of code by the user.

Attached there is a gif showing the process.

As under Windows there are some filetypes, like the ".SearchConnector-ms" (<https://filesec.io/searchConnector-ms>) which triggers automatic actions, this might have a bigger impact.

Flags: sec-bounty?

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a279_697845)• 3 years ago |

Group: firefox-core-security → mail-core-securityOS: Unspecified → Windows 10Product: Firefox → ThunderbirdVersion: unspecified → Thunderbird 91

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a4962_697845)• 3 years ago |

Type: task → defect

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1746139#c1)• 3 years ago |
|  | |

I just wanted to check, if this is considered as security risk or not? Or if there is any information missing.

Maybe not completly clear from the attached gif, but this of course also works when receiving an E-mail with the long attachement name.

Please let me know, if there is any information missing and if this is going to get fixed.

BR

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1746139#c2)• 3 years ago |
|  | |

Unfortunately Thunderbird is not part of the Mozilla security bug bounty program.

This could raise a security problem for some users, but IMHO (I'm not on the Thunderbird team) it seems relatively minor. Do people often drag attachments? I always click the "save" context menu button.

This is exacerbated by the fact that by default windows hides extensions (damn stupid thing to do!) so the user has even less chance of noticing the bad extension. I was thinking "sec-low" based on the difficulty in carrying out the attack (social engineer people to drag?) Could maybe argue for sec-moderate based on the severity of the consequence

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: sec-bounty? → sec-bounty-Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1746139#c3)• 3 years ago |
|  | |

The definition for the 128 char limit seems to be here:

<https://searchfox.org/mozilla-central/rev/682e5a82d403974bacb779c1db515962d946be48/widget/windows/nsDataObj.cpp#476>

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1746139#c4)• 3 years ago |
|  | |

Assigning to Widget Win32, to get attention from the right people.

Although this has been reported for Thunderbird, I'm guessing there might be drag&drop scenarios in Firefox with similar effects.

Group: mail-core-security → core-securityComponent: Security → Widget: Win32Product: Thunderbird → CoreVersion: Thunderbird 91 → unspecified

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1746139#c5)• 3 years ago |
|  | |

The severity field is not set for this bug.

:spohl, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(spohl.mozilla.bugs)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1746139#c6)• 3 years ago |
|  | |

We have an internal need for more good-first-bugs, so adding to that list.

(In reply to Kai Engert (:KaiE:) from [comment #3](/show_bug.cgi?id=1746139#c3 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop"))

> The definition for the 128 char limit seems to be here:
>
> <https://searchfox.org/mozilla-central/rev/682e5a82d403974bacb779c1db515962d946be48/widget/windows/nsDataObj.cpp#476>

This comment references Windows versions prior to XP. We should investigate if this path length limitation can safely be removed.

Severity: -- → S3Flags: needinfo?(spohl.mozilla.bugs)Keywords: [good-first-bug](/buglist.cgi?keywords=good-first-bug&resolution=---)Priority: -- → P3

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a4497302_1689)• 3 years ago |

Group: core-security → dom-core-security

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1746139#c7)• 3 years ago |
|  | |

Just wanted to ask, if there is a plan to change the behaviour. I would like to write a small blogpost about this, if there are no concerns?

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1746139#c8)• 3 years ago |
|  | |

n-i :dveditz regarding [comment 7](/show_bug.cgi?id=1746139#c7 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop").

Flags: needinfo?(dveditz)

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1746139#c9)• 3 years ago |
|  | |

(In reply to Stephen A Pohl [:spohl] from [comment #6](/show_bug.cgi?id=1746139#c6 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop"))

> We have an internal need for more good-first-bugs, so adding to that list.
>
> (In reply to Kai Engert (:KaiE:) from [comment #3](/show_bug.cgi?id=1746139#c3 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop"))
>
> > The definition for the 128 char limit seems to be here:
> >
> > <https://searchfox.org/mozilla-central/rev/682e5a82d403974bacb779c1db515962d946be48/widget/windows/nsDataObj.cpp#476>
>
> This comment references Windows versions prior to XP. We should investigate if this path length limitation can safely be removed.

It might no longer be 128, but there is surely still a limit. And therefore still a potential problem if the premise of this bug report is accepted - but no one has yet done. Ref <https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file?redirectedfrom=MSDN> <https://stackoverflow.com/questions/265769/maximum-filename-length-in-ntfs-windows-xp-and-windows-vista>

cc: masayuki, who was involved with [bug 250392](/show_bug.cgi?id=250392 "RESOLVED FIXED - Support \"UniformResourceLocatorW\" and \"FileGroupDescriptorW\" clipboard formats for Internet Shortcut")

|  | [Thomas D. (:thomas8)](/user_profile?user_id=273994) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1746139#c10)• 3 years ago |
|  | |

Just my 2 cents, the code which trims file names to whichever maximum length is acceptable to the OS should certainly *never* just chop off the right side, but always leave at least the last 4 characters (original file extension) intact and instead chop characters before that, which would easily fix this bug.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1746139#c11)• 3 years ago |
|  | |

Wow, it's really old bug! Yes, if we should keep the length of the limit, first, we should parse the file name to split extension and file name. Then, cut the file name if too long, and append the extension with `.`.

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a7059204_456485)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][win:security]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1746139#c12)• 3 years ago |
|  | |

Thomas is correct in [comment 10](/show_bug.cgi?id=1746139#c10 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") about how to handle truncation. We should be able to use MAX\_PATH now (MAX\_PATH - 1 ? watch out for buffer overflows and leave room for the terminating null), but whether we change it or not, there will still be a point where we have to truncate. Watch out for pathological cases where the extension itself might be super long, maybe even longer than the limit. Could always just slap something innocuous like `.txt` on the end if we have to truncate and the actual extension is longer than appears reasonable.

I don't know how to answer [comment 7](/show_bug.cgi?id=1746139#c7 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop"). Seems like more of a question for Thunderbird folks since their users are the ones potentially put at risk.

Flags: needinfo?(dveditz) → needinfo?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1746139#c13)• 3 years ago |
|  | |

Looks like Thunderbird should fix the file name as needed here: <https://searchfox.org/comm-central/rev/9be7ae36d358df58b0f29b9a5033e0c3e61074da/mail/base/content/mailCore.js#980>

Nicolai, can you take this?

Assignee: nobody → nicolai
[status-thunderbird\_esr91](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=affected)Flags: needinfo?(mkmelin+mozilla)

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a7791952_695164)• 3 years ago |

Status: NEW → ASSIGNED

|  | [Mirko Brodesser (:mbrodesser-Igalia)](/user_profile?user_id=725227) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1746139#c14)• 3 years ago |
|  | |

Be aware this should affect Firefox too, see [bug 1746151#c11](https://bugzilla.mozilla.org/show_bug.cgi?id=1746151#c11).

|  | [Mirko Brodesser (:mbrodesser-Igalia)](/user_profile?user_id=725227) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1746139#c15)• 3 years ago |
|  | |

As mentioned above, [#c10](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139#c10) seems the right way forward.

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1746139#c16)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1746139&comment_id=15826884 "3 revisions") |
|  | |

Some intresting parts from the callstack:

[nsDataObj::GetDownloadDetails](https://searchfox.org/mozilla-central/rev/1659f76981610c1b06437e0a34c0c232b48f4c93/widget/windows/nsDataObj.cpp#2168)

In our case this return null as kFilePromiseDestFilename is not set in our DnD events. The aFilename is derived

succesfully over a length of 128 chars here from the source URL (in the case for this method its srcFileName).

Renaming the source URL would mean that we'd have to do a copy of the file and then overwrite the file url in our Drag and Drop event.

---

**The mistake happens here**

[nsDataObj::GetFileDescriptor\_IStreamW](https://searchfox.org/mozilla-central/rev/1659f76981610c1b06437e0a34c0c232b48f4c93/widget/windows/nsDataObj.cpp#2253)

Here the destination file name gets truncated at 128 length accordingly to [NS\_MAX\_FILEDESCRIPTOR](https://searchfox.org/mozilla-central/rev/1659f76981610c1b06437e0a34c0c232b48f4c93/widget/windows/nsDataObj.cpp#476).

---

I see two solutions from here.

* Set kFilePromiseDestFilename for the events.

  A working example (I tried it out) could look like this:

  ```
  let name = attachment.name || attachment.displayName;

  if (name.length > 128) {
     let lastPieces = name.substr(-10);
     let newName = name.substr(0, 117) + "…" + lastPieces;
     dataTransfer.setData("application/x-moz-file-promise-dest-filename", newName)

  }

  ```
* The [wcsncpy](https://searchfox.org/mozilla-central/rev/1659f76981610c1b06437e0a34c0c232b48f4c93/widget/windows/nsDataObj.cpp#2253) call could be changed.

**I'm open for suggestions.** Maybe I'd need access to [bug 1746151#c11](https://bugzilla.mozilla.org/show_bug.cgi?id=1746151#c11) to see if a change for the wcsncpy call is planned.

---

#### Some other information:

[nsFlavorDataProvider.getFlavorData](https://searchfox.org/comm-central/rev/e2d8a048eb3ddca2f498365092611afc84f16daa/mail/base/content/mailCore.js#944) only gets called with a lazy dataprovider (e.g. cloudkey).

The attachment name in the UI is already visually dotted in the middle so that you are able to see the file ending.

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1746139#c17)• 3 years ago |
|  | |

Attached file
[Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz](attachment.cgi?id=9269188)
— [Details](attachment.cgi?id=9269188&action=edit)

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1746139#c18)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1746139&comment_id=15829902 "2 revisions") |
|  | |

Hey, I'm having troubles debugging [getFlavourData](https://searchfox.org/comm-central/source/mail/base/content/mailCore.js#944).

For me it seems to be code that gets invoked when an user uses the FileLink support (lazy dataprovider).

Here it says it's "dataless".

[#define kFilePromiseMime](https://searchfox.org/mozilla-central/rev/3f782c2587124923a37c750b88c5a40108077057/widget/nsITransferable.idl#60)

It should do something but i couldn't figure out what under Windows 10 with trunk daily tb and m-c.

My current understanding is, that it is used when drag and drop an attachement sent via FileLink. See [FileLink attachement for getFlavourData](https://bugzilla.mozilla.org/attachment.cgi?id=9269395)

One more thing:

It is definitely in the dataTransfer object, saved as an [nsXPTCStubBase] object.

Any ideas?

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1746139#c19)• 3 years ago |
|  | |

Attached image
[FileLink attachement for getFlavourData](attachment.cgi?id=9269395)
— [Details](attachment.cgi?id=9269395&action=edit)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1746139#c20)• 3 years ago |
|  | |

I think it's used when dragging an attachment (any attachment) out of Thunderbird, e.g. to the desktop

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1746139#c21)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1746139&comment_id=15829960 "4 revisions") |
|  | |

(In reply to Magnus Melin [:mkmelin] from [comment #20](/show_bug.cgi?id=1746139#c20 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop"))

> I think it's used when dragging an attachment (any attachment) out of Thunderbird, e.g. to the desktop

I've set [mailCore.js::messenger.saveAttachmentToFolder 3rd arg](https://searchfox.org/comm-central/rev/8d258916e1367d6c1a08d7225781cde9fc769136/mail/base/content/mailCore.js#984) to "foo.pdf" and added a breakpoint at nsMessenger::SaveAttachmentToFolder. This method is not called in the drag and drop operation from the file system to Thunderbird or the other way around from Thunderbird to file system under Win10.

The filename wasn't set to "foo.pdf" and the breakpoint wasn't hit.

I'd really like to see where this applies before making changes.

(Well a build wihout the nsFlavorDataProvider deleted had the same behaviour. No error and the attachment was succefully drag and dropped to the filesystem.)

Just figured out that it does something. It makes it possible to get attachement from e.g. an imap source. But you can't touch the name here seems to be some safety from somewhere.

|  | [u695164](/user_profile?user_id=695164) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1746139#c22)• 3 years ago |
|  | |

Attached file
[Bug 1746139 - Sanitize file names from untrusted sources. r=mkmelin](attachment.cgi?id=9269426) (obsolete)
— [Details](attachment.cgi?id=9269426&action=edit)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1746139#c23)• 3 years ago |
|  | |

This good-first-bug hasn't had any activity for 2 months, it is automatically unassigned.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#good_first_bug_unassign_inactive.py).

Assignee: nicolai → nobodyStatus: ASSIGNED → NEW

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1746139#c24)• 3 years ago |
|  | |

Is here still any progress? Or will this stay like it is?

I would still like to write a mini Blogpost about this.

Let me know, if there are any concerns.

BR

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1746139#c25)• 3 years ago |
|  | |

n-i for [comment 24](/show_bug.cgi?id=1746139#c24 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop")

Flags: needinfo?(nicolai)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1746139#c26)• 2 years ago |
|  | |

The following patch is waiting for review from an inactive reviewer:

| ID | Title | Author | Reviewer Status |
| --- | --- | --- | --- |
| [D141941](https://phabricator.services.mozilla.com/D141941) | [Bug 1746139](/show_bug.cgi?id=1746139 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz | [nicolai](https://bugzilla.mozilla.org/user_profile?user_id=695164) | [dveditz](https://phabricator.services.mozilla.com/p/dveditz/): Resigned from review |

:nicolai, could you please find another reviewer?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_reviewer.py).

Flags: needinfo?(nicolai)

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a18749784_697845)• 2 years ago |

[Attachment #9255446](/attachment.cgi?id=9255446&action=edit "Thunderbird_DragAndDropoutput.gif") -
Attachment is obsolete: true

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1746139#c27)• 2 years ago |
|  | |

Attached image
[Thunderbird\_draganddrop-2022-07-20\_07.42.42.gif](attachment.cgi?id=9286188)
— [Details](attachment.cgi?id=9286188&action=edit)

Added a new PoC Version.

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1746139#c28)• 2 years ago |
|  | |

Attached image
[Thunderbird\_tldr-2022-07-19\_21.16.46\_redacted.gif](attachment.cgi?id=9286202)
— [Details](attachment.cgi?id=9286202&action=edit)

And as the Blogpost is on it's way a new, more complete PoC.

|  | [Matthias Zoellner](/user_profile?user_id=697845)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1746139#c29)• 2 years ago |
|  | |

Just for your information: You can find the blogpost here: <https://blog.syss.com/posts/tampering-with-thunderbird-attachements/>

|  | [Thomas D. (:thomas8)](/user_profile?user_id=273994) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a19144190_273994)• 2 years ago |

Assignee: nobody → nicolaiStatus: NEW → ASSIGNED
[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected)
[tracking-thunderbird\_esr102](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=equals&v1=%3F)Keywords: [good-first-bug](/buglist.cgi?keywords=good-first-bug&resolution=---)Priority: P3 → P2

|  | [Thomas D. (:thomas8)](/user_profile?user_id=273994) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1746139#c30)• 2 years ago |
|  | |

Chris, could you review [D141941](https://phabricator.services.mozilla.com/D141941) (already reviewed by :dveditz) or connect another reviewer?

Flags: needinfo?(cmartin)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1746139#c31)• 2 years ago |
|  | |

Redirect a needinfo that is pending on an inactive user to the triage owner.

:spohl, since the bug has high priority and recent activity, could you please find another way to get the information or close the bug as `INCOMPLETE` if it is not actionable?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).

Flags: needinfo?(nicolai) → needinfo?(spohl.mozilla.bugs)

|  | [Chris Martin [:cmartin] - OOO sick](/user_profile?user_id=625428) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1746139#c32)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1746139&comment_id=15999521 "3 revisions") |
|  | |

LGTM on the `MAX_PATH` extension. I guess it's up to the other patch to actually prevent the exploit though, since AFAICT this will only make it so the attacker needs to craft a longer file name to cause the same behavior?

(Not that I think it affects anything, but it's worth noting that `MAX_PATH` is not always the maximum path length on Windows -- Windows 10 can have this limit removed in the registry, and thus many Windows API functions would still allow it. And also windows allows the "\?\really\really\really\long\path" extended path syntax that can be up to 32,767 chars long. ([link](https://docs.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation)))

Flags: needinfo?(cmartin)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a19217275_456485)• 2 years ago |

Flags: needinfo?(spohl.mozilla.bugs)

|  | [Alessandro Castellani [:aleca]](/user_profile?user_id=634666) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1746139#c33)• 2 years ago |
|  | |

Magnus, would you be able to take this leftover and finish it?

Flags: needinfo?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a25199876_101158)• 2 years ago |

Assignee: u695164 → mkmelin+mozillaFlags: needinfo?(mkmelin+mozilla)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1746139#c34)• 2 years ago |
|  | |

Redirect a needinfo that is pending on an inactive user to the triage owner.

:spohl, since the bug has high priority and recent activity, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#inactive_ni_pending.py).

Flags: needinfo?(u695164) → needinfo?(spohl.mozilla.bugs)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a25283035_101158)• 2 years ago |

Flags: needinfo?(spohl.mozilla.bugs)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a25572430_600971)• 2 years ago |

[Attachment #9269426](/attachment.cgi?id=9269426&action=edit "Bug 1746139 - Sanitize file names from untrusted sources. r=mkmelin") -
Attachment is obsolete: true

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1746139#c35)• 2 years ago |
|  | |

Attached file
[Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca](attachment.cgi?id=9297533)
— [Details](attachment.cgi?id=9297533&action=edit)

The common file name length limit is 255. On windows 255 chars, on linux 255 *bytes*.

In UTF-8 one char can take up up to 4 bytes, but 3 covers all normal cases.

Use a limit of 255/3 = 85 chars for file names to be safe. That will also make for more reasonable file names in general usage.

Filenames longer than 85 will turned into first 74 chars … 10 last chars.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a25572592_600971)• 2 years ago |

[Attachment #9297533](/attachment.cgi?id=9297533&action=edit "Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca") -
Attachment description: Bug 1746139 - Only allow filenames to be up to 255 ch. r=aleca → Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a25808005_101158)• 2 years ago |

[tracking-thunderbird\_esr102](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr102&o1=equals&v1=%2B)Target Milestone: --- → 107 Branch

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1746139#c36)• 2 years ago |
|  | |

Let's get this landed. Lando isn't letting me push it for some reason. dveditz, can you land D141941?

The information is already public since months ([comment 29](/show_bug.cgi?id=1746139#c29 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop")).

Flags: needinfo?(dveditz)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1746139#c37)• 2 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/120942422c67529a29ed3a563c6b4052705295d2>

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a28065488_101158)• 2 years ago |

Flags: needinfo?(dveditz)Target Milestone: 107 Branch → 108 Branch

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1746139#c38)• 2 years ago |
|  | |

Keeping filename ending intact when using windows with events like drag and drop. r=cmartin

<https://hg.mozilla.org/integration/autoland/rev/5984cee8a1c5688a06370fbcf2e5481458e12dfa>

<https://hg.mozilla.org/mozilla-central/rev/5984cee8a1c5>

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a28495577_75935)• 2 years ago |

Group: dom-core-security → core-security-release
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=wontfix)
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-thunderbird\_esr91](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=wontfix)
[tracking-firefox108](/buglist.cgi?f1=cf_tracking_firefox108&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox108&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [108+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=108%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1746139#c39)• 2 years ago |
|  | |

Hi Magnus, did you want to nominate this for ESR102 uplift?

Flags: needinfo?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1746139#c40)• 2 years ago |
|  | |

Comment on [attachment 9269188](/attachment.cgi?id=9269188 "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz") [[details]](/attachment.cgi?id=9269188&action=edit "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz")

[Bug 1746139](/show_bug.cgi?id=1746139 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Moderate security issue
* **User impact if declined**: Long filenames can trick the user to executing a file they didn't expect to be executing.
* **Fix Landed on Version**: 108
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The fix is fairly confined.
Flags: needinfo?(mkmelin+mozilla)
[Attachment #9269188](/attachment.cgi?id=9269188&action=edit "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz") -
Flags: approval-mozilla-esr102?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1746139#c41)• 2 years ago |
|  | |

Comment on [attachment 9269188](/attachment.cgi?id=9269188 "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz") [[details]](/attachment.cgi?id=9269188&action=edit "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz")

[Bug 1746139](/show_bug.cgi?id=1746139 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz

Approved for 102.6esr

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1746139#c42)• 2 years ago |
| uplift | |

Comment on [attachment 9269188](/attachment.cgi?id=9269188 "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz") [[details]](/attachment.cgi?id=9269188&action=edit "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz")

[Bug 1746139](/show_bug.cgi?id=1746139 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz

<https://hg.mozilla.org/releases/mozilla-esr102/rev/9d361299a3ab>

[Attachment #9269188](/attachment.cgi?id=9269188&action=edit "Bug 1746139 - Keeping filename ending intact when using windows with events like drag and drop. r=dveditz") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a29489939_690067)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a29490142_690067)• 2 years ago |

[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a30761573_553429)• 2 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?][win:security] → [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a30960083_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage][adv-main108+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1746139#c43)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9307362)
— [Details](attachment.cgi?id=9307362&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a30973746_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage][adv-main108+] → [reporter-external] [client-bounty-form] [verif?][win:security][post-critsmash-triage][adv-main108+][adv-esr102.6+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a31050189_578488)• 2 years ago |

Alias: CVE-2022-46874

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1746139#c44)• 2 years ago |
|  | |

Comment on [attachment 9297533](/attachment.cgi?id=9297533 "Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca") [[details]](/attachment.cgi?id=9297533&action=edit "Bug 1746139 - Only allow filenames to be up to 85 ch. r=aleca")

[Bug 1746139](/show_bug.cgi?id=1746139 "RESOLVED FIXED - Thunderbird Windows - Drag&Drop limited to 128 chars, allowing to change the file extension on drop") - Only allow filenames to be up to 85 ch. r=aleca

This needs to be uplifted to comm-esr102 since the other patch was uplifted to Firefox 102.6.0.

approval-comm-esr102+ a=rjl

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a31932381_63411)• 2 years ago |

[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1746139#c45)• 2 years ago |
|  | |

Thunderbird 102.6.1:

<https://hg.mozilla.org/releases/comm-esr102/rev/52c4495b3fb11e60c9c94ef148dd8563151df385>

[status-thunderbird\_esr102](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr102&o1=equals&v1=fixed)

|  | [Sören Hentzschel](/user_profile?user_id=359208) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a32023558_359208)• 2 years ago |

Regressions: [1806730](/show_bug.cgi?id=1806730 "VERIFIED FIXED - Dragging a URL to desktop fails with long page title (252 or more characters) since Firefox 108")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a33465068_578488)• 2 years ago |

Flags: sec-bounty-hof+

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a42923304_293623)• 2 years ago |

Regressions: [1829981](/show_bug.cgi?id=1829981 "VERIFIED FIXED - Firefox saves file names so long they cannot be readily deleted on Windows 10")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a50072575_1689)• 1 years ago |

Group: core-security-release

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a69746310_101158)• 11 months ago |

See Also: → [1882263](/show_bug.cgi?id=1882263 "RESOLVED INVALID - shortened subject when saving to disk")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a77538493_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1746139#a81808222_5842)• 6 months ago |

Regressions: [1906455](/show_bug.cgi?id=1906455 "NEW - Dragging a URL to windows file system can create files with too long filenames")
You need to [log in](/show_bug.cgi?id=1746139&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Matthias Zoellner](/user_profile?user_id=697845)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_e9026659_20250114_185428.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202305-13**

Multiple vulnerabilities have been discovered in Mozilla Thunderbird, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0** |
| Unaffected versions | >= **102.7.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.7.0"

```

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.7.0"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885815](https://bugs.gentoo.org/show_bug.cgi?id=885815)
* [891217](https://bugs.gentoo.org/show_bug.cgi?id=891217)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_3013c27e_20250114_185429.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-51

## Security Vulnerabilities fixed in Firefox 108

Announced
December 13, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 108

#### [#CVE-2022-46871: libusrsctp library out of date](#CVE-2022-46871)

Reporter
Mozilla Developers
Impact
high
##### Description

An out of date library (libusrsctp) contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1795697](https://bugzilla.mozilla.org/show_bug.cgi?id=1795697)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46873: Firefox did not implement the CSP directive unsafe-hashes](#CVE-2022-46873)

Reporter
Pete Freitag
Impact
moderate
##### Description

Because Firefox did not implement the `unsafe-hashes` CSP directive, an attacker who was able to inject markup into a page otherwise protected by a Content Security Policy may have been able to inject executable script. This would be severely constrained by the specified Content Security Policy of the document.

##### References

* [Bug 1644790](https://bugzilla.mozilla.org/show_bug.cgi?id=1644790)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could have potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46877: Fullscreen notification bypass](#CVE-2022-46877)

Reporter
Hafiizh
Impact
low
##### Description

By confusing the browser, the fullscreen notification could have been delayed or suppressed, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795139](https://bugzilla.mozilla.org/show_bug.cgi?id=1795139)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

#### [#CVE-2022-46879: Memory safety bugs fixed in Firefox 108](#CVE-2022-46879)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Lukas Bernhard, Gabriele Svelto, Randell Jesup, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736224%2C1793407%2C1794249%2C1795845%2C1797682%2C1797720%2C1798494%2C1799479)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d85592cd_20250114_185431.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-53

## Security Vulnerabilities fixed in Thunderbird 102.6

Announced
December 13, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.6

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

*Note*: CVE-2022-46874 was originally included in these advisories for Thunderbird 102.6, but a patch (specific to Thunderbird) was omitted, resulting in it actually being fixed in Thunderbird 102.6.1

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Thunderbird for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46881: Memory corruption in WebGL](#CVE-2022-46881)

Reporter
Karl and an Anonymous ASAN Nightly User
Impact
high
##### Description

An optimization in WebGL was incorrect in some cases, and could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1770930](https://bugzilla.mozilla.org/show_bug.cgi?id=1770930)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46882: Use-after-free in WebGL](#CVE-2022-46882)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free in WebGL extensions could have led to a potentially exploitable crash.

##### References

* [Bug 1789371](https://bugzilla.mozilla.org/show_bug.cgi?id=1789371)

#### [#CVE-2022-46878: Memory safety bugs fixed in Thunderbird 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


