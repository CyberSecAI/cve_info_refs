Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the fact that password reset tokens were not invalidated when a user changed their primary email address. This allowed an attacker to potentially gain access to the account using an old password reset link if the old email address is compromised.

**Weaknesses/Vulnerabilities:**
- The system did not invalidate existing password reset tokens upon an email change.
- Old password reset tokens remained valid even after the associated email address was no longer the primary email.

**Impact of Exploitation:**
- Account takeover: An attacker could use a password reset link sent to an old email address (if the attacker has access to the old email) to reset the password of the user, and regain access to the account.
- Re-linking of email address: Using the old reset link would re-link the account to the old email address.

**Attack Vectors:**
- Network: The attacker can exploit this remotely.
- User interaction is required for the initial reset password request, but not for the actual takeover once they gain control of the old email.

**Required Attacker Capabilities/Position:**
- The attacker needs access to an old email address that was previously associated with the target account.
- The attacker also requires the user to have requested a password reset link.
- The attacker needs to act before the `email_token_valid_hours` expiration time (default is 48 hours).

**Additional Notes:**
- The vulnerability is mitigated to some extent by the `email_token_valid_hours` SiteSetting, which by default is 48 hours, limiting the window of opportunity for the attacker.
- The provided commit `4bf306f0e3bf54a9ef9c5886bf1cfb85c20da570` and `83944213b2b2454af80d0407f60d67641b1f0b38` fixes the issue by deleting email tokens when a user's email is changed or deleted
- The vulnerability is rated as Moderate severity.
- CVSS v3 Score: 5.7
- CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N