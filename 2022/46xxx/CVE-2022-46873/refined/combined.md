=== Content from security.gentoo.org_7af359bc_20250114_193409.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202305-06**

Multiple vulnerabilities have been discovered in Mozilla Firefox, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.7.0**< **109.0** |
| Unaffected versions | >= **102.7.0**>= **109.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-102.7.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-102.7.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-109.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-109.0:rapid"

```
### References

* [CVE-2022-46871](https://nvd.nist.gov/vuln/detail/CVE-2022-46871)
* [CVE-2022-46872](https://nvd.nist.gov/vuln/detail/CVE-2022-46872)
* [CVE-2022-46873](https://nvd.nist.gov/vuln/detail/CVE-2022-46873)
* [CVE-2022-46874](https://nvd.nist.gov/vuln/detail/CVE-2022-46874)
* [CVE-2022-46875](https://nvd.nist.gov/vuln/detail/CVE-2022-46875)
* [CVE-2022-46877](https://nvd.nist.gov/vuln/detail/CVE-2022-46877)
* [CVE-2022-46878](https://nvd.nist.gov/vuln/detail/CVE-2022-46878)
* [CVE-2022-46879](https://nvd.nist.gov/vuln/detail/CVE-2022-46879)
* [CVE-2022-46880](https://nvd.nist.gov/vuln/detail/CVE-2022-46880)
* [CVE-2022-46881](https://nvd.nist.gov/vuln/detail/CVE-2022-46881)
* [CVE-2022-46882](https://nvd.nist.gov/vuln/detail/CVE-2022-46882)
* [CVE-2023-23597](https://nvd.nist.gov/vuln/detail/CVE-2023-23597)
* [CVE-2023-23598](https://nvd.nist.gov/vuln/detail/CVE-2023-23598)
* [CVE-2023-23599](https://nvd.nist.gov/vuln/detail/CVE-2023-23599)
* [CVE-2023-23600](https://nvd.nist.gov/vuln/detail/CVE-2023-23600)
* [CVE-2023-23601](https://nvd.nist.gov/vuln/detail/CVE-2023-23601)
* [CVE-2023-23602](https://nvd.nist.gov/vuln/detail/CVE-2023-23602)
* [CVE-2023-23603](https://nvd.nist.gov/vuln/detail/CVE-2023-23603)
* [CVE-2023-23604](https://nvd.nist.gov/vuln/detail/CVE-2023-23604)
* [CVE-2023-23605](https://nvd.nist.gov/vuln/detail/CVE-2023-23605)
* [CVE-2023-23606](https://nvd.nist.gov/vuln/detail/CVE-2023-23606)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [885813](https://bugs.gentoo.org/show_bug.cgi?id=885813)
* [891213](https://bugs.gentoo.org/show_bug.cgi?id=891213)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_3d2c765c_20250115_114705.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1805948)
* [XML](/show_bug.cgi?ctype=xml&id=1805948)

Closed
[Bug 1805948](/show_bug.cgi?id=1805948)

Opened 2 years ago
Closed 2 years ago

# astrobiology.nasa.gov not loading on FF 108

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

astrobiology.nasa.gov not loading on FF 108

## Categories

### (Core :: DOM: Security, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 108

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

110 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) |
| firefox108 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=wontfix) |
| firefox109 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed) |
| firefox110 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox108 |  | wontfix |
| firefox109 |  | fixed |
| firefox110 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: diannaS, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/2b944efac45d5581d1cb964f99e0aede?d=mm&size=40)  [diannaS](/user_profile?user_id=690067)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

4 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[csp-unsafe-hashes](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1805948&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1805948)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[CVE-2022-46873](/show_bug.cgi?id=1644790 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified")

[1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1806845](/show_bug.cgi?id=1806845 "RESOLVED DUPLICATE - Firefox 108 ignores 'unsafe-hashes', sites built using Shibboleth are broken")

## Details

### (Keywords: regression)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [actual108Mac.png](/attachment.cgi?id=9308543)  [2 years ago](#c0)  [Dianna Smith [:diannaS]](/user_profile?user_id=690067)   126.43 KB, image/png |  | [Details](/attachment.cgi?id=9308543&action=edit) |
| --- | --- | --- |
| [Expected108Mac.png](/attachment.cgi?id=9308544)  [2 years ago](#c1)  [Dianna Smith [:diannaS]](/user_profile?user_id=690067)   891.13 KB, image/png |  | [Details](/attachment.cgi?id=9308544&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1805948#c0)• 2 years ago |
|  | |

Attached image
[actual108Mac.png](attachment.cgi?id=9308543)
— [Details](attachment.cgi?id=9308543&action=edit)

Filing this bug from reddit reports:

<https://www.reddit.com/r/firefox/comments/zml8jl/astrobiologynasagov_not_loading_on_ff_but_does_on/>

"Tried this in 2 different Windows computers, one on Win 10 w/ FF 108.0 stable and another on Win 11 and FF 109 beta, with all extensions disabled. I only get the headers, but the content is blank and on the same PCs Edge and Chrome are fine. Anyone can tell what's going on? <https://astrobiology.nasa.gov/>"

I was able to recreate this on a MacOS 12.2.1

I ran mozregression and narrowed it down to [bug 1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

STR:

-Simply load <https://astrobiology.nasa.gov/> and notice only the headers appear and no image

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1805948#c1)• 2 years ago |
|  | |

Attached image
[Expected108Mac.png](attachment.cgi?id=9308544)
— [Details](attachment.cgi?id=9308544&action=edit)

Expected results from previous builds

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a84_690067)• 2 years ago |

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected)
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a161_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)Flags: needinfo?(evilpies)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1805948#c2)• 2 years ago |
|  | |

The problem is not exactly adding preffed-off support for `'unsafe-hashes'` in [bug 1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag"), but that the patch included the fix for [bug 1644790](/show_bug.cgi?id=1644790 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified") ([CVE-2022-46873](https://www.mozilla.org/en-US/security/advisories/mfsa2022-51/#CVE-2022-46873)): pages got `'unsafe-hashes'` behavior even when they didn't ask for it.

Regressed by: [CVE-2022-46873](/show_bug.cgi?id=1644790 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1805948#c3)• 2 years ago |
|  | |

If you set the pref `security.csp.unsafe-hashes.enabled` to `true` the site works.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a55860_703078)• 2 years ago |

Depends on: [csp-unsafe-hashes](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1805948#c4)• 2 years ago |
|  | |

Everything Daniel said is correct. We should probably just ship 'unsafe-hashes'. I am going to attach a patch to [bug 1343950](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes").

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a58388_703078)• 2 years ago |

Flags: needinfo?(evilpies)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1805948#c5)• 2 years ago |
|  | |

Interestingly enough even with `'unsafe-hashes'` the page still seems to have some inline style defined via JS that is blocked. However I see something similar in Chrome as well.

> Content Security Policy: The page’s settings blocked the loading of a resource at inline (“style-src”). widgets.f26384f93da6.js:1:29228

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a238056_703078)• 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1805948#c6)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1805948&comment_id=16203953 "1 revision") |
|  | |

Fixed in [bug 1343950](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes") by enabling `security.csp.unsafe-hashes.enabled` and verified on 110.0a1 on MacOS 12.2.1

Status: NEW → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1805948#a680474_690067)• 2 years ago |

See Also: → [1806845](/show_bug.cgi?id=1806845 "RESOLVED DUPLICATE - Firefox 108 ignores 'unsafe-hashes', sites built using Shibboleth are broken")

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1805948#c7)• 2 years ago |
|  | |

Setting 108 to wontfix since there is a workaround

[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1805948#c8)• 2 years ago |
|  | |

[Bug 1343950](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes") has been uplifted to Beta for 109.0b8 also now.

Assignee: nobody → tschuster
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed)Target Milestone: --- → 110 Branch
You need to [log in](/show_bug.cgi?id=1805948&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dianna Smith [:diannaS]](/user_profile?user_id=690067)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_41360c85_20250115_114703.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-51

## Security Vulnerabilities fixed in Firefox 108

Announced
December 13, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 108

#### [#CVE-2022-46871: libusrsctp library out of date](#CVE-2022-46871)

Reporter
Mozilla Developers
Impact
high
##### Description

An out of date library (libusrsctp) contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1795697](https://bugzilla.mozilla.org/show_bug.cgi?id=1795697)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46873: Firefox did not implement the CSP directive unsafe-hashes](#CVE-2022-46873)

Reporter
Pete Freitag
Impact
moderate
##### Description

Because Firefox did not implement the `unsafe-hashes` CSP directive, an attacker who was able to inject markup into a page otherwise protected by a Content Security Policy may have been able to inject executable script. This would be severely constrained by the specified Content Security Policy of the document.

##### References

* [Bug 1644790](https://bugzilla.mozilla.org/show_bug.cgi?id=1644790)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could have potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46877: Fullscreen notification bypass](#CVE-2022-46877)

Reporter
Hafiizh
Impact
low
##### Description

By confusing the browser, the fullscreen notification could have been delayed or suppressed, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795139](https://bugzilla.mozilla.org/show_bug.cgi?id=1795139)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

#### [#CVE-2022-46879: Memory safety bugs fixed in Firefox 108](#CVE-2022-46879)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Lukas Bernhard, Gabriele Svelto, Randell Jesup, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736224%2C1793407%2C1794249%2C1795845%2C1797682%2C1797720%2C1798494%2C1799479)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_3013c27e_20250114_193410.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-51

## Security Vulnerabilities fixed in Firefox 108

Announced
December 13, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 108

#### [#CVE-2022-46871: libusrsctp library out of date](#CVE-2022-46871)

Reporter
Mozilla Developers
Impact
high
##### Description

An out of date library (libusrsctp) contained vulnerabilities that could potentially be exploited.

##### References

* [Bug 1795697](https://bugzilla.mozilla.org/show_bug.cgi?id=1795697)

#### [#CVE-2022-46872: Arbitrary file read from a compromised content process](#CVE-2022-46872)

Reporter
Nika Layzell
Impact
high
##### Description

An attacker who compromised a content process could have partially escaped the sandbox to read arbitrary files via clipboard-related IPC messages.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1799156](https://bugzilla.mozilla.org/show_bug.cgi?id=1799156)

#### [#CVE-2022-46873: Firefox did not implement the CSP directive unsafe-hashes](#CVE-2022-46873)

Reporter
Pete Freitag
Impact
moderate
##### Description

Because Firefox did not implement the `unsafe-hashes` CSP directive, an attacker who was able to inject markup into a page otherwise protected by a Content Security Policy may have been able to inject executable script. This would be severely constrained by the specified Content Security Policy of the document.

##### References

* [Bug 1644790](https://bugzilla.mozilla.org/show_bug.cgi?id=1644790)

#### [#CVE-2022-46874: Drag and Dropped Filenames could have been truncated to malicious extensions](#CVE-2022-46874)

Reporter
Matthias Zoellner
Impact
moderate
##### Description

A file with a long filename could have had its filename truncated to remove the valid extension, leaving a malicious extension in its place. This could have potentially led to user confusion and the execution of malicious code.

##### References

* [Bug 1746139](https://bugzilla.mozilla.org/show_bug.cgi?id=1746139)

#### [#CVE-2022-46875: Download Protections were bypassed by .atloc and .ftploc files on Mac OS](#CVE-2022-46875)

Reporter
Dohyun Lee
Impact
moderate
##### Description

The executable file warning was not presented when downloading .atloc and .ftploc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1786188](https://bugzilla.mozilla.org/show_bug.cgi?id=1786188)

#### [#CVE-2022-46877: Fullscreen notification bypass](#CVE-2022-46877)

Reporter
Hafiizh
Impact
low
##### Description

By confusing the browser, the fullscreen notification could have been delayed or suppressed, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1795139](https://bugzilla.mozilla.org/show_bug.cgi?id=1795139)

#### [#CVE-2022-46878: Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](#CVE-2022-46878)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Randell Jesup, Valentin Gosu, Olli Pettay, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107 and Firefox ESR 102.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108 and Firefox ESR 102.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1782219%2C1797370%2C1797685%2C1801102%2C1801315%2C1802395)

#### [#CVE-2022-46879: Memory safety bugs fixed in Firefox 108](#CVE-2022-46879)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Lukas Bernhard, Gabriele Svelto, Randell Jesup, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 107. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 108](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736224%2C1793407%2C1794249%2C1795845%2C1797682%2C1797720%2C1798494%2C1799479)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_cab178cf_20250114_193409.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1644790)
* [XML](/show_bug.cgi?ctype=xml&id=1644790)

Closed
[Bug 1644790](/show_bug.cgi?id=1644790)
(CVE-2022-46873)

Opened 5 years ago
Closed 2 years ago

# Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified

## Categories

### (Core :: DOM: Security, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

108 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox107 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix) |
| firefox108 | --- | [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox107 |  | wontfix |
| firefox108 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: pete, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/947b0c6cb4777c4325dd0a4f724ec737?d=mm&size=40)  [pete](/user_profile?user_id=664665)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### ( [URL](https://www.petefreitag.com/test/csp-hash-bug.html "https://www.petefreitag.com/test/csp-hash-bug.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[csp-unsafe-hashes](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes"), [1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1788864](/show_bug.cgi?id=1788864 "RESOLVED FIXED - CSP: unsafe-hashes calculation for javascript: URLs differs from Chrome and Safari")

Dependency [tree](/showdependencytree.cgi?id=1644790&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1644790)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1805948](/show_bug.cgi?id=1805948 "RESOLVED FIXED - astrobiology.nasa.gov not loading on FF 108")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1683506](/show_bug.cgi?id=1683506 "RESOLVED DUPLICATE - CSP script-src with hashes allow inline event handlers to match the hash (even if 'unsafe-hashes' is not present)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[petefreitag.com/test/csp-hash-bug.html](https://www.petefreitag.com/test/csp-hash-bug.html "https://www.petefreitag.com/test/csp-hash-bug.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1806845](/show_bug.cgi?id=1806845 "RESOLVED DUPLICATE - Firefox 108 ignores 'unsafe-hashes', sites built using Shibboleth are broken")

[csplite.com/csp/test173/#bug\_ff\_unsaf...](https://csplite.com/csp/test173/#bug_ff_unsafe-hashes_event_handler "https://csplite.com/csp/test173/#bug_ff_unsafe-hashes_event_handler")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main108+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-46873

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-backlog][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main108+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a15649462_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [testcase.html](/attachment.cgi?id=9303266)  [2 years ago](#c7)  [Tom Schuster](/user_profile?user_id=703078)   278 bytes, text/html |  | [Details](/attachment.cgi?id=9303266&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9307369)  [2 years ago](#c13)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   399 bytes, text/plain |  | [Details](/attachment.cgi?id=9307369&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Pete Freitag](/user_profile?user_id=664665)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1644790#c0)• 5 years ago |
|  | |

According to the CSP Level 2 Specification "If 'unsafe-inline' is not in the list" ... "Whenever the user agent would execute an inline script from an inline event handler, instead the user agent MUST NOT execute script, and MUST report a violation." <https://www.w3.org/TR/CSP2/#allowed-script-sources> however FireFox 62 and below followed the spec, but starting with FireFox 63 it ignores this restriction.

The change in the code that allowed this appears to be here:

<https://searchfox.org/mozilla-central/diff/5fff1762ada26b04519cf8ed24489ca1b0f73c2f/dom/security/nsCSPContext.cpp#551-566>

Given a CSP policy: default-src 'none';script-src 'sha256-vmevK1pwVutIOH96hxUOXymyXdR2hSlZRAu8QWiW3dw='; and the markup: <body onload="alert('attr');"> the hash matches: "alert('attr');" it will allow execution of the script. You can see an example of this in the test page: <https://www.petefreitag.com/test/csp-hash-bug.html>

Again, according to the CSP Level 2 spec it should only allow a valid hash or a valid nonce on "a script element". So, it should only allow it in the form: <script>alert('attr');</script> not in an inline event handler.

The CSP Level 3 spec added a CSP source list keyword 'unsafe-hashes' which provides a way to allow execution of inline script event handlers. A bug is already filed to track implementation of unsafe-hashes: <https://bugzilla.mozilla.org/show_bug.cgi?id=1343950>

It appears that the best way to fix this security issue would be to implement 'unsafe-hashes'. Anyone attempting to use a hash on an inline script event handler would find that it fails to execute in Chrome without adding 'unsafe-hashes', so I would not imagine any legitimate use cases would rely on the current behavior.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a1918_159069)• 5 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: SecurityProduct: Firefox → Core

|  | [Pete Freitag](/user_profile?user_id=664665)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a86137_664665)• 5 years ago |

Group: core-securitySummary: Firefox 63+ CSP Hashes are allowed to Execute on inline scripts → Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1644790#c1)• 5 years ago |
|  | |

Fixing security groups.

Group: core-securityType: task → defect

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a1123428_1689)• 5 years ago |

Severity: -- → S3Status: UNCONFIRMED → NEWDepends on: [csp-unsafe-hashes](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes")Ever confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Priority: -- → P3Summary: Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution → Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specifiedWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a15649462_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1644790#c2)• 4 years ago |
|  | |

Christoph, please review the severity of this and find an assignee.

Flags: needinfo?(ckerschb)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1644790#c3)• 4 years ago |
|  | |

Hey Dan, we have not implemented `unsafe-hashes` and i don't think we are going to. FWIW, we would have [Bug 1343950](/show_bug.cgi?id=1343950 "RESOLVED FIXED - Content Security Policy (CSP) implement unsafe-hashes") on file for implementing it. Given that, is this still a sec-moderate? Or put differently, anything else we could do with this bug? Or does it go back into the backlog?

Flags: needinfo?(ckerschb) → needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a70669522_1689)• 2 years ago |

Blocks: [1788864](/show_bug.cgi?id=1788864 "RESOLVED FIXED - CSP: unsafe-hashes calculation for javascript: URLs differs from Chrome and Safari")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a74807558_703078)• 2 years ago |

Depends on: [1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1644790#c5)• 2 years ago |
|  | |

The test case is not accessible anymore, but [bug 1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag") should fix this. With that bug fixed we only use hashes of attributes after unsafe-hashes is specified in the CSP. However with unsafe-hashes being disabled by default that means there is no way of using hashes for attributes.

No longer depends on: [1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a74808037_703078)• 2 years ago |

Depends on: [1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag")

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1644790#c6)• 2 years ago |
|  | |

We might also consider unhiding this bug, considering while probably not widely known, I have seen at least one reference to this: <https://csplite.com/csp/test173/#bug_ff_unsafe-hashes_event_handler>. (I think I remember one other that I can't find right now)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1644790#c7)• 2 years ago |
|  | |

Attached file
[testcase.html](attachment.cgi?id=9303266)
— [Details](attachment.cgi?id=9303266&action=edit)

As expected this was fixed by [bug 1797070](/show_bug.cgi?id=1797070 "RESOLVED FIXED - CSP: Add basic implementation of unsafe-hashes behind a flag"). While the test page in [comment 0](/show_bug.cgi?id=1644790#c0 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified") is not accessible anymore, I recreated it based on the description.

In Nightly we don't execute the script, but we still do in Firefox release.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a76619347_703078)• 2 years ago |

Status: NEW → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a76744248_75935)• 2 years ago |

Assignee: nobody → tschusterGroup: dom-core-security → core-security-release
[status-firefox107](/buglist.cgi?f1=cf_status_firefox107&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox107&o1=equals&v1=wontfix)
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)Target Milestone: --- → 108 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1644790#c8)• 2 years ago |
|  | |

Tom, could we manualy

Flags: qe-verify+Whiteboard: [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?] → [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1644790#c9)• 2 years ago |
|  | |

(In reply to Brindusa Tot[:brindusat] from [comment #8](/show_bug.cgi?id=1644790#c8 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified"))

> Tom, could we manualy

Seems like something got lost here. 🙂

Flags: needinfo?(brindusa.tot)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1644790#c10)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #9](/show_bug.cgi?id=1644790#c9 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified"))

> (In reply to Brindusa Tot[:brindusat] from [comment #8](/show_bug.cgi?id=1644790#c8 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified"))
>
> > Tom, could we manualy
>
> Seems like something got lost here. 🙂

Yes, seems that something got lost! I suppose my question here was: could we manually verify this with testcase from [comment 7](/show_bug.cgi?id=1644790#c7 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified")? Should we do some more verification on this issue?

Flags: needinfo?(brindusa.tot) → needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a77823924_703078)• 2 years ago |

[Attachment #9303266](/attachment.cgi?id=9303266&action=edit "testcase.html") -
Attachment filename: file\_1644790.txt → file\_1644790.html
[Attachment #9303266](/attachment.cgi?id=9303266&action=edit "testcase.html") -
Attachment mime type: text/plain → text/htmlFlags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1644790#c11)• 2 years ago |
|  | |

You can verify this using the [attachment](https://bug1644790.bmoattachments.org/attachment.cgi?id=9303266&t=6I1EinHWShVrw6nYsniR9u). In a fixed version nothing should happen and in an unfixed version you should see an alert with the message "attr".

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1644790#c12)• 2 years ago |
|  | |

I have reproduced the alert message described in the above comment, using testcase.html from [comment 7](/show_bug.cgi?id=1644790#c7 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified") with an affected Nightly build (2022-11-01) on Win 10 x64.

The issue is verified as fixed on latest Beta 108.0b9 across platforms: Win 10 x64, macOS 11 and Ubuntu 18.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox108](/buglist.cgi?f1=cf_status_firefox108&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox108&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a78707356_578488)• 2 years ago |

Whiteboard: [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [domsecurity-backlog][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main108+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1644790#c13)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9307369)
— [Details](attachment.cgi?id=9307369&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a78797300_578488)• 2 years ago |

Alias: CVE-2022-46873

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a79335043_1689)• 2 years ago |

Flags: needinfo?(dveditz)See Also: → <https://csplite.com/csp/test173/#bug_ff_unsafe-hashes_event_handler>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a79335861_1689)• 2 years ago |

Regressions: [1805948](/show_bug.cgi?id=1805948 "RESOLVED FIXED - astrobiology.nasa.gov not loading on FF 108")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1644790#c14)• 2 years ago |
|  | |

Unhiding given [comment 6](/show_bug.cgi?id=1644790#c6 "VERIFIED FIXED - Firefox 63+ CSP Hashes Allow Inline Event Handler Script Execution without 'unsafe-hashes' specified"), that we have [published the advisory](https://www.mozilla.org/en-US/security/advisories/mfsa2022-51/#CVE-2022-46873) now, and that people are [discovering sites broken by this fix](https://bugzilla.mozilla.org/show_bug.cgi?id=1805948)

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a79856312_1689)• 2 years ago |

See Also: → [1806845](/show_bug.cgi?id=1806845 "RESOLVED DUPLICATE - Firefox 108 ignores 'unsafe-hashes', sites built using Shibboleth are broken")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1644790#a125283408_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1644790&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom Schuster](/user_profile?user_id=703078)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


