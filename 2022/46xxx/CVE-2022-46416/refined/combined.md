=== Content from github.com_b61be369_20250114_212042.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbosslabdcu%2FVulnerability-Reporting%2Fsecurity%2Fadvisories%2FGHSA-4xx4-r27p-wcrv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbosslabdcu%2FVulnerability-Reporting%2Fsecurity%2Fadvisories%2FGHSA-4xx4-r27p-wcrv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=bosslabdcu%2FVulnerability-Reporting)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bosslabdcu](/bosslabdcu)
/
**[Vulnerability-Reporting](/bosslabdcu/Vulnerability-Reporting)**
Public

* [Notifications](/login?return_to=%2Fbosslabdcu%2FVulnerability-Reporting) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fbosslabdcu%2FVulnerability-Reporting)
* [Star
   3](/login?return_to=%2Fbosslabdcu%2FVulnerability-Reporting)

* [Code](/bosslabdcu/Vulnerability-Reporting)
* [Issues
  0](/bosslabdcu/Vulnerability-Reporting/issues)
* [Pull requests
  0](/bosslabdcu/Vulnerability-Reporting/pulls)
* [Actions](/bosslabdcu/Vulnerability-Reporting/actions)
* [Projects
  0](/bosslabdcu/Vulnerability-Reporting/projects)
* [Security](/bosslabdcu/Vulnerability-Reporting/security)
* [Insights](/bosslabdcu/Vulnerability-Reporting/pulse)

Additional navigation options

* [Code](/bosslabdcu/Vulnerability-Reporting)
* [Issues](/bosslabdcu/Vulnerability-Reporting/issues)
* [Pull requests](/bosslabdcu/Vulnerability-Reporting/pulls)
* [Actions](/bosslabdcu/Vulnerability-Reporting/actions)
* [Projects](/bosslabdcu/Vulnerability-Reporting/projects)
* [Security](/bosslabdcu/Vulnerability-Reporting/security)
* [Insights](/bosslabdcu/Vulnerability-Reporting/pulse)

# Commercial Drone DHCP Exhaustion Vulnerability

Critical

[bosslabdcu](/bosslabdcu)
published
GHSA-4xx4-r27p-wcrv
Mar 27, 2023

## Package

Drone firmware
(python)

## Affected versions

v4.7.1(parrot bebop2 firmware)

## Patched versions

not patched

## Description

### Impact

A Dynamic Host Configuration Protocol (DHCP) starvation attack is a Denial of Service (DoS) attack that exhausts all available IP addresses on a drone’s DHCP server by generating a large number of packets and disguising them as legitimate connections after an attacker is able to access the drone’s internal network.

If this vulnerability is exploited, all devices that attempt to connect to the drone’s internal network after the attacker's device is connected are denied access to the internal network. In other words, a drone owner won’t be able to connect to the drone network after the attack. Through this vulnerability, the attacker can forcibly deny the owner access to the drone’s services.

### Summary

This vulnerability is caused by the DHCP provided by Wi-Fi–based commercial drones. Since DHCP does not provide mutual authentication, if an attacker sends a large number of packets that manipulate the DISCOVER packet trying to connect to the drone’s DHCP server, the DHCP server runs out of available IP addresses by mistaking malformed packets for legitimate requests.

By exploiting this vulnerability, an attacker can send a large number of manipulated DHCP connection packets to the drone’s DHCP server, and the drone’s DHCP server would then allocate assignable IP addresses to fake devices. As a result, the IP address pool that can be assigned by the drone’s DHCP server will be exhausted, and even if a legitimate device requests a connection to the drone’s DHCP server, the device would not be assigned an IP address. Hence, the drone denies connections from legitimate devices, and the services provided by the drone are similarly denied.

This vulnerability must be preceded by an attacker connecting to the drone network, using attacks such as Wi-Fi password cracking.

### Analysis

A DHCP starvation attack targets the DHCP server that exhausts all IP addresses that can be assigned from the server by manipulating the DISCOVER message. DHCP in Wi-Fi–based drones allocates IP addresses based on MAC addresses. However, DHCP does not provide a mutual authentication process to determine whether the connecting MAC address is the legitimate MAC address of the device. Therefore, if an attacker sends a large number of DHCP DISCOVER packets containing fake MAC addresses to the drone, the drone exhausts all available IP addresses by mistaking the manipulated packets as legitimate requests. Consequently, the drone does not have an IP address to assign to a device attempting a legitimate connection after this attack. The following figure shows the DHCP connection process.

[![image](https://user-images.githubusercontent.com/84011321/226807774-59e364ba-c9b5-4c37-abbc-4b1e0f6c8ef2.png)](https://user-images.githubusercontent.com/84011321/226807774-59e364ba-c9b5-4c37-abbc-4b1e0f6c8ef2.png)

#### Fig 1. DHCP connection process

A DHCP connection process begins with the client sending a DHCP DISCOVER packet to a drone’s DHCP server to request an assignable IP address. The DHCP server delivers the assignable IP address to the client in an OFFER packet, and the client sends a REQUEST packet, including the content that the corresponding address will be used for, to the DHCP server to use the IP address suggested by the DHCP server. Finally, the DHCP server allocates the IP address to the client by delivering the ACK packet based on the REQUEST packet received from the client.

In this process, if a malicious attacker penetrates the drone’s internal network using attack techniques such as password cracking and continuously sends manipulated DISCOVER packets to the drone, the drone continuously sends corresponding OFFER packets. Accordingly, if a malicious attacker uses an attack technology such as password cracking to break into the drone's internal network and continuously delivers the manipulated DISCOVER packet to the drone, the drone continuously transmits the corresponding OFFER packet. A vulnerability thereby exhausts all allocated IP addresses in the drone.

Based on the conceptual analysis results of this vulnerability, we used DHCPig to demonstrate how this vulnerability can be exploited. DHCPig is an open-source tool that manipulates and attacks DHCP connection packets using Scapy, the Python-based library. We used this tool to analyze the DHCP connection process for the Parrot Bebop 2 drone, which relied on Wi-Fi. We tried a DHCP starvation attack using the DHCPig tool, as shown in the following figure.

[![image](https://user-images.githubusercontent.com/84011321/226807802-835b3104-59e7-4b8a-975a-ef78f49cbe35.png)](https://user-images.githubusercontent.com/84011321/226807802-835b3104-59e7-4b8a-975a-ef78f49cbe35.png)

#### Fig 2. Example of DHCP starvation attack results using DHCPig tool

The above figure displays a DHCP starvation attack result using the DHCPig tool. Importantly, here we must verify whether this tool has successfully attempted the DHCP starvation attack, by analysing packets. Therefore, we analyse those packets which correspond to the DHCP connection process using Wireshark. An example of the analysis results of the DHCP connection process is shown in the following figure.

[![image](https://user-images.githubusercontent.com/84011321/226807822-df83b60e-3f34-4b21-b523-4ee7686ae71a.png)](https://user-images.githubusercontent.com/84011321/226807822-df83b60e-3f34-4b21-b523-4ee7686ae71a.png)

#### Fig 3. Example of DHCP connection process analysis results using Wireshark

As shown in the above figure, as a part of analysing the packets corresponding to the DHCP connection process using Wireshark, we analyse the DISCOVER packet (which is the beginning of the DHCP connection process) and the ACK packet (which is the end of the connection process), which are sent and received in sequence. Moreover, the OFFER packet with the drone’s IP address is received, where the DHCP Server Identifier field indicates the IP address of the DHCP server. Based on these analysis results, the experimental results of the attempted DHCP starvation attack are shown in the following figure.

[![image](https://user-images.githubusercontent.com/84011321/226807840-d753d9ef-18be-4ae3-8072-b9a6bbf2fd8e.png)](https://user-images.githubusercontent.com/84011321/226807840-d753d9ef-18be-4ae3-8072-b9a6bbf2fd8e.png)

#### Fig 4. Experimental results of DHCP starvation attack (Left: before attack; Right: after attack)

As shown in the above figure, before the DHCP starvation attack, a user device and a drone are successfully connected, with a video output being transferred from the drone thereafter. However, after the DHCP starvation attack, the connection to the drone is denied even if the user device attempts such a connection. In order to intuitively outline these attack results, the IP address of the internal network of the terminal connected to the drone is shown in the following figure, based on the Wi-Fi information of the drone.

[![image](https://user-images.githubusercontent.com/84011321/226807859-f6ba8df7-015e-48cb-84b3-20e1411ec402.png)](https://user-images.githubusercontent.com/84011321/226807859-f6ba8df7-015e-48cb-84b3-20e1411ec402.png)

#### Fig 5. Internal network IP address of the device connected to the drone (Left: before attack; Right: after attack)

As shown in above figure, before the DHCP starvation attack, the internal network IP address of the device connected to the drone is 192.168.42.98. This means that the IP address bandwidth of the drone is successfully allocated. However, when a user device attempts to connect to the drone’s internal network after a DHCP starvation attack, a warning message – “Couldn’t get IP address” – is displayed. Thereafter, even if the user device attempts a legitimate connection, the connection to the drone’s internal network is rejected.

Through this experiment, we demonstrate the successful results of the DHCP starvation attack on the Parrot Bebop 2 drone.

### *Discoverer(s)/Credits*

Kyungroul Lee/South Korea/carpedm@mnu.ac.kr

Wontae Jung/south korea/dnjsxo4354@mokpo.ac.kr

Junkwon Lee/south korea/kwonl57@mokpo.ac.kr

Jiin Jeong/south korea/ddd0444@cu.ac.kr

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:H

### CVE ID

CVE-2022-46416

### Weaknesses

[CWE-1037](/advisories?query=cwe%3A1037)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


