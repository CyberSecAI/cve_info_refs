Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from an out-of-bounds read in the `PORT` command parameter extraction functionality within Weston Embedded uC-FTPs v 1.98.00. Specifically, the code that parses the IP address and port arguments from the `PORT` command lacks proper bounds checking. When no IP address or port is provided in the `PORT` command, the parsing logic enters an infinite loop, incrementing a pointer until it accesses unmapped memory, leading to a crash.

**Weaknesses/Vulnerabilities Present:**
- **Out-of-bounds read (CWE-125):** The code reads beyond the allocated buffer when searching for digits in the `PORT` command arguments.
- **Improper Handling of Input (CWE-823):** The code does not handle the case where the required digit arguments are missing, leading to a pointer offset error.

**Impact of Exploitation:**
- **Denial of Service (DoS):** A successful attack leads to a crash of the uC-FTPs server due to the out-of-bounds read, rendering the service unavailable.

**Attack Vectors:**
- **Network Packets:** The vulnerability is triggered by sending specially crafted network packets to the vulnerable server.
- **Specifically Crafted `PORT` Command:** The attacker sends a `PORT` command without specifying an IP address or port number.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker must have the ability to send network packets to the uC-FTPs server.
- **Authenticated User:** The attacker must be an authenticated user of the FTP service to send the `PORT` command.

**Technical Details:**
- The vulnerability is triggered in the `FTPs_ProcessCtrlCmd` function, specifically when parsing arguments for the `PORT` command.
- The code uses a loop that increments the `ftp_session->CtrlCmdArgs` pointer looking for ASCII digits. This loop continues indefinitely if no digits are found and no NULL terminator is reached, eventually leading to a segmentation fault when accessing unmapped memory.
- The IP address parsing code iterates four times, expecting to find a digit each time, and the port parsing iterates twice, expecting digits each time.
- The code utilizes the `ASCII_IsDig` function to check if a character is a digit and `Str_ParseNbr_Int32U` to parse a string to an integer.

**Mitigation:**
The provided fix adds a check within the parsing loops to terminate if a `NULL` byte is reached in the network buffer, preventing the out-of-bounds read. The `NULL` byte is guaranteed to be present because the caller function `FTPs_CtrlTask` adds it after receiving network data.
```
//Example fix for IP address parsing:
for (i = 0; i <= 3; i++) {
    dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
    while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != (CPU_CHAR *)0) && (*ftp_session->CtrlCmdArgs != 0)) {
        ftp_session->CtrlCmdArgs++;
        dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
    }
    p_addr[i] = Str_ParseNbr_Int32U(ftp_session->CtrlCmdArgs, &ftp_session->CtrlCmdArgs, 10);
}
//Example fix for port parsing
for (i = 0; i <= 1; i++) {
    dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
    while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != 0) && (*ftp_session->CtrlCmdArgs != 0)) {
        ftp_session->CtrlCmdArgs++;
        dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
    }
    p_port[i] = Str_ParseNbr_Int32U(ftp_session->CtrlCmdArgs, &ftp_session->CtrlCmdArgs, 10);
}
```
The vulnerability is assigned both CVE-2022-46377 (for IP parsing issue) and CVE-2022-46378 (for port parsing issue) and was also assigned TALOS-2022-1681.