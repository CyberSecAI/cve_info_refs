```
{
  "vulnerability": {
    "root_cause": "The VPP IPSec plugin, when using AES-CBC mode, generates a predictable Initialization Vector (IV). Instead of using a cryptographically secure pseudo-random number generator (CSPRNG), it uses a deterministic method where IVs are chained using an AES round, making subsequent IVs predictable if one is known.",
    "weaknesses": [
      "CWE-329: Generation of Predictable IV with CBC Mode",
      "Use of predictable IVs in CBC mode."
    ],
    "impact": "An attacker who can observe one IV can predict subsequent IVs. This can lead to a compromise of confidentiality or integrity of the encrypted data if other vulnerabilities are also present.",
    "attack_vectors": [
      "Man-in-the-middle attacks",
       "Network traffic interception",
      "Passive observation of IPsec traffic"
    ],
    "required_capabilities": "An attacker needs the ability to observe network traffic and capture at least one IV which is transmitted in the clear within the ESP header.  This requires network level access at a point where IPsec traffic is being transmitted"
  },
  "affected_components": [
    "FD.io VPP (Vector Packet Processor) IPSec plugin",
    "VPP versions 22.10, 22.06, 22.02, 21.10, 21.06, 21.01, 20.09, 20.05, 20.01, 19.08, and 19.04"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-46397",
    "https://lists.fd.io/g/security-announce/message/2",
    "https://wiki.fd.io/view/TSC:Vulnerability_Management",
    "https://jira.fd.io/browse/VPP-2037",
    "https://packagecloud.io/fdio/release",
   "https://cwe.mitre.org/data/definitions/329.html",
    "https://git.fd.io/vpp/tree/src/vnet/ipsec/esp_encrypt.c#n405",
    "https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf",
    "https://www.rfc-editor.org/rfc/rfc3602#section-3",
    "https://git.fd.io/vpp/tree/src/plugins/crypto_openssl/main.c#n107",
    "https://www.openssl.org/docs/manmaster/man3/RAND_bytes.html",
    "https://git.fd.io/vpp/tree/src/plugins/crypto_ipsecmb/ipsecmb.c#n246",
    "https://git.fd.io/vpp/tree/src/plugins/crypto_native/aes_cbc.c#n273",
    "http://git.dpdk.org/dpdk/tree/lib/ipsec/esp_outb.c#n315",
    "http://git.dpdk.org/dpdk/tree/lib/ipsec/crypto.h#n206"

  ],
    "additional_notes": "The vulnerability was reported by Benoit Ganne. A fix has been implemented and committed to the main development branch, and has been cherry-picked to all affected release branches. Maintenance releases were performed for VPP 22.06 and 22.10. Older releases prior to VPP 22.06 are unsupported and will not have maintenance releases."
}
```