=== Content from github.com_4f5a1e5b_20250114_221131.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fpull%2F549)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fpull%2F549)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=polkadot-evm%2Ffrontier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[polkadot-evm](/polkadot-evm)
/
**[frontier](/polkadot-evm/frontier)**
Public

* [Notifications](/login?return_to=%2Fpolkadot-evm%2Ffrontier) You must be signed in to change notification settings
* [Fork
  511](/login?return_to=%2Fpolkadot-evm%2Ffrontier)
* [Star
   580](/login?return_to=%2Fpolkadot-evm%2Ffrontier)

* [Code](/polkadot-evm/frontier)
* [Issues
  122](/polkadot-evm/frontier/issues)
* [Pull requests
  27](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects
  0](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

Additional navigation options

* [Code](/polkadot-evm/frontier)
* [Issues](/polkadot-evm/frontier/issues)
* [Pull requests](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpolkadot-evm%2Ffrontier%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpolkadot-evm%2Ffrontier%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Handle 0 exponent with fudged length correctly in ModExp #549

 Merged

[sorpaas](/sorpaas)
merged 7 commits into
[polkadot-evm:master](/polkadot-evm/frontier/tree/master "polkadot-evm/frontier:master")
from
[moonbeam-foundation:notlesh-recalc-modexp-exp-length](/moonbeam-foundation/frontier/tree/notlesh-recalc-modexp-exp-length "moonbeam-foundation/frontier:notlesh-recalc-modexp-exp-length")

Jan 13, 2022

 Merged

# [Handle 0 exponent with fudged length correctly in ModExp](#top) #549

[sorpaas](/sorpaas)
merged 7 commits into
[polkadot-evm:master](/polkadot-evm/frontier/tree/master "polkadot-evm/frontier:master")
from
[moonbeam-foundation:notlesh-recalc-modexp-exp-length](/moonbeam-foundation/frontier/tree/notlesh-recalc-modexp-exp-length "moonbeam-foundation/frontier:notlesh-recalc-modexp-exp-length")

Jan 13, 2022

[Conversation
9](/polkadot-evm/frontier/pull/549)
[Commits
7](/polkadot-evm/frontier/pull/549/commits)
[Checks
0](/polkadot-evm/frontier/pull/549/checks)
[Files changed](/polkadot-evm/frontier/pull/549/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![notlesh](https://avatars.githubusercontent.com/u/2967426?s=60&v=4)](/notlesh)

Copy link

Contributor

### @notlesh **[notlesh](/notlesh)** commented [Jan 13, 2022](#issue-1100935819)

This PR properly handles an exponent of 0 in the ModExp precompile.

Sorry, something went wrong.

All reactions

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[Handle 0 exponent with fudged length correctly in ModExp](/polkadot-evm/frontier/pull/549/commits/31aa196158adccd0363d98e2aa89bd03bf7b3869 "Handle 0 exponent with fudged length correctly in ModExp")`

`[31aa196](/polkadot-evm/frontier/pull/549/commits/31aa196158adccd0363d98e2aa89bd03bf7b3869)`

 [![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&u=74d9f3602a6c533171b0a72908875aacd31ae167&v=4)](/notlesh)
[notlesh](/notlesh)
requested a review
from [sorpaas](/sorpaas)
as a [code owner](/polkadot-evm/frontier/blob/a630bd4dbd120c472bc2a0207cbf1a50f9ad8b1a/.github/CODEOWNERS#L5)
[January 13, 2022 00:06](#event-5883754543)

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[cargo fmt](/polkadot-evm/frontier/pull/549/commits/052b66a68dca1ba156bc238aa762b986900903eb "cargo fmt")`

`[052b66a](/polkadot-evm/frontier/pull/549/commits/052b66a68dca1ba156bc238aa762b986900903eb)`

[![sorpaas](https://avatars.githubusercontent.com/u/6277322?s=60&v=4)](/sorpaas)

**[sorpaas](/sorpaas)**
approved these changes
[Jan 13, 2022](#pullrequestreview-851184398)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb)

[![sorpaas](https://avatars.githubusercontent.com/u/6277322?s=60&v=4)](/sorpaas)

**[sorpaas](/sorpaas)**
requested changes
[Jan 13, 2022](#pullrequestreview-851188393)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb)

[frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3)
Outdated

Show resolved

Hide resolved

[frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3)
Outdated

Show resolved

Hide resolved

[![sorpaas](https://avatars.githubusercontent.com/u/6277322?s=60&v=4)](/sorpaas)

**[sorpaas](/sorpaas)**
reviewed
[Jan 13, 2022](#pullrequestreview-851196394)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb)

[frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3)
Outdated

Show resolved

Hide resolved

[![sorpaas](https://avatars.githubusercontent.com/u/6277322?s=60&v=4)](/sorpaas)

**[sorpaas](/sorpaas)**
reviewed
[Jan 13, 2022](#pullrequestreview-851217690)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb)

[frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/files/052b66a68dca1ba156bc238aa762b986900903eb#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3)
Outdated

Show resolved

Hide resolved

 [notlesh](/notlesh)
and others
added 2 commits
[January 12, 2022 20:48](#commits-pushed-8c8370a)

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[Revert to following EIP-2565 strictly, subtract after adding terms to…](/polkadot-evm/frontier/pull/549/commits/8c8370a2fcd6be311cfe71a5b283b0da35dd39eb "Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow")`
 …

`[8c8370a](/polkadot-evm/frontier/pull/549/commits/8c8370a2fcd6be311cfe71a5b283b0da35dd39eb)`

```
… prevent underflow
```

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh) [![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=40&v=4)](/sorpaas)

`[Update frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/commits/7b35235ba97345c70cbc28635d9005a6f343408c "Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>")`
 …

`[7b35235](/polkadot-evm/frontier/pull/549/commits/7b35235ba97345c70cbc28635d9005a6f343408c)`

```

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>
```

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=80&u=74d9f3602a6c533171b0a72908875aacd31ae167&v=4)](/notlesh)

Copy link

Contributor

Author

### **[notlesh](/notlesh)** commented [Jan 13, 2022](#issuecomment-1011768902)

| I agree with your critiques, [@sorpaas](https://github.com/sorpaas) , and reverted the changes which made this look less like the original EIP. |
| --- |

All reactions

Sorry, something went wrong.

[![notlesh](https://avatars.githubusercontent.com/u/2967426?s=60&v=4)](/notlesh)

**[notlesh](/notlesh)**
commented
[Jan 13, 2022](#pullrequestreview-851226380)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/7b35235ba97345c70cbc28635d9005a6f343408c)

[frame/evm/precompile/modexp/src/lib.rs](/polkadot-evm/frontier/pull/549/files/7b35235ba97345c70cbc28635d9005a6f343408c#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3)
Outdated

Show resolved

Hide resolved

 [notlesh](/notlesh)
added 2 commits
[January 12, 2022 21:00](#commits-pushed-85bd031)

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[More revert](/polkadot-evm/frontier/pull/549/commits/85bd031ea552d8f260d5842294410744469acc08 "More revert")`

`[85bd031](/polkadot-evm/frontier/pull/549/commits/85bd031ea552d8f260d5842294410744469acc08)`

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[cargo fmt](/polkadot-evm/frontier/pull/549/commits/b53f404e044a59a02413d340a919481a2be411f2 "cargo fmt")`

`[b53f404](/polkadot-evm/frontier/pull/549/commits/b53f404e044a59a02413d340a919481a2be411f2)`

[tgmichel](/tgmichel)
added a commit
to moonbeam-foundation/frontier
that referenced
this pull request
[Jan 13, 2022](#ref-commit-c76d66b)
[![@tgmichel](https://avatars.githubusercontent.com/u/3994116?s=40&u=92aa3098f48fbba177d6150b7fc2a262b2ca0c35&v=4)](/tgmichel)

`[Handle 0 exponent with fudged length correctly in ModExp (](/moonbeam-foundation/frontier/commit/c76d66bb47762ca944b3217f42977a45e7abc661 "Handle 0 exponent with fudged length correctly in ModExp (#549)")[polkadot-ev…](https://github.com/polkadot-evm/frontier/pull/549)`
…

`[c76d66b](/moonbeam-foundation/frontier/commit/c76d66bb47762ca944b3217f42977a45e7abc661)`

```
[…m#549](https://github.com/polkadot-evm/frontier/pull/549))
```

[tgmichel](/tgmichel)
added a commit
to moonbeam-foundation/frontier
that referenced
this pull request
[Jan 13, 2022](#ref-commit-8cfdfa3)
[![@tgmichel](https://avatars.githubusercontent.com/u/3994116?s=40&u=92aa3098f48fbba177d6150b7fc2a262b2ca0c35&v=4)](/tgmichel)

`[Handle 0 exponent with fudged length correctly in ModExp (](/moonbeam-foundation/frontier/commit/8cfdfa3e9f3d22bd42dbe28140aa4b32a2900271 "Handle 0 exponent with fudged length correctly in ModExp (#549) (#27)")[polkadot-ev…](https://github.com/polkadot-evm/frontier/pull/549)`
…

`[8cfdfa3](/moonbeam-foundation/frontier/commit/8cfdfa3e9f3d22bd42dbe28140aa4b32a2900271)`

```
[…m#549](https://github.com/polkadot-evm/frontier/pull/549)) ([#27](https://github.com/moonbeam-foundation/frontier/pull/27))
```

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh)

`[Prefer expect to match](/polkadot-evm/frontier/pull/549/commits/f568b3177da253536928cc57aadd65c4582b6081 "Prefer expect to match")`

`[f568b31](/polkadot-evm/frontier/pull/549/commits/f568b3177da253536928cc57aadd65c4582b6081)`

[![tgmichel](https://avatars.githubusercontent.com/u/3994116?s=60&v=4)](/tgmichel)

**[tgmichel](/tgmichel)**
approved these changes
[Jan 13, 2022](#pullrequestreview-851938313)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/f568b3177da253536928cc57aadd65c4582b6081)

[![sorpaas](https://avatars.githubusercontent.com/u/6277322?s=60&v=4)](/sorpaas)

**[sorpaas](/sorpaas)**
approved these changes
[Jan 13, 2022](#pullrequestreview-851943023)

 [View reviewed changes](/polkadot-evm/frontier/pull/549/files/f568b3177da253536928cc57aadd65c4582b6081)

[![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=40&u=c54e68ffd2e6cac57579f89fc92216282e464ba7&v=4)](/sorpaas)
[sorpaas](/sorpaas)
merged commit [`8a93fdc`](/polkadot-evm/frontier/commit/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)
into
polkadot-evm:master

[Jan 13, 2022](https://github.com/polkadot-evm/frontier/pull/549#event-5888799900)

[tgmichel](/tgmichel)
pushed a commit
to moonbeam-foundation/frontier
that referenced
this pull request
[Jan 14, 2022](#ref-commit-f7af9a4)
[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&u=74d9f3602a6c533171b0a72908875aacd31ae167&v=4)](/notlesh) [![@tgmichel](https://avatars.githubusercontent.com/u/3994116?s=40&v=4)](/tgmichel)

`[Handle 0 exponent with fudged length correctly in ModExp (](/moonbeam-foundation/frontier/commit/f7af9a4f2c66c81bfdfbafdfad661f2a91417652 "Handle 0 exponent with fudged length correctly in ModExp (#549)

* Handle 0 exponent with fudged length correctly in ModExp

* cargo fmt

* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow

* Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>

* More revert

* cargo fmt

* Prefer expect to match

Co-authored-by: Wei Tang <accounts@that.world>
(cherry picked from commit 8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)")[polkadot-ev…](https://github.com/polkadot-evm/frontier/pull/549)`
…

`[f7af9a4](/moonbeam-foundation/frontier/commit/f7af9a4f2c66c81bfdfbafdfad661f2a91417652)`

```
[…m#549](https://github.com/polkadot-evm/frontier/pull/549))

* Handle 0 exponent with fudged length correctly in ModExp

* cargo fmt

* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow

* Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>

* More revert

* cargo fmt

* Prefer expect to match

Co-authored-by: Wei Tang <accounts@that.world>
(cherry picked from commit [8a93fdc](https://github.com/moonbeam-foundation/frontier/commit/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664))
```

[akru](/akru)
added a commit
to AstarNetwork/Astar
that referenced
this pull request
[Jan 15, 2022](#ref-commit-4a2789f)
[![@akru](https://avatars.githubusercontent.com/u/786394?s=40&u=afe8c132677ec27bd48abad3e80870f16e94a8a6&v=4)](/akru)

`[Backported modexp precompile integer overflow fix](/AstarNetwork/Astar/commit/4a2789f38b88e5190ffe9620e796b106ef9c50bd "Backported modexp precompile integer overflow fix

https://github.com/paritytech/frontier/pull/549")`
…

`[4a2789f](/AstarNetwork/Astar/commit/4a2789f38b88e5190ffe9620e796b106ef9c50bd)`

```
[polkadot-evm/frontier#549](https://github.com/polkadot-evm/frontier/pull/549)
```

[abhijeetbhagat](/abhijeetbhagat)
pushed a commit
to web3labs/frontier
that referenced
this pull request
[Jan 11, 2023](#ref-commit-ddbccb4)
[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&u=74d9f3602a6c533171b0a72908875aacd31ae167&v=4)](/notlesh) [![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=40&u=c54e68ffd2e6cac57579f89fc92216282e464ba7&v=4)](/sorpaas)

`[Handle 0 exponent with fudged length correctly in ModExp (](/web3labs/frontier/commit/ddbccb46726a82e81825f741dad069fe6be8c1dd "Handle 0 exponent with fudged length correctly in ModExp (#549)

* Handle 0 exponent with fudged length correctly in ModExp

* cargo fmt

* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow

* Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>

* More revert

* cargo fmt

* Prefer expect to match

Co-authored-by: Wei Tang <accounts@that.world>")[polkadot-ev…](https://github.com/polkadot-evm/frontier/pull/549)`
…

`[ddbccb4](/web3labs/frontier/commit/ddbccb46726a82e81825f741dad069fe6be8c1dd)`

```
[…m#549](https://github.com/polkadot-evm/frontier/pull/549))

* Handle 0 exponent with fudged length correctly in ModExp

* cargo fmt

* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow

* Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>

* More revert

* cargo fmt

* Prefer expect to match

Co-authored-by: Wei Tang <accounts@that.world>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fpull%2F549)

Reviewers

[![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=40&v=4)](/sorpaas) [sorpaas](/sorpaas)

sorpaas approved these changes

[![@tgmichel](https://avatars.githubusercontent.com/u/3994116?s=40&v=4)](/tgmichel) [tgmichel](/tgmichel)

tgmichel approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=52&v=4)](/notlesh) [![@tgmichel](https://avatars.githubusercontent.com/u/3994116?s=52&v=4)](/tgmichel) [![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=52&v=4)](/sorpaas)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_627c1954_20250114_221129.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fcommit%2F8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fcommit%2F8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=polkadot-evm%2Ffrontier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[polkadot-evm](/polkadot-evm)
/
**[frontier](/polkadot-evm/frontier)**
Public

* [Notifications](/login?return_to=%2Fpolkadot-evm%2Ffrontier) You must be signed in to change notification settings
* [Fork
  511](/login?return_to=%2Fpolkadot-evm%2Ffrontier)
* [Star
   580](/login?return_to=%2Fpolkadot-evm%2Ffrontier)

* [Code](/polkadot-evm/frontier)
* [Issues
  122](/polkadot-evm/frontier/issues)
* [Pull requests
  27](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects
  0](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

Additional navigation options

* [Code](/polkadot-evm/frontier)
* [Issues](/polkadot-evm/frontier/issues)
* [Pull requests](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

## Commit

[Permalink](/polkadot-evm/frontier/commit/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Handle 0 exponent with fudged length correctly in ModExp ([#549](https://github.com/polkadot-evm/frontier/pull/549))

[Browse files](/polkadot-evm/frontier/tree/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664)
Browse the repository at this point in the history

```
* Handle 0 exponent with fudged length correctly in ModExp

* cargo fmt

* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow

* Update frame/evm/precompile/modexp/src/lib.rs

Clean up test case

Co-authored-by: Wei Tang <accounts@that.world>

* More revert

* cargo fmt

* Prefer expect to match

Co-authored-by: Wei Tang <accounts@that.world>
```

* Loading branch information

[![@notlesh](https://avatars.githubusercontent.com/u/2967426?s=40&v=4)](/notlesh) [![@sorpaas](https://avatars.githubusercontent.com/u/6277322?s=40&v=4)](/sorpaas)

[notlesh](/polkadot-evm/frontier/commits?author=notlesh "View all commits by notlesh")
and
[sorpaas](/polkadot-evm/frontier/commits?author=sorpaas "View all commits by sorpaas")
authored
Jan 13, 2022

1 parent
[6dd07a4](/polkadot-evm/frontier/commit/6dd07a4d581a4c00bb2a2238a81997fc75bc2127)

commit 8a93fdc

Showing
**1 changed file**
with
**51 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

56 changes: 51 additions & 5 deletions

56
[frame/evm/precompile/modexp/src/lib.rs](#diff-a7f629916c3f9988339d42cd9657d6569d26c7df6c3e303d7219e86cbd0e27d3 "frame/evm/precompile/modexp/src/lib.rs")

Show comments

[View file](/polkadot-evm/frontier/blob/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664/frame/evm/precompile/modexp/src/lib.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,7 +47,10 @@ fn calculate\_gas\_cost( |
|  |  | words += 1; |
|  |  | } |
|  |  |  |
|  |  | // TODO: prevent/handle overflow |
|  |  | // Note: can't overflow because we take words to be some u64 value / 8, which is |
|  |  | // necessarily less than sqrt(u64::MAX). |
|  |  | // Additionally, both base\_length and mod\_length are bounded to 1024, so this has |
|  |  | // an upper bound of roughly (1024 / 8) squared |
|  |  | words \* words |
|  |  | } |
|  |  |  |
| Expand All | | @@ -63,8 +66,17 @@ fn calculate\_gas\_cost( |
|  |  | let bytes: [u8; 32] = [0xFF; 32]; |
|  |  | let max\_256\_bit\_uint = BigUint::from\_bytes\_be(&bytes); |
|  |  |  |
|  |  | // from the EIP spec: |
|  |  | // (8 \* (exp\_length - 32)) + ((exponent & (2\*\*256 - 1)).bit\_length() - 1) |
|  |  | // |
|  |  | // Notes: |
|  |  | // \* exp\_length is bounded to 1024 and is > 32 |
|  |  | // \* exponent can be zero, so we subtract 1 after adding the other terms (whose sum |
|  |  | // must be > 0) |
|  |  | // \* the addition can't overflow because the terms are both capped at roughly |
|  |  | // 8 \* max size of exp\_length (1024) |
|  |  | iteration\_count = |
|  |  | (8 \* (exp\_length - 32)) + ((exponent.bitand(max\_256\_bit\_uint)).bits() - 1); |
|  |  | (8 \* (exp\_length - 32)) + exponent.bitand(max\_256\_bit\_uint).bits() - 1; |
|  |  | } |
|  |  |  |
|  |  | max(iteration\_count, 1) |
| Expand All | | @@ -89,7 +101,7 @@ fn calculate\_gas\_cost( |
|  |  | // 6) modulus, size as described above |
|  |  | // |
|  |  | // |
|  |  | // NOTE: input sizes are arbitrarily large (up to 256 bits), with the expectation |
|  |  | // NOTE: input sizes are bound to 1024 bytes, with the expectation |
|  |  | // that gas limits would be applied before actual computation. |
|  |  | // |
|  |  | // maximum stack size will also prevent abuse. |
| Expand Down  Expand Up | | @@ -133,7 +145,7 @@ impl Precompile for Modexp { |
|  |  | let mod\_len\_big = BigUint::from\_bytes\_be(&buf); |
|  |  | if mod\_len\_big > max\_size\_big { |
|  |  | return Err(PrecompileFailure::Error { |
|  |  | exit\_status: ExitError::Other("unreasonably large exponent length".into()), |
|  |  | exit\_status: ExitError::Other("unreasonably large modulus length".into()), |
|  |  | }); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -162,7 +174,6 @@ impl Precompile for Modexp { |
|  |  | let exponent = BigUint::from\_bytes\_be(&input[exp\_start..exp\_start + exp\_len]); |
|  |  |  |
|  |  | // do our gas accounting |
|  |  | // TODO: we could technically avoid reading base first... |
|  |  | let gas\_cost = |
|  |  | calculate\_gas\_cost(base\_len as u64, exp\_len as u64, mod\_len as u64, &exponent); |
|  |  | if let Some(gas\_left) = target\_gas { |
| Expand Down  Expand Up | | @@ -423,4 +434,39 @@ mod tests { |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | #[test] |
|  |  | fn test\_zero\_exp\_with\_33\_length() { |
|  |  | // This is a regression test which ensures that the 'iteration\_count' calculation |
|  |  | // in 'calculate\_iteration\_count' cannot underflow. |
|  |  | // |
|  |  | // In debug mode, this underflow could cause a panic. Otherwise, it causes N\*\*0 to |
|  |  | // be calculated at more-than-normal expense. |
|  |  | // |
|  |  | // TODO: cite security advisory |
|  |  |  |
|  |  | let input = vec![ |
|  |  | 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, |
|  |  | 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, |
|  |  | 0, 0, 0, 0, 0, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, |
|  |  | 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, |
|  |  | 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, |
|  |  | ]; |
|  |  |  |
|  |  | let cost: u64 = 100000; |
|  |  |  |
|  |  | let context: Context = Context { |
|  |  | address: Default::default(), |
|  |  | caller: Default::default(), |
|  |  | apparent\_value: From::from(0), |
|  |  | }; |
|  |  |  |
|  |  | let precompile\_result = Modexp::execute(&input, Some(cost), &context, false) |
|  |  | .expect("Modexp::execute() returned error"); |
|  |  |  |
|  |  | assert\_eq!(precompile\_result.output.len(), 1); // should be same length as mod |
|  |  | let result = BigUint::from\_bytes\_be(&precompile\_result.output[..]); |
|  |  | let expected = BigUint::parse\_bytes(b"0", 10).unwrap(); |
|  |  | assert\_eq!(result, expected); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8a93fdc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fcommit%2F8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a164a88b_20250114_221132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fsecurity%2Fadvisories%2FGHSA-cjg2-2fjg-fph4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpolkadot-evm%2Ffrontier%2Fsecurity%2Fadvisories%2FGHSA-cjg2-2fjg-fph4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=polkadot-evm%2Ffrontier)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[polkadot-evm](/polkadot-evm)
/
**[frontier](/polkadot-evm/frontier)**
Public

* [Notifications](/login?return_to=%2Fpolkadot-evm%2Ffrontier) You must be signed in to change notification settings
* [Fork
  511](/login?return_to=%2Fpolkadot-evm%2Ffrontier)
* [Star
   580](/login?return_to=%2Fpolkadot-evm%2Ffrontier)

* [Code](/polkadot-evm/frontier)
* [Issues
  122](/polkadot-evm/frontier/issues)
* [Pull requests
  27](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects
  0](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

Additional navigation options

* [Code](/polkadot-evm/frontier)
* [Issues](/polkadot-evm/frontier/issues)
* [Pull requests](/polkadot-evm/frontier/pulls)
* [Discussions](/polkadot-evm/frontier/discussions)
* [Actions](/polkadot-evm/frontier/actions)
* [Projects](/polkadot-evm/frontier/projects)
* [Security](/polkadot-evm/frontier/security)
* [Insights](/polkadot-evm/frontier/pulse)

# Integer underflow in the MODEXP precompile

Moderate

[sorpaas](/sorpaas)
published
GHSA-cjg2-2fjg-fph4
Jan 14, 2022

## Package

cargo

Frontier
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

<= commit 6dd07a4

## Patched versions

>= commit 8a93fdc

## Description

### Impact

A bug in Frontier's MODEXP precompile implementation can cause an integer underflow in certain conditions. This will cause a node crash for debug builds. For release builds (and production WebAssembly binaries), the impact is limited as it can only cause a normal EVM out-of-gas. It is recommended that you apply the patch as soon as possible.

If you do not use MODEXP precompile in your runtime, then you are not impacted.

### Patches

Patches are applied in PR [#549](https://github.com/polkadot-evm/frontier/pull/549).

### Workarounds

None.

### References

Patch PR: [#549](https://github.com/polkadot-evm/frontier/pull/549)

### Credits

Thanks to SR-Labs for discovering the security vulnerability, and thanks to PureStake team for the patches.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in the [Frontier repo](https://github.com/paritytech/frontier)

### Severity

Moderate

### CVE ID

CVE-2022-21685

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


