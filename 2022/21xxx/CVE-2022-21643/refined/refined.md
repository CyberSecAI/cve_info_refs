The provided content relates to CVE-2022-21643.

**Root cause of vulnerability:**
The vulnerability is caused by a SQL injection in the `register.php` file of the USOC application.

**Weaknesses/vulnerabilities present:**
- SQL Injection (CWE-89): The application is vulnerable to SQL injection due to unsanitized user input being directly incorporated into SQL queries. Specifically, the `$_POST["U"]`, `$_POST["M"]` and `$_POST["P"]` parameters are used without proper sanitization in the INSERT query.

**Impact of exploitation:**
Successful exploitation of this vulnerability could allow an attacker to:
- Manipulate the database
- Bypass authentication
- Gain unauthorized access to sensitive data
- Modify/delete data

**Attack vectors:**
- The attack vector is through the `register.php` page, where an attacker can provide malicious input in the username, email, or password fields.

**Required attacker capabilities/position:**
- The attacker needs to be able to access the registration page and submit arbitrary data through POST requests.

**Additional details:**
- The vulnerable code is present in the `register.php` file before the fix. Specifically, the `INSERT INTO User` query uses string concatenation and direct variables instead of prepared statements or parameterized queries.
- The fix (commit `21e8bfd7a9ab0b7f9344a7a3a7c32a7cdd5a0b69`) implements `mysqli::real_escape_string` to sanitize the input before using it in the query.
- The vulnerability was found by P0cas.