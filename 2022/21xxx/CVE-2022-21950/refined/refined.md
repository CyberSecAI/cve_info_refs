```
{
  "vulnerability_details": {
    "root_cause": "The canna systemd service uses a publicly accessible directory `/tmp/.iroha_unix` for placing a UNIX domain socket. The service attempts to create this directory on startup but tolerates if it already exists and does not perform permission checks. Additionally, the service cleans up the directory before and after execution, creating a window of opportunity for attackers to create a malicious directory.",
    "weaknesses": [
      "Insecure default socket directory location in `/tmp`",
      "Lack of permission checks on the socket directory",
      "Time-of-check-time-of-use (TOCTOU) race condition due to directory removal and recreation",
       "Use of world-writable /tmp directory for socket storage"
    ],
    "impact": "A local attacker can create a world-writable directory at `/tmp/.iroha_unix` before the `cannaserver` service starts, causing the service to place its socket in this unsafe directory. The attacker can then intercept client connections, receiving input data and returning manipulated data via a fake socket.",
    "attack_vectors": "Local access to the system is required. An attacker must be able to create a directory in `/tmp` before the `cannaserver` service does and place a malicious socket within the directory.",
     "required_capabilities": "Attacker requires local access to the system and the ability to create directories/files in /tmp. They also need to be able to monitor the removal of /tmp/.iroha_unix via inotify or similar mechanism to perform the attack during the window where the directory is removed by canna service. The attacker needs also be able to create and use unix sockets."
  }
}
```