=== Content from github.com_014fcbe7_20250114_192744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare%2Freleases%2Ftag%2Fv2.5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare%2Freleases%2Ftag%2Fv2.5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=onionshare%2Fonionshare)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onionshare](/onionshare)
/
**[onionshare](/onionshare/onionshare)**
Public

* [Notifications](/login?return_to=%2Fonionshare%2Fonionshare) You must be signed in to change notification settings
* [Fork
  658](/login?return_to=%2Fonionshare%2Fonionshare)
* [Star
   6.4k](/login?return_to=%2Fonionshare%2Fonionshare)

* [Code](/onionshare/onionshare/tree/v2.5)
* [Issues
  127](/onionshare/onionshare/issues)
* [Pull requests
  17](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

Additional navigation options

* [Code](/onionshare/onionshare/tree/v2.5)
* [Issues](/onionshare/onionshare/issues)
* [Pull requests](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

1. [Releases](/onionshare/onionshare/releases)
2. [v2.5](/onionshare/onionshare/releases/tag/v2.5)

# OnionShare 2.5

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/onionshare/onionshare/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.5)

 Loading

[View all tags](/onionshare/onionshare/tags)

![@micahflee](https://avatars.githubusercontent.com/u/156128?s=40&v=4)
[micahflee](/micahflee)
released this
17 Jan 22:46

[v2.5](/onionshare/onionshare/tree/v2.5)

This tag was signed with the committerâ€™s **verified signature**.

[![](https://avatars.githubusercontent.com/u/156128?s=64&v=4)](/micahflee)
[micahflee](/micahflee)
Micah Lee

GPG key ID: 403C2657CD994F73

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`1385aa0`](/onionshare/onionshare/commit/1385aa068f1ef41f67a0cee4eff61bc126346d4e)

This commit was signed with the committerâ€™s **verified signature**.

[![](https://avatars.githubusercontent.com/u/156128?s=64&v=4)](/micahflee)
[micahflee](/micahflee)
Micah Lee

GPG key ID: 403C2657CD994F73

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

What's new:

* Security fix: Sanitize the path parameter in History item widget to be plain text
* Security fix: Use microseconds in Receive mode directory creation to avoid potential DoS
* Security fix: Several hardening improvements for session and username management in Chat mode, to prevent impersonation and other issues
* Major feature: Obtain bridges from Moat / BridgeDB (over a domain-fronted Meek client)
* Major feature: Snowflake bridge support
* New feature: Tor connection settings, as well as general settings, are now Tabs rather than dialogs
* New feature: User can customize the Content-Security-Policy header in Website mode
* New feature: Built-in bridges are automatically updated from Tor's API when the user has chosen to use them
* Switch to using our `stem` fork called `cepa`, which is now published on PyPi so we can build it in releases
* Various bug fixes

 Assets
12

 Loading

 ðŸ‘
7
 boldrake60, RomelSan, Baccount, NuggaN85, ZeroDot1, SilmorSenedlen, and ivan-bryliant reacted with thumbs up emoji
 ðŸŽ‰
4
 danrobi11, RooneyMcNibNug, Baccount, and ZeroDot1 reacted with hooray emoji

All reactions

* ðŸ‘
  7 reactions
* ðŸŽ‰
  4 reactions

 9 people reacted

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_c12e2946_20250114_192744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare%2Fsecurity%2Fadvisories%2FGHSA-w9m4-7w72-r766)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare%2Fsecurity%2Fadvisories%2FGHSA-w9m4-7w72-r766)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=onionshare%2Fonionshare)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onionshare](/onionshare)
/
**[onionshare](/onionshare/onionshare)**
Public

* [Notifications](/login?return_to=%2Fonionshare%2Fonionshare) You must be signed in to change notification settings
* [Fork
  658](/login?return_to=%2Fonionshare%2Fonionshare)
* [Star
   6.4k](/login?return_to=%2Fonionshare%2Fonionshare)

* [Code](/onionshare/onionshare)
* [Issues
  127](/onionshare/onionshare/issues)
* [Pull requests
  17](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

Additional navigation options

* [Code](/onionshare/onionshare)
* [Issues](/onionshare/onionshare/issues)
* [Pull requests](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

# OTF-004: Improper Access Control: Chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom

Moderate

[micahflee](/micahflee)
published
GHSA-w9m4-7w72-r766
Jan 18, 2022

## Package

OnionShare
(OnionShare)

## Affected versions

>= 2.3

## Patched versions

2.5

## Description

Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.

* Vulnerability ID: OTF-004
* Vulnerability type: Improper Access Control
* Threat level: Moderate

## Description:

Chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.

## Technical description:

[![otf-004-a](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)

[![otf-004-b](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)

[![otf-004-c](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)

This series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.

This can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.

This results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.

## Impact:

An adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).

## Recommendation:

* Implement proper session handling

### Severity

Moderate

### CVE ID

CVE-2022-21691

### Weaknesses

No CWEs

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


