The provided content describes a Cross-Site Scripting (XSS) vulnerability in `s-cart/core` and `s-cart/s-cart` packages, both versions less than 6.9, and is related to CVE-2022-21149.

**Root cause of vulnerability:**
The application does not properly sanitize user input, specifically in the "Name" field when editing a user role, allowing an attacker to inject malicious code that is then executed in the browser of any user visiting certain admin pages.

**Weaknesses/vulnerabilities present:**
- Cross-site Scripting (XSS) vulnerability (CWE-79) due to lack of input sanitization/validation when setting roles.

**Impact of exploitation:**
- Cookie stealing, allowing attackers to gain unauthorized access to user accounts.
- Exposure of sensitive information, access to privileged services, and potential delivery of malware.

**Attack vectors:**
- An attacker, with admin access, injects malicious JavaScript code into the "Name" field when creating/editing a user role within the application's admin panel.
- The injected malicious code is stored within the application.
- When a user visits specific admin pages (`/sc_admin/user`, `/sc_admin/role`, `/sc_admin/permission`, `/sc_admin/checkip`), the stored malicious JavaScript is executed in their browser.

**Required attacker capabilities/position:**
- The attacker needs to have administrative access to the application.
- The attacker needs to access the system configuration, user permissions section to edit roles.
- The attacker needs to insert the XSS payload into the name field.
- The victim needs to visit the affected URLs for the XSS to be executed.