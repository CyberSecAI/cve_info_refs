Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2022-21644

**Root Cause:**
The vulnerability is due to a lack of proper input sanitization in the `usersearch.php` file. Specifically, the code directly incorporates user-supplied input from the `Name` and `Mail` GET parameters into SQL queries without proper escaping.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection (CWE-89):** The primary vulnerability is SQL injection. The code constructs SQL queries by directly concatenating user-supplied input from the `$_GET["Name"]` and `$_GET["Mail"]` parameters into the SQL query strings. This allows an attacker to inject arbitrary SQL code.
- Missing input validation and sanitization using `mysqli::real_escape_string()`.

**Impact of Exploitation:**
An attacker could potentially:
- Extract sensitive data from the database (e.g., user credentials).
- Modify or delete data in the database.
- Potentially gain unauthorized access to the system, depending on database permissions.
- Bypass authentication mechanisms

**Attack Vectors:**
- By crafting malicious URLs with crafted GET parameters for `Name` and `Mail`

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to access the `usersearch.php` page and modify URL GET parameters.
- The attacker must have administrative access to the vulnerable application to reach the affected `usersearch.php` page

**Additional details:**
- The vulnerability is considered "moderate" in severity because the `usersearch.php` file is typically only accessible to administrators.
- The provided code diff shows the fix implemented by using `mysqli_real_escape_string()` to sanitize the user-supplied input before incorporating it into the SQL queries.
- Affected versions are `<Pb1.0Bfx0` and patched versions are `Pb2.4Bfx2`.