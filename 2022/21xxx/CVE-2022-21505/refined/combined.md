=== Content from git.kernel.org_58fee259_20250114_184608.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Snowberg <eric.snowberg@oracle.com> | 2022-07-20 12:40:27 -0400 |
| --- | --- | --- |
| committer | Linus Torvalds <torvalds@linux-foundation.org> | 2022-07-20 09:56:48 -0700 |
| commit | [543ce63b664e2c2f9533d089a4664b559c3e6b5b](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)) | |
| tree | [10307928e7147906245d273f5f33e640c66d0cbe](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b) | |
| parent | [ca85855bdcae8f84f1512e88b4c75009ea17ea2f](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ca85855bdcae8f84f1512e88b4c75009ea17ea2f) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b&id2=ca85855bdcae8f84f1512e88b4c75009ea17ea2f)) | |
| download | [linux-543ce63b664e2c2f9533d089a4664b559c3e6b5b.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-543ce63b664e2c2f9533d089a4664b559c3e6b5b.tar.gz) | |

lockdown: Fix kexec lockdown bypass with ima policyThe lockdown LSM is primarily used in conjunction with UEFI Secure Boot.
This LSM may also be used on machines without UEFI. It can also be
enabled when UEFI Secure Boot is disabled. One of lockdown's features
is to prevent kexec from loading untrusted kernels. Lockdown can be
enabled through a bootparam or after the kernel has booted through
securityfs.
If IMA appraisal is used with the "ima\_appraise=log" boot param,
lockdown can be defeated with kexec on any machine when Secure Boot is
disabled or unavailable. IMA prevents setting "ima\_appraise=log" from
the boot param when Secure Boot is enabled, but this does not cover
cases where lockdown is used without Secure Boot.
To defeat lockdown, boot without Secure Boot and add ima\_appraise=log to
the kernel command line; then:
$ echo "integrity" > /sys/kernel/security/lockdown
$ echo "appraise func=KEXEC\_KERNEL\_CHECK appraise\_type=imasig" > \
/sys/kernel/security/ima/policy
$ kexec -ls unsigned-kernel
Add a call to verify ima appraisal is set to "enforce" whenever lockdown
is enabled. This fixes CVE-2022-21505.
Cc: stable@vger.kernel.org
Fixes: 29d3c1c8dfe7 ("kexec: Allow kexec\_file() with appropriate IMA policy when locked down")
Signed-off-by: Eric Snowberg <eric.snowberg@oracle.com>
Acked-by: Mimi Zohar <zohar@linux.ibm.com>
Reviewed-by: John Haxby <john.haxby@oracle.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)

| -rw-r--r-- | [security/integrity/ima/ima\_policy.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/security/integrity/ima/ima_policy.c?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/security/integrity/ima/ima\_policy.c b/security/integrity/ima/ima\_policy.cindex 73917413365b3c..a8802b8da946bf 100644--- a/[security/integrity/ima/ima\_policy.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/security/integrity/ima/ima_policy.c?id=ca85855bdcae8f84f1512e88b4c75009ea17ea2f)+++ b/[security/integrity/ima/ima\_policy.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/security/integrity/ima/ima_policy.c?id=543ce63b664e2c2f9533d089a4664b559c3e6b5b)@@ -2247,6 +2247,10 @@ bool ima\_appraise\_signature(enum kernel\_read\_file\_id id) if (id >= READING\_MAX\_ID) return false; + if (id == READING\_KEXEC\_IMAGE && !(ima\_appraise & IMA\_APPRAISE\_ENFORCE)+ && security\_locked\_down(LOCKDOWN\_KEXEC))+ return false;+ func = read\_idmap[id] ?: FILE\_CHECK;  rcu\_read\_lock(); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:44:45 +0000



=== Content from linux.oracle.com_bb982374_20250114_184608.html ===

[Oracle](https://oracle.com "Oracle")

* [ULN](https://linux.oracle.com)
* [Support](https://www.oracle.com/us/technologies/linux/support/overview/)
* [Documentation](https://www.oracle.com/technetwork/server-storage/linux/documentation/)
* [Downloads](https://www.oracle.com/technetwork/server-storage/linux/downloads/index.html)

#### Stay Connected:

* [Facebook](https://www.facebook.com/oraclelinux "Facebook")
* [Twitter](https://www.twitter.com/OracleLinux "Twitter")
* [LinkedIn](https://www.linkedin.com/groups?gid=120238 "LinkedIn")
* [YouTube](https://www.youtube.com/oraclelinuxchannel "YouTube")
* [Blog](https://blogs.oracle.com/linux "Blog")

![](https://yum.oracle.com/layout/i/mc07v4-banner-grey.jpg)
# CVE-2022-21505

* [ULN](https://linux.oracle.com) >
* [Oracle Linux CVE repository](https://linux.oracle.com/cve)  >
* CVE-2022-21505

## CVE Details

| **Release Date:** | 2023-05-12 |
| --- | --- |

## Description

\*\* RESERVED \*\* This candidate has been reserved by an organization or individual that will use it when announcing a new security problem. When the candidate has been publicized, the details for this candidate will be provided.

See more information about CVE-2022-21505 from [MITRE CVE dictionary](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21505) and [NIST NVD](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-21505)

## CVSS v3.0 metrics

**NOTE:** The following CVSS v3.0 metrics and score provided are preliminary and subject to review.

| **Base Score:** |  | **Base Metrics:** |  |
| --- | --- | --- | --- |
| **Access Vector:** | Undefined | **Attack Complexity:** | Undefined |
| **Privileges Required:** | None | **User Interaction:** | None |
| **Scope:** | Unchanged | **Confidentiality Impact:** | Undefined |
| **Integrity Impact:** | Undefined | **Availability Impact:** | Undefined |

## Errata information

| **Platform** **Errata** | **Release Date** | |
| --- | --- | --- |
| Oracle Linux version 7 (kernel-uek) | [ELSA-2022-9609](https://linux.oracle.com/errata/ELSA-2022-9609.html) | 2022-07-19 |
| Oracle Linux version 7 (kernel-uek) | [ELSA-2022-9709](https://linux.oracle.com/errata/ELSA-2022-9709.html) | 2022-08-15 |
| Oracle Linux version 7 (kernel-uek-container) | [ELSA-2022-9612](https://linux.oracle.com/errata/ELSA-2022-9612.html) | 2022-07-19 |
| Oracle Linux version 7 (kernel-uek-container) | [ELSA-2022-9710](https://linux.oracle.com/errata/ELSA-2022-9710.html) | 2022-08-15 |
| Oracle Linux version 8 (kernel-uek) | [ELSA-2022-9601](https://linux.oracle.com/errata/ELSA-2022-9601.html) | 2022-07-19 |
| Oracle Linux version 8 (kernel-uek) | [ELSA-2022-9609](https://linux.oracle.com/errata/ELSA-2022-9609.html) | 2022-07-19 |
| Oracle Linux version 8 (kernel-uek) | [ELSA-2022-9709](https://linux.oracle.com/errata/ELSA-2022-9709.html) | 2022-08-15 |
| Oracle Linux version 8 (kernel-uek-container) | [ELSA-2022-9602](https://linux.oracle.com/errata/ELSA-2022-9602.html) | 2022-07-19 |
| Oracle Linux version 8 (kernel-uek-container) | [ELSA-2022-9612](https://linux.oracle.com/errata/ELSA-2022-9612.html) | 2022-07-19 |
| Oracle Linux version 8 (kernel-uek-container) | [ELSA-2022-9710](https://linux.oracle.com/errata/ELSA-2022-9710.html) | 2022-08-15 |
| Oracle Linux version 9 (kernel) | [ELSA-2023-2458](https://linux.oracle.com/errata/ELSA-2023-2458.html) | 2023-05-15 |
| Oracle Linux version 9 (kernel-uek) | [ELSA-2022-9601](https://linux.oracle.com/errata/ELSA-2022-9601.html) | 2022-07-19 |

This page is generated automatically and has not been checked for errors or omissions. For clarification
or corrections please contact the [Oracle Linux ULN team](https://linux.oracle.com/)

## Technical information

* [Oracle Linux Certified Hardware](https://linux.oracle.com/hardware-certifications)
* [Oracle Linux Supported Releases](https://www.oracle.com/us/support/library/elsp-lifetime-069338.pdf)

## Oracle Linux Support

* [Oracle Linux Support](https://www.oracle.com/us/technologies/linux/OracleLinuxSupport/index.html)
* [Oracle Premier Support for Systems](https://www.oracle.com/us/support/premier/servers-storage/overview/index.html)
* [Advanced Customer Services](https://www.oracle.com/us/support/advanced-customer-services/overview/)

## Connect

* [Facebook](https://www.facebook.com/oraclelinux "Facebook")
* [Twitter](https://www.twitter.com/OracleLinux "Twitter")
* [LinkedIn](https://www.linkedin.com/groups?gid=120238 "LinkedIn")
* [YouTube](https://www.youtube.com/oraclelinuxchannel "YouTube")
* [Blog](https://blogs.oracle.com/linux "Blog")

## Contact Us

* [Global contacts](https://www.oracle.com/us/corporate/contact/global-070511.html)
* Oracle 1-800-633-0691

[![software.hardware.complete](//www.oracleimg.com/assets/mc04-footer-logo.png)](https://oracle.com)

[Subscribe](https://www.oracle.com/subscribe/index.html) | [Careers](https://www.oracle.com/corporate/employment/index.html) | [Contact Us](https://www.oracle.com/corporate/contact/index.html) | [Legal Notices](https://www.oracle.com/html/copyright.html) | [Terms of Use](https://www.oracle.com/html/terms.html) | [Your Privacy Rights](https://www.oracle.com/html/privacy.html)


