```json
{
  "cve": "CVE-2022-20943",
  "description": "Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device.\n\nThese vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition.\n\nNote: When the snort preserve-connection option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The snort preserve-connection setting is enabled by default. See the Details section of this advisory for more information.\n\nNote: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.",
  "impact": "A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition, or, if preserve connection is enabled, to bypass configured policies and deliver malicious payload.",
  "attack_vector": "An unauthenticated, remote attacker could exploit this vulnerability by sending a high rate of certain types of SMB2 packets through an affected device.",
  "weaknesses": [
    "Improper management of system resources when the Snort detection engine is processing SMB2 traffic."
  ],
  "root_cause": "The vulnerability is due to improper management of system resources when the Snort detection engine is processing SMB2 traffic.",
  "required_capabilities": "An unauthenticated, remote attacker with the ability to send crafted SMB2 packets.",
  "additional_information": {
    "snort_preserve_connection_enabled_impact": "When the snort preserve-connection option is enabled for the Snort detection engine, existing traffic flow are not dropped when the Snort process goes down. Instead, existing traffic flows bypass the Snort detection engine. A successful exploit could allow an attacker to bypass the configured policies and deliver a malicious payload to the protected network. Traffic flows that begin while the Snort process is down are dropped, resulting in a DoS condition.",
    "snort_preserve_connection_disabled_impact": "When the snort preserve-connection option is disabled for the Snort detection engine, existing traffic flows are dropped. A successful exploit could result in a DoS condition. Traffic flows that begin while the Snort process is down are also dropped, resulting in a DoS condition.",
    "affected_products": [
      "Cyber Vision",
      "FirePOWER Services - All platforms",
      "Firepower Threat Defense (FTD) Software - All platforms",
      "Meraki MX Security Appliances",
       "Umbrella Secure Internet Gateway (SIG)"
    ],
        "not_affected_products": [
            "Cisco 1000 Series Integrated Services Routers (ISRs)",
            "Cisco 4000 Series Integrated Services Routers (ISRs)",
            "Cisco Adaptive Security Appliance (ASA) Software",
            "Cisco Catalyst 8000V Edge Software",
            "Cisco Catalyst 8200 Series Edge Platforms",
            "Cisco Catalyst 8300 Series Edge Platforms",
            "Cisco Catalyst 8500 Series Edge Platforms",
             "Cisco Catalyst 8500L Series Edge Platforms",
            "Cisco Cloud Services Routers 1000V",
            "Cisco Firepower Management Center (FMC) Software",
             "Cisco Meraki MX64 and MX64w Appliances",
            "Cisco Meraki MX65 and MX65w Appliances",
            "Cisco Integrated Services Virtual Routers (ISRv)",
             "Open Source Snort 2"
    ]
  }
}
```