```
{
  "vulnerability": {
    "root_cause": "The vulnerability is due to a potential race condition in the `stealReceiveChannel` function within the `SurfaceFlinger` component.",
    "weaknesses": [
      "Race condition"
    ],
    "impact": "A malicious application could potentially exploit this race condition to perform UI spoofing or spy on user activities.",
    "attack_vectors": [
      "Local application"
    ],
    "required_capabilities": "A malicious application installed on the device."
  },
  "fixes": [
    {
      "commit": "https://android.googlesource.com/platform/frameworks/native/%2B/a49c413aee3f89aa68963f67fb144355608e12c6",
      "description": "A mutex was added to prevent the race condition in `stealReceiveChannel`."
    },
      {
      "commit": "https://android.googlesource.com/platform/frameworks/native/%2B/899e8cd0749cb3f43bef0bdb28002edab42bbb1b",
      "description": "Cherry-picked fix for SurfaceFlinger race condition"
    }
  ],
  "cve": "CVE-2022-20344"
}
```