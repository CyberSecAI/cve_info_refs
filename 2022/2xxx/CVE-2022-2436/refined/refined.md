```
{
  "vulnerability": {
    "CVE": "CVE-2022-2436",
    "description": "The Download Manager plugin for WordPress is vulnerable to deserialization of untrusted input via the 'file[package_dir]' parameter in versions up to, and including 3.2.49. This makes it possible for authenticated attackers with contributor privileges and above to call files using a PHAR wrapper that will deserialize the data and call arbitrary PHP Objects that can be used to perform a variety of malicious actions granted a POP chain is also present. It also requires that the attacker is successful in uploading a file with the serialized payload.",
    "root_cause": "The vulnerability is due to the insecure deserialization of user-supplied data. The plugin takes the value of `file[package_dir]` and decrypts it using the `Crypt::decrypt` method. The decrypted value is then processed as a file path. If a PHAR archive with a serialized payload is uploaded to the server, an attacker can craft a specific path that is then decrypted, resulting in the execution of arbitrary PHP code.",
    "vulnerabilities": [
      "Insecure Deserialization",
       "PHAR Deserialization"
    ],
    "impact": "Successful exploitation could lead to arbitrary code execution on the server.",
    "attack_vectors": "The vulnerability is triggered through the  `file[package_dir]` POST parameter during file upload or package update",
    "attacker_capabilities": "An authenticated attacker with contributor privileges or higher can exploit this vulnerability. The attacker also needs to upload a file containing the serialized PHP objects.",
      "references": [
        "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/download-manager/download-manager-3249-authenticated-contributor-phar-deserialization",
        "https://plugins.trac.wordpress.org/browser/download-manager/trunk/src/Admin/Menu/Packages.php#L68",
        "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2761422%40download-manager%2Ftrunk%2Fsrc%2FAdmin%2FMenu%2FPackages.php&new=2761422%40download-manager%2Ftrunk%2Fsrc%2FAdmin%2FMenu%2FPackages.php"
      ]
  }
}
```