=== Content from packetstormsecurity.com_2a69c306_20250114_183103.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.wordfence.com_b27bb8e3_20250114_183106.html ===


![](https://www.wordfence.com/wp-content/uploads/2022/08/High-Severity-Vulnerability-Patched-in-Download-Manager-Plugin.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

August 3, 2022

# High Severity Vulnerability Patched in Download Manager Plugin

On July 8, 2022 the Wordfence Threat Intelligence team initiated the responsible disclosure process for a vulnerability we discovered in “Download Manager,” a WordPress plugin that is installed on over 100,000 sites. This flaw makes it possible for an authenticated attacker to delete arbitrary files hosted on the server, provided they have access to create downloads. If an attacker deletes the wp-config.php file they can gain administrative privileges, including the ability to execute code, by re-running the WordPress install process.

[Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) received a firewall rule on July 8, 2022 to provide protection against any attackers that try to exploit this vulnerability. Wordfence Free users will receive this same protection 30 days later on August 7, 2022.

We attempted to reach out to the developer on July 8, 2022, the same day we discovered the vulnerability. We never received a response so we sent the full details to the WordPress.org plugins team on July 26, 2022. The plugin was fully patched the next day on July 27, 2022.

We strongly recommend ensuring that your site has been updated to the latest patched version of “Download Manager”, which is version 3.2.53 at the time of this publication.

**Description:** Authenticated (Contributor+) Arbitrary File Deletion

**Affected Plugin:** [Download Manager](https://wordpress.org/plugins/download-manager/)

**Plugin Slug:** download-manager

**Plugin Developer:** W3 Eden, Inc.

**Affected Versions:** <= 3.2.50

**CVE ID:** [CVE-2022-2431](https://www.cve.org/CVERecord?id=CVE-2022-2431)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 3.2.51

Download Manager is a popular WordPress plugin designed to allow site content creators to share downloadable files that are stored as posts. These downloads can be displayed on the front-end of the WordPress site for users to download. Unfortunately, vulnerable versions of the plugin contain a bypass in how the downloadable file is stored and subsequently deleted upon post deletion that make it possible for attackers to delete arbitrary files on the server.

More specifically, vulnerable versions of the plugin register the `deleteFiles()` function that is called via the `before_delete_post` hook. This hook is triggered right before a post has been deleted and its intended functionality in this case is to delete any files that may have been uploaded and associated with a “download” post.

At first glance this looks like a relatively safe functionality assuming the originally supplied file path is validated. Unfortunately, however, that is not the case as the path to the file saved with the “download” post is not validated to ensure it was a safe file type or in a location associated with a “download” post. This means that a path to an arbitrary file with any extension can be supplied via the `file[files][]` parameter when saving a post and that would be the file associated with the “download” post. On many configurations an attacker could supply a path such as `/var/www/html/wp-config.php` that would associate the site’s WordPress configuration file with the download post.

```
	    add_action('before_delete_post', array($this, 'deleteFiles'), 10, 2);
```
```
	function deleteFiles($post_id, $post)
	{
		$files = WPDM()->package->getFiles($post_id, false);
		foreach ($files as $file) {
			$file = WPDM()->fileSystem->locateFile($file);
			@unlink($file);
		}
	}
```

When the user goes to permanently delete the “download” post the `deleteFiles()` function will be triggered by the `before_delete_post` hook and the supplied file will be deleted, if it exists.

This can be used by attackers to delete critical files hosted on the server. The `wp-config.php` file in particular is a popular target for attackers as deletion of this file would disconnect the existing database from the compromised site and allow the attacker to re-complete the initial installation process and connect their own database to the site. Once a database is connected, they would have access to the server and could upload arbitrary files to further infect the system.

![](https://www.wordfence.com/wp-content/uploads/2022/08/Download-Manager-Delete-wp-config.gif)

*Demonstrating site reset upon download post deletion.*

This vulnerability requires contributor-level access and above to exploit, so it serves as an important reminder to make sure you don’t provide contributor-level and above access to untrusted users. It’s also important to validate that all users have strong passwords to ensure your site won’t subsequently be compromised as a result of a vulnerability like this due to an unauthorized actor gaining access via a weak or compromised password.

## Timeline

* **July 8, 2022** – Discovery of the Arbitrary File Deletion Vulnerability in the “Download Manager” plugin. A firewall rule is released to [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) users. We attempt to initiate contact with the developer.
* **July 26, 2022** – After no response from the developer, we send the full disclosure details to the WordPress plugins team. They acknowledge the report and make contact with the developer.
* **July 27, 2022**. – A fully patched version of the plugin is released as version 3.2.51.
* **August 7, 2022** – Wordfence free users receive the firewall rule.

## Conclusion

In today’s post, we detailed a flaw in the “Download Manager” plugin that makes it possible for authenticated attackers to delete arbitrary files hosted on an affected server, which could lead to remote code execution and ultimately complete site compromise. This flaw has been fully patched in version 3.2.51.

We recommend that WordPress site owners immediately verify that their site has been updated to the latest patched version available, which is version 3.2.53 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) received a firewall rule on July 8, 2022 to provide protection against any attackers trying to exploit this vulnerability. Wordfence Free users will receive this same protection 30 days later on August 7, 2022.

If you believe your site has been compromised as a result of this vulnerability or any other vulnerability, we offer Incident Response services via [Wordfence Care](https://www.wordfence.com/products/wordfence-care/). If you need your site cleaned immediately, [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) offers the same service with 24/7/365 availability and a 1-hour response time. Both these products include hands-on support in case you need further assistance.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fhigh-severity-vulnerability-patched-in-download-manager-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fhigh-severity-vulnerability-patched-in-download-manager-plugin%2F&text=High%20Severity%20Vulnerability%20Patched%20in%20Download%20Manager%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fhigh-severity-vulnerability-patched-in-download-manager-plugin%2F)

## Comments

4 Comments

* ![](https://secure.gravatar.com/avatar/b4dd21dc5d4d2f20267da9f0e32a878a?s=96&d=mm&r=g)
  Rob
  August 3, 2022
   8:26 am

  How would the attacker be able to run the setup and know the old database details to connect it back up?

+ ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  August 3, 2022
   8:46 am

  Hi Rob, an attacker would be able to supply any database details at that point (during the set-up) and would not require the old database details to get the site back up and running. Essentially they could connect any database to the site, regardless of what was previously connected, and have complete ownership of the installation that could be used to gain access to the server.

- ![](https://secure.gravatar.com/avatar/b4dd21dc5d4d2f20267da9f0e32a878a?s=96&d=mm&r=g)
  Rob
  August 4, 2022
   8:11 am

  Ah I see.

* ![](https://secure.gravatar.com/avatar/85d40876082aa6211205faf90bbac4f0?s=96&d=mm&r=g)
  Franks Ariuas Lopez
  August 3, 2022
   6:54 pm

  Excelente propuesta

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from plugins.trac.wordpress.org_ca391db5_20250114_183105.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2762092%2540download-manager%26old%3D2762092%2540download-manager)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2762084/download-manager "Changeset 2762084 for download-manager")
* [Next Change](/changeset/2762093/download-manager "Changeset 2762093 for download-manager") →

---

# Changeset [2762092](/changeset/2762092 "Show full changeset") for [download-manager](/browser/download-manager?rev=2762092 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/27/2022 03:26:39 AM
([2 years](/timeline?from=2022-07-27T03%3A26%3A39Z&precision=second "See timeline at 07/27/2022 03:26:39 AM") ago)

Author:
codename065
Message:
# 3.2.51 - 2022.07.27

* Revalidated attached file to avoid any blocked file type attachment

Location:
[download-manager/trunk](/browser/download-manager/trunk?rev=2762092)
Files:

4 edited

* [download-manager.php](/browser/download-manager/trunk/download-manager.php?rev=2762092 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [readme.txt](/browser/download-manager/trunk/readme.txt?rev=2762092 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [src/Admin/Menu/Packages.php](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2762092 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [src/AssetManager/AssetManager.php](/browser/download-manager/trunk/src/AssetManager/AssetManager.php?rev=2762092 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [download-manager/trunk/download-manager.php](/changeset/2762092/download-manager/trunk/download-manager.php "Show the changeset 2762092 restricted to download-manager/trunk/download-manager.php")

  | [r2761422](/browser/download-manager/trunk/download-manager.php?rev=2761422#L6 "Show revision 2761422 of this file in browser") | [r2762092](/browser/download-manager/trunk/download-manager.php?rev=2762092#L6 "Show revision 2762092 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: W3 Eden, Inc. |
  | 7 | 7 | Author URI: https://www.wpdownloadmanager.com/ |
  | 8 |  | Version: 3.2.5~~0~~ |
  |  | 8 | Version: 3.2.51 |
  | 9 | 9 | Text Domain: download-manager |
  | 10 | 10 | Domain Path: /languages |
  | […](/browser/download-manager/trunk/download-manager.php?rev=2761422#L40) | […](/browser/download-manager/trunk/download-manager.php?rev=2762092#L40) |  |
  | 40 | 40 | global $WPDM; |
  | 41 | 41 |  |
  | 42 |  | define('WPDM\_VERSION','3.2.5~~0~~'); |
  |  | 42 | define('WPDM\_VERSION','3.2.51'); |
  | 43 | 43 |  |
  | 44 | 44 | define('WPDM\_TEXT\_DOMAIN','download-manager'); |
* ## [download-manager/trunk/readme.txt](/changeset/2762092/download-manager/trunk/readme.txt "Show the changeset 2762092 restricted to download-manager/trunk/readme.txt")

  | [r2761422](/browser/download-manager/trunk/readme.txt?rev=2761422#L6 "Show revision 2761422 of this file in browser") | [r2762092](/browser/download-manager/trunk/readme.txt?rev=2762092#L6 "Show revision 2762092 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.0 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 |  | Stable tag: 3.2.5~~0~~ |
  |  | 8 | Stable tag: 3.2.51 |
  | 9 | 9 |  |
  | 10 | 10 |  |
  | […](/browser/download-manager/trunk/readme.txt?rev=2761422#L182) | […](/browser/download-manager/trunk/readme.txt?rev=2762092#L182) |  |
  | 182 | 182 | == Changelog == |
  | 183 | 183 |  |
  |  | 184 | = 3.2.51 - 2022.07.27 = |
  |  | 185 | \* Revalidated attached file to avoid any blocked file type attachment |
  |  | 186 |  |
  | 184 | 187 | = 3.2.50 - 2022.07.26 = |
  | 185 | 188 | \* Added option to allow/disallow proxy IP, disallowed by default |
* ## [download-manager/trunk/src/Admin/Menu/Packages.php](/changeset/2762092/download-manager/trunk/src/Admin/Menu/Packages.php "Show the changeset 2762092 restricted to download-manager/trunk/src/Admin/Menu/Packages.php")

  | [r2761422](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2761422#L30 "Show revision 2761422 of this file in browser") | [r2762092](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2762092#L30 "Show revision 2762092 of this file in browser") |  |
  | --- | --- | --- |
  | 30 | 30 | add\_action('wp\_ajax\_wpdm\_admin\_upload\_file', array($this, 'uploadFile')); |
  | 31 | 31 | add\_action('save\_post', array($this, 'savePackage')); |
  | 32 |  | ~~add\_action('before\_delete\_post', array($this, 'deleteFiles'), 10, 2);~~ |
  | 33 | 32 |  |
  | 34 | 33 | add\_action('manage\_wpdmpro\_posts\_columns', array($this, 'columnsTH')); |
  | […](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2761422#L71) | […](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2762092#L70) |  |
  | 71 | 70 | foreach ($meta\_value as &$value){ |
  | 72 | 71 | $value = wpdm\_escs($value); |
  |  | 72 | if(WPDM()->fileSystem->isBlocked($value)) $value = ''; |
  | 73 | 73 | } |
  | 74 | 74 | } else if($meta\_key == 'terms\_conditions'){ |
  | […](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2761422#L89) | […](/browser/download-manager/trunk/src/Admin/Menu/Packages.php?rev=2762092#L89) |  |
  | 89 | 89 | do\_action('wpdm\_admin\_update\_package',$post, $\_POST['file']); |
  | 90 | 90 | } |
  | 91 |  |  |
  | 92 |  | ~~function deleteFiles($post\_id, $post)~~ |
  | 93 |  | ~~{~~ |
  | 94 |  | ~~$files = WPDM()->package->getFiles($post\_id, false);~~ |
  | 95 |  | ~~foreach ($files as $file) {~~ |
  | 96 |  | ~~$file = WPDM()->fileSystem->locateFile($file);~~ |
  | 97 |  | ~~@unlink($file);~~ |
  | 98 |  | ~~}~~ |
  | 99 |  | ~~}~~ |
  | 100 | 91 |  |
  | 101 | 92 | function duplicate() |
* ## [download-manager/trunk/src/AssetManager/AssetManager.php](/changeset/2762092/download-manager/trunk/src/AssetManager/AssetManager.php "Show the changeset 2762092 restricted to download-manager/trunk/src/AssetManager/AssetManager.php")

  | [r2651434](/browser/download-manager/trunk/src/AssetManager/AssetManager.php?rev=2651434#L332 "Show revision 2651434 of this file in browser") | [r2762092](/browser/download-manager/trunk/src/AssetManager/AssetManager.php?rev=2762092#L332 "Show revision 2762092 of this file in browser") |  |
  | --- | --- | --- |
  | 332 | 332 | { |
  | 333 | 333 |  |
  | 334 |  | \_\_::isAuthentic('\_\_wpdm\_unlink', WPDMAM\_NONCE\_KEY, ~~WPDM\_ADMIN\_CAP~~, true); |
  |  | 334 | \_\_::isAuthentic('\_\_wpdm\_unlink', WPDMAM\_NONCE\_KEY, 'manage\_options', true); |
  | 335 | 335 |  |
  | 336 | 336 | $relpath = Crypt::decrypt(wpdm\_query\_var('delete')); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2762092)
* [Zip Archive](?format=zip&new=2762092)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


