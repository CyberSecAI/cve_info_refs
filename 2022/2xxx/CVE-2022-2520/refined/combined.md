=== Content from www.debian.org_8316556a_20250115_090854.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DSA 5333-1] tiff security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5333-1] tiff security update
* *From*: Aron Xu <aron@debian.org>
* *Date*: Sun, 29 Jan 2023 12:55:02 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1pM7D4-001XO9-D9%40seger.debian.org)Â [E1pM7D4-001XO9-D9@seger.debian.org](msg00021.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5333-1                   security@debian.org
<https://www.debian.org/security/>                                  Aron Xu
January 29, 2023                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : tiff
CVE ID         : CVE-2022-1354 CVE-2022-1355 CVE-2022-1622 CVE-2022-1623
                 CVE-2022-2056 CVE-2022-2057 CVE-2022-2058 CVE-2022-2519
                 CVE-2022-2520 CVE-2022-2521 CVE-2022-2867 CVE-2022-2868
                 CVE-2022-2869 CVE-2022-2953 CVE-2022-3570 CVE-2022-3597
                 CVE-2022-3599 CVE-2022-3627 CVE-2022-3636 CVE-2022-34526
                 CVE-2022-48281
Debian Bug     : 1011160 1014494 1022555 1024737 1029653

Several buffer overflow, divide by zero or out of bounds read/write
vulnerabilities were discovered in tiff, the Tag Image File Format (TIFF)
library and tools, which may cause denial of service when processing a
crafted TIFF image.

For the stable distribution (bullseye), these problems have been fixed in
version 4.2.0-1+deb11u3.

We recommend that you upgrade your tiff packages.

For the detailed security status of tiff please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tiff>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEhhz+aYQl/Bp4OTA7O1LKKgqv2VQFAmPWbCMACgkQO1LKKgqv
2VSytwgAhwPmD658VKUyf76i4kD+dO2fioMClzNZNZgXz9CxWPn18j67dphNDQkx
K3b/Vd9n/FMnmi7hApNdUtEXdorq0355UIT4tI6IMxuywEdAou4vCl83KXx7a6xR
Hgzap+e+fRma3TS3NvlrvnXm02RMvULEo/QVs2/5B/cxmaPDEFpKzwXoQwO87Ozi
fK7W6LkH6GqhC/cgGoIFjR8n9EBVY6BBzgbardsrxVElspQNrfeKg1O5L7Y26ql9
bp8YwMpEfSPxX69u/75xGiT3fQpMiGsLUEUAOrGynZH1jtyTPPzGDMd+VG1S8fQU
vZ+ZLnm2nAHBx+1YaGZNBcW8ocY2jA==
=NMoP
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_9cf2b1f2_20250115_090853.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# tiffcrop: -S option mutually exclusive (fixes [#349](/libtiff/libtiff/-/issues/349 "heap-buffer-overflow /home/lin/libtiff/tools/tiffcrop.c:6841:16 in extractImageSection"), [#414](/libtiff/libtiff/-/issues/414 "tiffcrop: heap-buffer-overflow in extractImageSection, tiffcrop.c:6905"), [#422](/libtiff/libtiff/-/issues/422 "tiffcrop: free invalid pointer in TIFFClose() at tif_close.c:131 called by tiffcrop.c:2522"), [#423](/libtiff/libtiff/-/issues/423 "tiffcrop: double free or corruption in rotateImage() at tiffcrop.c:8839"), [#424](/libtiff/libtiff/-/issues/424 "tiffcrop: sysmalloc assertion in rotateImage() at tiffcrop.c:8621"))

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/libtiff/libtiff/-/merge_requests/378.patch)
* [Plain diff](/libtiff/libtiff/-/merge_requests/378.diff)

[Su Laus](/Su_Laus) requested to merge  [Su\_Laus/libtiff:tiffcrop\_S-option\_mutually\_exclusive](/Su_Laus/libtiff/-/tree/tiffcrop_S-option_mutually_exclusive "Su_Laus/libtiff:tiffcrop_S-option_mutually_exclusive")
 into [master](/libtiff/libtiff/-/tree/master "master") Aug 15, 2022

* [Overview
  2](/libtiff/libtiff/-/merge_requests/378)
* [Commits
  2](/libtiff/libtiff/-/merge_requests/378/commits)
* [Pipelines
  2](/libtiff/libtiff/-/merge_requests/378/pipelines)
* [Changes
  1](/libtiff/libtiff/-/merge_requests/378/diffs)

Expand

According to Richard Nolde [#401 (comment 877637400)](https://gitlab.com/libtiff/libtiff/-/issues/401#note_877637400 "tiffcrop:  -S option probably does not work properly") the tiffcrop option â€ž-Sâ€œ is also mutually exclusive to the other crop options (-X|-Y), -Z and -z.

This is now checked and ends tiffcrop if those arguments are not mutually exclusive.

This MR will fix the following tiffcrop issues: [#349 (closed)](/libtiff/libtiff/-/issues/349 "heap-buffer-overflow /home/lin/libtiff/tools/tiffcrop.c:6841:16 in extractImageSection"), [#414 (closed)](/libtiff/libtiff/-/issues/414 "tiffcrop: heap-buffer-overflow in extractImageSection, tiffcrop.c:6905"), [#422 (closed)](/libtiff/libtiff/-/issues/422 "tiffcrop: free invalid pointer in TIFFClose() at tif_close.c:131 called by tiffcrop.c:2522"), [#423 (closed)](/libtiff/libtiff/-/issues/423 "tiffcrop: double free or corruption in rotateImage() at tiffcrop.c:8839"), [#424 (closed)](/libtiff/libtiff/-/issues/424 "tiffcrop: sysmalloc assertion in rotateImage() at tiffcrop.c:8621")

## Merge request reports

Assignee
Loading

Reviewers
Loading

Select reviewersRequest review fromLoading

Time tracking
Loading

Loading



=== Content from gitlab.com_fd5e590a_20250115_090852.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# tiffcrop: sysmalloc assertion in rotateImage() at tiffcrop.c:8621

**Summary**

There is a sysmalloc assertion in rotateImage() at tiffcrop.c:8621

`8621: if (!(rbuff = (unsigned char *)limitMalloc(buffsize)))`

**Version**

```
root@peng:~/libtiff-v4.4.0rc1# tools/.libs/tiffcrop -v
Library Release: LIBTIFF, Version 4.4.0
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.
Tiffcrop version: 2.5, last updated: 02-09-2022
```

**Steps to reproduce**

```
./autogen.sh
./configure
make -j
root@peng:~/libtiff-v4.4.0rc1# gdb --args tools/.libs/tiffcrop -Z 1:4,3:3 -R 90 -H 300 -S 2:2 -i poc3 /tmp/foo
TIFFFillStrip: Read error on strip 20; got 18446744073708357672 bytes, expected 7304.
tiffcrop: malloc.c:2401: sysmalloc: Assertion `(old_top == initial_top (av) && old_size == 0) || ((unsigned long) (old_size) >= MINSIZE && prev_inuse (old_top) && ((unsigned long) old_end & (pagesize - 1)) == 0)' failed.

Program received signal SIGABRT, Aborted.
__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
(gdb) bt
#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
#1  0x00007ffff77a17f1 in __GI_abort () at abort.c:79
#2  0x00007ffff77f4af1 in __malloc_assert (file=<optimized out>, function=<optimized out>, line=<optimized out>, assertion=<optimized out>) at malloc.c:298
#3  sysmalloc (nb=nb@entry=87680, av=av@entry=0x7ffff7b4cc40 <main_arena>) at malloc.c:2398
#4  0x00007ffff77f6060 in _int_malloc (av=av@entry=0x7ffff7b4cc40 <main_arena>, bytes=bytes@entry=87660) at malloc.c:4135
#5  0x00007ffff77f80ac in __GI___libc_malloc (bytes=87660) at malloc.c:3067
#6  0x000055555555baa6 in rotateImage (rotation=<optimized out>, image=0x7fffffff88a0, img_width=0x7fffffff8b88, img_length=0x7fffffff8b8c, ibuff_ptr=0x7fffffff88c0)
    at tiffcrop.c:8621
#7  0x00005555555568f6 in processCropSelections (read_buff_ptr=0x7fffffff8890, seg_buffs=0x7fffffff8950, crop=0x7fffffff8b50, image=0x7fffffff88a0) at tiffcrop.c:7671
#8  main (argc=<optimized out>, argv=0x7fffffffe348) at tiffcrop.c:2415
```

**Platform**

uname -a
Linux peng 5.4.0-42-generic 18.04.1-Ubuntu SMP Fri Jul 10 07:21:24 UTC 2020 x86\_64 x86\_64 x86\_64 GNU/Linux

[poc3](/-/project/4720790/uploads/03bdee56a45bbab1bd863a078d9707bc/poc3)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


