=== Content from security.gentoo.org_cece4576_20250114_194315.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# schroot: Denial of Service — GLSA **202210-11**

A vulnerability has been discovered in schroot which could result in denial of service of the schroot service.

### Affected packages

| Package | **dev-util/schroot** on all architectures |
| --- | --- |
| Affected versions | < **1.6.13\_p2** |
| Unaffected versions | >= **1.6.13\_p2** |

### Background

schroot is a utility to execute commands in a chroot environment.

### Description

schroot is unecessarily permissive in rules regarding chroot and session names.

### Impact

A crafted chroot or session name can break the internal state of the schroot service, leading to denial of service.

### Workaround

There is no known workaround at this time.

### Resolution

All schroot users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-util/schroot-1.6.13"

```
### References

* [CVE-2022-2787](https://nvd.nist.gov/vuln/detail/CVE-2022-2787)

**Release date**

October 31, 2022

**Latest revision**

October 31, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [867016](https://bugs.gentoo.org/show_bug.cgi?id=867016)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from codeberg.org_f4685f2a_20250114_194314.html ===

This website requires JavaScript.
[![](https://design.codeberg.org/logo-kit/icon_inverted.svg)](/)

[Explore](/explore/repos)
[About](https://docs.codeberg.org/getting-started/what-is-codeberg/#what-is-codeberg-e.v.%3F)
[FAQ](https://docs.codeberg.org/getting-started/faq/)
[Help](https://docs.codeberg.org)
[Donate](https://donate.codeberg.org)

[Register](/user/cbrgp/IkPVBUy)
[Sign in](/user/login?redirect_to=%2fshelter%2freschroot%2fcommit%2f6f7166a285e1e97aea390be633591f9791b29a6d)

[shelter](/shelter)/[reschroot](/shelter/reschroot)

Watch

[3](/shelter/reschroot/watchers)

Star

[5](/shelter/reschroot/stars)

Fork
You've already forked reschroot

[6](/shelter/reschroot/forks)

[Code](/shelter/reschroot)
[Issues
4](/shelter/reschroot/issues)
[Pull requests
4](/shelter/reschroot/pulls)
[Projects](/shelter/reschroot/projects)
[Releases
2](/shelter/reschroot/releases)
[Wiki](/shelter/reschroot/wiki)
[Activity](/shelter/reschroot/activity)

### Have stricter rules on chroot names [CVE-2022-2787]

[Browse source](/shelter/reschroot/src/commit/6f7166a285e1e97aea390be633591f9791b29a6d)

```
Commit [8c1c9370](/shelter/reschroot/commit/8c1c9370) ("sbuild::chroot_config: Replace is_valid_filename with
is_valid_sessionname") introduced a very broad rule on the name of a
chroot or session name. As it turned out, some of the allowed characters
would break schroot's internal state, or would make the setup croak in
various backends.

This change limits the set of allowed characters to what seems to be
safe: Letters and digits, and in all but the first place, the characters
dot ('.'), dash ('-'), and underscore ('_').

Special thanks to Julian Gilbey <jdg@debian.org> for reporting the issue
and providing additional insights about the severity.
```
...

This commit is contained in:

![](/assets/img/avatar_default.png "debian.axhn@manchmal.in-ulm.de")
parent
[3864e3858a](/shelter/reschroot/commit/3864e3858a8be02ef56742c23e67023f38894903)

commit
6f7166a285

 **3 changed files** with **46 additions** and **34 deletions**

[Show all changes](?style=unified&whitespace=show-all&show-outdated=)
[Ignore whitespace when comparing lines](?style=unified&whitespace=ignore-all&show-outdated=)
[Ignore changes in amount of whitespace](?style=unified&whitespace=ignore-change&show-outdated=)
[Ignore changes in whitespace at EOL](?style=unified&whitespace=ignore-eol&show-outdated=)

Show stats
[Download patch file](/shelter/reschroot/commit/6f7166a285e1e97aea390be633591f9791b29a6d.patch)
[Download diff file](/shelter/reschroot/commit/6f7166a285e1e97aea390be633591f9791b29a6d.diff)
Expand all files
Collapse all files

#### 33 [NEWS](#diff-9f621eb5fd3bcb2fa5c7bd228c9b1ad42edc46c8 "NEWS") Unescape Escape [View file](/shelter/reschroot/src/commit/6f7166a285e1e97aea390be633591f9791b29a6d/NEWS)

|  | |  |  | `@ -9,7 +9,38 @@ configuration.` |
|  |  |  |  |  |
|  |  |  |  | `* Major changes in 1.6.13:` |
|  |  |  |  |  |
|  |  |  |  | `1)` |
|  |  |  |  | `1) The rule on allowed characters in a chroot or session is a lot` |
|  |  |  |  | `stricter now. This is required to address CVE-2022-2787.` |
|  |  |  |  |  |
|  |  |  |  | `Before upgrading, you should check the output of` |
|  |  |  |  |  |
|  |  |  |  | `schroot --list --all | LC_ALL=C grep -vE '^[a-z]+:[a-zA-Z0-9][a-zA-Z0-9_.-]*$'` |
|  |  |  |  |  |
|  |  |  |  | `Any chroot or session listed here will become invisible, so you're` |
|  |  |  |  | `strongly advised to stop or rename them.` |
|  |  |  |  |  |
|  |  |  |  |  |
|  |  |  |  | `Dealing with an affected chroot:` |
|  |  |  |  |  |
|  |  |  |  | `To rename, edit the appropriate files, this is either` |
|  |  |  |  | `/etc/schroot/schroot.conf or in /etc/schroot/chroot.d/*. Change` |
|  |  |  |  | `the name in square brackets and, if needed, the "aliases=..."` |
|  |  |  |  | `line.` |
|  |  |  |  |  |
|  |  |  |  |  |
|  |  |  |  | `Dealing with an affected session:` |
|  |  |  |  |  |
|  |  |  |  | `Consider ending the session (--end-session) before upgrading.` |
|  |  |  |  | `This is the only safe way, especially if the problem is the name` |
|  |  |  |  | `of the underlying chroot.` |
|  |  |  |  |  |
|  |  |  |  | `The following steps should do the trick but still might break the` |
|  |  |  |  | `system:` |
|  |  |  |  | `(1) Edit /var/lib/schroot/session/<sessionname>, changing the first` |
|  |  |  |  | `line with the name in square brackets, the "name=..." line and,` |
|  |  |  |  | `if needed, the "aliases=..." line.` |
|  |  |  |  | `(2) Also rename /var/lib/schroot/session/<oldsessionname> to` |
|  |  |  |  | `/var/lib/schroot/session/<newsessionname>` |
|  |  |  |  |  |
|  |  |  |  | `* Major changes in 1.6.12:` |
|  |  |  |  |  |
|  | |  |  |  |

#### 42 [man/schroot.conf.5.man](#diff-c68d8cb01a2a93ab96a3ab2c6beb84df74664164 "man/schroot.conf.5.man") Unescape Escape [View file](/shelter/reschroot/src/commit/6f7166a285e1e97aea390be633591f9791b29a6d/man/schroot.conf.5.man)

|  | |  |  | `@ -547,37 +547,19 @@ description[fr]=\f[CI]French translation\fP` |
|  |  |  |  | `.PP` |
|  |  |  |  | `This will localise the \f[CI]description\fP key for all French locales.` |
|  |  |  |  | `.SH CHROOT NAMES` |
|  |  |  |  | `A number of characters or words are not permitted in a chroot name, session` |
|  |  |  |  | `name or configuration filename. The name may not contain a leading period` |
|  |  |  |  | `(\[oq].\[cq]). The characters \[oq]:\[cq] (colon), \[oq],\[cq] (comma) and` |
|  |  |  |  | `\[oq]/\[cq] (forward slash) are not permitted anywhere in the name. The name` |
|  |  |  |  | `may also not contain a trailing tilde (\[oq]~\[cq]). The rationale for these` |
|  |  |  |  | `restrictions is given below.` |
|  |  |  |  | `A number of characters or words are not permitted in a chroot name,` |
|  |  |  |  | `session name or configuration filename. The name must begin with a` |
|  |  |  |  | `lowercase or an uppercase letter, or a digit. The remaining characters` |
|  |  |  |  | `may additionally be dash (\[oq]-\[cq]), period (\[oq].\[cq]), or` |
|  |  |  |  | `underscore (\[oq]_\[cq]).` |
|  |  |  |  | `.PP` |
|  |  |  |  | `The rationale for these restrictions is as follows:` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] . \[cq]` |
|  |  |  |  | `A leading period could be used to create a name with a relative path in it, in` |
|  |  |  |  | `combination with \[oq]/\[cq], and this could allow overwriting of files on the` |
|  |  |  |  | `host filesystem. Not allowing this character also means hidden files cannot be` |
|  |  |  |  | `created. It also means some editor backups are automatically ignored. Periods` |
|  |  |  |  | `are allowed anywhere else in the name.` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] : \[cq]` |
|  |  |  |  | `A colon is used as a namespace delimiter, and so is not permitted as part of a` |
|  |  |  |  | `chroot or session name. LVM snapshot names may also not contain this character` |
|  |  |  |  | `due to a naming restriction by` |
|  |  |  |  | `.BR lvcreate (8).` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] / \[cq]` |
|  |  |  |  | `Names containing this character are not valid filenames. A forward slash would` |
|  |  |  |  | `potentially allow creation of files in subdirectories.` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] , \[cq]` |
|  |  |  |  | `Commas are used to separate items in lists. Aliases are separated by commas` |
|  |  |  |  | `and hence can't contain commas in their name.` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] ~ \[cq]` |
|  |  |  |  | `Filenames containing trailing tildes are used for editor backup files, which` |
|  |  |  |  | `are ignored. Tildes are allowed anywhere else in the name.` |
|  |  |  |  | `.RB Generic` |
|  |  |  |  | `Unfortunately, not all the places that deal with chroot names can` |
|  |  |  |  | `handle non-printable and other characters properly, and it's hard to` |
|  |  |  |  | `update all of them. This is mostly about the various shell scripts` |
|  |  |  |  | `where it's also unwise to assume authors always create safe code.` |
|  |  |  |  | `.TP` |
|  |  |  |  | `.RB \[oq] dpkg-old \[cq]` |
|  |  |  |  | `.TQ` |
|  | |  |  |  |

#### 5 [sbuild/sbuild-util.cc](#diff-bc7dc7038b054dc75f171dd9a6c8ade0d7bca11b "sbuild/sbuild-util.cc") Unescape Escape [View file](/shelter/reschroot/src/commit/6f7166a285e1e97aea390be633591f9791b29a6d/sbuild/sbuild-util.cc)

|  | |  |  | `@ -174,12 +174,11 @@ sbuild::is_valid_sessionname (std::string const& name)` |
|  |  |  |  | `{` |
|  |  |  |  | `bool match = false;` |
|  |  |  |  |  |
|  |  |  |  | `static regex file_namespace("^[^:/,.][^:/,]*$");` |
|  |  |  |  | `static regex editor_backup("~$");` |
|  |  |  |  | `// keep in sync with schroot.conf(5)` |
|  |  |  |  | `static regex file_namespace("^[a-zA-Z0-9][a-zA-Z0-9_.-]*$");` |
|  |  |  |  | `static regex debian_dpkg_conffile_cruft("dpkg-(old|dist|new|tmp)$");` |
|  |  |  |  |  |
|  |  |  |  | `if (regex_search(name, file_namespace) &&` |
|  |  |  |  | `!regex_search(name, editor_backup) &&` |
|  |  |  |  | `!regex_search(name, debian_dpkg_conffile_cruft)) {` |
|  |  |  |  | `match = true;` |
|  |  |  |  | `}` |
|  | |  |  |  |

Write
Preview

Loading…

Cancel
Save

Reference in a new issue

**Repository**
shelter/reschroot

**Title**

**Body**

Create issue

![](https://design.codeberg.org/logo-kit/icon_inverted.svg)

**Codeberg**

* [Documentation](https://docs.codeberg.org)
* [Community Issues](/Codeberg/Community/issues)
* [Contributing](/Codeberg/Contributing)* [Report Abuse](https://docs.codeberg.org/contact/#abuse)

**Association**

* [Who are we?](https://docs.codeberg.org/getting-started/what-is-codeberg/#what-is-codeberg-e.v.%3F)
* [Bylaws / Satzung](/codeberg/org/src/en/bylaws.md)
* [Donate](https://docs.codeberg.org/improving-codeberg/donate/)
* [Join / Support](https://join.codeberg.org)
* [Contact](https://docs.codeberg.org/contact/)

**Service**

* [Codeberg Pages](https://codeberg.page)
* [Weblate Translations](https://translate.codeberg.org)
* [Woodpecker CI](https://docs.codeberg.org/ci/#using-codeberg's-instance-of-woodpecker-ci)
* [Forgejo API](/api/swagger)
* [Status Page](https://status.codeberg.eu)

**Legal**

* [Imprint / Impressum](/codeberg/org/src/Imprint.md)
* [Privacy Policy](/codeberg/org/src/PrivacyPolicy.md)
* [Licenses](/assets/licenses.txt)
* [Terms of Use](/codeberg/org/src/TermsOfUse.md)

[Blog](https://blog.codeberg.org) |
[Mastodon](https://social.anoxinon.de/%40Codeberg) |
[Matrix Space](https://matrix.to/#/#codeberg-space:matrix.org) |
[Powered by Forgejo](/Codeberg-Infrastructure/forgejo)

English
Bahasa Indonesia
Deutsch
English
Español
Esperanto
Filipino
Français
Italiano
Latviešu
Magyar nyelv
Nederlands
Polski
Português de Portugal
Português do Brasil
Slovenščina
Suomi
Svenska
Türkçe
Čeština
Ελληνικά
Български
Русский
Українська
فارسی
日本語
简体中文
繁體中文（台灣）
繁體中文（香港）
한국어



=== Content from lists.debian.org_c91ea47d_20250114_194315.html ===


---

[[Date Prev](msg00006.html)][[Date Next](msg00008.html)]
[[Thread Prev](msg00006.html)][[Thread Next](msg00008.html)]
[[Date Index](maillist.html#00007)]
[[Thread Index](threads.html#00007)]

# [SECURITY] [DLA 3075-1] schroot security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3075-1] schroot security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 18 Aug 2022 10:57:22 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1oOdDG-0003yQ-9B%40seger.debian.org) [E1oOdDG-0003yQ-9B@seger.debian.org](msg00007.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3075-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                 Salvatore Bonaccorso
August 18, 2022                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : schroot
Version        : 1.6.10-6+deb10u1
CVE ID         : CVE-2022-2787

Julian Gilbey discovered that schroot, a tool allowing users to execute
commands in a chroot environment, had too permissive rules on chroot or
session names, allowing a denial of service on the schroot service for
all users that may start a schroot session.

Note that existing chroots and sessions are checked during upgrade, and
an upgrade is aborted if any future invalid name is detected.

Problematic session and chroots can be checked before upgrading with the
following command:

  schroot --list --all | LC_ALL=C grep -vE '^[a-z]+:[a-zA-Z0-9][a-zA-Z0-9_.-]*$'

See

  <<https://codeberg.org/shelter/reschroot/src/tag/release/reschroot-1.6.13/NEWS#L10-L41>>

for instructions on how to resolve such a situation.

For Debian 10 buster, this problem has been fixed in version
1.6.10-6+deb10u1.

We recommend that you upgrade your schroot packages.

For the detailed security status of schroot please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/schroot>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmL+GrNfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0SrwxAAha5yvAoXqanfSYOZTsN4dI/SBj3TjVEWTgymihmXlGk6HP6+XKhi+iUq
6GCUfMFUKfwZTJHFpjGK5KPn4KV9zII5yj/VbJj22UBsFqfL7Xr2DDf+1+eynrw/
cco30lLZH1ZP6mn36BX8dPkPWsvh9/D/fpRwfDQ9BltnbewjV+QcDNpzcCF3HxfJ
XdkNz3rcpPp8yJQASX7GYXetctLvaiVubCCtrXGCmsZsO6PIPvTaSW+0YWyORlQi
KRb+gk/a/AlApwNPKKnFH68mRfqEl+bmFOn8go8KwaN4PNGcZvjPfqT2AzpLICCG
417ByP3JcrNH2+SpeSmPEFxx7tXeHrF8+85diSADrscGe/M7v2rhir2hdVH94CqP
Nqcqe/oVH+gBmIww/hcLWAqCQg6KDf85yUWeng3C3pGVEZWEKmyxtubuqcjWrWnK
OOtfgWLc98P32lR+wBWmS72aoAOjzXIJpunBp/HW2Sylip6RVdLUqEc9CylHc6bV
EQyY9TkOxvuBCu6KZsJeF8aiEqW0XwWDjEbvxuSC8OUNFzG9tjPj67x5IE/wjYJ0
yHLi5ilPdEDYN4mXgBLC0i9YhU4XPK7xhSlaKbaQ8vlH4liOCHVTOrLcpIj7CRp/
G7iQoeAKmUteAay1BqU9+WSYte4gZZmfeFVY8diUNGT6m2j9NF8=
=CHZ2
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_9f273ab4_20250114_194315.html ===


---

[[Date Prev](msg00181.html)][[Date Next](msg00183.html)]
[[Thread Prev](msg00181.html)][[Thread Next](msg00183.html)]
[[Date Index](maillist.html#00182)]
[[Thread Index](threads.html#00182)]

# [SECURITY] [DSA 5213-1] schroot security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5213-1] schroot security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 18 Aug 2022 11:57:49 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1oOe9l-0005Q6-PA%40seger.debian.org) [E1oOe9l-0005Q6-PA@seger.debian.org](msg00182.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5213-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
August 18, 2022                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : schroot
CVE ID         : CVE-2022-2787

Julian Gilbey discovered that schroot, a tool allowing users to execute
commands in a chroot environment, had too permissive rules on chroot or
session names, allowing a denial of service on the schroot service for
all users that may start a schroot session.

Note that existing chroots and sessions are checked during upgrade, and
an upgrade is aborted if any future invalid name is detected.

Problematic session and chroots can be checked before upgrading with the
following command:

  schroot --list --all | LC_ALL=C grep -vE '^[a-z]+:[a-zA-Z0-9][a-zA-Z0-9_.-]*$'

See

  <<https://codeberg.org/shelter/reschroot/src/tag/release/reschroot-1.6.13/NEWS#L10-L41>>

for instructions on how to resolve such a situation.

For the stable distribution (bullseye), this problem has been fixed in
version 1.6.10-12+deb11u1.

We recommend that you upgrade your schroot packages.

For the detailed security status of schroot please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/schroot>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmL+KGJfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0QPdw/7BxDIMRgoa6zm6iTUvN/hcaim3Z1SJ/ZQhAaKtdU1RtqqlOz/BcQiovrZ
6xfl+Ss8kWQRjuqmR2G30tnLY2nW992vNw5PhQl/mlC4NHkFZIySPNQioAuesiF1
jp0iAvTwDGyHsrZmRdPIP3qB+PwycKnK57dq5FZizS9UNs7VYMLFDwXRk0XmhtwV
F1U8JxX57cfPtxFspoIWEGBa8yuD4IWR/UDzd/taWd4LspB1K2gyEfN2uacvGGwl
UGu2/hjAGOQwIlSvRHpuYlgb4FZCM7v2hQNeb0okIOQb+Id0g1kqxVuAdP03GrTp
s/5B+cUh9IFG2fEccOgB5YUz5T5p9NUD2CgccCa3GjXrsDg8qpig5RCVC5KShvYF
9JHcl6l09LQVZdVtGpJKVIpCyrGjLEKUpwsHZPbDs3/r4UkL8Hj7H4Us4d1dN1bB
vtjaxPJ2uCzlEXhc6bzTV6dLLUj0qmO8pxAIoOce9MI3GVIUTMPr7RnRYMewN4Re
++mJRLSEQNOpcg9YOfLh5eVr/RB21ZuqI+9/N0OzJ9oHvnSyuegKzCzJV6EsTsjF
vKnpy7Pb6agPb+M3GW7TfWuftvNbtnmsyM942OgeqYl/jvK0lvRaNLyJIi/FYry0
t3mmo/QsdgBVua4yfIragbUwBk3mcAnMvhivOJFJoBSrigfUErg=
=Gh4e
-----END PGP SIGNATURE-----

```

---


