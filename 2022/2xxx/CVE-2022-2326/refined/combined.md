=== Content from gitlab.com_3e8e6282_20250114_202216.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2326.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2326.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2326.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-2326.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Aug 03, 2022

  [05f0d34f](/gitlab-org/cves/-/commit/05f0d34fbaf69cfa065fcfdc05533dc3b7afddf8)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/05f0d34fbaf69cfa065fcfdc05533dc3b7afddf8)
  ·
  05f0d34f

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 03, 2022

  05f0d34f

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/05f0d34fbaf69cfa065fcfdc05533dc3b7afddf8)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 03, 2022

Loading



=== Content from gitlab.com_9f4b5d12_20250114_202217.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Ability to gain access to private project through an email invite by using other user's email address as an unverified secondary email

**[HackerOne report #1517554](https://hackerone.com/reports/1517554)** by `vaib25vicky` on 2022-03-21, assigned to [@rshambhuni](/rshambhuni "Rohit Shambhuni"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

#### Description

Member invitation by email address is vulnerable and allows user impersonation. When project admin invites a new member via email then Gitlab code **match it with unverified email** of different account. This gives an opportunity to an attacker to add legitimate member email address to his account and gain access to the private project.

#### Attack Scenario

Suppose there is company name `xyz.org`, all projects of this company are only accessible to its employees, that is those Gitlab accounts that have email addresses that match `<employee_name>[@]xyz.org`.

Attacker can add email address `john@xyz.org` to his personal Gitlab account which is an unverified email address and then all invitation to the `john@xyz.org` are actually goes to the attacker and he gains access to the private projects of the company.

#### PoC

##### Attacker account

* Attacker has a verified primary email address which he owns
* He adds another email address of the company employee `john@gitlab-bounty.com` in his account .

  This will be an unverified secondary email address

##### Victim account

* Creates a project named `Gitlab-Bounty`
* Invites member to the project by email address `john@gitlab-bounty.com`

##### Bug

* Gitlab will not check whether email address is verified or not and incorrectly matches the invitation to the attacker account.
* Attacker successfully managed to impersonate a legitimate employee of the company and gain access to the private project and repository

##### Output of checks

This bug happens on GitLab.com. Probably instance too (please check)

#### Impact

Gitlab don't check verified email address prior to matching them with Gitlab accounts and this allows an attacker to gain access to private projects with higher permissions and impersonate legitimate members of the project.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Jun 06, 2022 by [Bogdan Denkovych](/bdenkovych)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


