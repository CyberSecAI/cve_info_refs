=== Content from ubuntu.com_d47cb031_20250114_225215.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5496-1: cloud-init vulnerability

29 June 2022

cloud-init could be made to expose sensitive information.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 22.04 LTS](/security/notices?release=jammy)
* [Ubuntu 21.10](/security/notices?release=impish)
* [Ubuntu 20.04 LTS](/security/notices?release=focal)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [cloud-init](/security/cves?package=cloud-init) - initialization and customization tool for cloud instances

## Details

Mike Stroyan discovered that cloud-init could log password hashes when

reporting schema failures. An attacker with access to these logs could

potentially use this to gain user credentials.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 22.04

* [cloud-init](https://launchpad.net/ubuntu/%2Bsource/cloud-init)
  -
  [22.2-0ubuntu1~22.04.3](https://launchpad.net/ubuntu/%2Bsource/cloud-init/22.2-0ubuntu1~22.04.3)

##### Ubuntu 21.10

* [cloud-init](https://launchpad.net/ubuntu/%2Bsource/cloud-init)
  -
  [22.2-0ubuntu1~21.10.3](https://launchpad.net/ubuntu/%2Bsource/cloud-init/22.2-0ubuntu1~21.10.3)

##### Ubuntu 20.04

* [cloud-init](https://launchpad.net/ubuntu/%2Bsource/cloud-init)
  -
  [22.2-0ubuntu1~20.04.3](https://launchpad.net/ubuntu/%2Bsource/cloud-init/22.2-0ubuntu1~20.04.3)

##### Ubuntu 18.04

* [cloud-init](https://launchpad.net/ubuntu/%2Bsource/cloud-init)
  -
  [22.2-0ubuntu1~18.04.3](https://launchpad.net/ubuntu/%2Bsource/cloud-init/22.2-0ubuntu1~18.04.3)

In general, a standard system update will make the necessary changes.

Please note that sensitive information may have been logged to remote

logging aggregators as well as to the system journal, and removal of

such information may be required. Similarly, cloud-init configurations

that log in non-default locations may also require the removal of

sensitive information.

## References

* [CVE-2022-2084](/security/CVE-2022-2084)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_5fc1d4f0_20250114_225214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fcloud-init%2Fcommit%2F4d467b14363d800b2185b89790d57871f11ea88c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fcloud-init%2Fcommit%2F4d467b14363d800b2185b89790d57871f11ea88c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=canonical%2Fcloud-init)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[canonical](/canonical)
/
**[cloud-init](/canonical/cloud-init)**
Public

* [Notifications](/login?return_to=%2Fcanonical%2Fcloud-init) You must be signed in to change notification settings
* [Fork
  898](/login?return_to=%2Fcanonical%2Fcloud-init)
* [Star
   3.1k](/login?return_to=%2Fcanonical%2Fcloud-init)

* [Code](/canonical/cloud-init)
* [Issues
  540](/canonical/cloud-init/issues)
* [Pull requests
  16](/canonical/cloud-init/pulls)
* [Actions](/canonical/cloud-init/actions)
* [Security](/canonical/cloud-init/security)
* [Insights](/canonical/cloud-init/pulse)

Additional navigation options

* [Code](/canonical/cloud-init)
* [Issues](/canonical/cloud-init/issues)
* [Pull requests](/canonical/cloud-init/pulls)
* [Actions](/canonical/cloud-init/actions)
* [Security](/canonical/cloud-init/security)
* [Insights](/canonical/cloud-init/pulse)

## Commit

[Permalink](/canonical/cloud-init/commit/4d467b14363d800b2185b89790d57871f11ea88c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Remove schema errors from log ([#1551](https://github.com/canonical/cloud-init/pull/1551))

[Browse files](/canonical/cloud-init/tree/4d467b14363d800b2185b89790d57871f11ea88c)
Browse the repository at this point in the history

```
When schema errors are encountered, the section of userdata in question
gets printed to the cloud-init log. As this could contain sensitive
data, so log a generic warning instead and redirect user to run
cloud-init schema --system as root.

LP: #1978422
CVE: 2022-2084
```

* Loading branch information

[![@TheRealFalcon](https://avatars.githubusercontent.com/u/153674?s=40&v=4)](/TheRealFalcon)

[TheRealFalcon](/canonical/cloud-init/commits?author=TheRealFalcon "View all commits by TheRealFalcon")
authored
Jun 29, 2022

1 parent
[4eab80c](/canonical/cloud-init/commit/4eab80c9db89fcdae4d16c33d8f123cfa1aa62dd)

commit 4d467b1

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**51 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* cloudinit

  + cmd

    - cloudinit/cmd/main.py
      [main.py](#diff-5978682d3313395486da4847761e13e175e6303251fe7ddf81552db99779760e)
  + config

    - cloudinit/config/schema.py
      [schema.py](#diff-3dab74160d0d2e18837e4c271eb03209be4263cf51d44cb8ca78bb739fd3f68c)
* tests

  + integration\_tests/modules

    - tests/integration\_tests/modules/test\_cli.py
      [test\_cli.py](#diff-18a823835b44f0495b577eab5f96c3fb71e7dfadd188d377d3c23a83123bd0ac)
  + unittests/config

    - tests/unittests/config/test\_schema.py
      [test\_schema.py](#diff-ccf5aac2a6067d8a0782d74b172805f80e71225a212822e4f4e158f9ca1e6e3a)

## There are no files selected for viewing

4 changes: 3 additions & 1 deletion

4
[cloudinit/cmd/main.py](#diff-5978682d3313395486da4847761e13e175e6303251fe7ddf81552db99779760e "cloudinit/cmd/main.py")

Show comments

[View file](/canonical/cloud-init/blob/4d467b14363d800b2185b89790d57871f11ea88c/cloudinit/cmd/main.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -455,7 +455,9 @@ def main\_init(name, args): |
|  |  |  |
|  |  | # Validate user-data adheres to schema definition |
|  |  | if os.path.exists(init.paths.get\_ipath\_cur("userdata\_raw")): |
|  |  | validate\_cloudconfig\_schema(config=init.cfg, strict=False) |
|  |  | validate\_cloudconfig\_schema( |
|  |  | config=init.cfg, strict=False, log\_details=False |
|  |  | ) |
|  |  | else: |
|  |  | LOG.debug("Skipping user-data validation. No user-data found.") |
|  |  |  |
| Expand Down | |  |

15 changes: 12 additions & 3 deletions

15
[cloudinit/config/schema.py](#diff-3dab74160d0d2e18837e4c271eb03209be4263cf51d44cb8ca78bb739fd3f68c "cloudinit/config/schema.py")

Show comments

[View file](/canonical/cloud-init/blob/4d467b14363d800b2185b89790d57871f11ea88c/cloudinit/config/schema.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -198,6 +198,7 @@ def validate\_cloudconfig\_schema( |
|  |  | schema: dict = None, |
|  |  | strict: bool = False, |
|  |  | strict\_metaschema: bool = False, |
|  |  | log\_details: bool = True, |
|  |  | ): |
|  |  | """Validate provided config meets the schema definition. |
|  |  |  |
| Expand All | | @@ -210,6 +211,9 @@ def validate\_cloudconfig\_schema( |
|  |  | logging warnings. |
|  |  | @param strict\_metaschema: Boolean, when True validates schema using strict |
|  |  | metaschema definition at runtime (currently unused) |
|  |  | @param log\_details: Boolean, when True logs details of validation errors. |
|  |  | If there are concerns about logging sensitive userdata, this should |
|  |  | be set to False. |
|  |  |  |
|  |  | @raises: SchemaValidationError when provided config does not validate |
|  |  | against the provided schema. |
| Expand All | | @@ -234,12 +238,17 @@ def validate\_cloudconfig\_schema( |
|  |  | errors += ((path, error.message),) |
|  |  | if errors: |
|  |  | if strict: |
|  |  | # This could output/log sensitive data |
|  |  | raise SchemaValidationError(errors) |
|  |  | else: |
|  |  | if log\_details: |
|  |  | messages = ["{0}: {1}".format(k, msg) for k, msg in errors] |
|  |  | LOG.warning( |
|  |  | "Invalid cloud-config provided:\n%s", "\n".join(messages) |
|  |  | details = "\n" + "\n".join(messages) |
|  |  | else: |
|  |  | details = ( |
|  |  | "Please run 'sudo cloud-init schema --system' to " |
|  |  | "see the schema errors." |
|  |  | ) |
|  |  | LOG.warning("Invalid cloud-config provided: %s", details) |
|  |  |  |
|  |  |  |
|  |  | def annotated\_cloudconfig\_file( |
| Expand Down | |  |

20 changes: 14 additions & 6 deletions

20
[tests/integration\_tests/modules/test\_cli.py](#diff-18a823835b44f0495b577eab5f96c3fb71e7dfadd188d377d3c23a83123bd0ac "tests/integration_tests/modules/test_cli.py")

Show comments

[View file](/canonical/cloud-init/blob/4d467b14363d800b2185b89790d57871f11ea88c/tests/integration_tests/modules/test_cli.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,11 +18,18 @@ |
|  |  | - echo 'hi' > /var/tmp/test |
|  |  | """ |
|  |  |  |
|  |  | # The '-' in 'hashed-password' fails schema validation |
|  |  | INVALID\_USER\_DATA\_SCHEMA = """\ |
|  |  | #cloud-config |
|  |  | updates: |
|  |  | notnetwork: -1 |
|  |  | apt\_pipelining: bogus |
|  |  | users: |
|  |  | - default |
|  |  | - name: newsuper |
|  |  | gecos: Big Stuff |
|  |  | groups: users, admin |
|  |  | sudo: ALL=(ALL) NOPASSWD:ALL |
|  |  | hashed-password: asdfasdf |
|  |  | shell: /bin/bash |
|  |  | lock\_passwd: true |
|  |  | """ |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -69,11 +76,12 @@ def test\_invalid\_userdata\_schema(client: IntegrationInstance): |
|  |  | assert result.ok |
|  |  | log = client.read\_from\_file("/var/log/cloud-init.log") |
|  |  | warning = ( |
|  |  | "[WARNING]: Invalid cloud-config provided:\napt\_pipelining: 'bogus'" |
|  |  | " is not valid under any of the given schemas\nupdates: Additional" |
|  |  | " properties are not allowed ('notnetwork' was unexpected)" |
|  |  | "[WARNING]: Invalid cloud-config provided: Please run " |
|  |  | "'sudo cloud-init schema --system' to see the schema errors." |
|  |  | ) |
|  |  | assert warning in log |
|  |  | assert "asdfasdf" not in log |
|  |  |  |
|  |  | result = client.execute("cloud-init status --long") |
|  |  | if not result.ok: |
|  |  | raise AssertionError( |
| Expand Down | |  |

23 changes: 22 additions & 1 deletion

23
[tests/unittests/config/test\_schema.py](#diff-ccf5aac2a6067d8a0782d74b172805f80e71225a212822e4f4e158f9ca1e6e3a "tests/unittests/config/test_schema.py")

Show comments

[View file](/canonical/cloud-init/blob/4d467b14363d800b2185b89790d57871f11ea88c/tests/unittests/config/test_schema.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -286,10 +286,31 @@ def test\_validateconfig\_schema\_non\_strict\_emits\_warnings(self, caplog): |
|  |  | assert "cloudinit.config.schema" == module |
|  |  | assert logging.WARNING == log\_level |
|  |  | assert ( |
|  |  | "Invalid cloud-config provided:\np1: -1 is not of type 'string'" |
|  |  | "Invalid cloud-config provided: \np1: -1 is not of type 'string'" |
|  |  | == log\_msg |
|  |  | ) |
|  |  |  |
|  |  | @skipUnlessJsonSchema() |
|  |  | def test\_validateconfig\_schema\_sensitive(self, caplog): |
|  |  | """When log\_details=False, ensure details are omitted""" |
|  |  | schema = { |
|  |  | "properties": {"hashed\_password": {"type": "string"}}, |
|  |  | "additionalProperties": False, |
|  |  | } |
|  |  | validate\_cloudconfig\_schema( |
|  |  | {"hashed-password": "secret"}, |
|  |  | schema, |
|  |  | strict=False, |
|  |  | log\_details=False, |
|  |  | ) |
|  |  | [(module, log\_level, log\_msg)] = caplog.record\_tuples |
|  |  | assert "cloudinit.config.schema" == module |
|  |  | assert logging.WARNING == log\_level |
|  |  | assert ( |
|  |  | "Invalid cloud-config provided: Please run 'sudo cloud-init " |
|  |  | "schema --system' to see the schema errors." == log\_msg |
|  |  | ) |
|  |  |  |
|  |  | @skipUnlessJsonSchema() |
|  |  | def test\_validateconfig\_schema\_emits\_warning\_on\_missing\_jsonschema( |
|  |  | self, caplog |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4d467b1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcanonical%2Fcloud-init%2Fcommit%2F4d467b14363d800b2185b89790d57871f11ea88c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


