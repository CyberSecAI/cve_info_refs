Based on the provided content, here's a breakdown of the vulnerability:

*   **Root Cause:** The YaySMTP plugin settings are not properly authorized, allowing users with the "subscriber" role to modify them. Additionally, the plugin does not sanitize user-supplied input when saving settings, leading to Stored Cross-Site Scripting (XSS).
*   **Weaknesses/Vulnerabilities:**
    *   **Inadequate Authorization:** Subscriber-level users can modify plugin settings, which should typically be restricted to higher-level roles like administrators.
    *   **Stored XSS:** User-controlled input in the plugin settings is not properly escaped before being stored in the database. This allows an attacker to inject malicious JavaScript code that will execute when an administrator views the settings page.
*   **Impact of Exploitation:**
    *   An attacker with subscriber-level access can inject malicious JavaScript code through the plugin's settings. This injected script could potentially allow an attacker to perform actions such as:
        *   Redirecting users to malicious websites
        *   Stealing administrator session cookies
        *   Defacing the website
        *   Performing unauthorized actions on behalf of an admin user
*   **Attack Vectors:**
    *   The attacker needs to have an account with at least "subscriber" privileges on the WordPress site.
    *   The attacker exploits the lack of authorization and input sanitization in the plugin's settings page.
    *   The attacker injects malicious javascript code into the plugin settings.
*   **Required Attacker Capabilities/Position:**
    *   Attacker needs a valid subscriber-level user account on the vulnerable WordPress site.
    *   The attacker needs to be able to make HTTP requests to the `/wp-admin/admin-ajax.php` endpoint

The provided information is consistent with the description of CVE-2022-2371. The content also provides a proof of concept python script which can be used to test and exploit the vulnerability.