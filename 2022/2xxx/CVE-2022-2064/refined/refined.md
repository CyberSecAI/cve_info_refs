```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from insufficient session expiration handling. The application was not properly invalidating sessions or tokens when user details, such as roles or other important attributes, were modified.",
    "weaknesses": [
      "Insufficient session expiration",
      "Missing token version check",
      "Inadequate session invalidation after critical user updates (e.g., password change)"
    ],
    "impact": "An attacker could potentially maintain access even after a user has changed their password or had their permissions revoked by exploiting the lack of proper session invalidation, leading to unauthorized access or persistence of privileges.",
    "attack_vectors": "A user's session could remain valid even after a password change, or after their account roles are modified, thus allowing an attacker who has an old session to maintain unauthorized access",
    "required_capabilities": "The attacker needs to have a valid, active session prior to any user updates (e.g., password change). "
  },
  "fixes": [
    "Introduction of a `token_version` column in the `nc_users_v2` table.",
    "The `token_version` is a randomly generated string that is added to the jwt payload",
    "The `token_version` is checked on every request using the `initStrategies` method.",
    "The `token_version` is updated upon user update methods like password reset or change.",
    "Sessions are invalidated upon password change by changing the `token_version` of user in the DB."
  ]
}
```