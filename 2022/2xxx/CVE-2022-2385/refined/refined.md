```
{
  "CVE-2022-2385": {
    "related_content": [
      {
        "source": "groups.google.com_20b552dc_20250115_194344.html",
        "vulnerability": {
          "root_cause": "The vulnerability exists in how aws-iam-authenticator processes the AccessKeyID template parameter. When using the `{{AccessKeyID}}` template value to construct usernames, a malicious actor could potentially manipulate their AccessKeyID to generate different usernames which might lead to privilege escalation if the system grants different levels of access based on usernames.",
          "weaknesses": [
            "Improper Input Validation",
            "Template Injection"
          ],
          "impact": "A user with an allow-listed IAM identity could modify their username and escalate their privileges.",
          "attack_vectors": "The attack is network based and requires a compromised AWS IAM identity. An attacker can potentially modify their AccessKeyID in a way that bypasses the expected username validation logic.",
          "required_attacker_capabilities": "The attacker needs to possess an allow-listed IAM identity. The attacker must be able to manipulate the `AccessKeyID` parameter."
        }
      },
      {
        "source": "github.com_83ca7599_20250115_194341.html",
          "vulnerability": {
          "root_cause": "The vulnerability exists in aws-iam-authenticator when the `AccessKeyID` template parameter is used to construct usernames. This allows an attacker to modify their username by manipulating their `AccessKeyID` leading to potential privilege escalation.",
            "weaknesses": [
              "CWE-20: Improper Input Validation"
            ],
          "impact": "An allow-listed IAM identity can modify their username, potentially leading to privilege escalation.",
          "attack_vectors": "The attack vector is network-based and involves sending a specially crafted request to the aws-iam-authenticator that contains manipulated `AccessKeyID`.",
          "required_attacker_capabilities": "The attacker needs a valid, allow-listed IAM identity that can assume a role. They also need the ability to manipulate their `AccessKeyID`."
        }
      },
      {
        "source": "github.com_942bb3b1_20250115_194343.html",
        "vulnerability": {
          "root_cause": "The root cause lies in the use of the `{{AccessKeyID}}` template parameter within the aws-iam-authenticator to construct usernames. The authenticator does not properly validate or sanitize the `AccessKeyID`, allowing an attacker to manipulate it and construct different usernames.",
          "weaknesses": [
            "Improper Input Validation",
              "Lack of Input Sanitization",
                "Template Injection"
          ],
          "impact": "A user with an allow-listed IAM identity can potentially modify their username and escalate privileges by manipulating their AccessKeyID.",
          "attack_vectors": "The attack vector involves manipulating the AccessKeyID used in the authentication process.",
          "required_attacker_capabilities": "An attacker would need an allow-listed IAM identity and the ability to modify their AccessKeyID."
        }
      },
      {
        "source": "github.com_0eaa812e_20250115_194342.html",
        "vulnerability": {
          "root_cause": "The vulnerability arises from the lack of proper validation of query parameters in the aws-iam-authenticator, specifically when multiple parameters are provided, which could be exploited in combination with the `AccessKeyID` template parameter to potentially bypass authorization checks.",
            "weaknesses": [
             "Improper Input Validation"
            ],
          "impact": "The impact is that an allow-listed IAM identity can modify their username and escalate privileges.",
          "attack_vectors": "The attack vector involves manipulating the query parameters in the authentication request to alter the identity of the user.",
          "required_attacker_capabilities": "The attacker needs to have a valid IAM identity that is allow-listed to use the aws-iam-authenticator, and they need to have the ability to manipulate the query parameters in their authentication requests."
        }
      }
    ],
        "summary": "CVE-2022-2385 is a high-severity vulnerability in aws-iam-authenticator that arises from improper handling of the `AccessKeyID` template parameter when constructing usernames. This flaw can be exploited by an attacker with a valid, allow-listed IAM identity to modify their username and escalate privileges. The vulnerability occurs because the software does not adequately validate or sanitize the input, allowing manipulation via query parameters. This allows attackers to potentially bypass intended authorization and access controls. The attack is network-based and involves altering the AccessKeyID in authentication requests. The vulnerability was addressed in aws-iam-authenticator version v0.5.9.",
          "affected_versions": "< 0.5.9",
          "fixed_versions": "0.5.9"
  }
}
```