=== Content from www.pritect.net_5ae676f1_20250114_190202.html ===


[Skip to content](#site-content)
# [Pritect Network](https://www.pritect.net/)

WordPress Security Solutions

Menu

* [Home](http://www.pritect.net/)
* [Contact](https://www.pritect.net/contact)

[Home](https://www.pritect.net/) » Advanced Custom Fields < 5.12.3 can allow unauthenticated users to upload arbitrary files

# Advanced Custom Fields < 5.12.3 can allow unauthenticated users to upload arbitrary files

by [James Golovich](https://www.pritect.net/blog/author/james)

July 25, 2022

## Arbitrary File Upload

[Advanced Custom Fields](https://wordpress.org/plugins/advanced-custom-fields) and [Advanced Custom Fields Pro](https://www.advancedcustomfields.com/) have 2+ million installs according to wordpress.org. Versions older than 5.12.3 allow unauthenticated users to upload arbitrary files if there is a frontend form available. This vulnerability was introduced in the 5.0 rewrite and did not exist prior to that release.

Fortunately by default WordPress does not allow uploading of .php files so this vulnerability is not easily wormable, but there are many other file types that can be uploaded that can be then used with another exploit to execute code or used in a phishing attack to get a user to download and execute a resource from a “trusted” site.

No exploit code is being released at this time.

## Timeline

* 7/11/2022 Contacted developer
* 7/12/2022 Disclosed vulnerability
* 7/13/2022 Patch received from developer for testing
* 7/14/2022 Fix deployed to [GitHub](https://github.com/AdvancedCustomFields/acf/commit/d18a7bb40dd7e01385a6829a11954982640cd495) and pushed to wordpress.org plugin repository

* [nonce\_leak](https://www.pritect.net/blog/tag/nonce_leak)
* [wordpress plugin](https://www.pritect.net/blog/tag/wordpress-plugin)

Post navigation
[Elementor Page Builder < 1.8 allows logged in users unrestricted editing](https://www.pritect.net/blog/elementor-page-builder-1-8-allows-logged-users-unrestricted-editing)

#### Recent Posts

* [Advanced Custom Fields < 5.12.3 can allow unauthenticated users to upload arbitrary files](https://www.pritect.net/blog/advanced-custom-fields-5-12-3-can-allow-unauthenticated-users-to-upload-arbitrary-files)
* [Elementor Page Builder < 1.8 allows logged in users unrestricted editing](https://www.pritect.net/blog/elementor-page-builder-1-8-allows-logged-users-unrestricted-editing)
* [WordPress shortcode injection as an attack vector](https://www.pritect.net/blog/wordpress-shortcode-injection-attack-vector)
* [Ultimate Member < 1.3.84 allows executing arbitrary WordPress shortcodes](https://www.pritect.net/blog/ultimate-member-1-3-84-wordpress-shortcodes)
* [NinjaForms < 3.0.32 allows injecting arbitrary WordPress shortcodes](https://www.pritect.net/blog/ninjaforms-3-0-32-allows-injecting-arbitrary-wordpress-shortcodes)
#### Search

#### Donate to Pritect

Your donations keep us working on security issues!

![](https://www.paypalobjects.com/en_US/i/scr/pixel.gif)

#### Subscribe to our Newsletter

Receive information about new vulnerabilities and products.

First name

Last name

Email \*

* [Facebook](https://www.facebook.com/Pritect/)
* [Twitter](http://twitter.com/pritect)
* Email



=== Content from wpscan.com_9446b89b_20250114_190200.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Advanced Custom Fields 5.0-5.12.2 - Unauthenticated File Upload

### Description

The plugin allows unauthenticated users to upload files allowed in a default WP configuration (so PHP is not possible) if there is a frontend form available. This vulnerability was introduced in the 5.0 rewrite and did not exist prior to that release.

By default WordPress does not allow uploading of .php files so this vulnerability is not easily wormable, but there are many other file types that can be uploaded that can be then used with another exploit to execute code or used in a phishing attack to get a user to download and execute a resource from a "trusted" site.

### Proof of Concept

The nonce is retrieved from a form in the frontend
curl \
-i -s -k -X 'POST' \
-F "comment=Test comment" \
-F '\_acf\_post\_id=1' \
-F '\_acf\_validation=1' \
-F '\_acf\_nonce=ba2ef314e0' \
-F '\_acf\_changed=0' \
-F 'acf[field\_62c8939d255d8]=Something' \
-F 'author=testing' \
-F 'email=testing@example.com' \
-F 'url=' \
-F 'submit=Post+Comment' \
-F 'comment\_post\_ID=1' \
-F 'comment\_parent=0' \
-F 'acf[name]=@rickroll.mp4' \
'http://play.local/wp-comments-post.php'

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

advanced-custom-fields](https://a8cteam5105.wordpress.com/plugin/advanced-custom-fields/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 5.12.3

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

advanced-custom-fields-pro](https://a8cteam5105.wordpress.com/plugin/advanced-custom-fields-pro/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 5.12.3

### References

CVE
[CVE-2022-2594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2594)

URL
<https://www.pritect.net/blog/advanced-custom-fields-5-12-3-can-allow-unauthenticated-users-to-upload-arbitrary-files>

### Miscellaneous

Original Researcher
James Golovich

Submitter
Pritect

Submitter website
<https://pritect.net>

Submitter twitter
[Pritect](//twitter.com/Pritect)

Verified
Yes

WPVDB ID
[3fde5336-552c-4861-8b4d-89a16735c0e2](https://a8cteam5105.wordpress.com/vulnerability/3fde5336-552c-4861-8b4d-89a16735c0e2/)

### Timeline

Publicly Published
2022-08-01 (about 2 years ago)

Added
2022-08-01 (about 2 years ago)

Last Updated
2023-05-04 (about 1 years ago)

### Other

Published
Title

Published
2014-08-01
Title
[Really Easy Slider 0.1 - Shell Upload](https://a8cteam5105.wordpress.com/vulnerability/137c19da-9bbd-4138-84f3-8eb136e612a1/)

Published
2014-08-01
Title
[vithy - Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/d38919a2-5b12-42d6-9fbf-d5fe4f5e375b/)

Published
2024-08-02
Title
[YayExtra – WooCommerce Extra Product Options < 1.3.8 - Unauthenticated Arbitrary File Upload via handle\_upload\_file Function](https://a8cteam5105.wordpress.com/vulnerability/afba2ad3-8442-4bc6-a679-e7b5d86e1e8c/)

Published
2014-08-01
Title
[Kino Gallery 1.0 - Shell Upload](https://a8cteam5105.wordpress.com/vulnerability/92924247-dbfe-49ac-8612-b969da52c95a/)

Published
2022-09-05
Title
[CM Download Manager < 2.8.6 - Admin+ Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/d18e695b-4d6e-4ff6-a060-312594a0d2bd/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

