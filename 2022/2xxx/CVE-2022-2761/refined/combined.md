=== Content from gitlab.com_89b9e5b7_20250114_204548.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Arbitrary GFM references rendered in Jira issue description leak private/confidential resources

**[HackerOne report #1653149](https://hackerone.com/reports/1653149)** by `yvvdwf` on 2022-07-28, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

Gitlab allows integrating Jira issues whose descriptions are rendered using GFM. However the descriptions are not redacted. Consequently the priviate/confidential information are leaked to unauthorized users.

This report is basically the same as [the previous report](https://hackerone.com/reports/1652853). They are the same model of exploitation but their root causes are different. Indeed the Jira descriptions are managed by `JiraGfmPipeline` pipeline.

### Steps to reproduce:

Requirements:

* access to a premium subscription (no problem on GitLab.com as there are free trials, they work great for the attack)
* a Jira server. I used a cloud Jira instance on atlassian.com

As a normal user (victim):

* create a private project, let's call `victim/project-a`, then create a confidential issue inside. It's GFM reference is now `victim/project-a#1`

As an attacker which has a premium subscription (e.g., via free trials):

* In an existing project or create a new one
* Go to `Settings/Integrations` and select `Jira`. Follow the [guide](https://docs.gitlab.com/ee/integration/jira/issues.html#view-jira-issues) to fill the form to enable viewing Jira issues in the project.
* Login Jira, create an issue on the dashboard by fillting `victim/project-a#1` into the `Description` textbox.
* Go back to Gitlab web to view the issue you've created, .e.g., in `Issues/Jira issues` then select the issue
* Right click on the link of `victim/project-a#1` to view its source code. You should see the title of the issue created by the victim.
* Below is an example when I used `gitlab-org/gitlab#363725` as payload which is used to track one of my H1 reports.

[![jira-pipeline.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/5779b19a8d63b158cea4aef957d13d57494f7862/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36643332373436622d616535382d346637322d386662622d6463313763336338383137392f6a6972612d706970656c696e652e706e67)

### Impact

This vulnerability allows to renders *all* GFM references, such as, merged requests, issues, etc, even if they are private or confidential.

For example, attackers can simply scan through all *issue* numbers (starting from 1) of the `gitlab-org/gitlab` project, and thus leaking their titles.

Best regards,

yvvdwf

#### Impact

This vulnerability allows attacker to access to *all private or confidential* GFM references, such as, merged requests, issues, etc.

For example, attackers can simply scan through all issue numbers (starting from 1) of the `gitlab-org/gitlab` project, and thus leaking their titles.

#### Impact

This vulnerability allows attacker to access to *all private or confidential* GFM references, such as, merged requests, issues, etc.

For example, attackers can simply scan through all issue numbers (starting from 1) of the `gitlab-org/gitlab` project, and thus leaking their titles.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [jira-pipeline.png](https://h1.sec.gitlab.net/a/6d32746b-ae58-4f72-8fbb-dc17c3c88179/jira-pipeline.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_a3980cea_20250114_204546.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2761.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2761.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2761.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-2761.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Nov 09, 2022

  [87cb3820](/gitlab-org/cves/-/commit/87cb3820eb3c72d0a5721197f4434a68591c4911)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/87cb3820eb3c72d0a5721197f4434a68591c4911)
  ·
  87cb3820

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Nov 09, 2022

  87cb3820

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/87cb3820eb3c72d0a5721197f4434a68591c4911)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Nov 09, 2022

Loading


