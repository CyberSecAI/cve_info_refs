=== Content from gitlab.com_f07673b1_20250114_214145.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Job information is leaked to unauthorized users via the Runner Jobs API endpoint

**[HackerOne report #1092199](https://hackerone.com/reports/1092199)** by `vaib25vicky` on 2021-02-01, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

The past report [gitlab-foss#53032 (closed)](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/53032 "Private Projects' Jobs/Pipelines/namespace are leaked to Specific Runner Jobs API endpoint") is not considered a security issue because

as per this [gitlab-foss#53032 (comment 110938617)](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/53032#note_110938617 "Private Projects' Jobs/Pipelines/namespace are leaked to Specific Runner Jobs API endpoint")

> Even if we restricted that endpoint, it wouldn't matter because who owns the runner will still be able to access private repo source code, jobs handled by the runner, etc.

But I've found that this is a valid security issue in different cases such as

* Owner of the runner user **A** , enabled specific runner to be used by other maintainers of the project
* user **B** add the runner to their project, now as mentioned this is **not** a security issue because user **B** knows that user **A** owns runner and they can access the Jobs/Pipelines/namespace etc.
* BUT this becomes a **security issue** when the user **A** removes the user **B** from the project then user **B** can also access the endpoint `/runners/:id/jobs` and access user **A** private projects jobs/Pipelines/namespace.
* In this case user **B** is not the owner of the runner

There should be access control on the endpoint `/runners/:id/jobs`. There may be more such cases.

#### Impact

Private Projects' Jobs/Pipelines/namespace etc are leaked to Specific Runner Jobs API endpoint due to missing access control on the endpoint `/runners/:id/jobs`

## How To Reproduce

1. `UserA` creates `ProjectA` and adds `UserB` as maintainer
2. `UserA` creates a specific `runnerA` for `ProjectA` and allows it to be assigned to other projects
3. `UserB` creates a public project and enables `runnerA` on it
4. `UserB` is removed from `ProjectA`

   THE ISSUE:
5. `UserB` can access current and future private projects from the endpoint `/runners/:id/jobs` because they are still considered owner of `runnerA`

Edited May 10, 2022 by [Laura Montemayor](/lauraXD)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_26835252_20250114_214143.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-2227.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-2227.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-2227.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-2227.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jul 04, 2022

  [193c8084](/gitlab-org/cves/-/commit/193c80848451d272c2aca0c0daab151a8d609217)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/193c80848451d272c2aca0c0daab151a8d609217)
  ·
  193c8084

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 04, 2022

  193c8084

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/193c80848451d272c2aca0c0daab151a8d609217)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 04, 2022

Loading


