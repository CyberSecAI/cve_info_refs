=== Content from www.wordfence.com_cbb7cb9b_20250114_223110.html ===


![](https://www.wordfence.com/wp-content/uploads/2022/02/water-background-clear-rippled-water-in-ocean-wallpaper-banner-icon-picture-id1365594778.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

February 22, 2022

# Reflected XSS in Header Footer Code Manager

On February 15, 2022, the Wordfence Threat Intelligence team responsibly disclosed a reflected Cross-Site Scripting (XSS) vulnerability in Header Footer Code Manager, a WordPress plugin with over 300,000 installations.

The plugin publisher quickly acknowledged our initial contact and we sent the full disclosure details the same day, on February 15, 2022. A patched version, 1.1.17, was implemented a few days later and made available on February 18, 2022.

[Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) customers received a firewall rule to protect against this vulnerability on February 15, 2022. Sites still running the free version of Wordfence are partially protected against this exploit by our built-in XSS rule, but will receive full protection 30 days later, on March 17, 2022.

**Description:** Reflected Cross-Site Scripting

**Affected Plugin:** [Header Footer Code Manager](https://wordpress.org/plugins/header-footer-code-manager/)

**Plugin Slug:** header-footer-code-manager

**Plugin Developer:** 99robots

**Affected Versions:** <= 1.1.16

**CVE ID:** CVE-2022-0710

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Ramuel Gall

**Fully Patched Version:** 1.1.17

Header Footer Code Manager is a WordPress plugin designed to allow administrators to add code snippets to the header or footer of a website. One of the admin panel pages added by the plugin allows administrators to view a list of code snippets that had been added to the site, which included links to edit or delete these existing code snippets. The plugin’s column\_name function used the `$_REQUEST[‘page’]` parameter to construct this link.

WordPress uses the value of the `$_GET[‘page’]` parameter in order to determine which page the user is currently visiting, and will block unauthorized users if they’re not allowed to access the current page set in `$_GET[‘page’]`. This means that `$_REQUEST[‘page’]` might be expected to just contain the admin page used to display the list of code snippets, `hfcm-list`. However, due to a quirk of how PHP handles superglobal variables, `$_REQUEST` parameters can be overloaded.

PHP populates the `$_REQUEST` superglobal variable from `$_GET`, `$_POST`, and `$_COOKIE`. That means that normally, if a `$_GET[‘page’]` parameter is sent, `$_REQUEST[‘page’]` will be populated with the value of `$_GET[‘page’]`. In most PHP configurations, however, the `request_order` (or `variables_order` if `request_order` is not set) means that if a request is sent with both a `$_GET[‘page’]` parameter *and* a `$_POST[‘page’]` parameter, the value of `$_REQUEST[‘page’]` is set to the value of `$_POST[‘page’]`.

The upshot is that this can be used to execute JavaScript in the browser of a logged-in administrator, for instance, by tricking them into visiting a self-submitting form that sends a POST request to e.g. hxxps://victimsite.site/wp-admin/admin.php?page=hfcm-list, with the `$_POST[‘page’]` parameter set to malicious JavaScript.

The `$_GET[‘page’]` parameter means that WordPress will route the victim to the correct page, and then the value of `$_REQUEST[‘page’]` (which in nearly all configurations will be set to the value of `$_POST[‘page’]`) will get echoed out onto the page.

Most XSS can be used to perform actions using an administrator’s session, which includes the ability to create malicious administrators and in some cases add backdoors. Additionally, this particular plugin is used to add code to a site, so an attacker could also potentially leverage reflected XSS into stored XSS to attack site visitors, even on sites where file editing and user creation functionality was locked down.

## Timeline

**February 15, 2022** – The Wordfence Threat Intelligence team finishes our investigation and releases a firewall rule to Wordfence Premium, Care, and Response users to protect against any exploits targeting this vulnerability. We initiate the responsible disclosure process and receive a response from the plugin’s developers. We send over full disclosure.

**February 17, 2022** – Plugin changelog shows the issue is fixed.

**February 18, 2022** – A patched version of the plugin, 1.1.17, is released on the WordPress repo.

**March 17, 2022** – The firewall rule becomes available to free Wordfence users.

## Conclusion

In today’s article, we discussed a reflected XSS vulnerability in Header Footer Code Manager. While this would require tricking an administrator into clicking a link or performing some other action, it still offers the potential for site takeover. As such we urge you to update to the latest version of this plugin, 1.1.17 as of this writing, as soon as possible.

Sites running [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Wordfence Care](https://www.wordfence.com/products/wordfence-care/), and [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) are fully protected against this vulnerability. Sites running the free version of Wordfence are partially protected and will receive full protection on March 17, 2022.

If you believe your site has been compromised as a result of this vulnerability or any other vulnerability, we offer Incident Response services via [Wordfence Care](https://www.wordfence.com/products/wordfence-care/). If you need your site cleaned immediately, [Wordfence Response](https://www.wordfence.com/products/wordfence-response/) offers the same service with 24/7/365 availability and a 1-hour response time. Both these products include hands-on support in case you need further assistance.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected, as this is a serious vulnerability that can lead to complete site takeover.

*Thanks to Charlie Patel, CEO of 99robots, for rapidly and personally responding to our disclosure*

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F02%2Freflected-xss-in-header-footer-code-manager%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F02%2Freflected-xss-in-header-footer-code-manager%2F&text=Reflected%20XSS%20in%20Header%20Footer%20Code%20Manager&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F02%2Freflected-xss-in-header-footer-code-manager%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


