```
{
  "CVE-2022-0358": {
    "Description": "The virtiofsd in QEMU before 6.2.0-7 has a supplementary group bypass. If a user in a guest has supplementary group membership of \"root\" and changes user IDs via setresuid/setsgid, the user retains membership of supplementary groups which can allow for operations not normally permitted. For example, if the root user in the guest creates a directory with SGID set and allows unprivileged users to write to the directory, this can be exploited by an unprivileged user creating a SGID set executable in that directory. An unprivileged user can then execute it to get an egid of zero and access resources of the root group, resulting in privilege escalation.",
    "Root cause": "The virtiofsd daemon did not drop supplementary group memberships when switching user IDs, causing a privilege escalation vulnerability.",
    "Weaknesses": [
      "Improper dropping of supplementary groups",
      "Insecure file creation within a shared directory",
       "Use of setresuid/setsgid without proper supplementary group management"
    ],
    "Impact": "Privilege escalation within the guest to gain root group access by taking advantage of improper SGID permissions on files in the shared directory or privilege escalation on the host via an executable file with SGID",
    "Attack vectors": [
      "A local guest user exploits a directory with SGID set and write permissions for unprivileged users",
        "An unprivileged guest user exploits the vulnerability by creating a SGID set executable in a shared directory.",
      "A malicious host user leverages a guest-created executable with SGID to escalate privileges on the host"
    ],
    "Required attacker capabilities/position": [
      "Local user access to a guest VM with a directory shared by virtiofs",
      "Ability to create files in directories that are writeable by unprivileged users, and SGID to a specific group."
    ],
    "Additional details": [
      "The vulnerability is in how supplementary group memberships are managed when user IDs are switched using setresuid/setsgid",
      "The fix involves dropping all supplementary group memberships at the start of the process"
    ]
  }
}
```