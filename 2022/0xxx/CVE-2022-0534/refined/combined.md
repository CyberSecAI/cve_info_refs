=== Content from github.com_4fea4ba1_20250114_192647.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fissues%2F463)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fissues%2F463)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=michaelrsweet%2Fhtmldoc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[michaelrsweet](/michaelrsweet)
/
**[htmldoc](/michaelrsweet/htmldoc)**
Public

* [Notifications](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc) You must be signed in to change notification settings
* [Fork
  46](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc)
* [Star
   214](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc)

* [Code](/michaelrsweet/htmldoc)
* [Issues
  14](/michaelrsweet/htmldoc/issues)
* [Pull requests
  0](/michaelrsweet/htmldoc/pulls)
* [Discussions](/michaelrsweet/htmldoc/discussions)
* [Actions](/michaelrsweet/htmldoc/actions)
* [Projects
  0](/michaelrsweet/htmldoc/projects)
* [Security](/michaelrsweet/htmldoc/security)
* [Insights](/michaelrsweet/htmldoc/pulse)

Additional navigation options

* [Code](/michaelrsweet/htmldoc)
* [Issues](/michaelrsweet/htmldoc/issues)
* [Pull requests](/michaelrsweet/htmldoc/pulls)
* [Discussions](/michaelrsweet/htmldoc/discussions)
* [Actions](/michaelrsweet/htmldoc/actions)
* [Projects](/michaelrsweet/htmldoc/projects)
* [Security](/michaelrsweet/htmldoc/security)
* [Insights](/michaelrsweet/htmldoc/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmichaelrsweet%2Fhtmldoc%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Stack out-of-bounds read in gif\_get\_code() #463

Closed

[Jorgecmartins](/Jorgecmartins) opened this issue
Jan 7, 2022
· 5 comments

Closed

# [Stack out-of-bounds read in gif\_get\_code()](#top) #463

[Jorgecmartins](/Jorgecmartins) opened this issue
Jan 7, 2022
· 5 comments

Assignees
[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&v=4)](/michaelrsweet)

Labels
[bug](/michaelrsweet/htmldoc/labels/bug)
Something isn't working
[platform issue](/michaelrsweet/htmldoc/labels/platform%20issue)
Issue is specific to an OS or desktop
[priority-low](/michaelrsweet/htmldoc/labels/priority-low)

Milestone
[Stable](/michaelrsweet/htmldoc/milestone/1 "Stable")

## Comments

[![@Jorgecmartins](https://avatars.githubusercontent.com/u/23533883?s=80&u=336aae99af0815213289800662e5638b0085fc2b&v=4)](/Jorgecmartins)

Copy link

Contributor

### **[Jorgecmartins](/Jorgecmartins)** commented [Jan 7, 2022](#issue-1096381389)

| In `gif_get_code()`, in [image.cxx](https://github.com/michaelrsweet/htmldoc/blob/master/htmldoc/image.cxx), there is a stack out-of-bounds read in the following code:  ``` 267    curbit    = (curbit - lastbit) + 8 * last_byte; 268    last_byte += (unsigned)count; 269    lastbit   = last_byte * 8; 270  } 271 272  for (ret = 0, i = curbit + (unsigned)code_size - 1, j = (unsigned)code_size; 273       j > 0; 274       i --, j --) 275    ret = (ret << 1) | ((buf[i / 8] & bits[i & 7]) != 0); ```  The expression `curbit - lastbit`, line 267, can result in an integer overflow when `lastbit > curbit`, updating `curbit` to a large number since it is unsigned. Later on line 272 the variable `i` is set to number less than `code_size`, since `curbit + (unsigned)code_size - 1` overflows, which results after a few iterations in a stack out of bounds read in `buf[i/8]`.  I've attached [poc.zip](https://github.com/michaelrsweet/htmldoc/files/7829400/poc.zip) that contains a malicious gif and a html file and triggers the out of bounds read resulting in a segmentation fault. Steps to reproduce The following should result in a segmentation fault:  ``` $ unzip poc.zip $ htmldoc --webpage -f output.pdf crash.html  ``` Steps to analyse the crash on gdb ``` gdb --args htmldoc --webpage -f output.pdf ./crash.html # set a breakpoint on gif_get_code run continue 3 # reached the gif_get_code that will crash  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)
[michaelrsweet](/michaelrsweet)
self-assigned this
[Jan 7, 2022](#event-5858302579)

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)
[michaelrsweet](/michaelrsweet)
added
[unable-to-reproduce](/michaelrsweet/htmldoc/labels/unable-to-reproduce)
Unable to reproduce
[bug](/michaelrsweet/htmldoc/labels/bug)
Something isn't working
[platform issue](/michaelrsweet/htmldoc/labels/platform%20issue)
Issue is specific to an OS or desktop
[priority-low](/michaelrsweet/htmldoc/labels/priority-low)
and removed
[unable-to-reproduce](/michaelrsweet/htmldoc/labels/unable-to-reproduce)
Unable to reproduce
labels
[Jan 7, 2022](#event-5858312665)

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)
[michaelrsweet](/michaelrsweet)
added this to the [Stable](/michaelrsweet/htmldoc/milestone/1) milestone
[Jan 7, 2022](#event-5858349857)

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=80&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)

Copy link

Owner

### **[michaelrsweet](/michaelrsweet)** commented [Jan 7, 2022](#issuecomment-1007480892)

| [@Jorgecmartins](https://github.com/Jorgecmartins) I've tried this on macOS and Linux (Ubuntu 20.04), but only Linux reproduces. |
| --- |

All reactions

Sorry, something went wrong.

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=80&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)

Copy link

Owner

### **[michaelrsweet](/michaelrsweet)** commented [Jan 7, 2022](#issuecomment-1007491713)

| [master [776cf0f](https://github.com/michaelrsweet/htmldoc/commit/776cf0fc4c760f1fb7b966ce28dc92dd7d44ed50)] Fix potential stack overflow with GIF images (Issue [#463](https://github.com/michaelrsweet/htmldoc/issues/463)) |
| --- |

All reactions

Sorry, something went wrong.

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)
[michaelrsweet](/michaelrsweet)
closed this as [completed](/michaelrsweet/htmldoc/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 7, 2022](#event-5858432106)

[michaelrsweet](/michaelrsweet)
added a commit
that referenced
this issue
[Jan 7, 2022](#ref-commit-776cf0f)
[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)

`[Fix potential stack overflow with GIF images (Issue](/michaelrsweet/htmldoc/commit/776cf0fc4c760f1fb7b966ce28dc92dd7d44ed50 "Fix potential stack overflow with GIF images (Issue #463)") [#463](https://github.com/michaelrsweet/htmldoc/issues/463)[)](/michaelrsweet/htmldoc/commit/776cf0fc4c760f1fb7b966ce28dc92dd7d44ed50 "Fix potential stack overflow with GIF images (Issue #463)")`

`[776cf0f](/michaelrsweet/htmldoc/commit/776cf0fc4c760f1fb7b966ce28dc92dd7d44ed50)`

[![@Jorgecmartins](https://avatars.githubusercontent.com/u/23533883?s=80&u=336aae99af0815213289800662e5638b0085fc2b&v=4)](/Jorgecmartins)

Copy link

Contributor

Author

### **[Jorgecmartins](/Jorgecmartins)** commented [Jan 7, 2022](#issuecomment-1007674857)

| [@Jorgecmartins](https://github.com/Jorgecmartins) I've tried this on macOS and Linux (Ubuntu 20.04), but only Linux reproduces.  [@michaelrsweet](https://github.com/michaelrsweet) I was also able to reproduce it on macOS.  ``` Jorge@MacBook-Pro-de-Jorge htmldoc % ./htmldoc --webpage -f output.pdf ./crash.html ERR005: Unable to open psglyphs data file! ERR005: Unable to open character set file iso-8859-1! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Times-Roman.afm! ERR005: Unable to open psglyphs data file! ERR005: Unable to open character set file iso-8859-1! ERR005: Unable to open psglyphs data file! ERR005: Unable to open character set file iso-8859-1! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! ERR005: Unable to open font width file /usr/local/share/htmldoc/fonts/Helvetica.afm! PAGES: 2 ERR005: Unable to open font file /usr/local/share/htmldoc/fonts/Helvetica.pfa! zsh: segmentation fault  ./htmldoc --webpage -f output.pdf ./crash.html  ```  macOS version: 11.6  ``` Jorge@MacBook-Pro-de-Jorge htmldoc % uname -a Darwin MacBook-Pro-de-Jorge.local 20.6.0 Darwin Kernel Version 20.6.0: Mon Aug 30 06:12:21 PDT 2021; root:xnu-7195.141.6~3/RELEASE_X86_64 x86_64  ``` |
| --- |

All reactions

Sorry, something went wrong.

[michaelrsweet](/michaelrsweet)
added a commit
that referenced
this issue
[Jan 7, 2022](#ref-commit-312f0f9)
[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)

`[Block GIF images with a code size > 12 (Issue](/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9 "Block GIF images with a code size > 12 (Issue #463)") [#463](https://github.com/michaelrsweet/htmldoc/issues/463)[)](/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9 "Block GIF images with a code size > 12 (Issue #463)")`

`[312f0f9](/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)`

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=80&u=4e7b123b09469a7af9afd8350920ebdd6d7c2a66&v=4)](/michaelrsweet)

Copy link

Owner

### **[michaelrsweet](/michaelrsweet)** commented [Jan 7, 2022](#issuecomment-1007815551)

| [@Jorgecmartins](https://github.com/Jorgecmartins) I added another layer of protection here:  [master [312f0f9](https://github.com/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)] Block GIF images with a code size > 12 (Issue [#463](https://github.com/michaelrsweet/htmldoc/issues/463)) |
| --- |

All reactions

Sorry, something went wrong.

[![@Jorgecmartins](https://avatars.githubusercontent.com/u/23533883?s=80&u=336aae99af0815213289800662e5638b0085fc2b&v=4)](/Jorgecmartins)

Copy link

Contributor

Author

### **[Jorgecmartins](/Jorgecmartins)** commented [Jan 10, 2022](#issuecomment-1008939574)

| [@Jorgecmartins](https://github.com/Jorgecmartins) I added another layer of protection here:  [master [312f0f9](https://github.com/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)] Block GIF images with a code size > 12 (Issue [#463](https://github.com/michaelrsweet/htmldoc/issues/463))  [@michaelrsweet](https://github.com/michaelrsweet) The extra protection fixed the issue. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fissues%2F463)

Assignees

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&v=4)](/michaelrsweet) [michaelrsweet](/michaelrsweet)

Labels

[bug](/michaelrsweet/htmldoc/labels/bug)
Something isn't working
[platform issue](/michaelrsweet/htmldoc/labels/platform%20issue)
Issue is specific to an OS or desktop
[priority-low](/michaelrsweet/htmldoc/labels/priority-low)

Projects

None yet

Milestone

 [**Stable**](/michaelrsweet/htmldoc/milestone/1 "Stable")

Development

No branches or pull requests

2 participants

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=52&v=4)](/michaelrsweet) [![@Jorgecmartins](https://avatars.githubusercontent.com/u/23533883?s=52&v=4)](/Jorgecmartins)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_9fbf466e_20250114_192647.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 2928-1] htmldoc security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2928-1] htmldoc security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sat, 26 Feb 2022 11:20:58 +0000 (UTC)
* *Message-id*: <[[🔎]](/msgid-search/alpine.DEB.2.21.2202261119350.21110%40postfach.intern.alteholz.me) [alpine.DEB.2.21.2202261119350.21110@postfach.intern.alteholz.me](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2928-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                    Thorsten Alteholz
February 26, 2022                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : htmldoc
Version        : 1.8.27-8+deb9u2
CVE ID         : CVE-2021-40985 CVE-2021-43579 CVE-2022-0534

```
Several issues have been found in htmldoc, an HTML processor that
generates indexed HTML, PS, and PDF.
```

CVE-2022-0534

     A crafted GIF file could lead to a stack out-of-bounds read,
     which could result in a crash (segmentation fault).

CVE-2021-43579

     Converting an HTML document, which links to a crafted BMP file,
     could lead to a stack-based buffer overflow, which could result
     in remote code execution.

CVE-2021-40985

     A crafted BMP image could lead to a buffer overflow, which could
     cause a denial of service.

For Debian 9 stretch, these problems have been fixed in version
1.8.27-8+deb9u2.

We recommend that you upgrade your htmldoc packages.

For the detailed security status of htmldoc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/htmldoc>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAmIaDRpfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEcf7hAAtZQth4nBFoJEu7y0Iy77V2jUniYs4qetEyJ8E3/J8VUzdfHkp47rWQVc
SqVOEk4PQl0qh6/kFnWe+8CJz0FQM2erXvRKGy/5IGxhsi8xkbvvjoFHQbeWJt57
dvJvdLXke/ZlEsFJWJKUJZBKYJGHypGZz8L4MIVTno/hQcD8ahapO1w0zWLA2lgK
1z1F6YbLKos2jtw1lyZvfxkvgKPB/KLmhh7WdgBM4OxmlgsutGhbewqMEZROy/Ct
FXX6k5T9v4ILN+aePsvY0YRyHqJPHLVNFzKcvLIuiiqivMvxW+kWbawvP+q5aXBz
zbV8SVv7+vT0yH3cTBfzAH6XHDrGvSzAB1nxmIdTw/youYuwxlpguXv6BQiILHHP
sc1zWB9gu25uZRORAfFLm2Wrw+pje4QyRsGjGxmXp0HoMjwEFaJ3MY7sOYfsEJc5
lVknTAgSF8D9FehMPQ0L16DpDDc1+ZjHaJ3zrGUzNEZeVvlQCEBrJSZKhadbEjEb
/UJX4QzgPJ1utUWrEju8SBSX6zo7OpZQWmd4MYNrCpqR1csA0fvKp7VfRrrTzkX0
hz7VZfpyDMYjtpxl4o3hHQTO1j5weulBJVHjy0MXUAKdrUi/QPuBLcyf5pWSGXAN
kEwUbEap7uxyICuXeRRKI3vLZyl5rfmMJ1hhmKQsRXHkP4axA9k=
=Xqwr
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_af980257_20250114_192646.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fcommit%2F312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fcommit%2F312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=michaelrsweet%2Fhtmldoc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[michaelrsweet](/michaelrsweet)
/
**[htmldoc](/michaelrsweet/htmldoc)**
Public

* [Notifications](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc) You must be signed in to change notification settings
* [Fork
  46](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc)
* [Star
   214](/login?return_to=%2Fmichaelrsweet%2Fhtmldoc)

* [Code](/michaelrsweet/htmldoc)
* [Issues
  14](/michaelrsweet/htmldoc/issues)
* [Pull requests
  0](/michaelrsweet/htmldoc/pulls)
* [Discussions](/michaelrsweet/htmldoc/discussions)
* [Actions](/michaelrsweet/htmldoc/actions)
* [Projects
  0](/michaelrsweet/htmldoc/projects)
* [Security](/michaelrsweet/htmldoc/security)
* [Insights](/michaelrsweet/htmldoc/pulse)

Additional navigation options

* [Code](/michaelrsweet/htmldoc)
* [Issues](/michaelrsweet/htmldoc/issues)
* [Pull requests](/michaelrsweet/htmldoc/pulls)
* [Discussions](/michaelrsweet/htmldoc/discussions)
* [Actions](/michaelrsweet/htmldoc/actions)
* [Projects](/michaelrsweet/htmldoc/projects)
* [Security](/michaelrsweet/htmldoc/security)
* [Insights](/michaelrsweet/htmldoc/pulse)

## Commit

[Permalink](/michaelrsweet/htmldoc/commit/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Block GIF images with a code size > 12 (Issue [#463](https://github.com/michaelrsweet/htmldoc/issues/463))

[Browse files](/michaelrsweet/htmldoc/tree/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9)
Browse the repository at this point in the history

* Loading branch information

[![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=40&v=4)](/michaelrsweet)

[michaelrsweet](/michaelrsweet/htmldoc/commits?author=michaelrsweet "View all commits by michaelrsweet")
committed
Jan 7, 2022

1 parent
[7ca4694](/michaelrsweet/htmldoc/commit/7ca469404050cbf2295b9cbf37208c88822b02c9)

commit 312f0f9

Showing
**1 changed file**
with
**7 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

8 changes: 7 additions & 1 deletion

8
[htmldoc/image.cxx](#diff-65fe596e4c3fa8759de89bf71af4e09bb99699a67da468fbb4556171f37dbbd9 "htmldoc/image.cxx")

Show comments

[View file](/michaelrsweet/htmldoc/blob/312f0f9c12f26fbe015cd0e6cefa40e4b99017d9/htmldoc/image.cxx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -305,6 +305,12 @@ gif\_read\_image(FILE \*fp, /\* I - Input file \*/ |
|  |  | pass = 0; |
|  |  | code\_size = (uchar)getc(fp); |
|  |  |  |
|  |  | if (code\_size > 12) |
|  |  | { |
|  |  | progress\_error(HD\_ERROR\_READ\_ERROR, "Bad GIF file \"%s\" - invalid code size %d.", img->filename, code\_size); |
|  |  | return (-1); |
|  |  | } |
|  |  |  |
|  |  | if (gif\_read\_lzw(fp, 1, code\_size) < 0) |
|  |  | return (-1); |
|  |  |  |
| Expand Down  Expand Up | | @@ -432,7 +438,7 @@ gif\_read\_lzw(FILE \*fp, /\* I - File to read from \*/ |
|  |  | if (sp > stack) |
|  |  | return (\*--sp); |
|  |  |  |
|  |  | while ((code = gif\_get\_code (fp, code\_size, 0)) >= 0) |
|  |  | while ((code = gif\_get\_code(fp, code\_size, 0)) >= 0) |
|  |  | { |
|  |  | if (code == clear\_code) |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `312f0f9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmichaelrsweet%2Fhtmldoc%2Fcommit%2F312f0f9c12f26fbe015cd0e6cefa40e4b99017d9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


