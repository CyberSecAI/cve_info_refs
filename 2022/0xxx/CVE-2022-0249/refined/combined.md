=== Content from gitlab.com_4c144420_20250115_082558.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-0249.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-0249.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-0249.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-0249.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 12, 2022

  [632d7e8c](/gitlab-org/cves/-/commit/632d7e8c865a87b3dd254c989cfdb583adcbe8e7)
  [Publishing 3 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/632d7e8c865a87b3dd254c989cfdb583adcbe8e7)
  ·
  632d7e8c

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

  632d7e8c

  [Publishing 3 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/632d7e8c865a87b3dd254c989cfdb583adcbe8e7)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

Loading



=== Content from gitlab.com_92d72669_20250115_082558.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SSRF possible due to shared address space not being blocked.

**[HackerOne report #579934](https://hackerone.com/reports/579934)** by `no1zy` on 2019-05-14, assigned to `estrike`:

### Summary

Because `/lib/gitlab/url_blocker.rb` does not block shared address space, [SSRF](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery) is possible.

### Steps to reproduce

1. Go to [http://{host}/projects/new](http://%7Bhost%7D/projects/new)".
2. Click to "Repo by URL".
3. Enter the following in Git repository URL field. `http://100.64.0.5:9999/ssrf`
4. Enter other required fields.
5. Click to "Create project".

```
GET /ssrf/info/refs?service=git-upload-pack HTTP/1.1
Host: 100.64.0.5:9999
User-Agent: git/2.18.1
Accept: */*
Accept-Encoding: deflate, gzip
Pragma: no-cache

```

6. If you want to send parameters, specify the URL as follows:

```
http://100.64.0.5:9999/ssrf?param=true#
```

```
GET /ssrf?param=true HTTP/1.1
Host: 100.64.0.5:9999
User-Agent: git/2.18.1
Accept: */*
Accept-Encoding: deflate, gzip
Pragma: no-cache

```

## Impact

The shared address space is used as a private network address by the ISP.

Reference: <https://en.wikipedia.org/wiki/IPv4_shared_address_space>

This issue affects all actions using `/lib/gitlab/url_blocker.rb`.

## Proposal

To fix this issue, also block the `100.64.0.0/10` netmask.

Edited Oct 11, 2021 by [Sean Carroll](/sean_carroll)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


