=== Content from huntr.dev_291fa142_20250114_214320.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)

=== Content from notes.netbytesec.com_19e98ffe_20250114_214322.html ===

[Skip to main content](#main)

# [NetbyteSEC Blog](https://notes.netbytesec.com/)

Search

### Search This Blog

### Broken Access Control To Post-Auth Remote Code Execution in Webmin

on

[3/09/2022 11:05:00 AM](https://notes.netbytesec.com/2022/03/webmin-broken-access-control-to-post-auth-rce.html "permanent link")

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

NetbyteSEC Security Advisory - Broken Access Control To Post-Auth Remote Code Execution in Webmin

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiQ9_DKmeQhLUxS79eS0dF9KvsXn-JzLS3FGW4LiWUXCi905TwEF0nWK_TOW-S27HlOvaflX1GaYHecOhp5KZMDPgMywlCmb7aRF0BhVnipamoTKkbHMo-UMra7R7OiLCCocpz1pB8KrfrfF_FwKmshnbjYGGjTSEKZm0oZ-yQIjqQOSF3eraLHQ6v9KVfi/s16000/6f14304413eaa9ccc0b7f2c1cb791042534d3fc2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiQ9_DKmeQhLUxS79eS0dF9KvsXn-JzLS3FGW4LiWUXCi905TwEF0nWK_TOW-S27HlOvaflX1GaYHecOhp5KZMDPgMywlCmb7aRF0BhVnipamoTKkbHMo-UMra7R7OiLCCocpz1pB8KrfrfF_FwKmshnbjYGGjTSEKZm0oZ-yQIjqQOSF3eraLHQ6v9KVfi/s2688/6f14304413eaa9ccc0b7f2c1cb791042534d3fc2.png)

**Title:** Broken Access Control To Post-Auth Remote Code Execution in Webmin
**Advisory ID:** NBS-2022-0002
**Product:** Webmin
**Vulnerable Version:** <= 1.984
**Fixed Version:** 1.990
**CVE ID:** CVE-2022-0824, CVE-2022-0829
**Homepage:** https://www.webmin.com/
**Date of Discovery:** Feb 17th 2022
**Author:** Mohammad Faisal Sammio | NetbyteSEC

**Vendor/product description:**

Webmin is a web-based system administration tool for Unix-like servers, and services with over 1,000,000 installations worldwide. Using it, it is possible to configure operating system internals, such as users, disk quotas, services or configuration files, as well as modify, and control open-source apps, such as BIND DNS Server, Apache HTTP Server, PHP, MySQL, and many more.

*Source: https://github.com/webmin/webmin*

**Vulnerabilities:**

1) Improper Access Control to Post-Auth Remote Code Execution

CVE-ID: CVE-2022-0824
Risk: High, \*Webmin marks as Critical
Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
Reference: https://nvd.nist.gov/vuln/detail/CVE-2022-0824
Description:

In Webmin v1.984, affecting the File Manager module, any authenticated low privilege user without access rights to the File Manager module could interact with second-level file manager functionalities such as download file from remote URL and change file permission (chmod). It is possible to achieve Remote Code Execution via a crafted .cgi file by chaining those functionalities in the file manager. This vulnerability is capable of modifying the OS file system and executing OS Command with root privileges.

Proof of Concept:

The underlying reason is that the CGI scripts in authentic-theme/extensions/file-manager did not properly check that the user has access to the File Manager module. Apparently, the default behaviour in Webmin for second-level access control for users who do not have access to a module is to grant maximal privileges because the Webmin believed that the primary check would prohibit them although it is not.

The first-level user access control functionalities such as
save\_file.cgi, upload.cgi, download.cgi and edit\_file.cgi checking is properly
done and protected so we could not abuse them to have write access to the
server. Therefore, we have to discover the functionalities that are accessible
by the second-level user access control to attain write access in order to
place our CGI script. Fortunately, there is an endpoint that allows us to place
our CGI script from a remote URL called http\_download.cgi. Nevertheless, we
could not execute that CGI script as the permission is *-rw-r--r-- (644)* [1]
even we already have write access as shown in the code snippet below where the
Perl subroutine of *set\_ownership\_permissions(user, group, perms, file)*
in line 48 shows that the 3rd argument which is perms argument is set to *undef*
that refer to default umask value. When a user creates a file or directory in
Linux or UNIX system, the permissions are set to the defaults. The root user's
default umask is 022, which results in default directory permissions of 755 and
default file permissions of 644.

File: \filemin\http\_download.cgi - Line 48

[...]
        *&set\_ownership\_permissions($st[4], $st[5], undef, $full);*   //[1] 3rd argument, perms is set to *undef*
        @st = stat($cwd);
        print &text('http\_done', &nice\_size($st[7]),
                "<tt>".&html\_escape($full)."</tt>"),"<p>\n";
        &ui\_print\_footer("index.cgi?path=".&urlize($path),
                 $text{'previous\_page'});
[...]

Further discovering allows us to identify an endpoint that could be used to modify the file permission called chmod.cgi which is self-explanatory. To achieve remote code execution as root privileges, it is sufficient to take advantage of two (2) second-level user access control accessible functionalities which are http\_download.cgi and chmod.cgi endpoints as demonstrated in [GitHub](https://github.com/faisalfs10x/Webmin-CVE-2022-0824-revshell). *PoC: <https://github.com/faisalfs10x/Webmin-CVE-2022-0824-revshell>*

2) Improper Authorization in Scheduled Cron Jobs Module

CVE-ID: CVE-2022-0829
Risk: High
Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
Reference: https://nvd.nist.gov/vuln/detail/CVE-2022-0829
Description:

The /cron/save\_allow.cgi endpoint is accessible to any authenticated low privilege users resulting in controlling user access to cron jobs. They could allow and deny other users access to cron jobs affecting the Scheduled Cron Jobs module. This vulnerability is capable of modifying or restricting access to a system function outside the user's limits.

Proof of Concept:

File: \cron\save\_allow.cgi - The save\_allow.cgi endpoint is missing ACL permissions check. Hence, any low privilege user with access to the cron module could allow or restrict other users' access to the cron making the system user is unable to run scheduled tasks.

\*\*\* Developer fixed, adding ACL permission check [1] will fix the issue.

[...]
require './cron-lib.pl';
&ReadParse();

$access{'allow'} || &error($text{'allow\_ecannot'});   //[1] add ACL permission check here

&lock\_file($config{cron\_allow\_file});
&lock\_file($config{cron\_deny\_file});
unlink($config{cron\_allow\_file});
unlink($config{cron\_deny\_file});
if ($in{mode} == 1) { &save\_allowed(split(/\s+/, $in{'allow'})); }
elsif ($in{mode} == 2) { &save\_denied(split(/\s+/, $in{'deny'})); }
&unlock\_file($config{cron\_allow\_file});
&unlock\_file($config{cron\_deny\_file});
&webmin\_log("allow");
&redirect("");
[...]

**Solution:**

Update to the latest version 1.990. All systems with additional untrusted Webmin users should upgrade immediately.

**Vendor Contact Timeline:**
2022-02-17: Contact Webmin Security Contact (Jamie Cameron) via security[at]webmin.com
2022-02-21: Vendor response with acknowledgement and confirms security issue.
2022-03-03: Vendor releases security advisory and patches is available on version 1.990.
2022-03-06: Public release of security advisory.

NetByteSEC Sdn Bhd
===================
NetbyteSEC Sdn Bhd was incorporated under the Malaysian Companies Act 1965 in 2013.
NetbyteSEC is privately owned and is based in Cyberjaya, Selangor, Malaysia.
More information about NetbyteSEC Sdn Bhd can be found at:
https://www.netbytesec.com

[Advisory](https://notes.netbytesec.com/search/label/Advisory)
[CVE](https://notes.netbytesec.com/search/label/CVE)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular Posts

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhwW22izK9X3czli4MQKOKWGEbJBudpJxiQC8pmaJd4a56tc3QILMrDE3vyKLnejuKtM-HNKXk5VKUWZ9Qhc_5O8IBy6srxsHBIfTl3_NcfNLuyVpeUi9770GLPDf_iRvItFgR_VFgVXo_U-G6JzPEbCZ5AvDBsQ_yB-BHSN3Rc5Y65SyO58zdjzEuEZQ/s16000/Snipaste_2023-06-15_04-25-01.png)](https://notes.netbytesec.com/2023/06/install-elastic-kibana.html)
### [Detection Engineering Part 1: Setting up Elastic, Kibana and Fleet Server for SIEM and EDR](https://notes.netbytesec.com/2023/06/install-elastic-kibana.html)

This post was authored by Fareed. Introduction In this quick guide, we will walk you through the process of installing and setting up Elastic 8 with Kibana and Fleet. Elastic Stack is a powerful open-source solution that enables efficient data management and analysis, along with robust security capabilities. By following this guide, you'll be able to get started with Elastic 8 swiftly, connect it with Kibana, and leverage Fleet to connect to the advanced security features provided by Elastic Security. Let's dive in and unlock the potential of these essential tools for your data management and security needs.

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguwyD_mINEGrNTJw3WnREHquNhqs8C3qE5mrrgGjL7TMDbesK5oYjQ2eNcLzZfcERNFpRDUFY1z4JsuBJFMNmaCvAMEehWK7t2eRTr54MMdtLlS8SnE9xclrsEGWBVoO59HAmIk6sgUz0Ca_AHU_MoE2PJuAYiVPc3LnQ9qMDbOfHBuFt1FysI_NJeNkpq/w640-h640/OIG.jpg)](https://notes.netbytesec.com/2024/01/increase-max-index-size-and-archive.html)
### [Increase Max Index Size and Archive Indexed Data](https://notes.netbytesec.com/2024/01/increase-max-index-size-and-archive.html)

This post was authored by Detecx team NetbyteSec Introduction In the dynamic realm of data analytics and log management, Splunk stands as a powerful tool, transforming raw data into actionable insight. In this article, we want to explain about the complexities of Splunk indexing, focusing on crucial aspect that can significantly impact your system's availability.

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglSXFYeQSn5hGvkDAgHWKfNh6jeoAdzSFfX-bWOWDmXTdiVjUfYdTdW1n4Byi4K1B1zwLha5p9DQ5GbiEIw8QguSUFTGp1g-SPt7PUhMHoZPQRobF92et_sXwzSGVCljV6fsLC0wkMSXA58yET465fRhvfKLBhQPW9sxEhBHUwT7I8c4GmwvHgP9odcs53/s16000/soar%20token.png)](https://notes.netbytesec.com/2024/01/empowering-your-splunk-soar-enriching.html)
### [Empowering Your Splunk SOAR: Enriching with Splunk Enterprise Events for Next-Level Security Optimization](https://notes.netbytesec.com/2024/01/empowering-your-splunk-soar-enriching.html)

This post was authored by Detecx team NetbyteSec Introduction This blogpost is highlighting on a journey of the powerful collaboration between Splunk Enterprise and Splunk SOAR. We will explore the essential process of ingesting security events from Splunk Enterprise to Splunk SOAR. Discover how this integration creates a complete security solution, not just analyzing events but also automating responses for a more proactive approach. Splunk SOAR User Configuration

[Powered by Blogger](https://www.blogger.com)



=== Content from github.com_46920b80_20250114_214320.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2Feeeea3c097f5cc473770119f7ac61f1dcfa671b9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2Feeeea3c097f5cc473770119f7ac61f1dcfa671b9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=webmin%2Fwebmin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[webmin](/webmin)
/
**[webmin](/webmin/webmin)**
Public

* [Notifications](/login?return_to=%2Fwebmin%2Fwebmin) You must be signed in to change notification settings
* [Fork
  659](/login?return_to=%2Fwebmin%2Fwebmin)
* [Star
   4.5k](/login?return_to=%2Fwebmin%2Fwebmin)

* [Code](/webmin/webmin)
* [Issues
  487](/webmin/webmin/issues)
* [Pull requests
  30](/webmin/webmin/pulls)
* [Discussions](/webmin/webmin/discussions)
* [Actions](/webmin/webmin/actions)
* [Projects
  0](/webmin/webmin/projects)
* [Wiki](/webmin/webmin/wiki)
* [Security](/webmin/webmin/security)
* [Insights](/webmin/webmin/pulse)

Additional navigation options

* [Code](/webmin/webmin)
* [Issues](/webmin/webmin/issues)
* [Pull requests](/webmin/webmin/pulls)
* [Discussions](/webmin/webmin/discussions)
* [Actions](/webmin/webmin/actions)
* [Projects](/webmin/webmin/projects)
* [Wiki](/webmin/webmin/wiki)
* [Security](/webmin/webmin/security)
* [Insights](/webmin/webmin/pulse)

## Commit

[Permalink](/webmin/webmin/commit/eeeea3c097f5cc473770119f7ac61f1dcfa671b9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add missing permissions check when saving allowed cron users

[Browse files](/webmin/webmin/tree/eeeea3c097f5cc473770119f7ac61f1dcfa671b9)
Browse the repository at this point in the history

* Loading branch information

[![@jcameron](https://avatars.githubusercontent.com/u/102706?s=40&v=4)](/jcameron)

[jcameron](/webmin/webmin/commits?author=jcameron "View all commits by jcameron")
committed
Feb 19, 2022

1 parent
[f472208](/webmin/webmin/commit/f4722088945809b895f26566c0f20ddddcf11ec9)

commit eeeea3c

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[cron/save\_allow.cgi](#diff-846f93580c1d69a390c1e6dfd46b7aa2641715e105670e8211d58bc371f0f235 "cron/save_allow.cgi")

Show comments

[View file](/webmin/webmin/blob/eeeea3c097f5cc473770119f7ac61f1dcfa671b9/cron/save_allow.cgi)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  |  |
|  |  | require './cron-lib.pl'; |
|  |  | &ReadParse(); |
|  |  | $access{'allow'} || &error($text{'allow\_ecannot'}); |
|  |  |  |
|  |  | &lock\_file($config{cron\_allow\_file}); |
|  |  | &lock\_file($config{cron\_deny\_file}); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `eeeea3c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwebmin%2Fwebmin%2Fcommit%2Feeeea3c097f5cc473770119f7ac61f1dcfa671b9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


