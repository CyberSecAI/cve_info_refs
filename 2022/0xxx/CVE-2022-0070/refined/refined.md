```
{
  "CVE-2022-0070": {
    "match": true,
    "information": [
      {
        "source": "unit42.paloaltonetworks.com_52443d3e_20250114_223415.html",
        "root_cause": "AWS's hot patch solutions continuously search for Java processes and patch them against Log4Shell on the fly. To patch Java processes inside containers, the hot patch solutions invoke certain container binaries. For example, they run the container's \"java\" binary twice: once to retrieve the Java version, and again to inject the hot patch. The issue was that they invoked container binaries without properly containerizing them. That is, the new processes would run without the limitations normally applied to container processes.",
        "weaknesses": [
          "The \"java\" binary was invoked in the container namespaces via the nsenter command (excluding the user namespace). But aside from that, it was spawned with all Linux capabilities, and without the isolation technologies that normally confine containers, such as seccomp and cgroups. It also ran as the root user regardless of the container's user.",
           "A malicious container could include a malicious binary named “java” to trick the installed hot patch solution into invoking it with elevated privileges."
        ],
        "impact": "A malicious \"java\" process could abuse its elevated privileges to escape the container and take over the underlying host. Unprivileged processes can also exploit the patch service to escalate privileges and gain root code execution.",
        "attack_vectors": [
          "A malicious container could include a malicious binary named “java” to trick the hot patch service.",
          "A malicious unprivileged process could have created and run a malicious binary named \"java\" to trick the hot patch service into executing it with elevated privileges."
        ],
         "attacker_capabilities": "An attacker needs to have control over a container or an unprivileged process on a host with a vulnerable hot patch."
      },
          {
        "source": "alas.aws.amazon.com_da78a0db_20250114_223412.html",
        "description": "The Apache Log4j hotpatch package starting with log4j-cve-2021-44228-hotpatch-1.1-16 will now explicitly mimic the Linux capabilities and cgroups of the target Java process that the hotpatch is applied to."
      }
    ]
  }
}
```