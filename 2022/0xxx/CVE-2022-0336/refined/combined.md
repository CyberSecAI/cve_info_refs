=== Content from access.redhat.com_95b9f476_20250115_115157.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_f273966a_20250114_195040.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F1a5dc817c0c9379bbaab14c676681b42b0039a3c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F1a5dc817c0c9379bbaab14c676681b42b0039a3c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=samba-team%2Fsamba)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[samba-team](/samba-team)
/
**[samba](/samba-team/samba)**
Public

* [Notifications](/login?return_to=%2Fsamba-team%2Fsamba) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2Fsamba-team%2Fsamba)
* [Star
   932](/login?return_to=%2Fsamba-team%2Fsamba)

* [Code](/samba-team/samba)
* [Pull requests
  0](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

Additional navigation options

* [Code](/samba-team/samba)
* [Pull requests](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

## Commit

[Permalink](/samba-team/samba/commit/1a5dc817c0c9379bbaab14c676681b42b0039a3c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[CVE-2022-0336](https://github.com/advisories/GHSA-rg44-hwh5-vcpq "CVE-2022-0336"): s4/dsdb/samldb: Don't return early when an SPN is re-a…

[Browse files](/samba-team/samba/tree/1a5dc817c0c9379bbaab14c676681b42b0039a3c)
Browse the repository at this point in the history

```
…dded to an object

If an added SPN already exists on an object, we still want to check the
rest of the element values for conflicts.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14950>

Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

* Loading branch information

[![@jsutton24](https://avatars.githubusercontent.com/u/86935448?s=40&v=4)](/jsutton24) [![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=40&v=4)](/metze-samba)

[jsutton24](/samba-team/samba/commits?author=jsutton24 "View all commits by jsutton24")
authored and
[metze-samba](/samba-team/samba/commits?author=metze-samba "View all commits by metze-samba")
committed
Jan 31, 2022

1 parent
[c58ede4](/samba-team/samba/commit/c58ede44f382bd0125f761f0479c8d48156be400)

commit 1a5dc81

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**1 addition**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* selftest/knownfail.d

  + selftest/knownfail.d/ldap\_spn
    [ldap\_spn](#diff-588d63a795e57ddd9aa721cd81541dba00049a2feb1efef70374f77a25dceb8a)
* source4/dsdb/samdb/ldb\_modules

  + source4/dsdb/samdb/ldb\_modules/samldb.c
    [samldb.c](#diff-b23286c3753eb90fc96538cd65ba1d71e029d1823717d9f0a5074c81a5703aad)

## There are no files selected for viewing

1 change: 0 additions & 1 deletion

1
[selftest/knownfail.d/ldap\_spn](#diff-588d63a795e57ddd9aa721cd81541dba00049a2feb1efef70374f77a25dceb8a "selftest/knownfail.d/ldap_spn")

Show comments

[View file](/samba-team/samba/blob/1a5dc817c0c9379bbaab14c676681b42b0039a3c/selftest/knownfail.d/ldap_spn)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,2 +1 @@ |
|  |  | samba.tests.ldap\_spn.+LdapSpnTest.test\_spn\_dodgy\_spns |
|  |  | samba.tests.ldap\_spn.+LdapSpnSambaOnlyTest.test\_spn\_add\_a\_conflict\_along\_with\_a\_re\_added\_SPN |

3 changes: 1 addition & 2 deletions

3
[source4/dsdb/samdb/ldb\_modules/samldb.c](#diff-b23286c3753eb90fc96538cd65ba1d71e029d1823717d9f0a5074c81a5703aad "source4/dsdb/samdb/ldb_modules/samldb.c")

Show comments

[View file](/samba-team/samba/blob/1a5dc817c0c9379bbaab14c676681b42b0039a3c/source4/dsdb/samdb/ldb_modules/samldb.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4006,8 +4006,7 @@ static int samldb\_spn\_uniqueness\_check(struct samldb\_ctx \*ac, |
|  |  | ac->msg->dn); |
|  |  | if (ret == LDB\_ERR\_COMPARE\_TRUE) { |
|  |  | DBG\_INFO("SPN %s re-added to the same object\n", spn); |
|  |  | talloc\_free(tmp\_ctx); |
|  |  | return LDB\_SUCCESS; |
|  |  | continue; |
|  |  | } |
|  |  | if (ret != LDB\_SUCCESS) { |
|  |  | DBG\_ERR("SPN %s failed direct uniqueness check\n", spn); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1a5dc81`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2F1a5dc817c0c9379bbaab14c676681b42b0039a3c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.samba.org_9537c5c4_20250114_195038.html ===


The Samba-Bugzilla – Bug 14950
CVE-2022-0336 [SECURITY] Re-adding an SPN skips subsequent SPN conflict checks
Last modified: 2022-12-16 12:07:38 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=14950&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=14950&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 14950**](show_bug.cgi?id=14950)
(CVE-2022-0336)
- CVE-2022-0336 [SECURITY] Re-adding an SPN skips subsequent SPN conflict checks

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-0336 [SECURITY] Re-adding an SPN skips subsequent SPN conflict checks

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-0336 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Samba 4.1 and newer | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Samba 4.1 and newer "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | AD: LDB/DSDB/SAMDB ([show other bugs](buglist.cgi?component=AD%3A%20LDB%2FDSDB%2FSAMDB&product=Samba%204.1%20and%20newer&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.15.0 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 normal ([vote](page.cgi?id=voting/user.html&bug_id=14950#vote_14950)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Samba QA Contact | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Samba QA Contact | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-01-17 23:29 UTC by Jennifer Sutton | | --- | --- | | Modified: | 2022-12-16 12:07 UTC ([History](show_activity.cgi?id=14950)) | | CC List: | 3 users (show)  dbagnall jsutton keesvanvloten | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [14706](show_bug.cgi?id=14706 "RESOLVED FIXED") | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**Patch for master**](attachment.cgi?id=17100 "View the content of the attachment") (3.58 KB, patch)  [2022-01-18 01:21 UTC](#attach_17100 "Go to the comment associated with the attachment"), Jennifer Sutton | dbagnall: review+ | [Details](attachment.cgi?id=17100&action=edit) | | [**Patch for 4.15**](attachment.cgi?id=17101 "View the content of the attachment") (3.58 KB, patch)  [2022-01-18 01:22 UTC](#attach_17101 "Go to the comment associated with the attachment"), Jennifer Sutton | dbagnall: review+ | [Details](attachment.cgi?id=17101&action=edit) | | [**Patch for 4.14**](attachment.cgi?id=17102 "View the content of the attachment") (3.58 KB, patch)  [2022-01-18 01:22 UTC](#attach_17102 "Go to the comment associated with the attachment"), Jennifer Sutton | dbagnall: review+ | [Details](attachment.cgi?id=17102&action=edit) | | [**Patch for 4.13**](attachment.cgi?id=17103 "View the content of the attachment") (3.58 KB, patch)  [2022-01-18 01:22 UTC](#attach_17103 "Go to the comment associated with the attachment"), Jennifer Sutton | dbagnall: review+  jsutton: ci-passed+ | [Details](attachment.cgi?id=17103&action=edit) | | [**Advisory v1**](attachment.cgi?id=17105 "View the content of the attachment") (2.02 KB, text/plain)  [2022-01-20 04:01 UTC](#attach_17105 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17105&action=edit) | | [**Advisory v2**](attachment.cgi?id=17106 "View the content of the attachment") (2.03 KB, text/plain)  [2022-01-20 04:11 UTC](#attach_17106 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17106&action=edit) | | [**advisory v3**](attachment.cgi?id=17108 "View the content of the attachment") (2.04 KB, text/plain)  [2022-01-21 01:19 UTC](#attach_17108 "Go to the comment associated with the attachment"), Douglas Bagnall | *no flags* | [Details](attachment.cgi?id=17108&action=edit) | | [**advisory v4 -- with CVE**](attachment.cgi?id=17109 "View the content of the attachment") (2.06 KB, text/plain)  [2022-01-21 23:39 UTC](#attach_17109 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+ | [Details](attachment.cgi?id=17109&action=edit) | | [**4-13 patch v2**](attachment.cgi?id=17110 "View the content of the attachment") (3.70 KB, patch)  [2022-01-22 00:03 UTC](#attach_17110 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+  jsutton: ci-passed+ | [Details](attachment.cgi?id=17110&action=edit) | | [**4-15 patch v2**](attachment.cgi?id=17111 "View the content of the attachment") (3.70 KB, patch)  [2022-01-22 00:03 UTC](#attach_17111 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+  jsutton: ci-passed+ | [Details](attachment.cgi?id=17111&action=edit) | | [**4.14 patch v2**](attachment.cgi?id=17112 "View the content of the attachment") (3.70 KB, patch)  [2022-01-22 00:04 UTC](#attach_17112 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+  jsutton: ci-passed+ | [Details](attachment.cgi?id=17112&action=edit) | | [**master patch v2**](attachment.cgi?id=17113 "View the content of the attachment") (3.70 KB, patch)  [2022-01-22 00:07 UTC](#attach_17113 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+  dbagnall: ci-passed+ | [Details](attachment.cgi?id=17113&action=edit) | | [**patch for 4.12 with the CVE-2020-25722 patches**](attachment.cgi?id=17114 "View the content of the attachment") (3.70 KB, patch)  [2022-01-22 00:15 UTC](#attach_17114 "Go to the comment associated with the attachment"), Douglas Bagnall | jsutton: review+ | [Details](attachment.cgi?id=17114&action=edit) | | [Show Obsolete](#a0) (7) [View All](attachment.cgi?bugid=14950&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=14950&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=14950&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14950#c0)  Jennifer Sutton    2022-01-17 23:29:50 UTC  ``` The 'samba-tool spn add' command, as well as adding the specified SPN, re-adds any SPNs that already existed on the object. However, re-adding an SPN leads to an early return in samldb_spn_uniqueness_check(), which means checks on subsequent servicePrincipalName elements do not run.  Patch to follow. ```  [Comment 1](show_bug.cgi?id=14950#c1)  Jennifer Sutton    2022-01-18 01:21:23 UTC  ``` Created [attachment 17100](attachment.cgi?id=17100 "Patch for master") [[details]](attachment.cgi?id=17100&action=edit "Patch for master") Patch for master ```  [Comment 2](show_bug.cgi?id=14950#c2)  Jennifer Sutton    2022-01-18 01:22:01 UTC  ``` Created [attachment 17101](attachment.cgi?id=17101 "Patch for 4.15") [[details]](attachment.cgi?id=17101&action=edit "Patch for 4.15") Patch for 4.15 ```  [Comment 3](show_bug.cgi?id=14950#c3)  Jennifer Sutton    2022-01-18 01:22:29 UTC  ``` Created [attachment 17102](attachment.cgi?id=17102 "Patch for 4.14") [[details]](attachment.cgi?id=17102&action=edit "Patch for 4.14") Patch for 4.14 ```  [Comment 4](show_bug.cgi?id=14950#c4)  Jennifer Sutton    2022-01-18 01:22:56 UTC  ``` Created [attachment 17103](attachment.cgi?id=17103 "Patch for 4.13") [[details]](attachment.cgi?id=17103&action=edit "Patch for 4.13") Patch for 4.13 ```  [Comment 5](show_bug.cgi?id=14950#c5)  Douglas Bagnall    2022-01-20 03:58:52 UTC  ``` As with CVE-2020-25722, the CVSSv3.1 looks like  AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8)  Other mitigations might make it more complex and less serious, but I don't think that changes anything at CVSS's granularity. ```  [Comment 6](show_bug.cgi?id=14950#c6)  Jennifer Sutton    2022-01-20 04:01:19 UTC  ``` Created [attachment 17105](attachment.cgi?id=17105 "Advisory v1") [[details]](attachment.cgi?id=17105&action=edit "Advisory v1") Advisory v1  Added initial advisory text. ```  [Comment 7](show_bug.cgi?id=14950#c7)  Douglas Bagnall    2022-01-20 04:03:41 UTC  ``` Comment on [attachment 17105](attachment.cgi?id=17105 "Advisory v1") [[details]](attachment.cgi?id=17105&action=edit "Advisory v1") Advisory v1  Kees, do you want to be acknowledged for finding the bug, and if so, how?  Currently we have:  > Originally reported by Kees van Vloten ```  [Comment 8](show_bug.cgi?id=14950#c8)  Jennifer Sutton    2022-01-20 04:11:36 UTC  ``` Created [attachment 17106](attachment.cgi?id=17106 "Advisory v2") [[details]](attachment.cgi?id=17106&action=edit "Advisory v2") Advisory v2  Clarify that this specifically affects the AD DC. ```  [Comment 9](show_bug.cgi?id=14950#c9)  keesvanvloten    2022-01-20 09:39:56 UTC  ``` (In reply to Douglas Bagnall from [comment #7](show_bug.cgi?id=14950#c7))  First time this happens to me :-) Why not, your suggestion is fine:  "> Originally reported by Kees van Vloten" ```  [Comment 10](show_bug.cgi?id=14950#c10)  Douglas Bagnall    2022-01-21 01:19:57 UTC  ``` Created [attachment 17108](attachment.cgi?id=17108 "advisory v3") [[details]](attachment.cgi?id=17108&action=edit "advisory v3") advisory v3  Revised the advisory:  - credit Joseph for analysis and advisory writing. - add a couple of full stops.  We are still waiting for the CVE number. ```  [Comment 11](show_bug.cgi?id=14950#c11)  Douglas Bagnall    2022-01-21 23:39:07 UTC  ``` Created [attachment 17109](attachment.cgi?id=17109 "advisory v4 -- with CVE") [[details]](attachment.cgi?id=17109&action=edit "advisory v4 -- with CVE") advisory v4 -- with CVE ```  [Comment 12](show_bug.cgi?id=14950#c12)  Douglas Bagnall    2022-01-22 00:03:10 UTC  ``` Created [attachment 17110](attachment.cgi?id=17110 "4-13 patch v2") [[details]](attachment.cgi?id=17110&action=edit "4-13 patch v2") 4-13 patch v2 ```  [Comment 13](show_bug.cgi?id=14950#c13)  Douglas Bagnall    2022-01-22 00:03:49 UTC  ``` Created [attachment 17111](attachment.cgi?id=17111 "4-15 patch v2") [[details]](attachment.cgi?id=17111&action=edit "4-15 patch v2") 4-15 patch v2 ```  [Comment 14](show_bug.cgi?id=14950#c14)  Douglas Bagnall    2022-01-22 00:04:32 UTC  ``` Created [attachment 17112](attachment.cgi?id=17112 "4.14 patch v2") [[details]](attachment.cgi?id=17112&action=edit "4.14 patch v2") 4.14 patch v2 ```  [Comment 15](show_bug.cgi?id=14950#c15)  Douglas Bagnall    2022-01-22 00:07:30 UTC  ``` Created [attachment 17113](attachment.cgi?id=17113 "master patch v2") [[details]](attachment.cgi?id=17113&action=edit "master patch v2") master patch v2  v2 patches: - CVE number - reviewed-by tag  no code changes. ```  [Comment 16](show_bug.cgi?id=14950#c16)  Douglas Bagnall    2022-01-22 00:15:21 UTC  ``` Created [attachment 17114](attachment.cgi?id=17114 "patch for 4.12 with the CVE-2020-25722 patches") [[details]](attachment.cgi?id=17114&action=edit "patch for 4.12 with the CVE-2020-25722 patches") patch for 4.12 with the CVE-2020-25722 patches  Add a backport for people who backported the CVE-2020-25722 patches to 4.12. ```  [Comment 17](show_bug.cgi?id=14950#c17)  Douglas Bagnall    2022-01-22 00:23:05 UTC  ``` (In reply to Douglas Bagnall from [comment #16](show_bug.cgi?id=14950#c16))  > Add a backport for people who backported the CVE-2020-25722 patches to 4.12.  The same patch applies to 4.10 with backports. ```  [Comment 18](show_bug.cgi?id=14950#c18)  Douglas Bagnall    2022-01-22 23:46:09 UTC  ``` Samba vendors, release date for this is going to be January 31st. ```  [Comment 19](show_bug.cgi?id=14950#c19)  Samba QA Contact    2022-01-31 12:41:50 UTC  ``` This bug was referenced in samba v4-15-stable (Release samba-4.15.5):  d392b10c55bbcedda01fdd87fe6035fa3a6986b3 7a516257ea310fa045bdf14e677eaa97f2a83c33 ```  [Comment 20](show_bug.cgi?id=14950#c20)  Samba QA Contact    2022-01-31 12:42:51 UTC  ``` This bug was referenced in samba v4-14-stable (Release samba-4.14.12):  c4d576baaf09c418db6e706a33b8424b0781e5fc 8d0114ea973cfb610c0edf62f11c72ba1b525b03 ```  [Comment 21](show_bug.cgi?id=14950#c21)  Jule Anger    2022-01-31 12:53:37 UTC  ``` Removing vendor CC (so that any public comments don't need to be broadcast so widely) and opening these bugs to the public.   If you wish to continue to be informed about any changes here please CC individually. ```  [Comment 22](show_bug.cgi?id=14950#c22)  Samba QA Contact    2022-01-31 12:55:13 UTC  ``` This bug was referenced in samba v4-13-stable (Release samba-4.13.17):  7368e0051a320fce48c1f303914b62985a40beb0 2802b7d8f3f77a639d0d69bced528f328655750b ```  [Comment 23](show_bug.cgi?id=14950#c23)  Samba QA Contact    2022-01-31 13:41:36 UTC  ``` This bug was referenced in samba v4-14-test:  c4d576baaf09c418db6e706a33b8424b0781e5fc 8d0114ea973cfb610c0edf62f11c72ba1b525b03 ```  [Comment 24](show_bug.cgi?id=14950#c24)  Samba QA Contact    2022-01-31 13:45:09 UTC  ``` This bug was referenced in samba v4-15-test:  d392b10c55bbcedda01fdd87fe6035fa3a6986b3 7a516257ea310fa045bdf14e677eaa97f2a83c33 ```  [Comment 25](show_bug.cgi?id=14950#c25)  Samba QA Contact    2022-01-31 13:55:39 UTC  ``` This bug was referenced in samba v4-13-test:  7368e0051a320fce48c1f303914b62985a40beb0 2802b7d8f3f77a639d0d69bced528f328655750b ```  [Comment 26](show_bug.cgi?id=14950#c26)  Samba QA Contact    2022-01-31 15:55:11 UTC  ``` This bug was referenced in samba v4-16-test:  eaede91afd6d171539aa5298644aa5fb107a6341 e4f18bfaec844f261fa03616c9e55924366dfcf9 ```  [Comment 27](show_bug.cgi?id=14950#c27)  Samba QA Contact    2022-01-31 16:55:14 UTC  ``` This bug was referenced in samba master:  c58ede44f382bd0125f761f0479c8d48156be400 1a5dc817c0c9379bbaab14c676681b42b0039a3c ```  [Comment 28](show_bug.cgi?id=14950#c28)  Samba QA Contact    2022-01-31 17:07:12 UTC  ``` This bug was referenced in samba v4-16-stable (Release samba-4.16.0rc2):  eaede91afd6d171539aa5298644aa5fb107a6341 e4f18bfaec844f261fa03616c9e55924366dfcf9 ```  [Comment 29](show_bug.cgi?id=14950#c29)  Jule Anger    2022-02-02 09:04:47 UTC  ``` Pushed to all branches. Closing out bug report.  Thanks! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14950)
* - [XML](show_bug.cgi?ctype=xml&id=14950)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=14950)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=14950&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=14950&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_d0636a05_20250114_195044.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities — GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_64ce72ca_20250114_195043.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2Fc58ede44f382bd0125f761f0479c8d48156be400)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2Fc58ede44f382bd0125f761f0479c8d48156be400)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=samba-team%2Fsamba)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[samba-team](/samba-team)
/
**[samba](/samba-team/samba)**
Public

* [Notifications](/login?return_to=%2Fsamba-team%2Fsamba) You must be signed in to change notification settings
* [Fork
  437](/login?return_to=%2Fsamba-team%2Fsamba)
* [Star
   932](/login?return_to=%2Fsamba-team%2Fsamba)

* [Code](/samba-team/samba)
* [Pull requests
  0](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

Additional navigation options

* [Code](/samba-team/samba)
* [Pull requests](/samba-team/samba/pulls)
* [Actions](/samba-team/samba/actions)
* [Security](/samba-team/samba/security)
* [Insights](/samba-team/samba/pulse)

## Commit

[Permalink](/samba-team/samba/commit/c58ede44f382bd0125f761f0479c8d48156be400)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[CVE-2022-0336](https://github.com/advisories/GHSA-rg44-hwh5-vcpq "CVE-2022-0336"): pytest: Add a test for an SPN conflict with a re-added…

[Browse files](/samba-team/samba/tree/c58ede44f382bd0125f761f0479c8d48156be400)
Browse the repository at this point in the history

```
… SPN

This test currently fails, as re-adding an SPN means that later checks
do not run.

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=14950>

Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>
```

* Loading branch information

[![@jsutton24](https://avatars.githubusercontent.com/u/86935448?s=40&v=4)](/jsutton24) [![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=40&v=4)](/metze-samba)

[jsutton24](/samba-team/samba/commits?author=jsutton24 "View all commits by jsutton24")
authored and
[metze-samba](/samba-team/samba/commits?author=metze-samba "View all commits by metze-samba")
committed
Jan 31, 2022

1 parent
[6063e80](/samba-team/samba/commit/6063e8016fccbefd1c3fe378e3807c77bc04e4ec)

commit c58ede4

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**8 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* python/samba/tests

  + python/samba/tests/ldap\_spn.py
    [ldap\_spn.py](#diff-ed4ebff8a284286ad8c1cce8dfc9f7342fd31d801a072bc93543c0a1d17e5470)
* selftest/knownfail.d

  + selftest/knownfail.d/ldap\_spn
    [ldap\_spn](#diff-588d63a795e57ddd9aa721cd81541dba00049a2feb1efef70374f77a25dceb8a)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[python/samba/tests/ldap\_spn.py](#diff-ed4ebff8a284286ad8c1cce8dfc9f7342fd31d801a072bc93543c0a1d17e5470 "python/samba/tests/ldap_spn.py")

Show comments

[View file](/samba-team/samba/blob/c58ede44f382bd0125f761f0479c8d48156be400/python/samba/tests/ldap_spn.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -268,6 +268,8 @@ def \_test\_spn\_with\_args(self, rows, doc): |
|  |  | for k in ('dNSHostName', 'servicePrincipalName'): |
|  |  | if isinstance(m.get(k), str): |
|  |  | m[k] = m[k].format(dnsname=f"x.{REALM}") |
|  |  | elif isinstance(m.get(k), list): |
|  |  | m[k] = [x.format(dnsname=f"x.{REALM}") for x in m[k]] |
|  |  |  |
|  |  | msg = ldb.Message.from\_dict(samdb, m, op) |
|  |  |  |
| Expand Down  Expand Up | | @@ -727,6 +729,11 @@ class LdapSpnSambaOnlyTest(LdapSpnTestBase): |
|  |  | ('user:C', 'host/{dnsname}', '\*', ok), |
|  |  | ('user:D', 'www/{dnsname}', 'D', denied), |
|  |  | ), |
|  |  | ("add a conflict, along with a re-added SPN", |
|  |  | ('A', 'cifs/{dnsname}', '\*', ok), |
|  |  | ('B', 'cifs/heeble.example.net', 'B', ok), |
|  |  | ('B', ['cifs/heeble.example.net', 'host/{dnsname}'], 'B', constraint), |
|  |  | ), |
|  |  |  |
|  |  | ("changing dNSHostName after host", |
|  |  | ('A', {'dNSHostName': '{dnsname}'}, '\*', ok), |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[selftest/knownfail.d/ldap\_spn](#diff-588d63a795e57ddd9aa721cd81541dba00049a2feb1efef70374f77a25dceb8a "selftest/knownfail.d/ldap_spn")

Show comments

[View file](/samba-team/samba/blob/c58ede44f382bd0125f761f0479c8d48156be400/selftest/knownfail.d/ldap_spn)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1 +1,2 @@ |
|  |  | samba.tests.ldap\_spn.+LdapSpnTest.test\_spn\_dodgy\_spns |
|  |  | samba.tests.ldap\_spn.+LdapSpnSambaOnlyTest.test\_spn\_add\_a\_conflict\_along\_with\_a\_re\_added\_SPN |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c58ede4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamba-team%2Fsamba%2Fcommit%2Fc58ede44f382bd0125f761f0479c8d48156be400) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_1c4010ad_20250115_115158.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.samba.org_13c6df53_20250114_195046.html ===

## CVE-2022-0336.html:

```

===========================================================
== Subject:     Samba AD users with permission to write to
==              an account can impersonate arbitrary services.
==
== CVE ID#:     CVE-2022-0336
==
== Versions:    Samba 4.0.0 and later
==
== Summary:     Checks in the Samba AD DC to prevent aliased
==              SPNs could be bypassed, giving users who can
==              write to an account's servicePrincipalName
==              attribute the ability to impersonate services.
===========================================================

===========
Description
===========

The Samba AD DC includes checks when adding service principals names
(SPNs) to an account to ensure that SPNs do not alias with those
already in the database. Some of these checks are able to be bypassed
if an account modification re-adds an SPN that was previously present
on that account, such as one added when a computer is joined to a
domain.

An attacker who has the ability to write to an account can exploit
this to perform a denial-of-service attack by adding an SPN that
matches an existing service. Additionally, an attacker who can
intercept traffic can impersonate existing services, resulting in a
loss of confidentiality and integrity.

==================
Patch Availability
==================

Patches addressing both these issues have been posted to:

    https://www.samba.org/samba/security/

Additionally, Samba 4.13.17, 4.14.12, and 4.15.4 have been issued
as security releases to correct the defect.  Samba administrators are
advised to upgrade to these releases or apply the patch as soon
as possible.

==================
CVSSv3 calculation
==================

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (8.8)

==========
Workaround
==========

None.

=======
Credits
=======

Originally reported by Kees van Vloten.

Analysis, patches, and this advisory by Joseph Sutton of Catalyst
and the Samba Team.

==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================

```



=== Content from bugzilla.redhat.com_98dde3e9_20250114_195036.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2046134)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2046134)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2046134)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2046134

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2046134**](show_bug.cgi?id=2046134)
(CVE-2022-0336)
- [CVE-2022-0336](https://access.redhat.com/security/cve/CVE-2022-0336) samba: Samba AD users with permission to write to an account can impersonate arbitrary services

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-0336 samba: Samba AD users with permission to write to an account ca...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-0336 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2048568](show_bug.cgi?id=2048568 "CLOSED ERRATA - CVE-2022-0336 samba: Samba AD users with permission to write to an account can impersonate arbitrary services [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2046121](show_bug.cgi?id=2046121) | | TreeView+ | [depends on](buglist.cgi?bug_id=2046134&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2046134&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-01-26 10:09 UTC by Huzaifa S. Sidhpurwala | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-10-03 13:29 UTC ([History](show_activity.cgi?id=2046134)) | | [CC List:](page.cgi?id=fields.html#cclist) | 16 users (show)  abokovoy anoopcs asn dkarpele gdeschner hvyas iboukris jarrpa jstephen lmohanty madam pfilipen rhs-smb sbose security-response-team ssorce | | Fixed In Version: | samba 4.13.17, samba 4.14.12, samba 4.15.4 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A logic flaw in the Samba Active Directory Domain Controller leads to a denial of service and service impersonation. This flaw allows an attacker with the ability to write to an account to perform a denial of service attack or service impersonation by adding an SPN that matches an existing service. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-01-31 15:01:05 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2046134#c0)  Huzaifa S. Sidhpurwala    2022-01-26 10:09:54 UTC  ``` As per samba upstream advisory:   The Samba AD DC includes checks when adding service principals names (SPNs) to an account to ensure that SPNs do not alias with those already in the database. Some of these checks are able to be bypassed if an account modification re-adds an SPN that was previously present on that account, such as one added when a computer is joined to a domain.  An attacker who has the ability to write to an account can exploit this to perform a denial-of-service attack by adding an SPN that matches an existing service. Additionally, an attacker who can intercept traffic can impersonate existing services, resulting in a loss of confidentiality and integrity.   ```  [Comment 1](show_bug.cgi?id=2046134#c1)  Huzaifa S. Sidhpurwala    2022-01-31 14:23:04 UTC  ``` Created samba tracking bugs for this issue:  Affects: fedora-all [[bug 2048568](show_bug.cgi?id=2048568 "CLOSED ERRATA - CVE-2022-0336 samba: Samba AD users with permission to write to an account can impersonate arbitrary services [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=2046134#c2)  Product Security DevOps Team    2022-01-31 15:01:03 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2022-0336>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2046134&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_a3a0a9d0_20250115_115155.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rg44-hwh5-vcpq)

**CVE-2022-0336**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rg44-hwh5-vcpq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-0336](/advisories/GHSA-rg44-hwh5-vcpq)

## The Samba AD DC includes checks when adding service...

High severity

Unreviewed

Published
Aug 29, 2022
to the GitHub Advisory Database
•
Updated Sep 17, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-rg44-hwh5-vcpq/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The Samba AD DC includes checks when adding service principals names (SPNs) to an account to ensure that SPNs do not alias with those already in the database. Some of these checks are able to be bypassed if an account modification re-adds an SPN that was previously present on that account, such as one added when a computer is joined to a domain. An attacker who has the ability to write to an account can exploit this to perform a denial-of-service attack by adding an SPN that matches an existing service. Additionally, an attacker who can intercept traffic can impersonate existing services, resulting in a loss of confidentiality and integrity.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-0336>
* [samba-team/samba@1a5dc81](https://github.com/samba-team/samba/commit/1a5dc817c0c9379bbaab14c676681b42b0039a3c)
* [samba-team/samba@c58ede4](https://github.com/samba-team/samba/commit/c58ede44f382bd0125f761f0479c8d48156be400)
* <https://access.redhat.com/security/cve/CVE-2022-0336>
* <https://bugzilla.redhat.com/show_bug.cgi?id=2046134>
* <https://bugzilla.samba.org/show_bug.cgi?id=14950>
* <https://www.samba.org/samba/security/CVE-2022-0336.html>
* <https://security.gentoo.org/glsa/202309-06>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
Aug 29, 2022

Published to the GitHub Advisory Database
Aug 29, 2022

Last updated
Sep 17, 2023

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.295%
 (69th percentile)

### Weaknesses

[CWE-276](/advisories?query=cwe%3A276)

### CVE ID

CVE-2022-0336

### GHSA ID

GHSA-rg44-hwh5-vcpq

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-rg44-hwh5-vcpq/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


