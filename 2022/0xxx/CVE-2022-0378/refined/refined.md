The provided content is related to CVE-2022-0378.

**Root cause of vulnerability:**
The vulnerability stems from insufficient sanitization of input parameters passed to the `module` function within the `ApiController.php` file of the Microweber CMS. Specifically, the code was vulnerable to Cross-Site Scripting (XSS) attacks through the `value` parameters when making module API calls.

**Weaknesses/vulnerabilities present:**
The main vulnerability is a Cross-Site Scripting (XSS) vulnerability. Before the fix, the application was not properly sanitizing user-controlled inputs received as parameters to the module API calls allowing attackers to inject malicious scripts.

**Impact of exploitation:**
Successful exploitation of this XSS vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of a user's browser session. This could result in various malicious activities, such as:
- Session hijacking
- Defacement of the website
- Redirection to malicious sites
- Stealing user credentials or other sensitive information

**Attack vectors:**
The attack vector is through HTTP requests made to the `module` function of the `ApiController.php` file. Attackers can inject malicious scripts into the `value` parameters of the API calls.

**Required attacker capabilities/position:**
The attacker needs to be able to make HTTP requests to the vulnerable endpoint and have knowledge of the vulnerable parameter. There are no other specific privileges required beyond being able to interact with the application.

**Technical Details:**
The commit `fc7e1a026735b93f0e0047700d08c44954fce9ce` addresses the issue by adding a sanitization layer, using the `AntiXSS` class, to the request parameters.
- Before the fix, input parameters (`$_GET` and `$_POST`) were merged and directly used without proper sanitization.
- The fix introduces a `foreach` loop that iterates over the request data. Within this loop each value and key are cleaned using `$antixss->xss_clean()`. This sanitizes input before it is further used by the application.