=== Content from starlabs.sg_df61f129_20250115_190604.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

# Search

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from about.gitlab.com_4334833d_20250115_190600.html ===

  [![](/nuxt-images/solutions/ai/icons/eyebrow-two.svg)
New: GitLab Duo with Amazon Q](/partners/technology-partners/aws/#interest)  [![](/nuxt-images/banner/gitlab-duo-amazon-q.svg)
AI-driven DevSecOps.](/partners/technology-partners/aws/#interest)
# Talk to an Expert

Want to see a custom demo or get help finding the right plan? We'd love to chat.

 ![Image: Infinity](/_nuxt/image/377ef0.webp)
##### Looking for technical help?

Please contact customer support by submitting a case on our GitLab Support page.

[Contact Support](https://support.gitlab.com/)      01 - 10
##

Please complete all fields.

## FAQ

## Ready to get started?

See what your team can do with the most comprehensive

AI-powered DevSecOps platform.

 [Get free trial](https://gitlab.com/-/trial_registrations/new?glm_source=about.gitlab.com/free-trial/devsecops/&glm_content=default-saas-trial)


=== Content from www.qemu.org_5624b083_20250115_190603.html ===


* [Home](./)* [Donations](./donations)
  * [Download](./download)
  * [Support](./support)
  * [Contribute](./contribute)
  * [Docs](./documentation)
  * [Wiki](https://wiki.qemu.org)
  * [Blog](./blog)

# QEMU

A generic and open source machine emulator and virtualizer

## Features

[![Screenshot: QEMU running the ReactOS operating system on Linux.](screenshots/800px-Qemu_linux.png)](screenshots/800px-Qemu_linux.png "QEMU running the ReactOS operating system on Linux.")
### Full-system emulation

Run operating systems for any machine, on any supported architecture

[![Screenshot: QEMU running a 32-bit ARM binary on a 64-bit Linux system.](screenshots/qemu-arm.png)](screenshots/qemu-arm.png "QEMU running a 32-bit ARM binary on a 64-bit Linux system.")
### User-mode emulation

Run programs for another Linux/BSD target, on any supported architecture

[![Screenshot: The dashboard of the OSv operating system, running in the background as a QEMU/KVM process.](screenshots/qemu-advent-calendar-osv-redis.png)](screenshots/qemu-advent-calendar-osv-redis.png "The dashboard of the OSv operating system, running in the background as a QEMU/KVM process.")
### Virtualization

Run KVM and Xen virtual machines with near native performance

[![Screenshot: QEMU emulating an ASCII art game for the System z (s390) mainframe.](screenshots/qemu-advent-calendar-s390-moon-buggy.png)](screenshots/qemu-advent-calendar-s390-moon-buggy.png "QEMU emulating an ASCII art game for the System z (s390) mainframe.")
[![Screenshot: QEMU running Second Reality, a well-known PC demo from 1993, inside the FreeDOS operating system.](screenshots/qemu-advent-calendar-second-reality.png)](screenshots/qemu-advent-calendar-second-reality.png "QEMU running Second Reality, a well-known PC demo from 1993, inside the FreeDOS operating system.")

## Latest releases

* **[9.2.0](https://download.qemu.org/qemu-9.2.0.tar.xz)**
  Dec 10th 2024
  [signature](https://download.qemu.org/qemu-9.2.0.tar.xz.sig) ‚Äî [changes](https://wiki.qemu.org/ChangeLog/9.2)
* **[9.1.2](https://download.qemu.org/qemu-9.1.2.tar.xz)**
  Nov 20th 2024
  [signature](https://download.qemu.org/qemu-9.1.2.tar.xz.sig) ‚Äî [changes](https://wiki.qemu.org/ChangeLog/9.1)
* **[9.0.4](https://download.qemu.org/qemu-9.0.4.tar.xz)**
  Nov 20th 2024
  [signature](https://download.qemu.org/qemu-9.0.4.tar.xz.sig) ‚Äî [changes](https://wiki.qemu.org/ChangeLog/9.0)
* **[8.2.8](https://download.qemu.org/qemu-8.2.8.tar.xz)**
  Nov 20th 2024
  [signature](https://download.qemu.org/qemu-8.2.8.tar.xz.sig) ‚Äî [changes](https://wiki.qemu.org/ChangeLog/8.2)
* **[7.2.15](https://download.qemu.org/qemu-7.2.15.tar.xz)**
  Nov 20th 2024
  [signature](https://download.qemu.org/qemu-7.2.15.tar.xz.sig) ‚Äî [changes](https://wiki.qemu.org/ChangeLog/7.2)

[Full list of releases](https://download.qemu.org/)

* [Advent calendar](http://qemu-advent-calendar.org)
* [Blog planet](https://planet.virt-tools.org/)
* [KVM](https://www.linux-kvm.org/)
* [Libguestfs](http://libguestfs.org/)
* [Libvirt](https://libvirt.org/)
* [Xen](https://xenproject.org)

[page source](https://gitlab.com/qemu-project/qemu-web/-/blob/master/index.html)

QEMU is a member of [Software Freedom Conservancy](./conservancy/)

QEMU has [sponsors](./sponsors/)

[Website licenses](./license.html)



=== Content from gitlab.com_92738db4_20250115_122258.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
4367a20c**

authored
Jul 11, 2022
by
**[![Mauro Matteo Cascella's avatar](https://secure.gravatar.com/avatar/a1b46472954e90fc1acfc9c75d1243b632c5f097931faa414c36a7172e4c2161?s=96&d=identicon "Mauro Matteo Cascella")](/mauromatteo.cascella)
[Mauro Matteo Cascella](/mauromatteo.cascella)**
Committed by
[Paolo Bonzini](/bonzini)
Jul 13, 2022

[Browse files](/qemu-project/qemu/-/tree/4367a20cc442c56b05611b4224de9a61908f9eac)

### scsi/lsi53c895a: really fix use-after-free in lsi\_do\_msgout (CVE-2022-0216)

```

Set current_req to NULL, not current_req->req, to prevent reusing a free'd
buffer in case of repeated SCSI cancel requests.  Also apply the fix to
CLEAR QUEUE and BUS DEVICE RESET messages as well, since they also cancel
the request.

Thanks to Alexander Bulekov for providing a reproducer.

Fixes: CVE-2022-0216
Resolves: [#972](https://gitlab.com/qemu-project/qemu/-/issues/972 "LSI SCSI Use After Free (CVE-2022-0216)")

Signed-off-by: [![Mauro Matteo Cascella's avatar](https://secure.gravatar.com/avatar/a1b46472954e90fc1acfc9c75d1243b632c5f097931faa414c36a7172e4c2161?s=64&d=identicon "Mauro Matteo Cascella")](https://gitlab.com/mauromatteo.cascella "mcascell@redhat.com")[Mauro Matteo Cascella](https://gitlab.com/mauromatteo.cascella "mcascell@redhat.com") <mcascell@redhat.com>
Tested-by: ![default avatar](https://secure.gravatar.com/avatar/41ba645803ea30b5cb6d917e462f40d84e1981371ec8782a6317a407facb472e?s=32&d=identicon)Alexander Bulekov <alxndr@bu.edu>
Message-Id: <20220711123316.421279-1-mcascell@redhat.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/b58b3d205f0c82b289646cc4d253a4ca9ebdbbfea8dc7d471e83622d74741b05?s=32&d=identicon)Paolo Bonzini <pbonzini@redhat.com>
```

parent
[8e3d85d3](/qemu-project/qemu/-/commit/8e3d85d36b77f11ad7bded3a2d48c1f0cc334f82)

Loading

Loading

Loading

* [Changes
  2](/qemu-project/qemu/-/commit/4367a20cc442c56b05611b4224de9a61908f9eac)

[Hide whitespace changes](/qemu-project/qemu/-/commit/4367a20cc442c56b05611b4224de9a61908f9eac?action=show&controller=projects%2Fcommit&id=4367a20cc4&namespace_id=qemu-project&project_id=qemu&w=1)
[Inline](/qemu-project/qemu/-/commit/4367a20cc4?view=inline)
[Side-by-side](/qemu-project/qemu/-/commit/4367a20cc4?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from secure.gravatar.com_6804542e_20250115_190600.html ===
ÔøΩPNG

   
IHDR   @   @   ÔøΩiqÔøΩ    pHYs  ÔøΩ  ÔøΩÔøΩ+   IDATxÔøΩÔøΩÔøΩjA∆ø  x
ÔøΩÔøΩÔøΩiÔøΩcn9ÔøΩÔøΩ3lÔøΩCÔøΩÔøΩÔøΩÔøΩ'ÔøΩy ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ}!ÔøΩÔøΩ(ÔøΩÔøΩ!ÔøΩÔøΩ&mÔøΩoUwÔøΩNÔøΩw[vÔøΩÔøΩkÔøΩÔøΩÔøΩ⁄ûÔøΩÔøΩÔøΩÔøΩ
fÔøΩ.ÔøΩ>`ÔøΩ0ÔøΩ(0ÔøΩ'xsÔøΩÔøΩ5ÔøΩw"mÔøΩ`ZOÔøΩÔøΩx3ÔøΩ'hÔøΩÔøΩ=N)0ÔøΩn")ÔøΩ@ÔøΩÔøΩ0P ÔøΩJ ÔøΩÔøΩB
b\*AÔøΩÔøΩÔøΩXJÔøΩa< ÔøΩ BR ÔøΩÔøΩL ÔøΩÔøΩs ≈ªÎè´ÔøΩ|n(ÔøΩlÔøΩÔøΩsCÀÆÔøΩÔøΩÔøΩQwÔøΩnx(JPÔøΩ (ÔøΩÔøΩÔøΩÔøΩŒçÔøΩÔøΩOÔøΩÔøΩsÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ◊øÔøΩÔøΩ\*h^ÔøΩ<ÔøΩ<`ÔøΩJÔøΩmÔøΩÔøΩnÔøΩCÔøΩ ÔøΩSÔøΩ E ÔøΩ$ÔøΩ<ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ'ÔøΩz
eÔøΩz>7ÔøΩÔøΩÔøΩTxÔøΩbÔøΩoUÔøΩ\
nJLÔøΩ-ÔøΩÔøΩÔøΩ!%ÔøΩb èÔøΩoÔøΩwÔøΩÔøΩuÔøΩÔøΩÔøΩÔøΩA[LÔøΩ4)oWÔøΩÔøΩ◊áÔøΩÔøΩAÔøΩÔøΩ:ÔøΩn')ÔøΩ#ÔøΩ.1ÔøΩÔøΩLÔøΩ\*ÔøΩÔøΩ{ÔøΩldÔøΩÔøΩMp} ÔøΩ
ÔøΩÔøΩÔøΩ(ÔøΩÔøΩÔøΩ(ÔøΩÔøΩ\.ÔøΩÔøΩ"›áÔøΩÔøΩÔøΩÔøΩ\*IvÔøΩÔøΩÔøΩÔøΩ\*aÔøΩ]~ÔøΩNkﬁÜÔøΩÔøΩ
ÔøΩœ´ÔøΩ\*ÔøΩÔøΩÔøΩÔøΩjÔøΩÔøΩÔøΩ5NÔøΩgbÔøΩÔøΩT;ÔøΩoÔ¢≠ÔøΩÔøΩÔøΩ<2?cBÔøΩÔøΩmnÔøΩ/ËóÉÔøΩ'ÔøΩ)kﬁÜ-&ÔøΩ]ÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ)ÔøΩ{ RÔøΩÔøΩÔøΩpÔøΩlÔøΩÔøΩÔøΩÔøΩ78ÔøΩ5oCUB9ÔøΩ5oÔøΩlfÔøΩÔøΩ@A)ÔøΩÔøΩÔøΩ"ÔøΩ ÔøΩÔøΩÔøΩr=ÔøΩlgÔøΩÔøΩ1ÔøΩSÔøΩsOÔøΩÔøΩÔøΩÔøΩiÔøΩÔøΩvvBOÔøΩÔøΩÔøΩÔøΩOÔøΩÔøΩZ ÔøΩÔøΩgÔøΩRBÔøΩ<ÔøΩÔøΩ ?ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩGOÔøΩ\*!ÔøΩÔøΩÔøΩ'ÔøΩÔøΩy.ÔøΩÔøΩÔøΩÔøΩ-b«ÑÔøΩ1ÔøΩÔøΩbVÔøΩÔøΩÔøΩ0ÔøΩ9\*1HÔøΩ~ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩkd~    IENDÔøΩB`ÔøΩ

=== Content from lists.fedoraproject.org_1898c816_20250114_212651.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

√ó
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E.mbox.gz?message=ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/#ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E)

# [SECURITY] Fedora 37 Update: qemu-7.0.0-10.fc37

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesÔº†fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesÔº†fedoraproject.org")

10 Nov
2022

10 Nov
'22

2:49 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-4387579e67
2022-11-10 22:04:44.632042
--------------------------------------------------------------------------------

Name : qemu
Product : Fedora 37
Version : 7.0.0
Release : 10.fc37
URL : <http://www.qemu.org/>
Summary : QEMU is a FAST! processor emulator
Description :
qemu is an open source virtualizer that provides hardware
emulation for the KVM hypervisor. qemu acts as a virtual
machine monitor together with the KVM kernel modules, and emulates the
hardware for a full system such as a PC and its associated peripherals.

--------------------------------------------------------------------------------
Update Information:

vga: avoid crash if no default vga card (rhbz#2095639) lsi53c895a: fix use-
after-free in lsi\_do\_msgout (CVE-2022-0216) vnc-clipboard: fix integer underflow
(CVE-2022-3165)
--------------------------------------------------------------------------------
ChangeLog:

\* Tue Oct 18 2022 Mauro Matteo Cascella mcascell@redhat.com - 2:7.0.0-10
- vga: avoid crash if no default vga card (rhbz#2095639)
- lsi53c895a: fix use-after-free in lsi\_do\_msgout (CVE-2022-0216) (rhbz#2070902)
- vnc-clipboard: fix integer underflow (CVE-2022-3165) (rhbz#2129759)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2070902 - CVE-2022-0216 qemu: use-after-free in lsi\_do\_msgout function in hw/scsi/lsi53c895a.c [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2070902>
[ 2 ] Bug #2095639 - get Segmentation fault (core dumped) while run: qemu-system-s390x -M s390-ccw-virtio -vga help
<https://bugzilla.redhat.com/show_bug.cgi?id=2095639>
[ 3 ] Bug #2129759 - CVE-2022-3165 qemu: VNC: integer underflow in vnc\_client\_cut\_text\_ext leads to CPU exhaustion [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2129759>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-4387579e67' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E/#ZTY7TVHX62OJWF6IOBCIGLR2N5K4QN3E)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from bugzilla.redhat.com_eaff41bb_20250114_212648.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2036953)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2036953)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2036953)+ Login using a Red Hat Bugzilla account
  + Forgot¬†Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla ‚Äì Bug¬†2036953

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug¬†2036953**](show_bug.cgi?id=2036953)
(CVE-2022-0216)
- [CVE-2022-0216](https://access.redhat.com/security/cve/CVE-2022-0216) QEMU: use-after-free in lsi\_do\_msgout function in hw/scsi/lsi53c895a.c

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-0216 QEMU: use-after-free in lsi\_do\_msgout function in hw/scsi/lsi53...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-0216 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2070899](show_bug.cgi?id=2070899 "CLOSED EOL - CVE-2022-0216 xen: QEMU: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [fedora-all]") [2070900](show_bug.cgi?id=2070900 "CLOSED EOL - CVE-2022-0216 qemu: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [epel-7]") [2070902](show_bug.cgi?id=2070902 "CLOSED ERRATA - CVE-2022-0216 qemu: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2054405](show_bug.cgi?id=2054405) [2064637](show_bug.cgi?id=2064637) | | TreeView+ | [depends on](buglist.cgi?bug_id=2036953&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2036953&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-01-04 13:59 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-03-29 09:18 UTC ([History](show_activity.cgi?id=2036953)) | | [CC List:](page.cgi?id=fields.html#cclist) | 34 users (show)  berrange cfergeau crobinso dbecker eglynn gkamathe jen jferlan jforbes jjoyce jmaloy jschluet knoel lhh lkundrak lpeer m.a.young mburns mkenneth mrezanin mst ntait ondrejj pbonzini philmd ribarry rjones sclewis security-response-team slinaber slong spower virt-maint virt-maint | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A use-after-free vulnerability was found in the LSI53C895A SCSI Host Bus Adapter emulation of QEMU. The flaw occurs while processing repeated messages to cancel the current SCSI request via the lsi\_do\_msgout function. This flaw allows a malicious privileged user within the guest to crash the QEMU process on the host, resulting in a denial of service. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-04-01 12:25:19 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2036953#c0)  Pedro Sampaio    2022-01-04 13:59:44 UTC  ``` A use after free issue was found in the `hw/scsi/lsi53c895a.c` specifically in `lsi_do_msgout` function. `lsi_do_msgout` function is used to receive message from the OS, and do something based on that message. In this case, one message only has one-byte size.   ```  [Comment 5](show_bug.cgi?id=2036953#c5)  Mauro Matteo Cascella    2022-04-01 10:10:50 UTC  ``` Created qemu tracking bugs for this issue:  Affects: epel-7 [[bug 2070900](show_bug.cgi?id=2070900 "CLOSED EOL - CVE-2022-0216 qemu: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [epel-7]")] Affects: fedora-all [[bug 2070902](show_bug.cgi?id=2070902 "CLOSED ERRATA - CVE-2022-0216 qemu: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [fedora-all]")]   Created xen tracking bugs for this issue:  Affects: fedora-all [[bug 2070899](show_bug.cgi?id=2070899 "CLOSED EOL - CVE-2022-0216 xen: QEMU: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c [fedora-all]")]   ```  [Comment 6](show_bug.cgi?id=2036953#c6)  Mauro Matteo Cascella    2022-04-01 10:22:01 UTC  ``` STAR Labs security advisory: <https://starlabs.sg/advisories/22/22-0216>.   ```  [Comment 7](show_bug.cgi?id=2036953#c7)  Product Security DevOps Team    2022-04-01 12:25:16 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2022-0216>   ```  [Comment 8](show_bug.cgi?id=2036953#c8)  Mauro Matteo Cascella    2022-04-08 20:14:59 UTC  ``` Upstream issue: <https://gitlab.com/qemu-project/qemu/-/issues/972>   ```  [Comment 9](show_bug.cgi?id=2036953#c9)  Mauro Matteo Cascella    2022-08-01 12:09:27 UTC  ``` Upstream commit: <https://gitlab.com/qemu-project/qemu/-/commit/4367a20cc4>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2036953&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_dc5eb4f6_20250115_122259.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Fran√ßais](https://access.redhat.com/changeLanguage?language=fr)
* [ÌïúÍµ≠Ïñ¥](https://access.redhat.com/changeLanguage?language=ko)
* [Êó•Êú¨Ë™û](https://access.redhat.com/changeLanguage?language=ja)
* [‰∏≠Êñá (‰∏≠ÂõΩ)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 ¬© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from starlabs.sg_5e588b7c_20250114_212652.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/)¬†¬ª¬†[Advisories](https://starlabs.sg/advisories/)
# (CVE-2022-0216) QEMU LSI SCSI Use After Free

March 28, 2022¬†¬∑¬†7 min¬†¬∑¬†Muhammad Alifa Ramdhan (@n0psledbyte)

Table of Contents

* [Description of the vulnerability](#description-of-the-vulnerability)
  + [Technical Details](#technical-details)
  + [Exploitability](#exploitability)
  + [Requirement](#requirement)
  + [Proof Of Concept](#proof-of-concept)
* [Mitigations](#mitigations)
* [Timeline:](#timeline)

**CVE**: CVE-2022-0216

**Tested Versions**:

* QEMU < v6.0.0

**Product URL(s)**:

* <https://www.qemu.org/>

# Description of the vulnerability[#](#description-of-the-vulnerability)

## Technical Details[#](#technical-details)

The vulnerability resides in the `hw/scsi/lsi53c895a.c` specifically in `lsi_do_msgout` function. `lsi_do_msgout` function is used to receive messages from the OS, and do something based on that message. In this case, one message only has one-byte size.

```
static void lsi_do_msgout(LSIState *s)
{
    uint8_t msg;
    int len;
    uint32_t current_tag;
    lsi_request *current_req, *p, *p_next;
    if (s->current) {
        current_tag = s->current->tag;
        current_req = s->current; // [1]
    } else {
        current_tag = s->select_tag;
        current_req = lsi_find_by_tag(s, current_tag);
    }
    trace_lsi_do_msgout(s->dbc);
    while (s->dbc) { // s->dbc is controlled
        msg = lsi_get_msgbyte(s);
        s->sfbr = msg;
        switch (msg) {
		...
        case 0x0d:
            /* The ABORT TAG message clears the current I/O process only. */
            trace_lsi_do_msgout_abort(current_tag);
            if (current_req) { // current_req = s->current
                scsi_req_cancel(current_req->req); // [1] cancel scsi request, s->current will be freed and s->current = NULL
            }
            lsi_disconnect(s);
            break;
		...
        }
    }
    return;
bad:
    qemu_log_mask(LOG_UNIMP, "Unimplemented message 0x%02x\n", msg);
    lsi_set_phase(s, PHASE_MI);
    lsi_add_msg_byte(s, 7); /* MESSAGE REJECT */
    s->msg_action = LSI_MSG_ACTION_COMMAND;
}

```

`s->current` is `lsi_request` object which is created and allocated every time we request SCSI command from OS. Using `lsi_do_msgout`, we can cancel the current SCSI request by calling the `lsi_do_msgout` function and sending `0x0d` message. By sending `0x0d` message in `lsi_do_msgout` function, it will call `scsi_req_cancel` with `current_req->req` as argument. The problem is that after the SCSI request is canceled, `s->current` will be freed, but `current_req` is not null-ed which will point to the freed buffer. Because `current_req` is freed, by sending the next message byte with `0x0d` again. `current_req->req` will have an invalid value and can lead to undefined behavior or crash.

**ASAN Crash Log**

```
user@nopwn:~$ sudo setpci -s 00:04.0 4.B=7
[sudo] password for user:
user@nopwn:~$ sudo insmod hello.ko
=================================================================
==85627==ERROR: AddressSanitizer: heap-use-after-free on address 0x60400003d1d0 at pc 0x5654fb37e3e2 bp 0x7fb0657fb010 sp 0x7fb0657fb000
READ of size 8 at 0x60400003d1d0 thread T6
    #0 0x5654fb37e3e1 in lsi_do_msgout ../../hw/scsi/lsi53c895a.c:1033
    #1 0x5654fb380f18 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1267
    #2 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #3 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #4 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #5 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #6 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #7 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #8 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #9 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #10 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #11 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #12 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #13 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #14 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
    #15 0x7fb12c6e2292 in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x122292)
0x60400003d1d0 is located 0 bytes inside of 48-byte region [0x60400003d1d0,0x60400003d200)
freed by thread T6 here:
    #0 0x7fb12d90c7cf in __interceptor_free (/lib/x86_64-linux-gnu/libasan.so.5+0x10d7cf)
    #1 0x5654fb379df6 in lsi_request_free ../../hw/scsi/lsi53c895a.c:748
    #2 0x5654fb379fac in lsi_request_cancelled ../../hw/scsi/lsi53c895a.c:757
    #3 0x5654fb1cb19f in scsi_req_cancel_complete ../../hw/scsi/scsi-bus.c:1527
    #4 0x5654fb1cbc67 in scsi_req_cancel ../../hw/scsi/scsi-bus.c:1576
    #5 0x5654fb37e3f0 in lsi_do_msgout ../../hw/scsi/lsi53c895a.c:1033
    #6 0x5654fb380f18 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1267
    #7 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #8 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #9 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #10 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #11 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #12 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #13 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #14 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #15 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #16 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #17 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #18 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #19 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
previously allocated by thread T6 here:
    #0 0x7fb12d90cdc6 in calloc (/lib/x86_64-linux-gnu/libasan.so.5+0x10ddc6)
    #1 0x7fb12d418ef0 in g_malloc0 (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x57ef0)
    #2 0x5654fb380ef0 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1261
    #3 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #4 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #5 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #6 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #7 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #8 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #9 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #10 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #11 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #12 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #13 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #14 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #15 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
Thread T6 created by T0 here:
    #0 0x7fb12d839805 in pthread_create (/lib/x86_64-linux-gnu/libasan.so.5+0x3a805)
    #1 0x5654fc455e59 in qemu_thread_create ../../util/qemu-thread-posix.c:558
    #2 0x5654fbdec1a3 in kvm_start_vcpu_thread ../../accel/kvm/kvm-accel-ops.c:73
    #3 0x5654fbc2dd81 in qemu_init_vcpu ../../softmmu/cpus.c:628
    #4 0x5654fb7481ad in x86_cpu_realizefn ../../target/i386/cpu.c:6910
    #5 0x5654fc2260e1 in device_set_realized ../../hw/core/qdev.c:761
    #6 0x5654fbe61f58 in property_set_bool ../../qom/object.c:2257
    #7 0x5654fbe5c74d in object_property_set ../../qom/object.c:1402
    #8 0x5654fbe653b8 in object_property_set_qobject ../../qom/qom-qobject.c:28
    #9 0x5654fbe5cd70 in object_property_set_bool ../../qom/object.c:1472
    #10 0x5654fc222a27 in qdev_realize ../../hw/core/qdev.c:389
    #11 0x5654fb700c39 in x86_cpu_new ../../hw/i386/x86.c:111
    #12 0x5654fb700f35 in x86_cpus_init ../../hw/i386/x86.c:138
    #13 0x5654fb671cfb in pc_init1 ../../hw/i386/pc_piix.c:159
    #14 0x5654fb674c04 in pc_init_v6_1 ../../hw/i386/pc_piix.c:427
    #15 0x5654fae1d754 in machine_run_board_init ../../hw/core/machine.c:1237
    #16 0x5654fbc0d1be in qemu_init_board ../../softmmu/vl.c:2514
    #17 0x5654fbc0d598 in qmp_x_exit_preconfig ../../softmmu/vl.c:2588
    #18 0x5654fbc12cb8 in qemu_init ../../softmmu/vl.c:3611
    #19 0x5654faac6554 in main ../../softmmu/main.c:49
    #20 0x7fb12c5e70b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
SUMMARY: AddressSanitizer: heap-use-after-free ../../hw/scsi/lsi53c895a.c:1033 in lsi_do_msgout
Shadow bytes around the buggy address:
  0x0c087ffff9e0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffff9f0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa00: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa10: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa20: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
=>0x0c087ffffa30: fa fa fd fd fd fd fd fd fa fa[fd]fd fd fd fd fd
  0x0c087ffffa40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==85627==ABORTING

```
## Exploitability[#](#exploitability)

To exploit this kind of bug (use after free), we must overwrite the freed value by reallocating (malloc) heap memory with the same size with chunk‚Äôs size, which we want to overwrite. In this case, we must allocate memory after `scsi_req_cancel`, but unfortunately there‚Äôs no malloc primitive in this function. The only way to exploit this bug is by using another thread to spray the heap, and hope after `current_req` is freed, another thread will immediately allocating the freed chunk and overwrite `current_req` content/object, if we can control `current_req` content we can make a fake structure and can lead to code execution. But unfortunately, the idea to spray the heap using another thread is likely impossible, because mechanism in QEMU when handle incoming IO/MMIO request (we can read this mechanism in `prepare_mmio_access` in `softmmu/physmem.c`). The current mechanism is VCPU thread which handle LSI SCSI operation, can‚Äôt run at the same time with another VCPU thread which we made to do heap spray. Because of this restriction, we can‚Äôt control freed object and exploiting this bug is likely impossible.

## Requirement[#](#requirement)

* Attacker need to run as high-privileged user to load kernel module
* Using LSI SCSI with command `-device lsi53c810,id=scsi -device scsi-hd,drive=SysDisk -drive id=SysDisk,if=none,file=./disk.img`

## Proof Of Concept[#](#proof-of-concept)

PoC to trigger crash

* Host OS : Ubuntu
* Guest OS : Ubuntu
* Example QEMU command line used:

  ```
  qemu-system-x86_64 \
    -kernel ./bzImage \
    -m 3G -smp 4\
    -drive file=./groovy-debootsrap.ext2.qcow2 \
    -net nic -net user,hostfwd=tcp::2222-:22 \
    -append "root=/dev/sda console=ttyS0 nokaslr" \
    -device lsi53c810,id=scsi -device scsi-hd,drive=SysDisk -drive id=SysDisk,if=none,file=./disk.img \
    -nographic -enable-kvm -display none

  ```
* Run:

  ```
  $ sudo setpci -s 00:04.0 4.B=7 # enable master bit for lsi scsi pci device
  $ sudo insmod hello.ko

  ```

# Mitigations[#](#mitigations)

* Since the PoC must be run at high-privileged on the guest OS, Do not run untrusted code or driver in guest OS.

# Timeline:[#](#timeline)

* 2021-12-28 Vendor disclosure
* 2022-03-28 Vendor patched

[¬´ Prev

(CVE-2022-0168) Linux Kernel smb2\_ioctl\_query\_info NULL Pointer Dereference](https://starlabs.sg/advisories/22/22-0168/)
[Next ¬ª

(CVE-2022-28730) Apache JSPWiki v2.11.1 - Reflected XSS in AjaxPreview.jsp](https://starlabs.sg/advisories/22/22-28730/)

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from secure.gravatar.com_fb2e3933_20250115_190601.html ===
ÔøΩÔøΩÔøΩÔøΩ JFIF  ` `  ÔøΩÔøΩ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ÔøΩÔøΩ C 



ÔøΩÔøΩ C  

ÔøΩÔøΩ  P P" ÔøΩÔøΩ           
ÔøΩÔøΩ ÔøΩ   } !1AQa"q2ÔøΩÔøΩÔøΩ#BÔøΩÔøΩRÔøΩÔøΩ$3brÔøΩ
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ        
ÔøΩÔøΩ ÔøΩ  w !1AQaq"2ÔøΩBÔøΩÔøΩÔøΩÔøΩ #3RÔøΩbrÔøΩ
$4ÔøΩ%ÔøΩ&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ   ? ÔøΩ\*(ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ( ÔøΩÔøΩÔøΩÔøΩÔøΩdÔøΩÔøΩÔøΩ:]ŒΩÔøΩjÔøΩhÔøΩÔøΩcoÔøΩ0ÔøΩ\ÔøΩ ÔøΩÔøΩÔøΩ2H99ÔøΩ◊∞ÔøΩÔøΩN=!ÔøΩÔøΩÔøΩ3ÔøΩÔøΩÔøΩÔøΩÔøΩLÔøΩÔøΩÔøΩ)ÔøΩÔøΩkÔøΩ5WFÔøΩÔøΩ[ÔøΩ›èÔøΩÔøΩpÔøΩcÔøΩÔøΩÔøΩ“ßÓΩµJÔøΩ {>ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩﬂÖÔøΩÔøΩ{=ÔøΩzﬁìYÔøΩÔøΩÔøΩdÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ^4zWÔøΩCGz2R^GÔøΩÔøΩÔøΩÔøΩÔøΩOÔøΩ◊ÉÔøΩÔøΩÔøΩ(ÔøΩÔøΩÔøΩ(ÔøΩÔøΩÔøΩÔøΩDÔøΩUÔøΩOÔøΩ61\_ÔøΩ&ÔøΩÔøΩÔøΩ:ÔøΩÔøΩ0ÔøΩ…¥ÔøΩgÔøΩ3ÔøΩÔøΩÓ°´ÔøΩ^Z2ÔøΩ=ÔøΩÔøΩuapÔøΩÔøΩ◊Ö
{ÔøΩÔøΩÔøΩÔøΩŸ∑ÔøΩ%“µÔøΩ[ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ|ÔøΩKM%hDqCÔøΩTÔøΩÔøΩ√êÔøΩÔøΩÔøΩ'ÔøΩk?ÔøΩÔøΩ@ÔøΩ]ÔøΩÔøΩÔøΩs\kÔøΩ ÔøΩ2ÔøΩÔøΩÔøΩ—õ-ÔøΩ0A'ÔøΩ+ÔøΩ#\_ÔøΩIÔøΩy ÔøΩÔøΩÔøΩÔøΩÔøΩY|h\_k2xSO!ÔøΩ,nDÔøΩÔøΩ ÔøΩÔøΩÔøΩ#\_eÔøΩœøÔøΩÔøΩÔøΩ,ÔøΩ3~bÔøΩÔøΩÔøΩzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩlÔøΩ-ÔøΩrÔøΩ AslÔøΩÔøΩrÔøΩÔøΩÔøΩÔøΩ>ÔøΩÔøΩÔøΩÔøΩÔøΩcÔøΩÔøΩÔøΩ \_7ÔøΩ=ÔøΩÔøΩnÔøΩXm+ÔøΩÔøΩrkƒøaÔøΩÔøΩ7]ÔøΩÔøΩnÔøΩ ÔøΩ{ÔøΩ#ÔøΩnÔøΩM¬ΩPÔøΩ+ÔøΩÔøΩslÔøΩÔøΩÔøΩYHÔøΩ0A
xÔøΩÔøΩ?XÔøΩ'FÔøΩÔøΩ\_{>ÔøΩ\_ÔøΩ=:ÔøΩÔøΩ-4ÔøΩÔøΩÔøΩ«é=BFkÔøΩÔøΩ⁄øÔøΩYÔøΩ^xÔøΩÔøΩ6Koy3\_ÔøΩ.uÔøΩÔøΩFÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩsÔøΩÔøΩÔøΩAÔøΩÔøΩÔøΩÔøΩuÔøΩ/xÔøΩÔøΩÔøΩÈ∫¥ÔøΩ2 ?ÔøΩ[ÔøΩÔøΩtV<ÔøΩ ÔøΩ ÔøΩÔøΩ<A`ÔøΩvNqÔøΩZ5ÔøΩÔøΩ1~ÔøΩÔøΩÔøΩÔøΩFX.$ÔøΩ=4ÔøΩbÔøΩ ÔøΩÔøΩÔøΩ`ÔøΩ2:R◊©~ÔøΩÔøΩÔøΩuÔøΩJÔøΩHÔøΩZfÔøΩÔøΩnÔøΩETÔøΩHtFÔøΩ+^[\_ÔøΩÔøΩÔøΩQÔøΩhm%sÔøΩ^xJÔøΩSxÔøΩ}ÔøΩÔøΩ ÔøΩ—£ÔøΩÔøΩ^3’∂ÔøΩ4ÔøΩpZÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩkÔøΩÔøΩ'ÔøΩÔøΩÒûì∏ ÔøΩÔøΩÔøΩÔøΩorÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩEx|GÔøΩÔøΩÔøΩ;y~hÔøΩÔøΩÔøΩ‘ßÔøΩÔøΩVÔøΩÔøΩÔøΩÔøΩÔøΩeÔøΩœÇÔøΩÔøΩF/ÔøΩec4ÔøΩB ÑÔøΩÔøΩÔøΩ\_ÔøΩ!ÔøΩRdÔøΩÃí9.ÔøΩÔøΩ%ÔøΩÔøΩI5ÔøΩÔøΩÔøΩÔøΩÔøΩRÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩOfd!OÔøΩE~PÔøΩÔøΩhÔøΩFÔøΩXÔøΩGF\*√ÇÔøΩÔøΩÔøΩÔøΩ9\*ÔøΩ 5ÔøΩÔøΩÔøΩ\ÔøΩÔøΩ”üÔøΩQÔøΩ[?ÔøΩOÔøΩÔøΩwÔøΩ7{ÔøΩÔøΩÔøΩÔøΩÔøΩ\*ÔøΩ[ÔøΩÔøΩÔøΩ(ÔøΩ7ÔøΩ[ÔøΩÔøΩÔøΩÔøΩÔøΩ€öÔøΩÔøΩ2‘£ÔøΩ i.mÔøΩ?xÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩWÔøΩ>7xÔøΩÔøΩÔøΩ\_ÔøΩZ]ÔøΩÔøΩ‹ßÔøΩÔøΩ8
ÔøΩÔøΩeH>ÔøΩOÔøΩ7≈è|SÔøΩÔøΩmvÔøΩ6ÔøΩZ+KdÔøΩÔøΩF=[$ÔøΩrOÔøΩhÔøΩÔøΩ ⁄üZÔøΩ\ÔøΩÔøΩÔøΩ{ÔøΩÔøΩ2\GÔøΩYGÔøΩÔøΩ\_ÔøΩÔøΩÔøΩÔøΩÔøΩ◊øÔøΩÔøΩA4ÔøΩÔøΩG4.ÔøΩKGCÔøΩÔøΩAÔøΩÔøΩÔøΩÔøΩqÔøΩGÔøΩÔøΩ?
ÔøΩcÔøΩ‘¥ÔøΩ.e pÔøΩÔøΩÔøΩÔøΩM~>AÔøΩ3ÔøΩ(ÔøΩÔøΩ#DAÔøΩÔøΩN ÔøΩÔøΩÔøΩ?ÔøΩ>|2ÔøΩÔøΩ6<ÔøΩ7LÔøΩÔøΩR:XÔøΩcÔøΩÊ£ãy=ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ\_?ÔøΩÔøΩoÔøΩÔøΩÔøΩÔøΩﬂ©ÔøΩÔøΩÔøΩF!ÔøΩÔøΩ Eu5ÔøΩ}CÔøΩoÔøΩÔøΩ\_#WÔøΩÔøΩnÔøΩÔøΩÔøΩÔøΩ<0/%‘∑ÔøΩÔøΩÔøΩÔøΩ|ÔøΩ^ÔøΩsgBÔøΩÔøΩÔøΩx|SÔøΩÔøΩÔøΩR›ïÔøΩÔøΩÔøΩ\_ÔøΩ/ÔøΩh~ÔøΩaÔøΩÔøΩÔøΩaÔøΩÔøΩ!”ØÔøΩ=ÔøΩÔøΩ>ÔøΩ\.Oe-^+E{ÔøΩÔøΩÔøΩQÔøΩÔøΩ%cÔøΩpÔøΩÔøΩÔøΩ+¬Ω=ÔøΩÔøΩ~ÔøΩÔøΩ6+nPÔøΩÔøΩÔøΩ|/ÔøΩQÔøΩÔøΩÔøΩÔøΩkÔøΩ.ÔøΩ}ÔøΩﬁ≠ÔøΩ2ÔøΩÔøΩp.dÔøΩÔøΩXÔøΩÔøΩÔøΩ’îsÔøΩFrqÔøΩÔøΩ…øÔøΩ’µﬁõeÔøΩﬁ≠ÔøΩÔøΩ
ÔøΩi⁄≠ÔøΩa.pÔøΩH«£ÔøΩ cÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩk{ÔøΩÔøΩ+ÔøΩÔøΩy/ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ\IÔøΩZÔøΩÔøΩÔøΩÔøΩ \_yÔøΩÔøΩ4Oo3ÔøΩ\*4RÔøΩ\*ÔøΩ!ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ3$0ÔøΩÔøΩÔøΩ#HÔøΩK3ÔøΩ :ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ xÔøΩ\_7\ÔøΩŒëÔøΩÕå ÔøΩ,ÔøΩAÔøΩb3ÔøΩÔøΩÔøΩo·øÉ|'ÔøΩÔøΩÔøΩoGÔøΩÔøΩÔøΩÔøΩvqÔøΩ!ÔøΩ ÔøΩÔøΩ÷æÔøΩÔøΩmÔøΩÔøΩÔøΩ'ÔøΩÔøΩÔøΩÔøΩ>?ÔøΩKÔøΩÔøΩolÔøΩ}5ÔøΩÔøΩÔøΩÔøΩ'ÔøΩÔøΩÔøΩ ÔøΩ>ÔøΩÔøΩÔøΩV^8ÔøΩ≈ìY}ÔøΩÔøΩÔøΩÔøΩ"uƒ¶OÔøΩUÔøΩÔøΩUO9ÔøΩ8ÔøΩÔøΩkqÔøΩsÔøΩÔøΩÔøΩ?ZÔøΩeÔøΩÔøΩmpœäÔøΩÔøΩÔøΩÔøΩÔøΩ∆†.ÔøΩ5·´±5ÃôÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ
!\ÔøΩ$}ﬂØOÔøΩÔøΩÔøΩyÔøΩ-iÔøΩÔøΩÔøΩ}ÔøΩÔøΩF8.ÔøΩ=tÔøΩdÔøΩ ÔøΩÔøΩÔøΩoÔøΩÔøΩÔøΩÔøΩÔøΩeÔøΩ≈¥ÔøΩnÔøΩ`>ÔøΩnÔøΩÔøΩ>ÔøΩKÔøΩÔøΩÔøΩ8=ÔøΩÔøΩÔøΩÔøΩRÔøΩÔøΩÔøΩl<0ÔøΩcFEXÔøΩGÔøΩÔøΩ2ÔøΩÔøΩÔøΩÔøΩNÔøΩEWQÔøΩ!ÔøΩ\_ÔøΩiÔøΩSÔøΩÔøΩÔøΩYC~ÔøΩŒì
ÔøΩZÔøΩdÔøΩÔøΩÔøΩÔøΩ=HÔøΩÔøΩ4W5|5T9+EIyÔøΩX|U|$ÔøΩÔøΩ ÔøΩÔøΩ#ÔøΩ/ÔøΩ
jÔøΩÔøΩÔøΩÔøΩÔøΩmÔøΩÔøΩ?dÔøΩITÔøΩ ÔøΩAjÔøΩÔøΩÔøΩ|A,,4ÔøΩ
^ÔøΩ!}ÔøΩÔøΩ"ÔøΩÔøΩ
\_Q^ÔøΩÔøΩÔøΩs\_ÔøΩÔøΩÔøΩÔøΩœ¢ÔøΩ Z3N^\_hÔøΩlÔøΩÔøΩÔøΩﬂàÔøΩÔøΩ\_ÔøΩ>#G-ÔøΩÔøΩÔøΩÔøΩZlÔøΩ
iÔøΩÔøΩ7ÔøΩGrKqÔøΩÔøΩyÔøΩÔøΩAÔøΩ0)hÔøΩwÔøΩÔøΩÔøΩÔøΩ%ÔøΩÔøΩ#ÔøΩq8ÔøΩÔøΩÔøΩÔøΩJÔøΩr~aEWIÔøΩÔøΩÔøΩ

=== Content from starlabs.sg_45afdc13_20250115_122257.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/)¬†¬ª¬†[Advisories](https://starlabs.sg/advisories/)
# (CVE-2022-0216) QEMU LSI SCSI Use After Free

March 28, 2022¬†¬∑¬†7 min¬†¬∑¬†Muhammad Alifa Ramdhan (@n0psledbyte)

Table of Contents

* [Description of the vulnerability](#description-of-the-vulnerability)
  + [Technical Details](#technical-details)
  + [Exploitability](#exploitability)
  + [Requirement](#requirement)
  + [Proof Of Concept](#proof-of-concept)
* [Mitigations](#mitigations)
* [Timeline:](#timeline)

**CVE**: CVE-2022-0216

**Tested Versions**:

* QEMU < v6.0.0

**Product URL(s)**:

* <https://www.qemu.org/>

# Description of the vulnerability[#](#description-of-the-vulnerability)

## Technical Details[#](#technical-details)

The vulnerability resides in the `hw/scsi/lsi53c895a.c` specifically in `lsi_do_msgout` function. `lsi_do_msgout` function is used to receive messages from the OS, and do something based on that message. In this case, one message only has one-byte size.

```
static void lsi_do_msgout(LSIState *s)
{
    uint8_t msg;
    int len;
    uint32_t current_tag;
    lsi_request *current_req, *p, *p_next;
    if (s->current) {
        current_tag = s->current->tag;
        current_req = s->current; // [1]
    } else {
        current_tag = s->select_tag;
        current_req = lsi_find_by_tag(s, current_tag);
    }
    trace_lsi_do_msgout(s->dbc);
    while (s->dbc) { // s->dbc is controlled
        msg = lsi_get_msgbyte(s);
        s->sfbr = msg;
        switch (msg) {
		...
        case 0x0d:
            /* The ABORT TAG message clears the current I/O process only. */
            trace_lsi_do_msgout_abort(current_tag);
            if (current_req) { // current_req = s->current
                scsi_req_cancel(current_req->req); // [1] cancel scsi request, s->current will be freed and s->current = NULL
            }
            lsi_disconnect(s);
            break;
		...
        }
    }
    return;
bad:
    qemu_log_mask(LOG_UNIMP, "Unimplemented message 0x%02x\n", msg);
    lsi_set_phase(s, PHASE_MI);
    lsi_add_msg_byte(s, 7); /* MESSAGE REJECT */
    s->msg_action = LSI_MSG_ACTION_COMMAND;
}

```

`s->current` is `lsi_request` object which is created and allocated every time we request SCSI command from OS. Using `lsi_do_msgout`, we can cancel the current SCSI request by calling the `lsi_do_msgout` function and sending `0x0d` message. By sending `0x0d` message in `lsi_do_msgout` function, it will call `scsi_req_cancel` with `current_req->req` as argument. The problem is that after the SCSI request is canceled, `s->current` will be freed, but `current_req` is not null-ed which will point to the freed buffer. Because `current_req` is freed, by sending the next message byte with `0x0d` again. `current_req->req` will have an invalid value and can lead to undefined behavior or crash.

**ASAN Crash Log**

```
user@nopwn:~$ sudo setpci -s 00:04.0 4.B=7
[sudo] password for user:
user@nopwn:~$ sudo insmod hello.ko
=================================================================
==85627==ERROR: AddressSanitizer: heap-use-after-free on address 0x60400003d1d0 at pc 0x5654fb37e3e2 bp 0x7fb0657fb010 sp 0x7fb0657fb000
READ of size 8 at 0x60400003d1d0 thread T6
    #0 0x5654fb37e3e1 in lsi_do_msgout ../../hw/scsi/lsi53c895a.c:1033
    #1 0x5654fb380f18 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1267
    #2 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #3 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #4 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #5 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #6 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #7 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #8 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #9 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #10 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #11 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #12 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #13 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #14 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
    #15 0x7fb12c6e2292 in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x122292)
0x60400003d1d0 is located 0 bytes inside of 48-byte region [0x60400003d1d0,0x60400003d200)
freed by thread T6 here:
    #0 0x7fb12d90c7cf in __interceptor_free (/lib/x86_64-linux-gnu/libasan.so.5+0x10d7cf)
    #1 0x5654fb379df6 in lsi_request_free ../../hw/scsi/lsi53c895a.c:748
    #2 0x5654fb379fac in lsi_request_cancelled ../../hw/scsi/lsi53c895a.c:757
    #3 0x5654fb1cb19f in scsi_req_cancel_complete ../../hw/scsi/scsi-bus.c:1527
    #4 0x5654fb1cbc67 in scsi_req_cancel ../../hw/scsi/scsi-bus.c:1576
    #5 0x5654fb37e3f0 in lsi_do_msgout ../../hw/scsi/lsi53c895a.c:1033
    #6 0x5654fb380f18 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1267
    #7 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #8 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #9 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #10 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #11 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #12 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #13 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #14 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #15 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #16 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #17 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #18 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #19 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
previously allocated by thread T6 here:
    #0 0x7fb12d90cdc6 in calloc (/lib/x86_64-linux-gnu/libasan.so.5+0x10ddc6)
    #1 0x7fb12d418ef0 in g_malloc0 (/lib/x86_64-linux-gnu/libglib-2.0.so.0+0x57ef0)
    #2 0x5654fb380ef0 in lsi_execute_script ../../hw/scsi/lsi53c895a.c:1261
    #3 0x5654fb38df20 in lsi_reg_writeb ../../hw/scsi/lsi53c895a.c:1984
    #4 0x5654fb39559f in lsi_mmio_write ../../hw/scsi/lsi53c895a.c:2095
    #5 0x5654fb936452 in memory_region_write_accessor ../../softmmu/memory.c:491
    #6 0x5654fb9368dd in access_with_adjusted_size ../../softmmu/memory.c:552
    #7 0x5654fb943b74 in memory_region_dispatch_write ../../softmmu/memory.c:1502
    #8 0x5654fbb93b1c in flatview_write_continue ../../softmmu/physmem.c:2746
    #9 0x5654fbb93ef2 in flatview_write ../../softmmu/physmem.c:2786
    #10 0x5654fbb94870 in address_space_write ../../softmmu/physmem.c:2878
    #11 0x5654fbb9492c in address_space_rw ../../softmmu/physmem.c:2888
    #12 0x5654fbbd8347 in kvm_cpu_exec ../../accel/kvm/kvm-all.c:2517
    #13 0x5654fbdebd07 in kvm_vcpu_thread_fn ../../accel/kvm/kvm-accel-ops.c:49
    #14 0x5654fc4559f9 in qemu_thread_start ../../util/qemu-thread-posix.c:521
    #15 0x7fb12c7bb608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477
Thread T6 created by T0 here:
    #0 0x7fb12d839805 in pthread_create (/lib/x86_64-linux-gnu/libasan.so.5+0x3a805)
    #1 0x5654fc455e59 in qemu_thread_create ../../util/qemu-thread-posix.c:558
    #2 0x5654fbdec1a3 in kvm_start_vcpu_thread ../../accel/kvm/kvm-accel-ops.c:73
    #3 0x5654fbc2dd81 in qemu_init_vcpu ../../softmmu/cpus.c:628
    #4 0x5654fb7481ad in x86_cpu_realizefn ../../target/i386/cpu.c:6910
    #5 0x5654fc2260e1 in device_set_realized ../../hw/core/qdev.c:761
    #6 0x5654fbe61f58 in property_set_bool ../../qom/object.c:2257
    #7 0x5654fbe5c74d in object_property_set ../../qom/object.c:1402
    #8 0x5654fbe653b8 in object_property_set_qobject ../../qom/qom-qobject.c:28
    #9 0x5654fbe5cd70 in object_property_set_bool ../../qom/object.c:1472
    #10 0x5654fc222a27 in qdev_realize ../../hw/core/qdev.c:389
    #11 0x5654fb700c39 in x86_cpu_new ../../hw/i386/x86.c:111
    #12 0x5654fb700f35 in x86_cpus_init ../../hw/i386/x86.c:138
    #13 0x5654fb671cfb in pc_init1 ../../hw/i386/pc_piix.c:159
    #14 0x5654fb674c04 in pc_init_v6_1 ../../hw/i386/pc_piix.c:427
    #15 0x5654fae1d754 in machine_run_board_init ../../hw/core/machine.c:1237
    #16 0x5654fbc0d1be in qemu_init_board ../../softmmu/vl.c:2514
    #17 0x5654fbc0d598 in qmp_x_exit_preconfig ../../softmmu/vl.c:2588
    #18 0x5654fbc12cb8 in qemu_init ../../softmmu/vl.c:3611
    #19 0x5654faac6554 in main ../../softmmu/main.c:49
    #20 0x7fb12c5e70b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
SUMMARY: AddressSanitizer: heap-use-after-free ../../hw/scsi/lsi53c895a.c:1033 in lsi_do_msgout
Shadow bytes around the buggy address:
  0x0c087ffff9e0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffff9f0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa00: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa10: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
  0x0c087ffffa20: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd
=>0x0c087ffffa30: fa fa fd fd fd fd fd fd fa fa[fd]fd fd fd fd fd
  0x0c087ffffa40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087ffffa80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==85627==ABORTING

```
## Exploitability[#](#exploitability)

To exploit this kind of bug (use after free), we must overwrite the freed value by reallocating (malloc) heap memory with the same size with chunk‚Äôs size, which we want to overwrite. In this case, we must allocate memory after `scsi_req_cancel`, but unfortunately there‚Äôs no malloc primitive in this function. The only way to exploit this bug is by using another thread to spray the heap, and hope after `current_req` is freed, another thread will immediately allocating the freed chunk and overwrite `current_req` content/object, if we can control `current_req` content we can make a fake structure and can lead to code execution. But unfortunately, the idea to spray the heap using another thread is likely impossible, because mechanism in QEMU when handle incoming IO/MMIO request (we can read this mechanism in `prepare_mmio_access` in `softmmu/physmem.c`). The current mechanism is VCPU thread which handle LSI SCSI operation, can‚Äôt run at the same time with another VCPU thread which we made to do heap spray. Because of this restriction, we can‚Äôt control freed object and exploiting this bug is likely impossible.

## Requirement[#](#requirement)

* Attacker need to run as high-privileged user to load kernel module
* Using LSI SCSI with command `-device lsi53c810,id=scsi -device scsi-hd,drive=SysDisk -drive id=SysDisk,if=none,file=./disk.img`

## Proof Of Concept[#](#proof-of-concept)

PoC to trigger crash

* Host OS : Ubuntu
* Guest OS : Ubuntu
* Example QEMU command line used:

  ```
  qemu-system-x86_64 \
    -kernel ./bzImage \
    -m 3G -smp 4\
    -drive file=./groovy-debootsrap.ext2.qcow2 \
    -net nic -net user,hostfwd=tcp::2222-:22 \
    -append "root=/dev/sda console=ttyS0 nokaslr" \
    -device lsi53c810,id=scsi -device scsi-hd,drive=SysDisk -drive id=SysDisk,if=none,file=./disk.img \
    -nographic -enable-kvm -display none

  ```
* Run:

  ```
  $ sudo setpci -s 00:04.0 4.B=7 # enable master bit for lsi scsi pci device
  $ sudo insmod hello.ko

  ```

# Mitigations[#](#mitigations)

* Since the PoC must be run at high-privileged on the guest OS, Do not run untrusted code or driver in guest OS.

# Timeline:[#](#timeline)

* 2021-12-28 Vendor disclosure
* 2022-03-28 Vendor patched

[¬´ Prev

(CVE-2022-0168) Linux Kernel smb2\_ioctl\_query\_info NULL Pointer Dereference](https://starlabs.sg/advisories/22/22-0168/)
[Next ¬ª

(CVE-2022-28730) Apache JSPWiki v2.11.1 - Reflected XSS in AjaxPreview.jsp](https://starlabs.sg/advisories/22/22-28730/)

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from starlabs.sg_ce8b35b9_20250115_190601.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

# STAR Labs

We are a Singapore company providing cyber security services. Our aim is to enable organizations to better prepare and protect themselves against the ever-evolving threat of cyber attacks.

## (CVE-2024-6781) Calibre Arbitrary File Read

Summary Product Calibre Vendor Calibre Severity High - Unprivileged adversaries may exploit software vulnerabilities to perform relative path traversal to achieve arbitrary file read Affected Versions <= 7.14.0 (latest version as of writing) Tested Versions 7.14.0 CVE Identifier CVE-2024-6781 CVE Description Improper Limitation of a Pathname to a Restricted Directory (‚ÄòPath Traversal‚Äô) vulnerability allows Relative Path Traversal CWE Classification(s) CWE-22 Improper Limitation of a Pathname to a Restricted Directory (‚ÄòPath Traversal‚Äô) CAPEC Classification(s) CAPEC-139 Relative Path Traversal CVSS3....

July 31, 2024¬†¬∑¬†4 min¬†¬∑¬†Amos Ng (@LFlare)

## (CVE-2024-6782) Calibre Remote Code Execution

Summary Product Calibre Vendor Calibre Severity Critical - Unprivileged adversaries may exploit software vulnerabilities to perform remote code execution Affected Versions 6.9.0 ~ 7.14.0 (latest version as of writing) Tested Versions 7.14.0 CVE Identifier CVE-2024-6782 CVE Description Improper Access Control in Calibre Content Server allows remote code execution CWE Classification(s) CWE-863: Incorrect Authorization CAPEC Classification(s) CAPEC-253: Remote Code Inclusion CVSS3....

July 31, 2024¬†¬∑¬†4 min¬†¬∑¬†Amos Ng (@LFlare)

## (CVE-2024-7008) Calibre Reflected Cross-Site Scripting (XSS)

Summary Product Calibre Vendor Calibre Severity Medium Affected Versions <= 7.15.0 (latest version as of writing) Tested Versions 7.15.0 CVE Identifier CVE-2024-7008 CWE Classification(s) CWE-79 Improper Neutralization of Input During Web Page Generation (XSS or ‚ÄòCross-site Scripting‚Äô) CAPEC Classification(s) CAPEC-591 Reflected XSS CVSS3.1 Scoring System Base Score: 5.4 (Medium) Vector String: CVSS:3....

July 31, 2024¬†¬∑¬†3 min¬†¬∑¬†Devesh Logendran

## (CVE-2024-7009) Calibre SQLite Injection

Summary Product Calibre Vendor Calibre Severity Medium Affected Versions <= 7.15.0 (latest version as of writing) Tested Versions 7.15.0 CVE Identifier CVE-2024-7009 CWE Classification(s) CWE-89 Improper Neutralization of Special Elements used in an SQL Command (‚ÄòSQL Injection‚Äô) CAPEC Classification(s) CAPEC-66 SQL Injection CVSS3.1 Scoring System Base Score: 4.2 (Medium) Vector String: CVSS:3....

July 31, 2024¬†¬∑¬†5 min¬†¬∑¬†Devesh Logendran

## (CVE-2024-1837) Singtel RT5703W Unauthenticated Command Injection RCE via Login Vulnerability

Summary Product Singtel WI-FI 6 ROUTER RT5703W Vendor Singtel/Askey Severity Critical - Adversaries may exploit software vulnerabilities to execute arbitrary commands on the underlying OS with root privileges. Affected Versions V1.6.4-5194 (latest version as of writing) Tested Versions V1.6.4-5194 (latest version as of writing) Internal Identifier STAR-2023-0097 CVE Identifier TBD CVE Description OS command injection vulnerability in net....

July 22, 2024¬†¬∑¬†5 min¬†¬∑¬†Daniel Lim Wee Soong (@daniellimws)

## (CVE-2024-1838) Singtel RT5703W Authenticated Command Injection RCE via SetLoginPwd Vulnerability

Summary Product Singtel WI-FI 6 ROUTER RT5703W Vendor Singtel/Askey Severity High - Adversaries may exploit software vulnerabilities to execute arbitrary commands on the underlying OS with root privileges. Affected Versions V1.6.4-5194 (latest version as of writing) Tested Versions V1.6.4-5194 (latest version as of writing) Internal Identifier STAR-2023-0098 CVE Identifier TBD CVE Description OS command injection vulnerability in net....

July 22, 2024¬†¬∑¬†5 min¬†¬∑¬†Daniel Lim Wee Soong (@daniellimws)

## (CVE-2023-3368) Chamilo LMS Unauthenticated Command Injection

Summary Product Chamilo Vendor Chamilo Severity High - Adversaries may exploit software vulnerabilities to obtain unauthenticated remote code execution. Affected Versions <= v1.11.20 Tested Versions v1.11.20 (latest version as of writing) CVE Identifier CVE-2023-3368 CVE Description Command injection in /main/webservices/additional\_webservices.php in Chamilo LMS <= v1.11.20 allows unauthenticated attackers to obtain remote code execution via improper neutralisation of special characters....

November 28, 2023¬†¬∑¬†5 min¬†¬∑¬†Ngo Wei Lin (@Creastery)

[Next ¬ª](https://starlabs.sg/page/2/)

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from bugzilla.redhat.com_b498c33a_20250115_190556.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2070902)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2070902)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2070902)+ Login using a Red Hat Bugzilla account
  + Forgot¬†Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla ‚Äì Bug¬†2070902

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug¬†2070902**](show_bug.cgi?id=2070902)
- [CVE-2022-0216](https://access.redhat.com/security/cve/CVE-2022-0216) qemu: use-after-free in lsi\_do\_msgout function in hw/scsi/lsi53c895a.c [fedora-all]

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-0216 qemu: use-after-free in lsi\_do\_msgout function in hw/scsi/lsi53...

| | [Keywords](describekeywords.cgi): | Security  SecurityTracking | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | qemu | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 35 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Fedora Virtualization Maintainers | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2022-0216](show_bug.cgi?id=2036953 "CLOSED NOTABUG - CVE-2022-0216 QEMU: use-after-free in lsi_do_msgout function in hw/scsi/lsi53c895a.c") | | TreeView+ | [depends on](buglist.cgi?bug_id=2070902&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2070902&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-04-01 10:10 UTC by Mauro Matteo Cascella | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-11-10 22:20 UTC ([History](show_activity.cgi?id=2070902)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  berrange cfergeau crobinso ondrejj pbonzini philmd rjones virt-maint | | Fixed In Version: | qemu-6.2.0-14.fc36 qemu-7.0.0-10.fc37 | | | Doc Type: | No Doc Update | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-08-18 02:03:25 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2070902#c0)  Mauro Matteo Cascella    2022-04-01 10:10:36 UTC  ```  This is an automatically created tracking bug!  It was created to ensure that one or more security vulnerabilities are fixed in affected versions of fedora-all.  For comments that are specific to the vulnerability please use bugs filed against the "Security Response" product referenced in the "Blocks" field.  For more information see: <http://fedoraproject.org/wiki/Security/TrackingBugs>  When submitting as an update, use the fedpkg template provided in the next comment(s).  This will include the bug IDs of this tracking bug as well as the relevant top-level CVE bugs.  Please also mention the CVE IDs being fixed in the RPM changelog and the fedpkg commit message.  NOTE: this issue affects multiple supported versions of Fedora. While only one tracking bug has been filed, please correct all affected versions at the same time.  If you need to fix the versions independent of each other, you may clone this bug as appropriate.   ```  [Comment 1](show_bug.cgi?id=2070902#c1)  Mauro Matteo Cascella    2022-04-01 10:10:39 UTC  ``` Use the following template to for the 'fedpkg update' request to submit an update for this issue as it contains the top-level parent bug(s) as well as this tracking bug.  This will ensure that all associated bugs get updated when new packages are pushed to stable.  =====  # bugfix, security, enhancement, newpackage (required) type=security  # low, medium, high, urgent (required) severity=low  # testing, stable request=testing  # Bug numbers: 1234,9876 bugs=2036953,2070902  # Description of your update notes=Security fix for [PUT CVEs HERE]  # Enable request automation based on the stable/unstable karma thresholds autokarma=True stable_karma=3 unstable_karma=-3  # Automatically close bugs when this marked as stable close_bugs=True  # Suggest that users restart after update suggest_reboot=False  ======  Additionally, you may opt to use the bodhi web interface to submit updates:  <https://bodhi.fedoraproject.org/updates/new>   ```  [Comment 2](show_bug.cgi?id=2070902#c2)  Cole Robinson    2022-08-03 10:34:00 UTC  ``` Upstream commit: <https://gitlab.com/qemu-project/qemu/-/commit/4367a20cc4>   ```  [Comment 3](show_bug.cgi?id=2070902#c3)  Fedora Update System    2022-08-15 18:11:22 UTC  ``` FEDORA-2022-baf3c3b781 has been submitted as an update to Fedora 36. <https://bodhi.fedoraproject.org/updates/FEDORA-2022-baf3c3b781>   ```  [Comment 4](show_bug.cgi?id=2070902#c4)  Fedora Update System    2022-08-16 01:06:30 UTC  ``` FEDORA-2022-baf3c3b781 has been pushed to the Fedora 36 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2022-baf3c3b781` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2022-baf3c3b781>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 5](show_bug.cgi?id=2070902#c5)  Fedora Update System    2022-08-18 02:03:25 UTC  ``` FEDORA-2022-baf3c3b781 has been pushed to the Fedora 36 stable repository. If problem still persists, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=2070902#c6)  Fedora Update System    2022-10-19 20:16:28 UTC  ``` FEDORA-2022-4387579e67 has been submitted as an update to Fedora 37. <https://bodhi.fedoraproject.org/updates/FEDORA-2022-4387579e67>   ```  [Comment 7](show_bug.cgi?id=2070902#c7)  Fedora Update System    2022-10-20 18:21:09 UTC  ``` FEDORA-2022-4387579e67 has been pushed to the Fedora 37 testing repository. Soon you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --refresh --advisory=FEDORA-2022-4387579e67` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2022-4387579e67>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 8](show_bug.cgi?id=2070902#c8)  Fedora Update System    2022-11-10 22:20:34 UTC  ``` FEDORA-2022-4387579e67 has been pushed to the Fedora 37 stable repository. If problem still persists, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2070902&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from gitlab.com_0a053874_20250115_190601.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# LSI SCSI Use After Free (CVE-2022-0216)

A use-after-free vulnerability was found in the LSI53C895A SCSI Host Bus Adapter. The flaw occurs while processing repeated messages to cancel the current SCSI request via the lsi\_do\_msgout function. A malicious privileged user within the guest could use this flaw to crash the QEMU process on the host. Crash is the most likely outcome from this bug (that is, the UAF is not exploitable). See STAR Labs security advisory [1] for more information.

[1] <https://starlabs.sg/advisories/22-0216/>

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from starlabs.sg_c7f680cc_20250115_190602.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/)
# Publications

2 min¬†¬∑¬†Jacob Soo

Table of Contents

* [2023](#2023)
  + [A Year Fuzzing XNU Mach IPC](#a-year-fuzzing-xnu-mach-ipc)
  + [Ghosts of the Past: Classic PHP RCE Bugs in Trend Micro Enterprise Offerings](#ghosts-of-the-past-classic-php-rce-bugs-in-trend-micro-enterprise-offerings)
  + [What You See IS NOT What You Get: Pwning Electron-based Markdown Note-taking Apps](#what-you-see-is-not-what-you-get-pwning-electron-based-markdown-note-taking-apps)
  + [Unearthing Vulnerabilities in the Apple Ecosystem The Art of KidFuzzerV2.0](#unearthing-vulnerabilities-in-the-apple-ecosystem-the-art-of-kidfuzzerv20)
* [2022](#2022)
  + [How to Backup and Pwn using Time Machine](#how-to-backup-and-pwn-using-time-machine)
  + [The Journey To Hybrid Apple Driver Fuzzing](#the-journey-to-hybrid-apple-driver-fuzzing)
  + [All Roads leads to GKE‚Äôs Host : 4+ Ways to Escape](#all-roads-leads-to-gkes-host--4-ways-to-escape)
  + [A journey of hunting macOS kernel vulnerability](#a-journey-of-hunting-macos-kernel-vulnerability)
  + [An Introduction to Manual Source Code Review](#an-introduction-to-manual-source-code-review)
  + [A case study of an incorrect bitwise and optimization in V8](#a-case-study-of-an-incorrect-bitwise-and-optimization-in-v8)
* [2021](#2021)
  + [VM Escape Case Study VirtualBox Bug Hunting and Exploitation](#vm-escape-case-study-virtualbox-bug-hunting-and-exploitation)
  + [The Great Escape - A Case Study of VM Escape and EoP Vulnerabilities](#the-great-escape---a-case-study-of-vm-escape-and-eop-vulnerabilities)

The following is a list of presentations made by our STAR Labs Cyber Security researchers.

# 2023[#](#2023)

---

## A Year Fuzzing XNU Mach IPC[#](#a-year-fuzzing-xnu-mach-ipc)

* **Date:** 13th to 14th October 2023
* **Author:** Peter NGUY·ªÑN V≈© Ho√†ng
* **Event:** Hexacon 2023
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/Hexacon%202023/A%20Year%20Fuzzing%20XNU%20Mach%20IPC.pptx)

---

## Ghosts of the Past: Classic PHP RCE Bugs in Trend Micro Enterprise Offerings[#](#ghosts-of-the-past-classic-php-rce-bugs-in-trend-micro-enterprise-offerings)

* **Date:** 18th to 19th August 2023
* **Author:** POH Jia Hao
* **Event:** HITCON CMT 2023
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/HITCON%202023/Ghosts%20of%20the%20Past%20-%20Classic%20PHP%20RCE%20Bugs%20in%20Trend%20Micro%20Enterprise%20Offerings.pdf)

---

## What You See IS NOT What You Get: Pwning Electron-based Markdown Note-taking Apps[#](#what-you-see-is-not-what-you-get-pwning-electron-based-markdown-note-taking-apps)

* **Date:** 18th to 19th August 2023
* **Author:** LI Jiantao
* **Event:** HITCON CMT 2023
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/HITCON%202023/Pwning%20Electron-based%20Markdown%20Note-taking%20Apps.pdf)

---

## Unearthing Vulnerabilities in the Apple Ecosystem The Art of KidFuzzerV2.0[#](#unearthing-vulnerabilities-in-the-apple-ecosystem-the-art-of-kidfuzzerv20)

* **Date:** 19th to 20th May 2023
* **Author:** PAN Zhenpeng
* **Event:** Offensivecon 2023
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/Offensivecon%202023/Unearthing%20Vulnerabilities%20in%20the%20Apple%20Ecosystem%20The%20Art%20of%20KidFuzzerV2.0.pdf)

---

# 2022[#](#2022)

---

## How to Backup and Pwn using Time Machine[#](#how-to-backup-and-pwn-using-time-machine)

* **Date:** 10th to 11th November 2022
* **Author:** NGUY·ªÑN Ho√†ng Th·∫°ch
* **Event:** POC 2022
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/POC%202022/Nguyen%20Hoang%20Thach.pdf)

---

## The Journey To Hybrid Apple Driver Fuzzing[#](#the-journey-to-hybrid-apple-driver-fuzzing)

* **Date:** 10th to 11th November 2022
* **Author:** PAN Zhenpeng
* **Event:** POC 2022
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/POC%202022/Zhenpeng%20Pan.pdf)

---

## All Roads leads to GKE‚Äôs Host : 4+ Ways to Escape[#](#all-roads-leads-to-gkes-host--4-ways-to-escape)

* **Date:** 11th to 14th August 2022
* **Author:** Billy JHENG Bing-Jhong & Muhammad Ramdhan
* **Event:** Defcon 30 2022
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/Defcon%2030/Billy%20Jheng%20%20%20Muhammad%20Alifa%20Ramdhan%20-%20All%20Roads%20leads%20to%20GKEs%20Host%20%204%2B%20Ways%20to%20Escape.pdf)
* **Alternative Link:** [Presentation](https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Billy%20Jheng%20%20%20Muhammad%20Alifa%20Ramdhan%20-%20All%20Roads%20leads%20to%20GKEs%20Host%20%204%2B%20Ways%20to%20Escape.pdf)

---

## A journey of hunting macOS kernel vulnerability[#](#a-journey-of-hunting-macos-kernel-vulnerability)

* **Date:** 21st to 22nd April 2022
* **Author:** Peter NGUY·ªÑN V≈© Ho√†ng
* **Event:** Zer0Con 2022
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/Zer0Con%202022/A%20Journey%20Of%20Hunting%20macOS%20kernel.pptx)

---

## An Introduction to Manual Source Code Review[#](#an-introduction-to-manual-source-code-review)

* **Date:** 6th Apr 2022
* **Author:** POH Jia Hao
* **Event:** NUS GreyHats Security Wednesday
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/NUS%20GreyHats%20SecWed%20Apr%202021/Introduction%20to%20Manual%20Source%20Code%20Review/Introduction%20to%20Manual%20Source%20Code%20Review.pdf)

---

## A case study of an incorrect bitwise and optimization in V8[#](#a-case-study-of-an-incorrect-bitwise-and-optimization-in-v8)

* **Date:** 6th Apr 2022
* **Author:** Lucas TAY
* **Event:** NUS GreyHats Security Wednesday
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/NUS%20GreyHats%20SecWed%20Apr%202021/A%20case%20study%20of%20an%20incorrect%20bitwise%20and%20optimization%20in%20V8/CVE-2021-30599_official.pptx)

---

# 2021[#](#2021)

---

## VM Escape Case Study VirtualBox Bug Hunting and Exploitation[#](#vm-escape-case-study-virtualbox-bug-hunting-and-exploitation)

* **Date:** 4th to 5th December 2021
* **Author:** Muhammad Ramdhan
* **Event:** Indonesia IT Security Conference 2021
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/IDSECCONF%202021/VM%20Escape%20Case%20Study_%20VirtualBox%20Bug%20Hunting%20and%20Exploitation%20%28IDSECCONF%202021%29.pdf)

---

## The Great Escape - A Case Study of VM Escape and EoP Vulnerabilities[#](#the-great-escape---a-case-study-of-vm-escape-and-eop-vulnerabilities)

* **Date:** 26th to 27th November 2021
* **Author:** Billy JHENG Bing-Jhong & Muhammad Ramdhan
* **Event:** HITCON 2021
* **References:** [Presentation](https://github.com/star-sg/Presentations/blob/main/HITCON%202021/The%20Great%20Escape%20-%20A%20Case%20Study%20of%20VM%20Escape%20and%20EoP%20Vulnerabilities%28HITCON%202021%29.pdf)

---

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from access.redhat.com_ef2b004d_20250115_190557.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Fran√ßais](https://access.redhat.com/changeLanguage?language=fr)
* [ÌïúÍµ≠Ïñ¥](https://access.redhat.com/changeLanguage?language=ko)
* [Êó•Êú¨Ë™û](https://access.redhat.com/changeLanguage?language=ja)
* [‰∏≠Êñá (‰∏≠ÂõΩ)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 ¬© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from starlabs.sg_3878c95a_20250115_190601.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/)
# Advisories

Currently published 136 advisories.

[Vulnerability Disclosure Policy](./STAR%20Labs%20SG%20Pte.%20Ltd.%20Vulnerability%20Disclosure%20Policy.pdf)

## (CVE-2024-6781) Calibre Arbitrary File Read

Summary Product Calibre Vendor Calibre Severity High - Unprivileged adversaries may exploit software vulnerabilities to perform relative path traversal to achieve arbitrary file read Affected Versions <= 7.14.0 (latest version as of writing) Tested Versions 7.14.0 CVE Identifier CVE-2024-6781 CVE Description Improper Limitation of a Pathname to a Restricted Directory (‚ÄòPath Traversal‚Äô) vulnerability allows Relative Path Traversal CWE Classification(s) CWE-22 Improper Limitation of a Pathname to a Restricted Directory (‚ÄòPath Traversal‚Äô) CAPEC Classification(s) CAPEC-139 Relative Path Traversal CVSS3....

July 31, 2024¬†¬∑¬†4 min¬†¬∑¬†Amos Ng (@LFlare)

## (CVE-2024-6782) Calibre Remote Code Execution

Summary Product Calibre Vendor Calibre Severity Critical - Unprivileged adversaries may exploit software vulnerabilities to perform remote code execution Affected Versions 6.9.0 ~ 7.14.0 (latest version as of writing) Tested Versions 7.14.0 CVE Identifier CVE-2024-6782 CVE Description Improper Access Control in Calibre Content Server allows remote code execution CWE Classification(s) CWE-863: Incorrect Authorization CAPEC Classification(s) CAPEC-253: Remote Code Inclusion CVSS3....

July 31, 2024¬†¬∑¬†4 min¬†¬∑¬†Amos Ng (@LFlare)

## (CVE-2024-7008) Calibre Reflected Cross-Site Scripting (XSS)

Summary Product Calibre Vendor Calibre Severity Medium Affected Versions <= 7.15.0 (latest version as of writing) Tested Versions 7.15.0 CVE Identifier CVE-2024-7008 CWE Classification(s) CWE-79 Improper Neutralization of Input During Web Page Generation (XSS or ‚ÄòCross-site Scripting‚Äô) CAPEC Classification(s) CAPEC-591 Reflected XSS CVSS3.1 Scoring System Base Score: 5.4 (Medium) Vector String: CVSS:3....

July 31, 2024¬†¬∑¬†3 min¬†¬∑¬†Devesh Logendran

## (CVE-2024-7009) Calibre SQLite Injection

Summary Product Calibre Vendor Calibre Severity Medium Affected Versions <= 7.15.0 (latest version as of writing) Tested Versions 7.15.0 CVE Identifier CVE-2024-7009 CWE Classification(s) CWE-89 Improper Neutralization of Special Elements used in an SQL Command (‚ÄòSQL Injection‚Äô) CAPEC Classification(s) CAPEC-66 SQL Injection CVSS3.1 Scoring System Base Score: 4.2 (Medium) Vector String: CVSS:3....

July 31, 2024¬†¬∑¬†5 min¬†¬∑¬†Devesh Logendran

## (CVE-2024-1837) Singtel RT5703W Unauthenticated Command Injection RCE via Login Vulnerability

Summary Product Singtel WI-FI 6 ROUTER RT5703W Vendor Singtel/Askey Severity Critical - Adversaries may exploit software vulnerabilities to execute arbitrary commands on the underlying OS with root privileges. Affected Versions V1.6.4-5194 (latest version as of writing) Tested Versions V1.6.4-5194 (latest version as of writing) Internal Identifier STAR-2023-0097 CVE Identifier TBD CVE Description OS command injection vulnerability in net....

July 22, 2024¬†¬∑¬†5 min¬†¬∑¬†Daniel Lim Wee Soong (@daniellimws)

## (CVE-2024-1838) Singtel RT5703W Authenticated Command Injection RCE via SetLoginPwd Vulnerability

Summary Product Singtel WI-FI 6 ROUTER RT5703W Vendor Singtel/Askey Severity High - Adversaries may exploit software vulnerabilities to execute arbitrary commands on the underlying OS with root privileges. Affected Versions V1.6.4-5194 (latest version as of writing) Tested Versions V1.6.4-5194 (latest version as of writing) Internal Identifier STAR-2023-0098 CVE Identifier TBD CVE Description OS command injection vulnerability in net....

July 22, 2024¬†¬∑¬†5 min¬†¬∑¬†Daniel Lim Wee Soong (@daniellimws)

## (CVE-2023-3368) Chamilo LMS Unauthenticated Command Injection

Summary Product Chamilo Vendor Chamilo Severity High - Adversaries may exploit software vulnerabilities to obtain unauthenticated remote code execution. Affected Versions <= v1.11.20 Tested Versions v1.11.20 (latest version as of writing) CVE Identifier CVE-2023-3368 CVE Description Command injection in /main/webservices/additional\_webservices.php in Chamilo LMS <= v1.11.20 allows unauthenticated attackers to obtain remote code execution via improper neutralisation of special characters....

November 28, 2023¬†¬∑¬†5 min¬†¬∑¬†Ngo Wei Lin (@Creastery)

[Next ¬ª](https://starlabs.sg/advisories/page/2/)

¬© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)


