=== Content from gitlab.com_035b0d47_20250114_222305.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-0549.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-0549.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-0549.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-0549.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 12, 2022

  [2ea1a3a4](/gitlab-org/cves/-/commit/2ea1a3a472a52ffbff9c40099ec79c4e6d7581bf)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2ea1a3a472a52ffbff9c40099ec79c4e6d7581bf)
  ·
  2ea1a3a4

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

  2ea1a3a4

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2ea1a3a472a52ffbff9c40099ec79c4e6d7581bf)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

Loading



=== Content from gitlab.com_59dfb6f3_20250114_222306.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Users can be added to group via API but not UI with LDAP group sync enabled

Found in [Federal ticket 1420](https://gitlab-federal-support.zendesk.com/agent/tickets/1420)

When LDAP group sync is enabled and a GitLab group has an LDAP group link, then individual users cannot be manually added to the group via the UI.

However, using [this API call to add a member to a group](https://docs.gitlab.com/ee/api/members.html#add-a-member-to-a-group-or-project), a non-LDAP user *can* be added to the group. Here, I added `@user_1`, who has `id: 32`, to the group:

```
curl --request POST --header "PRIVATE-TOKEN: <token>" \
>      --data "user_id=32&access_level=30" "https://gitlab.local/api/v4/groups/61/members"
{"id":32,"name":"User One","username":"user_1","state":"active","avatar_url":"https://secure.gravatar.com/avatar/be72a6287c41316db75b7bc8020024c8?s=80\u0026d=identicon","web_url":"https://gitlab.local/user_1","access_level":30,"created_at":"2021-10-05T19:33:52.934Z","expires_at":null
```

This can be confirmed in the UI, too.

[![Screen_Shot_2021-10-05_at_4.18.27_PM](data:image/gif;base64...)](/-/project/278964/uploads/7ec5960333196383e01657bf4c5bf928/Screen_Shot_2021-10-05_at_4.18.27_PM.png)

Afterwards, trying to remove the user from the group using the API yields:

```
curl --request DELETE --header "PRIVATE-TOKEN: <token>" "https://gitlab.local/api/v4/groups/61/members/32"
{"message":"403 Forbidden"}
```

There also seems to be no way to remove this user from the group now.

This was reproduced in GitLab 14.3.

I've marked this issue as Confidential because of the security implications.

### Proposal:

Looks like a missing authorization check on the REST API. Might be worth checking and addressing if there is a corresponding GraphQL endpoint like this as well that is also vulnerable?

We might also have to see why DELETE action is not permitted? It is good that it is not permitted but is that due to having the authorization check in place or due to some other bug?

Edited Mar 29, 2022 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


