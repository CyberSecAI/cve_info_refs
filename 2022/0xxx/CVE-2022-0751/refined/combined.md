=== Content from gitlab.com_c1542520_20250115_080205.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-0751.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-0751.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-0751.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-0751.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 12, 2022

  [6ec49f36](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  ·
  6ec49f36

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

  6ec49f36

  [Publishing 2 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/6ec49f368c913b9678991c386cc85bc0dba08a54)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 12, 2022

Loading



=== Content from gitlab.com_a3399c03_20250115_080206.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# The inaccurate information displayed through the Gitlab.com web interface, allows the execution of arbitrary commands by the victim

See existing examples of reproducing for snippet, repo, and wiki below: [#349382 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/349382#examples-of-reproducing-on-snippet-repo-and-wiki "The inaccurate information displayed through the Gitlab.com web interface, allows the execution of arbitrary commands by the victim")

**[HackerOne report #1420660](https://hackerone.com/reports/1420660)** by `st4nly0n` on 2021-12-08, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

# Summary

The inaccurate information displayed through the Gitlab.com web interface, causes a victim to execute arbitrary system commands that in principle do not represent a security risk.

A non-printable **ASCII** character in the file name of a snippet, will make such files not be displayed in the web interface of [Gitlab.com](https://gitlab.com/), in this context integrity is the guarantee that the information presented through the web interface of [Gitlab.com](https://gitlab.com/) is reliable and accurate.

The non-printable **ASCII** character in the file name can be created using *(on Linux)* the following command:

```
touch $'\x90'
###  OR
touch `echo -e '\x90'`
```

Let's see the following image:

[![flow.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b1c026a5504cdcc5d00ccfb623c82f3b0b66fbf8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61333239653237382d333637652d343962312d393365662d3861376438653865656430322f666c6f772e706e67)

The image above shows a snippet containing two files `hello_world.sh` and `instructions.txt`, the file `instructions.txt` contains a command that will do the following:

* clone the current snippet.
* you will enter the cloned repository.
* it will execute the file `hello_world.sh` which all it does is display the text `Hello World` through the standard output.

This is totally valid, that is to say, theoretically if you create those two files and execute the above commands you will get the text `Hello World` through the standard output.

However, through the same steps, an attacker would cause you to execute an arbitrary system command, since the `hello_world.sh` file is a symbolic link to the `\x90echo "Hello World"` file that contains a command arbitrary system.

# Steps to reproduce

**[PREPARATION/ATTACKER]**

**1.** Go to <https://gitlab.com/-/snippets/new>

**2.** Create a private snippet with any file.

**3.** Clone the snippet via the `git clone` command.

**4.** Go to the directory where you have cloned the snippet.

**5.** Delete the file created in step 2.

**6.** Make a note of the **ID** of the snippet.

**7.** Create the `instructions.txt` file with the commands to clone and run the `hello_world.sh` file.

```
###  Replace <SNIPPET ID> with the id of the snippet copied in step 6
echo 'git clone https://gitlab.com/snippets/<SNIPPET ID>.git && cd <SNIPPET ID> && sh hello_world.sh' > instructions.txt
```

**8.** Create the file named `\x90echo "Hello World"` which contains a system command.

```
echo 'cat /etc/passwd' > $'\x90echo "Hello World"'
```

**9.** Create a symbolic link to the previously created file, name this symbolic link `hello_world.sh`

```
ln -s $'\x90echo "Hello World"' hello_world.sh
```

**10.** Push the changes to the remote.

```
git add .
git commit
git push origin HEAD -f
```

As a result of this behavior, executing the commands in the `instructions.txt` file will not display the text `Hello World`, but instead will display the content of the `/etc/passwd` command that you added in **step 8**.

# What is the current *bug* behavior?

A non-printable **ASCII** character in the file name of a snippet will prevent such files from being displayed on the [Gitlab.com](https://gitlab.com/) web interface, as a result of this behavior an attacker could make the victim execute arbitrary system commands.

# What is the expected *correct* behavior?

The names of the files that contain non-printable characters should be able to display their content through the [Gitlab.com](https://gitlab.com/) web interface, this is to ensure that the information presented to the user is reliable and accurate.

# Relevant logs and/or screenshots

The following videos show how the victim executed arbitrary system commands by following instructions in a snippet that did not initially appear to represent a security risk.

**Poc in Linux**

[poc\_Linux.mp4](https://user-content.gitlab-static.net/126025e22d257fea41d856af48fc93245e249b14/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34666666646463322d633566632d346637662d393830652d6362616231346564633530622f706f635f4c696e75782e6d7034 "Download 'poc_Linux.mp4'")

**Poc in WSL Windows**

[poc\_WSL\_windows.mp4](https://user-content.gitlab-static.net/8aca8103458e6067aed5e2401284e030a1aa6b14/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66336335383630362d383734382d346233312d613531652d6237353264633133626538642f706f635f57534c5f77696e646f77732e6d7034 "Download 'poc_WSL_windows.mp4'")

# Output of checks

This bug happens on GitLab.com

#### Impact

A victim could execute arbitrary system commands through an attacker-created snippet, as the information presented through the [Gitlab.com](https://gitlab.com/) web interface is not accurate when displaying the files from a snippet.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [flow.png](https://h1.sec.gitlab.net/a/a329e278-367e-49b1-93ef-8a7d8e8eed02/flow.png)
* [poc\_Linux.mp4](https://h1.sec.gitlab.net/a/4fffddc2-c5fc-4f7f-980e-cbab14edc50b/poc_Linux.mp4)
* [poc\_WSL\_windows.mp4](https://h1.sec.gitlab.net/a/f3c58606-8748-4b31-a51e-b752dc13be8d/poc_WSL_windows.mp4)

## Examples of reproducing on snippet, repo, and wiki

**Note that this cannot be reproduced on macOS (it does not allow a filename with the special character)**

I ([@cwoolley-gitlab](/cwoolley-gitlab "Chad Woolley")) have reproduced this. This exploit applies to anything backed by a clonable repo, including snippets, wiki, and repos. See more details in comments.

Here are examples of the same exploit pushed to snippets, repo, and wiki:

1. snippets: [cwoolley-gitlab/snippet-test-project$2231765](https://gitlab.com/cwoolley-gitlab/snippet-test-project/-/snippets/2231765 "test.txt")
2. repo: <https://gitlab.com/cwoolley-gitlab/snippet-test-project/-/tree/master>
3. wiki: <https://gitlab.com/cwoolley-gitlab/snippet-test-project/-/wikis/home> (unable to view, causes a 500 error when attempting to render page).

You can see that:

1. Snippets will still render the instructions with the special-char file hidden, and not indicate any errors or problems. This is arguably the most misleading attack vector.
2. Repos will render the special file, but it isn't clickable. It also fails to render the metadata and shows the loading state. This is arguably less severe because you can see the special char file, and it's obvious from the broken loading state that "somethings wrong". But you still can't see the contents on the web UI to tell that it's got exploit code in it.
3. The whole wiki starts failing with a 500 once you push the hidden file. So, this is arguably not an exploit (any more than any other possibly malicious git repo) or "misleading" at all.

Edited Jan 10, 2022 by [Chad Woolley](/cwoolley-gitlab)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


