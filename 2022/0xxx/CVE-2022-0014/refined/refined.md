- **Root cause of vulnerability:** An untrusted search path vulnerability exists in the Palo Alto Networks Cortex XDR agent.
- **Weaknesses/vulnerabilities present:** The vulnerability is a result of the Cortex XDR agent not properly validating the search path, which allows a local attacker with file creation privileges in the Windows root directory to place a malicious executable that can be unintentionally executed by another local user during a Live Terminal session. This is an example of an untrusted search path vulnerability, specifically CWE-426.
- **Impact of exploitation:** Successful exploitation allows an attacker to achieve arbitrary code execution with the privileges of the user who initiates a Live Terminal session, potentially leading to confidentiality, integrity, and availability impacts.
- **Attack vectors:** Local attacker with file creation privilege in the Windows root directory.
- **Required attacker capabilities/position:** The attacker must have the ability to create files in the Windows root directory, and they must also have a separate local user utilize the Live Terminal feature, which would inadvertently execute the attacker's malicious program. The attacker requires low privileges and user interaction.