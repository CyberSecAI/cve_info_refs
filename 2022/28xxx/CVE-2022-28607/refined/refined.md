The provided content describes multiple vulnerabilities in the isic.lk tour booking website that, when chained, lead to Remote Code Execution (RCE).

**Vulnerabilities:**

1.  **Information Disclosure:**
    *   **Root Cause:** The application discloses sensitive information, specifically an admin username, via the `/system/user/modules/mod_users/controller.php` endpoint when the `action=view` POST parameter is used.
    *   **Weakness:** Information leakage.
    *   **Impact:**  Allows an attacker to gain knowledge of the admin username.
    *   **Attack Vector:** Sending a POST request to the vulnerable endpoint with the `action=view` parameter.
2.  **SQL Injection:**
    *   **Root Cause:** The login functionality is vulnerable to SQL injection. Specifically, the `selectByUsername` function in `/system/user/modules/mod_users/helper.php` does not properly sanitize user input.
    *   **Weakness:** SQL injection vulnerability in the `username` parameter of the login form.
    *   **Impact:** Allows an attacker to bypass authentication by injecting SQL code into the username field. Specifically, they can use a UNION SELECT statement to overwrite the password hash used for comparison.
    *    **Attack Vector:** Sending a POST request to `/system/user/modules/mod_users/controller.php` with `action=doLogin`, a malicious username with injected SQL, and a valid password. The password is not validated in the injected SQL query, and the query will overwrite the password hash used in the application.

    ```sql
    username=admin' union select 1,2,3,4,5,6,'0192023a7bbd73250516f069df18b500',8,9 limit 1,1#&password=admin123
    ```
3.  **Unrestricted File Upload:**
    *   **Root Cause:** The application allows arbitrary file uploads via the `/system/application/libs/js/tinymce/plugins/filemanager/upload.php` endpoint. It requires a prior GET request to `/system/application/libs/js/tinymce/plugins/filemanager/dialog.php?type=0&editor=mce_0&field_id=selected_file`.
    *   **Weakness:** Unrestricted file upload allows an attacker to upload a malicious file, such as a PHP webshell.
    *   **Impact:** By uploading a webshell, an attacker gains the ability to execute arbitrary code on the server.
    *   **Attack Vector:** Sending a POST request with the webshell to `/system/application/libs/js/tinymce/plugins/filemanager/upload.php` after making a GET request to the specified dialog.php endpoint.

**Chained Exploitation:**

The attacker chains these vulnerabilities as follows:

1.  **Information Leakage:** The attacker first exploits the information disclosure vulnerability to obtain the admin username.
2.  **SQL Injection:**  The attacker then uses the obtained admin username and the SQL injection vulnerability to bypass authentication.
3. **File Upload:** Once authenticated, the attacker uploads a webshell via the file upload vulnerability, achieving RCE.

**Required Attacker Capabilities:**

*   The attacker needs to be able to send HTTP requests to the target web server.
*   The attacker does not need any special privileges or pre-existing access besides being able to interact with the publicly accessible website.

The provided content goes into more detail than the typical CVE description, including specific vulnerable paths, request parameters, and code snippets.