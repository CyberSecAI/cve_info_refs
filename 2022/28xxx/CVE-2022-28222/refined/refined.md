- **Root cause of vulnerability:** Improper sanitization of the `$_REQUEST['page']` parameter when generating links in the plugin's spam comment and user list tables. The plugin's functions `column_ct_comment` and `column_ct_username` in `/lib/Cleantalk/ApbctWP/FindSpam/ListTable/Comments.php` and `/lib/Cleantalk/ApbctWP/FindSpam/ListTable/Users.php` respectively use the value of the `$_REQUEST['page']` parameter directly in the generated links.
- **Weaknesses/vulnerabilities present:** Reflected Cross-Site Scripting (XSS).
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the browser of a logged-in administrator by tricking them into visiting a crafted URL containing malicious JavaScript code in the `page` parameter. This can lead to site takeover, adding a malicious administrator, or injecting backdoors.
- **Attack vectors:** The vulnerability can be exploited by crafting a URL that includes malicious JavaScript code in the `page` parameter, which is then reflected in the generated links by the plugin. Attackers could use social engineering tactics such as tricking a site admin into visiting a self-submitting form that sends a POST request with a malicious payload.
- **Required attacker capabilities/position:** The attacker needs to be able to trick a logged-in administrator into visiting the crafted URL. This can be done through social engineering or other means of delivering the malicious link.