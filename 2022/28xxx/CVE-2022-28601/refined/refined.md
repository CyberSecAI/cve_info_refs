- **Root cause of vulnerability:** The vulnerability lies in the "Simple 2FA Plugin for Moodle" where an attacker can overwrite the phone number associated with a user account.
- **Weaknesses/vulnerabilities present:** The plugin allows unauthenticated access to the `/auth/simple2fa/profile.php` endpoint, where users are supposed to update their phone number, after they successfully authenticated using username and password. By accessing this URL before submitting the 2FA code, an attacker can change the registered phone number for the account.
- **Impact of exploitation:** By exploiting this vulnerability, an attacker can bypass the 2FA mechanism, gain access to the user's account, and potentially access sensitive information or perform malicious actions.
- **Attack vectors:** The attack vector is force browsing to the `/auth/simple2fa/profile.php` URL after the initial login with username/password and before entering the 2FA code. The attacker then submits a POST request with a new phone number.
- **Required attacker capabilities/position:** The attacker needs to know the username and password of the targeted user and needs to be able to send crafted HTTP requests. They do not require any special network access and are able to perform the attack remotely.