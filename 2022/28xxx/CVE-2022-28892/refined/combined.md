=== Content from mahara.org_457eaef5_20250114_194321.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4165)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4165)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Strengthen the random generated tokens in Mahara before 20.10.5, 21.04.4, and 21.10.2

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Robert Lyon's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=313288)
[Robert Lyon](https://mahara.org/user/robertlyon-1)

Posts: 778

27 April 2022, 13:20

Related to [CVE 2021-29349](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-29349) but is specifically looking at the random token generator

Vulnerability type: CSRF
Attack type: Physical
Impact: Information disclosure, other

Affected components: Non-cryptographically random generated tokens are too easily guessable. They should be rendered in a cryptographical way. The current function to generate random keys is not random enough.

Suggested description: Mahara before 20.10.5, 21.04.4, 21.10.2, and 22.04.0 is vulnerable to Cross Site Request Forgery (CSRF) because randomly generated tokens are too easily guessable.

Reported by: Catalyst IT
[Bug report](https://bugs.launchpad.net/mahara/%2Bbug/1930171)
CVE reference: [CVE-2022-28892](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28892)

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  27 April 2022, 18:51

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4165)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_440005e7_20250114_194320.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1930171/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Strengthen the non-cryptographically random generated tokens

Bug #1930171 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2021-05-30

[254](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | Unassigned | [Mahara 21.10.1](https://launchpad.net/mahara/%2Bmilestone/21.10.1) |
|  | [20.10](https://bugs.launchpad.net/mahara/20.10) | Fix Released | High | Unassigned | [Mahara 20.10.5](https://launchpad.net/mahara/%2Bmilestone/20.10.5) |
|  | [21.04](https://bugs.launchpad.net/mahara/21.04) | Fix Released | High | Unassigned | [Mahara 21.04.4](https://launchpad.net/mahara/%2Bmilestone/21.04.4) |
|  | [21.10](https://bugs.launchpad.net/mahara/21.10) | Fix Released | High | Unassigned | [Mahara 21.10.2](https://launchpad.net/mahara/%2Bmilestone/21.10.2) |
|  | [22.04](https://bugs.launchpad.net/mahara/22.04) | Fix Released | High | Unassigned | [Mahara 22.04.0](https://launchpad.net/mahara/%2Bmilestone/22.04.0) |

### Bug Description

In Mahara we have a CSRF token called 'sesskey' which is generated in an old style guessable way.

We need to update this to do the following:

1) Make the token more random using by using random\_int() - That generates cryptographically secure pseudo-random integers

2) Rename the 'sesskey' to avoid confusion between this token and actual session key - need to change it to be some more obscure / generic name

3) Look at making the CSRF token be in the custom headers space rather than as a form field - to avoid having it exposed in GET urls etc

4) Make sure all the places we use get\_random\_key() are changed to the more secure way

## CVE References

* [2022-28892](/bugs/cve/2022-28892 "Mahara before 20.10.5, 21.04.4, 21.10...")

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2021-10-27

| **no longer affects**: | mahara/20.04 |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2022-04-07 (last edit on 2022-04-12): |  |  | [#3](/mahara/%2Bbug/1930171/comments/3) |
| --- | --- | --- | --- |

Related to <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-29349> but is specifically looking at the random token generator

Vulnerability type: CSRF

Attack type: Physical?

Impact: Information disclosure, other

Affected components: Non-cryptographically random generated tokens are too easily guessable. They should be rendered in a cryptographical way. The current function to generate random keys is not random enough.

Suggested description: Mahara before 20.10.5, 21.04.4, 21.10.2, and 22.04.0 is vulnerable to Cross Site Request Forgery (CSRF) because randomly generated tokens are too easily guessable.

Reported by: Catalyst IT

Bug report: [https://bugs.launchpad.net/mahara/+bug/1930171](https://bugs.launchpad.net/mahara/%2Bbug/1930171)

CVE reference: CVE-2022-28892 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28892>

Related to https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-29349 but is specifically looking at the random token generator
Vulnerability type: CSRF
Attack type: Physical?
Impact: Information disclosure, other
Affected components: Non-cryptographically random generated tokens are too easily guessable. They should be rendered in a cryptographical way. The current function to generate random keys is not random enough.
Suggested description: Mahara before 20.10.5, 21.04.4, 21.10.2, and 22.04.0 is vulnerable to Cross Site Request Forgery (CSRF) because randomly generated tokens are too easily guessable.
Reported by: Catalyst IT
Bug report: https://bugs.launchpad.net/mahara/+bug/1930171
CVE reference: CVE-2022-28892 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28892

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2022-04-11: |  |  | [#4](/mahara/%2Bbug/1930171/comments/4) |
| --- | --- | --- | --- |

[https://reviews.mahara.org/c/mahara/+/12117](https://reviews.mahara.org/c/mahara/%2B/12117)

https://reviews.mahara.org/c/mahara/+/12117

| **summary**: | - Strengthen the CSRF key to make it unguessable+ Strengthen the non-cryptographically random generated tokens |
| --- | --- |

[Gold (gold.catalyst)](https://launchpad.net/~gold.catalyst)
on 2022-04-26

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2022-04-26:  [**A change has been merged**](/mahara/%2Bbug/1930171/comments/5) |  |  | [#5](/mahara/%2Bbug/1930171/comments/5) |
| --- | --- | --- | --- |

Reviewed: [https://reviews.mahara.org/c/mahara/+/12688](https://reviews.mahara.org/c/mahara/%2B/12688)

Committed: <https://git.mahara.org/mahara/mahara/commit/11be0ecdbfa2dadcc3f2861006a840c0774a07ec>

Submitter: "Doris Tam <email address hidden>"

Branch: 21.10\_DEV

commit 11be0ecdbfa2dadcc3f2861006a840c0774a07ec

Author: Robert Lyon <email address hidden>

Date: Fri Jun 4 14:50:22 2021 +1200

Security [bug 1930171](/bugs/1930171): Strengthen the random token generator

Make it generate a cryptographically random token and make sure it's

at least 8 chars long at minimum

Change-Id: I45b621846b1c9ed3221edfb8ebf1ee3635dc9161

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 61b607d03dd1eae87eb91573a855bf801085e363)

Reviewed: https://reviews.mahara.org/c/mahara/+/12688
Committed: https://git.mahara.org/mahara/mahara/commit/11be0ecdbfa2dadcc3f2861006a840c0774a07ec
Submitter: "Doris Tam <doristam@catalyst.net.nz>"
Branch: 21.10\_DEV
commit 11be0ecdbfa2dadcc3f2861006a840c0774a07ec
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Fri Jun 4 14:50:22 2021 +1200
Security bug 1930171: Strengthen the random token generator
Make it generate a cryptographically random token and make sure it's
at least 8 chars long at minimum
Change-Id: I45b621846b1c9ed3221edfb8ebf1ee3635dc9161
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 61b607d03dd1eae87eb91573a855bf801085e363)

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1930171/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1930171/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1930171/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1930171/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


