```
Advisory ID: SYSS-2022-045, SYSS-2022-011, SYSS-2022-016, SYSS-2022-003, SYSS-2022-007
Product: Verbatim Store 'n' Go Secure Portable SSD, Executive Fingerprint Secure SSD, Fingerprint Secure Portable Hard Drive, Keypad Secure USB 3.2 Gen 1 Drive, Store 'n' Go Secure Portable HDD
Manufacturer: Verbatim
Affected Version(s): #53402 (GDMSLK02 C-INIC3637-V1.1), GDMSFE01-INI3637-C VER1.1, #53650, Part Number #49428, GD25LK01-3637-C VER4.0
Tested Version(s): #53402 (GDMSLK02 C-INIC3637-V1.1), GDMSFE01-INI3637-C VER1.1, #53650, Part Number #49428, GD25LK01-3637-C VER4.0
Vulnerability Type: Missing Immutable Root of Trust in Hardware (CWE-1326)
Risk Level: Medium
Solution Status: Fixed (for SYSS-2022-045), Open (for all other advisories)
CVE Reference: CVE-2022-28383
Author of Advisory: Matthias Deeg (SySS GmbH)

Overview:
The affected Verbatim products are portable USB drives with AES 256-bit hardware encryption. Some models include a built-in keypad for passcode entry, while others feature a fingerprint sensor for unlocking the device. The drives do not store passwords in the computer's volatile memory, which is intended to make them more secure than software encryption.

Vulnerability Details:
The firmware validation for the USB-to-SATA bridge controller INIC-3637EN only consists of a simple CRC-16 check (XMODEM CRC-16). An attacker can store malicious firmware code for the INIC-3637EN with a valid checksum on the SPI flash memory chip (XT25F01D or XT25F01B). The malicious firmware is then executed by the USB-to-SATA bridge controller. This can be exploited in a supply chain attack where an attacker with temporary physical access can modify the firmware to use an attacker-controlled AES key for data encryption. If the attacker later gains access to the drive, they can decrypt the user data.

Proof of Concept (PoC):
SySS was able to read and write the SPI flash memory (128 KB) using a universal programmer. The INIC-3637EN firmware is stored from file offset 0x4000 to 0x1BFFB, with the CRC-16 checksum at offset 0x1FFFC. A Python tool was developed to update the checksum of modified firmware images before writing them to the SPI flash memory.

Impact of Exploitation:
An attacker with physical access can replace the legitimate firmware with a malicious version that uses an attacker-controlled AES key. This allows the attacker to decrypt all data on the drive if they later gain access to it.

Attack vectors:
- Supply chain attack: An attacker with temporary physical access during the supply chain can reprogram the device.
- Physical access: An attacker with physical access to the device can reprogram the firmware.

Required attacker capabilities/position:
- Physical access to the device during the supply chain or otherwise.
- Ability to read and write to the SPI flash memory of the device.
- Knowledge of the location of the firmware and checksum within the flash memory.
```