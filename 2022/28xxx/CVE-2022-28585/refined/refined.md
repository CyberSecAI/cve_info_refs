- **Root cause of vulnerability**: The `$add` variable, passed to the `AddAdClass` function in `e\admin\tool\AdClass.php` at line 30, is directly inserted into an SQL query without proper sanitization.
- **Weaknesses/vulnerabilities present**: SQL Injection.
- **Impact of exploitation**: An attacker can execute arbitrary SQL queries, potentially leading to data exfiltration, modification, or deletion, and in some cases, gaining control of the underlying database server. In the provided example, the attacker was able to extract the database version number using the `updatexml` function.
- **Attack vectors**: By manipulating the `add[classname]` parameter of the request sent when adding an advertisement category.
- **Required attacker capabilities/position**: The attacker needs to be able to access the admin panel and have the ability to add advertisement categories and intercept the request to modify it.