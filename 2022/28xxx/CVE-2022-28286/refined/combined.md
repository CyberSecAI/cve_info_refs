=== Content from bugzilla.mozilla.org_f0ed3f1e_20250114_185206.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1735265)
* [XML](/show_bug.cgi?ctype=xml&id=1735265)

Closed
[Bug 1735265](/show_bug.cgi?id=1735265)
(CVE-2022-28286)

Opened 3 years ago
Closed 3 years ago

# Firefox incorrectly draws outside of iframe.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox incorrectly draws outside of iframe.

## Categories

### (Core :: Web Painting, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Web%20Painting#Web%20Painting)

Web Painting
▾

Core :: Web Painting
Construction of display lists, hit-testing, building of Layers and painting.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Web%20Painting&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Web%20Painting&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Web%20Painting)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 93

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

100 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox-esr91 | [99+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=99%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox93 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix) |
| firefox94 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix) |
| firefox95 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=wontfix) |
| firefox96 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix) |
| firefox97 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix) |
| firefox98 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix) |
| firefox99 | [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified) |
| firefox100 | [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr91 | 99+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox93 |  | wontfix |
| firefox94 |  | wontfix |
| firefox95 |  | wontfix |
| firefox96 |  | wontfix |
| firefox97 |  | wontfix |
| firefox98 |  | wontfix |
| firefox99 | + | verified |
| firefox100 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: prada960808, Assigned: mikokm)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f8c6852c1b354ed13d839ce75732f16a?d=mm&size=40)  [mikokm](/user_profile?user_id=547538)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6c14889b985cb94176e66a3ce2a8adbd?d=mm&size=40)  [prada960808](/user_profile?user_id=665039)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0646a42110a02dd585f200f270716852?d=mm&size=40)  [tnikkel](/user_profile?user_id=255010)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1409114](/show_bug.cgi?id=1409114 "RESOLVED FIXED - Figure out a better way to create display items for column backgrounds")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1760823](/show_bug.cgi?id=1760823 "NEW - Transformed mask-image is clipped incorrectly in table cell"), [CVE-2022-45420](/show_bug.cgi?id=1792643 "VERIFIED FIXED - iframe contents can be arbitrarily drawn outside of iframe.")

## Details

### (4 keywords, Whiteboard: [adv-main99+][adv-esr91.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-28286

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main99+][adv-esr91.8+]

QA Whiteboard:

---

Has STR:

yes

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

1

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a15173175_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c33 "3 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (9 files, 2 obsolete files)

| [parent.html](/attachment.cgi?id=9245388)  [3 years ago](#c0)  [prada960808](/user_profile?user_id=665039)   254 bytes, text/html |  | [Details](/attachment.cgi?id=9245388&action=edit) |
| --- | --- | --- |
| [child.html](/attachment.cgi?id=9245389)  [3 years ago](#c1)  [prada960808](/user_profile?user_id=665039)   701 bytes, text/html |  | [Details](/attachment.cgi?id=9245389&action=edit) |
| [ref\_image.png](/attachment.cgi?id=9245390)  [3 years ago](#c2)  [prada960808](/user_profile?user_id=665039)   26.88 KB, image/png |  | [Details](/attachment.cgi?id=9245390&action=edit) |
| [test.html](/attachment.cgi?id=9245396)  [3 years ago](#c3)  [Alice0775 White](/user_profile?user_id=293623)   343 bytes, text/html |  | [Details](/attachment.cgi?id=9245396&action=edit) |
| [parent.html](/attachment.cgi?id=9246922)  [3 years ago](#c8)  [Miko Mynttinen](/user_profile?user_id=547538)   154 bytes, text/html |  | [Details](/attachment.cgi?id=9246922&action=edit) |
| [child.html](/attachment.cgi?id=9246923)  [3 years ago](#c9)  [Miko Mynttinen](/user_profile?user_id=547538)   426 bytes, text/html |  | [Details](/attachment.cgi?id=9246923&action=edit) |
| [dl.txt](/attachment.cgi?id=9247873)  [3 years ago](#c12)  [Miko Mynttinen](/user_profile?user_id=547538)   5.94 KB, text/plain |  | [Details](/attachment.cgi?id=9247873&action=edit) |
| [Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange](/attachment.cgi?id=9248040)  [3 years ago](#c13)  [Miko Mynttinen](/user_profile?user_id=547538)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c30 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c37 "3 years ago") | [Details](/attachment.cgi?id=9248040&action=edit) | [Review](/attachment.cgi?id=9248040) |
| [Bug 1735265 - Part 2: Add test r=mstange](/attachment.cgi?id=9248041)  [3 years ago](#c14)  [Miko Mynttinen](/user_profile?user_id=547538)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c31 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#a14231906_75935 "3 years ago") | [Details](/attachment.cgi?id=9248041&action=edit) | [Review](/attachment.cgi?id=9248041) |
| [poc.html](/attachment.cgi?id=9249144)  [3 years ago](#c19)  [prada960808](/user_profile?user_id=665039)   621 bytes, text/html |  | [Details](/attachment.cgi?id=9249144&action=edit) |
| [advisory.txt](/attachment.cgi?id=9269928)  [3 years ago](#c39)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   215 bytes, text/plain |  | [Details](/attachment.cgi?id=9269928&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1735265#c0)• 3 years ago |
|  | |

Attached file
[parent.html](attachment.cgi?id=9245388) (obsolete)
— [Details](attachment.cgi?id=9245388&action=edit)

User Agent: Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36

Steps to reproduce:

1. open 'parent.html' on Firefox 93.
2. load 'child.html' by executing Js code

   set\_frame('./child.html');

Actual results:

The content in iframe is drawn outside of iframe even if 'child.html' is loaded from a local server.

Expected results:

The content in iframe should not be drawn outside of iframe.

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1735265#c1)• 3 years ago |
|  | |

Attached file
[child.html](attachment.cgi?id=9245389) (obsolete)
— [Details](attachment.cgi?id=9245389&action=edit)

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1735265#c2)• 3 years ago |
|  | |

Attached image
[ref\_image.png](attachment.cgi?id=9245390)
— [Details](attachment.cgi?id=9245390&action=edit)

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1735265#c3)• 3 years ago |
|  | |

Attached file
[test.html](attachment.cgi?id=9245396)
— [Details](attachment.cgi?id=9245396&action=edit)

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1735265#c4)• 3 years ago |
|  | |

I can reproduce the issue in Nightly95.0a1 Windows10.

Regression window:

<https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=45f6157a879ec5e6435a068bb7825169bd01c9a9&tochange=ceaebebccb5e67929ed7ba66d60954a9f218dc26>

Status: UNCONFIRMED → NEWHas Regression Range: --- → yesHas STR: --- → yes
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected)
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Component: Untriaged → LayoutEver confirmed: trueKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Product: Firefox → CoreRegressed by: [1691875](/show_bug.cgi?id=1691875 "RESOLVED FIXED - Refactor the code that creates inner table's ReflowInput and compute its size")

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1735265#c5)• 3 years ago |
|  | |

A layout change caused this but this is a graphics/displaylist issue afaict. Miko, any chance you could take a look?

Component: Layout → Web PaintingFlags: needinfo?(mikokm)

|  | [Jan Honza Odvarko [:Honza] (always need-info? me)](/user_profile?user_id=303767) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a43373_303767)• 3 years ago |

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix)

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1735265#c6)• 3 years ago |
|  | |

Is this a security issue?

It seems this can cover the content of the main frame from the iframe so that the user cannot see the website properly.

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a604438_690067)• 3 years ago |

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1735265#c7)• 3 years ago |
|  | |

Looking into this.

Assignee: nobody → mikokmStatus: NEW → ASSIGNEDFlags: needinfo?(mikokm)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1735265#c8)• 3 years ago |
|  | |

Attached file
[parent.html](attachment.cgi?id=9246922)
— [Details](attachment.cgi?id=9246922&action=edit)

[Attachment #9245388](/attachment.cgi?id=9245388&action=edit "parent.html") -
Attachment is obsolete: true
[Attachment #9245389](/attachment.cgi?id=9245389&action=edit "child.html") -
Attachment is obsolete: true

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1735265#c9)• 3 years ago |
|  | |

Attached file
[child.html](attachment.cgi?id=9246923)
— [Details](attachment.cgi?id=9246923&action=edit)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1735265#c10)• 3 years ago |
|  | |

Attached simplified testcases.

It seems that <colgroup> creates a table width sized background item that extends beyond the body bounds when the overflow is hidden. This seems to only happen when the corresponding <th> element has a stacking context or layer inducing style such as filter or will-change: transform (but surprisingly opacity does not work).

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1735265#c11)• 3 years ago |
|  | |

The severity field is not set for this bug.

:mattwoodrow, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(matt.woodrow)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a1268162_547538)• 3 years ago |

Severity: -- → S2Flags: needinfo?(matt.woodrow)Priority: -- → P3

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1735265#c12)• 3 years ago |
|  | |

Attached file
[dl.txt](attachment.cgi?id=9247873)
— [Details](attachment.cgi?id=9247873&action=edit)

Display list dump.

It seems that TableBackgroundColor item ends up outside of the transform item, despite having will-change: transform set.

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1735265#c13)• 3 years ago |
|  | |

Attached file
[Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange](attachment.cgi?id=9248040)
— [Details](attachment.cgi?id=9248040&action=edit)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1735265#c14)• 3 years ago |
|  | |

Attached file
[Bug 1735265 - Part 2: Add test r=mstange](attachment.cgi?id=9248041)
— [Details](attachment.cgi?id=9248041&action=edit)

Depends on D129681

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1735265#c15)• 3 years ago |
|  | |

The reporter requested that we consider this issue for the security bug bounty.

What are the limits or restrictions on what can be drawn on the framing page?

Group: gfx-core-securityFlags: sec-bounty?Flags: needinfo?(mikokm)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1735265#c16)• 3 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #15](/show_bug.cgi?id=1735265#c15 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe."))

> The reporter requested that we consider this issue for the security bug bounty.
>
> What are the limits or restrictions on what can be drawn on the framing page?

Consider a parent document with an iframe pointing to a child document that contains a table.

When a table header cell has stacking context inducing properties, its colum and column group backgrounds might be incorrectly clipped. If the table is large enough, these backgrounds can cover elements outside of the parent documents iframe bounds.

I was able to construct a testcase that fully covers the parent document in red. Browser chrome is unaffected.

Flags: needinfo?(mikokm)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1735265#c17)• 3 years ago |
|  | |

I assume a background image could be used as well? That makes the possibilities more interesting, but as an attack you'd still have to get your potential victim to frame you, and then hope there was something critical you could "erase" by covering it up or "replace" with an image that somehow fooled the viewer into interpreting things differently.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1735265#c18)• 3 years ago |
|  | |

When CSS background-image is used in element "colgroup", you can cover and replace the web contents with the image.

You can also place that image by applying the CSS width, height, left and top to the table element.

|  | [prada960808](/user_profile?user_id=665039)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1735265#c19)• 3 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9249144)
— [Details](attachment.cgi?id=9249144&action=edit)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1735265#c20)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily, it would require knowledge of how Gecko handles clipping and table backgrounds.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: The code changed in the patch was recently (FF92) moved to a different file, but the fix would be the same.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions.
[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: sec-approval?

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a3755136_547538)• 3 years ago |

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: sec-approval?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a4094099_24572)• 3 years ago |

[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=wontfix)
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1735265#c21)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

sec-low does not require sec-approval, you can land the patch and test as normal.

[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a4894798_578488)• 3 years ago |

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: sec-approval?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1735265#c22)• 3 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/c897d241ad396ac945043b026aca252defbe4704>

<https://hg.mozilla.org/integration/autoland/rev/26205128ce346e3b118df5e5610cec0c5aa30a05>

Backed out for causing reftest failures with 1735265-2-ref.html:

<https://hg.mozilla.org/integration/autoland/rev/47deea61c5ca3fa3bbfc00673b091cfd3c0ffd14>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=V99XSHzxRbmkvlt3ff4izg.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel&revision=26205128ce346e3b118df5e5610cec0c5aa30a05>

Reftest analyzer (width is smaller than in reference): <https://hg.mozilla.org/mozilla-central/raw-file/tip/layout/tools/reftest/reftest-analyzer.xhtml#logurl=https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/V99XSHzxRbmkvlt3ff4izg/runs/0/artifacts/public/logs/live_backing.log&only_show_unexpected=1>

Flags: needinfo?(mikokm)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a4977365_547538)• 3 years ago |

Flags: needinfo?(mikokm)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1735265#c23)• 3 years ago |
|  | |

There are some r+ patches which didn't land and no activity in this bug for 2 weeks.

:miko, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#not_landed.py).

Flags: needinfo?(mstange.moz)Flags: needinfo?(mikokm)

|  | [Markus Stange [:mstange]](/user_profile?user_id=293943) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a6770232_293943)• 3 years ago |

Flags: needinfo?(mstange.moz)Flags: needinfo?(mikokm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a7323164_75935)• 3 years ago |

[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix)
[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a9114791_75935)• 3 years ago |

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=wontfix)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1735265#c24)• 3 years ago |
|  | |

I think this was originally regressed by [bug 1409114](/show_bug.cgi?id=1409114 "RESOLVED FIXED - Figure out a better way to create display items for column backgrounds").

Regressed by: [1409114](/show_bug.cgi?id=1409114 "RESOLVED FIXED - Figure out a better way to create display items for column backgrounds")
No longer regressed by: [1691875](/show_bug.cgi?id=1691875 "RESOLVED FIXED - Refactor the code that creates inner table's ReflowInput and compute its size")

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a13952180_547538)• 3 years ago |

See Also: → [1760823](/show_bug.cgi?id=1760823 "NEW - Transformed mask-image is clipped incorrectly in table cell")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1735265#c25)• 3 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1409114](/show_bug.cgi?id=1409114 "RESOLVED FIXED - Figure out a better way to create display items for column backgrounds")

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1735265#c26)• 3 years ago |
|  | |

Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

<https://hg.mozilla.org/integration/autoland/rev/0e8ecb27701d1a671925d48bacaa206670c30a79>

<https://hg.mozilla.org/mozilla-central/rev/0e8ecb27701d>

Part 2: Add test r=mstange

<https://hg.mozilla.org/integration/autoland/rev/2371151dc9e98b077620490bcb70785adcac68bd>

<https://hg.mozilla.org/mozilla-central/rev/2371151dc9e9>

Group: gfx-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 100 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1735265#c27)• 3 years ago |
|  | |

Please nominate this for Beta/ESR approval when you get a chance.

[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=wontfix)
[tracking-firefox100](/buglist.cgi?f1=cf_tracking_firefox100&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox100&o1=equals&v1=%2B)
[tracking-firefox99](/buglist.cgi?f1=cf_tracking_firefox99&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox99&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [99+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=99%2B)Flags: needinfo?(mikokm)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1735265#c28)• 3 years ago |
|  | |

Changing the priority to P1 as the bug is tracked by a release manager for the current beta.

See [Triage for Bugzilla](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html#automatic-bug-updates) for more information.

If you disagree, please discuss with a release manager.

Priority: P3 → P1

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1735265#c29)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

### Beta/Release Uplift Approval Request

* **User impact if declined**: Table cell contents can overflow table bounds
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch is simple and includes a test. Additionally, this table structure is probably relatively rare.
* **String changes made/needed**:
Flags: needinfo?(mikokm)
[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: approval-mozilla-beta?

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14035615_547538)• 3 years ago |

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: approval-mozilla-beta?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1735265#c30)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

Approved for 99.0b8. Thanks.

[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1735265#c31)• 3 years ago |
|  | |

Comment on [attachment 9248041](/attachment.cgi?id=9248041 "Bug 1735265 - Part 2: Add test r=mstange") [[details]](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 2: Add test r=mstange

Approved for 99.0b8. Thanks.

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1735265#c32)• 3 years ago |
| uplift | |

Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

<https://hg.mozilla.org/releases/mozilla-beta/rev/e3a76df996b6>

Part 2: Add test r=mstange

<https://hg.mozilla.org/releases/mozilla-beta/rev/97b3e77ec5a7>

[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1735265#c33)• 3 years ago |
|  | |

Do we want this on ESR also?

Flags: needinfo?(mikokm)Flags: in-testsuite+

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1735265#c34)• 3 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #33](/show_bug.cgi?id=1735265#c33 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe."))

> Do we want this on ESR also?

I cannot comment about the security implications, but I think this is quite safe to uplift.

Flags: needinfo?(mikokm)

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1735265#c35)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Low risk patch that fixes a sec-low issue.
* **User impact if declined**: Table cell contents can overflow table bounds. Probably not a common issue in normal web content but has some security implications.
* **Fix Landed on Version**: 100
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch is simple and includes a test.
[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: approval-mozilla-esr91?

|  | [Miko Mynttinen](/user_profile?user_id=547538)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14141721_547538)• 3 years ago |

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: approval-mozilla-esr91?

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14184768_500622)• 3 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14185075_553429)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Raluca Popovici, Desktop QA](/user_profile?user_id=638973) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1735265#c36)• 3 years ago |
|  | |

I was able to reproduce this issue on my machine Win 10x64 on Nightly 95.0a1. I confirm the fix on Firefox 99.0b8 and Nightly 100.0a1

|  | [Raluca Popovici, Desktop QA](/user_profile?user_id=638973) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14229547_638973)• 3 years ago |

Status: RESOLVED → VERIFIED
[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=verified)
[status-firefox99](/buglist.cgi?f1=cf_status_firefox99&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox99&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1735265#c37)• 3 years ago |
|  | |

Comment on [attachment 9248040](/attachment.cgi?id=9248040 "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") [[details]](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange")

[Bug 1735265](/show_bug.cgi?id=1735265 "VERIFIED FIXED - Firefox incorrectly draws outside of iframe.") - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange

Thanks for the verification. Approved for 91.8esr.

[Attachment #9248040](/attachment.cgi?id=9248040&action=edit "Bug 1735265 - Part 1: Set clip on background items for table cols and colgroups, when the table cell has captured clip r=mstange") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14231906_75935)• 3 years ago |

[Attachment #9248041](/attachment.cgi?id=9248041&action=edit "Bug 1735265 - Part 2: Add test r=mstange") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1735265#c38)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/aa53a3f7fa51>

<https://hg.mozilla.org/releases/mozilla-esr91/rev/333794dc5892>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14481973_578488)• 3 years ago |

Whiteboard: [adv-main99+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1735265#c39)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9269928)
— [Details](attachment.cgi?id=9269928&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14721790_578488)• 3 years ago |

Whiteboard: [adv-main99+] → [adv-main99+][adv-esr91.8+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a14729894_578488)• 3 years ago |

Alias: CVE-2022-28286

|  | [Raluca Popovici, Desktop QA](/user_profile?user_id=638973) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1735265#c40)• 3 years ago |
|  | |

Verified fixed on Fx 91.8esr on Win 10x64. Reproduced on 91.6.1esr.

|  | [Raluca Popovici, Desktop QA](/user_profile?user_id=638973) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a15051887_638973)• 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a15130136_553429)• 3 years ago |

QA Whiteboard: [qa-triaged]Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a15173175_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a27653233_1689)• 2 years ago |

Group: core-security-release

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a30685598_255010)• 2 years ago |

See Also: → [CVE-2022-45420](/show_bug.cgi?id=1792643 "VERIFIED FIXED - iframe contents can be arbitrarily drawn outside of iframe.")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735265#a83080446_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1735265&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [prada960808](/user_profile?user_id=665039)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_08ed189d_20250114_185208.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-15

## Security Vulnerabilities fixed in Thunderbird 91.8

Announced
April 5, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.8

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-1197: OpenPGP revocation information was ignored](#CVE-2022-1197)

Reporter
Thunderbird user Johannes König
Impact
moderate
##### Description

When importing a revoked key that specified key compromise as the revocation reason, Thunderbird did not update the existing copy of the key that was not yet revoked, and the existing key was kept as non-revoked. Revocation statements that used another revocation reason, or that didn't specify a revocation reason, were unaffected.

##### References

* [Bug 1754985](https://bugzilla.mozilla.org/show_bug.cgi?id=1754985)

#### [#CVE-2022-1196: Use-after-free after VR Process destruction](#CVE-2022-1196)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

After a VR Process is destroyed, a reference to it may have been retained and used, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1750679](https://bugzilla.mozilla.org/show_bug.cgi?id=1750679)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potential exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Thunderbird 91.8](#CVE-2022-28289)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_e6c176ce_20250114_185207.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-13

## Security Vulnerabilities fixed in Firefox 99

Announced
April 5, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 99

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potentially exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28283: Missing security checks for fetching sourceMapURL](#CVE-2022-28283)

Reporter
Gijs
Impact
moderate
##### Description

The sourceMapURL feature in devtools was missing security checks that would have allowed a webpage to attempt to include local files or other files that should have been inaccessible.

##### References

* [Bug 1754066](https://bugzilla.mozilla.org/show_bug.cgi?id=1754066)

#### [#CVE-2022-28284: Script could be executed via svg's use element](#CVE-2022-28284)

Reporter
Leo Balter
Impact
moderate
##### Description

SVG's `<use>` element could have been used to load unexpected content that could have executed script in certain circumstances. While the specification seems to allow this, other browsers do not, and web developers relied on this property for script security so gecko's implementation was aligned with theirs.

##### References

* [Bug 1754522](https://bugzilla.mozilla.org/show_bug.cgi?id=1754522)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-28287: Text Selection could crash Firefox](#CVE-2022-28287)

Reporter
Aryan Sinha
Impact
low
##### Description

In unusual circumstances, selecting text could cause text selection caching to behave incorrectly, leading to a crash.

##### References

* [Bug 1741515](https://bugzilla.mozilla.org/show_bug.cgi?id=1741515)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](#CVE-2022-28289)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98 and Firefox ESR 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

#### [#CVE-2022-28288: Memory safety bugs fixed in Firefox 99](#CVE-2022-28288)

Reporter
Mozilla developers
Impact
moderate
##### Description

Mozilla developers and community members Randell Jesup, Sebastian Hengst, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746415%2C1746495%2C1746500%2C1747282%2C1748759%2C1749056%2C1749786%2C1751679%2C1752120%2C1756010%2C1756017%2C1757213%2C1757258%2C1757427)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d827746b_20250114_185208.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-14

## Security Vulnerabilities fixed in Firefox ESR 91.8

Announced
April 5, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.8

#### [#CVE-2022-1097: Use-after-free in NSSToken objects](#CVE-2022-1097)

Reporter
Randell Jesup
Impact
high
##### Description

`NSSToken` objects were referenced via direct points, and could have been accessed in an unsafe way on different threads, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1745667](https://bugzilla.mozilla.org/show_bug.cgi?id=1745667)

#### [#CVE-2022-28281: Out of bounds write due to unexpected WebAuthN Extensions](#CVE-2022-28281)

Reporter
Axel '0vercl0k' Souchet
Impact
high
##### Description

If a compromised content process sent an unexpected number of WebAuthN Extensions in a Register command to the parent process, an out of bounds write would have occurred leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1755621](https://bugzilla.mozilla.org/show_bug.cgi?id=1755621)

#### [#CVE-2022-1196: Use-after-free after VR Process destruction](#CVE-2022-1196)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
moderate
##### Description

After a VR Process is destroyed, a reference to it may have been retained and used, leading to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1750679](https://bugzilla.mozilla.org/show_bug.cgi?id=1750679)

#### [#CVE-2022-28282: Use-after-free in DocumentL10n::TranslateDocument](#CVE-2022-28282)

Reporter
Kirin
Impact
moderate
##### Description

By using a link with `rel="localization"` a use-after-free could have been triggered by destroying an object during JavaScript execution and then referencing the object through a freed pointer, leading to a potential exploitable crash.

##### References

* [Bug 1751609](https://bugzilla.mozilla.org/show_bug.cgi?id=1751609)

#### [#CVE-2022-28285: Incorrect AliasSet used in JIT Codegen](#CVE-2022-28285)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

When generating the assembly code for `MLoadTypedArrayElementHole`, an incorrect AliasSet was used. In conjunction with another vulnerability this could have been used for an out of bounds memory read.

##### References

* [Bug 1756957](https://bugzilla.mozilla.org/show_bug.cgi?id=1756957)

#### [#CVE-2022-28286: iframe contents could be rendered outside the border](#CVE-2022-28286)

Reporter
prada960808
Impact
low
##### Description

Due to a layout change, iframe contents could have been rendered outside of its border. This could have led to user confusion or spoofing attacks.

##### References

* [Bug 1735265](https://bugzilla.mozilla.org/show_bug.cgi?id=1735265)

#### [#CVE-2022-24713: Denial of Service via complex regular expressions](#CVE-2022-24713)

Reporter
Addison Crump and Jan-Erik Rediger
Impact
low
##### Description

The rust regex crate did not properly prevent crafted regular expressions from taking an arbitrary amount of time during parsing. If an attacker was able to supply input to this crate, they could have caused a denial of service in the browser.

##### References

* [Bug 1758509](https://bugzilla.mozilla.org/show_bug.cgi?id=1758509)

#### [#CVE-2022-28289: Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](#CVE-2022-28289)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Nika Layzell, Andrew McCreight, Gabriele Svelto, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 98 and Firefox ESR 91.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 99 and Firefox ESR 91.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1663508%2C1744525%2C1753508%2C1757476%2C1757805%2C1758549%2C1758776)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


