Based on the provided content, here's a breakdown of the vulnerability described for CVE-2022-28373:

**Root Cause of Vulnerability:**

*   The IDU (Indoor Unit) firmware (version 3.4.66.162) contains a function named `crtcreadpartition` within the `/usr/lib/lua/luci/crtc.lua` file that does not properly sanitize user-controlled parameters. Specifically, the function fails to filter out shell metacharacters.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The lack of input sanitization allows an attacker to inject shell metacharacters into parameters passed to the `crtcreadpartition` function. This enables execution of arbitrary shell commands.

**Impact of Exploitation:**

*   **Remote Code Execution:** Successful exploitation results in the attacker achieving remote code execution as the root user on the IDU. This grants complete control over the affected device.
*   **Persistence:** The vulnerability allows for the creation of a new user account with root privileges or other persistent modifications to the system, allowing for continued access even after a reboot.

**Attack Vectors:**

*   **Network Access:** Exploitation requires network access to the device's web interface listening on port 48443.
*   **JSON RPC API:** The vulnerability is exploited through the JSON RPC API accessible at `https://10.0.0.2:48443/cgi-bin/luci/rpc/crtc`.
*   **Specific Function Call:** The attack is launched by calling the `crtcreadpartition` method with a crafted payload within the parameters.

**Required Attacker Capabilities/Position:**

*   **Network Reachability:** The attacker must be able to reach the device on the network, likely meaning they must be on the same local network or have access to the device through a VPN.
*   **Knowledge of API and Parameters:** The attacker needs to know the API endpoint, function name (`crtcreadpartition`), the required parameters, and how to inject shell metacharacters within that context to execute malicious code.
*   **Access to Device Certificates:** The attacker needs access to the `ca.pem` and `server.pem` files located within the device firmware to authenticate to the JSON RPC API.
*   **crtcmode Enabled:** The attacker must enable the crtcmode by issuing the `crtcmode` command to the JSON RPC API.
*   **Basic Networking Skills:** The attacker needs to understand how to use tools like `curl` and `netcat` to deliver the payload and receive the reverse shell.

**Additional Details:**

*   The content provides a specific example of a payload used to achieve root access: injecting commands to create a named pipe, initiate a reverse shell via netcat, and then connecting to an attacker-controlled machine
*   The content provides a full attack chain, including how to obtain the required certificates, gain access to the web interface, extract the firmware, discover the vulnerability, and then exploit the vulnerability to gain remote code execution.
*   The content also highlights the lack of input validation which is the cause of the vulnerability

This information provides more detail than the basic CVE description.