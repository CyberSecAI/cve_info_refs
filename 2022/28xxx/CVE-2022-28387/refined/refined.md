The provided content relates to CVE-2022-28387.

**Root cause of vulnerability:**
The vulnerability stems from an insecure design in Verbatim Fingerprint Secure Portable Hard Drive and Verbatim Executive Fingerprint Secure SSD, which allows retrieval of the currently used password. The password can be retrieved by sending a specific IOCTL command to the USB device.

**Weaknesses/vulnerabilities present:**
- **Use of a Cryptographic Primitive with a Risky Implementation (CWE-1240):** The devices use AES-256 in ECB mode for data encryption, which is considered insecure.
-  **Insecure Password Retrieval:**  A specific IOCTL command can be used to retrieve the password and cryptographic key material.
- **Hardcoded Cryptographic Key**: The data part of device-specific commands is encrypted using AES with a hard-coded cryptographic key, found within the client software and the USB-to-SATA bridge controller's firmware, which contributes to the vulnerability.

**Impact of exploitation:**
- An attacker can retrieve the device's password and key material.
- Unauthorized access to stored data on the hard drive or SSD.
- Bypassing the fingerprint and password security mechanisms.

**Attack vectors:**
- Sending a specific IOCTL command (IOCTL\_SCSI\_PASS\_THROUGH) to the USB device.
- Requires knowledge of the used AES encryption scheme for the command data.

**Required attacker capabilities/position:**
- Physical access to the vulnerable device.
- Ability to send specific IOCTL commands to the device using a Windows or macOS client software or a custom tool.
- Knowledge of the hardcoded AES key used to encrypt the data part of the IOCTL command.

**Additional details:**

- The vulnerable devices use a USB-to-SATA bridge controller (INIC-3637EN) and a fingerprint sensor controller (INIC-3782N).
-  The devices have a fingerprint sensor for unlocking and password option.
- The vulnerability was found by Matthias Deeg of SySS GmbH.
- There is no known solution for the vulnerability.