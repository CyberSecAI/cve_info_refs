Based on the provided content, here's the breakdown of CVE-2022-40958:

**Root cause of vulnerability:**

- The vulnerability stems from the way Firefox handles cookies with a leading "=" character in the `Set-Cookie` header. When a cookie with a leading "=" is injected, the browser incorrectly parses the cookie, leading to a bypass of the `__Host` and `__Secure` prefix restrictions.

**Weaknesses/vulnerabilities present:**

- **Cookie Prefix Bypass:** The primary weakness is the ability to bypass the security restrictions imposed by the `__Host` and `__Secure` cookie prefixes. These prefixes are intended to ensure that cookies are set only from secure contexts or for the host domain. By injecting a cookie with a leading "=", an attacker can set cookies that should be restricted.
- **Incorrect Cookie Parsing:** The core issue is incorrect parsing logic, where the leading "=" is not handled correctly when splitting the cookie string into name and value. This causes the intended name to be interpreted as part of the value and the value is parsed incorrectly.

**Impact of exploitation:**

- **Session Fixation:** An attacker can exploit this vulnerability to perform session fixation attacks. They can set cookies for a victim site, potentially hijacking user sessions or controlling access to the site by using a crafted cookie.
- **Cookie Spoofing**: The attacker can create spoofing cookies that appear to be legitimate `__Host` and `__Secure` cookies. This could lead to authentication and authorization bypasses if the application relies solely on these cookies.
- **Subdomain attacks:** A compromised subdomain can set cookies for the parent domain, thus bypassing what the `__Host-` prefix is meant to protect against, without requiring a Man-in-the-Middle (MITM) attack.

**Attack vectors:**

- **Shared Subdomains:** Attackers on a shared subdomain that lacks a secure context can exploit the vulnerability.
- **MITM (Man-in-the-Middle):** A malicious MITM attacker could inject a crafted `Set-Cookie` header with a leading "=" character.
- **Compromised Subdomain**: A compromised subdomain can directly set these malicious cookies without needing an MITM.
- **XSS (Cross-Site Scripting):** If the attacker has an XSS vulnerability on a website, they can set these malicious cookies using javascript.

**Required attacker capabilities/position:**

- The attacker needs the ability to inject a malicious `Set-Cookie` header or execute JavaScript code to manipulate the `document.cookie` API.
- The attacker needs a presence on a non-secure context (non-HTTPS). This could be a compromised shared subdomain, a MITM position to inject the header, or XSS on a sibling domain.

**Additional details from the bug report:**

-   The vulnerability is not specific to `document.cookie`, it also affects cookies set via the `Set-Cookie` header.
-   The fix involves rejecting cookies with empty names that also have a value starting with either `__Host-` or `__Secure-` prefix.
-   The vulnerability was present in Firefox and Chrome, as well as the implementations of other web browsers.
-   The issue was discussed in the context of ongoing cookie specification updates.
-   The security impact is considered moderate, and the fix is low risk due to it targeting a very rare case.
-   The bug was fixed in Firefox 105, Firefox ESR 102.3 and later versions.

This information provides a more detailed understanding of the vulnerability than the original CVE description.