=== Content from www.mozilla.org_f0a3d189_20250114_213646.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-42

## Security Vulnerabilities fixed in Thunderbird 102.3

Announced
September 20, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Thunderbird on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-3155: Attachment files saved to disk on macOS could be executed without warning](#CVE-2022-3155)

Reporter
Koh M. Nakagawa
Impact
low
##### Description

When saving or opening an email attachment on macOS, Thunderbird did not set attribute com.apple.quarantine on the received file. If the received file was an application and the user attempted to open it, then the application was started immediately without asking the user to confirm.

##### References

* [Bug 1789061](https://bugzilla.mozilla.org/show_bug.cgi?id=1789061)

#### [#CVE-2022-40962: Memory safety bugs fixed in Thunderbird 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_65e15361_20250114_213645.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-41

## Security Vulnerabilities fixed in Firefox ESR 102.3

Announced
September 20, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.3

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Firefox on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-40962: Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 104 and Firefox ESR 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_a316ec28_20250114_213644.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1779993)
* [XML](/show_bug.cgi?ctype=xml&id=1779993)

Closed
[Bug 1779993](/show_bug.cgi?id=1779993)
(CVE-2022-40958)

Opened 2 years ago
Closed 2 years ago

# '=' prepended to set-cookie header can result in \_\_Secure- and \_\_Host- prefix bypasses

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

'=' prepended to set-cookie header can result in \_\_Secure- and \_\_Host- prefix bypasses

## Categories

### (Core :: Networking: Cookies, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20Cookies#Networking%3A%20Cookies)

Networking: Cookies
▾

Core :: Networking: Cookies
A general mechanism which server side connections (such as CGI scripts) can use to both store and retrieve information on the client side of the connection. This refers to HTML cookies; little blobs of data we store and share with sites
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20Cookies&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20Cookies&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20Cookies)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

106 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [105+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=105%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix) |
| firefox103 | [-](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=wontfix) |
| firefox104 | [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=wontfix) |
| firefox105 | [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed) |
| firefox106 | [+](/buglist.cgi?f1=cf_tracking_firefox106&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | - | wontfix |
| firefox-esr102 | 105+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox102 |  | wontfix |
| firefox103 | - | wontfix |
| firefox104 | + | wontfix |
| firefox105 | + | fixed |
| firefox106 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: haxatron1, Assigned: valentin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ece264081141db92a1ad0d985a5d3489?d=mm&size=40)  [haxatron1](/user_profile?user_id=704427)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1783982](/show_bug.cgi?id=1783982 "RESOLVED DUPLICATE - Cookie prefixes bypass via nameless cookies (rfc6265bis)")

Dependency [tree](/showdependencytree.cgi?id=1779993&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1779993)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1783982](/show_bug.cgi?id=1783982 "RESOLVED DUPLICATE - Cookie prefixes bypass via nameless cookies (rfc6265bis)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1783982](/show_bug.cgi?id=1783982 "RESOLVED DUPLICATE - Cookie prefixes bypass via nameless cookies (rfc6265bis)")

[github.com/httpwg/http-extensions/iss...](https://github.com/httpwg/http-extensions/issues/1210 "https://github.com/httpwg/http-extensions/issues/1210")

[github.com/httpwg/http-extensions/pul...](https://github.com/httpwg/http-extensions/pull/2220 "https://github.com/httpwg/http-extensions/pull/2220")

[github.com/httpwg/http-extensions/pul...](https://github.com/httpwg/http-extensions/pull/1592 "https://github.com/httpwg/http-extensions/pull/1592")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1345193 "https://bugs.chromium.org/p/chromium/issues/detail?id=1345193")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1351601 "https://bugs.chromium.org/p/chromium/issues/detail?id=1351601")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form][necko-triaged][post-critsmash-triage] [necko-priority-queue][adv-main105+][adv-esr102.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-40958

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][necko-triaged][post-critsmash-triage] [necko-priority-queue][adv-main105+][adv-esr102.3+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a5561254_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c29 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a4856149_553429 "2 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Bug 1779993 - Reject cookies with no name and a \_\_Secure- or \_\_Host- prefix r=#necko](/attachment.cgi?id=9293299)  [2 years ago](#c24)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c28 "2 years ago")  RyanVM : [approval-mozilla-esr102+](#c28 "2 years ago") | [Details](/attachment.cgi?id=9293299&action=edit) | [Review](/attachment.cgi?id=9293299) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9294822)  [2 years ago](#c32)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   320 bytes, text/plain |  | [Details](/attachment.cgi?id=9294822&action=edit) |
| [advisory.txt](/attachment.cgi?id=9295290)  [2 years ago](#c35)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   333 bytes, text/plain |  | [Details](/attachment.cgi?id=9295290&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1779993#c0)• 2 years ago |
|  | |

1. Go to <http://httpbin.org>
2. Execute document.cookie = "= \_\_Host-test=a" in the console
3. Go to <http://httpbin.org/headers> and see Cookie with cookie: 'Cookie "\_\_Host-test=a"'. This shouldn't happen as \_\_Secure- and \_\_Host- should only be set from a secure context
Flags: sec-bounty?

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a160_704427)• 2 years ago |

Summary: '=' prepended to cookie name can result in \_\_Secure- and \_\_Host- prefix bypasses → '=' prepended to set-cookie header can result in \_\_Secure- and \_\_Host- prefix bypasses

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1779993#c1)• 2 years ago |
|  | |

Additional notes: Also reproduces with Set-Cookie header

The pertinent issue is that when document.cookie = "=\_\_Host-test=a" is executed, the name of the cookie is empty, and the value of the cookie is "=\_\_Host-test=a". The unexpected result is that "\_\_Host-test=a" value gets sent instead of "=\_\_Host-test=a".

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1779993#c2)• 2 years ago |
|  | |

I recommend rejecting cookies with empty names as a fix for this problem

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a5605_159069)• 2 years ago |

Group: firefox-core-security → network-core-securityComponent: Security → Networking: CookiesProduct: Firefox → Core

|  | [edgul](/user_profile?user_id=701256) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1779993#c3)• 2 years ago |
|  | |

(In reply to haxatron1 from [comment #0](/show_bug.cgi?id=1779993#c0 "RESOLVED FIXED - '=' prepended to set-cookie header can result in __Secure- and __Host- prefix bypasses"))

> 1. Go to <http://httpbin.org>
> 2. Execute document.cookie = "= \_\_Host-test=a" in the console
> 3. Go to <http://httpbin.org/headers> and see Cookie with cookie: 'Cookie "\_\_Host-test=a"'. This shouldn't happen as \_\_Secure- and \_\_Host- should only be set from a secure context

Reproduced.

Severity: -- → S2Priority: -- → P1Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [necko-triaged] [necko-priority-review]

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1779993#c4)• 2 years ago |
|  | |

Just adding here the attack scenario:

"The attack scenario is that a malicious MITM or a compromised subdomain can set these prefixed cookies for a victim site to perform session fixation, effectively bypassing what this prefixes are meant to protect against."

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1779993#c5)• 2 years ago |
|  | |

There is also the case of a compromised subdomain being able to set a cookie for the parent domain, bypassing what the \_\_Host- prefix is meant to protect against. In that scenario no MITM is involved.

|  | [edgul](/user_profile?user_id=701256) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a203097_701256)• 2 years ago |

Priority: P1 → P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1779993#c6)• 2 years ago |
|  | |

This seems wrong even apart from bypassing \_\_Host and \_\_Secure. It's actually valid for a cookie to not have a name (or not have a value). We should not ever turn part of a value into a name.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1779993#c7)• 2 years ago |
|  | |

Turns out this has been discussed as part of the ongoing cookie spec update ([issue #1210](https://github.com/httpwg/http-extensions/issues/1210#issuecomment-893863325)), and although no one liked this behavior, there are worries about breaking sites that appear to depend on it. The end result was a [recommendation that servers not do this](https://github.com/httpwg/http-extensions/pull/2220). Obviously, hackers will ignore that recommendation if it's useful to do so.

Faking a prefixed cookie wasn't specifically mentioned, but it's a subset of this known ability. As far as I can tell Chrome also behaves this same way, which makes sense because there are web platform tests that try to help keep implementations in sync and help make sure our specs match reality.

There was a proposal to preserve the leading "=" in the case of a nameless cookie with an embedded "=" ([PR #1592](https://github.com/httpwg/http-extensions/pull/1592)). Seems sensible to me, but was rejected in favor of the weaker spec "recommendation" language. An alternate solution is in the proposed [Cookie Store API](https://wicg.github.io/cookie-store/#set-cookie-algorithm) (an experimental feature in Chrome) which says nameless cookies with an embedded '=" should be flat-out rejected.

I quite like the solution in PR #1592, but if we can't have that maybe we could do something specifically about prefixed cookies. We could still do the "start with =" solution if a nameless cookie has an embedded '=' in the value and "looks like" a prefixed cookie, or we could block the setting of those cookies. "looks like a prefixed cookie" could be broadly "starts with \_\_" or more narrowly "starts with either of the defined prefixes."

See Also: → <https://github.com/httpwg/http-extensions/issues/1210>,
<https://github.com/httpwg/http-extensions/pull/2220>,
<https://github.com/httpwg/http-extensions/pull/1592>

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1779993#c8)• 2 years ago |
|  | |

Yes, Chromium behaves this way, and this is being discussed there as well.

I have cc'ed @morlovich who is one of the Chromium engineers working on the report. Though it seems you have cc'ed @bingler too.

Summary of discussion on solutions on the report:

1. Currently the solution @bingler suggested was to reject any cookie values with the prefix:

`BWS "__Secure-" *cookie-octet "="`

or

`BWS "__Host-" *cookie-octet "="`

2. I have also suggested:

If the cookie pair starts with an = character, and there are at least two = characters in the cookie pair, and there is at least one cookie octet in between the leading = character and the second = character, then remove the leading = character before splitting the cookie pair into cookie name and cookie value.

This is a vulnerability in the RFC6265 spec itself as well, so its likely that the spec will get updated with whatever solution is decided as well.

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1779993#c9)• 2 years ago |
|  | |

\*Correction for 1

if the cookie name is empty, reject any cookie values with the prefix:

BWS "\_\_Secure-" \*cookie-octet "="

or

BWS "\_\_Host-" \*cookie-octet "="

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1779993#c10)• 2 years ago |
|  | |

Nvm... I also saw this from the <https://github.com/httpwg/http-extensions/issues/1210>

> since Set-Cookie: =foo=1 and Set-Cookie: =bar=2 are the same cookie (the nameless cookie) but with different values, and they overwrite each other, a site could be relying on getting the output Cookie: foo=1 or Cookie: bar=2 (but never both) as a way of (sort of) setting two mutually exclusive cookies named foo and bar.

So it looks like solution 1 is the best way to go about it.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1779993#c11)• 2 years ago |
|  | |

Could we get a link to the Chromium bug, please? Even if it's inaccessible to us as a security bug the reference is handy to have in our conversations with our Chrome/Edge colleagues, and will be a useful historical cross-reference when both bugs are made public in the future.

> This is a vulnerability in the RFC6265 spec itself as well,

The Technically not: [rfc6265 §5.4 step 4.1](https://www.rfc-editor.org/rfc/rfc6265.html#section-5.4) says

> Output the cookie's name, the %x3D ("=") character, and the cookie's value.

For an empty-name cookie that would yield `=__Host-foo=fakevalue`. That was changed in the ongoing and still technically unofficial rfc6265-bis spec update in [issue #1144](https://github.com/httpwg/http-extensions/pull/1144) because in practice most browsers didn't do that.

> so its likely that the spec will get updated with whatever solution is decided as well.

Absolutely. In fact we'd want to get agreement on a spec change before we fix this in Firefox. We all want browsers to follow the spec and the spec to match reality. Inconsistent behavior leads to sites breaking in one browser or another, or in the worst case leads to a site with a security bug but only for users of some browsers and not others.

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1779993#c12)• 2 years ago |
|  | |

The link is <https://bugs.chromium.org/p/chromium/issues/detail?id=1345193>, as mentioned, it is currently inaccessible without permissions and I there isn't any cc feature available. Would you like me to ask if they could cc you there?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1779993#c13)• 2 years ago |
|  | |

Thanks for the link. I'll email them and ask; no need to clutter their bug with that request.

If we're only going to protect prefixed cookies then any of the suggestions work, really, whether that's rejecting the cookies or prefixing the returned cookie value with "=". I'm unhappy protecting only prefixed cookies, however: those aren't the only ones with special handling. For example, normally an attacker can't overwrite an HttpOnly cookie from a non-HTTP context (e.g. `document.cookie`), and we don't let a non-secure cookie overwrite a secure cookie. This trick doesn't literally overwrite them, but it can create spoofing copies. Depending on the attackers position (plaintext MITM? XSS on a sibling domain?) and how the website is set up the attacker might be able to do that anyway,

The hypothetical usage in [comment 10](/show_bug.cgi?id=1779993#c10 "RESOLVED FIXED - '=' prepended to set-cookie header can result in __Secure- and __Host- prefix bypasses") is cute, but do we have any evidence of sites depending on that too-clever behavior?

Something is better than nothing, though. Although it adds more special-case cruft to the spec, the proposal to block such cookies only if the values start with a known prefix value is surgically targeted at a known case that can't possibly have been an innocent coincidence. Lord knows how many times we've been bitten in the ass by the smallest of seemingly inconsequential cookie changes. Philosophically I like your proposed option 2 better because it's a general solution, but it will change observable behavior in far more cases and that's unpredictable. Realistically Firefox can't take that risk unless the chromium team believes in that solution and is willing the forge the path.

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1345193>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1779993#c14)• 2 years ago |
|  | |

Since we referenced the original rfc6265 § 5.4 above as a historical note, I should note that [the Chrome bug discussion](https://bugs.chromium.org/p/chromium/issues/detail?id=1345193#c4) points out that [rfc6265 § 5.2](https://www.rfc-editor.org/rfc/rfc6265.html#section-5.2) strictly disallows nameless cookies in step 5 of `parse a "set-cookie-string"`. Step 3 before that is a little misleading because it mentions that the name and value are "possibly empty" -- but that's just step 3.

> 3. The (possibly empty) name string consists of the characters up to, but not including, the first %x3D ("=") character, and the (possibly empty) value string consists of the characters after the first %x3D ("=") character.
> 4. Remove any leading or trailing WSP characters from the name string and the value string.
> 5. If the name string is empty, ignore the set-cookie-string entirely.

That's just historical interest. Browsers have been pursuing rfc6265-bis for a long time now—including features like the Cookie Prefixes that are being attacked here—and that's what we need to be concerned with.

This isn't going to make next week's release (already testing release candidate builds) so let's target 104. Also affects ESR-91 that I think we support until ~fx105.

[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=wontfix)
[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected)
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox103](/buglist.cgi?f1=cf_tracking_firefox103&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox103&o1=equals&v1=-)
[tracking-firefox104](/buglist.cgi?f1=cf_tracking_firefox104&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox104&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [104+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=104%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [104+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=104%2B)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a706725_505624)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [necko-triaged] [necko-priority-review] → [reporter-external] [client-bounty-form] [verif?] [necko-triaged] [necko-priority-queue]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1779993#c15)• 2 years ago |
|  | |

Chrome's patch for this is [https://chromium.googlesource.com/chromium/src/+/f9580905b45edb8dfe7da6cd5f26421ab2b5c285](https://chromium.googlesource.com/chromium/src/%2B/f9580905b45edb8dfe7da6cd5f26421ab2b5c285)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1779993#c16)• 2 years ago |
|  | |

The bug is marked as tracked for firefox104 (beta). However, the bug still isn't assigned.

:ghess, could you please find an assignee for this tracked bug? If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#tracked_attention.py).

Flags: needinfo?(ghess)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1779993#c17)• 2 years ago |
|  | |

This is a reminder regarding [comment #16](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993#16)!

The bug is marked as tracked for firefox104 (beta). We have limited time to fix this, the soft freeze is in 14 days. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1779993#c18)• 2 years ago |
|  | |

This is a reminder regarding [comment #16](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993#16)!

The bug is marked as tracked for firefox104 (beta). We have limited time to fix this, the soft freeze is in 13 days. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1779993#c19)• 2 years ago |
|  | |

This is a reminder regarding [comment #16](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993#16)!

The bug is marked as tracked for firefox104 (beta). We have limited time to fix this, the soft freeze is in 10 days. However, the bug still isn't assigned.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1779993#c20)• 2 years ago |
|  | |

Clearly not getting fixed in the 104 timeframe.

[status-firefox103](/buglist.cgi?f1=cf_status_firefox103&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox103&o1=equals&v1=wontfix)
[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=wontfix)
[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[104+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=104%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[104+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=104%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=-)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a2078942_415378)• 2 years ago |

See Also: → [1783982](/show_bug.cgi?id=1783982 "RESOLVED DUPLICATE - Cookie prefixes bypass via nameless cookies (rfc6265bis)")

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a2417274_415378)• 2 years ago |

Blocks: [1783982](/show_bug.cgi?id=1783982 "RESOLVED DUPLICATE - Cookie prefixes bypass via nameless cookies (rfc6265bis)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1779993#c21)• 2 years ago |
|  | |

In the [second chrome bug](https://bugs.chromium.org/p/chromium/issues/detail?id=1351601#c9) squarcina posted a nice bit of investigation of how the initial Chrome fix can by bypassed with at least one cloud platform:

> I discovered some additional issues: PHP replaces spaces, dots and open square brackets with the underscore symbol in the keys of the $\_COOKIE superglobal array; other frameworks perform the URL decode of the cookie name. These server-side mistakes effectively violate the security assumptions that browsers make on cookie prefixes. I reported these issues to the mantainers of the affected projects.
>
> Then, I quickly investigated Amazon API Gateway, in particular [AWS Lambda proxy integration](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html). From the linked page:
>
> > Format 2.0 includes a new cookies field. All cookie headers in the request are combined with commas and added to the cookies field. In the response to the client, each cookie becomes a set-cookie header.
>
> According to my limited set of tests, this specific parser seems to be rfc6265bis-compliant. The problem with nameless cookies and the rfc serialization algorithm is that sending the header:
>
> ```
>    Cookie: =__Host-test=foo
>
> ```
>
> as a result of setting a nameless cookie via, e.g., document.cookie = '==\_\_Host-test=foo' (which is accepted by the latest Chrome Canary build), is further serialized by the AWS Lambda proxy integration as:
>
> ```
>    {
>    "version": "2.0",
>    "routeKey": "ANY /{proxy+}",
>    "rawPath": "/",
>    "rawQueryString": "",
>    "cookies": [
>        "__Host-test=foo"
>    ],
>    ...
>
> ```
>
> resulting indistinguishable from a legitimate cookie named '\_\_Host-test' with value 'foo'.
>
> In summary: chaining compliant parsers can introduce issues not mitigated by the current Chrome patch.

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1351601>

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1779993#c22)• 2 years ago |
|  | |

Wow. Very interesting research @squarcina!

This comes down to the same problem I elaborated in the other thread. There isn't a commonly defined spec for servers to parse the Cookie header, which can open up a whole can of worms regarding bypassing these cookie prefixes which have occurred time and time again in the past (with percent-encoded issues and what not). =\_\_Host-test=foo is actually the technically correct thing Chrome and Firefox should do in this case, but even with that, some platforms still interpret as \_\_Host-test=foo as pointed out by @squarcina.

|  | [Greg Hess](/user_profile?user_id=694371) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a2783349_694371)• 2 years ago |

Flags: needinfo?(ghess)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a3127429_415378)• 2 years ago |

Assignee: nobody → valentin.gosu

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1779993#c24)• 2 years ago |
|  | |

Attached file
[Bug 1779993 - Reject cookies with no name and a \_\_Secure- or \_\_Host- prefix r=#necko](attachment.cgi?id=9293299)
— [Details](attachment.cgi?id=9293299&action=edit)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1779993#c25)• 2 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/f55ef6188041c5e0dbd225bc7a56c19f93f83b9e>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1779993#c26)• 2 years ago |
|  | |

Reject cookies with no name and a \_\_Secure- or \_\_Host- prefix r=necko-reviewers,kershaw

<https://hg.mozilla.org/mozilla-central/rev/f55ef6188041>

Group: network-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 106 Branch

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1779993#c27)• 2 years ago |
|  | |

Comment on [attachment 9293299](/attachment.cgi?id=9293299 "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") [[details]](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko")

[Bug 1779993](/show_bug.cgi?id=1779993 "RESOLVED FIXED - '=' prepended to set-cookie header can result in __Secure- and __Host- prefix bypasses") - Reject cookies with no name and a \_\_Secure- or \_\_Host- prefix r=#necko

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential bypass of \_\_Host- and \_\_Secure- cookie prefix restrictions
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The change blocks cookies with no name and a value starting with either \_\_Host- or \_\_Secure-

  This corner case should be really rare, and shouldn't cause any breakage.
* **String changes made/needed**:
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**: 106
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-esr102?
[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a4506526_75935)• 2 years ago |

[tracking-firefox105](/buglist.cgi?f1=cf_tracking_firefox105&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B)
[tracking-firefox106](/buglist.cgi?f1=cf_tracking_firefox106&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox106&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=%3F) → [105+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=105%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1779993#c28)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1779993&comment_id=16066734 "1 revision") |
|  | |

Comment on [attachment 9293299](/attachment.cgi?id=9293299 "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") [[details]](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko")

[Bug 1779993](/show_bug.cgi?id=1779993 "RESOLVED FIXED - '=' prepended to set-cookie header can result in __Secure- and __Host- prefix bypasses") - Reject cookies with no name and a \_\_Secure- or \_\_Host- prefix r=#necko

Approved for 105.0b9 and 102.3esr.

[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-esr102?
[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-esr102+
[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-beta?
[Attachment #9293299](/attachment.cgi?id=9293299&action=edit "Bug 1779993 - Reject cookies with no name and a __Secure- or __Host- prefix r=#necko") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1779993#c29)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3f589e5decae>

[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1779993#c30)• 2 years ago |
|  | |

I can confirm the fix works on the latest Nightly build; Entering document.cookie = "=\_\_Host-test=a" will now throw the error "Cookie “” has been rejected for invalid prefix." I can also confirm that the Set-Cookie headers have also been fixed.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1779993#c31)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/80ecb3c8668b>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a4856149_553429)• 2 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?] [necko-triaged] [necko-priority-queue] → [reporter-external] [client-bounty-form] [verif?] [necko-triaged][post-critsmash-triage] [necko-priority-queue]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a5017712_428608)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [necko-triaged][post-critsmash-triage] [necko-priority-queue] → [reporter-external] [client-bounty-form][necko-triaged][post-critsmash-triage] [necko-priority-queue][adv-main105+][ adv-esr102.3+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1779993#c32)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9294822) (obsolete)
— [Details](attachment.cgi?id=9294822&action=edit)

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1779993#c33)• 2 years ago |
|  | |

Hi, could you credit me as the following instead? -

Axel Chong (@Haxatron)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a5461557_428608)• 2 years ago |

Alias: CVE-2022-40958

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1779993#c34)• 2 years ago |
|  | |

(In reply to haxatron1 from [comment #33](/show_bug.cgi?id=1779993#c33 "RESOLVED FIXED - '=' prepended to set-cookie header can result in __Secure- and __Host- prefix bypasses"))

> Hi, could you credit me as the following instead? -
>
> Axel Chong (@Haxatron)

@freddy, jic you didn't see my previous message.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1779993#c35)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9295290)
— [Details](attachment.cgi?id=9295290&action=edit)

Done. Thanks for working with us!

[Attachment #9294822](/attachment.cgi?id=9294822&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a5561254_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a15792865_1689)• 2 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a27643495_1689)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form][necko-triaged][post-critsmash-triage] [necko-priority-queue][adv-main105+][ adv-esr102.3+] → [reporter-external] [client-bounty-form][necko-triaged][post-critsmash-triage] [necko-priority-queue][adv-main105+][adv-esr102.3+]

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1779993#a58953669_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1779993&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3921f6bb_20250114_213644.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-40

## Security Vulnerabilities fixed in Firefox 105

Announced
September 20, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 105

This advisory was updated December 13, 2022 to add CVE-2022-46880. This fix was included in the original release of Firefox 105, but did not appear in the advisory published at that time.

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.
*Note*: This advisory was added on December 13th, 2022 after we better understood the impact of the issue. The fix was included in the original release of Firefox 105.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40961: Stack-buffer overflow when initializing Graphics](#CVE-2022-40961)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

During startup, a graphics driver with an unexpected name could lead to a stack-buffer overflow causing a potentially exploitable crash.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1784588](https://bugzilla.mozilla.org/show_bug.cgi?id=1784588)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Firefox on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-40962: Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 104 and Firefox ESR 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


