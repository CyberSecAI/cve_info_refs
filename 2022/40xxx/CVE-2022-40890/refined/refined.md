Based on the provided content, here's a breakdown of the vulnerability described:

**Root Cause:**

- The vulnerability lies in how Open5gs AMF handles `NG_Setup_Request` connections from gNBs (base stations).
- The AMF allocates resources for each gNB connection *before* checking if the maximum number of allowed gNBs has been reached.
- The check to prevent exceeding maximum number of gNB is performed *after* the `amf_gnb_t` structure has been allocated.
- The `amf_gnb_find_by_addr` function uses the hash value of `ogs_sockaddr_t`, which includes the port number. Therefore connections from the same IP but different ports bypass the duplicate detection.

**Weaknesses/Vulnerabilities Present:**

- **Resource exhaustion:** The AMF allocates memory for each new SCTP connection from a gNB, even if the maximum number of gNBs is reached. This leads to resource exhaustion and a crash when multiple connections are made from same IP using different ports.
- **Incorrect detection of existing gNB connections**: The logic for checking if the same gNB is already connected is based on the hash of the socket address, including the port number. This allows an attacker to initiate multiple gNB connections from a single IP address by using different ports.

**Impact of Exploitation:**

- **Denial of Service (DoS):** An attacker can cause the AMF to crash by establishing multiple SCTP connections, exceeding the maximum allocated resources and making the network unavailable.

**Attack Vectors:**

- The attacker establishes multiple SCTP connections to the AMF on different ports from the same IP address.

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to initiate SCTP connections to the AMF. This could be a malicious gNB, or an attacker spoofing gNB connections.
- The attacker needs to be able to control the source port numbers in the SCTP connections.
- Attacker needs to be able to send NG_Setup_Request messages after the SCTP connection is established.

**Additional Information:**

- The vulnerability affects Open5gs versions up to and including 2.4.10.
- The vendor pushed a commit which renamed the variables names from `gnb` to `peer`, but did not address the root cause of the vulnerability.