=== Content from github.com_843014ed_20250115_082529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fissues%2F152)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fissues%2F152)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=flatpressblog%2Fflatpress)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpressblog](/flatpressblog)
/
**[flatpress](/flatpressblog/flatpress)**
Public

* [Notifications](/login?return_to=%2Fflatpressblog%2Fflatpress) You must be signed in to change notification settings
* [Fork
  57](/login?return_to=%2Fflatpressblog%2Fflatpress)
* [Star
   188](/login?return_to=%2Fflatpressblog%2Fflatpress)

* [Code](/flatpressblog/flatpress)
* [Issues
  29](/flatpressblog/flatpress/issues)
* [Pull requests
  0](/flatpressblog/flatpress/pulls)
* [Actions](/flatpressblog/flatpress/actions)
* [Projects
  0](/flatpressblog/flatpress/projects)
* [Wiki](/flatpressblog/flatpress/wiki)
* [Security](/flatpressblog/flatpress/security)
* [Insights](/flatpressblog/flatpress/pulse)

Additional navigation options

* [Code](/flatpressblog/flatpress)
* [Issues](/flatpressblog/flatpress/issues)
* [Pull requests](/flatpressblog/flatpress/pulls)
* [Actions](/flatpressblog/flatpress/actions)
* [Projects](/flatpressblog/flatpress/projects)
* [Wiki](/flatpressblog/flatpress/wiki)
* [Security](/flatpressblog/flatpress/security)
* [Insights](/flatpressblog/flatpress/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fflatpressblog%2Fflatpress%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fflatpressblog%2Fflatpress%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Flatpress 1.2.1 - File upload bypass to RCE Vulnerebility #152

Closed

[s4n-h4xor](/s4n-h4xor) opened this issue
Sep 27, 2022
· 3 comments

Closed

# [Flatpress 1.2.1 - File upload bypass to RCE Vulnerebility](#top) #152

[s4n-h4xor](/s4n-h4xor) opened this issue
Sep 27, 2022
· 3 comments

## Comments

[![@s4n-h4xor](https://avatars.githubusercontent.com/u/72069722?s=80&v=4)](/s4n-h4xor)

Copy link

### **[s4n-h4xor](/s4n-h4xor)** commented [Sep 27, 2022](#issue-1387706093) • edited Loading

| **File upload bypass to RCE** **Severity:** High  **Description:** It is observed that the application has the functionality to upload images and download them further. The download functionality is not sandboxed, and it does not have proper security control which can be bypassed by tricking webserver and uploading dangerous file types which leads to RCE.  **Technical Impact:** A privileged attacker can use the upload functionality to gain access to the server  **Suggested Remediation:**   1. Restrict the file types accepted for upload, check the file extension, and only valid    extensions to upload. 2. Rename the files after getting uploaded randomly or use a hash.   **Steps to Reproduce:**   1. Login to the application   [1](https://user-images.githubusercontent.com/72069722/191999624-9b5a603a-1781-44bd-a914-49c5495700c3.png)   2. Navigate to the uploader section of the application.   [1](https://user-images.githubusercontent.com/72069722/192530190-04688a9c-7ea9-485c-91c5-ad766247d936.png)   3. Create a PHP file using the following payload.    Payload:    GIF89a;   [2](https://user-images.githubusercontent.com/72069722/192530231-9d65ccfa-d91b-4972-80b2-8a5361018888.png)   4. Upload created php file   [3](https://user-images.githubusercontent.com/72069722/192530254-41b7d349-cb5b-4df4-902a-cc2c82004829.png)   5. Navigate to file from media manager and open file   [4](https://user-images.githubusercontent.com/72069722/192530350-4595dc68-060e-4a93-bd0d-7915f5e1687b.png)   6. Append the following payload after file to give input commands and observe that commands    are getting executed    Payload: ?cmd=cat+/etc/passwd   [5](https://user-images.githubusercontent.com/72069722/192530914-cc69ff73-94f0-416e-a9dc-0bd70443e0a6.png)  [6](https://user-images.githubusercontent.com/72069722/192530425-e975a5af-fcd4-442b-b0d5-80b83022f84d.png)  *Opening issue here, Got no reply from hello@flatpress.org for 2 months* |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Fraenkiman](https://avatars.githubusercontent.com/u/50171344?s=80&u=5fb2eda9f96bb00a676e428cfde588b76f6220ed&v=4)](/Fraenkiman)

Copy link

Collaborator

### **[Fraenkiman](/Fraenkiman)** commented [Sep 28, 2022](#issuecomment-1260237214) • edited Loading

| Hello, everyone,  I unfortunately successfully reproduced the security issue on FlatPress fp-1.3.dev [master] and PHP version 7.4.30.  A possible solution could be to prevent the upload of php files via uploader. Unfortunately, my PHP knowledge is not sufficient for a possible solution.  So that PHP files in the attachs folder cannot be called directly, you can add an additional htaccess with the following rule for this folder as a temporary solution:  ``` <FilesMatch "\.(?i:php)$">   <IfModule !mod_authz_core.c>     Order allow,deny     Deny from all   </IfModule>   <IfModule mod_authz_core.c>     Require all denied   </IfModule> </FilesMatch>  ```  [\_htaccess.zip](https://github.com/flatpressblog/flatpress/files/9664152/_htaccess.zip)  This is then only valid for this folder. Tested with Apache/2.4.54  Best Regards |
| --- |

All reactions

Sorry, something went wrong.

[![@azett](https://avatars.githubusercontent.com/u/22837642?s=40&u=e3d38d4eac6846f1eb992919a44625f366364a46&v=4)](/azett)
[azett](/azett)
closed this as [completed](/flatpressblog/flatpress/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[92c0b2a](/flatpressblog/flatpress/commit/92c0b2a5178d5d7102a2fac85e8af0ba8940994f)`
[Oct 1, 2022](#event-7500272053)

[![@azett](https://avatars.githubusercontent.com/u/22837642?s=80&u=e3d38d4eac6846f1eb992919a44625f366364a46&v=4)](/azett)

Copy link

Member

### **[azett](/azett)** commented [Oct 1, 2022](#issuecomment-1264338156)

| Hi, thank you very much for reporting. FlatPress 1.2 didn't check uploaded files properly at all (even if the changelog said it did). [@Fraenkiman](https://github.com/Fraenkiman), could you please test this again?  Opening issue here, Got no reply from hello@flatpress.org for 2 months  Which I am ashamed of, totally missed this. Thank you very much for re-reporting here. |
| --- |

All reactions

Sorry, something went wrong.

[![@Fraenkiman](https://avatars.githubusercontent.com/u/50171344?s=40&u=5fb2eda9f96bb00a676e428cfde588b76f6220ed&v=4)](/Fraenkiman)
[Fraenkiman](/Fraenkiman)
mentioned this issue
[Oct 1, 2022](#ref-issue-1393439406)

[Forbidden file type prevents the upload of allowed file types
#154](/flatpressblog/flatpress/issues/154)

Open

[![@Fraenkiman](https://avatars.githubusercontent.com/u/50171344?s=80&u=5fb2eda9f96bb00a676e428cfde588b76f6220ed&v=4)](/Fraenkiman)

Copy link

Collaborator

### **[Fraenkiman](/Fraenkiman)** commented [Oct 1, 2022](#issuecomment-1264394905) • edited Loading

| Hello, everyone,  the bug fix for the issue was successfully tested in the following upload scenarios:  Single file: shell.php ;File was not placed in the attachs images directory as expected. ✔️ Single file: \*.zip; File was placed in the attachs directory as expected. ✔️ Single file: \*.rar; File was placed in the attachs directory as expected. ✔️ Single file: \*.png; File was placed in the images directory as expected. ✔️ Single file: \*.jpg; File was placed in the images directory as expected. ✔️ Single file: \*.gif; File was placed in the images directory as expected. ✔️  Mixed selection - only allowed file types; \*.png, \*.gif, \*.jpg, \*.zip, \*rar, \*.mp4 and \*.avi; Files were placed in the images and attachs directory as expected. ✔️  Mixed selection - allowed file types with forbidden file type; \*.png, \*.gif, \*.jpg, \*.php, \*.zip, \*rar, \*.mp4 and \*.avi; ;PHP file was not placed in the attachs images directory as expected. ✔️ However, the following was noticed: [#154](https://github.com/flatpressblog/flatpress/issues/154)  In my test, I was also able to successfully upload the \*.js file type. This file type could potentially be exploited for similar vulnerabilities.   * Is the behavior of the uploader as expected?   Conclusion: Bugfix request has been successfully tested on fp-1.3.dev [master]. I have created a [new issue](https://github.com/flatpressblog/flatpress/issues/154) to address the issue.  Best Regards Frank |
| --- |

All reactions

Sorry, something went wrong.

[![@WDavid404](https://avatars.githubusercontent.com/u/137129330?s=40&v=4)](/WDavid404)
[WDavid404](/WDavid404)
mentioned this issue
[Jul 29, 2024](#ref-issue-2433930050)

[Press （Intermediate, Linux, 2023）-- Flatpress 1.2.1
WDavid404/PG-Box#41](/WDavid404/PG-Box/issues/41)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fissues%2F152)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@azett](https://avatars.githubusercontent.com/u/22837642?s=52&v=4)](/azett) [![@Fraenkiman](https://avatars.githubusercontent.com/u/50171344?s=52&v=4)](/Fraenkiman) [![@s4n-h4xor](https://avatars.githubusercontent.com/u/72069722?s=52&v=4)](/s4n-h4xor)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


