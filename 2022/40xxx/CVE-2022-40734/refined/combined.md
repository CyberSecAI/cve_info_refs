=== Content from github.com_93055de7_20250115_115335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilicahd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilicahd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=64&v=4)

**silicahd**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilicahd)

[Overview](/silicahd)
[Repositories
3](/silicahd?tab=repositories)
[Projects
0](/silicahd?tab=projects)
[Packages
0](/silicahd?tab=packages)
[Stars
15](/silicahd?tab=stars)
[Sponsoring
0](/silicahd?tab=sponsoring)

More

* [Overview](/silicahd)
* [Repositories](/silicahd?tab=repositories)
* [Projects](/silicahd?tab=projects)
* [Packages](/silicahd?tab=packages)
* [Stars](/silicahd?tab=stars)
* [Sponsoring](/silicahd?tab=sponsoring)

![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=64&v=4)

**silicahd**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilicahd)

[![View silicahd's full-sized avatar](https://avatars.githubusercontent.com/u/7761519?v=4)](https://avatars.githubusercontent.com/u/7761519?v=4)

# Silica silicahd

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilicahd)

[0
followers](https://github.com/silicahd?tab=followers) · [1
following](https://github.com/silicahd?tab=following)

* Silica
* [silicahd.com](http://silicahd.com)

## [Achievements](/silicahd?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/silicahd?achievement=quickdraw&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/silicahd?achievement=public-sponsor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/silicahd?achievement=arctic-code-vault-contributor&tab=achievements)
## [Achievements](/silicahd?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/silicahd?achievement=quickdraw&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/silicahd?achievement=public-sponsor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/silicahd?achievement=arctic-code-vault-contributor&tab=achievements)

Block or Report

# Block or report silicahd

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=silicahd+%28user%29)

[Overview](/silicahd)
[Repositories
3](/silicahd?tab=repositories)
[Projects
0](/silicahd?tab=projects)
[Packages
0](/silicahd?tab=packages)
[Stars
15](/silicahd?tab=stars)
[Sponsoring
0](/silicahd?tab=sponsoring)

More

* [Overview](/silicahd)
* [Repositories](/silicahd?tab=repositories)
* [Projects](/silicahd?tab=projects)
* [Packages](/silicahd?tab=packages)
* [Stars](/silicahd?tab=stars)
* [Sponsoring](/silicahd?tab=sponsoring)

## Popular repositories Loading

1. [palmos](/silicahd/palmos) palmos
   Public

   Forked from [webosose/build-webos](/webosose/build-webos)

   palmOS OSE build layer

   Python
2. [EpicBuilder](/silicahd/EpicBuilder) EpicBuilder
   Public

   Forked from [TypiCMS/Base](/TypiCMS/Base)

   Multilingual CMS built with Laravel.

   PHP
3. [medrunUIUpWork](/silicahd/medrunUIUpWork) medrunUIUpWork
   Public

   Forked from [gochitashvili/medrun](/gochitashvili/medrun)

   Blade

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c0dbe5b9_20250115_115335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5m2h-7rf2-rpx6)

**CVE-2022-40734**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5m2h-7rf2-rpx6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-40734](/advisories/GHSA-5m2h-7rf2-rpx6)

## UniSharp Laravel Filemanager directory traversal vulnerability

Moderate severity

GitHub Reviewed

Published
Sep 15, 2022
to the GitHub Advisory Database
•
Updated Dec 7, 2023

[Vulnerability details](/advisories/GHSA-5m2h-7rf2-rpx6)
[Dependabot alerts
0](/advisories/GHSA-5m2h-7rf2-rpx6/dependabot)

## Package

composer

unisharp/laravel-filemanager
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

< 2.6.4

## Patched versions

2.6.4

## Description

UniSharp laravel-filemanager (aka Laravel Filemanager) with `league/flysystem` version `< 2.0.0` allows download?working\_dir=%2F.. directory traversal to read arbitrary files, as exploited in the wild in June 2022.

Since `v2.6.4`, UniSharp laravel-filemanager (aka Laravel Filemanager) requires users to install `league/flysystem` version `>= 2.0.0`.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-40734>
* [UniSharp/laravel-filemanager#1150](https://github.com/UniSharp/laravel-filemanager/issues/1150)
* [UniSharp/laravel-filemanager#1150 (comment)](https://github.com/UniSharp/laravel-filemanager/issues/1150#issuecomment-1320186966)
* [UniSharp/laravel-filemanager#1150 (comment)](https://github.com/UniSharp/laravel-filemanager/issues/1150#issuecomment-1825310417)
* [UniSharp/laravel-filemanager@8a357d0](https://github.com/UniSharp/laravel-filemanager/commit/8a357d02e8f54ddf130961c64ff2cfc1882bbfcf)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-40734)
Sep 14, 2022

Published to the GitHub Advisory Database
Sep 15, 2022

Reviewed
Sep 16, 2022

Last updated
Dec 7, 2023

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### [EPSS score](https://www.first.org/epss/user-guide)

5.992%
 (93rd percentile)

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### CVE ID

CVE-2022-40734

### GHSA ID

GHSA-5m2h-7rf2-rpx6

### Source code

[UniSharp/laravel-filemanager](https://github.com/UniSharp/laravel-filemanager)

### Credits

* [![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&v=4)](/streamtw)
  [streamtw](/streamtw)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-5m2h-7rf2-rpx6/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_48aa0dcc_20250114_195251.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=UniSharp%2Flaravel-filemanager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[UniSharp](/UniSharp)
/
**[laravel-filemanager](/UniSharp/laravel-filemanager)**
Public

* [Notifications](/login?return_to=%2FUniSharp%2Flaravel-filemanager) You must be signed in to change notification settings
* [Fork
  723](/login?return_to=%2FUniSharp%2Flaravel-filemanager)
* [Star
   2.1k](/login?return_to=%2FUniSharp%2Flaravel-filemanager)

* [Code](/UniSharp/laravel-filemanager)
* [Issues
  247](/UniSharp/laravel-filemanager/issues)
* [Pull requests
  21](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects
  0](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

Additional navigation options

* [Code](/UniSharp/laravel-filemanager)
* [Issues](/UniSharp/laravel-filemanager/issues)
* [Pull requests](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Directory traversal vulnerability (CVE-2022-40734) #1150

Closed

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Closed

# [Directory traversal vulnerability (CVE-2022-40734)](#top) #1150

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Labels
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

## Comments

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=80&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)

Copy link

### **[silicahd](/silicahd)** commented [Jun 22, 2022](#issue-1279489454)

| I do not use this package, but I seen this in our firewall blocked list. My guess is that there is some sort of vulnerability.  [image](https://user-images.githubusercontent.com/7761519/174942318-e389fa0a-dc43-4732-8b93-976ae2e87363.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
4
 attritionorg, dovidezra, JulienCauvin, and ORN-Fox reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 6, 2022](#issuecomment-1237988760)

| yes that is a security vulnerability. I found that during a pentest for a client and wanted to report this privately, but since the picture shows the attack the cat is out of the back anyway  POC with curl: curl "https://$DOMAIN/laravel-filemanager/download?working\_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd"  This will give you the file /etc/passwd on the server. All files which are readable by the user used to run the application can be read. This usually includes configuration files with passwords etc.  I want to request a CVE for this for proper tracking. Any objections to this by the maintainers? I'll wait a week until I request one. |
| --- |

All reactions

Sorry, something went wrong.

[![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=80&v=4)](/duyld2108)

Copy link

### **[duyld2108](/duyld2108)** commented [Sep 10, 2022](#issuecomment-1242645649)

| Just protected lfm routes with middleware [auth] until this issue fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 15, 2022](#issuecomment-1247612787)

| This was assigned [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734").  [@silicahd](https://github.com/silicahd): Can you please change the title to something like "Directory traversal vulnerability ([CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734"))"? |
| --- |

 👍
1
 silicahd reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=40&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)
[silicahd](/silicahd)
changed the title
~~Possible Attack and vulnerability~~
Directory traversal vulnerability (CVE-2022-40734)
[Sep 15, 2022](#event-7391631079)

[xabbuh](/xabbuh)
referenced
this issue
in Roave/SecurityAdvisories
[Sep 19, 2022](#ref-commit-b644f94)
[![@Ocramius](https://avatars.githubusercontent.com/u/154256?s=40&v=4)](/Ocramius)

`[Committing generated "composer.json" file as per "2022-09-16T17:14:39…](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85 "Committing generated \"composer.json\" file as per \"2022-09-16T17:14:39+00:00\"
Original commit: \"https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6\"")`
…

`[b644f94](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85)`

```
…+00:00"

Original commit: "[FriendsOfPHP/security-advisories@8b09a24](https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6)"
```

[![@attritionorg](https://avatars.githubusercontent.com/u/3095424?s=40&v=4)](/attritionorg)
[attritionorg](/attritionorg)
mentioned this issue
[Sep 26, 2022](#ref-issue-1385907512)

[Composer detected a directory traversal vulnerability
#1165](/UniSharp/laravel-filemanager/issues/1165)

Closed

[![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=80&v=4)](/jelmersdp)

Copy link

### **[jelmersdp](/jelmersdp)** commented [Oct 4, 2022](#issuecomment-1267097512) • edited Loading

| [@duyld2108](https://github.com/duyld2108) is it possible that this is already the case. If I look at the package [code](https://github.com/UniSharp/laravel-filemanager/blob/master/src/LaravelFilemanagerServiceProvider.php#L41)  I see that the auth middleware is already called. Are there any other specific lfm route that need to be include in the auth middleware? |
| --- |

 👀
1
 dovidezra reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[Jacotheron](/Jacotheron)
added a commit
to Jacotheron/laravel-filemanager
that referenced
this issue
[Nov 18, 2022](#ref-commit-3248ab4)
[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=40&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

`[attempt to fix the Issue: Directory traversal vulnerability (](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d "attempt to fix the Issue:  Directory traversal vulnerability (CVE-2022-40734) #1150. Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root")[CVE-2022…](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")`
…

`[3248ab4](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d)`

```
[…-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")) [UniSharp#1150](https://github.com/UniSharp/laravel-filemanager/issues/1150). Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root
```

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=80&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

Copy link

### **[Jacotheron](/Jacotheron)** commented [Nov 18, 2022](#issuecomment-1320186966) • edited Loading

| Having spent quite a bunch of time to get familiar with this issue (after I noticed no further releases to fix this issue), I am quite confident that this issue can be marked as resolved, and the releases no longer being marked as insucure.  When using any of the local filesystem drivers (managed by League\Flysystem) will be inspected and get the path normalized (luague/flysystem/src/WhitespacePathNormalizer.php - [WhitespacePathNormalizer.php](https://github.com/thephpleague/flysystem/blob/3.x/src/WhitespacePathNormalizer.php)). Inside this class, the method "normalizeRelativePath" will split the path up into its various sections (relative to the root for the laravel disk). This will then rebuild the path to never allow access to anything outside of this root. Should it find that the relative path wants to escape the root, it will throw a PathTraversalDetected exception. This existed for at least 3 years already  From my stacktrace, this happens when LFM determines whether the file exist, prior to fetching it to serve.  The way this is written is quite bulletproof, and other errors will be thrown if it detects possible ways one might try to fool it. I attempted this traversal on my own local server, throwing a bunch of the common directory traversal options (from [Directory Traversal Cheat Sheet](https://github.com/JahTheTrueGod/Directory-Traversal-Cheat-Sheet)) at it, and it blocked most, and the others failed as they were so wacky, PHP could not decode them into a path (the file does not exist, thus error 404).  I actually tried to make a pull-request with a bit of basic changes to fix this issue, but was unable to test it to confirm that it works as expected. My strategy was to simply use the PHP "realpath" function, where a relative path can be entered and it normalizes it into an absolute path; then ensure that the laravel disk root is above the normalized real path. For anyone wanting the code:  DownloadController -> getDownload method contents  ```        $file = $this->lfm->setName(request('file'));         $file_absolute = $file->path('absolute');          if (!Storage::disk($this->helper->config('disk'))->exists($file->path('storage'))) {             abort(404);         }           if(config('filesystems.disks.'.$this->helper->config('disk').'.driver') === 'local'){             $disk_root = realpath(config('filesystems.disks.'.$this->helper->config('disk').'.root'));             $file_real_path = realpath($file_absolute);             if(!Str::startsWith($file_real_path, $disk_root)){                 abort(404);             }         }          return response()->download($file_absolute);  ```  I was unable to get any request to pass the first "abort(404)", while attempting to go outside of the disk root.  As a conclusion, while this might have been an issue in the past, it has been solved (yes, it might not stop bots attempting to break in). While I would like these types of issues to be solved within the package that exposes it, the fact that is fixed by the underlying abstraction layer is good enough for me.  Just an edit: my tests is run with Laravel v9.40.1 (latest at time of writing), and PHP 8.1 |
| --- |

 ❤️
5
 JulienCauvin, ORN-Fox, schmeits, Jon78, and streamtw reacted with heart emoji

All reactions

* ❤️
  5 reactions

Sorry, something went wrong.

[![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=80&u=571b9344a882ef58dd9bb984382d3df38a92fcea&v=4)](/WhereIsLucas)

Copy link

### **[WhereIsLucas](/WhereIsLucas)** commented [Nov 30, 2022](#issuecomment-1332078409)

| So, should we consider this issue resolved and tag a new release ? |
| --- |

 👍
5
 schmeits, Jacotheron, marktan93, jesus6402, and streamtw reacted with thumbs up emoji
 ❤️
1
 jesus6402 reacted with heart emoji

All reactions

* 👍
  5 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=80&v=4)](/shankhadevpadam)

Copy link

### **[shankhadevpadam](/shankhadevpadam)** commented [Jan 23, 2023](#issuecomment-1399924171) • edited Loading

| Is this issue solved? |
| --- |

All reactions

Sorry, something went wrong.

[![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=80&u=1655a6ed08919b783a08fea9794652e7d5a05174&v=4)](/Romkabouter)

Copy link

### **[Romkabouter](/Romkabouter)** commented [Sep 8, 2023](#issuecomment-1712181172)

| bump |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 15, 2023](#issuecomment-1812163360) • edited Loading

| Thank you [@Jacotheron](https://github.com/Jacotheron) for your detailed elaboration! Looks like the issue will not exist if the version of `league\flysystem` is above `2.0.0`.  I am finding a way to resolve the CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 24, 2023](#issuecomment-1825310417)

| I have added dependency for `league/flysystem` in `composer.json`, and released `v2.6.4` of this package. If anyone installed this package with `v1.x` of `league/flysystem`, there will be a warning in the output of composer once they update this package to `v2.6.4`. |
| --- |

 👍
1
 Romkabouter reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
added
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.
labels
[Nov 24, 2023](#event-11054022999)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Dec 8, 2023](#issuecomment-1846488211)

| I have addressed the patched version`v2.6.4` of this CVE in the Github Advisory Database([GHSA-5m2h-7rf2-rpx6](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "GHSA-5m2h-7rf2-rpx6")).  I will still try to update information on other CVE websites. But I think it is fine to mark this issue as solved. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
closed this as [completed](/UniSharp/laravel-filemanager/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 8, 2023](#event-11189011044)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
removed
the
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
label
[Dec 11, 2023](#event-11205856810)

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011662647)

| [image](https://private-user-images.githubusercontent.com/44807635/315215206-81e13719-e1ad-42e0-b18f-a0faceec11d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTUyMDYtODFlMTM3MTktZTFhZC00MmUwLWIxOGYtYTBmYWNlZWMxMWQwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM4NTdiNDJiMDlmYTQ4NDAzY2UwYjhmNGNkZTYwNDBjNWRjY2NhODdlZDdiNWQ3MjEzNTFiYzRjYzNiYTI3MTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XQKn2SHd4I_zmPmH6gTf3TmSfz8sAizuiC9ez4gt91o) [image](https://private-user-images.githubusercontent.com/44807635/315217455-c19f4d02-3fac-4067-91e0-2e713a76dfb9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTc0NTUtYzE5ZjRkMDItM2ZhYy00MDY3LTkxZTAtMmU3MTNhNzZkZmI5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU1MmE3ZGY2NWQ1NTQzZjhkYjZmMGRlYWNhNDIzOGMwNTJkMWQ2NGM1MjdiZjc0YzA5YzliNzZlNDhmODRhMmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.M_y-yEjb8teDUALrmll6B-VO8RTJ9LS1i2yvQgLmSUg)  Does this vulnerability really exist? I can’t reproduce [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) my environment league/flysystem 1.1.10 laravel/framework 8.83.27 unisharp/laravel-filemanager:2.6.0  ``` GET /laravel/html/laravel-filemanager/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd HTTP/1.1 Host: localhost:82 Cache-Control: max-age=0 sec-ch-ua: "Chromium";v="91", " Not;A Brand";v="99" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8 Cookie: session=000573dc-ed50-4fc7-8243-5cb81b5c0b81.OzwBLib5YzCDnEDtAlSU7vizqY8; XSRF-TOKEN=eyJpdiI6IkM4WHZ5bTQ3QnV5Y1V1NUZTMmRlZEE9PSIsInZhbHVlIjoiZDhRSmFldWMybWROMGZiVit2dGxYMFNPNkhvRHcvUENXUFpHZzl2VG15NDRNY1hiMTNmV3NJYzBib0VjT2VkY29Ld2dpVlFiRVN5L1dLRjd1aU41U251Y0xtbWFuVTlxVE9keThleEhKZ1ZPdFR0TmwyTDhwM2oxc1RkcG5tenMiLCJtYWMiOiI0YTliZmUyZWY1ZGEzNDIzNmViMDNiZDFjOWUyZTVhMGNiZDFhMWI4ZjA0YmJlNWNiY2Q4YjY2ODc5MDhlMjc0IiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6IlVicnRPR1pJb2ZTaGV0NjBnM09OdEE9PSIsInZhbHVlIjoid3dHQXEyaS9mbTJVdEhFWEdib29LcGx5ZVA4cW1aZm9PbW1qRlFpdlNCUURYTkViM2piUjVNdWVSYUQyMXVSYjhnQjI4UFhLQ1ZnbkVEemkrT3YzK3dmcFcxYkdMeUhRRDg0NUtCTXpZOE1ZQTFpS2NCSk1zUHA5SmxYdXlWbWMiLCJtYWMiOiI0MDA5Yzk0ZTMzZGMzZDVkZTQ5YTgzN2Q5ZGZhNTQ0YzJlYjg5MmNmMTZlMjIzMzczNjYxYzAwY2Y1NTA0ZDk2IiwidGFnIjoiIn0%3D Connection: close    ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Mar 21, 2024](#issuecomment-2011688580)

| It existed at the time, but I don't have an environment to reproduce as I found this in a client environment |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011703257)

| [@sw0rd1ight](https://github.com/sw0rd1ight) in `v2.x` of `league/flysystem`, exception `PathTraversalDetected` is thrown. As for versions before `v2.x`, I do not know for sure it there is any other mechanism that prevents directory traversal. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011831496)

| [image](https://private-user-images.githubusercontent.com/44807635/315246377-212727d8-76f9-458a-b1a1-609faee4835c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyNDYzNzctMjEyNzI3ZDgtNzZmOS00NThhLWIxYTEtNjA5ZmFlZTQ4MzVjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgyYjY3NDk4NGY4MGY0NjkzYzEwNGIyNTdlODdlNzg5NzI4MjI3OWM5ZjhkMmRlNzk3YmU4ZTNiYzdlM2UyNjQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3gL_fDXa1r9QKz88g_FDUB_vI41Ns9fU98fFdtw19_4) According to the information I collected, this version seems to have vulnerabilities. Can you tell which version this is from the picture? [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011941905)

| [@sw0rd1ight](https://github.com/sw0rd1ight) The screenshot you provided looks like `v1.x` of this package. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2012486185)

| yes . I can reproduce this problem using unisharp/laravel-filemanager:1.8.0 [image](https://private-user-images.githubusercontent.com/44807635/315337800-937cfd67-9c53-4b2a-bc7a-3cd215db3fb1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUzMzc4MDAtOTM3Y2ZkNjctOWM1My00YjJhLWJjN2EtM2NkMjE1ZGIzZmIxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZlM2YzZjJmNzk3NDE1ZjAwODVmYjRiZjNhOGY1YjEzZWQxODNhNDkzMzZhOWI4NjlmNTAwYmU0Zjg3MmIyZWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.yxwC5BNYXdDCfGO1K9U18NKVBKykslyRPy-zQ6sli5c) laravel-filemanager: league/flysystem has not been introduced in 1.8.0.  ``` <?php namespace Unisharp\Laravelfilemanager\controllers;  /**  * Class DownloadController  * @package Unisharp\Laravelfilemanager\controllers  */ class DownloadController extends LfmController {     /**      * Download a file      *      * @return mixed      */     public function getDownload()     {         return response()->download(parent::getCurrentPath(request('file')));     } }   ```  Therefore, the scope of impact described by [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734") is not accurate. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 22, 2024](#issuecomment-2014534069)

| [@sw0rd1ight](https://github.com/sw0rd1ight) Thanks for your effort in reproducing this issue.  In my opinion, users who visit CVE pages may want to know the exact version that will not encounter the security issues. In that case, I need to report to CVE that versions greater than or equal to `v2.6.4` will do for sure (because `v2.6.4` requires user to install `v2.x` of `league/flysystem`).  Although some of the previous versions may not encounter this issue, since user can choose to install `v1.x` or `v2.x` versions of `league/flysystem`, it is more easy to avoid this issue just by updating this package to `v2.6.4` or newer versions. This is the reason why the current affected version range are marked in the CVE page.  Any suggestions? |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 28, 2024](#issuecomment-2025506101)

| [@streamtw](https://github.com/streamtw) ok.I have sent you a report to your email address streamtw.one@gmail.com |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

Assignees

No one assigned

Labels

[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

10 participants

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=52&v=4)](/Jacotheron) [![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=52&v=4)](/shankhadevpadam) [![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=52&v=4)](/Romkabouter) [![@johseg](https://avatars.githubusercontent.com/u/6318893?s=52&v=4)](/johseg) [![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=52&v=4)](/streamtw) [![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=52&v=4)](/silicahd) [![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=52&v=4)](/duyld2108) [![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=52&v=4)](/WhereIsLucas) [![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=52&v=4)](/sw0rd1ight) [![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=52&v=4)](/jelmersdp)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9bbd4c89_20250114_195252.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=UniSharp%2Flaravel-filemanager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[UniSharp](/UniSharp)
/
**[laravel-filemanager](/UniSharp/laravel-filemanager)**
Public

* [Notifications](/login?return_to=%2FUniSharp%2Flaravel-filemanager) You must be signed in to change notification settings
* [Fork
  723](/login?return_to=%2FUniSharp%2Flaravel-filemanager)
* [Star
   2.1k](/login?return_to=%2FUniSharp%2Flaravel-filemanager)

* [Code](/UniSharp/laravel-filemanager)
* [Issues
  247](/UniSharp/laravel-filemanager/issues)
* [Pull requests
  21](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects
  0](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

Additional navigation options

* [Code](/UniSharp/laravel-filemanager)
* [Issues](/UniSharp/laravel-filemanager/issues)
* [Pull requests](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Directory traversal vulnerability (CVE-2022-40734) #1150

Closed

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Closed

# [Directory traversal vulnerability (CVE-2022-40734)](#top) #1150

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Labels
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

## Comments

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=80&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)

Copy link

### **[silicahd](/silicahd)** commented [Jun 22, 2022](#issue-1279489454)

| I do not use this package, but I seen this in our firewall blocked list. My guess is that there is some sort of vulnerability.  [image](https://user-images.githubusercontent.com/7761519/174942318-e389fa0a-dc43-4732-8b93-976ae2e87363.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
4
 attritionorg, dovidezra, JulienCauvin, and ORN-Fox reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 6, 2022](#issuecomment-1237988760)

| yes that is a security vulnerability. I found that during a pentest for a client and wanted to report this privately, but since the picture shows the attack the cat is out of the back anyway  POC with curl: curl "https://$DOMAIN/laravel-filemanager/download?working\_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd"  This will give you the file /etc/passwd on the server. All files which are readable by the user used to run the application can be read. This usually includes configuration files with passwords etc.  I want to request a CVE for this for proper tracking. Any objections to this by the maintainers? I'll wait a week until I request one. |
| --- |

All reactions

Sorry, something went wrong.

[![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=80&v=4)](/duyld2108)

Copy link

### **[duyld2108](/duyld2108)** commented [Sep 10, 2022](#issuecomment-1242645649)

| Just protected lfm routes with middleware [auth] until this issue fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 15, 2022](#issuecomment-1247612787)

| This was assigned [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734").  [@silicahd](https://github.com/silicahd): Can you please change the title to something like "Directory traversal vulnerability ([CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734"))"? |
| --- |

 👍
1
 silicahd reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=40&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)
[silicahd](/silicahd)
changed the title
~~Possible Attack and vulnerability~~
Directory traversal vulnerability (CVE-2022-40734)
[Sep 15, 2022](#event-7391631079)

[xabbuh](/xabbuh)
referenced
this issue
in Roave/SecurityAdvisories
[Sep 19, 2022](#ref-commit-b644f94)
[![@Ocramius](https://avatars.githubusercontent.com/u/154256?s=40&v=4)](/Ocramius)

`[Committing generated "composer.json" file as per "2022-09-16T17:14:39…](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85 "Committing generated \"composer.json\" file as per \"2022-09-16T17:14:39+00:00\"
Original commit: \"https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6\"")`
…

`[b644f94](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85)`

```
…+00:00"

Original commit: "[FriendsOfPHP/security-advisories@8b09a24](https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6)"
```

[![@attritionorg](https://avatars.githubusercontent.com/u/3095424?s=40&v=4)](/attritionorg)
[attritionorg](/attritionorg)
mentioned this issue
[Sep 26, 2022](#ref-issue-1385907512)

[Composer detected a directory traversal vulnerability
#1165](/UniSharp/laravel-filemanager/issues/1165)

Closed

[![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=80&v=4)](/jelmersdp)

Copy link

### **[jelmersdp](/jelmersdp)** commented [Oct 4, 2022](#issuecomment-1267097512) • edited Loading

| [@duyld2108](https://github.com/duyld2108) is it possible that this is already the case. If I look at the package [code](https://github.com/UniSharp/laravel-filemanager/blob/master/src/LaravelFilemanagerServiceProvider.php#L41)  I see that the auth middleware is already called. Are there any other specific lfm route that need to be include in the auth middleware? |
| --- |

 👀
1
 dovidezra reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[Jacotheron](/Jacotheron)
added a commit
to Jacotheron/laravel-filemanager
that referenced
this issue
[Nov 18, 2022](#ref-commit-3248ab4)
[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=40&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

`[attempt to fix the Issue: Directory traversal vulnerability (](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d "attempt to fix the Issue:  Directory traversal vulnerability (CVE-2022-40734) #1150. Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root")[CVE-2022…](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")`
…

`[3248ab4](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d)`

```
[…-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")) [UniSharp#1150](https://github.com/UniSharp/laravel-filemanager/issues/1150). Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root
```

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=80&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

Copy link

### **[Jacotheron](/Jacotheron)** commented [Nov 18, 2022](#issuecomment-1320186966) • edited Loading

| Having spent quite a bunch of time to get familiar with this issue (after I noticed no further releases to fix this issue), I am quite confident that this issue can be marked as resolved, and the releases no longer being marked as insucure.  When using any of the local filesystem drivers (managed by League\Flysystem) will be inspected and get the path normalized (luague/flysystem/src/WhitespacePathNormalizer.php - [WhitespacePathNormalizer.php](https://github.com/thephpleague/flysystem/blob/3.x/src/WhitespacePathNormalizer.php)). Inside this class, the method "normalizeRelativePath" will split the path up into its various sections (relative to the root for the laravel disk). This will then rebuild the path to never allow access to anything outside of this root. Should it find that the relative path wants to escape the root, it will throw a PathTraversalDetected exception. This existed for at least 3 years already  From my stacktrace, this happens when LFM determines whether the file exist, prior to fetching it to serve.  The way this is written is quite bulletproof, and other errors will be thrown if it detects possible ways one might try to fool it. I attempted this traversal on my own local server, throwing a bunch of the common directory traversal options (from [Directory Traversal Cheat Sheet](https://github.com/JahTheTrueGod/Directory-Traversal-Cheat-Sheet)) at it, and it blocked most, and the others failed as they were so wacky, PHP could not decode them into a path (the file does not exist, thus error 404).  I actually tried to make a pull-request with a bit of basic changes to fix this issue, but was unable to test it to confirm that it works as expected. My strategy was to simply use the PHP "realpath" function, where a relative path can be entered and it normalizes it into an absolute path; then ensure that the laravel disk root is above the normalized real path. For anyone wanting the code:  DownloadController -> getDownload method contents  ```        $file = $this->lfm->setName(request('file'));         $file_absolute = $file->path('absolute');          if (!Storage::disk($this->helper->config('disk'))->exists($file->path('storage'))) {             abort(404);         }           if(config('filesystems.disks.'.$this->helper->config('disk').'.driver') === 'local'){             $disk_root = realpath(config('filesystems.disks.'.$this->helper->config('disk').'.root'));             $file_real_path = realpath($file_absolute);             if(!Str::startsWith($file_real_path, $disk_root)){                 abort(404);             }         }          return response()->download($file_absolute);  ```  I was unable to get any request to pass the first "abort(404)", while attempting to go outside of the disk root.  As a conclusion, while this might have been an issue in the past, it has been solved (yes, it might not stop bots attempting to break in). While I would like these types of issues to be solved within the package that exposes it, the fact that is fixed by the underlying abstraction layer is good enough for me.  Just an edit: my tests is run with Laravel v9.40.1 (latest at time of writing), and PHP 8.1 |
| --- |

 ❤️
5
 JulienCauvin, ORN-Fox, schmeits, Jon78, and streamtw reacted with heart emoji

All reactions

* ❤️
  5 reactions

Sorry, something went wrong.

[![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=80&u=571b9344a882ef58dd9bb984382d3df38a92fcea&v=4)](/WhereIsLucas)

Copy link

### **[WhereIsLucas](/WhereIsLucas)** commented [Nov 30, 2022](#issuecomment-1332078409)

| So, should we consider this issue resolved and tag a new release ? |
| --- |

 👍
5
 schmeits, Jacotheron, marktan93, jesus6402, and streamtw reacted with thumbs up emoji
 ❤️
1
 jesus6402 reacted with heart emoji

All reactions

* 👍
  5 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=80&v=4)](/shankhadevpadam)

Copy link

### **[shankhadevpadam](/shankhadevpadam)** commented [Jan 23, 2023](#issuecomment-1399924171) • edited Loading

| Is this issue solved? |
| --- |

All reactions

Sorry, something went wrong.

[![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=80&u=1655a6ed08919b783a08fea9794652e7d5a05174&v=4)](/Romkabouter)

Copy link

### **[Romkabouter](/Romkabouter)** commented [Sep 8, 2023](#issuecomment-1712181172)

| bump |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 15, 2023](#issuecomment-1812163360) • edited Loading

| Thank you [@Jacotheron](https://github.com/Jacotheron) for your detailed elaboration! Looks like the issue will not exist if the version of `league\flysystem` is above `2.0.0`.  I am finding a way to resolve the CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 24, 2023](#issuecomment-1825310417)

| I have added dependency for `league/flysystem` in `composer.json`, and released `v2.6.4` of this package. If anyone installed this package with `v1.x` of `league/flysystem`, there will be a warning in the output of composer once they update this package to `v2.6.4`. |
| --- |

 👍
1
 Romkabouter reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
added
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.
labels
[Nov 24, 2023](#event-11054022999)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Dec 8, 2023](#issuecomment-1846488211)

| I have addressed the patched version`v2.6.4` of this CVE in the Github Advisory Database([GHSA-5m2h-7rf2-rpx6](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "GHSA-5m2h-7rf2-rpx6")).  I will still try to update information on other CVE websites. But I think it is fine to mark this issue as solved. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
closed this as [completed](/UniSharp/laravel-filemanager/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 8, 2023](#event-11189011044)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
removed
the
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
label
[Dec 11, 2023](#event-11205856810)

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011662647)

| [image](https://private-user-images.githubusercontent.com/44807635/315215206-81e13719-e1ad-42e0-b18f-a0faceec11d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTUyMDYtODFlMTM3MTktZTFhZC00MmUwLWIxOGYtYTBmYWNlZWMxMWQwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM4NTdiNDJiMDlmYTQ4NDAzY2UwYjhmNGNkZTYwNDBjNWRjY2NhODdlZDdiNWQ3MjEzNTFiYzRjYzNiYTI3MTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XQKn2SHd4I_zmPmH6gTf3TmSfz8sAizuiC9ez4gt91o) [image](https://private-user-images.githubusercontent.com/44807635/315217455-c19f4d02-3fac-4067-91e0-2e713a76dfb9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTc0NTUtYzE5ZjRkMDItM2ZhYy00MDY3LTkxZTAtMmU3MTNhNzZkZmI5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU1MmE3ZGY2NWQ1NTQzZjhkYjZmMGRlYWNhNDIzOGMwNTJkMWQ2NGM1MjdiZjc0YzA5YzliNzZlNDhmODRhMmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.M_y-yEjb8teDUALrmll6B-VO8RTJ9LS1i2yvQgLmSUg)  Does this vulnerability really exist? I can’t reproduce [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) my environment league/flysystem 1.1.10 laravel/framework 8.83.27 unisharp/laravel-filemanager:2.6.0  ``` GET /laravel/html/laravel-filemanager/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd HTTP/1.1 Host: localhost:82 Cache-Control: max-age=0 sec-ch-ua: "Chromium";v="91", " Not;A Brand";v="99" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8 Cookie: session=000573dc-ed50-4fc7-8243-5cb81b5c0b81.OzwBLib5YzCDnEDtAlSU7vizqY8; XSRF-TOKEN=eyJpdiI6IkM4WHZ5bTQ3QnV5Y1V1NUZTMmRlZEE9PSIsInZhbHVlIjoiZDhRSmFldWMybWROMGZiVit2dGxYMFNPNkhvRHcvUENXUFpHZzl2VG15NDRNY1hiMTNmV3NJYzBib0VjT2VkY29Ld2dpVlFiRVN5L1dLRjd1aU41U251Y0xtbWFuVTlxVE9keThleEhKZ1ZPdFR0TmwyTDhwM2oxc1RkcG5tenMiLCJtYWMiOiI0YTliZmUyZWY1ZGEzNDIzNmViMDNiZDFjOWUyZTVhMGNiZDFhMWI4ZjA0YmJlNWNiY2Q4YjY2ODc5MDhlMjc0IiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6IlVicnRPR1pJb2ZTaGV0NjBnM09OdEE9PSIsInZhbHVlIjoid3dHQXEyaS9mbTJVdEhFWEdib29LcGx5ZVA4cW1aZm9PbW1qRlFpdlNCUURYTkViM2piUjVNdWVSYUQyMXVSYjhnQjI4UFhLQ1ZnbkVEemkrT3YzK3dmcFcxYkdMeUhRRDg0NUtCTXpZOE1ZQTFpS2NCSk1zUHA5SmxYdXlWbWMiLCJtYWMiOiI0MDA5Yzk0ZTMzZGMzZDVkZTQ5YTgzN2Q5ZGZhNTQ0YzJlYjg5MmNmMTZlMjIzMzczNjYxYzAwY2Y1NTA0ZDk2IiwidGFnIjoiIn0%3D Connection: close    ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Mar 21, 2024](#issuecomment-2011688580)

| It existed at the time, but I don't have an environment to reproduce as I found this in a client environment |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011703257)

| [@sw0rd1ight](https://github.com/sw0rd1ight) in `v2.x` of `league/flysystem`, exception `PathTraversalDetected` is thrown. As for versions before `v2.x`, I do not know for sure it there is any other mechanism that prevents directory traversal. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011831496)

| [image](https://private-user-images.githubusercontent.com/44807635/315246377-212727d8-76f9-458a-b1a1-609faee4835c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyNDYzNzctMjEyNzI3ZDgtNzZmOS00NThhLWIxYTEtNjA5ZmFlZTQ4MzVjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgyYjY3NDk4NGY4MGY0NjkzYzEwNGIyNTdlODdlNzg5NzI4MjI3OWM5ZjhkMmRlNzk3YmU4ZTNiYzdlM2UyNjQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.3gL_fDXa1r9QKz88g_FDUB_vI41Ns9fU98fFdtw19_4) According to the information I collected, this version seems to have vulnerabilities. Can you tell which version this is from the picture? [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011941905)

| [@sw0rd1ight](https://github.com/sw0rd1ight) The screenshot you provided looks like `v1.x` of this package. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2012486185)

| yes . I can reproduce this problem using unisharp/laravel-filemanager:1.8.0 [image](https://private-user-images.githubusercontent.com/44807635/315337800-937cfd67-9c53-4b2a-bc7a-3cd215db3fb1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4ODQ2NjgsIm5iZiI6MTczNjg4NDM2OCwicGF0aCI6Ii80NDgwNzYzNS8zMTUzMzc4MDAtOTM3Y2ZkNjctOWM1My00YjJhLWJjN2EtM2NkMjE1ZGIzZmIxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDE5NTI0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZlM2YzZjJmNzk3NDE1ZjAwODVmYjRiZjNhOGY1YjEzZWQxODNhNDkzMzZhOWI4NjlmNTAwYmU0Zjg3MmIyZWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.yxwC5BNYXdDCfGO1K9U18NKVBKykslyRPy-zQ6sli5c) laravel-filemanager: league/flysystem has not been introduced in 1.8.0.  ``` <?php namespace Unisharp\Laravelfilemanager\controllers;  /**  * Class DownloadController  * @package Unisharp\Laravelfilemanager\controllers  */ class DownloadController extends LfmController {     /**      * Download a file      *      * @return mixed      */     public function getDownload()     {         return response()->download(parent::getCurrentPath(request('file')));     } }   ```  Therefore, the scope of impact described by [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734") is not accurate. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 22, 2024](#issuecomment-2014534069)

| [@sw0rd1ight](https://github.com/sw0rd1ight) Thanks for your effort in reproducing this issue.  In my opinion, users who visit CVE pages may want to know the exact version that will not encounter the security issues. In that case, I need to report to CVE that versions greater than or equal to `v2.6.4` will do for sure (because `v2.6.4` requires user to install `v2.x` of `league/flysystem`).  Although some of the previous versions may not encounter this issue, since user can choose to install `v1.x` or `v2.x` versions of `league/flysystem`, it is more easy to avoid this issue just by updating this package to `v2.6.4` or newer versions. This is the reason why the current affected version range are marked in the CVE page.  Any suggestions? |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 28, 2024](#issuecomment-2025506101)

| [@streamtw](https://github.com/streamtw) ok.I have sent you a report to your email address streamtw.one@gmail.com |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

Assignees

No one assigned

Labels

[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

10 participants

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=52&v=4)](/Jacotheron) [![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=52&v=4)](/shankhadevpadam) [![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=52&v=4)](/Romkabouter) [![@johseg](https://avatars.githubusercontent.com/u/6318893?s=52&v=4)](/johseg) [![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=52&v=4)](/streamtw) [![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=52&v=4)](/silicahd) [![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=52&v=4)](/duyld2108) [![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=52&v=4)](/WhereIsLucas) [![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=52&v=4)](/sw0rd1ight) [![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=52&v=4)](/jelmersdp)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b50af328_20250115_115335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=UniSharp%2Flaravel-filemanager)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[UniSharp](/UniSharp)
/
**[laravel-filemanager](/UniSharp/laravel-filemanager)**
Public

* [Notifications](/login?return_to=%2FUniSharp%2Flaravel-filemanager) You must be signed in to change notification settings
* [Fork
  723](/login?return_to=%2FUniSharp%2Flaravel-filemanager)
* [Star
   2.1k](/login?return_to=%2FUniSharp%2Flaravel-filemanager)

* [Code](/UniSharp/laravel-filemanager)
* [Issues
  247](/UniSharp/laravel-filemanager/issues)
* [Pull requests
  21](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects
  0](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

Additional navigation options

* [Code](/UniSharp/laravel-filemanager)
* [Issues](/UniSharp/laravel-filemanager/issues)
* [Pull requests](/UniSharp/laravel-filemanager/pulls)
* [Discussions](/UniSharp/laravel-filemanager/discussions)
* [Actions](/UniSharp/laravel-filemanager/actions)
* [Projects](/UniSharp/laravel-filemanager/projects)
* [Wiki](/UniSharp/laravel-filemanager/wiki)
* [Security](/UniSharp/laravel-filemanager/security)
* [Insights](/UniSharp/laravel-filemanager/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FUniSharp%2Flaravel-filemanager%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Directory traversal vulnerability (CVE-2022-40734) #1150

Closed

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Closed

# [Directory traversal vulnerability (CVE-2022-40734)](#top) #1150

[silicahd](/silicahd) opened this issue
Jun 22, 2022
· 19 comments

Labels
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

## Comments

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=80&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)

Copy link

### **[silicahd](/silicahd)** commented [Jun 22, 2022](#issue-1279489454)

| I do not use this package, but I seen this in our firewall blocked list. My guess is that there is some sort of vulnerability.  [image](https://user-images.githubusercontent.com/7761519/174942318-e389fa0a-dc43-4732-8b93-976ae2e87363.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
4
 attritionorg, dovidezra, JulienCauvin, and ORN-Fox reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 6, 2022](#issuecomment-1237988760)

| yes that is a security vulnerability. I found that during a pentest for a client and wanted to report this privately, but since the picture shows the attack the cat is out of the back anyway  POC with curl: curl "https://$DOMAIN/laravel-filemanager/download?working\_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd"  This will give you the file /etc/passwd on the server. All files which are readable by the user used to run the application can be read. This usually includes configuration files with passwords etc.  I want to request a CVE for this for proper tracking. Any objections to this by the maintainers? I'll wait a week until I request one. |
| --- |

All reactions

Sorry, something went wrong.

[![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=80&v=4)](/duyld2108)

Copy link

### **[duyld2108](/duyld2108)** commented [Sep 10, 2022](#issuecomment-1242645649)

| Just protected lfm routes with middleware [auth] until this issue fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Sep 15, 2022](#issuecomment-1247612787)

| This was assigned [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734").  [@silicahd](https://github.com/silicahd): Can you please change the title to something like "Directory traversal vulnerability ([CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734"))"? |
| --- |

 👍
1
 silicahd reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=40&u=f71f2e77b422927d8293cce343424f8a208ef318&v=4)](/silicahd)
[silicahd](/silicahd)
changed the title
~~Possible Attack and vulnerability~~
Directory traversal vulnerability (CVE-2022-40734)
[Sep 15, 2022](#event-7391631079)

[xabbuh](/xabbuh)
referenced
this issue
in Roave/SecurityAdvisories
[Sep 19, 2022](#ref-commit-b644f94)
[![@Ocramius](https://avatars.githubusercontent.com/u/154256?s=40&v=4)](/Ocramius)

`[Committing generated "composer.json" file as per "2022-09-16T17:14:39…](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85 "Committing generated \"composer.json\" file as per \"2022-09-16T17:14:39+00:00\"
Original commit: \"https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6\"")`
…

`[b644f94](/Roave/SecurityAdvisories/commit/b644f940c47359724c8a9defc9046c59d252ed85)`

```
…+00:00"

Original commit: "[FriendsOfPHP/security-advisories@8b09a24](https://github.com/FriendsOfPHP/security-advisories/commit/8b09a2403ddee7e5cd8d614950d2cf73f6866cc6)"
```

[![@attritionorg](https://avatars.githubusercontent.com/u/3095424?s=40&v=4)](/attritionorg)
[attritionorg](/attritionorg)
mentioned this issue
[Sep 26, 2022](#ref-issue-1385907512)

[Composer detected a directory traversal vulnerability
#1165](/UniSharp/laravel-filemanager/issues/1165)

Closed

[![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=80&v=4)](/jelmersdp)

Copy link

### **[jelmersdp](/jelmersdp)** commented [Oct 4, 2022](#issuecomment-1267097512) • edited Loading

| [@duyld2108](https://github.com/duyld2108) is it possible that this is already the case. If I look at the package [code](https://github.com/UniSharp/laravel-filemanager/blob/master/src/LaravelFilemanagerServiceProvider.php#L41)  I see that the auth middleware is already called. Are there any other specific lfm route that need to be include in the auth middleware? |
| --- |

 👀
1
 dovidezra reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[Jacotheron](/Jacotheron)
added a commit
to Jacotheron/laravel-filemanager
that referenced
this issue
[Nov 18, 2022](#ref-commit-3248ab4)
[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=40&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

`[attempt to fix the Issue: Directory traversal vulnerability (](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d "attempt to fix the Issue:  Directory traversal vulnerability (CVE-2022-40734) #1150. Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root")[CVE-2022…](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")`
…

`[3248ab4](/Jacotheron/laravel-filemanager/commit/3248ab4f472ac86953961eb4a63a751aed6aa94d)`

```
[…-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734")) [UniSharp#1150](https://github.com/UniSharp/laravel-filemanager/issues/1150). Fix uses the php realpath function to evaluate the actual file path, and then ensure that the file being requested is below the local disk root
```

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=80&u=09654ea793de80505ba0c3972e8e59e583d717fc&v=4)](/Jacotheron)

Copy link

### **[Jacotheron](/Jacotheron)** commented [Nov 18, 2022](#issuecomment-1320186966) • edited Loading

| Having spent quite a bunch of time to get familiar with this issue (after I noticed no further releases to fix this issue), I am quite confident that this issue can be marked as resolved, and the releases no longer being marked as insucure.  When using any of the local filesystem drivers (managed by League\Flysystem) will be inspected and get the path normalized (luague/flysystem/src/WhitespacePathNormalizer.php - [WhitespacePathNormalizer.php](https://github.com/thephpleague/flysystem/blob/3.x/src/WhitespacePathNormalizer.php)). Inside this class, the method "normalizeRelativePath" will split the path up into its various sections (relative to the root for the laravel disk). This will then rebuild the path to never allow access to anything outside of this root. Should it find that the relative path wants to escape the root, it will throw a PathTraversalDetected exception. This existed for at least 3 years already  From my stacktrace, this happens when LFM determines whether the file exist, prior to fetching it to serve.  The way this is written is quite bulletproof, and other errors will be thrown if it detects possible ways one might try to fool it. I attempted this traversal on my own local server, throwing a bunch of the common directory traversal options (from [Directory Traversal Cheat Sheet](https://github.com/JahTheTrueGod/Directory-Traversal-Cheat-Sheet)) at it, and it blocked most, and the others failed as they were so wacky, PHP could not decode them into a path (the file does not exist, thus error 404).  I actually tried to make a pull-request with a bit of basic changes to fix this issue, but was unable to test it to confirm that it works as expected. My strategy was to simply use the PHP "realpath" function, where a relative path can be entered and it normalizes it into an absolute path; then ensure that the laravel disk root is above the normalized real path. For anyone wanting the code:  DownloadController -> getDownload method contents  ```        $file = $this->lfm->setName(request('file'));         $file_absolute = $file->path('absolute');          if (!Storage::disk($this->helper->config('disk'))->exists($file->path('storage'))) {             abort(404);         }           if(config('filesystems.disks.'.$this->helper->config('disk').'.driver') === 'local'){             $disk_root = realpath(config('filesystems.disks.'.$this->helper->config('disk').'.root'));             $file_real_path = realpath($file_absolute);             if(!Str::startsWith($file_real_path, $disk_root)){                 abort(404);             }         }          return response()->download($file_absolute);  ```  I was unable to get any request to pass the first "abort(404)", while attempting to go outside of the disk root.  As a conclusion, while this might have been an issue in the past, it has been solved (yes, it might not stop bots attempting to break in). While I would like these types of issues to be solved within the package that exposes it, the fact that is fixed by the underlying abstraction layer is good enough for me.  Just an edit: my tests is run with Laravel v9.40.1 (latest at time of writing), and PHP 8.1 |
| --- |

 ❤️
5
 JulienCauvin, ORN-Fox, schmeits, Jon78, and streamtw reacted with heart emoji

All reactions

* ❤️
  5 reactions

Sorry, something went wrong.

[![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=80&u=571b9344a882ef58dd9bb984382d3df38a92fcea&v=4)](/WhereIsLucas)

Copy link

### **[WhereIsLucas](/WhereIsLucas)** commented [Nov 30, 2022](#issuecomment-1332078409)

| So, should we consider this issue resolved and tag a new release ? |
| --- |

 👍
5
 schmeits, Jacotheron, marktan93, jesus6402, and streamtw reacted with thumbs up emoji
 ❤️
1
 jesus6402 reacted with heart emoji

All reactions

* 👍
  5 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=80&v=4)](/shankhadevpadam)

Copy link

### **[shankhadevpadam](/shankhadevpadam)** commented [Jan 23, 2023](#issuecomment-1399924171) • edited Loading

| Is this issue solved? |
| --- |

All reactions

Sorry, something went wrong.

[![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=80&u=1655a6ed08919b783a08fea9794652e7d5a05174&v=4)](/Romkabouter)

Copy link

### **[Romkabouter](/Romkabouter)** commented [Sep 8, 2023](#issuecomment-1712181172)

| bump |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 15, 2023](#issuecomment-1812163360) • edited Loading

| Thank you [@Jacotheron](https://github.com/Jacotheron) for your detailed elaboration! Looks like the issue will not exist if the version of `league\flysystem` is above `2.0.0`.  I am finding a way to resolve the CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Nov 24, 2023](#issuecomment-1825310417)

| I have added dependency for `league/flysystem` in `composer.json`, and released `v2.6.4` of this package. If anyone installed this package with `v1.x` of `league/flysystem`, there will be a warning in the output of composer once they update this package to `v2.6.4`. |
| --- |

 👍
1
 Romkabouter reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
added
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.
labels
[Nov 24, 2023](#event-11054022999)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Dec 8, 2023](#issuecomment-1846488211)

| I have addressed the patched version`v2.6.4` of this CVE in the Github Advisory Database([GHSA-5m2h-7rf2-rpx6](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "GHSA-5m2h-7rf2-rpx6")).  I will still try to update information on other CVE websites. But I think it is fine to mark this issue as solved. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
closed this as [completed](/UniSharp/laravel-filemanager/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 8, 2023](#event-11189011044)

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=40&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)
[streamtw](/streamtw)
removed
the
[WIP](/UniSharp/laravel-filemanager/labels/WIP)
Working in progress.
label
[Dec 11, 2023](#event-11205856810)

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011662647)

| [image](https://private-user-images.githubusercontent.com/44807635/315215206-81e13719-e1ad-42e0-b18f-a0faceec11d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5NDIzMDgsIm5iZiI6MTczNjk0MjAwOCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTUyMDYtODFlMTM3MTktZTFhZC00MmUwLWIxOGYtYTBmYWNlZWMxMWQwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDExNTMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcwNjBkOWNhNGZkYjc5ZWUzNWIzZmZkZmQ5N2M2ZjdhNjI5MmM1NWEyMjgwNjFjNTk1NzM3MjI4MWQ0NzM0NTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.nnqvt0YOhAMYKprzdAmF8RQZDn48moQIBr5OoYcGrm0) [image](https://private-user-images.githubusercontent.com/44807635/315217455-c19f4d02-3fac-4067-91e0-2e713a76dfb9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5NDIzMDgsIm5iZiI6MTczNjk0MjAwOCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyMTc0NTUtYzE5ZjRkMDItM2ZhYy00MDY3LTkxZTAtMmU3MTNhNzZkZmI5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDExNTMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQwODQ0NDIwZDAxNDBmOWQ2OTM5NjYxNTZjZTIyNmZmODdlMzY2NWUwNzQ2Mjk3MWQ2MTc4YzM5NjBjMGY5MTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.VUn4pqBcOgElUIVZwds8Eqe9IsGCbO04j6_vk85teZw)  Does this vulnerability really exist? I can’t reproduce [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) my environment league/flysystem 1.1.10 laravel/framework 8.83.27 unisharp/laravel-filemanager:2.6.0  ``` GET /laravel/html/laravel-filemanager/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd HTTP/1.1 Host: localhost:82 Cache-Control: max-age=0 sec-ch-ua: "Chromium";v="91", " Not;A Brand";v="99" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8 Cookie: session=000573dc-ed50-4fc7-8243-5cb81b5c0b81.OzwBLib5YzCDnEDtAlSU7vizqY8; XSRF-TOKEN=eyJpdiI6IkM4WHZ5bTQ3QnV5Y1V1NUZTMmRlZEE9PSIsInZhbHVlIjoiZDhRSmFldWMybWROMGZiVit2dGxYMFNPNkhvRHcvUENXUFpHZzl2VG15NDRNY1hiMTNmV3NJYzBib0VjT2VkY29Ld2dpVlFiRVN5L1dLRjd1aU41U251Y0xtbWFuVTlxVE9keThleEhKZ1ZPdFR0TmwyTDhwM2oxc1RkcG5tenMiLCJtYWMiOiI0YTliZmUyZWY1ZGEzNDIzNmViMDNiZDFjOWUyZTVhMGNiZDFhMWI4ZjA0YmJlNWNiY2Q4YjY2ODc5MDhlMjc0IiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6IlVicnRPR1pJb2ZTaGV0NjBnM09OdEE9PSIsInZhbHVlIjoid3dHQXEyaS9mbTJVdEhFWEdib29LcGx5ZVA4cW1aZm9PbW1qRlFpdlNCUURYTkViM2piUjVNdWVSYUQyMXVSYjhnQjI4UFhLQ1ZnbkVEemkrT3YzK3dmcFcxYkdMeUhRRDg0NUtCTXpZOE1ZQTFpS2NCSk1zUHA5SmxYdXlWbWMiLCJtYWMiOiI0MDA5Yzk0ZTMzZGMzZDVkZTQ5YTgzN2Q5ZGZhNTQ0YzJlYjg5MmNmMTZlMjIzMzczNjYxYzAwY2Y1NTA0ZDk2IiwidGFnIjoiIn0%3D Connection: close    ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@johseg](https://avatars.githubusercontent.com/u/6318893?s=80&v=4)](/johseg)

Copy link

### **[johseg](/johseg)** commented [Mar 21, 2024](#issuecomment-2011688580)

| It existed at the time, but I don't have an environment to reproduce as I found this in a client environment |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011703257)

| [@sw0rd1ight](https://github.com/sw0rd1ight) in `v2.x` of `league/flysystem`, exception `PathTraversalDetected` is thrown. As for versions before `v2.x`, I do not know for sure it there is any other mechanism that prevents directory traversal. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2011831496)

| [image](https://private-user-images.githubusercontent.com/44807635/315246377-212727d8-76f9-458a-b1a1-609faee4835c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5NDIzMDgsIm5iZiI6MTczNjk0MjAwOCwicGF0aCI6Ii80NDgwNzYzNS8zMTUyNDYzNzctMjEyNzI3ZDgtNzZmOS00NThhLWIxYTEtNjA5ZmFlZTQ4MzVjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDExNTMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWNmYjBkNzAyOTZmMzZiNTMyZGIyNGI1MzQ4OWYyODc3MjZjMjhlNTc1YTBhMWZkZTU5OWNhNzgxM2ZlZjE4ODQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.9-T2ZnoY8garBhakzTf2NsaleOYrod18-4YpT5dhv8k) According to the information I collected, this version seems to have vulnerabilities. Can you tell which version this is from the picture? [@johseg](https://github.com/johseg) [@streamtw](https://github.com/streamtw) |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 21, 2024](#issuecomment-2011941905)

| [@sw0rd1ight](https://github.com/sw0rd1ight) The screenshot you provided looks like `v1.x` of this package. |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 21, 2024](#issuecomment-2012486185)

| yes . I can reproduce this problem using unisharp/laravel-filemanager:1.8.0 [image](https://private-user-images.githubusercontent.com/44807635/315337800-937cfd67-9c53-4b2a-bc7a-3cd215db3fb1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5NDIzMDgsIm5iZiI6MTczNjk0MjAwOCwicGF0aCI6Ii80NDgwNzYzNS8zMTUzMzc4MDAtOTM3Y2ZkNjctOWM1My00YjJhLWJjN2EtM2NkMjE1ZGIzZmIxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDExNTMyOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIwOWMzZDQ1ZjJjZDM3YmZlOWVlOGFlMmNjOGFlMGNiMDBkMDA3ODFkMjY5MDBhYzY3ZTE1ZWE2ODUxY2E2MmMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XdwRprY1Qx1o9q3fapRS4BB0Y8-qSxqTJkZ4LcDhOnw) laravel-filemanager: league/flysystem has not been introduced in 1.8.0.  ``` <?php namespace Unisharp\Laravelfilemanager\controllers;  /**  * Class DownloadController  * @package Unisharp\Laravelfilemanager\controllers  */ class DownloadController extends LfmController {     /**      * Download a file      *      * @return mixed      */     public function getDownload()     {         return response()->download(parent::getCurrentPath(request('file')));     } }   ```  Therefore, the scope of impact described by [CVE-2022-40734](https://github.com/advisories/GHSA-5m2h-7rf2-rpx6 "CVE-2022-40734") is not accurate. |
| --- |

All reactions

Sorry, something went wrong.

[![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=80&u=c93a99c18fb0620b6a087f6e390236917c232f96&v=4)](/streamtw)

Copy link

Member

### **[streamtw](/streamtw)** commented [Mar 22, 2024](#issuecomment-2014534069)

| [@sw0rd1ight](https://github.com/sw0rd1ight) Thanks for your effort in reproducing this issue.  In my opinion, users who visit CVE pages may want to know the exact version that will not encounter the security issues. In that case, I need to report to CVE that versions greater than or equal to `v2.6.4` will do for sure (because `v2.6.4` requires user to install `v2.x` of `league/flysystem`).  Although some of the previous versions may not encounter this issue, since user can choose to install `v1.x` or `v2.x` versions of `league/flysystem`, it is more easy to avoid this issue just by updating this package to `v2.6.4` or newer versions. This is the reason why the current affected version range are marked in the CVE page.  Any suggestions? |
| --- |

All reactions

Sorry, something went wrong.

[![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=80&u=d504bf531b2ed387fafae9de43503413a8e7af6f&v=4)](/sw0rd1ight)

Copy link

### **[sw0rd1ight](/sw0rd1ight)** commented [Mar 28, 2024](#issuecomment-2025506101)

| [@streamtw](https://github.com/streamtw) ok.I have sent you a report to your email address streamtw.one@gmail.com |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FUniSharp%2Flaravel-filemanager%2Fissues%2F1150)

Assignees

No one assigned

Labels

[security](/UniSharp/laravel-filemanager/labels/security)
Exploits, attacks, dangerous leaks.

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

10 participants

[![@Jacotheron](https://avatars.githubusercontent.com/u/1516245?s=52&v=4)](/Jacotheron) [![@shankhadevpadam](https://avatars.githubusercontent.com/u/3838722?s=52&v=4)](/shankhadevpadam) [![@Romkabouter](https://avatars.githubusercontent.com/u/4774478?s=52&v=4)](/Romkabouter) [![@johseg](https://avatars.githubusercontent.com/u/6318893?s=52&v=4)](/johseg) [![@streamtw](https://avatars.githubusercontent.com/u/7333171?s=52&v=4)](/streamtw) [![@silicahd](https://avatars.githubusercontent.com/u/7761519?s=52&v=4)](/silicahd) [![@duyld2108](https://avatars.githubusercontent.com/u/9260564?s=52&v=4)](/duyld2108) [![@WhereIsLucas](https://avatars.githubusercontent.com/u/25830895?s=52&v=4)](/WhereIsLucas) [![@sw0rd1ight](https://avatars.githubusercontent.com/u/44807635?s=52&v=4)](/sw0rd1ight) [![@jelmersdp](https://avatars.githubusercontent.com/u/47385735?s=52&v=4)](/jelmersdp)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


