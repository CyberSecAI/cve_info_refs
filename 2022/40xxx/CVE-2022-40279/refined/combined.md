=== Content from github.com_d9b11c24_20250114_181908.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FTizenRT%2Fblob%2Ff8f776dd183246ad8890422c1ee5e8f33ab2aaaf%2Fexternal%2Fwpa_supplicant%2Fsrc%2Fl2_packet%2Fl2_packet_pcap.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FTizenRT%2Fblob%2Ff8f776dd183246ad8890422c1ee5e8f33ab2aaaf%2Fexternal%2Fwpa_supplicant%2Fsrc%2Fl2_packet%2Fl2_packet_pcap.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Samsung%2FTizenRT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Samsung](/Samsung)
/
**[TizenRT](/Samsung/TizenRT)**
Public

* [Notifications](/login?return_to=%2FSamsung%2FTizenRT) You must be signed in to change notification settings
* [Fork
  591](/login?return_to=%2FSamsung%2FTizenRT)
* [Star
   593](/login?return_to=%2FSamsung%2FTizenRT)

* [Code](/Samsung/TizenRT)
* [Issues
  37](/Samsung/TizenRT/issues)
* [Pull requests
  83](/Samsung/TizenRT/pulls)
* [Actions](/Samsung/TizenRT/actions)
* [Projects
  0](/Samsung/TizenRT/projects)
* [Wiki](/Samsung/TizenRT/wiki)
* [Security](/Samsung/TizenRT/security)
* [Insights](/Samsung/TizenRT/pulse)

Additional navigation options

* [Code](/Samsung/TizenRT)
* [Issues](/Samsung/TizenRT/issues)
* [Pull requests](/Samsung/TizenRT/pulls)
* [Actions](/Samsung/TizenRT/actions)
* [Projects](/Samsung/TizenRT/projects)
* [Wiki](/Samsung/TizenRT/wiki)
* [Security](/Samsung/TizenRT/security)
* [Insights](/Samsung/TizenRT/pulse)

## Files

 f8f776d
## Breadcrumbs

1. [TizenRT](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf)
2. /[external](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external)
3. /[wpa\_supplicant](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant)
4. /[src](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src)
5. /[l2\_packet](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src/l2_packet)
/
# l2\_packet\_pcap.c

Copy path Blame  Blame
## Latest commit

## History

[History](/Samsung/TizenRT/commits/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src/l2_packet/l2_packet_pcap.c)359 lines (312 loc) · 9.41 KB f8f776d
## Breadcrumbs

1. [TizenRT](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf)
2. /[external](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external)
3. /[wpa\_supplicant](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant)
4. /[src](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src)
5. /[l2\_packet](/Samsung/TizenRT/tree/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src/l2_packet)
/
# l2\_packet\_pcap.c

Top
## File metadata and controls

* Code
* Blame

359 lines (312 loc) · 9.41 KB[Raw](https://github.com/Samsung/TizenRT/raw/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src/l2_packet/l2_packet_pcap.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359/\* \* WPA Supplicant - Layer2 packet handling with libpcap/libdnet and WinPcap \* Copyright (c) 2003-2006, Jouni Malinen <j@w1.fi> \* \* This software may be distributed under the terms of the BSD license. \* See README for more details. \*/
#include "includes.h"#ifndef CONFIG\_NATIVE\_WINDOWS#include <sys/ioctl.h>#endif /\* CONFIG\_NATIVE\_WINDOWS \*/#include <pcap.h>#ifndef CONFIG\_WINPCAP#include <dnet.h>#endif /\* CONFIG\_WINPCAP \*/
#include "common.h"#include "eloop.h"#include "l2\_packet.h"
static const u8 pae\_group\_addr[ETH\_ALEN] = { 0x01, 0x80, 0xc2, 0x00, 0x00, 0x03 };
struct l2\_packet\_data { pcap\_t \*pcap;#ifdef CONFIG\_WINPCAP unsigned int num\_fast\_poll;#else /\* CONFIG\_WINPCAP \*/ eth\_t \*eth;#endif /\* CONFIG\_WINPCAP \*/ char ifname[100]; u8 own\_addr[ETH\_ALEN]; void (\*rx\_callback)(void \*ctx, const u8 \*src\_addr, const u8 \*buf, size\_t len); void \*rx\_callback\_ctx; int l2\_hdr; /\* whether to include layer 2 (Ethernet) header in calls \* to rx\_callback \*/};
int l2\_packet\_get\_own\_addr(struct l2\_packet\_data \*l2, u8 \*addr){ os\_memcpy(addr, l2->own\_addr, ETH\_ALEN); return 0;}
#ifndef CONFIG\_WINPCAPstatic int l2\_packet\_init\_libdnet(struct l2\_packet\_data \*l2){ eth\_addr\_t own\_addr;
 l2->eth = eth\_open(l2->ifname); if (!l2->eth) { wpa\_printf(MSG\_ERROR, "Failed to open interface '%s' - eth\_open: %s", l2->ifname, strerror(errno)); return -1; }
 if (eth\_get(l2->eth, &own\_addr) < 0) { wpa\_printf(MSG\_ERROR, "Failed to get own hw address from interface '%s' - eth\_get: %s", l2->ifname, strerror(errno)); eth\_close(l2->eth); l2->eth = NULL; return -1; } os\_memcpy(l2->own\_addr, own\_addr.data, ETH\_ALEN);
 return 0;}#endif /\* CONFIG\_WINPCAP \*/
int l2\_packet\_send(struct l2\_packet\_data \*l2, const u8 \*dst\_addr, u16 proto, const u8 \*buf, size\_t len){ int ret; struct l2\_ethhdr \*eth;
 if (l2 == NULL) { return -1; }
 if (l2->l2\_hdr) {#ifdef CONFIG\_WINPCAP ret = pcap\_sendpacket(l2->pcap, buf, len);#else /\* CONFIG\_WINPCAP \*/ ret = eth\_send(l2->eth, buf, len);#endif /\* CONFIG\_WINPCAP \*/ } else { size\_t mlen = sizeof(\*eth) + len; eth = os\_malloc(mlen); if (eth == NULL) { return -1; }
 os\_memcpy(eth->h\_dest, dst\_addr, ETH\_ALEN); os\_memcpy(eth->h\_source, l2->own\_addr, ETH\_ALEN); eth->h\_proto = htons(proto); os\_memcpy(eth + 1, buf, len);
#ifdef CONFIG\_WINPCAP ret = pcap\_sendpacket(l2->pcap, (u8 \*)eth, mlen);#else /\* CONFIG\_WINPCAP \*/ ret = eth\_send(l2->eth, (u8 \*)eth, mlen);#endif /\* CONFIG\_WINPCAP \*/
 os\_free(eth); }
 return ret;}
#ifndef CONFIG\_WINPCAPstatic void l2\_packet\_receive(int sock, void \*eloop\_ctx, void \*sock\_ctx){ struct l2\_packet\_data \*l2 = eloop\_ctx; pcap\_t \*pcap = sock\_ctx; struct pcap\_pkthdr hdr; const u\_char \*packet; struct l2\_ethhdr \*ethhdr; unsigned char \*buf; size\_t len;
 packet = pcap\_next(pcap, &hdr);
 if (packet == NULL || hdr.caplen < sizeof(\*ethhdr)) { return; }
 ethhdr = (struct l2\_ethhdr \*)packet; if (l2->l2\_hdr) { buf = (unsigned char \*)ethhdr; len = hdr.caplen; } else { buf = (unsigned char \*)(ethhdr + 1); len = hdr.caplen - sizeof(\*ethhdr); } l2->rx\_callback(l2->rx\_callback\_ctx, ethhdr->h\_source, buf, len);}#endif /\* CONFIG\_WINPCAP \*/
#ifdef CONFIG\_WINPCAPstatic void l2\_packet\_receive\_cb(u\_char \*user, const struct pcap\_pkthdr \*hdr, const u\_char \*pkt\_data){ struct l2\_packet\_data \*l2 = (struct l2\_packet\_data \*)user; struct l2\_ethhdr \*ethhdr; unsigned char \*buf; size\_t len;
 if (pkt\_data == NULL || hdr->caplen < sizeof(\*ethhdr)) { return; }
 ethhdr = (struct l2\_ethhdr \*)pkt\_data; if (l2->l2\_hdr) { buf = (unsigned char \*)ethhdr; len = hdr->caplen; } else { buf = (unsigned char \*)(ethhdr + 1); len = hdr->caplen - sizeof(\*ethhdr); } l2->rx\_callback(l2->rx\_callback\_ctx, ethhdr->h\_source, buf, len); /\* \* Use shorter poll interval for 3 seconds to reduce latency during key \* handshake. \*/ l2->num\_fast\_poll = 3 \* 50;}
static void l2\_packet\_receive\_timeout(void \*eloop\_ctx, void \*timeout\_ctx){ struct l2\_packet\_data \*l2 = eloop\_ctx; pcap\_t \*pcap = timeout\_ctx; int timeout;
 if (l2->num\_fast\_poll > 0) { timeout = 20000; l2->num\_fast\_poll--; } else { timeout = 100000; }
 /\* Register new timeout before calling l2\_packet\_receive() since \* receive handler may free this l2\_packet instance (which will \* cancel this timeout). \*/ eloop\_register\_timeout(0, timeout, l2\_packet\_receive\_timeout, l2, pcap); pcap\_dispatch(pcap, 10, l2\_packet\_receive\_cb, (u\_char \*)l2);}#endif /\* CONFIG\_WINPCAP \*/
static int l2\_packet\_init\_libpcap(struct l2\_packet\_data \*l2, unsigned short protocol){ bpf\_u\_int32 pcap\_maskp, pcap\_netp; char pcap\_filter[200], pcap\_err[PCAP\_ERRBUF\_SIZE]; struct bpf\_program pcap\_fp;
#ifdef CONFIG\_WINPCAP char ifname[128]; os\_snprintf(ifname, sizeof(ifname), "\\Device\\NPF\_%s", l2->ifname); pcap\_lookupnet(ifname, &pcap\_netp, &pcap\_maskp, pcap\_err); l2->pcap = pcap\_open\_live(ifname, 2500, 0, 10, pcap\_err); if (l2->pcap == NULL) { fprintf(stderr, "pcap\_open\_live: %s\n", pcap\_err); fprintf(stderr, "ifname='%s'\n", ifname); return -1; } if (pcap\_setnonblock(l2->pcap, 1, pcap\_err) < 0) { fprintf(stderr, "pcap\_setnonblock: %s\n", pcap\_geterr(l2->pcap)); }#else /\* CONFIG\_WINPCAP \*/ pcap\_lookupnet(l2->ifname, &pcap\_netp, &pcap\_maskp, pcap\_err); l2->pcap = pcap\_open\_live(l2->ifname, 2500, 0, 10, pcap\_err); if (l2->pcap == NULL) { fprintf(stderr, "pcap\_open\_live: %s\n", pcap\_err); fprintf(stderr, "ifname='%s'\n", l2->ifname); return -1; } if (pcap\_datalink(l2->pcap) != DLT\_EN10MB && pcap\_set\_datalink(l2->pcap, DLT\_EN10MB) < 0) { fprintf(stderr, "pcap\_set\_datalink(DLT\_EN10MB): %s\n", pcap\_geterr(l2->pcap)); return -1; }#endif /\* CONFIG\_WINPCAP \*/ os\_snprintf(pcap\_filter, sizeof(pcap\_filter), "not ether src " MACSTR " and " "( ether dst " MACSTR " or ether dst " MACSTR " ) and " "ether proto 0x%x", MAC2STR(l2->own\_addr), /\* do not receive own packets \*/ MAC2STR(l2->own\_addr), MAC2STR(pae\_group\_addr), protocol); if (pcap\_compile(l2->pcap, &pcap\_fp, pcap\_filter, 1, pcap\_netp) < 0) { fprintf(stderr, "pcap\_compile: %s\n", pcap\_geterr(l2->pcap)); return -1; }
 if (pcap\_setfilter(l2->pcap, &pcap\_fp) < 0) { fprintf(stderr, "pcap\_setfilter: %s\n", pcap\_geterr(l2->pcap)); return -1; }
 pcap\_freecode(&pcap\_fp);#ifdef BIOCIMMEDIATE /\* \* When libpcap uses BPF we must enable "immediate mode" to \* receive frames right away; otherwise the system may \* buffer them for us. \*/ { unsigned int on = 1; if (ioctl(pcap\_fileno(l2->pcap), BIOCIMMEDIATE, &on) < 0) { fprintf(stderr, "%s: cannot enable immediate mode on " "interface %s: %s\n", \_\_func\_\_, l2->ifname, strerror(errno)); /\* XXX should we fail? \*/ } }#endif /\* BIOCIMMEDIATE \*/
#ifdef CONFIG\_WINPCAP eloop\_register\_timeout(0, 100000, l2\_packet\_receive\_timeout, l2, l2->pcap);#else /\* CONFIG\_WINPCAP \*/ eloop\_register\_read\_sock(pcap\_get\_selectable\_fd(l2->pcap), l2\_packet\_receive, l2, l2->pcap);#endif /\* CONFIG\_WINPCAP \*/
 return 0;}
struct l2\_packet\_data \*l2\_packet\_init(const char \*ifname, const u8 \*own\_addr, unsigned short protocol, void (\*rx\_callback)(void \*ctx, const u8 \*src\_addr, const u8 \*buf, size\_t len), void \*rx\_callback\_ctx, int l2\_hdr){ struct l2\_packet\_data \*l2;
 l2 = os\_zalloc(sizeof(struct l2\_packet\_data)); if (l2 == NULL) { return NULL; } os\_strlcpy(l2->ifname, ifname, sizeof(l2->ifname)); l2->rx\_callback = rx\_callback; l2->rx\_callback\_ctx = rx\_callback\_ctx; l2->l2\_hdr = l2\_hdr;
#ifdef CONFIG\_WINPCAP if (own\_addr) { os\_memcpy(l2->own\_addr, own\_addr, ETH\_ALEN); }#else /\* CONFIG\_WINPCAP \*/ if (l2\_packet\_init\_libdnet(l2)) { return NULL; }#endif /\* CONFIG\_WINPCAP \*/
 if (l2\_packet\_init\_libpcap(l2, protocol)) {#ifndef CONFIG\_WINPCAP eth\_close(l2->eth);#endif /\* CONFIG\_WINPCAP \*/ os\_free(l2); return NULL; }
 return l2;}
void l2\_packet\_deinit(struct l2\_packet\_data \*l2){ if (l2 == NULL) { return; }
#ifdef CONFIG\_WINPCAP eloop\_cancel\_timeout(l2\_packet\_receive\_timeout, l2, l2->pcap);#else /\* CONFIG\_WINPCAP \*/ if (l2->eth) { eth\_close(l2->eth); } eloop\_unregister\_read\_sock(pcap\_get\_selectable\_fd(l2->pcap));#endif /\* CONFIG\_WINPCAP \*/ if (l2->pcap) { pcap\_close(l2->pcap); } os\_free(l2);}
int l2\_packet\_get\_ip\_addr(struct l2\_packet\_data \*l2, char \*buf, size\_t len){ pcap\_if\_t \*devs, \*dev; struct pcap\_addr \*addr; struct sockaddr\_in \*saddr; int found = 0; char err[PCAP\_ERRBUF\_SIZE + 1];
 if (pcap\_findalldevs(&devs, err) < 0) { wpa\_printf(MSG\_DEBUG, "pcap\_findalldevs: %s\n", err); return -1; }
 for (dev = devs; dev && !found; dev = dev->next) { if (os\_strcmp(dev->name, l2->ifname) != 0) { continue; }
 addr = dev->addresses; while (addr) { saddr = (struct sockaddr\_in \*)addr->addr; if (saddr && saddr->sin\_family == AF\_INET) { os\_strlcpy(buf, inet\_ntoa(saddr->sin\_addr), len); found = 1; break; } addr = addr->next; } }
 pcap\_freealldevs(devs);
 return found ? 0 : -1;}
void l2\_packet\_notify\_auth\_start(struct l2\_packet\_data \*l2){#ifdef CONFIG\_WINPCAP /\* \* Use shorter poll interval for 3 seconds to reduce latency during key \* handshake. \*/ l2->num\_fast\_poll = 3 \* 50; eloop\_cancel\_timeout(l2\_packet\_receive\_timeout, l2, l2->pcap); eloop\_register\_timeout(0, 10000, l2\_packet\_receive\_timeout, l2, l2->pcap);#endif /\* CONFIG\_WINPCAP \*/}
int l2\_packet\_set\_packet\_filter(struct l2\_packet\_data \*l2, enum l2\_packet\_filter\_type type){ return -1;}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9d203a6c_20250114_181909.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FTizenRT%2Fissues%2F5629)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FTizenRT%2Fissues%2F5629)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Samsung%2FTizenRT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Samsung](/Samsung)
/
**[TizenRT](/Samsung/TizenRT)**
Public

* [Notifications](/login?return_to=%2FSamsung%2FTizenRT) You must be signed in to change notification settings
* [Fork
  591](/login?return_to=%2FSamsung%2FTizenRT)
* [Star
   593](/login?return_to=%2FSamsung%2FTizenRT)

* [Code](/Samsung/TizenRT)
* [Issues
  37](/Samsung/TizenRT/issues)
* [Pull requests
  83](/Samsung/TizenRT/pulls)
* [Actions](/Samsung/TizenRT/actions)
* [Projects
  0](/Samsung/TizenRT/projects)
* [Wiki](/Samsung/TizenRT/wiki)
* [Security](/Samsung/TizenRT/security)
* [Insights](/Samsung/TizenRT/pulse)

Additional navigation options

* [Code](/Samsung/TizenRT)
* [Issues](/Samsung/TizenRT/issues)
* [Pull requests](/Samsung/TizenRT/pulls)
* [Actions](/Samsung/TizenRT/actions)
* [Projects](/Samsung/TizenRT/projects)
* [Wiki](/Samsung/TizenRT/wiki)
* [Security](/Samsung/TizenRT/security)
* [Insights](/Samsung/TizenRT/pulse)

# Security: Malfunction in function l2\_packet\_receive\_timeout() #5629

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Security: Malfunction in function l2\_packet\_receive\_timeout()](#top)#5629Copy linkAssignees [![j11591](https://avatars.githubusercontent.com/u/42333682?s=64&v=4)](/j11591)![@UVScan](https://avatars.githubusercontent.com/u/112676446?v=4&size=80)
## Description

![@UVScan](https://avatars.githubusercontent.com/u/112676446?v=4&size=48)[UVScan](https://github.com/UVScan)opened [on Sep 2, 2022](https://github.com/Samsung/TizenRT/issues/5629#issue-1359725709)
# Affected components

affected source code file: external/wpa\_supplicant/src/l2\_packet/l2\_packet\_pcap.c

# Attack vector(s)

Lacking a check for the return value of pcap\_dispatch.

pcap\_dispatch() returns the number of packets processed on success; this can be 0 if no packets were read from a live capture (if, for example, they were discarded because they didn't pass the packet filter, or if, on platforms that support a read timeout that starts before any packets arrive, the timeout expires before any packets arrive, or if the file descriptor for the capture device is in non-blocking mode and no packets were available to be read) or if no more packets are available in a ''savefile.'' It returns -1 if an error occurs or -2 if the loop terminated due to a call to pcap\_breakloop() before any packets were processed. If your application uses pcap\_breakloop(), make sure that you explicitly check for -1 and -2, rather than just checking for a return value < 0.

# Suggested description of the vulnerability for use in the CVE

Malfunction vulnerability in l2\_packet\_receive\_timeout() function in Samsung Electronics TizenRT latest version (and earlier) due to missing a check on the return value of pcap\_dispatch().

# Discoverer(s)/Credits

UVScan

# Reference(s)

<https://linux.die.net/man/3/pcap_dispatch>

[TizenRT/external/wpa\_supplicant/src/l2\_packet/l2\_packet\_pcap.c](https://github.com/Samsung/TizenRT/blob/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf/external/wpa_supplicant/src/l2_packet/l2_packet_pcap.c#L181)

Line 181
in
[f8f776d](/Samsung/TizenRT/commit/f8f776dd183246ad8890422c1ee5e8f33ab2aaaf)

|  | pcap\_dispatch(pcap, 10, l2\_packet\_receive\_cb, (u\_char \*)l2); |
| --- | --- |

## Metadata

### Assignees

* [![@j11591](https://avatars.githubusercontent.com/u/42333682?s=64&v=4)j11591](/j11591)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


