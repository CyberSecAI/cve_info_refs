- **Root cause of vulnerability:** A null pointer dereference occurs due to a logic error in how weak references are handled in Microsoft DirectComposition. Specifically, the status flag of a resource marshaler can be incorrectly set to indicate a weak reference exists when it does not, and the subsequent lookup for the weak reference fails, resulting in a NULL pointer dereference.
- **Weaknesses/vulnerabilities present:**
  - Incorrectly setting the status flag of a resource marshaler as having a weak reference when setting certain float properties via `DirectComposition::CResourceMarshaler::SetFloatProperty`.
  - Failure to handle a null return from `RtlLookupElementGenericTable` in `DirectComposition::CApplicationChannel::GetWeakReferenceBase` resulting in a null pointer dereference.
- **Impact of exploitation:** Exploitation leads to a system crash and denial of service (DoS). An unprivileged user can trigger a system reboot.
- **Attack vectors:**
  - An attacker must call a function that sets a float property with a specific type/ID (0x1 or 0x36) to a vulnerable resource marshaler.
  - Subsequently, another resource marshaler must create a weak reference to the target resource marshaler.
  - This can be achieved using methods like `DirectComposition::CAnimationLoggingManagerMarshaler::SetBufferProperty`, `DirectComposition::CVisualReferenceControllerMarshaler::SetVisual`, `DirectComposition::CBaseExpressionMarshaler::SetReferenceProperty`, or `DirectComposition::CExpressionMarshaler::SetReferenceArrayProperty`.
- **Required attacker capabilities/position:** An unprivileged user can execute specially crafted code to trigger the vulnerability. The attacker needs the ability to make specific syscalls to interact with the DirectComposition API.