=== Content from www.mozilla.org_f0a3d189_20250114_223454.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-42

## Security Vulnerabilities fixed in Thunderbird 102.3

Announced
September 20, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Thunderbird on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-3155: Attachment files saved to disk on macOS could be executed without warning](#CVE-2022-3155)

Reporter
Koh M. Nakagawa
Impact
low
##### Description

When saving or opening an email attachment on macOS, Thunderbird did not set attribute com.apple.quarantine on the received file. If the received file was an application and the user attempted to open it, then the application was started immediately without asking the user to confirm.

##### References

* [Bug 1789061](https://bugzilla.mozilla.org/show_bug.cgi?id=1789061)

#### [#CVE-2022-40962: Memory safety bugs fixed in Thunderbird 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2235af23_20250114_223451.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1770094)
* [XML](/show_bug.cgi?ctype=xml&id=1770094)

Closed
[Bug 1770094](/show_bug.cgi?id=1770094)
(CVE-2022-40956)

Opened 3 years ago
Closed 2 years ago

# XS-Leaks with CSP (base-uri) bypass by img tag.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

XS-Leaks with CSP (base-uri) bypass by img tag.

## Categories

### (Core :: DOM: Security, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

105 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix) |
| firefox-esr102 | [105+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=105%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox104 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=wontfix) |
| firefox105 | [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 |  | wontfix |
| firefox-esr102 | 105+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox104 |  | wontfix |
| firefox105 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: t.satoki111, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/f74146bada61d15a5e652919815bd355?d=mm&size=40)  [t.satoki111](/user_profile?user_id=706819)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")

Dependency [tree](/showdependencytree.cgi?id=1770094&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1770094)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, reporter-external, sec-low, Whiteboard: [domsecurity-backlog1] [adv-main105+][adv-esr102.3+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-40956

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-backlog1] [adv-main105+][adv-esr102.3+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a55526582_1689 "11 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c34 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files)

| [Information leaks to attack.example.com](/attachment.cgi?id=9277231)  [3 years ago](#c0)  [Satoki Tsuji](/user_profile?user_id=706819)   603 bytes, text/html |  | [Details](/attachment.cgi?id=9277231&action=edit) |
| --- | --- | --- |
| [leak1.png](/attachment.cgi?id=9277964)  [3 years ago](#c2)  [Satoki Tsuji](/user_profile?user_id=706819)   125.66 KB, image/png |  | [Details](/attachment.cgi?id=9277964&action=edit) |
| [leak2.png](/attachment.cgi?id=9277965)  [3 years ago](#c3)  [Satoki Tsuji](/user_profile?user_id=706819)   45.63 KB, image/png |  | [Details](/attachment.cgi?id=9277965&action=edit) |
| [log.txt](/attachment.cgi?id=9286602)  [2 years ago](#c8)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   22.77 KB, text/plain |  | [Details](/attachment.cgi?id=9286602&action=edit) |
| [Bug 1770094 r?emilio!,freddyb!](/attachment.cgi?id=9289658)  [2 years ago](#c15)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr102+](#c25 "2 years ago") | [Details](/attachment.cgi?id=9289658&action=edit) | [Review](/attachment.cgi?id=9289658) |
| [Bug 1770094 - Test. r?emilio!,freddyb!](/attachment.cgi?id=9289668)  [2 years ago](#c16)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9289668&action=edit) | [Review](/attachment.cgi?id=9289668) |
| [advisory.txt](/attachment.cgi?id=9294615)  [2 years ago](#c29)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   197 bytes, text/plain |  | [Details](/attachment.cgi?id=9294615&action=edit) |
| [image.png](/attachment.cgi?id=9295241)  [2 years ago](#c30)  [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815)   53.20 KB, image/png |  | [Details](/attachment.cgi?id=9295241&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1770094#c0)• 3 years ago |
|  | |

Attached file
[Information leaks to attack.example.com](attachment.cgi?id=9277231)
— [Details](attachment.cgi?id=9277231&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0

Steps to reproduce:

I have a Content-Security-Policy that restricts reading of the base tag to 'self'.

And checked if this restriction is effective by injecting HTML tags.

Actual results:

CSP appeared to have successfully prevented base tag injection.

However, from the img tag, it was confirmed that the request was sent to the URI specified in the base.

Only FireFox could get the secret path of a user's img tag by XS-Leaks.

The attached poc.html confirms the leakage of confidential information (uuid).

I am assuming an attack scenario where the profile URL is secret and the tag injection occurs on the top page.

Expected results:

A base tag blocked by CSP is invalid, and the img tag should issue a request to the original URI.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a123703_406194)• 3 years ago |

Group: firefox-core-security → dom-core-securityComponent: Untriaged → DOM: SecurityProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1770094#c1)• 3 years ago |
|  | |

The attached testcase works correctly for me -- the two links (the image and the navigation) are relative to our attachment domain and ignore the base setting. I see CSP errors for both. Were you running two test servers in the same file directory? Could you capture a HAR log in DevTools showing it doing the wrong thing?

Flags: needinfo?(t.satoki111)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1770094#c2)• 3 years ago |
|  | |

Attached image
[leak1.png](attachment.cgi?id=9277964)
— [Details](attachment.cgi?id=9277964&action=edit)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1770094#c3)• 3 years ago |
|  | |

Attached image
[leak2.png](attachment.cgi?id=9277965)
— [Details](attachment.cgi?id=9277965&action=edit)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1770094#c4)• 3 years ago |
|  | |

Thank you for verifying my report.

When you open the file you attached with "bmoattachments.org", other CSP settings (e.g. img-src) get in the way and disable base.

I would like you to try either temporarily saving it locally as a poc.html file or in an environment with CSP settings turned off except for base-uri.

I am attaching a screenshot of the actual screenshot I verified to show that I am not mistaken in my perception.

One is the same html that was submitted as a PoC on the site where the base-uri was specified.

leak1.png

The other is the server log to capture the request (requestbin).

leak2.png

Flags: needinfo?(t.satoki111)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1770094#c5)• 3 years ago |
|  | |

As far as I know, if `default-src 'none'` and `img-src 'none'` are valid, there is no problem.

However, if they are not, a GET request is sent to the URI specified in base, which is leak even if `base-uri 'none'` is set.

I have tried with the following CSP enabled, but it leaks.

```
base-uri 'none'; worker-src 'none'; connect-src 'none'; font-src 'none'; object-src 'none'; script-src 'none'; style-src 'none'; frame-src 'none'; frame-ancestors 'none'; form-action 'none'

```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a583411_1689)• 3 years ago |

Flags: needinfo?(dveditz)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1770094#c6)• 3 years ago |
|  | |

I'll take a look.

Flags: needinfo?(dveditz) → needinfo?(fbraun)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a2397755_406194)• 3 years ago |

Blocks: [xs-leaks](/show_bug.cgi?id=1742425 "NEW - [meta] XS-Leaks")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a3003592_1689)• 3 years ago |

Flags: needinfo?(dveditz)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1770094#c7)• 2 years ago |
|  | |

Need any additional information?

I want to create a CTF XS-Leaks problem using this behavior and am waiting for a fix.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1770094#c8)• 2 years ago |
|  | |

Attached file
[log.txt](attachment.cgi?id=9286602)
— [Details](attachment.cgi?id=9286602&action=edit)

I'm attaching some logs that I gathered by running firefox with `MOZ_LOG="CSPParser:5,CSPContext:5,CSMLog:5" firefox https://localhost:8000`.

It seems we are loading the image twice. I am quoting the most interesting bits here:

First, we parse the CSP and then do a `TYPE_INTERNAL_IMAGE_PRELOAD` of the URL at the domain *with* the injected base URL

```
#DebugDoContentSecurityCheck Begin
[Child 22315: Main Thread]: V/CSMLog doContentSecurityCheck:
[Child 22315: Main Thread]: V/CSMLog   processType: "webIsolated=http://localhost"
[Child 22315: Main Thread]: V/CSMLog   channelURI: "https://attack.example.com/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png"
[Child 22315: Main Thread]: V/CSMLog   httpMethod: GET
[Child 22315: Main Thread]: D/CSMLog   loadingPrincipal: "http://localhost:8000/poc.html"
[Child 22315: Main Thread]: D/CSMLog   triggeringPrincipal: "http://localhost:8000/poc.html"
[Child 22315: Main Thread]: D/CSMLog   principalToInherit: nullptr
[Child 22315: Main Thread]: V/CSMLog   redirectChain:
[Child 22315: Main Thread]: V/CSMLog   internalContentPolicyType: TYPE_INTERNAL_IMAGE_PRELOAD
[Child 22315: Main Thread]: V/CSMLog   externalContentPolicyType: TYPE_IMAGE
[Child 22315: Main Thread]: V/CSMLog   upgradeInsecureRequests: false
[Child 22315: Main Thread]: V/CSMLog   initialSecurityChecksDone: false
[Child 22315: Main Thread]: V/CSMLog   allowDeprecatedSystemRequests: false
[Child 22315: Main Thread]: D/CSMLog   CSP:
[Child 22315: Main Thread]: V/CSMLog   securityFlags:
[Child 22315: Main Thread]: V/CSMLog     - SEC_ALLOW_CROSS_ORIGIN_INHERITS_SEC_CONTEXT
[Child 22315: Main Thread]: V/CSMLog     - SEC_ALLOW_CHROME
[Child 22315: Main Thread]: V/CSMLog   httpsOnlyFirstStatus:
[Child 22315: Main Thread]: V/CSMLog     - HTTPS_ONLY_UNINITIALIZED
[Child 22315: Main Thread]: V/CSMLog     - HTTPS_ONLY_EXEMPT
[Child 22315: Main Thread]: D/CSMLog
#DebugDoContentSecurityCheck End

```

Then we ask the CSP if that location is allowed to be loaded - there is no CSP directive that disallows this:

```
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, aContentLocation: https://attack.example.com/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png
[Child 22315: Main Thread]: D/CSPContext >>>>                      aContentType: 38
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, decision: load, aContentLocation: https://attack.example.com/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, aContentLocation: https://attack.example.com/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png
[Child 22315: Main Thread]: D/CSPContext >>>>                      aContentType: 38
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, decision: load, aContentLocation: https://attack.example.com/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png

```

After that, we see just another image request, but with a different content policy type, `TYPE_INTERNAL_IMAGE`:

```
#DebugDoContentSecurityCheck Begin
[Child 22315: Main Thread]: V/CSMLog doContentSecurityCheck:
[Child 22315: Main Thread]: V/CSMLog   processType: "webIsolated=http://localhost"
[Child 22315: Main Thread]: V/CSMLog   channelURI: "http://localhost:8000/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png"
[Child 22315: Main Thread]: V/CSMLog   httpMethod: GET
[Child 22315: Main Thread]: D/CSMLog   loadingPrincipal: "http://localhost:8000/poc.html"
[Child 22315: Main Thread]: D/CSMLog   triggeringPrincipal: "http://localhost:8000/poc.html"
[Child 22315: Main Thread]: D/CSMLog   principalToInherit: nullptr
[Child 22315: Main Thread]: V/CSMLog   redirectChain:
[Child 22315: Main Thread]: V/CSMLog   internalContentPolicyType: TYPE_INTERNAL_IMAGE
[Child 22315: Main Thread]: V/CSMLog   externalContentPolicyType: TYPE_IMAGE
[Child 22315: Main Thread]: V/CSMLog   upgradeInsecureRequests: false
[Child 22315: Main Thread]: V/CSMLog   initialSecurityChecksDone: false
[Child 22315: Main Thread]: V/CSMLog   allowDeprecatedSystemRequests: false
[Child 22315: Main Thread]: D/CSMLog   CSP:
[Child 22315: Main Thread]: D/CSMLog   - "base-uri 'self'"
[Child 22315: Main Thread]: V/CSMLog   securityFlags:
[Child 22315: Main Thread]: V/CSMLog     - SEC_ALLOW_CROSS_ORIGIN_INHERITS_SEC_CONTEXT
[Child 22315: Main Thread]: V/CSMLog     - SEC_ALLOW_CHROME
[Child 22315: Main Thread]: V/CSMLog   httpsOnlyFirstStatus:
[Child 22315: Main Thread]: V/CSMLog     - HTTPS_ONLY_UNINITIALIZED
[Child 22315: Main Thread]: V/CSMLog     - HTTPS_ONLY_EXEMPT
[Child 22315: Main Thread]: D/CSMLog
#DebugDoContentSecurityCheck End
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, aContentLocation: http://localhost:8000/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png
[Child 22315: Main Thread]: D/CSPContext >>>>                      aContentType: 37
[Child 22315: Main Thread]: D/CSPContext nsCSPContext::ShouldLoad, decision: load, aContentLocation: http://localhost:8000/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png
[Child 22315: Main Thread]: D/CSMLog

```

Again, the CSP does not disallow the load.

**In summary, it seems that the image preloader is accepting the base tag without (or before) asking the CSP.**

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1770094#c9)• 2 years ago |
|  | |

Thank you for reporting this bug and please apologize the long wait.

I'm marking this as sec-low because this CSP bug does not lead to XSS and it assumes an injection in the page.

Please let us know when and where you intend to cover this in your CTF.

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1770094#c10)• 2 years ago |
|  | |

Thank you for your detailed understanding.

I do not think it is critical as it assumes HTML injection.

I decided it was a bit risky and reported it :)

The CTF will take place in November or January and we are thinking of XS-Leaks the secret profile page (protected by CSP).

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1770094#c11)• 2 years ago |
|  | |

Emilio, from looking at [`Document::ResolvePreloadImage`](https://searchfox.org/mozilla-central/rev/15b656909e77d3048d4652b894f79a8c719b4b86/dom/base/Document.cpp#12326-12366), it seems we never respected the base tag protection from CSP here.

When does the preloader logic kick in and does it know about the CSP?

Wondering what the right hooks should be..

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1770094#c12)• 2 years ago |
|  | |

Preloads are triggered by the speculative parser, so before the DOM is built from the meta element.

It seems we apply the CSP meta tag once it's added to the DOM which is too late: <https://searchfox.org/mozilla-central/rev/15b656909e77d3048d4652b894f79a8c719b4b86/dom/html/HTMLMetaElement.cpp#90-113>

However it seems the speculative parser does know about the CSP meta tag:

<https://searchfox.org/mozilla-central/rev/15b656909e77d3048d4652b894f79a8c719b4b86/parser/html/nsHtml5TreeOpExecutor.cpp#1330-1354>

So the question I guess is why the preload CSP is not applying.

Flags: needinfo?(emilio)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1770094#c13)• 2 years ago |
|  | |

Aha! Looking at [`BaseURIForPreload´](https://searchfox.org/mozilla-central/rev/15b656909e77d3048d4652b894f79a8c719b4b86/parser/html/nsHtml5TreeOpExecutor.cpp#1114-1126), it seems we just don't check the CSP.

We likely need a call into CSP like we have in [`SetBaseURIUsingFirstBaseWithHref`](https://searchfox.org/mozilla-central/rev/15b656909e77d3048d4652b894f79a8c719b4b86/dom/html/HTMLSharedElement.cpp#157-165).

@Tom Schuster: Maybe you can add this to your backlog, but it shouldn't have to block the other important stuff you're doing.

Severity: -- → S3Priority: -- → P3

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a5914660_363267)• 2 years ago |

Whiteboard: [domsecurity-backlog1]

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1770094#c14)• 2 years ago |
|  | |

Taking this, but I am currently still working on higher priority stuff.

Assignee: nobody → tschuster

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a6160735_703078)• 2 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1770094#c15)• 2 years ago |
|  | |

Attached file
[Bug 1770094 r?emilio!,freddyb!](attachment.cgi?id=9289658)
— [Details](attachment.cgi?id=9289658&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a7382964_600971)• 2 years ago |

[Attachment #9289658](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!") -
Attachment description: WIP: Bug 1770094 → Bug 1770094 r?emilio!,freddyb

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1770094#c16)• 2 years ago |
|  | |

Attached file
[Bug 1770094 - Test. r?emilio!,freddyb!](attachment.cgi?id=9289668)
— [Details](attachment.cgi?id=9289668&action=edit)

Depends on D154518

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a7384861_600971)• 2 years ago |

[Attachment #9289658](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!") -
Attachment description: Bug 1770094 r?emilio!,freddyb → Bug 1770094 r?emilio!,freddyb!

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1770094#c17)• 2 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/3849f10b51546b8d2e92ba4b1c6b088f625b6d64>

I just realized that this doesn't work when the CSP is delivered via the Content-Security-Policy header instead of the meta tag. Even though the comment in `nsHtml5TreeOpExecutor::AddSpeculationCSP` seemed to suggest the opposite to me.

Flags: needinfo?(dveditz)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a7623357_703078)• 2 years ago |

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1770094#c18)• 2 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/3849f10b51546b8d2e92ba4b1c6b088f625b6d64>

Backed out because the patch was incomplete: <https://hg.mozilla.org/integration/autoland/rev/c3fb0e962fae04391186a9a9cb658ec6072417be>

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a7633896_703078)• 2 years ago |

Flags: needinfo?(tschuster)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1770094#c19)• 2 years ago |
|  | |

r=freddyb,emilio

<https://hg.mozilla.org/integration/autoland/rev/cb68d36a743095c59719ccaac92370c9d60f2229>

<https://hg.mozilla.org/mozilla-central/rev/cb68d36a7430>

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1770094#c20)• 2 years ago |
|  | |

This is leave open to have another version of the test that uses a Content-Security-Policy header instead of meta tag. Sadly I don't think we can just set this header on the main test page?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1770094#c21)• 2 years ago |
|  | |

Why do `^headers^` files not work?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1770094#c22)• 2 years ago |
|  | |

> Why do ^headers^ files not work?

It does indeed work! Somehow I assumed it only works for other test files. I've updated the test. I am not quite sure what flags we usually use to remember checking in the security tests.

[status-firefox104](/buglist.cgi?f1=cf_status_firefox104&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox104&o1=equals&v1=wontfix)
[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed)
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=fixed)Flags: in-testsuite-Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)Version: Firefox 100 → Firefox 105

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a9023787_703078)• 2 years ago |

Status: ASSIGNED → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a9023844_703078)• 2 years ago |

Target Milestone: --- → 105 BranchVersion: Firefox 105 → unspecified

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1770094#c23)• 2 years ago |
|  | |

<https://groups.google.com/a/mozilla.org/g/dev-platform/c/QznyG9gzwYc/m/aGS52shgAAAJ> has a suggestion for how to be reminded to land the test later. Also, please request ESR102 approval on this when you get a chance.

Group: dom-core-security → core-security-release
[status-firefox106](/buglist.cgi?f1=cf_status_firefox106&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox106&o1=equals&v1=fixed) → ---
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=wontfix)
[tracking-firefox105](/buglist.cgi?f1=cf_tracking_firefox105&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox105&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [105+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=105%2B)Flags: needinfo?(tschuster)Flags: in-testsuite?Flags: in-testsuite-

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1770094#c24)• 2 years ago |
|  | |

Comment on [attachment 9289658](/attachment.cgi?id=9289658 "Bug 1770094 r?emilio!,freddyb!") [[details]](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!")

[Bug 1770094](/show_bug.cgi?id=1770094 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag.") r?emilio!,freddyb!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a simple patch that fixes an cross-site leak and CSP bypass that would be easy to recognize by looking at the already landed patch.
* **User impact if declined**:
* **Fix Landed on Version**: 105
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
Flags: needinfo?(tschuster)
[Attachment #9289658](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a9191341_703078)• 2 years ago |

[Attachment #9289668](/attachment.cgi?id=9289668&action=edit "Bug 1770094 - Test. r?emilio!,freddyb!") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a9191356_703078)• 2 years ago |

[Attachment #9289668](/attachment.cgi?id=9289668&action=edit "Bug 1770094 - Test. r?emilio!,freddyb!") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1770094#c25)• 2 years ago |
|  | |

Comment on [attachment 9289658](/attachment.cgi?id=9289658 "Bug 1770094 r?emilio!,freddyb!") [[details]](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!")

[Bug 1770094](/show_bug.cgi?id=1770094 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag.") r?emilio!,freddyb!

Approved for 102.3esr.

[Attachment #9289658](/attachment.cgi?id=9289658&action=edit "Bug 1770094 r?emilio!,freddyb!") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1770094#c26)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/7b43b4ab4275>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1770094#c27)• 2 years ago |
|  | |

I have the utmost respect for your excellent work and obsession with safety.

Thank you very much.

By the way, can a CVE or something be assigned to this issue?

I want to use it when explaining to others :)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1770094#c28)• 2 years ago |
|  | |

We usually decide over CVE assignment when the fix is available in Firefox release. This bug is tracking 105, which means that it will become available to our release population starting Tuesday, September 20th.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a10213805_703078)• 2 years ago |

Whiteboard: [domsecurity-backlog1] → [domsecurity-backlog1] [reminder-test 2022-10-18]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a10224182_428608)• 2 years ago |

Whiteboard: [domsecurity-backlog1] [reminder-test 2022-10-18] → [domsecurity-backlog1] [reminder-test 2022-10-18][adv-main105+][adv-esr102.3+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1770094#c29)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9294615)
— [Details](attachment.cgi?id=9294615&action=edit)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a10635671_553429)• 2 years ago |

Flags: qe-verify+Whiteboard: [domsecurity-backlog1] [reminder-test 2022-10-18][adv-main105+][adv-esr102.3+] → [domsecurity-backlog1] [reminder-test 2022-10-18][adv-main105+][adv-esr102.3+][post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a10640319_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1770094#c30)• 2 years ago |
|  | |

Attached image
[image.png](attachment.cgi?id=9295241)
— [Details](attachment.cgi?id=9295241&action=edit)

Hello! I tried verifying this issue today but I'm not sure if the following results are correct:

On Windows 10x64 with the affected build 102.0a1 (20220518214245) when loading the attached poc.html file on an HTTP local server, I see a second request for the .png file that has `attack.example.com` domain in the Network tab.

On fixed builds Firefox 105.0 (20220915150737) and Firefox 102.3.0esr (20220912135840) I can no longer see the `attack.example.com` request when loading the attached poc.html. This was tested on Windows 10x64, macOS 11 and Ubuntu 21.

I have attached a screenshot with my results for a better understanding. Note that I have also added a random .png file inside the server path `(http://127.0.0.1:8080/profile/img/b0190b16-41fb-9059-a680-9e5b47f24ce5.png)`. Is this verification correct or do I need to follow other steps in order to verify this issue? If so can you please provide if possible another set of steps? Thank you in advance!

Flags: needinfo?(tschuster)

|  | [Satoki Tsuji](/user_profile?user_id=706819)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1770094#c31)• 2 years ago |
|  | |

Thanks for the confirmation.

As you can see in your image, 105.0 does not request attack.example.com, so the security risk I reported has been fixed.

Many sites these days have user profiles created by UUID (and secret URLs).

This eliminates the risk of leaking paths that should be kept secret by the user.

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1770094#c32)• 2 years ago |
|  | |

(In reply to Satoki Tsuji from [comment #31](/show_bug.cgi?id=1770094#c31 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag."))

> Thanks for the confirmation.
>
> As you can see in your image, 105.0 does not request attack.example.com, so the security risk I reported has been fixed.
>
> Many sites these days have user profiles created by UUID (and secret URLs).
>
> This eliminates the risk of leaking paths that should be kept secret by the user.

Thank you as well for the confirmation and explanation.

I am closing this issue as verified fixed based on [comment 30](/show_bug.cgi?id=1770094#c30 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag.") and [comment 31](/show_bug.cgi?id=1770094#c31 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag."). Removing the ni? request as well.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox105](/buglist.cgi?f1=cf_status_firefox105&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox105&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(tschuster)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a10668281_428608)• 2 years ago |

Alias: CVE-2022-40956

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1770094#c33)• 2 years ago |
|  | |

Thanks Satoki Tsuji for your confirmation.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a15226173_703078)• 2 years ago |

Flags: needinfo?(tschuster)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1770094#c34)• 2 years ago |
|  | |

[Bug 1770094](/show_bug.cgi?id=1770094 "VERIFIED FIXED - XS-Leaks with CSP (base-uri) bypass by img tag.") - Test. r=emilio,freddyb

<https://hg.mozilla.org/mozilla-central/rev/41cb792ce9e9>

Flags: needinfo?(tschuster)Flags: in-testsuite?Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a20999600_1689)• 2 years ago |

Group: core-security-release

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1770094#c35)• 2 years ago |
|  | |

4 months ago, Tom Schuster (MoCo) placed a reminder on the bug using the whiteboard tag `[reminder-test 2022-10-18]` .

tschuster, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(tschuster)Whiteboard: [domsecurity-backlog1] [reminder-test 2022-10-18][adv-main105+][adv-esr102.3+][post-critsmash-triage] → [domsecurity-backlog1] [adv-main105+][adv-esr102.3+][post-critsmash-triage]

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a21274403_703078)• 2 years ago |

Flags: needinfo?(tschuster)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a55519711_578488)• 11 months ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a55526582_1689)• 11 months ago |

Flags: sec-bounty? → sec-bounty+Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1770094#a64160310_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1770094&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Satoki Tsuji](/user_profile?user_id=706819)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_65e15361_20250114_223453.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-41

## Security Vulnerabilities fixed in Firefox ESR 102.3

Announced
September 20, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.3

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Firefox on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-40962: Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 104 and Firefox ESR 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_3921f6bb_20250114_223453.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-40

## Security Vulnerabilities fixed in Firefox 105

Announced
September 20, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 105

This advisory was updated December 13, 2022 to add CVE-2022-46880. This fix was included in the original release of Firefox 105, but did not appear in the advisory published at that time.

#### [#CVE-2022-3266: Out of bounds read when decoding H264](#CVE-2022-3266)

Reporter
Willy R. Vasquez at UT Austin
Impact
high
##### Description

An out-of-bounds read can occur when decoding H264 video. This results in a potentially exploitable crash.

##### References

* [Bug 1767360](https://bugzilla.mozilla.org/show_bug.cgi?id=1767360)

#### [#CVE-2022-40959: Bypassing FeaturePolicy restrictions on transient pages](#CVE-2022-40959)

Reporter
Armin Ebert
Impact
high
##### Description

During iframe navigation, certain pages did not have their FeaturePolicy fully initialized leading to a bypass that leaked device permissions into untrusted subdocuments.

##### References

* [Bug 1782211](https://bugzilla.mozilla.org/show_bug.cgi?id=1782211)

#### [#CVE-2022-40960: Data-race when parsing non-UTF-8 URLs in threads](#CVE-2022-40960)

Reporter
Armin Ebert
Impact
high
##### Description

Concurrent use of the URL parser with non-UTF-8 data was not thread-safe. This could lead to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1787633](https://bugzilla.mozilla.org/show_bug.cgi?id=1787633)

#### [#CVE-2022-46880: Use-after-free in WebGL](#CVE-2022-46880)

Reporter
Atte Kettunen
Impact
high
##### Description

A missing check related to tex units could have led to a use-after-free and potentially exploitable crash.
*Note*: This advisory was added on December 13th, 2022 after we better understood the impact of the issue. The fix was included in the original release of Firefox 105.

##### References

* [Bug 1749292](https://bugzilla.mozilla.org/show_bug.cgi?id=1749292)

#### [#CVE-2022-40958: Bypassing Secure Context restriction for cookies with \_\_Host and \_\_Secure prefix](#CVE-2022-40958)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

By injecting a cookie with certain special characters, an attacker on a shared subdomain which is not a secure context could set and thus overwrite cookies from a secure context, leading to session fixation and other attacks.

##### References

* [Bug 1779993](https://bugzilla.mozilla.org/show_bug.cgi?id=1779993)

#### [#CVE-2022-40961: Stack-buffer overflow when initializing Graphics](#CVE-2022-40961)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

During startup, a graphics driver with an unexpected name could lead to a stack-buffer overflow causing a potentially exploitable crash.
*This issue only affects Firefox for Android. Other operating systems are not affected.*

##### References

* [Bug 1784588](https://bugzilla.mozilla.org/show_bug.cgi?id=1784588)

#### [#CVE-2022-40956: Content-Security-Policy base-uri bypass](#CVE-2022-40956)

Reporter
Satoki Tsuji
Impact
low
##### Description

When injecting an HTML base element, some requests would ignore the CSP's base-uri settings and accept the injected element's base instead.

##### References

* [Bug 1770094](https://bugzilla.mozilla.org/show_bug.cgi?id=1770094)

#### [#CVE-2022-40957: Incoherent instruction cache when building WASM on ARM64](#CVE-2022-40957)

Reporter
Gary Kwong
Impact
low
##### Description

Inconsistent data in instruction and data cache when creating wasm code could lead to a potentially exploitable crash.
*This bug only affects Firefox on ARM64 platforms.*

##### References

* [Bug 1777604](https://bugzilla.mozilla.org/show_bug.cgi?id=1777604)

#### [#CVE-2022-40962: Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](#CVE-2022-40962)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Nika Layzell, Timothy Nikkel, Sebastian Hengst, Andreas Pehrson, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 104 and Firefox ESR 102.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 105 and Firefox ESR 102.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1776655%2C1777574%2C1784835%2C1785109%2C1786502%2C1789440)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


