- **Root cause of vulnerability:** A use-after-free vulnerability exists in Foxit Reader's JavaScript engine due to improper handling of Optional Content Group (layer) objects during document close and page close actions. The `closeDoc` call frees the memory associated with an OCG object. Subsequently, a page close action attempts to access the freed memory.
- **Weaknesses/vulnerabilities present:** Use-after-free. The vulnerability is triggered due to out-of-sync execution of document close and page close actions, leading to the use of freed memory.
- **Impact of exploitation:** Arbitrary code execution. The vulnerability can be exploited for control-flow hijacking. By manipulating the memory layout, the attacker can gain control of the execution flow, leading to arbitrary code execution.
- **Attack vectors:** A specially crafted PDF document or a malicious website (if the browser plugin is enabled). The user needs to open the malicious file or visit a malicious site with the vulnerable plugin enabled.
- **Required attacker capabilities/position:** The attacker needs to create a malicious PDF document with specific JavaScript code to trigger the vulnerability. The attacker also needs to trick the user into opening the malicious PDF document. The attacker could also host the malicious PDF on a website, which would be exploitable if the vulnerable PDF plugin is active.