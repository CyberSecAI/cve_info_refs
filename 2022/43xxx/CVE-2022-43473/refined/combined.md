=== Content from www.talosintelligence.com_1caf12a3_20250115_101128.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2022-1685

## ManageEngine OpManager Add UCS Device blind XXE vulnerability

##### March 30, 2023

##### CVE Number

CVE-2022-43473

##### SUMMARY

A blind XML External Entity (XXE) vulnerability exists in the Add UCS Device functionality of ManageEngine OpManager 12.6.168. A specially crafted XML file can lead to SSRF. An attacker can serve
a malicious XML payload to trigger this vulnerability.

##### CONFIRMED VULNERABLE VERSIONS

The versions below were either tested or verified to be vulnerable by Talos or confirmed to be vulnerable by the vendor.

ManageEngine OpManager 12.6.168

##### PRODUCT URLS

OpManager - <https://www.manageengine.com/network-monitoring/>

##### CVSSv3 SCORE

5.8 - CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L

##### CWE

CWE-611 - Improper Restriction of XML External Entity Reference (‘XXE’)

##### DETAILS

OpManager is a network management solution that gathers hardware and software information of computers and other devices on a computer network for management, compliance and audit purposes.

An exploitable XML External Entity (XXE) injection vulnerability is related with an action: `Devices -> Add UCS`.
That action triggers a call to API as follows:

```
REQUEST

POST /client/api/json/discovery/addDevice HTTP/1.1
Host: 192.168.0.11:8060
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: */*
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-ZCSRF-TOKEN: opmcsrftoken=8c3015c780ad62974562e85cc6e8f72cf76dbced7cb80f9c56c76ecb8c088e39f2c9bdaed98e1fbec5f7f7b93e4dbeafb0a7d145d0313254c7a1ce475a822931
X-Requested-With: XMLHttpRequest
Content-Length: 95
Origin: http://192.168.0.11:8060
Connection: close
Referer: http://192.168.0.11:8060/apiclient/ember/index.jsp
Cookie: JSESSIONID=C30BF01AD5299032268FF60F8AC31943; (...)

deviceName=192.168.0.20&netmask=255.255.255.0&credentialName=MagicCredentials&addDeviceType=UCS

```

Parameter device points to `deviceName`, and a backend server will make a special HTTP request and will expect a response in an XML form.
Let us see such a request:

```
BACKEND REQUEST

POST /nuova HTTP/1.1
content-type: application/x-www-form-urlencoded
User-Agent: Java/1.8.0_345
Host: 192.168.0.20
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
Content-Length: 47

<aaaLogin inName="root" inPassword="Pass123" />

```

If an attacker is able to trigger that `Add UCS` action or convince an OpManager user to add a “device” under attacker control, they will be able to fully control the response for the backend request and serve a response in the following form:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://SOME_INTERNAL_IP/important_param=harmful_value"> %xxe;]>
<xml>&xxe;</xml>

```

Such XML, with defined external entity field, will force vulnerable backend code to perfom additional HTTP requests to the controller by an attacker internal device with given parameters.

Vulnerable code is located inside the `com/adventnet/me/opmanager/server/api/handler/RestAPIDiscoveryHandler.java` file.
Let us take a close look at the vulnerable source code:

```
Line 1 	  private int addDevice(APIRequestParams params, HttpServletRequest request, Properties auditProps) throws Exception {
Line 2 		String deviceName = request.getParameter("deviceName");
Line 3 		String netmask = request.getParameter("netmask");
Line 4 		String credName = request.getParameter("credentialName");
Line 5 		String deviceType = request.getParameter("type");
Line 6 		String displayName = request.getParameter("displayName");
Line 7 		String networkAddr = request.getParameter("networkAddress");
Line 8 		String isOpUSPM = request.getParameter("isOpUSPM");
Line 9 		(...)
Line 10
Line 11		if (addDeviceType != null && !addDeviceType.equals("") && addDeviceType.equals("UCS")) {
Line 12		  Properties userProp = this.util.getUserDetailsForKey(request.getParameter("apiKey"));
Line 13		  String userID = userProp.getProperty("USERID");
Line 14		  UCSDiscovery ucsdis = new UCSDiscovery();
Line 15		  String resultStr = ucsdis.discover(deviceName, netmask, credNames, userID);

```

Getting inside `ucsdis.discover` method:

```
/src/com/adventnet/me/opmanager/server/ucs/UCSDiscovery.java

Line 150  public Document getDetails(String deviceName, String protocol, Integer port, String inputXml) throws Exception {
Line 151  (...)
Line 152      String urlAddress = protocol.toLowerCase() + "://" + collectMachineName + ":" + port + "/nuova";
Line 153      URL url = new URL(urlAddress);
Line 154      conn = (HttpURLConnection)url.openConnection();
Line 155      conn.setRequestMethod("POST");
Line 156      conn.setDoOutput(true);
Line 157      conn.setRequestProperty("content-type", "application/x-www-form-urlencoded");
Line 158      conn.setReadTimeout(25000);
Line 159      OutputStream out = conn.getOutputStream();
Line 160      out.write(inputXml.getBytes());
Line 161      conn.connect();
Line 162      out.close();
Line 163	  (...)
Line 164	        in = conn.getInputStream();
Line 165      Document doc = XmlUtil.createDocument(in, false);

```

We can see code responsible for executing `BACKEND REQUEST`. Response data of this request is passed to the `createDocument` in `line 165`.

```
Line 320  public static Document createDocument(InputStream is, boolean validating) {
Line 321    try {
Line 322      DocumentBuilderFactory dbfactory = DocumentBuilderFactory.newInstance();
Line 323      dbfactory.setValidating(validating);
Line 324      DocumentBuilder builder = dbfactory.newDocumentBuilder();
Line 325      builder.setErrorHandler((ErrorHandler)new SAXErrorHandler());
Line 326      return builder.parse(is);

```

Attacker-controlled XML data is being parsed by `DocumentBuilder` `line 326` with default settings, which allows for XXE attack.

##### TIMELINE

2022-12-07 - Initial Vendor Contact

2022-12-15 - Vendor Disclosure

2022-12-30 - Vendor Patch Release

2023-03-30 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2023-1708](/vulnerability_reports/TALOS-2023-1708) [Previous Report

TALOS-2022-1597](/vulnerability_reports/TALOS-2022-1597)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.manageengine.com_10ef7dc8_20250115_225506.html ===


[![Network Monitoring Software - ManageEngine OpManager](https://www.manageengine.com/images/logo/opmanager.svg "Network Monitoring Software - ManageEngine OpManager")](/network-monitoring/)

[Download](/network-monitoring/download.html "Download ManageEngine OpManager")

* [Overview](/network-monitoring/ "Overview - ManageEngine OpManager")
* [Features](/network-monitoring/features.html "Features - ManageEngine OpManager")
* [Demo](/network-monitoring/demo-form.html "Demo - ManageEngine OpManager")
* [Get Quote](/network-monitoring/get-quote.html "Get Quote - ManageEngine OpManager")
* [Editions](/network-monitoring/opmanager-editions.html "Editions - ManageEngine OpManager")
* [Resources](/network-monitoring/opmanager-resources.html "Resources - ManageEngine OpManager")
* [Customers](/network-monitoring/customers.html "Customers - ManageEngine OpManager")
* [Support](/network-monitoring/support.html "Support - ManageEngine OpManager")

Security Updates - CVE Database

[Home](/network-monitoring/) »
[Security Updates](https://www.manageengine.com/network-monitoring/security-updates/index.html) Â» CVE-2022-43473

## XML External Entity (XXE) Vulnerability - CVE-2022-43473

**Severity:** Medium

**CVE ID:** [CVE-2022-43473](https://nvd.nist.gov/vuln/detail/CVE-2022-43473)

| **Product name** | **Affected Version(s)** | **Fixed Version(s)** | **Fixed On** |
| --- | --- | --- | --- |
| OpManager OpManager Plus OpManager MSP | 126168 and below | [126141](https://www.manageengine.com/network-monitoring/service-packs.html) | 28-12-2022 |
| [126154](https://www.manageengine.com/network-monitoring/itom-servicepack.html) / 126169 | 30-12-2022 |

**Details:**

OpManager : Previously, there was an XML External Entity (XXE) vulnerability in UCS module. It has been fixed now.

This issue has been fixed by disabling XML entities while parsing XML response, because of which XML entities will not be invoked.

**Impact:**

Exploiting XMLs with vulnerable XML entity lead to the access of restricted resources.

**Steps to upgrade:**

1. Kindly download the latest upgrade pack from [here](https://www.manageengine.com/network-monitoring/service-packs.html?cve-2022-43473).
2. Apply the latest build to your existing product installation as per the upgrade pack instructions provided in the above step.

**Source and Acknowledgements**

This vulnerability was reported by **Cisco Talos-Marcin Noga**. Find out more about CVE-2022-43473 from the [CVE dictionary](https://nvd.nist.gov/vuln/detail/CVE-2022-43473).

Kindly contact our product support team for further details, at the below mentioned email address:

* OpManager: opmanager-support@manageengine.com

Related Products

* » [Network Monitoring](https://www.manageengine.com/network-monitoring/?relPrd "Network Monitoring - ManageEngine")
* » [Bandwidth Monitoring & Traffic Analysis](https://www.manageengine.com/products/netflow/?relPrd "Bandwidth Monitoring & Traffic Analysis - ManageEngine")
* » [Network Configuration Management](https://www.manageengine.com/network-configuration-manager/?relPrd "Network Configuration Management - ManageEngine")
* » [Switch Port & IP Address Management](https://www.manageengine.com/products/oputils/?relPrd "Switch Port & IP Address Management - ManageEngine")
* » [Firewall Management](https://www.manageengine.com/products/firewall/?relPrd "Firewall Management - ManageEngine")
* » [Network Monitoring Software for MSPs](https://www.manageengine.com/network-monitoring-msp/?relPrd "Network Monitoring Software for MSPs - ManageEngine")
* » [IT Operations Management](/it-operations-management/ "IT Operations Management  - ManageEngine")
* » [Application Performance Monitoring](https://www.manageengine.com/products/applications_manager/?relPrd "Applications Manager - ManageEngine")

* [Download](https://www.manageengine.com/network-monitoring/download.html?btmMenu "Download ManageEngine OpManager")
* [Live Demo](https://demo.opmanager.com/ "Live Demo - ManageEngine OpManager")
* [Compare](https://www.manageengine.com/network-monitoring/opmanager-editions.html?btmMenu "Compare Edition - ManageEngine OpManager")
* [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?btmMenu "Get Quote - ManageEngine OpManager")
* [Buy Now](https://store.manageengine.com/opmanager/ "Buy Now - ManageEngine OpManager")

* [Download](https://www.manageengine.com/network-monitoring/download.html?btmMenuopm "Download ManageEngine OpManager")
* [Request Demo](https://www.manageengine.com/network-monitoring/demo-form.html?btmMenuopm "Demo - ManageEngine OpManager")
* [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?btmMenuopm "Get Quote ManageEngine OpManager")

[Pricing](https://store.manageengine.com/opmanager/?rhsFixed) [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?rhsFixed)



=== Content from www.manageengine.com_0ec4aa9c_20250115_225506.html ===


[![Network Monitoring Software - ManageEngine OpManager](https://www.manageengine.com/images/logo/opmanager.svg "Network Monitoring Software - ManageEngine OpManager")](/network-monitoring/)

[Download](/network-monitoring/download.html "Download ManageEngine OpManager")

* [Overview](/network-monitoring/ "Overview - ManageEngine OpManager")
* [Features](/network-monitoring/features.html "Features - ManageEngine OpManager")
* [Demo](/network-monitoring/demo-form.html "Demo - ManageEngine OpManager")
* [Get Quote](/network-monitoring/get-quote.html "Get Quote - ManageEngine OpManager")
* [Editions](/network-monitoring/opmanager-editions.html "Editions - ManageEngine OpManager")
* [Resources](/network-monitoring/opmanager-resources.html "Resources - ManageEngine OpManager")
* [Customers](/network-monitoring/customer-reviews.html "Customers - ManageEngine OpManager")
* [Support](/network-monitoring/support.html "Support - ManageEngine OpManager")

Security Updates - CVE Database

[Home](/network-monitoring/) »
Security Updates

# List of security vulnerabilities fixed in OpManager

This page contains a list of all security vulnerabilities fixed in OpManager along with its CVE ID and fixed build number. Go to [ManageEngine's Security Response Center](https://www.manageengine.com/manageengine-security-response-center.html) to report vulnerabilities on ManageEngine products.

| CVE / ZVE ID | Synopsis | Severity | Fixed in version | Link to latest build |
| --- | --- | --- | --- | --- |
| [CVE-2024-5466](/itom/advisory/cve-2024-5466.html) | OpManager: A Remote Code Execution (RCE) vulnerability could be exploited by users with 'Write' access to the 'Deploy Agent' action in the UI. This has been fixed now. [Reported by Daniel Santos] | High | 128330 / 128320 / 128188 / 128268 | [Download](https://www.manageengine.com/network-monitoring/service-packs.html) |
| [CVE-2024-6748](/itom/advisory/cve-2024-6748.html) | OpManager: The SQL injection vulnerability identified in the URL Monitoring has now been fixed. [Reported by: CrisprXiang, Cokebeer, and LFY] | High | 128318/128186/128267 |
| [CVE-2024-38870](https://www.manageengine.com/network-monitoring/security-updates/cve-2024-38870.html) | OpManager: A stored XSS vulnerability was discovered in Schedule reports. This has now been fixed. (Reported by Muhammed Mekkawy. Refer:CVE-2024-38870) | Medium | 128104/128238/128250 |
| [CVE-2024-36038](https://www.manageengine.com/itom/advisory/cve-2024-36038.html) | The stored XSS vulnerabilities was identified with the configured proxy server from 128234 version, have now been fixed. (Reported by Muhammed Mekkawy.) | High | 128249 |
| [ZVE-2024-1132](https://www.manageengine.com/itom/advisory/zve-2024-1132.html) | Previously, CSRF vulnerability (ZVE-2024-1132) was detected where the external users were able to utilize the network tools without authentication to perform ping or SNMP ping on network devices. This has now been fixed. (Reported by Jayateertha Guruprasad). | Medium | 128103/128247 |
| [CVE-2023-47211](https://www.manageengine.com/itom/advisory/cve-2023-47211.html) | Earlier, path traversal vulnerability was detected for MIB browser. This issue has now been fixed by implementing path sanitization. | High | 127260/ 127248/ 127194/ 127193 |
| [CVE-2023-29505](https://manageengine.com/itom/advisory/cve-2023-29505.html) | Previously, a WebSocket connection was affected by a Cross-site WebSocket hijacking vulnerability. This issue has been fixed by validating the origin of the websocket request. | Low | 127131 / 127120 / 127109 |
| [CVE-2023-31099](https://www.manageengine.com/network-monitoring/security-updates/cve-2023-31099.html) | Enterprise Edition: Remote code execution vulnerability was identified during the data transfer in the Enterprise Edition. This has been fixed now. | High | 126324 |
| [ZVE-2023-0284](https://www.manageengine.com/itom/advisory/zve-2023-0284.html) | OpManager : The Stored XSS vulnerability issues, that lead to JS injection, and were identified in the URL Monitors, have been fixed now. (Reported by Ranjit Pahan). | Medium | 126279 / 126155 / 126263 |
| [CVE-2022-43473](https://www.manageengine.com/itom/advisory/cve-2022-43473.html) | OpManager : Previously, there was an XML External Entity (XXE) vulnerability in UCS module. It has been fixed now. (Reported by Cisco Talos-Marcin Noga) | Medium | 126141 / 126154/ 126169 |
| [CVE-2022-37024](https://www.manageengine.com/itom/advisory/cve-2022-37024.html) | Earlier, there was a Remote Code Execution (RCE) vulnerability in IPv6 address management reported by an anonymous working with Trend Micro Zero Day Initiative. This has been fixed now. | High | 126120 / 126105 / 126003 / 125658 |
| [CVE-2022-38772](https://www.manageengine.com/itom/advisory/cve-2022-38772.html) | Earlier, there was a Remote Code Execution (RCE) vulnerability in IPv4 address management reported by an anonymous working with Trend Micro Zero Day Initiative. This has been fixed now. | High | 126120 / 126105 / 126003 / 125658 |
| [CVE-2022-36923](https://www.manageengine.com/itom/advisory/cve-2022-36923.html) | A vulnerability resulted in unauthenticated access of the user API key. This issue has been fixed now. (Reported by Anonymous working with Trend Micro Zero Day Initiative) | Critical | 126118 / 126104 / 126002 / 125657 |
| [CVE-2022-35404](https://www.manageengine.com/itom/advisory/cve-2022-35404.html) | Unauthorized creation of files lead to high resource consumption. This has been fixed now.(Reported by Tenable) | Medium | 125639/125655/126101 |
| [CVE-2022-29535](https://www.manageengine.com/network-monitoring/security-updates/cve-2022-29535.html) | The SQL injection vulnerability issues identified in few default reports have been fixed now. (Reported by Anh Vu) | High | 125589/125604/125629 |
| [CVE-2022-27908](/network-monitoring/security-updates/cve-2022-27908.html) | Earlier, an SQL injection vulnerability was noticed in the Inventory Reports module. It has been fixed now. | High | 125588/125603ï»¿ï»¿ |
| [CVE-2022-24703](/network-monitoring/security-updates/cve-2022-24703.html) | Earlier, there was a stored XSS vulnerability in the Schedule name field of Schedule page. This issue is fixed now. | Medium | 125584ï»¿ï»¿ |
| [CVE-2021-43319](/network-monitoring/security-updates/cve-2021-43319.html) | Remote Code Execution (RCE) vulnerability in the Ping functionality. | High | 125457, 125473ï»¿ï»¿ |
| [CVE-2021-41288](/network-monitoring/security-updates/cve-2021-41288.html) | SQL injection vulnerability noticed in the Reports module. | High | 125437, 125455 and 125467 |
| [CVE-2021-40493](/network-monitoring/security-updates/cve-2021-40493.html) | SQL injection vulnerability noticed in support diagnostics module. | High | 125437/125453 |
| [CVE-2021-20078](/network-monitoring/security-updates/cve-2021-20078.html) | Folder deletion due to path traversal vulnerability in Remote Desktop feature | Critical | 125332/125347 |
| [CVE-2021-3287](/network-monitoring/security-updates/cve-2021-3287.html) | Unauthenticated Remote Code Execution (RCE) vulnerability due to general bypass for the deserialization class. | Critical | 125220/125314 |
| [CVE-2020-28653](/network-monitoring/security-updates/cve-2020-28653.html) | Unauthenticated Remote Code Execution (RCE) vulnerability in the Smart Update Manager (SUM) servlet. | High | 125203/125218 |
| [CVE-2020-19554](/network-monitoring/security-updates/cve-2020-19554.html) | A reflected XSS vulnerability when the API key contained an XML-based XSS payload | Medium | 125177 |
| [CVE-2020-13818](/network-monitoring/security-updates/cve-2020-13818.html) | Directory Traversal validation was being bypassed when using <cachestart>. | High | 125144 |
| [CVE-2020-12116](/network-monitoring/security-updates/cve-2020-12116.html) | Path Traversal vulnerability | High | 124196/125125 |
| [CVE-2020-11946](/network-monitoring/security-updates/cve-2020-11946.html) | Unauthenticated access to API key disclosure from a servlet call | High | 124188/125120 |
| [CVE-2020-11527](/network-monitoring/security-updates/cve-2020-11527.html) | File read vulnerability in Arbitrary file | High | 124181 |
| [CVE-2020-10541](/network-monitoring/security-updates/cve-2020-10541.html) | Remote Code Execution (RCE) vulnerability in Mail Server Settings v1 APIs | High | 124172 |
| [CVE-2019-17421](/network-monitoring/security-updates/cve-2019-17421.html) | Incorrect file permissions on the packaged Nipper executable file | Medium | 124079 and 124099 |
| [CVE-2019-17602](/network-monitoring/security-updates/cve-2019-17602.html) | SQL injection vulnerability | High | 124078/124089 |
| [CVE-2019-15106](/network-monitoring/security-updates/cve-2019-15106.html) | User login bypass vulnerability in APM plugin | High | 124062/124070 |
| [CVE-2017-11560](https://www.manageengine.com/network-monitoring/security-updates/cve-2017-11560.html) | HTML Injection vulnerability | Medium | 124033 |
| Internal | An operator user could access some restricted folders by bypassing the session. | High | 123241 |
| [CVE-2018-20339](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-20339.html) | XSS vulnerability in 'Alarms' and 'Notes'. | High | 123239 |
| [CVE-2018-20338](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-20338.html) | SQL Injection vulnerability in 'Alarms'. | High | 123239 |
| [CVE-2018-20173](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-20173.html) | SQL Injection vulnerability in performance monitors' graph. | High | 123238 |
| [CVE-2018-19921](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-19921.html) | XSS vulnerability in adding/updating domain controller. | High | 123237 |
| [CVE-2018-19403](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-19403.html) | Unauthenticated Remote Code Execution (RCE) vulnerability. | High | 123231 |
| [CVE-2018-19288](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-19288.html) | XSS vulnerability in updating 'Widgets API'. | High | 123223 |
| [CVE-2018-18949](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-18949.html) | SQL Injection vulnerability in 'Mail Server' settings. | High | 123222 |
| [CVE-2018-18980](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-18980.html) | XML external entity vulnerability in 'Business view' page. | High | 123214 |
| [CVE-2018-18475](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-18475.html) | Unrestricted file upload vulnerability in uploading a background image in 'Business view'. | High | 123214 |
| [CVE-2018-18262](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-18262.html) | XSS vulnerability in 'Add Custom Category'. | High | 123214 |
| [CVE-2018-12997, CVE-2018-12998](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-12997-12998.html) | Injecting arbitrary web script or HTML via the parameter 'operation'. | High | 123169 |
| [CVE-2018-9088, CVE-2018-9087, CVE-2018-9089](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-9087-9088-9089.html) | SQL Injection vulnerability in 'FailOverHelperServlet'. | High | 123157 |
| [CVE-2018-10803](https://www.manageengine.com/network-monitoring/security-updates/cve-2018-10803.html) | XSS vulnerability (Cross-site-scripting) in 'Add credentials' page. | High | 123122 |
| [CVE-2017-12617](https://www.manageengine.com/network-monitoring/security-updates/cve-2017-12617.html) | Uploading JSP file to server via 'HTTP PUT' method | High | 123046 |

Related Products

* » [Network Monitoring](https://www.manageengine.com/network-monitoring/?relPrd "Network Monitoring - ManageEngine")
* » [Bandwidth Monitoring & Traffic Analysis](https://www.manageengine.com/products/netflow/?relPrd "Bandwidth Monitoring & Traffic Analysis - ManageEngine")
* » [Network Configuration Management](https://www.manageengine.com/network-configuration-manager/?relPrd "Network Configuration Management - ManageEngine")
* » [Switch Port & IP Address Management](https://www.manageengine.com/products/oputils/?relPrd "Switch Port & IP Address Management - ManageEngine")
* » [Firewall Management](https://www.manageengine.com/products/firewall/?relPrd "Firewall Management - ManageEngine")
* » [Network Monitoring Software for MSPs](https://www.manageengine.com/network-monitoring-msp/?relPrd "Network Monitoring Software for MSPs - ManageEngine")
* » [IT Operations Management](/it-operations-management/ "IT Operations Management  - ManageEngine")
* » [Application Performance Monitoring](https://www.manageengine.com/products/applications_manager/?relPrd "Applications Manager - ManageEngine")

* [Download](https://www.manageengine.com/network-monitoring/download.html?btmMenu "Download ManageEngine OpManager")
* [Live Demo](https://demo.opmanager.com/ "Live Demo - ManageEngine OpManager")
* [Compare](https://www.manageengine.com/network-monitoring/opmanager-editions.html?btmMenu "Compare Edition - ManageEngine OpManager")
* [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?btmMenu "Get Quote - ManageEngine OpManager")
* [Buy Now](https://store.manageengine.com/opmanager/ "Buy Now - ManageEngine OpManager")

* [Download](https://www.manageengine.com/network-monitoring/download.html?btmMenuopm "Download ManageEngine OpManager")
* [Request Demo](https://www.manageengine.com/network-monitoring/demo-form.html?btmMenuopm "Demo - ManageEngine OpManager")
* [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?btmMenuopm "Get Quote ManageEngine OpManager")

[Pricing](https://store.manageengine.com/opmanager/?rhsFixed) [Get Quote](https://www.manageengine.com/network-monitoring/get-quote.html?rhsFixed)
##### Features

* [Network Management](https://www.manageengine.com/network-monitoring/features.html#network-management?footer-new)
* [Server Management](https://www.manageengine.com/network-monitoring/features.html#server-management?footer-new)
* [Fault Management](https://www.manageengine.com/network-monitoring/features.html#fault-performance-management?footer-new)
* [Storage Management](https://www.manageengine.com/network-monitoring/features.html#storage-management?footer-new)
* [AIOps](https://www.manageengine.com/network-monitoring/features.html#aiops-features?footer-new)
* [Data center management](https://www.manageengine.com/network-monitoring/features.html#data-center-management?footer-new)

##### Sectors

* [Automobile & Aviation](https://www.manageengine.com/network-monitoring/automobile-aviation.html?footer-new)
* [Banking & Finance](https://www.manageengine.com/network-monitoring/banking-finance.html?footer-new)
* [Government](https://www.manageengine.com/network-monitoring/government.html?footer-new)
* [Healthcare](https://www.manageengine.com/network-monitoring/healthcare.html?footer-new)
* [Engineering & Manufacturing](https://www.manageengine.com/network-monitoring/engineering-manufacturing.html?footer-new)
* [More](https://www.manageengine.com/network-monitoring/features.html#other-industries?footer-new)

##### Quick links

* [Resources](https://www.manageengine.com/network-monitoring/opmanager-resources.html?footer-new)
* [Integrations](https://www.manageengine.com/network-monitoring/integration.html?footer-new)
* [Free trainings](https://www.youtube.com/watch?v=51IhFGOi4lc&list=PL0FkrkKW27nPKGfmaCUGwF2dtM7yQ6edp?footer-new)
* [Community](https://pitstop.manageengine.com/portal/en/community/opmanager?footer-new)
* [Customer Testimonials](https://www.manageengine.com/network-monitoring/customers.html?footer-new)
* [Case studies](https://www.manageengine.com/network-monitoring/customer-recommends.html?footer-new)

##### Why OpManager

* [Alternative to PRTG](https://www.manageengine.com/network-monitoring/alternative-to-prtg.html?footer-new)
* [Alternative to Solarwinds](https://www.manageengine.com/network-monitoring/alternative-to-solarwinds-npm.html?footer-new)
* [Alternative to Zabbix](https://www.manageengine.com/network-monitoring/alternative-to-zabbix.html?footer-new)

##### Company

* [About us](https://www.manageengine.com/about-us.html?footer-sec-opm)
* [Store](https://store.manageengine.com/opmanager/?footer-new)
* [Sitemap](https://www.manageengine.com/network-monitoring/sitemap.html?footer-new)

##### Training and Support

* [Contact support](https://www.manageengine.com/network-monitoring/support.html?footer-new)
* [Training and certification](https://www.manageengine.com/training/opmanager_training_agenda.html?footer-new)

##### Connect with us:

**ManageEngine** is a division of **Zoho Corp.**

[![Alternative to PRTG](/network-monitoring/images/footer/banner/footer-banner-1.webp)](https://www.manageengine.com/network-monitoring/alternative-to-prtg.html?footer-new-b1)
[![Full Stack Observability Whitepaper](/network-monitoring/images/footer/banner/footer-banner-2.webp)](https://www.manageengine.com/it-operations-management/full-stack-observability-whitepaper.html?footer-new-b2)



=== Content from talosintelligence.com_4cf59741_20250115_101124.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2022-1685

## ManageEngine OpManager Add UCS Device blind XXE vulnerability

##### March 30, 2023

##### CVE Number

CVE-2022-43473

##### SUMMARY

A blind XML External Entity (XXE) vulnerability exists in the Add UCS Device functionality of ManageEngine OpManager 12.6.168. A specially crafted XML file can lead to SSRF. An attacker can serve
a malicious XML payload to trigger this vulnerability.

##### CONFIRMED VULNERABLE VERSIONS

The versions below were either tested or verified to be vulnerable by Talos or confirmed to be vulnerable by the vendor.

ManageEngine OpManager 12.6.168

##### PRODUCT URLS

OpManager - <https://www.manageengine.com/network-monitoring/>

##### CVSSv3 SCORE

5.8 - CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L

##### CWE

CWE-611 - Improper Restriction of XML External Entity Reference (‘XXE’)

##### DETAILS

OpManager is a network management solution that gathers hardware and software information of computers and other devices on a computer network for management, compliance and audit purposes.

An exploitable XML External Entity (XXE) injection vulnerability is related with an action: `Devices -> Add UCS`.
That action triggers a call to API as follows:

```
REQUEST

POST /client/api/json/discovery/addDevice HTTP/1.1
Host: 192.168.0.11:8060
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: */*
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-ZCSRF-TOKEN: opmcsrftoken=8c3015c780ad62974562e85cc6e8f72cf76dbced7cb80f9c56c76ecb8c088e39f2c9bdaed98e1fbec5f7f7b93e4dbeafb0a7d145d0313254c7a1ce475a822931
X-Requested-With: XMLHttpRequest
Content-Length: 95
Origin: http://192.168.0.11:8060
Connection: close
Referer: http://192.168.0.11:8060/apiclient/ember/index.jsp
Cookie: JSESSIONID=C30BF01AD5299032268FF60F8AC31943; (...)

deviceName=192.168.0.20&netmask=255.255.255.0&credentialName=MagicCredentials&addDeviceType=UCS

```

Parameter device points to `deviceName`, and a backend server will make a special HTTP request and will expect a response in an XML form.
Let us see such a request:

```
BACKEND REQUEST

POST /nuova HTTP/1.1
content-type: application/x-www-form-urlencoded
User-Agent: Java/1.8.0_345
Host: 192.168.0.20
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
Content-Length: 47

<aaaLogin inName="root" inPassword="Pass123" />

```

If an attacker is able to trigger that `Add UCS` action or convince an OpManager user to add a “device” under attacker control, they will be able to fully control the response for the backend request and serve a response in the following form:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://SOME_INTERNAL_IP/important_param=harmful_value"> %xxe;]>
<xml>&xxe;</xml>

```

Such XML, with defined external entity field, will force vulnerable backend code to perfom additional HTTP requests to the controller by an attacker internal device with given parameters.

Vulnerable code is located inside the `com/adventnet/me/opmanager/server/api/handler/RestAPIDiscoveryHandler.java` file.
Let us take a close look at the vulnerable source code:

```
Line 1 	  private int addDevice(APIRequestParams params, HttpServletRequest request, Properties auditProps) throws Exception {
Line 2 		String deviceName = request.getParameter("deviceName");
Line 3 		String netmask = request.getParameter("netmask");
Line 4 		String credName = request.getParameter("credentialName");
Line 5 		String deviceType = request.getParameter("type");
Line 6 		String displayName = request.getParameter("displayName");
Line 7 		String networkAddr = request.getParameter("networkAddress");
Line 8 		String isOpUSPM = request.getParameter("isOpUSPM");
Line 9 		(...)
Line 10
Line 11		if (addDeviceType != null && !addDeviceType.equals("") && addDeviceType.equals("UCS")) {
Line 12		  Properties userProp = this.util.getUserDetailsForKey(request.getParameter("apiKey"));
Line 13		  String userID = userProp.getProperty("USERID");
Line 14		  UCSDiscovery ucsdis = new UCSDiscovery();
Line 15		  String resultStr = ucsdis.discover(deviceName, netmask, credNames, userID);

```

Getting inside `ucsdis.discover` method:

```
/src/com/adventnet/me/opmanager/server/ucs/UCSDiscovery.java

Line 150  public Document getDetails(String deviceName, String protocol, Integer port, String inputXml) throws Exception {
Line 151  (...)
Line 152      String urlAddress = protocol.toLowerCase() + "://" + collectMachineName + ":" + port + "/nuova";
Line 153      URL url = new URL(urlAddress);
Line 154      conn = (HttpURLConnection)url.openConnection();
Line 155      conn.setRequestMethod("POST");
Line 156      conn.setDoOutput(true);
Line 157      conn.setRequestProperty("content-type", "application/x-www-form-urlencoded");
Line 158      conn.setReadTimeout(25000);
Line 159      OutputStream out = conn.getOutputStream();
Line 160      out.write(inputXml.getBytes());
Line 161      conn.connect();
Line 162      out.close();
Line 163	  (...)
Line 164	        in = conn.getInputStream();
Line 165      Document doc = XmlUtil.createDocument(in, false);

```

We can see code responsible for executing `BACKEND REQUEST`. Response data of this request is passed to the `createDocument` in `line 165`.

```
Line 320  public static Document createDocument(InputStream is, boolean validating) {
Line 321    try {
Line 322      DocumentBuilderFactory dbfactory = DocumentBuilderFactory.newInstance();
Line 323      dbfactory.setValidating(validating);
Line 324      DocumentBuilder builder = dbfactory.newDocumentBuilder();
Line 325      builder.setErrorHandler((ErrorHandler)new SAXErrorHandler());
Line 326      return builder.parse(is);

```

Attacker-controlled XML data is being parsed by `DocumentBuilder` `line 326` with default settings, which allows for XXE attack.

##### TIMELINE

2022-12-07 - Initial Vendor Contact

2022-12-15 - Vendor Disclosure

2022-12-30 - Vendor Patch Release

2023-03-30 - Public Release

##### Credit

Discovered by Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2023-1708](/vulnerability_reports/TALOS-2023-1708) [Previous Report

TALOS-2022-1597](/vulnerability_reports/TALOS-2022-1597)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


