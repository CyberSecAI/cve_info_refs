=== Content from github.com_d81db18a_20250115_100617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsasagawa888%2Fnprolog%2Fissues%2F75)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsasagawa888%2Fnprolog%2Fissues%2F75)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=sasagawa888%2Fnprolog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sasagawa888](/sasagawa888)
/
**[nprolog](/sasagawa888/nprolog)**
Public

* [Notifications](/login?return_to=%2Fsasagawa888%2Fnprolog) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2Fsasagawa888%2Fnprolog)
* [Star
   89](/login?return_to=%2Fsasagawa888%2Fnprolog)

* [Code](/sasagawa888/nprolog)
* [Issues
  0](/sasagawa888/nprolog/issues)
* [Pull requests
  0](/sasagawa888/nprolog/pulls)
* [Actions](/sasagawa888/nprolog/actions)
* [Projects
  0](/sasagawa888/nprolog/projects)
* [Security](/sasagawa888/nprolog/security)
* [Insights](/sasagawa888/nprolog/pulse)

Additional navigation options

* [Code](/sasagawa888/nprolog)
* [Issues](/sasagawa888/nprolog/issues)
* [Pull requests](/sasagawa888/nprolog/pulls)
* [Actions](/sasagawa888/nprolog/actions)
* [Projects](/sasagawa888/nprolog/projects)
* [Security](/sasagawa888/nprolog/security)
* [Insights](/sasagawa888/nprolog/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsasagawa888%2Fnprolog%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsasagawa888%2Fnprolog%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Global Buffer overflow in gettoken at Main.c (Ver 1.91) #75

Closed

[Halcy0nic](/Halcy0nic) opened this issue
Oct 15, 2022
· 12 comments

Closed

# [Global Buffer overflow in gettoken at Main.c (Ver 1.91)](#top) #75

[Halcy0nic](/Halcy0nic) opened this issue
Oct 15, 2022
· 12 comments

## Comments

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

### **[Halcy0nic](/Halcy0nic)** commented [Oct 15, 2022](#issue-1410291931)

| Hi [@sasagawa888](https://github.com/sasagawa888),  I pulled down the most recent version of nprolog (Ver 1.91) and ran it through my fuzz tests. It looks like there is a global buffer overflow in gettoken at Main.c when you tell NPL to run a file in script mode.  [npl_crash](https://user-images.githubusercontent.com/42481692/196007594-70d23636-0d70-46ed-ba21-0c806ae84067.png)  I have attached most of the crash files for reproduction. If you compile the project with [AddressSanitizer](https://github.com/google/sanitizers/wiki/AddressSanitizer) it can also detect the global overflow: Makefile ``` CC   = gcc LIBS = -lm -ldl -fsanitize=address   LIBSRASPI = -lm -ldl -lwiringPi -fsanitize=address INCS =   CFLAGS = $(INCS) -Wall -O3 -fsanitize=address DEST = /usr/local/bin  ``` Running NPL in script mode [global_overflow_gettoken](https://user-images.githubusercontent.com/42481692/196007725-6bf781f8-32f7-452a-955e-28b48382056f.png)  [crash.zip](https://github.com/sasagawa888/nprolog/files/9793092/crash.zip) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 16, 2022](#issuecomment-1316485508)

| Sorry for the late reply. I missed it. I will consider |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 16, 2022](#issuecomment-1316512030)

| I changed the game called lights-out included in hiroi.pl for script mode and tried it. It worked fine. My environment is Linux-MINT. Which Prolog file did you run? please tell me in detail.  ```  npl -s tests/hiroi.pl  11000 11011 00111 01110 01101  10110 01110 11100 11011 00011  01101 01110 00111 11011 11000  00011 11011 11100 01110 10110 sasagawa@sasagawa-Diginnos-PC:~/nprolog$    ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

Author

### **[Halcy0nic](/Halcy0nic)** commented [Nov 16, 2022](#issuecomment-1317402880) • edited Loading

| Hi there! In the original message I attached a file for reproduction (named crash.zip). If you unzip this file you will find a script to run using NPL. After running this file in script mode, NPL will segfault. Compiling the project with address sanitizer (above) and running the attached NPL script will indicate where the global buffer overflow takes place.  I tested this on Ubuntu 18, 20, 16.04, and Debian. All 64 bit operating systems |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 17, 2022](#issuecomment-1319343167)

| Thank you for your reply. I will try. |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 18, 2022](#issuecomment-1319447370)

| Hi HalcOnic.  I downloaded crash.zip and unzipped it. However, the contents could not be read. Could you please send the data again? |
| --- |

All reactions

Sorry, something went wrong.

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

Author

### **[Halcy0nic](/Halcy0nic)** commented [Nov 18, 2022](#issuecomment-1319456791) • edited Loading

| Hi [@sasagawa888](https://github.com/sasagawa888)!  I just pulled down the file again and it seems like it is working correctly. If you unzip the file it should have a folder named report and another folder named vuln underneath it. The contents of the script may not be human readable (meaning the bytes of the file have been modified) but can still be executed by running the following:  ``` npl -s [any file in the vuln directory]  ```  Some of the output isn’t human readable, because it was generated by the fuzzer I am using (AFL), and the file bytes have been modified.  Are you able to see all of the files that start with the pattern id:000… in the report/vuln directory?  If not I will upload another sample. |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 18, 2022](#issuecomment-1319788054)

| When I unzipped the zip file, it looked like this: Cannot read inside the file. File name is also unknown. Do you have any other samples? [Screenshot at 2022-11-18 18-57-36](https://user-images.githubusercontent.com/1265066/202675881-59b73e17-f4cf-4b48-94e2-09ec0e1889a0.png) |
| --- |

All reactions

Sorry, something went wrong.

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

Author

### **[Halcy0nic](/Halcy0nic)** commented [Nov 18, 2022](#issuecomment-1320351384)

| [@sasagawa888](https://github.com/sasagawa888)  Here are a few new examples. If you unzip the **'testcases.zip'** file:  [testcases.zip](https://github.com/sasagawa888/nprolog/files/10043667/testcases.zip)  You will see a folder named **'testcases'** with the following contents inside:   * test1.pl * test2.pl * test3.pl  Viewing and executing test1.pl without AddressSanitizer [test1_contents](https://user-images.githubusercontent.com/42481692/202769858-e2dd1e7b-cde0-4fed-afe6-bcd8351d1901.png)  [test1_segfault](https://user-images.githubusercontent.com/42481692/202770291-779875ca-d56c-47f5-94ba-fa1e5b14f941.png) Executing test1.pl with AddressSanitizer [test1](https://user-images.githubusercontent.com/42481692/202770346-ed6334c3-44b9-41d9-8d54-bd63882c6056.png) Viewing and executing test2.pl without AddressSanitizer [test2_contents](https://user-images.githubusercontent.com/42481692/202770399-d373fa36-fb68-4120-9a8a-f3c99b66ae92.png)  [test2_segfault](https://user-images.githubusercontent.com/42481692/202770422-bc3f43a0-8926-4e18-a3ab-3830fba27e20.png) Executing test2.pl with AddressSanitizer [test2](https://user-images.githubusercontent.com/42481692/202770450-027f6606-2618-4ed7-8409-1b927cb23b3c.png) Viewing and executing test3.pl without AddressSanitizer [test3_contents](https://user-images.githubusercontent.com/42481692/202770502-6f983bbc-65ee-4ba6-afdf-d91aafab8855.png)  [test3_segfault](https://user-images.githubusercontent.com/42481692/202770527-5502330c-4cdd-493d-867f-843c3741ac9e.png) Executing test3.pl with AddressSanitizer [test3](https://user-images.githubusercontent.com/42481692/202770558-3c45e1a3-9e33-4fef-8203-632632fe2102.png) |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 18, 2022](#issuecomment-1320628511)

| I tested. An error occurred in test1.pl.  test2.pl Test3.pl becomes a segmentation fault. The reason is that $ is a symbol representing a string and the terminating $ is not given. I needed to detect file\_end and make it an error.  N-Prolog is ARITY-Prolog compatible. Not ISO-Prolog.  ``` N-Prolog Ver 1.91 ?- X = $abcd$. X = $abcd$ . yes ?-   sasagawa@DESKTOP-0D0L6O5:~/nprolog$ cat tests/test1.pl ... sasagawa@DESKTOP-0D0L6O5:~/nprolog$ npl -s tests/test1.pl Syntax error expected operator   around here line=1 column=0 ?- halt. Not callable ?-  .halt ?- halt. - good bye - sasagawa@DESKTOP-0D0L6O5:~/nprolog$ cat tests/test2.pl :- $1 is N+u is N+u. sasagawa@DESKTOP-0D0L6O5:~/nprolog$ npl -s tests/test2.pl Segmentation fault (core dumped) sasagawa@DESKTOP-0D0L6O5:~/nprolog$ cat tests/test3.pl :- %1- $1 :-:- %. sasagawa@DESKTOP-0D0L6O5:~/nprolog$ npl -s tests/test3.pl Segmentation fault (core dumped) sasagawa@DESKTOP-0D0L6O5:~/nprolog$   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=80&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)

Copy link

Author

### **[Halcy0nic](/Halcy0nic)** commented [Nov 18, 2022](#issuecomment-1320672074)

| Glad you were able to reproduce.  Just a heads up, it will segfault and cause a global buffer overflow even without the '$' character. Here is an example (attached):  [test4.zip](https://github.com/sasagawa888/nprolog/files/10045550/test4.zip)  [test4_contents](https://user-images.githubusercontent.com/42481692/202821848-456df454-e855-4fba-84fa-c452a9a626de.png)  [test4_segfault](https://user-images.githubusercontent.com/42481692/202821860-ae7b8a17-7a2b-402b-97a0-94283cbf5779.png) Executing with AddressSanitizer [test4_asan](https://user-images.githubusercontent.com/42481692/202821746-5041f17d-9a3d-4d92-bad1-173afa879b4c.png) |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 19, 2022](#issuecomment-1320802681)

| Reproduced. The reason is that I didn't expect the case without the period. Finding file\_end should be an error.  ``` sasagawa@sasagawa-Diginnos-PC:~/nprolog$ cat tests/test4.pl ffAon(Nf)'sasagawa@sasagawa-Diginnos-PC:~/nprolog$ npl -s tests/test4.pl Segmentation fault (core dumped) sasagawa@sasagawa-Diginnos-PC:~/nprolog$   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=80&v=4)](/sasagawa888)

Copy link

Owner

### **[sasagawa888](/sasagawa888)** commented [Nov 20, 2022](#issuecomment-1321014328)

| I fixed it. Please continue testing. |
| --- |

All reactions

Sorry, something went wrong.

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=40&v=4)](/sasagawa888)
[sasagawa888](/sasagawa888)
closed this as [completed](/sasagawa888/nprolog/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Nov 21, 2022](#event-7852989313)

[![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=40&u=2d33594f736ed622d96b4fa6f965ab39b433b7f1&v=4)](/Halcy0nic)
[Halcy0nic](/Halcy0nic)
mentioned this issue
[Jun 20, 2023](#ref-issue-1764343715)

[Memory Corruption Vulnerabilities in Version 1.94
#78](/sasagawa888/nprolog/issues/78)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsasagawa888%2Fnprolog%2Fissues%2F75)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@sasagawa888](https://avatars.githubusercontent.com/u/1265066?s=52&v=4)](/sasagawa888) [![@Halcy0nic](https://avatars.githubusercontent.com/u/42481692?s=52&v=4)](/Halcy0nic)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


