=== Content from research.splunk.com_bf37ea60_20250114_225650.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk XSS in Save table dialog header in search page

Updated Date: 2024-10-17
ID: a974d1ee-ddca-4837-b6ad-d55a8a239c20
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies persistent cross-site scripting (XSS) attempts in the 'Save Table' dialog on the Splunk search page. It detects POST requests to the endpoint `/en-US/splunkd/__raw/servicesNS/nobody/search/datamodel/model` containing potential XSS payloads. This activity is significant because it can allow a remote user with the "power" role to inject malicious scripts, leading to persistent XSS vulnerabilities. If confirmed malicious, this could enable attackers to execute arbitrary scripts in the context of the affected user, potentially leading to data theft, session hijacking, or further exploitation within the Splunk environment.

### Search

```
1`splunkd_webx` method=POST  uri=/*/splunkd/__raw/servicesNS/nobody/search/datamodel/model
2| table _time host status clientip user uri
3| `splunk_xss_in_save_table_dialog_header_in_search_page_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkd\_webx](https://github.com/splunk/security_content/blob/develop/macros/splunkd_webx.yml) | `index=_internal sourcetype=splunk_web_access` |
| splunk\_xss\_in\_save\_table\_dialog\_header\_in\_search\_page\_filter | `search *` |

`splunk_xss_in_save_table_dialog_header_in_search_page_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1189](https://attack.mitre.org/techniques/T1189/) | Drive-by Compromise | Initial Access |

KillChainPhase.DELIVERY

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT19
APT28
APT32
APT37
APT38
Andariel
Axiom
BRONZE BUTLER
CURIUM
Daggerfly
Dark Caracal
Darkhotel
Dragonfly
Earth Lusca
Elderwood
Lazarus Group
Leafminer
Leviathan
Machete
Magic Hound
Mustard Tempest
PLATINUM
PROMETHIUM
Patchwork
RTM
Threat Group-3390
Transparent Tribe
Turla
Windigo
Windshift
Winter Vivern

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Watch for POST requests combined with XSS script strings or obfuscation against the injection point /en-US/splunkd/\_\_raw/servicesNS/nobody/search/datamodel/model.

### Known False Positives

If host is vulnerable and XSS script strings are inputted they will show up in search. Not all Post requests are malicious as they will show when users create and save dashboards. This search may produce several results with non malicious POST requests. Only affects Splunk Web enabled instances.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Possible XSS exploitation attempt from $clientip$ | 25 | 50 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2022-1101>
* <https://portswigger.net/web-security/cross-site-scripting>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1189/splunk/splunk_xss_in_save_table_dialog_in_search_page.log) | `/opt/splunk/var/log/splunk/web_access.log` | `splunk_web_access` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1189/splunk/splunk_xss_in_save_table_dialog_in_search_page.log) | `/opt/splunk/var/log/splunk/web_access.log` | `splunk_web_access` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_xss_in_save_table_dialog_header_in_search_page.yml) |
Version: **4**

[Detection: Splunk XSS in Monitoring Console](https://research.splunk.com/application/b11accac-6fa3-4103-8a1a-7210f1a67087/ "Detection: Splunk XSS in Monitoring Console")

[Detection: Splunk XSS Privilege Escalation via Custom Urls in Dashboard](https://research.splunk.com/application/01e1e386-7656-4f36-a55a-52fe39b04a96/ "Detection: Splunk XSS Privilege Escalation via Custom Urls in Dashboard")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from www.splunk.com_405988a8_20250114_225652.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Persistent Cross-Site Scripting in “Save Table” Dialog in Splunk Enterprise

**Advisory ID:** SVD-2022-1101

**CVE ID:** [CVE-2022-43561](https://www.cve.org/CVERecord?id=CVE-2022-43561)

**Published:** 2022-11-02

**Last Update:** 2022-11-02

**CVSSv3.1 Score:** 6.4, Medium, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H)

**CWE:** [CWE-79](https://cwe.mitre.org/data/definitions/79.html)

**Bug ID:** SPL-207040

## Description

In Splunk Enterprise versions below 8.1.12, 8.2.9, and 9.0.2, a remote user that holds the “power” Splunk role can store arbitrary scripts that can lead to persistent cross-site scripting (XSS). The vulnerability affects instances with Splunk Web enabled.

## Solution

For Splunk Enterprise, upgrade versions to 8.1.12, 8.2.9, 9.0.2, or higher.

For Splunk Cloud Platform, Splunk is actively patching and monitoring the Splunk Cloud instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.11 and lower | 8.1.12 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.7=8 | 8.2.9 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.1 | 9.0.2 |
| Splunk Cloud Platform |  | Splunk Web | 9.0.2205 and lower | 9.0.2208 |

## Mitigations and Workarounds

If users do not log in to Splunk Web on indexers in a distributed environment, disable Splunk Web on those indexers. See [Disable unnecessary Splunk Enterprise components](https://docs.splunk.com/Documentation/Splunk/8.2.5/Security/DisableunnecessarySplunkcomponents) and the [web.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Webconf) configuration specification file for more information on disabling Splunk Web.

## Detections

* [Splunk XSS in “Save Table” dialog header in search/table page](https://research.splunk.com/application/a974d1ee-ddca-4837-b6ad-d55a8a239c20/)

This is a detection search to find persistent XSS that was included while inputting data in the ‘Save Table’ dialog in the affected versions of Splunk Enterprise.

## Severity

Splunk rated the vulnerability as Medium. The vulnerability lets a remote authenticated user with the power role to store arbitrary scripts, but exploitation requires a multistep process by the victim. Hence, Splunk scored the vulnerability as 6.4 with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H.

If the Splunk Enterprise instance does not run Splunk Web, there is no impact and the severity is Informational.

## Acknowledgments

Mr Hack (try\_to\_hack)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
