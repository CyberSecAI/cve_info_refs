```json
{
  "CVE-2022-43970": [
    {
      "Root cause of vulnerability": "The `httpd` web server application on the Linksys WRT54GL router contains a format string vulnerability in the `start_epi` function. This vulnerability is triggered due to the usage of `sprintf` with user-controlled values from the `WLrate` CGI parameter, leading to a buffer overflow on the stack.",
      "Weaknesses/vulnerabilities present": [
        "Format string vulnerability",
        "Buffer overflow"
      ],
      "Impact of exploitation": "Arbitrary code execution on the router with root privileges.",
      "Attack vectors": "The vulnerability is triggered by sending a crafted HTTP POST request to the `/apply.cgi` endpoint with the `start_epi` parameter set to `1` and the `WLrate` parameter containing a large payload designed to overwrite the return address on the stack.",
      "Required attacker capabilities/position": "The attacker must be on the same network as the vulnerable router and have knowledge of the device's authentication credentials. They also need the ability to send HTTP requests to the router's management interface, as well as the ability to setup a web server and reverse shell handler."
    },
        {
      "Root cause of vulnerability": "The `httpd` web server application on the Linksys WRT54GL router contains a command injection vulnerability via the `UI language` setting. Specifically, a `copy` command is constructed using a user-controlled value of `UI language` which isn't sanitized. This unsanitized value is then passed to the `system()` function, which allows for arbitrary command execution on the device.",
      "Weaknesses/vulnerabilities present": [
        "Command injection",
        "Lack of input validation"
      ],
      "Impact of exploitation": "Arbitrary command execution on the router with root privileges.",
      "Attack vectors": "The vulnerability is triggered by sending a crafted HTTP POST request to the router's management interface that sets the `UI language` parameter to a malicious value including shell commands. This crafted string is then injected into the `copy` command that is executed by the `system()` function. Subsequently, another request that triggers the vulnerable copy command is sent to the router.",
       "Required attacker capabilities/position":"The attacker must be on the same network as the vulnerable router and have knowledge of the device's authentication credentials. They also need the ability to send HTTP requests to the router's management interface."
    },
    {
      "Root cause of vulnerability": "The `httpd` web server application on the Linksys WRT54GL router contains a command injection vulnerability via the `check_tssi` function called by `apply.cgi`. Specifically, the arguments to the `check_tssi` function are parsed from URL parameters, and later formatted into a shell command and executed via a `system()` call.",
      "Weaknesses/vulnerabilities present": [
         "Command injection",
        "Lack of input validation"
      ],
      "Impact of exploitation": "Arbitrary command execution on the router with root privileges.",
      "Attack vectors": "The vulnerability is triggered by sending a crafted HTTP POST request to the router's `/apply.cgi` endpoint and omitting the `change_action`, `start_continue_transaction`, and `stop_continue_transaction` parameters, while also including the `WL_a10_bb` parameter with a payload containing a malicious command, as well as the `WL_at10_radio` and `WL_a10_ctl` parameters.",
      "Required attacker capabilities/position": "The attacker must be on the same network as the vulnerable router and have knowledge of the device's authentication credentials. They also need the ability to send HTTP requests to the router's management interface."
    }
  ]
}
```