=== Content from github.com_556d1246_20250114_212737.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspatie%2Fbrowsershot%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspatie%2Fbrowsershot%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=spatie%2Fbrowsershot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spatie](/spatie)
/
**[browsershot](/spatie/browsershot)**
Public

* [Notifications](/login?return_to=%2Fspatie%2Fbrowsershot) You must be signed in to change notification settings
* [Fork
  499](/login?return_to=%2Fspatie%2Fbrowsershot)
* [Star
   4.9k](/login?return_to=%2Fspatie%2Fbrowsershot)

Convert HTML to an image, PDF or string

[spatie.be/docs/browsershot](https://spatie.be/docs/browsershot "https://spatie.be/docs/browsershot")

### License

[MIT license](/spatie/browsershot/blob/main/LICENSE.md)

[4.9k
stars](/spatie/browsershot/stargazers) [499
forks](/spatie/browsershot/forks) [Branches](/spatie/browsershot/branches) [Tags](/spatie/browsershot/tags) [Activity](/spatie/browsershot/activity)
 [Star](/login?return_to=%2Fspatie%2Fbrowsershot)

 [Notifications](/login?return_to=%2Fspatie%2Fbrowsershot) You must be signed in to change notification settings

* [Code](/spatie/browsershot)
* [Pull requests
  2](/spatie/browsershot/pulls)
* [Discussions](/spatie/browsershot/discussions)
* [Actions](/spatie/browsershot/actions)
* [Security](/spatie/browsershot/security)
* [Insights](/spatie/browsershot/pulse)

Additional navigation options

* [Code](/spatie/browsershot)
* [Pull requests](/spatie/browsershot/pulls)
* [Discussions](/spatie/browsershot/discussions)
* [Actions](/spatie/browsershot/actions)
* [Security](/spatie/browsershot/security)
* [Insights](/spatie/browsershot/pulse)

# spatie/browsershot

    main[Branches](/spatie/browsershot/branches)[Tags](/spatie/browsershot/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[686 Commits](/spatie/browsershot/commits/main/) | | |
| [.github](/spatie/browsershot/tree/main/.github ".github") | | [.github](/spatie/browsershot/tree/main/.github ".github") |  |  |
| [art](/spatie/browsershot/tree/main/art "art") | | [art](/spatie/browsershot/tree/main/art "art") |  |  |
| [bin](/spatie/browsershot/tree/main/bin "bin") | | [bin](/spatie/browsershot/tree/main/bin "bin") |  |  |
| [docs](/spatie/browsershot/tree/main/docs "docs") | | [docs](/spatie/browsershot/tree/main/docs "docs") |  |  |
| [src](/spatie/browsershot/tree/main/src "src") | | [src](/spatie/browsershot/tree/main/src "src") |  |  |
| [tests](/spatie/browsershot/tree/main/tests "tests") | | [tests](/spatie/browsershot/tree/main/tests "tests") |  |  |
| [.editorconfig](/spatie/browsershot/blob/main/.editorconfig ".editorconfig") | | [.editorconfig](/spatie/browsershot/blob/main/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/spatie/browsershot/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/spatie/browsershot/blob/main/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/spatie/browsershot/blob/main/.gitignore ".gitignore") | | [.gitignore](/spatie/browsershot/blob/main/.gitignore ".gitignore") |  |  |
| [CHANGELOG.md](/spatie/browsershot/blob/main/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/spatie/browsershot/blob/main/CHANGELOG.md "CHANGELOG.md") |  |  |
| [LICENSE.md](/spatie/browsershot/blob/main/LICENSE.md "LICENSE.md") | | [LICENSE.md](/spatie/browsershot/blob/main/LICENSE.md "LICENSE.md") |  |  |
| [README.md](/spatie/browsershot/blob/main/README.md "README.md") | | [README.md](/spatie/browsershot/blob/main/README.md "README.md") |  |  |
| [composer.json](/spatie/browsershot/blob/main/composer.json "composer.json") | | [composer.json](/spatie/browsershot/blob/main/composer.json "composer.json") |  |  |
| [phpunit.xml.dist](/spatie/browsershot/blob/main/phpunit.xml.dist "phpunit.xml.dist") | | [phpunit.xml.dist](/spatie/browsershot/blob/main/phpunit.xml.dist "phpunit.xml.dist") |  |  |
| View all files | | |

## Repository files navigation

* README
* License

[![Social Card of Spatie's Browsershot](/spatie/browsershot/raw/main/art/socialcard.png)](/spatie/browsershot/blob/main/art/socialcard.png)

# Convert a webpage to an image or pdf using headless Chrome

[![Latest Version](https://camo.githubusercontent.com/91c8490f0af678f1703c546d58d38538c4457b8e7a17465580b9913b5d174197/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f7370617469652f62726f7773657273686f742e7376673f7374796c653d666c61742d737175617265)](https://github.com/spatie/browsershot/releases)
[![MIT Licensed](https://camo.githubusercontent.com/5ddd6787b46ff6b3a6e8bfa779dc451433a990e470ffe28b66c8fb4a3e5035ca/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d627269676874677265656e2e7376673f7374796c653d666c61742d737175617265)](/spatie/browsershot/blob/main/LICENSE.md)
[![run-tests](https://camo.githubusercontent.com/9a16183072f9aa2e2cc7290c592dbacb155641802d058d60f69dd68490980be1/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f7370617469652f62726f7773657273686f742f72756e2d74657374732e796d6c3f6c6162656c3d7465737473267374796c653d666c61742d737175617265)](https://github.com/spatie/browsershot/actions)
[![Total Downloads](https://camo.githubusercontent.com/c87342e5664c7a9935c0a90e51c39338a6468b69c374551580cc669d9afd408f/68747470733a2f2f696d672e736869656c64732e696f2f7061636b61676973742f64742f7370617469652f62726f7773657273686f742e7376673f7374796c653d666c61742d737175617265)](https://packagist.org/packages/spatie/browsershot)

The package can convert a webpage to an image or pdf. The conversion is done behind the scenes by [Puppeteer](https://github.com/GoogleChrome/puppeteer) which controls a headless version of Google Chrome.

Here's a quick example:

```
use Spatie\Browsershot\Browsershot;

// an image will be saved
Browsershot::url('https://example.com')->save($pathToImage);
```

It will save a pdf if the path passed to the `save` method has a `pdf` extension.

```
// a pdf will be saved
Browsershot::url('https://example.com')->save('example.pdf');
```

You can also use an arbitrary html input, simply replace the `url` method with `html`:

```
Browsershot::html('<h1>Hello world!!</h1>')->save('example.pdf');
```

If your HTML input is already in a file locally use the :

```
Browsershot::htmlFromFilePath('/local/path/to/file.html')->save('example.pdf');
```

Browsershot also can get the body of an html page after JavaScript has been executed:

```
Browsershot::url('https://example.com')->bodyHtml(); // returns the html of the body
```

If you wish to retrieve an array list with all of the requests that the page triggered you can do so:

```
$requests = Browsershot::url('https://example.com')
    ->triggeredRequests();

foreach ($requests as $request) {
    $url = $request['url']; //https://example.com/
}
```

To use Chrome's new [headless mode](https://developers.google.com/web/updates/2017/04/headless-chrome) pass the `newHeadless` method:

```
Browsershot::url('https://example.com')->newHeadless()->save($pathToImage);
```

## Support us

Learn how to create a package like this one, by watching our premium video course:

[![Laravel Package training](https://camo.githubusercontent.com/6c98bd2564e9c2b225f4dd042c8d8d6133dd541b4263f18df288dd9ed1eb9dba/68747470733a2f2f7370617469652e62652f6769746875622f7061636b6167652d747261696e696e672e6a7067)](https://laravelpackage.training)

We invest a lot of resources into creating [best in class open source packages](https://spatie.be/open-source). You can support us by [buying one of our paid products](https://spatie.be/open-source/support-us).

We highly appreciate you sending us a postcard from your hometown, mentioning which of our package(s) you are using. You'll find our address on [our contact page](https://spatie.be/about-us). We publish all received postcards on [our virtual postcard wall](https://spatie.be/open-source/postcards).

## Documentation

All documentation is available [on our documentation site](https://spatie.be/docs/browsershot).

## Testing

For running the testsuite, you'll need to have Puppeteer installed. Pleaser refer to the Browsershot requirements [here](https://spatie.be/docs/browsershot/v4/requirements). Usually `npm -g i puppeteer` will do the trick.

Additionally, you'll need the `pdftotext` CLI which is part of the poppler-utils package. More info can be found in in the [spatie/pdf-to-text readme](https://github.com/spatie/pdf-to-text?tab=readme-ov-file#requirements). Usually `brew install poppler-utils` will suffice.

Finally run the tests with:

```
composer test
```

## Contributing

Please see [CONTRIBUTING](https://github.com/spatie/.github/blob/main/CONTRIBUTING.md) for details.

## Security

If you've found a bug regarding security please mail security@spatie.be instead of using the issue tracker.

## Alternatives

If you're not able to install Node and Puppeteer, take a look at [v2 of browsershot](https://github.com/spatie/browsershot/tree/2.4.1), which uses Chrome headless CLI to take a screenshot. `v2` is not maintained anymore, but should work pretty well.

If using headless Chrome does not work for you take a look at at `v1` of this package which uses the abandoned `PhantomJS` binary.

## Credits

* [Freek Van der Herten](https://github.com/freekmurze)
* [All Contributors](/spatie/browsershot/contributors)

And a special thanks to [Caneco](https://twitter.com/caneco) for the logo ✨

## License

The MIT License (MIT). Please see [License File](/spatie/browsershot/blob/main/LICENSE.md) for more information.

## About

Convert HTML to an image, PDF or string

[spatie.be/docs/browsershot](https://spatie.be/docs/browsershot "https://spatie.be/docs/browsershot")

### Topics

[php](/topics/php "Topic: php")
[screenshot](/topics/screenshot "Topic: screenshot")
[phantomjs](/topics/phantomjs "Topic: phantomjs")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/spatie/browsershot/activity)
[Custom properties](/spatie/browsershot/custom-properties)
### Stars

[**4.9k**
stars](/spatie/browsershot/stargazers)
### Watchers

[**61**
watching](/spatie/browsershot/watchers)
### Forks

[**499**
forks](/spatie/browsershot/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fspatie%2Fbrowsershot&report=spatie+%28user%29)

## [Releases 154](/spatie/browsershot/releases)

[5.0.5
Latest

Dec 30, 2024](/spatie/browsershot/releases/tag/5.0.5)
[+ 153 releases](/spatie/browsershot/releases)

## Sponsor this project

 Sponsor

[Learn more about GitHub Sponsors](/sponsors)

## [Contributors 148](/spatie/browsershot/graphs/contributors)

* [![@freekmurze](https://avatars.githubusercontent.com/u/483853?s=64&v=4)](https://github.com/freekmurze)
* [![@rubenvanassche](https://avatars.githubusercontent.com/u/619804?s=64&v=4)](https://github.com/rubenvanassche)
* [![@AlexVanderbist](https://avatars.githubusercontent.com/u/6287961?s=64&v=4)](https://github.com/AlexVanderbist)
* [![@AdrianMrn](https://avatars.githubusercontent.com/u/12762044?s=64&v=4)](https://github.com/AdrianMrn)
* [![@Nielsvanpach](https://avatars.githubusercontent.com/u/10651054?s=64&v=4)](https://github.com/Nielsvanpach)
* [![@brendt](https://avatars.githubusercontent.com/u/6905297?s=64&v=4)](https://github.com/brendt)
* [![@dependabot[bot]](https://avatars.githubusercontent.com/in/29110?s=64&v=4)](https://github.com/apps/dependabot)
* [![@clementmas](https://avatars.githubusercontent.com/u/8032241?s=64&v=4)](https://github.com/clementmas)
* [![@darron1217](https://avatars.githubusercontent.com/u/8064923?s=64&v=4)](https://github.com/darron1217)
* [![@github-actions[bot]](https://avatars.githubusercontent.com/in/15368?s=64&v=4)](https://github.com/apps/github-actions)
* [![@ziaratban](https://avatars.githubusercontent.com/u/6462878?s=64&v=4)](https://github.com/ziaratban)
* [![@itsgoingd](https://avatars.githubusercontent.com/u/821582?s=64&v=4)](https://github.com/itsgoingd)
* [![@vitorsemeano](https://avatars.githubusercontent.com/u/4042283?s=64&v=4)](https://github.com/vitorsemeano)
* [![@timvandijck](https://avatars.githubusercontent.com/u/4528796?s=64&v=4)](https://github.com/timvandijck)

[+ 134 contributors](/spatie/browsershot/graphs/contributors)

## Languages

* [PHP
  86.0%](/spatie/browsershot/search?l=php)
* [JavaScript
  14.0%](/spatie/browsershot/search?l=javascript)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from fluidattacks.com_229e097d_20250114_212737.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Browsershot 3.57.2 - Server Side XSS to LFR via HTML

## Summary

|  |  |
| --- | --- |
| **Name** | Browsershot 3.57.2 - Server Side XSS to LFR via HTML |
| **Code name** | [Khalid](https://en.wikipedia.org/wiki/Khalid_%28singer%29) |
| **Product** | Browsershot |
| **Affected versions** | Version 3.57.2 |
|
| **State** | Public |
| **Release date** | 2022-10-28 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Server Side XSS |
| **Rule** | [425. Server Side XSS](https://docs.fluidattacks.com/criteria/vulnerabilities/425) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |
| **CVSSv3.1 Base Score** | 7.5 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2022-43983](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43983) |

## Description

Browsershot version 3.57.2 allows an external attacker to remotely
obtain arbitrary local files. This is possible because the application
does not validate that the HTML content passed to the `Browsershot::html`
method does not contain URL's that use the `file://` protocol.

## Vulnerability

This vulnerability occurs because the application does not validate that
the HTML content passed to the `Browsershot::html` method does not contain
URL's that use the `file://` protocol.

## Exploitation

![LFR-via-HTML-PDF-Generation](https://user-images.githubusercontent.com/51862990/198731809-cbafe32d-f73e-485e-8b79-a67447156e63.gif)

![exploit.png](https://user-images.githubusercontent.com/51862990/198731504-364cc6fc-a59f-412a-aee6-1321ffb44ea6.png)

## Our security policy

We have reserved the CVE-2022-43983 to refer to these issues from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Browsershot 3.57.2
* Operating System: GNU/Linux

## Mitigation

An updated version of Browsershot is available at the vendor page.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://github.com/spatie/browsershot>

**Release** <https://github.com/spatie/browsershot/releases/tag/3.57.3>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-25

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-25

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-25

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-25

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-25

Vulnerability patched.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2022-10-28

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)


