=== Content from lists.debian.org_3956887c_20250115_093502.html ===


---

[[Date Prev](msg00037.html)][[Date Next](msg00039.html)]
[[Thread Prev](msg00037.html)][[Thread Next](msg00039.html)]
[[Date Index](maillist.html#00038)]
[[Thread Index](threads.html#00038)]

# [SECURITY] [DLA 3212-1] twisted security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3212-1] twisted security update
* *From*: Dominik George <natureshadow@debian.org>
* *Date*: Mon, 28 Nov 2022 16:38:46 +0100
* *Message-id*: <[[üîé]](/msgid-search/20221128153846.qw3vo57deen7p7yr%40frifot)¬†[20221128153846.qw3vo57deen7p7yr@frifot](msg00038.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3212-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Dominik George
November 28, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : twisted
Version        : 18.9.0-3+deb10u2
CVE ID         : CVE-2022-39348
Debian Bug     :

It was discovered that twisted, a framework for internet applications
written in Python, was prone to an HTML injection when displaying the
HTTP Host header in an error page.

For Debian 10 buster, this problem has been fixed in version
18.9.0-3+deb10u2.

We recommend that you upgrade your twisted packages.

For the detailed security status of twisted please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/twisted>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpAtBAVznM2j.pgp)**

*Description:* PGP signature

---



=== Content from github.com_327eac07_20250115_093502.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fsecurity%2Fadvisories%2FGHSA-vg46-2rrj-3647)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fsecurity%2Fadvisories%2FGHSA-vg46-2rrj-3647)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=twisted%2Ftwisted)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[twisted](/twisted)
/
**[twisted](/twisted/twisted)**
Public

* [Notifications](/login?return_to=%2Ftwisted%2Ftwisted) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Ftwisted%2Ftwisted)
* [Star
   5.7k](/login?return_to=%2Ftwisted%2Ftwisted)

* [Code](/twisted/twisted)
* [Issues
  2.7k](/twisted/twisted/issues)
* [Pull requests
  113](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

Additional navigation options

* [Code](/twisted/twisted)
* [Issues](/twisted/twisted/issues)
* [Pull requests](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

# NameVirtualHost Host header injection.

Low

[adiroiban](/adiroiban)
published
GHSA-vg46-2rrj-3647
Oct 26, 2022

## Package

pip

twisted
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>=0.9.4

## Patched versions

>=22.10.0rc1

## Description

When the host header does not match a configured host `twisted.web.vhost.NameVirtualHost` will return a `NoResource` resource which renders the Host header unescaped into the 404 response allowing HTML and script injection.

In practice this should be very difficult to exploit as being able to modify the Host header of a normal HTTP request implies that one is already in a privileged position.

Example configuration:

```
from twisted.web.server import Site
from twisted.web.vhost import NameVirtualHost
from twisted.internet import reactor

resource = NameVirtualHost()
site = Site(resource)
reactor.listenTCP(8080, site)
reactor.run()
```

Output:

```
‚ùØ curl -H"Host:<h1>HELLO THERE</h1>" http://localhost:8080/

<html>
  <head><title>404 - No Such Resource</title></head>
  <body>
    <h1>No Such Resource</h1>
    <p>host b'<h1>hello there</h1>' not in vhost map</p>
  </body>
</html>

```

This vulnerability was introduced in [f49041b](https://github.com/twisted/twisted/commit/f49041bb67792506d85aeda9cf6157e92f8048f4) and first appeared in the 0.9.4 release.

### Severity

Low

### CVE ID

CVE-2022-39348

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_82a8fb65_20250115_093500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff2f5e81c03f14e253e85fe457e646130780db40b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff2f5e81c03f14e253e85fe457e646130780db40b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=twisted%2Ftwisted)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[twisted](/twisted)
/
**[twisted](/twisted/twisted)**
Public

* [Notifications](/login?return_to=%2Ftwisted%2Ftwisted) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Ftwisted%2Ftwisted)
* [Star
   5.7k](/login?return_to=%2Ftwisted%2Ftwisted)

* [Code](/twisted/twisted)
* [Issues
  2.7k](/twisted/twisted/issues)
* [Pull requests
  113](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

Additional navigation options

* [Code](/twisted/twisted)
* [Issues](/twisted/twisted/issues)
* [Pull requests](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

## Commit

[Permalink](/twisted/twisted/commit/f2f5e81c03f14e253e85fe457e646130780db40b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-vg46-2rrj-3647](https://github.com/advisories/GHSA-vg46-2rrj-3647 "GHSA-vg46-2rrj-3647")

[Browse files](/twisted/twisted/tree/f2f5e81c03f14e253e85fe457e646130780db40b)
Browse the repository at this point in the history

```
[#11716](https://github.com/twisted/twisted/issues/11716) Fix NameVirtualHost HTML injection and deprecate t.w.r.ErrorPage in favor of t.w.pages
```

* Loading branch information

[![@adiroiban](https://avatars.githubusercontent.com/u/204609?s=40&v=4)](/adiroiban)

[adiroiban](/twisted/twisted/commits?author=adiroiban "View all commits by adiroiban")
authored
Oct 26, 2022

2 parents
[50761f4](/twisted/twisted/commit/50761f4e5f1f56f986f09a939e576a49b93a64b2)
+
[b0545bc](/twisted/twisted/commit/b0545bcd8d43e7cdf4a3e3a7ea49d716060d63ac)

commit f2f5e81

 Show file tree

 Hide file tree

Showing
**16 changed files**
with
**416 additions**
and
**68 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/web/howto/web-in-60

  + docs/web/howto/web-in-60/error-handling.rst
    [error-handling.rst](#diff-359dc7f941117073b65396b6d399bf5d66ba89b549560222e9cd8644c175057b)
* src/twisted/web

  + \_auth

    - src/twisted/web/\_auth/wrapper.py
      [wrapper.py](#diff-09e99acd88be5575bc183197eefdabf82fd5e64dddc1e26bda2502daf1a18a12)
  + src/twisted/web/\_template\_util.py
    [\_template\_util.py](#diff-8b5268e87de77cb991bee1adb428d96189314ab58080ea3eb655e3c3ed90a74a)
  + src/twisted/web/distrib.py
    [distrib.py](#diff-303ef3ead153b2ef0a5be5df975c1d305e4729288e435e499b8cc4f5d8d4a023)
  + newsfragments

    - src/twisted/web/newsfragments/11716.bugfix
      [11716.bugfix](#diff-35e09002e268bab6f3596081cbcbf4c94b88cc0ee73b026d44063439d040a61e)
    - src/twisted/web/newsfragments/11716.feature
      [11716.feature](#diff-2f44ff8700920dfd5f468b1d49e35db8cba7a34cbeeda2dfe48e56c39956c76a)
    - src/twisted/web/newsfragments/11716.removal
      [11716.removal](#diff-69e67e9cbddf76807b71318c4924f9fe15938574f030508a28346491d274d541)
  + src/twisted/web/pages.py
    [pages.py](#diff-ac872447b5eb4a5f4e8d2e3c570e7a3d88011d1513cbed979bf16d761bad441d)
  + src/twisted/web/resource.py
    [resource.py](#diff-946657591606c93d3b04ed520cd6a3dcbdb66060f665b0d3119e88cf12bddbd1)
  + src/twisted/web/script.py
    [script.py](#diff-65a127fbec1f8f4fad86282fc58c0ec4a83ced2ddc46df7a737e2676f8a2f5e6)
  + src/twisted/web/server.py
    [server.py](#diff-6c8252af78a4a1c3cdfd2474b7349fb479c0e0a308a8336e4ddab729f55df9ba)
  + src/twisted/web/static.py
    [static.py](#diff-68cd191645fd357edea6167e6d595af4da1262b1dbee98fe60062af7733dfe42)
  + test

    - src/twisted/web/test/test\_pages.py
      [test\_pages.py](#diff-4b8f68cb7a5076aebd6159e48d4a91a789ec069696c897ef172b27d490bb659e)
    - src/twisted/web/test/test\_resource.py
      [test\_resource.py](#diff-b2c3abe6c23010e25b2425d7d05218c7d97f1c06293f7846f64b2f62a000e67e)
    - src/twisted/web/test/test\_vhost.py
      [test\_vhost.py](#diff-1255824e6efa995181b9c31d21b7f4585a685609f1117498c62dd8b0ea6f4fdc)
  + src/twisted/web/vhost.py
    [vhost.py](#diff-9f0016c78deb0e49301778a2ebf51bbe15112ff804b5cba84ce8f2ff0f2b9356)

## There are no files selected for viewing

26 changes: 7 additions & 19 deletions

26
[docs/web/howto/web-in-60/error-handling.rst](#diff-359dc7f941117073b65396b6d399bf5d66ba89b549560222e9cd8644c175057b "docs/web/howto/web-in-60/error-handling.rst")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/docs/web/howto/web-in-60/error-handling.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -32,32 +32,20 @@ As in the previous examples, we'll start with :py:class:`Site <twisted.web.serve |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | Next, we'll add one more import. :py:class:`NoResource <twisted.web.resource.NoResource>` is one of the pre-defined error |
|  |  | Next, we'll add one more import. :py:class:`notFound <twisted.web.pages.notFound>` is one of the pre-defined error |
|  |  | resources provided by Twisted Web. It generates the necessary 404 response code |
|  |  | and renders a simple html page telling the client there is no such resource. |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | and renders a simple HTML page telling the client there is no such resource. |
|  |  |  |
|  |  | .. code-block:: python |
|  |  |  |
|  |  |  |
|  |  | from twisted.web.resource import NoResource |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | from twisted.web.pages import notFound |
|  |  |  |
|  |  | Next, we'll define a custom resource which does some dynamic URL |
|  |  | dispatch. This example is going to be just like |
|  |  | the :doc:`previous one <dynamic-dispatch>` , where the path segment is |
|  |  | interpreted as a year; the difference is that this time we'll handle requests |
|  |  | which don't conform to that pattern by returning the not found response: |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | .. code-block:: python |
|  |  |  |
|  |  |  |
| Expand All | | @@ -66,7 +54,7 @@ which don't conform to that pattern by returning the not found response: |
|  |  | try: |
|  |  | year = int(name) |
|  |  | except ValueError: |
|  |  | return NoResource() |
|  |  | return notFound() |
|  |  | else: |
|  |  | return YearPage(year) |
|  |  |  |
| Expand All | | @@ -88,7 +76,7 @@ complete code for this example: |
|  |  | from twisted.web.server import Site |
|  |  | from twisted.web.resource import Resource |
|  |  | from twisted.internet import reactor, endpoints |
|  |  | from twisted.web.resource import NoResource |
|  |  | from twisted.web.pages import notFound |
|  |  |  |
|  |  | from calendar import calendar |
|  |  |  |
| Expand All | | @@ -100,14 +88,14 @@ complete code for this example: |
|  |  | def render\_GET(self, request): |
|  |  | cal = calendar(self.year) |
|  |  | return (b"<!DOCTYPE html><html><head><meta charset='utf-8'>" |
|  |  | b"<title></title></head><body><pre>" + cal.encode('utf-8') + "</pre>") |
|  |  | b"<title></title></head><body><pre>" + cal.encode('utf-8') + b"</pre>") |
|  |  |  |
|  |  | class Calendar(Resource): |
|  |  | def getChild(self, name, request): |
|  |  | try: |
|  |  | year = int(name) |
|  |  | except ValueError: |
|  |  | return NoResource() |
|  |  | return notFound() |
|  |  | else: |
|  |  | return YearPage(year) |
|  |  |  |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[src/twisted/web/\_auth/wrapper.py](#diff-09e99acd88be5575bc183197eefdabf82fd5e64dddc1e26bda2502daf1a18a12 "src/twisted/web/_auth/wrapper.py")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/_auth/wrapper.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,7 +21,7 @@ |
|  |  | from twisted.logger import Logger |
|  |  | from twisted.python.components import proxyForInterface |
|  |  | from twisted.web import util |
|  |  | from twisted.web.resource import ErrorPage, IResource |
|  |  | from twisted.web.resource import IResource, \_UnsafeErrorPage |
|  |  |  |
|  |  |  |
|  |  | @implementer(IResource) |
| Expand Down  Expand Up | | @@ -52,7 +52,7 @@ def generateWWWAuthenticate(scheme, challenge): |
|  |  | return b" ".join([scheme, b", ".join(lst)]) |
|  |  |  |
|  |  | def quoteString(s): |
|  |  | return b'"' + s.replace(b"\\", br"\\").replace(b'"', br"\"") + b'"' |
|  |  | return b'"' + s.replace(b"\\", rb"\\").replace(b'"', rb"\"") + b'"' |
|  |  |  |
|  |  | request.setResponseCode(401) |
|  |  | for fact in self.\_credentialFactories: |
| Expand Down  Expand Up | | @@ -125,7 +125,7 @@ def \_authorizedResource(self, request): |
|  |  | return UnauthorizedResource(self.\_credentialFactories) |
|  |  | except BaseException: |
|  |  | self.\_log.failure("Unexpected failure from credentials factory") |
|  |  | return ErrorPage(500, None, None) |
|  |  | return \_UnsafeErrorPage(500, "Internal Error", "") |
|  |  | else: |
|  |  | return util.DeferredResource(self.\_login(credentials)) |
|  |  |  |
| Expand Down  Expand Up | | @@ -213,7 +213,7 @@ def \_loginFailed(self, result): |
|  |  | "unexpected error", |
|  |  | failure=result, |
|  |  | ) |
|  |  | return ErrorPage(500, None, None) |
|  |  | return \_UnsafeErrorPage(500, "Internal Error", "") |
|  |  |  |
|  |  | def \_selectParseHeader(self, header): |
|  |  | """ |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[src/twisted/web/\_template\_util.py](#diff-8b5268e87de77cb991bee1adb428d96189314ab58080ea3eb655e3c3ed90a74a "src/twisted/web/_template_util.py")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/_template_util.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1034,9 +1034,9 @@ class \_TagFactory: |
|  |  | """ |
|  |  | A factory for L{Tag} objects; the implementation of the L{tags} object. |
|  |  |  |
|  |  | This allows for the syntactic convenience of C{from twisted.web.html import |
|  |  | tags; tags.a(href="linked-page.html")}, where 'a' can be basically any HTML |
|  |  | tag. |
|  |  | This allows for the syntactic convenience of C{from twisted.web.template |
|  |  | import tags; tags.a(href="linked-page.html")}, where 'a' can be basically |
|  |  | any HTML tag. |
|  |  |  |
|  |  | The class is not exposed publicly because you only ever need one of these, |
|  |  | and we already made it for you. |
| Expand Down | |  |

7 changes: 4 additions & 3 deletions

7
[src/twisted/web/distrib.py](#diff-303ef3ead153b2ef0a5be5df975c1d305e4729288e435e499b8cc4f5d8d4a023 "src/twisted/web/distrib.py")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/distrib.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,9 +124,10 @@ def failed(self, failure): |
|  |  | # XXX: Argh. FIXME. |
|  |  | failure = str(failure) |
|  |  | self.request.write( |
|  |  | resource.ErrorPage( |
|  |  | resource.\_UnsafeErrorPage( |
|  |  | http.INTERNAL\_SERVER\_ERROR, |
|  |  | "Server Connection Lost", |
|  |  | # GHSA-vg46-2rrj-3647 note: \_PRE does HTML-escape the input. |
|  |  | "Connection to distributed server lost:" + util.\_PRE(failure), |
|  |  | ).render(self.request) |
|  |  | ) |
| Expand Down  Expand Up | | @@ -376,7 +377,7 @@ def getChild(self, name, request): |
|  |  | pw\_shell, |
|  |  | ) = self.\_pwd.getpwnam(username.decode(sys.getfilesystemencoding())) |
|  |  | except KeyError: |
|  |  | return resource.NoResource() |
|  |  | return resource.\_UnsafeNoResource() |
|  |  | if sub: |
|  |  | twistdsock = os.path.join(pw\_dir, self.userSocketName) |
|  |  | rs = ResourceSubscription("unix", twistdsock) |
| Expand All | | @@ -385,5 +386,5 @@ def getChild(self, name, request): |
|  |  | else: |
|  |  | path = os.path.join(pw\_dir, self.userDirName) |
|  |  | if not os.path.exists(path): |
|  |  | return resource.NoResource() |
|  |  | return resource.\_UnsafeNoResource() |
|  |  | return static.File(path) |

1 change: 1 addition & 0 deletions

1
[src/twisted/web/newsfragments/11716.bugfix](#diff-35e09002e268bab6f3596081cbcbf4c94b88cc0ee73b026d44063439d040a61e "src/twisted/web/newsfragments/11716.bugfix")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/newsfragments/11716.bugfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | twisted.web.vhost.NameVirtualHost no longer echoes HTML received in the Host header without escaping it (CVE-2022-39348, GHSA-vg46-2rrj-3647). |

1 change: 1 addition & 0 deletions

1
[src/twisted/web/newsfragments/11716.feature](#diff-2f44ff8700920dfd5f468b1d49e35db8cba7a34cbeeda2dfe48e56c39956c76a "src/twisted/web/newsfragments/11716.feature")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/newsfragments/11716.feature)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | The twisted.web.pages.errorPage, notFound, and forbidden each return an IResource that displays an HTML error pages safely rendered using twisted.web.template. |

1 change: 1 addition & 0 deletions

1
[src/twisted/web/newsfragments/11716.removal](#diff-69e67e9cbddf76807b71318c4924f9fe15938574f030508a28346491d274d541 "src/twisted/web/newsfragments/11716.removal")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/newsfragments/11716.removal)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | The twisted.web.resource.ErrorPage, NoResource, and ForbiddenResource classes have been deprecated in favor of new implementations twisted.web.pages module because they permit HTML injection. |

134 changes: 134 additions & 0 deletions

134
[src/twisted/web/pages.py](#diff-ac872447b5eb4a5f4e8d2e3c570e7a3d88011d1513cbed979bf16d761bad441d "src/twisted/web/pages.py")

Show comments

[View file](/twisted/twisted/blob/f2f5e81c03f14e253e85fe457e646130780db40b/src/twisted/web/pages.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,134 @@ |
|  |  | # -\*- test-case-name: twisted.web.test.test\_pages -\*- |
|  |  | # Copyright (c) Twisted Matrix Laboratories. |
|  |  | # See LICENSE for details. |
|  |  |  |
|  |  | """ |
|  |  | Utility implementations of L{IResource}. |
|  |  | """ |
|  |  |  |
|  |  | \_\_all\_\_ = ( |
|  |  | "errorPage", |
|  |  | "notFound", |
|  |  | "forbidden", |
|  |  | ) |
|  |  |  |
|  |  | from typing import cast |
|  |  |  |
|  |  | from twisted.web import http |
|  |  | from twisted.web.iweb import IRenderable, IRequest |
|  |  | from twisted.web.resource import IResource, Resource |
|  |  | from twisted.web.template import renderElement, tags |
|  |  |  |
|  |  |  |
|  |  | class \_ErrorPage(Resource): |
|  |  | """ |
|  |  | L{\_ErrorPage} is a resource that responds to all requests with a particular |
|  |  | (parameterized) HTTP status code and an HTML body containing some |
|  |  | descriptive text. This is useful for rendering simple error pages. |
|  |  |  |
|  |  | @see: L{twisted.web.pages.errorPage} |
|  |  |  |
|  |  | @ivar \_code: An integer HTTP status code which will be used for the |
|  |  | response. |
|  |  |  |
|  |  | @ivar \_brief: A short string which will be included in the response body as |
|  |  | the page title. |
|  |  |  |
|  |  | @ivar \_detail: A longer string which will be included in the response body. |
|  |  | """ |
|  |  |  |
|  |  | def \_\_init\_\_(self, code: int, brief: str, detail: str) -> None: |
|  |  | super().\_\_init\_\_() |
|  |  | self.\_code: int = code |
|  |  | self.\_brief: str = brief |
|  |  | self.\_detail: str = detail |
|  |  |  |
|  |  | def render(self, request: IRequest) -> object: |
|  |  | """ |
|  |  | Respond to all requests with the given HTTP status code and an HTML |
|  |  | document containing the explanatory strings. |
|  |  | """ |
|  |  | request.setResponseCode(self.\_code) |
|  |  | request.setHeader(b"content-type", b"text/html; charset=utf-8") |
|  |  | return renderElement( |
|  |  | request, |
|  |  | # cast because the type annotations here seem off; Tag isn't an |
|  |  | # IRenderable but also probably should be? See |
|  |  | # https://github.com/twisted/twisted/issues/4982 |
|  |  | cast( |
|  |  | IRenderable, |
|  |  | tags.html( |
|  |  | tags.head(tags.title(f"{self.\_code} - {self.\_brief}")), |
|  |  | tags.body(tags.h1(self.\_brief), tags.p(self.\_detail)), |
|  |  | ), |
|  |  | ), |
|  |  | ) |
|  |  |  |
|  |  | def getChild(self, path: bytes, request: IRequest) -> Resource: |
|  |  | """ |
|  |  | Handle all requests for which L{\_ErrorPage} lacks a child by returning |
|  |  | this error page. |
|  |  |  |
|  |  | @param path: A path segment. |
|  |  |  |
|  |  | @param request: HTTP request |
|  |  | """ |
|  |  | return self |
|  |  |  |
|  |  |  |
|  |  | def errorPage(code: int, brief: str, detail: str) -> IResource: |
|  |  | """ |
|  |  | Build a resource that responds to all requests with a particular HTTP |
|  |  | status code and an HTML body containing some descriptive text. This is |
|  |  | useful for rendering simple error pages. |
|  |  |  |
|  |  | The resource dynamically handles all paths below it. Use |
|  |  | L{IResource.putChild()} override specific path. |
|  |  |  |
|  |  | @param code: An integer HTTP status code which will be used for the |
|  |  | response. |
|  |  |  |
|  |  | @param brief: A short string which will be included in the response |
|  |  | body as the page title. |
|  |  |  |
|  |  | @param detail: A longer string which will be included in the |
|  |  | response body. |
|  |  |  |
|  |  | @returns: An L{IResource} |
|  |  | """ |
|  |  | return \_ErrorPage(code, brief, detail) |
|  |  |  |
|  |  |  |
|  |  | def notFound( |
|  |  | brief: str = "No Such Resource", |
|  |  | message: str = "Sorry. No luck finding that resource.", |
|  |  | ) -> IResource: |
|  |  | """ |
|  |  | Generate an L{IResource} with a 404 Not Found status code. |
|  |  |  |
|  |  | @see: L{twisted.web.pages.errorPage} |
|  |  |  |
|  |  | @param brief: A short string displayed as the page title. |
|  |  |  |
|  |  | @param brief: A longer string displayed in the page body. |
|  |  |  |
|  |  | @returns: An L{IResource} |
|  |  | """ |
|  |  | return \_ErrorPage(http.NOT\_FOUND, brief, message) |
|  |  |  |
|  |  |  |
|  |  | def forbidden( |
|  |  | brief: str = "Forbidden Resource", message: str = "Sorry, resource is forbidden." |
|  |  | ) -> IResource: |
|  |  | """ |
|  |  | Generate an L{IResource} with a 403 Forbidden status code. |
|  |  |  |
|  |  | @see: L{twisted.web.pages.errorPage} |
|  |  |  |
|  |  | @param brief: A short string displayed as the page title. |
|  |  |  |
|  |  | @param brief: A longer string displayed in the page body. |
|  |  |  |
|  |  | @returns: An L{IResource} |
|  |  | """ |
|  |  | return \_ErrorPage(http.FORBIDDEN, brief, message) |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f2f5e81`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff2f5e81c03f14e253e85fe457e646130780db40b) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.gentoo.org_f5ab6747_20250115_093503.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Twisted: Multiple Vulnerabilities ‚Äî GLSA **202301-02**

Multiple vulnerabilities have been discovered in Twisted, the worst of which could result in denial of service.

### Affected packages

| Package | **dev-python/twisted** on all architectures |
| --- | --- |
| Affected versions | < **22.10.0** |
| Unaffected versions | >= **22.10.0** |

### Background

Twisted is an asynchronous networking framework written in Python.

### Description

Multiple vulnerabilities have been discovered in Twisted. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Twisted users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-python/twisted-22.10.0"

```
### References

* [CVE-2022-21712](https://nvd.nist.gov/vuln/detail/CVE-2022-21712)
* [CVE-2022-21716](https://nvd.nist.gov/vuln/detail/CVE-2022-21716)
* [CVE-2022-39348](https://nvd.nist.gov/vuln/detail/CVE-2022-39348)

**Release date**

January 11, 2023

**Latest revision**

January 11, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [878499](https://bugs.gentoo.org/show_bug.cgi?id=878499)
* [834542](https://bugs.gentoo.org/show_bug.cgi?id=834542)
* [832875](https://bugs.gentoo.org/show_bug.cgi?id=832875)

### Questions or comments?

Please feel free to contact us.

**¬© 2001‚Äì2020 Gentoo Foundation, Inc.**



=== Content from github.com_85fd45c4_20250115_093501.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff49041bb67792506d85aeda9cf6157e92f8048f4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff49041bb67792506d85aeda9cf6157e92f8048f4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=twisted%2Ftwisted)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[twisted](/twisted)
/
**[twisted](/twisted/twisted)**
Public

* [Notifications](/login?return_to=%2Ftwisted%2Ftwisted) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Ftwisted%2Ftwisted)
* [Star
   5.7k](/login?return_to=%2Ftwisted%2Ftwisted)

* [Code](/twisted/twisted)
* [Issues
  2.7k](/twisted/twisted/issues)
* [Pull requests
  113](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

Additional navigation options

* [Code](/twisted/twisted)
* [Issues](/twisted/twisted/issues)
* [Pull requests](/twisted/twisted/pulls)
* [Actions](/twisted/twisted/actions)
* [Security](/twisted/twisted/security)
* [Insights](/twisted/twisted/pulse)

## Commit

[Permalink](/twisted/twisted/commit/f49041bb67792506d85aeda9cf6157e92f8048f4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

vhost bugfix...

[Browse files](/twisted/twisted/tree/f49041bb67792506d85aeda9cf6157e92f8048f4)
Browse the repository at this point in the history

```
git-svn-id: svn://svn.twistedmatrix.com/svn/Twisted/trunk@53 bbbe8e31-12d6-0310-92fd-ac37d47ddeeb
```

* Loading branch information

[![@glyph](https://avatars.githubusercontent.com/u/716529?s=40&v=4)](/glyph)

[glyph](/twisted/twisted/commits?author=glyph "View all commits by glyph")
committed
Jul 23, 2001

1 parent
[39037ef](/twisted/twisted/commit/39037efcebbceaffb346d70e73fdeed57dd83ccc)

commit f49041b

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[twisted/web/vhost.py](#diff-fd04289084f45e7d75bae443762431d3376a136c71e7e99dc32e3dbadead18e9 "twisted/web/vhost.py")

Show comments

[View file](/twisted/twisted/blob/f49041bb67792506d85aeda9cf6157e92f8048f4/twisted/web/vhost.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,7 +34,7 @@ def \_getResourceForRequest(self, request): |
|  |  | """(Internal) Get the appropriate resource for the given host. |
|  |  | """ |
|  |  | host = string.lower(request.getHeader('host')) |
|  |  | return self.hosts.get(host, error.NoResource()) |
|  |  | return self.hosts.get(host, error.NoResource("host %s not in vhost map" % repr(host))) |
|  |  |  |
|  |  | def render(self, request): |
|  |  | """Implementation of resource.Resource's render method. |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f49041b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftwisted%2Ftwisted%2Fcommit%2Ff49041bb67792506d85aeda9cf6157e92f8048f4) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


