```
{
  "CVE-2022-39248": {
    "related_content": [
      {
        "source": "matrix.org_b745038c_20250114_223401.html",
        "content": "The content describes a 'Trusted Impersonation' vulnerability present in matrix-js-sdk (and derived SDKs) that incorrectly accepts to-device messages encrypted by Megolm rather than Olm. This vulnerability allows an attacker to impersonate the trusted sender of to-device messages, send fake keys to spoof historical messages, and even add a malicious key backup. This is a critical severity issue with CVE-2022-39251, CVE-2022-39255, and CVE-2022-39248 assigned to the different SDKs.\n\nThe attack vector is a malicious homeserver admin.\n\nThe impact includes:\n-  faking the trusted sender of to-device messages\n-  sending fake to-device messages to devices\n-  spoofing historical messages\n-  injecting a malicious key backup\n\nAttacker capabilities: Malicious homeserver admin"
      },
      {
        "source": "github.com_a1b59367_20250115_200145.html",
        "content": "UNRELATED"
      },
      {
        "source": "docs.github.com_d782ce82_20250115_200156.html",
        "content": "UNRELATED"
      },
      {
        "source": "github.com_f7ffc5b1_20250115_200155.html",
        "content": "The content details a vulnerability in matrix-android-sdk2 (CVE-2022-39248) where a malicious homeserver, in cooperation with an attacker, can send messages appearing to come from another user, or send spoofed to-device messages to inject malicious key backups.\n\nRoot cause: The matrix-android-sdk2 incorrectly accepts to-device messages encrypted with Megolm instead of Olm.\n\nWeaknesses: Protocol confusion vulnerability, incorrect handling of to-device messages.\n\nImpact:\n - Construct messages that appear to come from another user.\n - Inject a malicious key backup to exfiltrate message keys.\n\nAttack vector: A malicious homeserver cooperating with an attacker.\n\nRequired attacker capabilities: A malicious homeserver admin with the ability to craft malicious messages."
      },
      {
        "source": "github.com_dba769c8_20250115_200152.html",
        "content": "UNRELATED"
      },
      {
        "source": "github.com_d16527ff_20250115_200151.html",
         "content": "UNRELATED"
      },
       {
        "source": "github.com_dedff6c2_20250115_200208.html",
        "content": "UNRELATED"
       },
      {
        "source": "github.com_fe4b9a9c_20250115_200144.html",
        "content": "This commit log contains the fix for CVE-2022-39248 (and CVE-2022-39246) and includes changes to 'DefaultCryptoService.kt', 'InboundGroupSessionStore.kt', and 'MXOlmDevice.kt', among other files, with fixes related to processing Olm and Megolm encrypted messages.\n\nIt does not specify the vulnerability directly, but indicates the changes made in response to the vulnerability."
      },
     {
        "source": "github.com_e03bc5c1_20250114_223359.html",
        "content": "This content confirms the security fix for CVE-2022-39248 and CVE-2022-39246 in version 1.5.1 of matrix-android-sdk2. It mentions this version provides important security fixes, and that users should update immediately. It does not specify the details of the vulnerability"
      },
      {
        "source": "github.com_87cf65fc_20250115_200141.html",
         "content": "This content describes the vulnerability (CVE-2022-39248) as an Olm/Megolm protocol confusion issue. It states a malicious homeserver can craft messages to appear from another user, or send fake to-device messages to inject malicious key backups. It details the fix which ensures that the SDK only accepts Olm-encrypted to-device messages and stops signing backups after decryption, along with other security checks.\n\nRoot cause: Protocol confusion allowing acceptance of to-device messages encrypted with Megolm instead of Olm.\n\nWeaknesses: Insufficient validation of message encryption type for to-device messages.\n\nImpact:\n   - Impersonation of other users.\n   - Injection of malicious key backups.\n\nAttack vector: A malicious homeserver in cooperation with an attacker.\n\nRequired attacker capabilities: Malicious homeserver admin with the ability to craft malicious messages."
      }
    ]
  }
}
```