```
{
  "vulnerability": {
    "root_cause": "When performing a local clone, Git copies the contents of the source repository's `$GIT_DIR/objects` directory into the destination. Git dereferences symbolic links within the source's `$GIT_DIR/objects` directory before creating hardlinks or copies of the dereferenced target in the destination, potentially leading to sensitive information disclosure.",
    "weaknesses": [
      "The vulnerability arises from Git's behavior of dereferencing symbolic links during local clones, which allows an attacker to introduce a symbolic link in the source's `$GIT_DIR/objects` directory pointing to sensitive locations in the victim's machine."
    ],
    "impact": "Cloning a malicious repository with a symbolic link in its `$GIT_DIR/objects` may result in the disclosure of sensitive information from the victim's machine, as the cloned repository will contain hard links (or copies) of the target of the symbolic link.",
    "attack_vectors": [
      "A malicious actor can craft a repository containing a symbolic link within its `$GIT_DIR/objects` directory, pointing to sensitive information on the victim's machine.",
      "The victim is then tricked into cloning this repository locally using the `--local` optimization, either directly or via a submodule with the `--recurse-submodules` option.",
       "The `objects` directory itself may be a symbolic link, which when combined with dereferencing of symlinks within, can lead to the same information disclosure."

    ],
    "required_attacker_capabilities": "The attacker must be able to create and host a malicious Git repository with the described symlink, and then convince a victim to clone it using the `--local` clone optimization."
  },
  "additional_notes": [
    "This vulnerability affects versions of Git prior to those patched on 2022-10-18.",
     "The fix involves no longer dereferencing symbolic links via the `--local` clone mechanism and refusing to clone repositories that have symbolic links present in the `$GIT_DIR/objects` directory.",
     "The value of `protocol.file.allow` is changed to be `user` by default to avoid such issues.",
    "The vulnerability can be exploited even when the source repository is embedded as a submodule within another repository.",
     "Workarounds include avoiding `--local` optimization or untrusted submodules, or configuring `protocol.file.allow user`."
  ]
}
```