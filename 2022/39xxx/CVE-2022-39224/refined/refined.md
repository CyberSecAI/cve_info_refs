The provided content relates to CVE-2022-39224.

**Root cause of vulnerability:**
The vulnerability stems from the `arr-pm` library using the `PAYLOADCOMPRESSOR` tag from an RPM file to determine how to decompress the payload, without validating the value. This allowed an attacker to specify an arbitrary command as the payload compressor, leading to arbitrary shell execution.

**Weaknesses/vulnerabilities present:**
- **Arbitrary shell execution:** The library executes the command specified in the `PAYLOADCOMPRESSOR` tag without sanitization, leading to shell command injection.
- **Lack of input validation:** The library does not validate or sanitize the `PAYLOADCOMPRESSOR` field allowing attacker controlled values to be used as shell commands.

**Impact of exploitation:**
- An attacker can achieve arbitrary shell execution on the system processing a malicious RPM file.

**Attack vectors:**
- A malicious RPM file with a crafted `PAYLOADCOMPRESSOR` tag.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide a malicious RPM file to be processed by an application using a vulnerable version of the `arr-pm` library.

**More Detail:**
The vulnerability was present in the `extract` and `files` methods of the `RPM::File` class. The fix involves validating the `PAYLOADCOMPRESSOR` value, only allowing known and safe compressor values such as gzip, bzip2, xz, zstd, and lzma. The vulnerability was resolved in version 0.0.12. The vulnerability can be triggered when using the `-s rpm` or `--input-type rpm` flags in `fpm` when processing a malicious rpm.