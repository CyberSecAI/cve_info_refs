Based on the provided content, here's an analysis of the vulnerability described:

**Root Cause of Vulnerability:**
The vulnerability stems from the OIDC (OpenID Connect) authenticator in XWiki not properly validating the source of configuration parameters. It allows an attacker to override the configured OpenID provider by supplying custom provider details via request parameters.

**Weaknesses/Vulnerabilities:**

*   **Insecure Parameter Handling:** The application prioritizes request parameters over the configured settings for the OIDC provider. This allows attackers to inject their own provider details and bypass the intended authentication mechanism.
*   **Lack of Input Validation:** The system doesn't validate or sanitize the parameters received via HTTP requests before using them to establish the OIDC connection, allowing the use of arbitrary endpoints.
*   **Group Mapping Manipulation:** The vulnerability also extends to group mapping configurations, allowing an attacker to manipulate the `oidc.groups.mapping` parameter to gain unauthorized access to the XWikiAdminGroup.

**Impact of Exploitation:**

*   **Authentication Bypass:** Attackers can completely bypass the configured XWiki authentication and gain unauthorized access to the wiki.
*   **Privilege Escalation:** By manipulating group mappings, an attacker can grant themselves administrative privileges.
*   **Confidentiality Breach:** Unauthorized access to the system can lead to the exposure of sensitive data.
*   **Availability Impact:** By controlling the authentication flow and gaining admin rights, an attacker could disrupt or disable the system.

**Attack Vectors:**

*   **Network-based attacks:** Exploitation can occur via HTTP requests to the application.
*   **Parameter injection:** The attacker sends malicious request parameters to the server containing custom OIDC provider details or group mappings.

**Required Attacker Capabilities/Position:**
*   The attacker does not need any prior authentication or privileges to exploit the vulnerability.
*   The attacker needs to be able to send HTTP requests to the server hosting the vulnerable XWiki instance.
*   The attacker must be aware of the vulnerable parameters (`oidc.endpoint.*`, `oidc.xwikiprovider`, and `oidc.groups.mapping`).

**Additional Details:**

* The vulnerability is present in versions prior to 1.29.1 of the `org.xwiki.contrib.oidc:oidc-authenticator` Maven package.
* The fix for this vulnerability is included in version 1.29.1.
* The fix involved modifying the `OIDCClientConfiguration.java` file to not allow overriding of properties via request parameters unless the property is considered "safe". The `SAFE_PROPERTIES` set prevents request parameters from overriding the configured OIDC provider details. The code changes explicitly check whether `SAFE_PROPERTIES` contains the request parameter key before attempting to convert it.
* The vulnerability is identified by CVE-2022-39387 and has a CVSS v3 base score of 9.1, indicating a critical severity.
* The vulnerability is tracked in Jira under issue ID OIDC-118.

In summary, this is a critical vulnerability that allows for complete authentication bypass and potential privilege escalation by manipulating request parameters related to the OIDC authentication process in XWiki.