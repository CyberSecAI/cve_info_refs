```
{
  "vulnerability_details": {
    "root_cause": "Improper sanitization of user-supplied input when quoting direct messages leads to stored cross-site scripting (XSS).",
    "weaknesses": [
      "Stored XSS",
      "Insufficient input sanitization",
      "Inadequate HTML Purifier configuration"
    ],
    "impact": "An attacker can inject malicious JavaScript code that will be executed in the context of other users' browsers when they view the message. This could lead to session hijacking, data theft, or other malicious actions.",
    "attack_vectors": [
      "Sending a direct message containing the malicious payload",
      "Quoting the malicious message"
    ],
    "attacker_capabilities": "An attacker needs to be able to send direct messages to other users. Originally, administrator accounts were vulnerable because HTMLPurifier did not sanitize Javascript for them, but after the fix, it affected all users."
  },
    "additional_notes": "The vulnerability was initially present due to HTMLPurifier settings that allowed administrators to use `<script>` tags. The fix disabled `<script>` tags for administrators as well. However, the reporter suggests that blacklisting is not the best practice and that a whitelist approach should be used instead, using DOMPurify's allowlist as an example, citing that the payload `<img src=x onerror=alert(1)>` would still work."
}
```