=== Content from github.com_63e5ffc4_20250114_234802.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F726bac57659410da463dcf404b3e79a7312ac0b9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F726bac57659410da463dcf404b3e79a7312ac0b9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   730](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  15](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

## Commit

[Permalink](/eclipse-californium/californium/commit/726bac57659410da463dcf404b3e79a7312ac0b9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix pending job counters.

[Browse files](/eclipse-californium/californium/tree/726bac57659410da463dcf404b3e79a7312ac0b9)
Browse the repository at this point in the history

```
Run pending jobs on connection shutdown to align the counters.

Fixes issue [#2065](https://github.com/eclipse-californium/californium/issues/2065)

Signed-off-by: Achim Kraus <achim.kraus@cloudcoap.net>
```

* Loading branch information

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&v=4)](/boaks)

[boaks](/eclipse-californium/californium/commits?author=boaks "View all commits by boaks")
committed
Sep 19, 2022

1 parent
[92f7677](/eclipse-californium/californium/commit/92f7677d46673ff39f68b49faee0641d83f0dcd2)

commit 726bac5

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**370 additions**
and
**181 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* element-connector/src/main/java/org/eclipse/californium/elements/util

  + element-connector/src/main/java/org/eclipse/californium/elements/util/ExecutorsUtil.java
    [ExecutorsUtil.java](#diff-ac91d287392eac72911b468587360feed57a5352affd458902d932154988169a)
  + element-connector/src/main/java/org/eclipse/californium/elements/util/LimitedRunnable.java
    [LimitedRunnable.java](#diff-5cc0a409480267cb5a647326676dc32fe76dbd17e384da9f71d97d13664035ed)
  + element-connector/src/main/java/org/eclipse/californium/elements/util/SerialExecutor.java
    [SerialExecutor.java](#diff-9090d6518a8ca902457558ccedb997eac218fa5a99db452b32e8450386d760e2)
* scandium-core

  + scandium-core/api-changes.json
    [api-changes.json](#diff-c0e6ce03968eccf2b017e42e8afcb6cee42af99b9c51bcba7ac53b83436765e9)
  + src

    - main/java/org/eclipse/californium/scandium

      * scandium-core/src/main/java/org/eclipse/californium/scandium/DTLSConnector.java
        [DTLSConnector.java](#diff-251342662f1cfb83e80d989bf21c084240b9b92cd4dc20963c8e3d6da0e1fa79)
      * scandium-core/src/main/java/org/eclipse/californium/scandium/DtlsBindingPreprocessingConnector.java
        [DtlsBindingPreprocessingConnector.java](#diff-77d360aa2d29388515a020408b08ce6537c268b7a799d4594401988912aa34c0)
      * dtls

        + scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/Connection.java
          [Connection.java](#diff-547778d13dcdfa6f930f19e4c7a14341f1f4e80f86ff5860f3bdddaa3c46f8a1)
        + scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java
          [InMemoryConnectionStore.java](#diff-2a5ae2cb43f6404d7363d9b183ac59df6b19a5b24a2e4b3f53e50c21c3a63d1d)
        + scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryReadWriteLockConnectionStore.java
          [InMemoryReadWriteLockConnectionStore.java](#diff-a30b523b401a87451c7ec1149ae2af352c2004550bf0aaf8fdc9b208b11f558c)
    - test/java/org/eclipse/californium/scandium

      * scandium-core/src/test/java/org/eclipse/californium/scandium/DTLSConnectorAdvancedTest.java
        [DTLSConnectorAdvancedTest.java](#diff-e390282905422cfb89e89e418a54c0e89c4ce5470348ee7de5927bc59849f773)
      * scandium-core/src/test/java/org/eclipse/californium/scandium/DTLSConnectorHandshakeTest.java
        [DTLSConnectorHandshakeTest.java](#diff-ae1551c9a7db5d9972d58d697a7f3cd75b30dd719ab0804d552a5647d997bf44)
      * scandium-core/src/test/java/org/eclipse/californium/scandium/DTLSConnectorTest.java
        [DTLSConnectorTest.java](#diff-aa5673238a69db782e2db52e9937b9f6d5537c6382c26ed9c61466af3184bffd)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[element-connector/src/main/java/org/eclipse/californium/elements/util/ExecutorsUtil.java](#diff-ac91d287392eac72911b468587360feed57a5352affd458902d932154988169a "element-connector/src/main/java/org/eclipse/californium/elements/util/ExecutorsUtil.java")

Show comments

[View file](/eclipse-californium/californium/blob/726bac57659410da463dcf404b3e79a7312ac0b9/element-connector/src/main/java/org/eclipse/californium/elements/util/ExecutorsUtil.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -234,6 +234,25 @@ public static void shutdownExecutorGracefully(long timeMaxToWaitInMs, ExecutorSe |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Run all jobs. |
|  |  | \* |
|  |  | \* On {@link Throwable} write only warning and continue to run the other |
|  |  | \* jobs. |
|  |  | \* |
|  |  | \* @param jobs list of jobs to run. |
|  |  | \* @since 3.7 |
|  |  | \*/ |
|  |  | public static void runAll(List<Runnable> jobs) { |
|  |  | for (Runnable job : jobs) { |
|  |  | try { |
|  |  | job.run(); |
|  |  | } catch (Throwable e) { |
|  |  | LOGGER.warn("Ignoring error:", e); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set remove on cancel policy of provided executor. |
|  |  | \* |
| Expand Down | |  |

107 changes: 107 additions & 0 deletions

107
[element-connector/src/main/java/org/eclipse/californium/elements/util/LimitedRunnable.java](#diff-5cc0a409480267cb5a647326676dc32fe76dbd17e384da9f71d97d13664035ed "element-connector/src/main/java/org/eclipse/californium/elements/util/LimitedRunnable.java")

Show comments

[View file](/eclipse-californium/californium/blob/726bac57659410da463dcf404b3e79a7312ac0b9/element-connector/src/main/java/org/eclipse/californium/elements/util/LimitedRunnable.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,107 @@ |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Copyright (c) 2022 Contributors to the Eclipse Foundation. |
|  |  | \* |
|  |  | \* All rights reserved. This program and the accompanying materials |
|  |  | \* are made available under the terms of the Eclipse Public License v2.0 |
|  |  | \* and Eclipse Distribution License v1.0 which accompany this distribution. |
|  |  | \* |
|  |  | \* The Eclipse Public License is available at |
|  |  | \* http://www.eclipse.org/legal/epl-v20.html |
|  |  | \* and the Eclipse Distribution License is available at |
|  |  | \* http://www.eclipse.org/org/documents/edl-v10.html. |
|  |  | \* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | package org.eclipse.californium.elements.util; |
|  |  |  |
|  |  | import java.util.concurrent.Executor; |
|  |  | import java.util.concurrent.RejectedExecutionException; |
|  |  | import java.util.concurrent.atomic.AtomicInteger; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Limited jobs. |
|  |  | \* |
|  |  | \* Limits pending jobs based on counters. |
|  |  | \* |
|  |  | \* Note: for proper operation, ensure the at the end of |
|  |  | \* {@link Runnable#run()} the {@link LimitedRunnable#onDequeueing()} is |
|  |  | \* called. |
|  |  | \* |
|  |  | \* <pre> |
|  |  | \* public void run() { |
|  |  | \* try { |
|  |  | \* if (running.get() &amp;&amp; connection.isExecuting()) { |
|  |  | \* // process |
|  |  | \* } |
|  |  | \* } finally { |
|  |  | \* onDequeueing(); |
|  |  | \* } |
|  |  | \* } |
|  |  | \* </pre> |
|  |  | \* |
|  |  | \* @since 3.7 |
|  |  | \*/ |
|  |  | public abstract class LimitedRunnable implements Runnable { |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Down counter to limit pending jobs. |
|  |  | \*/ |
|  |  | private final AtomicInteger counter; |
|  |  | /\*\* |
|  |  | \* Indicator for overflows. {@code true}, if the counter indicates an |
|  |  | \* overflow, {@code false}, otherwise. |
|  |  | \*/ |
|  |  | private volatile boolean overflow; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Create job limited by the provided counter |
|  |  | \* |
|  |  | \* @param counter counter in count-down mode |
|  |  | \*/ |
|  |  | public LimitedRunnable(AtomicInteger counter) { |
|  |  | this.counter = counter; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Queue job. |
|  |  | \* |
|  |  | \* @throws RejectedExecutionException if limit is exceeded |
|  |  | \*/ |
|  |  | public void onQueueing() { |
|  |  | if (counter.decrementAndGet() < 0) { |
|  |  | overflow = true; |
|  |  | throw new RejectedExecutionException("queue overflow!"); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Dequeue job. |
|  |  | \*/ |
|  |  | public void onDequeueing() { |
|  |  | counter.incrementAndGet(); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Checks, if queueing this job causes an counter overflow. |
|  |  | \* |
|  |  | \* @return {@code true}, if the counter indicates an overflow, |
|  |  | \* {@code false}, otherwise. |
|  |  | \*/ |
|  |  | public boolean isOverflown() { |
|  |  | return overflow; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Execute this job. |
|  |  | \* |
|  |  | \* @param executor executor to execute jobs. |
|  |  | \*/ |
|  |  | public void execute(Executor executor) { |
|  |  | try { |
|  |  | onQueueing(); |
|  |  | executor.execute(this); |
|  |  | } catch (RejectedExecutionException ex) { |
|  |  | onDequeueing(); |
|  |  | throw ex; |
|  |  | } |
|  |  | } |
|  |  | } |

43 changes: 24 additions & 19 deletions

43
[element-connector/src/main/java/org/eclipse/californium/elements/util/SerialExecutor.java](#diff-9090d6518a8ca902457558ccedb997eac218fa5a99db452b32e8450386d760e2 "element-connector/src/main/java/org/eclipse/californium/elements/util/SerialExecutor.java")

Show comments

[View file](/eclipse-californium/californium/blob/726bac57659410da463dcf404b3e79a7312ac0b9/element-connector/src/main/java/org/eclipse/californium/elements/util/SerialExecutor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,10 +90,14 @@ public class SerialExecutor extends AbstractExecutorService { |
|  |  | \* |
|  |  | \* @param executor target executor. If {@code null}, the executor is |
|  |  | \* shutdown. |
|  |  | \* @throws IllegalArgumentException if the executor is also a |
|  |  | \* {@link SerialExecutor} |
|  |  | \*/ |
|  |  | public SerialExecutor(final Executor executor) { |
|  |  | if (executor == null) { |
|  |  | shutdown = true; |
|  |  | } else if (executor instanceof SerialExecutor) { |
|  |  | throw new IllegalArgumentException("Sequences of SerialExecutors are not supported!"); |
|  |  | } |
|  |  | this.executor = executor; |
|  |  | } |
| Expand Down  Expand Up | | @@ -211,7 +215,7 @@ public List<Runnable> shutdownNow() { |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Shutdown this executor and add all pending task from {@link #tasks} to |
|  |  | \* Shutdown this executor and add all pending jobs from {@link #tasks} to |
|  |  | \* the provided collection. |
|  |  | \* |
|  |  | \* @param jobs collection to add pending jobs. |
| Expand Down  Expand Up | | @@ -280,31 +284,31 @@ private final void scheduleNextJob() { |
|  |  | @Override |
|  |  | public void run() { |
|  |  | try { |
|  |  | setOwner(); |
|  |  | ExecutionListener current = listener.get(); |
|  |  | try { |
|  |  | setOwner(); |
|  |  | ExecutionListener current = listener.get(); |
|  |  | if (current != null) { |
|  |  | current.beforeExecution(); |
|  |  | } |
|  |  | command.run(); |
|  |  | } catch (Throwable t) { |
|  |  | LOGGER.error("unexpected error occurred:", t); |
|  |  | } finally { |
|  |  | try { |
|  |  | if (current != null) { |
|  |  | current.beforeExecution(); |
|  |  | current.afterExecution(); |
|  |  | } |
|  |  | command.run(); |
|  |  | } catch (Throwable t) { |
|  |  | LOGGER.error("unexpected error occurred:", t); |
|  |  | } finally { |
|  |  | try { |
|  |  | if (current != null) { |
|  |  | current.afterExecution(); |
|  |  | } |
|  |  | } catch (Throwable t) { |
|  |  | LOGGER.error("unexpected error occurred:", t); |
|  |  | } |
|  |  | clearOwner(); |
|  |  | LOGGER.error("unexpected error occurred after execution:", t); |
|  |  | } |
|  |  | } finally { |
|  |  | clearOwner(); |
|  |  | } |
|  |  | } finally { |
|  |  | try { |
|  |  | scheduleNextJob(); |
|  |  | } catch (RejectedExecutionException ex) { |
|  |  | LOGGER.debug("shutdown?", ex); |
|  |  | } |
|  |  | } catch (RejectedExecutionException ex) { |
|  |  | LOGGER.debug("shutdown?", ex); |
|  |  | } |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -332,7 +336,8 @@ public ExecutionListener setExecutionListener(ExecutionListener listener) { |
|  |  | /\*\* |
|  |  | \* Execution listener. |
|  |  | \* |
|  |  | \* Called before and after executing a task. |
|  |  | \* Called before and after executing a task. The calling thread is the same |
|  |  | \* as the the one executing the job. |
|  |  | \* |
|  |  | \* @since 2.4 |
|  |  | \*/ |
| Expand Down | |  |

25 changes: 25 additions & 0 deletions

25
[scandium-core/api-changes.json](#diff-c0e6ce03968eccf2b017e42e8afcb6cee42af99b9c51bcba7ac53b83436765e9 "scandium-core/api-changes.json")

Show comments

[View file](/eclipse-californium/californium/blob/726bac57659410da463dcf404b3e79a7312ac0b9/scandium-core/api-changes.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -400,5 +400,30 @@ |
|  |  | ] |
|  |  | } |
|  |  | } |
|  |  | ], |
|  |  | "3.7.0": [ |
|  |  | { |
|  |  | "extension": "revapi.differences", |
|  |  | "configuration": { |
|  |  | "ignore": true, |
|  |  | "differences": [ |
|  |  | { |
|  |  | "code": "java.method.removed", |
|  |  | "old": "method boolean org.eclipse.californium.scandium.DTLSConnector::executeHandshakeResult(java.util.concurrent.Executor, org.eclipse.californium.scandium.dtls.Connection, java.lang.Runnable)", |
|  |  | "justification": "Not part of the public API" |
|  |  | }, |
|  |  | { |
|  |  | "code": "java.method.removed", |
|  |  | "old": "method boolean org.eclipse.californium.scandium.DTLSConnector::executeInbound(java.util.concurrent.Executor, java.net.InetSocketAddress, java.lang.Runnable)", |
|  |  | "justification": "Not part of the public API" |
|  |  | }, |
|  |  | { |
|  |  | "code": "java.method.removed", |
|  |  | "old": "method boolean org.eclipse.californium.scandium.DTLSConnector::executeOutbound(java.util.concurrent.Executor, java.net.InetSocketAddress, java.lang.Runnable)", |
|  |  | "justification": "Not part of the public API" |
|  |  | } |
|  |  | ] |
|  |  | } |
|  |  | } |
|  |  | ] |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `726bac5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F726bac57659410da463dcf404b3e79a7312ac0b9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bcb67b2d_20250114_234804.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fsecurity%2Fadvisories%2FGHSA-p72g-cgh9-ghjg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fsecurity%2Fadvisories%2FGHSA-p72g-cgh9-ghjg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   730](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  15](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

# Failing DTLS handshakes may cause throttling to block processing of records

High

[boaks](/boaks)
published
GHSA-p72g-cgh9-ghjg
Nov 9, 2022

## Package

maven

org.eclipse.californium:scandium
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 2.7.4, < 3.7.0

## Patched versions

2.7.4, 3.7.0

## Description

### Impact

Failing handshakes didn't cleanup counters for throttling. In consequence the threshold may get reached and will not be released again. The results in permanently dropping records. The issues was reported for certificate based handshakes, but it can't be excluded, that this happens also for PSK based handshakes. It generally affects client and server as well.

### Patches

main: commit [726bac5](https://github.com/eclipse-californium/californium/commit/726bac57659410da463dcf404b3e79a7312ac0b9)

2.7.x: commit [5648a0c](https://github.com/eclipse-californium/californium/commit/5648a0c27c2c2667c98419254557a14bac2b1f3f)

Users are requested to update to 3.7.0. If Californium 2 support is required, users are requested to update to 2.7.4.

### Workarounds

none.

### For more information

[Issue 2065](https://github.com/eclipse-californium/californium/issues/2065)

[CWE 452](https://cwe.mitre.org/data/definitions/452.html)

### Severity

High

### CVE ID

CVE-2022-39368

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7e6ec407_20250114_234759.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F5648a0c27c2c2667c98419254557a14bac2b1f3f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F5648a0c27c2c2667c98419254557a14bac2b1f3f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=eclipse-californium%2Fcalifornium)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[eclipse-californium](/eclipse-californium)
/
**[californium](/eclipse-californium/californium)**
Public

* [Notifications](/login?return_to=%2Feclipse-californium%2Fcalifornium) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Feclipse-californium%2Fcalifornium)
* [Star
   730](/login?return_to=%2Feclipse-californium%2Fcalifornium)

* [Code](/eclipse-californium/californium)
* [Issues
  15](/eclipse-californium/californium/issues)
* [Pull requests
  0](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects
  0](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

Additional navigation options

* [Code](/eclipse-californium/californium)
* [Issues](/eclipse-californium/californium/issues)
* [Pull requests](/eclipse-californium/californium/pulls)
* [Actions](/eclipse-californium/californium/actions)
* [Projects](/eclipse-californium/californium/projects)
* [Wiki](/eclipse-californium/californium/wiki)
* [Security](/eclipse-californium/californium/security)
* [Insights](/eclipse-californium/californium/pulse)

## Commit

[Permalink](/eclipse-californium/californium/commit/5648a0c27c2c2667c98419254557a14bac2b1f3f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Run all pending job on removing connections.

[Browse files](/eclipse-californium/californium/tree/5648a0c27c2c2667c98419254557a14bac2b1f3f)
Browse the repository at this point in the history

```
Prevent gaps in pendingOutboundMessagesCountdown.

Signed-off-by: Achim Kraus <achim.kraus@cloudcoap.net>
```

* Loading branch information

[![@boaks](https://avatars.githubusercontent.com/u/10937819?s=40&v=4)](/boaks)

[boaks](/eclipse-californium/californium/commits?author=boaks "View all commits by boaks")
committed
Sep 19, 2022

1 parent
[9112803](/eclipse-californium/californium/commit/9112803a20152d1386415a4418e639919f8ac12b)

commit 5648a0c

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**21 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* scandium-core/src/main/java/org/eclipse/californium/scandium

  + scandium-core/src/main/java/org/eclipse/californium/scandium/DTLSConnector.java
    [DTLSConnector.java](#diff-251342662f1cfb83e80d989bf21c084240b9b92cd4dc20963c8e3d6da0e1fa79)
  + dtls

    - scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java
      [InMemoryConnectionStore.java](#diff-2a5ae2cb43f6404d7363d9b183ac59df6b19a5b24a2e4b3f53e50c21c3a63d1d)

## There are no files selected for viewing

10 changes: 5 additions & 5 deletions

10
[scandium-core/src/main/java/org/eclipse/californium/scandium/DTLSConnector.java](#diff-251342662f1cfb83e80d989bf21c084240b9b92cd4dc20963c8e3d6da0e1fa79 "scandium-core/src/main/java/org/eclipse/californium/scandium/DTLSConnector.java")

Show comments

[View file](/eclipse-californium/californium/blob/5648a0c27c2c2667c98419254557a14bac2b1f3f/scandium-core/src/main/java/org/eclipse/californium/scandium/DTLSConnector.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1035,7 +1035,7 @@ public void stop() { |
|  |  | for (Runnable job : pending) { |
|  |  | try { |
|  |  | job.run(); |
|  |  | } catch (Exception e) { |
|  |  | } catch (Throwable e) { |
|  |  | LOGGER.warn("Shutdown DTLS connector:", e); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -1401,7 +1401,7 @@ public void run() { |
|  |  |  |
|  |  | @Override |
|  |  | public void run() { |
|  |  | if (running.get()) { |
|  |  | if (running.get() && connection.isExecuting()) { |
|  |  | processRecord(record, connection); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -1971,7 +1971,7 @@ public void run() { |
|  |  | connection.getExecutor().execute(new Runnable() { |
|  |  | @Override |
|  |  | public void run() { |
|  |  | if (running.get()) { |
|  |  | if (running.get() && connections.getConnectionByAddress().isExecuting()) { |
|  |  | processClientHello(clientHello, record, connections); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -2399,7 +2399,7 @@ public void send(final RawData message) { |
|  |  | @Override |
|  |  | public void run() { |
|  |  | try { |
|  |  | if (running.get()) { |
|  |  | if (running.get() && connection.isExecuting()) { |
|  |  | sendMessage(now, message, connection); |
|  |  | } else { |
|  |  | DROP\_LOGGER.trace("DTLSConnector drops {} outgoing bytes to {}:{}, connector not running!", message.getSize(), message.getAddress(), message.getPort()); |
| Expand Down  Expand Up | | @@ -2816,7 +2816,7 @@ private void processAsynchronousHandshakeResult(final HandshakeResult handshakeR |
|  |  |  |
|  |  | @Override |
|  |  | public void run() { |
|  |  | if (running.get()) { |
|  |  | if (running.get() && connection.isExecuting()) { |
|  |  | Handshaker handshaker = connection.getOngoingHandshake(); |
|  |  | if (handshaker != null) { |
|  |  | try { |
| Expand Down | |  |

20 changes: 16 additions & 4 deletions

20
[...ium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java](#diff-2a5ae2cb43f6404d7363d9b183ac59df6b19a5b24a2e4b3f53e50c21c3a63d1d "scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java")

Show comments

[View file](/eclipse-californium/californium/blob/5648a0c27c2c2667c98419254557a14bac2b1f3f/scandium-core/src/main/java/org/eclipse/californium/scandium/dtls/InMemoryConnectionStore.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -534,15 +534,27 @@ public boolean remove(final Connection connection) { |
|  |  | public synchronized boolean remove(final Connection connection, final boolean removeFromSessionCache) { |
|  |  | boolean removed = connections.remove(connection.getConnectionId(), connection) == connection; |
|  |  | if (removed) { |
|  |  | List<Runnable> pendings = connection.getExecutor().shutdownNow(); |
|  |  | int pending = 0; |
|  |  | SerialExecutor executor = connection.getExecutor(); |
|  |  | if (executor != null) { |
|  |  | List<Runnable> pendings = connection.getExecutor().shutdownNow(); |
|  |  | for (Runnable job : pendings) { |
|  |  | try { |
|  |  | job.run(); |
|  |  | } catch (Throwable e) { |
|  |  | LOG.warn("Removing connection:", e); |
|  |  | } |
|  |  | } |
|  |  | pending = pendings.size(); |
|  |  | } |
|  |  | if (LOG.isTraceEnabled()) { |
|  |  | LOG.trace("{}connection: remove {} (size {}, left jobs: {})", tag, connection, connections.size(), |
|  |  | pendings.size(), new Throwable("connection removed!")); |
|  |  | } else if (pendings.isEmpty()) { |
|  |  | pending, new Throwable("connection removed!")); |
|  |  | } else if (pending == 0) { |
|  |  | LOG.debug("{}connection: remove {} (size {})", tag, connection, connections.size()); |
|  |  | } else { |
|  |  | LOG.debug("{}connection: remove {} (size {}, left jobs: {})", tag, connection, connections.size(), |
|  |  | pendings.size()); |
|  |  | pending); |
|  |  | } |
|  |  | removeFromEstablishedSessions(connection); |
|  |  | removeFromAddressConnections(connection); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5648a0c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feclipse-californium%2Fcalifornium%2Fcommit%2F5648a0c27c2c2667c98419254557a14bac2b1f3f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


