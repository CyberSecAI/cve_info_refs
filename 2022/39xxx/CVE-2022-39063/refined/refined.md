- **Root cause of vulnerability**: A buffer overflow vulnerability exists in the Open5GS UPF (User Plane Function) when processing PFCP Session Establishment Requests. The vulnerability stems from a lack of proper validation of the `pdi.local_f_teid.len` field, which is used in a `memcpy` operation to copy data into the `f_teid` structure. If `pdi.local_f_teid.len` exceeds the size of `f_teid`, it leads to a buffer overflow, overwriting adjacent memory.
- **Weaknesses/vulnerabilities present**: The primary vulnerability is a buffer overflow due to insufficient validation of the length parameter before using `memcpy`. Specifically, the length of data being copied from the incoming PFCP message is not checked against the buffer size it's being copied into.
- **Impact of exploitation**: Successful exploitation of this vulnerability leads to a denial-of-service (DoS) condition. The buffer overflow causes a segmentation fault, crashing the Open5GS UPF process and disrupting the LTE/5G mobile packet core network.
- **Attack vectors**: The attack vector involves sending a specially crafted PFCP Session Establishment Request to the Open5GS UPF. Specifically, the `PDR.F-TEID.IPv6-Address` field needs to be set to a duplicated IPv6 address, and the `pdi.local_f_teid.len` field should contain a value greater than the size of the `f_teid` structure.
- **Required attacker capabilities/position**: The attacker needs the ability to connect to the Open5GS UPF port (8805) for the PFCP protocol. They also need to be capable of constructing and sending a malicious PFCP Session Establishment Request. No special privileges are needed.