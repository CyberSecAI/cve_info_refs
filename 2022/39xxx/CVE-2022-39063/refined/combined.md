=== Content from www.synopsys.com_83b9bb08_20250115_100328.html ===


The Synopsys Software Integrity Group is now Black Duck®. [Learn More](/blog/our-new-beginning-as-black-duck.html)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)

[Build trust in your software](/)

* [Support](https://community.blackduck.com)
* English
* 日本語
* 简体中文

close search bar

Sorry, not available in this language yet

close language selection

* English
* 日本語

* [Manage Security Risks](/blog/category.manage-security-risks.html)
* [Build Security into DevOps](/blog/category.build-secure-software.html)
* [Secure the Software Supply Chain](/blog/category.software-supply-chain.html)
* [Security News & Trends](/blog/category.security-news-research.html)
* [Contact Sales](/contact-sales.html)

* [Blog Home](/blog.html)

# CyRC Vulnerability Advisory: Denial-of-service vulnerabilities (CVE-2022-39063) in Open5GS

[Black Duck Editorial Staff](/blog/authors/black-duck-editorial-team.html)

Sep 13, 2022
/
2 min read

Table of Contents

* Exploitation
* Affected software
* Impact
* Remediation
* Discovery credit
* Timeline
* About CVSS

## Subscribe

##

The Black Duck Cybersecurity Research Center (CyRC) has exposed a denial-of-service vulnerability in Open5GS. Open5GS is an open source project that provides LTE and 5G mobile packet core network functionalities with an AGPLv3 or commercial license. It can be used to build private LTE/5G telecom networks by individuals or telecom network operators.

When Open5GS UPF receives a PFCP Session Establishment Request, it stores related values for building the PFCP Session Establishment Response. The following source code in open5gs/lib/pfcp/handler.c causes this issue.

/\* Code block for parsing incoming PFCP Session Establishment Request. \*/

if (message-&gt;pdi.local\_f\_teid.presence) {

pdr-&gt;f\_teid\_len = message-&gt;pdi.local\_f\_teid.len;

memcpy(&amp;pdr-&gt;f\_teid, message-&gt;pdi.local\_f\_teid.data, pdr-&gt;f\_teid\_len);

pdr-&gt;f\_teid.teid = be32toh(pdr-&gt;f\_teid.teid);

}

...

/\* Code block for building outgoing PFCP Session Establishment Response. \*/

if (pdr-&gt;f\_teid\_len) {

memcpy(&amp;pdrbuf[i].f\_teid, &amp;pdr-&gt;f\_teid, pdr-&gt;f\_teid\_len);

pdrbuf[i].f\_teid.teid = htobe32(pdr-&gt;f\_teid.teid);

message-&gt;local\_f\_teid.presence = 1;

message-&gt;local\_f\_teid.data = &amp;pdrbuf[i].f\_teid;

message-&gt;local\_f\_teid.len = pdr-&gt;f\_teid\_len;

}

Once UPF receives a request, it gets the f\_teid\_len from incoming message, and then uses it to copy data from incoming message to struct f\_teid without checking the maximum length. If the pdi.local\_f\_teid.len exceeds the maximum length of the struct of f\_teid, the memcpy() overwrites the fields (e.g., f\_teid\_len) after f\_teid in the pdr struct. After parsing the request, the UPF starts to build a response. The f\_teid\_len with its overwritten value is used as a length for memcpy(). A segmentation fault occurs if this overwritten value is large enough.

This vulnerability is caused by a memcpy() that doesn’t have the maximum length of the source and target structure validated, so a buffer overflow attack exploit is possible.

## Exploitation

When connecting to the Open5GS UPF port (8805) for the PFCP protocol and sending an PFCP Association Setup Request followed by a PFCP Session Establishment Request with PDR.F-TEID.IPv6-Address set to a duplicated IPv6 address [e.g., 16(0xff) 16(0xff)], this buffer overflow attack causes a segmentation fault in [Open5GS](https://open5gs.org/).

## Affected software

Open5GS 2.4.9 and earlier versions

## Impact

Exploitation of this vulnerability would lead to a denial-of-service for the LTE/5G mobile packet core network.

CVSS 3.1 base score: 8.2 (high)

CVSS 3.1 vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H/E:P/RL:O/RC:C)

## Remediation

Black Duck recommends upgrading to Open5GS commit 444e182 or later. The vulnerability is patched as of commit d99491a on August 12, 2022, and commit 444e182 on August 14, 2022.

## Discovery credit

Qiang Li from the [Black Duck Cybersecurity Research Center (CyRC)](/resources/cybersecurity-research-center.html) in Wuhan, China, discovered the issue using the [Defensics® fuzz testing tool](/fuzz-testing.html).

## Timeline

* August 10, 2022: Initial disclosure
* August 16, 2022: Open5GS confirms vulnerability
* August 17, 2022: Black Duck validates the fix
* September 9, 2022: Open5GS version 2.4.10 is released – fixing the bug
* September 14, 2022: Black Duck publishes advisory

## About CVSS

FIRST.Org, Inc (FIRST) is a non-profit organization based out of US that owns and manages CVSS. It is not required to be a member of FIRST to utilize or implement CVSS but FIRST does require any individual or organization give appropriate attribution while using CVSS. FIRST also states that any individual or organization that publishes scores follow the guideline so that anyone can understand how the score was calculated.

* [CyRC](/blog/category.cyrc.html "CyRC")
* [Fuzzing](/blog/category.fuzzing.html "Fuzzing")
* [Security News & Trends](/blog/category.security-news-research.html "Security News & Trends")

## Continue Reading

[![Forrester recognizes Black Duck as a Leader in software composition analysis](https://www.blackduck.com/content/dam/black-duck/blogs/thumbnails/blackduck-logo-thumbnail.png)](/blog/forrester-wave-sca.html "Forrester recognizes Black Duck as a Leader in software composition analysis")

#### [Forrester recognizes Black Duck as a Leader in software composition analysis](/blog/forrester-wave-sca.html)

![Mike McGuire](/content/dam/black-duck/blogs/application-security/authors/Mike-McGuire.jpg)

By
[Mike McGuire](/blog/authors/mike-mcguire.html)

Nov 13, 2024
/
3 min read

Tags:
[SCA](/blog/category.sca.html),
[Security News & Trends](/blog/category.security-news-research.html)

[![Software Vulnerability Snapshot Report Findings](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/SVS-cover-image-350x200.jpg)](/blog/software-vulnerability-snapshot-report-findings.html "Software Vulnerability Snapshot Report Findings")

#### [Software Vulnerability Snapshot Report Findings](/blog/software-vulnerability-snapshot-report-findings.html)

![Fred Bals](/content/dam/black-duck/blogs/application-security/authors/Fred-Bals.jpg)

By
[Fred Bals](/blog/authors/fred-bals.html)

Nov 12, 2024
/
3 min read

Tags:
[DAST](/blog/category.dast.html),
[Security News & Trends](/blog/category.security-news-research.html),
[Web AppSec](/blog/category.web-appsec.html)

[![Key insights from Black Duck’s 2024 Global State of DevSecOps report](https://www.blackduck.com/content/dam/black-duck/blogs/application-security/thumbnails/global-state-devsecops-thumbnail.jpg)](/blog/black-duck-devsecops-report.html "Key insights from Black Duck’s 2024 Global State of DevSecOps report")

#### [Key insights from Black Duck’s 2024 Global State of DevSecOps report](/blog/black-duck-devsecops-report.html)

![Fred Bals](/content/dam/black-duck/blogs/application-security/authors/Fred-Bals.jpg)

By
[Fred Bals](/blog/authors/fred-bals.html)

Oct 08, 2024
/
5 min read

Tags:
[Security News & Trends](/blog/category.security-news-research.html),
[DevSecOps](/blog/category.devsecops.html)

##

## Explore Topics

[Agile, CI/CD](/blog/category.agile-ci-cd.html)
[AppSec Best Practices](/blog/category.appsec-best-practices.html)
[Artificial Intelligence](/blog/category.artificial-intelligence.html)
[Automotive](/blog/category.automotive.html)
[Build Security into DevOps](/blog/category.build-secure-software.html)
[Cloud Security](/blog/category.cloud-security.html)
[Compliance](/blog/category.compliance.html)
[Container Security](/blog/category.container-security.html)
[CyRC](/blog/category.cyrc.html)
[DevSecOps](/blog/category.devsecops.html)
[DAST](/blog/category.dast.html)
[Financial Services](/blog/category.financial-services.html)
[Fuzzing](/blog/category.fuzzing.html)
[Healthcare](/blog/category.healthcare.html)
[IAST](/blog/category.iast.html)
[Internet of Things](/blog/category.iot.html)
[M&A](/blog/category.m-a.html)
[Manage Security Risks](/blog/category.manage-security-risks.html)
[Medical Devices](/blog/category.medical-devices.html)
[Mobile](/blog/category.mobile.html)
[Orchestration & Correlation](/blog/category.orchestration-correlation.html)
[OSS License Compliance](/blog/category.oss-license-compliance.html)
[Pen Testing](/blog/category.pen-testing.html)
[Program Strategy & Planning](/blog/category.program-strategy-planning.html)
[Public Sector](/blog/category.public-sector.html)
[SAST](/blog/category.sast.html)
[SCA](/blog/category.sca.html)
[Secure the Software Supply Chain](/blog/category.software-supply-chain.html)
[Security News & Trends](/blog/category.security-news-research.html)
[Threat Modeling](/blog/category.threat-modeling.html)
[Threat & Risk Assessment](/blog/category.threat-risk-assessment.html)
[Training](/blog/category.training.html)
[Web Application Security](/blog/category.web-appsec.html)

[![Black Duck Home Page](/content/dam/black-duck/en-us/images/BlackDuckLogo-OnDark.svg)](/)
### Follow

[Manage Email Preferences](https://go.blackduck.com/email-subscription-center.html)

Manage Cookie Settings

 [800 District Ave. Ste 201
Burlington, MA 01803](https://www.google.com/maps/place/800%2BDistrict%2BAve%2B%23101%2C%2BBurlington%2C%2BMA%2B01803/%4042.4824129%2C-71.28993%2C12z/data%3D%214m5%213m4%211s0x89e39e3082ec0bb9%3A0x4f2eda58614dd0d9%218m2%213d42.482409%214d-71.2075325?entry=ttu)

[Contact Us](/contact-sales.html)

### Solutions

* [AI-generated Code](/solutions/artificial-intelligence-software-development.html)
* [API Security Testing](/solutions/api-security-testing.html)
* [AppSec Consolidation](/solutions/appsec-consolidation.html)
* [Application Security Testing](/solutions/application-security-testing.html)
* [DevSecOps](/solutions/devsecops.html)
* [Software Supply Chain Security](/solutions/software-supply-chain-security.html)
* [Manage AppSec Risk](/solutions/enterprise-application-security-risk-management.html)
* [Cloud & Container Security](/solutions/cloud-security.html)
* [Open Source License Compliance](/solutions/open-source-security.html)
* [M&A Due Diligence](/solutions/mergers-and-acquisitions.html)
* [Quality & Security Standards Compliance](/solutions/compliance.html)

### Products & Services

* [AppSec SaaS Platform](/platform.html)
* [Static Analysis (SAST)](/static-analysis-tools-sast.html)
* [Software Composition Analysis (SCA)](/software-composition-analysis-tools.html)
* [Interactive Analysis (IAST)](/interactive-application-security-testing.html)
* [Dynamic Analysis (DAST)](/dast.html)
* [Penetration Testing](/services/penetration-testing.html)
* [Protocol Fuzzing](/fuzz-testing.html)
* [AppSec Program Services](/services/security-program.html)
* [Threat & Risk Assessments](/services/security-program/software-architecture-design.html)

### Support

* [Community](https://community.blackduck.com/)
* [Documentation](https://documentation.blackduck.com)
* [Product Education](https://blackduck.skilljar.com/)
* [AppSec Training](/training.html)
* [Add-On Services](/customer-success.html)

### Resources

* [Resources Center](/resources.html)
* [Webinars](/resources/webinars.html)
* [Demos](/contact-sales.html)
* [Research & Reports](/resources/analyst-reports.html)
* [eBooks](/resources/ebooks.html)
* [White Papers](/resources/white-papers.html)
* [Blog](/blog.html)

### Explore more

* [About us](/company.html)
* [Contact sales](/contact-sales.html)
* [Customer stories](/resources/case-studies.html)
* [Partners](/partners.html)
* [Newsroom](https://news.blackduck.com)
* [Careers](/company/careers.html)
* [Glossary](/glossary.html)

### Legal

* [Agreements](/company/legal.html)
* [Privacy](/company/legal/privacy-policy.html)
* [Security](/company/legal/vulnerability-disclosure-policy.html)

©2025 Black Duck Software, Inc. All Rights Reserved


