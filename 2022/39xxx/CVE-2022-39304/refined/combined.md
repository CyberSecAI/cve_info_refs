=== Content from github.com_ceb15df0_20250115_083214.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fblob%2F24e56b3fb7669f209134a01eff731d7e2ef72a5c%2Ftransport.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fblob%2F24e56b3fb7669f209134a01eff731d7e2ef72a5c%2Ftransport.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=bradleyfalzon%2Fghinstallation)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bradleyfalzon](/bradleyfalzon)
/
**[ghinstallation](/bradleyfalzon/ghinstallation)**
Public

* [Notifications](/login?return_to=%2Fbradleyfalzon%2Fghinstallation) You must be signed in to change notification settings
* [Fork
  101](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)
* [Star
   320](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)

* [Code](/bradleyfalzon/ghinstallation)
* [Issues
  9](/bradleyfalzon/ghinstallation/issues)
* [Pull requests
  5](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects
  0](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

Additional navigation options

* [Code](/bradleyfalzon/ghinstallation)
* [Issues](/bradleyfalzon/ghinstallation/issues)
* [Pull requests](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

## Files

 24e56b3
## Breadcrumbs

1. [ghinstallation](/bradleyfalzon/ghinstallation/tree/24e56b3fb7669f209134a01eff731d7e2ef72a5c)
/
# transport.go

Copy path Blame  Blame
## Latest commit

## History

[History](/bradleyfalzon/ghinstallation/commits/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go)191 lines (165 loc) · 6.57 KB 24e56b3
## Breadcrumbs

1. [ghinstallation](/bradleyfalzon/ghinstallation/tree/24e56b3fb7669f209134a01eff731d7e2ef72a5c)
/
# transport.go

Top
## File metadata and controls

* Code
* Blame

191 lines (165 loc) · 6.57 KB[Raw](https://github.com/bradleyfalzon/ghinstallation/raw/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191package ghinstallation
import ( "bytes" "context" "encoding/json" "fmt" "io" "io/ioutil" "net/http" "sync" "time"
 "github.com/google/go-github/v29/github")
const ( // acceptHeader is the GitHub Apps Preview Accept header. acceptHeader = "application/vnd.github.machine-man-preview+json" apiBaseURL = "https://api.github.com")
// Transport provides a http.RoundTripper by wrapping an existing// http.RoundTripper and provides GitHub Apps authentication as an// installation.//// Client can also be overwritten, and is useful to change to one which// provides retry logic if you do experience retryable errors.//// See https://developer.github.com/apps/building-integrations/setting-up-and-registering-github-apps/about-authentication-options-for-github-apps/type Transport struct { BaseURL string // BaseURL is the scheme and host for GitHub API, defaults to https://api.github.com Client Client // Client to use to refresh tokens, defaults to http.Client with provided transport tr http.RoundTripper // tr is the underlying roundtripper being wrapped appID int64 // appID is the GitHub App's ID installationID int64 // installationID is the GitHub App Installation ID InstallationTokenOptions \*github.InstallationTokenOptions // parameters restrict a token's access appsTransport \*AppsTransport
 mu \*sync.Mutex // mu protects token token \*accessToken // token is the installation's access token}
// accessToken is an installation access token response from GitHubtype accessToken struct { Token string `json:"token"` ExpiresAt time.Time `json:"expires\_at"` Permissions github.InstallationPermissions `json:"permissions,omitempty"` Repositories []github.Repository `json:"repositories,omitempty"`}
var \_ http.RoundTripper = &Transport{}
// NewKeyFromFile returns a Transport using a private key from file.func NewKeyFromFile(tr http.RoundTripper, appID, installationID int64, privateKeyFile string) (\*Transport, error) { privateKey, err := ioutil.ReadFile(privateKeyFile) if err != nil { return nil, fmt.Errorf("could not read private key: %s", err) } return New(tr, appID, installationID, privateKey)}
// Client is a HTTP client which sends a http.Request and returns a http.Response// or an error.type Client interface { Do(\*http.Request) (\*http.Response, error)}
// New returns an Transport using private key. The key is parsed// and if any errors occur the error is non-nil.//// The provided tr http.RoundTripper should be shared between multiple// installations to ensure reuse of underlying TCP connections.//// The returned Transport's RoundTrip method is safe to be used concurrently.func New(tr http.RoundTripper, appID, installationID int64, privateKey []byte) (\*Transport, error) { atr, err := NewAppsTransport(tr, appID, privateKey) if err != nil { return nil, err }
 return NewFromAppsTransport(atr, installationID), nil}
// NewFromAppsTransport returns a Transport using an existing \*AppsTransport.func NewFromAppsTransport(atr \*AppsTransport, installationID int64) \*Transport { return &Transport{ BaseURL: atr.BaseURL, Client: &http.Client{Transport: atr.tr}, tr: atr.tr, appID: atr.appID, installationID: installationID, appsTransport: atr, mu: &sync.Mutex{}, }}
// RoundTrip implements http.RoundTripper interface.func (t \*Transport) RoundTrip(req \*http.Request) (\*http.Response, error) { token, err := t.Token(req.Context()) if err != nil { return nil, err }
 req.Header.Set("Authorization", "token "+token) req.Header.Add("Accept", acceptHeader) // We add to "Accept" header to avoid overwriting existing req headers. resp, err := t.tr.RoundTrip(req) return resp, err}
// Token checks the active token expiration and renews if necessary. Token returns// a valid access token. If renewal fails an error is returned.func (t \*Transport) Token(ctx context.Context) (string, error) { t.mu.Lock() defer t.mu.Unlock() if t.token == nil || t.token.ExpiresAt.Add(-time.Minute).Before(time.Now()) { // Token is not set or expired/nearly expired, so refresh if err := t.refreshToken(ctx); err != nil { return "", fmt.Errorf("could not refresh installation id %v's token: %s", t.installationID, err) } }
 return t.token.Token, nil}
// Permissions returns a transport token's GitHub installation permissions.func (t \*Transport) Permissions() (github.InstallationPermissions, error) { if t.token == nil { return github.InstallationPermissions{}, fmt.Errorf("Permissions() = nil, err: nil token") } return t.token.Permissions, nil}
// Repositories returns a transport token's GitHub repositories.func (t \*Transport) Repositories() ([]github.Repository, error) { if t.token == nil { return nil, fmt.Errorf("Repositories() = nil, err: nil token") } return t.token.Repositories, nil}
func (t \*Transport) refreshToken(ctx context.Context) error { // Convert InstallationTokenOptions into a ReadWriter to pass as an argument to http.NewRequest. body, err := GetReadWriter(t.InstallationTokenOptions) if err != nil { return fmt.Errorf("could not convert installation token parameters into json: %s", err) }
 req, err := http.NewRequest("POST", fmt.Sprintf("%s/app/installations/%v/access\_tokens", t.BaseURL, t.installationID), body) if err != nil { return fmt.Errorf("could not create request: %s", err) }
 // Set Content and Accept headers. if body != nil { req.Header.Set("Content-Type", "application/json") } req.Header.Set("Accept", acceptHeader)
 if ctx != nil { req = req.WithContext(ctx) }
 t.appsTransport.BaseURL = t.BaseURL t.appsTransport.Client = t.Client resp, err := t.appsTransport.RoundTrip(req) if err != nil { return fmt.Errorf("could not get access\_tokens from GitHub API for installation ID %v: %v", t.installationID, err) } defer resp.Body.Close()
 if resp.StatusCode/100 != 2 { return fmt.Errorf("request %+v received non 2xx response status %q with body %+v and TLS %+v", resp.Request, resp.Body, resp.Request, resp.TLS) }
 return json.NewDecoder(resp.Body).Decode(&t.token)}
// GetReadWriter converts a body interface into an io.ReadWriter object.func GetReadWriter(i interface{}) (io.ReadWriter, error) { var buf io.ReadWriter if i != nil { buf = new(bytes.Buffer) enc := json.NewEncoder(buf) err := enc.Encode(i) if err != nil { return nil, err } } return buf, nil}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.github.com_c0d35113_20250115_083211.html ===
[Skip to main content](#main-content)[GitHub Docs](/en)Version: Free, Pro, & TeamSearch GitHub DocsSearchSelect language: current language is EnglishOpen Search BarClose Search BarOpen MenuOpen Sidebar

* [Apps](/en/apps "Apps")/
* [Creating GitHub Apps](/en/apps/creating-github-apps "Creating GitHub Apps")/
* [Authenticate with a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app "Authenticate with a GitHub App")/
* [About authentication](/en/apps/creating-github-apps/authenticating-with-a-github-app/about-authentication-with-a-github-app "About authentication")
[Home](/en)[Apps](/en/apps)

* [Overview](/en/apps/overview)
* Using GitHub Apps
  + [About using apps](/en/apps/using-github-apps/about-using-github-apps)
  + [Install from Marketplace for user](/en/apps/using-github-apps/installing-a-github-app-from-github-marketplace-for-your-personal-account)
  + [Install from Marketplace for org](/en/apps/using-github-apps/installing-a-github-app-from-github-marketplace-for-your-organizations)
  + [Install from third party](/en/apps/using-github-apps/installing-a-github-app-from-a-third-party)
  + [Install your own app](/en/apps/using-github-apps/installing-your-own-github-app)
  + [Request for org](/en/apps/using-github-apps/requesting-a-github-app-from-your-organization-owner)
  + [Authorize](/en/apps/using-github-apps/authorizing-github-apps)
  + [Approve new permissions](/en/apps/using-github-apps/approving-updated-permissions-for-a-github-app)
  + [Review your authorizations](/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps)
  + [Review installations](/en/apps/using-github-apps/reviewing-and-modifying-installed-github-apps)
  + [Internal apps](/en/apps/using-github-apps/internal-github-apps)
* Creating GitHub Apps
  + About creating GitHub Apps
    - [About creating apps](/en/apps/creating-github-apps/about-creating-github-apps/about-creating-github-apps)
    - [GitHub App versus other options](/en/apps/creating-github-apps/about-creating-github-apps/deciding-when-to-build-a-github-app)
    - [Best practices](/en/apps/creating-github-apps/about-creating-github-apps/best-practices-for-creating-a-github-app)
    - [Migrate from OAuth apps](/en/apps/creating-github-apps/about-creating-github-apps/migrating-oauth-apps-to-github-apps)
  + Registering a GitHub App
    - [Register a GitHub App](/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app)
    - [Callback URL](/en/apps/creating-github-apps/registering-a-github-app/about-the-user-authorization-callback-url)
    - [Setup URL](/en/apps/creating-github-apps/registering-a-github-app/about-the-setup-url)
    - [Permissions](/en/apps/creating-github-apps/registering-a-github-app/choosing-permissions-for-a-github-app)
    - [Webhooks](/en/apps/creating-github-apps/registering-a-github-app/using-webhooks-with-github-apps)
    - [Visibility](/en/apps/creating-github-apps/registering-a-github-app/making-a-github-app-public-or-private)
    - [Rate limits](/en/apps/creating-github-apps/registering-a-github-app/rate-limits-for-github-apps)
    - [Custom badge](/en/apps/creating-github-apps/registering-a-github-app/creating-a-custom-badge-for-your-github-app)
  + Authenticate with a GitHub App
    - [About authentication](/en/apps/creating-github-apps/authenticating-with-a-github-app/about-authentication-with-a-github-app)
    - [Authenticate as an app](/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app)
    - [Authenticate as an installation](/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app-installation)
    - [Authenticate on behalf of users](/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-with-a-github-app-on-behalf-of-a-user)
    - [Manage private keys](/en/apps/creating-github-apps/authenticating-with-a-github-app/managing-private-keys-for-github-apps)
    - [Generate a JWT](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-a-json-web-token-jwt-for-a-github-app)
    - [Generate an installation access token](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-an-installation-access-token-for-a-github-app)
    - [Generate a user access token](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-a-user-access-token-for-a-github-app)
    - [Refresh user access tokens](/en/apps/creating-github-apps/authenticating-with-a-github-app/refreshing-user-access-tokens)
    - [Authenticate in Actions workflow](/en/apps/creating-github-apps/authenticating-with-a-github-app/making-authenticated-api-requests-with-a-github-app-in-a-github-actions-workflow)
  + Writing code for a GitHub App
    - [About writing GitHub App code](/en/apps/creating-github-apps/writing-code-for-a-github-app/about-writing-code-for-a-github-app)
    - [Quickstart](/en/apps/creating-github-apps/writing-code-for-a-github-app/quickstart)
    - [Respond to webhooks](/en/apps/creating-github-apps/writing-code-for-a-github-app/building-a-github-app-that-responds-to-webhook-events)
    - [Build a "Login" button](/en/apps/creating-github-apps/writing-code-for-a-github-app/building-a-login-with-github-button-with-a-github-app)
    - [Build a CLI](/en/apps/creating-github-apps/writing-code-for-a-github-app/building-a-cli-with-a-github-app)
    - [Build CI checks](/en/apps/creating-github-apps/writing-code-for-a-github-app/building-ci-checks-with-a-github-app)
* Sharing GitHub Apps
  + [Share your app](/en/apps/sharing-github-apps/sharing-your-github-app)
  + [Share with GHES](/en/apps/sharing-github-apps/making-your-github-app-available-for-github-enterprise-server)
  + [App manifest](/en/apps/sharing-github-apps/registering-a-github-app-from-a-manifest)
  + [App query parameters](/en/apps/sharing-github-apps/registering-a-github-app-using-url-parameters)
* Maintaining GitHub Apps
  + [Modify app settings](/en/apps/maintaining-github-apps/modifying-a-github-app-registration)
  + [Activate optional features](/en/apps/maintaining-github-apps/activating-optional-features-for-github-apps)
  + [GitHub App managers](/en/apps/maintaining-github-apps/about-github-app-managers)
  + [Manage allowed IP addresses](/en/apps/maintaining-github-apps/managing-allowed-ip-addresses-for-a-github-app)
  + [Suspend an installation](/en/apps/maintaining-github-apps/suspending-a-github-app-installation)
  + [Transfer ownership](/en/apps/maintaining-github-apps/transferring-ownership-of-a-github-app)
  + [Delete your app](/en/apps/maintaining-github-apps/deleting-a-github-app)
* GitHub Marketplace
  + Overview
    - [About GitHub Marketplace for apps](/en/apps/github-marketplace/github-marketplace-overview/about-github-marketplace-for-apps)
    - [About marketplace badges](/en/apps/github-marketplace/github-marketplace-overview/about-marketplace-badges)
    - [Publisher verification](/en/apps/github-marketplace/github-marketplace-overview/applying-for-publisher-verification-for-your-organization)
  + Create Marketplace apps
    - [Listing requirements](/en/apps/github-marketplace/creating-apps-for-github-marketplace/requirements-for-listing-an-app)
    - [Security best practice](/en/apps/github-marketplace/creating-apps-for-github-marketplace/security-best-practices-for-apps-on-github-marketplace)
    - [Customer experience best practice](/en/apps/github-marketplace/creating-apps-for-github-marketplace/customer-experience-best-practices-for-apps)
    - [View listing metrics](/en/apps/github-marketplace/creating-apps-for-github-marketplace/viewing-metrics-for-your-listing)
    - [View listing transactions](/en/apps/github-marketplace/creating-apps-for-github-marketplace/viewing-transactions-for-your-listing)
  + Marketplace API usage
    - [REST API](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/rest-endpoints-for-the-github-marketplace-api)
    - [Webhook events](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/webhook-events-for-the-github-marketplace-api)
    - [Testing your app](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/testing-your-app)
    - [New purchases & free trials](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/handling-new-purchases-and-free-trials)
    - [Handling plan changes](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/handling-plan-changes)
    - [Plan cancellations](/en/apps/github-marketplace/using-the-github-marketplace-api-in-your-app/handling-plan-cancellations)
  + List an app on the Marketplace
    - [Draft an app listing](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/drafting-a-listing-for-your-app)
    - [Write listing descriptions](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/writing-a-listing-description-for-your-app)
    - [Set listing pricing plans](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/setting-pricing-plans-for-your-listing)
    - [Webhooks for plan changes](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/configuring-a-webhook-to-notify-you-of-plan-changes)
    - [Submit your listing](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/submitting-your-listing-for-publication)
    - [Delete your listing](/en/apps/github-marketplace/listing-an-app-on-github-marketplace/deleting-your-app-listing-from-github-marketplace)
  + Sell apps on the Marketplace
    - [Pricing plans for apps](/en/apps/github-marketplace/selling-your-app-on-github-marketplace/pricing-plans-for-github-marketplace-apps)
    - [Billing customers](/en/apps/github-marketplace/selling-your-app-on-github-marketplace/billing-customers)
    - [Receive payment](/en/apps/github-marketplace/selling-your-app-on-github-marketplace/receiving-payment-for-app-purchases)
* OAuth apps
  + Using OAuth apps
    - [Install app personal account](/en/apps/oauth-apps/using-oauth-apps/installing-an-oauth-app-in-your-personal-account)
    - [Install app organization](/en/apps/oauth-apps/using-oauth-apps/installing-an-oauth-app-in-your-organization)
    - [Authorizing OAuth apps](/en/apps/oauth-apps/using-oauth-apps/authorizing-oauth-apps)
    - [Review OAuth apps](/en/apps/oauth-apps/using-oauth-apps/reviewing-your-authorized-oauth-apps)
    - [Third-party applications](/en/apps/oauth-apps/using-oauth-apps/connecting-with-third-party-applications)
    - [Internal apps](/en/apps/oauth-apps/using-oauth-apps/internal-oauth-apps)
  + Building OAuth apps
    - [GitHub Apps & OAuth apps](/en/apps/oauth-apps/building-oauth-apps/differences-between-github-apps-and-oauth-apps)
    - [Rate limits](/en/apps/oauth-apps/building-oauth-apps/rate-limits-for-oauth-apps)
    - [Creating an OAuth app](/en/apps/oauth-apps/building-oauth-apps/creating-an-oauth-app)
    - [Authenticate with an OAuth app](/en/apps/oauth-apps/building-oauth-apps/authenticating-to-the-rest-api-with-an-oauth-app)
    - [Authorizing OAuth apps](/en/apps/oauth-apps/building-oauth-apps/authorizing-oauth-apps)
    - [Scopes for OAuth apps](/en/apps/oauth-apps/building-oauth-apps/scopes-for-oauth-apps)
    - [Create custom badges](/en/apps/oauth-apps/building-oauth-apps/creating-a-custom-badge-for-your-oauth-app)
    - [Best practices](/en/apps/oauth-apps/building-oauth-apps/best-practices-for-creating-an-oauth-app)
  + Maintaining OAuth apps
    - [Modifying an OAuth app](/en/apps/oauth-apps/maintaining-oauth-apps/modifying-an-oauth-app)
    - [Activate optional features](/en/apps/oauth-apps/maintaining-oauth-apps/activating-optional-features-for-oauth-apps)
    - [Transfer ownership](/en/apps/oauth-apps/maintaining-oauth-apps/transferring-ownership-of-an-oauth-app)
    - [Troubleshoot authorization](/en/apps/oauth-apps/maintaining-oauth-apps/troubleshooting-authorization-request-errors)
    - [Troubleshoot token request](/en/apps/oauth-apps/maintaining-oauth-apps/troubleshooting-oauth-app-access-token-request-errors)
    - [Deleting an OAuth app](/en/apps/oauth-apps/maintaining-oauth-apps/deleting-an-oauth-app)

* [Apps](/en/apps "Apps")/
* [Creating GitHub Apps](/en/apps/creating-github-apps "Creating GitHub Apps")/
* [Authenticate with a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app "Authenticate with a GitHub App")/
* [About authentication](/en/apps/creating-github-apps/authenticating-with-a-github-app/about-authentication-with-a-github-app "About authentication")
# About authentication with a GitHub App

Your GitHub App can authenticate as itself, as an app installation, or on behalf of a user.

## In this article

* [Authentication as a GitHub App](#authentication-as-a-github-app)
* [Authentication as an app installation](#authentication-as-an-app-installation)
* [Authentication on behalf of a user](#authentication-on-behalf-of-a-user)
## [Authentication as a GitHub App](#authentication-as-a-github-app)

To authenticate as itself, your app will use a JSON Web Token (JWT). Your app should authenticate as itself when it needs to generate an installation access token. An installation access token is required to authenticate as an app installation. Your app should also authenticate as itself when it needs to make API requests to manage resources related to the app. For example, when it needs to list the accounts where it is installed. For more information, see [Authenticating as a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app) and [Generating a JSON Web Token (JWT) for a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-a-json-web-token-jwt-for-a-github-app).

## [Authentication as an app installation](#authentication-as-an-app-installation)

To authenticate as an installation, your app will use an installation access token. Your app should authenticate as an app installation when you want to attribute app activity to the app. Authenticating as an app installation lets your app access resources that are owned by the user or organization that installed the app. Authenticating as an app installation is ideal for automation workflows that don't involve user input. For more information, see [Authenticating as a GitHub App installation](/en/apps/creating-github-apps/authenticating-with-a-github-app/authenticating-as-a-github-app-installation) and [Generating an installation access token for a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-an-installation-access-token-for-a-github-app).

## [Authentication on behalf of a user](#authentication-on-behalf-of-a-user)

To authenticate on behalf of a user, your app will use a user access token. Your app should authenticate on behalf of a user when you want to attribute app activity to a user. Similar to authenticating as an app installation, your app can access resources that are owned by the user or organization that installed the app. Authenticating on behalf of a user is ideal when you want to ensure that your app only takes actions that could be performed by a specific user. For more information, see [Authenticating with a GitHub App on behalf of a user](/en/apps/creating-github-apps/authenticating-with-a-github-app/identifying-and-authorizing-users-for-github-apps) and [Generating a user access token for a GitHub App](/en/apps/creating-github-apps/authenticating-with-a-github-app/generating-a-user-access-token-for-a-github-app).

## Help and support

### Did you find what you needed?

 Yes No[Privacy policy](/en/site-policy/privacy-policies/github-privacy-statement)
### Help us make these docs great!

All GitHub docs are open source. See something that's wrong or unclear? Submit a pull request.

[Make a contribution](https://github.com/github/docs/blob/main/content/apps/creating-github-apps/authenticating-with-a-github-app/about-authentication-with-a-github-app.md)

[Learn how to contribute](/contributing)

### Still need help?

[Ask the GitHub community](https://github.com/orgs/community/discussions)[Contact support](https://support.github.com)
## Legal

* © 2025 GitHub, Inc.
* [Terms](/en/site-policy/github-terms/github-terms-of-service)
* [Privacy](/en/site-policy/privacy-policies/github-privacy-statement)
* [Status](https://www.githubstatus.com/)
* [Pricing](https://github.com/pricing)
* [Expert services](https://services.github.com)
* [Blog](https://github.blog)


=== Content from github.com_dec3d604_20250115_083218.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fsecurity%2Fadvisories%2FGHSA-h4q8-96p6-jcgr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fsecurity%2Fadvisories%2FGHSA-h4q8-96p6-jcgr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=bradleyfalzon%2Fghinstallation)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bradleyfalzon](/bradleyfalzon)
/
**[ghinstallation](/bradleyfalzon/ghinstallation)**
Public

* [Notifications](/login?return_to=%2Fbradleyfalzon%2Fghinstallation) You must be signed in to change notification settings
* [Fork
  101](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)
* [Star
   320](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)

* [Code](/bradleyfalzon/ghinstallation)
* [Issues
  9](/bradleyfalzon/ghinstallation/issues)
* [Pull requests
  5](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects
  0](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

Additional navigation options

* [Code](/bradleyfalzon/ghinstallation)
* [Issues](/bradleyfalzon/ghinstallation/issues)
* [Pull requests](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

# App JWT returned in error responses < v2.0.0

Moderate

[bradleyfalzon](/bradleyfalzon)
published
GHSA-h4q8-96p6-jcgr
Dec 19, 2022

## Package

gomod

ghinstallation
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 2.0.0

## Patched versions

2.0.0

## Description

### Impact

In ghinstallation v1, when the request to refresh an installation token failed, the HTTP request and response would be returned for debugging.

[ghinstallation/transport.go](https://github.com/bradleyfalzon/ghinstallation/blob/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go#L172-L174)

Lines 172 to 174
in
[24e56b3](/bradleyfalzon/ghinstallation/commit/24e56b3fb7669f209134a01eff731d7e2ef72a5c)

|  | if resp.StatusCode/100 != 2 { |
| --- | --- |
|  | return fmt.Errorf("request %+v received non 2xx response status %q with body %+v and TLS %+v", resp.Request, resp.Body, resp.Request, resp.TLS) |
|  | } |

The request contained the bearer JWT for the App, and was returned back to clients. This token is short lived (10 minute maximum).

### Patches

* This has already been patched in [d24f14f](https://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e), and is available in releases >= v2.0.0.

### References

*Are there any links users can visit to find out more?*

* See <https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-an-installation> for the App installation flow.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [ghinstallation](https://github.com/bradleyfalzon/ghinstallation)

### Severity

Moderate

5.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
High

Privileges required
Low

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:L

### CVE ID

CVE-2022-39304

### Weaknesses

[CWE-209](/advisories?query=cwe%3A209)

### Credits

* [![@Miskerest](https://avatars.githubusercontent.com/u/14872607?s=40&v=4)](/Miskerest)
  [Miskerest](/Miskerest)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_99d6c3ee_20250115_083216.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fcommit%2Fd24f14f8be70d94129d76026e8b0f4f9170c8c3e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fcommit%2Fd24f14f8be70d94129d76026e8b0f4f9170c8c3e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bradleyfalzon%2Fghinstallation)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bradleyfalzon](/bradleyfalzon)
/
**[ghinstallation](/bradleyfalzon/ghinstallation)**
Public

* [Notifications](/login?return_to=%2Fbradleyfalzon%2Fghinstallation) You must be signed in to change notification settings
* [Fork
  101](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)
* [Star
   320](/login?return_to=%2Fbradleyfalzon%2Fghinstallation)

* [Code](/bradleyfalzon/ghinstallation)
* [Issues
  9](/bradleyfalzon/ghinstallation/issues)
* [Pull requests
  5](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects
  0](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

Additional navigation options

* [Code](/bradleyfalzon/ghinstallation)
* [Issues](/bradleyfalzon/ghinstallation/issues)
* [Pull requests](/bradleyfalzon/ghinstallation/pulls)
* [Actions](/bradleyfalzon/ghinstallation/actions)
* [Projects](/bradleyfalzon/ghinstallation/projects)
* [Security](/bradleyfalzon/ghinstallation/security)
* [Insights](/bradleyfalzon/ghinstallation/pulse)

## Commit

[Permalink](/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add StatusCode to error message if refreshToken() fails due to an sus…

[Browse files](/bradleyfalzon/ghinstallation/tree/d24f14f8be70d94129d76026e8b0f4f9170c8c3e)
Browse the repository at this point in the history

```
…pended app ([#44](https://github.com/bradleyfalzon/ghinstallation/pull/44))

Add StatusCode to error message if refreshToken() fails due to an suspended app
```

* Loading branch information

[![@andygrunwald](https://avatars.githubusercontent.com/u/320064?s=40&v=4)](/andygrunwald)

[andygrunwald](/bradleyfalzon/ghinstallation/commits?author=andygrunwald "View all commits by andygrunwald")
authored
Mar 8, 2021

1 parent
[556cb68](/bradleyfalzon/ghinstallation/commit/556cb686e190f1c0f7517dcf613f88ec8395b656)

commit d24f14f

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[transport.go](#diff-5982a4ca350449c8a5deba675bc4bc4bb0f1823c45e6c7ba0076cc6b159fef8f "transport.go")

Show comments

[View file](/bradleyfalzon/ghinstallation/blob/d24f14f8be70d94129d76026e8b0f4f9170c8c3e/transport.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -170,7 +170,7 @@ func (t \*Transport) refreshToken(ctx context.Context) error { |
|  |  | defer resp.Body.Close() |
|  |  |  |
|  |  | if resp.StatusCode/100 != 2 { |
|  |  | return fmt.Errorf("request %+v received non 2xx response status %q with body %+v and TLS %+v", resp.Request, resp.Body, resp.Request, resp.TLS) |
|  |  | return fmt.Errorf("received non 2xx response status %q when fetching %v", resp.Status, req.URL) |
|  |  | } |
|  |  |  |
|  |  | return json.NewDecoder(resp.Body).Decode(&t.token) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d24f14f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbradleyfalzon%2Fghinstallation%2Fcommit%2Fd24f14f8be70d94129d76026e8b0f4f9170c8c3e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


