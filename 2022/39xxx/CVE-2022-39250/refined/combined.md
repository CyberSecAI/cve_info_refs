=== Content from github.com_26676751_20250114_181103.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Freleases%2Ftag%2Fv19.7.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Freleases%2Ftag%2Fv19.7.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=matrix-org%2Fmatrix-js-sdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-js-sdk](/matrix-org/matrix-js-sdk)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk) You must be signed in to change notification settings
* [Fork
  606](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)
* [Star
   1.7k](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)

* [Code](/matrix-org/matrix-js-sdk/tree/v19.7.0)
* [Issues
  228](/matrix-org/matrix-js-sdk/issues)
* [Pull requests
  27](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects
  0](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-js-sdk/tree/v19.7.0)
* [Issues](/matrix-org/matrix-js-sdk/issues)
* [Pull requests](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

1. [Releases](/matrix-org/matrix-js-sdk/releases)
2. [v19.7.0](/matrix-org/matrix-js-sdk/releases/tag/v19.7.0)

# v19.7.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/matrix-org/matrix-js-sdk/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v19.7.0)

 Loading

[View all tags](/matrix-org/matrix-js-sdk/tags)

![@RiotRobot](https://avatars.githubusercontent.com/u/24480685?s=40&v=4)
[RiotRobot](/RiotRobot)
released this
28 Sep 13:05

Â·
[2477 commits](/matrix-org/matrix-js-sdk/compare/v19.7.0...develop)
to develop
since this release

[v19.7.0](/matrix-org/matrix-js-sdk/tree/v19.7.0)

[`2d067ad`](/matrix-org/matrix-js-sdk/commit/2d067ad95778b26aed24b801be0951e215c3ac8c)

## ðŸ”’ Security

* Fix for [CVE-2022-39249](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE%2D2022%2D39249)
* Fix for [CVE-2022-39250](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE%2D2022%2D39250)
* Fix for [CVE-2022-39251](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE%2D2022%2D39251)
* Fix for [CVE-2022-39236](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE%2D2022%2D39236)

 Assets
6

 Loading

All reactions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_55cb4f42_20250114_181103.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fsecurity%2Fadvisories%2FGHSA-5w8r-8pgj-5jmf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fsecurity%2Fadvisories%2FGHSA-5w8r-8pgj-5jmf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=matrix-org%2Fmatrix-js-sdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-js-sdk](/matrix-org/matrix-js-sdk)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk) You must be signed in to change notification settings
* [Fork
  606](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)
* [Star
   1.7k](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)

* [Code](/matrix-org/matrix-js-sdk)
* [Issues
  228](/matrix-org/matrix-js-sdk/issues)
* [Pull requests
  27](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects
  0](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-js-sdk)
* [Issues](/matrix-org/matrix-js-sdk/issues)
* [Pull requests](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

# Key/device identifier confusion in SAS verification

Critical

[dkasak](/dkasak)
published
GHSA-5w8r-8pgj-5jmf
Sep 29, 2022

## Package

npm

matrix-js-sdk
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 19.7.0

## Patched versions

19.7.0

## Description

## Impact

An attacker cooperating with a malicious homeserver could interfere with the verification flow between two users, injecting its own cross-signing user identity in place of one of the usersâ€™ identities, leading to the other device trusting/verifying the user identity under the control of the homeserver instead of the intended one.

The vulnerability is a bug in the matrix-js-sdk, caused by checking and signing user identities and devices in two separate steps, and inadequately fixing the keys to be signed between those steps.

Even though the attack is partly made possible due to the design decision of treating cross-signing user identities as Matrix devices on the server side (with their device ID set to the public part of the user identity key), no other examined implementations were vulnerable.

## Patches

The matrix-js-sdk has been modified to double check that the key signed is the one that was verified instead of just referencing the key by ID. An additional check has been made to report an error when one of the device ID matches a cross-signing key.

## Workarounds

As this attack requires coordination between a malicious homeserver and an attacker -- if you trust your homeserver no particular workaround is needed.

As a potential way of detecting compromise, itâ€™s possible to review your device list or the device list of other users for devices with IDs in the form of a base64 cross-signing key (`5XaczGNlfz0bl8R1IX5qn+tBoue2tWJqLMh+SDUuvCk`) instead of classical device ID (`SEHACYDHMG`).

## References

Blog post: <https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients>

## For more information

If you have any questions or comments about this advisory, e-mail us at security@matrix.org

### Severity

Critical

### CVE ID

CVE-2022-39250

### Weaknesses

No CWEs

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_ed16ceb4_20250115_111906.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5w8r-8pgj-5jmf)

**CVE-2022-39250**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-5w8r-8pgj-5jmf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2022-39250](/advisories/GHSA-5w8r-8pgj-5jmf)

## matrix-js-sdk subject to user impersonation due to key/device identifier confusion in SAS verification

High severity

GitHub Reviewed

Published
Sep 29, 2022
in
[matrix-org/matrix-js-sdk](/matrix-org/matrix-js-sdk)
â€¢
Updated Jan 30, 2023

[Vulnerability details](/advisories/GHSA-5w8r-8pgj-5jmf)
[Dependabot alerts
0](/advisories/GHSA-5w8r-8pgj-5jmf/dependabot)

## Package

npm

matrix-js-sdk
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 19.7.0

## Patched versions

19.7.0

## Description

## Impact

An attacker cooperating with a malicious homeserver could interfere with the verification flow between two users, injecting its own cross-signing user identity in place of one of the usersâ€™ identities, leading to the other device trusting/verifying the user identity under the control of the homeserver instead of the intended one.

The vulnerability is a bug in the matrix-js-sdk, caused by checking and signing user identities and devices in two separate steps, and inadequately fixing the keys to be signed between those steps.

Even though the attack is partly made possible due to the design decision of treating cross-signing user identities as Matrix devices on the server side (with their device ID set to the public part of the user identity key), no other examined implementations were vulnerable.

## Patches

The matrix-js-sdk has been modified to double check that the key signed is the one that was verified instead of just referencing the key by ID. An additional check has been made to report an error when one of the device ID matches a cross-signing key.

## Workarounds

As this attack requires coordination between a malicious homeserver and an attacker -- if you trust your homeserver no particular workaround is needed.

As a potential way of detecting compromise, itâ€™s possible to review your device list or the device list of other users for devices with IDs in the form of a base64 cross-signing key (`5XaczGNlfz0bl8R1IX5qn+tBoue2tWJqLMh+SDUuvCk`) instead of classical device ID (`SEHACYDHMG`).

## References

Blog post: <https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients>

## For more information

If you have any questions or comments about this advisory, e-mail us at security@matrix.org

### References

* [GHSA-5w8r-8pgj-5jmf](https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf "GHSA-5w8r-8pgj-5jmf")
* <https://nvd.nist.gov/vuln/detail/CVE-2022-39250>
* [matrix-org/matrix-js-sdk@a587d7c](https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76)
* <https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0>
* <https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients>
* <https://security.gentoo.org/glsa/202210-35>

[![@dkasak](https://avatars.githubusercontent.com/u/463342?s=40&v=4)](/dkasak)
[dkasak](/dkasak)
published to
[matrix-org/matrix-js-sdk](/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf)
Sep 29, 2022

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-39250)
Sep 29, 2022

Published to the GitHub Advisory Database
Sep 30, 2022

Reviewed
Sep 30, 2022

Last updated
Jan 30, 2023

### Severity

High

8.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N

### [EPSS score](https://www.first.org/epss/user-guide)

0.114%
 (46th percentile)

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287) [CWE-322](/advisories?query=cwe%3A322)

### CVE ID

CVE-2022-39250

### GHSA ID

GHSA-5w8r-8pgj-5jmf

### Source code

[matrix-org/matrix-js-sdk](https://github.com/matrix-org/matrix-js-sdk)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-5w8r-8pgj-5jmf/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_e5169e2a_20250114_181102.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fcommit%2Fa587d7c36026fe1fcf93dfff63588abee359be76)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fcommit%2Fa587d7c36026fe1fcf93dfff63588abee359be76)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=matrix-org%2Fmatrix-js-sdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[matrix-org](/matrix-org)
/
**[matrix-js-sdk](/matrix-org/matrix-js-sdk)**
Public

* [Notifications](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk) You must be signed in to change notification settings
* [Fork
  606](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)
* [Star
   1.7k](/login?return_to=%2Fmatrix-org%2Fmatrix-js-sdk)

* [Code](/matrix-org/matrix-js-sdk)
* [Issues
  228](/matrix-org/matrix-js-sdk/issues)
* [Pull requests
  27](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects
  0](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

Additional navigation options

* [Code](/matrix-org/matrix-js-sdk)
* [Issues](/matrix-org/matrix-js-sdk/issues)
* [Pull requests](/matrix-org/matrix-js-sdk/pulls)
* [Actions](/matrix-org/matrix-js-sdk/actions)
* [Projects](/matrix-org/matrix-js-sdk/projects)
* [Security](/matrix-org/matrix-js-sdk/security)
* [Insights](/matrix-org/matrix-js-sdk/pulse)

## Commit

[Permalink](/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Resolve multiple CVEs

[Browse files](/matrix-org/matrix-js-sdk/tree/a587d7c36026fe1fcf93dfff63588abee359be76)
Browse the repository at this point in the history

```
[CVE-2022-39249](https://github.com/advisories/GHSA-6263-x97c-c4gg "CVE-2022-39249")
[CVE-2022-39250](https://github.com/advisories/GHSA-5w8r-8pgj-5jmf "CVE-2022-39250")
[CVE-2022-39251](https://github.com/advisories/GHSA-r48r-j8fx-mq2c "CVE-2022-39251")
[CVE-2022-39236](https://github.com/advisories/GHSA-hvv8-5v86-r45x "CVE-2022-39236")
```

* Loading branch information

[![@RiotRobot](https://avatars.githubusercontent.com/u/24480685?s=40&v=4)](/RiotRobot)

[RiotRobot](/matrix-org/matrix-js-sdk/commits?author=RiotRobot "View all commits by RiotRobot")
committed
Sep 28, 2022

1 parent
[b64a30f](/matrix-org/matrix-js-sdk/commit/b64a30f0ad35022b342ef8142e526fe12f43673a)

commit a587d7c

 Show file tree

 Hide file tree

Showing
**30 changed files**
with
**1,375 additions**
and
**79 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* spec

  + integ

    - spec/integ/matrix-client-crypto.spec.ts
      [matrix-client-crypto.spec.ts](#diff-a11214d99abb867611e5309e04f60cb2dd8dff6f01a4e32999019e4740d5b5b6)
    - spec/integ/matrix-client-syncing.spec.ts
      [matrix-client-syncing.spec.ts](#diff-563bd9cac559eedaed83746761f1c4d339c1eae20158766e7cea48a72ad37247)
    - spec/integ/megolm-integ.spec.ts
      [megolm-integ.spec.ts](#diff-824cf37a0f767075f7811b8f122b51fa2fdac9541c458970b8144982bae61f5b)
  + unit

    - spec/unit/content-helpers.spec.ts
      [content-helpers.spec.ts](#diff-57563a189d2f7c130b724d99baa8e5719e03daf6e4e8a9f0f79867e0c0446774)
    - spec/unit/crypto.spec.ts
      [crypto.spec.ts](#diff-c2428c3a9f1217cc15bfd96862643aced4f96f024802b2002320526ed80e49c6)
    - crypto

      * algorithms

        + spec/unit/crypto/algorithms/megolm.spec.ts
          [megolm.spec.ts](#diff-1608026fe4a0c1ddcaaf5e93abb7e4f463908581c1bc19bcd4f27e431e17c6b9)
      * spec/unit/crypto/backup.spec.ts
        [backup.spec.ts](#diff-1f30f109cff3bd88e92edf5fe041668b65c3a186f727b16818faec2652990a40)
      * spec/unit/crypto/secrets.spec.ts
        [secrets.spec.ts](#diff-55b0e7275b7510d86f5e201e7b377396032f2fe5f040c9681fb75d40213d2c01)
      * verification

        + spec/unit/crypto/verification/sas.spec.ts
          [sas.spec.ts](#diff-5858f5d49ed141b28e162c87cd7fc9235026a6b24c2d0d5958a16c6160bd1f5e)
    - models

      * spec/unit/models/beacon.spec.ts
        [beacon.spec.ts](#diff-e9800ab52919a46350a43658ccdee61ad59ab4667ebdf81110a294e68714f121)
* src

  + @types

    - src/@types/crypto.ts
      [crypto.ts](#diff-b48a7ff38f732502759971963b2f884e285501191dae5fe8724a0e759c1a739b)
  + src/NamespacedValue.ts
    [NamespacedValue.ts](#diff-b7968cc1172367d8b154e7c8941de1e40f615c59bc0c5d979a960150670503ff)
  + src/client.ts
    [client.ts](#diff-25d66d74617fe2e23d7946bd6e3ba95640ab1b9bc8947445d604fc271c7c1f12)
  + src/content-helpers.ts
    [content-helpers.ts](#diff-3d27c18cbe67978ab2bd101b007062096b9301ee967b0f026fffe681c513aed3)
  + crypto

    - src/crypto/OlmDevice.ts
      [OlmDevice.ts](#diff-f2a105ec132cea88c35977e70ea1b1ba51db2b738cde714c5ac1cd524ddff8c8)
    - src/crypto/SecretStorage.ts
      [SecretStorage.ts](#diff-cef792a7fe5292ff218b44701c423e282ae1b8df338a537d576851781430da7f)
    - algorithms

      * src/crypto/algorithms/megolm.ts
        [megolm.ts](#diff-f472935a595840f56a39e1255c3d38f2e95d9507e9b200b627cb01c19bb3801c)
      * src/crypto/algorithms/olm.ts
        [olm.ts](#diff-8a33013a1907f9a490c5a80200efb006fae4c75b581270fc5c2ce78bcc1f2af0)
    - src/crypto/backup.ts
      [backup.ts](#diff-2ac247e97434d93bb5fdab13ae3215b6465b7e4a0c1ac10f844a2bea4207ee57)
    - src/crypto/index.ts
      [index.ts](#diff-890ab04f8e5e8b612d0069bf0c681ef35d1ef3810abba98205ee464f3c366577)
    - src/crypto/olmlib.ts
      [olmlib.ts](#diff-e6e457114ac1e3095e7551d86f4cfce894c9e1788fe03e5121946e406b1b1c92)
    - store

      * src/crypto/store/base.ts
        [base.ts](#diff-587b652b307630acd415e0210d2badea32f2e11be4caf16db1122eb1ed498320)
      * src/crypto/store/indexeddb-crypto-store-backend.ts
        [indexeddb-crypto-store-backend.ts](#diff-5fd6124295b880cb79efaab622dec20aee29f4cbcca0354b0f6c098661a0e530)
      * src/crypto/store/indexeddb-crypto-store.ts
        [indexeddb-crypto-store.ts](#diff-7e58a7b33edee864354ff2e7f638bc14f5118ebee95b1daa6160c7cddb9941ea)
      * src/crypto/store/memory-crypto-store.ts
        [memory-crypto-store.ts](#diff-85324a5a5b04d29bb19e361e35d4770071d7dea0ebad2a2eb2a823c1cd6ec090)
    - verification

      * src/crypto/verification/Base.ts
        [Base.ts](#diff-a53c594ab3ded5b451c0ba58dcc1deec10893130c8dd975d6440f817f16ba4f4)
  + src/event-mapper.ts
    [event-mapper.ts](#diff-48935348fb6740bc9d410752ce630c31f91f2d3b48d012908cda6501113cad26)
  + models

    - src/models/beacon.ts
      [beacon.ts](#diff-c9fd490704ecf1176038f64e016d797a18003f0692fe81afe6c0e87eb9e5ae93)
    - src/models/event.ts
      [event.ts](#diff-abae49c10d0eab16ff7e75b4c4b02c67c22d2e97cd23610589086395b7800242)
  + src/sync.ts
    [sync.ts](#diff-1b0cb46cd1fcdaacf73c771bf7eed6e00a12ee030da1dbcca4ae12842e1ecd81)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[spec/integ/matrix-client-crypto.spec.ts](#diff-a11214d99abb867611e5309e04f60cb2dd8dff6f01a4e32999019e4740d5b5b6 "spec/integ/matrix-client-crypto.spec.ts")

Show comments

[View file](/matrix-org/matrix-js-sdk/blob/a587d7c36026fe1fcf93dfff63588abee359be76/spec/integ/matrix-client-crypto.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -494,6 +494,7 @@ describe("MatrixClient crypto", () => { |
|  |  | aliTestClient.expectKeyQuery({ device\_keys: { [aliUserId]: {} }, failures: {} }); |
|  |  | await aliTestClient.start(); |
|  |  | await bobTestClient.start(); |
|  |  | bobTestClient.client.crypto.deviceList.downloadKeys = () => Promise.resolve({}); |
|  |  | await firstSync(aliTestClient); |
|  |  | await aliEnablesEncryption(); |
|  |  | await aliSendsFirstMessage(); |
| Expand All | | @@ -504,6 +505,7 @@ describe("MatrixClient crypto", () => { |
|  |  | aliTestClient.expectKeyQuery({ device\_keys: { [aliUserId]: {} }, failures: {} }); |
|  |  | await aliTestClient.start(); |
|  |  | await bobTestClient.start(); |
|  |  | bobTestClient.client.crypto.deviceList.downloadKeys = () => Promise.resolve({}); |
|  |  | await firstSync(aliTestClient); |
|  |  | await aliEnablesEncryption(); |
|  |  | await aliSendsFirstMessage(); |
| Expand Down  Expand Up | | @@ -567,6 +569,7 @@ describe("MatrixClient crypto", () => { |
|  |  | aliTestClient.expectKeyQuery({ device\_keys: { [aliUserId]: {} }, failures: {} }); |
|  |  | await aliTestClient.start(); |
|  |  | await bobTestClient.start(); |
|  |  | bobTestClient.client.crypto.deviceList.downloadKeys = () => Promise.resolve({}); |
|  |  | await firstSync(aliTestClient); |
|  |  | await aliEnablesEncryption(); |
|  |  | await aliSendsFirstMessage(); |
| Expand All | | @@ -584,6 +587,9 @@ describe("MatrixClient crypto", () => { |
|  |  | await firstSync(bobTestClient); |
|  |  | await aliEnablesEncryption(); |
|  |  | await aliSendsFirstMessage(); |
|  |  | bobTestClient.httpBackend.when('POST', '/keys/query').respond( |
|  |  | 200, {}, |
|  |  | ); |
|  |  | await bobRecvMessage(); |
|  |  | await bobEnablesEncryption(); |
|  |  | const ciphertext = await bobSendsReplyMessage(); |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[spec/integ/matrix-client-syncing.spec.ts](#diff-563bd9cac559eedaed83746761f1c4d339c1eae20158766e7cea48a72ad37247 "spec/integ/matrix-client-syncing.spec.ts")

Show comments

[View file](/matrix-org/matrix-js-sdk/blob/a587d7c36026fe1fcf93dfff63588abee359be76/spec/integ/matrix-client-syncing.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -87,6 +87,8 @@ describe("MatrixClient syncing", () => { |
|  |  | }); |
|  |  |  |
|  |  | it("should emit RoomEvent.MyMembership for invite->leave->invite cycles", async () => { |
|  |  | await client.initCrypto(); |
|  |  |  |
|  |  | const roomId = "!cycles:example.org"; |
|  |  |  |
|  |  | // First sync: an invite |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a587d7c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmatrix-org%2Fmatrix-js-sdk%2Fcommit%2Fa587d7c36026fe1fcf93dfff63588abee359be76) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from security.gentoo.org_5b2ca18a_20250114_181104.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities â€” GLSA **202210-35**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.4.0** |
| Unaffected versions | >= **102.4.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.4.0** |
| Unaffected versions | >= **102.4.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.4.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.4.0"

```
### References

* [CVE-2022-39236](https://nvd.nist.gov/vuln/detail/CVE-2022-39236)
* [CVE-2022-39249](https://nvd.nist.gov/vuln/detail/CVE-2022-39249)
* [CVE-2022-39250](https://nvd.nist.gov/vuln/detail/CVE-2022-39250)
* [CVE-2022-39251](https://nvd.nist.gov/vuln/detail/CVE-2022-39251)
* [CVE-2022-42927](https://nvd.nist.gov/vuln/detail/CVE-2022-42927)
* [CVE-2022-42928](https://nvd.nist.gov/vuln/detail/CVE-2022-42928)
* [CVE-2022-42929](https://nvd.nist.gov/vuln/detail/CVE-2022-42929)
* [CVE-2022-42932](https://nvd.nist.gov/vuln/detail/CVE-2022-42932)

**Release date**

October 31, 2022

**Latest revision**

October 31, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [873667](https://bugs.gentoo.org/show_bug.cgi?id=873667)
* [878315](https://bugs.gentoo.org/show_bug.cgi?id=878315)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from matrix.org_b745038c_20250114_181103.html ===

[![Matrix logo](/images/matrix-logo-white.svg)](/)

î˜‚

[Spec](https://spec.matrix.org)

Foundation

[About Matrix](/foundation/about/)
[Governing Board Elections 2024](/foundation/governing-board-elections/)

[Blog](/blog/)
[Docs](/docs/)

Ecosystem

[Clients](/ecosystem/clients/)
[Bridges](/ecosystem/bridges/)
[Servers](/ecosystem/servers/)
[Integrations](/ecosystem/integrations/)
[SDKs](/ecosystem/sdks/)
[Hosting](/ecosystem/hosting/)

[Donate](/support)
[Try Matrix](/try-matrix/)

# Upgrade now to address E2EE vulnerabilities in matrix-js-sdk, matrix-ios-sdk and matrix-android-sdk2

28.09.2022 17:41
â€”
[Security](/category/security)
â€”
[Matthew Hodgson](/author/matthew-hodgson),
[Denis Kasak](/author/denis-kasak),
[Matrix Cryptography Team](/author/matrix-cryptography-team),
[Matrix Security Team](/author/matrix-security-team)

**TL;DR:**

* Two critical severity vulnerabilities in end-to-end encryption were found in
  the SDKs which power Element, Beeper, Cinny, SchildiChat, Circuli, Synod.im
  and any other clients based on matrix-js-sdk, matrix-ios-sdk or
  matrix-android-sdk2.
* These have now been fixed, and we have not seen evidence of them being
  exploited in the wild. All of the critical vulnerabilities require
  cooperation from a malicious homeserver to be exploited.
* **Please upgrade immediately in order to be protected against these
  vulnerabilities.**
* Clients with other encryption implementations (including Hydrogen, ElementX,
  Nheko, FluffyChat, Syphon, Timmy, Gomuks and Pantalaimon) are not affected;
  **this is not a protocol bug**.
* We take the security of our end-to-end encryption extremely seriously, and we
  have an ongoing series of public independent audits booked to help guard
  against future vulnerabilities. We will also be making some protocol changes
  in the future to provide additional layers of protection.
* This resolves the [pre-disclosure](https://matrix.org/blog/2022/09/23/pre-disclosure-upcoming-critical-security-release-of-matrix-sd-ks-and-clients) issued on September 23rd.

Hi all,

Recently we have been hard at work investigating some subtle security
vulnerabilities in certain implementations of Matrix's end-to-end encryption
which were responsibly disclosed to us by researchers at Royal Holloway
University London, University of Sheffield and Brave Software. Two of these
vulnerabilities are critical severity, in that they could allow malicious
server admins to attack their users, and are implementation bugs in clients
using matrix-js-sdk (e.g. Element Web) or implementations derived from
matrix-js-sdk, rather than protocol flaws. matrix-rust-sdk (and other 2nd/3rd
generation SDKs) are not affected by these. These vulnerabilities are fixed in
today's release, and we are not aware of them having been exploited in the
wild.

**If you're using Element or an application that shares the same SDKs (Beeper,
Cinny, SchildiChat, Circuli, Synod.im) then please upgrade now. Do not perform
verification with new devices until you have upgraded.**

We'd like to thank the security researchers for investing significant time and
effort into doing a deep dive to find these issues, and thus contributing
materially to making Matrix more secure for the whole ecosystem. Despite our
best efforts, there is always a risk of security issues in software, and we're
very glad to have identified and fixed these issues while also taking the
opportunity to improve our vulnerability disclosure and coordinated upgrade
process.

Please note that the critical severity issues are implementation issues in
matrix-js-sdk and derivatives, and are **not** protocol issues in Matrix. The
latest version of the researchers' paper that we've seen incorrectly presents
Element as 'the reference Matrix client', and confuses the higher severity
implementation bugs with lower severity protocol critique. This is very
unfortunate, given Hydrogen, ElementX, Nheko, FluffyChat, Syphon, Timmy, Gomuks
and Pantalaimon and other independent implementations are not affected. In
fact, every client independently implemented using the Matrix spec seems to
have got it right, which speaks well of the protocol. It's only the first
generation SDK (predating the spec) and its derivatives which had these bugs.

The two critical severity issues lead to three attack scenarios, all of which
are prevented by today's releases:

* "*Key/Device Identifier Confusion in SAS Verification*" â€“ A bug existed in
  matrix-js-sdk where it confused together device IDs and cross-signing keys
  (given under the hood, cross-signing keys are represented as devices). This
  could be exploited by a malicious server admin to break emoji-based
  verification when cross-signing is in use, authenticating themselves rather
  than the target user being verified. This bug is only present in
  matrix-js-sdk (not iOS or Android SDKs), tracked as a critical severity CVE:
  CVE-2022-39250.
* "*Trusted Impersonation*" â€“ matrix-js-sdk (and derived SDKs) suffered from
  a protocol-confusion bug where it would incorrectly accept to-device messages
  encrypted by Megolm rather than Olm, attributing them to the Megolm sender
  rather than the actual sender. As a result, an attacker could fake the
  trusted sender of to-device messages, allowing them to send fake to-device
  messages to devices - e.g. fake keys to spoof historical messages from other
  users. This bug is tracked as a critical severity CVE: CVE-2022-39251
  (matrix-js-sdk), CVE-2022-39255 (matrix-ios-sdk) and CVE-2022-39248
  (matrix-android-sdk2).
* "*Malicious key backup*" â€“ the above 'trusted impersonation' bug in
  matrix-js-sdk (and derived SDKs) could be used by a malicious homeserver
  admin to add a malicious key backup to the user's account under certain
  unusual conditions in order to exfiltrate message keys. While we are not
  aware of this being exploited in the wild, out of an abundance of caution we
  recommend checking your key backup settings. If you are particularly paranoid
  you may wish to reset your online key backup. This doesn't have a separate
  CVE, as the root cause is the same as "Trusted Impersonation".

Three lower priority issues were also identified by the researchers:

* "*Semi-trusted Impersonation*" â€“ matrix-js-sdk (and derived SDKs) accepted keys
  forwarded by other users, even if your client didn't request them. As
  a result, a malicious server admin could fake an encrypted message to look as
  if it was sent from a given user on that server. However, impersonated
  messages like this are clearly marked by clients like Element with a clear
  "The authenticity of this encrypted message can't be guaranteed" warning
  â€“ which is why we consider this low severity. That said, it's an avoidable
  attack, and we've fixed this by ensuring that clients don't accept 'unsafe'
  keys (with the exception of keys forwarded when you invite a user to an
  existing conversation). In future, in Olm/Megolm v2 we're also linking
  key-sending events to the underlying recipient Olm identity to ensure that
  keys cannot be misappropriated. This issue is tracked as a moderate severity
  CVE: CVE-2022-39249 (matrix-js-sdk), CVE-2022-39257 (matrix-ios-sdk) and
  CVE-2022-39246 (matrix-android-sdk2).
* "*Homeserver Control of Room Membership*" â€“ A malicious homeserver can fake
  invites on behalf of its users to invite malicious users into their
  conversations, or add malicious devices into its users accounts. However,
  when this happens, we clearly warn the user: if you have verified the users
  you are talking to, the room and user will be shown with a big red cross to
  mark if malicious devices have been added. Similarly, if an unexpected user
  is invited to a conversation, all users can clearly see and take evasive
  action. Therefore we consider this a low severity issue. That said, this
  behaviour can be improved, and we've started work on switching our trust
  model to trust-on-first-use (so that new untrusted devices are proactively
  excluded from conversations, even if you haven't explicitly verified their
  owner) - and we're also looking to add cryptographic signatures to membership
  events in E2EE rooms to stop impersonated invites. These fixes will land
  over the coming months.
* "*IND-CCA break*" â€“ Matrix's usage of AES-CTR to encrypt attachments, secrets
  and symmetric key backups is not "IND-CCA2 secure", because it does not
  include the AES initialisation vector within the hash used to secure the
  payload from tampering. As a result, if an attacker could observe the result
  of both a given encryption and a given decryption operation, it would be
  possible to extract the encryption private key. However, this is a purely
  theoretical attack as Matrix does not provide a way to mount the attack. In
  the future, we will fix our use of AES-CTR to include the IV within the hash.

We'd like to again thank Martin R. Albrecht and Dan Jones from the Information
Security Group at Royal Holloway University London, Benjamin Dowling from
Security of Advanced Systems Group, University of Sheffield and SofÃ­a Celi from
Brave Software for discovering these issues and responsibly disclosing them to
us, and then working with us to agree on an extended disclosure window given
the amount of work needed to verify and ship fixes throughout Matrix over the
course of the summer period. We welcome any further formal security analysis
work, and hope that it will distinguish clearly between Matrix-the-protocol and
Matrix implementations like matrix-js-sdk, rather than conflating them. You can
read their full paper [here](https://nebuchadnezzar-megolm.github.io/).

We'd also like to thank all the downstream Element package maintainers,
downstream forks and other affected clients for working together under time
constraints for this coordinated release - your patience and understanding is
very much appreciated indeed.

Meanwhile, we are taking extreme measures to avoid future E2EE vulnerabilities.
You will notice that matrix-rust-sdk, hydrogen-sdk and other 2nd and 3rd
generation SDKs were not affected by the bugs at the root cause of the critical
issues here. This is **precisely** why we have been working on replacing the
first generation SDKs with a clean, carefully written Rust implementation in
the form of matrix-rust-sdk, complete with an ongoing independent public audit.

We started the process of auditing matrix-rust-sdk with the [Least Authority
vodozemac audit in May](https://matrix.org/blog/2022/05/16/independent-public-audit-of-vodozemac-a-native-rust-reference-implementation-of-matrix-end-to-end-encryption), and we have three more audits agreed
â€“ covering matrix-rust-sdk-crypto, matrix-rust-sdk, and a whole reference
Matrix stack. Ironically, the mitigation work for these vulnerabilities in the
legacy SDKs has severely impacted our timelines for finishing
matrix-rust-sdk-crypto work (in fact, we had to push back the Least Authority
audit of matrix-rust-sdk-crypto given the
[burndown](https://github.com/matrix-org/matrix-rust-sdk/milestone/1) has not
progressed), but we will be shifting to the new audited codebase as rapidly as
we possibly can.

Over the coming months we will also introduce our first ever major version
update of Olm and Megolm, in order to fix the MAC truncation issue highlighted
in the [vodozemac audit](https://matrix.org/media/Least%20Authority%20-%20Matrix%20vodozemac%20Final%20Audit%20Report.pdf) (Issue J), and reduce the risk of further
key-forwarding issues (as per the "Semi-trusted Impersonation" vulnerability
above). New conversations will default to using v2 of Olm/Megolm for security,
and existing conversations can be optionally upgraded (similar to a 'room
version' upgrade in Matrix today). We are also adding extensive end-to-end
testing using [Polyjuice](https://gitlab.com/polyjuice) and [Traffic
Light](https://github.com/matrix-org/trafficlight) to stress-test encryption
and improve reliability.

Finally, we will continue our research into layering Matrix over Messaging
Layer Security (MLS) - the IETF proposed standard for interoperable end-to-end
encrypted group messaging. This work has been delayed by the mitigation
activity above, but otherwise it's making good progress and we're excited to
see how Decentralised MLS performs in reality against Olm+Megolm v2.

We'd like to apologise to the wider Matrix community for the inconvenience and
disruption of these issues, and thank you for your patience while we've
resolved them.

Matthew, Denis and the Matrix cryptography & security teams.

## The Foundation needs you

The Matrix.org Foundation is a non-profit and only relies
on donations to operate. Its core mission is to maintain
the Matrix Specification, but it does much more than that.

It maintains the matrix.org homeserver and hosts several
bridges for free. It fights for our collective rights to
digital privacy and dignity.

[Support us](/support)

[Donate](/support)
[Shop](https://shop.matrix.org)
[Security Disclosure Policy](/security-disclosure-policy)
[Security Hall of Fame](/security-hall-of-fame)
[Code of Conduct](/legal/code-of-conduct)
[Legal](/legal)
[Contact](/contact)
[Site Source](https://github.com/matrix-org/matrix.org/)

[![GitHub](/assets/github.svg)](https://github.com/matrix-org)
[![GitLab](/assets/gitlab.svg)](https://gitlab.matrix.org/)
[![Mastodon](/assets/mastodon.svg)](https://mastodon.matrix.org/%40matrix)
[![Twitter](/assets/twitter.svg)](https://twitter.com/matrixdotorg)
[![YouTube](/assets/youtube.svg)](https://www.youtube.com/channel/UCVFkW-chclhuyYRbmmfwt6w)
[![RSS](/assets/rss.svg)](/atom.xml)

[Copyright Notice](/legal/copyright-notice)


