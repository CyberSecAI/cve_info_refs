```
{
  "vulnerability": {
    "root_cause": "The Matrix Federation API allows remote homeservers to request authorization events of events in a room. Synapse homeservers did not sufficiently check if the requesting server had the right to access them.",
    "weaknesses": [
      "Insufficient authorization checks when handling federation requests for authorization events."
    ],
    "impact": "A malicious actor can potentially access authorization events of a room (including power level events, membership events, room creation events, etc) by sending a federation request, even if they are not authorized.",
    "attack_vectors": [
      "A remote homeserver sends a federation request to another homeserver requesting the authorization events of an event within a room."
    ],
    "required_attacker_capabilities": "The attacker needs to know the room ID and the ID of an event within the targeted room."
  },
  "fixes": [
    "The vulnerability was patched in Synapse version 1.69.0. The fix tells remote homeservers that the server is unable to authorize them if they query a room that has partial state on the server."
  ],
  "workarounds": [
    "Using the `federation_domain_whitelist` configuration option to restrict federation to only trusted servers can mitigate the issue."
  ],
  "cve": "CVE-2022-39335"
}
```