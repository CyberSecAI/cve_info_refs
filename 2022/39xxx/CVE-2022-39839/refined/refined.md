The provided content describes a stored Cross-Site Scripting (XSS) vulnerability in the Cotonti forum software.

**Root cause of vulnerability:**
The vulnerability stems from insufficient sanitization of user-supplied input, specifically within the forum's poll creation feature. The application was using HTMLPurifier to sanitize input, but was not properly configured to disable JavaScript for administrators.

**Weaknesses/vulnerabilities present:**
- Stored XSS vulnerability: Malicious JavaScript code can be injected and stored in the database, which is then executed when other users view the content.
- Inadequate sanitization: HTMLPurifier was not configured to remove JavaScript tags for administrators, allowing them to inject malicious code.

**Impact of exploitation:**
- Arbitrary code execution in the context of the victim's browser. This can lead to:
    - Account hijacking.
    - Defacement of the website.
    - Data theft.
    - Redirecting users to malicious sites.

**Attack vectors:**
- The vulnerability is exploited through the forum's poll creation feature.

**Required attacker capabilities/position:**
- The attacker needs to be an administrator to create a poll with malicious JavaScript code.
- A victim needs to visit the topic containing the malicious poll for the XSS payload to execute in their browser.

**Additional notes:**
- The initial fix involved disabling `<script>` tags in HTMLPurifier for administrators.
- A suggestion was made to use a whitelist approach for sanitization instead of a blacklist approach. The vulnerability was found in version 0.9.20 of the Cotonti forum software and was fixed in version 0.9.21.
- The discussion indicates that regular users have stricter HTMLPurifier settings, thus only administrators were initially vulnerable.