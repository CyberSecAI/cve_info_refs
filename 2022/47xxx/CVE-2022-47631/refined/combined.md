=== Content from www.syss.de_0b384a3c_20250114_194333.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2023-002
Product: Razer Synapse
Manufacturer: Razer Inc.
Affected Version(s): Versions before 3.8.0428.042117 (20230601)
Tested Version(s): 3.8.0228.022313 (20230315)
under Windows 10 Pro (10.0.19044)
under Windows 11 Home (10.0.22621)
Vulnerability Type: Improper Privilege Management (CWE-269)
Time-of-check Time-of-use Race Condition (CWE-367)
Risk Level: High
Solution Status: Fixed
Manufacturer Notification: 2023-03-23
Solution Date: 2023-04-28
Public Disclosure: 2023-08-31
CVE Reference: CVE-2022-47631
Author of Advisory: Dr. Oliver Schwarz, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Razer Synapse is an additional driver software for Razer gaming devices.
The manufacturer describes the product as a "unified cloud-based
hardware configuration tool" (see [1]).
Due to an unsafe installation path, improper privilege management, and a
time-of-check time-of-use race condition, the associated system service
"Razer Synapse Service" is vulnerable to DLL hijacking.
As a result, local Windows users can abuse the Razer driver installer to
obtain administrative privileges on Windows.
In order to exploit the vulnerability, the attacker needs physical
access to the machine and needs to prepare the attack before Razer
Synapse is installed along with a Razer driver.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The attack scenario considers a Windows machine without any previous
installation of any Razer device or software.
The attacker has a local unprivileged Windows account, physical access
to the machine, and a device which is either a Razer peripheral or able
to pretend to be one (such as a Bash Bunny or a Raspberry Pi Zero).
The attacker aims at executing code with full system privileges.
The attack exploits the Razer Synapse Service which runs with elevated
privileges. While the main binary of the service is stored in the
protected location "C:\Program Files (x86)\Razer\Synapse3\Service", it
dynamically loads libraries from
"C:\ProgramData\Razer\Synapse3\Service\bin".
Before the installation, standard users can write to this path, since
"C:\ProgramData" is world-writable on a standard installation of
Windows.
The Synapse installation procedure changes access privileges, so that
standard users cannot write to the path any longer.
However, if the path is created before the driver installation, the
creator can set own files to be read-only and deny write access for
the SYSTEM user.
Upon start, the Synapse service checks the location for foreign DLLs,
removes them, and aborts upon failure to delete them.
However, due to a time-of-check time-of-use race condition, attackers
can replace a benign DLL after it has been checked and before it is
loaded.
Note that the described vulnerability is similar to CVE-2021-44226
(SYSS-2021-058) and CVE-2022-47632 (SYSS-2022-047), which Razer Inc.
fixed in March and September of 2022, respectively.
The new attack differs from the earlier ones in that the attacker
now has to exploit a race condition.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The attack consists of the following steps:
1. Before the installation of the driver/Synapse, the attacker creates
"C:\ProgramData\Razer\Synapse3\Service\bin", copies a custom
malicious version of userenv.dll into the directory, sets the DLL to
read-only, and denies write access for SYSTEM.
2. Afterwards, the attacker triggers the installation of Synapse.
This can be done without any elevated privileges by plugging in a
Razer device and following the installation procedure for Synapse
if device-specific co-installers are not disabled.
Alternatively, a device such as Bash Bunny or a Raspberry Pi Zero
can be used and pretend to be a Razer device.
3. With the help of a script, the attacker monitors the installation
progress. As soon as legitimate DLL files show up in the directory,
the attacker temporarily overwrites the malicious DLL with a
legitimate one, waits for the DLL to be assessed (i.e., read), and
then quickly copies back the malicious content to the DLL before it
is actually loaded and executed.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Razer has published a patched version that will be deployed automatically
upon driver installation on current Windows builds.
To prevent similar attacks through other co-installers, system
administrators can disable them by setting the following key in the
Windows registry:
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Installer\DisableCoInstallers = 1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2022-12-19: Vulnerability discovered
2023-03-23: Vulnerability reported to manufacturer
2023-04-28: Patch released by manufacturer
2023-08-31: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Razer Synapse 3
https://www2.razer.com/eu-en/synapse-3
[2] SySS Security Advisory SYSS-2023-002
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2023-002.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy
[4] SySS Proof of Concept Video
https://youtu.be/0myDcqmtt0U
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Oliver Schwarz of SySS GmbH.
E-Mail: oliver.schwarz@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Oliver\_Schwarz.asc
Key ID: 0x9716294F1294280D
Key Fingerprint: D452 B014 E992 2886 E799 6B43 9716 294F 1294 280D
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: https://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE1FKwFOmSKIbnmWtDlxYpTxKUKA0FAmTsprkACgkQlxYpTxKU
KA2+ehAAh0McQFUxuHHBPDlUmhoWLI+iOfTu7sGmJQLmHA5OToLnvCmz1Eqal7C2
B1G3IR8S9wvj5Ah2TFQdCAg0s4+WL+LmvhcxjL2t2Iq8hVd9v/kWFfx4N95YfA3f
CveZRfFbMLgPN18pyKN41J5K1JjDj7HEHNYGOD/s5PsevM1tMwgQCz4PB/dAZcVj
0NkiiadD+xpe03H9S4H5DxyY10k1xt4vFNo2KObEfTnBPTNWte8VG7C7NNLSnqhS
uQDR4wFrDQ2AT03im8ErN4ymXljohPVOTmIS8mvSrC72r6S0OD395Fm8FBW3qirg
Y5y2YQsWbtbMLtGcOB4aRRQhS3QAUkmGG64vd+Wfg7/a/ntjMM9TPzmWDAQbHkLf
mZihJlO4VNY8pSrQRx66bfodDffMBm0Jb0ArLL+/EktbpyGsGx18W2CXmYLVj0B7
FOUoHbNRoecSDnrx8PrhiQOgnmVhC0fw5IKoFZSmRLPNFOZQKUWR0T3kpYL83nUT
VzGfSY0ZC+d41hWTJwv7Jqf/qKSt274T5GVZklkWEBaR0tabEwwfG2jLZnlxTja+
X2bTVh013HjeltVXeJCMWQrqJrlr52AZNQQYRNBU5EWlkm9itsmHyOsbe0o04yvn
cQIjjiwYi1Rao0irOHG+sv5m/FgDpXm+FzcjGhptLAHPU5MC0uc=
=TecR
-----END PGP SIGNATURE-----


=== Content from seclists.org_f8898a99_20250114_194332.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

![](/shared/images/nst-icons.svg#search)

# [SYSS-2023-002] Razer Synapse - Local Privilege Escalation

---

*From*: Oliver Schwarz via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 13 Sep 2023 14:18:30 +0200

---

```

Advisory ID:               SYSS-2023-002
Product:                   Razer Synapse
Manufacturer:              Razer Inc.
Affected Version(s):       Versions before 3.8.0428.042117 (20230601)
Tested Version(s):         3.8.0228.022313 (20230315)
                           under Windows 10 Pro (10.0.19044)
                           under Windows 11 Home (10.0.22621)
Vulnerability Type:        Improper Privilege Management (CWE-269)

```
 Time-of-check Time-of-use Race Condition
(CWE-367)
```

Risk Level:                High
Solution Status:           Fixed
Manufacturer Notification: 2023-03-23
Solution Date:             2023-04-28
Public Disclosure:         2023-08-31
CVE Reference:             CVE-2022-47631
Author of Advisory:        Dr. Oliver Schwarz, SySS GmbH

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Overview:

Razer Synapse is an additional driver software for Razer gaming devices.
The manufacturer describes the product as a "unified cloud-based
hardware configuration tool" (see [1]).

Due to an unsafe installation path, improper privilege management, and a
time-of-check time-of-use race condition, the associated system service
"Razer Synapse Service" is vulnerable to DLL hijacking.
As a result, local Windows users can abuse the Razer driver installer to
obtain administrative privileges on Windows.

In order to exploit the vulnerability, the attacker needs physical
access to the machine and needs to prepare the attack before Razer
Synapse is installed along with a Razer driver.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerability Details:

The attack scenario considers a Windows machine without any previous
installation of any Razer device or software.
The attacker has a local unprivileged Windows account, physical access
to the machine, and a device which is either a Razer peripheral or able
to pretend to be one (such as a Bash Bunny or a Raspberry Pi Zero).
The attacker aims at executing code with full system privileges.

The attack exploits the Razer Synapse Service which runs with elevated
privileges. While the main binary of the service is stored in the
protected location "C:\Program Files (x86)\Razer\Synapse3\Service", it
dynamically loads libraries from
"C:\ProgramData\Razer\Synapse3\Service\bin".
Before the installation, standard users can write to this path, since
"C:\ProgramData" is world-writable on a standard installation of
Windows.

The Synapse installation procedure changes access privileges, so that
standard users cannot write to the path any longer.
However, if the path is created before the driver installation, the
creator can set own files to be read-only and deny write access for
the SYSTEM user.

Upon start, the Synapse service checks the location for foreign DLLs,
removes them, and aborts upon failure to delete them.
However, due to a time-of-check time-of-use race condition, attackers
can replace a benign DLL after it has been checked and before it is
loaded.

Note that the described vulnerability is similar to CVE-2021-44226
(SYSS-2021-058) and CVE-2022-47632 (SYSS-2022-047), which Razer Inc.
fixed in March and September of 2022, respectively.
The new attack differs from the earlier ones in that the attacker
now has to exploit a race condition.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Proof of Concept (PoC):

The attack consists of the following steps:

1. Before the installation of the driver/Synapse, the attacker creates
   "C:\ProgramData\Razer\Synapse3\Service\bin", copies a custom
   malicious version of userenv.dll into the directory, sets the DLL to
   read-only, and denies write access for SYSTEM.

2. Afterwards, the attacker triggers the installation of Synapse.
   This can be done without any elevated privileges by plugging in a
   Razer device and following the installation procedure for Synapse
   if device-specific co-installers are not disabled.
   Alternatively, a device such as Bash Bunny or a Raspberry Pi Zero
   can be used and pretend to be a Razer device.

3. With the help of a script, the attacker monitors the installation
   progress. As soon as legitimate DLL files show up in the directory,
   the attacker temporarily overwrites the malicious DLL with a
   legitimate one, waits for the DLL to be assessed (i.e., read), and
   then quickly copies back the malicious content to the DLL before it
   is actually loaded and executed.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solution:

Razer has published a patched version that will be deployed automatically
upon driver installation on current Windows builds.

To prevent similar attacks through other co-installers, system
administrators can disable them by setting the following key in the
Windows registry:

```
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device
Installer\DisableCoInstallers = 1
```

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclosure Timeline:

2022-12-19: Vulnerability discovered
2023-03-23: Vulnerability reported to manufacturer
2023-04-28: Patch released by manufacturer
2023-08-31: Public disclosure of vulnerability

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

References:

[1] Product website for Razer Synapse 3
    <https://www2.razer.com/eu-en/synapse-3>
[2] SySS Security Advisory SYSS-2023-002

<https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2023-002.txt>
[3] SySS Responsible Disclosure Policy
    <https://www.syss.de/en/responsible-disclosure-policy>
[4] SySS Proof of Concept Video
    <https://youtu.be/0myDcqmtt0U>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Credits:

This security vulnerability was found by Dr. Oliver Schwarz of SySS GmbH.

E-Mail: oliver.schwarz () syss de

```
Public Key:
<https://www.syss.de/fileadmin/dokumente/PGPKeys/Oliver_Schwarz.asc>
```

Key ID: 0x9716294F1294280D
Key Fingerprint: D452 B014 E992 2886 E799 6B43 9716 294F 1294 280D

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disclaimer:

The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copyright:

Creative Commons - Attribution (by) - Version 3.0
URL: <https://creativecommons.org/licenses/by/3.0/deed.en>
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](5)
[By Date](date.html#6)
[![Next](/images/right-icon-16x16.png)](7)

[![Previous](/images/left-icon-16x16.png)](5)
[By Thread](index.html#6)
[![Next](/images/right-icon-16x16.png)](7)

### Current thread:

* **[SYSS-2023-002] Razer Synapse - Local Privilege Escalation** *Oliver Schwarz via Fulldisclosure (Sep 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_2a076421_20250114_194331.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


