Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   Integer overflow in the `gf_hevc_read_sps_bs_internal` function, specifically within the calculation of `sps->max_CU_width` and `sps->max_CU_height`.

**Weaknesses/Vulnerabilities:**

*   The code calculates `max_CU_width` and `max_CU_height` using left bit shifts (`<<`). The shift exponent is determined by the sum of `sps->log2_min_luma_coding_block_size` and `sps->log2_diff_max_min_luma_coding_block_size`.
*   When the sum of `sps->log2_min_luma_coding_block_size` and `sps->log2_diff_max_min_luma_coding_block_size` is large enough (e.g., 146 as indicated in the crash report), it exceeds the maximum representable value for the shift count which is an integer, causing an integer overflow, resulting in undefined behavior. This is further specified as a "shift exponent too large" error by the runtime.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** The integer overflow leads to a crash, as reported by the sanitizer. The crash occurs when parsing a crafted media file, potentially leading to a denial-of-service condition.
*   **Data structure corruption:** The vulnerability can also cause corruption of the `sps` data structure because `max_CU_width` and `max_CU_height` can have incorrect values.

**Attack Vectors:**

*   The vulnerability can be triggered by processing a specially crafted HEVC video file (e.g., a .mov file) through the `MP4Box` utility of GPAC.
*   The attacker needs to provide a specially crafted HEVC bitstream where the parameters `sps->log2_min_luma_coding_block_size` and `sps->log2_diff_max_min_luma_coding_block_size` are set such that their sum causes the integer overflow.

**Required Attacker Capabilities/Position:**

*   The attacker needs the ability to provide a specially crafted HEVC bitstream to be processed by the vulnerable version of GPAC.
*   The attacker can trigger the vulnerability through a tool like `MP4Box` provided by GPAC.

**Additional Details:**

*   The specific vulnerable code is in the `media_tools/av_parsers.c` file at line 8316.
*   The issue was found using Address Sanitizer (ASAN), as indicated by the crash report: `runtime error: shift exponent 146 is too large for 32-bit type 'int'`.
*   The provided proof-of-concept (POC) file `poc_int.mov` demonstrates the vulnerability.
*   The issue was fixed in commit `6bb3e4e288f02c9c595e63230979cd5443a1cb7a`.