=== Content from git.kernel.org_982f3309_20250114_232302.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Frederick Lawler <fred@cloudflare.com> | 2023-01-09 10:39:06 -0600 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2023-01-10 18:19:32 -0800 |
| commit | [96398560f26aa07e8f2969d73c8197e6a6d10407](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=96398560f26aa07e8f2969d73c8197e6a6d10407) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)) | |
| tree | [fe7a7cb74e8ce660912bc4dd6db3eec0bbe10f7c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=96398560f26aa07e8f2969d73c8197e6a6d10407) | |
| parent | [53da7aec32982f5ee775b69dce06d63992ce4af3](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=53da7aec32982f5ee775b69dce06d63992ce4af3) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=96398560f26aa07e8f2969d73c8197e6a6d10407&id2=53da7aec32982f5ee775b69dce06d63992ce4af3)) | |
| download | [linux-96398560f26aa07e8f2969d73c8197e6a6d10407.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-96398560f26aa07e8f2969d73c8197e6a6d10407.tar.gz) | |

net: sched: disallow noqueue for qdisc classesWhile experimenting with applying noqueue to a classful queue discipline,
we discovered a NULL pointer dereference in the \_\_dev\_queue\_xmit()
path that generates a kernel OOPS:
# dev=enp0s5
# tc qdisc replace dev $dev root handle 1: htb default 1
# tc class add dev $dev parent 1: classid 1:1 htb rate 10mbit
# tc qdisc add dev $dev parent 1:1 handle 10: noqueue
# ping -I $dev -w 1 -c 1 1.1.1.1
[ 2.172856] BUG: kernel NULL pointer dereference, address: 0000000000000000
[ 2.173217] #PF: supervisor instruction fetch in kernel mode
...
[ 2.178451] Call Trace:
[ 2.178577] <TASK>
[ 2.178686] htb\_enqueue+0x1c8/0x370
[ 2.178880] dev\_qdisc\_enqueue+0x15/0x90
[ 2.179093] \_\_dev\_queue\_xmit+0x798/0xd00
[ 2.179305] ? \_raw\_write\_lock\_bh+0xe/0x30
[ 2.179522] ? \_\_local\_bh\_enable\_ip+0x32/0x70
[ 2.179759] ? \_\_\_neigh\_create+0x610/0x840
[ 2.179968] ? eth\_header+0x21/0xc0
[ 2.180144] ip\_finish\_output2+0x15e/0x4f0
[ 2.180348] ? dst\_output+0x30/0x30
[ 2.180525] ip\_push\_pending\_frames+0x9d/0xb0
[ 2.180739] raw\_sendmsg+0x601/0xcb0
[ 2.180916] ? \_raw\_spin\_trylock+0xe/0x50
[ 2.181112] ? \_raw\_spin\_unlock\_irqrestore+0x16/0x30
[ 2.181354] ? get\_page\_from\_freelist+0xcd6/0xdf0
[ 2.181594] ? sock\_sendmsg+0x56/0x60
[ 2.181781] sock\_sendmsg+0x56/0x60
[ 2.181958] \_\_sys\_sendto+0xf7/0x160
[ 2.182139] ? handle\_mm\_fault+0x6e/0x1d0
[ 2.182366] ? do\_user\_addr\_fault+0x1e1/0x660
[ 2.182627] \_\_x64\_sys\_sendto+0x1b/0x30
[ 2.182881] do\_syscall\_64+0x38/0x90
[ 2.183085] entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
...
[ 2.187402] </TASK>
Previously in commit d66d6c3152e8 ("net: sched: register noqueue
qdisc"), NULL was set for the noqueue discipline on noqueue init
so that \_\_dev\_queue\_xmit() falls through for the noqueue case. This
also sets a bypass of the enqueue NULL check in the
register\_qdisc() function for the struct noqueue\_disc\_ops.
Classful queue disciplines make it past the NULL check in
\_\_dev\_queue\_xmit() because the discipline is set to htb (in this case),
and then in the call to \_\_dev\_xmit\_skb(), it calls into htb\_enqueue()
which grabs a leaf node for a class and then calls qdisc\_enqueue() by
passing in a queue discipline which assumes ->enqueue() is not set to NULL.
Fix this by not allowing classes to be assigned to the noqueue
discipline. Linux TC Notes states that classes cannot be set to
the noqueue discipline. [1] Let's enforce that here.
Links:
1. https://linux-tc-notes.sourceforge.net/tc/doc/sch\_noqueue.txt
Fixes: d66d6c3152e8 ("net: sched: register noqueue qdisc")
Cc: stable@vger.kernel.org
Signed-off-by: Frederick Lawler <fred@cloudflare.com>
Reviewed-by: Jakub Sitnicki <jakub@cloudflare.com>
Link: [https://lore.kernel.org/r/20230109163906.706000-1-fred@cloudflare.com](https://lore.kernel.org/r/20230109163906.706000-1-fred%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=96398560f26aa07e8f2969d73c8197e6a6d10407)

| -rw-r--r-- | [net/sched/sch\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/sched/sch_api.c?id=96398560f26aa07e8f2969d73c8197e6a6d10407) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/sched/sch\_api.c b/net/sched/sch\_api.cindex 2317db02c764d2..72d2c204d5f340 100644--- a/[net/sched/sch\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/sched/sch_api.c?id=53da7aec32982f5ee775b69dce06d63992ce4af3)+++ b/[net/sched/sch\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/sched/sch_api.c?id=96398560f26aa07e8f2969d73c8197e6a6d10407)@@ -1133,6 +1133,11 @@ skip: return -ENOENT; } + if (new && new->ops == &noqueue\_qdisc\_ops) {+ NL\_SET\_ERR\_MSG(extack, "Cannot assign noqueue to a class");+ return -EINVAL;+ }+ err = cops->graft(parent, cl, new, &old, extack); if (err) return err; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:21:39 +0000



=== Content from tldp.org_8c1db22a_20250114_232303.html ===


| Traffic Control HOWTO: | | |
| --- | --- | --- |
| [Prev](elements.html) |  | [Next](software.html) |

---

# 4. Components of Linux Traffic Control

**Table 1. Correlation between traffic control elements and Linux
components**

| traditional element | Linux component |
| --- | --- |
| [shaping](elements.html#e-shaping) | The [class](components.html#c-class) offers shaping capabilities. |
| [scheduling](elements.html#e-scheduling) | A [qdisc](components.html#c-qdisc) is a scheduler. Schedulers can be simple such as the FIFO or complex, containing classes and other qdiscs, such as HTB. |
| [classifying](elements.html#e-classifying) | The [filter](components.html#c-filter) object performs the classification through the agency of a [classifier](components.html#c-classifier) object. Strictly speaking, Linux classifiers cannot exist outside of a filter. |
| [policing](elements.html#e-policing) | A [policer](components.html#c-police) exists in the Linux traffic control implementation only as part of a [filter](components.html#c-filter). |
| [dropping](elements.html#e-dropping) | To [drop](components.html#c-drop) traffic requires a [filter](components.html#c-filter) with a [policer](components.html#c-police) which uses "drop" as an action. |
| [marking](elements.html#e-marking) | The dsmark [qdisc](components.html#c-qdisc) is used for marking. |

## 4.1. qdisc

Simply put, a qdisc is a scheduler
([Section 3.2](elements.html#e-scheduling)). Every output interface needs a
scheduler of some kind, and the default scheduler is a FIFO.
Other qdiscs available under Linux will rearrange the packets entering
the scheduler's queue in accordance with that scheduler's rules.

The qdisc is the major building block on which all of Linux traffic
control is built, and is also called a queuing discipline.

The [classful qdiscs](classful-qdiscs.html) can contain [class](components.html#c-class)es, and provide a handle
to which to attach [filter](components.html#c-filter)s. There is no prohibition on using a
classful qdisc without child classes, although this will usually consume
cycles and other system resources for no benefit.

The [classless qdiscs](classless-qdiscs.html) can contain no classes, nor is it possible to
attach filter to a classless qdisc. Because a classless qdisc contains
no children of any kind, there is no utility to [classifying](elements.html#e-classifying).
This means that no filter can be attached to a classless qdisc.

A source of terminology confusion is the usage of the terms
root qdisc and ingress qdisc. These are not
really queuing disciplines, but rather locations onto which traffic
control structures can be attached for egress (outbound traffic) and
ingress (inbound traffic).

Each interface contains both. The primary and more common is the
egress qdisc, known as the root qdisc. It can contain any
of the queuing disciplines ([qdisc](components.html#c-qdisc)s) with potential
[class](components.html#c-class)es and class structures. The overwhelming majority of
documentation applies to the root qdisc and its children. Traffic
transmitted on an interface traverses the egress or root qdisc.

For traffic accepted on an interface, the ingress qdisc is traversed.
With its limited utility, it allows no child [class](components.html#c-class) to be
created, and only exists as an object onto which a [filter](components.html#c-filter) can be
attached. For practical purposes, the ingress qdisc is merely a
convenient object onto which to attach a [policer](components.html#c-police) to limit the
amount of traffic accepted on a network interface.

In short, you can do much more with an egress qdisc because it contains
a real qdisc and the full power of the traffic control system. An
ingress qdisc can only support a policer. The remainder of the
documentation will concern itself with traffic control structures
attached to the root qdisc unless otherwise specified.

## 4.2. class

Classes only exist inside a classful [qdisc](components.html#c-qdisc) (*e.g.*, [HTB](classful-qdiscs.html#qc-htb)
and [CBQ](classful-qdiscs.html#qc-cbq)). Classes are immensely flexible and can always
contain either multiple children classes or a single child qdisc
[[1]](#FTN.AEN422).
There is no prohibition against a class containing a classful qdisc
itself, which facilitates tremendously complex traffic control
scenarios.

Any class can also have an arbitrary number of [filter](components.html#c-filter)s attached
to it, which allows the selection of a child class or the use of a
filter to reclassify or drop traffic entering a particular class.

A leaf class is a terminal class in a qdisc. It contains a qdisc
(default [FIFO](classless-qdiscs.html#qs-fifo)) and will never contain a child class. Any
class which contains a child class is an inner class (or root class) and
not a leaf class.

## 4.3. filter

The filter is the most complex component in the Linux
traffic control system. The filter provides a convenient mechanism for
gluing together several of the key elements of traffic control. The
simplest and most obvious role of the filter is to classify
(see [Section 3.3](elements.html#e-classifying)) packets. Linux filters allow the
user to classify packets into an output queue with either several
different filters or a single filter.

* A filter must contain a [classifier](components.html#c-classifier) phrase.
* A filter may contain a [policer](components.html#c-police) phrase.

Filters can be attached either to classful [qdisc](components.html#c-qdisc)s or to
[class](components.html#c-class)es, however the enqueued packet always enters the root
qdisc first. After the filter attached to the root qdisc has been
traversed, the packet may be directed to any subclasses (which can have
their own filters) where the packet may undergo further classification.

## 4.4. classifier

Filter objects, which can be manipulated using [**tc**](software.html#s-iproute2-tc), can use several
different classifying mechanisms, the most common of which is the
u32 classifier. The u32 classifier allows the user to
select packets based on attributes of the packet.

The classifiers are tools which can be used as part of a [filter](components.html#c-filter)
to identify characteristics of a packet or a packet's metadata. The
Linux classfier object is a direct analogue to the basic operation and
elemental mechanism of traffic control [classifying](elements.html#e-classifying).

## 4.5. policer

This elemental mechanism is only used in Linux traffic control as part
of a [filter](components.html#c-filter). A policer calls one action above and another
action below the specified rate. Clever use of policers can simulate
a three-color meter. See also
[Section 10](diagram.html).

Although both [policing](elements.html#e-policing) and [shaping](elements.html#e-shaping) are basic
elements of traffic control for limiting bandwidth usage a policer will
never delay traffic. It can only perform an action based on specified
criteria. See also
[Example 5](software.html#ex-s-iproute2-tc-filter).

## 4.6. drop

This basic traffic control mechanism is only used in Linux traffic
control as part of a [policer](components.html#c-police). Any policer attached to
any [filter](components.html#c-filter) could have a [drop](components.html#c-drop) action.

| Note | The only place in the Linux traffic control system where a packet can be explicitly dropped is a policer. A policer can limit packets enqueued at a specific rate, or it can be configured to drop all traffic matching a particular pattern [[2]](#FTN.AEN483). |
| --- | --- |

There are, however, places within the traffic control system where a
packet may be dropped as a side effect. For example, a packet will be
dropped if the scheduler employed uses this method to control flows as
the [GRED](classless-qdiscs.html#qs-gred) does.

Also, a shaper or scheduler which runs out of its allocated buffer space
may have to drop a packet during a particularly bursty or overloaded
period.

## 4.7. handle

Every [class](components.html#c-class) and classful [qdisc](components.html#c-qdisc) (see also
[Section 7](classful-qdiscs.html)) requires a unique identifier within
the traffic control structure. This unique identifier is known as a
handle and has two constituent members, a major number and a minor
number. These numbers can be assigned arbitrarily by the user in
accordance with the following rules
[[3]](#FTN.AEN505).

**The numbering of handles for classes and qdiscs**

*major*

This parameter is completely free of meaning to the kernel. The
user may use an arbitrary numbering scheme, however all objects in
the traffic control structure with the same parent must share a
*major* handle number. Conventional
numbering schemes start at 1 for objects attached directly to the
root qdisc.

*minor*

This parameter unambiguously identifies the object as a qdisc if
*minor* is 0. Any other value identifies the
object as a class. All classes sharing a parent must have unique
*minor* numbers.

The special handle ffff:0 is reserved for the ingress qdisc.

The handle is used as the target in *classid* and
*flowid* phrases of **tc** [filter](components.html#c-filter) statements.
These handles are external identifiers for the objects, usable by
userland applications. The kernel maintains internal identifiers for
each object.

### Notes

| [[1]](components.html#AEN422) | A classful qdisc can only have children classes of its type. For example, an HTB qdisc can only have HTB classes as children. A CBQ qdisc cannot have HTB classes as children. |
| --- | --- |
| [[2]](components.html#AEN483) | In this case, you'll have a [filter](components.html#c-filter) which uses a [classifier](components.html#c-classifier) to select the packets you wish to drop. Then you'll use a [policer](components.html#c-police) with a with a drop action like this **police rate 1bps burst 1 action drop/drop**. |
| [[3]](components.html#AEN505) | I do not know the range nor base of these numbers. I believe they are u32 hexadecimal, but need to confirm this. |

---

| [Prev](elements.html) | [Home](index.html) | [Next](software.html) |
| --- | --- | --- |
| Traditional Elements of Traffic Control |  | Software and Tools |



=== Content from www.debian.org_92bfbf63_20250114_232304.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DSA 5324-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5324-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Mon, 23 Jan 2023 20:11:44 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1pK3AO-006ihI-7r%40seger.debian.org)Â [E1pK3AO-006ihI-7r@seger.debian.org](msg00013.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5324-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
January 23, 2023                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2022-2873 CVE-2022-3545 CVE-2022-3623 CVE-2022-4696
                 CVE-2022-36280 CVE-2022-41218 CVE-2022-45934 CVE-2022-47929
                 CVE-2023-0179 CVE-2023-0266 CVE-2023-0394 CVE-2023-23454
                 CVE-2023-23455

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2022-2873

    Zheyu Ma discovered that an out-of-bounds memory access flaw in the
    Intel iSMT SMBus 2.0 host controller driver may result in denial of
    service (system crash).

CVE-2022-3545

    It was discovered that the Netronome Flow Processor (NFP) driver
    contained a use-after-free flaw in area_cache_get(), which may
    result in denial of service or the execution of arbitrary code.

CVE-2022-3623

    A race condition when looking up a CONT-PTE/PMD size hugetlb page
    may result in denial of service or an information leak.

CVE-2022-4696

    A use-after-free vulnerability was discovered in the io_uring
    subsystem.

CVE-2022-36280

    An out-of-bounds memory write vulnerability was discovered in the
    vmwgfx driver, which may allow a local unprivileged user to cause a
    denial of service (system crash).

CVE-2022-41218

    Hyunwoo Kim reported a use-after-free flaw in the Media DVB core
    subsystem caused by refcount races, which may allow a local user to
    cause a denial of service or escalate privileges.

CVE-2022-45934

    An integer overflow in l2cap_config_req() in the Bluetooth subsystem
    was discovered, which may allow a physically proximate attacker to
    cause a denial of service (system crash).

CVE-2022-47929

    Frederick Lawler reported a NULL pointer dereference in the traffic
    control subsystem allowing an unprivileged user to cause a denial of
    service by setting up a specially crafted traffic control
    configuration.

CVE-2023-0179

    Davide Ornaghi discovered incorrect arithmetics when fetching VLAN
    header bits in the netfilter subsystem, allowing a local user to
    leak stack and heap addresses or potentially local privilege
    escalation to root.

CVE-2023-0266

    A use-after-free flaw in the sound subsystem due to missing locking
    may result in denial of service or privilege escalation.

CVE-2023-0394

    Kyle Zeng discovered a NULL pointer dereference flaw in
    rawv6_push_pending_frames() in the network subsystem allowing a
    local user to cause a denial of service (system crash).

CVE-2023-23454

    Kyle Zeng reported that the Class Based Queueing (CBQ) network
    scheduler was prone to denial of service due to interpreting
    classification results before checking the classification
    return code.

CVE-2023-23455

    Kyle Zeng reported that the ATM Virtual Circuits (ATM) network
    scheduler was prone to a denial of service due to interpreting
    classification results before checking the classification
    return code.

For the stable distribution (bullseye), these problems have been fixed in
version 5.10.162-1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmPO6CtfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Ra0w//fLN39l/vLOzDs++lrDvYDVGpTFS/D3CfMq6ucxI36BEoxPXk5aKyH/la
red6SnuLf7lI+4CcH3vvLpo1vHreqOXRXoE/u1JdWij9vvLHyHjJKLgCkn43UlLN
ukdEnmls3DCJr42apdHhV7nyjLXfBzocgOfq8+oOUHS2/K2SPYc1dqtn96Dsmogu
nH/Mcorr9kHX1wjWtCPQCCSsjo3+xxRzc1WDpbdqolox979s7hFSIqZ65T74w/mV
KksIg/4CJHNlwo/piiwH6/Gi419v6Tj4HPUPcJpFEJou6adnnXqrBX+aNE9WvHEe
Y/Fmj2DSxBvCJ+MKzCVWNf94lfjxcb4mE8VlUxUTa6BR0BGC7/iKDz0HglYPnbue
zdNMEUcsgw3pxLB9sorFmcPbKOgzquwp2WLGCPxw04UMDmK5bBTZ/zKVa1b639C9
BGeOmDCfg9+b33Er9pKvvuky/C3divGbZ3TnWKcztVPR33Y2e2E1WtvvbLtayFsO
0ezn8r7vNCu+3hBTT09wXJQzil7o1zyfb9MwtzgSuxksLoFbm/B21rw1KEzTgyCC
FiQDJF2OQNmzKJokNgsmpIknx75/x1WG1UQbMeO15tZW8zSjItrDtiydw8Uyrs+8
BU0Ta3tiqtyOrlc22k+K2yDWrg16pRw9ik3iNokYgM7z/RcHwv4=
=7Ixp
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_cf152cef_20250114_232302.html ===


---

[[Date Prev](msg00005.html)][[Date Next](msg00007.html)]
[[Thread Prev](msg00005.html)][[Thread Next](msg00007.html)]
[[Date Index](maillist.html#00006)]
[[Thread Index](threads.html#00006)]

# [SECURITY] [DLA 3403-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3403-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Wed, 3 May 2023 14:01:28 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZFJNGHuB08t0uKuB%40decadent.org.uk)Â [ZFJNGHuB08t0uKuB@decadent.org.uk](msg00006.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3403-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
May 3, 2023                                   <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.19.282-1
CVE ID         : CVE-2022-2873 CVE-2022-3424 CVE-2022-3545 CVE-2022-3707
                 CVE-2022-4744 CVE-2022-36280 CVE-2022-41218 CVE-2022-45934
                 CVE-2022-47929 CVE-2023-0045 CVE-2023-0266 CVE-2023-0394
                 CVE-2023-0458 CVE-2023-0459 CVE-2023-0461 CVE-2023-1073
                 CVE-2023-1074 CVE-2023-1078 CVE-2023-1079 CVE-2023-1118
                 CVE-2023-1281 CVE-2023-1513 CVE-2023-1670 CVE-2023-1829
                 CVE-2023-1855 CVE-2023-1859 CVE-2023-1989 CVE-2023-1990
                 CVE-2023-1998 CVE-2023-2162 CVE-2023-2194 CVE-2023-23454
                 CVE-2023-23455 CVE-2023-23559 CVE-2023-26545 CVE-2023-28328
                 CVE-2023-30456 CVE-2023-30772
Debian Bug     : 825141

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service, or information
leak.

CVE-2022-2873

    Zheyu Ma discovered that an out-of-bounds memory access flaw in
    the Intel iSMT SMBus 2.0 host controller driver may result in
    denial of service (system crash).

CVE-2022-3424

    Zheng Wang and Zhuorao Yang reported a flaw in the SGI GRU driver
    which could lead to a use-after-free.  On systems where this driver
    is used, a local user can explit this for denial of service (crash
    or memory corruption) or possibly for privilege escalation.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2022-3545

    It was discovered that the Netronome Flow Processor (NFP) driver
    contained a use-after-free flaw in area_cache_get(), which may
    result in denial of service or the execution of arbitrary code.

CVE-2022-3707

    Zheng Wang reported a flaw in the i915 graphics driver's
    virtualisation (GVT-g) support that could lead to a double-free.
    On systems where this feature is used, a guest can exploit this
    for denial of service (crash or memory corruption) or possibly for
    privilege escalation.

CVE-2022-4744

    The syzkaller tool found a flaw in the TUN/TAP network driver,
    which can lead to a double-free.  A local user can exploit this
    for denial of service (crash or memory corruption) or possibly for
    privilege escalation.

CVE-2022-36280

    An out-of-bounds memory write vulnerability was discovered in the
    vmwgfx driver, which may allow a local unprivileged user to cause
    a denial of service (system crash).

CVE-2022-41218

    Hyunwoo Kim reported a use-after-free flaw in the Media DVB core
    subsystem caused by refcount races, which may allow a local user
    to cause a denial of service or escalate privileges.

CVE-2022-45934

    An integer overflow in l2cap_config_req() in the Bluetooth
    subsystem was discovered, which may allow a physically proximate
    attacker to cause a denial of service (system crash).

CVE-2022-47929

    Frederick Lawler reported a NULL pointer dereference in the
    traffic control subsystem allowing an unprivileged user to cause a
    denial of service by setting up a specially crafted traffic
    control configuration.

CVE-2023-0045

    Rodrigo Branco and Rafael Correa De Ysasi reported that when a
    user-space task told the kernel to enable Spectre v2 mitigation
    for it, the mitigation was not enabled until the task was next
    rescheduled.  This might be exploitable by a local or remote
    attacker to leak sensitive information from such an application.

CVE-2023-0266

    A use-after-free flaw in the sound subsystem due to missing
    locking may result in denial of service or privilege escalation.

CVE-2023-0394

    Kyle Zeng discovered a NULL pointer dereference flaw in
    rawv6_push_pending_frames() in the network subsystem allowing a
    local user to cause a denial of service (system crash).

CVE-2023-0458

    Jordy Zimmer and Alexandra Sandulescu found that getrlimit() and
    related system calls were vulnerable to speculative execution
    attacks such as Spectre v1.  A local user could explot this to
    leak sensitive information from the kernel.

CVE-2023-0459

    Jordy Zimmer and Alexandra Sandulescu found a regression in
    Spectre v1 mitigation in the user-copy functions for the amd64
    (64-bit PC) architecture.  Where the CPUs do not implement SMAP or
    it is disabled, a local user could exploit this to leak sensitive
    information from the kernel.  Other architectures may also be
    affected.

CVE-2023-0461

    "slipper" reported a flaw in the kernel's support for ULPs (Upper
    Layer Protocols) on top of TCP that can lead to a double-free when
    using kernel TLS sockets.  A local user can exploit this for
    denial of service (crash or memory corruption) or possibly for
    privilege escalation.

    Kernel TLS is not enabled in Debian's official kernel
    configurations.

CVE-2023-1073

    Pietro Borrello reported a type confusion flaw in the HID (Human
    Interface Device) subsystem.  An attacker able to insert and
    remove USB devices might be able to use this to cause a denial of
    service (crash or memory corruption) or possibly to run arbitrary
    code in the kernel.

CVE-2023-1074

    Pietro Borrello reported a type confusion flaw in the SCTP
    protocol implementation which can lead to a memory leak.  A local
    user could exploit this to cause a denial of service (resource
    exhaustion).

CVE-2023-1078

    Pietro Borrello reported a type confusion flaw in the RDS protocol
    implementation.  A local user could exploit this to cause a denial
    of service (crash or memory corruption) or possibly for privilege
    escalation.

CVE-2023-1079

    Pietro Borrello reported a race condition in the hid-asus HID
    driver which could lead to a use-after-free.  An attacker able to
    insert and remove USB devices can use this to cause a denial of
    service (crash or memory corruption) or possibly to run arbitrary
    code in the kernel.

CVE-2023-1118

    Duoming Zhou reported a race condition in the ene_ir remote
    control driver that can lead to a use-after-free if the driver
    is unbound.  It is not clear what the security impact of this is.

CVE-2023-1281, CVE-2023-1829

    "valis" reported two flaws in the cls_tcindex network traffic
    classifier which could lead to a use-after-free.  A local user can
    exploit these for privilege escalation.  This update removes
    cls_tcindex entirely.

CVE-2023-1513

    Xingyuan Mo reported an information leak in the KVM implementation
    for the i386 (32-bit PC) architecture.  A local user could exploit
    this to leak sensitive information from the kernel.

CVE-2023-1670

    Zheng Wang reported a race condition in the xirc2ps_cs network
    driver which can lead to a use-after-free.  An attacker able to
    insert and remove PCMCIA devices can use this to cause a denial of
    service (crash or memory corruption) or possibly to run arbitrary
    code in the kernel.

CVE-2023-1855

    Zheng Wang reported a race condition in the xgene-hwmon hardware
    monitoring driver that may lead to a use-after-free.  It is not
    clear what the security impact of this is.

CVE-2023-1859

    Zheng Wang reported a race condition in the 9pnet_xen transport
    for the 9P filesystem on Xen, which can lead to a use-after-free.
    On systems where this feature is used, a backend driver in another
    domain can use this to cause a denial of service (crash or memory
    corruption) or possibly to run arbitrary code in the vulnerable
    domain.

CVE-2023-1989

    Zheng Wang reported a race condition in the btsdio Bluetooth
    adapter driver that can lead to a use-after-free.  An attacker
    able to insert and remove SDIO devices can use this to cause a
    denial of service (crash or memory corruption) or possibly to run
    arbitrary code in the kernel.

CVE-2023-1990

    Zheng Wang reported a race condition in the st-nci NFC adapter
    driver that can lead to a use-after-free.  It is not clear what
    the security impact of this is.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2023-1998

    JosÃ© Oliveira and Rodrigo Branco reported a regression in Spectre
    v2 mitigation for user-space on x86 CPUs supporting IBRS but not
    eIBRS.  This might be exploitable by a local or remote attacker to
    leak sensitive information from a user-space application.

CVE-2023-2162

    Mike Christie reported a race condition in the iSCSI TCP transport
    that can lead to a use-after-free.  On systems where this feature
    is used, a local user might be able to use this to cause a denial
    of service (crash or memory corruption) or possibly for privilege
    escalation.

CVE-2023-2194

    Wei Chen reported a potential heap buffer overflow in the
    i2c-xgene-slimpro IÂ²C adapter driver.  A local user with
    permission to access such a device can use this to cause a denial
    of service (crash or memory corruption) and probably for privilege
    escalation.

CVE-2023-23454

    Kyle Zeng reported that the Class Based Queueing (CBQ) network
    scheduler was prone to denial of service due to interpreting
    classification results before checking the classification return
    code.

CVE-2023-23455

    Kyle Zeng reported that the ATM Virtual Circuits (ATM) network
    scheduler was prone to a denial of service due to interpreting
    classification results before checking the classification return
    code.

CVE-2023-23559

    Szymon Heidrich reported incorrect bounds checks in the rndis_wlan
    Wi-Fi driver which may lead to a heap buffer overflow or overread.
    An attacker able to insert and remove USB devices can use this to
    cause a denial of service (crash or memory corruption) or
    information leak, or possibly to run arbitrary code in the kernel.

CVE-2023-26545

    Lianhui Tang reported a flaw in the MPLS protocol implementation
    that could lead to a double-free.  A local user might be able to
    exploit this to cause a denial of service (crash or memory
    corruption) or possibl for privilege escalation.

CVE-2023-28328

    Wei Chen reported a flaw in the az6927 DVB driver that can lead to
    a null pointer dereference.  A local user permitted to access an
    IÂ²C adapter device that this driver creates can use this to cause
    a denial of service (crash).

CVE-2023-30456

    Reima ISHII reported a flaw in the KVM implementation for Intel
    CPUs affecting nested virtualisation.  When KVM was used as the L0
    hypervisor, and EPT and/or unrestricted guest mode was disabled,
    it did not prevent an L2 guest from being configured with an
    architecturally invalid protection/paging mode.  A malicious guest
    could exploit this to cause a denial of service (crash).

CVE-2023-30772

    Zheng Wang reported a race condition in the da9150 charger driver
    which could lead to a use-after-free.  It is not clear what the
    security impact of this is.

    This driver is not enabled in Debian's official kernel
    configurations.

For Debian 10 buster, these problems have been fixed in version
4.19.282-1.  This update additionally fixes Debian bug #825141, and
includes many more bug fixes from stable updates 4.19.270-4.19.282
inclusive.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpM9k3CPindH.pgp)**

*Description:* PGP signature

---



=== Content from cdn.kernel.org_b632eb2c_20250114_232301.html ===
commit 38f3ee12661fdc2805e06942e4e3d604e03cd9cf
Author: Greg Kroah-Hartman
Date: Sat Jan 14 10:33:46 2023 +0100
Linux 6.1.6
Link: https://lore.kernel.org/r/20230112135326.981869724@linuxfoundation.org
Tested-by: Conor Dooley
Tested-by: Ronald Warsow
Tested-by: Shuah Khan
Tested-by: Kelsey Steele
Tested-by: Takeshi Ogasawara
Tested-by: Guenter Roeck
Tested-by: Bagas Sanjaya
Tested-by: Ron Economos
Tested-by: Sudip Mukherjee
Tested-by: Jon Hunter
Tested-by: Linux Kernel Functional Testing
Tested-by: Allen Pais
Tested-by: Rudi Heitbaum
Tested-by: Salvatore Bonaccorso
Signed-off-by: Greg Kroah-Hartman
commit cb9b3951d6366c30f0085c9830381b1334cdcf62
Author: Takashi Iwai
Date: Thu Jan 5 10:35:31 2023 +0100
ALSA: hda: cs35l41: Check runtime suspend capability at runtime\_idle
commit ae50e2ab122cef68f46b7799fb9deffe3334f5e2 upstream.
The runtime PM core checks with runtime\_idle callback whether it can
goes to the runtime suspend or not, and we can put the boost type
check there instead of runtime\_suspend and \_resume calls. This will
reduce the unnecessary runtime\_suspend() calls.
Fixes: 1873ebd30cc8 ("ALSA: hda: cs35l41: Support Hibernation during Suspend")
Cc:
Link: https://lore.kernel.org/r/20230105093531.16960-2-tiwai@suse.de
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit a6d58eff4f8367af588c49cbceed28147b1030c7
Author: Chris Chiu
Date: Tue Jan 3 17:53:32 2023 +0800
ALSA: hda - Enable headset mic on another Dell laptop with ALC3254
commit a5751933a7f6abbdad90d98f25a25bb4b133a9e6 upstream.
There is another Dell Latitude laptop (1028:0c03) with Realtek
codec ALC3254 which needs the ALC269\_FIXUP\_DELL4\_MIC\_NO\_PRESENCE
instead of the default matched ALC269\_FIXUP\_DELL1\_MIC\_NO\_PRESENCE.
Apply correct fixup for this particular model to enable headset mic.
Signed-off-by: Chris Chiu
Cc:
Link: https://lore.kernel.org/r/20230103095332.730677-1-chris.chiu@canonical.com
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 8107550bfe1189d7459292a66aab30a74c349cda
Author: Takashi Iwai
Date: Thu Jan 5 10:35:30 2023 +0100
ALSA: hda: cs35l41: Don't return -EINVAL from system suspend/resume
commit 15a59cb0a3d6ddf2cb79f8dc3081b3130aad3767 upstream.
The recent commit to support the system suspend for CS35L41 caused a
regression on the models with CS35L41\_EXT\_BOOST\_NO\_VSPK\_SWITC boost
type, as the suspend/resume callbacks just return -EINVAL. This is
eventually handled as a fatal error and blocks the whole system
suspend/resume.
For avoiding the problem, this patch corrects the return code from
cs35l41\_system\_suspend() and \_resume() to 0, and replace dev\_err()
with dev\_err\_once() for stop spamming too much.
Fixes: 88672826e2a4 ("ALSA: hda: cs35l41: Support System Suspend")
Cc:
Link: https://lore.kernel.org/all/e6751ac2-34f3-d13f-13db-8174fade8308@pm.me
Link: https://lore.kernel.org/r/20230105093531.16960-1-tiwai@suse.de
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 57f6bea5218c37426ccf68b37fa66a0f476ef869
Author: Jeremy Szu
Date: Thu Jan 5 12:41:53 2023 +0800
ALSA: hda/realtek: fix mute/micmute LEDs don't work for a HP platform
commit 9c694fbfe6f36017b060ad74c7565cb379852e40 upstream.
There is a HP platform uses ALC236 codec which using GPIO2 to control
mute LED and GPIO1 to control micmute LED.
Thus, add a quirk to make them work.
Signed-off-by: Jeremy Szu
Cc:
Link: https://lore.kernel.org/r/20230105044154.8242-1-jeremy.szu@canonical.com
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 0e19738afc84fc2f8ed1ad1baa0373fcb8ebca36
Author: Adrian Chan
Date: Mon Jan 9 16:05:20 2023 -0500
ALSA: hda/hdmi: Add a HP device 0x8715 to force connect list
commit de1ccb9e61728dd941fe0e955a7a129418657267 upstream.
Add the 'HP Engage Flex Mini' device to the force connect list to
enable audio through HDMI.
Signed-off-by: Adrian Chan
Cc:
Link: https://lore.kernel.org/r/20230109210520.16060-1-adchan@google.com
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit d6ad4bd1d896ae1daffd7628cd50f124280fb8b1
Author: Clement Lecigne
Date: Fri Jan 13 13:07:45 2023 +0100
ALSA: pcm: Move rwsem lock inside snd\_ctl\_elem\_read to prevent UAF
commit 56b88b50565cd8b946a2d00b0c83927b7ebb055e upstream.
Takes rwsem lock inside snd\_ctl\_elem\_read instead of snd\_ctl\_elem\_read\_user
like it was done for write in commit 1fa4445f9adf1 ("ALSA: control - introduce
snd\_ctl\_notify\_one() helper"). Doing this way we are also fixing the following
locking issue happening in the compat path which can be easily triggered and
turned into an use-after-free.
64-bits:
snd\_ctl\_ioctl
snd\_ctl\_elem\_read\_user
[takes controls\_rwsem]
snd\_ctl\_elem\_read [lock properly held, all good]
[drops controls\_rwsem]
32-bits:
snd\_ctl\_ioctl\_compat
snd\_ctl\_elem\_write\_read\_compat
ctl\_elem\_write\_read
snd\_ctl\_elem\_read [missing lock, not good]
CVE-2023-0266 was assigned for this issue.
Cc: stable@kernel.org # 5.13+
Signed-off-by: Clement Lecigne
Reviewed-by: Jaroslav Kysela
Link: https://lore.kernel.org/r/20230113120745.25464-1-tiwai@suse.de
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit e8988e878af693ac13b0fa80ba2e72d22d68f2dd
Author: Frederick Lawler
Date: Mon Jan 9 10:39:06 2023 -0600
net: sched: disallow noqueue for qdisc classes
commit 96398560f26aa07e8f2969d73c8197e6a6d10407 upstream.
While experimenting with applying noqueue to a classful queue discipline,
we discovered a NULL pointer dereference in the \_\_dev\_queue\_xmit()
path that generates a kernel OOPS:
# dev=enp0s5
# tc qdisc replace dev $dev root handle 1: htb default 1
# tc class add dev $dev parent 1: classid 1:1 htb rate 10mbit
# tc qdisc add dev $dev parent 1:1 handle 10: noqueue
# ping -I $dev -w 1 -c 1 1.1.1.1
[ 2.172856] BUG: kernel NULL pointer dereference, address: 0000000000000000
[ 2.173217] #PF: supervisor instruction fetch in kernel mode
...
[ 2.178451] Call Trace:
[ 2.178577]
[ 2.178686] htb\_enqueue+0x1c8/0x370
[ 2.178880] dev\_qdisc\_enqueue+0x15/0x90
[ 2.179093] \_\_dev\_queue\_xmit+0x798/0xd00
[ 2.179305] ? \_raw\_write\_lock\_bh+0xe/0x30
[ 2.179522] ? \_\_local\_bh\_enable\_ip+0x32/0x70
[ 2.179759] ? \_\_\_neigh\_create+0x610/0x840
[ 2.179968] ? eth\_header+0x21/0xc0
[ 2.180144] ip\_finish\_output2+0x15e/0x4f0
[ 2.180348] ? dst\_output+0x30/0x30
[ 2.180525] ip\_push\_pending\_frames+0x9d/0xb0
[ 2.180739] raw\_sendmsg+0x601/0xcb0
[ 2.180916] ? \_raw\_spin\_trylock+0xe/0x50
[ 2.181112] ? \_raw\_spin\_unlock\_irqrestore+0x16/0x30
[ 2.181354] ? get\_page\_from\_freelist+0xcd6/0xdf0
[ 2.181594] ? sock\_sendmsg+0x56/0x60
[ 2.181781] sock\_sendmsg+0x56/0x60
[ 2.181958] \_\_sys\_sendto+0xf7/0x160
[ 2.182139] ? handle\_mm\_fault+0x6e/0x1d0
[ 2.182366] ? do\_user\_addr\_fault+0x1e1/0x660
[ 2.182627] \_\_x64\_sys\_sendto+0x1b/0x30
[ 2.182881] do\_syscall\_64+0x38/0x90
[ 2.183085] entry\_SYSCALL\_64\_after\_hwframe+0x63/0xcd
...
[ 2.187402]
Previously in commit d66d6c3152e8 ("net: sched: register noqueue
qdisc"), NULL was set for the noqueue discipline on noqueue init
so that \_\_dev\_queue\_xmit() falls through for the noqueue case. This
also sets a bypass of the enqueue NULL check in the
register\_qdisc() function for the struct noqueue\_disc\_ops.
Classful queue disciplines make it past the NULL check in
\_\_dev\_queue\_xmit() because the discipline is set to htb (in this case),
and then in the call to \_\_dev\_xmit\_skb(), it calls into htb\_enqueue()
which grabs a leaf node for a class and then calls qdisc\_enqueue() by
passing in a queue discipline which assumes ->enqueue() is not set to NULL.
Fix this by not allowing classes to be assigned to the noqueue
discipline. Linux TC Notes states that classes cannot be set to
the noqueue discipline. [1] Let's enforce that here.
Links:
1. https://linux-tc-notes.sourceforge.net/tc/doc/sch\_noqueue.txt
Fixes: d66d6c3152e8 ("net: sched: register noqueue qdisc")
Cc: stable@vger.kernel.org
Signed-off-by: Frederick Lawler
Reviewed-by: Jakub Sitnicki
Link: https://lore.kernel.org/r/20230109163906.706000-1-fred@cloudflare.com
Signed-off-by: Jakub Kicinski
Signed-off-by: Greg Kroah-Hartman
commit cd2e80a3ac7005f964680ae63946cdde4e970e0a
Author: Linus Torvalds
Date: Mon Jan 9 17:04:49 2023 -0600
gcc: disable -Warray-bounds for gcc-11 too
commit 5a41237ad1d4b62008f93163af1d9b1da90729d8 upstream.
We had already disabled this warning for gcc-12 due to bugs in the value
range analysis, but it turns out we end up having some similar problems
with gcc-11.3 too, so let's disable it there too.
Older gcc versions end up being increasingly less relevant, and
hopefully clang and newer version of gcc (ie gcc-13) end up working
reliably enough that we still get the build coverage even when we
disable this for some versions.
Link: https://lore.kernel.org/all/20221227002941.GA2691687@roeck-us.net/
Link: https://lore.kernel.org/all/D8BDBF66-E44C-45D4-9758-BAAA4F0C1998@kernel.org/
Cc: Kees Cook
Cc: Vlastimil Babka
Cc: Guenter Roeck
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 8cc0e63ba86c9f4e732de9f42642231c8e3a31d2
Author: Chuck Lever
Date: Fri Jan 6 12:43:37 2023 -0500
Revert "SUNRPC: Use RMW bitops in single-threaded hot paths"
commit 7827c81f0248e3c2f40d438b020f3d222f002171 upstream.
The premise that "Once an svc thread is scheduled and executing an
RPC, no other processes will touch svc\_rqst::rq\_flags" is false.
svc\_xprt\_enqueue() examines the RQ\_BUSY flag in scheduled nfsd
threads when determining which thread to wake up next.
Found via KCSAN.
Fixes: 28df0988815f ("SUNRPC: Use RMW bitops in single-threaded hot paths")
Reviewed-by: Jeff Layton
Signed-off-by: Chuck Lever
Signed-off-by: Greg Kroah-Hartman
commit 29fbaa434c223f29917e8de054cc48a96e6c0ed4
Author: Kyle Huey
Date: Tue Nov 15 15:09:32 2022 -0800
selftests/vm/pkeys: Add a regression test for setting PKRU through ptrace
commit 6ea25770b043c7997ab21d1ce95ba5de4d3d85d9 upstream.
This tests PTRACE\_SETREGSET with NT\_X86\_XSTATE modifying PKRU directly and
removing the PKRU bit from XSTATE\_BV.
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-7-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit d2602da3da87a1832f708c8639b0afbfb5704cd4
Author: Kyle Huey
Date: Tue Nov 15 15:09:31 2022 -0800
x86/fpu: Emulate XRSTOR's behavior if the xfeatures PKRU bit is not set
commit d7e5aceace514a2b1b3ca3dc44f93f1704766ca7 upstream.
The hardware XRSTOR instruction resets the PKRU register to its hardware
init value (namely 0) if the PKRU bit is not set in the xfeatures mask.
Emulating that here restores the pre-5.14 behavior for PTRACE\_SET\_REGSET
with NT\_X86\_XSTATE, and makes sigreturn (which still uses XRSTOR) and
ptrace behave identically. KVM has never used XRSTOR and never had this
behavior, so KVM opts-out of this emulation by passing a NULL pkru pointer
to copy\_uabi\_to\_xstate().
Fixes: e84ba47e313d ("x86/fpu: Hook up PKRU into ptrace()")
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-6-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit 587478470b0a632c706090a8b0cbf59de0e98b48
Author: Kyle Huey
Date: Tue Nov 15 15:09:30 2022 -0800
x86/fpu: Allow PKRU to be (once again) written by ptrace.
commit 4a804c4f8356393d6b5eff7600f07615d7869c13 upstream.
Move KVM's PKRU handling code in fpu\_copy\_uabi\_to\_guest\_fpstate() to
copy\_uabi\_to\_xstate() so that it is shared with other APIs that write the
XSTATE such as PTRACE\_SETREGSET with NT\_X86\_XSTATE.
This restores the pre-5.14 behavior of ptrace. The regression can be seen
by running gdb and executing `p $pkru`, `set $pkru = 42`, and `p $pkru`.
On affected kernels (5.14+) the write to the PKRU register (which gdb
performs through ptrace) is ignored.
[ dhansen: removed stable@ tag for now. The ABI was broken for long
enough that this is not urgent material. Let's let it stew
in tip for a few weeks before it's submitted to stable
because there are so many ABIs potentially affected. ]
Fixes: e84ba47e313d ("x86/fpu: Hook up PKRU into ptrace()")
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-5-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit bfa72faf69e82f7d64fefe0ca162f803d98e6679
Author: Kyle Huey
Date: Tue Nov 15 15:09:29 2022 -0800
x86/fpu: Add a pkru argument to copy\_uabi\_to\_xstate()
commit 2c87767c35ee9744f666ccec869d5fe742c3de0a upstream.
In preparation for moving PKRU handling code out of
fpu\_copy\_uabi\_to\_guest\_fpstate() and into copy\_uabi\_to\_xstate(), add an
argument that copy\_uabi\_from\_kernel\_to\_xstate() can use to pass the
canonical location of the PKRU value. For
copy\_sigframe\_from\_user\_to\_xstate() the kernel will actually restore the
PKRU value from the fpstate, but pass in the thread\_struct's pkru location
anyways for consistency.
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-4-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit a442736b704d4194ae68f75f4ee2e64cf2b8a142
Author: Kyle Huey
Date: Tue Nov 15 15:09:28 2022 -0800
x86/fpu: Add a pkru argument to copy\_uabi\_from\_kernel\_to\_xstate().
commit 1c813ce0305571e1b2e4cc4acca451da9e6ad18f upstream.
Both KVM (through KVM\_SET\_XSTATE) and ptrace (through PTRACE\_SETREGSET
with NT\_X86\_XSTATE) ultimately call copy\_uabi\_from\_kernel\_to\_xstate(),
but the canonical locations for the current PKRU value for KVM guests
and processes in a ptrace stop are different (in the kvm\_vcpu\_arch and
the thread\_state structs respectively).
In preparation for eventually handling PKRU in
copy\_uabi\_to\_xstate, pass in a pointer to the PKRU location.
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-3-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit f28418b06f6b1e83c81369ef1705ee53da106ae6
Author: Kyle Huey
Date: Tue Nov 15 15:09:27 2022 -0800
x86/fpu: Take task\_struct\* in copy\_sigframe\_from\_user\_to\_xstate()
commit 6a877d2450ace4f27c012519e5a1ae818f931983 upstream.
This will allow copy\_sigframe\_from\_user\_to\_xstate() to grab the address of
thread\_struct's pkru value in a later patch.
Signed-off-by: Kyle Huey
Signed-off-by: Dave Hansen
Link: https://lore.kernel.org/all/20221115230932.7126-2-khuey%40kylehuey.com
Signed-off-by: Greg Kroah-Hartman
commit 763b92568726b55569ea4896fe36e3c174cc3b0d
Author: Helge Deller
Date: Sun Dec 11 19:50:20 2022 +0100
parisc: Align parisc MADV\_XXX constants with all other architectures
commit 71bdea6f798b425bc0003780b13e3fdecb16a010 upstream.
Adjust some MADV\_XXX constants to be in sync what their values are on
all other platforms. There is currently no reason to have an own
numbering on parisc, but it requires workarounds in many userspace
sources (e.g. glibc, qemu, ...) - which are often forgotten and thus
introduce bugs and different behaviour on parisc.
A wrapper avoids an ABI breakage for existing userspace applications by
translating any old values to the new ones, so this change allows us to
move over all programs to the new ABI over time.
Signed-off-by: Helge Deller
Signed-off-by: Greg Kroah-Hartman


=== Content from www.spinics.net_cafc744c_20250114_232306.html ===


# noqueue qdisc and non-virtual interfaces

[[Date Prev](msg555704.html)][[Date Next](msg555706.html)][[Thread Prev](msg555698.html)][[Thread Next](msg555709.html)][[Date Index](mail5.html#555705)][[Thread Index](thrd5.html#555705)]

---

* *Subject*: noqueue qdisc and non-virtual interfaces
* *From*: Ignat Korchagin <ignat@xxxxxxxxxxxxxx>
* *Date*: Fri, 1 Mar 2019 12:19:07 +0000
* *Cc*: Daniel Dao <dqminh@xxxxxxxxxxxxxx>, Ivan Babrou <ivan@xxxxxxxxxxxxxx>, Frank Hofmann <fhofmann@xxxxxxxxxxxxxx>, Nicolae Vartolomei <nv@xxxxxxxxxxxxxx>

---

```
Good day,

According to this link:
<http://linux-tc-notes.sourceforge.net/tc/doc/sch_noqueue.txt> it should
not be possible to assign noqueue qdisc to physical devices or
classes. Yet, I can clearly do it even on the latest 5.0-rc series
kernels:

$ sudo tc qdisc add dev eth0 root noqueue
$ sudo tc qdisc show dev eth0
qdisc noqueue 8005: root refcnt 385

If I understand the source correctly, noqueue qdisc was designed only
for network interfaces, which have IFF_NO_QUEUE in priv_flags in
net_device structure. However, I see no checks in the code, which
enforce it when attaching this qdisc to an interface.

I believe, it was not possible before, but commit
d66d6c3152e8d5a6db42a56bf7ae1c6cae87ba48 changed that.

Regardless, if it is intentional or not, the change is incomplete as
it introduces a potential NULL ptr dereference bug, which can be
triggered by doing something like:

dev="eth0"
sudo tc qdisc replace dev $dev root noqueue
sudo tc qdisc delete dev $dev root
sudo tc qdisc replace dev $dev root handle 1: htb default 1
sudo tc class add dev $dev parent 1: classid 1:1 htb rate 1000Gbps
sudo tc qdisc add dev $dev parent 1:1 handle 10: noqueue

I believe it should not be possible to have noqueue qdisc on physical
nics, but, please, let me know if I'm wrong.

Regards,
Ignat

```

---

* Prev by Date:
  **[RE: [PATCH 3/3] dt-bindings: can: rcar\_canfd: Document r8a774a1 support](msg555704.html)**
* Next by Date:
  **[Re: [PATCH net-next 1/6] net: core: dev\_addr\_lists: add VID to device address](msg555706.html)**
* Previous by thread:
  **[Question about setting speed and duplex failed after auto-negotiation disabled on marvell phy](msg555698.html)**
* Next by thread:
  **[[RFC PATCH net-next] selftests: tc-testing: Add pedit tests](msg555709.html)**
* Index(es):
  + [**Date**](mail5.html#555705)
  + [**Thread**](thrd5.html#555705)

[[IndexÂ ofÂ Archives]](/lists/)

[[LinuxÂ KernelÂ Discussion]](/lists/kernel/)

[[TCPÂ Instrumentation]](/lists/tcpinst-wg/)

[[Netfilter]](/lists/netfilter/)

[[BerkeleyÂ PacketÂ Filter]](/lists/bpf/)

[[EthernetÂ Bridging]](/lists/linux-ethernet-bridging/)

[[LinuxÂ WirelessÂ Networking]](/lists/linux-wireless/)

[[Openconnect]](/lists/openconnect/)

[[LinuxÂ WPANÂ Networking]](/lists/linux-wpan/)

[[LinuxÂ HostÂ AP]](/lists/hostap/)

[[LinuxÂ WPANÂ Networking]](/lists/linux-wpan/)

[[LinuxÂ BluetoothÂ Networking]](/lists/linux-bluetooth/)

[[LinuxÂ ATH6KLÂ Networking]](/lists/ath6kl/)

[[LinuxÂ NetworkingÂ Users]](/lists/linux-net/)

[[XDPÂ Newbies]](/lists/xdp-newbies/)

[[LinuxÂ Coverity]](/lists/linux-coverity/)

[[VLAN]](/lists/vlan/)

[[Git]](/lists/git/)

[[IETFÂ Annouce]](/lists/ietf-ann/)

[[LinuxÂ Assembly]](/lists/linux-assembly/)

[[Security]](/lists/security/)

[[Bugtraq]](/lists/bugtraq/)

[[YosemiteÂ Information]](https://yosemitenews.info/)

[[MIPSÂ Linux]](/lists/mips/)

[[ARMÂ LinuxÂ Kernel]](/lists/arm-kernel/)

[[ARMÂ Linux]](/lists/arm/)

[[LinuxÂ Virtualization]](/lists/linux-virtualization/)

[[LinuxÂ IDE]](/lists/linux-ide/)

[[LinuxÂ RAID]](/lists/raid/)

[[LinuxÂ SCSI]](/lists/linux-scsi/)

[[Squid]](/lists/squid/)

---

|  | [Powered by Linux](/lists/) |
| --- | --- |



=== Content from lists.debian.org_2bafc90c_20250114_232302.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3349-1] linux-5.10 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3349-1] linux-5.10 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Thu, 2 Mar 2023 23:05:14 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZAEdmsNQXriVISie%40decadent.org.uk)Â [ZAEdmsNQXriVISie@decadent.org.uk](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3349-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
March 02, 2023                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-5.10
Version        : 5.10.162-1~deb10u1
CVE ID         : CVE-2022-2873 CVE-2022-3545 CVE-2022-3623 CVE-2022-4696
                 CVE-2022-36280 CVE-2022-41218 CVE-2022-45934 CVE-2022-47929
                 CVE-2023-0179 CVE-2023-0240 CVE-2023-0266 CVE-2023-0394
                 CVE-2023-23454  CVE-2023-23455 CVE-2023-23586
Debian Bug     : 825141 1008501 1027430 1027483

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2022-2873

    Zheyu Ma discovered that an out-of-bounds memory access flaw in
    the Intel iSMT SMBus 2.0 host controller driver may result in
    denial of service (system crash).

CVE-2022-3545

    It was discovered that the Netronome Flow Processor (NFP) driver
    contained a use-after-free flaw in area_cache_get(), which may
    result in denial of service or the execution of arbitrary code.

CVE-2022-3623

    A race condition when looking up a CONT-PTE/PMD size hugetlb page
    may result in denial of service or an information leak.

CVE-2022-4696

    A use-after-free vulnerability was discovered in the io_uring
    subsystem.

CVE-2022-36280

    An out-of-bounds memory write vulnerability was discovered in the
    vmwgfx driver, which may allow a local unprivileged user to cause
    a denial of service (system crash).

CVE-2022-41218

    Hyunwoo Kim reported a use-after-free flaw in the Media DVB core
    subsystem caused by refcount races, which may allow a local user
    to cause a denial of service or escalate privileges.

CVE-2022-45934

    An integer overflow in l2cap_config_req() in the Bluetooth
    subsystem was discovered, which may allow a physically proximate
    attacker to cause a denial of service (system crash).

CVE-2022-47929

    Frederick Lawler reported a NULL pointer dereference in the
    traffic control subsystem allowing an unprivileged user to cause a
    denial of service by setting up a specially crafted traffic
    control configuration.

CVE-2023-0179

    Davide Ornaghi discovered incorrect arithmetics when fetching VLAN
    header bits in the netfilter subsystem, allowing a local user to
    leak stack and heap addresses or potentially local privilege
    escalation to root.

CVE-2023-0240

    A flaw was discovered in the io_uring subsystem that could lead
    to a use-after-free.  A local user could exploit this to cause
    a denial of service (crash or memory corruption) or possibly for
    privilege escalation.

CVE-2023-0266

    A use-after-free flaw in the sound subsystem due to missing
    locking may result in denial of service or privilege escalation.

CVE-2023-0394

    Kyle Zeng discovered a NULL pointer dereference flaw in
    rawv6_push_pending_frames() in the network subsystem allowing a
    local user to cause a denial of service (system crash).

CVE-2023-23454

    Kyle Zeng reported that the Class Based Queueing (CBQ) network
    scheduler was prone to denial of service due to interpreting
    classification results before checking the classification return
    code.

CVE-2023-23455

    Kyle Zeng reported that the ATM Virtual Circuits (ATM) network
    scheduler was prone to a denial of service due to interpreting
    classification results before checking the classification return
    code.

CVE-2023-23586

    A flaw was discovered in the io_uring subsystem that could lead to
    an information leak.  A local user could exploit this to obtain
    sensitive information from the kernel or other users.

For Debian 10 buster, these problems have been fixed in version
5.10.162-1~deb10u1.

This update also fixes Debian bugs #825141, #1008501, #1027430, and
#1027483, and includes many more bug fixes from stable updates
5.10.159-5.10.162 inclusive.

We recommend that you upgrade your linux-5.10 packages.

For the detailed security status of linux-5.10 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-5.10>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpaqzwJDO6b5.pgp)**

*Description:* PGP signature

---


