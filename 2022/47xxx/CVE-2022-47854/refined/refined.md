The provided content relates to CVE-2022-47854.

**Root cause of vulnerability:**
The `$_POST['filename']` parameter in `ajaxsupplement.php` is not properly filtered, allowing an attacker to upload files with arbitrary extensions to arbitrary directories by manipulating the `filename` parameter.

**Weaknesses/vulnerabilities present:**
- Unrestricted file upload vulnerability
- Lack of input sanitization/validation for filename parameter.
- Insecure use of `move_uploaded_file` with user-controlled path.

**Impact of exploitation:**
- Arbitrary code execution through uploaded PHP files.
- Full server compromise.

**Attack vectors:**
- Sending a crafted HTTP POST request to `/ajaxsupplement.php`.
- Providing a malicious filename (e.g., `../../z.php`).
- Providing a malicious file with PHP code, disguised as a PDF by prefixing it with `%PDF`.

**Required attacker capabilities/position:**
- Ability to send HTTP requests to the web server.
- Knowledge of the vulnerable endpoint (`/ajaxsupplement.php`) and parameters.