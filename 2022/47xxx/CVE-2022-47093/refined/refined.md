- **Root cause of vulnerability**: A heap-use-after-free vulnerability occurs in the `m2tsdmx_declare_pid` function within `filters/dmx_m2ts.c` at line 470.
- **Weaknesses/vulnerabilities present**: Heap-use-after-free. The code frees a memory region and then attempts to access it later.
- **Impact of exploitation**: The vulnerability can lead to a crash, potentially causing Denial of Service (DoS) and Remote Code Execution (RCE).
- **Attack vectors**: The vulnerability is triggered when processing a crafted MPEG-2 Transport Stream (M2TS) file. The provided Proof of Concept (PoC) file `poc_uaf.avi` when imported via the `MP4Box` tool causes the crash.
- **Required attacker capabilities/position**: The attacker needs to provide a crafted M2TS file to be processed by the vulnerable software. The attacker needs to be able to execute the `MP4Box` tool.