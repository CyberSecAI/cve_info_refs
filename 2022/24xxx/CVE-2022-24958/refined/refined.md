```
{
  "CVE-2022-24958": {
    "description": "A flaw was discovered that the USB gadget subsystem that could lead to a use-after-free. A local user permitted to configure USB gadgets could exploit this to cause a denial of service (crash or memory corruption) or possibly for privilege escalation.",
    "root_cause": "The vulnerability is caused by a use-after-free in the USB gadget subsystem related to the `dev->buf` member.",
    "weaknesses": [
      "Use-after-free"
    ],
    "impact": "Successful exploitation could lead to denial of service (crash or memory corruption) or possibly privilege escalation.",
    "attack_vectors": [
      "Local user permitted to configure USB gadgets can trigger the vulnerability."
    ],
    "required_capabilities": "A local user with the ability to configure USB gadgets.",
    "additional_details": "The vulnerability occurs in `drivers/usb/gadget/legacy/inode.c`, specifically within the `dev_config` function. The issue stems from improper handling of the `dev->buf` member during error conditions. The fix involves clearing the `dev->config`, `dev->hs_config` and `dev->dev` members upon failure and avoiding releasing an existing `dev->buf`"
  }
}
```