The content is related to CVE-2022-24023.

**Root cause of vulnerability:** The `GetValue` function in TCL LinkHub Mesh Wi-Fi devices does not properly validate the size of the destination buffer when copying data from flash configuration. This leads to a buffer overflow.

**Weaknesses/vulnerabilities:**
- **Buffer overflow:** The `GetValue` function copies data into a fixed-size buffer without checking if the data to be copied exceeds the buffer's capacity.
- **Unsafe string copy:** The use of `strcpy` in `confctl_set_app_language` can lead to a buffer overflow if the input string is larger than the destination buffer.
- **Incorrect usage of strncpy:** While `strncpy` is used to copy data into a buffer, the maximum length is not always enforced and the destination buffer size is not taken into account which leads to buffer overflows.

**Impact of exploitation:**
- **Arbitrary code execution:** By overflowing the buffer, an attacker can overwrite the return address on the stack, allowing them to redirect execution flow and execute arbitrary code.
- **Device compromise:** Successful exploitation can lead to complete compromise of the affected device.

**Attack vectors:**
- **Remote exploitation:** The vulnerability can be exploited remotely via protobuf messages, similar to those used by the TCL phone application, that modify the flash configuration values.
- **Local exploitation:** The `cfm` command-line utility can also be used to modify flash configuration values to trigger the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs to be able to send specially crafted protobuf messages to the device or have local access to the device to use the `cfm` command line utility.
- No authentication is required to exploit the vulnerability.