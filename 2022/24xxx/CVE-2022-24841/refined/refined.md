The provided content is related to CVE-2022-24841.

**Root cause of vulnerability:**
The root cause lies in improper authorization and access control within the "teams" feature of Fleet, specifically in how user roles and permissions were enforced. This allowed users with lower privileges to perform actions that should have been restricted to users with higher privileges.

**Weaknesses/vulnerabilities present:**
- **Improper Authorization (CWE-284, CWE-862):** Team admins could elevate their privileges by adding themselves as admins, maintainers, or observers on other teams. Team maintainers could list all users and query packs.
- **Missing Authorization (CWE-285):** Team observers, maintainers, and admins could list all activities and software for the entire instance, whereas these actions should have been restricted to global users or team-specific data.
- **Improper Access Control (CWE-639):** The system failed to properly restrict access to resources based on the user's role and team membership.

**Impact of exploitation:**
- **Privilege Escalation:** Team admins could gain elevated privileges on other teams, allowing them to potentially compromise those teams.
- **Information Disclosure:** Team maintainers could access sensitive information like a list of all users. Team members could list all activities and software instance-wide.

**Attack vectors:**
The attack vector is network-based, requiring a user with valid Fleet credentials to exploit the authorization flaws.

**Required attacker capabilities/position:**
- Valid Fleet credentials for a user with team admin, team maintainer, or team observer role.
- Access to the network where the Fleet instance is running.

**Additional details:**

- The vulnerability affects Fleet Premium versions prior to 4.13 when "teams" are in use.
- The free version of Fleet is not affected because it does not support teams.
- The fix was implemented by restricting access to certain endpoints based on user roles.
- The vulnerability was discovered by Lares during a penetration test.
- The advisory notes that retesting will be conducted and results will be available at the next release.
- The CVSS score is 6.5 (Moderate), with base metrics AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N, indicating a network-based attack with low complexity, requiring low privileges, no user interaction, and resulting in high confidentiality impact but no integrity or availability impact.