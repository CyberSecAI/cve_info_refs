=== Content from github.com_3a4d401d_20250114_182359.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffleetdm%2Ffleet%2Fcommit%2Fda171d3b8d149c30b8307723cbe6b6e8847cb30c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffleetdm%2Ffleet%2Fcommit%2Fda171d3b8d149c30b8307723cbe6b6e8847cb30c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fleetdm%2Ffleet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fleetdm](/fleetdm)
/
**[fleet](/fleetdm/fleet)**
Public

* [Notifications](/login?return_to=%2Ffleetdm%2Ffleet) You must be signed in to change notification settings
* [Fork
  450](/login?return_to=%2Ffleetdm%2Ffleet)
* [Star
   3.3k](/login?return_to=%2Ffleetdm%2Ffleet)

* [Code](/fleetdm/fleet)
* [Issues
  2k](/fleetdm/fleet/issues)
* [Pull requests
  58](/fleetdm/fleet/pulls)
* [Actions](/fleetdm/fleet/actions)
* [Security](/fleetdm/fleet/security)
* [Insights](/fleetdm/fleet/pulse)

Additional navigation options

* [Code](/fleetdm/fleet)
* [Issues](/fleetdm/fleet/issues)
* [Pull requests](/fleetdm/fleet/pulls)
* [Actions](/fleetdm/fleet/actions)
* [Security](/fleetdm/fleet/security)
* [Insights](/fleetdm/fleet/pulse)

## Commit

[Permalink](/fleetdm/fleet/commit/da171d3b8d149c30b8307723cbe6b6e8847cb30c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-pr2g-j78h-84cr](https://github.com/fleetdm/fleet/security/advisories/GHSA-pr2g-j78h-84cr "GHSA-pr2g-j78h-84cr")

[Browse files](/fleetdm/fleet/tree/da171d3b8d149c30b8307723cbe6b6e8847cb30c)
Browse the repository at this point in the history

```
* Fix access control issues with users

* Fix access control issues with packs

* Fix access control issues with software

* Changes suggested by Martin

* All users can access the global schedule

* Restrict access to activities

* Add explicit test for team admin escalation vuln

* All global users should be able to read all software

* Handbook editor pass - Security - GitHub Security ([#5108](https://github.com/fleetdm/fleet/pull/5108))

* Update security.md

All edits are recorded by line:

395 replaced “open-source” with “open source”
411 replaced “open-source” with “open source”
439 added “the” before “comment”; replaced “repositories,” with “repositories”
445 deleted “being” before “located”
458 added “and” after “PR”
489 replaced “on” with “in”
493 replaced “open-source” with “open source”; Replaced “privileges,” with “privileges”

* Update security.md

line 479

* Update security.md

added (static analysis tools used to identify problems in code) to line 479

* Fix UI

* Fix UI

* revert api v1 to latest in documentation ([#5149](https://github.com/fleetdm/fleet/pull/5149))

* revert api v1 to latest in documentation

* Update fleetctl doc page

Co-authored-by: Noah Talerman <noahtal@umich.edu>

* Add team admin team policy automation; fix e2e

* Update to company page of the handbook ([#5164](https://github.com/fleetdm/fleet/pull/5164))

Updated "Why do we use a wireframe-first approach?" section of company.md

* removed extra data on smaller screens ([#5154](https://github.com/fleetdm/fleet/pull/5154))

* Update for team automations; e2e

* Jira Integration: Cypress e2e tests only ([#5055](https://github.com/fleetdm/fleet/pull/5055))

* Update company.md ([#5170](https://github.com/fleetdm/fleet/pull/5170))

This is to update the formatting under "empathy" and to fix the spelling of "help text."
This was done as per [@mikermcneil](https://github.com/mikermcneil) .
This is related to #[#4941](https://github.com/fleetdm/fleet/pull/4941) and [#4902](https://github.com/fleetdm/fleet/issues/4902)

* fix update updated_at for aggregated_stats ([#5112](https://github.com/fleetdm/fleet/pull/5112))

Update the updated_at column when using ON DUPLICATE UPDATE so that
the counts_updated_at is up to date

* basic sql formatting in code ie whitespace around operators

* Fix e2e test

* Fix tests in server/authz

Co-authored-by: gillespi314 <73313222+gillespi314@users.noreply.github.com>
Co-authored-by: Desmi-Dizney <99777687+Desmi-Dizney@users.noreply.github.com>
Co-authored-by: Michal Nicpon <39177923+michalnicp@users.noreply.github.com>
Co-authored-by: Noah Talerman <noahtal@umich.edu>
Co-authored-by: Mike Thomas <78363703+mike-j-thomas@users.noreply.github.com>
Co-authored-by: Martavis Parker <47053705+martavis@users.noreply.github.com>
Co-authored-by: RachelElysia <71795832+RachelElysia@users.noreply.github.com>
```

* Loading branch information

[![@lucasmrod](https://avatars.githubusercontent.com/u/2073526?s=40&v=4)](/lucasmrod) [![@gillespi314](https://avatars.githubusercontent.com/u/73313222?s=40&v=4)](/gillespi314)
[![@Desmi-Dizney](https://avatars.githubusercontent.com/u/99777687?s=40&v=4)](/Desmi-Dizney) [![@michalnicp](https://avatars.githubusercontent.com/u/39177923?s=40&v=4)](/michalnicp) [![@noahtalerman](https://avatars.githubusercontent.com/u/47070608?s=40&v=4)](/noahtalerman) [![@mike-j-thomas](https://avatars.githubusercontent.com/u/78363703?s=40&v=4)](/mike-j-thomas) [![@martavis](https://avatars.githubusercontent.com/u/47053705?s=40&v=4)](/martavis) [![@RachelElysia](https://avatars.githubusercontent.com/u/71795832?s=40&v=4)](/RachelElysia)

8 people

authored
Apr 18, 2022

1 parent
[2ee4a52](/fleetdm/fleet/commit/2ee4a52e7c876181d19ba96a8e6d8ef998d1a4a5)

commit da171d3

 Show file tree

 Hide file tree

Showing
**31 changed files**
with
**1,339 additions**
and
**352 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changes

  + changes/activities-rbac
    [activities-rbac](#diff-b35e1e4055eb553a95cf081aa141deef71fbd3569bb2da1e539521116a0c84a6)
  + changes/issue-GHSA-pr2g-j78h-84cr
    [issue-GHSA-pr2g-j78h-84cr](#diff-80d3b3d78ff45d9c208893cc6f33ccc346a07850650187885bc088fc06ce4bb2)
* cypress/integration

  + free

    - cypress/integration/free/maintainer.spec.ts
      [maintainer.spec.ts](#diff-2db8cb84bb4199e65237661d21ceac1be1cd6986492d4696db23b108b8451258)
    - cypress/integration/free/observer.spec.ts
      [observer.spec.ts](#diff-26c94818fba6c669f943aa3d936df6d26dc7312e1be0b3451abf47c20e37ba84)
  + premium

    - cypress/integration/premium/admin.spec.ts
      [admin.spec.ts](#diff-8e1baf8b92f1433315544ef9f38ca15b78b2dbe90bd5eb7182c5b0a1083d315f)
    - cypress/integration/premium/maintainer.spec.ts
      [maintainer.spec.ts](#diff-bc40180e41af02fe3f6c706d5b970245b817385ee8bfba312bd5744b0df332a4)
    - cypress/integration/premium/team\_admin.spec.ts
      [team\_admin.spec.ts](#diff-e6aa16514f100426966e2b79f0c7b37611fa72fe270f110c216103c68d558e9b)
    - cypress/integration/premium/team\_maintainer\_observer.spec.ts
      [team\_maintainer\_observer.spec.ts](#diff-17ba9a9f3015311a08b49289bd74533e3999279de2f65b0e310a9fde2f5ae02f)
* frontend/pages

  + Homepage/cards/Software

    - frontend/pages/Homepage/cards/Software/Software.tsx
      [Software.tsx](#diff-99631f5bf45cb021ee9b7b84fc1908e220f2057095499075f2b9799413f923ad)
  + admin

    - TeamManagementPage/TeamDetailsWrapper/MembersPage

      * frontend/pages/admin/TeamManagementPage/TeamDetailsWrapper/MembersPage/MembersPage.tsx
        [MembersPage.tsx](#diff-3e60bb4410bf981774619792805b41728f8e96b7531d28390faf002b73619eda)
    - UserManagementPage/components/UserForm

      * frontend/pages/admin/UserManagementPage/components/UserForm/UserForm.tsx
        [UserForm.tsx](#diff-3947d6fd8c8b72bc9841b0193326a0a4449ddeccd7baf575aa39cf379f9b0a06)
  + policies/ManagePoliciesPage

    - frontend/pages/policies/ManagePoliciesPage/ManagePoliciesPage.tsx
      [ManagePoliciesPage.tsx](#diff-26bb41183dde00948e910199094c5796925e3219348dd9a9d6a7c8042e87d55b)
  + software/ManageSoftwarePage

    - frontend/pages/software/ManageSoftwarePage/ManageSoftwarePage.tsx
      [ManageSoftwarePage.tsx](#diff-07eab546bbae9eba04bffcc9f0fe04bb40734ae0e1e6ebf47ac90420f4786e46)
* server

  + authz

    - server/authz/authz.go
      [authz.go](#diff-67febf6ef34621ecdf0eed563fd882f3de656530845a969cf0929ced11b8ad9e)
    - server/authz/policy.rego
      [policy.rego](#diff-7e443009502560081e03869cb637d2184919b0770e485bbc34bccca08ea2253d)
    - server/authz/policy\_test.go
      [policy\_test.go](#diff-7565cffb47e565efcb8933e0ab6872851f6b092126b643961ebb896594be3511)
  + fleet

    - server/fleet/authz.go
      [authz.go](#diff-02e3c7d1d9e8d94636c7081f8c515cb5b7f1fa6f3868e783ac426a96b4a95ad5)
    - server/fleet/packs.go
      [packs.go](#diff-aef7628be65f6973d0e0cb58bf8537eae3f8a93bafdd48611a44d84ceff025db)
    - server/fleet/software.go
      [software.go](#diff-b0b26f1f341f0bf629b2761dfcc467a8afedd5859c95017ee43f927fb7ad9ca2)
  + service

    - server/service/activities\_test.go
      [activities\_test.go](#diff-6ecc3846109629370a233edab7eae3c344720c6ab8e9457b5b52aa1b49dfa404)
    - server/service/endpoint\_utils\_test.go
      [endpoint\_utils\_test.go](#diff-4732653f2f2bf96a5cc4ba9894a9809fb20ddadaa5044cf6a5c67221b971f475)
    - server/service/global\_schedule.go
      [global\_schedule.go](#diff-fe74db95143f74f3c853b47f643b19e6dea09b32d4dbfc1861f3441772d18fca)
    - server/service/global\_schedule\_test.go
      [global\_schedule\_test.go](#diff-ffecfa4357b4fec6f8418cc261f6448792c81ce942ce2fa0f213b4d35d4ab5d3)
    - server/service/hosts.go
      [hosts.go](#diff-8103c94796fb91784bbc8c75c1fd026e47eee9db34bd5daf30b0aefcae460558)
    - server/service/scheduled\_queries\_test.go
      [scheduled\_queries\_test.go](#diff-17cd12d0692b2a52580f90639bd3c7b42d702dacec8d5713ecbe2bf1070e8492)
    - server/service/software.go
      [software.go](#diff-4d2a6ec765480e809813c12f5ede33f9b20c4845d27988017f81ef15161a39ff)
    - server/service/software\_test.go
      [software\_test.go](#diff-e36e5f9b598dbd75cf52271d01409b1741e16d685e77e967da3537f5bed4a4e5)
    - server/service/team\_schedule.go
      [team\_schedule.go](#diff-1c5fbd79e1e7dd78a7cd6d85467431135f8d5c05a7435e166f1c20301f46b67d)
    - server/service/team\_schedule\_test.go
      [team\_schedule\_test.go](#diff-d3fcad1e7e7c948953f411722f6ae0d5506d8c92390389eb7eafc172e9d5eca1)
    - server/service/users.go
      [users.go](#diff-37fce36e6657f8a71994f835cd578ca4a59f1e2fb82cc3156bcadbc3c579c482)
    - server/service/users\_test.go
      [users\_test.go](#diff-88820858b3636cbfe59375ec481968ff3f72219d0b86ffa94f25be17ece21c92)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[changes/activities-rbac](#diff-b35e1e4055eb553a95cf081aa141deef71fbd3569bb2da1e539521116a0c84a6 "changes/activities-rbac")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/changes/activities-rbac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1 @@ |
|  |  | \* Restrict non-global user from access to activities |

3 changes: 3 additions & 0 deletions

3
[changes/issue-GHSA-pr2g-j78h-84cr](#diff-80d3b3d78ff45d9c208893cc6f33ccc346a07850650187885bc088fc06ce4bb2 "changes/issue-GHSA-pr2g-j78h-84cr")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/changes/issue-GHSA-pr2g-j78h-84cr)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,3 @@ |
|  |  | \* Fix access control issues with "user" endpoints. |
|  |  | \* Fix access control issues with "pack" endpoints. |
|  |  | \* Fix access control issues with "software" endpoints. |

36 changes: 8 additions & 28 deletions

36
[cypress/integration/free/maintainer.spec.ts](#diff-2db8cb84bb4199e65237661d21ceac1be1cd6986492d4696db23b108b8451258 "cypress/integration/free/maintainer.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/free/maintainer.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -189,31 +189,7 @@ describe( |
|  |  | describe("Manage software page", () => { |
|  |  | beforeEach(() => cy.visit("/software/manage")); |
|  |  | it("should restrict global maintainer from 'Manage automations' button", () => { |
|  |  | it("hides manages software automations when all teams selected", () => { |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.getAttached(".Select").within(() => { |
|  |  | cy.findByText(/all teams/i).should("exist"); |
|  |  | }); |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.findByRole("button", { |
|  |  | name: /manage automations/i, |
|  |  | }).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | }); |
|  |  | it("hides manage automations button when all teams not selected", () => { |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.getAttached(".Select").within(() => { |
|  |  | cy.getAttached(".Select-control").click(); |
|  |  | cy.getAttached(".Select-menu-outer").within(() => { |
|  |  | cy.findByText(/apples/i).should("exist"); |
|  |  | }); |
|  |  | cy.findByRole("button", { |
|  |  | name: /manage automations/i, |
|  |  | }).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | }); |
|  |  | cy.findByText(/manage automations/).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | describe("Query pages", () => { |
| Expand Down  Expand Up | | @@ -274,9 +250,13 @@ describe( |
|  |  | cy.loginWithCySession("mary@organization.com", "user123#"); |
|  |  | cy.visit("/policies/manage"); |
|  |  | }); |
|  |  | it("allows maintainer to manage automations", () => { |
|  |  | cy.findByRole("button", { name: /manage automations/i }).click(); |
|  |  | cy.findByRole("button", { name: /cancel/i }).click(); |
|  |  | it("hides manage automations from maintainer", () => { |
|  |  | cy.getAttached(".button-wrap").within(() => { |
|  |  | cy.findByRole("button", { name: /add a policy/i }).should("exist"); |
|  |  | cy.findByRole("button", { name: /manage automations/i }).should( |
|  |  | "not.exist" |
|  |  | ); |
|  |  | }); |
|  |  | }); |
|  |  | it("allows maintainer to add a policy", () => { |
|  |  | cy.findByRole("button", { name: /add a policy/i }).click(); |
| Expand Down | |  |

6 changes: 2 additions & 4 deletions

6
[cypress/integration/free/observer.spec.ts](#diff-26c94818fba6c669f943aa3d936df6d26dc7312e1be0b3451abf47c20e37ba84 "cypress/integration/free/observer.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/free/observer.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -209,12 +209,10 @@ describe("Free tier - Observer user", () => { |
|  |  | cy.visit("/policies/manage"); |
|  |  | }); |
|  |  | it("hides manage automations button", () => { |
|  |  | cy.findByRole("button", { name: /manage automations/i }).should( |
|  |  | "not.exist" |
|  |  | ); |
|  |  | cy.findByText(/manage automations/i).should("not.exist"); |
|  |  | }); |
|  |  | it("hides add a policy button", () => { |
|  |  | cy.findByRole("button", { name: /add a policy/i }).should("not.exist"); |
|  |  | cy.findByText(/add a policy/).should("not.exist"); |
|  |  | }); |
|  |  | it("hides run, edit, or delete a policy", () => { |
|  |  | cy.getAttached("tbody").within(() => { |
| Expand Down | |  |

21 changes: 21 additions & 0 deletions

21
[cypress/integration/premium/admin.spec.ts](#diff-8e1baf8b92f1433315544ef9f38ca15b78b2dbe90bd5eb7182c5b0a1083d315f "cypress/integration/premium/admin.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/premium/admin.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -564,6 +564,27 @@ describe("Premium tier - Global Admin user", () => { |
|  |  | }); |
|  |  | cy.findByText(/successfully updated policy automations/i).should("exist"); |
|  |  | }); |
|  |  | it("allows global admin to automate a team policy", () => { |
|  |  | cy.visit("/policies/manage"); |
|  |  | cy.getAttached(".Select-control").within(() => { |
|  |  | cy.findByText(/all teams/i).click(); |
|  |  | }); |
|  |  | cy.getAttached(".Select-menu") |
|  |  | .contains(/apples/i) |
|  |  | .click(); |
|  |  | cy.getAttached(".button-wrap") |
|  |  | .findByRole("button", { name: /manage automations/i }) |
|  |  | .click(); |
|  |  | cy.getAttached(".manage-automations-modal").within(() => { |
|  |  | cy.getAttached(".fleet-slider").click(); |
|  |  | cy.getAttached(".fleet-checkbox\_\_input").check({ force: true }); |
|  |  | cy.getAttached("#webhook-url") |
|  |  | .clear() |
|  |  | .type("https://example.com/global\_admin"); |
|  |  | cy.findByText(/save/i).click(); |
|  |  | }); |
|  |  | cy.findByText(/successfully updated policy automations/i).should("exist"); |
|  |  | }); |
|  |  | it("allows global admin to delete a team policy", () => { |
|  |  | cy.visit("/policies/manage"); |
|  |  | cy.getAttached(".Select-control").within(() => { |
| Expand Down | |  |

35 changes: 4 additions & 31 deletions

35
[cypress/integration/premium/maintainer.spec.ts](#diff-bc40180e41af02fe3f6c706d5b970245b817385ee8bfba312bd5744b0df332a4 "cypress/integration/premium/maintainer.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/premium/maintainer.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -201,32 +201,8 @@ describe("Premium tier - Maintainer user", () => { |
|  |  | }); |
|  |  | describe("Manage software page", () => { |
|  |  | beforeEach(() => cy.visit("/software/manage")); |
|  |  | it("should restrict global maintainer from 'Manage automations' button", () => { |
|  |  | it("hides manages software automations when all teams selected", () => { |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.getAttached(".Select").within(() => { |
|  |  | cy.findByText(/all teams/i).should("exist"); |
|  |  | }); |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.findByRole("button", { |
|  |  | name: /manage automations/i, |
|  |  | }).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | }); |
|  |  | it("hides manage automations button when all teams not selected", () => { |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.getAttached(".Select").within(() => { |
|  |  | cy.getAttached(".Select-control").click(); |
|  |  | cy.getAttached(".Select-menu-outer").within(() => { |
|  |  | cy.findByText(/apples/i).should("exist"); |
|  |  | }); |
|  |  | cy.findByRole("button", { |
|  |  | name: /manage automations/i, |
|  |  | }).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | }); |
|  |  | it("hides 'Manage automations' button from global maintainer", () => { |
|  |  | cy.findByText(/manage automations/i).should("not.exist"); |
|  |  | }); |
|  |  | }); |
|  |  | describe("Query pages", () => { |
| Expand All | | @@ -250,11 +226,8 @@ describe("Premium tier - Maintainer user", () => { |
|  |  | }); |
|  |  | describe("Manage policies page", () => { |
|  |  | beforeEach(() => cy.visit("/policies/manage")); |
|  |  | it("allows global maintainer to click 'Manage automations' button", () => { |
|  |  | cy.getAttached(".button-wrap") |
|  |  | .findByRole("button", { name: /manage automations/i }) |
|  |  | .click(); |
|  |  | cy.findByRole("button", { name: /cancel/i }).click(); |
|  |  | it("hides manage automations button", () => { |
|  |  | cy.findByText(/manage hosts/i).should("not.exist"); |
|  |  | }); |
|  |  | it("allows global maintainer to add a new policy", () => { |
|  |  | cy.getAttached(".button-wrap") |
| Expand Down | |  |

13 changes: 2 additions & 11 deletions

13
[cypress/integration/premium/team\_admin.spec.ts](#diff-e6aa16514f100426966e2b79f0c7b37611fa72fe270f110c216103c68d558e9b "cypress/integration/premium/team_admin.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/premium/team_admin.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -192,10 +192,7 @@ describe("Premium tier - Team Admin user", () => { |
|  |  | }); |
|  |  | describe("Manage software page", () => { |
|  |  | beforeEach(() => cy.visit("/software/manage")); |
|  |  | it("hides manage automations button since all teams not selected", () => { |
|  |  | cy.getAttached(".manage-software-page\_\_header-wrap").within(() => { |
|  |  | cy.findByText(/apples/i).should("exist"); |
|  |  | }); |
|  |  | it("hides manage automations button", () => { |
|  |  | cy.findByText(/manage automations/i).should("not.exist"); |
|  |  | }); |
|  |  | }); |
| Expand Down  Expand Up | | @@ -283,12 +280,6 @@ describe("Premium tier - Team Admin user", () => { |
|  |  | }); |
|  |  | describe("Manage policies page", () => { |
|  |  | beforeEach(() => cy.visit("/policies/manage")); |
|  |  | it("hides manage automations button when all teams not selected", () => { |
|  |  | cy.getAttached(".manage-policies-page\_\_header-wrap").within(() => { |
|  |  | cy.findByText(/apples/i).should("exist"); |
|  |  | }); |
|  |  | cy.findByText(/manage automations/i).should("not.exist"); |
|  |  | }); |
|  |  | it("allows team admin to add a new policy", () => { |
|  |  | cy.getAttached(".button-wrap") |
|  |  | .findByRole("button", { name: /add a policy/i }) |
| Expand Down  Expand Up | | @@ -358,7 +349,7 @@ describe("Premium tier - Team Admin user", () => { |
|  |  | cy.findByText(/apples/i).should("exist"); |
|  |  | }); |
|  |  | it("displays the team admin controls", () => { |
|  |  | cy.findByRole("button", { name: /add member/i }).click(); |
|  |  | cy.findByRole("button", { name: /create user/i }).click(); |
|  |  | cy.findByRole("button", { name: /cancel/i }).click(); |
|  |  | cy.findByRole("button", { name: /add hosts/i }).click(); |
|  |  | cy.findByRole("button", { name: /done/i }).click(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[cypress/integration/premium/team\_maintainer\_observer.spec.ts](#diff-17ba9a9f3015311a08b49289bd74533e3999279de2f65b0e310a9fde2f5ae02f "cypress/integration/premium/team_maintainer_observer.spec.ts")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/cypress/integration/premium/team_maintainer_observer.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -276,8 +276,8 @@ describe("Premium tier - Team observer/maintainer user", () => { |
|  |  | cy.findByText(/apples/i).click(); |
|  |  | cy.findByText(/oranges/i).click(); |
|  |  |  |
|  |  | // On maintaining team, should see the "Manage automations" button |
|  |  | cy.findByText(/manage automations/i).should("exist"); |
|  |  | // On maintaining team, should not see the "Manage automations" button |
|  |  | cy.findByText(/manage automations/i).should("not.exist"); |
|  |  | // On maintaining team, should see "add a policy" and "save" a policy |
|  |  | cy.findByText(/add a policy/i).click(); |
|  |  |  |
| Expand Down | |  |

12 changes: 10 additions & 2 deletions

12
[frontend/pages/Homepage/cards/Software/Software.tsx](#diff-99631f5bf45cb021ee9b7b84fc1908e220f2057095499075f2b9799413f923ad "frontend/pages/Homepage/cards/Software/Software.tsx")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/frontend/pages/Homepage/cards/Software/Software.tsx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,8 @@ |
|  |  | import React, { useState } from "react"; |
|  |  | import React, { useContext, useState } from "react"; |
|  |  | import { useQuery } from "react-query"; |
|  |  | import { Tab, Tabs, TabList, TabPanel } from "react-tabs"; |
|  |  |  |
|  |  | import { AppContext } from "context/app"; |
|  |  | import paths from "router/paths"; |
|  |  | import configAPI from "services/entities/config"; |
|  |  | import softwareAPI, { ISoftwareResponse } from "services/entities/software"; |
| Expand Down  Expand Up | | @@ -39,6 +40,10 @@ const Software = ({ |
|  |  | const [pageIndex, setPageIndex] = useState<number>(0); |
|  |  | const [isSoftwareEnabled, setIsSoftwareEnabled] = useState<boolean>(); |
|  |  |  |
|  |  | const { availableTeams, currentTeam, isOnGlobalTeam } = useContext( |
|  |  | AppContext |
|  |  | ); |
|  |  |  |
|  |  | const { data: config } = useQuery(["config"], configAPI.loadAll, { |
|  |  | onSuccess: (data) => { |
|  |  | setIsSoftwareEnabled(data?.host\_settings?.enable\_software\_inventory); |
| Expand Down  Expand Up | | @@ -71,8 +76,11 @@ const Software = ({ |
|  |  | teamId: currentTeamId, |
|  |  | }), |
|  |  | { |
|  |  | enabled: |
|  |  | isOnGlobalTeam || |
|  |  | !!availableTeams?.find((t) => t.id === currentTeam?.id), |
|  |  | keepPreviousData: true, |
|  |  | staleTime: 30000, // TODO: Discuss a reasonable staleTime given that counts are only updated infrequently? |
|  |  | staleTime: 30000, // stale time can be adjusted if fresher data is desired based on software inventory interval |
|  |  | onSuccess: (data) => { |
|  |  | setShowSoftwareUI(true); |
|  |  | if (isSoftwareEnabled && data.software?.length !== 0) { |
| Expand Down | |  |

75 changes: 47 additions & 28 deletions

75
[frontend/pages/admin/TeamManagementPage/TeamDetailsWrapper/MembersPage/MembersPage.tsx](#diff-3e60bb4410bf981774619792805b41728f8e96b7531d28390faf002b73619eda "frontend/pages/admin/TeamManagementPage/TeamDetailsWrapper/MembersPage/MembersPage.tsx")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/frontend/pages/admin/TeamManagementPage/TeamDetailsWrapper/MembersPage/MembersPage.tsx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,9 +51,13 @@ const MembersPage = ({ |
|  |  | const teamId = parseInt(team\_id, 10); |
|  |  |  |
|  |  | const { renderFlash } = useContext(NotificationContext); |
|  |  | const { config, isGlobalAdmin, currentUser, isPremiumTier } = useContext( |
|  |  | AppContext |
|  |  | ); |
|  |  | const { |
|  |  | config, |
|  |  | currentUser, |
|  |  | isGlobalAdmin, |
|  |  | isPremiumTier, |
|  |  | isTeamAdmin, |
|  |  | } = useContext(AppContext); |
|  |  |  |
|  |  | const smtpConfigured = config?.smtp\_settings.configured || false; |
|  |  | const canUseSso = config?.sso\_settings.enable\_sso || false; |
| Expand Down  Expand Up | | @@ -137,14 +141,7 @@ const MembersPage = ({ |
|  |  | const toggleCreateMemberModal = useCallback(() => { |
|  |  | setShowCreateUserModal(!showCreateUserModal); |
|  |  | setShowAddMemberModal(false); |
|  |  | currentUser ? setUserEditing(currentUser) : setUserEditing(undefined); |
|  |  | }, [ |
|  |  | showCreateUserModal, |
|  |  | currentUser, |
|  |  | setShowCreateUserModal, |
|  |  | setUserEditing, |
|  |  | setShowAddMemberModal, |
|  |  | ]); |
|  |  | }, [showCreateUserModal, setShowCreateUserModal, setShowAddMemberModal]); |
|  |  |  |
|  |  | // FUNCTIONS |
|  |  |  |
| Expand All | | @@ -153,7 +150,10 @@ const MembersPage = ({ |
|  |  | teamsAPI |
|  |  | .removeMembers(teamId, removedUsers) |
|  |  | .then(() => { |
|  |  | renderFlash("success", `Successfully removed ${userEditing?.name}`); |
|  |  | renderFlash( |
|  |  | "success", |
|  |  | `Successfully removed ${userEditing?.name || "member"}` |
|  |  | ); |
|  |  | // If user removes self from team, redirect to home |
|  |  | if (currentUser && currentUser.id === removedUsers.users[0].id) { |
|  |  | window.location.href = "/"; |
| Expand All | | @@ -178,12 +178,15 @@ const MembersPage = ({ |
|  |  | (newMembers: INewMembersBody) => { |
|  |  | teamsAPI |
|  |  | .addMembers(teamId, newMembers) |
|  |  | .then(() => |
|  |  | .then(() => { |
|  |  | const count = newMembers.users.length; |
|  |  | renderFlash( |
|  |  | "success", |
|  |  | `${newMembers.users.length} members successfully added to ${currentTeam?.name}.` |
|  |  | ) |
|  |  | ) |
|  |  | `${count} ${ |
|  |  | count === 1 ? "member" : "members" |
|  |  | } successfully added to ${currentTeam?.name}.` |
|  |  | ); |
|  |  | }) |
|  |  | .catch(() => |
|  |  | renderFlash("error", "Could not add members. Please try again.") |
|  |  | ) |
| Expand Down  Expand Up | | @@ -288,7 +291,10 @@ const MembersPage = ({ |
|  |  | usersAPI |
|  |  | .update(userEditing.id, updatedAttrs) |
|  |  | .then(() => { |
|  |  | renderFlash("success", `Successfully edited ${userName}.`); |
|  |  | renderFlash( |
|  |  | "success", |
|  |  | `Successfully edited ${userName || "member"}.` |
|  |  | ); |
|  |  |  |
|  |  | if ( |
|  |  | currentUser && |
| Expand Down  Expand Up | | @@ -317,7 +323,7 @@ const MembersPage = ({ |
|  |  | } else { |
|  |  | renderFlash( |
|  |  | "error", |
|  |  | `Could not edit ${userName}. Please try again.` |
|  |  | `Could not edit ${userName || "member"}. Please try again.` |
|  |  | ); |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -349,13 +355,24 @@ const MembersPage = ({ |
|  |  | Expecting to see new team members listed here? Try again in a |
|  |  | few seconds as the system catches up. |
|  |  | </p> |
|  |  | <Button |
|  |  | variant="brand" |
|  |  | className={`${noMembersClass}\_\_create-button`} |
|  |  | onClick={toggleAddUserModal} |
|  |  | > |
|  |  | Add member |
|  |  | </Button> |
|  |  | {isGlobalAdmin && ( |
|  |  | <Button |
|  |  | variant="brand" |
|  |  | className={`${noMembersClass}\_\_create-button`} |
|  |  | onClick={toggleAddUserModal} |
|  |  | > |
|  |  | Add member |
|  |  | </Button> |
|  |  | )} |
|  |  | {isTeamAdmin && ( |
|  |  | <Button |
|  |  | variant="brand" |
|  |  | className={`${noMembersClass}\_\_create-button`} |
|  |  | onClick={toggleCreateMemberModal} |
|  |  | > |
|  |  | Create user |
|  |  | </Button> |
|  |  | )} |
|  |  | </> |
|  |  | ) : ( |
|  |  | <> |
| Expand Down  Expand Up | | @@ -396,8 +413,10 @@ const MembersPage = ({ |
|  |  | isLoading={isLoadingMembers} |
|  |  | defaultSortHeader={"name"} |
|  |  | defaultSortDirection={"asc"} |
|  |  | onActionButtonClick={toggleAddUserModal} |
|  |  | actionButtonText={"Add member"} |
|  |  | onActionButtonClick={ |
|  |  | isGlobalAdmin ? toggleAddUserModal : toggleCreateMemberModal |
|  |  | } |
|  |  | actionButtonText={isGlobalAdmin ? "Add member" : "Create user"} |
|  |  | actionButtonVariant={"brand"} |
|  |  | hideActionButton={memberIds.length === 0 && searchString === ""} |
|  |  | onQueryChange={({ searchQuery }) => setSearchString(searchQuery)} |
| Expand All | | @@ -424,7 +443,7 @@ const MembersPage = ({ |
|  |  | onSubmit={onEditMemberSubmit} |
|  |  | defaultName={userEditing?.name} |
|  |  | defaultEmail={userEditing?.email} |
|  |  | defaultGlobalRole={userEditing?.global\_role} |
|  |  | defaultGlobalRole={userEditing?.global\_role || null} |
|  |  | defaultTeamRole={userEditing?.role} |
|  |  | defaultTeams={userEditing?.teams} |
|  |  | availableTeams={teams || []} |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[frontend/pages/admin/UserManagementPage/components/UserForm/UserForm.tsx](#diff-3947d6fd8c8b72bc9841b0193326a0a4449ddeccd7baf575aa39cf379f9b0a06 "frontend/pages/admin/UserManagementPage/components/UserForm/UserForm.tsx")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/frontend/pages/admin/UserManagementPage/components/UserForm/UserForm.tsx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -121,7 +121,7 @@ const UserForm = ({ |
|  |  | }); |
|  |  |  |
|  |  | const [isGlobalUser, setIsGlobalUser] = useState<boolean>( |
|  |  | defaultGlobalRole !== null |
|  |  | !!defaultGlobalRole |
|  |  | ); |
|  |  |  |
|  |  | useEffect(() => { |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[frontend/pages/policies/ManagePoliciesPage/ManagePoliciesPage.tsx](#diff-26bb41183dde00948e910199094c5796925e3219348dd9a9d6a7c8042e87d55b "frontend/pages/policies/ManagePoliciesPage/ManagePoliciesPage.tsx")

Show comments

[View file](/fleetdm/fleet/blob/da171d3b8d149c30b8307723cbe6b6e8847cb30c/frontend/pages/policies/ManagePoliciesPage/ManagePoliciesPage.tsx)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -138,6 +138,7 @@ const ManagePolicyPage = ({ |
|  |  |  |
|  |  | const canAddOrRemovePolicy = |
|  |  | isGlobalAdmin || isGlobalMaintainer || isTeamMaintainer || isTeamAdmin; |
|  |  | const canManageAutomations = isGlobalAdmin || isTeamAdmin; |
|  |  |  |
|  |  | const { isLoading: isLoadingWebhooks, refetch: refetchWebhooks } = useQuery< |
|  |  | IConfig | ILoadTeamResponse, |
| Expand Down  Expand Up | | @@ -364,7 +365,7 @@ const ManagePolicyPage = ({ |
|  |  | </div> |
|  |  | </div> |
|  |  | <div className={`${baseClass} button-wrap`}> |
|  |  | {canAddOrRemovePolicy && |
|  |  | {canManageAutomations && |
|  |  | !isLoadingWebhooks && |
|  |  | !isLoadingGlobalPolicies && ( |
|  |  | <Button |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `da171d3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffleetdm%2Ffleet%2Fcommit%2Fda171d3b8d149c30b8307723cbe6b6e8847cb30c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ebf0c322_20250114_182400.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffleetdm%2Ffleet%2Fsecurity%2Fadvisories%2FGHSA-pr2g-j78h-84cr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffleetdm%2Ffleet%2Fsecurity%2Fadvisories%2FGHSA-pr2g-j78h-84cr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=fleetdm%2Ffleet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fleetdm](/fleetdm)
/
**[fleet](/fleetdm/fleet)**
Public

* [Notifications](/login?return_to=%2Ffleetdm%2Ffleet) You must be signed in to change notification settings
* [Fork
  450](/login?return_to=%2Ffleetdm%2Ffleet)
* [Star
   3.3k](/login?return_to=%2Ffleetdm%2Ffleet)

* [Code](/fleetdm/fleet)
* [Issues
  2k](/fleetdm/fleet/issues)
* [Pull requests
  58](/fleetdm/fleet/pulls)
* [Actions](/fleetdm/fleet/actions)
* [Security](/fleetdm/fleet/security)
* [Insights](/fleetdm/fleet/pulse)

Additional navigation options

* [Code](/fleetdm/fleet)
* [Issues](/fleetdm/fleet/issues)
* [Pull requests](/fleetdm/fleet/pulls)
* [Actions](/fleetdm/fleet/actions)
* [Security](/fleetdm/fleet/security)
* [Insights](/fleetdm/fleet/pulse)

# Improper Authorization and Missing Authorization and Improper Access Control in github.com/fleetdm/fleet

Moderate

[zwass](/zwass)
published
GHSA-pr2g-j78h-84cr
Apr 18, 2022

## Package

gomod

github.com/fleetdm/fleet
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<4.13

## Patched versions

4.13

## Description

[Lares](https://www.lares.com/) identified post-authentication authorization issues on Fleet 4.12.1 during a penetration testing engagement.

We will post the full report as soon as we have addressed the remaining, less impactful issues.

This advisory covers the most impactful issues discovered through this test, all related to authorization in the [teams](https://fleetdm.com/docs/using-fleet/teams) feature of Fleet. Exploiting these issues requires valid Fleet credentials.

With the full report, we will disclose our plans for additional automated and manual testing to prevent these issues from occurring again.

We will also update the product documentation with more granular role and permission information so the expected behavior for all these cases is explicit.

### Affects

Fleet Premium 4.12.1 and older **if teams users are in use.** The free version of Fleet does not support teams and is unaffected.

| Version | Configuration | Impacted |
| --- | --- | --- |
| <4.13 | Teams used, team admins used | Yes |
| <4.13 | Teams used, team observers and maintainers used | Partially |
| <4.13 | Teams used, only global accounts used | No |

Fleet instances without teams, or with teams but without restricted team accounts are not affected.

The most impactful part of this issue, listed first in the **Impact** section, requires team admins to be in use to be exploited.

### Impact

#### A team admin can add themselves as admin, maintainer or observer on other teams.

In 4.13, this is no longer possible.

#### Team maintainers can list all users.

In 4.13, only global admins can list all users. We will add back the ability to do so for team administrators in a future release.

#### Team maintainers can list all query packs.

In 4.13, only global admins and global maintainers should be able to list all query packs.

#### Team observers, maintainers, and admins can list all activities.

In 4.13, only global users can view global activities.

#### Team observers, maintainers, and admins can list software for the entire instance.

In 4.13, only global users can list global software, and team users can list team software.

We fixed these issues through a private fork, which was then committed to the main Fleet branch. (LINK TO COMMIT WILL BE HERE ONCE PUBLISHED)

### Patches

Fleet 4.13

### Workarounds

If not using team access, this issue is not exploitable.

If not using team admins, the first part of the issue *A team admin can add themselves as admin, maintainer, or observer on other teams* is not exploitable.

### Detection

* Review team memberships to ensure only authorized users are present.

Other issues granted read access to limited data.

### Retesting

4.13 has been tested internally for these issues, and will be retested externally. We are releasing this advisory and update before retesting has occurred as we are confident we have addressed the issues properly and want to provide the fix as soon as possible. Retesting results will be made available with the next scheduled Fleet release at the latest.

### For more information

If you have any questions or comments about this advisory:

join us in the #fleet channel of [osquery Slack](https://join.slack.com/t/osquery/shared_invite/zt-h29zm0gk-s2DBtGUTW4CFel0f0IjTEw).

Email us at security@fleetdm.com.

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2022-24841

### Weaknesses

[CWE-284](/advisories?query=cwe%3A284) [CWE-285](/advisories?query=cwe%3A285) [CWE-639](/advisories?query=cwe%3A639) [CWE-862](/advisories?query=cwe%3A862)

### Credits

* [![@MrTurvey](https://avatars.githubusercontent.com/u/5578593?s=40&v=4)](/MrTurvey)
  [MrTurvey](/MrTurvey)
  Analyst
* [![@j5oh](https://avatars.githubusercontent.com/u/62714889?s=40&v=4)](/j5oh)
  [j5oh](/j5oh)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


