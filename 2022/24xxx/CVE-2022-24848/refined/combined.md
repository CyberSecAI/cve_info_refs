=== Content from github.com_6c2a56f5_20250114_201617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fpull%2F10953)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fpull%2F10953)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=dhis2%2Fdhis2-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dhis2](/dhis2)
/
**[dhis2-core](/dhis2/dhis2-core)**
Public

* [Notifications](/login?return_to=%2Fdhis2%2Fdhis2-core) You must be signed in to change notification settings
* [Fork
  355](/login?return_to=%2Fdhis2%2Fdhis2-core)
* [Star
   297](/login?return_to=%2Fdhis2%2Fdhis2-core)

* [Code](/dhis2/dhis2-core)
* [Pull requests
  40](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects
  0](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

Additional navigation options

* [Code](/dhis2/dhis2-core)
* [Pull requests](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdhis2%2Fdhis2-core%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdhis2%2Fdhis2-core%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: Merge pull request from GHSA-52vp-f7hj-cj92 #10953

 Merged

[ameenhere](/ameenhere)
merged 7 commits into
[2.36](/dhis2/dhis2-core/tree/2.36 "dhis2/dhis2-core:2.36")
from
[DHIS2-13056-2.36](/dhis2/dhis2-core/tree/DHIS2-13056-2.36 "dhis2/dhis2-core:DHIS2-13056-2.36")

Jun 2, 2022

 Merged

# [fix: Merge pull request from GHSA-52vp-f7hj-cj92](#top) #10953

[ameenhere](/ameenhere)
merged 7 commits into
[2.36](/dhis2/dhis2-core/tree/2.36 "dhis2/dhis2-core:2.36")
from
[DHIS2-13056-2.36](/dhis2/dhis2-core/tree/DHIS2-13056-2.36 "dhis2/dhis2-core:DHIS2-13056-2.36")

Jun 2, 2022

[Conversation
1](/dhis2/dhis2-core/pull/10953)
[Commits
7](/dhis2/dhis2-core/pull/10953/commits)
[Checks
0](/dhis2/dhis2-core/pull/10953/checks)
[Files changed](/dhis2/dhis2-core/pull/10953/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ameenhere](https://avatars.githubusercontent.com/u/1190589?s=60&v=4)](/ameenhere)

Copy link

Contributor

### @ameenhere **[ameenhere](/ameenhere)** commented [Jun 1, 2022](#issue-1255423403)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [ameenhere](/ameenhere)
and others
added 7 commits
[June 1, 2022 10:57](#commits-pushed-c22e21b)

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[Merge pull request from](/dhis2/dhis2-core/pull/10953/commits/c22e21b9a4c4e40bf3d1428e8587decbb3ca42bb "Merge pull request from GHSA-52vp-f7hj-cj92") [GHSA-52vp-f7hj-cj92](https://github.com/dhis2/dhis2-core/security/advisories/GHSA-52vp-f7hj-cj92 "GHSA-52vp-f7hj-cj92")`

`[c22e21b](/dhis2/dhis2-core/pull/10953/commits/c22e21b9a4c4e40bf3d1428e8587decbb3ca42bb)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[Remove newline](/dhis2/dhis2-core/pull/10953/commits/1df7729759a535dde0d8ab69f9c8fd6455f3572f "Remove newline")`

`[1df7729](/dhis2/dhis2-core/pull/10953/commits/1df7729759a535dde0d8ab69f9c8fd6455f3572f)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[Formattting](/dhis2/dhis2-core/pull/10953/commits/2fe3c9d9221b62a315757d619b8e2cb51a67abc4 "Formattting")`

`[2fe3c9d](/dhis2/dhis2-core/pull/10953/commits/2fe3c9d9221b62a315757d619b8e2cb51a67abc4)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[formatting SqlUtils](/dhis2/dhis2-core/pull/10953/commits/1c535994ff5e98002873a11fbda3cae6f237765b "formatting SqlUtils")`

`[1c53599](/dhis2/dhis2-core/pull/10953/commits/1c535994ff5e98002873a11fbda3cae6f237765b)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[formatting](/dhis2/dhis2-core/pull/10953/commits/d44fb92e87c929a8df36b5414389f4d00c60593a "formatting")`

`[d44fb92](/dhis2/dhis2-core/pull/10953/commits/d44fb92e87c929a8df36b5414389f4d00c60593a)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[Sonar fix](/dhis2/dhis2-core/pull/10953/commits/21327c47875cb58cfdc2818b95387b92ffcf1cc8 "Sonar fix")`

`[21327c4](/dhis2/dhis2-core/pull/10953/commits/21327c47875cb58cfdc2818b95387b92ffcf1cc8)`

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

`[Merge branch '2.36' into DHIS2-13056-2.36](/dhis2/dhis2-core/pull/10953/commits/c0de233871a47ba97d9c042a831918d9a3c4597f "Merge branch '2.36' into DHIS2-13056-2.36")`

`[c0de233](/dhis2/dhis2-core/pull/10953/commits/c0de233871a47ba97d9c042a831918d9a3c4597f)`

 [![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&u=64c32ebd26375c947a218a56a311fe47c53d4d94&v=4)](/ameenhere)
[ameenhere](/ameenhere)
marked this pull request as ready for review
[June 1, 2022 12:20](#event-6718449447)

[![@sonarqubecloud](https://avatars.githubusercontent.com/in/12526?s=80&v=4)](/apps/sonarqubecloud)

Copy link

### **[sonarqubecloud](/apps/sonarqubecloud) bot** commented [Jun 1, 2022](#issuecomment-1143542331)

| Kudos, SonarCloud Quality Gate passed!    [Quality Gate passed](https://sonarcloud.io/dashboard?id=dhis2_dhis2-core&pullRequest=10953)  [Bug](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=BUG) [A](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=BUG) [0 Bugs](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=BUG) [Vulnerability](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=VULNERABILITY) [A](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=VULNERABILITY) [0 Vulnerabilities](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=VULNERABILITY) [Security Hotspot](https://sonarcloud.io/project/security_hotspots?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=SECURITY_HOTSPOT) [A](https://sonarcloud.io/project/security_hotspots?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=SECURITY_HOTSPOT) [0 Security Hotspots](https://sonarcloud.io/project/security_hotspots?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=SECURITY_HOTSPOT) [Code Smell](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=CODE_SMELL) [A](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=CODE_SMELL) [2 Code Smells](https://sonarcloud.io/project/issues?id=dhis2_dhis2-core&pullRequest=10953&resolved=false&types=CODE_SMELL)  [0.0%](https://sonarcloud.io/component_measures?id=dhis2_dhis2-core&pullRequest=10953&metric=new_coverage&view=list) [0.0% Coverage](https://sonarcloud.io/component_measures?id=dhis2_dhis2-core&pullRequest=10953&metric=new_coverage&view=list) [0.0%](https://sonarcloud.io/component_measures?id=dhis2_dhis2-core&pullRequest=10953&metric=new_duplicated_lines_density&view=list) [0.0% Duplication](https://sonarcloud.io/component_measures?id=dhis2_dhis2-core&pullRequest=10953&metric=new_duplicated_lines_density&view=list) |
| --- |

All reactions

Sorry, something went wrong.

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&u=64c32ebd26375c947a218a56a311fe47c53d4d94&v=4)](/ameenhere)
[ameenhere](/ameenhere)
merged commit [`9a16b53`](/dhis2/dhis2-core/commit/9a16b53d63ff2fba2740ad2aad59693006e728e0)
into
2.36

[Jun 2, 2022](https://github.com/dhis2/dhis2-core/pull/10953#event-6728563495)

 [![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&u=64c32ebd26375c947a218a56a311fe47c53d4d94&v=4)](/ameenhere)
[ameenhere](/ameenhere)
deleted the
DHIS2-13056-2.36

branch
[June 2, 2022 13:47](#event-6728563604)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fpull%2F10953)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=52&v=4)](/ameenhere)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dacd8484_20250114_201614.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2Fef04483a9b177d62e48dcf4e498b302a11f95e7d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2Fef04483a9b177d62e48dcf4e498b302a11f95e7d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dhis2%2Fdhis2-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dhis2](/dhis2)
/
**[dhis2-core](/dhis2/dhis2-core)**
Public

* [Notifications](/login?return_to=%2Fdhis2%2Fdhis2-core) You must be signed in to change notification settings
* [Fork
  355](/login?return_to=%2Fdhis2%2Fdhis2-core)
* [Star
   297](/login?return_to=%2Fdhis2%2Fdhis2-core)

* [Code](/dhis2/dhis2-core)
* [Pull requests
  40](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects
  0](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

Additional navigation options

* [Code](/dhis2/dhis2-core)
* [Pull requests](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

## Commit

[Permalink](/dhis2/dhis2-core/commit/ef04483a9b177d62e48dcf4e498b302a11f95e7d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-52vp-f7hj-cj92](https://github.com/dhis2/dhis2-core/security/advisories/GHSA-52vp-f7hj-cj92 "GHSA-52vp-f7hj-cj92")

[Browse files](/dhis2/dhis2-core/tree/ef04483a9b177d62e48dcf4e498b302a11f95e7d)
Browse the repository at this point in the history

```
* fix: Add validation for programs org unit associations [DHIS2-13056]

* fix compilation failure in test class

* Fix one more compilation failure in another test class

Co-authored-by: Lars Helge Øverland <lars@dhis2.org>
Co-authored-by: Ameen <ameen@dhis2.org>
```

* Loading branch information

[![@Philip-Larsen-Donnelly](https://avatars.githubusercontent.com/u/35666657?s=40&v=4)](/Philip-Larsen-Donnelly) [![@larshelge](https://avatars.githubusercontent.com/u/908206?s=40&v=4)](/larshelge) [![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

3 people

authored
Jun 1, 2022

1 parent
[57f2dac](/dhis2/dhis2-core/commit/57f2dacde7ac90733caf6593fe2502575dc6fc2e)

commit ef04483

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**144 additions**
and
**18 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dhis-2

  + dhis-api/src/main/java/org/hisp/dhis

    - common

      * dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java
        [IdentifiableObjectManager.java](#diff-96119ef8087ce7f085ba085b51636fb50ae0bc23810853d5294e7b17ec192c18)
    - feedback

      * dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java
        [ErrorCode.java](#diff-46be114384528924944452a51223a6e1d33307de08a81725435ddaeb9a30e6d0)
  + dhis-services/dhis-service-core/src

    - main/java/org/hisp/dhis

      * association

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/AbstractOrganisationUnitAssociationsQueryBuilder.java
          [AbstractOrganisationUnitAssociationsQueryBuilder.java](#diff-a98caf60d4e7f80a083a4a59e59d14f2831b0d7da20f3616c9cc50f33c9ab7a0)
      * common

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java
          [DefaultIdentifiableObjectManager.java](#diff-b6c2544bb3b511a357f1013de5200bd8470e518901d964d078a845da7a28d8d9)
      * deduplication/hibernate

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/deduplication/hibernate/HibernatePotentialDuplicateStore.java
          [HibernatePotentialDuplicateStore.java](#diff-41c4983f8a53d81b76a98f45a644a60fd0b517f17ed4f6ea32c2cd5dae5ea89f)
      * program

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/DefaultProgramService.java
          [DefaultProgramService.java](#diff-862f92ed1702c5d2dcab02414532f74430f9ae44701d459d74a51bde8ac67256)
    - test/java/org/hisp/dhis/common

      * dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java
        [IdentifiableObjectManagerTest.java](#diff-67d85ff993b2a9da22451dab48a946bcc960ddb1c8c3d302a883def9941dec76)
  + dhis-support/dhis-support-commons/src

    - main/java/org/hisp/dhis/commons/collection

      * dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java
        [CollectionUtils.java](#diff-f987acbc74530722ce4a1dc1ad4ca33145c9a3d51b1c2bc86fc4ab0e0f35ecc0)
    - test/java/org/hisp/dhis/commons/util

      * dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java
        [CollectionUtilsTest.java](#diff-0e6e4f25984779315eb369ef55343d39278c1c702aced132f38d68eb087a1b2c)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java](#diff-96119ef8087ce7f085ba085b51636fb50ae0bc23810853d5294e7b17ec192c18 "dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -109,7 +109,10 @@ <T extends IdentifiableObject> List<AttributeValue> getAllValuesByAttributes( Cl |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getByUid( Class<T> clazz, Collection<String> uids ); |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getByUid( Collection<Class<? extends IdentifiableObject>> classes, |
|  |  | <T extends IdentifiableObject> List<T> getAndValidateByUid( Class<T> type, Collection<String> uids ) |
|  |  | throws IllegalQueryException; |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getByUid( Collection<Class<? extends IdentifiableObject>> types, |
|  |  | Collection<String> uids ); |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getById( Class<T> clazz, Collection<Long> ids ); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java](#diff-46be114384528924944452a51223a6e1d33307de08a81725435ddaeb9a30e6d0 "dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,7 @@ public enum ErrorCode |
|  |  | E1105( "Data set not found or not accessible: `{0}`" ), |
|  |  | E1106( "There are duplicate translation record for property `{0}` and locale `{1}`" ), |
|  |  | E1107( "Object type `{0}` is not translatable." ), |
|  |  | E1112( "Object(s) of type `{0}` not found or not accessible: `{1}`" ), |
|  |  |  |
|  |  | /\* Org unit merge \*/ |
|  |  | E1500( "At least two source orgs unit must be specified" ), |
| Expand Down | |  |

15 changes: 6 additions & 9 deletions

15
[...main/java/org/hisp/dhis/association/AbstractOrganisationUnitAssociationsQueryBuilder.java](#diff-a98caf60d4e7f80a083a4a59e59d14f2831b0d7da20f3616c9cc50f33c9ab7a0 "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/AbstractOrganisationUnitAssociationsQueryBuilder.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/AbstractOrganisationUnitAssociationsQueryBuilder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,7 @@ |
|  |  | import static org.hisp.dhis.hibernate.jsonb.type.JsonbFunctions.HAS\_USER\_GROUP\_IDS; |
|  |  | import static org.hisp.dhis.hibernate.jsonb.type.JsonbFunctions.HAS\_USER\_ID; |
|  |  | import static org.hisp.dhis.security.acl.AclService.LIKE\_READ\_METADATA; |
|  |  | import static org.hisp.dhis.system.util.SqlUtils.singleQuote; |
|  |  |  |
|  |  | import java.util.Arrays; |
|  |  | import java.util.Objects; |
| Expand All | | @@ -43,6 +44,7 @@ |
|  |  | import lombok.RequiredArgsConstructor; |
|  |  |  |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.hisp.dhis.system.util.SqlUtils; |
|  |  | import org.hisp.dhis.user.CurrentUserGroupInfo; |
|  |  | import org.hisp.dhis.user.CurrentUserService; |
|  |  | import org.hisp.dhis.user.User; |
| Expand Down  Expand Up | | @@ -147,14 +149,14 @@ private String getSharingConditions( String access ) |
|  |  | private String getOwnerCondition( CurrentUserGroupInfo currentUserGroupInfo ) |
|  |  | { |
|  |  | return String.join( " or ", |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " = " + withQuotes( currentUserGroupInfo.getUserUID() ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " = " + singleQuote( currentUserGroupInfo.getUserUID() ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " is null" ); |
|  |  | } |
|  |  |  |
|  |  | private String getPublicSharingCondition( String access ) |
|  |  | { |
|  |  | return String.join( " or ", |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " like " + withQuotes( access ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " like " + singleQuote( access ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " is null" ); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -187,7 +189,7 @@ private String jsonbFunction( String functionName, String... params ) |
|  |  | "(", |
|  |  | String.join( ",", "inner\_query\_alias.sharing", |
|  |  | Arrays.stream( params ) |
|  |  | .map( this::withQuotes ) |
|  |  | .map( SqlUtils::singleQuote ) |
|  |  | .collect( joining( "," ) ) ), |
|  |  | ")" ); |
|  |  | } |
| Expand All | | @@ -201,16 +203,11 @@ private String getUidsFilter( Set<String> uids ) |
|  |  | { |
|  |  | return T\_ALIAS + ".uid in (" + |
|  |  | uids.stream() |
|  |  | .map( this::withQuotes ) |
|  |  | .map( SqlUtils::singleQuote ) |
|  |  | .collect( joining( "," ) ) |
|  |  | + ")"; |
|  |  | } |
|  |  |  |
|  |  | private String withQuotes( String uid ) |
|  |  | { |
|  |  | return String.join( "", "'", uid, "'" ); |
|  |  | } |
|  |  |  |
|  |  | private String getUserOrgUnitPathsFilter( Set<String> userOrgUnitPaths ) |
|  |  | { |
|  |  | return Stream.concat( |
| Expand Down | |  |

22 changes: 22 additions & 0 deletions

22
[...his-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java](#diff-b6c2544bb3b511a357f1013de5200bd8470e518901d964d078a845da7a28d8d9 "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -56,6 +56,9 @@ |
|  |  | import org.hisp.dhis.category.CategoryOption; |
|  |  | import org.hisp.dhis.category.CategoryOptionCombo; |
|  |  | import org.hisp.dhis.common.exception.InvalidIdentifierReferenceException; |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.hisp.dhis.feedback.ErrorCode; |
|  |  | import org.hisp.dhis.feedback.ErrorMessage; |
|  |  | import org.hisp.dhis.hibernate.HibernateProxyUtils; |
|  |  | import org.hisp.dhis.schema.Schema; |
|  |  | import org.hisp.dhis.schema.SchemaService; |
| Expand Down  Expand Up | | @@ -607,6 +610,25 @@ public <T extends IdentifiableObject> List<T> getByUid( Collection<Class<? exten |
|  |  | return list; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | @Transactional( readOnly = true ) |
|  |  | public <T extends IdentifiableObject> List<T> getAndValidateByUid( Class<T> type, Collection<String> uids ) |
|  |  | throws IllegalQueryException |
|  |  | { |
|  |  | List<T> objects = getByUid( type, uids ); |
|  |  |  |
|  |  | List<String> identifiers = IdentifiableObjectUtils.getUids( objects ); |
|  |  | List<String> difference = CollectionUtils.difference( uids, identifiers ); |
|  |  |  |
|  |  | if ( !difference.isEmpty() ) |
|  |  | { |
|  |  | throw new IllegalQueryException( new ErrorMessage( |
|  |  | ErrorCode.E1112, type.getSimpleName(), difference ) ); |
|  |  | } |
|  |  |  |
|  |  | return objects; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | @Transactional( readOnly = true ) |
|  |  | @SuppressWarnings( "unchecked" ) |
| Expand Down | |  |

12 changes: 6 additions & 6 deletions

12
[...src/main/java/org/hisp/dhis/deduplication/hibernate/HibernatePotentialDuplicateStore.java](#diff-41c4983f8a53d81b76a98f45a644a60fd0b517f17ed4f6ea32c2cd5dae5ea89f "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/deduplication/hibernate/HibernatePotentialDuplicateStore.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/deduplication/hibernate/HibernatePotentialDuplicateStore.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -70,7 +70,7 @@ |
|  |  | import org.hisp.dhis.trackedentity.TrackedEntityInstanceStore; |
|  |  | import org.hisp.dhis.trackedentityattributevalue.TrackedEntityAttributeValue; |
|  |  | import org.hisp.dhis.trackedentityattributevalue.TrackedEntityAttributeValueAudit; |
|  |  | import org.hisp.dhis.trackedentityattributevalue.TrackedEntityAttributeValueAuditService; |
|  |  | import org.hisp.dhis.trackedentityattributevalue.TrackedEntityAttributeValueAuditStore; |
|  |  | import org.hisp.dhis.user.CurrentUserService; |
|  |  | import org.springframework.context.ApplicationEventPublisher; |
|  |  | import org.springframework.jdbc.core.JdbcTemplate; |
| Expand All | | @@ -85,21 +85,21 @@ public class HibernatePotentialDuplicateStore |
|  |  |  |
|  |  | private final TrackedEntityInstanceStore trackedEntityInstanceStore; |
|  |  |  |
|  |  | private final TrackedEntityAttributeValueAuditService trackedEntityAttributeValueAuditService; |
|  |  | private final TrackedEntityAttributeValueAuditStore trackedEntityAttributeValueAuditStore; |
|  |  |  |
|  |  | private final DhisConfigurationProvider config; |
|  |  |  |
|  |  | public HibernatePotentialDuplicateStore( SessionFactory sessionFactory, JdbcTemplate jdbcTemplate, |
|  |  | ApplicationEventPublisher publisher, CurrentUserService currentUserService, AclService aclService, |
|  |  | TrackedEntityInstanceStore trackedEntityInstanceStore, AuditManager auditManager, |
|  |  | TrackedEntityAttributeValueAuditService trackedEntityAttributeValueAuditService, |
|  |  | TrackedEntityAttributeValueAuditStore trackedEntityAttributeValueAuditStore, |
|  |  | DhisConfigurationProvider config ) |
|  |  | { |
|  |  | super( sessionFactory, jdbcTemplate, publisher, PotentialDuplicate.class, currentUserService, |
|  |  | aclService, false ); |
|  |  | this.trackedEntityInstanceStore = trackedEntityInstanceStore; |
|  |  | this.auditManager = auditManager; |
|  |  | this.trackedEntityAttributeValueAuditService = trackedEntityAttributeValueAuditService; |
|  |  | this.trackedEntityAttributeValueAuditStore = trackedEntityAttributeValueAuditStore; |
|  |  | this.config = config; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -248,8 +248,8 @@ private void auditTeav( TrackedEntityAttributeValue av, TrackedEntityAttributeVa |
|  |  |  |
|  |  | if ( config.isEnabled( CHANGELOG\_TRACKER ) ) |
|  |  | { |
|  |  | trackedEntityAttributeValueAuditService.addTrackedEntityAttributeValueAudit( deleteTeavAudit ); |
|  |  | trackedEntityAttributeValueAuditService.addTrackedEntityAttributeValueAudit( updatedTeavAudit ); |
|  |  | trackedEntityAttributeValueAuditStore.addTrackedEntityAttributeValueAudit( deleteTeavAudit ); |
|  |  | trackedEntityAttributeValueAuditStore.addTrackedEntityAttributeValueAudit( updatedTeavAudit ); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

8 changes: 6 additions & 2 deletions

8
[...services/dhis-service-core/src/main/java/org/hisp/dhis/program/DefaultProgramService.java](#diff-862f92ed1702c5d2dcab02414532f74430f9ae44701d459d74a51bde8ac67256 "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/DefaultProgramService.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/program/DefaultProgramService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ |
|  |  | import lombok.RequiredArgsConstructor; |
|  |  |  |
|  |  | import org.apache.commons.collections4.SetValuedMap; |
|  |  | import org.hisp.dhis.common.IdentifiableObjectManager; |
|  |  | import org.hisp.dhis.dataelement.DataElement; |
|  |  | import org.hisp.dhis.dataentryform.DataEntryForm; |
|  |  | import org.hisp.dhis.organisationunit.OrganisationUnit; |
| Expand Down  Expand Up | | @@ -62,6 +63,8 @@ public class DefaultProgramService |
|  |  |  |
|  |  | private final ProgramStore programStore; |
|  |  |  |
|  |  | private final IdentifiableObjectManager idObjectManager; |
|  |  |  |
|  |  | private final CurrentUserService currentUserService; |
|  |  |  |
|  |  | @Qualifier( "jdbcProgramOrgUnitAssociationsStore" ) |
| Expand Down  Expand Up | | @@ -195,9 +198,10 @@ public boolean hasOrgUnit( Program program, OrganisationUnit organisationUnit ) |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public SetValuedMap<String, String> getProgramOrganisationUnitsAssociationsForCurrentUser( |
|  |  | Set<String> programUids ) |
|  |  | public SetValuedMap<String, String> getProgramOrganisationUnitsAssociationsForCurrentUser( Set<String> programUids ) |
|  |  | { |
|  |  | idObjectManager.getAndValidateByUid( Program.class, programUids ); |
|  |  |  |
|  |  | return jdbcOrgUnitAssociationsStore.getOrganisationUnitsAssociationsForCurrentUser( programUids ); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

28 changes: 28 additions & 0 deletions

28
[...s/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java](#diff-67d85ff993b2a9da22451dab48a946bcc960ddb1c8c3d302a883def9941dec76 "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  | import static org.junit.Assert.assertNotNull; |
|  |  | import static org.junit.Assert.assertNull; |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  | import static org.junit.jupiter.api.Assertions.assertThrows; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Arrays; |
| Expand All | | @@ -46,6 +47,7 @@ |
|  |  | import org.hisp.dhis.dataelement.DataElementGroup; |
|  |  | import org.hisp.dhis.dataelement.DataElementOperand; |
|  |  | import org.hisp.dhis.dataelement.DataElementService; |
|  |  | import org.hisp.dhis.feedback.ErrorCode; |
|  |  | import org.hisp.dhis.hibernate.exception.CreateAccessDeniedException; |
|  |  | import org.hisp.dhis.hibernate.exception.DeleteAccessDeniedException; |
|  |  | import org.hisp.dhis.hibernate.exception.UpdateAccessDeniedException; |
| Expand Down  Expand Up | | @@ -473,6 +475,32 @@ public void getByUidTest() |
|  |  | assertTrue( cd.contains( dataElementD ) ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getAndValidateByUidTest() |
|  |  | { |
|  |  | DataElement dataElementA = createDataElement( 'A' ); |
|  |  | DataElement dataElementB = createDataElement( 'B' ); |
|  |  | DataElement dataElementC = createDataElement( 'C' ); |
|  |  | identifiableObjectManager.save( dataElementA ); |
|  |  | identifiableObjectManager.save( dataElementB ); |
|  |  | identifiableObjectManager.save( dataElementC ); |
|  |  | List<DataElement> ab = identifiableObjectManager.getAndValidateByUid( DataElement.class, |
|  |  | Arrays.asList( dataElementA.getUid(), dataElementB.getUid() ) ); |
|  |  | assertTrue( ab.contains( dataElementA ) ); |
|  |  | assertTrue( ab.contains( dataElementB ) ); |
|  |  | assertFalse( ab.contains( dataElementC ) ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getAndValidateByUidExceptionTest() |
|  |  | { |
|  |  | DataElement dataElementA = createDataElement( 'A' ); |
|  |  | identifiableObjectManager.save( dataElementA ); |
|  |  | IllegalQueryException ex = assertThrows( IllegalQueryException.class, () -> identifiableObjectManager |
|  |  | .getAndValidateByUid( DataElement.class, Arrays.asList( dataElementA.getUid(), "xhjG82jHaky" ) ) ); |
|  |  | assertEquals( ErrorCode.E1112, ex.getErrorCode() ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getOrderedUidIdSchemeTest() |
|  |  | { |
| Expand Down | |  |

19 changes: 19 additions & 0 deletions

19
[.../dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java](#diff-f987acbc74530722ce4a1dc1ad4ca33145c9a3d51b1c2bc86fc4ab0e0f35ecc0 "dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,9 +27,12 @@ |
|  |  | \*/ |
|  |  | package org.hisp.dhis.commons.collection; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Collection; |
|  |  | import java.util.Collections; |
|  |  | import java.util.HashSet; |
|  |  | import java.util.Iterator; |
|  |  | import java.util.List; |
|  |  | import java.util.Objects; |
|  |  | import java.util.Set; |
|  |  | import java.util.function.Consumer; |
| Expand Down  Expand Up | | @@ -58,6 +61,22 @@ public static <T> Collection<T> intersection( Collection<T> c1, Collection<T> c2 |
|  |  | return set1; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns all elements which are contained by {@code collection1} but not |
|  |  | \* contained by {@code collection2} as an immutable list. |
|  |  | \* |
|  |  | \* @param <T> |
|  |  | \* @param list1 the first collection. |
|  |  | \* @param list2 the second collection. |
|  |  | \* @return all elements in {@code collection1} not in {@code collection2}. |
|  |  | \*/ |
|  |  | public static <A> List<A> difference( Collection<A> collection1, Collection<A> collection2 ) |
|  |  | { |
|  |  | List<A> list = new ArrayList<>( collection1 ); |
|  |  | list.removeAll( collection2 ); |
|  |  | return Collections.unmodifiableList( list ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Searches for and returns the first string which starts with the given |
|  |  | \* prefix. Removes the match from the collection. |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[...rt/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java](#diff-0e6e4f25984779315eb369ef55343d39278c1c702aced132f38d68eb087a1b2c "dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java")

Show comments

[View file](/dhis2/dhis2-core/blob/ef04483a9b177d62e48dcf4e498b302a11f95e7d/dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,52 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2004-2022, University of Oslo |
|  |  | \* All rights reserved. |
|  |  | \* |
|  |  | \* Redistribution and use in source and binary forms, with or without |
|  |  | \* modification, are permitted provided that the following conditions are met: |
|  |  | \* Redistributions of source code must retain the above copyright notice, this |
|  |  | \* list of conditions and the following disclaimer. |
|  |  | \* |
|  |  | \* Redistributions in binary form must reproduce the above copyright notice, |
|  |  | \* this list of conditions and the following disclaimer in the documentation |
|  |  | \* and/or other materials provided with the distribution. |
|  |  | \* Neither the name of the HISP project nor the names of its contributors may |
|  |  | \* be used to endorse or promote products derived from this software without |
|  |  | \* specific prior written permission. |
|  |  | \* |
|  |  | \* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND |
|  |  | \* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED |
|  |  | \* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE |
|  |  | \* DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR |
|  |  | \* ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES |
|  |  | \* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; |
|  |  | \* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON |
|  |  | \* ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT |
|  |  | \* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS |
|  |  | \* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. |
|  |  | \*/ |
|  |  | package org.hisp.dhis.commons.util; |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  |  |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.junit.jupiter.api.Test; |
|  |  |  |
|  |  | import com.google.common.collect.Lists; |
|  |  |  |
|  |  | class CollectionUtilsTest |
|  |  | { |
|  |  |  |
|  |  | @Test |
|  |  | public void testDifference() |
|  |  | { |
|  |  | List<String> collection1 = Lists.newArrayList( "One", "Two", "Three" ); |
|  |  | List<String> collection2 = Lists.newArrayList( "One", "Two", "Four" ); |
|  |  | List<String> difference = CollectionUtils.difference( collection1, collection2 ); |
|  |  |  |
|  |  | assertEquals( 1, difference.size() ); |
|  |  | assertEquals( "Three", difference.get( 0 ) ); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ef04483`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2Fef04483a9b177d62e48dcf4e498b302a11f95e7d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_70ea2514_20250114_201618.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fsecurity%2Fadvisories%2FGHSA-52vp-f7hj-cj92)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fsecurity%2Fadvisories%2FGHSA-52vp-f7hj-cj92)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dhis2%2Fdhis2-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dhis2](/dhis2)
/
**[dhis2-core](/dhis2/dhis2-core)**
Public

* [Notifications](/login?return_to=%2Fdhis2%2Fdhis2-core) You must be signed in to change notification settings
* [Fork
  355](/login?return_to=%2Fdhis2%2Fdhis2-core)
* [Star
   297](/login?return_to=%2Fdhis2%2Fdhis2-core)

* [Code](/dhis2/dhis2-core)
* [Pull requests
  40](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects
  0](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

Additional navigation options

* [Code](/dhis2/dhis2-core)
* [Pull requests](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

# Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') in OrgUnit program association

High

[Philip-Larsen-Donnelly](/Philip-Larsen-Donnelly)
published
GHSA-52vp-f7hj-cj92
Jun 1, 2022

## Package

dhis2-core
(dhis2)

## Affected versions

2.36,2.37

## Patched versions

2.36.10.1,2.37.6.1

## Description

Improper neutralization of special elements used in an SQL command

('SQL Injection') vulnerability in the `OrgUnit` API in DHIS2 allows authenticated remote attackers to execute arbitrary SQL commands via unspecified vectors.

### Impact

A serious SQL injection security vulnerability has been found affecting the `/api/programs/orgUnits?programs=` API endpoint in all DHIS2 versions.

The system is vulnerable to attack only from users that are logged in to DHIS2, and there is no known way of exploiting the vulnerability without first being logged in as a DHIS2 user.

The vulnerability is not exposed to a non-malicious user - the vulnerability requires a conscious attack to be exploited.

A successful exploit of this vulnerability could allow the malicious user to read, edit and delete data in the DHIS2 instance's database.

There are no known exploits of the security vulnerabilities addressed by these patch releases. However, we strongly recommend that all DHIS2 implementations using affected versions upgrade to one of the latest supported patches as soon as possible.

### Patches

Security patches are now available for the following DHIS2 versions:

v2.36 -- Update to 2.36.10.1 or above

v2.37 -- Update to 2.37.6.1 or above

These patches address a critical security vulnerability. If your DHIS2 system is using one of the versions listed above, you should download and install the appropriate patch version immediately. If you are using a version of DHIS2 earlier than 2.35 you are also susceptible to this vulnerability and should upgrade to the latest "End of Support" build for your DHIS2 major version. All of the latest patch versions are available for download at [dhis2.org/downloads](https://dhis2.org/downloads).

### Workarounds

*N.B. the following mitigations can be used to mitigate SQL injection vulnerabilities in general, so please consider adding them regardless.*

For implementations which can NOT upgrade, you can apply mitigations at the web proxy level.

For apache2, please follow the steps below:

1. create a file called /etc/apache2/conf-available/block-requests.conf
2. add the contents below
3. run "a2enconf block-requests"
4. run "apache2ctl -t" and make sure you see "Syntax OK"
5. service apache2 reload

```
RewriteEngine On

# check for SQLi on all api requests
RewriteCond %{REQUEST_URI} ^.*/api/([0-9]+/)?
RewriteRule .* - [E=MY_ARGS:%{QUERY_STRING},C]

RewriteCond %{QUERY_STRING} (.*)&(filter=[^&]*)(?=&|$)(.*)|^(filter=[^&]*)(&|$)(.*)
RewriteRule .* - [E=MY_ARGS:%1%3%6]

RewriteCond %{ENV:MY_ARGS} ('|%27)
RewriteRule ^(.*)$ - [F,L]

```

For nginx, please follow the steps below:

1. add the following snippet of code before the `location` block in `nginx.conf` (usually under `/etc/nginx/`)
2. run `nginx -t` to make sure syntax is ok
3. service nginx reload

```
# Set an alert flag to zero
set $sqli 0;

# Copy query parameters to a local variable
set $my_args $args;

# If a local copy of query parameters contains FILTER= parameter, exclude it (case insensitive)
if ($my_args ~* (.*)&(filter=[^&]*)(?=&|$)(.*)|^(filter=[^&]*)(&|$)(.*)) {
     set $my_args $1$3$6;
}

# Check that all remaining parameters don't contain a single quote
if ( $my_args ~* "('|%27)" ) {
    set $sqli 1;
}

# Return an error code if a single quote was found in parameters
if ($sqli = 1) {
    return 418;
}

```
### References

You can read more about the process for identifying, reviewing, and addressing potential security vulnerabilities on our website: <https://dhis2.org/security>

### For more information

If you have any questions or comments about this advisory:

* Email us at security@dhis2.org

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2022-24848

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8b5a8e9e_20250114_201612.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2F3b245d04a58b78f0dc9bae8559f36ee4ca36dfac)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2F3b245d04a58b78f0dc9bae8559f36ee4ca36dfac)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dhis2%2Fdhis2-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dhis2](/dhis2)
/
**[dhis2-core](/dhis2/dhis2-core)**
Public

* [Notifications](/login?return_to=%2Fdhis2%2Fdhis2-core) You must be signed in to change notification settings
* [Fork
  355](/login?return_to=%2Fdhis2%2Fdhis2-core)
* [Star
   297](/login?return_to=%2Fdhis2%2Fdhis2-core)

* [Code](/dhis2/dhis2-core)
* [Pull requests
  40](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects
  0](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

Additional navigation options

* [Code](/dhis2/dhis2-core)
* [Pull requests](/dhis2/dhis2-core/pulls)
* [Actions](/dhis2/dhis2-core/actions)
* [Projects](/dhis2/dhis2-core/projects)
* [Wiki](/dhis2/dhis2-core/wiki)
* [Security](/dhis2/dhis2-core/security)
* [Insights](/dhis2/dhis2-core/pulse)

## Commit

[Permalink](/dhis2/dhis2-core/commit/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-52vp-f7hj-cj92](https://github.com/dhis2/dhis2-core/security/advisories/GHSA-52vp-f7hj-cj92 "GHSA-52vp-f7hj-cj92")

[Browse files](/dhis2/dhis2-core/tree/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac)
Browse the repository at this point in the history

* Loading branch information

[![@ameenhere](https://avatars.githubusercontent.com/u/1190589?s=40&v=4)](/ameenhere)

[ameenhere](/dhis2/dhis2-core/commits?author=ameenhere "View all commits by ameenhere")
authored
Jun 1, 2022

1 parent
[0a0d8e3](/dhis2/dhis2-core/commit/0a0d8e393ed4f8bcd3cdc5a1bdd389051fe2a1b1)

commit 3b245d0

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**148 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dhis-2

  + dhis-api/src/main/java/org/hisp/dhis

    - common

      * dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java
        [IdentifiableObjectManager.java](#diff-96119ef8087ce7f085ba085b51636fb50ae0bc23810853d5294e7b17ec192c18)
    - feedback

      * dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java
        [ErrorCode.java](#diff-46be114384528924944452a51223a6e1d33307de08a81725435ddaeb9a30e6d0)
  + dhis-services/dhis-service-core/src

    - main/java/org/hisp/dhis

      * association

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/ProgramOrganisationUnitAssociationsQueryBuilder.java
          [ProgramOrganisationUnitAssociationsQueryBuilder.java](#diff-9f7b2d26de025bf989b8d3b1af5a7a02f6d88b02915c4e38271cfcd2abf41026)
      * common

        + dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java
          [DefaultIdentifiableObjectManager.java](#diff-b6c2544bb3b511a357f1013de5200bd8470e518901d964d078a845da7a28d8d9)
    - test/java/org/hisp/dhis/common

      * dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java
        [IdentifiableObjectManagerTest.java](#diff-67d85ff993b2a9da22451dab48a946bcc960ddb1c8c3d302a883def9941dec76)
  + dhis-support

    - dhis-support-commons/src

      * main/java/org/hisp/dhis/commons/collection

        + dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java
          [CollectionUtils.java](#diff-f987acbc74530722ce4a1dc1ad4ca33145c9a3d51b1c2bc86fc4ab0e0f35ecc0)
      * test/java/org/hisp/dhis/commons/util

        + dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java
          [CollectionUtilsTest.java](#diff-0e6e4f25984779315eb369ef55343d39278c1c702aced132f38d68eb087a1b2c)
    - dhis-support-system/src/main/java/org/hisp/dhis/system/util

      * dhis-2/dhis-support/dhis-support-system/src/main/java/org/hisp/dhis/system/util/SqlUtils.java
        [SqlUtils.java](#diff-730272d178710cd54f9e4b3f90e6fc7820e4138e0da6f627b8d0d7d411dc7cb7)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java](#diff-96119ef8087ce7f085ba085b51636fb50ae0bc23810853d5294e7b17ec192c18 "dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-api/src/main/java/org/hisp/dhis/common/IdentifiableObjectManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -108,6 +108,9 @@ <T extends IdentifiableObject> List<AttributeValue> getAllValuesByAttributes( Cl |
|  |  | <T extends IdentifiableObject> long countAllValuesByAttributes( Class<T> klass, List<Attribute> attributes ); |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getByUid( Class<T> clazz, Collection<String> uids ); |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getAndValidateByUid( Class<T> type, Collection<String> uids ) |
|  |  | throws IllegalQueryException; |
|  |  |  |
|  |  | <T extends IdentifiableObject> List<T> getById( Class<T> clazz, Collection<Long> ids ); |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java](#diff-46be114384528924944452a51223a6e1d33307de08a81725435ddaeb9a30e6d0 "dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-api/src/main/java/org/hisp/dhis/feedback/ErrorCode.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,7 @@ public enum ErrorCode |
|  |  | E1105( "Data set not found or not accessible: `{0}`" ), |
|  |  | E1106( "There are duplicate translation record for property `{0}` and locale `{1}`" ), |
|  |  | E1107( "Object type `{0}` is not translatable." ), |
|  |  | E1112( "Object(s) of type `{0}` not found or not accessible: `{1}`" ), |
|  |  |  |
|  |  | /\* Data \*/ |
|  |  | E2000( "Query parameters cannot be null" ), |
| Expand Down | |  |

14 changes: 6 additions & 8 deletions

14
[.../main/java/org/hisp/dhis/association/ProgramOrganisationUnitAssociationsQueryBuilder.java](#diff-9f7b2d26de025bf989b8d3b1af5a7a02f6d88b02915c4e38271cfcd2abf41026 "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/ProgramOrganisationUnitAssociationsQueryBuilder.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/association/ProgramOrganisationUnitAssociationsQueryBuilder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,7 @@ |
|  |  | import static org.hisp.dhis.hibernate.jsonb.type.JsonbFunctions.HAS\_USER\_GROUP\_IDS; |
|  |  | import static org.hisp.dhis.hibernate.jsonb.type.JsonbFunctions.HAS\_USER\_ID; |
|  |  | import static org.hisp.dhis.security.acl.AclService.LIKE\_READ\_METADATA; |
|  |  | import static org.hisp.dhis.system.util.SqlUtils.singleQuote; |
|  |  |  |
|  |  | import java.util.Arrays; |
|  |  | import java.util.Objects; |
| Expand All | | @@ -43,6 +44,7 @@ |
|  |  | import lombok.RequiredArgsConstructor; |
|  |  |  |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.hisp.dhis.system.util.SqlUtils; |
|  |  | import org.hisp.dhis.user.CurrentUserGroupInfo; |
|  |  | import org.hisp.dhis.user.CurrentUserService; |
|  |  | import org.hisp.dhis.user.User; |
| Expand Down  Expand Up | | @@ -133,14 +135,14 @@ private String getSharingConditions( String access ) |
|  |  | private String getOwnerCondition( CurrentUserGroupInfo currentUserGroupInfo ) |
|  |  | { |
|  |  | return String.join( " or ", |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " = " + withQuotes( currentUserGroupInfo.getUserUID() ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " = " + singleQuote( currentUserGroupInfo.getUserUID() ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "owner" ) + " is null" ); |
|  |  | } |
|  |  |  |
|  |  | private String getPublicSharingCondition( String access ) |
|  |  | { |
|  |  | return String.join( " or ", |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " like " + withQuotes( access ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " like " + singleQuote( access ), |
|  |  | jsonbFunction( EXTRACT\_PATH\_TEXT, "public" ) + " is null" ); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -173,7 +175,7 @@ private String jsonbFunction( String functionName, String... params ) |
|  |  | "(", |
|  |  | String.join( ",", "prg.sharing", |
|  |  | Arrays.stream( params ) |
|  |  | .map( this::withQuotes ) |
|  |  | .map( SqlUtils::singleQuote ) |
|  |  | .collect( joining( "," ) ) ), |
|  |  | ")" ); |
|  |  | } |
| Expand All | | @@ -187,15 +189,11 @@ private String getProgramUidsFilter( Set<String> programUids ) |
|  |  | { |
|  |  | return "pr.uid in (" + |
|  |  | programUids.stream() |
|  |  | .map( this::withQuotes ) |
|  |  | .map( SqlUtils::singleQuote ) |
|  |  | .collect( joining( "," ) ) |
|  |  | + ")"; |
|  |  | } |
|  |  |  |
|  |  | private String withQuotes( String programUid ) |
|  |  | { |
|  |  | return String.join( "", "'", programUid, "'" ); |
|  |  | } |
|  |  |  |
|  |  | private String getUserOrgUnitPathsFilter( Set<String> userOrgUnitPaths ) |
|  |  | { |
| Expand Down | |  |

22 changes: 22 additions & 0 deletions

22
[...his-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java](#diff-b6c2544bb3b511a357f1013de5200bd8470e518901d964d078a845da7a28d8d9 "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/common/DefaultIdentifiableObjectManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,6 +57,9 @@ |
|  |  | import org.hisp.dhis.category.CategoryOptionCombo; |
|  |  | import org.hisp.dhis.chart.Chart; |
|  |  | import org.hisp.dhis.common.exception.InvalidIdentifierReferenceException; |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.hisp.dhis.feedback.ErrorCode; |
|  |  | import org.hisp.dhis.feedback.ErrorMessage; |
|  |  | import org.hisp.dhis.hibernate.HibernateProxyUtils; |
|  |  | import org.hisp.dhis.reporttable.ReportTable; |
|  |  | import org.hisp.dhis.schema.Schema; |
| Expand Down  Expand Up | | @@ -618,6 +621,25 @@ public <T extends IdentifiableObject> List<T> getByUid( Class<T> clazz, Collecti |
|  |  |  |
|  |  | return (List<T>) store.getByUid( uids ); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | @Transactional( readOnly = true ) |
|  |  | public <T extends IdentifiableObject> List<T> getAndValidateByUid( Class<T> type, Collection<String> uids ) |
|  |  | throws IllegalQueryException |
|  |  | { |
|  |  | List<T> objects = getByUid( type, uids ); |
|  |  |  |
|  |  | List<String> identifiers = IdentifiableObjectUtils.getUids( objects ); |
|  |  | List<String> difference = CollectionUtils.difference( uids, identifiers ); |
|  |  |  |
|  |  | if ( !difference.isEmpty() ) |
|  |  | { |
|  |  | throw new IllegalQueryException( new ErrorMessage( |
|  |  | ErrorCode.E1112, type.getSimpleName(), difference ) ); |
|  |  | } |
|  |  |  |
|  |  | return objects; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | @Transactional( readOnly = true ) |
| Expand Down | |  |

28 changes: 28 additions & 0 deletions

28
[...s/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java](#diff-67d85ff993b2a9da22451dab48a946bcc960ddb1c8c3d302a883def9941dec76 "dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-services/dhis-service-core/src/test/java/org/hisp/dhis/common/IdentifiableObjectManagerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,6 +33,7 @@ |
|  |  | import static org.junit.Assert.assertNotNull; |
|  |  | import static org.junit.Assert.assertNull; |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  | import static org.junit.jupiter.api.Assertions.assertThrows; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Arrays; |
| Expand All | | @@ -46,6 +47,7 @@ |
|  |  | import org.hisp.dhis.dataelement.DataElementGroup; |
|  |  | import org.hisp.dhis.dataelement.DataElementOperand; |
|  |  | import org.hisp.dhis.dataelement.DataElementService; |
|  |  | import org.hisp.dhis.feedback.ErrorCode; |
|  |  | import org.hisp.dhis.hibernate.exception.CreateAccessDeniedException; |
|  |  | import org.hisp.dhis.hibernate.exception.DeleteAccessDeniedException; |
|  |  | import org.hisp.dhis.hibernate.exception.UpdateAccessDeniedException; |
| Expand Down  Expand Up | | @@ -444,6 +446,32 @@ public void getByUidTest() |
|  |  | assertTrue( cd.contains( dataElementC ) ); |
|  |  | assertTrue( cd.contains( dataElementD ) ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getAndValidateByUidTest() |
|  |  | { |
|  |  | DataElement dataElementA = createDataElement( 'A' ); |
|  |  | DataElement dataElementB = createDataElement( 'B' ); |
|  |  | DataElement dataElementC = createDataElement( 'C' ); |
|  |  | identifiableObjectManager.save( dataElementA ); |
|  |  | identifiableObjectManager.save( dataElementB ); |
|  |  | identifiableObjectManager.save( dataElementC ); |
|  |  | List<DataElement> ab = identifiableObjectManager.getAndValidateByUid( DataElement.class, |
|  |  | Arrays.asList( dataElementA.getUid(), dataElementB.getUid() ) ); |
|  |  | assertTrue( ab.contains( dataElementA ) ); |
|  |  | assertTrue( ab.contains( dataElementB ) ); |
|  |  | assertFalse( ab.contains( dataElementC ) ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getAndValidateByUidExceptionTest() |
|  |  | { |
|  |  | DataElement dataElementA = createDataElement( 'A' ); |
|  |  | identifiableObjectManager.save( dataElementA ); |
|  |  | IllegalQueryException ex = assertThrows( IllegalQueryException.class, () -> identifiableObjectManager |
|  |  | .getAndValidateByUid( DataElement.class, Arrays.asList( dataElementA.getUid(), "xhjG82jHaky" ) ) ); |
|  |  | assertEquals( ErrorCode.E1112, ex.getErrorCode() ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void getOrderedUidIdSchemeTest() |
| Expand Down | |  |

19 changes: 19 additions & 0 deletions

19
[.../dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java](#diff-f987acbc74530722ce4a1dc1ad4ca33145c9a3d51b1c2bc86fc4ab0e0f35ecc0 "dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-support/dhis-support-commons/src/main/java/org/hisp/dhis/commons/collection/CollectionUtils.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,9 +27,12 @@ |
|  |  | \*/ |
|  |  | package org.hisp.dhis.commons.collection; |
|  |  |  |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Collection; |
|  |  | import java.util.Collections; |
|  |  | import java.util.HashSet; |
|  |  | import java.util.Iterator; |
|  |  | import java.util.List; |
|  |  | import java.util.Objects; |
|  |  | import java.util.Set; |
|  |  | import java.util.function.Consumer; |
| Expand Down  Expand Up | | @@ -57,6 +60,22 @@ public static <T> Collection<T> intersection( Collection<T> c1, Collection<T> c2 |
|  |  | set1.retainAll( new HashSet<>( c2 ) ); |
|  |  | return set1; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns all elements which are contained by {@code collection1} but not |
|  |  | \* contained by {@code collection2} as an immutable list. |
|  |  | \* |
|  |  | \* @param <T> |
|  |  | \* @param collection1 the first collection. |
|  |  | \* @param collection2 the second collection. |
|  |  | \* @return all elements in {@code collection1} not in {@code collection2}. |
|  |  | \*/ |
|  |  | public static <A> List<A> difference( Collection<A> collection1, Collection<A> collection2 ) |
|  |  | { |
|  |  | List<A> list = new ArrayList<>( collection1 ); |
|  |  | list.removeAll( collection2 ); |
|  |  | return Collections.unmodifiableList( list ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Searches for and returns the first string which starts with the given |
| Expand Down | |  |

52 changes: 52 additions & 0 deletions

52
[...rt/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java](#diff-0e6e4f25984779315eb369ef55343d39278c1c702aced132f38d68eb087a1b2c "dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-support/dhis-support-commons/src/test/java/org/hisp/dhis/commons/util/CollectionUtilsTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,52 @@ |
|  |  | /\* |
|  |  | \* Copyright (c) 2004-2022, University of Oslo |
|  |  | \* All rights reserved. |
|  |  | \* |
|  |  | \* Redistribution and use in source and binary forms, with or without |
|  |  | \* modification, are permitted provided that the following conditions are met: |
|  |  | \* Redistributions of source code must retain the above copyright notice, this |
|  |  | \* list of conditions and the following disclaimer. |
|  |  | \* |
|  |  | \* Redistributions in binary form must reproduce the above copyright notice, |
|  |  | \* this list of conditions and the following disclaimer in the documentation |
|  |  | \* and/or other materials provided with the distribution. |
|  |  | \* Neither the name of the HISP project nor the names of its contributors may |
|  |  | \* be used to endorse or promote products derived from this software without |
|  |  | \* specific prior written permission. |
|  |  | \* |
|  |  | \* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND |
|  |  | \* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED |
|  |  | \* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE |
|  |  | \* DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR |
|  |  | \* ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES |
|  |  | \* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; |
|  |  | \* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON |
|  |  | \* ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT |
|  |  | \* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS |
|  |  | \* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. |
|  |  | \*/ |
|  |  | package org.hisp.dhis.commons.util; |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  |  |
|  |  | import java.util.List; |
|  |  |  |
|  |  | import org.hisp.dhis.commons.collection.CollectionUtils; |
|  |  | import org.junit.jupiter.api.Test; |
|  |  |  |
|  |  | import com.google.common.collect.Lists; |
|  |  |  |
|  |  | class CollectionUtilsTest |
|  |  | { |
|  |  |  |
|  |  | @Test |
|  |  | public void testDifference() |
|  |  | { |
|  |  | List<String> collection1 = Lists.newArrayList( "One", "Two", "Three" ); |
|  |  | List<String> collection2 = Lists.newArrayList( "One", "Two", "Four" ); |
|  |  | List<String> difference = CollectionUtils.difference( collection1, collection2 ); |
|  |  |  |
|  |  | assertEquals( 1, difference.size() ); |
|  |  | assertEquals( "Three", difference.get( 0 ) ); |
|  |  | } |
|  |  | } |

17 changes: 17 additions & 0 deletions

17
[...-2/dhis-support/dhis-support-system/src/main/java/org/hisp/dhis/system/util/SqlUtils.java](#diff-730272d178710cd54f9e4b3f90e6fc7820e4138e0da6f627b8d0d7d411dc7cb7 "dhis-2/dhis-support/dhis-support-system/src/main/java/org/hisp/dhis/system/util/SqlUtils.java")

Show comments

[View file](/dhis2/dhis2-core/blob/3b245d04a58b78f0dc9bae8559f36ee4ca36dfac/dhis-2/dhis-support/dhis-support-system/src/main/java/org/hisp/dhis/system/util/SqlUtils.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,6 +45,8 @@ |
|  |  | public class SqlUtils |
|  |  | { |
|  |  | public static final String QUOTE = "\""; |
|  |  |  |
|  |  | public static final String SINGLE\_QUOTE = "'"; |
|  |  |  |
|  |  | public static final String SEPARATOR = "."; |
|  |  |  |
| Expand Down  Expand Up | | @@ -79,6 +81,21 @@ public static String quote( String alias, String relation ) |
|  |  |  |
|  |  | return alias + SEPARATOR + quote( relation ); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Single-quotes the given relation (typically a value). Single-quotes part |
|  |  | \* of the given relation are encoded (replaced by double single-quotes that |
|  |  | \* is). |
|  |  | \* |
|  |  | \* @param relation the relation (typically a column). |
|  |  | \* @return the single-quoted relation. |
|  |  | \*/ |
|  |  | public static String singleQuote( String relation ) |
|  |  | { |
|  |  | String rel = relation.replaceAll( SINGLE\_QUOTE, (SINGLE\_QUOTE + SINGLE\_QUOTE) ); |
|  |  |  |
|  |  | return SINGLE\_QUOTE + rel + SINGLE\_QUOTE; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns a string set for the given result set and column. Assumes that |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3b245d0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdhis2%2Fdhis2-core%2Fcommit%2F3b245d04a58b78f0dc9bae8559f36ee4ca36dfac) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


