=== Content from apiiro.com_c94416bf_20250115_100205.html ===


2024 ‚Äì Apiiro makes waves üåä in our biggest year yet
[Read more](https://apiiro.com/news_item/apiiro-closes-breakthrough-2024-with-275-growth-as-cios-and-cisos-prioritize-aspm-to-supercharge-secure-software-delivery/%20 "Read more")

[![Apiiro - Leading Application Security Posture Management (ASPM) Platform](https://apiiro.com/wp-content/themes/apiirov2/assets/img/logo.svg)
![Apiiro - Leading Application Security Posture Management (ASPM) Platform](https://apiiro.com/wp-content/themes/apiirov2/assets/img/logo-gradient.svg)](https://apiiro.com)

![Apiiro logo](https://apiiro.com/wp-content/themes/apiirov2/assets/img/logo.svg)
![close menu](https://apiiro.com/wp-content/themes/apiirov2/assets/img/close-x.svg)

* Platform
  ![back](https://apiiro.com/wp-content/themes/apiirov2/assets/img/arrow-back.svg)Back
  ![close menu](https://apiiro.com/wp-content/themes/apiirov2/assets/img/close-x.svg)

  Platform
  Platform

  [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-Diamond-2.svg)

  ASPM Platform Overview
  Design, develop and deliver secure software faster

  **Open** ‚Äì Integrate with everything! extended by native scanners

  **Deep** ‚Äì Understand your software architecture, from code-to-runtime

  **Scalable** ‚Äì Analyze over 100K code repositories via read-only API

  Learn more](https://apiiro.com/product/aspm/ "ASPM Platform Overview")
  [Powered by DCA](https://apiiro.com/product/deep-code-analysis-dca-apiiro/ "Powered by DCA")

  Products
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-layout.svg)

    Apiiro Design
    Detect risks before a single line of code is written](https://apiiro.com/product/aspm/ "Apiiro Design")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-codefile.svg)

    Apiiro Develop
    Fix risks in your code with runtime context](https://apiiro.com/product/aspm/ "Apiiro Develop")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-paperplane.svg)

    Apiiro Deliver
    Protect your SCM and CI/CD for secure delivery](https://apiiro.com/product/aspm/ "Apiiro Deliver")
* Products
  ![back](https://apiiro.com/wp-content/themes/apiirov2/assets/img/arrow-back.svg)Back
  ![close menu](https://apiiro.com/wp-content/themes/apiirov2/assets/img/close-x.svg)

  Products
  By use case
  [Powered by DCA](https://apiiro.com/product/deep-code-analysis-dca-apiiro/ "Powered by DCA")

  ![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-layout.svg)

  Apiiro Design
  + [Risk detection in the design phase
    Identify risks before you start coding](https://apiiro.com/product/risk-detection-at-design-phase/ "Risk detection in the design phase")
  + [AI-based threat modeling stories
    Generate threats and mitigations on new features](https://apiiro.com/product/risk-detection-at-design-phase/ "AI-based threat modeling stories")
  + [Contextual questionnaires
    Eliminate manual steps for faster, safer development](https://apiiro.com/product/aspm/ "Contextual questionnaires")
  ![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-codefile.svg)

  Apiiro Develop
  + [Real-time software inventory
    Generate and explore XBOM with Deep Code Analysis](https://apiiro.com/product/software-bill-of-materials-sbom/ "Real-time software inventory")
  + [Material code changes detection
    Comply with PCI v4, NIST and SOC2](https://apiiro.com/product/application-software-supply-chain-inventory-risk-assessment/ "Material code changes detection")
  + [API inventory and security in code
    Discover, inventory, and test APIs in code](https://apiiro.com/product/api-security-testing/ "API inventory and security in code")
  + [Risk-based code reviews
    Detect business logic changes and trigger reviews](https://apiiro.com/product/aspm/ "Risk-based code reviews")
  + [Automated codebase risk assessment
    Prioritize security reviews and scanning efficiently](https://apiiro.com/product/application-software-supply-chain-inventory-risk-assessment/ "Automated codebase risk assessment")
  + [Crown-jewel applications detection
    Uncover and prioritize your most critical assets](https://apiiro.com/product/application-risk-prioritization-remediation/ "Crown-jewel applications detection")
  + [Secrets security
    Detect, validate, fix and prevent secrets exposure](https://apiiro.com/product/secrets-security-in-code/ "Secrets security")
  + [Open source (OSS) security
    Fix and prevent reachable vulnerabilities and malware](https://apiiro.com/product/software-composition-analysis/ "Open source (OSS) security")
  + [Sensitive data in code
    Detect and prevent PII, PHI, PCI data exposure](https://apiiro.com/product/aspm/ "Sensitive data in code")
  + [Managed SAST
    Detect, fix and prevent OWASP Top 10 vulnerabilities](https://apiiro.com/product/aspm/ "Managed SAST")
  ![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-paperplane.svg)

  Apiiro Deliver
  + [Software supply chain security (SSCS)
    Protect your SCM and CI/CD pipelines from attacks](https://apiiro.com/product/sscs/ "Software supply chain security (SSCS)")
  + [Automated release risk assessment
    Eliminate manual steps for faster, safer deployments](https://apiiro.com/product/application-risk-prioritization-remediation/ "Automated release risk assessment")
  + [Change-driven penetration testing
    Automatically trigger testing on high-risk changes](https://apiiro.com/product/api-security-testing/ "Change-driven penetration testing")

  ![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-enter.svg)

  **Unified risk and vulnerability management** across application, infrastructure, and code quality scanners, with code-to-runtime actionable context

  ![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-coverage-shield.svg)

  **Automated security controls validation and assurance** based on your organization‚Äôs SDLC policies, with actionable context from your CMDB

  ![icon](https://apiiro.com/wp-content/uploads/2024/10/ClusterEntitty.svg)

  **Risk Graph policy engine and developer‚Äôs guardrails** at every phase: design, development (pull request), and delivery (build/deploy)
* Learn
  ![back](https://apiiro.com/wp-content/themes/apiirov2/assets/img/arrow-back.svg)Back
  ![close menu](https://apiiro.com/wp-content/themes/apiirov2/assets/img/close-x.svg)

  Learn
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-trophy.svg)

    Customers](https://apiiro.com/resources/case-studies/ "Customers")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/Play.svg)

    Resources](https://apiiro.com/resources "Resources")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-blog.svg)

    Blog](https://apiiro.com/blog "Blog")
  [How Cloudera balances development speed and product security with Apiiro
  Learn how Apiiro helped Cloudera consolidate their AppSec tools and get risk-based context to reduce their backlogs and meet customer security and regulatory requirements.](https://apiiro.com/resource/cloudera-case-study-development-speed-product-security-aspm/ "How Cloudera balances development speed and product security with Apiiro")
  [![How Cloudera balances development speed and product security with Apiiro](https://apiiro.com/wp-content/uploads/2024/10/cloudera-sm.png)](https://apiiro.com/resource/cloudera-case-study-development-speed-product-security-aspm/)
  [All case studies](https://apiiro.com/resources/case-studies/)
* Company
  ![back](https://apiiro.com/wp-content/themes/apiirov2/assets/img/arrow-back.svg)Back
  ![close menu](https://apiiro.com/wp-content/themes/apiirov2/assets/img/close-x.svg)

  Company
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-case.svg)

    Careers](https://apiiro.com/careers/ "Careers")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-star.svg)

    Partners](https://apiiro.com/partners/ "Partners")
  + [![icon](https://apiiro.com/wp-content/uploads/2024/10/icon-news.svg)

    News](https://apiiro.com/news-center/ "News")
  [The Apiiro way
  We believe that a vibrant culture is an essential key to building the best products. This is why we pick each of our team members attentively. We embrace each other‚Äôs uniqueness. We encourage our people to be bold. We operate with honesty, transparency & integrity, together with customer obsession.](https://apiiro.com/careers/ "The Apiiro way")
  [![The Apiiro way](https://apiiro.com/wp-content/uploads/2024/10/de36a3d83293bbfa1e008bc217377dde.jpg)](https://apiiro.com/careers/)

[Get a demo](https://apiiro.com/schedule-a-demo/ "Get a demo")

[Log in](https://login.apiiro.com/ "Log in")

[Get a demo](https://apiiro.com/schedule-a-demo/ "Get a demo")

![mobile menu toggler](https://apiiro.com/wp-content/themes/apiirov2/assets/img/menu-toggler.svg)

[Apiiro Blog](https://apiiro.com/blog)
Ôπ• Malicious Kubernetes Helm charts can be‚Ä¶

Technical
# Malicious Kubernetes Helm charts can be used to steal sensitive information from Argo CD deployments

Published February 3 2022 ¬∑
4 min. read

Apiiro‚Äôs Security Research team has uncovered a major software supply chain 0-day vulnerability ([CVE-2022-24348](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24348)) in Argo CD, the popular open source Continuous Delivery platform, which enables attackers to access sensitive information such as secrets, passwords, and API keys.

Argo CD manages and orchestrates the execution and monitoring of application deployment post-integration.

## TL;DR

* Argo CD is a popular, open-source, Continuous Delivery (CD) platform that is used by thousands of organizations globally.
* A 0-day vulnerability, discovered by Apiiro‚Äôs Security Research team, allows malicious actors to load a Kubernetes Helm Chart YAML file to the vulnerability and ‚Äúhop‚Äù from their application ecosystem to other applications‚Äô data outside of the user‚Äôs scope.
* The actors can read and exfiltrate secrets, tokens, and other sensitive information residing on other applications.
* The impact of the attack includes privilege escalation, sensitive information disclosure, lateral movement attacks, and more.
* Although Argo CD contributors were aware of this weak point in 2019 and implemented an anti-path-traversal mechanism, a bug in the control allows for exploitation of this vulnerability.

![](https://apiiro.com/wp-content/uploads/2022/02/CVE-image.png)

## Vulnerability Details & Attack Breakdown

In order to build a new deployment pipeline, a user can define either a Git repository or a Kubernetes Helm Chart file that includes:

* The metadata and information needed to deploy the appropriate Kubernetes configuration, and
* The ability to dynamically update the cloud configuration as the manifest is being modified.

A Helm Chart is a YAML file that embeds different fields to form a declaration of resources and configurations needed in order for deploying an application.

The application in question can contain values of many sorts, one of those types can contain file names and relative paths to self-contained application parts in other files.

In fact, Argo CD‚Äôs contributors [envisioned this kind of exploitation in 2019](https://github.com/argoproj/argo-cd/issues/2715) to be possible and built a dedicated mechanism to thwart any such attempt.

Repositories are saved on a dedicated server or pod named *argocd-reposerver*. There is no strong segmentation apart from file hierarchy, so the anti-path-traversal mechanism is a critical linchpin of file security.The inner workings of the mechanism are mainly present in a single file in the source code at *util/security/path\_traversal.go,* which defines the procedural cleanup of source path input.

| 123456789101112131415161718192021222324252627282930313233 | // Ensure that `requestedPath` is on the same directory or any subdirectory of `currentRoot`. Both `currentRoot` and// `requestedPath` must be absolute paths. They may contain any number of `./` or `/../` dir changes.func EnforceToCurrentRoot(currentRoot, requestedPath string) (string, error) { currentRoot = filepath.Clean(currentRoot) requestedDir, requestedFile := parsePath(requestedPath) if !isRequestedDirUnderCurrentRoot(currentRoot, requestedDir) { return "", fmt.Errorf("requested path %s should be on or under current directory %s", requestedPath, currentRoot) } return requestedDir + string(filepath.Separator) + requestedFile, nil}¬†func isRequestedDirUnderCurrentRoot(currentRoot, requestedPath string) bool { if currentRoot == string(filepath.Separator) { return true } else if currentRoot == requestedPath { return true } if requestedPath[len(requestedPath)-1] != '/' { requestedPath = requestedPath + "/" } if currentRoot[len(currentRoot)-1] != '/' { currentRoot = currentRoot + "/" } return strings.HasPrefix(requestedPath, currentRoot)}¬†func parsePath(path string) (string, string) { directory := filepath.Dir(path) if directory == path { return directory, "" } return directory, filepath.Base(path)} |
| --- | --- |

The functions in the code snippet above are in charge of cleanup (consisting mainly of [Go‚Äôs package filepath and its Clean()](https://pkg.go.dev/path/filepath#Clean) function) and check that the resulting cleaned-up version of the path matches the subdirectory of the current operating directory.

The function is used in Helm Chart processing under reposerver/repository/repository.go:

| 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364 | func helmTemplate(appPath string, repoRoot string, env \*v1alpha1.Env, q \*apiclient.ManifestRequest, isLocal bool) ([]\*unstructured.Unstructured, error) {¬†¬†¬†¬†concurrencyAllowed := isConcurrencyAllowed(appPath)¬†¬†¬†¬†if !concurrencyAllowed {¬†¬†¬†¬†¬†¬†¬†¬†manifestGenerateLock.Lock(appPath)¬†¬†¬†¬†¬†¬†¬†¬†defer manifestGenerateLock.Unlock(appPath)¬†¬†¬†¬†}¬†¬†¬†¬†¬†templateOpts := &amp;helm.TemplateOpts{¬†¬†¬†¬†¬†¬†¬†¬†Name:¬†¬†¬†¬†¬†¬†¬†¬†q.AppName,¬†¬†¬†¬†¬†¬†¬†¬†Namespace:¬†¬† q.Namespace,¬†¬†¬†¬†¬†¬†¬†¬†KubeVersion: text.SemVer(q.KubeVersion),¬†¬†¬†¬†¬†¬†¬†¬†APIVersions: q.ApiVersions,¬†¬†¬†¬†¬†¬†¬†¬†Set:¬†¬†¬†¬†¬†¬†¬†¬† map[string]string{},¬†¬†¬†¬†¬†¬†¬†¬†SetString:¬†¬† map[string]string{},¬†¬†¬†¬†¬†¬†¬†¬†SetFile:¬†¬†¬†¬† map[string]string{},¬†¬†¬†¬†}¬†¬†¬†¬†¬†appHelm := q.ApplicationSource.Helm¬†¬†¬†¬†var version string¬†¬†¬†¬†var passCredentials bool¬†¬†¬†¬†if appHelm != nil {¬†¬†¬†¬†¬†¬†¬†¬†if appHelm.Version != "" {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†version = appHelm.Version¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†if appHelm.ReleaseName != "" {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†templateOpts.Name = appHelm.ReleaseName¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†for \_, val := range appHelm.ValueFiles {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†// If val is not a URL, run it against the directory enforcer. If it is a URL, use it without checking¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†// If val does not exist, warn. If IgnoreMissingValueFiles, do not append, else let Helm handle it.¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if \_, err := url.ParseRequestURI(val); err != nil {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†// Ensure that the repo root provided is absolute¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†absRepoPath, err := filepath.Abs(repoRoot)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if err != nil {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†return nil, err¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†// If the path to the file is relative, join it with the current working directory (appPath)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†path := val¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if !filepath.IsAbs(path) {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†absWorkDir, err := filepath.Abs(appPath)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if err != nil {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†return nil, err¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†path = filepath.Join(absWorkDir, path)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†\_, err = security.EnforceToCurrentRoot(absRepoPath, path)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if err != nil {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†return nil, err¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†\_, err = os.Stat(path)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if os.IsNotExist(err) {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†if appHelm.IgnoreMissingValueFiles {¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†log.Debugf(" %s values file does not exist", path)¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†continue¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†}¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†templateOpts.Values = append(templateOpts.Values, val)¬†¬†¬†¬†¬†¬†¬†¬†} |
| --- | --- |

This function further inspects and relies on the returned values from the path\_traversal‚Äôs cleanup and current-directory matching for listed elements under the Chart‚Äôs *valueFiles* field. The field is supposed to contain a reference to the files within the **local** accompanying value files to be subsequently read and parsed into ingested values.

Here is a sample Argo CD manifest file with the valueFiles field present:

| 12345678910111213141516 | apiVersion: argoproj.io/v1alpha1kind: Applicationmetadata: name: testApplication namespace: argocdspec: destination:¬†¬† namespace: default¬†¬† server: https://kubernetes.default.svc project: default source:¬†¬†helm:¬†¬† valueFiles:¬†¬†¬†¬†¬†¬†- values.yaml¬†¬†path: src¬†¬†repoURL:¬†¬†https://github.com/[path\_to\_repo].git |
| --- | --- |

## So far so good, but‚Ä¶

While investigating the control flow and potential angles to attack the system, the Apiiro Security Research team paid special attention to the way the *valueFiles* values are evaluated and parsed by the application.

A crucial point of interaction is the preliminary check for input value content ‚Äì [the code searches for patterned string that will fit into the mold of a URI](https://github.com/argoproj/argo-cd/blob/96f95ca1c1048c37f935f6f72ff54be641d92b60/reposerver/repository/repository.go#L588) by utilizing a function called *ParseRequestURI.*

Looking deeper into this decisive point ‚Äì here is what the [official documentation](https://pkg.go.dev/net/url#ParseRequestURI) says about the function‚Äôs behavior:

*ParseRequestURI parses a raw url into a URL structure. It assumes that url was received in an HTTP request, so the url is interpreted only as an absolute URI or an absolute path. The string url is assumed not to have a #fragment suffix. (Web browsers strip #fragment before sending the URL to a web server.)*

So can we make the parser accept a local file-path and confuse it to be a URI, and use that confusion to skip the whole cleanup and anti-path-traversal mechanism check?

The answer is yes ‚Äì with a simple trick.

## If it walks like a URI

Deconstructing the sentence ‚ÄúIt assumes that url was received in an HTTP request, so the url is interpreted only as an absolute URI or an absolute path‚Äù reveals the Achilles‚Äô heel of the mechanism. Simply put: if the valueFiles listed are going to look like a URI, it will be treated as one, skipping all other checks and treating it as a legitimate URL.

Because the default behavior of the function is to take for granted that it receives an HTTP request,- it can be an absolute path of a URL like */directory/values.yaml* (take special notice of the prefixed backslash on the path).When looking at it as a URL, it passes the sanity test but is an absolute file-path.

Because the reposerver uses a monolithic and deterministic file-structure, all the other out-of-bound applications have a definite and predictable format and path.¬† An attacker can ssemble a concatenated, direct call to a specified values.yaml file, which is used by many applications as a vassal for secret and sensitive values.

## Impact

The impact of the vulnerability is two-fold:

First, there are the direct implications of contents read from other files present on the reposerver, which can contain sensitive information. This by itself can impact an organization.

Second, because application files usually contain an assortment of transitive values of secrets, tokens, and environmental sensitive settings ‚Äì this can effectively be used by the attacker to further expand their campaign by moving laterally through different services and escalating their privileges to gain more ground on the system and target organization‚Äôs resources.

## Technical designations

CVSS: 3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N ‚Äì Score 7.7 (High)

CVE-ID: CVE-2022-24348

## Acknowledgements

Apiiro‚Äôs Research Team would like to extend our gratitude to Argo CD‚Äôs swift incident response and professional handling of the case, for treating their large user-base with respect, and for understanding of the implications of the attack scenarios.

## Timeline

30-Jan-2022 : Vulnerability reported to vendor

30-Jan-2022 : Vendor verified and acknowledged the bug

31-Jan-2022 : Mutual continued triage to understand and discuss vulnerability‚Äôs extent and impact

01-Feb-2022 : Vendor reported on progressive work on patch and fix and release schedule

03-Feb-2022 : Synchronous release of advisories, patch, and blog

### Platform

* [Platform Overview](https://apiiro.com/platform/ "Overview")
* [ASPM Platform Overview](https://apiiro.com/product/aspm/)
* [Visibility & Risk Assessment](https://apiiro.com/product/application-software-supply-chain-inventory-risk-assessment/)
* [Prioritization & Remediation](https://apiiro.com/product/application-risk-prioritization-remediation/)
* [Governance & Assurance](https://apiiro.com/product/application-risk-management-governance-prevention/)

### Products

* [Apiiro Design](https://apiiro.com/product/aspm/)
* [Apiiro Develop](https://apiiro.com/product/aspm/)
* [Apiiro Deliver](https://apiiro.com/product/aspm/)

### Learn

* [Blog](https://apiiro.com/blog/)
* [Videos](https://apiiro.com/resources/videos/)
* [Guides](https://apiiro.com/resources/guides/)
* [Customers](https://apiiro.com/resources/case-studies/)

### Company

* [About Us](https://apiiro.com/company/)
* [Partners](https://apiiro.com/partners/)
* [Careers](https://apiiro.com/careers/)
* [News](https://apiiro.com/news-center/)
* [Trust Center](https://trust.apiiro.com/)
* [Contact Us](https://apiiro.com/contact-us/)

¬© 2024 Apiiro
[Privacy Policy](https://apiiro.com/privacy-policy/ "Privacy Policy")

[Terms of Use](https://apiiro.com/website-terms-of-use/ "Terms of Use")

[Cookie Policy](https://apiiro.com/cookie-policy/ "Cookie Policy")

![](https://apiiro.com/wp-content/themes/apiirov2/assets/img/cookie.png)
### Cookies Notice

This site uses cookies to deliver services and to analyze traffic.

Learn more

Okay, got it

![](https://px.ads.linkedin.com/collect/?pid=2816610&fmt=gif)



=== Content from github.com_78d86b24_20250115_100205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fargoproj%2Fargo-cd%2Fsecurity%2Fadvisories%2FGHSA-63qx-x74g-jcr7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fargoproj%2Fargo-cd%2Fsecurity%2Fadvisories%2FGHSA-63qx-x74g-jcr7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=argoproj%2Fargo-cd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[argoproj](/argoproj)
/
**[argo-cd](/argoproj/argo-cd)**
Public

* [Notifications](/login?return_to=%2Fargoproj%2Fargo-cd) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fargoproj%2Fargo-cd)
* [Star
   18.4k](/login?return_to=%2Fargoproj%2Fargo-cd)

* [Code](/argoproj/argo-cd)
* [Issues
  3.1k](/argoproj/argo-cd/issues)
* [Pull requests
  474](/argoproj/argo-cd/pulls)
* [Discussions](/argoproj/argo-cd/discussions)
* [Actions](/argoproj/argo-cd/actions)
* [Projects
  5](/argoproj/argo-cd/projects)
* [Wiki](/argoproj/argo-cd/wiki)
* [Security](/argoproj/argo-cd/security)
* [Insights](/argoproj/argo-cd/pulse)

Additional navigation options

* [Code](/argoproj/argo-cd)
* [Issues](/argoproj/argo-cd/issues)
* [Pull requests](/argoproj/argo-cd/pulls)
* [Discussions](/argoproj/argo-cd/discussions)
* [Actions](/argoproj/argo-cd/actions)
* [Projects](/argoproj/argo-cd/projects)
* [Wiki](/argoproj/argo-cd/wiki)
* [Security](/argoproj/argo-cd/security)
* [Insights](/argoproj/argo-cd/pulse)

# Path traversal and dereference of symlinks when passing Helm value files

High

[jannfis](/jannfis)
published
GHSA-63qx-x74g-jcr7
Feb 3, 2022

## Package

gomod

github.com/argoproj/argo-cd
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

All versions

## Patched versions

2.3.0, 2.2.4, 2.1.9

## Description

### Impact

All versions of Argo CD are vulnerable to a path traversal bug that allows to pass arbitrary values files to be consumed by Helm charts.

Additionally, it is possible to craft special Helm chart packages containing value files that are actually symbolic links, pointing to arbitrary files outside the repository's root directory.

If an attacker with permissions to create or update Applications knows or can guess the full path to a file containing valid YAML, they can create a malicious Helm chart to consume that YAML as values files, thereby gaining access to data they would otherwise have no access to.

The impact can especially become critical in environments that make use of encrypted value files (e.g. using plugins with git-crypt or SOPS) containing sensitive or confidential data, and decrypt these secrets to disk before rendering the Helm chart.

Also, because any error message from `helm template` is passed back to the user, and these error messages are quite verbose, enumeration of files on the repository server's file system is possible.

### Patches

A patch for this vulnerability has been released in the following Argo CD versions:

* v2.3.0
* v2.2.4
* v2.1.9

We urge users of Argo CD to update their installation to one of the fixed versions as listed above.

### Workarounds

No workaround for this issue.

### References

* <https://apiiro.com/blog/malicious-kubernetes-helm-charts-can-be-used-to-steal-sensitive-information-from-argo-cd-deployments>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24348>

### For more information

* Open an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)
* Join us on [Slack](https://argoproj.github.io/community/join-slack) in channel `#argo-cd`

### Credits

The path traversal vulnerability was discovered and reported by Moshe Zioni, VP Security Research, [Apiiro](https://www.apiiro.com).

During the development of a fix for the path traversal vulnerability, the Argo CD team discovered the related issue with symbolic links.

The Argo CD team would like to thank Moshe Zioni for the responsible disclosure, and the constructive discussions during handling this issue!

### Severity

High

7.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N

### CVE ID

CVE-2022-24348

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22) [CWE-200](/advisories?query=cwe%3A200)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


