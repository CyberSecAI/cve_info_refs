The provided content is related to CVE-2022-24335.

**Root cause of vulnerability:**
- Time-of-check/Time-of-use (TOCTOU) vulnerability during agent registration via XML-RPC in TeamCity.

**Weaknesses/vulnerabilities:**
- TOCTOU vulnerability: A race condition exists where the state of a system is checked and then acted upon, but the state might change in between, leading to unexpected behavior. Specifically, during agent registration via XML-RPC, there's a window of opportunity where an attacker can interfere.

**Impact of exploitation:**
- A successful exploit of this vulnerability could allow an attacker to potentially manipulate or compromise the agent registration process, leading to unauthorized access, data manipulation, or denial of service. The details of the specific impact are not clearly described, but the TOCTOU vulnerability could be leveraged to potentially execute code on the server or disrupt its operation by registering malicious agents.

**Attack vectors:**
- The vulnerability is exploitable through the XML-RPC interface during the agent registration process. This means an attacker would need to interact with this specific interface to trigger the race condition.

**Required attacker capabilities/position:**
- An attacker needs to be able to interact with the TeamCity server's XML-RPC interface. The specific requirements such as authentication or pre-existing access are not mentioned, but it is implied that the attacker needs to be able to initiate agent registration or interfere with an ongoing registration.

**Additional details:**
- The vulnerability was reported by Artem Godin (TW-73468).
- It was resolved in TeamCity version 2021.2.