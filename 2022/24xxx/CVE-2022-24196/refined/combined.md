=== Content from github.com_50053365_20250115_204421.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fcommit%2F321336392695ead6f071cb60240956282d254782)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fcommit%2F321336392695ead6f071cb60240956282d254782)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=itext%2Fitext-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[itext](/itext)
/
**[itext-java](/itext/itext-java)**
Public

* [Notifications](/login?return_to=%2Fitext%2Fitext-java) You must be signed in to change notification settings
* [Fork
  457](/login?return_to=%2Fitext%2Fitext-java)
* [Star
   2.1k](/login?return_to=%2Fitext%2Fitext-java)

* [Code](/itext/itext-java)
* [Pull requests
  73](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects
  0](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

Additional navigation options

* [Code](/itext/itext-java)
* [Pull requests](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

## Commit

[Permalink](/itext/itext-java/commit/321336392695ead6f071cb60240956282d254782)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix OOM on reading raw bytes stream

[Browse files](/itext/itext-java/tree/321336392695ead6f071cb60240956282d254782)
Browse the repository at this point in the history

```
DEVSIX-6244
```

* Loading branch information

Egor Martsynkovsky
authored and
Ubuntu
committed
Feb 16, 2022

1 parent
[a9af64d](/itext/itext-java/commit/a9af64d404f47031ce2c551abf31fa781df0ac64)

commit 3213363

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**64 additions**
and
**20 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* kernel/src

  + main/java/com/itextpdf/kernel

    - exceptions

      * kernel/src/main/java/com/itextpdf/kernel/exceptions/KernelExceptionMessageConstant.java
        [KernelExceptionMessageConstant.java](#diff-120e034364970bcf62a486e4d38680949b99f1a24c370a98a081be6998f65615)
    - pdf

      * kernel/src/main/java/com/itextpdf/kernel/pdf/PdfReader.java
        [PdfReader.java](#diff-f6dd65f63d737a942f2e8faebb3f922bebd3ac02bc60d1d0f09e5e07501bb042)
  + test

    - java/com/itextpdf/kernel/pdf

      * kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderDecodeTest.java
        [PdfReaderDecodeTest.java](#diff-186f4dbe38e412ecf12ba265c8bd7aa85479f07468df497b4c551b90fdc39ca7)
      * kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderTest.java
        [PdfReaderTest.java](#diff-781962bfc478bb016e04ef6ce2fec0b85c19e0d3d833940a5d29142fbc7dc1e5)
    - resources/com/itextpdf/kernel/pdf/PdfReaderTest

      * kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/CompressionWrongObjStm.pdf
        [CompressionWrongObjStm.pdf](#diff-6279fdbf3d76fcac16b00b69552e6021bf4bd83f973ce2039d508887492b63c6)
      * kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/NoEndstreamKeyword.pdf
        [NoEndstreamKeyword.pdf](#diff-5f0b37f35e5f93877e731d7fa6494a329427afbab4065d7fbbb7c359c1fd4c85)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[kernel/src/main/java/com/itextpdf/kernel/exceptions/KernelExceptionMessageConstant.java](#diff-120e034364970bcf62a486e4d38680949b99f1a24c370a98a081be6998f65615 "kernel/src/main/java/com/itextpdf/kernel/exceptions/KernelExceptionMessageConstant.java")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/main/java/com/itextpdf/kernel/exceptions/KernelExceptionMessageConstant.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -271,6 +271,7 @@ public final class KernelExceptionMessageConstant { |
|  |  | + "do not contain ExtGState entry. Unable to process operator {0}."; |
|  |  | public static final String SHADING\_TYPE\_NOT\_FOUND = "Shading type not found."; |
|  |  | public static final String STDCF\_NOT\_FOUND\_ENCRYPTION = "/StdCF not found (encryption)"; |
|  |  | public static final String STREAM\_SHALL\_END\_WITH\_ENDSTREAM = "Stream shall end with endstream keyword."; |
|  |  | public static final String STRUCT\_PARENT\_INDEX\_NOT\_FOUND\_IN\_TAGGED\_OBJECT = "StructParent index not found in " |
|  |  | + "tagged object."; |
|  |  | public static final String STRUCTURE\_ELEMENT\_IN\_STRUCTURE\_DESTINATION\_SHALL\_BE\_AN\_INDIRECT\_OBJECT = "Structure " |
| Expand Down | |  |

14 changes: 9 additions & 5 deletions

14
[kernel/src/main/java/com/itextpdf/kernel/pdf/PdfReader.java](#diff-f6dd65f63d737a942f2e8faebb3f922bebd3ac02bc60d1d0f09e5e07501bb042 "kernel/src/main/java/com/itextpdf/kernel/pdf/PdfReader.java")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/main/java/com/itextpdf/kernel/pdf/PdfReader.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -382,8 +382,9 @@ public byte[] readStreamBytes(PdfStream stream, boolean decode) throws IOExcepti |
|  |  | \*/ |
|  |  | public byte[] readStreamBytesRaw(PdfStream stream) throws IOException { |
|  |  | PdfName type = stream.getAsName(PdfName.Type); |
|  |  | if (!PdfName.XRefStm.equals(type) && !PdfName.ObjStm.equals(type)) |
|  |  | if (!PdfName.XRef.equals(type) && !PdfName.ObjStm.equals(type)) { |
|  |  | checkPdfStreamLength(stream); |
|  |  | } |
|  |  | long offset = stream.getOffset(); |
|  |  | if (offset <= 0) |
|  |  | return null; |
| Expand All | | @@ -393,7 +394,7 @@ public byte[] readStreamBytesRaw(PdfStream stream) throws IOException { |
|  |  | RandomAccessFileOrArray file = tokens.getSafeFile(); |
|  |  | byte[] bytes = null; |
|  |  | try { |
|  |  | file.seek(stream.getOffset()); |
|  |  | file.seek(offset); |
|  |  | bytes = new byte[length]; |
|  |  | file.readFully(bytes); |
|  |  | boolean embeddedStream = pdfDocument.doesStreamBelongToEmbeddedFile(stream); |
| Expand Down  Expand Up | | @@ -1461,21 +1462,24 @@ private void checkPdfStreamLength(PdfStream pdfStream) throws IOException { |
|  |  | line.reset(); |
|  |  |  |
|  |  | // added boolean because of mailing list issue (17 Feb. 2014) |
|  |  | if (!tokens.readLineSegment(line, false)) |
|  |  | if (!tokens.readLineSegment(line, false)) { |
|  |  | if (!StrictnessLevel.CONSERVATIVE.isStricter(this.strictnessLevel)) { |
|  |  | throw new PdfException(KernelExceptionMessageConstant.STREAM\_SHALL\_END\_WITH\_ENDSTREAM); |
|  |  | } |
|  |  | break; |
|  |  | } |
|  |  | if (line.startsWith(endstream)) { |
|  |  | streamLength = (int) (pos - start); |
|  |  | break; |
|  |  | } else if (line.startsWith(endobj)) { |
|  |  | tokens.seek(pos - 16); |
|  |  | String s = tokens.readString(16); |
|  |  | int index = s.indexOf(endstream1); |
|  |  | if (index >= 0) |
|  |  | pos = pos - 16 + index; |
|  |  | streamLength = (int) (pos - start); |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | streamLength = (int) (pos - start); |
|  |  | tokens.seek(pos - 2); |
|  |  | if (tokens.read() == 13) { |
|  |  | streamLength--; |
| Expand Down | |  |

29 changes: 14 additions & 15 deletions

29
[kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderDecodeTest.java](#diff-186f4dbe38e412ecf12ba265c8bd7aa85479f07468df497b4c551b90fdc39ca7 "kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderDecodeTest.java")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderDecodeTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,12 +60,12 @@ This file is part of the iText (R) project. |
|  |  | @Category(IntegrationTest.class) |
|  |  | public class PdfReaderDecodeTest extends ExtendedITextTest { |
|  |  |  |
|  |  | public static final String sourceFolder = "./src/test/resources/com/itextpdf/kernel/pdf/PdfReaderDecodeTest/"; |
|  |  | public static final String SOURCE\_FOLDER = "./src/test/resources/com/itextpdf/kernel/pdf/PdfReaderDecodeTest/"; |
|  |  |  |
|  |  | @Test |
|  |  | public void noMemoryHandlerTest() throws IOException { |
|  |  | try (PdfDocument pdfDocument = new PdfDocument(new PdfWriter(new ByteArrayOutputStream())); |
|  |  | FileInputStream is = new FileInputStream(sourceFolder + "stream")) { |
|  |  | FileInputStream is = new FileInputStream(SOURCE\_FOLDER + "stream")) { |
|  |  | byte[] b = new byte[51]; |
|  |  | is.read(b); |
|  |  |  |
| Expand Down  Expand Up | | @@ -98,7 +98,7 @@ public void noMemoryHandlerTest() throws IOException { |
|  |  | }) |
|  |  | public void defaultMemoryHandlerTest() throws IOException { |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf"), |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf"), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  | PdfStream stream = pdfDocument.getFirstPage().getContentStream(0); |
|  |  | byte[] b = stream.getBytes(false); |
| Expand Down  Expand Up | | @@ -129,7 +129,7 @@ public void customMemoryHandlerSingleTest() throws IOException { |
|  |  | handler.setMaxSizeOfSingleDecompressedPdfStream(1000); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand Down  Expand Up | | @@ -166,7 +166,7 @@ public void oneFilterCustomMemoryHandlerSingleTest() throws IOException { |
|  |  | handler.setMaxSizeOfSingleDecompressedPdfStream(20); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand All | | @@ -176,10 +176,10 @@ public void oneFilterCustomMemoryHandlerSingleTest() throws IOException { |
|  |  | PdfArray array = new PdfArray(); |
|  |  | stream.put(PdfName.Filter, array); |
|  |  |  |
|  |  | // Limit is reached, but the stream has no filters. Therefore we don't consider ot to be suspicious |
|  |  | // Limit is reached, but the stream has no filters. Therefore, we don't consider it to be suspicious. |
|  |  | Assert.assertEquals(51, PdfReader.decodeBytes(b, stream).length); |
|  |  |  |
|  |  | // Limit is reached, but the stream has only one filter. Therefore we don't consider ot to be suspicious |
|  |  | // Limit is reached, but the stream has only one filter. Therefore, we don't consider it to be suspicious. |
|  |  | array.add(PdfName.Fl); |
|  |  | Assert.assertEquals(40, PdfReader.decodeBytes(b, stream).length); |
|  |  | } |
| Expand All | | @@ -200,7 +200,7 @@ public boolean isMemoryLimitsAwarenessRequiredOnDecompression(PdfArray filters) |
|  |  | handler.setMaxSizeOfSingleDecompressedPdfStream(20); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand All | | @@ -211,7 +211,7 @@ public boolean isMemoryLimitsAwarenessRequiredOnDecompression(PdfArray filters) |
|  |  | stream.put(PdfName.Filter, array); |
|  |  | array.add(PdfName.Fl); |
|  |  |  |
|  |  | // Limit is reached, and the stream with one filter is considered to be suspicious |
|  |  | // Limit is reached, and the stream with one filter is considered to be suspicious. |
|  |  | Exception e = Assert.assertThrows(MemoryLimitsAwareException.class, |
|  |  | () -> PdfReader.decodeBytes(b, stream) |
|  |  | ); |
| Expand All | | @@ -235,7 +235,7 @@ public boolean isMemoryLimitsAwarenessRequiredOnDecompression(PdfArray filters) |
|  |  | handler.setMaxSizeOfSingleDecompressedPdfStream(20); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand All | | @@ -247,8 +247,7 @@ public boolean isMemoryLimitsAwarenessRequiredOnDecompression(PdfArray filters) |
|  |  | array.add(PdfName.Fl); |
|  |  | array.add(PdfName.Fl); |
|  |  |  |
|  |  | // Limit is reached but the stream with several copies of the filter is not considered |
|  |  | // to be suspicious |
|  |  | // Limit is reached but the stream with several copies of the filter is not considered to be suspicious. |
|  |  | PdfReader.decodeBytes(b, stream); |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -279,7 +278,7 @@ public void customMemoryHandlerSumTest() throws IOException { |
|  |  | handler.setMaxSizeOfDecompressedPdfStreamsSum(100000); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand All | | @@ -303,7 +302,7 @@ public void pageSumTest() throws IOException { |
|  |  | handler.setMaxSizeOfDecompressedPdfStreamsSum(1500000); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand All | | @@ -324,7 +323,7 @@ public void pageAsSingleStreamTest() throws IOException { |
|  |  | handler.setMaxSizeOfSingleDecompressedPdfStream(1500000); |
|  |  |  |
|  |  | try (PdfDocument pdfDocument = new PdfDocument( |
|  |  | new PdfReader(sourceFolder + "timing.pdf", |
|  |  | new PdfReader(SOURCE\_FOLDER + "timing.pdf", |
|  |  | new ReaderProperties().setMemoryLimitsAwareHandler(handler)), |
|  |  | new PdfWriter(new ByteArrayOutputStream()))) { |
|  |  |  |
| Expand Down | |  |

40 changes: 40 additions & 0 deletions

40
[kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderTest.java](#diff-781962bfc478bb016e04ef6ce2fec0b85c19e0d3d833940a5d29142fbc7dc1e5 "kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderTest.java")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/test/java/com/itextpdf/kernel/pdf/PdfReaderTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,6 +57,7 @@ This file is part of the iText (R) project. |
|  |  | import com.itextpdf.kernel.exceptions.XrefCycledReferencesException; |
|  |  | import com.itextpdf.kernel.pdf.PdfReader.StrictnessLevel; |
|  |  | import com.itextpdf.kernel.utils.CompareTool; |
|  |  | import com.itextpdf.kernel.xmp.XMPException; |
|  |  | import com.itextpdf.test.AssertUtil; |
|  |  | import com.itextpdf.test.ExtendedITextTest; |
|  |  | import com.itextpdf.test.annotations.LogMessage; |
| Expand Down  Expand Up | | @@ -2518,6 +2519,45 @@ public void readPdfInvalidPrevConservativeModeTest() throws IOException { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void streamWithoutEndstreamKeywordTest() throws IOException, XMPException { |
|  |  | final String fileName = SOURCE\_FOLDER + "NoEndstreamKeyword.pdf"; |
|  |  | try (PdfReader reader = new PdfReader(fileName)) { |
|  |  | reader.setStrictnessLevel(StrictnessLevel.LENIENT); |
|  |  | try (PdfDocument document = new PdfDocument(reader)) { |
|  |  | final PdfCatalog catalog = new PdfCatalog((PdfDictionary) reader.trailer |
|  |  | .get(PdfName.Root, true)); |
|  |  | final PdfStream xmpMetadataStream = catalog.getPdfObject().getAsStream(PdfName.Metadata); |
|  |  | final int xmpMetadataStreamLength = ((PdfNumber) xmpMetadataStream.get(PdfName.Length)).intValue(); |
|  |  |  |
|  |  | // 27600 is actual invalid length of stream. In reader StrictnessLevel#LENIENT we expect, that this |
|  |  | // length will be fixed. |
|  |  | Assert.assertNotEquals(27600, xmpMetadataStreamLength); |
|  |  |  |
|  |  | // 3090 is expected length of the stream after fix. |
|  |  | Assert.assertEquals(3090, xmpMetadataStreamLength); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void streamWithoutEndstreamKeywordConservativeModeTest() throws IOException, XMPException { |
|  |  | final String fileName = SOURCE\_FOLDER + "NoEndstreamKeyword.pdf"; |
|  |  | try (PdfReader reader = new PdfReader(fileName)) { |
|  |  | reader.setStrictnessLevel(StrictnessLevel.CONSERVATIVE); |
|  |  |  |
|  |  | Exception exception = Assert.assertThrows(PdfException.class, () -> new PdfDocument(reader)); |
|  |  | Assert.assertEquals(KernelExceptionMessageConstant.STREAM\_SHALL\_END\_WITH\_ENDSTREAM, exception.getMessage()); |
|  |  |  |
|  |  | PdfCatalog catalog = new PdfCatalog((PdfDictionary) reader.trailer.get(PdfName.Root, true)); |
|  |  | PdfStream xmpMetadataStream = catalog.getPdfObject().getAsStream(PdfName.Metadata); |
|  |  |  |
|  |  | // 27600 is actual invalid length of stream. In reader StrictnessLevel#CONSERVATIVE we expect, that |
|  |  | // exception would be thrown and length wouldn't be fixed. |
|  |  | Assert.assertEquals(27600, ((PdfNumber) xmpMetadataStream.get(PdfName.Length)).intValue()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Returns the current memory use. |
|  |  | \* |
| Expand Down | |  |

Binary file modified
BIN
+1 Byte
(100%)

[kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/CompressionWrongObjStm.pdf](#diff-6279fdbf3d76fcac16b00b69552e6021bf4bd83f973ce2039d508887492b63c6 "kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/CompressionWrongObjStm.pdf")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/CompressionWrongObjStm.pdf)
Edit file

Delete file

Binary file not shown.

Binary file added
BIN
+3.55 KB

[kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/NoEndstreamKeyword.pdf](#diff-5f0b37f35e5f93877e731d7fa6494a329427afbab4065d7fbbb7c359c1fd4c85 "kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/NoEndstreamKeyword.pdf")

Show comments

[View file](/itext/itext-java/blob/321336392695ead6f071cb60240956282d254782/kernel/src/test/resources/com/itextpdf/kernel/pdf/PdfReaderTest/NoEndstreamKeyword.pdf)
Edit file

Delete file

Binary file not shown.

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3213363`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fcommit%2F321336392695ead6f071cb60240956282d254782) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from adobe-type-tools.github.io_de9bf1a0_20250115_204416.html ===
POST C IPRS
T
Software Fro
m Ad bo
e

R

The Compact Font Format
Specification
Adobe Developer Support

Technical Note #5176

Version 1.0

4 December 2003

Adobe Systems Incorporated

Corporate Headquarters
1585 Charleston Road PO Box 7900
Mountain View, CA 94039-7900
(415) 961-4400 Main Number
(415) 961-4111 Developer Support
Fax: (415) 969-4138

European Engineering Support Group
Adobe Systems Benelux B.V.
P.O. Box 22750
1100 DG Amsterdam
PN LPS5176
The Netherlands
+31-20-6511 355
Fax: +31-20-6511 313

Adobe Systems Eastern Region
24 New England
Executive Park
Burlington, MA  01803
(617) 273-2120
Fax: (617) 273-2336

Adobe Systems Co., Ltd.
Yebisu Garden Place Tower
4-20-3 Ebisu, Shibuya-ku
Tokyo 150
Japan
+81-3-5423-8169
Fax: +81-3-5423-8204

Copyright © 1996–1998, 2000, 2003 by Adobe Systems Incorporated. All rights reserved.

No part of this publication may be reproduced, stored in a retrieval system, or transmit-
ted, in any form or by any means, electronic, mechanical, photocopying, recording, or
otherwise, without the prior written consent of the publisher.

PostScript is a trademark of Adobe Systems Incorporated. All instances of the name Post-
Script in the text are references to the PostScript language as defined by Adobe Systems
Incorporated unless otherwise stated. The name PostScript also is used as a product
trademark for Adobe Systems’ implementation of the PostScript language interpreter.

Any references to a “PostScript printer,” a “PostScript file,” or a “PostScript driver” refer
to printers, files, and driver programs (respectively) which are written in or support the
PostScript language. The sentences in this book that use “PostScript language” as an
adjective phrase are so constructed to reinforce that the name refers to the standard
language definition as set forth by Adobe Systems Incorporated.

Adobe, Adobe Type Manager, ATM, PostScript and the PostScript logo are trademarks
of Adobe Systems Incorporated which may be registered in certain jurisdictions. Apple
and Macintosh are registered trademarks and QuickDraw and TrueType are trademarks
of Apple Computer Incorporated. Microsoft and Windows are registered trademarks of
Microsoft Corporation. Times is a registered trademark of Linotype-Hell AG and/or its
subsidiaries. All other brand or product names are the trademarks or registered trade-
marks of their respective holders.

This publication and the information herein is furnished AS IS, is subject to change with-
out notice, and should not be construed as a commitment by Adobe Systems Incorpo-
rated. Adobe Systems Incorporated assumes no responsibility or liability for any errors
or inaccuracies, makes no warranty of any kind (express, implied or statutory) with
respect to this publication, and expressly disclaims any and all warranties of merchant-
ability, fitness for particular purposes and noninfringement of third party rights.

Contents

The Compact Font Format Specification  7

1

Introduction  7

2 Data Layout  7

3 Data Types  8

4 DICT Data  9

5

INDEX Data  12

6 Header  13

7 Name INDEX  13

8

9

Top DICT INDEX  14

Top DICT Data  14

10 String INDEX  17

11 Glyph Organization  18

12 Encodings  18

13 Charsets  21

14 CharStrings INDEX  23

15 Private DICT Data  23

16

Local/Global Subrs INDEXes  25

17 Synthetic Fonts  27

18 CID-keyed Fonts  27

19

FDSelect  28

5

Appendix A

Standard Strings  31

Appendix B

Predefined Encodings  37

Appendix C

Predefined Charsets  45

Appendix D

Example CFF Font  51

Appendix E

PostScript File Structure  53

Appendix F

Embedded PostScript  55

Appendix G

Related Documentation  57

Appendix H

CFF DICT Encoding  59

Appendix I

Changes Since Earlier Versions  61

6

(4 Dec 03)

The Compact Font Format
Specification

1 Introduction

This document describes the specification of a font format that
is suitable for compactly representing one or more Type 1 or
CID-keyed fonts. Unlike previous Type 1 and CID-keyed font
formats, CFF allows multiple fonts to be stored together in a
unit called a FontSet. Principal space savings are a result of using
a compact binary representation for most of the information,
sharing of common data between fonts, and defaulting
frequently occurring data.

The CFF format is designed to be used in conjunction with
Type 2 charstrings for the character description procedures (see
Adobe Technical Note #5177: “The Type 2 Charstring Format”).

The design supports the embedding of PostScript® language
code which permits additional flexibility and extensibility of the
format when used in printer environments (see Appendix E).

2 Data Layout

Conceptually the binary data is organized as a number of
separate data structures. The overall layout within the binary
data is shown Table 1. Since some of these data structures are
reached via offsets the ordering could be changed, although the
first five occupy fixed locations.

7

Table 1 CFF Data Layout

Entry

Header

Name INDEX

Top DICT INDEX

String INDEX

Global Subr INDEX

Encodings

Charsets

FDSelect

Comments

–

–

–

–

–

–

–

CIDFonts only

CharStrings INDEX

per-font

Font DICT INDEX

per-font, CIDFonts only

Private DICT

per-font

Local Subr INDEX

per-font or per-Private DICT for CIDFonts

Copyright and
Trademark Notices

–

Appendix D shows an annotated example of a CFF font.

3 Data Types

This section describes data representation and types used by the
format.

All multi-byte numeric data and offset fields are stored in big-
endian byte order (high byte low offset) and do not honor any
alignment restrictions. This leads to a format that is free from
padding bytes.

Data objects are often specified by byte offsets that are relative
to some reference point within the CFF data. These offsets are 1
to 4 bytes in length. This document uses the convention of
enclosing the reference point in parentheses and uses a
reference point of (0) to indicate an offset relative to the start
of the CFF data and (self) to indicate an offset relative to the
data structure containing the offset.

8

The Compact Font Format Specification

(4 Dec 03)

The CFF format data types are shown in Table 2.

Table 2 CFF Data Types

Name

Range

Description

Card8

0 – 255

1-byte unsigned number

Card16

0 – 65535

2-byte unsigned number

Offset

varies

OffSize

1– 4

1, 2, 3, or 4 byte offset (specified by
OffSize field)

1-byte unsigned number specifies the
size of an Offset field or fields

SID

0 – 64999

2-byte string identifier

This document describes data structures by listing field types,
names, and descriptions. Data structures may be given a type
name and subsequently described. Arrays of objects are
indicated by the usual square bracket convention enclosing the
array length.

The majority of CFF data is contained by either of two data
structures called DICT and INDEX which are described in
subsequent sections.

4 DICT Data

Font dictionary data comprising key-value pairs is represented
in a compact tokenized format that is similar to that used to
represent Type 1 charstrings. Dictionary keys are encoded as 1-
or 2-byte operators and dictionary values are encoded as
variable-size numeric operands that represent either integer or
real values. An operator is preceded by the operand(s) that
specify its value. A DICT is simply a sequence of
operand(s)/operator bytes concatenated together.

A number of integer operand types of varying sizes are defined
and are encoded as shown in Table 3 (first byte of operand is b0,

4  DICT Data

 9

second is b1, and so on).

Table 3 Operand Encoding

Size

b0 range

Value range

Value calculation

1

2

2

3

5

32

– 246

–107

– +107

b0–139

247

– 250

+108

– +1131

(b0–247)*256+b1+108

251

– 254

–1131

– –108

–(b0–251)*256–b1–108

28

29

–32768

– +32767

b1<<8|b2

–(2^31)

– +(2^31–1) b1<<24|b2<<16|b3<<8|b4

Note 1

The 1- , 2-, and 3- byte integer formats are identical to those used by
Type 2 charstrings.

Examples of the integer formats are shown in Table 4.

Table 4 Integer Format Examples

Value

Encoding

0

8b

100

ef

–100

27

1000

fa 7c

–1000

fe 7c

10000

1c 27 10

 –10000

1c d8 f0

 100000

1d 00 01 86 a0

–100000

1d ff fe 79 60

A real number operand is provided in addition to integer
operands. This operand begins with a byte value of 30 followed
by a variable-length sequence of bytes. Each byte is composed
of two 4-bit nibbles as defined in Table 5. The first nibble of a
pair is stored in the most significant 4 bits of a byte and the
second nibble of a pair is stored in the least significant 4 bits of

10

The Compact Font Format Specification

(4 Dec 03)

a byte.

Table 5 Nibble Definitions

Nibble

Represents

0 – 9

a

b

c

d

e

f

0 – 9

. (decimal point)

E

E–

<reserved>

– (minus)

end of number

A real number is terminated by one (or two) 0xf nibbles so that
it is always padded to a full byte. Thus, the value –2.25 is
encoded by the byte sequence (1e e2 a2 5f) and the value
0.140541E–3 by the sequence (1e 0a 14 05 41 c3 ff).

Operators and operands may be distinguished by inspection of
their first byte: 0–21 specify operators and 28, 29, 30, and
32–254 specify operands (numbers). Byte values 22–27, 31, and
255 are reserved. An operator may be preceded by up to a
maximum of 48 operands.

An operator may have one or more operands of the types
shown in Table 6.

Table 6 Operand Types

Type

number

boolean

SID

array

delta

Description

Integer or real number

Integer type with the values 0 (false) and 1 (true)

String id (see section 10)

One or more numbers

A number or a delta-encoded array of numbers
(see below)

The length of array or delta types is determined by counting the
operands preceding the operator. The second and subsequent
numbers in a delta are encoded as the difference between

4  DICT Data

 11

successive values. For example, an array a0, a1, ..., an would be
encoded as: a0 (a1–a0) (a2–a1) ..., (an–a(n–1)).

Two-byte operators have an initial escape byte of 12.

Further compaction of dictionary data is achieved by
establishing default values for various DICT keys. For those keys
that have a default value the absence of the corresponding
operator in a DICT implies a key should take its default value.

(A list of DICT operators for the Top and Private DICTs may be
found in sections 9 and 15, respectively.)

5 INDEX Data

An INDEX is an array of variable-sized objects. It comprises a
header, an offset array, and object data. The offset array
specifies offsets within the object data. An object is retrieved by
indexing the offset array and fetching the object at the
specified offset. The object’s length can be determined by
subtracting its offset from the next offset in the offset array. An
additional offset is added at the end of the offset array so the
length of the last object may be determined. The INDEX format
is shown in Table 7.

Table 7 INDEX Format

Type

Name

Description

Card16

count

Number of objects stored in INDEX

OffSize

offSize

Offset array element size

Offset

Card8

offset
[count+1]

data
[<varies>]

Offset array (from byte preceding
object data)

Object data

Offsets in the offset array are relative to the byte that precedes
the object data. Therefore the first element of the offset array
is always 1. (This ensures that every object has a corresponding
offset which is always nonzero and permits the efficient
implementation of dynamic object loading.)

An empty INDEX is represented by a count field with a 0 value

12

The Compact Font Format Specification

(4 Dec 03)

and no additional fields. Thus, the total size of an empty INDEX
is 2 bytes.

Note 2 An INDEX may be skipped by jumping to the offset specified by the last

element of the offset array.

6 Header

The binary data begins with a header having the format shown
in Table 8.

Table 8 Header Format

Type

Card8

Card8

Card8

Name

major

minor

Description

Format major version (starting at 1)

Format minor version (starting at 0)

hdrSize

Header size (bytes)

OffSize

offSize

Absolute offset (0) size

Implementations reading font set files must include code to
check version numbers so that if and when the format and
therefore the version number changes, older implementations
will reject newer versions gracefully. If the major version
number is understood by an implementation it can safely
proceed with reading the font. The minor version number
indicates extensions to the format that are undetectable by
implementations that do not support them although they will
be unable to take advantage of these extensions.

The hdrSize field must be used when locating the Name INDEX.
It is provided so that future versions of the format may
introduce additional data between the offSize field and the
Name INDEX in a manner that is compatible with older
implementations.

The offSize field specifies the size of all offsets (0) relative to the
start of CFF data.

7 Name INDEX

This contains the PostScript language names (FontName or
CIDFontName) of all the fonts in the FontSet stored in an INDEX
structure. The font names are sorted, thereby permitting a

6  Header

 13

binary search to be performed when locating a specific font
within a FontSet. The sort order is based on character codes
treated as 8-bit unsigned integers. A given font name precedes
another font name having the first name as its prefix. There
must be at least one entry in this INDEX, i.e. the FontSet must
contain at least one font.

For compatibility with client software, such as PostScript
interpreters and Acrobat®, font names should be no longer
than 127 characters and should not contain any of the following
ASCII characters: [, ], (, ), {, }, <, >, /, %, null (NUL), space, tab,
carriage return, line feed, form feed. It is recommended that
font names be restricted to the printable ASCII subset, codes 33
through 126. Adobe Type Manager® (ATM®) software imposes
a further restriction on the font name length of 63 characters.

Note 3

For compatibility with earlier PostScript interpreters, see Technical Note
#5088, “Font Naming Issues.”

A font may be deleted from a FontSet without removing its data
by setting the first byte of its name in the Name INDEX to 0
(NUL). This kind of deletion offers a simple way to handle font
upgrades without rebuilding entire fontsets. Binary search
software must detect deletions and restart the search at the
previous or next name in the INDEX to ensure that all
appropriate names are matched.

8 Top DICT INDEX

This contains the top-level DICTs of all the fonts in the FontSet
stored in an INDEX structure. Objects contained within this
INDEX correspond to those in the Name INDEX in both order
and number. Each object is a DICT structure that corresponds to
the top-level dictionary of a PostScript font.

A font is identified by an entry in the Name INDEX and its data
is accessed via the corresponding Top DICT.

9 Top DICT Data

The names of the Top DICT operators shown in Table 9 are,
where possible, the same as the corresponding Type 1 dict key.
Operators that have no corresponding Type 1 dict key are noted
in the table below along with a default value, if any. (Several

14

The Compact Font Format Specification

(4 Dec 03)

operators have been derived from FontInfo dict keys but have
been grouped together with the Top DICT operators for
simplicity. The keys from the FontInfo dict are indicated in the
Default,notes column of Table 9.)

Table 9 Top DICT Operator Entries

Name

version

Notice

Copyright

FullName

FamilyName

Weight

isFixedPitch

ItalicAngle

UnderlinePosition

Value Operand(s)

Default, notes

0

1

12 0

2

3

4

12 1

12 2

12 3

SID

SID

SID

SID

SID

SID

–, FontInfo

–, FontInfo

–, FontInfo

–, FontInfo

–, FontInfo

–, FontInfo

boolean

0 (false), FontInfo

number

0, FontInfo

number

–100, FontInfo

UnderlineThickness

12 4

number

50, FontInfo

PaintType

CharstringType

FontMatrix

UniqueID

FontBBox

12 5

12 6

12 7

13

5

number

number

0

2

array

0.001 0 0 0.001 0 0

number

–

array

0 0 0 0

StrokeWidth

12 8

number

array

0

–

XUID

charset

Encoding

CharStrings

Private

14

15

16

17

18

number

0, charset offset (0)

number

0, encoding offset (0)

number

–, CharStrings offset
(0)

number
number

–, Private DICT size
and offset (0)

SyntheticBase

12 20

number

PostScript

12 21

SID

–, synthetic base font
index

–, embedded
PostScript language
code

9  Top DICT Data

 15

Table 9 Top DICT Operator Entries (continued)

Name

Value Operand(s)

Default, notes

BaseFontName

12 22

SID

BaseFontBlend

12 23

delta

–, (added as needed
by Adobe-based
technology)

–, (added as needed
by Adobe-based
technology)

The embedded PostScript operator provides an escape
mechanism that may be used to address extensibility or
compatibility issues in a printer font (see Appendix F).

The separation of dictionary data into top-level and Private
dictionaries reflects Type 1 usage where Top DICT data is parsed
at findfont time and used to construct a valid Type 1 font
dictionary. The Private operator value specifies a size and an
offset that is followed at font rendering time in order to
construct the data structures associated with Private DICT data.

The operators BaseFontName and BaseFontBlend are added to
multiple master font instances embedded in PDF documents.
BaseFontName is the FontName of the original multiple master
font and BaseFontBlend is the User Design Vector used to
compute the instance.

CIDFonts require the additional Top DICT operators shown in
Table 10.

Table 10 CIDFont Operator Extensions

Name

ROS

Value

Operand(s) Default, notes

12 30

SID SID
number

–, Registry Ordering
Supplement

CIDFontVersion

12 31

number

CIDFontRevision

12 32

number

CIDFontType

12 33

number

0

0

0

CIDCount

12 34

number

8720

UIDBase

FDArray

12 35

number

–

12 36

number

–, Font DICT (FD)
INDEX offset (0)

16

The Compact Font Format Specification

(4 Dec 03)

Table 10 CIDFont Operator Extensions

Name

FDSelect

Value

Operand(s) Default, notes

12 37

number

–, FDSelect offset (0)

FontName

12 38

SID

–, FD FontName

The ROS operator combines the Registry, Ordering, and
Supplement keys together. CIDFonts are described fully in
section 18.

The Top DICT begins with the SyntheticBase and ROS operators
for synthetic and CIDFonts, respectively. Regular Type 1 fonts
begin with some other operator. (This permits the
determination of the kind of font without parsing the entire
Top DICT.)

10 String INDEX

All the strings, with the exception of the FontName and
CIDFontName strings which appear in the Name INDEX, used by
different fonts within the FontSet are collected together into an
INDEX structure and are referenced by a 2-byte unsigned
number called a string identifier or SID. Only unique strings are
stored in the table thereby removing duplication across fonts.
Further space saving is obtained by allocating commonly
occurring strings to predefined SIDs. These strings, known as the
standard strings, describe all the names used in the ISOAdobe
and Expert character sets along with a few other strings
common to Type 1 fonts. A complete list of standard strings is
given in Appendix A.

The client program will contain an array of standard strings with
nStdStrings elements. Thus, the standard strings take SIDs in the
range 0 to (nStdStrings –1). The first string in the String INDEX
corresponds to the SID whose value is equal to nStdStrings, the
first non-standard string, and so on. When the client needs to
determine the string that corresponds to a particular SID it
performs the following: test if SID is in standard range then
fetch from internal table, otherwise, fetch string from the String
INDEX using a value of (SID – nStdStrings) as the index.

An SID is defined as a 2-byte unsigned number but only takes

10  String INDEX

 17

values in the range 0–64999, inclusive. SID values 65000 and
above are available for implementation use.

A FontSet with zero non-standard strings is represented by an
empty INDEX.

11 Glyph Organization

The glyphs within a font constitute a charset and are accessed
via an encoding. An encoding is an array of codes associated
with some or all glyphs in a font and a charset is an array of
“names” for all glyphs in the font. (In CFF these names are
actually SIDs or CIDs, which must be unique.)

In order to understand how charsets, encodings, and glyphs are
related in CFF it is useful to think of them as 3 “parallel” arrays
that are indexed in unison. Thus, it is possible to name and
encode the glyph at the given glyph index (GID) by using the
GID to index the charset and encoding arrays, respectively. By
definition the first glyph (GID 0) is “.notdef” and must be
present in all fonts. Since this is always the case, it is not
necessary to represent either the encoding (unencoded) or
name (.notdef) for GID 0. Consequently, taking advantage of
this optimization, the encoding and charset arrays always begin
with GID 1.

12 Encodings

Encoding data is located via the offset operand to the Encoding
operator in the Top DICT. Only one Encoding operator can be
specified per font except for CIDFonts which specify no
encoding. A glyph’s encoding is specified by a 1-byte code that
permits values in the range 0 – 255.

Each encoding is described by a format-type identifier byte
followed by format-specific data. Two formats are currently
defined as specified in Tables 11 and 12.

Table 11 Format 0

Type

Name

Description

Card8

Card8

format

nCodes

=0

Number of encoded glyphs

18

The Compact Font Format Specification

(4 Dec 03)

Table 11 Format 0

Type

Name

Description

Card8

code
[nCodes]

Code array

Each element of the code array represents the encoding for the
corresponding glyph. This format should be used when the
codes are in a fairly random order.

Table 12 Format 1

Type

Name

Description

Card8

Card8

struct

format

=1

nRanges

Number of code ranges

Range1
[nRanges]

Range1 array (see Table 13)

The format of a Range1 is described in Table 13.

Table 13 Range1 Format (Encoding)

Type

Name

Description

Card8

Card8

first

nLeft

First code in range

Codes left in range (excluding first)

Each Range1 describes a group of sequential codes. For
example, the codes 51 52 53 54 55 could be represented by the
Range1: 51 4, and a perfectly ordered encoding of 256 codes can
be described with the Range1: 0 255.

This format is particularly suited to encodings that are well
ordered.

A few fonts have multiply-encoded glyphs which are not
supported directly by any of the above formats. This situation is
indicated by setting the high-order bit in the format byte and
supplementing the encoding, regardless of format type, as

12  Encodings

 19

shown in Table 14.

Table 14 Supplemental Encoding Data

Type

Card8

struct

Name

nSups

Description

Number of supplementary mappings

Supplement
[nSups]

Supplementary encoding array (see
Table 15 below)

The format of a Supplement is specified in Table 15.

Table 15 Supplement Format

Type

Card8

SID

Name

code

glyph

Description

Encoding

Name

Each Supplement describes a single code-to-glyph mapping
which provides another encoding for a glyph that has already
been mentioned in the main encoding table.

Sorting glyphs by encoding and then SID for unencoded glyphs
(remembering that .notdef must be first) typically yields very
small font encodings. Still more optimization is possible by
observing that many fonts adopt one of two common
encodings. In these cases the operand to the Encoding operator
in the Top DICT specifies a predefined encoding id, in place of
an offset, as defined in Table 16.

Table 16 Encoding ID

Id

0

1

Name

Standard Encoding

Expert Encoding

If the font uses Standard Encoding the Encoding operator can
be omitted from the Top DICT since its default value is 0. Details
of predefined encodings can be found in Appendix B.

It is not necessary for a font to contain all the glyphs specified
by a predefined encoding in order to be able to use it. The only
requirement is that every glyph in the font has an identical

20

The Compact Font Format Specification

(4 Dec 03)

encoding to those in the predefined encoding (including
unencoded glyphs).

Two or more fonts may share the same encoding by setting the
offset operand of the Encoding operator to the same value in
each font.

By definition, glyphs that are not specified by custom or
predefined encodings are unencoded.

Note 4

Predefined encodings may be applied to a variety of fonts regardless of
charset whereas custom encodings may only be applied to fonts with
specific charsets. Consequently, predefined encodings are specified as
code to SID mappings and custom encodings are specified as code to
GID mappings.

13 Charsets

Charset data is located via the offset operand to the charset
operator in the Top DICT. Each charset is described by a format-
type identifier byte followed by format-specific data. Three
formats are currently defined as shown in Tables 17, 18, and 20.

Table 17 Format 0

Type

Name

Description

Card8

format

=0

SID

glyph
[nGlyphs–1]

Glyph name array

Each element of the glyph array represents the name of the
corresponding glyph. This format should be used when the SIDs
are in a fairly random order. The number of glyphs (nGlyphs) is
the value of the count field in the CharStrings INDEX. (There is
one less element in the glyph name array than nGlyphs because
the .notdef glyph name is omitted.)

Table 18 Format 1

Type

Name

Description

Card8

struct

format

=1

Range1
[<varies>]

Range1 array (see Table 19)

13  Charsets

 21

The Range1 format is shown in Table 19.

Table 19 Range1 Format (Charset)

Type

SID

Card8

Name

first

nLeft

Description

First glyph in range

Glyphs left in range (excluding first)

Each Range1 describes a group of sequential SIDs. The number
of ranges is not explicitly specified in the font. Instead, software
utilizing this data simply processes ranges until all glyphs in the
font are covered. This format is particularly suited to charsets
that are well ordered.

Table 20 Format 2

Type

Name

Description

Card8

struct

format

=2

Range2
[<varies>]

Range2 array (see Table 21)

The Range2 format is shown in Table 21.

Table 21 Range2 Format

Type

SID

Name

first

Description

First glyph in range

Card16

nLeft

Glyphs left in range (excluding first)

Format 2 differs from format 1 only in the size of the nLeft field
in each range. This format is most suitable for fonts with a large
well-ordered charset — for example, for Asian CIDFonts.

Careful attention to the allocation order of SIDs typically yields
very small font charsets. Still more optimization is possible by
observing that many fonts adopt one of 3 common charsets. In
these cases the operand to the charset operator in the Top DICT
specifies a predefined charset id, in place of an offset, as shown

22

The Compact Font Format Specification

(4 Dec 03)

in Table 22.

Table 22 Charset ID

Id

0

1

2

Name

ISOAdobe

Expert

ExpertSubset

If the font has an ISOAdobe charset, the charset operator can be
omitted from the Top DICT since its default value is 0. Details of
predefined charsets can be found in Appendix C. A font may use
a predefined charset if it exactly matches in the first nGlyphs.
CID fonts must not use predefined charsets.

Two or more fonts may share the same charset by setting the
offset operand of the charset operator to the same value in
each font.

14 CharStrings INDEX

This contains the charstrings of all the glyphs in a font stored in
an INDEX structure. Charstring objects contained within this
INDEX are accessed by GID. The first charstring (GID 0) must be
the .notdef glyph. The number of glyphs available in a font may
be determined from the count field in the INDEX.

The format of the charstring data, and therefore the method of
interpretation, is specified by the CharstringType operator in
the Top DICT. The CharstringType operator has a default value
of 2 indicating the Type 2 charstring format which was designed
in conjunction with CFF. Type 1 charstrings are documented in
the “Adobe Type 1 Font Format” published by Addison-Wesley.
Type 2 charstrings are described in Adobe Technical Note #5177:
“Type 2 Charstring Format.” Other charstring types may also be
supported by this method.

15 Private DICT Data

The names of the Private DICT operators shown in Table 23 are,
where possible, the same as the corresponding Type 1 dict keys.
Operators that have no corresponding Type 1 dict key are

14  CharStrings INDEX

 23

indicated with a note in Table 23.

Table 23 Private DICT Operators

Name

Value

Operand(s) Default, notes

BlueValues

OtherBlues

FamilyBlues

FamilyOtherBlues

6

7

8

9

delta

delta

delta

delta

–

–

–

–

12 9

number

0.039625

BlueScale

BlueShift

BlueFuzz

StdHW

StdVW

12 10

number

12 11

number

10

11

number

number

7

1

–

–

–

–

StemSnapH

12 12

delta

StemSnapV

12 13

delta

ForceBold

12 14

boolean

false

LanguageGroup

12 17

number

0

ExpansionFactor

12 18

number

0.06

initialRandomSeed

12 19

number

0

Subrs

defaultWidthX

nominalWidthX

19

20

21

number

–, Offset (self) to local
subrs

number

0, see below

number

0, see below

The local subrs offset is relative to the beginning of the Private
DICT data.

The defaultWidthX and nominalWidthX operators supply width
values for glyphs. If a glyph width equals the defaultWidthX
value it can be omitted from the charstring, otherwise the glyph
width is computed by adding the charstring width to
nominalWidthX value. If nominalWidthX is carefully chosen the
bulk of the widths in the charstrings can be reduced from 2-byte
to single-byte numbers thereby saving space.

The OtherBlues and FamilyOtherBlues operators must occur

24

The Compact Font Format Specification

(4 Dec 03)

after the BlueValues and FamilyBlues operators, respectively.

A Private DICT is required, but may be specified as having a
length of 0 if there are no non-default values to be stored.

16 Local / Global Subrs INDEXes

Both Type 1 and Type 2 charstrings support the notion of
subroutines or subrs. A subr is typically a sequence of charstring
bytes representing a sub-program that occurs in more than one
place in a font’s charstring data. This subr may be stored once
but referenced many times from within one or more charstrings
by the use of the callsubr operator whose operand is the
number of the subr to be called. The subrs are local to a
particular font and cannot be shared between fonts. Type 2
charstrings also permit global subrs which function in the same
way but are called by the callgsubr operator and may be shared
across fonts.

Local subrs are stored in an INDEX structure which is located via
the offset operand of the Subrs operator in the Private DICT. A
font without local subrs has no Subrs operator in the Private
DICT.

Global subrs are stored in an INDEX structure which follows the
String INDEX. A FontSet without any global subrs is represented
by an empty Global Subrs INDEX.

Subr numbers in Type 2 charstrings are skewed by a number
called the “subr number bias” which is calculated from the
count of the subroutines in either the local or global subr
INDEXes. The bias is calculated as follows:

Card16 bias;
Card16 nSubrs = subrINDEX.count;

if (CharstringType == 1)

bias = 0;

else if (nSubrs < 1240)

bias = 107;

else if (nSubrs < 33900)

bias = 1131;

else

bias = 32768;

For correct subr selection the calculated bias must be added to

16  Local/Global Subrs INDEXes

 25

the subr number operand before accessing the appropriate subr
INDEX. This technique allows subr numbers to be specified using
negative as well as positive numbers thereby fully utilizing the
available number ranges and thus saving space. (The above
calculation obviates the need for an explicit bias to be stored in
the font which is currently the case for Type 1 fonts.) Tables 24,
25, and 26 show the relationship between subr indices,
numbers, number sizes and range counts for the different
biasing schemes (column headings are described following
Table 26).

Table 24 nSubrs < 1240, bias = 107

Ordered index

Reorder index

Biased number

Size

Count

0  –

214

0

215

–

1238

215

–

–

214

1238

–107

+108

–

–

+107

+1131

1

2

215

1024

Total:

1239

Table 25 nSubrs < 33900, bias = 1131

Ordered index

Reorder index

Biased number

Size

Count

0

215

1239

–

–

–

214

1024

1238

0

2262

1239

–

–

–

1238

–107

1023

–1131

2262

+108

–

–

–

+107

–108

+1131

2263

– 33898

2263

– 33898

+1132

– +32767

1

2

2

3

215

1024

1024

31636

Total:

33899

Table 26 nSubrs >= 33900, bias = 32768

Ordered index

Reorder index

Biased number

Size

Count

0

215

1239

–

–

–

214

32661

– 32875

–107

1238

31637

– 32660

–1131

2262

32876

– 33899

+108

–

–

–

+107

–108

+1131

2263

– 33899

0

– 31636

–32768  –

–1132

33900

– 65535

33900

– 65535

+1132

– +32767

1

2

2

3

3

215

1024

1024

31637

31636

Total:

65536

Where the column headings are interpreted as follows:

26

The Compact Font Format Specification

(4 Dec 03)

Ordered index

Reorder index

subr index ordered by most frequent
subr first.

ordered index reordered for bias (this
is the index of subrs in the local/global
Subr INDEX structures).

Biased number

reorder index with bias subtracted
(callsubr/callgsubr operand).

Size

Count

biased number size (bytes).

number of subrs in range.

17 Synthetic Fonts

A synthetic font is a modification of another font by means of a
different transformation matrix or encoding. Obliqued,
expanded, and condensed fonts are examples of fonts that may
be constructed as synthetic fonts.

Synthetic fonts have a name and a Top DICT that refers to a base
font. The Top DICT may contain the following operators:
FullName, ItalicAngle, FontMatrix, SyntheticBase, and
Encoding.

The SyntheticBase operator is required and specifies the zero-
based index of the font that is to be used as the base font. The
FontMatrix and/or Encoding is applied to this font in order to
algorithmically create a new font. The other operator values
override those given in the base font. The Top DICT must begin
with a SyntheticBase operator. The base font shall not be a CID-
keyed font or a synthetic font.

18 CID-keyed Fonts

The representation of a CIDFont is designed to be separable
from its encoding. In keeping with this strategy, the CFF
representation does not include any encoding information
which instead resides in a CMap file. If a need arises for a more
compact representation of the CMap file, CFF can be extended
to accommodate it.

A CFF CIDFont has the CIDFontName in the Name INDEX and a
corresponding Top DICT. The Top DICT begins with ROS operator
which specifies the Registry-Ordering-Supplement for the font.

17  Synthetic Fonts

 27

This will indicate to a CFF parser that special CID processing
should be applied to this font. Specifically:

(cid:127) The FDArray operator is expected to be present, with a single
argument specifying an offset to the Font DICT INDEX. Each
Font DICT in this array specifies information unique to a
particular group of glyphs in the font. The mapping of
glyphs to Font DICTs is specified by the FDSelect structure
described below. Each Font DICT will specify a corresponding
Private DICT with the Private DICT operator.

(cid:127) The charset data, although in the same format as non-

CIDFonts, will represent CIDs rather than SIDs, i.e. charstrings
are “named” by CIDs in a CIDFont. In a complete CIDFont the
charset table will specify an identity mapping (where GID
equals CID for all glyphs) as a single range beginning at CID 1
(CID 0, the .notdef glyph, is omitted) that covers all the
glyphs in the font. Subset CIDFonts will generally need to use
a more complex charset table representing a non-identity
mapping (where CID doesn’t equal GID).

(cid:127) The Top DICT will include an FDSelect operator specifying an

offset to a charset-like data structure (see next section)
which contains a, possibly range-encoded, list of indexes,
from which a single index may be derived for each glyph.
The index identifies the Font DICT, and therefore the Private
DICT, to be used when rasterizing a glyph.

(cid:127) The encoding data is omitted (see above); no Encoding

operator will be present and the default StandardEncoding
should not be applied.

There are no predefined charsets for CID fonts.

19 FDSelect

The FDSelect associates an FD (Font DICT) with a glyph by
specifying an FD index for that glyph. The FD index is used to
access one of the Font DICTs stored in the Font DICT INDEX.

FDSelect data is located via the offset operand to the FDSelect
operator in the Top DICT. FDSelect data specifies a format-type
identifier byte followed by format-specific data. Two formats

28

The Compact Font Format Specification

(4 Dec 03)

are currently defined, as shown in Tables 27 and 28.

Table 27 Format 0

Type

Name

Description

Card8

Card8

format

=0

fds
[nGlyphs]

FD selector array

Each element of the fd array (fds) represents the FD index of the
corresponding glyph. This format should be used when the FD
indexes are in a fairly random order. The number of glyphs
(nGlyphs) is the value of the count field in the CharStrings
INDEX. (This format is identical to charset format 0 except that
the .notdef glyph is included in this case.)

Table 28 Format 3

Type

Name

Description

Card8

format

=3

Card16

nRanges

Number of ranges

struct

Range3
[nRanges]

Range3 array (see Table 29)

Card16

sentinel

Sentinel GID (see below)

The format of a Range3 is shown in Table 29.

Table 29 Range3 Format

Type

Name

Description

Card16

first

First glyph index in range

Card8

fd

FD index for all glyphs in range

Each Range3 describes a group of sequential GIDs that have the
same FD index. Each range includes GIDs from the ‘first’ GID up
to, but not including, the ‘first’ GID of the next range element.
Thus, elements of the Range3 array are ordered by increasing
‘first’ GIDs. The first range must have a ‘first’ GID of 0. A sentinel
GID follows the last range element and serves to delimit the last
range in the array. (The sentinel GID is set equal to the number
of glyphs in the font. That is, its value is 1 greater than the last
GID in the font.) This format is particularly suited to FD indexes
that are well ordered (the usual case).

19  FDSelect

 29

30

The Compact Font Format Specification

(4 Dec 03)

Appendix A
Standard Strings

(SID / name)

0

1

2

3

4

5

6

7

8

9

.notdef

space

exclam

21

four

22

five

23

six

quotedbl

24

seven

numbersign

25

eight

dollar

percent

ampersand

quoteright

parenleft

26 nine

27

colon

28

semicolon

29

less

30

equal

10 parenright

31 greater

11

asterisk

32 question

12 plus

13

comma

14 hyphen

15 period

16

slash

17

zero

18 one

19

two

20

three

33

at

34 A

35 B

36 C

37 D

38

39

E

F

40 G

41 H

42

43

I

J

44 K

45

L

46 M

47 N

48 O

49

P

50 Q

51 R

52

53

S

T

54 U

55 V

56 W

57 X

58 Y

59

Z

60 bracketleft

61 backslash

62 bracketright

31

63

asciicircum

64 underscore

65 quoteleft

66

67

68

69

70

71

72

73

74

75

76

77

a

b

c

d

e

f

g

h

i

j

k

l

braceleft

121 ellipsis

bar

122 perthousand

braceright

123 questiondown

asciitilde

124 grave

exclamdown

125 acute

92

93

94

95

96

97

98

99

cent

sterling

fraction

100 yen

101 florin

126 circumflex

127 tilde

128 macron

129 breve

130 dotaccent

102 section

131 dieresis

103 currency

132 ring

104 quotesingle

133 cedilla

105 quotedblleft

134 hungarumlaut

106 guillemotleft

135 ogonek

78 m

107 guilsinglleft

136 caron

79

80

81

82

83

84

85

86

87

n

o

p

q

r

s

t

u

v

88 w

89

90

91

x

y

z

108 guilsinglright

137 emdash

109 fi

110 fl

111 endash

112 dagger

138 AE

139 ordfeminine

140 Lslash

141 Oslash

113 daggerdbl

142 OE

114 periodcentered

143 ordmasculine

115 paragraph

144 ae

116 bullet

145 dotlessi

117 quotesinglbase

146 lslash

118 quotedblbase

147 oslash

119 quotedblright

148 oe

120 guillemotright

149 germandbls

32

Appendix A Standard Strings

(4 Dec 03)

150 onesuperior

179 Ecircumflex

208

ecircumflex

151 logicalnot

180 Edieresis

209

edieresis

152 mu

181 Egrave

153 trademark

182 Iacute

210

egrave

211

iacute

154 Eth

183 Icircumflex

212

icircumflex

155 onehalf

184 Idieresis

213

idieresis

156 plusminus

185 Igrave

157 Thorn

186 Ntilde

214

igrave

215 ntilde

158 onequarter

187 Oacute

216 oacute

159 divide

188 Ocircumflex

217 ocircumflex

160 brokenbar

189 Odieresis

218 odieresis

161 degree

190 Ograve

219 ograve

162 thorn

191 Otilde

163 threequarters

192 Scaron

220 otilde

221

scaron

164 twosuperior

193 Uacute

222 uacute

165 registered

194 Ucircumflex

223 ucircumflex

166 minus

167 eth

168 multiply

197 Yacute

196 Ugrave

225 ugrave

226

yacute

195 Udieresis

224 udieresis

169 threesuperior

198 Ydieresis

227

ydieresis

170 copyright

199 Zcaron

228

zcaron

171 Aacute

200 aacute

229

exclamsmall

172 Acircumflex

201 acircumflex

230 Hungarumlautsmall

173 Adieresis

202 adieresis

231 dollaroldstyle

174 Agrave

203 agrave

232 dollarsuperior

175 Aring

176 Atilde

204 aring

205 atilde

233

ampersandsmall

234 Acutesmall

177 Ccedilla

206 ccedilla

235 parenleftsuperior

178 Eacute

207 eacute

236 parenrightsuperior

 33

237 twodotenleader

266 ff

238 onedotenleader

267 ffi

239 zerooldstyle

268 ffl

295 Vsmall

296 Wsmall

297 Xsmall

240 oneoldstyle

269 parenleftinferior

298 Ysmall

241 twooldstyle

270 parenrightinferior

299 Zsmall

242 threeoldstyle

271 Circumflexsmall

300 colonmonetary

243 fouroldstyle

272 hyphensuperior

301 onefitted

244 fiveoldstyle

273 Gravesmall

302 rupiah

245 sixoldstyle

274 Asmall

303 Tildesmall

246 sevenoldstyle

275 Bsmall

304 exclamdownsmall

247 eightoldstyle

276 Csmall

305 centoldstyle

248 nineoldstyle

277 Dsmall

306 Lslashsmall

249 commasuperior

278 Esmall

307 Scaronsmall

250 threequartersemdash

279 Fsmall

308 Zcaronsmall

251 periodsuperior

280 Gsmall

309 Dieresissmall

252 questionsmall

281 Hsmall

310 Brevesmall

253 asuperior

282 Ismall

311 Caronsmall

254 bsuperior

283 Jsmall

312 Dotaccentsmall

255 centsuperior

284 Ksmall

313 Macronsmall

256 dsuperior

285 Lsmall

314 figuredash

257 esuperior

286 Msmall

315 hypheninferior

258 isuperior

287 Nsmall

316 Ogoneksmall

259 lsuperior

288 Osmall

317 Ringsmall

260 msuperior

289 Psmall

318 Cedillasmall

261 nsuperior

290 Qsmall

319 questiondownsmall

262 osuperior

291 Rsmall

320 oneeighth

263 rsuperior

292 Ssmall

321 threeeighths

264 ssuperior

293 Tsmall

322 fiveeighths

265 tsuperior

294 Usmall

323 seveneighths

34

Appendix A Standard Strings

(4 Dec 03)

324 onethird

353 AEsmall

382 001.003

325 twothirds

354 Ccedillasmall

383 Black

326 zerosuperior

355 Egravesmall

384 Bold

327 foursuperior

356 Eacutesmall

385 Book

328 fivesuperior

357 Ecircumflexsmall

386 Light

329 sixsuperior

358 Edieresissmall

387 Medium

330 sevensuperior

359 Igravesmall

388 Regular

331 eightsuperior

360 Iacutesmall

389 Roman

332 ninesuperior

361 Icircumflexsmall

390 Semibold

333 zeroinferior

362 Idieresissmall

334 oneinferior

363 Ethsmall

335 twoinferior

364 Ntildesmall

336 threeinferior

365 Ogravesmall

337 fourinferior

366 Oacutesmall

338 fiveinferior

367 Ocircumflexsmall

339 sixinferior

368 Otildesmall

340 seveninferior

369 Odieresissmall

341 eightinferior

370 OEsmall

342 nineinferior

371 Oslashsmall

343 centinferior

372 Ugravesmall

344 dollarinferior

373 Uacutesmall

345 periodinferior

374 Ucircumflexsmall

346 commainferior

375 Udieresissmall

347 Agravesmall

376 Yacutesmall

348 Aacutesmall

377 Thornsmall

349 Acircumflexsmall

378 Ydieresissmall

350 Atildesmall

379 001.000

351 Adieresissmall

380 001.001

352 Aringsmall

381 001.002

 35

36

Appendix A Standard Strings

(4 Dec 03)

Appendix B
Predefined Encodings

Standard Encoding (code / SID / name)

0

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

39

40

0

0

0

0

0

0

0

0

0

0

0

1

2

3

4

5

6

7

8

9

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

space

exclam

42

11

asterisk

43

12

plus

44

13

comma

45

14

hyphen

46

15

period

47

16

slash

48

17

zero

49

18

one

50

19

two

51

20

three

52

21

four

53

22

five

54

23

six

quotedbl

55

24

seven

numbersign

56

25

eight

dollar

percent

57

26

nine

58

27

colon

ampersand

59

28

semicolon

quoteright

60

29

less

parenleft

61

30

equal

41

10

parenright

62

31

greater

37

63

32

question

92

61

backslash

64

33

at

93

62

bracketright

121 90

122 91

y

z

65

34

66

35

67

36

68

37

69

38

70

39

71

40

72

41

73

42

74

43

75

44

76

45

A

B

C

D

E

F

G

H

I

J

K

L

77

46 M

78

47

N

79

48 O

80

49

P

81

50 Q

82

51

83

52

84

53

85

54

86

55

R

S

T

U

V

87

56 W

88

57

89

58

90

59

X

Y

Z

94

63

asciicircum

123 92

braceleft

95

64

underscore

124 93

bar

96

65

quoteleft

125 94

braceright

97

66

98

67

99

68

100 69

101 70

102 71

103 72

104 73

105 74

106 75

107 76

108 77

a

b

c

d

e

f

g

h

i

j

k

l

126 95

asciitilde

127 0

.notdef

128 0

.notdef

129 0

.notdef

130 0

.notdef

131 0

.notdef

132 0

.notdef

133 0

.notdef

134 0

.notdef

135 0

.notdef

136 0

.notdef

137 0

.notdef

109 78 m

138 0

.notdef

110 79

111 80

112 81

113 82

114 83

115 84

116 85

117 86

118 87

n

o

p

q

r

s

t

u

v

139 0

.notdef

140 0

.notdef

141 0

.notdef

142 0

.notdef

143 0

.notdef

144 0

.notdef

145 0

.notdef

146 0

.notdef

147 0

.notdef

119 88 w

148 0

.notdef

91

60

bracketleft

120 89

x

149 0

.notdef

38

Appendix B Predefined Encodings

(4 Dec 03)

150 0

.notdef

179 113 daggerdbl

208 137 emdash

151 0

.notdef

180 114 periodcentered

209 0

.notdef

152 0

.notdef

181 0

.notdef

210 0

.notdef

153 0

.notdef

182 115 paragraph

211 0

.notdef

154 0

.notdef

183 116 bullet

212 0

.notdef

155 0

.notdef

184 117 quotesinglbase

213 0

.notdef

156 0

.notdef

185 118 quotedblbase

214 0

.notdef

157 0

.notdef

186 119 quotedblright

215 0

.notdef

158 0

.notdef

187 120 guillemotright

216 0

.notdef

159 0

.notdef

188 121 ellipsis

217 0

.notdef

160 0

.notdef

189 122 perthousand

218 0

.notdef

161 96

exclamdown

190 0

.notdef

219 0

.notdef

162 97

cent

191 123 questiondown

220 0

.notdef

163 98

sterling

192 0

.notdef

221 0

.notdef

164 99

fraction

193 124 grave

222 0

.notdef

165 100 yen

194 125 acute

223 0

.notdef

166 101 florin

195 126 circumflex

224 0

.notdef

167 102 section

196 127 tilde

225 138 AE

168 103 currency

197 128 macron

226 0

.notdef

169 104 quotesingle

198 129 breve

227 139 ordfeminine

170 105 quotedblleft

199 130 dotaccent

228 0

.notdef

171 106 guillemotleft

200 131 dieresis

229 0

.notdef

172 107 guilsinglleft

201 0

.notdef

230 0

.notdef

173 108 guilsinglright

202 132 ring

231 0

.notdef

174 109 fi

175 110 fl

203 133 cedilla

232 140 Lslash

204 0

.notdef

233 141 Oslash

176 0

.notdef

205 134 hungarumlaut

234 142 OE

177 111 endash

206 135 ogonek

235 143 ordmasculine

178 112 dagger

207 136 caron

236 0

.notdef

 39

237 0

.notdef

244 0

.notdef

251 149 germandbls

238 0

.notdef

245 145 dotlessi

252 0

.notdef

239 0

.notdef

246 0

.notdef

253 0

.notdef

240 0

.notdef

247 0

.notdef

254 0

.notdef

241 144 ae

248 146 lslash

255 0

.notdef

242 0

.notdef

249 147 oslash

243 0

.notdef

250 148 oe

ExpertEncoding (code / SID / name )

0

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

0

0

0

0

0

0

0

0

0

0

0

0

0

0

1

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

.notdef

space

36

231 dollaroldstyle

37

232 dollarsuperior

38

233 ampersandsmall

39

234 Acutesmall

40

235 parenleftsuperior

41

236 parenrightsuperior

42

237 twodotenleader

43

238 onedotenleader

44

13

comma

45

14

hyphen

46

15

period

47

99

fraction

48

239 zerooldstyle

49

240 oneoldstyle

50

241 twooldstyle

33

229 exclamsmall

51

242 threeoldstyle

34

230 Hungarumlautsmall

52

243 fouroldstyle

35

0

.notdef

53

244 fiveoldstyle

40

Appendix B Predefined Encodings

(4 Dec 03)

54

245 sixoldstyle

83

264 ssuperior

112 289 Psmall

55

246 sevenoldstyle

84

265 tsuperior

113 290 Qsmall

56

247 eightoldstyle

85

0

.notdef

114 291 Rsmall

57

248 nineoldstyle

86

266 ff

115 292 Ssmall

58

27

colon

87

109 fi

116 293 Tsmall

59

28

semicolon

88

110 fl

117 294 Usmall

60

249 commasuperior

89

267 ffi

118 295 Vsmall

61

250 threequartersemdash

90

268 ffl

119 296 Wsmall

62

251 periodsuperior

91

269 parenleftinferior

120 297 Xsmall

63

252 questionsmall

92

0

.notdef

121 298 Ysmall

64

0

.notdef

93

270 parenrightinferior

122 299 Zsmall

65

253 asuperior

94

271 Circumflexsmall

123 300 colonmonetary

66

254 bsuperior

95

272 hyphensuperior

124 301 onefitted

67

255 centsuperior

96

273 Gravesmall

125 302 rupiah

68

256 dsuperior

97

274 Asmall

126 303 Tildesmall

69

257 esuperior

98

275 Bsmall

127 0

.notdef

70

71

72

0

0

0

.notdef

.notdef

.notdef

99

276 Csmall

128 0

.notdef

100 277 Dsmall

129 0

.notdef

101 278 Esmall

130 0

.notdef

73

258 isuperior

102 279 Fsmall

131 0

.notdef

74

75

0

0

.notdef

.notdef

103 280 Gsmall

132 0

.notdef

104 281 Hsmall

133 0

.notdef

76

259 lsuperior

105 282 Ismall

134 0

.notdef

77

260 msuperior

106 283 Jsmall

135 0

.notdef

78

261 nsuperior

107 284 Ksmall

136 0

.notdef

79

262 osuperior

108 285 Lsmall

137 0

.notdef

80

81

0

0

.notdef

.notdef

109 286 Msmall

138 0

.notdef

110 287 Nsmall

139 0

.notdef

82

263 rsuperior

111 288 Osmall

140 0

.notdef

 41

141 0

.notdef

170 311 Caronsmall

199 0

.notdef

142 0

.notdef

171 0

.notdef

200 326 zerosuperior

143 0

.notdef

172 312 Dotaccentsmall

201 150 onesuperior

144 0

.notdef

173 0

.notdef

202 164 twosuperior

145 0

.notdef

174 0

.notdef

203 169 threesuperior

146 0

.notdef

175 313 Macronsmall

204 327 foursuperior

147 0

.notdef

176 0

.notdef

205 328 fivesuperior

148 0

.notdef

177 0

.notdef

206 329 sixsuperior

149 0

.notdef

178 314 figuredash

207 330 sevensuperior

150 0

.notdef

179 315 hypheninferior

208 331 eightsuperior

151 0

.notdef

180 0

.notdef

209 332 ninesuperior

152 0

.notdef

181 0

.notdef

210 333 zeroinferior

153 0

.notdef

182 316 Ogoneksmall

211 334 oneinferior

154 0

.notdef

183 317 Ringsmall

212 335 twoinferior

155 0

.notdef

184 318 Cedillasmall

213 336 threeinferior

156 0

.notdef

185 0

.notdef

214 337 fourinferior

157 0

.notdef

186 0

.notdef

215 338 fiveinferior

158 0

.notdef

187 0

.notdef

216 339 sixinferior

159 0

.notdef

188 158 onequarter

217 340 seveninferior

160 0

.notdef

189 155 onehalf

218 341 eightinferior

161 304 exclamdownsmall

190 163 threequarters

219 342 nineinferior

162 305 centoldstyle

191 319 questiondownsmall

220 343 centinferior

163 306 Lslashsmall

192 320 oneeighth

221 344 dollarinferior

164 0

.notdef

193 321 threeeighths

222 345 periodinferior

165 0

.notdef

194 322 fiveeighths

223 346 commainferior

166 307 Scaronsmall

195 323 seveneighths

224 347 Agravesmall

167 308 Zcaronsmall

196 324 onethird

225 348 Aacutesmall

168 309 Dieresissmall

197 325 twothirds

226 349 Acircumflexsmall

169 310 Brevesmall

198 0

.notdef

227 350 Atildesmall

42

Appendix B Predefined Encodings

(4 Dec 03)

228 351 Adieresissmall

238 361 Icircumflexsmall

248 371 Oslashsmall

229 352 Aringsmall

239 362 Idieresissmall

249 372 Ugravesmall

230 353 AEsmall

240 363 Ethsmall

250 373 Uacutesmall

231 354 Ccedillasmall

241 364 Ntildesmall

251 374 Ucircumflexsmall

232 355 Egravesmall

242 365 Ogravesmall

252 375 Udieresissmall

233 356 Eacutesmall

243 366 Oacutesmall

253 376 Yacutesmall

234 357 Ecircumflexsmall

244 367 Ocircumflexsmall

254 377 Thornsmall

235 358 Edieresissmall

245 368 Otildesmall

255 378 Ydieresissmall

236 359 Igravesmall

246 369 Odieresissmall

237 360 Iacutesmall

247 370 OEsmall

 43

44

Appendix B Predefined Encodings

(4 Dec 03)

Appendix C
Predefined Charsets

All charsets are presented in GID order beginning with GID 1. (The .notdef glyph is
implicitly GID 0 and is therefore not shown.)

ISOAdobe (SID / name)

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

space

exclam

quotedbl

numbersign

dollar

percent

ampersand

quoteright

parenleft

parenright

asterisk

plus

comma

hyphen

period

slash

zero

one

two

three

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

39

40

four

five

six

seven

eight

nine

colon

semicolon

less

equal

greater

question

at

A

B

C

D

E

F

G

41

42

43

44

45

H

I

J

K

L

46 M

47

N

48 O

49

P

50 Q

51

52

53

54

55

R

S

T

U

V

56 W

57

58

59

60

X

Y

Z

bracketleft

45

61

62

63

64

65

66

67

68

69

70

71

72

73

74

75

76

77

backslash

bracketright

asciicircum

underscore

quoteleft

a

b

c

d

e

f

g

h

i

j

k

l

78 m

79

80

81

82

83

84

85

86

87

n

o

p

q

r

s

t

u

v

93

94

95

96

97

98

99

cent

sterling

fraction

100 yen

101 florin

bar

braceright

asciitilde

125 acute

126 circumflex

127 tilde

exclamdown

128 macron

129 breve

130 dotaccent

131 dieresis

132 ring

133 cedilla

102 section

134 hungarumlaut

103 currency

135 ogonek

104 quotesingle

136 caron

105 quotedblleft

137 emdash

106 guillemotleft

138 AE

107 guilsinglleft

139 ordfeminine

108 guilsinglright

140 Lslash

109 fi

110 fl

111 endash

112 dagger

141 Oslash

142 OE

143 ordmasculine

144 ae

113 daggerdbl

145 dotlessi

114 periodcentered

146 lslash

115 paragraph

147 oslash

116 bullet

148 oe

117 quotesinglbase

149 germandbls

118 quotedblbase

150 onesuperior

119 quotedblright

151 logicalnot

88 w

120 guillemotright

152 mu

89

90

91

92

x

y

z

121 ellipsis

153 trademark

122 perthousand

154 Eth

123 questiondown

155 onehalf

braceleft

124 grave

156 plusminus

46

Appendix C Predefined Charsets

(4 Dec 03)

157 Thorn

181 Egrave

158 onequarter

182 Iacute

205 atilde

206 ccedilla

159 divide

183 Icircumflex

207 eacute

160 brokenbar

184 Idieresis

208 ecircumflex

161 degree

162 thorn

185 Igrave

186 Ntilde

163 threequarters

187 Oacute

209 edieresis

210 egrave

211 iacute

164 twosuperior

188 Ocircumflex

212 icircumflex

165 registered

189 Odieresis

213 idieresis

166 minus

167 eth

168 multiply

190 Ograve

191 Otilde

192 Scaron

214 igrave

215 ntilde

216 oacute

169 threesuperior

193 Uacute

217 ocircumflex

170 copyright

194 Ucircumflex

218 odieresis

171 Aacute

195 Udieresis

172 Acircumflex

196 Ugrave

173 Adieresis

197 Yacute

219 ograve

220 otilde

221 scaron

222 uacute

223 ucircumflex

224 udieresis

198 Ydieresis

199 Zcaron

200 aacute

201 acircumflex

225 ugrave

202 adieresis

226 yacute

174 Agrave

175 Aring

176 Atilde

177 Ccedilla

178 Eacute

179 Ecircumflex

203 agrave

180 Edieresis

204 aring

227 ydieresis

228 zcaron

Expert (SID / name)

1

space

233 ampersandsmall

238 onedotenleader

229 exclamsmall

234 Acutesmall

230 Hungarumlautsmall

235 parenleftsuperior

231 dollaroldstyle

236 parenrightsuperior

232 dollarsuperior

237 twodotenleader

13

14

15

99

comma

hyphen

period

fraction

 47

239 zerooldstyle

240 oneoldstyle

267 ffi

268 ffl

299 Zsmall

300 colonmonetary

241 twooldstyle

269 parenleftinferior

301 onefitted

242 threeoldstyle

270 parenrightinferior

302 rupiah

243 fouroldstyle

271 Circumflexsmall

303 Tildesmall

244 fiveoldstyle

272 hyphensuperior

304 exclamdownsmall

245 sixoldstyle

273 Gravesmall

305 centoldstyle

246 sevenoldstyle

274 Asmall

306 Lslashsmall

247 eightoldstyle

275 Bsmall

307 Scaronsmall

248 nineoldstyle

276 Csmall

308 Zcaronsmall

27

28

colon

semicolon

277 Dsmall

278 Esmall

309 Dieresissmall

310 Brevesmall

249 commasuperior

279 Fsmall

311 Caronsmall

250 threequartersemdash

280 Gsmall

312 Dotaccentsmall

251 periodsuperior

281 Hsmall

313 Macronsmall

252 questionsmall

282 Ismall

314 figuredash

253 asuperior

254 bsuperior

283 Jsmall

284 Ksmall

315 hypheninferior

316 Ogoneksmall

255 centsuperior

285 Lsmall

317 Ringsmall

256 dsuperior

286 Msmall

318 Cedillasmall

257 esuperior

258 isuperior

259 lsuperior

260 msuperior

261 nsuperior

262 osuperior

263 rsuperior

264 ssuperior

265 tsuperior

266 ff

109 fi

110 fl

287 Nsmall

288 Osmall

289 Psmall

290 Qsmall

291 Rsmall

292 Ssmall

293 Tsmall

294 Usmall

295 Vsmall

296 Wsmall

297 Xsmall

298 Ysmall

158 onequarter

155 onehalf

163 threequarters

319 questiondownsmall

320 oneeighth

321 threeeighths

322 fiveeighths

323 seveneighths

324 onethird

325 twothirds

326 zerosuperior

150 onesuperior

48

Appendix C Predefined Charsets

(4 Dec 03)

164 twosuperior

343 centinferior

361 Icircumflexsmall

169 threesuperior

344 dollarinferior

362 Idieresissmall

327 foursuperior

345 periodinferior

363 Ethsmall

328 fivesuperior

346 commainferior

364 Ntildesmall

329 sixsuperior

347 Agravesmall

365 Ogravesmall

330 sevensuperior

348 Aacutesmall

366 Oacutesmall

331 eightsuperior

349 Acircumflexsmall

367 Ocircumflexsmall

332 ninesuperior

350 Atildesmall

368 Otildesmall

333 zeroinferior

351 Adieresissmall

369 Odieresissmall

334 oneinferior

352 Aringsmall

370 OEsmall

335 twoinferior

353 AEsmall

371 Oslashsmall

336 threeinferior

354 Ccedillasmall

372 Ugravesmall

337 fourinferior

355 Egravesmall

373 Uacutesmall

338 fiveinferior

356 Eacutesmall

374 Ucircumflexsmall

339 sixinferior

357 Ecircumflexsmall

375 Udieresissmall

340 seveninferior

358 Edieresissmall

376 Yacutesmall

341 eightinferior

359 Igravesmall

377 Thornsmall

342 nineinferior

360 Iacutesmall

378 Ydieresissmall

Expert Subset (SID / name)

1

space

239 zerooldstyle

28

semicolon

231 dollaroldstyle

240 oneoldstyle

249 commasuperior

232 dollarsuperior

241 twooldstyle

250 threequartersemdash

235 parenleftsuperior

242 threeoldstyle

251 periodsuperior

236 parenrightsuperior

243 fouroldstyle

253 asuperior

237 twodotenleader

244 fiveoldstyle

254 bsuperior

238 onedotenleader

245 sixoldstyle

255 centsuperior

13

14

15

99

comma

hyphen

period

fraction

246 sevenoldstyle

256 dsuperior

247 eightoldstyle

257 esuperior

248 nineoldstyle

258 isuperior

27

colon

259 lsuperior

 49

260 msuperior

314 figuredash

330 sevensuperior

261 nsuperior

262 osuperior

263 rsuperior

264 ssuperior

265 tsuperior

266 ff

109 fi

110 fl

267 ffi

268 ffl

315 hypheninferior

331 eightsuperior

158 onequarter

332 ninesuperior

155 onehalf

333 zeroinferior

163 threequarters

334 oneinferior

320 oneeighth

335 twoinferior

321 threeeighths

336 threeinferior

322 fiveeighths

337 fourinferior

323 seveneighths

338 fiveinferior

324 onethird

339 sixinferior

325 twothirds

340 seveninferior

269 parenleftinferior

326 zerosuperior

341 eightinferior

270 parenrightinferior

150 onesuperior

342 nineinferior

272 hyphensuperior

164 twosuperior

343 centinferior

300 colonmonetary

169 threesuperior

344 dollarinferior

301 onefitted

327 foursuperior

345 periodinferior

302 rupiah

328 fivesuperior

346 commainferior

305 centoldstyle

329 sixsuperior

50

Appendix C Predefined Charsets

(4 Dec 03)

Appendix D
Example CFF Font

This appendix illustrates the CFF format with an example font.
The font shown is a subset with just the .notdef and space
glyphs of the Times* font program that has been renamed. This
font has no subrs and uses predefined encoding and charset.

Binary dump (147 bytes):

0000000  0100 0401 0001 0101 1341 4243 4445 462b  |?.??.????ABCDEF+|
0000010  5469 6d65 732d 526f 6d61 6e00 0101 011f  |Times-Roman.????|
0000020  f81b 00f8 1c02 f81d 03f8 1904 1c6f 000d  |??.??????????o.?|
0000030  fb3c fb6e fa7c fa16 05e9 11b8 f112 0003  |?<?n?|????????.?|
0000040  0101 0813 1830 3031 2e30 3037 5469 6d65  |?????001.007Time|
0000050  7320 526f 6d61 6e54 696d 6573 0000 0002  |s RomanTimes...?|
0000060  0101 0203 0e0e 7d99 f92a 99fb 7695 f773  |??????}??*??v??s|
0000070  8b06 f79a 93fc 7c8c 077d 99f8 5695 f75e  |??????|??}??V??^|
0000080  9908 fb6e 8cf8 7393 f710 8b09 a70a df0b  |???n??s?????????|
0000090  f78e 14                                  |???             |

51

Annotated dump:

### Header (00000000)
major  =1
minor  =0
hdrSize=4
offSize=1
### Name INDEX (00000004)
count  =1
offSize=1
--- offset[index]=value
[0]=1 [1]=19
--- object[index]=<value>
[0]=<ABCDEF+Times-Roman>
### Top DICT INDEX (0000001b)
count  =1
offSize=1
--- offset[index]=value
[0]=1 [1]=31
--- object[index]=<value>
[0]=<391 version 392 FullName 393 FamilyName 389 Weight 28416
UniqueID -168 -218 1000 898 FontBBox 94 CharStrings 45 102 Private>
### String INDEX (0000003e)
count  =3
offSize=1
--- offset[index]=value
[0]=1 [1]=8 [2]=19 [3]=24
--- object[index]=<value>
[0]=<001.007> [1]=<Times Roman> [2]=<Times>
### Global Subrs INDEX (0000005c)
count  =0
### CharStrings INDEX (0000005e)
count  =2
offSize=1
--- offset[index]=value
[0]=1 [1]=2 [2]=3
--- object[index]=<value>
[0]=<endchar> [1]=<endchar>
### Private DICT (00000066)
-14 14 662 14 -226 10 223 0 BlueValues 262 8 -488 1 OtherBlues
-14 14 450 10 202 14 FamilyBlues -218 1 479 8 124 0 FamilyOtherBlues
28 StdHW 84 StdVW 250 defaultWidthX

52

Appendix D Example CFF Font

(4 Dec 03)

Appendix E
PostScript File Structure

CFF data is enclosed in a wrapper and treated as a file when used
by a PostScript interpreter that supports the FontSet resource. The
wrapper allows the file to be directly executed by the interpreter,
and permits insertion or removal by a DSC (Document Structuring
Convention)-aware  driver.  A  well-formatted  FontSet  file  has  the
following structure:

%!PS-Adobe-3.0 Resource-FontSet
%%DocumentNeededResources: ProcSet (FontSetInit)
%%EndComments
%%IncludeResource: ProcSet (FontSetInit)
%%BeginResource: FontSet (<fontsetname>)
%%Title: (FontSet/<fontsetname>)
%%Version: <realversion> [<intrevision>]
/FontSetInit /ProcSet findresource begin
%%BeginData: <m> Binary Bytes
/<fontsetname> <n> StartData<space><n-binary-data-bytes>
%%EndData
%%EndResource
%%EOF

A single space (0x20) follows the StartData procedure call which is
followed  immediately  by  <n>  binary  data  bytes.  Note  that  the
%%EndData  DSC  comment  must  be  preceded  by  a  newline
character (that is not part of the binary data) so that it is correctly
parsed. The count <m> in the %%BeginData: DSC is greater than
that  used  by  the  StartData  procedure  call  by  the  number  of
characters in the call itself.

All the (0) offsets in the <binary data> are relative to the start of
the  <binary  data>.  That  is,  the  byte  following  the  space  that
terminates StartData is numbered 0.

53

54

Appendix E PostScript File Structure

(4 Dec 03)

Appendix F
Embedded PostScript

A Top DICT may contain at most one embedded PostScript oper-
ator. It must be in the main font dictionary, not in the Private
dictionary. If present, this string is executed after the font dictio-
nary has been completely constructed, but before definefont. At
that time, the interpreter:

(cid:127) Pushes the top-level font dictionary (that is under construc-

tion) on the dictionary stack;

(cid:127) Executes the PostScript string;

(cid:127) Pops the dictionary stack.

At the time of execution, the FontInfo, Encoding, CharStrings,
and all other elements of the font dictionary have been defined,
including ones that are set to default values. (There is no Private
dictionary, however. In CFF, the Private dictionary is never pro-
cessed as PostScript, so there is no opportunity for embedded
PostScript to alter it.)

A CFF CIDFont may contain an embedded PostScript operator in
the Top DICT or in any FDs.

If it is in the Top DICT, the embedded PostScript string is pro-
cessed as described above. This occurs after the font dictionary
has been completely constructed (including all FDArray sub-dic-
tionaries), but before definefont.

If it is in one of the nested sub-dictionaries in the FDArray, it is
executed after the sub-dictionary has been completely con-
structed (including default values), but before it has been incor-
porated as an element of the main font dictionary. The sub-
dictionary is on the dictionary stack; there is no way to access the
main dictionary.

55

A CFF consumer that does not interpret PostScript can ignore the
embedded PostScript string. The font should still work, but with-
out the feature that the embedded PostScript would have acti-
vated.

When OpenType fonts are converted into CFF for embedding in
a document, the font embedding information specified by the
FSType bits, and the type of the original font, should be included
in the resulting file. (See Technical Note #5147: “Font Embed-
ding Guidelines for Adobe Third-party Developers,” for more
information.)

The embedding information is added to the Top DICT using the
PostScript operator (12 21) with a SID operand. The SID points to
a string containing the PostScript commands and arguments in
the String INDEX. The following is an example of the PostScript
that might be included:

 /FSType 8 def /OrigFontType /OpenType def

56

Appendix F Embedded PostScript

(4 Dec 03)

Appendix G
Related Documentation

The following documents may be consulted for further
information on Adobe font technology. All are available at
http://partners.adobe.com/asn/developer/technotes.html.

(cid:127) Adobe Type 1 Font Format. Addison-Wesley, 1991; ISBN 0-

201-57044-0.

(cid:127) PostScript Language Reference, Third Edition. Addison-

Wesley, 1999; ISBN 0-201-37922-8.

(cid:127) Technical Note #5014: “Adobe CMap and CIDFont Files

Specification.”

(cid:127) Technical Note #5015: “The Type 1 Font Format

Supplement.” This document contains all updates to the
Type 1 format.

(cid:127) Technical Note #5040: “Supporting Downloadable PostScript
Fonts.” Describes how Type 1 fonts have traditionally been
packaged for use in the Macintosh® and Windows®
environments – specifically, the use of POST resources for
Macintosh fonts and the PFB compressed binary format for
Windows fonts.

(cid:127) Technical Note #5088: “Font Naming Issues.” In addition to a

discussion of general font name issues, this document
explains the naming conventions for multiple master fonts.

(cid:127) Technical Note #5092: “CID-Keyed Font File Format

Overview.”

(cid:127) Technical Note #5177: “Type 2 Charstring Format.”

57

(cid:127) Technical Note #5147: “Font Embedding Guidelines for

Adobe Third-party Developers.”

58

Appendix G Related Documentation

(4 Dec 03)

Appendix H
CFF DICT Encoding

One-byte CFF DICT Operators

Dec

Hex Operator

Dec

Hex

Operator

0

1

2

3

4

5

6

7

8

9

10

11

121

13

14

15

16

17

00

01

02

03

04

05

06

07

08

09

0a

0b

0c

0d

0e

0f

10

11

version

Notice

FullName

FamilyName

Weight

FontBBox

BlueValues

OtherBlues

FamilyBlues

FamilyOtherBlues

StdHW

StdVW

escape

UniqueID

XUID

charset

Encoding

CharStrings

18

19

20

21

22

23

24

25

26

27

282

29

30

31

12

13

14

15

16

17

18

19

1a

1b

1c

1d

1e

1f

Private

Subrs

defaultWidthX

nominalWidthX

-Reserved-

-Reserved-

-Reserved-

-Reserved-

-Reserved-

-Reserved-

shortint

longint

BCD

-Reserved-

32–246

20–f6

<numbers>

247–2543

f7–fe

<numbers>

255

ff

-Reserved-

1. First byte of a 2-byte operator.

2. First byte of a 3-byte sequence specifying a number.

3. First byte of a 2-byte sequence specifying a number.

59

Two-byte CFF DICT Operators

Dec

Hex

Operator

Dec

Hex

Operator

12 0

12 1

12 2

12 3

12 4

12 5

12 6

12 7

12 8

12 9

0c 00

Copyright

0c 01

isFixedPitch

0c 02

ItalicAngle

0c 03

UnderlinePosition

0c 04

UnderlineThickness

0c 05

PaintType

0c 06

CharstringType

0c 07

FontMatrix

0c 08

StrokeWidth

0c 09

BlueScale

12 10

0c 0a

BlueShift

12 11

0c 0b

BlueFuzz

12 12

0c 0c

StemSnapH

12 13

0c 0d

StemSnapV

12 14

0c 0e

ForceBold

12 15

0c 0f

-Reserved-

12 16

0c 10

-Reserved-

12 17

0c 11

LanguageGroup

12 18

0c 12

ExpansionFactor

12 19

0c 13

initialRandomSeed

12 20

0c 14

SyntheticBase

12 21

12 22

12 23

12 24

12 25

12 26

12 27

12 28

12 29

12 30

12 31

12 32

12 33

12 34

12 35

12 36

12 37

12 38

0c 15

0c 16

0c 17

0c 18

0c 19

0c 1a

PostScript

BaseFontName

BaseFontBlend

-Reserved-

-Reserved-

-Reserved-

0c 1b

-Reserved-

0c 1c

0c 1d

0c 1e

0c 1f

0c 20

0c 21

0c 22

0c 23

0c 24

0c 25

0c 26

-Reserved-

-Reserved-

ROS

CIDFontVersion

CIDFontRevision

CIDFontType

CIDCount

UIDBase

FDArray

FDSelect

FontName

-Reserved-

12 39–

12 255

0c 27–
0c ff

60

Appendix H CFF DICT Encoding

(4 Dec 03)

Appendix I
Changes Since Earlier
Versions

The following changes and revisions have been made since the
initial publication date of 18 November 1996.

Changes in the 4 December 2003 document

(cid:127) Appendix D, Embedded PostScript – added information

about how to include FSType information when OpenType
fonts are converted into CFF.

Changes in the 16 March 2000 document

(cid:127) Removed all material about multiple master and chameleon

fonts.

(cid:127) Section 4, DICT Data – specified the order of nibble data

stored in a byte; also specified the range of values in the first
byte of an operator or operand that can be used to
distinguish between operators and operands.

(cid:127) Section 12, Encodings – clarified that glyphs not specified by

custom or predefined encodings are, by definition,
unencoded.

(cid:127) Section 15, Private DICT Data – added statement that Private
DICT is required, but may be specified as having 0 length.

(cid:127) Section 15, Private DICT Data – removed entries for

ForceBoldThreshhold and lenIV from Table 23.

(cid:127) Section 17, PS File Structure – moved this section to Appendix
E; the previous Appendix E and all subsequent appendices
moved accordingly.

(cid:127) Section 18, Copyright and Trademark Notices – removed

entire section.

61

(cid:127) Section 22, FDSelect – added clarification of the values of

GIDs.

(cid:127) Added appendix summarizing CFF DICT encoding.

Note

The version number of the format has not changed for this revision.

Changes in the 18 March 1998 document

(cid:127) Table 25, it was noted that the only value supported for

lenIV is –1.

(cid:127) Section 13, Charsets – statement added that CID fonts must

not use predefined charsets.

(cid:127) Section 22, FDSelect – first paragraph; the FD index is used to
access one of the Font DICTs stored in the Font DICT INDEX
(not the previously stated “FDArray”).

Changes in the 15 October 1997 document

(cid:127) Minor changes were made to clarify existing text.

(cid:127) In Table 2, the string id range was changed to 0–64999.

(cid:127) In Table 9, the default for the FontBBox array was specified as

“0 0 0 0”.

(cid:127) The specification of multiple master fonts was changed in

several sections.

(cid:127) Section 17, PostScript File Structure – corrections made to

DSC comments.

(cid:127) Section 19, Synthetic Fonts – new capability added to specify

encodings for synthetic fonts.

(cid:127) Appendix D, Example CFF Font – corrected operator name in

example; FamilyBlueValues changed to FamilyBlues.

Changes in the 16 December 1996 document

A variety of minor changes were made to clarify existing text;
the technical content was not affected.

62

Appendix I Changes Since Earlier Versions

(4 Dec 03)



=== Content from kb.itextpdf.com_b7ce558a_20250115_204409.html ===


[Skip to main content](#content)

Show navigation

* [![](../__assets-6ad25673-bdae-4c81-a7b8-2451626f421b/image/ITSC-Logo-Horizontal-RGB-300dpi.png)
  Go to homepage](../?l=en)

* [iText Website](https://itextpdf.com/)
* [Blog](https://itextpdf.com/en/blog)
* [Support](https://itextpdf.com/en/support)
* [Community](https://itextpdf.com/en/welcome-itext-community)

1. [iText](../itext/)
   /
2. [Releases](../itext/releases)

[Skip table of contents](#article-inner-content)

# Release iText Core 7.2.2

#### Release date: April 11, 2022

It's already Q2 of 2022, and so we're pleased to announce the release of iText Core 7.2.2. Your favorite PDF library for Java and .NET ([and more!](https://itextpdf.com/en/products/itext-7/itext-7-suite-byol-aws)).

On the Java side we've updated some dependencies such as Bouncy Castle to 1.70, Log4j to 1.7.33, and Logback to 1.2.10. For .NET the `System.Text.RegularExpressions` dependency is now explicit rather than implicit, and uses version 4.3.1.

We've made some improvements to iText's parsing logic for PDF cross-reference structures. This was to prevent the potential for a PDF's structure to be maliciously created to cause infinite loops or other issues. See the example linked below for more details.

We've also fixed a bug relating to CFF font parsing. As noted in the [specification](https://adobe-type-tools.github.io/font-tech-notes/pdfs/5176.CFF.pdf), CFF is a font format which was developed by Adobe to act as a compact container for one or more fonts by using lossless compression. In cases when a font's CID does not correspond to its GID, iText could incorrectly read its cmap values resulting in incorrect glyphs being displayed in PDF viewers. To address this, the font parsing logic has been rewritten to account for fonts where the glyph IDs do not match the CIDs, and will now handle them in the correct and expected manner.

This release also addresses two CVE issues ([CVE-2022-24196](https://nvd.nist.gov/vuln/detail/CVE-2022-24196), and [CVE-2022-24197](https://nvd.nist.gov/vuln/detail/CVE-2022-24197)) which were disclosed. See the Changelog or the linked issues for more details.

As always, we try to synchronize the release of iText 7 Core with releases of the iText 7 add-ons making up the rest of the iText 7 Suite. So, besides Core, be sure to also check out:

## iText 7 Suite Releases

* [Release pdfCalligraph 3.0.1](../itext/release-pdfcalligraph-3-0-1)
* [Release pdfHTML 4.0.2](../itext/release-pdfhtml-4-0-2)
* [Release pdfOffice 2.0.2](../itext/release-pdfoffice-2-0-2)
* [Release pdfXFA 3.0.1](../itext/release-pdfxfa-3-0-1)
* [Release RUPS 7.2.2](../itext/release-rups-7-2-2)
## Release Related Examples

* [pdfHTML: more accurate rendering of checkboxes](../itext/pdfhtml-more-accurate-rendering-of-checkboxes)
* [pdfOffice: improved conversion of docx files containing embedded videos](../itext/pdfoffice-improved-conversion-of-docx-files-contai)
* [pdfOffice: improved conversion of docx files with repeating table header on new page](../itext/pdfoffice-improved-conversion-of-docx-files-with-r)
* [Safeguards against loops in cross-reference structure of PDF files](../itext/safeguards-against-loops-in-cross-reference-struct)

**Downloads:**

|  | [GitHub](https://github.com/itext/) | [Maven](https://mvnrepository.com/artifact/com.itextpdf) | [NuGet](https://www.nuget.org/profiles/iText) | [Artifactory](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/) |
| --- | --- | --- | --- | --- |
| [iText 7 Core](https://itextpdf.com/en/products/itext-7/itext-7-core) â 7.2.2 ([Java](https://api.itextpdf.com/iText7/java/7.2.2/)) | [link](https://github.com/itext/itext7/releases/tag/7.2.2) | [link](https://search.maven.org/artifact/com.itextpdf/itext7-core/7.2.2/pom) | N/A | [link](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/releases/com/itextpdf/root/7.2.2) |
| [iText 7 Core](https://itextpdf.com/en/products/itext-7/itext-7-core) â 7.2.2 ([.NET](https://api.itextpdf.com/iText7/dotnet/7.2.2/)) | [link](https://github.com/itext/itext7-dotnet/releases/tag/7.2.2) | N/A | [link](https://www.nuget.org/packages/itext7/7.2.2) | [link](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/nuget/itext7/itext7.7.2.2.nupkg) |

## Improvements

* Updated some Java dependencies (Bouncy Castle 1.70, Logback 1.2.10, slf4j 1.7.33)
* Updated (or rather make it explicit) a .NET dependency (System.Text.RegularExpressions 4.3.1)
* Revised cross-reference parsing logic

## Bugs

* Fixed [CFF](https://adobe-type-tools.github.io/font-tech-notes/pdfs/5176.CFF.pdf) font-parsing logic
* CVE fixes
  + CVE-2022-24196 - out-of-memory error via the component readStreamBytesRaw
  + CVE-2022-24197 - stack-based buffer overflow via the component ByteBuffer.append

### eBooks

* [Best iText 7 Questions on StackOverflow](https://kb.itextpdf.com/home/it7kb/ebooks/best-itext-7-questions-on-stackoverflow)
* [iText 7: Building Blocks](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-building-blocks)
* [iText 7: Jump-Start Tutorial for .NET](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-jump-start-tutorial-for-net)
* [iText 7: Jump-Start Tutorial for Java](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-jump-start-tutorial-for-java)

### Installation Instructions

* [Installing iText Community for .NET developers](../itext/installing-itext-community-for-net-developers)
* [Installing iText Community for Java developers](../itext/installing-itext-community-for-java-developers)
* [Installing iText for .NET](../itext/installing-itext-for-net)
* [Installing iText for Java](../itext/installing-itext-for-java)
### Examples (latest ones)

* [pdfHTML: Custom Tagworker examples](../itext/pdfhtml-custom-tagworker-examples)
* [Creating a simple PDF/UA document](../itext/creating-a-simple-pdf-ua-document)
* [Custom Metadata entry](../itext/custom-metadata-entry)
* [Large tables](../itext/large-tables)
* [Language-specific examples](../itext/language-specific-examples)
### FAQ (latest ones)

* [I upgraded to iText version 7 or 8, how do I use my license?](../itext/i-upgraded-to-itext-7-how-do-i-use-my-license)
* [How to change a background Image into a watermark by altering the opacity?](../itext/how-to-change-a-background-image-into-a-watermark-)
* [How to change the text color of an AcroForm field?](../itext/how-to-change-the-text-color-of-an-acroform-field)
* [Is it safe to remove XFA?](../itext/is-it-safe-to-remove-xfa)
* [How to fill XFA form using iText without breaking usage rights?](../itext/how-to-fill-xfa-form-using-itext-without-breaking-)
×

![](../__theme/footer-logo--f92dd2820b24ad5bb8be.svg)

[About Us](https://itextpdf.com/en/about-us)
/ [News](https://itextpdf.com/en/blog)
/ [Jobs](https://itextpdf.com/en/jobs)
/ [Open Source AGPL license](https://itextpdf.com/en/how-buy/agpl-license)
/ [Commercial & OEM licenses](https://itextpdf.com/en/how-buy)

* Copyright © 2025 iText
* •
  Powered by
  [Scroll Viewport](https://www.k15t.com/go/scroll-viewport-cloud-help-center)
  &
  [Atlassian Confluence](https://www.atlassian.com/software/confluence)

JavaScript errors detected

Please note, these errors can depend on your browser setup.

If this problem persists, please contact our support.

[Contact Support](https://k15t.jira.com/servicedesk/customer/portal/3)
Close



=== Content from github.com_9bcb8020_20250114_231002.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Freleases%2Ftag%2F7.1.18)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Freleases%2Ftag%2F7.1.18)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=itext%2Fitext-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[itext](/itext)
/
**[itext-java](/itext/itext-java)**
Public

* [Notifications](/login?return_to=%2Fitext%2Fitext-java) You must be signed in to change notification settings
* [Fork
  457](/login?return_to=%2Fitext%2Fitext-java)
* [Star
   2.1k](/login?return_to=%2Fitext%2Fitext-java)

* [Code](/itext/itext-java/tree/7.1.18)
* [Pull requests
  73](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects
  0](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

Additional navigation options

* [Code](/itext/itext-java/tree/7.1.18)
* [Pull requests](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

1. [Releases](/itext/itext-java/releases)
2. [7.1.18](/itext/itext-java/releases/tag/7.1.18)

# iText Core/Community 7.1.18

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/itext/itext-java/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...7.1.18)

 Loading

[View all tags](/itext/itext-java/tags)

![@introfog](https://avatars.githubusercontent.com/u/25721839?s=40&v=4)
[introfog](/introfog)
released this
16 Dec 14:18

·
[1248 commits](/itext/itext-java/compare/7.1.18...develop)
to develop
since this release

[7.1.18](/itext/itext-java/tree/7.1.18)

This tag was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/12270680?s=64&v=4)](/iText-CI)
[iText-CI](/iText-CI)
iText Continuous Integration

GPG key ID: 035FD9539EE015A2

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`6c7d50c`](/itext/itext-java/commit/6c7d50c4edaaa16de30dcdb4990350a3262609c9)

The iText 7 Core 7.1.18 release is a maintenance release for iText 7.1.x which includes some recent CVE mitigations and backports from 7.2.x releases.

It addresses two CVE issues ([CVE-2022-24196](https://nvd.nist.gov/vuln/detail/CVE-2022-24196), [CVE-2022-24197](https://nvd.nist.gov/vuln/detail/CVE-2022-24197)) which were fixed in the release of [iText 7 Core 7.2.2](https://kb.itextpdf.com/home/it7kb/releases/release-itext-core-7-2-2). In addition, we've also backported a fix from our [7.2.1](https://kb.itextpdf.com/home/it7kb/releases/release-itext-core-7-2-1) release which fixes improper nesting of canvas operators when converting SVG to PDF by supporting q/Q Operators inside BT/ET text blocks and objects.

 Assets
4

 Loading

 👍
1
 Han0nly reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

 1 person reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_36715954_20250114_231001.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=itext%2Fitext-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[itext](/itext)
/
**[itext-java](/itext/itext-java)**
Public

* [Notifications](/login?return_to=%2Fitext%2Fitext-java) You must be signed in to change notification settings
* [Fork
  457](/login?return_to=%2Fitext%2Fitext-java)
* [Star
   2.1k](/login?return_to=%2Fitext%2Fitext-java)

* [Code](/itext/itext-java)
* [Pull requests
  73](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects
  0](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

Additional navigation options

* [Code](/itext/itext-java)
* [Pull requests](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fitext%2Fitext-java%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fitext%2Fitext-java%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# A list of bugs found #78

 Closed

[ZanderHuang](/ZanderHuang)
wants to merge
1
commit into
[itext:develop](/itext/itext-java/tree/develop "itext/itext-java:develop")
from
[ZanderHuang:bugs\_report](/ZanderHuang/itext7/tree/bugs_report "ZanderHuang/itext7:bugs_report")

 Closed

# [A list of bugs found](#top) #78

[ZanderHuang](/ZanderHuang)
wants to merge
1
commit into
[itext:develop](/itext/itext-java/tree/develop "itext/itext-java:develop")
from
[ZanderHuang:bugs\_report](/ZanderHuang/itext7/tree/bugs_report "ZanderHuang/itext7:bugs_report")

[Conversation
8](/itext/itext-java/pull/78)
[Commits
1](/itext/itext-java/pull/78/commits)
[Checks
0](/itext/itext-java/pull/78/checks)
[Files changed](/itext/itext-java/pull/78/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=60&v=4)](/ZanderHuang)

Copy link

### @ZanderHuang **[ZanderHuang](/ZanderHuang)** commented [Oct 26, 2021](#issue-1036531715) • edited Loading

## Unqiue Bugs Found

Recently we ([Zhang Cen](https://github.com/occia) , [Huang Wenjie](https://github.com/ZanderHuang) and [Zhang Xiaohan](https://github.com/Han0nly)) discovered a series of bugs in latest itextpdf (version 7.1.17).
Every bug we reported in the following is unique and reproducable. Furthermore, they have been manually analyzed and triaged in removing the duplicates.

Due to the lack of contextual knowledge in the itextpdf library, we cannot thoroughly fix some bugs hence we look forward to any proposed plan from the developers in fixing these bugs.

## Bug Report

The bug report folder can be downloaded from <https://drive.google.com/drive/folders/1b38Mi8fKp05vzMbth1oiopFYNH92GWrK?usp=sharing>

Total 56 bugs are reported in this pull request.

A full list is provided below.

### Folder structure

* Level 1 (folder): exception type
* Level 2 (folder): error location
* Level 3 (files): POC file and **report.txt** including reproducing steps

### report.txt content:

1. Exception type
2. Error location
3. Bug cause and impact
4. Crash thread's stacks
5. Steps to reproduce

### Bug full list

1. java.lang.ArrayIndexOutOfBoundsException

   -- com.itextpdf.kernel.crypto.ARCFOUREncryption.encryptARCFOUR--ARCFOUREncryption.java-93

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard128.computeOwnerKey--StandardHandlerUsingStandard128.java-81

   -- com.itextpdf.kernel.pdf.PdfXrefTable.clear--PdfXrefTable.java-448

   -- com.itextpdf.kernel.pdf.PdfXrefTable.get--PdfXrefTable.java-153

   -- com.itextpdf.kernel.pdf.PdfXrefTable.initFreeReferencesList--PdfXrefTable.java-185
2. java.lang.ClassCastException

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard40.initKeyAndReadDictionary--StandardHandlerUsingStandard40.java-193

   -- com.itextpdf.kernel.pdf.PdfDocument.open--PdfDocument.java-1958

   -- com.itextpdf.kernel.pdf.PdfEncryption.readAndSetCryptoModeForStdHandler--PdfEncryption.java-531

   -- com.itextpdf.kernel.pdf.PdfEncryption.readAndSetCryptoModeForStdHandler--PdfEncryption.java-534

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344
3. java.lang.NegativeArraySizeException

   -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598
4. java.lang.NullPointerException

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard40.initKeyAndReadDictionary--StandardHandlerUsingStandard40.java-194

   -- com.itextpdf.kernel.crypto.securityhandler.StandardSecurityHandler.getIsoBytes--StandardSecurityHandler.java-94

   -- com.itextpdf.kernel.pdf.PdfArray.get--PdfArray.java-374

   -- com.itextpdf.kernel.pdf.PdfObjectWrapper.markObjectAsIndirect--PdfObjectWrapper.java-141

   -- com.itextpdf.kernel.pdf.PdfReader.getOriginalFileId--PdfReader.java-669

   -- com.itextpdf.kernel.pdf.PdfReader.readDecryptObj--PdfReader.java-1287

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-738

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-739

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-740

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-773

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-792
5. java.lang.NumberFormatException

   -- com.itextpdf.io.source.PdfTokenizer.getIntValue--PdfTokenizer.java-512

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-315
6. java.lang.OutOfMemoryError

   -- com.itextpdf.kernel.pdf.PdfReader.readStreamBytesRaw--PdfReader.java-391

   -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598
7. java.lang.StackOverflowError

   -- com.itextpdf.io.source.ByteBuffer.append--ByteBuffer.java-110

   -- com.itextpdf.io.source.PdfTokenizer.getStringValue--PdfTokenizer.java-187

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-341

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-343

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-361

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-377

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-413

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-452

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-469

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-271

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-300

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-306

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314

   -- com.itextpdf.io.source.RandomAccessFileOrArray.read--RandomAccessFileOrArray.java-138

   -- com.itextpdf.io.util.MessageFormatUtil.format--MessageFormatUtil.java-55

   -- com.itextpdf.kernel.pdf.PdfDictionary.putAll--PdfDictionary.java-333

   -- com.itextpdf.kernel.pdf.PdfName.compareTo--PdfName.java-1003

   -- com.itextpdf.kernel.pdf.PdfNumber.generateValue--PdfNumber.java-180

   -- com.itextpdf.kernel.pdf.PdfReader.readArray--PdfReader.java-944

   -- com.itextpdf.kernel.pdf.PdfReader.readDictionary--PdfReader.java-923

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1336

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-801

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-845

   -- com.itextpdf.kernel.pdf.PdfReader.readPdfName--PdfReader.java-912

   -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-817

   -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-834
8. java.lang.StringIndexOutOfBoundsException

   -- com.itextpdf.io.source.PdfTokenizer.checkPdfHeader--PdfTokenizer.java-239

Any further discussion for these vulnerabilities including fix is welcomed and look forward to hearing from you.

Sorry, something went wrong.

All reactions

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=40&v=4)](/ZanderHuang)

`[Create bugs_report.md](/itext/itext-java/pull/78/commits/fe6bb222cc46fdd85470bc3333bcf3e023d58918 "Create bugs_report.md

bugs_report.md contains a series of bugs which are unique and reproducible.")`
 …

`[fe6bb22](/itext/itext-java/pull/78/commits/fe6bb222cc46fdd85470bc3333bcf3e023d58918)`

```
bugs_report.md contains a series of bugs which are unique and reproducible.
```

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=40&v=4)](/ZanderHuang)
[ZanderHuang](/ZanderHuang)
changed the title
~~Create bugs\_report.md~~
A list of bugs found
[Nov 3, 2021](#event-5564830348)

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=80&v=4)](/ZanderHuang)

Copy link

Author

### **[ZanderHuang](/ZanderHuang)** commented [Nov 13, 2021](#issuecomment-968119805)

| Hi itext7 Team, any updates on the issues mentioned? [@Snipx](https://github.com/Snipx) |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Nov 30, 2021](#issuecomment-982983688)

| Hi [@ZanderHuang](https://github.com/ZanderHuang), thank you for reporting the issues to us. We have acknowledged them and agree that handling invalid input could have been done better on iText library side. While we don't have any updates to share at this point, we would certainly welcome any Pull Requests that attempt to fix the problems and we could collaborate on converging towards the proper fix in the scope of individual PRs.  We don't expose GitHub's *Issues* functionality at this point, hence I am closing this PR as it's more of an *Issue* rather than a *PR* but rest assured we got the message. Thanks again |
| --- |

 👍
1
 ZanderHuang reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=40&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)
[Snipx](/Snipx)
closed this
[Nov 30, 2021](#event-5694505381)

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Dec 28, 2021](#issuecomment-1002312677)

| Hi [@ZanderHuang](https://github.com/ZanderHuang), would you mind signing our CLA (details available at <https://itextpdf.com/en/how-buy/legal/itext-contributor-license-agreement>) so that we are able to use your files in our tests? |
| --- |

All reactions

Sorry, something went wrong.

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issuecomment-1022914579) • edited Loading

| Hi [@Snipx](https://github.com/Snipx) , I'm the collaborator of [@ZanderHuang](https://github.com/ZanderHuang), we are willing to donate our test cases. I'll sign the CLA document and send it to dev.intern@itextpdf.com using my Github public email address. |
| --- |

 👍
1
 Snipx reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089279222) • edited Loading

| java.lang.OutOfMemoryError -- com.itextpdf.kernel.pdf.PdfReader.readStreamBytesRaw--PdfReader.java-391 -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24196>  This has been fixed in commit [3213363](https://github.com/itext/itext-java/commit/321336392695ead6f071cb60240956282d254782)  The fix is available in 7.2.2 |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089282165)

| java.lang.StackOverflowError -- com.itextpdf.io.source.ByteBuffer.append--ByteBuffer.java-110 -- com.itextpdf.io.source.PdfTokenizer.getStringValue--PdfTokenizer.java-187 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-341 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-343 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-361 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-377 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-413 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-452 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-469 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-271 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-300 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-306 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314 -- com.itextpdf.io.source.RandomAccessFileOrArray.read--RandomAccessFileOrArray.java-138 -- com.itextpdf.io.util.MessageFormatUtil.format--MessageFormatUtil.java-55 -- com.itextpdf.kernel.pdf.PdfDictionary.putAll--PdfDictionary.java-333 -- com.itextpdf.kernel.pdf.PdfName.compareTo--PdfName.java-1003 -- com.itextpdf.kernel.pdf.PdfNumber.generateValue--PdfNumber.java-180 -- com.itextpdf.kernel.pdf.PdfReader.readArray--PdfReader.java-944 -- com.itextpdf.kernel.pdf.PdfReader.readDictionary--PdfReader.java-923 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1336 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-801 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-845 -- com.itextpdf.kernel.pdf.PdfReader.readPdfName--PdfReader.java-912 -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-817 -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-834  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24197>  This has been fixed in commit [88c9cb7](https://github.com/itext/itext-java/commit/88c9cb7ec7befa096d83206419506ec5c7664912)  The fix is available in 7.2.2 |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089287808)

| java.lang.ArrayIndexOutOfBoundsException -- com.itextpdf.kernel.crypto.ARCFOUREncryption.encryptARCFOUR--ARCFOUREncryption.java-93 -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard128.computeOwnerKey--StandardHandlerUsingStandard128.java-81 -- com.itextpdf.kernel.pdf.PdfXrefTable.clear--PdfXrefTable.java-448 -- com.itextpdf.kernel.pdf.PdfXrefTable.get--PdfXrefTable.java-153 -- com.itextpdf.kernel.pdf.PdfXrefTable.initFreeReferencesList--PdfXrefTable.java-185  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24198>  This is not something we agree with at this point It's not clear what kind of DDoS we can get.  We do confirm that the provided code sample triggers ArrayIndexOutOfBoundsException in our Java library. We don't see any description of the potential exploitation of this. The fact that the user of the library may not know that this exception can be thrown does not by itself mean that we have a vulnerability in the library and that cannot be associated with Denial of Service vulnerability in our opinion. Java is the programming language that safeguards against buffer overflow attacks and therefore nothing related to information leakage is applicable here. We do agree that the library could have thrown a better exception but the fact that it throws ArrayIndexOutOfBoundsException is not by itself a vulnerability, and no case supporting that this behavior may be exploited to cause DoS has been presented to us. |
| --- |

 👍
4
 avlemos, introfog, SanketS-CX, and yulian-gaponenko reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Vsevolod-Bro](https://avatars.githubusercontent.com/u/73461682?s=40&v=4)](/Vsevolod-Bro)
[Vsevolod-Bro](/Vsevolod-Bro)
mentioned this pull request
[Jun 20, 2022](#ref-issue-1276286441)

[[FP]: CVE-2022-24198 in kernel-7.2.2.jar
jeremylong/DependencyCheck#4613](/jeremylong/DependencyCheck/issues/4613)

Closed

[![@helloimvincent](https://avatars.githubusercontent.com/u/51130790?s=80&v=4)](/helloimvincent)

Copy link

### **[helloimvincent](/helloimvincent)** commented [Nov 2, 2022](#issuecomment-1299754562) • edited Loading

| Hi, can check if this CVE affects iText 5 libraries as well? Because iText 5 is listed under the known affected software configurations for this CVE in NVD website. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=52&v=4)](/ZanderHuang) [![@Snipx](https://avatars.githubusercontent.com/u/695313?s=52&v=4)](/Snipx) [![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=52&v=4)](/Han0nly) [![@helloimvincent](https://avatars.githubusercontent.com/u/51130790?s=52&v=4)](/helloimvincent)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from kb.itextpdf.com_77cb2cbc_20250115_130159.html ===


[Skip to main content](#content)

Show navigation

* [![](../__assets-6ad25673-bdae-4c81-a7b8-2451626f421b/image/ITSC-Logo-Horizontal-RGB-300dpi.png)
  Go to homepage](../?l=en)

* [iText Website](https://itextpdf.com/)
* [Blog](https://itextpdf.com/en/blog)
* [Support](https://itextpdf.com/en/support)
* [Community](https://itextpdf.com/en/welcome-itext-community)

1. [iText](../itext/)
   /
2. [Releases](../itext/releases)

[Skip table of contents](#article-inner-content)

# Release iText Core 7.2.1

#### Release date: January 11, 2022

iText Core 7.2.1 is the latest release of your favorite PDF library for Java and .NET ([and more!](https://itextpdf.com/en/products/itext-7/itext-7-suite-byol-aws)), and the first scheduled maintenance release for iText 7.2. It brings further improvements for SVG conversion, supporting default values for the `d` attribute of the `path` tag and improving PDF output, which in previous versions could be rendered incorrectly by some PDF viewers, such as Safari and View (macOS), and Documents (iOS). Please see the release-related examples to get a full insight into these changes, and as usual, pdfHTML also benefits from any SVG handling changes..

As for PDF merging functionality, we should note more intelligent outline handling, which is no longer as strict and can fix some syntax mistakes in the Outlines hierarchy. For instance, absence of the parent attribute which is mandatory in the PDF specification is not an issue anymore.

We'd also like to thank the iText community for its contributions, specifically; [realityone](https://github.com/realityone), with a really important and impactful [fix for incompatibility with PDF standards](https://github.com/itext/itext7/pull/81) in our codebase and [kohler](https://github.com/kohler), whose PR helped us a lot in our efforts to [process PDF outlines better](https://github.com/itext/itext7/pull/46). We are happy to see that after 21 years there is still so much interest in improving the iText library.

You can also expect other changes such as a number of bug fixes, plus some significant improvements to the codebase. we've provided some examples below to give you more insight and demonstrate use cases.

As always, we try to synchronize the release with those of our iText 7 add-ons. So, besides Core, be sure to also check out:

## iText 7 Suite Releases

* [Release pdfHTML 4.0.1](../itext/release-pdfhtml-4-0-1)
* [Release pdfOCR 2.0.1](../itext/release-pdfocr-2-0-1)
* [Release pdfOffice 2.0.1](../itext/release-pdfoffice-2-0-1)
* [Release pdfOptimizer 2.0.1](../itext/release-pdfoptimizer-2-0-1)
* [Release pdfRender 2.0.1](../itext/release-pdfrender-2-0-1)
* [Release RUPS 7.2.1](../itext/release-rups-7-2-1)
## Release Related Examples

* [Fail-safe processing of Outlines without Parent link](../itext/fail-safe-processing-of-outlines-without-parent-li)
* [Improving SVG to PDF conversion](../itext/improving-svg-to-pdf-conversion)
* [pdfOffice: Spreadsheet To PDF Support](../itext/pdfoffice-spreadsheet-to-pdf-support)

**Downloads:**

|  | [GitHub](https://github.com/itext/) | [Maven](https://mvnrepository.com/artifact/com.itextpdf) | [NuGet](https://www.nuget.org/profiles/iText) | [Artifactory](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/) |
| --- | --- | --- | --- | --- |
| [iText 7 Core](https://itextpdf.com/en/products/itext-7/itext-7-core) â 7.2.1 ([Java](https://api.itextpdf.com/iText7/java/7.2.1/)) | [link](https://github.com/itext/itext7/releases/tag/7.2.1) | [link](https://search.maven.org/artifact/com.itextpdf/itext7-core/7.2.1/pom) | N/A | [link](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/releases/com/itextpdf/root/7.2.1) |
| [iText 7 Core](https://itextpdf.com/en/products/itext-7/itext-7-core) â 7.2.1 ([.NET](https://api.itextpdf.com/iText7/dotnet/7.2.1/)) | [link](https://github.com/itext/itext7-dotnet/releases/tag/7.2.1) | N/A | [link](https://www.nuget.org/packages/itext7/7.2.1) | [link](https://repo.itextsupport.com/webapp/#/artifacts/browse/tree/General/nuget/itext7/itext7.7.2.1.nupkg) |

## Improvements

* SVG: Support default value for <path> 'd" attribute
* Process Outlines using explicit hierarchy
* support of copying empty tags

## Bugs

* Outlines structure parsing: infinite loop while merging with outlines
* SVG. Support of q/Q Operators inside BT/ET text block/object
* Set PubKeySecurityHandler output stream with DER encoding format
* OcgPropertiesCopier: StackOverflowError when merging documents with OCGs if a resource has cycle reference

### eBooks

* [Best iText 7 Questions on StackOverflow](https://kb.itextpdf.com/home/it7kb/ebooks/best-itext-7-questions-on-stackoverflow)
* [iText 7: Building Blocks](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-building-blocks)
* [iText 7: Jump-Start Tutorial for .NET](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-jump-start-tutorial-for-net)
* [iText 7: Jump-Start Tutorial for Java](https://kb.itextpdf.com/home/it7kb/ebooks/itext-7-jump-start-tutorial-for-java)

### Installation Instructions

* [Installing iText Community for .NET developers](../itext/installing-itext-community-for-net-developers)
* [Installing iText Community for Java developers](../itext/installing-itext-community-for-java-developers)
* [Installing iText for .NET](../itext/installing-itext-for-net)
* [Installing iText for Java](../itext/installing-itext-for-java)
### Examples (latest ones)

* [pdfHTML: Custom Tagworker examples](../itext/pdfhtml-custom-tagworker-examples)
* [Creating a simple PDF/UA document](../itext/creating-a-simple-pdf-ua-document)
* [Custom Metadata entry](../itext/custom-metadata-entry)
* [Large tables](../itext/large-tables)
* [Language-specific examples](../itext/language-specific-examples)
### FAQ (latest ones)

* [I upgraded to iText version 7 or 8, how do I use my license?](../itext/i-upgraded-to-itext-7-how-do-i-use-my-license)
* [How to change a background Image into a watermark by altering the opacity?](../itext/how-to-change-a-background-image-into-a-watermark-)
* [How to change the text color of an AcroForm field?](../itext/how-to-change-the-text-color-of-an-acroform-field)
* [Is it safe to remove XFA?](../itext/is-it-safe-to-remove-xfa)
* [How to fill XFA form using iText without breaking usage rights?](../itext/how-to-fill-xfa-form-using-itext-without-breaking-)
×

![](../__theme/footer-logo--f92dd2820b24ad5bb8be.svg)

[About Us](https://itextpdf.com/en/about-us)
/ [News](https://itextpdf.com/en/blog)
/ [Jobs](https://itextpdf.com/en/jobs)
/ [Open Source AGPL license](https://itextpdf.com/en/how-buy/agpl-license)
/ [Commercial & OEM licenses](https://itextpdf.com/en/how-buy)

* Copyright © 2025 iText
* •
  Powered by
  [Scroll Viewport](https://www.k15t.com/go/scroll-viewport-cloud-help-center)
  &
  [Atlassian Confluence](https://www.atlassian.com/software/confluence)

JavaScript errors detected

Please note, these errors can depend on your browser setup.

If this problem persists, please contact our support.

[Contact Support](https://k15t.jira.com/servicedesk/customer/portal/3)
Close



=== Content from github.com_b043cc4c_20250114_231000.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=itext%2Fitext-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[itext](/itext)
/
**[itext-java](/itext/itext-java)**
Public

* [Notifications](/login?return_to=%2Fitext%2Fitext-java) You must be signed in to change notification settings
* [Fork
  457](/login?return_to=%2Fitext%2Fitext-java)
* [Star
   2.1k](/login?return_to=%2Fitext%2Fitext-java)

* [Code](/itext/itext-java)
* [Pull requests
  73](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects
  0](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

Additional navigation options

* [Code](/itext/itext-java)
* [Pull requests](/itext/itext-java/pulls)
* [Actions](/itext/itext-java/actions)
* [Projects](/itext/itext-java/projects)
* [Wiki](/itext/itext-java/wiki)
* [Security](/itext/itext-java/security)
* [Insights](/itext/itext-java/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fitext%2Fitext-java%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fitext%2Fitext-java%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# A list of bugs found #78

 Closed

[ZanderHuang](/ZanderHuang)
wants to merge
1
commit into
[itext:develop](/itext/itext-java/tree/develop "itext/itext-java:develop")
from
[ZanderHuang:bugs\_report](/ZanderHuang/itext7/tree/bugs_report "ZanderHuang/itext7:bugs_report")

 Closed

# [A list of bugs found](#top) #78

[ZanderHuang](/ZanderHuang)
wants to merge
1
commit into
[itext:develop](/itext/itext-java/tree/develop "itext/itext-java:develop")
from
[ZanderHuang:bugs\_report](/ZanderHuang/itext7/tree/bugs_report "ZanderHuang/itext7:bugs_report")

[Conversation
8](/itext/itext-java/pull/78)
[Commits
1](/itext/itext-java/pull/78/commits)
[Checks
0](/itext/itext-java/pull/78/checks)
[Files changed](/itext/itext-java/pull/78/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=60&v=4)](/ZanderHuang)

Copy link

### @ZanderHuang **[ZanderHuang](/ZanderHuang)** commented [Oct 26, 2021](#issue-1036531715) • edited Loading

## Unqiue Bugs Found

Recently we ([Zhang Cen](https://github.com/occia) , [Huang Wenjie](https://github.com/ZanderHuang) and [Zhang Xiaohan](https://github.com/Han0nly)) discovered a series of bugs in latest itextpdf (version 7.1.17).
Every bug we reported in the following is unique and reproducable. Furthermore, they have been manually analyzed and triaged in removing the duplicates.

Due to the lack of contextual knowledge in the itextpdf library, we cannot thoroughly fix some bugs hence we look forward to any proposed plan from the developers in fixing these bugs.

## Bug Report

The bug report folder can be downloaded from <https://drive.google.com/drive/folders/1b38Mi8fKp05vzMbth1oiopFYNH92GWrK?usp=sharing>

Total 56 bugs are reported in this pull request.

A full list is provided below.

### Folder structure

* Level 1 (folder): exception type
* Level 2 (folder): error location
* Level 3 (files): POC file and **report.txt** including reproducing steps

### report.txt content:

1. Exception type
2. Error location
3. Bug cause and impact
4. Crash thread's stacks
5. Steps to reproduce

### Bug full list

1. java.lang.ArrayIndexOutOfBoundsException

   -- com.itextpdf.kernel.crypto.ARCFOUREncryption.encryptARCFOUR--ARCFOUREncryption.java-93

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard128.computeOwnerKey--StandardHandlerUsingStandard128.java-81

   -- com.itextpdf.kernel.pdf.PdfXrefTable.clear--PdfXrefTable.java-448

   -- com.itextpdf.kernel.pdf.PdfXrefTable.get--PdfXrefTable.java-153

   -- com.itextpdf.kernel.pdf.PdfXrefTable.initFreeReferencesList--PdfXrefTable.java-185
2. java.lang.ClassCastException

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard40.initKeyAndReadDictionary--StandardHandlerUsingStandard40.java-193

   -- com.itextpdf.kernel.pdf.PdfDocument.open--PdfDocument.java-1958

   -- com.itextpdf.kernel.pdf.PdfEncryption.readAndSetCryptoModeForStdHandler--PdfEncryption.java-531

   -- com.itextpdf.kernel.pdf.PdfEncryption.readAndSetCryptoModeForStdHandler--PdfEncryption.java-534

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344
3. java.lang.NegativeArraySizeException

   -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598
4. java.lang.NullPointerException

   -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard40.initKeyAndReadDictionary--StandardHandlerUsingStandard40.java-194

   -- com.itextpdf.kernel.crypto.securityhandler.StandardSecurityHandler.getIsoBytes--StandardSecurityHandler.java-94

   -- com.itextpdf.kernel.pdf.PdfArray.get--PdfArray.java-374

   -- com.itextpdf.kernel.pdf.PdfObjectWrapper.markObjectAsIndirect--PdfObjectWrapper.java-141

   -- com.itextpdf.kernel.pdf.PdfReader.getOriginalFileId--PdfReader.java-669

   -- com.itextpdf.kernel.pdf.PdfReader.readDecryptObj--PdfReader.java-1287

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-738

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-739

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-740

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-773

   -- com.itextpdf.kernel.pdf.PdfReader.readObjectStream--PdfReader.java-792
5. java.lang.NumberFormatException

   -- com.itextpdf.io.source.PdfTokenizer.getIntValue--PdfTokenizer.java-512

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-315
6. java.lang.OutOfMemoryError

   -- com.itextpdf.kernel.pdf.PdfReader.readStreamBytesRaw--PdfReader.java-391

   -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598
7. java.lang.StackOverflowError

   -- com.itextpdf.io.source.ByteBuffer.append--ByteBuffer.java-110

   -- com.itextpdf.io.source.PdfTokenizer.getStringValue--PdfTokenizer.java-187

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-341

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-343

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-361

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-377

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-413

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-452

   -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-469

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-271

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-300

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-306

   -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314

   -- com.itextpdf.io.source.RandomAccessFileOrArray.read--RandomAccessFileOrArray.java-138

   -- com.itextpdf.io.util.MessageFormatUtil.format--MessageFormatUtil.java-55

   -- com.itextpdf.kernel.pdf.PdfDictionary.putAll--PdfDictionary.java-333

   -- com.itextpdf.kernel.pdf.PdfName.compareTo--PdfName.java-1003

   -- com.itextpdf.kernel.pdf.PdfNumber.generateValue--PdfNumber.java-180

   -- com.itextpdf.kernel.pdf.PdfReader.readArray--PdfReader.java-944

   -- com.itextpdf.kernel.pdf.PdfReader.readDictionary--PdfReader.java-923

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1336

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-801

   -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-845

   -- com.itextpdf.kernel.pdf.PdfReader.readPdfName--PdfReader.java-912

   -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-817

   -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-834
8. java.lang.StringIndexOutOfBoundsException

   -- com.itextpdf.io.source.PdfTokenizer.checkPdfHeader--PdfTokenizer.java-239

Any further discussion for these vulnerabilities including fix is welcomed and look forward to hearing from you.

Sorry, something went wrong.

All reactions

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=40&v=4)](/ZanderHuang)

`[Create bugs_report.md](/itext/itext-java/pull/78/commits/fe6bb222cc46fdd85470bc3333bcf3e023d58918 "Create bugs_report.md

bugs_report.md contains a series of bugs which are unique and reproducible.")`
 …

`[fe6bb22](/itext/itext-java/pull/78/commits/fe6bb222cc46fdd85470bc3333bcf3e023d58918)`

```
bugs_report.md contains a series of bugs which are unique and reproducible.
```

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=40&v=4)](/ZanderHuang)
[ZanderHuang](/ZanderHuang)
changed the title
~~Create bugs\_report.md~~
A list of bugs found
[Nov 3, 2021](#event-5564830348)

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=80&v=4)](/ZanderHuang)

Copy link

Author

### **[ZanderHuang](/ZanderHuang)** commented [Nov 13, 2021](#issuecomment-968119805)

| Hi itext7 Team, any updates on the issues mentioned? [@Snipx](https://github.com/Snipx) |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Nov 30, 2021](#issuecomment-982983688)

| Hi [@ZanderHuang](https://github.com/ZanderHuang), thank you for reporting the issues to us. We have acknowledged them and agree that handling invalid input could have been done better on iText library side. While we don't have any updates to share at this point, we would certainly welcome any Pull Requests that attempt to fix the problems and we could collaborate on converging towards the proper fix in the scope of individual PRs.  We don't expose GitHub's *Issues* functionality at this point, hence I am closing this PR as it's more of an *Issue* rather than a *PR* but rest assured we got the message. Thanks again |
| --- |

 👍
1
 ZanderHuang reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=40&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)
[Snipx](/Snipx)
closed this
[Nov 30, 2021](#event-5694505381)

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Dec 28, 2021](#issuecomment-1002312677)

| Hi [@ZanderHuang](https://github.com/ZanderHuang), would you mind signing our CLA (details available at <https://itextpdf.com/en/how-buy/legal/itext-contributor-license-agreement>) so that we are able to use your files in our tests? |
| --- |

All reactions

Sorry, something went wrong.

[![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=80&v=4)](/Han0nly)

Copy link

### **[Han0nly](/Han0nly)** commented [Jan 27, 2022](#issuecomment-1022914579) • edited Loading

| Hi [@Snipx](https://github.com/Snipx) , I'm the collaborator of [@ZanderHuang](https://github.com/ZanderHuang), we are willing to donate our test cases. I'll sign the CLA document and send it to dev.intern@itextpdf.com using my Github public email address. |
| --- |

 👍
1
 Snipx reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089279222) • edited Loading

| java.lang.OutOfMemoryError -- com.itextpdf.kernel.pdf.PdfReader.readStreamBytesRaw--PdfReader.java-391 -- com.itextpdf.kernel.pdf.PdfXrefTable.extendXref--PdfXrefTable.java-598  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24196>  This has been fixed in commit [3213363](https://github.com/itext/itext-java/commit/321336392695ead6f071cb60240956282d254782)  The fix is available in 7.2.2 |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089282165)

| java.lang.StackOverflowError -- com.itextpdf.io.source.ByteBuffer.append--ByteBuffer.java-110 -- com.itextpdf.io.source.PdfTokenizer.getStringValue--PdfTokenizer.java-187 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-341 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-343 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-361 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-377 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-413 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-452 -- com.itextpdf.io.source.PdfTokenizer.nextToken--PdfTokenizer.java-469 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-271 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-300 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-306 -- com.itextpdf.io.source.PdfTokenizer.nextValidToken--PdfTokenizer.java-314 -- com.itextpdf.io.source.RandomAccessFileOrArray.read--RandomAccessFileOrArray.java-138 -- com.itextpdf.io.util.MessageFormatUtil.format--MessageFormatUtil.java-55 -- com.itextpdf.kernel.pdf.PdfDictionary.putAll--PdfDictionary.java-333 -- com.itextpdf.kernel.pdf.PdfName.compareTo--PdfName.java-1003 -- com.itextpdf.kernel.pdf.PdfNumber.generateValue--PdfNumber.java-180 -- com.itextpdf.kernel.pdf.PdfReader.readArray--PdfReader.java-944 -- com.itextpdf.kernel.pdf.PdfReader.readDictionary--PdfReader.java-923 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1336 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-1344 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-801 -- com.itextpdf.kernel.pdf.PdfReader.readObject--PdfReader.java-845 -- com.itextpdf.kernel.pdf.PdfReader.readPdfName--PdfReader.java-912 -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-817 -- com.itextpdf.kernel.pdf.PdfReader.readReference--PdfReader.java-834  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24197>  This has been fixed in commit [88c9cb7](https://github.com/itext/itext-java/commit/88c9cb7ec7befa096d83206419506ec5c7664912)  The fix is available in 7.2.2 |
| --- |

All reactions

Sorry, something went wrong.

[![@Snipx](https://avatars.githubusercontent.com/u/695313?s=80&u=74c00bac9702ebc3df4a355f59532457359a024c&v=4)](/Snipx)

Copy link

Contributor

### **[Snipx](/Snipx)** commented [Apr 5, 2022](#issuecomment-1089287808)

| java.lang.ArrayIndexOutOfBoundsException -- com.itextpdf.kernel.crypto.ARCFOUREncryption.encryptARCFOUR--ARCFOUREncryption.java-93 -- com.itextpdf.kernel.crypto.securityhandler.StandardHandlerUsingStandard128.computeOwnerKey--StandardHandlerUsingStandard128.java-81 -- com.itextpdf.kernel.pdf.PdfXrefTable.clear--PdfXrefTable.java-448 -- com.itextpdf.kernel.pdf.PdfXrefTable.get--PdfXrefTable.java-153 -- com.itextpdf.kernel.pdf.PdfXrefTable.initFreeReferencesList--PdfXrefTable.java-185  Has been reported as <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24198>  This is not something we agree with at this point It's not clear what kind of DDoS we can get.  We do confirm that the provided code sample triggers ArrayIndexOutOfBoundsException in our Java library. We don't see any description of the potential exploitation of this. The fact that the user of the library may not know that this exception can be thrown does not by itself mean that we have a vulnerability in the library and that cannot be associated with Denial of Service vulnerability in our opinion. Java is the programming language that safeguards against buffer overflow attacks and therefore nothing related to information leakage is applicable here. We do agree that the library could have thrown a better exception but the fact that it throws ArrayIndexOutOfBoundsException is not by itself a vulnerability, and no case supporting that this behavior may be exploited to cause DoS has been presented to us. |
| --- |

 👍
4
 avlemos, introfog, SanketS-CX, and yulian-gaponenko reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Vsevolod-Bro](https://avatars.githubusercontent.com/u/73461682?s=40&v=4)](/Vsevolod-Bro)
[Vsevolod-Bro](/Vsevolod-Bro)
mentioned this pull request
[Jun 20, 2022](#ref-issue-1276286441)

[[FP]: CVE-2022-24198 in kernel-7.2.2.jar
jeremylong/DependencyCheck#4613](/jeremylong/DependencyCheck/issues/4613)

Closed

[![@helloimvincent](https://avatars.githubusercontent.com/u/51130790?s=80&v=4)](/helloimvincent)

Copy link

### **[helloimvincent](/helloimvincent)** commented [Nov 2, 2022](#issuecomment-1299754562) • edited Loading

| Hi, can check if this CVE affects iText 5 libraries as well? Because iText 5 is listed under the known affected software configurations for this CVE in NVD website. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-java%2Fpull%2F78)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@ZanderHuang](https://avatars.githubusercontent.com/u/18213663?s=52&v=4)](/ZanderHuang) [![@Snipx](https://avatars.githubusercontent.com/u/695313?s=52&v=4)](/Snipx) [![@Han0nly](https://avatars.githubusercontent.com/u/13165857?s=52&v=4)](/Han0nly) [![@helloimvincent](https://avatars.githubusercontent.com/u/51130790?s=52&v=4)](/helloimvincent)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


