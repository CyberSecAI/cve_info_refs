=== Content from wwws.nightwatchcybersecurity.com_87069aef_20250115_202742.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

# Home

We are an innovative cybersecurity consultancy offering a variety of services for our clients including:

* Advisory services
* Penetration testing
* Research
* Training

*Another project of IDN*

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F)
  + [Copy shortlink](https://wp.me/P7EvFy-3)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/3)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_32515328_20250114_225424.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975
# GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975

[February 11, 2022July 2, 2024](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/), [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/)[git](https://wwws.nightwatchcybersecurity.com/tag/git/), [gitbleed](https://wwws.nightwatchcybersecurity.com/tag/gitbleed/), [github](https://wwws.nightwatchcybersecurity.com/tag/github/), [gitlab](https://wwws.nightwatchcybersecurity.com/tag/gitlab/)

## Summary

Due to a discrepancy in Git behavior, partial parts of a source code repository are visible when making copies via the [“git clone”](https://git-scm.com/docs/git-clone) command. There are additional parts of the repository that only become visible when using the “–mirror” option. This can lead to secrets being exposed via git repositories when not removed properly, and a false sense of security when repositories are scanned for secrets against a cloned, non-mirrored copy.

Attackers and bug bounty hunters can use this discrepancy in Git behavior to find hidden secrets and other sensitive data in public repositories.

Organizations can mitigate this by analyzing a fuller copy of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo) (which do a more thorough job).

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

***[ADDED APRIL 2022: This bug is NOT the same as [NotGitBleed](https://www.notgitbleed.com/) – see their website here]***

**[ADDED JULY 2024: [A more in-depth article](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/) on this issue from AquaSec]**

## Technical Details

Git is a popular open source tool used for version control of source code. When users make a copy of a local or remote git repository, they use the [“git clone”](https://git-scm.com/docs/git-clone) command. However, this command doesn’t copy all of the data in the originating repository such as deleted branches and commits. On the other hand, there is a “–mirror” option which copies more parts of the repository. The discrepancy between the two behaviors can lead to secrets and other sensitive data lingering in the original repository. Additionally, existing tools for secrets detection often operate on cloned repositories and do not detect secrets in the mirror portion of the repository unless cloned via the “–mirror” command.

**[ADDED July 2024: More technical details [are available in this blog post from AquaSec](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/)]**

We also tested forking in GitHub and GitLab, and in both systems forking uses the regular “git clone” behind the scenes and not the “–mirror” version. That means that repositories containing secrets in the mirrored portion will not propagate those secrets to their forks.

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

We provide two examples of repositories containing hidden secrets that are only visible when cloning with the “–mirror” option. These can be found here:

* [gb\_testrepo\_delete](https://github.com/nightwatchcybersecurity/gb_testrepo_delete) – secret is retained after a branch is deleted
* [gb\_testrepo\_reset](https://github.com/nightwatchcybersecurity/gb_testrepo_reset) – secret is retained after the git history is reset

If you try to clone the repository without the “–mirror” option, and retrieve the secret, it will not work:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_clone.png?w=605)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_clone.png?w=605)

If you try the same with the “–mirror” option, you can now retrieve the secret (also note the larger number of objects retrieved):

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_mirror.png?w=669)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_mirror.png?w=669)

If you run [gitleaks](https://github.com/zricethezav/gitleaks) on the cloned repositories, no secrets are found:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_clone.png?w=314)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_mirror.png?w=314)

However, running [gitleaks](https://github.com/zricethezav/gitleaks) on the mirrored copies, finds the secrets stashed in deleted areas:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_clone.png?w=437)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_mirror.png?w=437)
## Tooling

There are plenty of existing tools out there that can manipulate git repositories, scan them for secrets and remove specific commits. During our research, we used git for checking out repositories, [git-filter-repo](https://github.com/newren/git-filter-repo) for figuring out the delta between cloned and mirrored copies of the same repository, and [gitleaks](https://github.com/zricethezav/gitleaks) to scan for secrets.

For examples on how to use these tools, please see sample scripts that we have [published to GitHub](https://github.com/nightwatchcybersecurity/gitbleed_tools).

## Mitigations

Organizations can mitigate this by analyzing a larger part of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo). Garbage collection and pruning in git is also recommended.

Organizations should not analyze regular cloned copies (without the “–mirror” option) since that may provide a false sense of security, and should not rely on methods of removing secrets such as deleting a branch or rewinding history via the “[git reset](https://git-scm.com/docs/git-reset)” command.

## Branding

[![logo](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png?w=383)](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png)

There seems to be a recent trend to name vulnerabilities. While we think it’s silly, why not go with the flow?

Therefore we named this one “**GitBleed**“, since it leads to bleeding of secrets from repositories – with [a mirrored logo](https://github.com/nightwatchcybersecurity/gitbleed_tools/blob/main/gitbleed_icon.png) since it involves mirrored repositories.

## Changelog

2022-02-11: Initial publication

2022-02-26: Added CVE reference

2024-07-02: Added link to AquaSec

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/) [RFC 9116 / “security.txt” Has Been Published →](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)

### Leave a comment [Cancel reply](/2022/02/11/gitbleed/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F11%252Fgitbleed%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + [Customize](https://wwwsnightwatchcybersecuritycom.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fwwwsnightwatchcybersecuritycom.wordpress.com%2F2022%2F02%2F11%2Fgitbleed%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F11%252Fgitbleed%252F)
  + [Copy shortlink](https://wp.me/s7EvFy-gitbleed)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/5878)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_179e9ef1_20250115_202739.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)RFC 9116 / “security.txt” Has Been Published
# RFC 9116 / “security.txt” Has Been Published

[April 27, 2022](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)

> After 5 years of work, security.txt is officially an RFC. I am pleased to announce RFC 9116: <https://t.co/uIqSRo28ak>.
>
> I would like to use this opportunity to thank those who made this possible. Thank you. ❤️ [pic.twitter.com/Z8SNxd81ZO](https://t.co/Z8SNxd81ZO)
>
> — Ed (@EdOverflow) [April 27, 2022](https://twitter.com/EdOverflow/status/1519415583896481792?ref_src=twsrc%5Etfw)

See: <https://www.rfc-editor.org/rfc/rfc9116>

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/) [Insecure Bootstrap Process in Google’s Cloud SQL Proxy →](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)

### Leave a comment [Cancel reply](/2022/04/27/rfc-9116-security-txt-has-been-published/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F04%252F27%252Frfc-9116-security-txt-has-been-published%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F04%252F27%252Frfc-9116-security-txt-has-been-published%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-1AZ)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/6137)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_01053c4c_20250115_202742.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Articles posted by nightwatchcyber
# Author: nightwatchcyber

# [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)

[March 19, 2023](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)

## Summary

The bootstrap process for Google’s cloud SQL Proxy CLI uses the “curl | bash” pattern and didn’t document a way to verify authenticity of the downloaded binaries. The vendor updated documentation with information on how to use checksums to verify the downloaded binaries.

## Vulnerability Details

[As part of our ongoing research into supply chain attacks](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/), we have been analyzing bash installer scripts using the “curl | bash” pattern. [Google provides such script](https://github.com/GoogleCloudPlatform/cloud-sql-proxy#installation) used to install the Cloud SQL proxy. However, the documentation doesn’t indicate how to verify downloaded files prior to execution.

## Vendor Response

The vendor [updated their documentation](https://github.com/GoogleCloudPlatform/cloud-sql-proxy/pull/1676/files) with information on how to verify downloaded binaries via checksums.

## References

Vendor issue tracker # 244384166

## Timeline

2022-08-30: Initial report to the vendor
2022-08-30: Vendor acknowledged the report
2022-09-27: Vendor rejected the report as a security issue
2023-03-03: Vendor reported that a fix has been implemented
2023-03-19: Public disclosure

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/#respond)

# [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)

[April 27, 2022](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)

> After 5 years of work, security.txt is officially an RFC. I am pleased to announce RFC 9116: <https://t.co/uIqSRo28ak>.
>
> I would like to use this opportunity to thank those who made this possible. Thank you. ❤️ [pic.twitter.com/Z8SNxd81ZO](https://t.co/Z8SNxd81ZO)
>
> — Ed (@EdOverflow) [April 27, 2022](https://twitter.com/EdOverflow/status/1519415583896481792?ref_src=twsrc%5Etfw)

See: <https://www.rfc-editor.org/rfc/rfc9116>

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/#respond)

# [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)

[February 11, 2022July 2, 2024](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/), [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/)
[git](https://wwws.nightwatchcybersecurity.com/tag/git/), [gitbleed](https://wwws.nightwatchcybersecurity.com/tag/gitbleed/), [github](https://wwws.nightwatchcybersecurity.com/tag/github/), [gitlab](https://wwws.nightwatchcybersecurity.com/tag/gitlab/)

## Summary

Due to a discrepancy in Git behavior, partial parts of a source code repository are visible when making copies via the [“git clone”](https://git-scm.com/docs/git-clone) command. There are additional parts of the repository that only become visible when using the “–mirror” option. This can lead to secrets being exposed via git repositories when not removed properly, and a false sense of security when repositories are scanned for secrets against a cloned, non-mirrored copy.

Attackers and bug bounty hunters can use this discrepancy in Git behavior to find hidden secrets and other sensitive data in public repositories.

Organizations can mitigate this by analyzing a fuller copy of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo) (which do a more thorough job).

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

***[ADDED APRIL 2022: This bug is NOT the same as [NotGitBleed](https://www.notgitbleed.com/) – see their website here]***

**[ADDED JULY 2024: [A more in-depth article](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/) on this issue from AquaSec]**

## Technical Details

Git is a popular open source tool used for version control of source code. When users make a copy of a local or remote git repository, they use the [“git clone”](https://git-scm.com/docs/git-clone) command. However, this command doesn’t copy all of the data in the originating repository such as deleted branches and commits. On the other hand, there is a “–mirror” option which copies more parts of the repository. The discrepancy between the two behaviors can lead to secrets and other sensitive data lingering in the original repository. Additionally, existing tools for secrets detection often operate on cloned repositories and do not detect secrets in the mirror portion of the repository unless cloned via the “–mirror” command.

**[ADDED July 2024: More technical details [are available in this blog post from AquaSec](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/)]**

We also tested forking in GitHub and GitLab, and in both systems forking uses the regular “git clone” behind the scenes and not the “–mirror” version. That means that repositories containing secrets in the mirrored portion will not propagate those secrets to their forks.

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

We provide two examples of repositories containing hidden secrets that are only visible when cloning with the “–mirror” option. These can be found here:

* [gb\_testrepo\_delete](https://github.com/nightwatchcybersecurity/gb_testrepo_delete) – secret is retained after a branch is deleted
* [gb\_testrepo\_reset](https://github.com/nightwatchcybersecurity/gb_testrepo_reset) – secret is retained after the git history is reset

If you try to clone the repository without the “–mirror” option, and retrieve the secret, it will not work:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_clone.png?w=605)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_clone.png?w=605)

If you try the same with the “–mirror” option, you can now retrieve the secret (also note the larger number of objects retrieved):

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_mirror.png?w=669)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_mirror.png?w=669)

If you run [gitleaks](https://github.com/zricethezav/gitleaks) on the cloned repositories, no secrets are found:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_clone.png?w=314)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_mirror.png?w=314)

However, running [gitleaks](https://github.com/zricethezav/gitleaks) on the mirrored copies, finds the secrets stashed in deleted areas:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_clone.png?w=437)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_mirror.png?w=437)
## Tooling

There are plenty of existing tools out there that can manipulate git repositories, scan them for secrets and remove specific commits. During our research, we used git for checking out repositories, [git-filter-repo](https://github.com/newren/git-filter-repo) for figuring out the delta between cloned and mirrored copies of the same repository, and [gitleaks](https://github.com/zricethezav/gitleaks) to scan for secrets.

For examples on how to use these tools, please see sample scripts that we have [published to GitHub](https://github.com/nightwatchcybersecurity/gitbleed_tools).

## Mitigations

Organizations can mitigate this by analyzing a larger part of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo). Garbage collection and pruning in git is also recommended.

Organizations should not analyze regular cloned copies (without the “–mirror” option) since that may provide a false sense of security, and should not rely on methods of removing secrets such as deleting a branch or rewinding history via the “[git reset](https://git-scm.com/docs/git-reset)” command.

## Branding

[![logo](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png?w=383)](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png)

There seems to be a recent trend to name vulnerabilities. While we think it’s silly, why not go with the flow?

Therefore we named this one “**GitBleed**“, since it leads to bleeding of secrets from repositories – with [a mirrored logo](https://github.com/nightwatchcybersecurity/gitbleed_tools/blob/main/gitbleed_icon.png) since it involves mirrored repositories.

## Changelog

2022-02-11: Initial publication

2022-02-26: Added CVE reference

2024-07-02: Added link to AquaSec

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/#respond)

# [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)

[February 6, 2022](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)

## Summary

The bootstrap process for Oracle Cloud CLI using the “curl | bash” pattern was insecure since there was no way to verify authenticity of the downloaded binaries. The vendor is now publishing checksums that can be used to verify the downloaded binaries.

## Vulnerability Details

[As part of our ongoing research into supply chain attacks](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/), we have been analyzing bash installer scripts using the “curl | basj” pattern. [Oracle provides such script](https://github.com/oracle/oci-cli#linux) used to install the CLI command for interaction with Oracle Cloud. However, there was no way to check whether the files that the script downloads are legitimate, which could potentially open the end-user to supply chain attacks. The installer is run as follows:

```
bash -c "$(curl -L https://raw.githubusercontent.com/oracle/oci-cli/master/scripts/install/install.sh)"
```
## Vendor Response

The vendor [started publishing SHA-256](https://github.com/oracle/oci-cli/releases) checksums for the CLI.

## References

Vendor reference # S1456147

Vendor security advisory: [Jan 2022](https://www.oracle.com/security-alerts/cpujan2022.html)

## Timeline

2021-04-21: Initial report to the vendor
2021-04-21: Vendor acknowledged the report
2021-05-04: Vendor communicated that a fix is pending
2021-12-28: Vendor reported that a fix has been implemented and credit will be provided in an advisory
2022-01-18: Vendor advisory published
2022-02-06: Public disclosure

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/#respond)

# [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)

[December 31, 2021December 30, 2021](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/)
[log4j](https://wwws.nightwatchcybersecurity.com/tag/log4j/)

Over the last few weeks, security teams everywhere have been busy patching [Log4J vulnerabilities](https://logging.apache.org/log4j/2.x/security.html). In this article we want to talk about the three things you can tell your friends why this is way worse.

## Ubiquity

This vulnerability impacts impacts Java applications and those can be found almost anywhere: enterprise, vendor applications, database drivers, Android phones and even the smartchip on the credit card in your wallet ([Java Card](https://en.wikipedia.org/wiki/Java_Card)). Additionally, majority of Java applications use log4j to handle logging, often involving user input. While your phone is [probably not exploitable](https://security.googleblog.com/2021/12/apache-log4j-vulnerability.html), the sheer number of places where log4j can be hiding makes this is hard to fix.

## Severity

There are vulnerabilities that come out all the time, but few of them reach the highest possible level of severity: remote code execution (RCE) and this one hits that ticket. That means that every server running Java within your company becomes everyone’s computer – an attacker can run anything they want there and then use that as a springboard to tunnel in further.

## Exploitability

There are many severe vulnerabilities out there that require specialized knowledge to exploit including speaking dead computer languages and building weird binaries during a full moon. With this one, you can begin the exploit [by copy/pasting a tweet into a search bar combined with DNS](https://scotthelme.co.uk/responding-to-the-log4j-2-vulnerability/).

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/#respond)

# [WhatsApp for Android Retains Deleted Contacts Locally](https://wwws.nightwatchcybersecurity.com/2021/12/30/whatsapp-for-android-retains-deleted-contacts-locally/)

[December 30, 2021](https://wwws.nightwatchcybersecurity.com/2021/12/30/whatsapp-for-android-retains-deleted-contacts-locally/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/), [Research](https://wwws.nightwatchcybersecurity.com/category/research/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/), [whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)

## Summary

WhatApp for Android retains contact info locally after contacts get deleted. This would allow an attacker with physical access to the device to check if the WhatsApp user had interactions with specific contacts, even though they have been deleted.

## Vulnerability Details

When a contact is deleted on WhatsApp, their information about security code changes is retained (while the chat content is not). The only way to get rid of that is to select “Clear Chat” for the contact before deleting it. Even deleting the chat itself doesn’t do it unless the “Clear Chat” operation is done first. [The “security code change notifications” option](https://faq.whatsapp.com/general/security-and-privacy/security-code-change-notification/?lang=en) must be enabled in order for this to work.

Someone getting access to the user’s device can figure out whether they ever chatted with specific contacts, even if those contacts and their chats are no longer on the device. This is a privacy issue – especially for people like journalists and those living in dangerous countries.

Since WhatsApp uses Android’s contact app for contact information but supports chats with numbers that aren’t contacts, our theory is that the application retains information about security code changes even for contacts no longer on the device. There seems to be a discrepancy between how the “Clear chat” option and “Delete Chat” options are implemented in the application, with the first option deleting security notification data.

To reproduce:

1. Delete a chat with a contact that had security code changes before.
2. Delete the contact from the device via the Android Contacts app.
3. Re-add contact to the device via the Android Contacts app.
4. Start a new chat in WhatsApp with that contact but do not send any messages.
5. Observe that security code changes are listed with dates in the chat.
6. Select “Clear Chat” to remove the security code changes, and repeat sterps 1-4. Observe that the security code changes no longer appear.

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/12/screen-shot-2021-12-30-at-4.13.16-pm.png?w=612)

Tested on WhatsApp for Android, app version 2.21.20.20, running on Android 12.

## Vendor Response

We haven’t retested on a more recent version but our recommendation to users is to use the “Clear Chat” option in order to prevent this.

The vendor will not be fixing this issue, here is their response:

> *As part of the attack scenario you describe getting access to a person’s WhatsApp account to obtain private data, as you mention yourself, people do have a way to remove these messages from their account, if a bad actor gets access to their WhatsApp account prior to that person deleting that information then they will be able to view this information. As such, we are closing this report.*

## References

CWE: [CWE-212 – Improper Removal of Sensitive Information Before Storage or Transfer](https://cwe.mitre.org/data/definitions/212.html)

Facebook # 10102482597361835

## Timeline

2021-10-24: Initial report sent to the vendor, report ID assigned
2021-10-27: Vendor asks for more info, additional info and screenshots sent
2021-11-03: Vendor sent interim status report, still investigating
2021-11-09: Vendor rejects the vulnerability and closes the report
2021-12-30: Public disclosure

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2021/12/30/whatsapp-for-android-retains-deleted-contacts-locally/#respond)

# [Open Redirect Vulnerability in Substack](https://wwws.nightwatchcybersecurity.com/2021/08/22/open-redirect-vulnerability-in-substack/)

[August 22, 2021](https://wwws.nightwatchcybersecurity.com/2021/08/22/open-redirect-vulnerability-in-substack/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)
[substack](https://wwws.nightwatchcybersecurity.com/tag/substack/)

## Summary

Substack had a open redirect vulnerability in their login flow which would have allowed an attacker to facilitate phishing attacks. The vendor has deployed a fix for this issue.

## Vulnerability Details

Substack is an online platform that allows users to create and operate free and paid subscription newsletters. This platform had an open redirect vulnerability in its login flow which would redirect users to any sites after login completed. This could have been used by an attacker to facilitate phishing attacks targeting Substack users and steal their credentials.

The vulnerability was due to the fact that the “redirect parameter” in the login flow wasn’t been validated to make sure that the redirect only goes to a specific set of URLs. The attacker could specify their own redirect URL as follows:

```
https://substack.com/sign-in?redirect=https://www.google.com
```

See screenshots below:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/08/screen1.png?w=614)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/08/screen2.png?w=525)
## Vendor Response

Once a correct reporting channel was established, the issue was reported to the vendor and a fix was deployed limited the redirect parameter to Substack-specific URLs.

## References

CWE: [CWE-601: URL Redirection to Untrusted Site (‘Open Redirect’)](https://cwe.mitre.org/data/definitions/601.html)

OWASP: [Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)

## Timeline

2021-07-08: Initial contact with the vendor, asking for a correct reporting channel
2021-07-09: Initial reply received, confirming communication channe again – no response from the vendor
2021-07-13: Pinged again – no response; pinged company co-founders on Twitter
2021-07-13: Communication with the vendor re-established, technical details sent
2021-07-23: Pinged for status, no response
2021-07-29: Vendor responded that a fix has been implemented
2021-07-29: Fix confirmed, vendor pinged for disclosure coordination – no response
2021-08-22: Public disclosure

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2021/08/22/open-redirect-vulnerability-in-substack/#respond)

# [Speaking @Appsec\_Village @DEFCON 29](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/)

[July 12, 2021August 8, 2021](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)

Our talk titled “The Poisoned Diary: Supply Chain Attacks on Install Scripts” was accepted at this year’s @Appsec\_Village @DEFCON 29.

**UPDATE:** It will take place on Sunday, August 8th, at 9:05 AM PST / 12:05 PM EDT. [Details can be found here](https://www.appsecvillage.com/events/dc-2021/the-poisoned-diary-supply-chain-attacks-on-install-scripts) – Q&A will take place on DEFCON’s Discord server.

* [Slides (PDF)](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/08/appsec_village_defcon.pdf)
* [Video recording (Youtube)](https://youtu.be/K8PAITvlJng)

[2 Comments](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/#comments)

# [Firebase CLI Installer Making Calls to Google Analytics](https://wwws.nightwatchcybersecurity.com/2021/05/25/firebase-cli-installer-making-calls-to-google-analytics/)

[May 25, 2021May 25, 2021](https://wwws.nightwatchcybersecurity.com/2021/05/25/firebase-cli-installer-making-calls-to-google-analytics/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)
[analytics](https://wwws.nightwatchcybersecurity.com/tag/analytics/), [firebase](https://wwws.nightwatchcybersecurity.com/tag/firebase/), [google](https://wwws.nightwatchcybersecurity.com/tag/google/)

[Firebase](https://firebase.google.com/) is a mobile and web application development platform provided by Google. One of the tools available for the platform is the [Firebase CLI tool](https://firebase.google.com/docs/cli) ([GitHub repo](https://github.com/firebase/firebase-tools)) which helps developers interact with the platform from command line. [An automatic install script](https://firebase.tools) is offered among other options, which allows installation of the CLI tool via the “curl | bash” pattern as follows:

```
curl -sL https://firebase.tools | bash
```

[As part of our ongoing research](https://github.com/nightwatchcybersecurity/dont_curl_and_bash) into supply chain attacks, we have been looking into bash installer scripts that make calls to external systems. First, there is no way to verify that the installer is legit, However, to our surprise, we also found that this script makes calls to Google Analytics as part of the installation process. There is no sensitive data being collected but Google may still be collecting IP addresses of users installing the CLI. The source code for the installer script can be found here:

<https://firebase.tools/>

While this can be disabled, the documentation to do so is hard to find and is embedded within the installer script itself. We hope that Google will make this documentation more clear in the future. In any case, here is the documentation:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/05/screen-shot-2021-05-25-at-8.08.40-am.png?w=630)

The actual code that makes these calls can be found here:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/05/screen-shot-2021-05-25-at-8.10.15-am.png?w=625)

And here are all the analytics events triggered within the script:

```

send_analytics_event start
...
send_analytics_event uninstall_npm
...
send_analytics_event uninstall
...
send_analytics_event already_installed
...
send_analytics_event upgrade
...
send_analytics_event "missing_platform_$UNAME"
...
send_analytics_event failure
...
send_analytics_event missing_path
...
send_analytics_event success

```

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2021/05/25/firebase-cli-installer-making-calls-to-google-analytics/#respond)

# [New Tools for Addressing Supply Chain Attacks](https://wwws.nightwatchcybersecurity.com/2021/05/09/new-tools-for-addressing-supply-chain-attacks/)

[May 9, 2021](https://wwws.nightwatchcybersecurity.com/2021/05/09/new-tools-for-addressing-supply-chain-attacks/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/), [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)

In the recent [codecov.io security incident](https://about.codecov.io/security-update/), an attacker modified a shell script used by a common software development tool for code coverage. This modification did not take place at the original source code repository where it would have been visible to others, but after the code was packaged and placed on the web server from which it was served.

Prompted by this incident, we are now releasing new tools that provide information and detection of similar attacks against other projects. The scope is limited to attacks that modify the released code and do not touch the original source code. The following tools are now available:

* **[dont\_curl\_and\_bash](https://github.com/nightwatchcybersecurity/dont_curl_and_bash)** – a list of projects that are installed directly off the Internet via a “curl | bash” manner along with possible mitigations
* **[icetrust](https://github.com/nightwatchcybersecurity/icetrust)** – a tool that can be used to verify a downloaded artifact such as a shell script before it is executed via methods such as checksums and PGP signatures
* **[release\_auditor](https://github.com/nightwatchcybersecurity/release_auditor)** – a tool that can be used to check if a GitHub release was modified after initial publication (see [our earlier blog post](https://wwws.nightwatchcybersecurity.com/2021/04/25/supply-chain-attacks-via-github-com-releases/) for additional information)

Additionally, we are also providing two examples of how a continuous monitoring dashboard can be setup to detect such attacks by project maintainers. The following are available (screenshots below):

* [Simple one page dashboard](https://icetrust_dashboard.nightwatchcybersecurity.com/) (GitHub [repo](https://github.com/nightwatchcybersecurity/icetrust_dashboard_example))
* [Uptime / status-page like dashboard](https://icetrust_uptime.nightwatchcybersecurity.com/) (GitHub [repo](https://github.com/nightwatchcybersecurity/icetrust_uptime_example))

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/05/screen-shot-2021-05-09-at-5.35.25-pm.png?w=1024)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2021/05/screen-shot-2021-05-09-at-5.35.43-pm.png?w=803)

[Leave a comment](https://wwws.nightwatchcybersecurity.com/2021/05/09/new-tools-for-addressing-supply-chain-attacks/#respond)

# Post navigation

[← Older posts](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/page/2/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2023%252F03%252F19%252Finsecure-bootstrap-process-in-googles-cloud-sql-proxy%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2023%252F03%252F19%252Finsecure-bootstrap-process-in-googles-cloud-sql-proxy%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com)
  + [View site in Reader](https://wordpress.com/read/feeds/49995147)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_32515328_20250115_202743.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975
# GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975

[February 11, 2022July 2, 2024](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/), [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/)[git](https://wwws.nightwatchcybersecurity.com/tag/git/), [gitbleed](https://wwws.nightwatchcybersecurity.com/tag/gitbleed/), [github](https://wwws.nightwatchcybersecurity.com/tag/github/), [gitlab](https://wwws.nightwatchcybersecurity.com/tag/gitlab/)

## Summary

Due to a discrepancy in Git behavior, partial parts of a source code repository are visible when making copies via the [“git clone”](https://git-scm.com/docs/git-clone) command. There are additional parts of the repository that only become visible when using the “–mirror” option. This can lead to secrets being exposed via git repositories when not removed properly, and a false sense of security when repositories are scanned for secrets against a cloned, non-mirrored copy.

Attackers and bug bounty hunters can use this discrepancy in Git behavior to find hidden secrets and other sensitive data in public repositories.

Organizations can mitigate this by analyzing a fuller copy of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo) (which do a more thorough job).

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

***[ADDED APRIL 2022: This bug is NOT the same as [NotGitBleed](https://www.notgitbleed.com/) – see their website here]***

**[ADDED JULY 2024: [A more in-depth article](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/) on this issue from AquaSec]**

## Technical Details

Git is a popular open source tool used for version control of source code. When users make a copy of a local or remote git repository, they use the [“git clone”](https://git-scm.com/docs/git-clone) command. However, this command doesn’t copy all of the data in the originating repository such as deleted branches and commits. On the other hand, there is a “–mirror” option which copies more parts of the repository. The discrepancy between the two behaviors can lead to secrets and other sensitive data lingering in the original repository. Additionally, existing tools for secrets detection often operate on cloned repositories and do not detect secrets in the mirror portion of the repository unless cloned via the “–mirror” command.

**[ADDED July 2024: More technical details [are available in this blog post from AquaSec](https://www.aquasec.com/blog/undetected-hard-code-secrets-expose-corporations/)]**

We also tested forking in GitHub and GitLab, and in both systems forking uses the regular “git clone” behind the scenes and not the “–mirror” version. That means that repositories containing secrets in the mirrored portion will not propagate those secrets to their forks.

MITRE assigned [CVE-2022-24975](https://nvd.nist.gov/vuln/detail/CVE-2022-24975) to track this issue.

We provide two examples of repositories containing hidden secrets that are only visible when cloning with the “–mirror” option. These can be found here:

* [gb\_testrepo\_delete](https://github.com/nightwatchcybersecurity/gb_testrepo_delete) – secret is retained after a branch is deleted
* [gb\_testrepo\_reset](https://github.com/nightwatchcybersecurity/gb_testrepo_reset) – secret is retained after the git history is reset

If you try to clone the repository without the “–mirror” option, and retrieve the secret, it will not work:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_clone.png?w=605)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_clone.png?w=605)

If you try the same with the “–mirror” option, you can now retrieve the secret (also note the larger number of objects retrieved):

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/delete_mirror.png?w=669)

And:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/reset_mirror.png?w=669)

If you run [gitleaks](https://github.com/zricethezav/gitleaks) on the cloned repositories, no secrets are found:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_clone.png?w=314)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_delete_mirror.png?w=314)

However, running [gitleaks](https://github.com/zricethezav/gitleaks) on the mirrored copies, finds the secrets stashed in deleted areas:

![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_clone.png?w=437)
![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitleaks_reset_mirror.png?w=437)
## Tooling

There are plenty of existing tools out there that can manipulate git repositories, scan them for secrets and remove specific commits. During our research, we used git for checking out repositories, [git-filter-repo](https://github.com/newren/git-filter-repo) for figuring out the delta between cloned and mirrored copies of the same repository, and [gitleaks](https://github.com/zricethezav/gitleaks) to scan for secrets.

For examples on how to use these tools, please see sample scripts that we have [published to GitHub](https://github.com/nightwatchcybersecurity/gitbleed_tools).

## Mitigations

Organizations can mitigate this by analyzing a larger part of their repositories using the “–mirror” option and remove sensitive data using tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo). Garbage collection and pruning in git is also recommended.

Organizations should not analyze regular cloned copies (without the “–mirror” option) since that may provide a false sense of security, and should not rely on methods of removing secrets such as deleting a branch or rewinding history via the “[git reset](https://git-scm.com/docs/git-reset)” command.

## Branding

[![logo](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png?w=383)](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2022/02/gitbleed_icon-3.png)

There seems to be a recent trend to name vulnerabilities. While we think it’s silly, why not go with the flow?

Therefore we named this one “**GitBleed**“, since it leads to bleeding of secrets from repositories – with [a mirrored logo](https://github.com/nightwatchcybersecurity/gitbleed_tools/blob/main/gitbleed_icon.png) since it involves mirrored repositories.

## Changelog

2022-02-11: Initial publication

2022-02-26: Added CVE reference

2024-07-02: Added link to AquaSec

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/) [RFC 9116 / “security.txt” Has Been Published →](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)

### Leave a comment [Cancel reply](/2022/02/11/gitbleed/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F11%252Fgitbleed%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F11%252Fgitbleed%252F)
  + [Copy shortlink](https://wp.me/s7EvFy-gitbleed)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/5878)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_a5163edc_20250115_202742.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Insecure Bootstrap Process in Oracle Cloud CLI
# Insecure Bootstrap Process in Oracle Cloud CLI

[February 6, 2022](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)

## Summary

The bootstrap process for Oracle Cloud CLI using the “curl | bash” pattern was insecure since there was no way to verify authenticity of the downloaded binaries. The vendor is now publishing checksums that can be used to verify the downloaded binaries.

## Vulnerability Details

[As part of our ongoing research into supply chain attacks](https://wwws.nightwatchcybersecurity.com/2021/07/12/speaking-appsec_village-defcon-29/), we have been analyzing bash installer scripts using the “curl | basj” pattern. [Oracle provides such script](https://github.com/oracle/oci-cli#linux) used to install the CLI command for interaction with Oracle Cloud. However, there was no way to check whether the files that the script downloads are legitimate, which could potentially open the end-user to supply chain attacks. The installer is run as follows:

```
bash -c "$(curl -L https://raw.githubusercontent.com/oracle/oci-cli/master/scripts/install/install.sh)"
```
## Vendor Response

The vendor [started publishing SHA-256](https://github.com/oracle/oci-cli/releases) checksums for the CLI.

## References

Vendor reference # S1456147

Vendor security advisory: [Jan 2022](https://www.oracle.com/security-alerts/cpujan2022.html)

## Timeline

2021-04-21: Initial report to the vendor
2021-04-21: Vendor acknowledged the report
2021-05-04: Vendor communicated that a fix is pending
2021-12-28: Vendor reported that a fix has been implemented and credit will be provided in an advisory
2022-01-18: Vendor advisory published
2022-02-06: Public disclosure

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/) [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975 →](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)

### Leave a comment [Cancel reply](/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F06%252Finsecure-bootstrap-process-in-oracle-cloud-cli%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2022%252F02%252F06%252Finsecure-bootstrap-process-in-oracle-cloud-cli%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-1wA)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/5864)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from lore.kernel.org_ec833a43_20250114_225423.html ===

```
[git.vger.kernel.org archive mirror](../?t=20220601211250)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Junio C Hamano <gitster@pobox.com>
To: Mark Esler <mark.esler@canonical.com>
Cc: [git@vger.kernel.org](../../git/?t=20220601211250)
Subject: [Re: CVE-2022-24975](#r)
Date: Wed, 01 Jun 2022 14:12:43 -0700	[[thread overview]](#r)
Message-ID: <xmqq4k14qe9g.fsf@gitster.g> (<raw>)
In-Reply-To: <[CAJ=HsVKX-NXePKU1G0UKRcFT5He8AjS_TQEirb3hN3chGFz9TA@mail.gmail.com](../CAJ%3DHsVKX-NXePKU1G0UKRcFT5He8AjS_TQEirb3hN3chGFz9TA%40mail.gmail.com/)> (Mark Esler's message of "Wed, 1 Jun 2022 15:55:09 -0500")

Mark Esler <mark.esler@canonical.com> writes:

> Hello,
>
> Could the git developers state their position on CVE-2022-24975? Is it
> disputed or will it be addressed by upstream?
>
> As I read the documentation, --mirror is working as stated and MITRE
> should remove the CVE.
>
> Thank you,
> Mark Esler

It took me a while to Google for "gitbleed" as I got tons of GI
bleed but no Gitbleed, so a quick conclusion is there is no such
credible thing called gitbleed ;-)

Jokes aside (yes, I know about [*]).

As you said, "A repository can have more than what branch heads and
tags can reach, and the --mirror option is a way to copy all the
things that are reachable from other refs.  It is 100% working as
intended."

During the discussion about [*] on git-security@ mailing lsit,
everybody said that it is dubious that CVE is warranted.  I am not
sure there is anything more for us to do.

[Reference]

* <https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/>

  the author of which asked git-security@ list and after getting
  things explained, accepted that this is a "working as intended"
  functionality and promised to adjust the blog post entry not to
  imply that the entire repository can be copied.  I do not know how
  much correction was actually made since then, though.

```

---

```
[next](../CAJ%3DHsV%2BDEP6WqyBpQq8ACsMM-KixN9-JRAMXNjML8AcjWosChA%40mail.gmail.com/) [prev parent](../CAJ%3DHsVKX-NXePKU1G0UKRcFT5He8AjS_TQEirb3hN3chGFz9TA%40mail.gmail.com/) [reply](#R)other threads:[[~2022-06-01 21:12 UTC](../?t=20220601211250)|[newest](../)]

Thread overview: 4+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
2022-06-01 20:55 [CVE-2022-24975](../CAJ%3DHsVKX-NXePKU1G0UKRcFT5He8AjS_TQEirb3hN3chGFz9TA%40mail.gmail.com/) Mark Esler
2022-06-01 21:12 ` [Junio C Hamano [this message]](#t)
2022-06-01 21:40   ` [CVE-2022-24975](../CAJ%3DHsV%2BDEP6WqyBpQq8ACsMM-KixN9-JRAMXNjML8AcjWosChA%40mail.gmail.com/) Mark Esler
2022-06-06 15:11   ` [CVE-2022-24975](../DM6PR01MB597862CFD285C837EA61E690F9A29%40DM6PR01MB5978.prod.exchangelabs.com/) Dyer, Edwin

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=xmqq4k14qe9g.fsf@gitster.g \
    --to=gitster@pobox.com \
    --cc=git@vger.kernel.org \
    --cc=mark.esler@canonical.com \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from twitter.com_43723aa9_20250115_202743.html ===



=== Content from rtyley.github.io_6af691d0_20250115_202741.html ===

# BFG Repo-Cleaner

## Removes large or troublesome blobs like git-filter-branch does, but faster. And written in Scala

[View project on GitHub](https://github.com/rtyley/bfg-repo-cleaner)

```
$ bfg --strip-blobs-bigger-than 100M --replace-text banned.txt repo.git

```
# an alternative to git-filter-branch

The BFG is a simpler, faster alternative to [`git-filter-branch`](https://git-scm.com/docs/git-filter-branch) for cleansing bad data out of your Git repository history:

* Removing **Crazy Big Files**
* Removing **Passwords**, **Credentials** & other **Private data**

The `git-filter-branch` command is enormously powerful and can do things that the BFG can't - but the BFG is *much* better for the tasks above, because:

* [Faster](#speed) : **10 - 720x** faster
* [Simpler](#examples) : The BFG isn't particularily clever, but *is* focused on making the above tasks easy
* Beautiful : If you need to, you can use the beautiful Scala language to customise the BFG. Which has got to be better than Bash scripting at least some of the time.

# Usage

First clone a fresh copy of your repo, using the [`--mirror`](https://stackoverflow.com/q/3959924/438886) flag:

```
$ git clone --mirror git://example.com/some-big-repo.git

```

This is a [bare](https://git-scm.com/docs/gitglossary.html#def_bare_repository)
repo, which means your normal files won't be visible, but it is a *full* copy of the Git database of your repository, and at this point
you should **make a backup of it** to ensure you don't lose anything.

Now you can run the BFG to clean your repository up:

```
$ java -jar [bfg.jar](#download) --strip-blobs-bigger-than 100M some-big-repo.git

```

The BFG will update your commits and all branches and tags so they are clean, but it doesn't physically delete the unwanted stuff. Examine the repo to make sure your history has been updated, and then use the standard [`git gc`](https://git-scm.com/docs/git-gc) command to strip out the unwanted dirty data, which Git will now recognise as surplus to requirements:

```
$ cd some-big-repo.git
$ git reflog expire --expire=now --all && git gc --prune=now --aggressive

```

Finally, once you're happy with the updated state of your repo, push it back up *(note that because your clone command used the `--mirror` flag, this push will update **all** refs on your remote server)*:

```
$ git push
```

At this point, you're ready for everyone to ditch their old copies of the repo and do fresh clones of the nice, new pristine data. It's best to delete all old clones, as they'll have dirty history that you *don't* want to risk pushing back into your newly cleaned repo.

# Examples

In all these examples `bfg` is an alias for `java -jar bfg.jar`.

Delete all files named 'id\_rsa' or 'id\_dsa' :

```
$ bfg --delete-files id_{dsa,rsa}  my-repo.git
```

Remove all blobs bigger than 50 megabytes :

```
$ bfg --strip-blobs-bigger-than 50M  my-repo.git
```

Replace all passwords listed in a file *(prefix lines 'regex:' or 'glob:' if required)* with `***REMOVED***` wherever they occur in your repository :

```
$ bfg --replace-text passwords.txt  my-repo.git
```

Remove all folders or files named '.git' - a [reserved filename](https://github.com/git/git/blob/d29e9c89d/fsck.c#L228-L229) in Git. These often
[become a problem](https://stackoverflow.com/q/16821649/438886) when migrating to
Git from other source-control systems like Mercurial :

```
$ bfg --delete-folders .git --delete-files .git  --no-blob-protection  my-repo.git
```

For further command-line options, you can run the BFG without any arguments,
which will output [text like this](https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&g=com.madgag&a=bfg&v=LATEST&e=txt).

# Your *current* files are sacred...

By default the BFG doesn't modify the contents of your *latest* commit on your
`master` (or '`HEAD`') branch, even though it *will* clean
all the commits before it.

That's because your latest commit is likely to be the one
that you deploy to production, and a simple deletion of a private credential or a big
file is quite likely to result in broken code that no longer has the hard-coded data it
expects - you need to fix that, the BFG can't do it for you. Once you've committed your
changes- and your latest commit is *clean* with none of the undesired data in it -
you can run the BFG to perform it's simple deletion operations over all your historical
commits.

Note:

* Cleaning Git repos is about *completely* eradicating bad stuff from history.
  If something 'bad' (like a 10MB file, when you're specifying
  `--strip-blobs-bigger-than 5M`) is in a protected commit, it *won't* be
  deleted - it'll persist in your repository,
  [even
  if the BFG deletes if from earlier commits](https://github.com/rtyley/bfg-repo-cleaner/issues/53#issuecomment-50088997). If you want the BFG to delete
  something **you need to make sure your current commits are *clean***.* Note that although the files in those protected commits won't be changed, when those commits follow on from earlier dirty commits, their commit
    ids **will** change, to reflect the changed history - only the SHA-1 id of the filesystem-tree will remain the same.

If you want to turn off the protection (in general, not recommended) you can
use the `--no-blob-protection` flag:

```
$ bfg --strip-biggest-blobs 100 --no-blob-protection repo.git
```
# Faster...

The BFG is [10 - 720x](https://docs.google.com/spreadsheet/ccc?key=0AsR1d5Zpes8HdER3VGU1a3dOcmVHMmtzT2dsS2xNenc) faster
than `git-filter-branch`, turning an *overnight* job into one that takes *less than ten minutes*.

BFG's performance advantage is due to these factors:

* The approach of `git-filter-branch` is to step through every commit in your repository, examining the complete file-hierarchy of each one. For the intended use-cases of The BFG this is wasteful, as we don't care *where* in a file structure a 'bad' file exists - we just want it dealt with. Inherent in the nature of Git is that *every* file and folder is represented precisely once (and given a unique [SHA-1](https://en.wikipedia.org/wiki/SHA-1) hash-id). The BFG takes advantage of this to process each and every file & folder exactly **once** - no need for extra work.
* Taking advantage of the great support for parallelism in [Scala](https://docs.scala-lang.org/overviews/parallel-collections/overview.html) and the JVM, the BFG does multi-core processing by default - the work of cleaning your Git repository is spread over every single core in your machine and typically consumes 100% of capacity for a substantial portion of the run.
* All action takes place in a single process (the process of the JVM), so doesn't require the frequent fork-and-exec-ing needed by `git-filter-branch`'s mix of Bash and C code.

# Feedback

> I tried deleting using several "how to" blog entries for git filter-branch, but wasn't successful. Then tried The BFG; worked like a champ - very cool tool!
>
> — [Bill Hunt](https://linkedin.com/in/billh), CTO at OptTown

> I found The BFG Repo-Cleaner and ran it to clean up some large files, and was amazed by the performance.
>
> — [Jason Frey](https://github.com/Fryguy), Software Engineer at [Red Hat](https://www.redhat.com/)

> I was able to shrink the current repository down to ~500 megabytes in about 10 minutes when using this tool. My hand crafted scripts clock in at 615 megabytes in 3 days time for comparison.
>
> — [Elliot Glaysher](https://github.com/eglaysher), Google Software Engineer on [Google Chrome](https://code.google.com/p/chromium/issues/detail?id=111570#c29)

> The BFG was simple to set up and so fast that I had to ask Roberto, *"Is that it?"* and check for myself... it worked exactly as intended.
>
> — [Nicholas Tollervey](https://github.com/ntoll), Developer at [The Guardian](https://www.guardian.co.uk/)

> Roberto's creations ([Agit](https://play.google.com/store/apps/details?id=com.madgag.agit) and The BFG) are both very cool ;-)
>
> — [Junio C Hamano](https://git-blame.blogspot.com/), [Maintainer of Git](https://github.blog/2020-04-07-celebrating-15-years-of-git-an-interview-with-git-maintainer-junio-hamano/)

**Also see more feedback on** [**Twitter...**](https://twitter.com/rtyley/timelines/464727264345993216)

# Requirements

* The [Java Runtime Environment](https://www.java.com/en/download/manual.jsp) (**Java 8** or above - BFG [v1.12.16](https://repo1.maven.org/maven2/com/madgag/bfg/1.12.16/bfg-1.12.16.jar) was the last version to support Java 7, [v1.12.3](https://repo1.maven.org/maven2/com/madgag/bfg/1.12.3/bfg-1.12.3.jar) was the last version to support Java 6)

That's it - the Scala library and all other dependencies are folded into the [downloadable jar](#download).

# Links...

* [Rewriting Git project history with The BFG](https://www.guardian.co.uk/info/developer-blog/2013/apr/29/rewrite-git-history-with-the-bfg) - a blogpost for The Guardian
* [GitMinutes](https://episodes.gitminutes.com/2013/04/gitminutes-06-roberto-tyley-on.html) podcast interview
* [Git Going Faster... with Scala](https://www.parleys.com/play/53a7d2d1e4b0543940d9e56b) - talk for ScalaDays 2014, later Parleys *[Presentation of the Day](https://twitter.com/Parleys/status/517319848331083776)*
* [InfoQ interview](https://www.infoq.com/articles/git-Cleaner)
* [Questions tagged `git-rewrite-history`](https://stackoverflow.com/questions/tagged/git-rewrite-history) on Stack Overflow

# License

The BFG is free software: you can redistribute it and/or modify
it under the terms of the [GNU General Public License](https://www.gnu.org/licenses/gpl.html) as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The BFG is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

[Download
.jar file](https://repo1.maven.org/maven2/com/madgag/bfg/1.14.0/bfg-1.14.0.jar)

[The BFG](https://github.com/rtyley/bfg-repo-cleaner) is by [Roberto Tyley](https://github.com/rtyley), the author of [Prout](https://github.com/guardian/prout), [gu:who](https://github.com/guardian/gu-who), [Agit](https://play.google.com/store/apps/details?id=com.madgag.agit) and the packager of [Spongy Castle](https://rtyley.github.io/spongycastle/). [Twitter](https://twitter.com/rtyley) [Google+](https://plus.google.com/%2BRobertoTyley?rel=author) [PGP](rtyley.gpg)

[![Build Status](https://travis-ci.com/rtyley/bfg-repo-cleaner.svg?branch=master)](https://travis-ci.com/rtyley/bfg-repo-cleaner)

This page was generated by [GitHub Pages](https://pages.github.com/) using the Architect theme by [Jason Long](https://twitter.com/jasonlong).



=== Content from github.com_675fd41a_20250114_225423.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgit%2Fgit%2Fblob%2F2dc94da3744bfbbf145eca587a0f5ff480cc5867%2FDocumentation%2Fgit-clone.txt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgit%2Fgit%2Fblob%2F2dc94da3744bfbbf145eca587a0f5ff480cc5867%2FDocumentation%2Fgit-clone.txt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=git%2Fgit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[git](/git)
/
**[git](/git/git)**
Public

* [Notifications](/login?return_to=%2Fgit%2Fgit) You must be signed in to change notification settings
* [Fork
  25.8k](/login?return_to=%2Fgit%2Fgit)
* [Star
   53.2k](/login?return_to=%2Fgit%2Fgit)

* [Code](/git/git)
* [Pull requests
  194](/git/git/pulls)
* [Actions](/git/git/actions)
* [Security](/git/git/security)
* [Insights](/git/git/pulse)

Additional navigation options

* [Code](/git/git)
* [Pull requests](/git/git/pulls)
* [Actions](/git/git/actions)
* [Security](/git/git/security)
* [Insights](/git/git/pulse)

## Files

 2dc94da
## Breadcrumbs

1. [git](/git/git/tree/2dc94da3744bfbbf145eca587a0f5ff480cc5867)
2. /[Documentation](/git/git/tree/2dc94da3744bfbbf145eca587a0f5ff480cc5867/Documentation)
/
# git-clone.txt

Copy path Blame  Blame
## Latest commit

## History

[History](/git/git/commits/2dc94da3744bfbbf145eca587a0f5ff480cc5867/Documentation/git-clone.txt)364 lines (313 loc) · 13.5 KB 2dc94da
## Breadcrumbs

1. [git](/git/git/tree/2dc94da3744bfbbf145eca587a0f5ff480cc5867)
2. /[Documentation](/git/git/tree/2dc94da3744bfbbf145eca587a0f5ff480cc5867/Documentation)
/
# git-clone.txt

Top
## File metadata and controls

* Code
* Blame

364 lines (313 loc) · 13.5 KB[Raw](https://github.com/git/git/raw/2dc94da3744bfbbf145eca587a0f5ff480cc5867/Documentation/git-clone.txt)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364git-clone(1)============
NAME----git-clone - Clone a repository into a new directory
SYNOPSIS--------[verse]'git clone' [--template=<template-directory>] [-l] [-s] [--no-hardlinks] [-q] [-n] [--bare] [--mirror] [-o <name>] [-b <name>] [-u <upload-pack>] [--reference <repository>] [--dissociate] [--separate-git-dir <git-dir>] [--depth <depth>] [--[no-]single-branch] [--no-tags] [--recurse-submodules[=<pathspec>]] [--[no-]shallow-submodules] [--[no-]remote-submodules] [--jobs <n>] [--sparse] [--[no-]reject-shallow] [--filter=<filter>] [--] <repository> [<directory>]
DESCRIPTION-----------
Clones a repository into a newly created directory, createsremote-tracking branches for each branch in the cloned repository(visible using `git branch --remotes`), and creates and checks out aninitial branch that is forked from the cloned repository'scurrently active branch.
After the clone, a plain `git fetch` without arguments will updateall the remote-tracking branches, and a `git pull` withoutarguments will in addition merge the remote master branch into thecurrent master branch, if any (this is untrue when "--single-branch"is given; see below).
This default configuration is achieved by creating references tothe remote branch heads under `refs/remotes/origin` andby initializing `remote.origin.url` and `remote.origin.fetch`configuration variables.
OPTIONS--------l::--local:: When the repository to clone from is on a local machine, this flag bypasses the normal "Git aware" transport mechanism and clones the repository by making a copy of HEAD and everything under objects and refs directories. The files under `.git/objects/` directory are hardlinked to save space when possible.+If the repository is specified as a local path (e.g., `/path/to/repo`),this is the default, and --local is essentially a no-op. If therepository is specified as a URL, then this flag is ignored (and wenever use the local optimizations). Specifying `--no-local` willoverride the default when `/path/to/repo` is given, using the regularGit transport instead.+\*NOTE\*: this operation can race with concurrent modification to thesource repository, similar to running `cp -r src dst` while modifying`src`.
--no-hardlinks:: Force the cloning process from a repository on a local filesystem to copy the files under the `.git/objects` directory instead of using hardlinks. This may be desirable if you are trying to make a back-up of your repository.
-s::--shared:: When the repository to clone is on the local machine, instead of using hard links, automatically setup `.git/objects/info/alternates` to share the objects with the source repository. The resulting repository starts out without any object of its own.+\*NOTE\*: this is a possibly dangerous operation; do \*not\* useit unless you understand what it does. If you clone yourrepository using this option and then delete branches (or use anyother Git command that makes any existing commit unreferenced) in thesource repository, some objects may become unreferenced (or dangling).These objects may be removed by normal Git operations (such as `git commit`)which automatically call `git maintenance run --auto`. (Seelinkgit:git-maintenance[1].) If these objects are removed and were referencedby the cloned repository, then the cloned repository will become corrupt.+Note that running `git repack` without the `--local` option in a repositorycloned with `--shared` will copy objects from the source repository into a packin the cloned repository, removing the disk space savings of `clone --shared`.It is safe, however, to run `git gc`, which uses the `--local` option bydefault.+If you want to break the dependency of a repository cloned with `--shared` onits source repository, you can simply run `git repack -a` to copy allobjects from the source repository into a pack in the cloned repository.
--reference[-if-able] <repository>:: If the reference repository is on the local machine, automatically setup `.git/objects/info/alternates` to obtain objects from the reference repository. Using an already existing repository as an alternate will require fewer objects to be copied from the repository being cloned, reducing network and local storage costs. When using the `--reference-if-able`, a non existing directory is skipped with a warning instead of aborting the clone.+\*NOTE\*: see the NOTE for the `--shared` option, and also the`--dissociate` option.
--dissociate:: Borrow the objects from reference repositories specified with the `--reference` options only to reduce network transfer, and stop borrowing from them after a clone is made by making necessary local copies of borrowed objects. This option can also be used when cloning locally from a repository that already borrows objects from another repository--the new repository will borrow objects from the same repository, and this option can be used to stop the borrowing.
-q::--quiet:: Operate quietly. Progress is not reported to the standard error stream.
-v::--verbose:: Run verbosely. Does not affect the reporting of progress status to the standard error stream.
--progress:: Progress status is reported on the standard error stream by default when it is attached to a terminal, unless `--quiet` is specified. This flag forces progress status even if the standard error stream is not directed to a terminal.
--server-option=<option>:: Transmit the given string to the server when communicating using protocol version 2. The given string must not contain a NUL or LF character. The server's handling of server options, including unknown ones, is server-specific. When multiple `--server-option=<option>` are given, they are all sent to the other side in the order listed on the command line.
-n::--no-checkout:: No checkout of HEAD is performed after the clone is complete.
--[no-]reject-shallow:: Fail if the source repository is a shallow repository. The 'clone.rejectShallow' configuration variable can be used to specify the default.
--bare:: Make a 'bare' Git repository. That is, instead of creating `<directory>` and placing the administrative files in `<directory>/.git`, make the `<directory>` itself the `$GIT\_DIR`. This obviously implies the `--no-checkout` because there is nowhere to check out the working tree. Also the branch heads at the remote are copied directly to corresponding local branch heads, without mapping them to `refs/remotes/origin/`. When this option is used, neither remote-tracking branches nor the related configuration variables are created.
--sparse:: Employ a sparse-checkout, with only files in the toplevel directory initially being present. The linkgit:git-sparse-checkout[1] command can be used to grow the working directory as needed.
--filter=<filter-spec>:: Use the partial clone feature and request that the server sends a subset of reachable objects according to a given object filter. When using `--filter`, the supplied `<filter-spec>` is used for the partial clone filter. For example, `--filter=blob:none` will filter out all blobs (file contents) until needed by Git. Also, `--filter=blob:limit=<size>` will filter out all blobs of size at least `<size>`. For more details on filter specifications, see the `--filter` option in linkgit:git-rev-list[1].
--mirror:: Set up a mirror of the source repository. This implies `--bare`. Compared to `--bare`, `--mirror` not only maps local branches of the source to local branches of the target, it maps all refs (including remote-tracking branches, notes etc.) and sets up a refspec configuration such that all these refs are overwritten by a `git remote update` in the target repository.
-o <name>::--origin <name>:: Instead of using the remote name `origin` to keep track of the upstream repository, use `<name>`. Overrides `clone.defaultRemoteName` from the config.
-b <name>::--branch <name>:: Instead of pointing the newly created HEAD to the branch pointed to by the cloned repository's HEAD, point to `<name>` branch instead. In a non-bare repository, this is the branch that will be checked out. `--branch` can also take tags and detaches the HEAD at that commit in the resulting repository.
-u <upload-pack>::--upload-pack <upload-pack>:: When given, and the repository to clone from is accessed via ssh, this specifies a non-default path for the command run on the other end.
--template=<template-directory>:: Specify the directory from which templates will be used; (See the "TEMPLATE DIRECTORY" section of linkgit:git-init[1].)
-c <key>=<value>::--config <key>=<value>:: Set a configuration variable in the newly-created repository; this takes effect immediately after the repository is initialized, but before the remote history is fetched or any files checked out. The key is in the same format as expected by linkgit:git-config[1] (e.g., `core.eol=true`). If multiple values are given for the same key, each value will be written to the config file. This makes it safe, for example, to add additional fetch refspecs to the origin remote.+Due to limitations of the current implementation, some configurationvariables do not take effect until after the initial fetch and checkout.Configuration variables known to not take effect are:`remote.<name>.mirror` and `remote.<name>.tagOpt`. Use thecorresponding `--mirror` and `--no-tags` options instead.
--depth <depth>:: Create a 'shallow' clone with a history truncated to the specified number of commits. Implies `--single-branch` unless `--no-single-branch` is given to fetch the histories near the tips of all branches. If you want to clone submodules shallowly, also pass `--shallow-submodules`.
--shallow-since=<date>:: Create a shallow clone with a history after the specified time.
--shallow-exclude=<revision>:: Create a shallow clone with a history, excluding commits reachable from a specified remote branch or tag. This option can be specified multiple times.
--[no-]single-branch:: Clone only the history leading to the tip of a single branch, either specified by the `--branch` option or the primary branch remote's `HEAD` points at. Further fetches into the resulting repository will only update the remote-tracking branch for the branch this option was used for the initial cloning. If the HEAD at the remote did not point at any branch when `--single-branch` clone was made, no remote-tracking branch is created.
--no-tags:: Don't clone any tags, and set `remote.<remote>.tagOpt=--no-tags` in the config, ensuring that future `git pull` and `git fetch` operations won't follow any tags. Subsequent explicit tag fetches will still work, (see linkgit:git-fetch[1]).+Can be used in conjunction with `--single-branch` to clone andmaintain a branch with no references other than a single clonedbranch. This is useful e.g. to maintain minimal clones of the defaultbranch of some repository for search indexing.
--recurse-submodules[=<pathspec>]:: After the clone is created, initialize and clone submodules within based on the provided pathspec. If no pathspec is provided, all submodules are initialized and cloned. This option can be given multiple times for pathspecs consisting of multiple entries. The resulting clone has `submodule.active` set to the provided pathspec, or "." (meaning all submodules) if no pathspec is provided.+Submodules are initialized and cloned using their default settings. This isequivalent to running`git submodule update --init --recursive <pathspec>` immediately afterthe clone is finished. This option is ignored if the cloned repository doesnot have a worktree/checkout (i.e. if any of `--no-checkout`/`-n`, `--bare`,or `--mirror` is given)
--[no-]shallow-submodules:: All submodules which are cloned will be shallow with a depth of 1.
--[no-]remote-submodules:: All submodules which are cloned will use the status of the submodule's remote-tracking branch to update the submodule, rather than the superproject's recorded SHA-1. Equivalent to passing `--remote` to `git submodule update`.
--separate-git-dir=<git-dir>:: Instead of placing the cloned repository where it is supposed to be, place the cloned repository at the specified directory, then make a filesystem-agnostic Git symbolic link to there. The result is Git repository can be separated from working tree.
-j <n>::--jobs <n>:: The number of submodules fetched at the same time. Defaults to the `submodule.fetchJobs` option.
<repository>:: The (possibly remote) repository to clone from. See the <<URLS,GIT URLS>> section below for more information on specifying repositories.
<directory>:: The name of a new directory to clone into. The "humanish" part of the source repository is used if no directory is explicitly given (`repo` for `/path/to/repo.git` and `foo` for `host.xz:foo/.git`). Cloning into an existing directory is only allowed if the directory is empty.
:git-clone: 1include::urls.txt[]
EXAMPLES--------
\* Clone from upstream:+------------$ git clone git://git.kernel.org/pub/scm/.../linux.git my-linux$ cd my-linux$ make------------
\* Make a local clone that borrows from the current directory, without checking things out:+------------$ git clone -l -s -n . ../copy$ cd ../copy$ git show-branch------------
\* Clone from upstream while borrowing from an existing local directory:+------------$ git clone --reference /git/linux.git \ git://git.kernel.org/pub/scm/.../linux.git \ my-linux$ cd my-linux------------
\* Create a bare repository to publish your changes to the public:+------------$ git clone --bare -l /home/proj/.git /pub/scm/proj.git------------
GIT---Part of the linkgit:git[1] suite

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.aquasec.com_ddc282ea_20250114_225424.html ===


[300,000+ Prometheus Servers and Exporters Exposed to DoS Attacks](https://www.aquasec.com/blog/300000-prometheus-servers-and-exporters-exposed-to-dos-attacks/)
[Sign in](https://cloud.aquasec.com/signin)
[Contact](https://www.aquasec.com/about-us/contact-us/)
[Support](https://support.aquasec.com/support/home)
[We're hiring!](/about-us/careers/)

[Aqua Security](https://www.aquasec.com "Aqua Security")

[Platform](https://www.aquasec.com/aqua-cloud-native-security-platform/)

[Solutions](https://www.aquasec.com/solutions/aws-container-security/)

[Resources](https://www.aquasec.com/resources/)

[Company](/about-us/)

Platform
[Aqua Platform
Unified Cloud Security
Gain total lifecycle visibility, reduce risks and stop attacks with the most comprehensive, fully integrated Cloud Native Application Protection Platform (CNAPP)
Platform overview](/aqua-cloud-native-security-platform/)

* [All platform Integrations](https://www.aquasec.com/integrations/)
* [Aqua CNAPP in action](https://www.aquasec.com/demo/)

[Aqua Open SourceDriving security innovation in the cloud native community](https://www.aquasec.com/products/open-source-projects/)

* [Trivy](https://trivy.dev/)
* [Tracee](https://www.aquasec.com/products/tracee/)

Code Security

* [Scanning & Assurance Scan artifacts across the entire software development lifecycle](https://www.aquasec.com/products/container-scanning)
* [Software Supply Chain SecurityProtect your code, tools, and processes](/products/software-supply-chain-security/)
* [Vulnerability ManagementAdvanced Code-to-Cloud vulnerability management to reduce noise and fix fast](/products/container-vulnerability-scanning/)

Runtime Security

* [Container SecurityFull lifecycle advanced protection for containerized applications](https://www.aquasec.com/products/container-security/)
* [Cloud Workload Protection (CWPP)Runtime protection for every cloud native workload](/products/cwpp-cloud-workload-protection/)
* [Hybrid-Cloud & Multi-Cloud SecurityCode to Cloud security for hybrid and multi-cloud deployments](https://www.aquasec.com/use-cases/multi-cloud-and-hybrid-cloud/)

Posture Management

* [CI/CD Pipeline SecurityAutomate DevSecOps](https://www.aquasec.com/use-cases/devops-security/)
* [Kubernetes SecurityHolistic Kubernetes Security for the Enterprise](https://www.aquasec.com/products/kubernetes-security/)
* [Cloud Security Posture ManagementExtend traditional CSPM with workload visibility](https://www.aquasec.com/products/cspm/)

What's New?

* [New Aqua User Experience: Streamlined Vulnerability Management](https://www.aquasec.com/blog/new-aqua-user-experience-streamline-vulnerability-management/)
* [Walk the Line: High-Fidelity Incident Detection Without Disruption](https://www.aquasec.com/blog/walk-the-line-high-fidelity-incident-detection-without-disruption/)
* [Securing GenAI: Safeguarding LLM-Powered Applications](https://www.aquasec.com/blog/securing-genai-safeguarding-llm-powered-applications-with-aqua/)

Solutions
Use Cases

* [Automate DevSecOpsSecurity and speed without compromise](/use-cases/devops-security/)
* [GenAI Application SecuritySecure GenAI Applications from Code to Runtime](https://www.aquasec.com/solutions/ai-application-security/)
* [Detection and ResponseCloud native detection & Response (CNDR)](https://www.aquasec.com/use-cases/cndr-cloud-native-detection-and-reponse/)
* [Hybrid-Cloud & Multi-CloudSecurity for hybrid and multi-cloud deployments](https://www.aquasec.com/use-cases/multi-cloud-and-hybrid-cloud/)
* [Prove ComplianceControls for PCI, HIPAA, GDPR, and beyond](/use-cases/container-auditing-compliance/)

[Solutions](/solutions/aws-container-security/)

* [Docker SecurityEnterprise-Grade security for Docker environments](https://www.aquasec.com/solutions/docker-container-security/)
* [AWS Cloud SecurityProtect cloud native workloads on AWS](/solutions/aws-container-security/)
* [Google Cloud SecuritySecure K8s apps on Google Cloud Platform](/solutions/google-cloud-kubernetes-security/)

* [OpenShift SecurityCloud Native Security for Red Hat OpenShift](/solutions/red-hat-openshift-container-security/)
* [VMware Tanzu SecurityNative security across VMware Tanzu](/solutions/vmware-tanzu/)
* [Azure Cloud SecurityFull Lifecycle Security for Azure Container Workloads](/solutions/azure-container-security/)

[Industry](https://www.aquasec.com/solutions/federal/)

* [FederalCNAPP solution for Federal Government](https://www.aquasec.com/solutions/federal/)

* [Financial ServicesOne platform for financial services](https://www.aquasec.com/solutions/finance)

[![](https://www.aquasec.com/wp-content/uploads/2021/01/15-misfigs-Resources-thumbnail-1.jpg)
Whitepaper
The 15 Riskiest AWS Misconfigurations

Download Now](https://info.aquasec.com/aws-misconfigurations)

Resources
[The best of cloud native
Aqua Blog
Expert insight, best practices and advice on cloud native security, trends, threat intelligence and compliance
Read the Blog](https://www.aquasec.com/blog/)

* [SEC vs. SolarWinds: A Cybersecurity Game Changer for CISOs](https://www.aquasec.com/blog/sec-vs-solarwinds-ciso)
* [Accenture and Aqua Partner to Empower Cloud Security](https://www.aquasec.com/blog/accenture-and-aqua-partner-to-empower-cloud-security)

Resources

* [Resources CentereBooks, Data sheets, Whitepapers, Webinars, and much more](https://www.aquasec.com/resources/)
* [The Cloud Native ChannelCloud native security webinars & videos](https://www.aquasec.com/resources/virtual-container-security-channel/)
* [AquademyThe Aqua academy](https://aquademy.aquasec.com/)

* [Cloud Native WikiThe educational center for everything cloud native](https://www.aquasec.com/cloud-native-academy/)
* [Docker Containers](https://www.aquasec.com/cloud-native-academy/docker-container/)
* [Software supply chain security](/cloud-native-academy/supply-chain-security/supply-chain-security-mitigating-the-supply-chain-threat/)
* [Cloud security](https://www.aquasec.com/cloud-native-academy/cspm/cloud-security/)
* [Kubernetes](https://www.aquasec.com/cloud-native-academy/kubernetes-101/kubernetes-complete-guide/)
* [Application Security](https://www.aquasec.com/cloud-native-academy/application-security/application-security/)
* [DevSecOps](https://www.aquasec.com/cloud-native-academy/devsecops/devsecops/)

[![](https://www.aquasec.com/wp-content/uploads/2019/08/Horizontal-Dark-Abyss.svg)
Aqua research team
Security research focused on the cloud native stack to identify new threats and attack vectors
More security research](https://www.aquasec.com/research/)
[2023 Annual Aqua Nautilus Research
A Comprehensive Cloud Native Threat Report](https://info.aquasec.com/2023-cloud-native-threat-report)

Company
Recognized Leadership

* [CISO Choice Awards
  Winner for Cloud Workload Protection Platform (CWPP)](https://info.aquasec.com/ciso-choice-awards?utm_source=zoom&utm_campaign=cwpp&utm_content=ciso_awards)
* [Forrester Consulting: The Total Economic Impact™ of Aqua CNAPP
  90% Reduction in vulnerability research and detection time](https://info.aquasec.com/forrester-tei)
* [Frost & Sullivan CNAPP report
  Top innovation leader](https://info.aquasec.com/frost-sullivan-cnapp)

* [About Us](/about-us/)
* [Customers](/customers/)
* [Partners](/partners/)
* [Newsroom](/about-us/news/)

* [Upcoming Events](/events/)
* [Careers](/careers/)
* [Support](https://success.aquasec.com/)
* [Services](https://www.aquasec.com/services/)

Connect

* [Contact](/about-us/contact-us/)
* [Twitter](https://twitter.com/AquaSecTeam)
* [Facebook](https://www.facebook.com/AquaSecTeam)
* [Linkedin](https://www.linkedin.com/company/aquasecteam)
* [Instagram](https://www.instagram.com/aquaseclife/)

[News](/about-us/news/)
[![Aqua logo](https://www.aquasec.com/wp-content/themes/aqua3/images/aqua_default_140x140.png)
Aqua Security Named Leader and Outperformer in GigaOm Radar for Container Security](https://www.aquasec.com/news/leader-gigaom-container-security/)
[![Aqua logo](https://www.aquasec.com/wp-content/themes/aqua3/images/aqua_default_140x140.png)
Aqua Security Expands Certifications in Support of Enterprise Security and Privacy](https://www.aquasec.com/news/certifications-enterprise-security/)
[![](https://www.aquasec.com/wp-content/uploads/2021/08/Newsroom-Bank-Info-Security-140x140.jpg)
Script Kiddie ‘Matrix’ Builds Massive Botnet](https://www.bankinfosecurity.com/script-kiddie-matrix-builds-massive-botnet-a-26926)

Search

[Get Started](/demo/)

[Aqua Blog](https://www.aquasec.com/blog/)
# Phantom Secrets: Undetected Secrets Expose Major Corporations

Security Threat

[Yakir Kadkoda](https://www.aquasec.com/authors/yakir-kadkoda/)[Ilay Goldman](https://www.aquasec.com/authors/ilay-goldman/)June 23, 2024

![Phantom Secrets: Undetected Secrets Expose Major Corporations](https://www.aquasec.com/wp-content/uploads/2024/06/Phantom-secrets-blog-image-main-1200x628-1.jpg)

For years, we’ve been educating developers not to hard-code secrets into their code. Now it turns out that even doing this once might permanently expose that secret, even after its apparent removal – and worse, most secrets scanning methods will miss it. Our research found that almost 18% of secrets might be overlooked.

We uncovered major secrets, including credentials to cloud environments, internal infrastructures, and telemetry platforms, exposed on the Internet. Through a variety of Git-based processes whose impact is not well understood by developers and AppSec professionals, and Source Code Management (SCM) platforms behavior, secrets remain exposed even after considered removed. In this blog, we will explain each of these scenarios.

### Uncovering Hidden Secrets

In this research, we will shed a bright light on advanced strategies for uncovering hidden secrets in your source code. Some of these hidden secrets cannot be discovered by any of the current popular scanning tools. If you care to discover them, you will need to adopt new scanning methods. We will review existing research on various known scenarios and introduce new findings, including case studies on hidden secrets we discovered.

To illustrate the severity of what we review in our research, consider this: by applying one of the strategies we present, we discovered that **conventional scanning methods miss nearly 18% of potential secrets** in the repositories of the top 100 organizations on GitHub (encompassing over 50,000 repositories). And this is just the tip of the iceberg.

During our research, we uncovered some significant secrets, including gaining access to the complete cloud environments of some of the biggest organizations in the world, infiltrating the internal fuzzing infrastructure of sensitive projects, accessing telemetry platforms, and even obtaining access to network devices, SNMP secrets, and camera footage of Fortune 500 companies.

### Case Studies from the Wild

In this research, we present various cases and strategies that allowed us to uncover numerous valid secrets in highly sensitive environments. To motivate you to learn these methods, here are some examples of our findings. These discoveries could lead to significant attacks on the impacted organizations. This highlights how secrets can be missed when users don’t scan their codebase using these strategies.

#### **Get every fuzzing result of Firefox – Mozilla FuzzManager API Token**

FuzzManager is an internal tool used by Mozilla to collect, manage, and analyze fuzzing data, which helps identify potential security vulnerabilities and bugs. Due to the sensitive nature of this information, it is not shared publicly to prevent malicious actors from exploiting unpatched vulnerabilities.

During our research, we discovered an API token for Mozilla’s FuzzManager ([https://fuzzmanager.fuzzing.mozilla.org](https://fuzzmanager.fuzzing.mozilla.org/)) that was leaked in one of Mozilla’s public GitHub repositories. This API token provided access to Mozilla’s internal fuzzing data and results.

![Commit that was only accessible on the mirrored version of the repository and contained a secret ](https://www.aquasec.com/wp-content/uploads/2024/06/1-1024x617.jpg)

Commit that was only accessible on the mirrored version of the repository and contained a secret

In our proof of concept, we were able to download all the fuzzing results related to the Firefox project from this internal service.

![An example of a fuzzing result of Firefox project ](https://www.aquasec.com/wp-content/uploads/2024/06/2-1024x704.jpg)

An example of a fuzzing result of Firefox project

To make things worse, the token was mistakenly configured with high privileges, allowing both read and write access. Access to this fuzzing infrastructure could expose known fuzzing results, revealing unpatched security vulnerabilities in the different projects. With detailed information on specific bugs, attackers could craft precise and effective exploits, increasing the risk of successful attacks on users.

The write privilege can be used by an attacker to erase, distort or manipulate fuzzing data, in order to hide an interesting data-point.

It is also important to note that the Tor Browser is based on Firefox. Any vulnerabilities discovered in Firefox through this fuzzing infrastructure could potentially exist in Tor as well, exposing it to similar risks.

We [reported](https://hackerone.com/reports/2030076) our findings to the Mozilla security team, which promptly rotated the token.

#### Protecting Mozilla’s Telemetry Data: Leaked Employee API Token

Mozilla’s telemetry system collects usage statistics, performance metrics, and other data from Firefox users to enhance browser performance. The telemetry dashboard is used to create queries and dashboards using the aggregated telemetry data of users. The dashboard also allows access to information about Mozilla products and business which is considered confidential company data, therefore, access is generally restricted to authorized personnel only.

During our research, we discovered an API token belonging to a Mozilla employee on the telemetry service ([https://sql.telemetry.mozilla.org](https://sql.telemetry.mozilla.org/)) that had been inadvertently leaked in one of Mozilla’s public GitHub repositories.

![Secret that was exposed in a Git Commit ](https://www.aquasec.com/wp-content/uploads/2024/06/3-1024x859.jpg)

Secret that was exposed in a Git Commit

This token granted access to the service dashboard, which contained confidential data.

![Access to Mozilla telemetry (https://sql.telemetry.mozilla.org) with leaked employee token ](https://www.aquasec.com/wp-content/uploads/2024/06/4-1024x501.jpg)

Access to Mozilla telemetry (https://sql.telemetry.mozilla.org) with leaked employee token

Upon identifying this exposure, we promptly [reported](https://hackerone.com/reports/2193815) our findings to Mozilla. They responded immediately by rotating the compromised token and removing it from the service.

#### Meraki API Tokens of Fortune 500 Companies

Meraki API tokens grant access to the Meraki Dashboard API, which is used for managing network resources. These tokens are extremely sensitive as they offer direct control over network configurations and data. If exposed, the risks include unauthorized access, allowing attackers to seize control of network resources and compromise sensitive information.

During our research, we discovered privileged Meraki API tokens used by some of the Fortune 500 companies. These tokens could allow attackers to access network devices, SNMP secrets, camera footage, and more, serving as an initial foothold for the exposed parties. We reported this issue to the companies involved and to Cisco, which immediately investigated the issue and rotated the tokens.

![Retrieving sensitive data, such as SNMP secrets, using the exposed tokens](https://www.aquasec.com/wp-content/uploads/2024/06/5-1024x676.jpg)

Retrieving sensitive data, such as SNMP secrets, using the exposed tokens

#### Healthcare Company Leaves Crown Jewels Unguarded

During our research, we found an Azure service principal token belonging to a large healthcare company exposed in a Git commit.

This token had high privilege on their Azure AD, high access to the company’s internal Azure Kubernetes Service (AKS), their Azure Container Registry (ACR), and many other resources on Azure. For example, the token enabled retrieving admin credentials for their AKS instances, this may lead to full control over the Kubernetes clusters of the organization. The token also allowed to obtain credentials to the internal ACR, which could have led an attacker to perform a [supply chain attack](https://www.aquasec.com/cloud-native-academy/supply-chain-security/software-supply-chain-attacks/), by pushing a malicious container image, impacting the organization, and customers.

![Obtaining AKS and ACR privileged credentials with the leaked Service Principal token ](https://www.aquasec.com/wp-content/uploads/2024/06/6-1024x573.jpg)

Obtaining AKS and ACR privileged credentials with the leaked Service Principal token

We immediately reported our findings to the company, who promptly rotated the compromised token and investigated the case.

### Explaining How We Found These Secrets

Now that we have showcased the value of our research, let’s delve into the techniques that led to these significant findings. First, we’ll start with some background information, basic assumptions, and Git internals before moving on to the details.

#### **Background and Basic Assumptions**

In the past we heard a lot of horror stories about leaked secrets in various SCM platforms. Those cases raised great awareness among developers and organizations. Thus, they invested resources using [built-in features](https://docs.github.com/en/code-security/secret-scanning/about-secret-scanning) on some platforms to alert users about possible leaks and prevent secrets from being pushed from the beginning.

Additionally, some companies actively search for leaks of their users’ tokens. Most importantly, many have adopted bug bounty programs. This approach encourages numerous ethical hackers to disclose these secrets and report them to companies before attackers can exploit them.

While these solutions are great and actively reduce a lot of the risks, they often miss secrets as detailed below.

#### **Secrets Scanning Tools and Their Blind Spots**

The problem of exposed secrets in source code remains a common and significant challenge in the software development life cycle (SDLC).

Not all secrets scanning tools are alike, the diverse scanning tools vary in the volume of results, and the level of their accuracy.

When building a [secrets](https://www.aquasec.com/cloud-native-academy/kubernetes-101/secret-scanning/) scanning tool you need to take some basic engineering decisions, for instance will the detection mechanism be based on pattern recognition, or the detection is entropy-based.

This may impact the volume of results. Now you need another algorithm to verify the accuracy of these results, there’s a fine balance between false positive and false negative. These decisions impact the effectiveness of the secrets scanning tool and this leads to the conclusion that companies need to use multiple scanning tools to get maximum results.

#### Several nuances that further contribute to this complexity:

* API key patterns often do not conform to standard regular expression models, making detection more challenging.

* Hardcoded secrets can be found in unpredictable locations, extending beyond the usual confines of configuration files or URLs parameters.

* Credentials exhibit varying entropy levels, indicating that not all of them will be easily detectable based on complexity.

* [Hardcoded secrets can be encoded](https://blog.aquasec.com/the-ticking-supply-chain-attack-bomb-of-exposed-kubernetes-secrets) in many ways within the source code, which can further complicate the scanning process.

Nevertheless, there is another dimension to this problem. In some cases, the secrets scanners completely miss vast areas of the code base, due to inherent limitations and the behavior of the SCM platforms, which leads to missed secrets. De facto there are various commits that remain unscanned or unreachable for the secrets scanners.

## Why Do Secrets Scanning Tools Miss Secrets?

Most of the time when you run a secrets scanning on your SCM, you will be using the `git clone`, command, either actively or behind the scenes in the internals of the scanning tool.

Due to edge cases or design choices of Git and SCM platforms (GitHub, GitLab, Bitbucket, Azure Repos, and more). When using `git clone` command, you will miss some commits that remain unscanned and unreachable. In this case, these commits may contain secrets that won’t be discovered.

GitHub is a popular platform with plenty of public repositories. Hence, it is often targeted by attackers who launch massive secrets harvesting campaigns. Therefore, in our research we decided to focus on this SCM platform. Nevertheless, we will also show examples from other SCM, to emphasis that this problem isn’t limited to GitHub.

Interestingly, in their [documentation](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository#about-sensitive-data-exposure) GitHub state unequivocally that sensitive data can be exposed via different scenarios, but they don’t explain how and why this exposure happens. It’s unclear for users how this happens and how to find these exposed sensitive data. In this blog we aim to shed a brighter light on most of these scenarios.

#### Technical Explanation

While there are number of reasons that may lead to missed secrets, we chose to focus in three main categories:

1. Secrets that are accessible via `git clone`
2. Secrets that are accessible only via `git clone --mirror`
3. Secrets that are accessible via cached views of SCM platforms

#### **Secret that are accessible via git clone**

By referring to secrets accessible only via `git clone` we mean the most popular methods and approaches for secrets scanning. A workflow, user, DevOps engineer, or researcher runs `git clone` to clone a project from source control management systems like GitHub and then uses a secrets scanning tool, such as [Gitleaks](https://github.com/gitleaks/gitleaks) or [TruffleHog](https://github.com/trufflesecurity/trufflehog) (There are plenty of secrets scanning tools, but for simplicity, we will focus on the popular ones).

![The Iceberg of Secrets: Most secrets will be revealed in cloned versions of a Git repository ](https://www.aquasec.com/wp-content/uploads/2024/06/7-1024x576.jpg)

The Iceberg of Secrets: Most secrets will be revealed in cloned versions of a Git repository

Usually, the scan will cover different branches, the commit history, and other areas of the repository. This is the most standard way most of us scan our code. However, there are risks because there is more to scan, and secrets and sensitive data may still exist in your repository.

#### Secret that are accessible via git clone – -mirror

In short, the command `git clone --mirror` fetches a copy of your repository that includes all references, such as all remote branches, tags, etc. ensuring a complete copy of the original repository as it exists in the remote/origin (the term `origin` is the default name for a remote repository).

On February 11, 2022, the cybersecurity consultancy [nightwatchcybersecurity](https://twitter.com/nightwatchcyber) released a blog post discussing an issue they named [GitBleed](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/) (CVE-2022-24975).

The CVE is about the Git documentation regarding the `--mirror` option, which does not mention the availability of deleted content when a user clones a project with `--mirror`. This CVE has been disputed by multiple third parties who believe this is the intended behavior of Git.

Here is the [official response](https://lore.kernel.org/git/xmqq4k14qe9g.fsf%40gitster.g/) of git regarding this CVE.

![The Iceberg of Secrets: The next layer of secrets exists in the mirror version of a Git repository. ](https://www.aquasec.com/wp-content/uploads/2024/06/8-1024x576.jpg)

The Iceberg of Secrets: The next layer of secrets exists in the mirror version of a Git repository.

Anyway, this issue highlights that when scanning a repository for secrets using `git clone` rather than `git clone --mirror`, there is a risk of missing sensitive data that exists only in mirrored copies of your repository.

**This finding is significant since the majority of users/workflows use the git clone command**. What’s even worse is that many scanning tools do not support scanning mirror repositories, or users must use them in a specific way to scan mirrored repositories, leaving users with limited options to scan the repository for secrets.

Which means potentially, there are numerous leaked secrets out there that users don’t yet know they might accidentally reveal, because they never scan the mirror version of their repositories.

#### What Is a Mirror Repository, and Why Does It Contain More Content?

When we reviewed the GitBleed research, we noticed it lacked a detailed explanation of *why* the issue is happening. The focus was primarily on describing the issue itself.

Here, we aim to delve deeper into the reasons behind this occurrence, exploring Git’s internal workings to provide a clearer understanding of how and why some secrets are only accessible in the mirror copy of a repository.

As a reminder, in the original research the author claimed that the main gap between the `git clone` and `git clone --mirror` commands stem from deleted content. We would like to clarify that the issue is not primarily related to “deleted” content, although that is one aspect. The real reason for discovering additional content on mirrored repositories lies in the behavior of certain SCM platforms, which can be problematic in specific scenarios, as well as the typical behavior of Git, which can be misused by users.

As we mentioned above, mirrored repository includes all references of the original repository as they exist in the SCM.

When we want to get the mirrored copy of our repository, we can use `git clone --mirror <repository-url>`. This command creates an exact replica of the repository, which is useful for tasks such as creating backups and moving repositories between SCM platforms or hosting servers.

Essentially, when you execute `git clone --mirror`, you’re instructing it to get every piece of code, every branch, and every commit – the entire repository content.

To understand what is happening behind the scenes when you perform a regular `git clone` and `git clone --mirror`, let’s first understand what references are on git.

Basically, references (or refs) are pointers to commits, and git stores information about your repository’s branches, tags, etc., in these data structures.

Branches are stored in references named `refs/heads/<branch_name>`, and tags are stored in references named `refs/tags/<tag_name>`. [Remote branches](https://git-scm.com/book/en/v2/Git-Branching-Remote-Branches) are stored in `refs/remotes/origin/<branch_name>` and pull requests in some SCM platforms are stored in references named `refs/pull/<id>`, and so on.

A regular branch name like `bugfix` is actually a reference whose full name is spelled `refs/heads/bugfix`.

It is unnecessary to write the full name of the reference, and we can omit different parts of its prefix when using commands like `git show <reference_name>`. For example: `refs/remotes/origin/<branch_name>` is equivalent to `remotes/origin/<branch_name>` and `origin/<branch_name>`.

Remote-tracking branches are references that reflect the state of remote branches. They are local references that you cannot move manually – Git updates them automatically during any network communication to ensure they accurately represent the state of the remote repository.

Think of them as bookmarks that remind you where the branches in your remote repositories were the last time you connected to them. For example, in the remote (GitHub), you might have a branch called `my-branch` represented as `refs/heads/my-branch`. When you clone or fetch the repository, you will have a local reference for the same branch as `refs/remotes/origin/my-branch`

**The concept of remote-tracking branches exists only in your local repository**. Therefore, there is no reason for a reference like `refs/remotes/origin/my-branch` to exist on GitHub (or others SCM platforms). This would be pointless because the same branch is hosted on GitHub as `refs/heads/my-branch`

To fully understand the issue with secrets that are accessible only via `git clone --mirror`, let’s delve into how git clone knows which references to fetch/map.

When you open the `.git` folder and look into the `config` file, you will see a line like this: `fetch = +refs/heads/*:refs/remotes/origin/*`. This line essentially tells Git to fetch all branches from the remote (in our case, GitHub) and map them to remote-tracking branches locally. As a result, when we clone a repository in the usual way, we get all the existing branches of the project.

In contrast, the configuration for `git clone --mirror` looks like this: `fetch = +refs/*:refs/*`. This means that every reference from the remote repository is fetched and mapped directly, including pull request references, remote-tracking branch references, and any other references.

In summary, using `git clone --mirror` brings in everything, including references not typically fetched by a standard clone. In contrast, `git clone` only brings branches that exist in the remote. This is why you might find different and new commits that can be accessed and scanned for sensitive data.

[![The difference between `git clone` and `git clone --mirror` ](https://www.aquasec.com/wp-content/uploads/2024/06/8.5_x2.jpg)](https://www.aquasec.com/wp-content/uploads/2024/06/8.5_x2.jpg)

The difference between `git clone` and `git clone –mirror`

Now that we have some basic knowledge about Git internals, let’s describe the most common scenario that leads to secrets being exposed only in the mirrored version of our projects:

#### First Blind Spot: Pull Request References

GitHub stores information about pull requests in read-only reference in the following format: `refs/pull/<pull_request_number>/head`

As we mentioned before, this kind of reference will not be fetched in a regular clone but will be in a mirrored clone.

Pull request references remain forever and do not [get deleted](https://stackoverflow.com/questions/18318097/delete-a-closed-pull-request-from-github/18318431#18318431) in the usual way (you will need GitHub support to delete them).

As a result, secrets present in a pull request’s history will not be exposed when scanning a Git repository using only a git clone command.

However, if a pull request containing secrets is merged into the project, these secrets become part of the branch history and will be detected since branches are fetched with a regular `git clone`. Additionally, if the pull request is not merged but is opened from a branch within the main project, the secrets will also be found because, as mentioned, branches are fetched during a `git clone`.

Nevertheless, the following secret scenario will only be accessible with a `git clone --mirror`:

1. A pull request that contains a secret in its history is “closed” or “squashed and merged”, and the branch from which the pull request was created being deleted (it is very common to delete branches after the pull request is closed or merged).
2. A pull request made from a fork. In this scenario, whether the pull request is open, closed, or squashed, there is no local branch in the scanned repository with the secret. Therefore, only a mirrored clone will fetch the pull request with the sensitive data.

![List remote references of our Git project, including a reference to the pull request in refs/pull/1/head ](https://www.aquasec.com/wp-content/uploads/2024/06/9_edited.jpg)

List remote references of our Git project, including a reference to the pull request in refs/pull/1/head

Other platforms like GitLab and Azure Repos have similar references for pull requests.

For example, a merge request reference on GitLab is called `refs/merge-requests/#{id}/head`, but they behave differently. [GitLab deletes merge request refs](https://gitlab.com/gitlab-org/gitlab/-/issues/223156) 14 days after being merged/closed, and Azure Repos delete these references if the pull request is deleted. However, if the pull request is rejected, these references will still be accessible with `git clone --mirror`.

Bitbucket does not have references for pull requests, but secrets can still be accessible via the GUI of all SCM platforms.

This raises another question: What is the best approach here? Should we have references to these PRs so we can scan them, or should we hide them/make them difficult to access? We need to remember that attackers have time and motivation.

#### Second Blind Spot: Dangling Remote Tracking Branch References

As we mentioned above, remote-tracking branches are references that reflect the state of remote branches. These are local-only references that shouldn’t exist on the remote. However, there are some edge cases that may cause them to appear on the remote, such as on GitHub, Bitbucket, Azure repos and more.

The GitBleed research provides two examples([1](https://github.com/nightwatchcybersecurity/gb_testrepo_reset), [2](https://github.com/nightwatchcybersecurity/gb_testrepo_delete)), where secrets were found in mirrored versions of repositories. The common factor in these scenarios was the use of the `git push --mirror` command. Keep in mind that the `git push --mirror` **is seldom used in practice** and has different purposes than git push.

During our research, we discovered the reason why these scenarios led to secrets existing in the mirrored version of the repository. The command `git push --mirror` triggers an interesting behavior in both Git and some SCM platforms, which results in remote tracking branches being pushed to the SCM.

In general, consider the following scenario:

1. You created a local branch.
2. You mistakenly committed a sensitive data in the local branch.
3. You pushed the local branch to the remote (GitHub).
4. You noticed the mistake and deleted the local branch.
5. You made `git push --mirror`, which deletes the remote branch. But this command also creates a “dangling” new reference for the compromised branch in the remote.

In this scenario the secret will be visible only by `git clone --mirror`.

Let’s show how this looks with relevant commands. consider that you clone a project and then perform the following commands:

![](https://www.aquasec.com/wp-content/uploads/2024/06/10_carbon_bash_01.svg)

At this point, locally we have `refs/heads/new-branch` and `refs/remotes/origin/new-branch`, and remotely the repository named `origin` has `refs/heads/new-branch` – they all point to that *mistake*.

Then you noticed your mistake (secret committed) and you wish to delete it from the local and remote with the following command:

![](https://www.aquasec.com/wp-content/uploads/2024/06/11_carbon_bash_01.svg)

We get rid of the local `refs/heads/new-branch` and propagate the removal to `origin` by removing `refs/heads/new-branch` from it. However, because of the `--mirror` option, which synchronizes the local state to the destination, we also propagate `refs/remotes/origin/new-branch`. So, we push the remote-tracking branch local reference that points to the mistake to the remote, and now when a user clones the project with `git clone --mirror`, they will have access to this secret.

We might think that when we delete a local branch, we can expect to delete the remote-tracking branch as well, but this is not the case.

When we reported this behavior to the Git security team, they responded that this is a very old design decision, coming from a desire not to lose information even when the `origin` loses it, so that they can ask other who forked from them to see if anybody has what they lost by accident and recover it. Indeed, Git has many different use cases that we may not always be aware of or consider.

Git stated that the SCM platforms can prevent those remote-tracking branches from being pushed to remote by implementing pre-receive hooks to limit the hierarchy under `refs/` they receive pushes into. We checked various popular SCM platforms and found that **GitLab is the only SCM that blocks remote-tracking** branch references from being pushed to the remote, and when you try to do so, you will get the following error message:

![](https://www.aquasec.com/wp-content/uploads/2024/06/12_carbon_bash_01.svg)

But GitHub, Bitbucket, Azure Repos, and more accept them, which, as we see, can lead to hidden secrets being exposed.

We have reported our findings to different SCM providers about how the `git push --mirror` command can lead to dangling remote references.

They responded that *“This is an intentional design decision and is working as expected. We may make this functionality stricter in the future”.*

[![This chart illustrates how references are mapped from a remote repository (in this case, GitHub) to a local computer. As shown in the bottom section, using git clone --mirror retrieves all available references. In contrast as shown in the upper section, a regular git clone omits some references that are present in the SCM platform ](https://www.aquasec.com/wp-content/uploads/2024/06/13-998x1024.jpg)](https://www.aquasec.com/wp-content/uploads/2024/06/13.jpg)

This chart illustrates how references are mapped from a remote repository (in this case, GitHub) to a local computer. As shown in the bottom section, using git clone — –mirror retrieves all available references. In contrast as shown in the upper section, a regular git clone omits some references that are present in the SCM platform

In summary, `git clone --mirror` allows us to fetch all the references that exist in the remote repository. Previously, we provided two examples: pull requests and remote-tracking branches. However, there are other references in Git and the SCM, such as notes, tags, and more that we didn’t mention, and secrets can exist on them too.

#### **Statistics of Secrets Accessible Only via git clone – -mirror**

To demonstrate the risk and the prevalence of the scenarios we mentioned, we analyzed how many of these hidden “mirrored” secrets exist. We scanned the [top 100 organizations on GitHub](https://gitstar-ranking.com/organizations), ranked by the number of stars, which together have 52,268 different repositories. We first scanned these repositories with Gitleaks using git clone, then we scanned them again using git clone –mirror. We counted the number of unique secrets, meaning those that only exist in the mirrored version of the repository. We found that **if users only scan for secrets using a regular git clone, they will miss around 17.78% of the potential secrets** in their repositories.\*

![Organizations that scan with git clone will miss an average of 17.78% of potential secrets ](https://www.aquasec.com/wp-content/uploads/2024/06/14.png)

Organizations that scan with git clone will miss an average of 17.78% of potential secrets

\*It’s also important to mention that not every result from a secrets scanning tool is accurate, as there are many false positives. However, these results still need to be verified and considered by organizations. As we will show you, some of these results were significant (and this was after deciding to check only a few of them due to the huge number of potential new secrets).

### Secrets that are accessible via cached views of SCM platforms

As clear as black and white: Everything committed to an SCM platform is permanent. Commits remain accessible through “cache views” on the SCM. Essentially, the SCM saves the commit content forever. This means that even if a secret containing commit is removed from both the cloned and mirrored versions of your repository, it can still be accessed if someone knows the commit hash. They can retrieve the commit content through the SCM platforms GUI and access the leaked secret.

![The Iceberg of Secrets: The next layer of secrets exists in the of the SCM ](https://www.aquasec.com/wp-content/uploads/2024/06/15-1024x576.jpg)

The Iceberg of Secrets: The next layer of secrets exists in the of the SCM

The misconception that a commit is no longer visible can create a false sense of security, leading you to believe that no one can access it. However, as we will demonstrate, there are multiple ways to retrieve these seemingly inaccessible commits hashes.

Not long ago, Neodyme published a great [blog post](https://neodyme.io/en/blog/github_secrets/#github-api-and-its-additional-functions) discussing this risk. Here, we will share additional findings on how different SCM platforms behave and realistic approaches to discovering cached view commits.

Here we will demonstrate four different strategies to retrieve cached view commits, ranked from the least likely to the most likely to encounter cached view commits:

#### 1 – Brute forcing cached view commit hashes

Content of historic commits can be accessed online via the SCM GUI/API. Mind, that if you don’t know the commit hash, and choose to guess it, you only need to guess the four initial characters in order to be automatically redirected to the content of a commit that starts with these 4 characters (on GitHub), as discussed in the Neodyme [blog](https://neodyme.io/en/blog/github_secrets/#github-api-and-its-additional-functions).

In large projects, collisions with other commits starting with the same 4 characters can occur, resulting in a 404-error page. In such cases, we need to add one or two more characters to our guess until we find a commit. Once found, we can extract the full list of available commits from the mirrored version of our repository. If a commit is not present in the mirrored version, it indicates that it is a cached view commit, which might contain interesting content.

It is important to note that this brute force approach can be time-consuming, especially when facing rate limits on the remote server.

On other SCM platforms we found similar behavior: On Bitbucket, you only need to guess too the first 4 characters of the hash. On GitLab, you need to guess the first 7 characters. However, on Azure Repos and AWS CodeCommit, this method is not feasible because you need to guess the full hash.

#### 2 – Using REST API endpoints for event

GitHub provides a REST API that allows us to list [repository events](https://docs.github.com/en/enterprise-server%403.13/rest/activity/events?apiVersion=2022-11-28), which enable searching for commit hashes. Neodyme reported in their blog about a [tool](https://github.com/neodyme-labs/github-secrets) they created to find these hashes.

**The Events API has significant limitations.** Firstly, it will only show the most recent 90 days or up to 300 events, whichever is fewer. This restricts the scope of what can be retrieved and analyzed​.

#### 3 – GUI of Pull requests

This scenario was discovered by our research team. Two common ways to “delete secrets” after they were committed is:

1. `git reset --hard HEAD~{number_of_commits}` followed by `git push --force`.
2. `git commit --amend` followed by `git push --force` (after editing the file with the secret)

However, when these actions are performed on a branch that has an open pull request, it leaves traces in the GUI that reveal the cached view commit hash. This makes it possible to harvest these hashes and search for secrets within them. In this scenario, the hash of the commit will not be accessible via the cloned or mirrored version of the repository but can be harvested from the GUI of the SCM.

All you need to do is search for a string *like* `force-pushed the {branch_name} branch from {commit_hash} to {commit_hash}` in the Pull Request GUI. The interesting commit hash is the first one, as it is typically the cached view.

![It is possible to harvest cached view commits by looking for the word 'force-pushed' in the pull requests and extracting the first commit hash ](https://www.aquasec.com/wp-content/uploads/2024/06/16-1024x276.jpg)

It is possible to harvest cached view commits by looking for the word ‘force-pushed’ in the pull requests and extracting the first commit hash

If you want to do this, you must read [GitHub’s scraping policy](https://docs.github.com/en/site-policy/acceptable-use-policies/github-acceptable-use-policies#7-information-usage-restrictions), as this information is only available by scraping each PR on github.com and is not available via the official API.

#### 4 – Using GitHub historical dataset

This strategy was discovered by our research team. The most efficient way to find cached view commits is by utilizing [GitHub’s historical dataset](http://ghtorrent-downloads.ewi.tudelft.nl/mysql/) and checking past commits records of your repositories. We used this dataset in the past to successfully identify security gaps, such as finding [millions of vulnerable repositories to RepoJacking.](https://www.aquasec.com/blog/github-dataset-research-reveals-millions-potentially-vulnerable-to-repojacking/)

In our use case, anyone can collect every commit ever recorded for a target repository and then verify if these commits are included in the mirrored version. If a commit is not present in the mirrored version, it would be a good idea to fetch this commit from GitHub and scan it for secrets.

The collection covers a 9-year data ranging between 2013 and 2021. This is a significant timeframe which contains a lot of records in which one can find hash view commit, that may contain a live secret.

[![How to extract potential cached commits with GitHub historical dataset](https://www.aquasec.com/wp-content/uploads/2024/06/17-1024x451.jpg)](https://www.aquasec.com/wp-content/uploads/2024/06/17.jpg)

How to extract potential cached commits with GitHub historical dataset

Potential steps needed to retrieve specific commits:

* Download the [dataset](http://ghtorrent-downloads.ewi.tudelft.nl/mysql/) and extract the following three tables: `project.csv`, `project_commits.csv`, and `commits.csv`.

* Search for repositories of your organization to get the related ID of the in the dataset.

* From `project_commits.csv`, obtain the IDs (not the hashes) of the commits related to a target repository.

* Retrieve the commit hashes from commits.csv to get a full list of commits for a target repository to be scanned for cached view commits.

* Clone the target project using `git clone --mirror` and extract each commit that exists in the mirror version.

* Identify only the commits that are in the dataset but not in the mirror (because there are commits that exist in the mirror but not in the dataset, as the dataset is only up to around 2021).

* Utilize the GitHub API to get the content of the cached view of each commit and scan each the blob within the commit using a [secret scanning](https://www.aquasec.com/cloud-native-academy/supply-chain-security/github-secret-scanning/) tool.

While this process is complicated and resource consuming and the odds of finding secrets are rather low, it is still a great way to detect forgotten secrets, that won’t be found otherwise.

### Summary and Mitigations

Secrets remain one of the most sought-after targets for attackers because they are powerful and often the low-hanging fruit. In this blog, we explored various strategies to uncover secrets that may otherwise be hidden for years.

We would like to mention that prevention is the best defense, but we must also review the history of our repositories for secrets, especially if they are public, to eliminate any secrets and traces that attackers could exploit.

To better protect your code and infrastructure, we offer the following mitigation and strategies to address the various risks and scenarios discussed in this blog.

While we will focus on GitHub repositories since they are more likely to be public, these steps are also applicable to other SCM platforms like GitLab, Bitbucket, Azure Repos, etc.

* If you accidentally push a secret to SCM, you should consider it compromised and rotate it immediately. As we have shown, even if you try to hide the commit containing the secret using git commands or tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo), there are still ways to retrieve these commits and access them through cached views on SCM platforms.

* While it may take a long time and is a less practical action to take, to completely delete secrets from GitHub, you will need to contact [GitHub support](https://support.github.com/). This is relevant for most SCM platforms as well.

* Try adopting internal features of the SCMs, such as using push protection.

* GitHub offers their best practice to *[Avoid accidental commits in the future](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository#avoiding-accidental-commits-in-the-future)* we highly recommend going over this document

* Set up pre-commit hooks to scan for secrets before every commit. This helps preventing accidental exposure of sensitive information in your repository.

**Mitigations for Secrets Accessible Only via git clone – -mirror**

* Scan your repository for secrets by using the `git clone --mirror` option.
* Only few secrets scanning tools support scanning bare repositories, below is an example of a couple of them ([Gitleaks](https://github.com/gitleaks/gitleaks) and [TruffleHog](https://github.com/trufflesecurity/trufflehog)).

Gitleaks example

![](https://www.aquasec.com/wp-content/uploads/2024/06/18_carbon_bash_03.svg)

TruffleHog – the option to scan bare repositories was added recently:

![](https://www.aquasec.com/wp-content/uploads/2024/06/19_carbon_bash_01.svg)

**UPDATE** – On June 24, TruffleHog [added](https://github.com/trufflesecurity/trufflehog/pull/2988 "https://github.com/trufflesecurity/trufflehog/pull/2988") the ability to scan different references that we have covered in this blog, and basically get all available references on the remote

* As a first step, we suggest you scan the delta between the regular clone and the mirrored clone, as it may contain hidden secrets. The author of GitBleed gave an example for this concept with the following [tool](https://github.com/nightwatchcybersecurity/gitbleed_tools) (powered by Gitleaks). Naturally you can utilize other secrets scanners under the same concept.

![Focus on secrets unique to the mirror version by checking the delta with the cloned version](https://www.aquasec.com/wp-content/uploads/2024/06/20-1024x470.jpg)

Focus on secrets unique to the mirror version by checking the delta with the cloned version

* **Deleting secrets from pull request references:**   As we mentioned earlier, when a secret is committed to an SCM platform, the commit remains there permanently as a cached view. However, if you still want to hide the commit and rewrite the history, you can use tools like [BFG](https://rtyley.github.io/bfg-repo-cleaner/) or [git-filter-repo](https://github.com/newren/git-filter-repo). In the case of secrets in pull requests, these tools will be insufficient, as they cannot delete the read-only pull request references on the remote by themselves. To delete pull request references that contain secrets, users need to de-reference and delete the compromised references. However, this option is available only to GitHub Enterprise Admins.
  + Users seeking to remove secrets from pull requests in public or private repositories on GitHub.com will need to contact [GitHub Support](https://support.github.com/) for assistance.
  + For those using GitHub Enterprise, a comprehensive [tutorial](https://badshah.io/remove-secrets-from-git-repo/) is available on how to de-reference and delete pull requests from your GitHub server.
* **Deleting Secrets from Dangling Remote Tracking Branch References:** To delete secrets from dangling remote tracking branch references, start by listing all references in the remote using `git ls-remote`. Look for any references that start with the `prefix` `refs/remotes/origin/{branch_name}`. If you find such references, check them for secrets. If a reference contains secrets, delete it from the remote using the command `git push origin` `:refs/remotes/origin/{branch_name}`.
* **Mitigations for Secrets Accessible Only via cached views****:** Ensure that no exposed commits went unnoticed, it is advisable to utilize GitHub’s dataset or scan pull requests for force-pushed commits.
### Aqua Solution

Available in August, Aqua customers using the [Software Supply Chain Security](https://www.aquasec.com/products/software-supply-chain-security/) module will be able to prevent developers from committing code with embedded secrets, and scan for phantom secrets hidden within their SCM file system.

**Published under:** [SECURITY RESEARCH](https://www.aquasec.com/category/research/)

**Tags:** [code security](https://www.aquasec.com/tag/code-security/), [Software Supply Chain Security](https://www.aquasec.com/tag/software-supply-chain-security/)

[Yakir Kadkoda](https://www.aquasec.com/authors/yakir-kadkoda/)
Yakir Kadkoda is a Lead Security Researcher at Aqua's research team, Team Nautilus. He combines his expertise in vulnerability research with a focus on discovering and analyzing new security threats and attack vectors in cloud native environments, supply chain security, and CI/CD processes. Prior to joining Aqua, Yakir worked as a red teamer. Yakir has shared his deep cybersecurity insights at major industry events like Black Hat and RSA.

[Ilay Goldman](https://www.aquasec.com/authors/ilay-goldman/)
Ilay Goldman is a Security Researcher at Aqua's research team, Team Nautilus. He specializes in uncovering and analyzing novel security threats and attack vectors in cloud native environments, as well as in supply chain security and open-source vulnerabilities. Before joining Aqua, he gained experience as a red team member. Ilay has also been an active public speaker, presenting his expertise at major cybersecurity events such as Black Hat and RSA.

Table of Contents

* [Uncovering Hidden Secrets](#section-1)
* [Case Studies from the Wild](#section-2)
* [Explaining How We Found These Secrets](#section-3)
* [Why Do Secrets Scanning Tools Miss Secrets?](#section-4)
* [Secrets that are accessible via cached views of SCM platforms](#section-5)
* [Summary and Mitigations](#section-6)
* [Aqua Solution](#section-7)

Need to secure enterprise workloads?
Aqua Cloud Native Application Protection Platform (CNAPP)
Go cloud native with the experts!
[Get Demo](https://www.aquasec.com/demo)

[Aqua Security](https://www.aquasec.com "Aqua Security")

Aqua Security is the pioneer in securing containerized cloud native applications from development to production. Aqua's full lifecycle solution prevents attacks by enforcing pre-deployment hygiene and mitigates attacks in real time in production, reducing mean time to repair and overall business risk. The Aqua Platform, a Cloud Native Application Protection Platform (CNAPP), integrates security from Code to Cloud, combining the power of agent and agentless technology into a single solution. With enterprise scale that doesn’t slow development pipelines, Aqua secures your future in the cloud. Founded in 2015, Aqua is headquartered in Boston, MA and Ramat Gan, IL protecting over 500 of the world’s largest enterprises.
[![Read Aqua Security reviews on G2](https://www.aquasec.com/wp-content/themes/aqua3/images/g2_gray_8.png)](https://www.g2.com/products/aqua-security/reviews?utm_source=review-widget "Read reviews of Aqua Security on G2")

Use Cases

* [Automate DevSecOps](/use-cases/devops-security/)
* [Modernize Security](/use-cases/cloud-workload-security/)
* [CNDR Cloud Native Detection & Response](/use-cases/cndr-cloud-native-detection-and-reponse/)
* [Compliance and Auditing](/use-cases/container-auditing-compliance/)
* [Serverless Containers & Functions](/products/serverless-container-functions/)
* [Hybrid and Multi Cloud](/use-cases/multi-cloud-and-hybrid-cloud/)
* [Federal Cloud Native Security](/solutions/federal/)

Environments

* [Kubernetes Security](/products/kubernetes-security/)
* [OpenShift Security](/solutions/red-hat-openshift-container-security/)
* [AWS Security](/solutions/aws-container-security/)
* [Azure Cloud Security](/solutions/azure-container-security/)
* [Google Cloud Security](/solutions/google-cloud-kubernetes-security/)
* [Security for VMware Tanzu](/solutions/vmware-tanzu/)
* [Docker Security](/solutions/docker-container-security/)

Partners

* [Technology Partners](/partners/#technology-alliances)
* [Partner With Us](/partners/#partner-with-us)

Resources

* [Aqua Security Research](/research/)
* [The Cloud Native Wiki](/cloud-native-academy/)
* [Kubernetes 101](/cloud-native-academy/kubernetes-101/kubernetes-complete-guide/)
* [AWS Cloud Security](/cloud-native-academy/cspm/aws-cloud-security/)
* [Docker 101](/cloud-native-academy/docker-container/)
* [The Cloud Native Channel](/resources/virtual-container-security-channel/)
* [O’Reilly Book: Kubernetes Security](https://info.aquasec.com/kubernetes-security)
* [CNAPP 101](https://www.aquasec.com/cloud-native-academy/cnapp/what-is-cnapp/)
* [CSPM 101](https://www.aquasec.com/cloud-native-academy/cspm/cloud-security-posture-management-cspm/)
* [Container Security 101](https://www.aquasec.com/cloud-native-academy/container-security/container-security/)

About Us

* [About Aqua](/about-us/)
* [Newsroom](/about-us/news/)
* [Careers](/about-us/careers/)
* [Brand Guidelines](/brand/)
* [Trust & Security](/trust/security/)
* [Aqua Cloud Native Protection FAQ](/aquarantee-cloud-native-protection-warranty/)
* [Professional services](https://www.aquasec.com/services/)

Get in Touch

* [Aqua Blog](https://www.aquasec.com/blog/)
* [Contact Us](/about-us/contact-us/)
* [Success Portal](https://success.aquasec.com/)

Products

* [Cloud Native Security Platform](/aqua-cloud-native-security-platform/)
* [CSPM Cloud Security](/products/cspm/)
* [Container Security](/products/container-security/)
* [Kubernetes Security](/products/kubernetes-security/)
* [Serverless Security](/products/serverless-container-functions/)
* [Cloud VM Security](/products/cloud-vm-security/)
* [Dynamic Threat Analysis (DTA)](/products/container-analysis/)
* [Container Vulnerability Scanning](/products/container-vulnerability-scanning/)
* [Open Source Container Security](/products/open-source-projects/)
* [Platform Integrations](/integrations/)

[Get Started](/demo/)

Copyright © 2025 Aqua Security Software Ltd.   [Privacy Policy](/privacy/) | [Terms of Use](/terms-of-use/) |
[Cookie Settings](#footer "Cookie Settings") |

[Accessibility Tools](#footer "Open accessibility options")

[Normal text size](#footer "Normal text size")
[Medium text size](#footer "Medium text size")
[Large text size](#footer "Large text size")

---

[Normal display](#footer "Normal display")
[Black & White display](#footer "Black & White display")
[High contrast display](#footer "High contrast display")

---

[Stop transitions and animations](#footer "Stop transitions and animations")
[Underline Links](#footer "Underline Links")



=== Content from www.notgitbleed.com_f9e48d3b_20250115_202739.html ===

[Skip to the content.](#content)
![](NotGitBleed2Color.svg)

# NotGitBleed - TL;DR

Due to configuration errors or human error, significant numbers of people may have accidentally checked GitHub credentials
into GitHub commits as metadata, most commonly a username as the author name and a password in the email address field.
We estimate in the region of 50,000 to 100,000[1](#fn:1) user credentials may have been affected covering a wide range of
organisations including governments, corporations, large open-source foundations as well as smaller organisations and
individuals.

GitHub have since rolled out changes that auto revoke PAT tokens and GitHub credentials if they are detected in commit metadata and have performed the task retroactively so any developer on GitHub.com who may have been affected in the past should have received an email already.

While GitHub has a form of MFA known as ‘Verified Device’ <https://github.blog/changelog/2019-07-01-verified-devices/>, many users still choose to re-use the same password across multiple services so it’s important to check if you have accidentally committed any credential and what the risks are related to your account and any organisation you are connected to.

As there are still leaked credentials associated with this issue in GitHub and other datastores we’ve chosen not to disclose any
specific details about affected organisations or repos at this time.

# How we found the issue

We were first alerted to this form of credential leak by a developer who had accidentally committed their username as
their committer name and their password as their committer email address. Interested by this, we manually analysed
several internal repos for this particular client and found that this had happened before a number of times over
the years, possibly without the users ever knowing they had done this.

A simple way to find this is with
`git log |grep Author |grep -v @`

Offering to perform the same task against this client’s public repos, we found a few instances, including a functional
PAT token that would have allowed us to write to at least some of the repos belonging to the client.

Automating the scanning process and choosing some large public organisations, we discovered that while it was a rare
event, it was happening and had been happening for many years without many developers realising. With the huge numbers
of commits on GitHub even comparatively rare events occur a significant number of times. The implications were
terrifying. Many open-source projects may have been disclosing developer credentials in clear text in the very
metadata of their projects.

# Root cause

When the developer first spoke to us, they explained that they were setting up an IDE on their machine and that
through setting up a new project, they were prompted for a git author name and email address. However due to muscle memory and seeing a prompt similar to a login screen, they entered their credentials which were saved as commit metadata every time they committed to any repo.

The following screenshot shows as an example of what IntelliJ looks like when you attempt to commit to a repo with no configured author details. Anything you enter here will be saved in a location such as `~/.gitconfig` and the contents committed to git any time there is a `git push` on this device.

![GitHub committer-email search ](/gitbleed_ide_prompt.png)

There could be other reasons for this, including bugs in automation scripts and possibly a misunderstanding of the git CLI.
However, as well as passwords we found lots of other bits of information such as left-over command line parameters and
even extensive internal LDAP group information.

# How to see if you are affected

All our research was focused on GitHub, both GitHub enterprise (on-prem) and GitHub.com as that is the tooling used
by our clients. However, it is possible that other code repository systems are also affected by this or a similar issue.

In a future blog post we’ll go into more details of the scripts we used to investigate this issue, along with some other external
sources of data that also leaked GitHub credential information.

In this post we’ll summarise a couple of simple ways to look for secrets in GitHub commit data.

## Check Git Config

If you think you may have been affected, checking your git config is the first step that I would recommend, as it would show you the contents of the author email address being automatically used on each commit.

## Git Log

This method is perhaps the least automated but also the simplest. Clone a repo that you have pushed to, navigate to that directory and run `git log| grep Author | grep -v @`.
This method is not fool proof however and anyone who has an @ sign in their password would need to perform an enhanced version of this grep as it would otherwise be removed from the results.

## GitHub Search

You can use the GitHub Advanced Search interface ‘GitHub Searching Commits’ <https://docs.github.com/en/search-github/searching-on-github/searching-commits> to search commit metadata, for example using `committer-email`, the most common place we found passwords. It was easy to identify users who had committed well-known common passwords. However, while this does work it would also potentially expose any password you are searching for in browser history and web logs etc and should only really be used for research purposes.

![GitHub committer-email search ](/GitHubSeach_committer-email.png)

It’s also easy to use the GitHub search API, which at the time (August/September 2021) was in preview. We used it to return the number of commits
with a string matching a common password set as the committer email address.

```
def search_api(password: str) -> int:
    url = 'https://api.github.com/search/commits?q=committer-email:' + password
    headers = {
        'Authorization': 'token' + token,
        'Accept': 'application/vnd.github.cloak-preview'
    }
    r = requests.get(url, headers=headers)
    if r.status_code != 200:
        print(f"Error - HTTP Status Code: {r.status_code}")
        print(r.text)
        return -1
    else:
        result = r.json()
        return result['total_count']

```

Whilst GitHub have implemented a number of mitigations it is still possible to find examples of secrets in commit metadata.

It should also be possible to use the user events API to view all of your personal commit data too however the GitHub documentation suggests you may be limited in the number of events and the timelines for which you can search <https://docs.github.com/en/rest/reference/activity#events>

# Recommendations

## For GitHub Users

* Review IDE and Git configuration files for mis-configurations - see [Check Git Config](#check-git-config)
* Review automation scripts that interact with Git
* Check metadata for any:
  + non-GitHub repositories you use
  + private repos on GitHub.com
  + repos in self-hosted GitHub Enterprise
* If you find misconfigurations during the above steps consider incident response approach. This is likely to be challenging as we have identified issues going back at least 10 years. We would recommend seeking IR expert advice if you have been affected.
* If you use self-hosted GitHub Enterprise - rotate your own credentials as these are not controlled by GitHub
* If you find leaked secrets in private repo metadata, rotate these yourself as these are not automatically changed by GitHub.
* You should also rotate any credentials on any other systems where they may have been reused.
* Enable MFA (Multi-Factor Authentication / also sometimes called Two Step Verification) everywhere it’s supported.
* Review relevant NCSC Advice:
  + <https://www.ncsc.gov.uk/collection/developers-collection/principles/protect-your-code-repository>
  + <https://www.ncsc.gov.uk/collection/passwords/updating-your-approach>

## For Git clients and IDEs

* Apply input validation to fields, especially the email field and display warnings to users if the data doesn’t match the expected format.

# Other Considerations

## Software Supply Chain

We found leaked credentials in a number of very popular open-source projects. We scanned all the repos in a sample of 70 open-source
organisations used by one our clients and in approximately half of them found strings which looked like plausible passwords, as well as some PATs.
These in theory could have been used to make unauthorised changes to these projects.

## External Authentication Providers

For organisations using an external identity provider, e.g., via SAML, GitHub should have no knowledge of the actual credentials. Therefore, the automated security checking implemented by GitHub to prevent users from accidentally leaking credentials in commit data may not detect these.

## Cross domain commits

Users may commit across a range of domains, including to on-prem hosted GitHub Enterprise, GitHub.com and to repos in multiple organisations. This has a number
of implications for detecting and remediating leaked credentials including:

* Users of on-prem GitHub enterprise who’ve accidentally included credentials in their git config may leak internal authentication credentials if they also push
  to external repos. As stated above, GitHub will not be aware of these credentials and has no ability to revoke them or alert users.
* Credentials found in one organisations public repos may be valid against a number of different repos if the user has access, e.g., as a collaborator. This
  can make investigating the scope of compromise for GitHub credentials more difficult.

# Timeline Overview

Whilst GitHub started to deploy some remediation in September 2021 there were, and potentially still are, risks associated with credential reuse for exposed credentials. We felt that on the balance of risk is was better to wait to publish any details until
GitHub had completed the majority of their remediation work.

* July 2021 - Found fist instance on GitHub Enterprise server when a developer asked ‘How do I change my password’
* 12th August 2021 - Contacted GitHub via HackerOne
* 16th August 2021 - HackerOne closed issue
* 27th August 2021 - Escalated to clients GitHub Account Manager
* 2nd September 2021 - Started discussions with GitHub Security Team
* 7th September 2021 - Sought advice from NCSC Vulnerability team due to widespread nature of the issue
* 17th September 2021 - GitHub stated:
  + Scanning the commit metadata (author\_email, author\_name, committer\_email, committer\_name and message) as well as the rest of the

    commit for GitHub tokens and automatically revoking the token and notifying the owner.
* 22nd October 2021 - GitHub confirmed they implemented:
  + Scanning of all historic commit metadata for PATs when a repo is transitioned from private to public and revoking any found
* 1st November 2021 - GitHub started:
  + Scanning pull request, issue descriptions and comments for GitHub PATs, and automatically revoking any found
* 8th March 2022 - GitHub confirmed they:
  + Rolled out an auto-revoke flow for logins/passwords in new commit metadata including usernames / passwords as names or email metadata.
  + Started contacting members of the GitHub secret scanning partner program to let them know they plan to start sending them results found in commit
    metadata and issues / comments. GitHub acknowledged this will take a while to roll out, since it requires partners to start parsing updated
    details in the webhooks when sending them discovered credentials.
* 23rd March 2022 - GitHub contacted us to start the process of co-ordinated disclosure as they plan to publish a change log for the soon to be released Secret Scanning for credentials feature.
* 11th April 2022 - Coordinated disclosure with GitHub (https://github.blog/changelog/2022-04-11-secret-scanning-detects-and-revokes-leaked-passwords/)

# Future posts

We plan to release more details in the coming weeks which will include:

* An overview of the automated scanner and the evolution of this tooling
* Other Data sources we found that leaked secret data from GitHub commit metadata
* Sample testing against the ‘;–have i been pwned?[2](#fn:2) dataset
* Overview of bug reporting process, including interaction with HackerOne[3](#fn:3)
* Some stats

# Researchers

This research was lead by:

* Aaron Devaney (https://www.mdsec.co.uk/)
* supported by Will Deane (ASX Consulting Ltd).

As with all research other people
contributed advice and guidance along the way including, but not limited to:

* UK’s National Cyber Security Centre (NCSC)
* Marcus Pinto (MDSec)
* Carolos Foscolos ([Codollo](https://www.codollo.com)) - who provided the logo as well as advice

# Name

When we first started researching this issue (July/August 2021) Carolos Foscolos came up with the name GitBleed[4](#fn:4), he also created a logo and registered `gitbleed.com`.
We also then registered gitbleed as a github handle and @gitbleed on twitter etc. We have been holding off publishing details to allow GitHub
time to implement mitigations.

In the meantime, other researchers found an issue with
information leaking from a GitHub repo when using the `--mirror` switch with `git clone`
<https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/> and named it GitBleed. As naming things is one of the two hard problems in computer science[5](#fn:5)
and the issue we’ve been researching is no longer ‘GitBleed’, we have gone with NotGitBleed.

# Footnotes

1. 50,000 to 100,000 figure is based on extrapolating data obtained for all commits within a range of fixed periods as we didn’t have the time or resources to search every commit in GitHubs history. [↩](#fnref:1)
2. <https://haveibeenpwned.com> [↩](#fnref:2)
3. <https://www.hackerone.com> [↩](#fnref:3)
4. The name was selected because the potential to backdoor third-party dependencies is serious enough that we wanted a catchy name. [↩](#fnref:4)
5. <https://lmgtfy.app/?q=there+are+only+two+hard+things+in+computer+science> [↩](#fnref:5)

This page was generated by [GitHub Pages](https://pages.github.com).



=== Content from wwws.nightwatchcybersecurity.com_45297b9a_20250115_202740.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Contact
# Contact

Please use the form below to contact us or reach us via email to **info /at\ nightwatchcybersecurity.com**.

Email(required)

Message(required)

Submit

Δ

You can also DM us via Twitter here: [@nightwatchcyber](https://twitter.com/nightwatchcyber).

Like Loading...

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252Fcontact%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252Fcontact%252F)
  + [Copy shortlink](https://wp.me/P7EvFy-4)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/contact/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/4)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from github.com_d408bddd_20250115_202741.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnewren%2Fgit-filter-repo)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnewren%2Fgit-filter-repo)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=newren%2Fgit-filter-repo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[newren](/newren)
/
**[git-filter-repo](/newren/git-filter-repo)**
Public

* [Notifications](/login?return_to=%2Fnewren%2Fgit-filter-repo) You must be signed in to change notification settings
* [Fork
  725](/login?return_to=%2Fnewren%2Fgit-filter-repo)
* [Star
   8.9k](/login?return_to=%2Fnewren%2Fgit-filter-repo)

Quickly rewrite git repository history (filter-branch replacement)

### License

Unknown and 2 other licenses found

### Licenses found

[Unknown
COPYING](/newren/git-filter-repo/blob/main/./COPYING) [GPL-2.0
COPYING.gpl](/newren/git-filter-repo/blob/main/./COPYING.gpl) [MIT
COPYING.mit](/newren/git-filter-repo/blob/main/./COPYING.mit)

[8.9k
stars](/newren/git-filter-repo/stargazers) [725
forks](/newren/git-filter-repo/forks) [Branches](/newren/git-filter-repo/branches) [Tags](/newren/git-filter-repo/tags) [Activity](/newren/git-filter-repo/activity)
 [Star](/login?return_to=%2Fnewren%2Fgit-filter-repo)

 [Notifications](/login?return_to=%2Fnewren%2Fgit-filter-repo) You must be signed in to change notification settings

* [Code](/newren/git-filter-repo)
* [Issues
  51](/newren/git-filter-repo/issues)
* [Pull requests
  2](/newren/git-filter-repo/pulls)
* [Discussions](/newren/git-filter-repo/discussions)
* [Actions](/newren/git-filter-repo/actions)
* [Projects
  0](/newren/git-filter-repo/projects)
* [Security](/newren/git-filter-repo/security)
* [Insights](/newren/git-filter-repo/pulse)

Additional navigation options

* [Code](/newren/git-filter-repo)
* [Issues](/newren/git-filter-repo/issues)
* [Pull requests](/newren/git-filter-repo/pulls)
* [Discussions](/newren/git-filter-repo/discussions)
* [Actions](/newren/git-filter-repo/actions)
* [Projects](/newren/git-filter-repo/projects)
* [Security](/newren/git-filter-repo/security)
* [Insights](/newren/git-filter-repo/pulse)

# newren/git-filter-repo

    main[Branches](/newren/git-filter-repo/branches)[Tags](/newren/git-filter-repo/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[645 Commits](/newren/git-filter-repo/commits/main/) | | |
| [.github](/newren/git-filter-repo/tree/main/.github ".github") | | [.github](/newren/git-filter-repo/tree/main/.github ".github") |  |  |
| [Documentation](/newren/git-filter-repo/tree/main/Documentation "Documentation") | | [Documentation](/newren/git-filter-repo/tree/main/Documentation "Documentation") |  |  |
| [contrib/filter-repo-demos](/newren/git-filter-repo/tree/main/contrib/filter-repo-demos "This path skips through empty directories") | | [contrib/filter-repo-demos](/newren/git-filter-repo/tree/main/contrib/filter-repo-demos "This path skips through empty directories") |  |  |
| [t](/newren/git-filter-repo/tree/main/t "t") | | [t](/newren/git-filter-repo/tree/main/t "t") |  |  |
| [.gitattributes](/newren/git-filter-repo/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/newren/git-filter-repo/blob/main/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/newren/git-filter-repo/blob/main/.gitignore ".gitignore") | | [.gitignore](/newren/git-filter-repo/blob/main/.gitignore ".gitignore") |  |  |
| [COPYING](/newren/git-filter-repo/blob/main/COPYING "COPYING") | | [COPYING](/newren/git-filter-repo/blob/main/COPYING "COPYING") |  |  |
| [COPYING.gpl](/newren/git-filter-repo/blob/main/COPYING.gpl "COPYING.gpl") | | [COPYING.gpl](/newren/git-filter-repo/blob/main/COPYING.gpl "COPYING.gpl") |  |  |
| [COPYING.mit](/newren/git-filter-repo/blob/main/COPYING.mit "COPYING.mit") | | [COPYING.mit](/newren/git-filter-repo/blob/main/COPYING.mit "COPYING.mit") |  |  |
| [INSTALL.md](/newren/git-filter-repo/blob/main/INSTALL.md "INSTALL.md") | | [INSTALL.md](/newren/git-filter-repo/blob/main/INSTALL.md "INSTALL.md") |  |  |
| [Makefile](/newren/git-filter-repo/blob/main/Makefile "Makefile") | | [Makefile](/newren/git-filter-repo/blob/main/Makefile "Makefile") |  |  |
| [README.md](/newren/git-filter-repo/blob/main/README.md "README.md") | | [README.md](/newren/git-filter-repo/blob/main/README.md "README.md") |  |  |
| [git-filter-repo](/newren/git-filter-repo/blob/main/git-filter-repo "git-filter-repo") | | [git-filter-repo](/newren/git-filter-repo/blob/main/git-filter-repo "git-filter-repo") |  |  |
| [git\_filter\_repo.py](/newren/git-filter-repo/blob/main/git_filter_repo.py "git_filter_repo.py") | | [git\_filter\_repo.py](/newren/git-filter-repo/blob/main/git_filter_repo.py "git_filter_repo.py") |  |  |
| [pyproject.toml](/newren/git-filter-repo/blob/main/pyproject.toml "pyproject.toml") | | [pyproject.toml](/newren/git-filter-repo/blob/main/pyproject.toml "pyproject.toml") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* GPL-2.0 license
* MIT license

git filter-repo is a versatile tool for rewriting history, which includes
[capabilities I have not found anywhere
else](#design-rationale-behind-filter-repo). It roughly falls into the
same space of tool as [git
filter-branch](https://git-scm.com/docs/git-filter-branch) but without the
capitulation-inducing poor
[performance](https://public-inbox.org/git/CABPp-BGOz8nks0%2BTdw5GyGqxeYR-3FF6FT5JcgVqZDYVRQ6qog%40mail.gmail.com/),
with far more capabilities, and with a design that scales usability-wise
beyond trivial rewriting cases. [git filter-repo is now recommended by the
git project](https://git-scm.com/docs/git-filter-branch#_warning) instead
of git filter-branch.

While most users will probably just use filter-repo as a simple command
line tool (and likely only use a few of its flags), at its core filter-repo
contains a library for creating history rewriting tools. As such, users
with specialized needs can leverage it to quickly create [entirely new
history rewriting tools](/newren/git-filter-repo/blob/main/contrib/filter-repo-demos).

# Table of Contents

* [Prerequisites](#prerequisites)
* [How do I install it?](#how-do-i-install-it)
* [How do I use it?](#how-do-i-use-it)
* [Why filter-repo instead of other alternatives?](#why-filter-repo-instead-of-other-alternatives)
  + [filter-branch](#filter-branch)
  + [BFG Repo Cleaner](#bfg-repo-cleaner)
* [Simple example, with comparisons](#simple-example-with-comparisons)
  + [Solving this with filter-repo](#solving-this-with-filter-repo)
  + [Solving this with BFG Repo Cleaner](#solving-this-with-bfg-repo-cleaner)
  + [Solving this with filter-branch](#solving-this-with-filter-branch)
  + [Solving this with fast-export/fast-import](#solving-this-with-fast-exportfast-import)
* [Design rationale behind filter-repo](#design-rationale-behind-filter-repo)
* [How do I contribute?](#how-do-i-contribute)
* [Is there a Code of Conduct?](#is-there-a-code-of-conduct)
* [Upstream Improvements](#upstream-improvements)

# Prerequisites

filter-repo requires:

* git >= 2.22.0 at a minimum; [some features](#upstream-improvements)
  require git >= 2.24.0 or later
* python3 >= 3.6

# How do I install it?

While the `git-filter-repo` repository has many files, the main logic
is all contained in a single-file python script named
`git-filter-repo`, which was done to make installation for basic use
on many systems trivial: just place that one file into your $PATH.

See [INSTALL.md](/newren/git-filter-repo/blob/main/INSTALL.md) for things beyond basic usage or special
cases. The more involved instructions are only needed if one of the
following apply:

* you do not find the above comment about trivial installation intuitively
  obvious
* you are working with a python3 executable named something other than
  "python3"
* you want to install documentation (beyond the builtin docs shown with -h)
* you want to run some of the [contrib](/newren/git-filter-repo/blob/main/contrib/filter-repo-demos) examples
* you want to create your own python filtering scripts using filter-repo as
  a module/library

# How do I use it?

For comprehensive documentation:

* see the [user manual](https://htmlpreview.github.io/?https://github.com/newren/git-filter-repo/blob/docs/html/git-filter-repo.html)
* alternative formating of the user manual is available on various
  external sites
  ([example](https://www.mankier.com/1/git-filter-repo)), for those
  that don't like the htmlpreview.github.io layout, though it may
  only be up-to-date as of the latest release

If you prefer learning from examples:

* there is a [cheat sheet for converting filter-branch
  commands](/newren/git-filter-repo/blob/main/Documentation/converting-from-filter-branch.md#cheat-sheet-conversion-of-examples-from-the-filter-branch-manpage),
  which covers every example from the filter-branch manual
* there is a [cheat sheet for converting BFG Repo Cleaner
  commands](/newren/git-filter-repo/blob/main/Documentation/converting-from-bfg-repo-cleaner.md#cheat-sheet-conversion-of-examples-from-bfg),
  which covers every example from the BFG website
* the [simple example](#simple-example-with-comparisons) below may
  be of interest
* the user manual has an extensive [examples
  section](https://htmlpreview.github.io/?https://github.com/newren/git-filter-repo/blob/docs/html/git-filter-repo.html#EXAMPLES)
* I have collected a set of [example filterings based on user-filed issues](/newren/git-filter-repo/blob/main/Documentation/examples-from-user-filed-issues.md)

In either case, you may also find the [Frequently Answered Questions](/newren/git-filter-repo/blob/main/Documentation/FAQ.md) useful.

# Why filter-repo instead of other alternatives?

This was covered in more detail in a [Git Rev News article on
filter-repo](https://git.github.io/rev_news/2019/08/21/edition-54/#an-introduction-to-git-filter-repo--written-by-elijah-newren),
but some highlights for the main competitors:

## filter-branch

* filter-branch is [extremely to unusably
  slow](https://public-inbox.org/git/CABPp-BGOz8nks0%2BTdw5GyGqxeYR-3FF6FT5JcgVqZDYVRQ6qog%40mail.gmail.com/)
  ([multiple orders of magnitude slower than it should
  be](https://git-scm.com/docs/git-filter-branch#PERFORMANCE))
  for non-trivial repositories.
* [filter-branch is riddled with
  gotchas](https://git-scm.com/docs/git-filter-branch#SAFETY) that can
  silently corrupt your rewrite or at least thwart your "cleanup"
  efforts by giving you something more problematic and messy than what
  you started with.
* filter-branch is [very onerous](#simple-example-with-comparisons)
  [to
  use](https://github.com/newren/git-filter-repo/blob/a6a6a1b0f62d365bbe2e76f823e1621857ec4dbd/contrib/filter-repo-demos/filter-lamely#L9-L61)
  for any rewrite which is even slightly non-trivial.
* the git project has stated that the above issues with filter-branch
  cannot be backward compatibly fixed; they recommend that you [stop
  using
  filter-branch](https://git-scm.com/docs/git-filter-branch#_warning)
* die-hard fans of filter-branch may be interested in
  [filter-lamely](/newren/git-filter-repo/blob/main/contrib/filter-repo-demos/filter-lamely)
  (a.k.a. [filter-branch-ish](/newren/git-filter-repo/blob/main/contrib/filter-repo-demos/filter-branch-ish)),
  a reimplementation of filter-branch based on filter-repo which is
  more performant (though not nearly as fast or safe as
  filter-repo).
* a [cheat
  sheet](/newren/git-filter-repo/blob/main/Documentation/converting-from-filter-branch.md#cheat-sheet-conversion-of-examples-from-the-filter-branch-manpage)
  is available showing how to convert example commands from the manual of
  filter-branch into filter-repo commands.

## BFG Repo Cleaner

* great tool for its time, but while it makes some things simple, it
  is limited to a few kinds of rewrites.
* its architecture is not amenable to handling more types of
  rewrites.
* its architecture presents some shortcomings and bugs even for its
  intended usecase.
* fans of bfg may be interested in
  [bfg-ish](/newren/git-filter-repo/blob/main/contrib/filter-repo-demos/bfg-ish), a reimplementation of bfg
  based on filter-repo which includes several new features and bugfixes
  relative to bfg.
* a [cheat
  sheet](/newren/git-filter-repo/blob/main/Documentation/converting-from-bfg-repo-cleaner.md#cheat-sheet-conversion-of-examples-from-bfg)
  is available showing how to convert example commands from the manual of
  BFG Repo Cleaner into filter-repo commands.

# Simple example, with comparisons

Let's say that we want to extract a piece of a repository, with the intent
on merging just that piece into some other bigger repo. For extraction, we
want to:

* extract the history of a single directory, src/. This means that only
  paths under src/ remain in the repo, and any commits that only touched
  paths outside this directory will be removed.
* rename all files to have a new leading directory, my-module/ (e.g. so that
  src/foo.c becomes my-module/src/foo.c)
* rename any tags in the extracted repository to have a 'my-module-'
  prefix (to avoid any conflicts when we later merge this repo into
  something else)

## Solving this with filter-repo

Doing this with filter-repo is as simple as the following command:

```
  git filter-repo --path src/ --to-subdirectory-filter my-module --tag-rename '':'my-module-'
```

(the single quotes are unnecessary, but make it clearer to a human that we
are replacing the empty string as a prefix with `my-module-`)

## Solving this with BFG Repo Cleaner

BFG Repo Cleaner is not capable of this kind of rewrite; in fact, all
three types of wanted changes are outside of its capabilities.

## Solving this with filter-branch

filter-branch comes with a pile of caveats (more on that below) even
once you figure out the necessary invocation(s):

```
  git filter-branch \
      --tree-filter 'mkdir -p my-module && \
                     git ls-files \
                         | grep -v ^src/ \
                         | xargs git rm -f -q && \
                     ls -d * \
                         | grep -v my-module \
                         | xargs -I files mv files my-module/' \
          --tag-name-filter 'echo "my-module-$(cat)"' \
	  --prune-empty -- --all
  git clone file://$(pwd) newcopy
  cd newcopy
  git for-each-ref --format="delete %(refname)" refs/tags/ \
      | grep -v refs/tags/my-module- \
      | git update-ref --stdin
  git gc --prune=now
```

Some might notice that the above filter-branch invocation will be really
slow due to using --tree-filter; you could alternatively use the
--index-filter option of filter-branch, changing the above commands to:

```
  git filter-branch \
      --index-filter 'git ls-files \
                          | grep -v ^src/ \
                          | xargs git rm -q --cached;
                      git ls-files -s \
                          | sed "s%$(printf \\t)%&my-module/%" \
                          | git update-index --index-info;
                      git ls-files \
                          | grep -v ^my-module/ \
                          | xargs git rm -q --cached' \
      --tag-name-filter 'echo "my-module-$(cat)"' \
      --prune-empty -- --all
  git clone file://$(pwd) newcopy
  cd newcopy
  git for-each-ref --format="delete %(refname)" refs/tags/ \
      | grep -v refs/tags/my-module- \
      | git update-ref --stdin
  git gc --prune=now
```

However, for either filter-branch command there are a pile of caveats.
First, some may be wondering why I list five commands here for
filter-branch. Despite the use of --all and --tag-name-filter, and
filter-branch's manpage claiming that a clone is enough to get rid of
old objects, the extra steps to delete the other tags and do another
gc are still required to clean out the old objects and avoid mixing
new and old history before pushing somewhere. Other caveats:

* Commit messages are not rewritten; so if some of your commit
  messages refer to prior commits by (abbreviated) sha1, after the
  rewrite those messages will now refer to commits that are no longer
  part of the history. It would be better to rewrite those
  (abbreviated) sha1 references to refer to the new commit ids.
* The --prune-empty flag sometimes misses commits that should be
  pruned, and it will also prune commits that *started* empty rather
  than just ended empty due to filtering. For repositories that
  intentionally use empty commits for versioning and publishing
  related purposes, this can be detrimental.
* The commands above are OS-specific. GNU vs. BSD issues for sed,
  xargs, and other commands often trip up users; I think I failed to
  get most folks to use --index-filter since the only example in the
  filter-branch manpage that both uses it and shows how to move
  everything into a subdirectory is linux-specific, and it is not
  obvious to the reader that it has a portability issue since it
  silently misbehaves rather than failing loudly.
* The --index-filter version of the filter-branch command may be two to
  three times faster than the --tree-filter version, but both
  filter-branch commands are going to be multiple orders of magnitude
  slower than filter-repo.
* Both commands assume all filenames are composed entirely of ascii
  characters (even special ascii characters such as tabs or double
  quotes will wreak havoc and likely result in missing files or
  misnamed files)

## Solving this with fast-export/fast-import

One can kind of hack this together with something like:

```
  git fast-export --no-data --reencode=yes --mark-tags --fake-missing-tagger \
      --signed-tags=strip --tag-of-filtered-object=rewrite --all \
      | grep -vP '^M [0-9]+ [0-9a-f]+ (?!src/)' \
      | grep -vP '^D (?!src/)' \
      | perl -pe 's%^(M [0-9]+ [0-9a-f]+ )(.*)$%\1my-module/\2%' \
      | perl -pe 's%^(D )(.*)$%\1my-module/\2%' \
      | perl -pe s%refs/tags/%refs/tags/my-module-% \
      | git -c core.ignorecase=false fast-import --date-format=raw-permissive \
            --force --quiet
  git for-each-ref --format="delete %(refname)" refs/tags/ \
      | grep -v refs/tags/my-module- \
      | git update-ref --stdin
  git reset --hard
  git reflog expire --expire=now --all
  git gc --prune=now
```

But this comes with some nasty caveats and limitations:

* The various greps and regex replacements operate on the entire
  fast-export stream and thus might accidentally corrupt unintended
  portions of it, such as commit messages. If you needed to edit
  file contents and thus dropped the --no-data flag, it could also
  end up corrupting file contents.
* This command assumes all filenames in the repository are composed
  entirely of ascii characters, and also exclude special characters
  such as tabs or double quotes. If such a special filename exists
  within the old src/ directory, it will be pruned even though it
  was intended to be kept. (In slightly different repository
  rewrites, this type of editing also risks corrupting filenames
  with special characters by adding extra double quotes near the end
  of the filename and in some leading directory name.)
* This command will leave behind huge numbers of useless empty
  commits, and has no realistic way of pruning them. (And if you
  tried to combine this technique with another tool to prune the
  empty commits, then you now have no way to distinguish between
  commits which were made empty by the filtering that you want to
  remove, and commits which were empty before the filtering process
  and which you thus may want to keep.)
* Commit messages which reference other commits by hash will now
  reference old commits that no longer exist. Attempting to edit
  the commit messages to update them is extraordinarily difficult to
  add to this kind of direct rewrite.

# Design rationale behind filter-repo

None of the existing repository filtering tools did what I wanted;
they all came up short for my needs. No tool provided any of the
first eight traits below I wanted, and no tool provided more than
two of the last four traits either:

1. [Starting report] Provide user an analysis of their repo to help
   them get started on what to prune or rename, instead of expecting
   them to guess or find other tools to figure it out. (Triggered, e.g.
   by running the first time with a special flag, such as --analyze.)
2. [Keep vs. remove] Instead of just providing a way for users to
   easily remove selected paths, also provide flags for users to
   only *keep* certain paths. Sure, users could workaround this by
   specifying to remove all paths other than the ones they want to
   keep, but the need to specify all paths that *ever* existed in
   **any** version of the repository could sometimes be quite
   painful. For filter-branch, using pipelines like `git ls-files | grep -v ... | xargs -r git rm` might be a reasonable workaround
   but can get unwieldy and isn't as straightforward for users; plus
   those commands are often operating-system specific (can you spot
   the GNUism in the snippet I provided?).
3. [Renaming] It should be easy to rename paths. For example, in
   addition to allowing one to treat some subdirectory as the root
   of the repository, also provide options for users to make the
   root of the repository just become a subdirectory. And more
   generally allow files and directories to be easily renamed.
   Provide sanity checks if renaming causes multiple files to exist
   at the same path. (And add special handling so that if a commit
   merely copied oldname->newname without modification, then
   filtering oldname->newname doesn't trigger the sanity check and
   die on that commit.)
4. [More intelligent safety] Writing copies of the original refs to
   a special namespace within the repo does not provide a
   user-friendly recovery mechanism. Many would struggle to recover
   using that. Almost everyone I've ever seen do a repository
   filtering operation has done so with a fresh clone, because
   wiping out the clone in case of error is a vastly easier recovery
   mechanism. Strongly encourage that workflow by [detecting and
   bailing if we're not in a fresh
   clone](https://htmlpreview.github.io/?https://github.com/newren/git-filter-repo/blob/docs/html/git-filter-repo.html#FRESHCLONE),
   unless the user overrides with --force.
5. [Auto shrink] Automatically remove old cruft and repack the
   repository for the user after filtering (unless overridden); this
   simplifies things for the user, helps avoid mixing old and new
   history together, and avoids problems where the multi-step
   process for shrinking the repo documented in the manpage doesn't
   actually work in some cases. (I'm looking at you,
   filter-branch.)
6. [Clean separation] Avoid confusing users (and prevent accidental
   re-pushing of old stuff) due to mixing old repo and rewritten
   repo together. (This is particularly a problem with filter-branch
   when using the --tag-name-filter option, and sometimes also an
   issue when only filtering a subset of branches.)
7. [Versatility] Provide the user the ability to extend the tool or
   even write new tools that leverage existing capabilities, and
   provide this extensibility in a way that (a) avoids the need to
   fork separate processes (which would destroy performance), (b)
   avoids making the user specify OS-dependent shell commands (which
   would prevent users from sharing commands with each other), (c)
   takes advantage of rich data structures (because hashes, dicts,
   lists, and arrays are prohibitively difficult in shell) and (d)
   provides reasonable string manipulation capabilities (which are
   sorely lacking in shell).
8. [Old commit references] Provide a way for users to use old commit
   IDs with the new repository (in particular via mapping from old to
   new hashes with refs/replace/ references).
9. [Commit message consistency] If commit messages refer to other
   commits by ID (e.g. "this reverts commit 01234567890abcdef", "In
   commit 0013deadbeef9a..."), those commit messages should be
   rewritten to refer to the new commit IDs.
10. [Become-empty pruning] Commits which become empty due to filtering
    should be pruned. If the parent of a commit is pruned, the first
    non-pruned ancestor needs to become the new parent. If no
    non-pruned ancestor exists and the commit was not a merge, then it
    becomes a new root commit. If no non-pruned ancestor exists and
    the commit was a merge, then the merge will have one less parent
    (and thus make it likely to become a non-merge commit which would
    itself be pruned if it had no file changes of its own). One
    special thing to note here is that we prune commits which become
    empty, NOT commits which start empty. Some projects intentionally
    create empty commits for versioning or publishing reasons, and
    these should not be removed. (As a special case, commits which
    started empty but whose parent was pruned away will also be
    considered to have "become empty".)
11. [Become-degenerate pruning] Pruning of commits which become empty
    can potentially cause topology changes, and there are lots of
    special cases. Normally, merge commits are not removed since they
    are needed to preserve the graph topology, but the pruning of
    parents and other ancestors can ultimately result in the loss of
    one or more parents. A simple case was already noted above: if a
    merge commit loses enough parents to become a non-merge commit and
    it has no file changes, then it too can be pruned. Merge commits
    can also have a topology that becomes degenerate: it could end up
    with the merge\_base serving as both parents (if all intervening
    commits from the original repo were pruned), or it could end up
    with one parent which is an ancestor of its other parent. In such
    cases, if the merge has no file changes of its own, then the merge
    commit can also be pruned. However, much as we do with empty
    pruning we do not prune merge commits that started degenerate
    (which indicates it may have been intentional, such as with --no-ff
    merges) but only merge commits that become degenerate and have no
    file changes of their own.
12. [Speed] Filtering should be reasonably fast

# How do I contribute?

See the [contributing guidelines](/newren/git-filter-repo/blob/main/Documentation/Contributing.md).

# Is there a Code of Conduct?

Participants in the filter-repo community are expected to adhere to
the same standards as for the git project, so the [git Code of
Conduct](https://git.kernel.org/pub/scm/git/git.git/tree/CODE_OF_CONDUCT.md)
applies.

# Upstream Improvements

Work on filter-repo and [its
predecessor](https://public-inbox.org/git/51419b2c0904072035u1182b507o836a67ac308d32b9%40mail.gmail.com/)
has also driven numerous improvements to fast-export and fast-import
(and occasionally other commands) in core git, based on things
filter-repo needs to do its work:

* git-2.48.0 (to be released Jan 2025)
  + [fast-import: disallow more path components](https://git.kernel.org/pub/scm/git/git.git/commit/?id=da91a90c2f)
  + [fast-import: disallow "." and ".." path components](https://git.kernel.org/pub/scm/git/git.git/commit/?id=4a2790a257)
  + [fast-import: avoid making replace refs point to themselves](https://git.kernel.org/pub/scm/git/git.git/commit/?id=5e904f1a4a)
* git-2.28.0
  + [fast-import: add new --date-format=raw-permissive format](https://git.kernel.org/pub/scm/git/git.git/commit/?id=d42a2fb72f)
* git-2.24.0
  + [fast-export: handle nested tags](https://git.kernel.org/pub/scm/git/git.git/commit/?id=941790d7de)
  + [t9350: add tests for tags of things other than a commit](https://git.kernel.org/pub/scm/git/git.git/commit/?id=8d7d33c1ce)
  + [fast-export: allow user to request tags be marked with --mark-tags](https://git.kernel.org/pub/scm/git/git.git/commit/?id=a1638cfe12)
  + [fast-export: add support for --import-marks-if-exists](https://git.kernel.org/pub/scm/git/git.git/commit/?id=208d69246e)
  + [fast-import: add support for new 'alias' command](https://git.kernel.org/pub/scm/git/git.git/commit/?id=b8f50e5b60)
  + [fast-import: allow tags to be identified by mark labels](https://git.kernel.org/pub/scm/git/git.git/commit/?id=f73b2aba05)
  + [fast-import: fix handling of deleted tags](https://git.kernel.org/pub/scm/git/git.git/commit/?id=3164e6bd24)
  + [fast-export: fix exporting a tag and nothing else](https://git.kernel.org/pub/scm/git/git.git/commit/?id=af2abd870b)
  + [git-fast-import.txt: clarify that multiple merge commits are allowed](https://git.kernel.org/pub/scm/git/git.git/commit/?id=d1387d3895)
* git-2.23.0
  + [t9350: fix encoding test to actually test reencoding](https://git.kernel.org/pub/scm/git/git.git/commit/?id=32615ce762)
  + [fast-import: support 'encoding' commit header](https://git.kernel.org/pub/scm/git/git.git/commit/?id=3edfcc65fd)
  + [fast-export: avoid stripping encoding header if we cannot reencode](https://git.kernel.org/pub/scm/git/git.git/commit/?id=ccbfc96dc4)
  + [fast-export: differentiate between explicitly UTF-8 and implicitly
    UTF-8](https://git.kernel.org/pub/scm/git/git.git/commit/?id=57a8be2cb0)
  + [fast-export: do automatic reencoding of commit messages only if
    requested](https://git.kernel.org/pub/scm/git/git.git/commit/?id=e80001f8fd)
* git-2.22.0
  + [log,diff-tree: add --combined-all-paths option](https://git.kernel.org/pub/scm/git/git.git/commit/?id=d76ce4f734)
  + [t9300: demonstrate bug with get-mark and empty orphan commits](https://git.kernel.org/pub/scm/git/git.git/commit/?id=62edbec7de)
  + [git-fast-import.txt: fix wording about where ls command can appear](https://git.kernel.org/pub/scm/git/git.git/commit/?id=a63c54a019)
  + [fast-import: check most prominent commands first](https://git.kernel.org/pub/scm/git/git.git/commit/?id=5056bb7646)
  + [fast-import: only allow cat-blob requests where it makes sense](https://git.kernel.org/pub/scm/git/git.git/commit/?id=7ffde293f2)
  + [fast-import: fix erroneous handling of get-mark with empty orphan
    commits](https://git.kernel.org/pub/scm/git/git.git/commit/?id=cf7b857a77)
  + [Honor core.precomposeUnicode in more places](https://git.kernel.org/pub/scm/git/git.git/commit/?id=8e712ef6fc)
* git-2.21.0
  + [fast-export: convert sha1 to oid](https://git.kernel.org/pub/scm/git/git.git/commit/?id=843b9e6d48)
  + [git-fast-import.txt: fix documentation for --quiet option](https://git.kernel.org/pub/scm/git/git.git/commit/?id=f55c979b14)
  + [git-fast-export.txt: clarify misleading documentation about rev-list
    args](https://git.kernel.org/pub/scm/git/git.git/commit/?id=4532be7cba)
  + [fast-export: use value from correct enum](https://git.kernel.org/pub/scm/git/git.git/commit/?id=b93b81e799)
  + [fast-export: avoid dying when filtering by paths and old tags exist](https://git.kernel.org/pub/scm/git/git.git/commit/?id=1f30c904b3)
  + [fast-export: move commit rewriting logic into a function for reuse](https://git.kernel.org/pub/scm/git/git.git/commit/?id=f129c4275c)
  + [fast-export: when using paths, avoid corrupt stream with non-existent
    mark](https://git.kernel.org/pub/scm/git/git.git/commit/?id=cd13762d8f)
  + [fast-export: ensure we export requested refs](https://git.kernel.org/pub/scm/git/git.git/commit/?id=fdf31b6369)
  + [fast-export: add --reference-excluded-parents option](https://git.kernel.org/pub/scm/git/git.git/commit/?id=530ca19c02)
  + [fast-import: remove unmaintained duplicate documentation](https://git.kernel.org/pub/scm/git/git.git/commit/?id=25dd3e4889)
  + [fast-export: add a --show-original-ids option to show
    original names](https://git.kernel.org/pub/scm/git/git.git/commit/?id=a965bb3116)
  + [git-show-ref.txt: fix order of flags](https://git.kernel.org/pub/scm/git/git.git/commit/?id=bd8d6f0def)
* git-2.20.0
  + [update-ref: fix type of update\_flags variable to
    match its usage](https://git.kernel.org/pub/scm/git/git.git/commit/?id=e4c34855a2)
  + [update-ref: allow --no-deref with --stdin](https://git.kernel.org/pub/scm/git/git.git/commit/?id=d345e9fbe7)
* git-1.7.3
  + [fast-export: Fix dropping of files with --import-marks and path
    limiting](https://git.kernel.org/pub/scm/git/git.git/commit/?id=4087a02e45)
  + [fast-export: Add a --full-tree option](https://git.kernel.org/pub/scm/git/git.git/commit/?id=7f40ab0916)
  + [fast-export: Fix output order of D/F changes](https://git.kernel.org/pub/scm/git/git.git/commit/?id=060df62422)
  + [fast-import: Improve robustness when D->F changes provided in wrong
    order](https://git.kernel.org/pub/scm/git/git.git/commit/?id=253fb5f889)
* git-1.6.4:
  + [fast-export: Set revs.topo\_order before calling setup\_revisions](https://git.kernel.org/pub/scm/git/git.git/commit/?id=668f3aa776)
  + [fast-export: Omit tags that tag trees](https://git.kernel.org/pub/scm/git/git.git/commit/?id=02c48cd69b)
  + [fast-export: Make sure we show actual ref names instead of "(null)"](https://git.kernel.org/pub/scm/git/git.git/commit/?id=2374502c6c)
  + [fast-export: Do parent rewriting to avoid dropping relevant commits](https://git.kernel.org/pub/scm/git/git.git/commit/?id=32164131db)
  + [fast-export: Add a --tag-of-filtered-object option for newly
    dangling tags](https://git.kernel.org/pub/scm/git/git.git/commit/?id=2d8ad46919)
  + [Add new fast-export testcases](https://git.kernel.org/pub/scm/git/git.git/commit/?id=25e0ca5dd6)
  + [fast-export: Document the fact that git-rev-list arguments are
    accepted](https://git.kernel.org/pub/scm/git/git.git/commit/?id=8af15d282e)
* git-1.6.3:
  + [git-filter-branch: avoid collisions with variables in eval'ed
    commands](https://git.kernel.org/pub/scm/git/git.git/commit/?id=d5b0c97d13)
  + [Correct missing SP characters in grammar comment at top of
    fast-import.c](https://git.kernel.org/pub/scm/git/git.git/commit/?id=98e1a4186a)
  + [fast-export: Avoid dropping files from commits](https://git.kernel.org/pub/scm/git/git.git/commit/?id=ebeec7dbc5)
* git-1.6.1.4:
  + [fast-export: ensure we traverse commits in topological order](https://git.kernel.org/pub/scm/git/git.git/commit/?id=784f8affe4)

## About

Quickly rewrite git repository history (filter-branch replacement)

### Resources

[Readme](#readme-ov-file)
### License

Unknown and 2 other licenses found

### Licenses found

[Unknown
COPYING](/newren/git-filter-repo/blob/main/./COPYING) [GPL-2.0
COPYING.gpl](/newren/git-filter-repo/blob/main/./COPYING.gpl) [MIT
COPYING.mit](/newren/git-filter-repo/blob/main/./COPYING.mit)

[Activity](/newren/git-filter-repo/activity)
### Stars

[**8.9k**
stars](/newren/git-filter-repo/stargazers)
### Watchers

[**53**
watching](/newren/git-filter-repo/watchers)
### Forks

[**725**
forks](/newren/git-filter-repo/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fnewren%2Fgit-filter-repo&report=newren+%28user%29)

## [Releases 14](/newren/git-filter-repo/releases)

[v2.47.0
Latest

Dec 4, 2024](/newren/git-filter-repo/releases/tag/v2.47.0)
[+ 13 releases](/newren/git-filter-repo/releases)

## [Packages 0](/users/newren/packages?repo_name=git-filter-repo)

No packages published

## [Used by 2.6k](/newren/git-filter-repo/network/dependents)

[* ![@ChidambaramR](https://avatars.githubusercontent.com/u/3937823?s=64&v=4)
* ![@SowmyaC28](https://avatars.githubusercontent.com/u/102833324?s=64&v=4)
* ![@ibdems](https://avatars.githubusercontent.com/u/142596630?s=64&v=4)
* ![@janmalyy](https://avatars.githubusercontent.com/u/168116276?s=64&v=4)
* ![@AngelGSoto](https://avatars.githubusercontent.com/u/16337679?s=64&v=4)
* ![@abay-kulamkadyr](https://avatars.githubusercontent.com/u/99425961?s=64&v=4)
* ![@dipandhali2021](https://avatars.githubusercontent.com/u/121673023?s=64&v=4)
* ![@Rohanrn9882](https://avatars.githubusercontent.com/u/105193321?s=64&v=4)

+ 2,586](/newren/git-filter-repo/network/dependents)

## [Contributors 46](/newren/git-filter-repo/graphs/contributors)

* [![@newren](https://avatars.githubusercontent.com/u/5455730?s=64&v=4)](https://github.com/newren)
* [![@dscho](https://avatars.githubusercontent.com/u/127790?s=64&v=4)](https://github.com/dscho)
* [![@stefanor](https://avatars.githubusercontent.com/u/442117?s=64&v=4)](https://github.com/stefanor)
* [![@marcows](https://avatars.githubusercontent.com/u/6334512?s=64&v=4)](https://github.com/marcows)
* [![@xorangekiller](https://avatars.githubusercontent.com/u/5561926?s=64&v=4)](https://github.com/xorangekiller)
* [![@Ikke](https://avatars.githubusercontent.com/u/135698?s=64&v=4)](https://github.com/Ikke)
* [![@benblo](https://avatars.githubusercontent.com/u/574187?s=64&v=4)](https://github.com/benblo)
* [![@RagingCactus](https://avatars.githubusercontent.com/u/1112236?s=64&v=4)](https://github.com/RagingCactus)
* [![@lassik](https://avatars.githubusercontent.com/u/2564245?s=64&v=4)](https://github.com/lassik)
* [![@dalito](https://avatars.githubusercontent.com/u/2648874?s=64&v=4)](https://github.com/dalito)
* [![@HassanAkbar](https://avatars.githubusercontent.com/u/5301572?s=64&v=4)](https://github.com/HassanAkbar)
* [![@J-M0](https://avatars.githubusercontent.com/u/6653392?s=64&v=4)](https://github.com/J-M0)
* [![@fmigneault](https://avatars.githubusercontent.com/u/19194484?s=64&v=4)](https://github.com/fmigneault)
* [![@autumn-traveller](https://avatars.githubusercontent.com/u/50424388?s=64&v=4)](https://github.com/autumn-traveller)

[+ 32 contributors](/newren/git-filter-repo/graphs/contributors)

## Languages

* [Python
  63.9%](/newren/git-filter-repo/search?l=python)
* [Shell
  34.8%](/newren/git-filter-repo/search?l=shell)
* [Makefile
  1.3%](/newren/git-filter-repo/search?l=makefile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


