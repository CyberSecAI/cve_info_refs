=== Content from github.com_3bee1de1_20250115_085329.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Freleases%2Ftag%2Fv2.0.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Freleases%2Ftag%2Fv2.0.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=evmos%2Fevmos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evmos](/evmos)
/
**[evmos](/evmos/evmos)**
Public

* [Notifications](/login?return_to=%2Fevmos%2Fevmos) You must be signed in to change notification settings
* [Fork
  878](/login?return_to=%2Fevmos%2Fevmos)
* [Star
   1.7k](/login?return_to=%2Fevmos%2Fevmos)

* [Code](/evmos/evmos/tree/v2.0.1)
* [Issues
  13](/evmos/evmos/issues)
* [Pull requests
  10](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

Additional navigation options

* [Code](/evmos/evmos/tree/v2.0.1)
* [Issues](/evmos/evmos/issues)
* [Pull requests](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

1. [Releases](/evmos/evmos/releases)
2. [v2.0.1](/evmos/evmos/releases/tag/v2.0.1)

# v2.0.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/evmos/evmos/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.0.1)

 Loading

[View all tags](/evmos/evmos/tags)

![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&v=4)
[fedekunze](/fedekunze)
released this
06 Mar 21:33

·
[1 commit](/evmos/evmos/compare/v2.0.1...release/v2.0.x)
to release/v2.0.x
since this release

[v2.0.1](/evmos/evmos/tree/v2.0.1)

[`39f0f27`](/evmos/evmos/commit/39f0f27621fcee44a4e5538e0fd37f16899e610e)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## `v2.0.1` - 2022-03-06

### Bug Fixes

* Don't use GetParams by [@ValarDragon](https://github.com/ValarDragon) in [#363](https://github.com/evmos/evmos/pull/363)

## New Contributors

* [@ValarDragon](https://github.com/ValarDragon) made their first contribution in [#363](https://github.com/evmos/evmos/pull/363)

**Full Changelog**: [v2.0.0...v2.0.1](https://github.com/evmos/evmos/compare/v2.0.0...v2.0.1)

### Contributors

* [![@ValarDragon](https://avatars.githubusercontent.com/u/6440154?s=64&v=4)](https://github.com/ValarDragon)

ValarDragon

 Assets
8

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_46be3c1b_20250115_085328.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F28870258d4ee9f1b8aeef5eba891681f89348f71)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F28870258d4ee9f1b8aeef5eba891681f89348f71)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=evmos%2Fevmos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evmos](/evmos)
/
**[evmos](/evmos/evmos)**
Public

* [Notifications](/login?return_to=%2Fevmos%2Fevmos) You must be signed in to change notification settings
* [Fork
  878](/login?return_to=%2Fevmos%2Fevmos)
* [Star
   1.7k](/login?return_to=%2Fevmos%2Fevmos)

* [Code](/evmos/evmos)
* [Issues
  13](/evmos/evmos/issues)
* [Pull requests
  10](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

Additional navigation options

* [Code](/evmos/evmos)
* [Issues](/evmos/evmos/issues)
* [Pull requests](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

## Commit

[Permalink](/evmos/evmos/commit/28870258d4ee9f1b8aeef5eba891681f89348f71)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-5jgq-x857-p8xw](https://github.com/advisories/GHSA-5jgq-x857-p8xw "GHSA-5jgq-x857-p8xw")

[Browse files](/evmos/evmos/tree/28870258d4ee9f1b8aeef5eba891681f89348f71)
Browse the repository at this point in the history

```
* fix: only enable claims from authorized channels

* changelog

* changelog 2

* fix tests

* rename to authorized

* update forks

* upgrade height

* check for EVM chains

* bonded ration adjustment

* update genesis

* fixes

* swagger
```

* Loading branch information

[![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&v=4)](/fedekunze)

[fedekunze](/evmos/evmos/commits?author=fedekunze "View all commits by fedekunze")
authored
Mar 6, 2022

1 parent
[a5a1221](/evmos/evmos/commit/a5a1221c8616a8d0abf13121ac3b7e98189e7c6c)

commit 2887025

 Show file tree

 Hide file tree

Showing
**16 changed files**
with
**233 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* client/docs

  + statik

    - client/docs/statik/statik.go
      [statik.go](#diff-fa3f9d3fbea063fbc470f21a8e6fb36510183cb29a464a46f8a4d4fff38673ca)
  + swagger-ui

    - client/docs/swagger-ui/swagger.yaml
      [swagger.yaml](#diff-2a09e9916a3c0f4d4e82d9aba834d29f66fe9ceae98ea5840cef99de7002d221)
* proto/evmos/claims/v1

  + proto/evmos/claims/v1/genesis.proto
    [genesis.proto](#diff-a45a85f72e752cd975f20fd67123d5e3e2879e5b05327d37bbddd30c4dbdc30a)
* types

  + types/errors.go
    [errors.go](#diff-5b7f76c81fbbae7194fed7ea102e093e525333906d94600dc6961f9fa8786828)
* x

  + claims

    - keeper

      * x/claims/keeper/ibc\_callbacks.go
        [ibc\_callbacks.go](#diff-1381e683e90e608b3b9571039a7f9a49f31dfb2ce7177e1ed0ab23e01576a743)
      * x/claims/keeper/ibc\_callbacks\_test.go
        [ibc\_callbacks\_test.go](#diff-d6dbd4e76aa30e3cd056246702fc138fb7079a5969489df3bc0b41f62e548502)
    - x/claims/module.go
      [module.go](#diff-a2477e6b6263e538fd5b95c7e7c6087e115a0286054267886aae2ea70eba4fd7)
    - types

      * x/claims/types/claim\_record.go
        [claim\_record.go](#diff-66be7cb6d05b29dd4cbf15b90eb0af078fa049ffdbd4d304dc39513788ef407a)
      * x/claims/types/claim\_record\_test.go
        [claim\_record\_test.go](#diff-7d7e75470d1d53e3ed2910b7d82023bdb534098fbf2246dd176df1f40aa5a93d)
  + erc20

    - x/erc20/module.go
      [module.go](#diff-3693ea00201bd4aa86825815ae3d894626114a0e462a179a6dc57bd06c6968b7)
  + inflation

    - x/inflation/genesis.go
      [genesis.go](#diff-2efc26b89e1d9c4bf4df9955ead62dd258adc5b7cd5fbc5cde6d6a40b4591e26)
    - keeper

      * x/inflation/keeper/hooks.go
        [hooks.go](#diff-3194f95192d56deb75d2b94a3435bf3ae9241f74780b6008ec1717b5b65c437b)
      * x/inflation/keeper/hooks\_test.go
        [hooks\_test.go](#diff-3f28b8c4f67c9ccfdab2e8bf031df359547326f1619b97a7b6999cedf831ab35)
      * x/inflation/keeper/inflation.go
        [inflation.go](#diff-5a6c519dfc7056b0858357df4a16255a055b6794348ebaaec890153212902e9b)
    - types

      * x/inflation/types/interfaces.go
        [interfaces.go](#diff-5523d4ab71b8e8ccb34a6d65dc451c8373ea8b573abd3d7ce216fd143d2501ef)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -37,6 +37,10 @@ Ref: https://keepachangelog.com/en/1.0.0/ |
|  |  |  |
|  |  | ## [v2.0.0] - 2022-03-06 |
|  |  |  |
|  |  | ### State Machine Breaking |
|  |  |  |
|  |  | - (claims) Restrict claiming to a list of authorized IBC channels. |
|  |  |  |
|  |  | ### Improvements |
|  |  |  |
|  |  | - (deps) [\#360](https://github.com/tharsis/evmos/pull/360) Bump Ethermint to [`v0.11.0`](https://github.com/tharsis/ethermint/releases/tag/v0.11.0) |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[client/docs/statik/statik.go](#diff-fa3f9d3fbea063fbc470f21a8e6fb36510183cb29a464a46f8a4d4fff38673ca "client/docs/statik/statik.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/client/docs/statik/statik.go)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

42 changes: 42 additions & 0 deletions

42
[client/docs/swagger-ui/swagger.yaml](#diff-2a09e9916a3c0f4d4e82d9aba834d29f66fe9ceae98ea5840cef99de7002d221 "client/docs/swagger-ui/swagger.yaml")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/client/docs/swagger-ui/swagger.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -250,6 +250,20 @@ paths: |
|  |  | claims\_denom: |
|  |  | type: string |
|  |  | title: denom of claimable coin |
|  |  | authorized\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | description: >- |
|  |  | list of authorized channel identifiers that can perform |
|  |  | address attestations |
|  |  |  |
|  |  | via IBC. |
|  |  | evm\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | title: list of channel identifiers from EVM compatible chains |
|  |  | description: >- |
|  |  | QueryParamsResponse is the response type for the Query/Params RPC |
|  |  | method. |
| Expand Down  Expand Up | | @@ -26870,6 +26884,20 @@ definitions: |
|  |  | claims\_denom: |
|  |  | type: string |
|  |  | title: denom of claimable coin |
|  |  | authorized\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | description: >- |
|  |  | list of authorized channel identifiers that can perform address |
|  |  | attestations |
|  |  |  |
|  |  | via IBC. |
|  |  | evm\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | title: list of channel identifiers from EVM compatible chains |
|  |  | description: Params defines the claims module's parameters. |
|  |  | evmos.claims.v1.QueryClaimsRecordResponse: |
|  |  | type: object |
| Expand Down  Expand Up | | @@ -26983,6 +27011,20 @@ definitions: |
|  |  | claims\_denom: |
|  |  | type: string |
|  |  | title: denom of claimable coin |
|  |  | authorized\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | description: >- |
|  |  | list of authorized channel identifiers that can perform address |
|  |  | attestations |
|  |  |  |
|  |  | via IBC. |
|  |  | evm\_channels: |
|  |  | type: array |
|  |  | items: |
|  |  | type: string |
|  |  | title: list of channel identifiers from EVM compatible chains |
|  |  | description: QueryParamsResponse is the response type for the Query/Params RPC method. |
|  |  | evmos.claims.v1.QueryTotalUnclaimedResponse: |
|  |  | type: object |
| Expand Down | |  |

1 change: 0 additions & 1 deletion

1
[proto/evmos/claims/v1/genesis.proto](#diff-a45a85f72e752cd975f20fd67123d5e3e2879e5b05327d37bbddd30c4dbdc30a "proto/evmos/claims/v1/genesis.proto")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/proto/evmos/claims/v1/genesis.proto)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,6 @@ option go\_package = "github.com/tharsis/evmos/v2/x/claims/types"; |
|  |  | message GenesisState { |
|  |  | // params defines all the parameters of the module. |
|  |  | Params params = 1 [ (gogoproto.nullable) = false ]; |
|  |  |  |
|  |  | // list of claim records with the corresponding airdrop recipient |
|  |  | repeated ClaimsRecordAddress claims\_records = 2 |
|  |  | [ (gogoproto.nullable) = false ]; |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[types/errors.go](#diff-5b7f76c81fbbae7194fed7ea102e093e525333906d94600dc6961f9fa8786828 "types/errors.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/types/errors.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,18 @@ |
|  |  | package types |
|  |  |  |
|  |  | import ( |
|  |  | sdkerrors "github.com/cosmos/cosmos-sdk/types/errors" |
|  |  | ) |
|  |  |  |
|  |  | // RootCodespace is the codespace for all errors defined in this package |
|  |  | const RootCodespace = "evmos" |
|  |  |  |
|  |  | // root error codes for Evmos |
|  |  | const ( |
|  |  | codeKeyTypeNotSupported = iota + 2 |
|  |  | ) |
|  |  |  |
|  |  | // errors |
|  |  | var ( |
|  |  | ErrKeyTypeNotSupported = sdkerrors.Register(RootCodespace, codeKeyTypeNotSupported, "key type 'secp256k1' not supported") |
|  |  | ) |

35 changes: 34 additions & 1 deletion

35
[x/claims/keeper/ibc\_callbacks.go](#diff-1381e683e90e608b3b9571039a7f9a49f31dfb2ce7177e1ed0ab23e01576a743 "x/claims/keeper/ibc_callbacks.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/claims/keeper/ibc_callbacks.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ import ( |
|  |  | channeltypes "github.com/cosmos/ibc-go/v3/modules/core/04-channel/types" |
|  |  | "github.com/cosmos/ibc-go/v3/modules/core/exported" |
|  |  |  |
|  |  | evmos "github.com/tharsis/evmos/v2/types" |
|  |  | "github.com/tharsis/evmos/v2/x/claims/types" |
|  |  | ) |
|  |  |  |
| Expand All | | @@ -21,7 +22,7 @@ func (k Keeper) OnRecvPacket( |
|  |  | ) exported.Acknowledgement { |
|  |  | params := k.GetParams(ctx) |
|  |  |  |
|  |  | // short circuit in case claim is not active (no-op) |
|  |  | // short (no-op) circuit by returning original ACK in case the claim is not active |
|  |  | if !params.IsClaimsActive(ctx.BlockTime()) { |
|  |  | return ack |
|  |  | } |
| Expand Down  Expand Up | | @@ -60,6 +61,38 @@ func (k Keeper) OnRecvPacket( |
|  |  | } |
|  |  |  |
|  |  | senderClaimsRecord, senderRecordFound := k.GetClaimsRecord(ctx, sender) |
|  |  |  |
|  |  | // NOTE: we know that the connected chains from the authorized IBC channels |
|  |  | // don't support ethereum keys (i.e `ethsecp256k1`). Thus, so we return an error, |
|  |  | // unless the destination channel from a connection to a chain that is EVM-compatible |
|  |  | // or supports ethereum keys (eg: Cronos, Injective). |
|  |  | if sender.Equals(recipient) && !params.IsEVMChannel(packet.DestinationChannel) { |
|  |  | switch { |
|  |  | // case 1: secp256k1 key from sender/recipient has no claimed actions -> error ACK to prevent funds from getting stuck |
|  |  | case senderRecordFound && !senderClaimsRecord.HasClaimedAny(): |
|  |  | return channeltypes.NewErrorAcknowledgement( |
|  |  | sdkerrors.Wrapf( |
|  |  | evmos.ErrKeyTypeNotSupported, "receiver address %s is not a valid ethereum address", data.Receiver, |
|  |  | ).Error(), |
|  |  | ) |
|  |  | default: |
|  |  | // case 2: sender/recipient has funds stuck -> error acknowledgement to prevent more transferred tokens from |
|  |  | // getting stuck while we implement IBC withdrawals |
|  |  | return channeltypes.NewErrorAcknowledgement( |
|  |  | sdkerrors.Wrapf( |
|  |  | evmos.ErrKeyTypeNotSupported, |
|  |  | "reverted transfer to unsupported address %s to prevent more funds from getting stuck", |
|  |  | data.Receiver, |
|  |  | ).Error(), |
|  |  | ) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // return original ACK in case the destination channel is not authorized |
|  |  | if !params.IsAuthorizedChannel(packet.DestinationChannel) { |
|  |  | return ack |
|  |  | } |
|  |  |  |
|  |  | recipientClaimsRecord, recipientRecordFound := k.GetClaimsRecord(ctx, recipient) |
|  |  |  |
|  |  | // handle the 4 cases for the recipient and sender claim records |
| Expand Down | |  |

67 changes: 59 additions & 8 deletions

67
[x/claims/keeper/ibc\_callbacks\_test.go](#diff-d6dbd4e76aa30e3cd056246702fc138fb7079a5969489df3bc0b41f62e548502 "x/claims/keeper/ibc_callbacks_test.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/claims/keeper/ibc_callbacks_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,14 +6,15 @@ import ( |
|  |  |  |
|  |  | "github.com/stretchr/testify/suite" |
|  |  |  |
|  |  | "github.com/cosmos/cosmos-sdk/crypto/keys/secp256k1" |
|  |  | sdk "github.com/cosmos/cosmos-sdk/types" |
|  |  | sdkerrors "github.com/cosmos/cosmos-sdk/types/errors" |
|  |  | transfertypes "github.com/cosmos/ibc-go/v3/modules/apps/transfer/types" |
|  |  | clienttypes "github.com/cosmos/ibc-go/v3/modules/core/02-client/types" |
|  |  | channeltypes "github.com/cosmos/ibc-go/v3/modules/core/04-channel/types" |
|  |  | ibcgotesting "github.com/cosmos/ibc-go/v3/testing" |
|  |  |  |
|  |  | ibcmock "github.com/cosmos/ibc-go/v3/testing/mock" |
|  |  |  |
|  |  | "github.com/tharsis/evmos/v2/app" |
|  |  | "github.com/tharsis/evmos/v2/ibctesting" |
|  |  | "github.com/tharsis/evmos/v2/x/claims/types" |
| Expand Down  Expand Up | | @@ -295,12 +296,16 @@ func (suite \*IBCTestingSuite) TestOnAckClaim() { |
|  |  | } |
|  |  |  |
|  |  | func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | pk := secp256k1.GenPrivKey() |
|  |  | secpAddr := sdk.AccAddress(pk.PubKey().Address()) |
|  |  | secpAddrEvmos := secpAddr.String() |
|  |  | secpAddrCosmos := sdk.MustBech32ifyAddressBytes(sdk.Bech32MainPrefix, secpAddr) |
|  |  | sender := "evmos1sv9m0g7ycejwr3s369km58h5qe7xj77hvcxrms" |
|  |  | receiver := "evmos1hf0468jjpe6m6vx38s97z2qqe8ldu0njdyf625" |
|  |  |  |
|  |  | disabledTimeoutTimestamp := uint64(0) |
|  |  | timeoutHeight = clienttypes.NewHeight(0, 100) |
|  |  | mockpacket := channeltypes.NewPacket(ibcgotesting.MockPacketData, 1, "port", "channel", "port2", "channel2", timeoutHeight, disabledTimeoutTimestamp) |
|  |  | mockpacket := channeltypes.NewPacket(ibcgotesting.MockPacketData, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, disabledTimeoutTimestamp) |
|  |  | ack := ibcmock.MockAcknowledgement |
|  |  |  |
|  |  | testCases := []struct { |
| Expand All | | @@ -318,6 +323,17 @@ func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | suite.Require().Equal(ack, resAck) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "params, channel not authorized", |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", sender, receiver) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-100", timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().Equal(ack, resAck) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "non ics20 packet", |
|  |  | func() { |
| Expand All | | @@ -332,18 +348,18 @@ func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", "evmos", receiver) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, "port", "channel", "port2", "channel2", timeoutHeight, 0) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().False(resAck.Success()) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "invalid sender", |
|  |  | "invalid sender 2", |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", "badba1sv9m0g7ycejwr3s369km58h5qe7xj77hvcxrms", receiver) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, "port", "channel", "port2", "channel2", timeoutHeight, 0) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().False(resAck.Success()) |
| Expand All | | @@ -354,7 +370,31 @@ func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", receiver, "badbadhf0468jjpe6m6vx38s97z2qqe8ldu0njdyf625") |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, "port", "channel", "port2", "channel2", timeoutHeight, 0) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().False(resAck.Success()) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "fail - sender and receiver address is the same (no claim record)", |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", secpAddrCosmos, secpAddrEvmos) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().False(resAck.Success()) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "fail - sender and receiver address is the same (with claim record)", |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", secpAddrCosmos, secpAddrEvmos) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, 0) |
|  |  |  |
|  |  | suite.app.ClaimsKeeper.SetClaimsRecord(suite.ctx, secpAddr, types.NewClaimsRecord(sdk.NewInt(100))) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().False(resAck.Success()) |
| Expand All | | @@ -365,7 +405,18 @@ func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", sender, receiver) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, "port", "channel", "port2", "channel2", timeoutHeight, 0) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, types.DefaultAuthorizedChannels[0], timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().True(resAck.Success()) |
|  |  | }, |
|  |  | }, |
|  |  | { |
|  |  | "correct, same sender with EVM channel", |
|  |  | func() { |
|  |  | transfer := transfertypes.NewFungibleTokenPacketData("aevmos", "100", secpAddrCosmos, secpAddrEvmos) |
|  |  | bz := transfertypes.ModuleCdc.MustMarshalJSON(&transfer) |
|  |  | packet := channeltypes.NewPacket(bz, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, types.DefaultEVMChannels[0], timeoutHeight, 0) |
|  |  |  |
|  |  | resAck := suite.app.ClaimsKeeper.OnRecvPacket(suite.ctx, packet, ack) |
|  |  | suite.Require().True(resAck.Success()) |
| Expand All | | @@ -384,7 +435,7 @@ func (suite \*KeeperTestSuite) TestReceive() { |
|  |  | func (suite \*KeeperTestSuite) TestAck() { |
|  |  | disabledTimeoutTimestamp := uint64(0) |
|  |  | timeoutHeight = clienttypes.NewHeight(0, 100) |
|  |  | mockpacket := channeltypes.NewPacket(ibcgotesting.MockPacketData, 1, "port", "channel", "port2", "channel2", timeoutHeight, disabledTimeoutTimestamp) |
|  |  | mockpacket := channeltypes.NewPacket(ibcgotesting.MockPacketData, 1, transfertypes.PortID, "channel-0", transfertypes.PortID, "channel-0", timeoutHeight, disabledTimeoutTimestamp) |
|  |  | ack := ibcmock.MockAcknowledgement |
|  |  |  |
|  |  | testCases := []struct { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[x/claims/module.go](#diff-a2477e6b6263e538fd5b95c7e7c6087e115a0286054267886aae2ea70eba4fd7 "x/claims/module.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/claims/module.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -167,4 +167,4 @@ func (am AppModule) EndBlock(ctx sdk.Context, \_ abci.RequestEndBlock) []abci.Val |
|  |  | } |
|  |  |  |
|  |  | // ConsensusVersion implements AppModule/ConsensusVersion. |
|  |  | func (AppModule) ConsensusVersion() uint64 { return 1 } |
|  |  | func (AppModule) ConsensusVersion() uint64 { return 2 } |

11 changes: 11 additions & 0 deletions

11
[x/claims/types/claim\_record.go](#diff-66be7cb6d05b29dd4cbf15b90eb0af078fa049ffdbd4d304dc39513788ef407a "x/claims/types/claim_record.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/claims/types/claim_record.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,6 +57,17 @@ func (cr ClaimsRecord) HasClaimedAction(action Action) bool { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // HasClaimedAny returns true if the user has claimed at least one reward from the |
|  |  | // available actions |
|  |  | func (cr ClaimsRecord) HasClaimedAny() bool { |
|  |  | for \_, completed := range cr.ActionsCompleted { |
|  |  | if completed { |
|  |  | return true |
|  |  | } |
|  |  | } |
|  |  | return false |
|  |  | } |
|  |  |  |
|  |  | // HasClaimedAll returns true if the user has claimed all the rewards from the |
|  |  | // available actions |
|  |  | func (cr ClaimsRecord) HasClaimedAll() bool { |
| Expand Down | |  |

39 changes: 39 additions & 0 deletions

39
[x/claims/types/claim\_record\_test.go](#diff-7d7e75470d1d53e3ed2910b7d82023bdb534098fbf2246dd176df1f40aa5a93d "x/claims/types/claim_record_test.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/claims/types/claim_record_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -137,6 +137,45 @@ func TestClaimsRecordHasClaimedAll(t \*testing.T) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestClaimsRecordHasAny(t \*testing.T) { |
|  |  | testCases := []struct { |
|  |  | name string |
|  |  | claimsRecord ClaimsRecord |
|  |  | expBool bool |
|  |  | }{ |
|  |  | { |
|  |  | "false - empty", |
|  |  | ClaimsRecord{}, |
|  |  | false, |
|  |  | }, |
|  |  | { |
|  |  | "false - not claimed", |
|  |  | ClaimsRecord{ |
|  |  | ActionsCompleted: []bool{false, false, false, false}, |
|  |  | }, |
|  |  | false, |
|  |  | }, |
|  |  | { |
|  |  | "true - single action claimed", |
|  |  | ClaimsRecord{ |
|  |  | ActionsCompleted: []bool{true, false, false, false}, |
|  |  | }, |
|  |  | true, |
|  |  | }, |
|  |  | { |
|  |  | "true - all claimed", |
|  |  | ClaimsRecord{ |
|  |  | ActionsCompleted: []bool{true, true, true, true}, |
|  |  | }, |
|  |  | true, |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | for \_, tc := range testCases { |
|  |  | require.True(t, tc.expBool == tc.claimsRecord.HasClaimedAny(), tc.name) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestClaimsRecordAddressValidate(t \*testing.T) { |
|  |  | addr := sdk.AccAddress(tests.GenerateAddress().Bytes()) |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[x/erc20/module.go](#diff-3693ea00201bd4aa86825815ae3d894626114a0e462a179a6dc57bd06c6968b7 "x/erc20/module.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/erc20/module.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,7 +42,7 @@ func (AppModuleBasic) RegisterLegacyAminoCodec(cdc \*codec.LegacyAmino) {} |
|  |  |  |
|  |  | // ConsensusVersion returns the consensus state-breaking version for the module. |
|  |  | func (AppModuleBasic) ConsensusVersion() uint64 { |
|  |  | return 1 |
|  |  | return 2 |
|  |  | } |
|  |  |  |
|  |  | // RegisterInterfaces registers interfaces and implementations of the erc20 module. |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[x/inflation/genesis.go](#diff-2efc26b89e1d9c4bf4df9955ead62dd258adc5b7cd5fbc5cde6d6a40b4591e26 "x/inflation/genesis.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/inflation/genesis.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,7 +11,7 @@ func InitGenesis( |
|  |  | ctx sdk.Context, |
|  |  | k keeper.Keeper, |
|  |  | ak types.AccountKeeper, |
|  |  | sk types.StakingKeeper, |
|  |  | \_ types.StakingKeeper, |
|  |  | data types.GenesisState, |
|  |  | ) { |
|  |  | // Ensure inflation module account is set on genesis |
| Expand All | | @@ -33,7 +33,7 @@ func InitGenesis( |
|  |  | k.SetEpochsPerPeriod(ctx, epochsPerPeriod) |
|  |  |  |
|  |  | // Get bondedRatio |
|  |  | bondedRatio := sk.BondedRatio(ctx) |
|  |  | bondedRatio := k.BondedRatio(ctx) |
|  |  |  |
|  |  | // Calculate epoch mint provision |
|  |  | epochMintProvision := types.CalculateEpochMintProvision( |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[x/inflation/keeper/hooks.go](#diff-3194f95192d56deb75d2b94a3435bf3ae9241f74780b6008ec1717b5b65c437b "x/inflation/keeper/hooks.go")

Show comments

[View file](/evmos/evmos/blob/28870258d4ee9f1b8aeef5eba891681f89348f71/x/inflation/keeper/hooks.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ func (k Keeper) AfterEpochEnd(ctx sdk.Context, epochIdentifier string, epochNumb |
|  |  | period++ |
|  |  | k.SetPeriod(ctx, period) |
|  |  | period = k.GetPeriod(ctx) |
|  |  | bondedRatio := k.stakingKeeper.BondedRatio(ctx) |
|  |  | bondedRatio := k.BondedRatio(ctx) |
|  |  | newProvision = types.CalculateEpochMintProvision( |
|  |  | params, |
|  |  | period, |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2887025`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fcommit%2F28870258d4ee9f1b8aeef5eba891681f89348f71) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2e8dece4_20250115_085331.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fsecurity%2Fadvisories%2FGHSA-5jgq-x857-p8xw)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fevmos%2Fevmos%2Fsecurity%2Fadvisories%2FGHSA-5jgq-x857-p8xw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=evmos%2Fevmos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[evmos](/evmos)
/
**[evmos](/evmos/evmos)**
Public

* [Notifications](/login?return_to=%2Fevmos%2Fevmos) You must be signed in to change notification settings
* [Fork
  878](/login?return_to=%2Fevmos%2Fevmos)
* [Star
   1.7k](/login?return_to=%2Fevmos%2Fevmos)

* [Code](/evmos/evmos)
* [Issues
  13](/evmos/evmos/issues)
* [Pull requests
  10](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

Additional navigation options

* [Code](/evmos/evmos)
* [Issues](/evmos/evmos/issues)
* [Pull requests](/evmos/evmos/pulls)
* [Discussions](/evmos/evmos/discussions)
* [Actions](/evmos/evmos/actions)
* [Security](/evmos/evmos/security)
* [Insights](/evmos/evmos/pulse)

# Malicious Migration of Claimable Amount through IBC

Critical

[fedekunze](/fedekunze)
published
GHSA-5jgq-x857-p8xw
Mar 7, 2022

## Package

gomod

github.com/tharsis/evmos
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

≤ 1.1.2

## Patched versions

≥ 2.0.0

## Description

## Impact

*What kind of vulnerability is it? Who is impacted?*

### Classification

The vulnerability has been classified as `critical` with a score of `9.0` (highest). It has the potential to affect and drain unclaimed airdrop funds from Cosmos and Osmosis eligible user addresses.

### Disclosure

The attack requires advanced knowledge of the internals of the core and application packages of IBC, IBC relayers, the Cosmos SDK `AnteHandler`, and the Evmos `x/claims` module. The step-by-step attack is described below:

1. An actor creates a malicious chain with a custom `AnteHandler` that skips signature verification for transactions, specifically IBC `MsgTransfer`. This allows the attacker to impersonate any account by setting a custom `sender` address field of the IBC transfer message.
2. The malicious actor then connects this newly created chain via IBC to Evmos and fills the `recipient` address from the transfer message with an address they control.
3. Once the IBC packet containing the Transfer data is relayed to Evmos, it is processed by the claims module IBC middleware. Which migrates the claim records to the recipient address, which is owned by the attacker.
4. The attacker then performs two airdrop Actions, claiming up to 75% of the total initial claimable amount.
5. The Actor repeats steps 1., 2., and 3. for every address that has unclaimed funds from the airdrop. This automatically claims 75% of the unclaimable amount.
6. The malicious actor performs the final Action, claiming 100% of all the user funds.
7. Then, the attacker transfers the funds to another chain with a DEX (Osmosis, Cosmos Hub) via IBC.
8. Finally, the attacker withdraws the total amount in fiat through a centralized exchange.

### Users impacted

No users have suffered the loss of funds as no malicious chains have been connected to Evmos.

## Patches

*Has the problem been patched? What versions should users upgrade to?*

The patch involves defining a list of authorized channels for chains that are connected to Evmos via IBC. This restricts the chains that have the capability of migrating users' claims records as per the specification. By default, the authorized destination channels are `"channel-0"` (Osmosis) and `"channel-3"` (Cosmos Hub).

Please upgrade your mainnet node and validator to [`v2.0.1`](https://github.com/tharsis/evmos/releases/tag/v2.0.1) **ASAP**.

## Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

No, the fix for the critical vulnerability is state machine breaking. An upgrade procedure must be coordinated with the nodes running the network.

## References

*Are there any links users can visit to find out more?*

* Claims module spec: [evmos.dev/modules/claims](https://evmos.dev/modules/claims)
* Cosmos SDK documentation: [docs.cosmos.network](https://docs.cosmos.network/)
* IBC documentation: [ibc.cosmos.network](https://ibc.cosmos.network/)

## For more information

If you have any questions or comments about this advisory:

* Reach out to the Core Team in [Discord](https://discord.gg/evmos)
* Open an issue in [tharsis/evmos](https://github.com/tharsis/evmos/issues)
* Email us at [security@thars.is](security%40thars.is)

Thanks to the Core IBC team at Interchain GmbH for the secure disclosure of this vulnerability

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

### CVE ID

CVE-2022-24738

### Weaknesses

[CWE-288](/advisories?query=cwe%3A288) [CWE-322](/advisories?query=cwe%3A322)

### Credits

* [![@colin-axner](https://avatars.githubusercontent.com/u/25233464?s=40&v=4)](/colin-axner)
  [colin-axner](/colin-axner)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


