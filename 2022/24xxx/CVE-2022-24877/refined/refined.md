- **Root cause of vulnerability**: Improper path handling in Kustomization files. The `kustomize-controller` allows a specially crafted `kustomization.yaml` file to access sensitive data from the controller's pod filesystem.
- **Weaknesses/vulnerabilities present**: Path traversal vulnerability due to improper handling of file paths in `kustomization.yaml` files.
- **Impact of exploitation**:
    - Exposure of sensitive data from the controller's pod filesystem.
    - Potential privilege escalation in multi-tenancy deployments if the controller's service account has elevated permissions.
- **Attack vectors**: Maliciously crafted `kustomization.yaml` file.
- **Required attacker capabilities/position**: Users with write access to a Flux source can exploit this vulnerability. The attacker needs to be able to modify the `kustomization.yaml` file.

The vulnerability is present in `kustomize-controller` versions prior to v0.24.0 and `flux2` versions prior to v0.29.0. The fix involves introducing a new Kustomize file system implementation which ensures that all files being handled are contained within the Kustomization working directory, blocking references to any files that do not meet that requirement. The CVSS score is 10.0, indicating a critical severity.