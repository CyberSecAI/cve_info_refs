- **Root cause of vulnerability:** The `page` parameter in `edit_page.php` is not sanitized before being used in an SQL query. The code directly incorporates the unsanitized `$_GET['page']` value into the SQL query, which makes it vulnerable to SQL injection attacks. Specifically, the line `$id = mysql_prep($_GET['page']);` uses `mysql_prep` which does not provide sufficient sanitization.
- **Weaknesses/vulnerabilities present:** SQL injection vulnerability.
- **Impact of exploitation:** An attacker can manipulate the SQL query to potentially gain unauthorized access to the database, modify data, or even gain control of the server, depending on the database and server configuration.
- **Attack vectors:** The attack vector is via a crafted URL by manipulating the `page` GET parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the vulnerable `edit_page.php` script, and have knowledge of SQL syntax to craft a malicious payload within the `page` parameter. They do not need to be authenticated, or have a user account.