Based on the provided content, here's a breakdown of the vulnerability:

**Vulnerability:** Prototype Pollution

**Root Cause:** The `defaultMergeRecords()` function in `deepmerge.ts` does not properly handle the `__proto__` property, allowing an attacker to inject properties into the prototype of an object.

**Weaknesses:**
- The vulnerability exists because the code directly assigns the merged value to `result[key]` without any checks.
- It fails to prevent the modification of the `__proto__` property during the merging process.

**Impact:**
- An attacker can pollute the prototype of objects, potentially leading to denial-of-service by modifying built-in object properties.
- This could lead to unexpected behavior of the application.
- By adding malicious properties to the prototype, an attacker may also be able to achieve Remote Code Execution.

**Attack Vectors:**
- The attacker can inject a crafted JSON payload with `__proto__` as the key during the deep merge operation.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to control the input given to the `deepmerge` function.

**Additional Details:**
- The vulnerable code is in the `defaultMergeRecords` function within `src/deepmerge.ts`.
- The fix implemented in commit `d637db7e4fb2bfb113cb4bc1c85a125936d7081b` and merged in `b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72`, protects against prototype pollution by using Object.defineProperty() when the key is `__proto__`.
- The fix also includes a test case in `tests/deepmerge.test.ts` to verify the fix and prevent regression.
- The affected versions are before 4.0.2.
- The vulnerability is identified as CWE-1321.