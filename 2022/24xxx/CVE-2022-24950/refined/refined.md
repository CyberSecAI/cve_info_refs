Based on the provided information, here's a breakdown of the vulnerability described in CVE-2022-24950:

**Root Cause:**

*   A race condition exists in the `UserTerminalRouter::getInfoForId()` function of EternalTerminal. This function retrieves user info for a client connection from a mutable `unordered_map` called `idInfoMap`.
*   The retrieved user info is then used in `TerminalServer::run()` and passed to `pipeSocketHandler::listen()` to set the permissions on the forwarded SSH socket.

**Weaknesses/Vulnerabilities:**

*   **Race Condition:** A local attacker can monitor the logs for new client registrations, and when a new client connects, they can rapidly modify the `idInfoMap` before the server sets up the SSH socket.
*   **Mutable Data Structure:** The use of a mutable `unordered_map` (`idInfoMap`) to store client information allows for manipulation by an attacker.
*   **Lack of Synchronization:** The process of retrieving user info and setting up the SSH socket permissions is not properly synchronized, allowing for the race condition to occur.

**Impact of Exploitation:**

*   **SSH Socket Hijacking:** The attacker can cause the ownership of the forwarded SSH agent socket to be transferred to their user.
*   **Unauthorized Access:** The attacker can use the hijacked SSH socket to log into other machines that the targeted user has access to.
*   **Session Hijacking:** The victim can potentially be given a session as the attacker upon login due to the attacker's modified entry in the `idInfoMap`.

**Attack Vectors:**

*   **Local Access:** The attacker needs local access to the server where EternalTerminal is running.
*   **Log Monitoring:** The attacker must be able to monitor the EternalTerminal server logs.
*   **IPC Socket:** The attacker leverages the world-accessible local IPC socket (`/var/run/etserver.idpasskey.fifo`) to trigger the vulnerability.

**Required Attacker Capabilities/Position:**

*   The attacker must have an account on the target system.
*   The attacker needs the ability to execute commands and monitor log files.
*   The attacker needs to be able to interact with the Eternal Terminal server's IPC socket.

**Additional Details:**
*   The provided proof-of-concept (PoC) script shows how the attack works. It monitors the logs for client IDs, and when a new one appears, it manipulates the `idInfoMap` to take over the SSH socket.
*   The vulnerability was patched in Eternal Terminal version 6.1.9.