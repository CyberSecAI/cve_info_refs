=== Content from security.gentoo.org_58090d82_20250114_181038.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# HashiCorp Vault: Multiple Vulnerabilities — GLSA **202207-01**

Multiple vulnerabilities have been discovered in HashiCorp Vault, the worst of which could result in denial of service.

### Affected packages

| Package | **app-admin/vault** on all architectures |
| --- | --- |
| Affected versions | < **1.10.3** |
| Unaffected versions | >= **1.10.3** |

### Background

HashiCorp Vault is a tool for managing secrets.

### Description

Multiple vulnerabilities have been discovered in HashiCorp Vault. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All HashiCorp Vault users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/vault-1.10.3"

```
### References

* [CVE-2020-25594](https://nvd.nist.gov/vuln/detail/CVE-2020-25594)
* [CVE-2021-27668](https://nvd.nist.gov/vuln/detail/CVE-2021-27668)
* [CVE-2021-3024](https://nvd.nist.gov/vuln/detail/CVE-2021-3024)
* [CVE-2021-3282](https://nvd.nist.gov/vuln/detail/CVE-2021-3282)
* [CVE-2021-32923](https://nvd.nist.gov/vuln/detail/CVE-2021-32923)
* [CVE-2021-37219](https://nvd.nist.gov/vuln/detail/CVE-2021-37219)
* [CVE-2021-38553](https://nvd.nist.gov/vuln/detail/CVE-2021-38553)
* [CVE-2021-38554](https://nvd.nist.gov/vuln/detail/CVE-2021-38554)
* [CVE-2021-41802](https://nvd.nist.gov/vuln/detail/CVE-2021-41802)
* [CVE-2021-43998](https://nvd.nist.gov/vuln/detail/CVE-2021-43998)
* [CVE-2021-45042](https://nvd.nist.gov/vuln/detail/CVE-2021-45042)
* [CVE-2022-25243](https://nvd.nist.gov/vuln/detail/CVE-2022-25243)
* [CVE-2022-30689](https://nvd.nist.gov/vuln/detail/CVE-2022-30689)

**Release date**

July 29, 2022

**Latest revision**

July 29, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [768312](https://bugs.gentoo.org/show_bug.cgi?id=768312)
* [797244](https://bugs.gentoo.org/show_bug.cgi?id=797244)
* [808093](https://bugs.gentoo.org/show_bug.cgi?id=808093)
* [817269](https://bugs.gentoo.org/show_bug.cgi?id=817269)
* [827945](https://bugs.gentoo.org/show_bug.cgi?id=827945)
* [829493](https://bugs.gentoo.org/show_bug.cgi?id=829493)
* [835070](https://bugs.gentoo.org/show_bug.cgi?id=835070)
* [845405](https://bugs.gentoo.org/show_bug.cgi?id=845405)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from discuss.hashicorp.com_c003cd4e_20250114_181038.html ===


[HashiCorp Discuss](/)

# [HCSEC-2022-09 - Vault PKI Secrets Engine Policy Results In Incorrect Wildcard Certificate Issuance](/t/hcsec-2022-09-vault-pki-secrets-engine-policy-results-in-incorrect-wildcard-certificate-issuance/36600)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

March 4, 2022, 11:08pm

1

**Bulletin ID:** HCSEC-2022-09

**Affected Products / Versions:** Vault and Vault Enterprise 1.8.0 through 1.8.8, and 1.9.3; fixed in 1.8.9 and 1.9.4.

**Publication Date:** March 4, 2022

**Summary**

Vault and Vault Enterprise (“Vault”) allowed the PKI secrets engine under certain configurations to issue wildcard certificates to authorized users for a specified domain, even if the PKI role policy attribute `allow_subdomains` is set to false. This vulnerability, CVE-2022-25243, was fixed in Vault Enterprise 1.8.9 and 1.9.4.

**Background**

Vault’s [PKI secrets engine](https://www.vaultproject.io/docs/secrets/pki) provides several PKI role policy attributes that allow an operator to granularly define policies:

* [`allow_bare_domains`](https://www.vaultproject.io/api/secret/pki#allow_bare_domains) specifies if the policy can issue a certificate for the exact domain in `allowed_domains` (e.g., `example[.]com`).
* [`allow_glob_domains`](https://www.vaultproject.io/api/secret/pki#allow_glob_domains) permits the use of a glob `*` characters in patterns specified in `allowed_domains`. When disabled, `*` in a `allowed_domain` entry will be treated as a wildcard character.
* [`allow_subdomains`](https://www.vaultproject.io/api-docs/secret/pki#allow_subdomains) restricts the issuance of wildcard certificates and certificates for subdomains of those listed in `allowed_domains`.
* [`allowed_domains`](https://www.vaultproject.io/api/secret/pki#allowed_domains) in combination with the above attributes define an allowlist of domains which this role can issue against.

**Details**

It was reported that Vault’s PKI secrets engine was unexpectedly permitting the issuance of wildcard certificates when `allow_subdomains` was set to false. The scenario in question required `allow_bare_domains` be set to `true` as well as at least one domain without globs (e.g., `example[.]com` or `subdomain[.]example[.]com`) be in the `allowed_domains` field of a PKI issuance role.

One mitigating factor is that the `allow_bare_domains` attribute is false by default and must be explicitly enabled by an operator.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.8.9 and 1.9.4, or newer. Please refer to [Upgrading Vault](https://www.vaultproject.io/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was independently identified by both the Vault engineering team and an external party who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-11 - Vault’s PKI Issuer Endpoint Did Not Correctly Authorize Access to Issuer Metadata](https://discuss.hashicorp.com/t/hcsec-2023-11-vault-s-pki-issuer-endpoint-did-not-correctly-authorize-access-to-issuer-metadata/52079)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6250 | March 30, 2023 |
| [PKI - Issue with role and glob patterns](https://discuss.hashicorp.com/t/pki-issue-with-role-and-glob-patterns/43881)  [Vault](/c/vault/30) | 1 | 863 | September 27, 2023 |
| [HCSEC-2021-28 - Vault's Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards](https://discuss.hashicorp.com/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7265 | October 7, 2021 |
| [HCSEC-2021-09 - Vault’s PKI Engine CRL May Exclude Revoked But Unexpired Certificates After Tidy](https://discuss.hashicorp.com/t/hcsec-2021-09-vault-s-pki-engine-crl-may-exclude-revoked-but-unexpired-certificates-after-tidy/23461)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 8479 | April 21, 2021 |
| [HCSEC-2021-10 - Vault’s Cassandra Integrations Did Not Validate TLS Certificates](https://discuss.hashicorp.com/t/hcsec-2021-10-vault-s-cassandra-integrations-did-not-validate-tls-certificates/23463)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7481 | April 21, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from discuss.hashicorp.com_33a013d6_20250114_181038.html ===


[HashiCorp Discuss](/)

| Category | Topics |
| --- | --- |
| [Announcements](/c/announcements/48)This category is for announcements that impact the community across more than one tool. | 2 |
| [Boundary](/c/boundary/50)Boundary use cases, questions, and best practices discussions. Please note this tool is currently a 0.x release, so it will have many updates in the coming months. | 669 |
| [Consul](/c/consul/29)Consul use cases, questions, and best practices discussions. | 2281 |
| [HashiCorp Cloud Platform (HCP)](/c/hcp/54)HashiCorp Cloud Platform (HCP) use cases, questions, and best practices discussions. Please note that offerings may be in various release lifecycles. | 72 |
| [Nomad](/c/nomad/28)Nomad use cases, questions, and best practices discussions. | 2147 |
| [Packer](/c/packer/23)Packer use cases, questions, and best practices discussions. | 1307 |
| [Sentinel](/c/sentinel/25)Sentinel use cases, questions, and best practices discussions. | 167 |
| [Terraform](/c/terraform-core/27)Terraform, HCP Terraform (Terraform Cloud), Terraform Enterprise, and CDK for Terraform use cases, questions, and best practices discussions. | 6937 |
| [Terraform Providers](/c/terraform-providers/31)Terraform providers (such as AWS, Azure, Google, or Kubernetes) and plugin development use cases, questions, and best practices discussions. | 964 |
| [Vagrant](/c/vagrant/24)Vagrant use cases, questions, and best practices discussions. | 632 |
| [Vault](/c/vault/30)Vault use cases, questions, and best practices discussions. | 4487 |
| [Waypoint](/c/waypoint/51)Waypoint use cases, questions, and best practices discussions. Please note this tool is currently a 0.x release, so it will have many updates in the coming months. | 328 |
| [Security](/c/security/52)Security updates for all HashiCorp products and services. Posting to this category is restricted to HashiCorp employees only. | 150 |
| [Release Notifications](/c/release-notifications/57)The Release Notifications category is a one-stop place to see all new product and version release announcements. This topic is read-only. Please subscribe to see notifications. | 407 |
| [HashiCorp User Groups, Events, and Meetups](/c/hugs-events-meetups/35)HashiCorp User Groups (HUGs) or event speaker slides, questions, best practices, and discussions. | 87 |
| [Community Jobs](/c/community-jobs/37)**A place for companies within the community who are looking for candidates that run our tools can post their job openings and encourage community members to apply.** | 27 |
| [What's Your Story?](/c/stories/36)**What has your journey been like with us? What tools did you start with? Who helped you along the way? What were your challenges in getting started? Share your story with the community so that others can learn from your experiences.** | 14 |
| [Working Remotely](/c/working-remotely/45)This forum is intended to be a space for anyone, anywhere in the world to discuss working remotely. It’s a place to submit questions, suggestions, challenges, and even a bit of the fun and funny stuff that happens along the way. HashiCorp has been a distributed company since its inception, so we wanted to create a forum where anyone can contribute to the conversation. | 6 |
| [HashiCraft Holidays Hackstravaganza](/c/hashicraft-holidays-hackstravaganza/53)It is about that time again where the weather turns cold and it is time to drink hot cocoa in front of the fireplace (or recording of a fireplace on the TV). What better way to spend some of these evenings than working on a fun side-project, or organizing an internal competition at work? | 8 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


