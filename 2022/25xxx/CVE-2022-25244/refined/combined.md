=== Content from discuss.hashicorp.com_33a013d6_20250114_181416.html ===


[HashiCorp Discuss](/)

| Category | Topics |
| --- | --- |
| [Announcements](/c/announcements/48)This category is for announcements that impact the community across more than one tool. | 2 |
| [Boundary](/c/boundary/50)Boundary use cases, questions, and best practices discussions. Please note this tool is currently a 0.x release, so it will have many updates in the coming months. | 669 |
| [Consul](/c/consul/29)Consul use cases, questions, and best practices discussions. | 2281 |
| [HashiCorp Cloud Platform (HCP)](/c/hcp/54)HashiCorp Cloud Platform (HCP) use cases, questions, and best practices discussions. Please note that offerings may be in various release lifecycles. | 72 |
| [Nomad](/c/nomad/28)Nomad use cases, questions, and best practices discussions. | 2147 |
| [Packer](/c/packer/23)Packer use cases, questions, and best practices discussions. | 1307 |
| [Sentinel](/c/sentinel/25)Sentinel use cases, questions, and best practices discussions. | 167 |
| [Terraform](/c/terraform-core/27)Terraform, HCP Terraform (Terraform Cloud), Terraform Enterprise, and CDK for Terraform use cases, questions, and best practices discussions. | 6937 |
| [Terraform Providers](/c/terraform-providers/31)Terraform providers (such as AWS, Azure, Google, or Kubernetes) and plugin development use cases, questions, and best practices discussions. | 964 |
| [Vagrant](/c/vagrant/24)Vagrant use cases, questions, and best practices discussions. | 632 |
| [Vault](/c/vault/30)Vault use cases, questions, and best practices discussions. | 4487 |
| [Waypoint](/c/waypoint/51)Waypoint use cases, questions, and best practices discussions. Please note this tool is currently a 0.x release, so it will have many updates in the coming months. | 328 |
| [Security](/c/security/52)Security updates for all HashiCorp products and services. Posting to this category is restricted to HashiCorp employees only. | 150 |
| [Release Notifications](/c/release-notifications/57)The Release Notifications category is a one-stop place to see all new product and version release announcements. This topic is read-only. Please subscribe to see notifications. | 407 |
| [HashiCorp User Groups, Events, and Meetups](/c/hugs-events-meetups/35)HashiCorp User Groups (HUGs) or event speaker slides, questions, best practices, and discussions. | 87 |
| [Community Jobs](/c/community-jobs/37)**A place for companies within the community who are looking for candidates that run our tools can post their job openings and encourage community members to apply.** | 27 |
| [What's Your Story?](/c/stories/36)**What has your journey been like with us? What tools did you start with? Who helped you along the way? What were your challenges in getting started? Share your story with the community so that others can learn from your experiences.** | 14 |
| [Working Remotely](/c/working-remotely/45)This forum is intended to be a space for anyone, anywhere in the world to discuss working remotely. It’s a place to submit questions, suggestions, challenges, and even a bit of the fun and funny stuff that happens along the way. HashiCorp has been a distributed company since its inception, so we wanted to create a forum where anyone can contribute to the conversation. | 6 |
| [HashiCraft Holidays Hackstravaganza](/c/hashicraft-holidays-hackstravaganza/53)It is about that time again where the weather turns cold and it is time to drink hot cocoa in front of the fireplace (or recording of a fireplace on the TV). What better way to spend some of these evenings than working on a fun side-project, or organizing an internal competition at work? | 8 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from discuss.hashicorp.com_c5aabada_20250114_181417.html ===


[HashiCorp Discuss](/)

# [HCSEC-2022-08 - Vault Enterprise’s Tokenization Transform Configuration Endpoint May Expose Transform Key](/t/hcsec-2022-08-vault-enterprise-s-tokenization-transform-configuration-endpoint-may-expose-transform-key/36599)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

March 4, 2022, 10:52pm

1

**Bulletin ID:** HCSEC-2022-08

**Affected Products / Versions:** Vault Enterprise 1.7.0 through 1.7.9, 1.8.8, and 1.9.3.

**Publication Date:** March 4, 2022

**Summary**

Vault Enterprise (“Vault”) clusters using the tokenization transform feature can expose the tokenization key through the tokenization key configuration endpoint to authorized operators with `read` permissions on this endpoint. This vulnerability, CVE-2022-25244, was fixed in Vault Enterprise 1.7.10, 1.8.9, and 1.9.4.

**Background**

Vault’s [tokenization transform](https://www.vaultproject.io/docs/secrets/transform/tokenization) protects sensitive values making them irreversible from a token alone. To decode the original value, the token must be submitted to Vault where it is retrieved from a cryptographic mapping in storage. Tokenization is stateful, requiring at least both the tokenization state and the transform key to decode the original value.

**Details**

During ongoing Vault development, it was observed that the [tokenization key configuration endpoint](https://www.vaultproject.io/api-docs/secret/transform#read-tokenization-key-configuration) incorrectly included the base64-encoded key as part of a requested key configuration.

Exposure to key disclosure and subsequent tokenization reversal is mitigated as follows:

* The endpoint in question is authenticated, with read permissions generally reserved for Vault operators and unneeded for tokenization transform usage on a day-to-day basis.
* Knowledge of the transform key alone is insufficient to reverse the tokenization. An adversary would also need tokenization state values (stored either in Vault’s backend storage or external RDBMS) as well as end-user-device tokens (if the default, [non-exportable](https://www.vaultproject.io/docs/secrets/transform/tokenization#export-decoded) tokenization mode is used) to reverse the tokenization process.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.7.10, 1.8.9, 1.9.4, or newer. Operators may also opt to [rotate the tokenization key](https://www.vaultproject.io/api-docs/secret/transform#rotate-tokenization-key), if they believe it was exposed. Please refer to [Upgrading Vault](https://www.vaultproject.io/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by the Vault engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-18 - Vault Leaks Client Token and Token Accessor in Audit Devices](https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices/69669)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 2373 | August 31, 2024 |
| [HCSEC-2021-33 - Vault’s KV Secrets Engine With Integrated Storage Exposed to Authenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7061 | December 14, 2021 |
| [HCSEC-2022-15 - Vault Enterprise Does Not Verify Existing Voter Status When Joining An Integrated Storage HA Node](https://discuss.hashicorp.com/t/hcsec-2022-15-vault-enterprise-does-not-verify-existing-voter-status-when-joining-an-integrated-storage-ha-node/42420)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 8249 | July 26, 2022 |
| [HCSEC-2023-17 - Vault’s KV Diff Viewer Allowed HTML Injection](https://discuss.hashicorp.com/t/hcsec-2023-17-vault-s-kv-diff-viewer-allowed-html-injection/54814)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6742 | June 9, 2023 |
| [HCSEC-2024-10 - Vault Enterprise Leaks Sensitive HTTP Request Headers in Audit Log When Deployed With a Performance Standby Node](https://discuss.hashicorp.com/t/hcsec-2024-10-vault-enterprise-leaks-sensitive-http-request-headers-in-audit-log-when-deployed-with-a-performance-standby-node/66553)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 3782 | April 30, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


