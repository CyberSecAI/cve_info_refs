=== Content from snyk.io_d627c5e4_20250114_205842.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. link-preview-js
# Server-side Request Forgery (SSRF) Affecting [link-preview-js](/package/npm/link-preview-js) package, versions **<2.1.16**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-LINKPREVIEWJS-2933520#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.08% (38th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)

* Snyk ID**SNYK-JS-LINKPREVIEWJS-2933520**
* published**29 Jun 2022**
* disclosed**22 Jun 2022**
* credit**Reworr**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 22 Jun 2022

[CVE-2022-25876  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-25876) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-918  (opens in a new tab)](https://cwe.mitre.org/data/definitions/918.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `link-preview-js` to version 2.1.16 or higher.

## Overview

[link-preview-js](https://www.npmjs.org/package/link-preview-js) is a Javascript module to extract and fetch HTTP link information from blocks of text.

Affected versions of this package are vulnerable to Server-side Request Forgery (SSRF) which allows attackers to send arbitrary requests to the local network and read the response. This is due to flawed DNS rebinding protection.

## PoC:

1. Find domain that resolved to private address with reverse ip lookup or use domains localtest.me (127.0.0.1) or devhead.net (127.0.0.1 + 192.168.1.1 + 192.168.0.1).
2. Write it to `getLinkPreview`.
3. You see content from your local address.
## References

* [GitHub Issue](https://github.com/ospfranco/link-preview-js/issues/115)
* [Github PR](https://github.com/ospfranco/link-preview-js/pull/117)
### CVSS Scores

version 3.1
### Snyk

6.2 medium

* Attack Vector (AV)

  The vulnerable component is not bound to the network stack and the attacker's path is via read/write/execute capabilities.

  **Local**
* Attack Complexity (AC)

  Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component.

  **Low**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is a total loss of confidentiality, resulting in all resources within the impacted component being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server.

  **High**
* Integrity (I)

  There is no loss of integrity within the impacted component.

  **None**
* Availability (A)

  There is no impact to availability within the impacted component.

  **None**
### NVD

5.5 medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_9bf0c3a7_20250114_205837.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fpull%2F117)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fpull%2F117)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=OP-Engineering%2Flink-preview-js)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OP-Engineering](/OP-Engineering)
/
**[link-preview-js](/OP-Engineering/link-preview-js)**
Public

* [Notifications](/login?return_to=%2FOP-Engineering%2Flink-preview-js) You must be signed in to change notification settings
* [Fork
  125](/login?return_to=%2FOP-Engineering%2Flink-preview-js)
* [Star
   777](/login?return_to=%2FOP-Engineering%2Flink-preview-js)

* [Code](/OP-Engineering/link-preview-js)
* [Issues
  3](/OP-Engineering/link-preview-js/issues)
* [Pull requests
  0](/OP-Engineering/link-preview-js/pulls)
* [Actions](/OP-Engineering/link-preview-js/actions)
* [Security](/OP-Engineering/link-preview-js/security)
* [Insights](/OP-Engineering/link-preview-js/pulse)

Additional navigation options

* [Code](/OP-Engineering/link-preview-js)
* [Issues](/OP-Engineering/link-preview-js/issues)
* [Pull requests](/OP-Engineering/link-preview-js/pulls)
* [Actions](/OP-Engineering/link-preview-js/actions)
* [Security](/OP-Engineering/link-preview-js/security)
* [Insights](/OP-Engineering/link-preview-js/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FOP-Engineering%2Flink-preview-js%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FOP-Engineering%2Flink-preview-js%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add dns resolver #117

 Merged

[ospfranco](/ospfranco)
merged 2 commits into
[main](/OP-Engineering/link-preview-js/tree/main "OP-Engineering/link-preview-js:main")
from
[dns-resolver](/OP-Engineering/link-preview-js/tree/dns-resolver "OP-Engineering/link-preview-js:dns-resolver")

Jun 27, 2022

 Merged

# [Add dns resolver](#top) #117

[ospfranco](/ospfranco)
merged 2 commits into
[main](/OP-Engineering/link-preview-js/tree/main "OP-Engineering/link-preview-js:main")
from
[dns-resolver](/OP-Engineering/link-preview-js/tree/dns-resolver "OP-Engineering/link-preview-js:dns-resolver")

Jun 27, 2022

+65

−7

[Conversation
3](/OP-Engineering/link-preview-js/pull/117)
[Commits
2](/OP-Engineering/link-preview-js/pull/117/commits)
[Checks
0](/OP-Engineering/link-preview-js/pull/117/checks)
[Files changed
3](/OP-Engineering/link-preview-js/pull/117/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ospfranco](https://avatars.githubusercontent.com/u/1634213?s=60&v=4)](/ospfranco)

Copy link

Collaborator

### @ospfranco **[ospfranco](/ospfranco)** commented [Jun 25, 2022](#issue-1284461296)

Closes [#115](https://github.com/OP-Engineering/link-preview-js/issues/115)

[@AbdurrahmanA](https://github.com/AbdurrahmanA) would you mind taking a look and making sure the implementation is correct?

Sorry, something went wrong.

All reactions

`[Add dns resolver](/OP-Engineering/link-preview-js/pull/117/commits/b66cd63e304cc135d04df0cafea1c425565af024 "Add dns resolver")`

`[b66cd63](/OP-Engineering/link-preview-js/pull/117/commits/b66cd63e304cc135d04df0cafea1c425565af024)`

[![aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=60&v=4)](/aaydin-tr)

**[aaydin-tr](/aaydin-tr)**
suggested changes
[Jun 25, 2022](#pullrequestreview-1019299344)

 [View reviewed changes](/OP-Engineering/link-preview-js/pull/117/files/b66cd63e304cc135d04df0cafea1c425565af024)

[index.ts](/OP-Engineering/link-preview-js/pull/117/files/b66cd63e304cc135d04df0cafea1c425565af024#diff-dcdc3e0b3362edb8fec2a51d3fa51f8fb8af8f70247e06d9887fa934834c9122)
Outdated

|  |  | @@ -21,13 +22,20 @@ interface IPreFetchedResource { | |
| --- | --- | --- | --- |
|  |  | data: string; |
|  |  | } |
|  |  |  |
|  |  | const metaTag = (doc: cheerio.Root, type: string, attr: string) => { |
|  |  | function throwOnLoopback(address: string) { |
|  |  | if (address === "localhost" || address === "127.0.0.1") { |

Copy link

Contributor

### @aaydin-tr **[aaydin-tr](/aaydin-tr)** [Jun 25, 2022](#discussion_r906670729)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The loopback address doesn't always have to be "localhost" or "127.0.0.1", we may need to check other reserved local ips, I think it makes more sense to use regex for this. e.g

```
new RegExp(
    "^" +
      "(?:(?:10|127)(?:\\.\\d{1,3}){3})" +
      "|" +
      "(?:(?:169\\.254|192\\.168|192\\.0)(?:\\.\\d{1,3}){2})" +
      "|" +
      "(?:172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})" +
      "$",
    "i"
  )

```

if you can find a more comprehensive regex it will be nice too

Sorry, something went wrong.

All reactions

Copy link

Collaborator

Author

### @ospfranco **[ospfranco](/ospfranco)** [Jun 27, 2022](#discussion_r906996701)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'll just use this regex for now

Sorry, something went wrong.

All reactions

`[Check for loopback via regex](/OP-Engineering/link-preview-js/pull/117/commits/a3b2b52c565b0f941a1711032172150e7d5709f0 "Check for loopback via regex")`

`[a3b2b52](/OP-Engineering/link-preview-js/pull/117/commits/a3b2b52c565b0f941a1711032172150e7d5709f0)`

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
merged commit [`7331edd`](/OP-Engineering/link-preview-js/commit/7331edd8845622366d1fdc4ed6305ecfec5dfdd3)
into
main

[Jun 27, 2022](https://github.com/OP-Engineering/link-preview-js/pull/117#event-6882158126)

 [![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
deleted the
dns-resolver

branch
[June 27, 2022 05:53](#event-6882158240)

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

Author

### **[ospfranco](/ospfranco)** commented [Jun 27, 2022](#issuecomment-1166902382)

| released under 1.1.16 |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
mentioned this pull request
[Oct 21, 2024](#ref-issue-2287467402)

[SSRF error occurs on Specific IP
#150](/OP-Engineering/link-preview-js/issues/150)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fpull%2F117)

Reviewers

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=40&v=4)](/aaydin-tr) [aaydin-tr](/aaydin-tr)

aaydin-tr requested changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [SSRF](https://github.com/OP-Engineering/link-preview-js/issues/115)

2 participants

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=52&v=4)](/ospfranco) [![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=52&v=4)](/aaydin-tr)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_706c1fc7_20250114_205832.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fissues%2F115)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fissues%2F115)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=OP-Engineering%2Flink-preview-js)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OP-Engineering](/OP-Engineering)
/
**[link-preview-js](/OP-Engineering/link-preview-js)**
Public

* [Notifications](/login?return_to=%2FOP-Engineering%2Flink-preview-js) You must be signed in to change notification settings
* [Fork
  125](/login?return_to=%2FOP-Engineering%2Flink-preview-js)
* [Star
   777](/login?return_to=%2FOP-Engineering%2Flink-preview-js)

* [Code](/OP-Engineering/link-preview-js)
* [Issues
  3](/OP-Engineering/link-preview-js/issues)
* [Pull requests
  0](/OP-Engineering/link-preview-js/pulls)
* [Actions](/OP-Engineering/link-preview-js/actions)
* [Security](/OP-Engineering/link-preview-js/security)
* [Insights](/OP-Engineering/link-preview-js/pulse)

Additional navigation options

* [Code](/OP-Engineering/link-preview-js)
* [Issues](/OP-Engineering/link-preview-js/issues)
* [Pull requests](/OP-Engineering/link-preview-js/pulls)
* [Actions](/OP-Engineering/link-preview-js/actions)
* [Security](/OP-Engineering/link-preview-js/security)
* [Insights](/OP-Engineering/link-preview-js/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FOP-Engineering%2Flink-preview-js%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FOP-Engineering%2Flink-preview-js%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SSRF #115

Closed

[keworr](/keworr) opened this issue
May 25, 2022
· 17 comments
 · Fixed by [#117](https://github.com/OP-Engineering/link-preview-js/pull/117)

Closed

# [SSRF](#top) #115

[keworr](/keworr) opened this issue
May 25, 2022
· 17 comments
 · Fixed by [#117](https://github.com/OP-Engineering/link-preview-js/pull/117)

## Comments

[![@keworr](https://avatars.githubusercontent.com/u/47640060?s=80&u=873262fbb428daced5a3a321206cb0e635594492&v=4)](/keworr)

Copy link

### **[keworr](/keworr)** commented [May 25, 2022](#issue-1247683812) • edited Loading

| **Describe** There is a way to bypass your regex to validate private & local networks.  If we use <http://127.0.0.1/> or <http://localhost/> to link preview, we don't see it (`Error: link-preview-js did not receive a valid a url or text`), but if we use a domain that resolved to 127.0.0.1, we can. For example: localtest.me resolved to 127.0.0.1 (localhost), i.e. If you 'curl localtest.me', you'll see your localhost.  Similarly we can read any other private & local address, any port.  **To Reproduce** Steps to reproduce:   1. Find domain that resolved to private address with reverse ip lookup or use localtest.me (127.0.0.1) or devhead.net (127.0.0.1 + 192.168.1.1 + 192.168.0.1). 2. Write it to getLinkPreview. 3. Done. You see your local domain.   **Screenshots** [image](https://user-images.githubusercontent.com/47640060/170204508-717c1e40-57dc-424f-8ea1-1f029c6ede73.png) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 25, 2022](#issuecomment-1136915812)

| Which version are you using? At some point, someone submitted a PR to patch redirections, by default it should not follow any. |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 25, 2022](#issuecomment-1136920564)

| I don't quite get what is the issue though... these sites seem to register the loopback address on DNS level. Even curl returns the data of the directory, then it also means that curl has an SSRF vulnerability?  [Screenshot 000528](https://user-images.githubusercontent.com/1634213/170212384-15f780bb-4c10-44e2-971a-3f9997e901bb.png) |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 25, 2022](#issuecomment-1136922503)

| The regex is not a security feature, it's only a way to detect links in the text. As stated, the library does not follow redirections by default.  [#105](https://github.com/OP-Engineering/link-preview-js/issues/105) |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
closed this as [completed](/OP-Engineering/link-preview-js/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 25, 2022](#event-6675521294)

[![@keworr](https://avatars.githubusercontent.com/u/47640060?s=80&u=873262fbb428daced5a3a321206cb0e635594492&v=4)](/keworr)

Copy link

Author

### **[keworr](/keworr)** commented [May 25, 2022](#issuecomment-1137105216)

| But you accepted same SSRF here - [#105](https://github.com/OP-Engineering/link-preview-js/issues/105)? |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 25, 2022](#issuecomment-1137437336) • edited Loading

| I really don't understand what you mean. In that issue, the author submitted a PR not to follow redirects, which is now the default behavior. The same author complained that it is possible to pass the regex with a localhost url, like I said, the regex is not meant to be a security feature, it is only there for link detection. Once the url is passed to the fetch library, there is no way to re-validate the url (even if the regex was meant to do that, which it is not) . On the other hand, I already showed you that curl also has this same behavior, because the domains you send use the localhost address on a DNS level, so that means (as far as I can see) that there is no SSRF vulnerability, this is just the expected behavior. |
| --- |

All reactions

Sorry, something went wrong.

[![@keworr](https://avatars.githubusercontent.com/u/47640060?s=80&u=873262fbb428daced5a3a321206cb0e635594492&v=4)](/keworr)

Copy link

Author

### **[keworr](/keworr)** commented [May 25, 2022](#issuecomment-1137482408) • edited Loading

| Redirects were disabled in that issue because it allows to read local hosts, right? And my way also allows to read local hosts? idk what is different  Yes, curl by default allow same, also curl allow requests as `curl file:///etc/passwd` by default, SMB requests, FTP, etc. Also e.g. any browsers allow redirects by default, but you disabled it.  I just saw that issue and thought that SSRF is sensitive here, if not - ok. |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 25, 2022](#issuecomment-1137629653)

| redirects were disallowed not because localhost, but because redirections are by default insecure. Your way allows to reach localhost, not because the library is doing something wrong, but because the domains you provided loopback to localhost **on the DNS level**, they are not intercepting the request and redirecting, they are straight up returning 127.0.0.1 when their DNS address is resolved. There is nothing I can do about that. |
| --- |

All reactions

Sorry, something went wrong.

[![@keworr](https://avatars.githubusercontent.com/u/47640060?s=40&u=873262fbb428daced5a3a321206cb0e635594492&v=4)](/keworr)
[keworr](/keworr)
mentioned this issue
[May 25, 2022](#ref-issue-1248478370)

[Invite to issue
aaydin-tr/svn-scanner#1](/aaydin-tr/svn-scanner/issues/1)

Closed

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=80&v=4)](/aaydin-tr)

Copy link

Contributor

### **[aaydin-tr](/aaydin-tr)** commented [May 25, 2022](#issuecomment-1137767058) • edited Loading

| [@ospfranco](https://github.com/ospfranco) first of all i install lastest version of package for testing my local machine and cant see `followRedirects` option in source could there be a problem with npm? can you check please  [image](https://user-images.githubusercontent.com/50546655/170352073-87f07e3d-20f3-4713-b1e3-6f7aaf90de9c.png)  [image](https://user-images.githubusercontent.com/50546655/170350549-c62501d8-9b55-4d87-977a-2cae8bb736c7.png)  [image](https://user-images.githubusercontent.com/50546655/170350739-bb07b3de-3ea6-4e93-917a-a3a1eff02a31.png)  Second of all i agree with [@keworr](https://github.com/keworr) this vulnerability is called DNS pinning (or DNS rebinding) and it allow to bypass all control mechanism on DNS level but library has proxy option and the purpose of proxy is to fix such DNS level problems and vulnerabilities. But if we want the library to prevent such DNS level attacks as well we can fix this by dns lookup before make request |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 26, 2022](#issuecomment-1138134525)

| hi [@AbdurrahmanA](https://github.com/AbdurrahmanA), you are right I published a new version of the package, probably some cache was left on my machine when I published one of the newer versions. Thanks a lot!  Thanks a lot for the explanation, that was what I needed. [This StackOverflow answer](https://stackoverflow.com/questions/102605/can-i-perform-a-dns-lookup-hostname-to-ip-address-using-client-side-javascript) seems to suggest there is no way to resolve the DNS address from JavaScript, seems like the solution is to self-host a proxy? |
| --- |

All reactions

Sorry, something went wrong.

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=80&v=4)](/aaydin-tr)

Copy link

Contributor

### **[aaydin-tr](/aaydin-tr)** commented [May 26, 2022](#issuecomment-1138903473)

| Actually if we added that kind of option to library it would be great i would love have that option. We can easily do `nslookup` for server side, for client side we can use `https://dns.google/resolve?name=localtest.me` or that option wont be available for client side. By the way this library should not be in client side it wil get lots of CORS error 😁 |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 27, 2022](#issuecomment-1139282697) • edited Loading

| If you mean hardcoding a DNS service, not a fan (and especially google's), but maybe an option to pass a DNS resolver if one chooses to do so.  The library will face CORS errors on websites, on React Native, Cordova, etc it works just fine |
| --- |

All reactions

Sorry, something went wrong.

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=80&v=4)](/aaydin-tr)

Copy link

Contributor

### **[aaydin-tr](/aaydin-tr)** commented [May 29, 2022](#issuecomment-1140521097)

| We can easily set DNS resolver for Node js side, but if we do this using native `dns` library, will it be a problem for client-side users? otherwise we should make an online dns resolver option right? |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 30, 2022](#issuecomment-1140697889)

| I'm still not sure if the DNS resolver should always be there, just from a latency point of view, it might affect people who have already deployed this. But just passing a function that resolves the host might be enough for us to check against common attacks?  ``` getLinkPreview('some text with a link', {   // Must resolve the url host, internally checks for loopbacks and common SSRF attacks   resolveDNSHost: (url: string) => Promise<string> })  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
reopened this
[May 30, 2022](#event-6699796174)

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [May 30, 2022](#issuecomment-1140698692)

| On the other hand, I don't think this would be an issue on mobiles. Almost nobody has a server running on the phone for the loopback address to be considered dangerous. Maybe conditionally importing/requiring the DNS resolver on node is enough... |
| --- |

All reactions

Sorry, something went wrong.

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=80&v=4)](/aaydin-tr)

Copy link

Contributor

### **[aaydin-tr](/aaydin-tr)** commented [Jun 10, 2022](#issuecomment-1152619114)

| Sorry for late response, Yes we just need the DNS resolver on node can we do that and also, we need to warn people about common SSRF vulnerabilities and make sure people understand what this library does. |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=80&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)

Copy link

Collaborator

### **[ospfranco](/ospfranco)** commented [Jun 13, 2022](#issuecomment-1153628549)

| Most people won't care 🤷‍♂️ they barely read the CORS warning. But I'll try to find some time in the coming weeks to add the option, otherwise PRs are welcome |
| --- |

All reactions

Sorry, something went wrong.

[![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=80&v=4)](/aaydin-tr)

Copy link

Contributor

### **[aaydin-tr](/aaydin-tr)** commented [Jun 13, 2022](#issuecomment-1154243185)

| Great to hear that, i could also do it if i have time, i will inform you 👌 |
| --- |

All reactions

Sorry, something went wrong.

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
mentioned this issue
[Jun 25, 2022](#ref-pullrequest-1284461296)

[Add dns resolver
#117](/OP-Engineering/link-preview-js/pull/117)
 Merged

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=40&u=5f75a6db058f4fe0047c76d3b66571ff06259407&v=4)](/ospfranco)
[ospfranco](/ospfranco)
closed this as [completed](/OP-Engineering/link-preview-js/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#117](/OP-Engineering/link-preview-js/pull/117)
[Jun 27, 2022](#event-6882158139)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FOP-Engineering%2Flink-preview-js%2Fissues%2F115)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Add dns resolver](/OP-Engineering/link-preview-js/pull/117)
 [OP-Engineering/link-preview-js](/OP-Engineering/link-preview-js)

3 participants

[![@ospfranco](https://avatars.githubusercontent.com/u/1634213?s=52&v=4)](/ospfranco) [![@keworr](https://avatars.githubusercontent.com/u/47640060?s=52&v=4)](/keworr) [![@aaydin-tr](https://avatars.githubusercontent.com/u/50546655?s=52&v=4)](/aaydin-tr)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


