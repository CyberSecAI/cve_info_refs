```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability occurs when the `libpq` or `pg-native` addons attempt to cast a non-array second argument to an array, which fails and results in a Denial of Service (DoS).",
    "weaknesses": [
      "Denial of Service (DoS)",
      "CWE-400: Uncontrolled Resource Consumption"
    ],
    "impact": "The vulnerability allows an attacker to cause a denial of service, making the system inaccessible to legitimate users.",
    "attack_vectors": "The vulnerability can be exploited by sending crafted requests with a non-array second argument to the vulnerable function within the `libpq` or `pg-native` library.",
    "attacker_capabilities": "The attacker requires the ability to send network requests to the affected service. No prior authentication or user interaction is required."
  },
  "affected_packages": [
    {
      "package": "libpq",
      "version": "<1.8.10"
    },
    {
      "package": "pg-native",
      "version": "<3.0.1"
    }
  ],
  "poc": [
    "//pg-native -> poc.js\n\nlet Client = require('pg-native')\nlet client = new Client();\nclient.connectSync();\nclient.query('some str', 1, function() {});",
    "//libpq -> poc.js\n\nvar Libpq = require('libpq')\nconst pq = new Libpq();\npq.sendQueryParams(\"some str\", 1)"
    ]
}
```