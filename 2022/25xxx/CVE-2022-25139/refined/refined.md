```
{
  "vulnerability": {
    "root_cause": "The PromiseCapability record was stored directly in the function object during a function invocation. This is incorrect, as the PromiseCapability record should be linked to the current execution context. This resulted in function->context being overwritten with consecutive recursive calls, leading to a use-after-free.",
    "weaknesses": [
      "Use-after-free"
    ],
    "impact": "Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).",
    "attack_vectors": "The vulnerability can be triggered by crafting specific JavaScript code that involves recursive calls to asynchronous functions.",
    "required_attacker_capabilities": "An attacker needs the ability to execute JavaScript code within the context of the vulnerable NGINX njs environment."
  },
  "affected_product": "NetApp products incorporating NGINX, specifically njs versions through 0.7.1",
  "remediation": "The vulnerability is addressed by storing the PromiseCapability record in the correct execution context, rather than directly in the function object. This is resolved by the commit 6a07c2156a07ef307b6dcf3c2ca8571a5f1af7a6, which modifies njs_async.c, njs_function.c, njs_function.h, njs_value.h, njs_vm.c, njs_vmcode.c and njs_vmcode.h.",
  "additional_notes": "The vulnerability was publicly discussed, and NetApp is aware of the issue. The provided GitHub issue #451 and the corresponding commit provide detailed information and the fix for this vulnerability"
}
```