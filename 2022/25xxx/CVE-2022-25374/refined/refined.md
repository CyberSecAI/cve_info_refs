Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- A traceability-related improvement in Terraform Enterprise (TFE) unintentionally caused the application to log HTTP request bodies. This logging was not intended and exposed sensitive data.
- A previous sensitive data redaction mechanism was not fully effective against these specific logs.

**Weaknesses/Vulnerabilities:**

- **Unintended Logging of Sensitive Data:** TFE was logging HTTP request bodies, which could include sensitive data such as workspace variables.
- **Insufficient Redaction:** The existing sensitive data redaction mechanism failed to prevent the logging of sensitive data in this context.

**Impact of Exploitation:**

- **Exposure of Sensitive Data:** Sensitive information, such as workspace variables, could be exposed in logs, either locally or in external log forwarding destinations if enabled. This could include secrets, API keys, and other credentials.
- **Potential for Unauthorized Access:** If the logs were forwarded to an external destination, unauthorized parties might gain access to the exposed sensitive data.

**Attack Vectors:**

- **HTTP Requests to TFE:** Attackers did not need direct access to the system and would exploit the vulnerability by making HTTP requests to TFE which included sensitive data, triggering the unintended logging.
- **Access to Logs:** Attackers with access to the TFE logs, either locally or in log forwarding destinations, could access the exposed sensitive data.

**Required Attacker Capabilities/Position:**

- **Ability to make HTTP requests to TFE:** An attacker would need to be able to interact with TFE via HTTP requests.
- **Access to TFE logs:** An attacker would need to have access to TFE server logs, or any external logging service where logs were forwarded.

**Additional Notes:**

- The vulnerability was present in Terraform Enterprise versions v202112-1 through v202201-2.
- The issue was fixed in Terraform Enterprise v202202-1.
- The vulnerability was identified by an external party and reported to HashiCorp.
- The logs were emitted by the `ptfe_atlas` container within TFE.
- The issue was caused by a traceability improvement that introduced a side effect of logging HTTP request bodies.
- HashiCorp recommends that customers upgrade to a fixed version and evaluate their logs for sensitive data.
- The fix involved modifying TFE application logging configuration to not capture HTTP request bodies, reverting to the behavior before v202112-1.