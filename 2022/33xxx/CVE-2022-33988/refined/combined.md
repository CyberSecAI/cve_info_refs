=== Content from www.usenix.org_935cc5a9_20250114_185000.html ===


 [usenix\_logo\_notag\_white](/)

* [Sign In](/user?destination=conference/usenixsecurity22/presentation/jeitner)
* [Conferences](/conferences)

 [![](https://www.usenix.org/sites/default/files/styles/neat_conference_menu_logo/public/sec22_wordmark_stacked_white_400x164_rev.png?itok=RqiBGb4U)](/conference/usenixsecurity22)

* [Attend](/conference/usenixsecurity22#registration)
  + [Registration Information](/conference/usenixsecurity22/registration-information)
  + [Registration Discounts](/conference/usenixsecurity22/registration-discounts)
  + [Terms and Conditions](/conference/usenixsecurity22/terms)
  + [Grant Opportunities](/conference/usenixsecurity22/grants)

  + [Venue, Hotel, and Travel](/conference/usenixsecurity22/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity22/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity22/technical-sessions)

  + [Summer Accepted Papers](/conference/usenixsecurity22/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity22/fall-accepted-papers)
  + [Winter Accepted Papers](/conference/usenixsecurity22/winter-accepted-papers)

  + [Activities](/conference/usenixsecurity22/activities)
  + [Poster Session and Happy Hour](/conference/usenixsecurity22/poster-session)
* [Participate](/conference/usenixsecurity22/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity22/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity22/submission-policies-and-instructions)

  + [Call for Artifacts](/conference/usenixsecurity22/call-for-artifacts)
  + [Artifact Appendix Guidelines](/conference/usenixsecurity22/artifact-appendix-guidelines)

  + [Instructions for Presenters](/conference/usenixsecurity22/instructions-presenters)
* [Sponsors](/conference/usenixsecurity22#sponsorship)
  + [Exhibitor Services](/conference/usenixsecurity22/exhibitor-services)
* [About](/conference/usenixsecurity22#marquee)
  + [Symposium Organizers](/conference/usenixsecurity22#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)

  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity22#questions)

# XDRI Attacks - and - How to Enhance Resilience of Residential Routers

Authors:

Philipp Jeitner, *Fraunhofer Institute for Secure Information Technology SIT and National Research Center for Applied Cybersecurity ATHENE;* Haya Shulman, *Fraunhofer Institute for Secure Information Technology SIT, National Research Center for Applied Cybersecurity ATHENE, and Goethe-Universität Frankfurt;* Lucas Teichmann, *Fraunhofer Institute for Secure Information Technology SIT;* Michael Waidner, *Fraunhofer Institute for Secure Information Technology SIT, National Research Center for Applied Cybersecurity ATHENE, and Technische Universität Darmstadt*

Abstract:

We explore the security of residential routers and find a range of critical vulnerabilities. Our evaluations show that 10 out of 36 popular routers are vulnerable to injections of fake records via misinterpretation of special characters. We also find that in 15 of the 36 routers the mechanisms, that are meant to prevent cache poisoning attacks, can be circumvented.

In our Internet-wide study with an advertisement network, we identified and analyzed 976 residential routers used by web clients, out of which more than 95% were found vulnerable to our attacks. Overall, vulnerable routers are prevalent and are distributed among 177 countries and 4830 networks.

To understand the core factors causing the vulnerabilities we perform black- and white-box analyses of the routers. We find that many problems can be attributed to incorrect assumptions on the protocols' behaviour and the Internet, misunderstanding of the standard recommendations, bugs, and simplified DNS software implementations.

We provide recommendations to mitigate our attacks. We also set up a tool to enable everyone to evaluate the security of their routers at <https://xdi-attack.net/>.

## [Philipp Jeitner, Fraunhofer Institute for Secure Information Technology SIT and National Research Center for Applied Cybersecurity ATHENE](/conference/usenixsecurity22/speaker-or-organizer/philipp-jeitner-fraunhofer-institute-secure)

## [Haya Shulman, Fraunhofer Institute for Secure Information Technology SIT, National Research Center for Applied Cybersecurity ATHENE, and Goethe-Universität Frankfurt](/conference/usenixsecurity22/speaker-or-organizer/haya-shulman-fraunhofer-institute-secure)

## [Lucas Teichmann, Fraunhofer Institute for Secure Information Technology SIT](/conference/usenixsecurity22/speaker-or-organizer/lucas-teichmann-fraunhofer-institute-secure)

## [Michael Waidner, Fraunhofer Institute for Secure Information Technology SIT, National Research Center for Applied Cybersecurity ATHENE, and Technische Universität Darmstadt](/conference/usenixsecurity22/speaker-or-organizer/michael-waidner-fraunhofer-institute-secure)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-locked.png)BibTeX@inproceedings {281372,

author = {Philipp Jeitner and Haya Shulman and Lucas Teichmann and Michael Waidner},

title = {{XDRI} Attacks - and - How to Enhance Resilience of Residential Routers},

booktitle = {31st USENIX Security Symposium (USENIX Security 22)},

year = {2022},

isbn = {978-1-939133-31-1},

address = {Boston, MA},

pages = {4473--4490},

url = {https://www.usenix.org/conference/usenixsecurity22/presentation/jeitner},

publisher = {USENIX Association},

month = aug

}

[Download](/biblio/export/bibtex/281372)![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Jeitner PDF](https://www.usenix.org/system/files/sec22-jeitner.pdf "sec22-jeitner.pdf")![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-unlocked.png)[View the slides](https://www.usenix.org/system/files/sec22_slides-jeitner.pdf)
## Presentation Video

* [Attend](/conference/usenixsecurity22#registration)
  + [Registration Information](/conference/usenixsecurity22/registration-information)
  + [Registration Discounts](/conference/usenixsecurity22/registration-discounts)
  + [Terms and Conditions](/conference/usenixsecurity22/terms)
  + [Grant Opportunities](/conference/usenixsecurity22/grants)
  + [Venue, Hotel, and Travel](/conference/usenixsecurity22/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity22/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity22/technical-sessions)
  + [Summer Accepted Papers](/conference/usenixsecurity22/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity22/fall-accepted-papers)
  + [Winter Accepted Papers](/conference/usenixsecurity22/winter-accepted-papers)
  + [Activities](/conference/usenixsecurity22/activities)
  + [Poster Session and Happy Hour](/conference/usenixsecurity22/poster-session)
* [Participate](/conference/usenixsecurity22/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity22/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity22/submission-policies-and-instructions)
  + [Call for Artifacts](/conference/usenixsecurity22/call-for-artifacts)
  + [Artifact Appendix Guidelines](/conference/usenixsecurity22/artifact-appendix-guidelines)
  + [Instructions for Presenters](/conference/usenixsecurity22/instructions-presenters)
* [Sponsors](/conference/usenixsecurity22#sponsorship)
  + [Exhibitor Services](/conference/usenixsecurity22/exhibitor-services)
* [About](/conference/usenixsecurity22#marquee)
  + [Symposium Organizers](/conference/usenixsecurity22#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)
  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity22#questions)

[Twitter](http://twitter.com/usenixsecurity)[Facebook](https://www.facebook.com/USENIX-Security-Symposium-13544602263)[Youtube](http://www.youtube.com/user/USENIXAssociation)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)

© USENIX



=== Content from www.openwall.com_0493975a_20250114_184959.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2022/08/15/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <d07a552b-e107-a680-8220-eca36b07565d@sit.fraunhofer.de>
Date: Sat, 13 Aug 2022 17:00:16 -0700
From: "Philipp Jeitner (SIT)" <philipp.jeitner@....fraunhofer.de>
To: <oss-security@...ts.openwall.com>
Subject: Multiple DNS Cache poisoning vulnerabilities in dproxy and
 drpoxy-nexgen (CVE-2022-33988, CVE-2022-33989, CVE-2022-33990,
 CVE-2022-33991)

We hereby disclose the discovery of multiple DNS Cache poisoning
vulnerabilities in the dproxy(-nexgen) DNS forwarder. dproxy is a
caching DNS forwarder/proxy which is unmaintained since about 2004, yet
it is still used in some residential router firmwares. Because the
project is unmaintained, there are no patches available for the
described issues.

Our findings are published in our 2022 paper "XDRI Attacks - and - How
to Enhance Resilience of Residential Routers" in August 2022.

Discovery/Credits
-----------------

Philipp Jeitner, Lucas Teichmann and Haya Shulman
Fraunhofer SIT

References
----------

   - dproxy: <https://sourceforge.net/projects/dproxy/>
   - paper website: <https://xdi-attack.net/>
   - paper presentation:
<https://www.usenix.org/conference/usenixsecurity22/presentation/jeitner>

CVE-2022-33990: Misinterpretation of special characters in domain names
leading to cache-poisoning
--------------------------------------------------------------------------------------------------

Misinterpretation of special domain name characters in dproxy-nexgen
leads to cache-poisoning as domain names and their associated IP
addresses are cached in their misinterpreted form.

## Summary

Attacker can poison the DNS cache of the vulnerable router/forwarder by
triggering queries to attacker controlled domain names whose queries
and/or answers contain special characters (zero-byte or period sign).
These characters are misinterpreted by the vulnerable router/forwarder
so that the attacker can provide addresses for domain names he does not own.

## Impact

Attackers who control a script or web-site which is loaded on a client
of the vulnerable router/forwarder can hijack connections by poisoning
the DNS cache.

## Steps to reproduce

To reproduce, connect a computer to the router and follow the Steps at
<https://xdi-attack.net/manual.html> or use our downloadable test-tool at
<https://xdi-attack.net/test.html> (NOT the online test).

## Detailed description and publication timeline

A detailed description of this attack is included in our 2021 USENIX
security paper "Injection Attacks Reloaded: Tunnelling Malicious
Payloads over DNS", see Section 3.2. We conducted further research and
found that these attacks apply to various router models.

CVE-2022-33989: Static UDP port in DNS queries sent to upstream resolvers
-------------------------------------------------------------------------

dproxy-nexgen uses a static UDP source port (selected randomly only at
boot-time) in upstream queries sent to DNS resolvers which allows DNS
cache poisoning as there is not enough entropy to prevent traffic
injection attacks.

## Summary

The router/forwarder uses a fixed UDP port for all queries sent to
upstream resolvers.

## Impact

Attackers who control a script or web-site which is loaded on a client
of the vulnerable router/forwarder can exploit this to poison the DNS
cache by classic DNS poisoning attacks with spoofed IP address of the
upstream resolver.

## Steps to reproduce

Connect a computer to the vulnerable router/forwarder and trigger
multiple DNS queries. Observe the queries sent to upstream resolvers via
packet capture, either on the routers Internet-facing interface or the
upstream resolver's network interface. The queries captured on these
interfaces have the same UDP source port.

## Detailed description and publication timeline

This attack is known to be practical since the 2008 publication "Black
Ops 2008: It’s The End Of The Cache As We Know It"
(<https://www.blackhat.com/presentations/bh-jp-08/bh-jp-08-Kaminsky/BlackHat-Japan-08-Kaminsky-DNS08-BlackOps.pdf>).
During an evaluation of DNS vulnerabilities in routers, we found this
attack to be still applicable.

CVE-2022-33988: DNS TXID value is re-used from client queries
-------------------------------------------------------------

dproxy-nexgen re-uses the DNS transaction id (TXID) value from client
queries, which allows attackers able to sent queries to the resolver to
conduct DNS cache poisoning attacks as the TXID value is known to the
attacker.

## Summary

The router/forwarder re-uses the DNS TXID value from client queries when
forwarding the DNS query to upstream resolvers.

## Impact

Attackers which can send DNS queries directly to the vulnerable
router/forwarder can infer the TXID used for upstream queries as the
value is re-used from the query sent by the attacker. This allows the
attacker to inject malicious records into the router/forwarder's DNS
cache, as the remaining entropy in the DNS request (max 16-bit UDP
source port) is not enough to protect against spoofed DNS responses.

## Steps to reproduce

Connect a computer to the vulnerable router/forwarder and trigger some
DNS queries. Monitor the requests sent by the client device (e.g. via
wireshark) and compare the DNS TXID value with the value of the packets
forwarded to the upstream resolvers, e.g. by capturing traffic on the
routers Internet-facing interface or the upstream resolver's network
interface. The TXID values of these packets are the same.

CVE-2022-33991: Disabling of DNSSEC protection provided by upstream
resolvers
-----------------------------------------------------------------------------

dproxy-nexgen forwards and caches DNS queries with checking disabled
(CD) bit set to 1 which leads to disabling of DNSSEC protection provided
by upstream resolvers.

## Summary

The router/forwarder forwards DNS queries with the checking disabled
(CD) bit set to 1 to upstream resolvers and caches the responses
provided by the upstream resolver. The cached answers are then sent to
other clients even when they do set the checking disabled (CD) bit to 0.

## Impact

Attackers which can send DNS queries directly to the vulnerable
router/forwarder can disable DNSSEC protection on the upstream resolver
by sending queries with the checking disabled (CD) bit set to 1. When
the attacker is able to inject DNS responses via another method (e.g.
MitM attacks, BGP hijacking), this allows attacker to hijack connections
from clients of the vulnerable router/forwarder, as DNSSEC protection is
not guaranteed anymore.

## Steps to reproduce

Connect a computer to the vulnerable router/forwarder and trigger the
following DNS queries via `dig`:

      $ dig sigfail.verteiltesysteme.net +cdflag @router/forwarder-ip
      (should always return 134.91.78.139)

      $ dig sigfail.verteiltesysteme.net +short @router/forwarder-ip
      (returns 134.91.78.139 if vulnerable, should return nothing)

Note: you can replace `sigfail.verteiltesysteme.net` with any other
domain with broken DNSSEC, such as `www.dnssec-failed.org`, only the
addresses will be different.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


