- **Root cause of vulnerability:** The application is vulnerable to Stored Cross-Site Scripting (XSS) due to insufficient sanitization of the filename parameter when uploading images.
- **Weaknesses/vulnerabilities present:** Stored XSS vulnerability. The filename parameter in the `/api/storage/upload/PostImage` endpoint is not properly sanitized, allowing an attacker to inject malicious scripts.
- **Impact of exploitation:** An attacker can inject arbitrary JavaScript code, leading to actions such as session hijacking, defacement, or redirection to malicious websites. The injected script is stored and executed each time a user views the affected post.
- **Attack vectors:** The attack vector is through the `/api/storage/upload/PostImage` endpoint. The filename parameter can be manipulated during the image upload process.
- **Required attacker capabilities/position:** The attacker needs to be authenticated as an administrator to access the "New Post" functionality and insert an image, and thus trigger the vulnerability.