Based on the provided information, here's an analysis of CVE-2022-35978:

**Root Cause of Vulnerability:**

*   The vulnerability stems from the ability of a mod in single-player mode to set a global setting that dictates which Lua script is loaded for the main menu. This script is loaded without proper sandboxing when the game session is exited.

**Weaknesses/Vulnerabilities Present:**

*   **Lack of Sandboxing:** The Lua environment in which the main menu script runs is not sandboxed. This allows the script to directly interact with and potentially harm the user's system.
*   **Unprotected Setting:** A mod can set the `main_menu_script` setting, which is meant to define the main menu's Lua script, thus bypassing intended restrictions.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Because of the lack of sandboxing, a malicious mod can execute arbitrary Lua code with the privileges of the user running the Minetest client.
*   **System Compromise:** The attacker could potentially gain control over the user's system, steal data, install malware, or perform other malicious actions. This could be achieved by using the lack of sandboxing to access system functionalities.

**Attack Vectors:**

*   **Malicious Mod:** An attacker would distribute a malicious mod.
*   **Single-Player Mode:** The vulnerability is triggered in single-player mode, where the mod-set `main_menu_script` is loaded.
*   **Game Exit:** The malicious script is loaded when the user exits the game session.

**Required Attacker Capabilities/Position:**

*   **Mod Creation/Distribution:** The attacker needs to create or modify a mod.
*   **Mod Installation:** The user must install and activate the malicious mod.
*   **Single-Player Game Usage:** The user must run the game in single-player mode.
*  **No Privileges Required:** The attacker does not require special permissions on the userâ€™s system to exploit the vulnerability.

**Additional Details:**

*   The vulnerability is specific to single-player mode.
*   The patch ([da71e86](https://github.com/minetest/minetest/commit/da71e86633d0b27cd02d7aac9fdac625d141ca13)) addresses this by preventing the `main_menu_script` setting from being modified by mods.
*   The severity is rated as High due to the potential for system compromise.
*   CVSS v3 base score of 8.4
*   Attack vector: Local
*   Attack complexity: Low
*   Privileges required: None
*   User interaction: None
*   Scope: Unchanged
*   Confidentiality: High
*   Integrity: High
*   Availability: High