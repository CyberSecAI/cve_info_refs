```
{
  "cve": "CVE-2022-35295",
  "description": "Multiple vulnerabilities were identified that could allow a local attacker authenticated as <sid>adm to escalate privileges on SAP UNIX systems. The vulnerabilities are due to the privileged saposcol process generating files in its default working directory (/usr/sap/tmp) owned by the <sid>adm user, and following symbolic links when trying to open/create these files.",
  "vulnerabilities": [
    {
      "name": "UNIX Symlink Following and Insecure File Permissions in Detailed Lock Logging Feature of saposcol",
      "root_cause": "The saposcol process uses `openat()` without the `O_EXCL` flag when creating `SaposcolMonAreaLocking.log`, allowing an attacker to replace the file with a symlink. The process then opens the existing file for appending and changes its permissions to world-readable/writable (666).",
      "weaknesses": [
        "Insecure file handling",
        "Symbolic link following",
        "Missing O_EXCL flag in openat() call",
         "Insecure file permissions"
      ],
      "impact": "An attacker can gain read/write access to arbitrary files owned by the root user account by creating a malicious symlink before activating the detailed lock logging feature.",
      "attack_vectors": [
        "Local exploitation",
        "Symbolic link manipulation"
      ],
      "attacker_capabilities": "Requires local access as <sid>adm user"
    },
    {
      "name": "UNIX Symlink Following and Race Condition in Hardware Reporting Feature of saposcol",
       "root_cause": "The saposcol process creates a hardware report file (e.g., `hwconfig_<host>`) in its working directory and does not check if it has been replaced with a symlink after creation but before changing its ownership and permissions. This allows for a race condition where a malicious symlink can be placed in between creation and permission setting.",
      "weaknesses": [
         "Insecure file handling",
        "Symbolic link following",
        "Race condition"
      ],
      "impact": "An attacker can either corrupt arbitrary files owned by the root user account by writing hardware information to it or gain unauthorized read access by carefully placing a symlink and exploiting the race condition.",
       "attack_vectors": [
        "Local exploitation",
        "Symbolic link manipulation",
         "Race condition exploitation"
      ],
      "attacker_capabilities": "Requires local access as <sid>adm user"
    },
    {
      "name": "UNIX Symlink Following and Race Condition in System Log Feature of saposcol",
       "root_cause": "Similar to the hardware reporting vulnerability, the saposcol process creates system log report file (e.g., `ossyslog_<host>`) in its working directory without proper checks for symlinks, which leads to a similar vulnerability.",
      "weaknesses": [
        "Insecure file handling",
        "Symbolic link following",
        "Race condition"
      ],
       "impact": "An attacker can overwrite arbitrary files with system log information or gain unauthorized read access using a race condition by placing a malicious symlink.",
      "attack_vectors": [
        "Local exploitation",
        "Symbolic link manipulation",
        "Race condition exploitation"
      ],
      "attacker_capabilities": "Requires local access as <sid>adm user"
    },
    {
      "name": "UNIX Symlink Following in Log File Creation of saposcol",
       "root_cause": "The saposcol process resolves symlinks when creating log files (`dev_coll` and `dev_coll.tmp`) during startup.",
      "weaknesses": [
        "Insecure file handling",
        "Symbolic link following"
      ],
       "impact": "An attacker can overwrite arbitrary files owned by root with log data by placing a malicious symlink and restarting the saposcol process.",
      "attack_vectors": [
       "Local exploitation",
        "Symbolic link manipulation"
      ],
      "attacker_capabilities": "Requires local access as <sid>adm user, and the ability to trigger a restart of the saposcol process."
    },
     {
      "name": "UNIX Symlink Following in Shared Memory Dump File Creation of saposcol",
       "root_cause": "The saposcol process resolves symlinks when creating a shared memory dump file (`coll.put`) during termination.",
      "weaknesses": [
        "Insecure file handling",
        "Symbolic link following"
      ],
      "impact": "An attacker can overwrite arbitrary files owned by root with data from shared memory segment by placing a malicious symlink and stopping the saposcol process.",
      "attack_vectors": [
        "Local exploitation",
        "Symbolic link manipulation"
      ],
      "attacker_capabilities": "Requires local access as <sid>adm user, and the ability to trigger a stop of the saposcol process."
    }
  ],
  "affected_versions": [
    "SAP Host Agent 721 (patch no. 42)",
    "SAP Host Agent 722 (patch no. 54)",
      "SAPHOSTAGENT 7.22"
  ],
  "fix_versions": [
    "SAP Security Note 3159736"
  ],
    "workarounds": [
    "Remove write access to the DIR_PERF (e.g. /usr/sap/tmp) directory for <sid>adm account."
  ]
}
```