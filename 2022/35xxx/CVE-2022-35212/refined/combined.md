=== Content from forums.oscommerce.com_ae6cbc27_20250114_231945.html ===
[Jump to content](#elContent "Go to main content on this page")

 [facebook](https://www.facebook.com/pages/osCommerce/33387373079)
 [twitter](https://twitter.com/osCommerce)
[list](https://oscommerce.us1.list-manage.com/subscribe?u=8034c4fa2bcb139b4fc4861cd&id=b428c4d027)
[github](https://github.com/osCommerce/osCommerce-V4)

[![dev osCommerce](https://www.oscommerce.com/themes/oscommerce/img/logo-3.png)](https://www.oscommerce.com/)

[![dev osCommerce](https://app.oscommerce.com/themes/oscommerce_app/img/oscommerce-icon.svg)](https://www.oscommerce.com/)

[![](https://www.oscommerce.com/themes/oscommerce/img/app_shop_logo.webp)](https://www.oscommerce.com/app/)

| * osCommerce 4   + [osCommerce 4](https://www.oscommerce.com/products)     - [Free Trial](https://www.oscommerce.com/host-with-oscommerce)     - [Download osCommerce 4](https://www.oscommerce.com/download-oscommerce)     - [Ecommerce products](https://demo.oscommerce.com)     - [Dev kits](https://www.oscommerce.com/premium-app-packages-page)     - [Enterprise version](https://www.oscommerce.com/oscommerce-enterprise)   + [App Shop](https://www.oscommerce.com/app)     - [Design](https://www.oscommerce.com/app/design)     - [Marketing](https://www.oscommerce.com/app/marketing)     - [SEO tools](https://www.oscommerce.com/app/seo-tools)     - [Payment](https://www.oscommerce.com/app/payment)     - [Shipping](https://www.oscommerce.com/app/shipping)   + [Support](https://www.oscommerce.com/support)     - [Feature list](https://www.oscommerce.com/feature-list)     - [Documentation](https://wiki.oscommerce.com)     - [Public Chat](https://www.oscommerce.com/public-chat)     - [Partners](https://www.oscommerce.com/partners)     - [Bug Reports](https://github.com/osCommerce/osCommerce-V4/issues)   + [Services](https://www.oscommerce.com/services)     - [Ecommerce development](https://www.oscommerce.com/ecommerce-development)     - [Migration to osCommerce](https://www.oscommerce.com/migration-to-oscommerce)     - [osCommerce hosting](https://www.oscommerce.com/oscommerce-hosting)     - [Enterprise services](https://www.oscommerce.com/enterprise-oscommerce)     - [White label Ecommerce](https://www.oscommerce.com/white-label-ecommerce)   + [App Shop](https://app.oscommerce.com/)     - [Retail pack](https://www.oscommerce.com/app/153)     - [Wholesale /B2b pack](https://www.oscommerce.com/app/152)     - [Marketplaces](https://www.oscommerce.com/app/marketplaces)     - [Submit app](https://www.oscommerce.com/app)     - [Request app](https://www.oscommerce.com/app)   + [Us](https://www.oscommerce.com/us)     - [The Team](https://www.oscommerce.com/the-team)     - [News](https://www.oscommerce.com/blog)     - [Legal Policies](https://www.oscommerce.com/legal-policies)     - [For Investors](https://www.oscommerce.com/for-investors)     - [Live Shops](https://trends.builtwith.com/shop/osCommerce) |
| --- |

[Forum](https://www.oscommerce.com/forums/)

[![](https://www.oscommerce.com/themes/oscommerce/img/app-oscommerce-icon.svg)](https://app.oscommerce.com/)

* + Everywhere
  + This Forum
  + This Topic
  + Status Updates
  + Topics
  + Members
* [Checkout](https://www.oscommerce.com/app/checkout)
* [Login](https://www.oscommerce.com/account/?return=https%3A%2F%2Fwww.oscommerce.com/forums%2F)
* [Contact Us](https://www.oscommerce.com/contact)
* [Get in touch](https://www.oscommerce.com/contact)

* [Home](https://www.oscommerce.com/forums/ "Home")
* [General](https://www.oscommerce.com/forums/forum/27-general/)
* [Security](https://www.oscommerce.com/forums/forum/76-security/)
* Potencial XSS vulnerability

osCommerce

The e-commerce.

[![](https://www.oscommerce.com/images/demoIcon.png) New Demo](https://demo.oscommerce.com/)
[Host with osCommerce](https://www.oscommerce.com/host-with-oscommerce) [Host on your own](https://www.oscommerce.com/download-oscommerce)

* [![advertisement_alt](https://www.oscommerce.com/forums/uploads/monthly_2022_07/devoscommerce.jpg.1f7b0cfdfc98e0a9b17700ba4569fb4e.jpg)](https://www.oscommerce.com/forums/index.php?app=core&module=system&controller=redirect&do=advertisement&ad=2&key=590a4c3482ada6df4cfa826468b8fde103cd07ea2606b3f0e4ce3989aebc0c7b)
* [![advertisement_alt](https://www.oscommerce.com/forums/uploads/monthly_2022_07/devoscommerce.jpg.1f7b0cfdfc98e0a9b17700ba4569fb4e.jpg)](https://www.oscommerce.com/forums/index.php?app=core&module=system&controller=redirect&do=advertisement&ad=2&key=590a4c3482ada6df4cfa826468b8fde103cd07ea2606b3f0e4ce3989aebc0c7b)
* [![advertisement_alt](https://www.oscommerce.com/forums/uploads/monthly_2022_05/banner_mobile_forum.png.819afb2c97a8726a905b986b3c3a7e94.png)](https://www.oscommerce.com/forums/index.php?app=core&module=system&controller=redirect&do=advertisement&ad=2&key=590a4c3482ada6df4cfa826468b8fde103cd07ea2606b3f0e4ce3989aebc0c7b)

[Our Partners](https://www.oscommerce.com/Services)

![]()

# Potencial XSS vulnerability

* [xss](https://www.oscommerce.com/forums/tags/xss/ "Find other content tagged with 'xss'")

---

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

**By
[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [Start new topic](https://www.oscommerce.com/forums/forum/76-security/?do=add "Start a new topic in this forum")

## Recommended Posts

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823070)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/ "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823070)

I am using osCommerce2 and find one potential XSS vulnerability in its version 2.3.4.1:

osCommerce implements function *tep\_db\_query()*to execute SQL statement.  In case of MySQL error, the function *tep\_db\_query()* would call *tep\_db\_error()* to handle the mysql errors:

*$result = mysqli\_query($$link, $query) or tep\_db\_error($query, mysqli\_errno($$link), mysqli\_error($$link));*

The *tep\_db\_error()*function basically calls *die()* function to display the error back to users:

*die('<font color="#000000"><strong>' . $errno . ' - ' . $error . '<br /><br />' . $query . ' ...);*

The *$query* variable is sent by users and is well sanitized against SQL injection. However, it will also be used in the *die()* function (a sensitive XSS function like *echo()*) when Mysql returns errors. In multiple files (e.g.,  "/admin/modules.php") ,  the $query variable is not sanitized (against XSS) and can be exploited because of the die() function.

I suggest adding XSS sanitizers in the *tep\_db\_error()* function to avoid this kind of attack.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![ruden](https://www.oscommerce.com/forums/uploads/monthly_2019_03/ruden.thumb.png.15764f3860d2263146827034c041f50c.png)](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")

### [ruden](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823071)

### **[ruden](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")**

* [![ruden](https://www.oscommerce.com/forums/uploads/monthly_2019_03/ruden.thumb.png.15764f3860d2263146827034c041f50c.png)](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")
* Banned
* + [115](https://www.oscommerce.com/forums/profile/295639-ruden/content/ "115 posts")
* **Real Name:** Valeriy Rudenko
* **Gender:** Male
* **Location:** Poland

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823071 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823071)

<https://github.com/ruden/vanilla-oscommerce/commit/753fbbf5cafe47a1035188cfc36078f6767e6970>

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

### [Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823072)

### **[Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")**

* [![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")
* Members
* + [31.2k](https://www.oscommerce.com/forums/profile/17188-jack_mcs/content/ "31,228 posts")
* **Real Name:** Jack
* **Gender:** Male

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823072 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823072)

[@chluo](https://www.oscommerce.com/forums/profile/412471-chluo/)You may want to install [this addon](https://apps.oscommerce.com/Fz2EY%26osc-error-handler) to prevent errors from being displayed to the customers.

**Support Links**:

**For Hire**: Contact me for anything you need help with for your shop: **upgrading, hosting, repairs, code written, etc.**

**[All of My Addons](https://www.oscommerce.com/forums/topic/497125-my-addons/)**

[Get the latest versions of my addons](https://www.oscommerce-solution.com/addons_download.php)

[Recommended SEO Addons](https://www.oscommerce.com/forums/user/17188-jack-mcs)

##### Link to comment

##### Share on other sites

---

More sharing options...

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823073)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* **Author**

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823073 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823073)

> 5 minutes ago, Jack\_mcs said:
>
> [@chluo](https://www.oscommerce.com/forums/profile/412471-chluo/)You may want to install [this addon](https://apps.oscommerce.com/Fz2EY%26osc-error-handler) to prevent errors from being displayed to the customers.

Yes, this also works. But wouldn't it be better to fix it in a newer version because many other users use this app not only me 😀.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

### [Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823074)

### **[Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")**

* [![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")
* Members
* + [31.2k](https://www.oscommerce.com/forums/profile/17188-jack_mcs/content/ "31,228 posts")
* **Real Name:** Jack
* **Gender:** Male

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823074 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823074)

If by "newer version" you mean the version of oscommerce, that might be the case with the new planned version. The current V2 version is no longer supported so such changes would not be made to it.

**Support Links**:

**For Hire**: Contact me for anything you need help with for your shop: **upgrading, hosting, repairs, code written, etc.**

**[All of My Addons](https://www.oscommerce.com/forums/topic/497125-my-addons/)**

[Get the latest versions of my addons](https://www.oscommerce-solution.com/addons_download.php)

[Recommended SEO Addons](https://www.oscommerce.com/forums/user/17188-jack-mcs)

##### Link to comment

##### Share on other sites

---

More sharing options...

[![bonbec](https://www.oscommerce.com/forums/uploads/monthly_2019_11/avatarARA.thumb.jpg.19fdd84ac14fea589694d336be34c6db.jpg)](https://www.oscommerce.com/forums/profile/158549-bonbec/ "Go to bonbec's profile")

### [bonbec](https://www.oscommerce.com/forums/profile/158549-bonbec/ "Go to bonbec's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823075)

### **[bonbec](https://www.oscommerce.com/forums/profile/158549-bonbec/ "Go to bonbec's profile")**

* [![bonbec](https://www.oscommerce.com/forums/uploads/monthly_2019_11/avatarARA.thumb.jpg.19fdd84ac14fea589694d336be34c6db.jpg)](https://www.oscommerce.com/forums/profile/158549-bonbec/ "Go to bonbec's profile")
* Members
* + [510](https://www.oscommerce.com/forums/profile/158549-bonbec/content/ "510 posts")
* **Real Name:** Fred
* **Gender:** Male
* **Location:** France

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823075 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823075)

Excuse me for asking the question, but if the person already have an access to the admin, what's the use of doing an XSS inclusion?

with OsC 2.2 since 2006 ...

##### Link to comment

##### Share on other sites

---

More sharing options...

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823076)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* **Author**

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823076 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823076)

> 16 minutes ago, bonbec said:
>
> Excuse me for asking the question, but if the person already have an access to the admin, what's the use of doing an XSS inclusion?

The attacker can be a common user, the two query functions I mentioned are in the include folder.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823077)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823077 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823077)

> 2 hours ago, ruden said:
>
> <https://github.com/ruden/vanilla-oscommerce/commit/753fbbf5cafe47a1035188cfc36078f6767e6970>

Does this fix the reported problem?

##### Link to comment

##### Share on other sites

---

More sharing options...

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823078)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* **Author**

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823078 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823078)

> 20 minutes ago, Jack\_mcs said:
>
> If by "newer version" you mean the version of oscommerce, that might be the case with the new planned version. The current V2 version is no longer supported so such changes would not be made to it.﻿

OK. Please let me know if it has been fixed. Thanks

##### Link to comment

##### Share on other sites

---

More sharing options...

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823079)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* **Author**

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823079 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823079)

> 1 minute ago, Hotclutch said:
>
> Does this fix the reported problem?

I would suggest adding XSS sanitizers in <https://github.com/ruden/vanilla-oscommerce/blob/dev/catalog/includes/functions/database.php> at line 42. That is: die('<font color="#000000"><strong>' . $errno . ' - ' . $error . '<br /><br />' . htmlspecialchars($query) ...).

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823080)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823080 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823080)

I see the commits are for Vanilla osCommerce. If someone has a solution for regular osCommerce and the CE versions (which probably are the same) that would be useful.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823081)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823081 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823081)

```

die('<font color="#000000"><strong>' . $errno . ' - ' . $error . '<br /><br />' . htmlspecialchars($query) . '<br /><br /><small><font color="#ff0000">[TEP STOP]</font></small><br /><br /></strong></font>');
```

[@chluo](https://www.oscommerce.com/forums/profile/412471-chluo/) you mean like this?

##### Link to comment

##### Share on other sites

---

More sharing options...

[![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

### [chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823082)

### **[chluo](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")**

* [![chluo](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/412471-chluo/ "Go to chluo's profile")
* Members
* + [6](https://www.oscommerce.com/forums/profile/412471-chluo/content/ "6 posts")

* **Author**

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823082 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823082)

> Just now, Hotclutch said:
>
> ```
>
>
> die('<font color="#000000"><strong>' . $errno . ' - ' . $err﻿or . '<br /><br />' . htmlspecialchars﻿($query) . '<br /><br /><small><font color="#ff0000">[TEP STOP]</font></small><br /><br /></strong></font>');
> ```
>
> [@chluo](https://www.oscommerce.com/forums/profile/412471-chluo/) you mean like this?

Yes.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

### [Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823083)

### **[Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")**

* [![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")
* Members
* + [31.2k](https://www.oscommerce.com/forums/profile/17188-jack_mcs/content/ "31,228 posts")
* **Real Name:** Jack
* **Gender:** Male

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823083 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823083)

> 1 hour ago, Hotclutch said:
>
> I see the commits are for Vanilla osCommerce. If someone has a solution for regular osCommerce and the CE versions (which probably are the same) that would be useful.

The goal is, or should be, to hide the failure from the visitor. That's what my addon does.

**Support Links**:

**For Hire**: Contact me for anything you need help with for your shop: **upgrading, hosting, repairs, code written, etc.**

**[All of My Addons](https://www.oscommerce.com/forums/topic/497125-my-addons/)**

[Get the latest versions of my addons](https://www.oscommerce-solution.com/addons_download.php)

[Recommended SEO Addons](https://www.oscommerce.com/forums/user/17188-jack-mcs)

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823084)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823084 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823084)

> 31 minutes ago, Jack\_mcs said:
>
> The goal is, or should be, to hide the failure from the visitor. That's what my addon does.

The instructions for your addon say to :

1) - Upload the included osc\_error\_handler\_db\_handler.php file to

the root of your shop and then execure it by using a url like:

https://YOUR DOMAIN/osc\_error\_handler\_db\_handler.php

but there is no such file included, only osc\_error\_handler.php in the functions folder. Is that right?

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823085)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823085 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823085)

Sorry, nevermind, I see it under the database folder.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

### [Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823086)

### **[Hotclutch](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")**

* [![Hotclutch](https://www.oscommerce.com/forums/uploads/monthly_2021_12/mercedes-serebro-w211.thumb.jpg.41b6fedf2f5e927847989fe53ff8ea28.jpg)](https://www.oscommerce.com/forums/profile/223627-hotclutch/ "Go to Hotclutch's profile")
* Members
* + [2.8k](https://www.oscommerce.com/forums/profile/223627-hotclutch/content/ "2,805 posts")
* **Real Name:** Ashley
* **Gender:** Male
* **Location:** Cape Town, SA

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823086 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823086)

I guess it would be advisable to do both - fix the vulnerability and install the addon.

Would it still be possible for a hacker to exploit this vulnerability with the addon installed? i.e a hacker who knows osCommerce and who already knows the vulnerability exists.

##### Link to comment

##### Share on other sites

---

More sharing options...

[![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

### [Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823087)

### **[Jack\_mcs](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")**

* [![Jack_mcs](data:image/svg+xml...)](https://www.oscommerce.com/forums/profile/17188-jack_mcs/ "Go to Jack_mcs's profile")
* Members
* + [31.2k](https://www.oscommerce.com/forums/profile/17188-jack_mcs/content/ "31,228 posts")
* **Real Name:** Jack
* **Gender:** Male

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823087 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823087)

The addon doesn't stop attacks. It just prevents the message from displaying on the site. For a while a few years ago there was a common attempt where the hacker would enter an invalid command just so they could see the command. Once they had the format, they would put in valid data and try again. The shops code should handle such attacks but the older shops don't. But even in Phoenix, at least earlier versions, still displayed the error so that should be stopped regardless.

**Support Links**:

**For Hire**: Contact me for anything you need help with for your shop: **upgrading, hosting, repairs, code written, etc.**

**[All of My Addons](https://www.oscommerce.com/forums/topic/497125-my-addons/)**

[Get the latest versions of my addons](https://www.oscommerce-solution.com/addons_download.php)

[Recommended SEO Addons](https://www.oscommerce.com/forums/user/17188-jack-mcs)

##### Link to comment

##### Share on other sites

---

More sharing options...

[![ruden](https://www.oscommerce.com/forums/uploads/monthly_2019_03/ruden.thumb.png.15764f3860d2263146827034c041f50c.png)](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")

### [ruden](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823088)

### **[ruden](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")**

* [![ruden](https://www.oscommerce.com/forums/uploads/monthly_2019_03/ruden.thumb.png.15764f3860d2263146827034c041f50c.png)](https://www.oscommerce.com/forums/profile/295639-ruden/ "Go to ruden's profile")
* Banned
* + [115](https://www.oscommerce.com/forums/profile/295639-ruden/content/ "115 posts")
* **Real Name:** Valeriy Rudenko
* **Gender:** Male
* **Location:** Poland

* + [Share](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823088 "Share this post")

[Posted August 20, 2021](https://www.oscommerce.com/forums/topic/497119-potencial-xss-vulnerability/?do=findComment&comment=1823088)

> 10 hours ago, chluo said:
>
> I suggest adding XSS sanitizers in the *tep\_db\_error()* function to avoid this kind of attack.

Requests are used preparation, in order to perform injection you need to have access to the code.

It does not affect anything.

Delete code die('<font color="#000000"><strong>' . $errno . ' - ' . $error . '<br /><br />' . $query . '<br /><br /><small><font color="#ff0000">[TEP STOP]</font></small><br /><br /></strong></font>');

##### Link to comment

##### Share on other sites

---

More sharing options...

#### Archived

This topic is now archived and is closed to further replies.

[Go to topic listing](https://www.oscommerce.com/forums/forum/76-security/ "Go to Security")

* [Latest from forum](https://www.oscommerce.com/forums/rss/1-latest-from-forum.xml/ "Latest from forum")
* [Latest from forum Copy](https://www.oscommerce.com/forums/rss/2-latest-from-forum.xml/ "Latest from forum Copy")

* [Home](https://www.oscommerce.com/forums/ "Home")
* [General](https://www.oscommerce.com/forums/forum/27-general/)
* [Security](https://www.oscommerce.com/forums/forum/76-security/)
* Potencial XSS vulnerability

osCommerce ltd Company No. , Old Station House, Station Approach, Swindon, SN1 3DU, United Kingdom

![](https://www.oscommerce.com/app/themes/oscommerce_app/img/mastercardNew.png)
![](https://www.oscommerce.com/app/themes/oscommerce_app/img/visaWhite.webp)
![](https://www.oscommerce.com/app/themes/oscommerce_app/img/payplay-white.webp)
© 2023 osCommerce ltd [Legal Policies](https://www.oscommerce.com/app/us%26legal)

[Powered by Invision Community](https://www.invisioncommunity.com/ "Invision Community")

×

* [Existing user? Sign In](https://www.oscommerce.com/forums/login/)
* [Sign Up](https://www.oscommerce.com/forums/register/)

* [osCommerce](https://www.oscommerce.com)
* #### Browse

  + Back
  + [Forums](https://www.oscommerce.com/forums/)
  + [Leaderboard](https://www.oscommerce.com/forums/leaderboard/)
  + [Online Users](https://www.oscommerce.com/forums/online/)
  + [Staff](https://www.oscommerce.com/forums/staff/)
  + [Guidelines](https://www.oscommerce.com/Us%26Legal#TermsOfUsePolicy)
* #### Activity

  + Back
  + [All Activity](https://www.oscommerce.com/forums/discover/)
  + [Search](https://www.oscommerce.com/forums/search/)
* [Apps Marketplace](https://apps.oscommerce.com)
* [Live Sites](https://sites.oscommerce.com)
* [Documentation](https://library.oscommerce.com)

×

* Create New...


