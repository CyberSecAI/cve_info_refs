The provided content is related to CVE-2022-35164.

**Root cause of vulnerability:**
The vulnerability is a heap use-after-free in the `bit_copy_chain` function. The issue arises when `bit_copy_chain` is called, and both `dat->chain` and `tmp_dat->chain` point to the same memory address. The `realloc` call within `bit_copy_chain` frees the memory pointed to by `dat->chain`, but subsequent code attempts to read from this freed memory, leading to the use-after-free.

**Weaknesses/vulnerabilities present:**
- Heap use-after-free vulnerability.
- The `bit_copy_chain` function was not properly handling cases where it was copying data within the same memory location.
- Incorrect handling of temporary hdl_dat chain in `obj_flush_hdlstream`.

**Impact of exploitation:**
- Memory corruption
- Potential for arbitrary code execution

**Attack vectors:**
- Crafted DWG files that trigger the vulnerable code path in `bit_copy_chain`.
- The vulnerability is triggered during the encoding of a PLANESURFACE object, which occurs when processing certain DWG files.

**Required attacker capabilities/position:**
- Ability to provide a specially crafted DWG file as input to `libredwg`.
- No special privileges or prior access is needed