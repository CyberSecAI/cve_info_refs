=== Content from github.com_4e5cd39f_20250114_230147.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fblob%2Ff200ff158d5abcb974a6b597a962b6b2fbea2b06%2Fsoftmmu%2Fphysmem.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fblob%2Ff200ff158d5abcb974a6b597a962b6b2fbea2b06%2Fsoftmmu%2Fphysmem.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=qemu%2Fqemu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[qemu](/qemu)
/
**[qemu](/qemu/qemu)**
Public

* [Notifications](/login?return_to=%2Fqemu%2Fqemu) You must be signed in to change notification settings
* [Fork
  5.7k](/login?return_to=%2Fqemu%2Fqemu)
* [Star
   10.7k](/login?return_to=%2Fqemu%2Fqemu)

* [Code](/qemu/qemu)
* [Pull requests
  0](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects
  0](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

Additional navigation options

* [Code](/qemu/qemu)
* [Pull requests](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_41d1f5bd_20250114_230153.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F418ade7849ce7641c0f7333718caf5091a02fd4c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F418ade7849ce7641c0f7333718caf5091a02fd4c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=qemu%2Fqemu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[qemu](/qemu)
/
**[qemu](/qemu/qemu)**
Public

* [Notifications](/login?return_to=%2Fqemu%2Fqemu) You must be signed in to change notification settings
* [Fork
  5.7k](/login?return_to=%2Fqemu%2Fqemu)
* [Star
   10.7k](/login?return_to=%2Fqemu%2Fqemu)

* [Code](/qemu/qemu)
* [Pull requests
  0](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects
  0](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

Additional navigation options

* [Code](/qemu/qemu)
* [Pull requests](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

## Commit

[Permalink](/qemu/qemu/commit/418ade7849ce7641c0f7333718caf5091a02fd4c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

softmmu: Always initialize xlat in address\_space\_translate\_for\_iotlb

[Browse files](/qemu/qemu/tree/418ade7849ce7641c0f7333718caf5091a02fd4c)
Browse the repository at this point in the history

```
The bug is an uninitialized memory read, along the translate_fail
path, which results in garbage being read from iotlb_to_section,
which can lead to a crash in io_readx/io_writex.

The bug may be fixed by writing any value with zero
in ~TARGET_PAGE_MASK, so that the call to iotlb_to_section using
the xlat'ed address returns io_mem_unassigned, as desired by the
translate_fail path.

It is most useful to record the original physical page address,
which will eventually be logged by memory_region_access_valid
when the access is rejected by unassigned_mem_accepts.

Resolves: <https://gitlab.com/qemu-project/qemu/-/issues/1065>
Signed-off-by: Richard Henderson <richard.henderson@linaro.org>
Reviewed-by: Peter Maydell <peter.maydell@linaro.org>
Message-Id: <20220621153829.366423-1-richard.henderson@linaro.org>
```

* Loading branch information

[![@rth7680](https://avatars.githubusercontent.com/u/2529319?s=40&v=4)](/rth7680)

[rth7680](/qemu/qemu/commits?author=rth7680 "View all commits by rth7680")
committed
Jun 21, 2022

1 parent
[3f42906](/qemu/qemu/commit/3f42906c9ab2c777a895b48b87b8107167e4a275)

commit 418ade7

Showing
**1 changed file**
with
**12 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

13 changes: 12 additions & 1 deletion

13
[softmmu/physmem.c](#diff-0bf9f4e2385cdab37f3ac881f90efd92b46f1507b6a807006862b6d53cb22100 "softmmu/physmem.c")

Show comments

[View file](/qemu/qemu/blob/418ade7849ce7641c0f7333718caf5091a02fd4c/softmmu/physmem.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -669,7 +669,7 @@ void tcg\_iommu\_init\_notifier\_list(CPUState \*cpu) |
|  |  |  |
|  |  | /\* Called from RCU critical section \*/ |
|  |  | MemoryRegionSection \* |
|  |  | address\_space\_translate\_for\_iotlb(CPUState \*cpu, int asidx, hwaddr addr, |
|  |  | address\_space\_translate\_for\_iotlb(CPUState \*cpu, int asidx, hwaddr orig\_addr, |
|  |  | hwaddr \*xlat, hwaddr \*plen, |
|  |  | MemTxAttrs attrs, int \*prot) |
|  |  | { |
| Expand All | | @@ -678,6 +678,7 @@ address\_space\_translate\_for\_iotlb(CPUState \*cpu, int asidx, hwaddr addr, |
|  |  | IOMMUMemoryRegionClass \*imrc; |
|  |  | IOMMUTLBEntry iotlb; |
|  |  | int iommu\_idx; |
|  |  | hwaddr addr = orig\_addr; |
|  |  | AddressSpaceDispatch \*d = |
|  |  | qatomic\_rcu\_read(&cpu->cpu\_ases[asidx].memory\_dispatch); |
|  |  |  |
| Expand Down  Expand Up | | @@ -722,6 +723,16 @@ address\_space\_translate\_for\_iotlb(CPUState \*cpu, int asidx, hwaddr addr, |
|  |  | return section; |
|  |  |  |
|  |  | translate\_fail: |
|  |  | /\* |
|  |  | \* We should be given a page-aligned address -- certainly |
|  |  | \* tlb\_set\_page\_with\_attrs() does so. The page offset of xlat |
|  |  | \* is used to index sections[], and PHYS\_SECTION\_UNASSIGNED = 0. |
|  |  | \* The page portion of xlat will be logged by memory\_region\_access\_valid() |
|  |  | \* when this memory access is rejected, so use the original untranslated |
|  |  | \* physical address. |
|  |  | \*/ |
|  |  | assert((orig\_addr & ~TARGET\_PAGE\_MASK) == 0); |
|  |  | \*xlat = orig\_addr; |
|  |  | return &d->map.sections[PHYS\_SECTION\_UNASSIGNED]; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `418ade7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F418ade7849ce7641c0f7333718caf5091a02fd4c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2fc5ecc1_20250114_230150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fblob%2Fv7.0.0%2Finclude%2Fexec%2Fcpu-all.h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fblob%2Fv7.0.0%2Finclude%2Fexec%2Fcpu-all.h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=qemu%2Fqemu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[qemu](/qemu)
/
**[qemu](/qemu/qemu)**
Public

* [Notifications](/login?return_to=%2Fqemu%2Fqemu) You must be signed in to change notification settings
* [Fork
  5.7k](/login?return_to=%2Fqemu%2Fqemu)
* [Star
   10.7k](/login?return_to=%2Fqemu%2Fqemu)

* [Code](/qemu/qemu/tree/v7.0.0)
* [Pull requests
  0](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects
  0](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

Additional navigation options

* [Code](/qemu/qemu/tree/v7.0.0)
* [Pull requests](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

## Files

 v7.0.0
## Breadcrumbs

1. [qemu](/qemu/qemu/tree/v7.0.0)
2. /[include](/qemu/qemu/tree/v7.0.0/include)
3. /[exec](/qemu/qemu/tree/v7.0.0/include/exec)
/
# cpu-all.h

Copy path Blame  Blame
## Latest commit

## History

[History](/qemu/qemu/commits/v7.0.0/include/exec/cpu-all.h)505 lines (433 loc) · 14.5 KB v7.0.0
## Breadcrumbs

1. [qemu](/qemu/qemu/tree/v7.0.0)
2. /[include](/qemu/qemu/tree/v7.0.0/include)
3. /[exec](/qemu/qemu/tree/v7.0.0/include/exec)
/
# cpu-all.h

Top
## File metadata and controls

* Code
* Blame

505 lines (433 loc) · 14.5 KB[Raw](https://github.com/qemu/qemu/raw/refs/tags/v7.0.0/include/exec/cpu-all.h)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505/\* \* defines common to all virtual CPUs \* \* Copyright (c) 2003 Fabrice Bellard \* \* This library is free software; you can redistribute it and/or \* modify it under the terms of the GNU Lesser General Public \* License as published by the Free Software Foundation; either \* version 2.1 of the License, or (at your option) any later version. \* \* This library is distributed in the hope that it will be useful, \* but WITHOUT ANY WARRANTY; without even the implied warranty of \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU \* Lesser General Public License for more details. \* \* You should have received a copy of the GNU Lesser General Public \* License along with this library; if not, see <http://www.gnu.org/licenses/>. \*/#ifndef CPU\_ALL\_H#define CPU\_ALL\_H
#include "exec/cpu-common.h"#include "exec/memory.h"#include "qemu/thread.h"#include "hw/core/cpu.h"#include "qemu/rcu.h"
#define EXCP\_INTERRUPT 0x10000 /\* async interruption \*/#define EXCP\_HLT 0x10001 /\* hlt instruction reached \*/#define EXCP\_DEBUG 0x10002 /\* cpu stopped after a breakpoint or singlestep \*/#define EXCP\_HALTED 0x10003 /\* cpu is halted (waiting for external event) \*/#define EXCP\_YIELD 0x10004 /\* cpu wants to yield timeslice to another \*/#define EXCP\_ATOMIC 0x10005 /\* stop-the-world and emulate atomic \*/
/\* some important defines: \* \* HOST\_WORDS\_BIGENDIAN : if defined, the host cpu is big endian and \* otherwise little endian. \* \* TARGET\_WORDS\_BIGENDIAN : same for target cpu \*/
#if defined(HOST\_WORDS\_BIGENDIAN) != defined(TARGET\_WORDS\_BIGENDIAN)#define BSWAP\_NEEDED#endif
#ifdef BSWAP\_NEEDED
static inline uint16\_t tswap16(uint16\_t s){ return bswap16(s);}
static inline uint32\_t tswap32(uint32\_t s){ return bswap32(s);}
static inline uint64\_t tswap64(uint64\_t s){ return bswap64(s);}
static inline void tswap16s(uint16\_t \*s){ \*s = bswap16(\*s);}
static inline void tswap32s(uint32\_t \*s){ \*s = bswap32(\*s);}
static inline void tswap64s(uint64\_t \*s){ \*s = bswap64(\*s);}
#else
static inline uint16\_t tswap16(uint16\_t s){ return s;}
static inline uint32\_t tswap32(uint32\_t s){ return s;}
static inline uint64\_t tswap64(uint64\_t s){ return s;}
static inline void tswap16s(uint16\_t \*s){}
static inline void tswap32s(uint32\_t \*s){}
static inline void tswap64s(uint64\_t \*s){}
#endif
#if TARGET\_LONG\_SIZE == 4#define tswapl(s) tswap32(s)#define tswapls(s) tswap32s((uint32\_t \*)(s))#define bswaptls(s) bswap32s(s)#else#define tswapl(s) tswap64(s)#define tswapls(s) tswap64s((uint64\_t \*)(s))#define bswaptls(s) bswap64s(s)#endif
/\* Target-endianness CPU memory access functions. These fit into the \* {ld,st}{type}{sign}{size}{endian}\_p naming scheme described in bswap.h. \*/#if defined(TARGET\_WORDS\_BIGENDIAN)#define lduw\_p(p) lduw\_be\_p(p)#define ldsw\_p(p) ldsw\_be\_p(p)#define ldl\_p(p) ldl\_be\_p(p)#define ldq\_p(p) ldq\_be\_p(p)#define stw\_p(p, v) stw\_be\_p(p, v)#define stl\_p(p, v) stl\_be\_p(p, v)#define stq\_p(p, v) stq\_be\_p(p, v)#define ldn\_p(p, sz) ldn\_be\_p(p, sz)#define stn\_p(p, sz, v) stn\_be\_p(p, sz, v)#else#define lduw\_p(p) lduw\_le\_p(p)#define ldsw\_p(p) ldsw\_le\_p(p)#define ldl\_p(p) ldl\_le\_p(p)#define ldq\_p(p) ldq\_le\_p(p)#define stw\_p(p, v) stw\_le\_p(p, v)#define stl\_p(p, v) stl\_le\_p(p, v)#define stq\_p(p, v) stq\_le\_p(p, v)#define ldn\_p(p, sz) ldn\_le\_p(p, sz)#define stn\_p(p, sz, v) stn\_le\_p(p, sz, v)#endif
/\* MMU memory access macros \*/
#if defined(CONFIG\_USER\_ONLY)#include "exec/user/abitypes.h"
/\* On some host systems the guest address space is reserved on the host. \* This allows the guest address space to be offset to a convenient location. \*/extern uintptr\_t guest\_base;extern bool have\_guest\_base;extern unsigned long reserved\_va;
/\* \* Limit the guest addresses as best we can. \* \* When not using -R reserved\_va, we cannot really limit the guest \* to less address space than the host. For 32-bit guests, this \* acts as a sanity check that we're not giving the guest an address \* that it cannot even represent. For 64-bit guests... the address \* might not be what the real kernel would give, but it is at least \* representable in the guest. \* \* TODO: Improve address allocation to avoid this problem, and to \* avoid setting bits at the top of guest addresses that might need \* to be used for tags. \*/#define GUEST\_ADDR\_MAX\_ \ ((MIN\_CONST(TARGET\_VIRT\_ADDR\_SPACE\_BITS, TARGET\_ABI\_BITS) <= 32) ? \ UINT32\_MAX : ~0ul)#define GUEST\_ADDR\_MAX (reserved\_va ? reserved\_va - 1 : GUEST\_ADDR\_MAX\_)
#else
#include "exec/hwaddr.h"
#define SUFFIX#define ARG1 as#define ARG1\_DECL AddressSpace \*as#define TARGET\_ENDIANNESS#include "exec/memory\_ldst.h.inc"
#define SUFFIX \_cached\_slow#define ARG1 cache#define ARG1\_DECL MemoryRegionCache \*cache#define TARGET\_ENDIANNESS#include "exec/memory\_ldst.h.inc"
static inline void stl\_phys\_notdirty(AddressSpace \*as, hwaddr addr, uint32\_t val){ address\_space\_stl\_notdirty(as, addr, val, MEMTXATTRS\_UNSPECIFIED, NULL);}
#define SUFFIX#define ARG1 as#define ARG1\_DECL AddressSpace \*as#define TARGET\_ENDIANNESS#include "exec/memory\_ldst\_phys.h.inc"
/\* Inline fast path for direct RAM access. \*/#define ENDIANNESS#include "exec/memory\_ldst\_cached.h.inc"
#define SUFFIX \_cached#define ARG1 cache#define ARG1\_DECL MemoryRegionCache \*cache#define TARGET\_ENDIANNESS#include "exec/memory\_ldst\_phys.h.inc"#endif
/\* page related stuff \*/
#ifdef TARGET\_PAGE\_BITS\_VARY# include "exec/page-vary.h"extern const TargetPageBits target\_page;#ifdef CONFIG\_DEBUG\_TCG#define TARGET\_PAGE\_BITS ({ assert(target\_page.decided); target\_page.bits; })#define TARGET\_PAGE\_MASK ({ assert(target\_page.decided); \ (target\_long)target\_page.mask; })#else#define TARGET\_PAGE\_BITS target\_page.bits#define TARGET\_PAGE\_MASK ((target\_long)target\_page.mask)#endif#define TARGET\_PAGE\_SIZE (-(int)TARGET\_PAGE\_MASK)#else#define TARGET\_PAGE\_BITS\_MIN TARGET\_PAGE\_BITS#define TARGET\_PAGE\_SIZE (1 << TARGET\_PAGE\_BITS)#define TARGET\_PAGE\_MASK ((target\_long)-1 << TARGET\_PAGE\_BITS)#endif
#define TARGET\_PAGE\_ALIGN(addr) ROUND\_UP((addr), TARGET\_PAGE\_SIZE)
/\* same as PROT\_xxx \*/#define PAGE\_READ 0x0001#define PAGE\_WRITE 0x0002#define PAGE\_EXEC 0x0004#define PAGE\_BITS (PAGE\_READ | PAGE\_WRITE | PAGE\_EXEC)#define PAGE\_VALID 0x0008/\* \* Original state of the write flag (used when tracking self-modifying code) \*/#define PAGE\_WRITE\_ORG 0x0010/\* \* Invalidate the TLB entry immediately, helpful for s390x \* Low-Address-Protection. Used with PAGE\_WRITE in tlb\_set\_page\_with\_attrs() \*/#define PAGE\_WRITE\_INV 0x0020/\* For use with page\_set\_flags: page is being replaced; target\_data cleared. \*/#define PAGE\_RESET 0x0040/\* For linux-user, indicates that the page is MAP\_ANON. \*/#define PAGE\_ANON 0x0080
#if defined(CONFIG\_BSD) && defined(CONFIG\_USER\_ONLY)/\* FIXME: Code that sets/uses this is broken and needs to go away. \*/#define PAGE\_RESERVED 0x0100#endif/\* Target-specific bits that will be used via page\_get\_flags(). \*/#define PAGE\_TARGET\_1 0x0200#define PAGE\_TARGET\_2 0x0400
#if defined(CONFIG\_USER\_ONLY)void page\_dump(FILE \*f);
typedef int (\*walk\_memory\_regions\_fn)(void \*, target\_ulong, target\_ulong, unsigned long);int walk\_memory\_regions(void \*, walk\_memory\_regions\_fn);
int page\_get\_flags(target\_ulong address);void page\_set\_flags(target\_ulong start, target\_ulong end, int flags);int page\_check\_range(target\_ulong start, target\_ulong len, int flags);
/\*\* \* page\_alloc\_target\_data(address, size) \* @address: guest virtual address \* @size: size of data to allocate \* \* Allocate @size bytes of out-of-band data to associate with the \* guest page at @address. If the page is not mapped, NULL will \* be returned. If there is existing data associated with @address, \* no new memory will be allocated. \* \* The memory will be freed when the guest page is deallocated, \* e.g. with the munmap system call. \*/void \*page\_alloc\_target\_data(target\_ulong address, size\_t size);
/\*\* \* page\_get\_target\_data(address) \* @address: guest virtual address \* \* Return any out-of-bound memory assocated with the guest page \* at @address, as per page\_alloc\_target\_data. \*/void \*page\_get\_target\_data(target\_ulong address);#endif
CPUArchState \*cpu\_copy(CPUArchState \*env);
/\* Flags for use in ENV->INTERRUPT\_PENDING.
 The numbers assigned here are non-sequential in order to preserve binary compatibility with the vmstate dump. Bit 0 (0x0001) was previously used for CPU\_INTERRUPT\_EXIT, and is cleared when loading the vmstate dump. \*/
/\* External hardware interrupt pending. This is typically used for interrupts from devices. \*/#define CPU\_INTERRUPT\_HARD 0x0002
/\* Exit the current TB. This is typically used when some system-level device makes some change to the memory mapping. E.g. the a20 line change. \*/#define CPU\_INTERRUPT\_EXITTB 0x0004
/\* Halt the CPU. \*/#define CPU\_INTERRUPT\_HALT 0x0020
/\* Debug event pending. \*/#define CPU\_INTERRUPT\_DEBUG 0x0080
/\* Reset signal. \*/#define CPU\_INTERRUPT\_RESET 0x0400
/\* Several target-specific external hardware interrupts. Each target/cpu.h should define proper names based on these defines. \*/#define CPU\_INTERRUPT\_TGT\_EXT\_0 0x0008#define CPU\_INTERRUPT\_TGT\_EXT\_1 0x0010#define CPU\_INTERRUPT\_TGT\_EXT\_2 0x0040#define CPU\_INTERRUPT\_TGT\_EXT\_3 0x0200#define CPU\_INTERRUPT\_TGT\_EXT\_4 0x1000
/\* Several target-specific internal interrupts. These differ from the preceding target-specific interrupts in that they are intended to originate from within the cpu itself, typically in response to some instruction being executed. These, therefore, are not masked while single-stepping within the debugger. \*/#define CPU\_INTERRUPT\_TGT\_INT\_0 0x0100#define CPU\_INTERRUPT\_TGT\_INT\_1 0x0800#define CPU\_INTERRUPT\_TGT\_INT\_2 0x2000
/\* First unused bit: 0x4000. \*/
/\* The set of all bits that should be masked when single-stepping. \*/#define CPU\_INTERRUPT\_SSTEP\_MASK \ (CPU\_INTERRUPT\_HARD \ | CPU\_INTERRUPT\_TGT\_EXT\_0 \ | CPU\_INTERRUPT\_TGT\_EXT\_1 \ | CPU\_INTERRUPT\_TGT\_EXT\_2 \ | CPU\_INTERRUPT\_TGT\_EXT\_3 \ | CPU\_INTERRUPT\_TGT\_EXT\_4)
#ifdef CONFIG\_USER\_ONLY
/\* \* Allow some level of source compatibility with softmmu. We do not \* support any of the more exotic features, so only invalid pages may \* be signaled by probe\_access\_flags(). \*/#define TLB\_INVALID\_MASK (1 << (TARGET\_PAGE\_BITS\_MIN - 1))#define TLB\_MMIO 0#define TLB\_WATCHPOINT 0
#else
/\* \* Flags stored in the low bits of the TLB virtual address. \* These are defined so that fast path ram access is all zeros. \* The flags all must be between TARGET\_PAGE\_BITS and \* maximum address alignment bit. \* \* Use TARGET\_PAGE\_BITS\_MIN so that these bits are constant \* when TARGET\_PAGE\_BITS\_VARY is in effect. \*//\* Zero if TLB entry is valid. \*/#define TLB\_INVALID\_MASK (1 << (TARGET\_PAGE\_BITS\_MIN - 1))/\* Set if TLB entry references a clean RAM page. The iotlb entry will contain the page physical address. \*/#define TLB\_NOTDIRTY (1 << (TARGET\_PAGE\_BITS\_MIN - 2))/\* Set if TLB entry is an IO callback. \*/#define TLB\_MMIO (1 << (TARGET\_PAGE\_BITS\_MIN - 3))/\* Set if TLB entry contains a watchpoint. \*/#define TLB\_WATCHPOINT (1 << (TARGET\_PAGE\_BITS\_MIN - 4))/\* Set if TLB entry requires byte swap. \*/#define TLB\_BSWAP (1 << (TARGET\_PAGE\_BITS\_MIN - 5))/\* Set if TLB entry writes ignored. \*/#define TLB\_DISCARD\_WRITE (1 << (TARGET\_PAGE\_BITS\_MIN - 6))
/\* Use this mask to check interception with an alignment mask \* in a TCG backend. \*/#define TLB\_FLAGS\_MASK \ (TLB\_INVALID\_MASK | TLB\_NOTDIRTY | TLB\_MMIO \ | TLB\_WATCHPOINT | TLB\_BSWAP | TLB\_DISCARD\_WRITE)
/\*\* \* tlb\_hit\_page: return true if page aligned @addr is a hit against the \* TLB entry @tlb\_addr \* \* @addr: virtual address to test (must be page aligned) \* @tlb\_addr: TLB entry address (a CPUTLBEntry addr\_read/write/code value) \*/static inline bool tlb\_hit\_page(target\_ulong tlb\_addr, target\_ulong addr){ return addr == (tlb\_addr & (TARGET\_PAGE\_MASK | TLB\_INVALID\_MASK));}
/\*\* \* tlb\_hit: return true if @addr is a hit against the TLB entry @tlb\_addr \* \* @addr: virtual address to test (need not be page aligned) \* @tlb\_addr: TLB entry address (a CPUTLBEntry addr\_read/write/code value) \*/static inline bool tlb\_hit(target\_ulong tlb\_addr, target\_ulong addr){ return tlb\_hit\_page(tlb\_addr, addr & TARGET\_PAGE\_MASK);}
#ifdef CONFIG\_TCG/\* accel/tcg/cpu-exec.c \*/void dump\_drift\_info(GString \*buf);/\* accel/tcg/translate-all.c \*/void dump\_exec\_info(GString \*buf);void dump\_opcount\_info(GString \*buf);#endif /\* CONFIG\_TCG \*/
#endif /\* !CONFIG\_USER\_ONLY \*/
/\* accel/tcg/cpu-exec.c \*/int cpu\_exec(CPUState \*cpu);void tcg\_exec\_realizefn(CPUState \*cpu, Error \*\*errp);void tcg\_exec\_unrealizefn(CPUState \*cpu);
/\*\* \* cpu\_set\_cpustate\_pointers(cpu) \* @cpu: The cpu object \* \* Set the generic pointers in CPUState into the outer object. \*/static inline void cpu\_set\_cpustate\_pointers(ArchCPU \*cpu){ cpu->parent\_obj.env\_ptr = &cpu->env; cpu->parent\_obj.icount\_decr\_ptr = &cpu->neg.icount\_decr;}
/\*\* \* env\_archcpu(env) \* @env: The architecture environment \* \* Return the ArchCPU associated with the environment. \*/static inline ArchCPU \*env\_archcpu(CPUArchState \*env){ return container\_of(env, ArchCPU, env);}
/\*\* \* env\_cpu(env) \* @env: The architecture environment \* \* Return the CPUState associated with the environment. \*/static inline CPUState \*env\_cpu(CPUArchState \*env){ return &env\_archcpu(env)->parent\_obj;}
/\*\* \* env\_neg(env) \* @env: The architecture environment \* \* Return the CPUNegativeOffsetState associated with the environment. \*/static inline CPUNegativeOffsetState \*env\_neg(CPUArchState \*env){ ArchCPU \*arch\_cpu = container\_of(env, ArchCPU, env); return &arch\_cpu->neg;}
/\*\* \* cpu\_neg(cpu) \* @cpu: The generic CPUState \* \* Return the CPUNegativeOffsetState associated with the cpu. \*/static inline CPUNegativeOffsetState \*cpu\_neg(CPUState \*cpu){ ArchCPU \*arch\_cpu = container\_of(cpu, ArchCPU, parent\_obj); return &arch\_cpu->neg;}
/\*\* \* env\_tlb(env) \* @env: The architecture environment \* \* Return the CPUTLB state associated with the environment. \*/static inline CPUTLB \*env\_tlb(CPUArchState \*env){ return &env\_neg(env)->tlb;}
#endif /\* CPU\_ALL\_H \*/

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sick.codes_41a5b665_20250114_230155.html ===


* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

No Result
 View All Result

[Home](https://sick.codes)
[Security](https://sick.codes/category/security/)

# CVE-2022-35414 – QEMU 4.1.50 through QEMU 7.0.0 – address\_space\_translate\_for\_iotlb allows a guest user to crash a host resulting in a denial of service.

by
[Sick Codes](https://sick.codes/author/admin/)
[July 11, 2022](https://sick.codes/sick-2022-113/)

in
[Security](https://sick.codes/category/security/)

 [1](https://sick.codes/sick-2022-113/#comments)

### Title

CVE-2022-35414 – QEMU 4.1.50 through QEMU 7.0.0 – address\_space\_translate\_for\_iotlb allows a guest user to crash a host resulting in a denial of service.

### CVE ID

CVE-2022-35414

### CVSS Score

N/A

### Internal IDs

SICK-2022-113

# Vendor

QEMU Project

### Product

QEMU

### Product Versions

QEMU version 4.1.50 through 7.0.0

### Vulnerability Details

A vulnerability in qemu-system-aarch64 in QEMU 4.1.50 through QEMU 7.0.0 allows a guest OS to crash a host when a guess attempts to access an unmapped IOMMU. An attacker can crash and potentially execute arbitrary code as a QEMU guest. An uninitialized local variable in cputlb tlb\_set\_page\_with\_attrs causes a SIGSEGV in io\_readx/io\_writex via address\_space\_translate\_for\_iotlb when a CPU accesses an unmapped IOMMU via memory\_region\_register\_iommu\_notifier.

### Vendor Response

<https://gitlab.com/qemu-project/qemu/-/issues/1065>

[https://www.mail-archive.com/qemu-devel@nongnu.org/msg895266.html](https://www.mail-archive.com/qemu-devel%40nongnu.org/msg895266.html)

<https://gitlab.com/qemu-project/qemu/-/commit/549d4005874f602e957b07459949ae514ea96f20>

### Proof of Concept

Attempted to run varying imx6 kernels on qemu-system-aarch64 & qemu-system-arm.

```
git clone https://github.com/ryzenlover/remarkable-mfgtools.git

# qemu-system-aarch64 -machine virt -cpu cortex-a57 \
#         -device virtio-net-device,netdev=net0 -netdev user,id=net0 \
#         -m 512 \
#         -bios qemu-u-boot-bcm-2xxx-rpi4.bin \
#         -device virtio-gpu-pci -serial stdio \
#         -device qemu-xhci -device usb-tablet -device usb-kbd \
#         -drive id=disk0,file=boot-image-qemu.hddimg,if=none,format=raw -device virtio-blk-device,drive=disk0

Jul 04 11:10:00.883873 hostname kernel: qemu-system-aar[191949]: segfault at a0 ip 000056298699d0bb sp 00007fe2bb9fde30 error 4 in qemu-system-aarch64[5629863bc000+97c000]
Jul 04 11:10:00.883965 hostname kernel: Code: 48 89 06 c7 46 08 01 00 00 00 44 89 66 20 0f 11 46 10 e8 b8 fc ff ff 48 8b 74 24 30 eb 53 90 48 8b 6c 24 28 0f 1f 00 48 89 ca <48> 8b 89 a0 00 00 00 48 85 c9 75 f1 80 7a 30 00 0f 84 9f 00 00 00
```
#### Disclosure Timeline

* **2022-06-06** – Researcher discovers vulnerability
* **2022-07-04** – Researcher encounters vulnerability

### Links

<https://gitlab.com/qemu-project/qemu/-/issues/1065>

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2022-113.md>

<https://sick.codes/sick-2022-113>

<https://github.com/qemu/qemu/blob/f200ff158d5abcb974a6b597a962b6b2fbea2b06/softmmu/physmem.c>

<https://github.com/qemu/qemu/blob/v7.0.0/include/exec/cpu-all.h#L145-L148>

[https://github.com/qemu/qemu/commit/ 3517fb726741c109cae7995f9ea46f0cab6187d6#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fcR482](https://github.com/qemu/qemu/commit/3517fb726741c109cae7995f9ea46f0cab6187d6#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fcR482)

[https://github.com/qemu/qemu/commit/ 3517fb726741c109cae7995f9ea46f0cab6187d6#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fcR482.aa](https://github.com/qemu/qemu/commit/3517fb726741c109cae7995f9ea46f0cab6187d6#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fcR482.aa)

<https://github.com/qemu/qemu/commit/418ade7849ce7641c0f7333718caf5091a02fd4c>

[https://www.mail-archive.com/qemu-devel@nongnu.org/msg895266.html](https://www.mail-archive.com/qemu-devel%40nongnu.org/msg895266.html)

### Researchers

* Trung Nguyen <https://gitlab.com/TrungNguyen1909>
* Sick Codes <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

#### CVE Links

<https://sick.codes/sick-2022-113>

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35414

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2022-35414>

Next Post
[![CVE-2022-36123 asm_exc_page_fault](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2022-128/)
### [CVE-2022-36123 - A vulnerability in Linux kernel mainline v5.18-rc1 through v5.19-rc6 does not clear statically allocated variables in the block starting symbol (.bss) due to a failed early\_xen\_iret\_patch leading to an asm\_exc\_page\_fault, or arbitrary code execution](https://sick.codes/sick-2022-128/)

[![asrock ipmi bug](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/asrock-rack-aspeed-ast2500-bmc-ipmi-reset-fixes-american-megatrends/)
### [ASRock Rack Aspeed Ast2500 BMC/IPMI Reset Fixes (American Megatrends)](https://sick.codes/asrock-rack-aspeed-ast2500-bmc-ipmi-reset-fixes-american-megatrends/)

[![Hacking RAM Trucks](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/live-event-sick-codes-presenting-automotive-cybersecurity-conference-by-automotive-iq-research-on-the-stellantis-platform-santa-clara-marriott-hotel-ca-october-25-27-2022/)
### [Live Event: Sick Codes presenting @ Automotive Cybersecurity Conference by Automotive-IQ: "Research on the Stellantis Platform" Santa Clara Marriott Hotel, CA, October 25 - 27, 2022](https://sick.codes/live-event-sick-codes-presenting-automotive-cybersecurity-conference-by-automotive-iq-research-on-the-stellantis-platform-santa-clara-marriott-hotel-ca-october-25-27-2022/)

### Comments 1

1. Pingback: [Vulnerabilidad en () - CVE-2022-35414 - Información y Soluciones](https://vulnerability.app/2022/cve-2022-35414/)

### Leave a Reply [Cancel reply](/sick-2022-113/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name

Email

Website

No Result
 View All Result

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

© 2017-2021 [Sick.Codes](/ "Sick Codes")

#### [@sickcodes](https://github.com/sickcodes)

#### [@sickcodes](https://twitter.com/sickcodes)

#### [@sickcodes](https://www.linkedin.com/in/sickcodes)

#### [Discord Server](https://discord.com/invite/mx8pPw39Yg)

#### [sickcodes.slack.com](https://join.slack.com/t/sickcodes/shared_invite/zt-tsi4f7gy-wkh46eeQVUMq5j3Naf7RrA)

#### [t.me/sickcodeschat](https://t.me/sickcodeschat)

#### [./contact\_form](https://sick.codes/contact)



=== Content from www.mail-archive.com_2386d7b0_20250114_230157.html ===


[Skip to site navigation (Press enter)](#nav)

# [Re: [PATCH v2] softmmu: Always initialize xlat in address\_space\_translate\_for\_iotlb](/search?l=qemu-devel@nongnu.org&q=subject:%22Re%5C%3A+%5C%5BPATCH+v2%5C%5D+softmmu%5C%3A+Always+initialize+xlat+in+address_space_translate_for_iotlb%22&o=newest)

[Peter Maydell](/search?l=qemu-devel@nongnu.org&q=from:%22Peter+Maydell%22)
[Tue, 21 Jun 2022 08:49:09 -0700](/search?l=qemu-devel@nongnu.org&q=date:20220621)

```
On Tue, 21 Jun 2022 at 16:38, Richard Henderson
<richard.hender...@linaro.org> wrote:
>
> The bug is an uninitialized memory read, along the translate_fail
> path, which results in garbage being read from iotlb_to_section,
> which can lead to a crash in io_readx/io_writex.
>
> The bug may be fixed by writing any value with zero
> in ~TARGET_PAGE_MASK, so that the call to iotlb_to_section using
> the xlat'ed address returns io_mem_unassigned, as desired by the
> translate_fail path.
>
> It is most useful to record the original physical page address,
> which will eventually be logged by memory_region_access_valid
> when the access is rejected by unassigned_mem_accepts.
>
> Resolves: <https://gitlab.com/qemu-project/qemu/-/issues/1065>
> Signed-off-by: Richard Henderson <richard.hender...@linaro.org>
```
```

Reviewed-by: Peter Maydell <peter.mayd...@linaro.org>

thanks
-- PMM

```

* [Previous message](msg895263.html)
* [View by thread](thrd10.html#895266)
* [View by date](mail11.html#895266)
* [Next message](msg895293.html)

* [[PATCH v2] softmmu: Always initialize xlat in address\_sp...](msg895263.html) Richard Henderson
* + Re: [PATCH v2] softmmu: Always initialize xlat in a... Peter Maydell

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [qemu-devel - all messages](/qemu-devel%40nongnu.org/)
* [qemu-devel - about the list](/qemu-devel%40nongnu.org/info.html)
* [Expand](/search?l=qemu-devel@nongnu.org&q=subject:%22Re%5C%3A+%5C%5BPATCH+v2%5C%5D+softmmu%5C%3A+Always+initialize+xlat+in+address_space_translate_for_iotlb%22&o=newest&f=1 "e")
* [Previous message](msg895263.html "p")
* [Next message](msg895293.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* CAFEAcA\_SRK59SYLa9CnMTvAvKMT\_5P2vjGXAMquTq8zPLSKw8w@mail.gmail.com



=== Content from www.qemu.org_d1bd2058_20250114_230158.html ===

[QEMU
![Logo](../_static/qemu_128x128.png)](../index.html)
9.2.50

Contents:

* [About QEMU](../about/index.html)
* [System Emulation](index.html)
  + [Introduction](introduction.html)
  + [Invocation](invocation.html)
  + [Device Emulation](device-emulation.html)
  + [Keys in the graphical frontends](keys.html)
  + [Keys in the character backend multiplexer](mux-chardev.html)
  + [QEMU Monitor](monitor.html)
  + [Disk Images](images.html)
  + [QEMU virtio-net standby (net\_failover)](virtio-net-failover.html)
  + [Direct Linux Boot](linuxboot.html)
  + [Generic Loader](generic-loader.html)
  + [Guest Loader](guest-loader.html)
  + [QEMU Barrier Client](barrier.html)
  + [VNC security](vnc-security.html)
  + [TLS setup for network services](tls.html)
  + [Providing secret data to QEMU](secrets.html)
  + [Client authorization](authz.html)
  + [GDB usage](gdb.html)
  + [Record/replay](replay.html)
  + [Managed start up options](managed-startup.html)
  + [Managing device boot order with bootindex properties](bootindex.html)
  + [Virtual CPU hotplug](cpu-hotplug.html)
  + [Persistent reservation managers](pr-manager.html)
  + [QEMU System Emulator Targets](targets.html)
  + Security
    - [Overview](#overview)
    - [Security Requirements](#security-requirements)
      * [Virtualization Use Case](#virtualization-use-case)
      * [Non-virtualization Use Case](#non-virtualization-use-case)
    - [Architecture](#architecture)
      * [Guest Isolation](#guest-isolation)
      * [Principle of Least Privilege](#principle-of-least-privilege)
      * [Isolation mechanisms](#isolation-mechanisms)
    - [Sensitive configurations](#sensitive-configurations)
      * [Monitor console (QMP and HMP)](#monitor-console-qmp-and-hmp)
  + [Multi-process QEMU](multi-process.html)
  + [Confidential Guest Support](confidential-guest-support.html)
  + [QEMU VM templating](vm-templating.html)
* [User Mode Emulation](../user/index.html)
* [Tools](../tools/index.html)
* [System Emulation Management and Interoperability](../interop/index.html)
* [System Emulation Guest Hardware Specifications](../specs/index.html)
* [Developer Information](../devel/index.html)

[QEMU](../index.html)

* [System Emulation](index.html)
* Security
* [View page source](https://gitlab.com/qemu-project/qemu/-/blob/master/docs/system/security.rst)

---

# Security[](#security "Permalink to this heading")

## Overview[](#overview "Permalink to this heading")

This chapter explains the security requirements that QEMU is designed to meet
and principles for securely deploying QEMU.

## Security Requirements[](#security-requirements "Permalink to this heading")

QEMU supports many different use cases, some of which have stricter security
requirements than others. The community has agreed on the overall security
requirements that users may depend on. These requirements define what is
considered supported from a security perspective.

### Virtualization Use Case[](#virtualization-use-case "Permalink to this heading")

The virtualization use case covers cloud and virtual private server (VPS)
hosting, as well as traditional data center and desktop virtualization. These
use cases rely on hardware virtualization extensions to execute guest code
safely on the physical CPU at close-to-native speed.

The following entities are untrusted, meaning that they may be buggy or
malicious:

* Guest
* User-facing interfaces (e.g. VNC, SPICE, WebSocket)
* Network protocols (e.g. NBD, live migration)
* User-supplied files (e.g. disk images, kernels, device trees)
* Passthrough devices (e.g. PCI, USB)

Bugs affecting these entities are evaluated on whether they can cause damage in
real-world use cases and treated as security bugs if this is the case.

### Non-virtualization Use Case[](#non-virtualization-use-case "Permalink to this heading")

The non-virtualization use case covers emulation using the Tiny Code Generator
(TCG). In principle the TCG and device emulation code used in conjunction with
the non-virtualization use case should meet the same security requirements as
the virtualization use case. However, for historical reasons much of the
non-virtualization use case code was not written with these security
requirements in mind.

Bugs affecting the non-virtualization use case are not considered security
bugs at this time. Users with non-virtualization use cases must not rely on
QEMU to provide guest isolation or any security guarantees.

## Architecture[](#architecture "Permalink to this heading")

This section describes the design principles that ensure the security
requirements are met.

### Guest Isolation[](#guest-isolation "Permalink to this heading")

Guest isolation is the confinement of guest code to the virtual machine. When
guest code gains control of execution on the host this is called escaping the
virtual machine. Isolation also includes resource limits such as throttling of
CPU, memory, disk, or network. Guests must be unable to exceed their resource
limits.

QEMU presents an attack surface to the guest in the form of emulated devices.
The guest must not be able to gain control of QEMU. Bugs in emulated devices
could allow malicious guests to gain code execution in QEMU. At this point the
guest has escaped the virtual machine and is able to act in the context of the
QEMU process on the host.

Guests often interact with other guests and share resources with them. A
malicious guest must not gain control of other guests or access their data.
Disk image files and network traffic must be protected from other guests unless
explicitly shared between them by the user.

### Principle of Least Privilege[](#principle-of-least-privilege "Permalink to this heading")

The principle of least privilege states that each component only has access to
the privileges necessary for its function. In the case of QEMU this means that
each process only has access to resources belonging to the guest.

The QEMU process should not have access to any resources that are inaccessible
to the guest. This way the guest does not gain anything by escaping into the
QEMU process since it already has access to those same resources from within
the guest.

Following the principle of least privilege immediately fulfills guest isolation
requirements. For example, guest A only has access to its own disk image file
`a.img` and not guest B’s disk image file `b.img`.

In reality certain resources are inaccessible to the guest but must be
available to QEMU to perform its function. For example, host system calls are
necessary for QEMU but are not exposed to guests. A guest that escapes into
the QEMU process can then begin invoking host system calls.

New features must be designed to follow the principle of least privilege.
Should this not be possible for technical reasons, the security risk must be
clearly documented so users are aware of the trade-off of enabling the feature.

### Isolation mechanisms[](#isolation-mechanisms "Permalink to this heading")

Several isolation mechanisms are available to realize this architecture of
guest isolation and the principle of least privilege. With the exception of
Linux seccomp, these mechanisms are all deployed by management tools that
launch QEMU, such as libvirt. They are also platform-specific so they are only
described briefly for Linux here.

The fundamental isolation mechanism is that QEMU processes must run as
unprivileged users. Sometimes it seems more convenient to launch QEMU as
root to give it access to host devices (e.g. `/dev/net/tun`) but this poses a
huge security risk. File descriptor passing can be used to give an otherwise
unprivileged QEMU process access to host devices without running QEMU as root.
It is also possible to launch QEMU as a non-root user and configure UNIX groups
for access to `/dev/kvm`, `/dev/net/tun`, and other device nodes.
Some Linux distros already ship with UNIX groups for these devices by default.

* SELinux and AppArmor make it possible to confine processes beyond the
  traditional UNIX process and file permissions model. They restrict the QEMU
  process from accessing processes and files on the host system that are not
  needed by QEMU.
* Resource limits and cgroup controllers provide throughput and utilization
  limits on key resources such as CPU time, memory, and I/O bandwidth.
* Linux namespaces can be used to make process, file system, and other system
  resources unavailable to QEMU. A namespaced QEMU process is restricted to only
  those resources that were granted to it.
* Linux seccomp is available via the QEMU `--sandbox` option. It disables
  system calls that are not needed by QEMU, thereby reducing the host kernel
  attack surface.

## Sensitive configurations[](#sensitive-configurations "Permalink to this heading")

There are aspects of QEMU that can have security implications which users &
management applications must be aware of.

### Monitor console (QMP and HMP)[](#monitor-console-qmp-and-hmp "Permalink to this heading")

The monitor console (whether used with QMP or HMP) provides an interface
to dynamically control many aspects of QEMU’s runtime operation. Many of the
commands exposed will instruct QEMU to access content on the host file system
and/or trigger spawning of external processes.

For example, the `migrate` command allows for the spawning of arbitrary
processes for the purpose of tunnelling the migration data stream. The
`blockdev-add` command instructs QEMU to open arbitrary files, exposing
their content to the guest as a virtual disk.

Unless QEMU is otherwise confined using technologies such as SELinux, AppArmor,
or Linux namespaces, the monitor console should be considered to have privileges
equivalent to those of the user account QEMU is running under.

It is further important to consider the security of the character device backend
over which the monitor console is exposed. It needs to have protection against
malicious third parties which might try to make unauthorized connections, or
perform man-in-the-middle attacks. Many of the character device backends do not
satisfy this requirement and so must not be used for the monitor console.

The general recommendation is that the monitor console should be exposed over
a UNIX domain socket backend to the local host only. Use of the TCP based
character device backend is inappropriate unless configured to use both TLS
encryption and authorization control policy on client connections.

In summary, the monitor console is considered a privileged control interface to
QEMU and as such should only be made accessible to a trusted management
application or user.

 [Previous](target-xtensa.html "Xtensa System emulator")
[Next](multi-process.html "Multi-process QEMU")

---

© Copyright 2025, The QEMU Project Developers.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).

This documentation is for QEMU version 9.2.50.

[QEMU and this manual are released under the
GNU General Public License, version 2.](../about/license.html)



=== Content from github.com_3c5ca1fb_20250114_230150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=qemu%2Fqemu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[qemu](/qemu)
/
**[qemu](/qemu/qemu)**
Public

* [Notifications](/login?return_to=%2Fqemu%2Fqemu) You must be signed in to change notification settings
* [Fork
  5.7k](/login?return_to=%2Fqemu%2Fqemu)
* [Star
   10.7k](/login?return_to=%2Fqemu%2Fqemu)

* [Code](/qemu/qemu)
* [Pull requests
  0](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects
  0](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

Additional navigation options

* [Code](/qemu/qemu)
* [Pull requests](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

## Commit

[Permalink](/qemu/qemu/commit/3517fb726741c109cae7995f9ea46f0cab6187d6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

target/loongarch: Clean up tlb when cpu reset

[Browse files](/qemu/qemu/tree/3517fb726741c109cae7995f9ea46f0cab6187d6)
Browse the repository at this point in the history

```
We should make sure that tlb is clean when cpu reset.

Signed-off-by: Song Gao <gaosong@loongson.cn>
Message-Id: <20220705070950.2364243-1-gaosong@loongson.cn>
Reviewed-by: Richard Henderson <richard.henderson@linaro.org>
Signed-off-by: Richard Henderson <richard.henderson@linaro.org>
```

* Loading branch information

[![@gaosong-loongson](https://avatars.githubusercontent.com/u/84619582?s=40&v=4)](/gaosong-loongson) [![@rth7680](https://avatars.githubusercontent.com/u/2529319?s=40&v=4)](/rth7680)

[gaosong-loongson](/qemu/qemu/commits?author=gaosong-loongson "View all commits by gaosong-loongson")
authored and
[rth7680](/qemu/qemu/commits?author=rth7680 "View all commits by rth7680")
committed
Jul 5, 2022

1 parent
[c1ca312](/qemu/qemu/commit/c1ca312a6f035adad6558f44e6a3bc9ddeeed4b0)

commit 3517fb7

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[target/loongarch/cpu.c](#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fc "target/loongarch/cpu.c")

Show comments

[View file](/qemu/qemu/blob/3517fb726741c109cae7995f9ea46f0cab6187d6/target/loongarch/cpu.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -479,6 +479,7 @@ static void loongarch\_cpu\_reset(DeviceState \*dev) |
|  |  |  |
|  |  | #ifndef CONFIG\_USER\_ONLY |
|  |  | env->pc = 0x1c000000; |
|  |  | memset(env->tlb, 0, sizeof(env->tlb)); |
|  |  | #endif |
|  |  |  |
|  |  | restore\_fp\_status(env); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3517fb7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gitlab.com_2fd1f979_20250114_230154.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# cputlb: uninitialized local variable in tlb\_set\_page\_with\_attrs cause SIGSEGV when a CPU access an unmapped IOMMU page

## Host environment

* Operating system: Any
* OS/kernel version: Any
* Architecture: Any
* QEMU flavor: qemu-system
* QEMU version:QEMU emulator version 7.0.0 (v6.2.0-3146-g7e0e865ad5-dirty)

## Emulated/Virtualized environment

* Architecture: TCG-based

## Description of problem

When a TCG cpu accesses an unmapped page within an IOMMU region that causes a translation fault, QEMU SIGSEGVs in `io_readx`.
The reason was that in `address_space_translate_for_iotlb`, `xlat` is not set on a permission fault.
As a result, `xlat` in `tlb_set_page_with_attr` is uninitialized. This in turn causes various mis-calculation and eventually crashes in `io_readx`.

## Suggested fix

I would suggest setting `*xlat = addr` before the for loop in `address_space_translate_for_iotlb` so that if the translation fail, we can still have a guest error log that shows a meaningful address.

Edited Jun 07, 2022 by [TrungNguyen1909](/TrungNguyen1909)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from github.com_aa8549b5_20250114_230151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=qemu%2Fqemu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[qemu](/qemu)
/
**[qemu](/qemu/qemu)**
Public

* [Notifications](/login?return_to=%2Fqemu%2Fqemu) You must be signed in to change notification settings
* [Fork
  5.7k](/login?return_to=%2Fqemu%2Fqemu)
* [Star
   10.7k](/login?return_to=%2Fqemu%2Fqemu)

* [Code](/qemu/qemu)
* [Pull requests
  0](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects
  0](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

Additional navigation options

* [Code](/qemu/qemu)
* [Pull requests](/qemu/qemu/pulls)
* [Actions](/qemu/qemu/actions)
* [Projects](/qemu/qemu/projects)
* [Security](/qemu/qemu/security)
* [Insights](/qemu/qemu/pulse)

## Commit

[Permalink](/qemu/qemu/commit/3517fb726741c109cae7995f9ea46f0cab6187d6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

target/loongarch: Clean up tlb when cpu reset

[Browse files](/qemu/qemu/tree/3517fb726741c109cae7995f9ea46f0cab6187d6)
Browse the repository at this point in the history

```
We should make sure that tlb is clean when cpu reset.

Signed-off-by: Song Gao <gaosong@loongson.cn>
Message-Id: <20220705070950.2364243-1-gaosong@loongson.cn>
Reviewed-by: Richard Henderson <richard.henderson@linaro.org>
Signed-off-by: Richard Henderson <richard.henderson@linaro.org>
```

* Loading branch information

[![@gaosong-loongson](https://avatars.githubusercontent.com/u/84619582?s=40&v=4)](/gaosong-loongson) [![@rth7680](https://avatars.githubusercontent.com/u/2529319?s=40&v=4)](/rth7680)

[gaosong-loongson](/qemu/qemu/commits?author=gaosong-loongson "View all commits by gaosong-loongson")
authored and
[rth7680](/qemu/qemu/commits?author=rth7680 "View all commits by rth7680")
committed
Jul 5, 2022

1 parent
[c1ca312](/qemu/qemu/commit/c1ca312a6f035adad6558f44e6a3bc9ddeeed4b0)

commit 3517fb7

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[target/loongarch/cpu.c](#diff-83c563ed6330dc5d49876f1116e7518b5c16654bbc6e9b4ea8e28f5833d576fc "target/loongarch/cpu.c")

Show comments

[View file](/qemu/qemu/blob/3517fb726741c109cae7995f9ea46f0cab6187d6/target/loongarch/cpu.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -479,6 +479,7 @@ static void loongarch\_cpu\_reset(DeviceState \*dev) |
|  |  |  |
|  |  | #ifndef CONFIG\_USER\_ONLY |
|  |  | env->pc = 0x1c000000; |
|  |  | memset(env->tlb, 0, sizeof(env->tlb)); |
|  |  | #endif |
|  |  |  |
|  |  | restore\_fp\_status(env); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3517fb7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fqemu%2Fqemu%2Fcommit%2F3517fb726741c109cae7995f9ea46f0cab6187d6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_c98311a9_20250114_230154.html ===


---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)]
[[Thread Prev](msg00007.html)][[Thread Next](msg00009.html)]
[[Date Index](maillist.html#00008)]
[[Thread Index](threads.html#00008)]

# [SECURITY] [DLA 3099-1] qemu security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3099-1] qemu security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Mon, 5 Sep 2022 08:58:05 +0530
* *Message-id*: <YxVsxXlWx/Sdg4MV@debian.org>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3099-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
September 05, 2022                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : qemu
Version        : 1:3.1+dfsg-8+deb10u9
CVE ID         : CVE-2020-13253 CVE-2020-15469 CVE-2020-15859 CVE-2020-25084
                 CVE-2020-25085 CVE-2020-25624 CVE-2020-25625 CVE-2020-25723
                 CVE-2020-27617 CVE-2020-27821 CVE-2020-28916 CVE-2020-29129
                 CVE-2020-29443 CVE-2020-35504 CVE-2020-35505 CVE-2021-3392
                 CVE-2021-3416 CVE-2021-3507 CVE-2021-3527 CVE-2021-3582
                 CVE-2021-3607 CVE-2021-3608 CVE-2021-3682 CVE-2021-3713
                 CVE-2021-3748 CVE-2021-3930 CVE-2021-4206 CVE-2021-4207
                 CVE-2021-20181 CVE-2021-20196 CVE-2021-20203 CVE-2021-20221
                 CVE-2021-20257 CVE-2022-26354 CVE-2022-35414

Multiple security issues were discovered in QEMU, a fast processor
emulator, which could result in denial of service or the the execution
of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:3.1+dfsg-8+deb10u9.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmMVbMUACgkQhj1N8u2c
KO+N6w//XuvPOvMxGsDw3swppKApkL1ECz7NC1L4xRouPyHhh0JZrqwovd5miY6M
mmIq2zeurtEVhf6kkhw1NP3ywrfgURyf7RhpcLN3z/o8aqjLoxL6fIJGzv9URulC
6xDpu1n5mKTI/EX8Zeqy9ks3+HgHNAg9jr5s5TWIYlJLhhlYvrvMbUAeM04V8Zaw
XGXJj0Jx1f83CMFVNXDJ6shBzfUZII3taZIjUFcME5DUFNxaG8492nYisRcwlDNy
Z1AOGbhehZlgbk5t4cX2kOMq/qp9EiAqrBUZgqXtT+zCRBr4hQjK5OOmaq69p4N5
RsS8MA3/Rtvt9b3xuNXnDy28O50yvlQJK9GJa/p8KM894pn2fMTu3pxFVAn4xIsp
umcx4LbxSYaBDygtK81xhxK3ODfakR8YGmXUffeRasPw/mFncdN9kTxCvuSgdoUO
rgqcmJ+D38JAzV+ALjEnMZkrGYzscM6GzKHA5DR37qmdG/JNNKpqy3TRWBpNY4ZL
QYmAIW5MvCx3SEgZBeAkUwPpfam6d3DwKm7RUvmvL5ul/UDcyowYRCpZGwgtyL57
8N3yu0V9IA0L04yuiUcd9RE3qXGsFQU7YvzpB7hEj2WQIV2i9LDb+5D2qnUJmdCR
+dCiSgxf0qi14Rbhv9gZ4/jCAC4fWHHGuyCO4ySyLVmDgtgBpQo=
=EhD5
-----END PGP SIGNATURE-----

```

---


