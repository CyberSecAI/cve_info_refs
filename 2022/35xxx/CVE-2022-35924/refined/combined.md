=== Content from next-auth.js.org_57ba067f_20250115_101959.html ===

Skip to main contentNextAuth.js is becoming Auth.js! 🎉 We're creating Authentication for the Web. Everyone included. You are looking at the NextAuth.js (v4) documentation. For the new documentation go to [authjs.dev](https://authjs.dev).[![NextAuth Logo](/img/logo/logo-xs.png)![NextAuth Logo](/img/logo/logo-xs.png)**NextAuth.js**](/)[Documentation](/getting-started/introduction)[Tutorials](/tutorials)[FAQ](/faq)[Security](/security)[v4](/getting-started/introduction)

* [v4](/providers/email)
* [v3](/v3/providers/email)
* [All Releases](https://github.com/nextauthjs/next-auth/releases)
[npm](https://www.npmjs.com/package/next-auth)[GitHub](https://github.com/nextauthjs/next-auth)Search

* [Getting Started](/getting-started/introduction)
  + [Introduction](/getting-started/introduction)
  + [Getting Started](/getting-started/example)
  + [Client API](/getting-started/client)
  + [REST API](/getting-started/rest-api)
  + [TypeScript](/getting-started/typescript)
  + [Upgrade Guide (v4)](/getting-started/upgrade-v4)
* [Configuration](/configuration/initialization)
* [Providers](/providers/)
  + [42 School](/providers/42-school)
  + [Apple](/providers/apple)
  + [Atlassian](/providers/atlassian)
  + [Auth0](/providers/auth0)
  + [Authentik](/providers/authentik)
  + [Azure Active Directory B2C](/providers/azure-ad-b2c)
  + [Azure Active Directory](/providers/azure-ad)
  + [Battle.net](/providers/battle.net)
  + [Box](/providers/box)
  + [BoxyHQ SAML](/providers/boxyhq-saml)
  + [Bungie](/providers/bungie)
  + [Amazon Cognito](/providers/cognito)
  + [Coinbase](/providers/coinbase)
  + [Credentials](/providers/credentials)
  + [Discord](/providers/discord)
  + [Dropbox](/providers/dropbox)
  + [DuendeIdentityServer6](/providers/duende-identityserver6)
  + [Email](/providers/email)
  + [EVE Online](/providers/eveonline)
  + [Facebook](/providers/facebook)
  + [FACEIT](/providers/faceit)
  + [Foursquare](/providers/foursquare)
  + [Freshbooks](/providers/freshbooks)
  + [FusionAuth](/providers/fusionauth)
  + [GitHub](/providers/github)
  + [GitLab](/providers/gitlab)
  + [Google](/providers/google)
  + [HubSpot](/providers/hubspot)
  + [IdentityServer4](/providers/identity-server4)
  + [Overview](/providers/)
  + [Instagram](/providers/instagram)
  + [Kakao](/providers/kakao)
  + [Keycloak](/providers/keycloak)
  + [LINE](/providers/line)
  + [LinkedIn](/providers/linkedin)
  + [Mailchimp](/providers/mailchimp)
  + [Mail.ru](/providers/mailru)
  + [Medium](/providers/medium)
  + [Naver](/providers/naver)
  + [Netlify](/providers/netlify)
  + [Okta](/providers/okta)
  + [OneLogin](/providers/onelogin)
  + [Osso](/providers/osso)
  + [osu!](/providers/osu)
  + [Patreon](/providers/patreon)
  + [Pinterest](/providers/pinterest)
  + [Pipedrive](/providers/pipedrive)
  + [Reddit](/providers/reddit)
  + [Salesforce](/providers/salesforce)
  + [Slack](/providers/slack)
  + [Spotify](/providers/spotify)
  + [Strava](/providers/strava)
  + [Todoist](/providers/todoist)
  + [Trakt](/providers/trakt)
  + [Twitch](/providers/twitch)
  + [Twitter](/providers/twitter)
  + [United Effects](/providers/united-effects)
  + [VK](/providers/vk)
  + [Wikimedia](/providers/wikimedia)
  + [WordPress.com](/providers/wordpress)
  + [WorkOS](/providers/workos)
  + [Yandex](/providers/yandex)
  + [Zitadel](/providers/zitadel)
  + [Zoho](/providers/zoho)
  + [Zoom](/providers/zoom)
* [Adapters](/adapters)
* [Warnings](/warnings)
* [Errors](/errors)
* [Deployment](/deployment)
* [Guides](/guides/)
* SponsoredLooking for a
  hosted alternative?[Try Clerk →](https://go.clerk.com/DefS1u4)

* [Providers](/providers/)
* Email
Version: v4On this page
# Email

## Overview[​](#overview "Direct link to heading")

The Email provider uses email to send "magic links" that can be used to sign in, you will likely have seen these if you have used services like Slack before.

Adding support for signing in via email in addition to one or more OAuth services provides a way for users to sign in if they lose access to their OAuth account (e.g. if it is locked or deleted).

The Email provider can be used in conjunction with (or instead of) one or more OAuth providers.

### How it works[​](#how-it-works "Direct link to heading")

On initial sign in, a **Verification Token** is sent to the email address provided. By default this token is valid for 24 hours. If the Verification Token is used within that time (i.e. by clicking on the link in the email) an account is created for the user and they are signed in.

If someone provides the email address of an *existing account* when signing in, an email is sent and they are signed into the account associated with that email address when they follow the link in the email.

tip

The Email Provider can be used with both JSON Web Tokens and database sessions, but you **must** configure a database to use it. It is not possible to enable email sign in without using a database.

## Options[​](#options "Direct link to heading")

The **Email Provider** comes with a set of default options:

* [Email Provider options](https://github.com/nextauthjs/next-auth/blob/v4/packages/next-auth/src/providers/email.ts)

You can override any of the options to suit your own use case.

## Configuration[​](#configuration "Direct link to heading")

NextAuth.js lets you send emails either via HTTP or SMTP.

### HTTP[​](#http "Direct link to heading")

Check out our [HTTP-based Email Provider](https://authjs.dev/guides/configuring-http-email) guide.

### SMTP[​](#smtp "Direct link to heading")

1. NextAuth.js does not include `nodemailer` as a dependency, so you'll need to install it yourself if you want to use the Email Provider. Run `npm install nodemailer` or `yarn add nodemailer`.
2. You will need an SMTP account; ideally for one of the [services known to work with `nodemailer`](https://community.nodemailer.com/2-0-0-beta/setup-smtp/well-known-services/).
3. There are two ways to configure the SMTP server connection.

You can either use a connection string or a `nodemailer` configuration object or transport.

2.1 **Using a connection string**

Create an `.env` file to the root of your project and add the connection string and email address.

.env
```
    EMAIL_SERVER=smtp://username:password@smtp.example.com:587
    EMAIL_FROM=noreply@example.com

```

Now you can add the email provider like this:

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: process.env.EMAIL_SERVER,
    from: process.env.EMAIL_FROM
  }),
],

```

2.2 **Using a configuration object**

In your `.env` file in the root of your project simply add the configuration object options individually:

.env
```
EMAIL_SERVER_USER=username
EMAIL_SERVER_PASSWORD=password
EMAIL_SERVER_HOST=smtp.example.com
EMAIL_SERVER_PORT=587
EMAIL_FROM=noreply@example.com

```

Now you can add the provider settings to the NextAuth.js options object in the Email Provider.

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: {
      host: process.env.EMAIL_SERVER_HOST,
      port: process.env.EMAIL_SERVER_PORT,
      auth: {
        user: process.env.EMAIL_SERVER_USER,
        pass: process.env.EMAIL_SERVER_PASSWORD
      }
    },
    from: process.env.EMAIL_FROM
  }),
],

```

3. Do not forget to setup one of the database [adapters](https://authjs.dev/getting-started/database) for storing the Email verification token.
4. You can now sign in with an email address at `/api/auth/signin`.

A user account (i.e. an entry in the Users table) will not be created for the user until the first time they verify their email address. If an email address is already associated with an account, the user will be signed in to that account when they use the link in the email.

## Customizing emails[​](#customizing-emails "Direct link to heading")

You can fully customize the sign in email that is sent by passing a custom function as the `sendVerificationRequest` option to `EmailProvider()`.

e.g.

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: process.env.EMAIL_SERVER,
    from: process.env.EMAIL_FROM,
    sendVerificationRequest({
      identifier: email,
      url,
      provider: { server, from },
    }) {
      /* your function */
    },
  }),
]

```

The following code shows the complete source for the built-in `sendVerificationRequest()` method:

```
import { createTransport } from "nodemailer"

async function sendVerificationRequest(params) {
  const { identifier, url, provider, theme } = params
  const { host } = new URL(url)
  // NOTE: You are not required to use `nodemailer`, use whatever you want.
  const transport = createTransport(provider.server)
  const result = await transport.sendMail({
    to: identifier,
    from: provider.from,
    subject: `Sign in to ${host}`,
    text: text({ url, host }),
    html: html({ url, host, theme }),
  })
  const failed = result.rejected.concat(result.pending).filter(Boolean)
  if (failed.length) {
    throw new Error(`Email(s) (${failed.join(", ")}) could not be sent`)
  }
}

/**
 * Email HTML body
 * Insert invisible space into domains from being turned into a hyperlink by email
 * clients like Outlook and Apple mail, as this is confusing because it seems
 * like they are supposed to click on it to sign in.
 *
 * @note We don't add the email address to avoid needing to escape it, if you do, remember to sanitize it!
 */
function html(params: { url: string, host: string, theme: Theme }) {
  const { url, host, theme } = params

  const escapedHost = host.replace(/\./g, "&#8203;.")

  const brandColor = theme.brandColor || "#346df1"
  const color = {
    background: "#f9f9f9",
    text: "#444",
    mainBackground: "#fff",
    buttonBackground: brandColor,
    buttonBorder: brandColor,
    buttonText: theme.buttonText || "#fff",
  }

  return `
<body style="background: ${color.background};">
  <table width="100%" border="0" cellspacing="20" cellpadding="0"
    style="background: ${color.mainBackground}; max-width: 600px; margin: auto; border-radius: 10px;">
    <tr>
      <td align="center"
        style="padding: 10px 0px; font-size: 22px; font-family: Helvetica, Arial, sans-serif; color: ${color.text};">
        Sign in to <strong>${escapedHost}</strong>
      </td>
    </tr>
    <tr>
      <td align="center" style="padding: 20px 0;">
        <table border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td align="center" style="border-radius: 5px;" bgcolor="${color.buttonBackground}"><a href="${url}"
                target="_blank"
                style="font-size: 18px; font-family: Helvetica, Arial, sans-serif; color: ${color.buttonText}; text-decoration: none; border-radius: 5px; padding: 10px 20px; border: 1px solid ${color.buttonBorder}; display: inline-block; font-weight: bold;">Sign
                in</a></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td align="center"
        style="padding: 0px 0px 10px 0px; font-size: 16px; line-height: 22px; font-family: Helvetica, Arial, sans-serif; color: ${color.text};">
        If you did not request this email you can safely ignore it.
      </td>
    </tr>
  </table>
</body>
`
}

/** Email Text body (fallback for email clients that don't render HTML, e.g. feature phones) */
function text({ url, host }: { url: string, host: string }) {
  return `Sign in to ${host}\n${url}\n\n`
}

```
tip

If you want to generate great looking email client compatible HTML with React, check out <https://mjml.io>

## Customizing the Verification Token[​](#customizing-the-verification-token "Direct link to heading")

By default, we are generating a random verification token. You can define a `generateVerificationToken` method in your provider options if you want to override it:

pages/api/auth/[...nextauth].js
```
providers: [
  EmailProvider({
    async generateVerificationToken() {
      return "ABC123"
    }
  })
],

```
## Normalizing the email address[​](#normalizing-the-email-address "Direct link to heading")

By default, NextAuth.js will normalize the email address. It treats values as case-insensitive (which is technically not compliant to the [RFC 2821 spec](https://datatracker.ietf.org/doc/html/rfc2821), but in practice this causes more problems than it solves, eg. when looking up users by e-mail from databases.) and also removes any secondary email address that was passed in as a comma-separated list. You can apply your own normalization via the `normalizeIdentifier` method on the `EmailProvider`. The following example shows the default behavior:

```
EmailProvider({
  // ...
  normalizeIdentifier(identifier: string): string {
    // Get the first two elements only,
    // separated by `@` from user input.
    let [local, domain] = identifier.toLowerCase().trim().split("@")
    // The part before "@" can contain a ","
    // but we remove it on the domain part
    domain = domain.split(",")[0]
    return `${local}@${domain}`

    // You can also throw an error, which will redirect the user
    // to the error page with error=EmailSignin in the URL
    // if (identifier.split("@").length > 2) {
    //   throw new Error("Only one email allowed")
    // }
  },
})

```
danger

Always make sure this returns a single e-mail address, even if multiple ones were passed in.

## Sending Magic Links To Existing Users[​](#sending-magic-links-to-existing-users "Direct link to heading")

You can ensure that only existing users are sent a magic login link. You will need to grab the email the user entered and check your database to see if the email already exists in the "User" collection in your database. If it exists, it will send the user a magic link but otherwise, you can send the user to another page, such as "/register".

pages/api/auth/[...nextauth].js
```
import User from "../../../models/User";
import db from "../../../utils/db";
...
callbacks: {
  async signIn({ user, account, email }) {
    await db.connect();
    const userExists = await User.findOne({
      email: user.email,  //the user object has an email property, which contains the email the user entered.
    });
    if (userExists) {
      return true;   //if the email exists in the User collection, email them a magic login link
    } else {
      return "/register";
    }
  },
 ...

```
[Edit this page](https://github.com/nextauthjs/next-auth/edit/v4/docs/docs/providers/email.md)Last updated on **Oct 24, 2024** by **Balázs Orbán**[PreviousDuendeIdentityServer6](/providers/duende-identityserver6)[NextEVE Online](/providers/eveonline)

* [Overview](#overview)
  + [How it works](#how-it-works)
* [Options](#options)
* [Configuration](#configuration)
  + [HTTP](#http)
  + [SMTP](#smtp)
* [Customizing emails](#customizing-emails)
* [Customizing the Verification Token](#customizing-the-verification-token)
* [Normalizing the email address](#normalizing-the-email-address)
* [Sending Magic Links To Existing Users](#sending-magic-links-to-existing-users)
About NextAuth.js

* [Introduction](/getting-started/introduction)
Download

* [GitHub](https://github.com/nextauthjs/next-auth)
* [NPM](https://www.npmjs.com/package/next-auth)
Acknowledgements

* [Contributors](/contributors)
* [Sponsors](/sponsors)
* [Images by unDraw](https://undraw.co/)
NextAuth.js © Iain Collins 2025



=== Content from github.com_6434d93d_20250115_101954.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fcommit%2Fafb1fcdae3cc30445038ef588e491d139b916003)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fcommit%2Fafb1fcdae3cc30445038ef588e491d139b916003)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=nextauthjs%2Fnext-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextauthjs](/nextauthjs)
/
**[next-auth](/nextauthjs/next-auth)**
Public

* [Notifications](/login?return_to=%2Fnextauthjs%2Fnext-auth) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)
* [Star
   25.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)

* [Code](/nextauthjs/next-auth)
* [Issues
  309](/nextauthjs/next-auth/issues)
* [Pull requests
  100](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects
  0](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

Additional navigation options

* [Code](/nextauthjs/next-auth)
* [Issues](/nextauthjs/next-auth/issues)
* [Pull requests](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

## Commit

[Permalink](/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix(providers): add `normalizeIdentifier` to EmailProvider

[Browse files](/nextauthjs/next-auth/tree/afb1fcdae3cc30445038ef588e491d139b916003)
Browse the repository at this point in the history

```
* fix(providers): add `normalizeIdentifier` to EmailProvider

* docs: document `normalizeIdentifier`

* fix: allow throwing error from normalizer

* test: add e-mail tests

* chore: log provider id

* test: merge client+config jest configs and add coverage report

* test: show coverage for untested files

* fix: only allow first domain in email. Add tests

* chore: add `coverage` to tsconfig exclude list

* cleanup

* revert

Co-authored-by: Thang Vu <thvu@hey.com>
```

* Loading branch information

[![@balazsorban44](https://avatars.githubusercontent.com/u/18369201?s=40&v=4)](/balazsorban44) [![@ThangHuuVu](https://avatars.githubusercontent.com/u/31528554?s=40&v=4)](/ThangHuuVu)

[balazsorban44](/nextauthjs/next-auth/commits?author=balazsorban44 "View all commits by balazsorban44")
and
[ThangHuuVu](/nextauthjs/next-auth/commits?author=ThangHuuVu "View all commits by ThangHuuVu")
committed
Aug 1, 2022

1 parent
[a21db89](/nextauthjs/next-auth/commit/a21db8950f7a0c3e568faf69cb236f21e65fa42f)

commit afb1fcd

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**301 additions**
and
**66 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/docs/providers

  + docs/docs/providers/email.md
    [email.md](#diff-9fd2bdabe5f31e886e0bf09cc1c2bb21f2acff4a8d779ea428ac21e9bc844bf8)
* packages/next-auth

  + config

    - packages/next-auth/config/jest.client.config.js
      [jest.client.config.js](#diff-59d0f76cbb9a31ae171e5d062a5e37e820990f2fa05eac8a6e018176043445c9)
    - packages/next-auth/config/jest.config.js
      [jest.config.js](#diff-bb4b8e217af06dcd0d554c41b04d51dcce04e12f29ff1d9d75265761ea8a3c5b)
    - packages/next-auth/config/jest.core.config.js
      [jest.core.config.js](#diff-5a0be29e51483dbe2aa4acaba282d94d8df47a70eff36013f873c2e181b7ec7b)
  + packages/next-auth/package.json
    [package.json](#diff-24e3e5d8c67633fc56fa6283e74b1e6c0792e832efb1adce14e1bb8e7cc3ed22)
  + src

    - core

      * lib/email

        + packages/next-auth/src/core/lib/email/signin.ts
          [signin.ts](#diff-72ce0597eb9a0c57656adacb95ae106ec868f9577bee1832519b4897f1cb5c76)
      * routes

        + packages/next-auth/src/core/routes/signin.ts
          [signin.ts](#diff-6a7efa6186a272beb387ed043cc3deed13326bbe69da4eb3dc8d8b9549e4ebd0)
    - providers

      * packages/next-auth/src/providers/email.ts
        [email.ts](#diff-1264518d917ff39a9d7362665d98f20c8cdd39803b3e6739316d6944145b62e7)
  + tests

    - packages/next-auth/tests/email.test.ts
      [email.test.ts](#diff-6e0abe4205b8cefd15b75b369cfaa74251ebc08d6311245d3aa9ed5977274d2a)
    - packages/next-auth/tests/getServerSession.test.ts
      [getServerSession.test.ts](#diff-67ff8a02daffcca10cbdbfa21d07f40be4924171da4618e095afbdd7b6315ca9)
    - packages/next-auth/tests/lib.ts
      [lib.ts](#diff-cb85764bc4823e2b21b7b1f00c53f20005fc8d4747f70338903c0fea22e89590)
  + packages/next-auth/tsconfig.json
    [tsconfig.json](#diff-ec9d297cd691c19c93ef70c6b898af7fe4492c165099e79117a367c519976347)

## There are no files selected for viewing

28 changes: 28 additions & 0 deletions

28
[docs/docs/providers/email.md](#diff-9fd2bdabe5f31e886e0bf09cc1c2bb21f2acff4a8d779ea428ac21e9bc844bf8 "docs/docs/providers/email.md")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/docs/docs/providers/email.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -223,3 +223,31 @@ providers: [ |
|  |  | }) |
|  |  | ], |
|  |  | ``` |
|  |  |  |
|  |  | ## Normalizing the email address |
|  |  |  |
|  |  | By default, NextAuth.js will normalize the email address. It treats values as case-insensitive (which is technically not compliant to the [RFC 2821 spec](https://datatracker.ietf.org/doc/html/rfc2821), but in practice this causes more problems than it solves, eg. when looking up users by e-mail from databases.) and also removes any secondary email address that was passed in as a comma-separated list. You can apply your own normalization via the `normalizeIdentifier` method on the `EmailProvider`. The following example shows the default behavior: |
|  |  | ```ts |
|  |  | EmailProvider({ |
|  |  | // ... |
|  |  | normalizeIdentifier(identifier: string): string { |
|  |  | // Get the first two elements only, |
|  |  | // separated by `@` from user input. |
|  |  | let [local, domain] = identifier.toLowerCase().trim().split("@") |
|  |  | // The part before "@" can contain a "," |
|  |  | // but we remove it on the domain part |
|  |  | domain = domain.split(",")[0] |
|  |  | return `${local}@${domain}` |
|  |  |  |
|  |  | // You can also throw an error, which will redirect the user |
|  |  | // to the error page with error=EmailSignin in the URL |
|  |  | // if (identifier.split("@").length > 2) { |
|  |  | // throw new Error("Only one email allowed") |
|  |  | // } |
|  |  | }, |
|  |  | }) |
|  |  | ``` |
|  |  |  |
|  |  | :::warning |
|  |  | Always make sure this returns a single e-mail address, even if multiple ones were passed in. |
|  |  | ::: |

16 changes: 0 additions & 16 deletions

16
[packages/next-auth/config/jest.client.config.js](#diff-59d0f76cbb9a31ae171e5d062a5e37e820990f2fa05eac8a6e018176043445c9 "packages/next-auth/config/jest.client.config.js")

Show comments

[View file](/nextauthjs/next-auth/blob/a21db8950f7a0c3e568faf69cb236f21e65fa42f/packages/next-auth/config/jest.client.config.js)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

34 changes: 34 additions & 0 deletions

34
[packages/next-auth/config/jest.config.js](#diff-bb4b8e217af06dcd0d554c41b04d51dcce04e12f29ff1d9d75265761ea8a3c5b "packages/next-auth/config/jest.config.js")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/packages/next-auth/config/jest.config.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,34 @@ |
|  |  | /\*\* @type {import('jest').Config} \*/ |
|  |  | module.exports = { |
|  |  | projects: [ |
|  |  | { |
|  |  | displayName: "core", |
|  |  | testMatch: ["\*\*/\*.test.ts"], |
|  |  | rootDir: ".", |
|  |  | setupFilesAfterEnv: ["./config/jest-setup.js"], |
|  |  | transform: { |
|  |  | "\\.(js|jsx|ts|tsx)$": ["@swc/jest", require("./swc.config")], |
|  |  | }, |
|  |  | coveragePathIgnorePatterns: ["tests"], |
|  |  | }, |
|  |  | { |
|  |  | displayName: "client", |
|  |  | testMatch: ["\*\*/\*.test.js"], |
|  |  | setupFilesAfterEnv: ["./config/jest-setup.js"], |
|  |  | rootDir: ".", |
|  |  | transform: { |
|  |  | "\\.(js|jsx|ts|tsx)$": ["@swc/jest", require("./swc.config")], |
|  |  | }, |
|  |  | testEnvironment: "jsdom", |
|  |  | coveragePathIgnorePatterns: ["\_\_tests\_\_"], |
|  |  | }, |
|  |  | ], |
|  |  | watchPlugins: [ |
|  |  | "jest-watch-typeahead/filename", |
|  |  | "jest-watch-typeahead/testname", |
|  |  | ], |
|  |  | collectCoverage: true, |
|  |  | coverageDirectory: "../coverage", |
|  |  | coverageReporters: ["html", "text-summary"], |
|  |  | collectCoverageFrom: ["src/\*\*/\*.(js|jsx|ts|tsx)"], |
|  |  | } |

13 changes: 0 additions & 13 deletions

13
[packages/next-auth/config/jest.core.config.js](#diff-5a0be29e51483dbe2aa4acaba282d94d8df47a70eff36013f873c2e181b7ec7b "packages/next-auth/config/jest.core.config.js")

Show comments

[View file](/nextauthjs/next-auth/blob/a21db8950f7a0c3e568faf69cb236f21e65fa42f/packages/next-auth/config/jest.core.config.js)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

4 changes: 1 addition & 3 deletions

4
[packages/next-auth/package.json](#diff-24e3e5d8c67633fc56fa6283e74b1e6c0792e832efb1adce14e1bb8e7cc3ed22 "packages/next-auth/package.json")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/packages/next-auth/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -42,9 +42,7 @@ |
|  |  | "build:js": "pnpm clean && pnpm generate-providers && tsc && babel --config-file ./config/babel.config.js src --out-dir . --extensions \".tsx,.ts,.js,.jsx\"", |
|  |  | "build:css": "postcss --config config/postcss.config.js src/\*\*/\*.css --base src --dir . && node config/wrap-css.js", |
|  |  | "watch:css": "postcss --config config/postcss.config.js --watch src/\*\*/\*.css --base src --dir .", |
|  |  | "test:client": "jest --config ./config/jest.client.config.js", |
|  |  | "test:core": "jest --config ./config/jest.core.config.js", |
|  |  | "test": "pnpm test:core && pnpm test:client", |
|  |  | "test": "jest --config ./config/jest.config.js", |
|  |  | "prepublishOnly": "pnpm build", |
|  |  | "generate-providers": "node ./config/generate-providers.js", |
|  |  | "setup": "pnpm generate-providers", |
| Expand Down | |  |

35 changes: 18 additions & 17 deletions

35
[packages/next-auth/src/core/lib/email/signin.ts](#diff-72ce0597eb9a0c57656adacb95ae106ec868f9577bee1832519b4897f1cb5c76 "packages/next-auth/src/core/lib/email/signin.ts")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/packages/next-auth/src/core/lib/email/signin.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,27 +21,28 @@ export default async function email( |
|  |  | Date.now() + (provider.maxAge ?? ONE\_DAY\_IN\_SECONDS) \* 1000 |
|  |  | ) |
|  |  |  |
|  |  | // Save in database |
|  |  | // @ts-expect-error |
|  |  | await adapter.createVerificationToken({ |
|  |  | identifier, |
|  |  | token: hashToken(token, options), |
|  |  | expires, |
|  |  | }) |
|  |  |  |
|  |  | // Generate a link with email, unhashed token and callback url |
|  |  | const params = new URLSearchParams({ callbackUrl, token, email: identifier }) |
|  |  | const \_url = `${url}/callback/${provider.id}?${params}` |
|  |  |  |
|  |  | // Send to user |
|  |  | await provider.sendVerificationRequest({ |
|  |  | identifier, |
|  |  | token, |
|  |  | expires, |
|  |  | url: \_url, |
|  |  | provider, |
|  |  | theme, |
|  |  | }) |
|  |  | await Promise.all([ |
|  |  | // Send to user |
|  |  | provider.sendVerificationRequest({ |
|  |  | identifier, |
|  |  | token, |
|  |  | expires, |
|  |  | url: \_url, |
|  |  | provider, |
|  |  | theme, |
|  |  | }), |
|  |  | // Save in database |
|  |  | // @ts-expect-error // verified in `assertConfig` |
|  |  | adapter.createVerificationToken({ |
|  |  | identifier, |
|  |  | token: hashToken(token, options), |
|  |  | expires, |
|  |  | }), |
|  |  | ]) |
|  |  |  |
|  |  | return `${url}/verify-request?${new URLSearchParams({ |
|  |  | provider: provider.id, |
| Expand Down | |  |

33 changes: 20 additions & 13 deletions

33
[packages/next-auth/src/core/routes/signin.ts](#diff-6a7efa6186a272beb387ed043cc3deed13326bbe69da4eb3dc8d8b9549e4ebd0 "packages/next-auth/src/core/routes/signin.ts")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/packages/next-auth/src/core/routes/signin.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,16 +33,26 @@ export default async function signin(params: { |
|  |  | return { redirect: `${url}/error?error=OAuthSignin` } |
|  |  | } |
|  |  | } else if (provider.type === "email") { |
|  |  | /\*\* |
|  |  | \* @note Technically the part of the email address local mailbox element |
|  |  | \* (everything before the @ symbol) should be treated as 'case sensitive' |
|  |  | \* according to RFC 2821, but in practice this causes more problems than |
|  |  | \* it solves. We treat email addresses as all lower case. If anyone |
|  |  | \* complains about this we can make strict RFC 2821 compliance an option. |
|  |  | \*/ |
|  |  | const email = body?.email?.toLowerCase() |
|  |  |  |
|  |  | let email: string = body?.email |
|  |  | if (!email) return { redirect: `${url}/error?error=EmailSignin` } |
|  |  | const normalizer: (identifier: string) => string = |
|  |  | provider.normalizeIdentifier ?? |
|  |  | ((identifier) => { |
|  |  | // Get the first two elements only, |
|  |  | // separated by `@` from user input. |
|  |  | let [local, domain] = identifier.toLowerCase().trim().split("@") |
|  |  | // The part before "@" can contain a "," |
|  |  | // but we remove it on the domain part |
|  |  | domain = domain.split(",")[0] |
|  |  | return `${local}@${domain}` |
|  |  | }) |
|  |  |  |
|  |  | try { |
|  |  | email = normalizer(body?.email) |
|  |  | } catch (error) { |
|  |  | logger.error("SIGNIN\_EMAIL\_ERROR", { error, providerId: provider.id }) |
|  |  | return { redirect: `${url}/error?error=EmailSignin` } |
|  |  | } |
|  |  |  |
|  |  | // Verified in `assertConfig` |
|  |  | // eslint-disable-next-line @typescript-eslint/no-non-null-assertion |
| Expand Down  Expand Up | | @@ -85,10 +95,7 @@ export default async function signin(params: { |
|  |  | const redirect = await emailSignin(email, options) |
|  |  | return { redirect } |
|  |  | } catch (error) { |
|  |  | logger.error("SIGNIN\_EMAIL\_ERROR", { |
|  |  | error: error as Error, |
|  |  | providerId: provider.id, |
|  |  | }) |
|  |  | logger.error("SIGNIN\_EMAIL\_ERROR", { error, providerId: provider.id }) |
|  |  | return { redirect: `${url}/error?error=EmailSignin` } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

17 changes: 16 additions & 1 deletion

17
[packages/next-auth/src/providers/email.ts](#diff-1264518d917ff39a9d7362665d98f20c8cdd39803b3e6739316d6944145b62e7 "packages/next-auth/src/providers/email.ts")

Show comments

[View file](/nextauthjs/next-auth/blob/afb1fcdae3cc30445038ef588e491d139b916003/packages/next-auth/src/providers/email.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,21 @@ export interface EmailConfig extends CommonProviderOptions { |
|  |  | generateVerificationToken?: () => Awaitable<string> |
|  |  | /\*\* If defined, it is used to hash the verification token when saving to the database . \*/ |
|  |  | secret?: string |
|  |  | /\*\* |
|  |  | \* Normalizes the user input before sending the verification request. |
|  |  | \* |
|  |  | \* ⚠️ Always make sure this method returns a single email address. |
|  |  | \* |
|  |  | \* @note Technically, the part of the email address local mailbox element |
|  |  | \* (everything before the `@` symbol) should be treated as 'case sensitive' |
|  |  | \* according to RFC 2821, but in practice this causes more problems than |
|  |  | \* it solves, e.g.: when looking up users by e-mail from databases. |
|  |  | \* By default, we treat email addresses as all lower case, |
|  |  | \* but you can override this function to change this behavior. |
|  |  | \* |
|  |  | \* [Documentation](https://next-auth.js.org/providers/email#normalizing-the-e-mail-address) | [RFC 2821](https://tools.ietf.org/html/rfc2821) | [Email syntax](https://en.wikipedia.org/wiki/Email\_address#Syntax) |
|  |  | \*/ |
|  |  | normalizeIdentifier?: (identifier: string) => string |
|  |  | options: EmailUserConfig |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -79,7 +94,7 @@ export default function Email(options: EmailUserConfig): EmailConfig { |
|  |  | }) |
|  |  | const failed = result.rejected.concat(result.pending).filter(Boolean) |
|  |  | if (failed.length) { |
|  |  | throw new Error(`Email(s) (${failed.join(", ")}) could not be sent`) |
|  |  | throw new Error(`Email (${failed.join(", ")}) could not be sent`) |
|  |  | } |
|  |  | }, |
|  |  | options, |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `afb1fcd`

[![@vercel](https://avatars.githubusercontent.com/in/8329?s=80&v=4)](/apps/vercel)

Copy link

### @vercel **[vercel](/apps/vercel) bot** commented on `[afb1fcd](/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003)` [Aug 1, 2022](#commitcomment-79933883)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Successfully deployed to the following URLs:

## next-auth – ./

[next-auth-git-main-nextauthjs.vercel.app](https://next-auth-git-main-nextauthjs.vercel.app)

[next-auth-nextauthjs.vercel.app](https://next-auth-nextauthjs.vercel.app)

[next-auth-phi-two.vercel.app](https://next-auth-phi-two.vercel.app)

[www.next-auth.js.org](https://www.next-auth.js.org)

[next-auth.js.org](https://next-auth.js.org)

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fcommit%2Fafb1fcdae3cc30445038ef588e491d139b916003) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_13622044_20250115_101956.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fsecurity%2Fadvisories%2FGHSA-xv97-c62v-4587)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnextauthjs%2Fnext-auth%2Fsecurity%2Fadvisories%2FGHSA-xv97-c62v-4587)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nextauthjs%2Fnext-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nextauthjs](/nextauthjs)
/
**[next-auth](/nextauthjs/next-auth)**
Public

* [Notifications](/login?return_to=%2Fnextauthjs%2Fnext-auth) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)
* [Star
   25.6k](/login?return_to=%2Fnextauthjs%2Fnext-auth)

* [Code](/nextauthjs/next-auth)
* [Issues
  309](/nextauthjs/next-auth/issues)
* [Pull requests
  100](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects
  0](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

Additional navigation options

* [Code](/nextauthjs/next-auth)
* [Issues](/nextauthjs/next-auth/issues)
* [Pull requests](/nextauthjs/next-auth/pulls)
* [Discussions](/nextauthjs/next-auth/discussions)
* [Actions](/nextauthjs/next-auth/actions)
* [Projects](/nextauthjs/next-auth/projects)
* [Security](/nextauthjs/next-auth/security)
* [Insights](/nextauthjs/next-auth/pulse)

# Sending verification requests (magic link) to unwanted emails

Critical

[balazsorban44](/balazsorban44)
published
GHSA-xv97-c62v-4587
Aug 2, 2022

## Package

npm

next-auth
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<4.10.3, <3.29.10

## Patched versions

4.10.3, 3.29.10

## Description

### Impact

`next-auth` users who are using the `EmailProvider` either in versions before `4.10.3` or `3.29.10` are affected.

If an attacker could forge a request that sent a comma-separated list of emails (eg.: `attacker@attacker.com,victim@victim.com`) to the sign-in endpoint, NextAuth.js would send emails to both the attacker and the victim's e-mail addresses. The attacker could then login as a newly created user with the email being `attacker@attacker.com,victim@victim.com`. This means that basic authorization like `email.endsWith("@victim.com")` in the `signIn` callback would fail to communicate a threat to the developer and would let the attacker bypass authorization, even with an `@attacker.com` address.

### Patches

We patched this vulnerability in `v4.10.3` and `v3.29.10` by normalizing the email value that is sent to the sign-in endpoint before accessing it anywhere else. We also added a `normalizeIdentifier` callback on the `EmailProvider` configuration, where you can further tweak your requirements for what your system considers a valid e-mail address. (E.g.: strict RFC2821 compliance)

To upgrade, run one of the following:

```
npm i next-auth@latest
```

```
yarn add next-auth@latest
```

```
pnpm add next-auth@latest
```

(This will update to the latest v4 version, but you can change `latest` to `3` if you want to stay on v3. This is not recommended. v3 is unmaintained.)

### Workarounds

If for some reason you cannot upgrade, you can normalize the incoming request like the following, using Advanced Initialization:

```
// pages/api/auth/[...nextauth].ts

function normalize(identifier) {
  // Get the first two elements only,
  // separated by `@` from user input.
  let [local, domain] = identifier.toLowerCase().trim().split("@")
  // The part before "@" can contain a ","
  // but we remove it on the domain part
  domain = domain.split(",")[0]
  return `${local}@${domain}`
}

export default async function handler(req, res) {
  if (req.body.email) req.body.email = normalize(req.body.email)
  return await NextAuth(req, res, {/* your options */ })
}
```
### References

* EmailProvider: <https://next-auth.js.org/providers/email>
* Normalize the email address: <https://next-auth.js.org/providers/email#normalizing-the-email-address>
* Email syntax: <https://en.wikipedia.org/wiki/Email_address#Local-part>
* `signIn` callback: <https://next-auth.js.org/configuration/callbacks#sign-in-callback>
* Advanced Initialization: <https://next-auth.js.org/configuration/initialization#advanced-initialization>
* `nodemailer` address: <https://nodemailer.com/message/addresses>

### For more information

If you have any concerns, we request responsible disclosure, outlined here: <https://next-auth.js.org/security#reporting-a-vulnerability>

### Timeline

The issue was reported 26th of July, a response was sent out in less than 1 hour and after identifying the issue a patch was published within 5 working days.

### Acknowledgments

We would like to thank [Socket](https://socket.dev) for disclosing this vulnerability in a responsible manner and following up until it got published.

### Severity

Critical

9.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

### CVE ID

CVE-2022-35924

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### Credits

* [![@feross](https://avatars.githubusercontent.com/u/121766?s=40&v=4)](/feross)
  [feross](/feross)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from en.wikipedia.org_77f94d32_20250115_101950.html ===
[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Contents](/wiki/Wikipedia%3AContents "Guides to browsing Wikipedia")
* [Current events](/wiki/Portal%3ACurrent_events "Articles related to current events")
* [Random article](/wiki/Special%3ARandom "Visit a randomly selected article [x]")
* [About Wikipedia](/wiki/Wikipedia%3AAbout "Learn about Wikipedia and how it works")
* [Contact us](//en.wikipedia.org/wiki/Wikipedia%3AContact_us "How to contact Wikipedia")

Contribute

* [Help](/wiki/Help%3AContents "Guidance on how to use and edit Wikipedia")
* [Learn to edit](/wiki/Help%3AIntroduction "Learn how to edit Wikipedia")
* [Community portal](/wiki/Wikipedia%3ACommunity_portal "The hub for editors")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes to Wikipedia [r]")
* [Upload file](/wiki/Wikipedia%3AFile_upload_wizard "Add images or other media for use on Wikipedia")

[![](/static/images/icons/wikipedia.png)
![Wikipedia](/static/images/mobile/copyright/wikipedia-wordmark-en.svg)
![The Free Encyclopedia](/static/images/mobile/copyright/wikipedia-tagline-en.svg)](/wiki/Main_Page)

[Search](/wiki/Special%3ASearch "Search Wikipedia [f]")

Search

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Email+address "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Email+address "You're encouraged to log in; however, it's not mandatory. [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Email+address "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Email+address "You're encouraged to log in; however, it's not mandatory. [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* (Top)
* [1
  Message transport](#Message_transport)
* [2
  Syntax](#Syntax)

  Toggle Syntax subsection
  + [2.1
    Local-part](#Local-part)
    - [2.1.1
      Sub-addressing](#Sub-addressing)
  + [2.2
    Domain](#Domain)
  + [2.3
    Examples](#Examples)
    - [2.3.1
      Valid email addresses](#Valid_email_addresses)
    - [2.3.2
      Valid email addresses with SMTPUTF8](#Valid_email_addresses_with_SMTPUTF8)
    - [2.3.3
      Invalid email addresses](#Invalid_email_addresses)
* [3
  Validation and verification](#Validation_and_verification)
* [4
  Internationalization](#Internationalization)
* [5
  See also](#See_also)
* [6
  References](#References)
* [7
  Further reading](#Further_reading)
* [8
  External links](#External_links)

Toggle the table of contents

# Email address

26 languages

* [العربية](https://ar.wikipedia.org/wiki/%D8%B9%D9%86%D9%88%D8%A7%D9%86_%D8%A8%D8%B1%D9%8A%D8%AF_%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A "عنوان بريد إلكتروني – Arabic")
* [Čeština](https://cs.wikipedia.org/wiki/E-mailov%C3%A1_adresa "E-mailová adresa – Czech")
* [Dansk](https://da.wikipedia.org/wiki/E-mailadresse "E-mailadresse – Danish")
* [Deutsch](https://de.wikipedia.org/wiki/E-Mail-Adresse "E-Mail-Adresse – German")
* [Esperanto](https://eo.wikipedia.org/wiki/Retpo%C5%9Dtadreso "Retpoŝtadreso – Esperanto")
* [فارسی](https://fa.wikipedia.org/wiki/%D8%B1%D8%A7%DB%8C%D8%A7%D9%86%D8%B4%D8%A7%D9%86%DB%8C "رایانشانی – Persian")
* [Français](https://fr.wikipedia.org/wiki/Adresse_%C3%A9lectronique "Adresse électronique – French")
* [한국어](https://ko.wikipedia.org/wiki/%EC%A0%84%EC%9E%90_%EC%9A%B0%ED%8E%B8_%EC%A3%BC%EC%86%8C "전자 우편 주소 – Korean")
* [Hrvatski](https://hr.wikipedia.org/wiki/E-adresa "E-adresa – Croatian")
* [Bahasa Indonesia](https://id.wikipedia.org/wiki/Alamat_surel "Alamat surel – Indonesian")
* [Íslenska](https://is.wikipedia.org/wiki/Netfang "Netfang – Icelandic")
* [Latviešu](https://lv.wikipedia.org/wiki/Elektronisk%C4%81_pasta_adrese "Elektroniskā pasta adrese – Latvian")
* [മലയാളം](https://ml.wikipedia.org/wiki/%E0%B4%87-%E0%B4%AE%E0%B5%86%E0%B4%AF%E0%B4%BF%E0%B5%BD_%E0%B4%B5%E0%B4%BF%E0%B4%B2%E0%B4%BE%E0%B4%B8%E0%B4%82 "ഇ-മെയിൽ വിലാസം – Malayalam")
* [Bahasa Melayu](https://ms.wikipedia.org/wiki/Alamat_e-mel "Alamat e-mel – Malay")
* [日本語](https://ja.wikipedia.org/wiki/%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9 "メールアドレス – Japanese")
* [Олык марий](https://mhr.wikipedia.org/wiki/%D0%AD%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD_%D0%BF%D0%BE%D1%87%D1%82%D0%BE_%D0%B0%D0%B4%D1%80%D0%B5%D1%81 "Электрон почто адрес – Eastern Mari")
* [Polski](https://pl.wikipedia.org/wiki/Adres_poczty_elektronicznej "Adres poczty elektronicznej – Polish")
* [Русский](https://ru.wikipedia.org/wiki/%D0%90%D0%B4%D1%80%D0%B5%D1%81_%D1%8D%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9_%D0%BF%D0%BE%D1%87%D1%82%D1%8B "Адрес электронной почты – Russian")
* [Slovenčina](https://sk.wikipedia.org/wiki/Elektronick%C3%A1_adresa "Elektronická adresa – Slovak")
* [کوردی](https://ckb.wikipedia.org/wiki/%D9%86%D8%A7%D9%88%D9%86%DB%8C%D8%B4%D8%A7%D9%86%DB%8C_%D8%A6%DB%8C%D9%85%DB%95%DB%8C%DA%B5 "ناونیشانی ئیمەیڵ – Central Kurdish")
* [Suomi](https://fi.wikipedia.org/wiki/S%C3%A4hk%C3%B6postiosoite "Sähköpostiosoite – Finnish")
* [Українська](https://uk.wikipedia.org/wiki/%D0%90%D0%B4%D1%80%D0%B5%D1%81%D0%B0_%D0%B5%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D1%97_%D0%BF%D0%BE%D1%88%D1%82%D0%B8 "Адреса електронної пошти – Ukrainian")
* [اردو](https://ur.wikipedia.org/wiki/%D8%A8%D8%B1%D9%82%DB%8C_%DA%88%D8%A7%DA%A9_%D9%BE%D8%AA%DB%81 "برقی ڈاک پتہ – Urdu")
* [Wolof](https://wo.wikipedia.org/wiki/M%C3%A0kkaanum_mb%C3%ABjfeppal "Màkkaanum mbëjfeppal – Wolof")
* [粵語](https://zh-yue.wikipedia.org/wiki/%E9%9B%BB%E9%83%B5%E5%9C%B0%E5%9D%80 "電郵地址 – Cantonese")
* [中文](https://zh.wikipedia.org/wiki/%E9%9B%BB%E5%AD%90%E9%83%B5%E4%BB%B6%E5%9C%B0%E5%9D%80 "電子郵件地址 – Chinese")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q1273217#sitelinks-wikipedia "Edit interlanguage links")

* [Article](/wiki/Email_address "View the content page [c]")
* [Talk](/wiki/Talk%3AEmail_address "Discuss improvements to the content page [t]")

English

* [Read](/wiki/Email_address)
* [Edit](/w/index.php?title=Email_address&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Email_address&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/Email_address)
* [Edit](/w/index.php?title=Email_address&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Email_address&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/Email_address "List of all English Wikipedia pages containing links to this page [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Email_address "Recent changes in pages linked from this page [k]")
* [Upload file](/wiki/Wikipedia%3AFile_Upload_Wizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=Email_address&oldid=1268156000 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Email_address&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=Email_address&id=1268156000&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEmail_address)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEmail_address)

Print/export

* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=Email_address&action=show-download-screen "Download this page as a PDF file")
* [Printable version](/w/index.php?title=Email_address&printable=yes "Printable version of this page [p]")

In other projects

* [Wikimedia Commons](https://commons.wikimedia.org/wiki/Category%3AEmail_address)
* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q1273217 "Structured data on this page hosted by Wikidata [g]")

Appearance
move to sidebar
hide

From Wikipedia, the free encyclopedia

Identifier of the destination where email messages are delivered

An **email address** identifies an [email](/wiki/Email "Email") box to which messages are delivered. While early messaging systems used a variety of formats for addressing, today, email addresses follow a set of specific rules originally standardized by the [Internet Engineering Task Force](/wiki/Internet_Engineering_Task_Force "Internet Engineering Task Force") (IETF) in the 1980s, and updated by [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [5322](https://datatracker.ietf.org/doc/html/rfc5322) and [6854](https://datatracker.ietf.org/doc/html/rfc6854). The term email address in this article refers to just the *addr-spec* in Section 3.4 of RFC [5322](https://datatracker.ietf.org/doc/html/rfc5322). The RFC defines *address* more broadly as either a *mailbox* or *group*. A *mailbox* value can be either a *name-addr*, which contains a *display-name* and *addr-spec*, or the more common *addr-spec* alone.

An email address, such as *john.smith@example.com*, is made up from a [local-part](#Local-part), the symbol @, and a *[domain](#Domain)*, which may be a [domain name](/wiki/Domain_name "Domain name") or an [IP address](/wiki/IP_address "IP address") enclosed in brackets. Although the standard requires the local-part to be case-sensitive,[[1]](#cite_note-1) it also urges that receiving hosts deliver messages in a case-independent manner,[[2]](#cite_note-2) e.g., that the mail system in the domain *example.com* treat *John.Smith* as equivalent to *john.smith*; some mail systems even treat them as equivalent to *johnsmith*.[[3]](#cite_note-3) Mail systems often limit the users' choice of name to a subset of the technically permitted characters; with the introduction of [internationalized domain names](/wiki/Internationalized_domain_name "Internationalized domain name"), efforts are progressing to permit non-[ASCII](/wiki/ASCII "ASCII") characters in email addresses.

Due to the ubiquity of email in today's world, email addresses are often used as regular [usernames](/wiki/Usernames "Usernames") by many websites and services that provide a user profile or account.[[4]](#cite_note-4) For example, if a user wants to login to their [Xbox Live](/wiki/Xbox_Live "Xbox Live") video gaming profile, they would use their [Microsoft account](/wiki/Microsoft_account "Microsoft account") in the form of an email address as the username ID, even though the service in this case is not email.

## Message transport

[[edit](/w/index.php?title=Email_address&action=edit&section=1 "Edit section: Message transport")]

An email address consists of two parts, a local-part (sometimes a user name, but not always) and a domain; if the domain is a domain name rather than an IP address then the SMTP client uses the domain name to look up the mail exchange IP address. The general format of an email address is *local-part*@*domain*, e.g. jsmith@[192.168.1.2], *jsmith@example.com*. The SMTP client transmits the message to the mail exchange, which may forward it to another mail exchange until it eventually arrives at the host of the recipient's mail system.

The transmission of electronic mail from the author's computer and between mail hosts in the Internet uses the [Simple Mail Transfer Protocol](/wiki/Simple_Mail_Transfer_Protocol "Simple Mail Transfer Protocol") (SMTP), defined in [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [5321](https://datatracker.ietf.org/doc/html/rfc5321) and [5322](https://datatracker.ietf.org/doc/html/rfc5322), and extensions such as [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [6531](https://datatracker.ietf.org/doc/html/rfc6531). The mailboxes may be accessed and managed by applications on personal computers, mobile devices or [webmail](/wiki/Webmail "Webmail") sites, using the [SMTP](/wiki/SMTP "SMTP") protocol and either the [Post Office Protocol](/wiki/Post_Office_Protocol "Post Office Protocol") (POP) or the [Internet Message Access Protocol](/wiki/Internet_Message_Access_Protocol "Internet Message Access Protocol") (IMAP).

When [transmitting email messages](/wiki/Simple_Mail_Transfer_Protocol#Mail_processing_model "Simple Mail Transfer Protocol"), [mail user agents](/wiki/Mail_user_agent "Mail user agent") (MUAs) and [mail transfer agents](/wiki/Mail_transfer_agent "Mail transfer agent") (MTAs) use the [domain name system](/wiki/Domain_name_system "Domain name system") (DNS) to look up a [Resource Record](/wiki/Domain_Name_System#DNS_resource_records "Domain Name System") (RR) for the recipient's domain. A mail exchanger resource record ([MX record](/wiki/MX_record "MX record")) contains the name of the recipient's mailserver. In absence of an MX record, an address record ([A](/wiki/A_record "A record") or [AAAA](/wiki/AAAA_record "AAAA record")) directly specifies the mail host.

The local-part of an email address has no significance for intermediate mail relay systems other than the final mailbox host. Email senders and intermediate relay systems must not assume it to be case-insensitive, since the final mailbox host may or may not treat it as such. A single mailbox may receive mail for multiple email addresses, if configured by the administrator. Conversely, a single email address may be the alias to a distribution list to many mailboxes. [Email aliases](/wiki/Email_alias "Email alias"), [electronic mailing lists](/wiki/Electronic_mailing_list "Electronic mailing list"), [sub-addressing](#Sub-addressing), and [catch-all](/wiki/Email_filtering "Email filtering") addresses, the latter being mailboxes that receive messages regardless of the local-part, are common patterns for achieving a variety of delivery goals.

The addresses found in the header fields of an email message are not directly used by mail exchanges to deliver the message. An email message also contains a message envelope that contains the information for mail routing. While envelope and header addresses may be equal, [forged email](/wiki/Email_spoofing "Email spoofing") addresses (also called *spoofed email addresses*) are often seen in [spam](/wiki/Email_spam "Email spam"), [phishing](/wiki/Phishing "Phishing"), and many other Internet-based scams. This has led to several initiatives which aim to make such forgeries of fraudulent emails easier to spot.

## Syntax

[[edit](/w/index.php?title=Email_address&action=edit&section=2 "Edit section: Syntax")]

The format of an email address is *local-part@domain*, where the local-part may be up to 64 [octets](/wiki/Octet_%28computing%29 "Octet (computing)") long and the [domain](/wiki/Domain_name "Domain name") may have a maximum of 255 octets.[[5]](#cite_note-5) The formal definitions are in RFC 5322 (sections 3.2.3 and 3.4.1) and RFC 5321—with a more readable form given in the informational RFC 3696 (written by J. Klensin, the author of RFC [5321](https://datatracker.ietf.org/doc/html/rfc5321)) and the associated errata.

An email address also may have an associated "display-name" (Display Name) for the recipient, which precedes the address specification, now surrounded by angled brackets, for example: *John Smith <john.smith@example.org>*.[[6]](#cite_note-6) Email spammers and phishers will often use "Display Name spoofing" to trick their victims, by using a false Display Name, or by using a different email address as the Display Name.[[7]](#cite_note-7)

Earlier forms of [email addresses for other networks than the Internet](/wiki/Non-Internet_email_address "Non-Internet email address") included other notations, such as that required by [X.400](/wiki/X.400 "X.400"), and the [UUCP](/wiki/UUCP "UUCP") *[bang path](/wiki/Bang_path "Bang path")* notation, in which the address was given in the form of a sequence of computers through which the message should be relayed. This was widely used for several years, but was superseded by the Internet standards promulgated by the [Internet Engineering Task Force](/wiki/Internet_Engineering_Task_Force "Internet Engineering Task Force") (IETF).

### Local-part

[[edit](/w/index.php?title=Email_address&action=edit&section=3 "Edit section: Local-part")]

The local-part of the email address may be unquoted or may be enclosed in quotation marks.

If unquoted, it may use any of these [ASCII](/wiki/ASCII "ASCII") characters:

* uppercase and lowercase [Latin](/wiki/Basic_Latin_%28Unicode_block%29 "Basic Latin (Unicode block)") letters `A` to `Z` and `a` to `z`
* digits `0` to `9`
* printable characters `!#$%&'*+-/=?^_`{|}~`
* dot `.`, provided that it is not the first or last character and provided also that it does not appear consecutively (e.g., `John..Doe@example.com` is not allowed).[[8]](#cite_note-rfc3696-8)

If quoted, it may contain Space, Horizontal Tab (HT), any ASCII graphic except Backslash and Quote and a quoted-pair consisting of a Backslash followed by HT, Space or any ASCII graphic; it may also be split between lines anywhere that HT or Space appears. In contrast to unquoted local-parts, the addresses `".John.Doe"@example.com`, `"John.Doe."@example.com` and `"John..Doe"@example.com` are allowed.

The maximum total length of the local-part of an email address is 64 octets.[[9]](#cite_note-rfc5321-9)

* Space and special characters `"(),:;<>@[\]` are allowed with restrictions (they are only allowed inside a quoted string, as described in the paragraph below, and in that quoted string, any backslash or double-quote must be preceded once by a backslash);
* Comments are allowed with parentheses at either end of the local-part; e.g., `john.smith(comment)@example.com` and `(comment)john.smith@example.com` are both equivalent to `john.smith@example.com`.

In addition to the above ASCII characters, international characters above U+007F, encoded as [UTF-8](/wiki/UTF-8 "UTF-8"), are permitted by RFC 6531 when the [EHLO](/wiki/Simple_Mail_Transfer_Protocol#Extension_discovery_mechanism "Simple Mail Transfer Protocol") specifies [SMTPUTF8](/wiki/Simple_Mail_Transfer_Protocol#SMTPUTF8 "Simple Mail Transfer Protocol"), though even mail systems that support SMTPUTF8 and 8BITMIME may restrict which characters to use when assigning local-parts.

A local-part is either a Dot-string or a Quoted-string; it cannot be a combination. Quoted strings and characters, however, are not commonly used.[*[citation needed](/wiki/Wikipedia%3ACitation_needed "Wikipedia:Citation needed")*] RFC 5321 also warns that "a host that expects to receive mail SHOULD avoid defining mailboxes where the Local-part requires (or uses) the Quoted-string form".

The local-part `postmaster` is treated specially—it is case-insensitive, and should be forwarded to the domain email administrator. Technically all other local-parts are case-sensitive, therefore `johns@example.com` and `JohnS@example.com` specify different mailboxes; however, many organizations treat uppercase and lowercase letters as equivalent. Indeed, RFC 5321 warns that "a host that expects to receive mail SHOULD avoid defining mailboxes where ... the Local-part is case-sensitive".

Despite the wide range of special characters which are technically valid, organisations, mail services, mail servers and mail clients in practice often do not accept all of them. For example, [Windows Live Hotmail](/wiki/Windows_Live_Hotmail "Windows Live Hotmail") only allows creation of email addresses using alphanumerics, dot (`.`), underscore (`_`) and hyphen (`-`).[[10]](#cite_note-10) Common advice is to avoid using some special characters to avoid the risk of rejected emails.[[11]](#cite_note-11)

According to RFC 5321 2.3.11 *Mailbox and Address,* "the local-part MUST be interpreted and assigned semantics only by the host specified in the domain of the address". This means that no assumptions can be made about the meaning of the local-part of another mail server. It is entirely up to the configuration of the mail server.

Interpretation of the local-part is dependent on the conventions and policies implemented in the mail server. For example, [case sensitivity](/wiki/Case_sensitivity "Case sensitivity") may distinguish mailboxes differing only in capitalization of characters of the local-part, although this is not very common.[[12]](#cite_note-12) For example, [Gmail](/wiki/Gmail "Gmail") ignores all dots in the local-part of a *@gmail.com* address for the purposes of determining account identity.[[13]](#cite_note-13)

#### Sub-addressing

[[edit](/w/index.php?title=Email_address&action=edit&section=4 "Edit section: Sub-addressing")]

Some mail services support a tag included in the local-part, such that the address is an alias to a prefix of the local-part. Typically the characters following a plus and less often the characters following a minus, so fred+bah@domain and fred+foo@domain might end up in the same inbox as fred+@domain or even as fred@domain. For example, the address *joeuser+tag@example.com* denotes the same delivery address as *joeuser@example.com*. [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [5233](https://datatracker.ietf.org/doc/html/rfc5233)[[14]](#cite_note-14) refers to this convention as *subaddressing*, but it is also known as *plus addressing*, *tagged addressing* or *mail extensions*. This can be useful for tagging emails for sorting, and for spam control.[[15]](#cite_note-Gmail-15)

Addresses of this form, using various separators between the base name and the tag, are supported by several email services, including [Andrew Project](/wiki/Andrew_Project "Andrew Project") (plus),[[16]](#cite_note-16) Runbox (plus),[[17]](#cite_note-17) [Gmail](/wiki/Gmail "Gmail") (plus),[[15]](#cite_note-Gmail-15) [Rackspace](/wiki/Rackspace "Rackspace") (plus), [Yahoo! Mail](/wiki/Yahoo%21_Mail "Yahoo! Mail") Plus (hyphen),[[18]](#cite_note-18) Apple's [iCloud](/wiki/ICloud "ICloud") (plus), [Outlook.com](/wiki/Outlook.com "Outlook.com") (plus),[[19]](#cite_note-19) [Mailfence](/wiki/Mailfence "Mailfence") (plus),[[20]](#cite_note-20) [Proton Mail](/wiki/Proton_Mail "Proton Mail") (plus),[[21]](#cite_note-21) [Fastmail](/wiki/Fastmail "Fastmail") (plus and Subdomain Addressing),[[22]](#cite_note-22) postale.io (plus),[[23]](#cite_note-23) Pobox (plus),[[24]](#cite_note-24)
MeMail (plus),[[25]](#cite_note-25) and [MTAs](/wiki/Message_transfer_agent "Message transfer agent") like [MMDF](/wiki/MMDF "MMDF") (equals), [Qmail](/wiki/Qmail "Qmail") and [Courier Mail Server](/wiki/Courier_Mail_Server "Courier Mail Server") (hyphen).[[26]](#cite_note-control-26)[[27]](#cite_note-27) [Postfix](/wiki/Postfix_%28software%29 "Postfix (software)") and [Exim](/wiki/Exim "Exim") allow configuring an arbitrary separator from the legal character set.[[28]](#cite_note-28)[[29]](#cite_note-29)

The text of the tag may be used to apply filtering,[[26]](#cite_note-control-26) or to create *single-use*, or [disposable email addresses](/wiki/Disposable_email_address "Disposable email address").[[30]](#cite_note-30)

### Domain

[[edit](/w/index.php?title=Email_address&action=edit&section=5 "Edit section: Domain")]

The [domain name](/wiki/Domain_name "Domain name") part of an email address has to conform to strict guidelines: it must match the requirements for a [hostname](/wiki/Hostname "Hostname"), a list of dot-separated [DNS](/wiki/DNS "DNS") labels, each label being limited to a length of 63 characters and consisting of:[[8]](#cite_note-rfc3696-8): §2

* Uppercase and lowercase [Latin](/wiki/Basic_Latin_%28Unicode_block%29 "Basic Latin (Unicode block)") letters `A` to `Z` and `a` to `z`;
* Digits `0` to `9`, provided that top-level domain names are not all-numeric;
* Hyphen `-`, provided that it is not the first or last character.

This rule is known as the *LDH rule* (letters, digits, hyphen). In addition, the domain may be an [IP address](/wiki/IP_address "IP address") literal, surrounded by square brackets `[]`, such as `jsmith@[192.168.2.1]` or `jsmith@[IPv6:2001:db8::1]`, although this is rarely seen except in [email spam](/wiki/Email_spam "Email spam"). [Internationalized domain names](/wiki/Internationalized_domain_name "Internationalized domain name") (which are encoded to comply with the requirements for a [hostname](/wiki/Hostname "Hostname")) allow for presentation of non-ASCII domains. In mail systems compliant with RFC 6531 and RFC 6532 an email address may be encoded as [UTF-8](/wiki/UTF-8 "UTF-8"), both a local-part as well as a domain name.

Comments are allowed in the domain as well as in the local-part; for example, `john.smith@(comment)example.com` and `john.smith@example.com(comment)` are equivalent to `john.smith@example.com`.

[RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [2606](https://datatracker.ietf.org/doc/html/rfc2606) specifies that certain domains, for example those intended for documentation and testing, should not be resolvable and that as a result mail addressed to mailboxes in them and their subdomains should be non-deliverable. Of note for e-mail are *example*, *invalid*, *example.com*, *example.net*, and *example.org*.

### Examples

[[edit](/w/index.php?title=Email_address&action=edit&section=6 "Edit section: Examples")]
#### Valid email addresses

[[edit](/w/index.php?title=Email_address&action=edit&section=7 "Edit section: Valid email addresses")]

* `simple@example.com`
* `very.common@example.com`
* `FirstName.LastName@EasierReading.org` (case is always ignored after the @ and usually before)
* `x@example.com` (one-letter local-part)
* `long.email-address-with-hyphens@and.subdomains.example.com`
* `user.name+tag+sorting@example.com` (may be routed to `user.name@example.com` inbox depending on mail server)
* `name/surname@example.com` (slashes are a printable character, and allowed)
* `admin@example` (local domain name with no [TLD](/wiki/Top-level_domain "Top-level domain"), although ICANN highly discourages dotless email addresses[[31]](#cite_note-31))
* `example@s.example` (see the [List of Internet top-level domains](/wiki/List_of_Internet_top-level_domains "List of Internet top-level domains"))
* `" "@example.org` (space between the quotes)
* `"john..doe"@example.org` (quoted double dot)
* `mailhost!username@example.org` (bangified host route used for uucp mailers)
* `"very.(),:;<>[]\".VERY.\"very@\\ \"very\".unusual"@strange.example.com` (include non-letters character AND multiple [at sign](/wiki/At_sign "At sign"), the first one being double quoted)
* `user%example.com@example.org` (% escaped mail route to user@example.com via example.org)
* `user-@example.org` (local-part ending with non-alphanumeric character from the list of allowed printable characters)
* `postmaster@[123.123.123.123]` (IP addresses are allowed instead of domains when in square brackets, but strongly discouraged)
* `postmaster@[IPv6:2001:0db8:85a3:0000:0000:8a2e:0370:7334]` (IPv6 uses a different syntax)
* `_test@[IPv6:2001:0db8:85a3:0000:0000:8a2e:0370:7334]` (begin with underscore different syntax)

#### Valid email addresses with SMTPUTF8

[[edit](/w/index.php?title=Email_address&action=edit&section=8 "Edit section: Valid email addresses with SMTPUTF8")]

* `I❤️CHOCOLATE@example.com` ([emoji](/wiki/Emoji "Emoji") are only allowed with SMTPUTF8)

#### Invalid email addresses

[[edit](/w/index.php?title=Email_address&action=edit&section=9 "Edit section: Invalid email addresses")]

* `abc.example.com` (no @ character)
* `a@b@c@example.com` (only one @ is allowed outside quotation marks)
* `a"b(c)d,e:f;g<h>i[j\k]l@example.com` (none of the special characters in this local-part are allowed outside quotation marks)
* `just"not"right@example.com` (quoted strings must be dot separated or be the only element making up the local-part)
* `this is"not\allowed@example.com` (spaces, quotes, and backslashes may only exist when within quoted strings and preceded by a backslash)
* `this\ still\"not\\allowed@example.com` (even if escaped (preceded by a backslash), spaces, quotes, and backslashes must still be contained by quotes)
* `1234567890123456789012345678901234567890123456789012345678901234+x@example.com` (local-part is longer than 64 characters)
* `i.like.underscores@but_they_are_not_allowed_in_this_part` (underscore is not allowed in domain part)

## Validation and verification

[[edit](/w/index.php?title=Email_address&action=edit&section=10 "Edit section: Validation and verification")]

|  | This section **needs additional citations for [verification](/wiki/Wikipedia%3AVerifiability "Wikipedia:Verifiability")**. Please help [improve this article](/wiki/Special%3AEditPage/Email_address "Special:EditPage/Email address") by [adding citations to reliable sources](/wiki/Help%3AReferencing_for_beginners "Help:Referencing for beginners") in this section. Unsourced material may be challenged and removed. *(July 2019)* *([Learn how and when to remove this message](/wiki/Help%3AMaintenance_template_removal "Help:Maintenance template removal"))* |
| --- | --- |

Email addresses are often requested as input to website as validation of user existence. Other validation methods are available, such as cell phone number validation, [postal mail](/wiki/Postal_mail "Postal mail") validation, and fax validation.

An email address is generally recognized as having two parts joined with an [at-sign](/wiki/At-sign "At-sign") (*@*), although technical specification detailed in RFC 822 and subsequent RFCs are more extensive.[[32]](#cite_note-32)

Syntactically correct, verified email addresses do not guarantee that an [email box](/wiki/Email_box "Email box") exists. Thus many mail servers use other techniques and check the mailbox existence against relevant systems such as the [Domain Name System](/wiki/Domain_Name_System "Domain Name System") for the domain or using [callback verification](/wiki/Callback_verification "Callback verification") to check if the mailbox exists. Callback verification is an imperfect solution, as it may be disabled to avoid a [directory harvest attack](/wiki/Directory_harvest_attack "Directory harvest attack"), or callbacks may be reported as spam and lead to listing on a [DNSBL](/wiki/DNSBL "DNSBL").

Several validation techniques may be utilized to validate a user email address. For example,[[33]](#cite_note-33)

* Verification links: Email address validation is often accomplished for account creation on websites by sending an email to the user-provided email address with a special temporary hyperlink. On receipt, the user opens the link, immediately activating the account. Email addresses are also useful as means of delivering messages from a website, e.g., user messages, user actions, to the email inbox.
* Formal and informal standards: RFC 3696 provides specific advice for validating Internet identifiers, including email addresses. Some websites instead attempt to evaluate the validity of email addresses through arbitrary standards, such as by rejecting addresses containing valid characters, such as *+* and */*, or enforcing arbitrary length limitations. Email address internationalization provides for a much larger range of characters than many current validation algorithms allow, such as all Unicode characters above U+0080, encoded as [UTF-8](/wiki/UTF-8 "UTF-8").
* Algorithmic tools: Large websites, bulk mailers and spammers require efficient tools to validate email addresses. Such tools depend upon [heuristic algorithms](/wiki/Heuristic_algorithm "Heuristic algorithm") and [statistical models](/wiki/Statistical_model "Statistical model").[[34]](#cite_note-34)
* Sender reputation: An email sender's reputation may be used to attempt to verify whether the sender is trustworthy or a potential spammer. Factors that may be incorporated into an assessment of sender reputation include the quality of past contact with or content provided by, and engagement levels of, the sender's IP address or email address.
* Browser-based verification: HTML5 forms implemented in many browsers allow email address validation to be handled by the browser.[[35]](#cite_note-35)

Some companies offer services to validate an email address, often using an [application programming interface](/wiki/Application_programming_interface "Application programming interface"), but there is no guarantee that it will provide accurate results.

## Internationalization

[[edit](/w/index.php?title=Email_address&action=edit&section=11 "Edit section: Internationalization")]

The [IETF](/wiki/IETF "IETF") conducts a technical and standards working group devoted to internationalization issues of email addresses, entitled *Email Address Internationalization* (EAI, also known as IMA, Internationalized Mail Address).[[36]](#cite_note-36) This group produced [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [6530](https://datatracker.ietf.org/doc/html/rfc6530), [6531](https://datatracker.ietf.org/doc/html/rfc6531), [6532](https://datatracker.ietf.org/doc/html/rfc6532) and [6533](https://datatracker.ietf.org/doc/html/rfc6533), and continues to work on additional EAI-related RFCs.

The IETF's EAI Working group published RFC 6530 "Overview and Framework for Internationalized Email", which enabled non-ASCII characters to be used in both the local-parts and domain of an email address. RFC 6530 provides for email based on the [UTF-8](/wiki/UTF-8 "UTF-8") encoding, which permits the full repertoire of [Unicode](/wiki/Unicode "Unicode"). RFC 6531 provides a mechanism for SMTP servers to negotiate transmission of the [SMTPUTF8](/wiki/SMTPUTF8 "SMTPUTF8") content.

The basic EAI concepts involve exchanging mail in UTF-8. Though the original proposal included a downgrading mechanism for legacy systems, this has now been dropped.[[37]](#cite_note-37) The local servers are responsible for the local-part of the address, whereas the domain would be restricted by the rules of [internationalized domain names](/wiki/Internationalized_domain_name "Internationalized domain name"), though still transmitted in UTF-8. The mail server is also responsible for any mapping mechanism between the IMA form and any ASCII alias.

EAI enables users to have a localized address in a native language script or character set, as well as an ASCII form for communicating with legacy systems or for script-independent use. Applications that recognize internationalized domain names and mail addresses must have facilities to convert these representations.

Significant demand for such addresses is expected in China, Japan, Russia, and other markets that have large user bases in a non-Latin-based writing system.

For example, in addition to the [.in](/wiki/.in ".in") top-level domain, the government of India in 2011[[38]](#cite_note-38) got approval for ".bharat", (from *[Bhārat Gaṇarājya](/wiki/Republic_of_India "Republic of India")*), written in seven [different scripts](/wiki/Brahmic_scripts "Brahmic scripts")[[39]](#cite_note-39)[[40]](#cite_note-40) for use by Gujrati, Marathi, Bangali, Tamil, Telugu, Punjabi and Urdu speakers. Indian company XgenPlus.com claims to be the world's first EAI mailbox provider,[[41]](#cite_note-41) and the [Government of Rajasthan](/wiki/Government_of_Rajasthan "Government of Rajasthan") now supplies a free email account on domain राजस्थान.भारत for every citizen of the state.[[42]](#cite_note-42) A leading media house Rajasthan Patrika launched their IDN domain पत्रिका.भारत with contactable email.

The example addresses below would not be handled by [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [5321](https://datatracker.ietf.org/doc/html/rfc5321) based servers without an extension, but are permitted by the **UTF8SMTP** extension of [RFC](/wiki/RFC_%28identifier%29 "RFC (identifier)") [6530](https://datatracker.ietf.org/doc/html/rfc6530) and [6531](https://datatracker.ietf.org/doc/html/rfc6531). Servers compliant with this will be able to handle these:

* [Latin alphabet](/wiki/Latin_alphabet "Latin alphabet") with [diacritics](/wiki/Diacritics "Diacritics"): éléonore@example.com
* [Greek alphabet](/wiki/Greek_alphabet "Greek alphabet"): δοκιμή@παράδειγμα.δοκιμή
* [Traditional Chinese characters](/wiki/Traditional_Chinese_characters "Traditional Chinese characters"): 我買@屋企.香港
* [Japanese characters](/wiki/Japanese_characters "Japanese characters"): 二ノ宮@黒川.日本
* [Cyrillic characters](/wiki/Cyrillic_characters "Cyrillic characters"): медведь@с-балалайкой.рф
* [Devanagari characters](/wiki/Devanagari "Devanagari"): संपर्क@डाटामेल.भारत

## See also

[[edit](/w/index.php?title=Email_address&action=edit&section=12 "Edit section: See also")]

* [![icon](//upload.wikimedia.org/wikipedia/commons/thumb/f/f9/Crystal_Clear_app_linneighborhood.svg/28px-Crystal_Clear_app_linneighborhood.svg.png)](/wiki/File%3ACrystal_Clear_app_linneighborhood.svg)[internet portal](/wiki/Portal%3AInternet "Portal:Internet")
* [![icon](//upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Noun-technology.svg/29px-Noun-technology.svg.png)](/wiki/File%3ANoun-technology.svg)[technology portal](/wiki/Portal%3ATechnology "Portal:Technology")

* [Anti-spam techniques](/wiki/Anti-spam_techniques "Anti-spam techniques")
* [Email client](/wiki/Email_client "Email client")
* [Email box](/wiki/Email_box "Email box")
* [Email authentication](/wiki/Email_authentication "Email authentication")
* [Non-Internet email address](/wiki/Non-Internet_email_address "Non-Internet email address")
* [International email](/wiki/International_email "International email")

## References

[[edit](/w/index.php?title=Email_address&action=edit&section=13 "Edit section: References")]

1. **[^](#cite_ref-1)** J. Klensin (October 2008). ["General Syntax Principles and Transaction Model"](https://datatracker.ietf.org/doc/html/rfc5321#section-2.4). [*Simple Mail Transfer Protocol*](https://datatracker.ietf.org/doc/html/rfc5321). p. 15. sec. 2.4. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5321](https://doi.org/10.17487/RFC5321). [RFC](/wiki/Request_for_Comments "Request for Comments") [5321](https://datatracker.ietf.org/doc/html/rfc5321). The local-part of a mailbox MUST BE treated as case sensitive.
2. **[^](#cite_ref-2)** J. Klensin (October 2008). ["General Syntax Principles and Transaction Model"](https://datatracker.ietf.org/doc/html/rfc5321#section-2.4). [*Simple Mail Transfer Protocol*](https://datatracker.ietf.org/doc/html/rfc5321). p. 15. sec. 2.4. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5321](https://doi.org/10.17487/RFC5321). [RFC](/wiki/Request_for_Comments "Request for Comments") [5321](https://datatracker.ietf.org/doc/html/rfc5321). However, exploiting the case sensitivity of mailbox local-parts impedes interoperability and is discouraged.
3. **[^](#cite_ref-3)** [*"...you can add or remove the dots from a mail address without changing the actual destination address; and they'll all go to your inbox..."*](https://support.google.com/mail/answer/10313?topic=14822), Google.com
4. **[^](#cite_ref-4)** Morrison, Sara (2021-09-06). ["How a simple email address makes things complicated"](https://www.vox.com/recode/22620276/what-to-do-when-you-get-someone-elses-email-security-vulnerabilities-gmail-inbox-invasion). *Vox*. Retrieved 2024-07-15.
5. **[^](#cite_ref-5)** [Klensin, J.](/wiki/John_Klensin "John Klensin") (October 2008). ["Size Limits and Minimums"](https://datatracker.ietf.org/doc/html/rfc5321#section-4.5.3.1). [*Simple Mail Transfer Protocol*](https://datatracker.ietf.org/doc/html/rfc5321). [IETF](/wiki/Internet_Engineering_Task_Force "Internet Engineering Task Force"). sec. 4.5.3.1. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5321](https://doi.org/10.17487/RFC5321). [RFC](/wiki/Request_for_Comments "Request for Comments") [5321](https://datatracker.ietf.org/doc/html/rfc5321).
6. **[^](#cite_ref-6)** ["Address Specification"](https://datatracker.ietf.org/doc/html/rfc5322#section-3.4). [*Internet Message Format*](https://datatracker.ietf.org/doc/html/rfc5322). sec. 3.4. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5322](https://doi.org/10.17487/RFC5322). [RFC](/wiki/Request_for_Comments "Request for Comments") [5322](https://datatracker.ietf.org/doc/html/rfc5322). Retrieved March 14, 2023.
7. **[^](#cite_ref-7)** ["Spotting a Spoofing"](https://www.cyber.nj.gov/informational-report/spotting-a-spoofing). *cyber.nj.gov*. November 19, 2020. Retrieved 17 April 2023.
8. ^ [***a***](#cite_ref-rfc3696_8-0) [***b***](#cite_ref-rfc3696_8-1) [Klensin, J.](/wiki/John_Klensin "John Klensin") (February 2004). [*RFC 3696*](https://datatracker.ietf.org/doc/html/rfc3696). [IETF](/wiki/Internet_Engineering_Task_Force "Internet Engineering Task Force"). [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC3696](https://doi.org/10.17487/RFC3696). Retrieved 2017-08-01.: §3
9. **[^](#cite_ref-rfc5321_9-0)** [Klensin, J.](/wiki/John_Klensin "John Klensin") (October 2008). [*RFC 5321*](https://datatracker.ietf.org/doc/html/rfc5321#section-4.5.3.1.1). [IETF](/wiki/Internet_Engineering_Task_Force "Internet Engineering Task Force"). sec. 4.5.3.1.1. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5321](https://doi.org/10.17487/RFC5321). Retrieved 2019-08-01.
10. **[^](#cite_ref-10)** ["Sign up for Windows Live"](https://signup.live.com/newuser.aspx?mkt=en-us). Retrieved 2008-07-26.. However, the phrase is hidden, thus one has to either check the availability of an invalid ID, e.g., *me#1*, or resort to alternative displaying, e.g., *no-style* or source view, in order to read it.
11. **[^](#cite_ref-11)** ["Characters in the local part of an email address"](https://www.jochentopf.com/email/chars.html). Retrieved 2016-03-30.
12. **[^](#cite_ref-12)** [Are Email Addresses Case Sensitive?](http://email.about.com/od/emailbehindthescenes/f/email_case_sens.htm) [Archived](https://web.archive.org/web/20160603181434/http%3A//email.about.com/od/emailbehindthescenes/f/email_case_sens.htm) 2016-06-03 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine") by Heinz Tschabitscher
13. **[^](#cite_ref-13)** ["Receiving someone else's mail"](https://mail.google.com/support/bin/answer.py?answer=10313&topic=14822). *google.com*.
14. **[^](#cite_ref-14)** Murchison, K. (2008). [*Sieve Email Filtering: Subaddress Extension*](https://datatracker.ietf.org/doc/html/rfc5233). [IETF](/wiki/IETF "IETF"). [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.17487/RFC5233](https://doi.org/10.17487/RFC5233). [RFC](/wiki/Request_for_Comments "Request for Comments") [5233](https://datatracker.ietf.org/doc/html/rfc5233). Retrieved February 9, 2019.
15. ^ [***a***](#cite_ref-Gmail_15-0) [***b***](#cite_ref-Gmail_15-1) ["Send emails from a different address or alias"](https://support.google.com/mail/answer/22370?hl=en#alias&zippy=%2Cfilter-using-your-gmail-alias). *Gmail Help*. Retrieved 13 December 2023.
16. **[^](#cite_ref-16)** ["An Overview of the Andrew Message System"](https://www.andrew.cmu.edu/user/rjs3/ams.pdf) (PDF). Retrieved 17 April 2023.
17. **[^](#cite_ref-17)** ["Subaddressing/Plus Addressing"](https://help.runbox.com/subaddressing-plus-addressing/). Retrieved 1 January 2024.
18. **[^](#cite_ref-18)** ["Disposable addresses in Yahoo Mail"](https://help.yahoo.com/kb/SLN3523.html). *Yahoo Help*.
19. **[^](#cite_ref-19)** Rivera, Rafael (2013-09-17). ["Outlook.com supports simpler "+" email aliases too"](https://web.archive.org/web/20140220025605/http%3A//withinwindows.com/within-windows/outlookcom-supports-simpler-email-aliases-too). *Within Windows*. Archived from [the original](http://withinwindows.com/within-windows/outlookcom-supports-simpler-email-aliases-too) on 2014-02-20. Retrieved 2023-12-04.
20. **[^](#cite_ref-20)** ["Plus Addressing: The Best Way to Track Spammers in 2024"](https://blog.mailfence.com/plus-addressing-to-track-spammers/). *mailfence.com*.
21. **[^](#cite_ref-21)** ["Addresses and Aliases"](https://proton.me/support/addresses-and-aliases). *proton.me*.
22. **[^](#cite_ref-22)** ["Plus addressing and subdomain addressing"](https://www.fastmail.com/help/receive/addressing.html). *www.fastmail.com*. [Archived](https://web.archive.org/web/20201006174046/https%3A//www.fastmail.com/help/receive/addressing.html) from the original on 2020-10-06. Retrieved 2020-10-06.
23. **[^](#cite_ref-23)** ["postale.io's FAQ on sub-addressing"](https://postale.io/faq#Do%20you%20support%20automatic%20aliases%20such%20as%20name+tag@domain.com%20(a.k.a%20sub-addressing)?). *postale.io*. [Archived](https://web.archive.org/web/20201006222841/https%3A//postale.io/faq#Do%20you%20support%20automatic%20aliases%20such%20as%20name+tag@domain.com%20(a.k.a%20sub-addressing)?) from the original on 2020-10-06. Retrieved 2020-10-06.
24. **[^](#cite_ref-24)** ["Can I use myaddress+extension@pobox.com with my Pobox account?"](https://helpspot.pobox.com/index.php?pg=kb.page&id=58). *helpspot.pobox.com*. n.d. [Archived](https://web.archive.org/web/20201003170157/https%3A//helpspot.pobox.com/index.php?pg=kb.page&id=58) from the original on 2020-10-03. Retrieved 2020-10-03. Pobox supports the use of "+anystring" (plus extensions) with any address.
25. **[^](#cite_ref-25)** ["MeMail"](https://www.memail.com/). *www.memail.com*. Retrieved 2020-10-06.
26. ^ [***a***](#cite_ref-control_26-0) [***b***](#cite_ref-control_26-1) ["Dot-Qmail, Control the delivery of mail messages"](https://web.archive.org/web/20120126124047/http%3A//qmail.org/man/man5/dot-qmail.html). Archived from [the original](http://qmail.org/man/man5/dot-qmail.html) on 26 January 2012. Retrieved 27 January 2012.
27. **[^](#cite_ref-27)** Sill, Dave. ["4.1.5. extension addresses"](http://www.lifewithqmail.org/lwq.html#extension-addresses). *Life with qmail*. Retrieved 27 January 2012.
28. **[^](#cite_ref-28)** ["Postfix Configuration Parameters"](http://www.postfix.org/postconf.5.html#recipient_delimiter). *postfix.org*.
29. **[^](#cite_ref-29)** ["Exim Configuration Parameters, "local\_part\_suffix""](https://www.exim.org/exim-html-current/doc/html/spec_html/ch-generic_options_for_routers.html). *exim.org*.
30. **[^](#cite_ref-30)** Gina Trapani (2005) ["Instant disposable Gmail addresses"](https://lifehacker.com/144397/instant-disposable-gmail-addresses)
31. **[^](#cite_ref-31)** ["New gTLD Dotless Domain Names Prohibited"](https://www.icann.org/news/announcement-2013-08-30-en). *www.icann.org*. ICANN. Retrieved 23 March 2020.
32. **[^](#cite_ref-32)** ["How Domino formats the sender's Internet address in outbound messages"](https://www.ibm.com/support/knowledgecenter/en/SSKTMJ_9.0.1/admin/conf_howdominoformatsthesendersinternetaddressinoutbo_r.html). *IBM Knowledge Center*. Retrieved 23 July 2019.
33. **[^](#cite_ref-33)** ["M3AAWG Sender Best Common Practices, Version 3"](https://www.m3aawg.org/sites/default/files/document/M3AAWG_Senders_BCP_Ver3-2015-02.pdf) (PDF). *Messaging, Malware and Mobile Anti-Abuse Working Group*. February 2015. Retrieved 23 July 2019.
34. **[^](#cite_ref-34)** [Verification & Validation Techniques for Email Address Quality Assurance](http://dev.egure.com/verification-validation-techniques-email-address-quality-assurance.pdf) by Jan Hornych 2011, University of Oxford
35. **[^](#cite_ref-35)** ["4.10 Forms — HTML5"](http://www.w3.org/TR/html5/forms.html#e-mail-state-(type=email)). *w3.org*.
36. **[^](#cite_ref-36)** ["Eai Status Pages"](http://tools.ietf.org/wg/eai/). *Email Address Internationalization (Active WG)*. IETF. March 17, 2006 – March 18, 2013. Retrieved July 26, 2008.
37. **[^](#cite_ref-37)** ["Email Address Internationalization (eai)"](http://datatracker.ietf.org/wg/eai/charter/). IETF. Retrieved November 30, 2010.
38. **[^](#cite_ref-38)** ["2011-01-25 - Approval of Delegation of the seven top-level domains representing India in various languages"](https://features.icann.org/2011-01-25-approval-delegation-seven-top-level-domains-representing-india-various-languages). *features.icann.org*.
39. **[^](#cite_ref-39)** ["Internationalized Domain Names (IDNs) | Registry.In"](https://registry.in/Internationalized_Domain_Names_IDNs). *registry.in*. Retrieved 2016-10-17.
40. **[^](#cite_ref-40)** ["Now, get your email address in Hindi"](http://economictimes.indiatimes.com/tech/internet/now-get-your-email-address-in-hindi/articleshow/53830034.cms). *The Economic Times*. Retrieved 2016-10-17.
41. **[^](#cite_ref-41)** ["Universal Acceptance in India"](https://uasg.tech/2017/02/universal-acceptance-india/). 15 February 2017.
42. **[^](#cite_ref-42)** ["देश में पहला, प्रदेश के हर नागरिक के लिए मुफ्त ई-वॉल्ट और ई-मेल की सुविधा शुरू - वसुन्धरा राजे"](http://vasundhararaje.in/hi/cm-launches-free-e-mail-and-e-vault-for-every-citizen-of-the-state-digifest-18082017.html). *वसुन्धरा राजे* (in Hindi). 2017-08-18. Retrieved 2017-08-20.

## Further reading

[[edit](/w/index.php?title=Email_address&action=edit&section=14 "Edit section: Further reading")]

* RFC [821](https://datatracker.ietf.org/doc/html/rfc821) Simple Mail Transfer Protocol (Obsoleted by RFC [2821](https://datatracker.ietf.org/doc/html/rfc2821) and [5321](https://datatracker.ietf.org/doc/html/rfc5321))
* RFC [822](https://datatracker.ietf.org/doc/html/rfc822) Standard for the Format of ARPA Internet Text Messages (Obsoleted by RFC [2822](https://datatracker.ietf.org/doc/html/rfc2822)) (Errata)
* RFC [1035](https://datatracker.ietf.org/doc/html/rfc1035) Domain names, Implementation and specification (Errata)
* RFC [1123](https://datatracker.ietf.org/doc/html/rfc1123) Requirements for Internet Hosts, Application and Support (Updated by RFC [2821](https://datatracker.ietf.org/doc/html/rfc2821), [5321](https://datatracker.ietf.org/doc/html/rfc5321)) (Errata)
* RFC [2142](https://datatracker.ietf.org/doc/html/rfc2142) Mailbox Names for Common Services, Roles and Functions (Errata)
* RFC [2821](https://datatracker.ietf.org/doc/html/rfc2821) Simple Mail Transfer Protocol (Obsoletes RFC [821](https://datatracker.ietf.org/doc/html/rfc821), Updates RFC [1123](https://datatracker.ietf.org/doc/html/rfc1123), Obsoleted by RFC [5321](https://datatracker.ietf.org/doc/html/rfc5321)) (Errata)
* RFC [2822](https://datatracker.ietf.org/doc/html/rfc2822) Internet Message Format (Obsoletes RFC [822](https://datatracker.ietf.org/doc/html/rfc822), Obsoleted by RFC [5322](https://datatracker.ietf.org/doc/html/rfc5322)) (Errata)
* RFC [3696](https://datatracker.ietf.org/doc/html/rfc3696) Application Techniques for Checking and Transformation of Names (Errata)
* RFC [4291](https://datatracker.ietf.org/doc/html/rfc4291) IP Version 6 Addressing Architecture (Updated by RFC [5952](https://datatracker.ietf.org/doc/html/rfc5952)) (Errata)
* RFC [5321](https://datatracker.ietf.org/doc/html/rfc5321) Simple Mail Transfer Protocol (Obsoletes RFC [2821](https://datatracker.ietf.org/doc/html/rfc2821), Updates RFC [1123](https://datatracker.ietf.org/doc/html/rfc1123)) (Errata)
* RFC [5322](https://datatracker.ietf.org/doc/html/rfc5322) Internet Message Format (Obsoletes RFC [2822](https://datatracker.ietf.org/doc/html/rfc2822), Updated by RFC [6854](https://datatracker.ietf.org/doc/html/rfc6854)) (Errata)
* RFC [5598](https://datatracker.ietf.org/doc/html/rfc5598) Internet Mail Architecture
* RFC [5952](https://datatracker.ietf.org/doc/html/rfc5952) A Recommendation for IPv6 Address Text Representation (Updates RFC [4291](https://datatracker.ietf.org/doc/html/rfc4291)) (Errata)
* RFC [6530](https://datatracker.ietf.org/doc/html/rfc6530) Overview and Framework for Internationalized Email (Obsoletes RFC [4952](https://datatracker.ietf.org/doc/html/rfc4952), [5504](https://datatracker.ietf.org/doc/html/rfc5504), [5825](https://datatracker.ietf.org/doc/html/rfc5825))
* RFC [6531](https://datatracker.ietf.org/doc/html/rfc6531) SMTP Extension for Internationalized Email (Obsoletes RFC [5336](https://datatracker.ietf.org/doc/html/rfc5336))
* RFC [6854](https://datatracker.ietf.org/doc/html/rfc6854) Update to Internet Message Format to Allow Group Syntax in the "From:" and "Sender:" Header Fields (Updates RFC [5322](https://datatracker.ietf.org/doc/html/rfc5322))

## External links

[[edit](/w/index.php?title=Email_address&action=edit&section=15 "Edit section: External links")]

* [![](//upload.wikimedia.org/wikipedia/commons/thumb/d/df/Wikibooks-logo-en-noslogan.svg/16px-Wikibooks-logo-en-noslogan.svg.png)](/wiki/File%3AWikibooks-logo-en-noslogan.svg) [Validate Email Address](https://en.wikibooks.org/wiki/Coding_Cookbook/Validate_Email_Address "wikibooks:Coding Cookbook/Validate Email Address") at Wikibooks
* [![](//upload.wikimedia.org/wikipedia/commons/thumb/d/df/Wikibooks-logo-en-noslogan.svg/16px-Wikibooks-logo-en-noslogan.svg.png)](/wiki/File%3AWikibooks-logo-en-noslogan.svg) [Best Practices](https://en.wikibooks.org/wiki/JavaScript/Best_Practices "wikibooks:JavaScript/Best Practices") at Wikibooks
* [![](//upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/12px-Commons-logo.svg.png)](/wiki/File%3ACommons-logo.svg) Media related to [Email address](https://commons.wikimedia.org/wiki/Category%3AEmail_address "commons:Category:Email address") at Wikimedia Commons

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://en.wikipedia.org/w/index.php?title=Email_address&oldid=1268156000>"
[Category](/wiki/Help%3ACategory "Help:Category"):

* [Email](/wiki/Category%3AEmail "Category:Email")
Hidden categories:

* [Webarchive template wayback links](/wiki/Category%3AWebarchive_template_wayback_links "Category:Webarchive template wayback links")
* [CS1 Hindi-language sources (hi)](/wiki/Category%3ACS1_Hindi-language_sources_%28hi%29 "Category:CS1 Hindi-language sources (hi)")
* [Articles with short description](/wiki/Category%3AArticles_with_short_description "Category:Articles with short description")
* [Short description matches Wikidata](/wiki/Category%3AShort_description_matches_Wikidata "Category:Short description matches Wikidata")
* [All articles with unsourced statements](/wiki/Category%3AAll_articles_with_unsourced_statements "Category:All articles with unsourced statements")
* [Articles with unsourced statements from August 2016](/wiki/Category%3AArticles_with_unsourced_statements_from_August_2016 "Category:Articles with unsourced statements from August 2016")
* [Articles needing additional references from July 2019](/wiki/Category%3AArticles_needing_additional_references_from_July_2019 "Category:Articles needing additional references from July 2019")
* [All articles needing additional references](/wiki/Category%3AAll_articles_needing_additional_references "Category:All articles needing additional references")
* [Commons category link is on Wikidata](/wiki/Category%3ACommons_category_link_is_on_Wikidata "Category:Commons category link is on Wikidata")

* This page was last edited on 8 January 2025, at 10:57 (UTC).
* Text is available under the [Creative Commons Attribution-ShareAlike 4.0 License](/wiki/Wikipedia%3AText_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License "Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License");
  additional terms may apply. By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use "foundation:Special:MyLanguage/Policy:Terms of Use") and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy "foundation:Special:MyLanguage/Policy:Privacy policy"). Wikipedia® is a registered trademark of the [Wikimedia Foundation, Inc.](https://wikimediafoundation.org/), a non-profit organization.

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About Wikipedia](/wiki/Wikipedia%3AAbout)
* [Disclaimers](/wiki/Wikipedia%3AGeneral_disclaimer)
* [Contact Wikipedia](//en.wikipedia.org/wiki/Wikipedia%3AContact_us)
* [Code of Conduct](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AUniversal_Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/en.wikipedia.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//en.m.wikipedia.org/w/index.php?title=Email_address&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)



=== Content from next-auth.js.org_f01cc3e6_20250115_101958.html ===

Skip to main contentNextAuth.js is becoming Auth.js! 🎉 We're creating Authentication for the Web. Everyone included. You are looking at the NextAuth.js (v4) documentation. For the new documentation go to [authjs.dev](https://authjs.dev).[![NextAuth Logo](/img/logo/logo-xs.png)![NextAuth Logo](/img/logo/logo-xs.png)**NextAuth.js**](/)[Documentation](/getting-started/introduction)[Tutorials](/tutorials)[FAQ](/faq)[Security](/security)[v4](/getting-started/introduction)

* [v4](/configuration/initialization)
* [v3](/v3/getting-started/introduction)
* [All Releases](https://github.com/nextauthjs/next-auth/releases)
[npm](https://www.npmjs.com/package/next-auth)[GitHub](https://github.com/nextauthjs/next-auth)Search

* [Getting Started](/getting-started/introduction)
  + [Introduction](/getting-started/introduction)
  + [Getting Started](/getting-started/example)
  + [Client API](/getting-started/client)
  + [REST API](/getting-started/rest-api)
  + [TypeScript](/getting-started/typescript)
  + [Upgrade Guide (v4)](/getting-started/upgrade-v4)
* [Configuration](/configuration/initialization)
  + [Initialization](/configuration/initialization)
  + [Options](/configuration/options)
  + [Providers](/configuration/providers/oauth)
  + [Databases](/configuration/databases)
  + [Pages](/configuration/pages)
  + [Callbacks](/configuration/callbacks)
  + [Events](/configuration/events)
  + [Next.js](/configuration/nextjs)
* [Providers](/providers/)
* [Adapters](/adapters)
* [Warnings](/warnings)
* [Errors](/errors)
* [Deployment](/deployment)
* [Guides](/guides/)
* SponsoredLooking for a
  hosted alternative?[Try Clerk →](https://go.clerk.com/DefS1u4)

* Configuration
* Initialization
Version: v4On this page
# Initialization

The main entry point of NextAuth.js is the `NextAuth` method that you import from `next-auth`. It handles different types of requests, as defined in the [REST API](/getting-started/rest-api) section.

info

NextAuth.js cannot use the run [Edge Runtime](https://nextjs.org/docs/api-reference/edge-runtime) for initialization. The upcoming [`@auth/nextjs` library](https://authjs.dev/reference/next-auth) (which will replace `next-auth`) on the other hand will be fully compatible.

You can initialize NextAuth.js in a few different ways.

## Simple initialization[​](#simple-initialization "Direct link to heading")

### API Routes (`pages`)[​](#api-routes-pages "Direct link to heading")

In Next.js, you can define an API route that will catch all requests that begin with a certain path. Conveniently, this is called [Catch all API routes](https://nextjs.org/docs/api-routes/dynamic-api-routes#catch-all-api-routes).

When you define a `/pages/api/auth/[...nextauth]` JS/TS file, you instruct NextAuth.js that every API request beginning with `/api/auth/*` should be handled by the code written in the `[...nextauth]` file.

/pages/api/auth/[...nextauth].ts
```
import NextAuth from "next-auth"

export default NextAuth({
  ...
})

```

Here, you only need to pass your [options](/configuration/options) to `NextAuth`, and `NextAuth` does the rest.

This is the preferred initialization in tutorials/other parts of the documentation, as it simplifies the code and reduces potential errors in the authentication flow.

### Route Handlers (`app/`)[​](#route-handlers-app "Direct link to heading")

[Next.js 13.2](https://nextjs.org/blog/next-13-2#custom-route-handlers) introduced [Route Handlers](https://beta.nextjs.org/docs/routing/route-handlers), the preferred way to handle REST-like requests in App Router (`app/`).

You can initialize NextAuth.js with a Route Handler too, very similar to API Routes.

/app/api/auth/[...nextauth]/route.ts
```
import NextAuth from "next-auth"

const handler = NextAuth({
  ...
})

export { handler as GET, handler as POST }

```

Internally, NextAuth.js detects that it is being initialized in a Route Handler (by understanding that it is passed a Web [`Request` instance](https://developer.mozilla.org/en-US/docs/Web/API/Request)), and will return a handler that returns a [`Response` instance](https://developer.mozilla.org/en-US/docs/Web/API/Response). A Route Handler file expects you to export some named handler functions that handle a request and return a response. NextAuth.js needs the `GET` and `POST` handlers to function properly, so we export those two.

info

Technically, in a Route Handler, the `api/` prefix is not necessary, but we decided to keep it required for an easier migration.

## Advanced initialization[​](#advanced-initialization "Direct link to heading")

info

The following describes the advanced initialization with API Routes, but everything will apply similarily when using [Route Handlers](https://beta.nextjs.org/docs/routing/route-handlers) too.
Instead, `NextAuth` will receive the first two arguments of a Route Handler, and the third argument will be the [auth options](/configuration/options)

If you have a specific use case and need to make NextAuth.js do something slightly different than what it is designed for, keep in mind, the `[...nextauth].ts` config file is just **a regular [API Route](https://nextjs.org/docs/api-routes/introduction)**.

That said, you can initialize NextAuth.js like this:

/pages/api/auth/[...nextauth].ts
```
import type { NextApiRequest, NextApiResponse } from "next"
import NextAuth from "next-auth"

export default async function auth(req: NextApiRequest, res: NextApiResponse) {
  // Do whatever you want here, before the request is passed down to `NextAuth`
  return await NextAuth(req, res, {
    ...
  })
}

```

The `...` section will still be your [options](/configuration/options), but you now have the possibility to execute/modify certain things on the request.

You could for example log the request, add headers, read `query` or `body` parameters, whatever you would do in an API route.

tip

Since this is a catch-all route, remember to check what kind of NextAuth.js "action" is running. Compare the REST API with the `req.query.nextauth` parameter.

For example to execute something on the "callback" action when the request is a POST method, you can check for `req.query.nextauth.includes("callback") && req.method === "POST"`

note

`NextAuth` will implicitly close the response (by calling `res.end`, `res.send` or similar), so you should not run code **after** `NextAuth` in the function body. Using `return NextAuth` makes sure you don't forget that.

Any variable you create this way will be available in the `NextAuth` options as well, since they are in the same scope.

/pages/api/auth/[...nextauth].ts
```
import type { NextApiRequest, NextApiResponse } from "next"
import NextAuth from "next-auth"

export default async function auth(req: NextApiRequest, res: NextApiResponse) {

  if(req.query.nextauth.includes("callback") && req.method === "POST") {
    console.log(
      "Handling callback request from my Identity Provider",
      req.body
    )
  }

  // Get a custom cookie value from the request
  const someCookie = req.cookies["some-custom-cookie"]

  return await NextAuth(req, res, {
    ...
    callbacks: {
      session({ session, token }) {
        // Return a cookie value as part of the session
        // This is read when `req.query.nextauth.includes("session") && req.method === "GET"`
        session.someCookie = someCookie
        return session
      }
    }
  })
}

```

A practical example could be to not show a certain provider on the default sign-in page, but still be able to sign in with it. (The idea is taken from [this discussion](https://github.com/nextauthjs/next-auth/discussions/3133)):

/pages/api/auth/[...nextauth].ts
```
import NextAuth from "next-auth"
import CredentialsProvider from "next-auth/providers/credentials"
import GoogleProvider from "next-auth/providers/google"

export default async function auth(req, res) {
  const providers = [
    CredentialsProvider(...),
    GoogleProvider(...),
  ]

  const isDefaultSigninPage = req.method === "GET" && req.query.nextauth.includes("signin")

  // Will hide the `GoogleProvider` when you visit `/api/auth/signin`
  if (isDefaultSigninPage) providers.pop()

  return await NextAuth(req, res, {
    providers,
    ...
  })
}

```

For more details on all available actions and which methods are supported, please check out the [REST API documentation](/getting-started/rest-api) or the appropriate area in [the source code](https://github.com/nextauthjs/next-auth/blob/v4/packages/next-auth/src/core/index.ts)

This way of initializing `NextAuth` is very powerful, but should be used sparingly.

danger

Changing parts of the request that is essential to `NextAuth` to do its job - like messing with the [default cookies](/configuration/options#cookies) - can have unforeseen consequences, and have the potential to introduce security holes if done incorrectly. Only change those if you understand consequences.

[Edit this page](https://github.com/nextauthjs/next-auth/edit/v4/docs/docs/configuration/initialization.md)Last updated on **Oct 24, 2024** by **Balázs Orbán**[PreviousUpgrade Guide (v4)](/getting-started/upgrade-v4)[NextOptions](/configuration/options)

* [Simple initialization](#simple-initialization)
  + [API Routes (`pages`)](#api-routes-pages)
  + [Route Handlers (`app/`)](#route-handlers-app)
* [Advanced initialization](#advanced-initialization)
About NextAuth.js

* [Introduction](/getting-started/introduction)
Download

* [GitHub](https://github.com/nextauthjs/next-auth)
* [NPM](https://www.npmjs.com/package/next-auth)
Acknowledgements

* [Contributors](/contributors)
* [Sponsors](/sponsors)
* [Images by unDraw](https://undraw.co/)
NextAuth.js © Iain Collins 2025



=== Content from next-auth.js.org_8fd767d4_20250115_101959.html ===

Skip to main contentNextAuth.js is becoming Auth.js! 🎉 We're creating Authentication for the Web. Everyone included. You are looking at the NextAuth.js (v4) documentation. For the new documentation go to [authjs.dev](https://authjs.dev).[![NextAuth Logo](/img/logo/logo-xs.png)![NextAuth Logo](/img/logo/logo-xs.png)**NextAuth.js**](/)[Documentation](/getting-started/introduction)[Tutorials](/tutorials)[FAQ](/faq)[Security](/security)[v4](/getting-started/introduction)

* [v4](/providers/email)
* [v3](/v3/providers/email)
* [All Releases](https://github.com/nextauthjs/next-auth/releases)
[npm](https://www.npmjs.com/package/next-auth)[GitHub](https://github.com/nextauthjs/next-auth)Search

* [Getting Started](/getting-started/introduction)
  + [Introduction](/getting-started/introduction)
  + [Getting Started](/getting-started/example)
  + [Client API](/getting-started/client)
  + [REST API](/getting-started/rest-api)
  + [TypeScript](/getting-started/typescript)
  + [Upgrade Guide (v4)](/getting-started/upgrade-v4)
* [Configuration](/configuration/initialization)
* [Providers](/providers/)
  + [42 School](/providers/42-school)
  + [Apple](/providers/apple)
  + [Atlassian](/providers/atlassian)
  + [Auth0](/providers/auth0)
  + [Authentik](/providers/authentik)
  + [Azure Active Directory B2C](/providers/azure-ad-b2c)
  + [Azure Active Directory](/providers/azure-ad)
  + [Battle.net](/providers/battle.net)
  + [Box](/providers/box)
  + [BoxyHQ SAML](/providers/boxyhq-saml)
  + [Bungie](/providers/bungie)
  + [Amazon Cognito](/providers/cognito)
  + [Coinbase](/providers/coinbase)
  + [Credentials](/providers/credentials)
  + [Discord](/providers/discord)
  + [Dropbox](/providers/dropbox)
  + [DuendeIdentityServer6](/providers/duende-identityserver6)
  + [Email](/providers/email)
  + [EVE Online](/providers/eveonline)
  + [Facebook](/providers/facebook)
  + [FACEIT](/providers/faceit)
  + [Foursquare](/providers/foursquare)
  + [Freshbooks](/providers/freshbooks)
  + [FusionAuth](/providers/fusionauth)
  + [GitHub](/providers/github)
  + [GitLab](/providers/gitlab)
  + [Google](/providers/google)
  + [HubSpot](/providers/hubspot)
  + [IdentityServer4](/providers/identity-server4)
  + [Overview](/providers/)
  + [Instagram](/providers/instagram)
  + [Kakao](/providers/kakao)
  + [Keycloak](/providers/keycloak)
  + [LINE](/providers/line)
  + [LinkedIn](/providers/linkedin)
  + [Mailchimp](/providers/mailchimp)
  + [Mail.ru](/providers/mailru)
  + [Medium](/providers/medium)
  + [Naver](/providers/naver)
  + [Netlify](/providers/netlify)
  + [Okta](/providers/okta)
  + [OneLogin](/providers/onelogin)
  + [Osso](/providers/osso)
  + [osu!](/providers/osu)
  + [Patreon](/providers/patreon)
  + [Pinterest](/providers/pinterest)
  + [Pipedrive](/providers/pipedrive)
  + [Reddit](/providers/reddit)
  + [Salesforce](/providers/salesforce)
  + [Slack](/providers/slack)
  + [Spotify](/providers/spotify)
  + [Strava](/providers/strava)
  + [Todoist](/providers/todoist)
  + [Trakt](/providers/trakt)
  + [Twitch](/providers/twitch)
  + [Twitter](/providers/twitter)
  + [United Effects](/providers/united-effects)
  + [VK](/providers/vk)
  + [Wikimedia](/providers/wikimedia)
  + [WordPress.com](/providers/wordpress)
  + [WorkOS](/providers/workos)
  + [Yandex](/providers/yandex)
  + [Zitadel](/providers/zitadel)
  + [Zoho](/providers/zoho)
  + [Zoom](/providers/zoom)
* [Adapters](/adapters)
* [Warnings](/warnings)
* [Errors](/errors)
* [Deployment](/deployment)
* [Guides](/guides/)
* SponsoredLooking for a
  hosted alternative?[Try Clerk →](https://go.clerk.com/DefS1u4)

* [Providers](/providers/)
* Email
Version: v4On this page
# Email

## Overview[​](#overview "Direct link to heading")

The Email provider uses email to send "magic links" that can be used to sign in, you will likely have seen these if you have used services like Slack before.

Adding support for signing in via email in addition to one or more OAuth services provides a way for users to sign in if they lose access to their OAuth account (e.g. if it is locked or deleted).

The Email provider can be used in conjunction with (or instead of) one or more OAuth providers.

### How it works[​](#how-it-works "Direct link to heading")

On initial sign in, a **Verification Token** is sent to the email address provided. By default this token is valid for 24 hours. If the Verification Token is used within that time (i.e. by clicking on the link in the email) an account is created for the user and they are signed in.

If someone provides the email address of an *existing account* when signing in, an email is sent and they are signed into the account associated with that email address when they follow the link in the email.

tip

The Email Provider can be used with both JSON Web Tokens and database sessions, but you **must** configure a database to use it. It is not possible to enable email sign in without using a database.

## Options[​](#options "Direct link to heading")

The **Email Provider** comes with a set of default options:

* [Email Provider options](https://github.com/nextauthjs/next-auth/blob/v4/packages/next-auth/src/providers/email.ts)

You can override any of the options to suit your own use case.

## Configuration[​](#configuration "Direct link to heading")

NextAuth.js lets you send emails either via HTTP or SMTP.

### HTTP[​](#http "Direct link to heading")

Check out our [HTTP-based Email Provider](https://authjs.dev/guides/configuring-http-email) guide.

### SMTP[​](#smtp "Direct link to heading")

1. NextAuth.js does not include `nodemailer` as a dependency, so you'll need to install it yourself if you want to use the Email Provider. Run `npm install nodemailer` or `yarn add nodemailer`.
2. You will need an SMTP account; ideally for one of the [services known to work with `nodemailer`](https://community.nodemailer.com/2-0-0-beta/setup-smtp/well-known-services/).
3. There are two ways to configure the SMTP server connection.

You can either use a connection string or a `nodemailer` configuration object or transport.

2.1 **Using a connection string**

Create an `.env` file to the root of your project and add the connection string and email address.

.env
```
    EMAIL_SERVER=smtp://username:password@smtp.example.com:587
    EMAIL_FROM=noreply@example.com

```

Now you can add the email provider like this:

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: process.env.EMAIL_SERVER,
    from: process.env.EMAIL_FROM
  }),
],

```

2.2 **Using a configuration object**

In your `.env` file in the root of your project simply add the configuration object options individually:

.env
```
EMAIL_SERVER_USER=username
EMAIL_SERVER_PASSWORD=password
EMAIL_SERVER_HOST=smtp.example.com
EMAIL_SERVER_PORT=587
EMAIL_FROM=noreply@example.com

```

Now you can add the provider settings to the NextAuth.js options object in the Email Provider.

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: {
      host: process.env.EMAIL_SERVER_HOST,
      port: process.env.EMAIL_SERVER_PORT,
      auth: {
        user: process.env.EMAIL_SERVER_USER,
        pass: process.env.EMAIL_SERVER_PASSWORD
      }
    },
    from: process.env.EMAIL_FROM
  }),
],

```

3. Do not forget to setup one of the database [adapters](https://authjs.dev/getting-started/database) for storing the Email verification token.
4. You can now sign in with an email address at `/api/auth/signin`.

A user account (i.e. an entry in the Users table) will not be created for the user until the first time they verify their email address. If an email address is already associated with an account, the user will be signed in to that account when they use the link in the email.

## Customizing emails[​](#customizing-emails "Direct link to heading")

You can fully customize the sign in email that is sent by passing a custom function as the `sendVerificationRequest` option to `EmailProvider()`.

e.g.

pages/api/auth/[...nextauth].js
```
import EmailProvider from "next-auth/providers/email";
...
providers: [
  EmailProvider({
    server: process.env.EMAIL_SERVER,
    from: process.env.EMAIL_FROM,
    sendVerificationRequest({
      identifier: email,
      url,
      provider: { server, from },
    }) {
      /* your function */
    },
  }),
]

```

The following code shows the complete source for the built-in `sendVerificationRequest()` method:

```
import { createTransport } from "nodemailer"

async function sendVerificationRequest(params) {
  const { identifier, url, provider, theme } = params
  const { host } = new URL(url)
  // NOTE: You are not required to use `nodemailer`, use whatever you want.
  const transport = createTransport(provider.server)
  const result = await transport.sendMail({
    to: identifier,
    from: provider.from,
    subject: `Sign in to ${host}`,
    text: text({ url, host }),
    html: html({ url, host, theme }),
  })
  const failed = result.rejected.concat(result.pending).filter(Boolean)
  if (failed.length) {
    throw new Error(`Email(s) (${failed.join(", ")}) could not be sent`)
  }
}

/**
 * Email HTML body
 * Insert invisible space into domains from being turned into a hyperlink by email
 * clients like Outlook and Apple mail, as this is confusing because it seems
 * like they are supposed to click on it to sign in.
 *
 * @note We don't add the email address to avoid needing to escape it, if you do, remember to sanitize it!
 */
function html(params: { url: string, host: string, theme: Theme }) {
  const { url, host, theme } = params

  const escapedHost = host.replace(/\./g, "&#8203;.")

  const brandColor = theme.brandColor || "#346df1"
  const color = {
    background: "#f9f9f9",
    text: "#444",
    mainBackground: "#fff",
    buttonBackground: brandColor,
    buttonBorder: brandColor,
    buttonText: theme.buttonText || "#fff",
  }

  return `
<body style="background: ${color.background};">
  <table width="100%" border="0" cellspacing="20" cellpadding="0"
    style="background: ${color.mainBackground}; max-width: 600px; margin: auto; border-radius: 10px;">
    <tr>
      <td align="center"
        style="padding: 10px 0px; font-size: 22px; font-family: Helvetica, Arial, sans-serif; color: ${color.text};">
        Sign in to <strong>${escapedHost}</strong>
      </td>
    </tr>
    <tr>
      <td align="center" style="padding: 20px 0;">
        <table border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td align="center" style="border-radius: 5px;" bgcolor="${color.buttonBackground}"><a href="${url}"
                target="_blank"
                style="font-size: 18px; font-family: Helvetica, Arial, sans-serif; color: ${color.buttonText}; text-decoration: none; border-radius: 5px; padding: 10px 20px; border: 1px solid ${color.buttonBorder}; display: inline-block; font-weight: bold;">Sign
                in</a></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td align="center"
        style="padding: 0px 0px 10px 0px; font-size: 16px; line-height: 22px; font-family: Helvetica, Arial, sans-serif; color: ${color.text};">
        If you did not request this email you can safely ignore it.
      </td>
    </tr>
  </table>
</body>
`
}

/** Email Text body (fallback for email clients that don't render HTML, e.g. feature phones) */
function text({ url, host }: { url: string, host: string }) {
  return `Sign in to ${host}\n${url}\n\n`
}

```
tip

If you want to generate great looking email client compatible HTML with React, check out <https://mjml.io>

## Customizing the Verification Token[​](#customizing-the-verification-token "Direct link to heading")

By default, we are generating a random verification token. You can define a `generateVerificationToken` method in your provider options if you want to override it:

pages/api/auth/[...nextauth].js
```
providers: [
  EmailProvider({
    async generateVerificationToken() {
      return "ABC123"
    }
  })
],

```
## Normalizing the email address[​](#normalizing-the-email-address "Direct link to heading")

By default, NextAuth.js will normalize the email address. It treats values as case-insensitive (which is technically not compliant to the [RFC 2821 spec](https://datatracker.ietf.org/doc/html/rfc2821), but in practice this causes more problems than it solves, eg. when looking up users by e-mail from databases.) and also removes any secondary email address that was passed in as a comma-separated list. You can apply your own normalization via the `normalizeIdentifier` method on the `EmailProvider`. The following example shows the default behavior:

```
EmailProvider({
  // ...
  normalizeIdentifier(identifier: string): string {
    // Get the first two elements only,
    // separated by `@` from user input.
    let [local, domain] = identifier.toLowerCase().trim().split("@")
    // The part before "@" can contain a ","
    // but we remove it on the domain part
    domain = domain.split(",")[0]
    return `${local}@${domain}`

    // You can also throw an error, which will redirect the user
    // to the error page with error=EmailSignin in the URL
    // if (identifier.split("@").length > 2) {
    //   throw new Error("Only one email allowed")
    // }
  },
})

```
danger

Always make sure this returns a single e-mail address, even if multiple ones were passed in.

## Sending Magic Links To Existing Users[​](#sending-magic-links-to-existing-users "Direct link to heading")

You can ensure that only existing users are sent a magic login link. You will need to grab the email the user entered and check your database to see if the email already exists in the "User" collection in your database. If it exists, it will send the user a magic link but otherwise, you can send the user to another page, such as "/register".

pages/api/auth/[...nextauth].js
```
import User from "../../../models/User";
import db from "../../../utils/db";
...
callbacks: {
  async signIn({ user, account, email }) {
    await db.connect();
    const userExists = await User.findOne({
      email: user.email,  //the user object has an email property, which contains the email the user entered.
    });
    if (userExists) {
      return true;   //if the email exists in the User collection, email them a magic login link
    } else {
      return "/register";
    }
  },
 ...

```
[Edit this page](https://github.com/nextauthjs/next-auth/edit/v4/docs/docs/providers/email.md)Last updated on **Oct 24, 2024** by **Balázs Orbán**[PreviousDuendeIdentityServer6](/providers/duende-identityserver6)[NextEVE Online](/providers/eveonline)

* [Overview](#overview)
  + [How it works](#how-it-works)
* [Options](#options)
* [Configuration](#configuration)
  + [HTTP](#http)
  + [SMTP](#smtp)
* [Customizing emails](#customizing-emails)
* [Customizing the Verification Token](#customizing-the-verification-token)
* [Normalizing the email address](#normalizing-the-email-address)
* [Sending Magic Links To Existing Users](#sending-magic-links-to-existing-users)
About NextAuth.js

* [Introduction](/getting-started/introduction)
Download

* [GitHub](https://github.com/nextauthjs/next-auth)
* [NPM](https://www.npmjs.com/package/next-auth)
Acknowledgements

* [Contributors](/contributors)
* [Sponsors](/sponsors)
* [Images by unDraw](https://undraw.co/)
NextAuth.js © Iain Collins 2025



=== Content from next-auth.js.org_6ff8658c_20250115_101957.html ===

Skip to main contentNextAuth.js is becoming Auth.js! 🎉 We're creating Authentication for the Web. Everyone included. You are looking at the NextAuth.js (v4) documentation. For the new documentation go to [authjs.dev](https://authjs.dev).[![NextAuth Logo](/img/logo/logo-xs.png)![NextAuth Logo](/img/logo/logo-xs.png)**NextAuth.js**](/)[Documentation](/getting-started/introduction)[Tutorials](/tutorials)[FAQ](/faq)[Security](/security)[v4](/getting-started/introduction)

* [v4](/configuration/callbacks)
* [v3](/v3/configuration/callbacks)
* [All Releases](https://github.com/nextauthjs/next-auth/releases)
[npm](https://www.npmjs.com/package/next-auth)[GitHub](https://github.com/nextauthjs/next-auth)Search

* [Getting Started](/getting-started/introduction)
  + [Introduction](/getting-started/introduction)
  + [Getting Started](/getting-started/example)
  + [Client API](/getting-started/client)
  + [REST API](/getting-started/rest-api)
  + [TypeScript](/getting-started/typescript)
  + [Upgrade Guide (v4)](/getting-started/upgrade-v4)
* [Configuration](/configuration/initialization)
  + [Initialization](/configuration/initialization)
  + [Options](/configuration/options)
  + [Providers](/configuration/providers/oauth)
  + [Databases](/configuration/databases)
  + [Pages](/configuration/pages)
  + [Callbacks](/configuration/callbacks)
  + [Events](/configuration/events)
  + [Next.js](/configuration/nextjs)
* [Providers](/providers/)
* [Adapters](/adapters)
* [Warnings](/warnings)
* [Errors](/errors)
* [Deployment](/deployment)
* [Guides](/guides/)
* SponsoredLooking for a
  hosted alternative?[Try Clerk →](https://go.clerk.com/DefS1u4)

* Configuration
* Callbacks
Version: v4On this page
# Callbacks

Callbacks are **asynchronous** functions you can use to control what happens when an action is performed.

Callbacks are extremely powerful, especially in scenarios involving JSON Web Tokens as they allow you to implement access controls without a database and to integrate with external databases or APIs.

tip

If you want to pass data such as an Access Token or User ID to the browser when using JSON Web Tokens, you can persist the data in the token when the `jwt` callback is called, then pass the data through to the browser in the `session` callback.

You can specify a handler for any of the callbacks below.

pages/api/auth/[...nextauth].js
```
...
  callbacks: {
    async signIn({ user, account, profile, email, credentials }) {
      return true
    },
    async redirect({ url, baseUrl }) {
      return baseUrl
    },
    async session({ session, user, token }) {
      return session
    },
    async jwt({ token, user, account, profile, isNewUser }) {
      return token
    }
...
}

```

The documentation below shows how to implement each callback, their default behaviour and an example of what the response for each callback should be. Note that configuration options and authentication providers you are using can impact the values passed to the callbacks.

## Sign in callback[​](#sign-in-callback "Direct link to heading")

Use the `signIn()` callback to control if a user is allowed to sign in.

pages/api/auth/[...nextauth].js
```
...
callbacks: {
  async signIn({ user, account, profile, email, credentials }) {
    const isAllowedToSignIn = true
    if (isAllowedToSignIn) {
      return true
    } else {
      // Return false to display a default error message
      return false
      // Or you can return a URL to redirect to:
      // return '/unauthorized'
    }
  }
}
...

```

* When using the **Email Provider** the `signIn()` callback is triggered both when the user makes a **Verification Request** (before they are sent an email with a link that will allow them to sign in) and again *after* they activate the link in the sign-in email.

  Email accounts do not have profiles in the same way OAuth accounts do. On the first call during email sign in the `email` object will include a property `verificationRequest: true` to indicate it is being triggered in the verification request flow. When the callback is invoked *after* a user has clicked on a sign-in link, this property will not be present.

  You can check for the `verificationRequest` property to avoid sending emails to addresses or domains on a blocklist (or to only explicitly generate them for email address in an allow list).

* When using the **Credentials Provider** the `user` object is the response returned from the `authorize` callback and the `profile` object is the raw body of the `HTTP POST` submission.

note

When using NextAuth.js with a database, the User object will be either a user object from the database (including the User ID) if the user has signed in before or a simpler prototype user object (i.e. name, email, image) for users who have not signed in before.

When using NextAuth.js without a database, the user object will always be a prototype user object, with information extracted from the profile.

note

Redirects returned by this callback cancel the authentication flow. Only redirect to error pages that, for example, tell the user why they're not allowed to sign in.

To redirect to a page after a successful sign in, please use [the `callbackUrl` option](/getting-started/client#specifying-a-callbackurl) or [the redirect callback](/configuration/callbacks#redirect-callback).

## Redirect callback[​](#redirect-callback "Direct link to heading")

The redirect callback is called anytime the user is redirected to a callback URL (e.g. on signin or signout).

By default only URLs on the same URL as the site are allowed, you can use the redirect callback to customise that behaviour.

The default redirect callback looks like this:

pages/api/auth/[...nextauth].js
```
...
callbacks: {
  async redirect({ url, baseUrl }) {
    // Allows relative callback URLs
    if (url.startsWith("/")) return `${baseUrl}${url}`
    // Allows callback URLs on the same origin
    else if (new URL(url).origin === baseUrl) return url
    return baseUrl
  }
}
...

```
note

The redirect callback may be invoked more than once in the same flow.

## JWT callback[​](#jwt-callback "Direct link to heading")

This callback is called whenever a JSON Web Token is created (i.e. at sign
in) or updated (i.e whenever a session is accessed in the client). The returned value will be [encrypted](/configuration/options#jwt), and it is stored in a cookie.

Requests to `/api/auth/signin`, `/api/auth/session` and calls to `getSession()`, `getServerSession()`, `useSession()` will invoke this function, but only if you are using a [JWT session](/configuration/options#session). This method is not invoked when you persist sessions in a database.

* As with database persisted session expiry times, token expiry time is extended whenever a session is active.
* The arguments *user*, *account*, *profile* and *isNewUser* are only passed the first time this callback is called on a new session, after the user signs in. In subsequent calls, only `token` will be available.

The contents *user*, *account*, *profile* and *isNewUser* will vary depending on the provider and if you are using a database. You can persist data such as User ID, OAuth Access Token in this token, see the example below for `access_token` and `user.id`. To expose it on the client side, check out the [`session()` callback](#session-callback) as well.

pages/api/auth/[...nextauth].js
```
...
callbacks: {
  async jwt({ token, account, profile }) {
    // Persist the OAuth access_token and or the user id to the token right after signin
    if (account) {
      token.accessToken = account.access_token
      token.id = profile.id
    }
    return token
  }
}
...

```
tip

Use an if branch to check for the existence of parameters (apart from `token`). If they exist, this means that the callback is being invoked for the first time (i.e. the user is being signed in). This is a good place to persist additional data like an `access_token` in the JWT. Subsequent invocations will only contain the `token` parameter.

## Session callback[​](#session-callback "Direct link to heading")

The session callback is called whenever a session is checked. By default, **only a subset of the token is returned for increased security**. If you want to make something available you added to the token (like `access_token` and `user.id` from above) via the `jwt()` callback, you have to explicitly forward it here to make it available to the client.

e.g. `getSession()`, `useSession()`, `/api/auth/session`

* When using database sessions, the User (`user`) object is passed as an argument.
* When using JSON Web Tokens for sessions, the JWT payload (`token`) is provided instead.

pages/api/auth/[...nextauth].js
```
...
callbacks: {
  async session({ session, token, user }) {
    // Send properties to the client, like an access_token and user id from a provider.
    session.accessToken = token.accessToken
    session.user.id = token.id

    return session
  }
}
...

```
tip

When using JSON Web Tokens the `jwt()` callback is invoked before the `session()` callback, so anything you add to the
JSON Web Token will be immediately available in the session callback, like for example an `access_token` or `id` from a provider.

danger

The session object is not persisted server side, even when using database sessions - only data such as the session token, the user, and the expiry time is stored in the session table.

If you need to persist session data server side, you can use the `accessToken` returned for the session as a key - and connect to the database in the `session()` callback to access it. Session `accessToken` values do not rotate and are valid as long as the session is valid.

If using JSON Web Tokens instead of database sessions, you should use the User ID or a unique key stored in the token (you will need to generate a key for this yourself on sign in, as access tokens for sessions are not generated when using JSON Web Tokens).

[Edit this page](https://github.com/nextauthjs/next-auth/edit/v4/docs/docs/configuration/callbacks.md)Last updated on **Oct 24, 2024** by **Balázs Orbán**[PreviousPages](/configuration/pages)[NextEvents](/configuration/events)

* [Sign in callback](#sign-in-callback)
* [Redirect callback](#redirect-callback)
* [JWT callback](#jwt-callback)
* [Session callback](#session-callback)
About NextAuth.js

* [Introduction](/getting-started/introduction)
Download

* [GitHub](https://github.com/nextauthjs/next-auth)
* [NPM](https://www.npmjs.com/package/next-auth)
Acknowledgements

* [Contributors](/contributors)
* [Sponsors](/sponsors)
* [Images by unDraw](https://undraw.co/)
NextAuth.js © Iain Collins 2025



=== Content from nodemailer.com_5456963c_20250115_102000.html ===

[![Nodemailer](/nm_logo_200x136.png)](https://nodemailer.com)

[Powered by **EmailEngine**](https://emailengine.app/?utm_source=nodemailer&utm_campaign=nodemailer&utm_medium=header-link)

[![](/EmailEngine_logo_vert.png)

Send and receive emails easily with Outlook and Gmail using OAuth2.](https://emailengine.app/?utm_source=nodemailer&utm_campaign=nodemailer&utm_medium=sidebar)

* [**1.** Nodemailer](/about/)
  + [Migration](/about/migrate/)
  + [License](/about/license/)
* [**2.** Usage](/usage/)
  + [SMTP? Say what?](/usage/why-smtp/)
  + [Using Gmail](/usage/using-gmail/)
  + [Delivering bulk mail](/usage/bulk-mail/)
* [**3.** Message configuration](/message/)
  + [Attachments](/message/attachments/)
  + [Alternatives](/message/alternatives/)
  + [Address object](/message/addresses/)
  + [Calendar events](/message/calendar-events/)
  + [Embedded images](/message/embedded-images/)
  + [List headers](/message/list-headers/)
  + [Custom headers](/message/custom-headers/)
  + [Custom source](/message/custom-source/)
* [**4.** SMTP transport](/smtp/)
  + [SMTP envelope](/smtp/envelope/)
  + [Pooled SMTP](/smtp/pooled/)
  + [Testing SMTP](/smtp/testing/)
  + [OAuth2](/smtp/oauth2/)
  + [Custom authentication](/smtp/customauth/)
  + [Proxy support](/smtp/proxies/)
  + [Delivery status notifications](/smtp/dsn/)
* [**5.** Other transports](/transports/)
  + [Sendmail transport](/transports/sendmail/)
  + [SES transport](/transports/ses/)
  + [Stream transport](/transports/stream/)
* [**6.** Plugins](/plugins/)
  + [Create plugins](/plugins/create/)
* [**7.** DKIM](/dkim/)
* [**8.** Extra modules](/extras/)
  + [SMTP Server](/extras/smtp-server/)
  + [SMTP Connection](/extras/smtp-connection/)
  + [Mailparser](/extras/mailparser/)
  + [Mailcomposer](/extras/mailcomposer/)
  + [Node.js daemons](/extras/daemons/)
* [**9.** NodemailerApp](/app/)

![](https://www.paypalobjects.com/en_US/i/scr/pixel.gif)

[Nodemailer](/) > [Message configuration](/message/) > Address object

# Address object

All email addresses can be **plain** email addresses

```
'foobar@example.com'

```

* or with **formatted name** (includes unicode support)

```
'Ноде Майлер <foobar@example.com>'

```
Notice that all address fields (even \*from:\*) are comma separated lists, so if you want to use a comma (or any other special symbol) in the name part, make sure you enclose the name in double quotes like this: `'"Майлер, Ноде" '`

* or as an **address object** (in this case you do not need to worry about the formatting, no need to use quotes etc.)

```
{
    name: 'Майлер, Ноде',
    address: 'foobar@example.com'
}

```

All address fields accept values as a comma separated list of emails or an array of emails or an array of comma separated list of emails or address objects - use it as you like. Formatting can be mixed.

```
...,
to: 'foobar@example.com, "Ноде Майлер" <bar@example.com>, "Name, User" <baz@example.com>',
cc: [
    'foobar@example.com',
    '"Ноде Майлер" <bar@example.com>,
    "Name, User" <baz@example.com>'
],
bcc: [
    'foobar@example.com',
    {
        name: 'Майлер, Ноде',
        address: 'foobar@example.com'
    }
]
...

```

You can even use unicode domains, these are automatically converted to punycode

```
'"Unicode Domain" <info@müriaad-polüteism.info>'

```


