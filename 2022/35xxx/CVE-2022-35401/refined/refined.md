- **Root cause of vulnerability:** The vulnerability stems from the weak generation of the `ifttt_stoken` and the reliance on the device's uptime for token validation. The `ifttt_stoken` is derived from a random number modulo 0xFF, resulting in only 255 possible values, making it easily brute-forceable. Furthermore, the timestamp used for token validity is based on device uptime, which resets upon reboot, thus making the old token valid again.
- **Weaknesses/vulnerabilities present:**
    - Weak `ifttt_stoken` generation due to limited keyspace.
    - Use of device uptime for token expiration validation, which is reset upon reboot.
    - `ifttt_stoken` and `ifttt_timestamp` are not cleared from nvram even if the associated features are disabled.
- **Impact of exploitation:** Successful exploitation allows an attacker to gain full administrative access to the device.
- **Attack vectors:**
    - The attack involves sending HTTP requests to the `get_IFTTTtoken.cgi` endpoint with a `shortToken` query parameter.
    - The attacker must send the request with a User-Agent header starting with "asusrouter" and containing "IFTTT" or "Alexa".
    - The attacker must guess/brute-force the `ifttt_stoken`, which has a limited keyspace.
    -  The attacker can trigger a device reboot to make previously generated tokens valid again.
- **Required attacker capabilities/position:**
    - The attacker needs network access to the router, either local or remote if WAN access is enabled.
    - The attacker must craft specific HTTP requests.
    - The attacker can use brute-force methods to guess the short token.
    - The attacker may need to induce a reboot for previously generated tokens to be valid.