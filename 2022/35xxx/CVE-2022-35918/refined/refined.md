Based on the provided content, here's an analysis of CVE-2022-35918:

**Root cause of vulnerability:**

The vulnerability stems from a directory traversal flaw within the Streamlit framework when handling requests for custom components. Specifically, the Streamlit server did not properly restrict file access within the custom component directory. This allowed a crafted URL to traverse outside of the designated component directory, potentially accessing files in other parts of the server's file system.

**Weaknesses/vulnerabilities present:**

- **Directory Traversal:** The core vulnerability is a lack of proper input sanitization or validation for file paths requested when serving custom component files. This allows an attacker to use "..", absolute paths, or symlinks to access files outside the intended directory.

**Impact of exploitation:**

- **Information Disclosure:** Successful exploitation could lead to the disclosure of sensitive server files, including logs, world-readable files, and potentially other confidential information located on the web server's filesystem.

**Attack vectors:**

- **Malicious URLs:** Attackers can craft malicious URLs that include file paths designed to traverse outside the custom component directory. The Streamlit server processes the requested URL and exposes the content of the referenced file.

**Required attacker capabilities/position:**

- **Network Access:** The attacker must be able to send HTTP requests to the vulnerable Streamlit server.
- **Knowledge of vulnerable component:** The attacker needs to know that the target application uses custom components, and how these component files are requested.

**Additional Notes:**

-   The provided content includes a commit that addresses the vulnerability (80d9979). This commit includes code changes to prevent access outside the custom component directory using `os.path.commonprefix` check.
-   The fix also includes new tests to prevent regressions.
-   The advisory mentions that the vulnerability affects versions of Streamlit from 0.63.0 to 1.11.0, and was fixed in version 1.11.1.
-   The CVSS score for this vulnerability is 6.5, classified as moderate severity due to the confidentiality impact, with a low attack complexity and no privileges required.