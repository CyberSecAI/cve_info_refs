=== Content from www.ec-cube.net_f5606960_20250114_230459.html ===

# EC-CUBE用プラグイン「商品画像一括アップロードプラグイン」におけるアップロードファイルの検証不備の脆弱性(JVN#30900552)

##### 更新履歴

2022/09/15 16:50
JVNからの公表内容情報へのリンクを追加

2022/09/14 13:00
脆弱性の名称をJVN公表内容と合わせました(※脆弱性の内容に変更はありません)

2022/09/09 10:00
初版公開

## EC-CUBE用プラグイン「商品画像一括アップロードプラグイン」におけるアップロードファイルの検証不備の脆弱性のお知らせ

EC-CUBE用プラグイン「商品画像一括アップロードプラグイン」に脆弱性(危険度: 低)があることが判明いたしました。

脆弱性そのものは、修正の反映によりすぐに解決するものです。以下のいずれかの方法により、ご対応をお願いいたします。

* 修正方法1: プラグインのバージョンアップを行う場合
* 修正方法2: 修正差分を確認して適宜反映する場合

皆様にはお手数おかけし誠に申し訳ございません。

本脆弱性における被害報告は現時点でございませんが、できるだけ速やかにご対応をお願いいたします。

## 脆弱性の概要

### EC-CUBE用プラグイン「商品画像一括アップロードプラグイン」におけるアップロードファイルの検証不備の脆弱性

#### 危険度:

低

#### 不具合が存在する「商品画像一括アップロードプラグイン」のバージョン:

* 1.0.0 (EC-CUBE 4系対応)
* 4.1.0 (EC-CUBE 4系対応)

#### 詳細:

商品画像一括アップロードプラグインには、不正なファイルがアップロード可能な脆弱性が存在します。

### JVNからの公表内容 (2022/09/15公開)

[JVN#30900552 EC-CUBE 用プラグイン「商品画像一括アップロードプラグイン」におけるアップロードファイルの検証不備の脆弱性](https://jvn.jp/jp/JVN30900552/)

## 修正方法1: プラグインのバージョンアップを行う場合

「商品画像一括アップロードプラグイン」を最新版にバージョンアップしていただくことで、本件の脆弱性は修正されます。ご利用の方は、速やかにプラグインのバージョンアップをお願いいたします。

#### 修正済みプラグインのバージョン

* **バージョン 4.1.1 (EC-CUBE 4系対応)**

## 修正方法2: 修正差分を確認して適宜反映する場合

下記のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。

### 対象バージョン

* **バージョン 4.1.0 (EC-CUBE 4系対応)**

### 修正差分

#### ■ バージョン 4.1.0 (EC-CUBE 4系対応)

##### 対象ファイル

* app/Plugin/ProductImagesUploader/Controller/Admin/ConfigController.php

 Controller/Admin/ConfigController.php
CHANGED

Viewed

|  | @@ -20,6 +20,7 @@ use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template; |
| --- | --- |
| 20 20 | use Symfony\Component\EventDispatcher\EventDispatcherInterface; |
| 21 21 | use Symfony\Component\Filesystem\Filesystem; |
| 22 22 | use Symfony\Component\Finder\Finder; |
| 23 | + use Symfony\Component\HttpFoundation\File\File; |
| 23 24 | use Symfony\Component\HttpFoundation\File\UploadedFile; |
| 24 25 | use Symfony\Component\HttpFoundation\Request; |
| 25 26 | use Symfony\Component\HttpKernel\Event\PostResponseEvent; |
|  | @@ -63,7 +64,27 @@ class ConfigController extends AbstractController |
| 63 64 |  |
| 64 65 | return $this->redirectToRoute('product\_images\_uploader\_admin\_config'); |
| 65 66 | } |
| 67 | +  $count = $finder->in($tmpDir) |
| 68 | +  ->files() |
| 69 | +  ->ignoreDotFiles(false) |
| 70 | +  ->filter(function (\SplFileInfo $file) { |
| 71 | +  $file = new File($file->getRealPath()); |
| 72 | +  if (strpos($file->getMimeType(), 'image') === 0) { |
| 66 73 |  |
| 74 | +  return false; |
| 75 | +  } |
| 76 | +  if (in\_array(strtolower($file->getExtension()), ['gif', 'jpg', 'jpeg', 'png'])) { |
| 77 | + |
| 78 | +  return false; |
| 79 | +  } |
| 80 | + |
| 81 | +  return true; |
| 82 | +  })->count(); |
| 83 | +  if ($count > 0) { |
| 84 | +  $this->addError('zipファイル内に画像以外のファイルが含まれています。', 'admin'); |
| 85 | + |
| 86 | +  return $this->redirectToRoute('product\_images\_uploader\_admin\_config'); |
| 87 | +  } |
| 67 88 | // save\_imageへコピー |
| 68 89 | $fs->mirror($tmpDir, $this->eccubeConfig->get('eccube\_save\_image\_dir')); |
| 69 90 |  |



=== Content from jvn.jp_bc707abe_20250114_230458.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/09/15  Last Updated:2022/09/15
# JVN#30900552 EC-CUBE plugin "Product Image Bulk Upload Plugin" vulnerable to insufficient verification in uploading files

## Overview

EC-CUBE plugin "Product Image Bulk Upload Plugin" provided by EC-CUBE CO.,LTD. contains an insufficient verification vulnerability when uploading files.

## Products Affected

* EC-CUBE plugin "Product Image Bulk Upload Plugin" 1.0.0
* EC-CUBE plugin "Product Image Bulk Upload Plugin" 4.1.0

## Description

EC-CUBE plugin "Product Image Bulk Upload Plugin", a plugin that enables to upload image files, provided by EC-CUBE CO.,LTD. contains an insufficient verification vulnerability when uploading files ([CWE-20](https://cwe.mitre.org/data/definitions/20.html)).

Exploiting this vulnerability allows a remote unauthenticated attacker to upload arbitrary files other than image files.

## Impact

One of the attack scenarios and the possible impacts is as follows:

If a user with an administrative privilege of EC-CUBE where the vulnerable plugin is installed is led to uploads a specially crafted file, an arbitrary script may be executed on the system.

## Solution

**Update the plugin**

Update the plugin to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| EC-CUBE CO.,LTD. | [Vulnerable](491122/index.html) | 2022/09/15 | [EC-CUBE CO.,LTD. website](https://www.ec-cube.net/info/weakness/20220909/product_images_uploader.php) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L
Base Score:
6.3

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:H/Au:N/C:P/I:P/A:P
Base Score:
5.1

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

EC-CUBE CO.,LTD. reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and EC-CUBE CO.,LTD. coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2022-37346](https://www.cve.org/CVERecord?id=CVE-2022-37346) |
| JVN iPedia | [JVNDB-2022-000072](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000072) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.


