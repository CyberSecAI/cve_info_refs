- **Root cause of vulnerability:** Use-after-free in the JavaScript engine of Foxit PDF Reader when handling media player events. The `closeDoc` call frees memory associated with a media player object, which is then accessed by a page close action, leading to a use-after-free.
- **Weaknesses/vulnerabilities present:** Use-after-free vulnerability (CWE-416). The issue stems from asynchronous execution of document close and page close events, which leads to memory being freed while still being referenced by JavaScript code.
- **Impact of exploitation:** Arbitrary code execution. Attackers can use the vulnerability to gain control of the application by manipulating memory after it is freed, allowing for code injection and execution.
- **Attack vectors:**
  - Opening a specially-crafted malicious PDF document.
  - Visiting a malicious website with a specially crafted page when the browser plugin extension is enabled.
- **Required attacker capabilities/position:**
  - The attacker needs to be able to deliver a malicious PDF document to the victim, or have them visit a malicious website.
  - The victim needs to open the malicious file or visit the malicious website with an enabled browser plugin.