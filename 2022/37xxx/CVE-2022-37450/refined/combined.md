=== Content from news.ycombinator.com_726b4163_20250114_215440.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D32354896) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Israeli researchers discovered the first consensus-level attack on Ethereum](https://twitter.com/yaish_aviv/status/1555445499041300481) ([twitter.com/yaish\_aviv](from?site=twitter.com/yaish_aviv)) | | --- | --- | --- | |  | | 185 points by [cryptoisthekey](user?id=cryptoisthekey) [on Aug 5, 2022](item?id=32354896)  | [hide](hide?id=32354896&goto=item%3Fid%3D32354896) | [past](https://hn.algolia.com/?query=Israeli%20researchers%20discovered%20the%20first%20consensus-level%20attack%20on%20Ethereum&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=32354896&auth=bc2e67bd375565c0bfd6499e8d25f15c8be16aef) | [55 comments](item?id=32354896) |  | |  |  | [ogogmad](user?id=ogogmad) [on Aug 5, 2022](item?id=32357215)   | [next](#32355955) [–]  This might not even be news to the people in the knows. @foldfinance says *We have known this to be the case with F2Pool for awhile but flashbots refuses to do anything* See [https://nitter.42l.fr/foldfinance/status/1555477252736897024...](https://nitter.42l.fr/foldfinance/status/1555477252736897024#m) @railgun\_project says *This is a well known drawback of proof-of-work systems that was talked about even before Ethereum was launched. It is inaccurate to say that this is a recent "disclosure"* See [https://nitter.42l.fr/railgun\_project/status/155556027729019...](https://nitter.42l.fr/railgun_project/status/1555560277290192896#m) @mesquka says *Not as big of a discovery as it's made to seem IMO. Essentially just intentionally caused temporary chain forks to gain a competitive mining advantage. Known as an issue in PoW since Bitcoin launch (see any discussion about 'Longest Chain Rule' and things like 'Selfish Mining')* See <https://nitter.42l.fr/mesquka/status/1555562671575023618#m> | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [paulmd](user?id=paulmd) [on Aug 5, 2022](item?id=32359925)   | [parent](#32357215) | [next](#32358532) [–]  > @railgun\_project says This is a well known drawback of proof-of-work systems that was talked about even before Ethereum was launched. It is inaccurate to say that this is a recent "disclosure" this isn't an inherent weakness of proof-of-work systems, it's a weakness of proof-of-work systems *that allow difficulty back-off if a block is not found quickly enough*. It's always been kinda hilarious watching the various crypto factions slapfight and strawman each other to hell and back... ladies, please, you're all awful, each in your own way. (coming from a person who backs neither and merely follows crypto-tech in order to refute the arguments more accurately) | | --- | --- | --- | | | |  |  | [dickmd](user?id=dickmd) [on Aug 5, 2022](item?id=32360849)   | [root](#32357215) | [parent](#32359925) | [next](#32358532) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [paulmd](user?id=paulmd) [on Aug 5, 2022](item?id=32361009)   | [root](#32357215) | [parent](#32360849) | [next](#32358532) [–]  > created: 13 minutes ago hmmmmmmm | | --- | --- | --- | | | |  |  | [Ar-Curunir](user?id=Ar-Curunir) [on Aug 5, 2022](item?id=32358532)   | [parent](#32357215) | [prev](#32359925) | [next](#32355955) [–]  All the tweets about it being a well known drawback are missing the point: yes, we knew that there's a general class of attacks affecting PoW this way, but it's the first time AFAIK that there's been public evidence of this attack actually occurring. | | --- | --- | --- | | | |  |  | [shmoneforeight](user?id=shmoneforeight) [on Aug 6, 2022](item?id=32365148)   | [root](#32357215) | [parent](#32358532) | [next](#32355955) [–]  To reaffirm Ar-Curunir, even the author of the original selfish mining paper thinks this is a big deal: <https://twitter.com/ittayeyal/status/1555665714178101249> | | --- | --- | --- | | | |  |  | [shmoneforeight](user?id=shmoneforeight) [on Aug 6, 2022](item?id=32368612)   | [root](#32357215) | [parent](#32365148) | [next](#32355955) [–]  And now, the second author of the selfish mining paper joins in: <https://twitter.com/el33th4xor/status/1555926860067921920> | | --- | --- | --- | | | |  |  | [cryptoisthekey](user?id=cryptoisthekey) [on Aug 6, 2022](item?id=32369943)   | [root](#32357215) | [parent](#32368612) | [next](#32355955) [–]  Finally, even @foldfinance and @mesquka are toning down their comments. @foldfinance: "F2pool is doing additional exploitive behavior besides the one described here, sorry if that was not clear in our tweet." @mesquka: "Yes, the specific execution of this particular attack is unique to ethereum due to it's dynamic difficulty adjustment, but block withholding and timestamp manipulation as a class of attacks are well known." | | --- | --- | --- | | | |  |  | [yuan43](user?id=yuan43) [on Aug 5, 2022](item?id=32355955)   | [prev](#32357215) | [next](#32354897) [–]  > Whenever F2Pool's block timestamps reach the point where mining difficulty is supposed to decrease, they artificially set them to be one second earlier. F2Pool has been executing this attack over the past two years, and the evidence has been hiding in plain sight! ... This has the effect of making it harder for the rest of the network to compete against F2Pool's blocks. In this way, F2Pool can, or so it appears, give itself an advantage while taking zero risk. It would be irrational *not* to adopt this strategy. The thread doesn't say what happens if the entire network adopts this strategy - maybe it's in the paper... | | --- | --- | --- | | | |  |  | [mw888](user?id=mw888) [on Aug 6, 2022](item?id=32365580)   | [parent](#32355955) | [next](#32354897) [–]  This issue actually seems less severe than selfish meaning exactly for the reason that all miners can enact it to the same proportional benefit. | | --- | --- | --- | | | |  |  | [cryptoisthekey](user?id=cryptoisthekey) [on Aug 5, 2022](item?id=32354897)   | [prev](#32355955) | [next](#32355547) [–]  The attack is called "Uncle Maker", as it allows attackers to displace main-chain blocks with their own blocks, thus making these displaced blocks become uncles. By analyzing the timestamps of the last 3 million blocks, it becomes apparent that F2Pool has performed the attack in the wild. | | --- | --- | --- | | | |  |  | [aaaaaaaaata](user?id=aaaaaaaaata) [on Aug 5, 2022](item?id=32355559)   | [parent](#32354897) | [next](#32355547) [–]  What is the implication of the findings? | | --- | --- | --- | | | |  |  | [xbar](user?id=xbar) [on Aug 5, 2022](item?id=32356838)   | [root](#32354897) | [parent](#32355559) | [next](#32355640) [–]  Probably that if you weren't mining on f2pool for the last few years you were severely disadvantaged, and that if every other pool doesn't start executing this "attack", they are not playing the ETH game correctly. | | --- | --- | --- | | | |  |  | [mistrial9](user?id=mistrial9) [on Aug 5, 2022](item?id=32358973)   | [root](#32354897) | [parent](#32356838) | [next](#32355640) [–]  exaggeration does not lend clarity .. an advantage is short-lived, like so many opportunistic moves in real life? the math says that the "severity" of the disadvantage is related to the change in difficulty at that juncture | | --- | --- | --- | | | |  |  | [sschueller](user?id=sschueller) [on Aug 5, 2022](item?id=32355640)   | [root](#32354897) | [parent](#32355559) | [prev](#32356838) | [next](#32355698) [–]  ETH 2.0 delayed by another year... | | --- | --- | --- | | | |  |  | [quickthrower2](user?id=quickthrower2) [on Aug 5, 2022](item?id=32355919)   | [root](#32354897) | [parent](#32355640) | [next](#32362886) [–]  ETH 2.0 sounds like commercial fusion power. | | --- | --- | --- | | | |  |  | [pelagicAustral](user?id=pelagicAustral) [on Aug 5, 2022](item?id=32356039)   | [root](#32354897) | [parent](#32355919) | [next](#32356182) [–]  Half-Life 3 much? | | --- | --- | --- | | | |  |  | [api](user?id=api) [on Aug 5, 2022](item?id=32356182)   | [root](#32354897) | [parent](#32355919) | [prev](#32356039) | [next](#32362886) [–]  There's steady but slow progress in fusion in energy density and power output, so no. | | --- | --- | --- | | | |  |  | [inphovore](user?id=inphovore) [on Aug 5, 2022](item?id=32360166)   | [root](#32354897) | [parent](#32356182) | [next](#32362886) [–]  The issue with fusion has been the same for the last 50 years. Harvesting the gamma’s full electron volt right out of the reaction. We’re still 50+ years away. Nothing in modern technology suggests otherwise. Science media has to explain why billions are dumped into these programs each year (as though edge science isn’t enough.) In the meantime, everyone will be happy if we can harvest just enough to make the cost of the exchange worth while. most optimistically through harvesting the heat from a sustained reaction (which is 1000 x less potential). | | --- | --- | --- | | | |  |  | [shakezula](user?id=shakezula) [on Aug 5, 2022](item?id=32362886)   | [root](#32354897) | [parent](#32355640) | [prev](#32355919) | [next](#32355698) [–]  Why would this have anything to do with Eth2 when it’s explicitly a vulnerability in Proof of Work systems? | | --- | --- | --- | | | |  |  | [oneoff786](user?id=oneoff786) [on Aug 5, 2022](item?id=32355698)  [flagged]  | [root](#32354897) | [parent](#32355559) | [prev](#32355640) | [next](#32355547) [2 more]  Good for crypto | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [on Aug 5, 2022](item?id=32355753)   | [root](#32354897) | [parent](#32355698) | [next](#32355547) [–]  Could you please stop posting unsubstantive and/or flamebait comments? You've been doing it a lot, unfortunately, and it's not what this site is for. <https://news.ycombinator.com/newsguidelines.html> | | --- | --- | --- | | | |  |  | [mjburgess](user?id=mjburgess) [on Aug 5, 2022](item?id=32355547)   | [prev](#32354897) | [next](#32355360) [–]  > Although most mining pools produce relatively inconspicuous-looking blocks, F2Pool blatantly disregards the rules and uses false timestamps for its blocks. Specifically, whenever a block should have a timestamp difference from its parent which is divisible by 9 (precisely the time at which mining difficulty decreases), F2Pool hangs at the preceding second a while longer, thereby increasing mining difficulty and profits. Thus, in the past two years, F2Pool didn’t have even a single block with a timestamp which is divisible by 9. from the medium post | | --- | --- | --- | | | |  |  | [\_\_s](user?id=__s) [on Aug 5, 2022](item?id=32355924)   | [parent](#32355547) | [next](#32356152) [–]  What's the implication if everyone does this? Does it eventually converge on a working consensus? | | --- | --- | --- | | | |  |  | [quickthrower2](user?id=quickthrower2) [on Aug 5, 2022](item?id=32356152)   | [parent](#32355547) | [prev](#32355924) | [next](#32355360) [–]  Having read bits of the paper and the article I don't get why divisibility by 9 matters. Can anyone ELI-9 this? | | --- | --- | --- | | | |  |  | [horsawlarway](user?id=horsawlarway) [on Aug 5, 2022](item?id=32356282)   | [root](#32355547) | [parent](#32356152) | [next](#32356475) [–]  I haven't done the math, but I believe it's because of two points: 1 - The "difficulty" of mining a block is based on how long it's been since the last block was mined, with a drop off in difficulty at 9 seconds 2 - If two blocks "tie", the the block that was more difficult to mine is the winner, and takes the rewards. --- So essentially, it's a way of breaking ties in their favor - reliably - by cheating a smidge on the timestamps they send for their blocks. | | --- | --- | --- | | | |  |  | [tromp](user?id=tromp) [on Aug 5, 2022](item?id=32356475)   | [root](#32355547) | [parent](#32356152) | [prev](#32356282) | [next](#32355360) [–]  It matters according to equation (48) on page 7 in the Ethereum design specification [1]. This section specifies how to adjust the difficulty target for each new block. The optimization (I hesitate to call it an attack) identified in the paper could have been rendered ineffective if rounding down (for division by 2048 and by 9) was delayed until *after* the multiplication in equation (45), resulting in a much smoother adjustment. The so-called "yellow paper" sadly lacks a motivation of all the seemingly arbitrary numbers involved. [1] <https://ethereum.github.io/yellowpaper/paper.pdf> | | --- | --- | --- | | | |  |  | [NickRandom](user?id=NickRandom) [on Aug 5, 2022](item?id=32355360)   | [prev](#32355547) | [next](#32357776) [–]  See also - Uncle Maker: (Time)Stamping Out The Competition in Ethereum ( [https://www.researchgate.net/publication/362482526\_Uncle\_Mak...](https://www.researchgate.net/publication/362482526_Uncle_Maker_TimeStamping_Out_The_Competition_in_Ethereum) ) | | --- | --- | --- | | | |  |  | [creeble](user?id=creeble) [on Aug 5, 2022](item?id=32357776)   | [prev](#32355360) | [next](#32357332) [–]  Has this strategy been used successfully in Bitcoin, or why not? | | --- | --- | --- | | | |  |  | [Synaesthesia](user?id=Synaesthesia) [on Aug 5, 2022](item?id=32357847)   | [parent](#32357776) | [next](#32357332) [–]  As the 2nd tweet explains, the difficulty of Ethereum changes dynamically amd can decrease the longer that a block hasnt been mined, this is not the case in Bitcoin. | | --- | --- | --- | | | |  |  | [infthi](user?id=infthi) [on Aug 5, 2022](item?id=32358807)   | [root](#32357776) | [parent](#32357847) | [next](#32362913) [–]  Bitcoin also adjust difficulty - but does that every two weeks or so. would it make sense to mine for a sibling for the last block before the difficulty increase while everyone else mines for a child block with increased difficulty? thus having twice the relative hashrate for 10 min every time difficulty increases. | | --- | --- | --- | | | |  |  | [game-of-throws](user?id=game-of-throws) [on Aug 5, 2022](item?id=32362615)   | [root](#32357776) | [parent](#32358807) | [next](#32362913) [–]  No, this attack wouldn't work on bitcoin. Bitcoin chooses the chain with the most total work (which is blocks x difficulty), not the most blocks. Else someone could fork the chain from a block sometime in 2009 when difficulty was very low and outpace the rest of the network. | | --- | --- | --- | | | |  |  | [shakezula](user?id=shakezula) [on Aug 5, 2022](item?id=32362913)   | [root](#32357776) | [parent](#32357847) | [prev](#32358807) | [next](#32357332) [–]  This is not true. Bitcoin has a difficulty adjustment. <https://www.blockchain.com/charts/difficulty> [https://www.coindesk.com/learn/bitcoin-mining-difficulty-eve...](https://www.coindesk.com/learn/bitcoin-mining-difficulty-everything-you-need-to-know/) | | --- | --- | --- | | | |  |  | [mw888](user?id=mw888) [on Aug 6, 2022](item?id=32365596)   | [root](#32357776) | [parent](#32362913) | [next](#32357332) [–]  It was true, but they didn’t specify that Bitcoin adjusts difficulty when the new block is published, not ever while waiting for a block. | | --- | --- | --- | | | |  |  | [mypastself](user?id=mypastself) [on Aug 5, 2022](item?id=32357332)   | [prev](#32357776) | [next](#32356713) [–]  Even for someone with a reasonable amount of knowledge in the area, this was a difficult read. “…the attack does not entail any behavior which has a non-zero probability of earning less than mining honestly…” | | --- | --- | --- | | | |  |  | [cwmma](user?id=cwmma) [on Aug 5, 2022](item?id=32363082)   | [parent](#32357332) | [next](#32356713) [–]  Yeah I had to read that a few times due to to a triple negative and a comparison, I think it's trying to say that the strategy has no parts that have any chance of earning you less money then normal. | | --- | --- | --- | | | |  |  | [ironSkillet](user?id=ironSkillet) [on Aug 5, 2022](item?id=32356713)   | [prev](#32357332) | [next](#32356485) [–]  Maybe it's just that hindsight is 20/20, but given how simple this trick is, I'm surprised this wasn't obvious to someone when declaring the policy. | | --- | --- | --- | | | |  |  | [Majromax](user?id=Majromax) [on Aug 5, 2022](item?id=32357200)   | [parent](#32356713) | [next](#32356485) [–]  It seems to me that there's a delicate, probably impossible balance: the difficulty decreases at the critical times, but not fast enough to compensate for the tiebreak. Suppose the difficulty decreased by a *lot*: at 0:59 it is effectively impossible to mine a block but at 1:00 it is so easy that a speak-and-spell could do it. In that case, it seems like the optimum strategy for a selfish miner would be to try to post-date the timestamp and mine an "easy" block. It would still lose to a legitimately-mined "hard" block, but it would profit in expectation by being the first "easy" block to reach the network. On the other hand, setting a difficulty schedule such that there is no single optimum timestamp might impose a too-fast decay on difficulty. | | --- | --- | --- | | | |  |  | [TacticalCoder](user?id=TacticalCoder) [on Aug 5, 2022](item?id=32356485)   | [prev](#32356713) | [next](#32356163) [–]  Is this an attack on PoW or PoS? For Ethereum, since quite a while, is already mining blocks on both the PoW and the PoS chain. | | --- | --- | --- | | | |  |  | [vivegi](user?id=vivegi) [on Aug 5, 2022](item?id=32356534)   | [parent](#32356485) | [next](#32356163) [–]  From the paper: > We introduce a novel attack vector on proof-of-work (PoW) cryptocurrencies which relieson timestamp manipulations, instead of traditional ones such as block withholding | | --- | --- | --- | | | |  |  | [ogogmad](user?id=ogogmad) [on Aug 5, 2022](item?id=32356163)   | [prev](#32356485) | [next](#32356083) [–]  ETH price unaffected by the news, it seems. | | --- | --- | --- | | | |  |  | [mw888](user?id=mw888) [on Aug 6, 2022](item?id=32365618)   | [parent](#32356163) | [next](#32357088) [–]  This news is not as bad as known advantages which can be exploited in PoW for several years now, namely selfish mining, which only benefits the largest or most coordinated miners. This attack is open for all, which effectively cancels out the advantage it offers (assuming everyone does it); the externalization is consistent, minor inaccuracies of time stamps on blocks. | | --- | --- | --- | | | |  |  | [spookthesunset](user?id=spookthesunset) [on Aug 5, 2022](item?id=32357088)   | [parent](#32356163) | [prev](#32365618) | [next](#32357981) [–]  Cryptocurrency never seems to track against real world events. Kinda makes you wonder how much of its volume is legit. | | --- | --- | --- | | | |  |  | [spamizbad](user?id=spamizbad) [on Aug 5, 2022](item?id=32357170)   | [root](#32356163) | [parent](#32357088) | [next](#32362930) [–]  Ah but it does get impacted by things like interest rates and tech stocks. | | --- | --- | --- | | | |  |  | [spookthesunset](user?id=spookthesunset) [on Aug 5, 2022](item?id=32357203)   | [root](#32356163) | [parent](#32357170) | [next](#32362930) [–]  Very true. And arguably government stimulus checks too. But bad news? Your crypto coin has a documented flaw that allows it to be manipulated? Good news for your coin! | | --- | --- | --- | | | |  |  | [shakezula](user?id=shakezula) [on Aug 5, 2022](item?id=32362930)   | [root](#32356163) | [parent](#32357088) | [prev](#32357170) | [next](#32357981) [–]  weird time to make this argument in the wake of the latest cryptocurrency downturn which tracked almost lockstep with the stock market. | | --- | --- | --- | | | |  |  | [timbit42](user?id=timbit42) [on Aug 5, 2022](item?id=32357981)   | [parent](#32356163) | [prev](#32357088) | [next](#32356083) [–]  As Eth is moving to PoS soon, I'd expect it have to affect Bitcoin's price more. | | --- | --- | --- | | | |  |  | [doomroot](user?id=doomroot) [on Aug 5, 2022](item?id=32358238)   | [root](#32356163) | [parent](#32357981) | [next](#32356083) [–]  This does not work on bitcoin. Bitcoin’s difficulty targeting algorithm only retargets every 2016 blocks. This attack is only possible for diff target algos that retarget within a single block slot. | | --- | --- | --- | | | |  |  | [arisAlexis](user?id=arisAlexis) [on Aug 5, 2022](item?id=32356083)   | [prev](#32356163) | [next](#32358611) [–]  doesn't matter, ETH turns to PoS very soon | | --- | --- | --- | | | |  |  | [chpatrick](user?id=chpatrick) [on Aug 5, 2022](item?id=32357540)   | [parent](#32356083) | [next](#32357583) [–]  Seems like it's been a PoS for a few years. | | --- | --- | --- | | | |  |  | [foepys](user?id=foepys) [on Aug 5, 2022](item?id=32357583)   | [parent](#32356083) | [prev](#32357540) | [next](#32358611) [–]  This has the same energy as fusion power is only 30 years away. I have been hearing this since at least 2019. | | --- | --- | --- | | | |  |  | [affinepplan](user?id=affinepplan) [on Aug 5, 2022](item?id=32358177)   | [root](#32356083) | [parent](#32357583) | [next](#32358611) [–]  ok but---it's literally set to merge in like a month. It did get delayed for quite a while yes, but it's happening now for realsies | | --- | --- | --- | | | |  |  | [delaaxe](user?id=delaaxe) [on Aug 5, 2022](item?id=32358611)   | [prev](#32356083) [–]  Guess what? Ethereum is switching from proof of work to proof of stake in about a month, so all of this is irrelevant | | --- | --- | --- | | | |  |  | [xeromal](user?id=xeromal) [on Aug 5, 2022](item?id=32358643)   | [parent](#32358611) | [next](#32365628) [–]  This seems like a bit hostile for some cool research | | --- | --- | --- | | | |  |  | [mw888](user?id=mw888) [on Aug 6, 2022](item?id=32365628)   | [parent](#32358611) | [prev](#32358643) | [next](#32358650) [–]  Didn’t read the article? They say at the end if this is how Eth manages a known consensus system, it reflects poorly on how they will implement a far more complicated and unexplored one. | | --- | --- | --- | | | |  |  | [mr90210](user?id=mr90210) [on Aug 5, 2022](item?id=32358650)   | [parent](#32358611) | [prev](#32365628) [–]  Ok | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from medium.com_e7508625_20250114_215437.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd27c1cb62fef&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40aviv.yaish%2Funcle-maker-time-stamping-out-the-competition-in-ethereum-d27c1cb62fef&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40aviv.yaish%2Funcle-maker-time-stamping-out-the-competition-in-ethereum-d27c1cb62fef&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Uncle Maker: (Time)Stamping Out The Competition in Ethereum

[![Aviv Yaish](https://miro.medium.com/v2/resize:fill:88:88/1*segQFIFyuge7WeCrK8w04g.jpeg)](/%40aviv.yaish?source=post_page---byline--d27c1cb62fef--------------------------------)

[Aviv Yaish](/%40aviv.yaish?source=post_page---byline--d27c1cb62fef--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb48dad205d28&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40aviv.yaish%2Funcle-maker-time-stamping-out-the-competition-in-ethereum-d27c1cb62fef&user=Aviv+Yaish&userId=b48dad205d28&source=post_page-b48dad205d28--byline--d27c1cb62fef---------------------post_header-----------)

4 min read·Aug 5, 2022

--

5

Listen

Share

The First Evidence of An Attack on a Major Cryptocurrency

In a new [paper](https://eprint.iacr.org/2022/1020), we ([Aviv Yaish](http://avivyaish.com), [Gilad Stern](https://giladstern.github.io/) & [Aviv Zohar](http://avivz.net)) present and analyze a new attack vector on Proof-of-Work cryptocurrencies, such as Ethereum. We then go over recent Ethereum blocks to give the ***first*** evidence of a consensus-level attack executed in the wild on a major cryptocurrency!

![]()

A succinct description of our attack, in meme-form.

## Mining Difficulty in Ethereum

In Ethereum, the difficulty of mining the current block changes on-the-fly and decreases the longer the time that has passed without anyone mining a new valid block; this is done to ensure that inter-block times will not be too high in expectation. **What could go wrong?**

![]()

In Ethereum, mining difficulty changes on-the-fly.

## (Time)Stamping Out The Competition

The time between blocks, and thus also mining difficulty, is determined according to block timestamps. The problem with this is that miners have a certain degree of freedom when setting them, and can even set false timestamps. For example, a miner can start mining a block now, but set the block’s timestamp to actually be 5 seconds in the past, or 10 seconds in the future. As long as this timestamp is within a certain reasonable bound, the block will still be considered valid, according to Ethereum’s consensus laws.

These same consensus laws say that in case of ties between blocks of the same height, the block with a higher total mining difficulty should be picked to be the parent of the currently mined block, while the other one should be its uncle.

Thus, a miner who wishes to replace the last block on the blockchain, can do so by mining a new block of its own which has a timestamp which is low enough to increase the block’s mining difficulty. This can be useful, for example, in cases where this last block has high paying transactions, or in order to double-spend a transaction contained within the block. Another possibility is for an attacker to preemptively mine blocks with such false timestamps, in order to make sure they win in case of ties with other blocks which might be mined concurrently, or which might’ve been mined in the recent past but haven’t reached the attacker yet.

Note that this is in stark contrast to most of the existing literature, which attempts to replace blocks by requiring that miners secretly create a heavier chain, withhold it and then publish it.

![]()

A devious attacker can displace a main-chain block (b1) by mining the red block (bA) with a lower timestamp.

## No Risk, No Gain? No!

In our paper, we formally describe the aforementioned attack and rigorously analyze it. We show that by executing the attack in a specific manner, the attack does not entail any behavior which has a non-zero probability of earning less than mining honestly, meaning that *our attack dominates the honest mining strategy*.

## In Search of Lost Time: Uncle Making in the Wild

By analyzing publicly available on-chain data, we can finally say that the answer to the long-standing question *do miners attack the consensus layer of major cryptocurrencies?* is a resounding **yes!**

Although most mining pools produce relatively inconspicuous-looking blocks, F2Pool blatantly disregards the rules and uses false timestamps for its blocks. Specifically, whenever a block should have a timestamp difference from its parent which is divisible by 9 (precisely the time at which mining difficulty decreases), F2Pool hangs at the preceding second a while longer, thereby increasing mining difficulty and profits. Thus, in the past two years, *F2Pool didn’t have even a single block with a timestamp which is divisible by 9*.

![]()

F2Pool never mines blocks with timestamps which are divisible by 9, instead falsely setting their timestamps to be one second earlier, thereby increasing mining difficulty and profits!

When looking at blocks mined by other pools, one can observe that practically all others have an over-representation of uncle blocks with timestamps differences which *are* divisible by 9, meaning that F2Pool specifically attempts to replace these blocks.

![]()

Ethermine, Hiveon and 0x5a…4c have more uncles than we’d expect at the 9 seconds mark, because F2Pool is an uncle maker!

## Take Home Message

We feel that it is very fitting to publish this paper on the cusp of The Merge, e.g. Ethereum’s migration to Proof-of-Stake. The current version of Ethereum’s consensus, which relies on Proof-of-Work, is known for adopting changes rapidly, without always carefully examining them and the effect they might have on the incentives of miners. Thus, changes which were designed to mitigate one [vulnerability](https://eips.ethereum.org/EIPS/eip-100), open the door for [new ones](https://dl.acm.org/doi/pdf/10.1145/3490486.3538250). Our paper shows that consensus mechanisms and changes to them should be rigorously analyzed, especially with regards to mining incentives.

This was responsibly disclosed to the Ethereum Foundation before the publication of the paper.

If you have comments, feedback, improvements or suggestions don’t be shy and reach out to us, we’d be glad to hear from you! You can do so and also see what else we’re up to via our websites: [AvivY](http://avivyaish.com/), [Gilad](https://giladstern.github.io/), [AvivZ](https://www.avivz.net/).

[Ethereum](/tag/ethereum?source=post_page-----d27c1cb62fef--------------------------------)[Cryptocurrency](/tag/cryptocurrency?source=post_page-----d27c1cb62fef--------------------------------)[Blockchain](/tag/blockchain?source=post_page-----d27c1cb62fef--------------------------------)[Security](/tag/security?source=post_page-----d27c1cb62fef--------------------------------)[Mining](/tag/mining?source=post_page-----d27c1cb62fef--------------------------------)

--

--

5

[![Aviv Yaish](https://miro.medium.com/v2/resize:fill:96:96/1*segQFIFyuge7WeCrK8w04g.jpeg)](/%40aviv.yaish?source=post_page---post_author_info--d27c1cb62fef--------------------------------)[![Aviv Yaish](https://miro.medium.com/v2/resize:fill:128:128/1*segQFIFyuge7WeCrK8w04g.jpeg)](/%40aviv.yaish?source=post_page---post_author_info--d27c1cb62fef--------------------------------)Follow[## Written by Aviv Yaish](/%40aviv.yaish?source=post_page---post_author_info--d27c1cb62fef--------------------------------)[65 Followers](/%40aviv.yaish/followers?source=post_page---post_author_info--d27c1cb62fef--------------------------------)·[1 Following](/%40aviv.yaish/following?source=post_page---post_author_info--d27c1cb62fef--------------------------------)

I research cryptocurrencies.

Follow
## Responses (5)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----d27c1cb62fef--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d27c1cb62fef--------------------------------)[About](/about?autoplay=1&source=post_page-----d27c1cb62fef--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d27c1cb62fef--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d27c1cb62fef--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d27c1cb62fef--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d27c1cb62fef--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d27c1cb62fef--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d27c1cb62fef--------------------------------)[Teams](/business?source=post_page-----d27c1cb62fef--------------------------------)



=== Content from github.com_f3a80288_20250114_215436.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fblob%2F671094279e8d27f4b4c3c94bf8b636c26b473976%2Fcore%2Fforkchoice.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fblob%2F671094279e8d27f4b4c3c94bf8b636c26b473976%2Fcore%2Fforkchoice.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ethereum%2Fgo-ethereum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethereum](/ethereum)
/
**[go-ethereum](/ethereum/go-ethereum)**
Public

* [Notifications](/login?return_to=%2Fethereum%2Fgo-ethereum) You must be signed in to change notification settings
* [Fork
  20.4k](/login?return_to=%2Fethereum%2Fgo-ethereum)
* [Star
   48.1k](/login?return_to=%2Fethereum%2Fgo-ethereum)

* [Code](/ethereum/go-ethereum)
* [Issues
  193](/ethereum/go-ethereum/issues)
* [Pull requests
  99](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects
  0](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

Additional navigation options

* [Code](/ethereum/go-ethereum)
* [Issues](/ethereum/go-ethereum/issues)
* [Pull requests](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

## Files

 6710942
## Breadcrumbs

1. [go-ethereum](/ethereum/go-ethereum/tree/671094279e8d27f4b4c3c94bf8b636c26b473976)
2. /[core](/ethereum/go-ethereum/tree/671094279e8d27f4b4c3c94bf8b636c26b473976/core)
/
# forkchoice.go

Copy path Blame  Blame
## Latest commit

## History

[History](/ethereum/go-ethereum/commits/671094279e8d27f4b4c3c94bf8b636c26b473976/core/forkchoice.go)108 lines (99 loc) · 4.13 KB 6710942
## Breadcrumbs

1. [go-ethereum](/ethereum/go-ethereum/tree/671094279e8d27f4b4c3c94bf8b636c26b473976)
2. /[core](/ethereum/go-ethereum/tree/671094279e8d27f4b4c3c94bf8b636c26b473976/core)
/
# forkchoice.go

Top
## File metadata and controls

* Code
* Blame

108 lines (99 loc) · 4.13 KB[Raw](https://github.com/ethereum/go-ethereum/raw/671094279e8d27f4b4c3c94bf8b636c26b473976/core/forkchoice.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108// Copyright 2021 The go-ethereum Authors// This file is part of the go-ethereum library.//// The go-ethereum library is free software: you can redistribute it and/or modify// it under the terms of the GNU Lesser General Public License as published by// the Free Software Foundation, either version 3 of the License, or// (at your option) any later version.//// The go-ethereum library is distributed in the hope that it will be useful,// but WITHOUT ANY WARRANTY; without even the implied warranty of// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the// GNU Lesser General Public License for more details.//// You should have received a copy of the GNU Lesser General Public License// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.
package core
import ( crand "crypto/rand" "errors" "math/big" mrand "math/rand"
 "github.com/ethereum/go-ethereum/common" "github.com/ethereum/go-ethereum/common/math" "github.com/ethereum/go-ethereum/core/types" "github.com/ethereum/go-ethereum/log" "github.com/ethereum/go-ethereum/params")
// ChainReader defines a small collection of methods needed to access the local// blockchain during header verification. It's implemented by both blockchain// and lightchain.type ChainReader interface { // Config retrieves the header chain's chain configuration. Config() \*params.ChainConfig
 // GetTd returns the total difficulty of a local block. GetTd(common.Hash, uint64) \*big.Int}
// ForkChoice is the fork chooser based on the highest total difficulty of the// chain(the fork choice used in the eth1) and the external fork choice (the fork// choice used in the eth2). This main goal of this ForkChoice is not only for// offering fork choice during the eth1/2 merge phase, but also keep the compatibility// for all other proof-of-work networks.type ForkChoice struct { chain ChainReader rand \*mrand.Rand
 // preserve is a helper function used in td fork choice. // Miners will prefer to choose the local mined block if the // local td is equal to the extern one. It can be nil for light // client preserve func(header \*types.Header) bool}
func NewForkChoice(chainReader ChainReader, preserve func(header \*types.Header) bool) \*ForkChoice { // Seed a fast but crypto originating random generator seed, err := crand.Int(crand.Reader, big.NewInt(math.MaxInt64)) if err != nil { log.Crit("Failed to initialize random seed", "err", err) } return &ForkChoice{ chain: chainReader, rand: mrand.New(mrand.NewSource(seed.Int64())), preserve: preserve, }}
// ReorgNeeded returns whether the reorg should be applied// based on the given external header and local canonical chain.// In the td mode, the new head is chosen if the corresponding// total difficulty is higher. In the extern mode, the trusted// header is always selected as the head.func (f \*ForkChoice) ReorgNeeded(current \*types.Header, header \*types.Header) (bool, error) { var ( localTD = f.chain.GetTd(current.Hash(), current.Number.Uint64()) externTd = f.chain.GetTd(header.Hash(), header.Number.Uint64()) ) if localTD == nil || externTd == nil { return false, errors.New("missing td") } // Accept the new header as the chain head if the transition // is already triggered. We assume all the headers after the // transition come from the trusted consensus layer. if ttd := f.chain.Config().TerminalTotalDifficulty; ttd != nil && ttd.Cmp(externTd) <= 0 { return true, nil } // If the total difficulty is higher than our known, add it to the canonical chain // Second clause in the if statement reduces the vulnerability to selfish mining. // Please refer to http://www.cs.cornell.edu/~ie53/publications/btcProcFC.pdf reorg := externTd.Cmp(localTD) > 0 if !reorg && externTd.Cmp(localTD) == 0 { number, headNumber := header.Number.Uint64(), current.Number.Uint64() if number < headNumber { reorg = true } else if number == headNumber { var currentPreserve, externPreserve bool if f.preserve != nil { currentPreserve, externPreserve = f.preserve(current), f.preserve(header) } reorg = !currentPreserve && (externPreserve || f.rand.Float64() < 0.5) } } return reorg, nil}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


