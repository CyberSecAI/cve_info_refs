=== Content from gromox.com_1fcb42a0_20250115_112710.html ===


![Gromox brand character](mascot.svg)

# Welcome to the Gromox project webpage

Gromox is the central groupware server component of grommunio. It is capable
of serving as a drop-in replacement for Microsoft Exchange.
Connectivity options include RPC/HTTP (Outlook Anywhere), MAPI/HTTP, IMAP,
POP3, an SMTP-speaking LDA, and a PHP module with a MAPI function subset.
Components can scale-out over multiple hosts.

Gromox is modular and consists of a set of components and programs to
provide its feature set. This repository includes a number of manual pages, for
which a rendered version is at [docs.grommunio.com](https://docs.grommunio.com/man/gromox.7.html).

Gromox relies on other components to provide a sensibly complete mail
system,

* [Admin API/CLI](https://github.com/grommunio/admin-api) (AAPI)
  and, optionally, [Admin Web
  Interface](https://github.com/grommunio/admin-web) (AWEB) for user management
* a mail transfer agent like Postfx, Exim, and more
* mail security solutions like rspamd and others (commercial ones
  included)
* optionally, User Web Interface via [grommunio-web](https://github.com/grommunio/grommunio-web)
* optionally, Exchange ActiveSync (EAS)/mobile device support
  via [grommunio-sync](https://github.com/grommunio/grommunio-sync)
* optionally, CalDAV & CardDAV interoperability via
  [grommunio-dav](https://github.com/grommunio/grommunio-dav)

The grommunio Appliance ships these essentials and has a ready-to-run
installation of Gromox.

Support is available through grommunio GmbH and its partners. See [grommunio.com](https://grommunio.com/) for details.
A community forum is at [community.grommunio.com](https://community.grommunio.com/).

The source code repository and technical issue tracker can be found at <https://github.com/grommunio/gromox>.

[Latest Release
2.37 ⬇](https://github.com/grommunio/gromox/releases/download/gromox-2.37/gromox-2.37.tar.zst)
## Downloads

* [gromox-2.37.tar.zst](https://github.com/grommunio/gromox/releases/download/gromox-2.37/gromox-2.37.tar.zst)
  ([.asc](https://github.com/grommunio/gromox/releases/download/gromox-2.37/gromox-2.37.tar.asc))



=== Content from www.openwall.com_37d0e0e6_20250114_183055.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2022/08/03/6) [[next>]](../../../2022/08/05/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20220804103817.osenwnxxnj3ufxd4@suse.com>
Date: Thu, 4 Aug 2022 12:38:17 +0200
From: Filippo Bonazzi <fbonazzi@...e.de>
To: oss-security@...ts.openwall.com
Subject: gromox: potential local privilege escalation (CVE-2022-37030)

Hello list,

the following report describes a local privilege escalation vulnerability in
Gromox[0] versions 0.5 to 1.27. Any code references in this report are based on
version 1.27 in the upstream Git repository[1], and packaging references are
based on the 1.27 RPM distributed by upstream[2].

# Introduction

Gromox is the central groupware server component of grommunio[3]. It is capable
of serving as a replacement for Microsoft Exchange and compatibles.

Among its many features, Gromox provides a PAM module to authenticate non-Gromox
processes to an authentication backend such as MySQL or LDAP. The PAM module
allows runtime loading of plugins, and its configuration lives in
`/etc/gromox/pam` or `/etc/gromox`.

The interaction between this PAM module, its runtime loading of plugins and
their configuration causes the vulnerability described in this report.

# The Vulnerability

The RPM spec file packages the `/etc/gromox` directory with ownership
`root:gromox` and mode 775, i.e. the directory is writeable by the unprivileged
`gromox` group.

The directory contains, among others, the configuration file for the PAM module.
When the authentication hook of the PAM module is invoked, the module loads the
`/etc/gromox/pam.cfg` configuration file, which can contain a path and a list of
filenames to be used to load plugins. The plugins are regular .so shared objects,
which are then executed by the PAM module.

It is therefore possible for the `gromox` group to effectively have the PAM
stack run arbitrary code upon execution of the `pam_gromox.so` module.

Assuming that the PAM stack is run as root, as it is likely, this results in the
unprivileged `gromox` group being able to execute arbitrary code as root.

# Proof of Concept Exploit

Attached is a proof of concept setup that has been tested on current openSUSE
distributions.
The only precondition for the exploit is that gromox is installed and a target
user is in the `gromox` group.

# Upstream Fix

Upstream released version 1.28 of Gromox[4] which removes configuration
directives for runtime loading of plugins. Plugins are now loaded from a fixed
list, and from root-controlled paths only. This removes the possibility for an
unprivileged user to control what will be executed by the Gromox PAM module.

# Timeline

2022-07-25: I contacted upstream with the vulnerability report and offered
             coordinated disclosure.
	    Upstream released version 1.28 on the same day, fixing the issue,
	    and did not request any embargo.
2022-07-26: I reviewed the new version and verified that the issue has been
             fixed.
2022-08-01: I obtained CVE-2022-37030 from Mitre to track this issue.

# References

[0] <https://gromox.com/>
[1] <https://github.com/grommunio/gromox>
[2] <https://download.grommunio.com/community/openSUSE_Tumbleweed/>
[3] <https://grommunio.com/>
[4] <https://github.com/grommunio/gromox/releases/tag/gromox-1.28>

--
Filippo Bonazzi
Security Engineer                        suse.com
8257 4398 947A 2DBE F21D 76E6 937A 63F0 5B36 46D9

Download attachment "[gromox-poc.zip](1/1)" of type "application/zip" (2488 bytes)

Download attachment "[signature.asc](1/2)" of type "application/pgp-signature" (489 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from grommunio.com_c3c0e0e4_20250115_112712.html ===

# grommunio

[![grommunio Logo](https://grommunio.com/wp-content/uploads/2020/12/grommunio_logo_light-menu_334x80.png)](https://grommunio.com/)

* [Home](https://grommunio.com/)
* [Features](https://grommunio.com/features/)
  + [Email](https://grommunio.com/features/email/)
  + [Contacts](https://grommunio.com/features/contacts/)
  + [Calendar](https://grommunio.com/features/calendar/)
  + [Tasks](https://grommunio.com/features/tasks/)
  + [Meet](https://grommunio.com/features/meet/)
  + [Chat](https://grommunio.com/features/chat/)
  + [Files](https://grommunio.com/features/files/)
  + [Office](https://grommunio.com/features/office/)
  + [Archive](https://grommunio.com/features/archive/)
  + [Mobile Device Management](https://grommunio.com/features/mobile-device-management/)
  + [Architecture](https://grommunio.com/features/architecture/)
* Product
  + [Product](https://grommunio.com/product/)
  + [Pricing](https://grommunio.com/pricing/)
  + [Demo](https://grommunio.com/demo/)
  + [Release Notes](https://grommunio.com/release-notes/)
* [News](https://grommunio.com/news/)
* [Partner](https://grommunio.com/partner/)
  + [Find a partner](https://grommunio.com/find-a-partner/)
  + [Partner Program](https://grommunio.com/partner-program/)
  + [Partner Portal](https://portal.grommunio.com/)
* Company
  + [About us](https://grommunio.com/about-us/)
  + [Contact](https://grommunio.com/contact/)
  + [Jobs](https://grommunio.com/jobs/)
  + [In the press](https://grommunio.com/in-the-press/)
  + [Press](https://grommunio.com/press/)
* Resources
  + [Community](https://community.grommunio.com/)
  + [Documentation](https://docs.grommunio.com/)
  + [GitHub Repository](https://github.com/grommunio)
* [Download](https://grommunio.com/download/)
* [![German](https://grommunio.com/wp-content/uploads/flags/Flag_of_Germany.svg)](https://grommunio.com/de/)

## groupware and much, much more

The most advanced solution in communication and collaboration – a platform for EVERYONE!

## exchange your exchange

Digital sovereignty: Decide for yourself whether on premise or in the cloud – with 100% control over your data!

## Complete communication and collaboration solution

Digital, open source communication – in real-time at enterprise level!

7

### Digital communication and collaboration on enterprise level

grommunio efficiently summarizes all requirements of modern, digital communication and collaboration. This includes the device and operating system independent management of sensitive data such as e-mail, contacts, calendar, chat, video conference, file sharing and much more – in real time.

With open source technology based on Linux, grommunio is scalable and meets the highest security requirements. Thanks to its advanced architecture, grommunio can be integrated into existing systems without great effort.

### Emails, contacts, calendars in one platform

Increase your efficiency by managing emails, contacts, calendars, tasks and much more with just one platform.

With integrated enterprise-grade Active Sync, your data is available on all devices in real time.

![grommunio tasks](https://grommunio.com/wp-content/uploads/2021/01/screenshot-tasks.jpg "grommunio tasks")

![grommunio calendar](https://grommunio.com/wp-content/uploads/2021/01/screenshot-calendar.jpg "grommunio calendar")

### Work efficiently and increase productivity

Invite directly from your calendar to online conferences with grommunio Meet, share files of all kinds in grommunio files and talk to your employees at the same time via grommunio chat.

Organize projects with shared folders and create schedules to see at a glance when your colleagues have time.

### Enterprise-grade security

Secure communication and collaboration for your highest demands. You can sit back and relax knowing that your confidential information is protected with enterprise security.

Manage all your devices with grommunio Mobile Device Management. For example, if a smartphone is lost or a colleague leaves the company, you can remove all data and disable all access at any time.

![grommunio email](https://grommunio.com/wp-content/uploads/2021/01/screenshot-email.jpg "grommunio email")

First class compatibility

The appliance can be integrated into your existing environment at any time and can be used immediately with the following clients, among others.



Windows Mail

![icon outlook](https://grommunio.com/wp-content/uploads/2021/01/icon-outlook_240x240.png)

Outlook



Android



Apple Mail / iOS

![Thunderbird Icon](https://grommunio.com/wp-content/uploads//2021/01/icon-sm-thunderbird1.svg)

Thunderbird



and more

#### This is what distinguishes grommunio

![sets grommunio apart icon-1](https://grommunio.com/wp-content/uploads/2021/06/DasZeichnetgrammmAus-icon-1-1.png)

The appliance offers a wide range of interfaces … for optimal integration in a variety of environments.

![sets grommunio apart icon-2](https://grommunio.com/wp-content/uploads/2021/06/DasZeichnetgrammmAus-icon-2-1.png)

As the first open source solution – with a fully functional implementation of Outlook Anywhere (RPC-over-HTTP) and MAPI-over-HTTP, grommunio is the alternative to proprietary backends for native interoperability with Microsoft Outlook.

![sets grommunio apart icon-3](https://grommunio.com/wp-content/uploads/2021/06/DasZeichnetgrammmAus-icon-3-1.png)

With its efficient and optimized design, it even outperforms its proprietary counterparts in most areas.

![sets grommunio apart icon-4](https://grommunio.com/wp-content/uploads/2021/06/DasZeichnetgrammmAus-icon-4-1.png)

With the Linux platform as the basis, and the associated scalability and manageability, grommunio convinces with its large variety of implementation scenarios in your data center.

### Features

Your entire communication in just one platform!


### Email

With grommunio you send your mails as usual via Outlook, iOS or Android devices, as well as via grommunio Web.

**Learn more**


### Contacts

Continue to manage your contacts on all devices with the usual apps or with grommunio Web.

**Learn more**


### Calendar

Edit entries however is most convenient for you. grommunio syncs calendars on all devices simultaneously. grommunio syncs calendars on all devices simultaneously.

**Learn more**


### Tasks

Tasks can easily continue to be managed in your Outlook, on their mobile devices or in grommunio Web.

**Learn more**


### Meet

Video conferences with grommunio Meet web-based or via app: high-performance, scalable, end-point secured and user-friendly.

**Learn more**


### Chat

Enterprise chat systems for internal and external communication on a web and app basis.

**Learn more**


### Files

grommunio Files offers you unrestricted and secure access to all your shared documents and data from the office or on the go.

**Learn more**


### Office

The Office suite lets you create and edit complex documents, professional spreadsheets, and stunning presentations.

**Learn more**


### Mobile Device Management

With Mobile Device Management, you can protect your data if a mobile device is lost. Stored data can be deleted by external access.

**Learn more**


### Architecture

The appliance has a wide range of interfaces with optimal integration in a large number of applications and environments.

**Learn more**

### grommunio Partner Program

grommunio focuses on the indirect sales channel. Sales partners and distributors benefit from this. As a sales partner, you too can benefit from these growth opportunities and the excellent opportunities of the partner program.

[Become a partner](https://grommunio.com/partner-program/)

### Subscribe to Newsletter

Choose language:
Choose language:

German

English

Subscribe

**You will receive an email with a link to confirm your email address.**

I would like to regularly receive information about the latest developments and products from grommunio delivered directly to my email inbox By subscribing to the newsletter, I therefore freely give my consent that grommunio may use my personal data to send me the newsletter by email. For this purpose, my name, email address and language selection will be processed. I can revoke my freely-given consent at any time with effect for the future without giving reasons (e.g. via the link contained in the email). Further information on the processing of my data, in particular on the storage periods and data subject’s rights, can be found in the [**Privacy Policy**](https://grommunio.com/privacy/ "Privacy Policy").

Subscribe to our newsletter

[Newsletter](#abonnieren)

Quick Links

* [Home](https://grommunio.com/)
* [Features](https://grommunio.com/features/)
* [Product](https://grommunio.com/product/)
* [Pricing](https://grommunio.com/pricing/)
* [Demo](https://grommunio.com/demo/)
* [News](https://grommunio.com/news/)
* [About us](https://grommunio.com/about-us/)
* [Contact](https://grommunio.com/contact/)
* [Jobs](https://grommunio.com/jobs/)
* [In the press](https://grommunio.com/in-the-press/)
* [Press](https://grommunio.com/press/)
* [Release Notes](https://grommunio.com/release-notes/)
* [Download](https://grommunio.com/download/)

Features

* [Email](https://grommunio.com/features/email/)
* [Contacts](https://grommunio.com/features/contacts/)
* [Calendar](https://grommunio.com/features/calendar/)
* [Tasks](https://grommunio.com/features/tasks/)
* [Meet](https://grommunio.com/features/meet/)
* [Chat](https://grommunio.com/features/chat/)
* [Files](https://grommunio.com/features/files/)
* [Office](https://grommunio.com/features/office/)
* [Archive](https://grommunio.com/features/archive/)
* [Mobile Device Management](https://grommunio.com/features/mobile-device-management/)
* [Architecture](https://grommunio.com/features/architecture/)

Partner

* [Find a partner](https://grommunio.com/find-a-partner/)
* [Partner program](https://grommunio.com/partner-program/)
* [Partner Portal](https://portal.grommunio.com/)

Resources

* [Community](https://community.grommunio.com/)
* [Documentation](https://docs.grommunio.com/)
* [GitHub repository](https://github.com/grommunio)

Legal

* [Cookie Policy](https://grommunio.com/cookie-policy/)
* [Privacy Policy](https://grommunio.com/privacy/)
* [Legal Notice](https://grommunio.com/legal-notice/)
* [General Terms and Conditions](https://grommunio.com/wp-content/uploads/2021/09/AGB_grommunio_EN_01OCT21.pdf)
* [Right of withdrawal](https://grommunio.com/right-of-withdrawal/)

Languages

* [![](https://grommunio.com/wp-content/uploads/flags/1Flag_of_the_United_Kingdom.svg)English](https://grommunio.com/)
* [![](https://grommunio.com/wp-content/uploads/flags/Flag_of_Germany.svg)Deutsch](https://grommunio.com/de/)

[![LinkedIn](https://grommunio.com/wp-content/uploads/2023/02/linkedin-icon_200.svg "LinkedIn")](https://www.linkedin.com/company/grommunio-official)
[![X](https://grommunio.com/wp-content/uploads/2024/06/x-icon_200-1.svg "X")](https://x.com/grommunio)
[![Mastodon](https://grommunio.com/wp-content/uploads/2023/02/mastodon-icon_200.svg "Mastodon")](https://mastodon.social/%40grommunio)
[![Facebook](https://grommunio.com/wp-content/uploads/2023/02/facebook-icon_200.svg "Facebook")](https://www.facebook.com/grommunio)
[![Instagram](https://grommunio.com/wp-content/uploads/2023/02/instagram-icon_200.svg "Instagram")](https://www.instagram.com/grommunio_official)

[![Open Source Business Alliance](https://grommunio.com/wp-content/uploads//2021/11/OSBA_Logo_246x100.svg "Open Source Business Alliance")](https://osb-alliance.de/)
[![Association of the Austrian Software Industry](https://grommunio.com/wp-content/uploads/2021/12/voesi-logo-transp_408x100.png "Association of the Austrian Software Industry")](https://www.voesi.or.at/home-en/)
[![open invention network](https://grommunio.com/wp-content/uploads/2021/12/OIN_logo-183x100-1.svg "open invention network")](https://openinventionnetwork.com/)
[![Upgrade to Linux](https://grommunio.com/wp-content/uploads/2022/11/UpgradetoLinux_icon.svg "Upgrade to Linux")](https://www.upgradetolinux.com/)

© 2020-2025 grommunio GmbH. All rights reserved.

* [Kontakt](https://grommunio.com/de/kontakt/)
* [Community](https://community.grommunio.com/)
* [Docs](https://docs.grommunio.com/)

Manage Cookie Consent

In order to regularly improve our service and provide you with a user-friendly website, we use Cookies that require your freely-given consent.

If you agree, please click on "Accept all".

(Selecting "Accept all" also activates Cookies that involve data transfer to third countries for which there is no adequacy decision pursuant to Article 45 GDPR and no appropriate safeguards pursuant to Article 46 GDPR. Among other things, there is a risk that authorities access your data for control and monitoring purposes and that you have no effective legal remedy. These Cookies are not necessary for the use of the website, but enable an even more individualized service of the website. By selecting "Accept all", you therefore expressly consent to this data transfer in accordance with Art 49(1) lit a GDPR.)

If you do not make a selection or click on the "Necessary Only" button, no Cookies requiring consent will be activated.

You can change your preferences or deselect all Cookies requiring consent at any time.

You can find more information about Cookies and your right to withdraw your consent in our [**Cookie Policy**](https://grommunio.com/cookie-policy/).

Functional cookies
Functional cookies

Always active

The technical storage or access is strictly necessary for the legitimate purpose of enabling the use of a specific service explicitly requested by the subscriber or user, or for the sole purpose of carrying out the transmission of a communication over an electronic communications network.

Preferences
Preferences

The technical storage or access is necessary for the legitimate purpose of storing preferences that are not requested by the subscriber or user.

Statistics
Statistics

The technical storage or access that is used exclusively for statistical purposes.
The technical storage or access that is used exclusively for anonymous statistical purposes. Without a subpoena, voluntary compliance on the part of your Internet Service Provider, or additional records from a third party, information stored or retrieved for this purpose alone cannot usually be used to identify you.

a:2:{s:4:"text";s:9:"Marketing";s:4:"show";i:1;}
a:2:{s:4:"text";s:9:"Marketing";s:4:"show";i:1;}

The technical storage or access is required to create user profiles to send advertising, or to track the user on a website or across several websites for similar marketing purposes.

Manage options
Manage services
Manage {vendor\_count} vendors
[Read more about these purposes](https://cookiedatabase.org/tcf/purposes/)

Accept all
Necessary only
Settings
Save settings
Settings

{title}
{title}
{title}

Manage consent



=== Content from www.openwall.com_0604ede6_20250115_112712.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2022/08/03/6) [[next>]](../../../2022/08/05/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20220804103817.osenwnxxnj3ufxd4@suse.com>
Date: Thu, 4 Aug 2022 12:38:17 +0200
From: Filippo Bonazzi <fbonazzi@...e.de>
To: oss-security@...ts.openwall.com
Subject: gromox: potential local privilege escalation (CVE-2022-37030)

Hello list,

the following report describes a local privilege escalation vulnerability in
Gromox[0] versions 0.5 to 1.27. Any code references in this report are based on
version 1.27 in the upstream Git repository[1], and packaging references are
based on the 1.27 RPM distributed by upstream[2].

# Introduction

Gromox is the central groupware server component of grommunio[3]. It is capable
of serving as a replacement for Microsoft Exchange and compatibles.

Among its many features, Gromox provides a PAM module to authenticate non-Gromox
processes to an authentication backend such as MySQL or LDAP. The PAM module
allows runtime loading of plugins, and its configuration lives in
`/etc/gromox/pam` or `/etc/gromox`.

The interaction between this PAM module, its runtime loading of plugins and
their configuration causes the vulnerability described in this report.

# The Vulnerability

The RPM spec file packages the `/etc/gromox` directory with ownership
`root:gromox` and mode 775, i.e. the directory is writeable by the unprivileged
`gromox` group.

The directory contains, among others, the configuration file for the PAM module.
When the authentication hook of the PAM module is invoked, the module loads the
`/etc/gromox/pam.cfg` configuration file, which can contain a path and a list of
filenames to be used to load plugins. The plugins are regular .so shared objects,
which are then executed by the PAM module.

It is therefore possible for the `gromox` group to effectively have the PAM
stack run arbitrary code upon execution of the `pam_gromox.so` module.

Assuming that the PAM stack is run as root, as it is likely, this results in the
unprivileged `gromox` group being able to execute arbitrary code as root.

# Proof of Concept Exploit

Attached is a proof of concept setup that has been tested on current openSUSE
distributions.
The only precondition for the exploit is that gromox is installed and a target
user is in the `gromox` group.

# Upstream Fix

Upstream released version 1.28 of Gromox[4] which removes configuration
directives for runtime loading of plugins. Plugins are now loaded from a fixed
list, and from root-controlled paths only. This removes the possibility for an
unprivileged user to control what will be executed by the Gromox PAM module.

# Timeline

2022-07-25: I contacted upstream with the vulnerability report and offered
             coordinated disclosure.
	    Upstream released version 1.28 on the same day, fixing the issue,
	    and did not request any embargo.
2022-07-26: I reviewed the new version and verified that the issue has been
             fixed.
2022-08-01: I obtained CVE-2022-37030 from Mitre to track this issue.

# References

[0] <https://gromox.com/>
[1] <https://github.com/grommunio/gromox>
[2] <https://download.grommunio.com/community/openSUSE_Tumbleweed/>
[3] <https://grommunio.com/>
[4] <https://github.com/grommunio/gromox/releases/tag/gromox-1.28>

--
Filippo Bonazzi
Security Engineer                        suse.com
8257 4398 947A 2DBE F21D 76E6 937A 63F0 5B36 46D9

Download attachment "[gromox-poc.zip](1/1)" of type "application/zip" (2488 bytes)

Download attachment "[signature.asc](1/2)" of type "application/pgp-signature" (489 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.suse.com_cff2c7d9_20250114_183057.html ===


| Bugzilla – Bug 1201949 | VUL-0: CVE-2022-37030: gromox: potential local privilege escalation | Last modified: 2022-08-05 07:58:26 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1201949)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1201949**](show_bug.cgi?id=1201949)
- VUL-0: CVE-2022-37030: gromox: potential local privilege escalation

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2022-37030: gromox: potential local privilege escalation

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | openSUSE Tumbleweed | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | openSUSE | | [Component:](describecomponents.cgi?product=openSUSE Tumbleweed "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=openSUSE%20Tumbleweed&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | Current | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86-64 Linux | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal ([vote](page.cgi?id=voting/user.html&bug_id=1201949#vote_1201949)) | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | E-mail List | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1200165](show_bug.cgi?id=1200165 "RESOLVED FIXED - AUDIT-TRACKER: gromox: review of package for rpmlint stoppers") | |  | Show dependency [tree](showdependencytree.cgi?id=1201949&hide_resolved=1) / [graph](showdependencygraph.cgi?id=1201949) | |  | | Reported: | 2022-07-28 09:30 UTC by Filippo Bonazzi | | --- | --- | | Modified: | 2022-08-05 07:58 UTC ([History](show_activity.cgi?id=1201949)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1201949) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1201949&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1201949&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1201949#c0)  Filippo Bonazzi   2022-07-28 09:30:01 UTC  ``` During an audit of Gromox for inclusion in openSUSE Tumbleweed, a potential local privilege escalation was found as described in [bsc#1200165](http://bugzilla.suse.com/show_bug.cgi?id=1200165). ``` [Comment 1](show_bug.cgi?id=1201949#c1)  Filippo Bonazzi   2022-07-28 10:26:42 UTC  ``` The following report describes a local privilege escalation vulnerability in Gromox[0] version 1.27 (latest). The vulnerability probably applies to previous versions as well, since it has to do with the way the application is packaged.  # Introduction  Gromox is the central groupware server component of grommunio[1]. It is capable of serving as a replacement for Microsoft Exchange and compatibles.  Among its many features, Gromox provides a PAM module to authenticate non-Gromox processes to an authentication backend such as MySQL or LDAP. The PAM module allows runtime loading of plugins, and its configuration lives in `/etc/gromox/pam` or `/etc/gromox`.  The interaction between this PAM module, its runtime loading of plugins and their configuration causes the vulnerability described in this report.  # The Vulnerability  The RPM spec file packages the `/etc/gromox` directory with ownership `root:gromox` and mode 775, i.e. the directory is writeable by the unprivileged `gromox` group.  The directory contains, among others, the configuration file for the PAM module. When the authentication hook of the PAM module is invoked, the module loads the `/etc/gromox/pam.cfg` configuration file, which can contain a path and a list of filenames to be used to load plugins. The plugins are regular .so shared objects, which are then executed by the PAM module.  It is therefore possible for the `gromox` group to effectively have the PAM stack run arbitrary code upon execution of the `pam_gromox.so` module.  Assuming that the PAM stack is run as root, as it is likely, this results in the unprivileged `gromox` group being able to execute arbitrary code as root.  # Proof of Concept Exploit  Attached is a proof of concept setup that has been tested on current openSUSE distributions. The only precondition for the exploit is that gromox is installed and a target user is in the `gromox` group.  # Suggested Fix  In order to prevent privilege escalation, an unprivileged user cannot be allowed to control paths and filenames that will be executed by other users (`root` in the worst case).  Probably the best thing to do is to set the `/etc/gromox` folder ownership to `root:root` and mode 755 rather than 775, and only allow privileged users to modify the configuration.  # References  [0] <https://gromox.com/> [1] <https://grommunio.com/> ``` [Comment 2](show_bug.cgi?id=1201949#c2)  Filippo Bonazzi   2022-08-01 17:12:26 UTC  ``` The issue has been assigned CVE-2022-37030. ``` [Comment 3](show_bug.cgi?id=1201949#c3)  Filippo Bonazzi   2022-08-05 07:58:26 UTC  ``` CVE has been made public and report has been posted to OSS[0].  Closing this as we are unaffected.  [0] <https://www.openwall.com/lists/oss-security/2022/08/04/1> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1201949)
* - [XML](show_bug.cgi?ctype=xml&id=1201949)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1201949)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1201949)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)


