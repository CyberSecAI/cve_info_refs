=== Content from research.splunk.com_5442d7e0_20250114_212157.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Endpoint Denial of Service DoS Zip Bomb

Updated Date: 2024-10-16
ID: b237d393-2f57-4531-aad7-ad3c17c8b041
Author: Marissa Bower, Rod Soto, Splunk
[Type: TTP](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies crashes in the Splunk search app caused by specially crafted ZIP files, affecting Universal Forwarder versions 8.1.11 and 8.2 versions below 8.2.7.1. It detects this activity by monitoring Universal Forwarder error logs for specific messages indicating invalid or binary file issues. This activity is significant because it can disrupt Splunk operations, leading to potential data loss or monitoring gaps. If confirmed malicious, this attack could result in a denial of service, hindering the organization's ability to monitor and respond to other security incidents effectively.

### Search

```
1`splunkd` component=FileClassifierManager event_message=*invalid* event_message=*binary*
2|stats count by host component event_message
3| `splunk_endpoint_denial_of_service_dos_zip_bomb_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkd](https://github.com/splunk/security_content/blob/develop/macros/splunkd.yml) | `index=_internal sourcetype=splunkd` |
| splunk\_endpoint\_denial\_of\_service\_dos\_zip\_bomb\_filter | `search *` |

`splunk_endpoint_denial_of_service_dos_zip_bomb_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1499](https://attack.mitre.org/techniques/T1499/) | Endpoint Denial of Service | Impact |

KillChainPhase.ACTIONS\_ON\_OBJECTIVES

NistCategory.DE\_CM

Cis18Value.CIS\_10

Sandworm Team

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Notable | Yes |
| Rule Title | `%name%` |
| Rule Description | `%description%` |
| Notable Event Fields | user, dest |
| Creates Risk Event | True |

This configuration file applies to all detections of type TTP. These detections will use Risk Based Alerting and generate Notable Events.
### Implementation

Need to monitor Splunkd data from Universal Forwarders.

### Known False Positives

This search may reveal non malicious zip files causing errors as well.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential exposure of environment variables from url embedded in dashboard | 75 | 100 | 75 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* [https://en.wikipedia.org/wiki/ZIP\_(file\_format)](https://en.wikipedia.org/wiki/ZIP_%28file_format%29)
* <https://www.splunk.com/en_us/product-security.html>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1499/splunk/splunk_zip_bomb_vulnerability.log) | `/opt/splunkforwarder/var/log/splunk/splunkd.log` | `splunkd` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1499/splunk/splunk_zip_bomb_vulnerability.log) | `/opt/splunkforwarder/var/log/splunk/splunkd.log` | `splunkd` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_endpoint_denial_of_service_dos_zip_bomb.yml) |
Version: **3**

[Detection: Splunk DoS via Malformed S2S Request](https://research.splunk.com/application/fc246e56-953b-40c1-8634-868f9e474cbd/ "Detection: Splunk DoS via Malformed S2S Request")

[Detection: Splunk Enterprise Windows Deserialization File Partition](https://research.splunk.com/application/947d4d2e-1b64-41fc-b32a-736ddb88ce97/ "Detection: Splunk Enterprise Windows Deserialization File Partition")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from www.splunk.com_9958006d_20250114_212200.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Malformed ZIP file crashes Universal Forwarders and Splunk Enterprise through file monitoring input

**Advisory ID:** SVD-2022-0803

**CVE ID:** [CVE-2022-37439](https://www.cve.org/CVERecord?id=CVE-2022-37439)

**Published:** 2022-08-16

**Last Update:** 2022-08-16

**CVSSv3.1 Score:** 5.5, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

**CWE:** [CWE-409](https://cwe.mitre.org/data/definitions/409.html)

**Bug ID:** TBD

## Description

In Splunk Enterprise and Universal Forwarder versions in the following table, indexing a specially crafted ZIP file using the file monitoring input can result in a crash of the application. Attempts to restart the application would result in a crash and would require manually removing the malformed file. The vulnerability does not affect Splunk Enterprise 9.0 or higher.

## Solution

For Splunk Enterprise and Universal Forwarder customers, upgrade versions to 8.1.11, 8.2.7.1, or higher.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Universal Forwarder | 8.1 | Monitor Processor | 8.1.10 and lower | 8.1.11 |
| Universal Forwarder | 8.2 | Monitor Processor | 8.2.0 to 8.2.7 | 8.2.7.1 |
| Universal Forwarder | 9.0 | - | Not affected | - |
| Splunk Enterprise | 8.1 | Monitor Processor | 8.1.10 and lower | 8.1.11 |
| Splunk Enterprise | 8.2 | Monitor Processor | 8.2.0 to 8.2.7 | 8.2.7.1 |
| Splunk Enterprise | 9.0 | - | Not affected | - |

## Mitigations and Workarounds

None

## Detections

* [Splunk endpoint DOS zip bomb vulnerability UF](https://research.splunk.com/application/b237d393-2f57-4531-aad7-ad3c17c8b041)

This search lets an operator retroactively identify potential Splunk app crashes resulting from SVD-2022-0803. It is not possible to detect the attack before a crash using this method. The provided search indicates Universal Forwarder errors from uploaded binary or compressed ZIP files, which this attack uses. Consider any results from this search for further research to determine if a malformed ZIP file caused the crash (noting that the file extension might have been altered).

## Severity

Splunk rates the vulnerability as Medium. The prerequisites require local privileged access to write to a monitored directory that is not restricted to the Splunk, system, or root user. Hence, Splunk rates the vulnerability as 5.5 with a CVSSv3.1 vector of CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H.

If your Splunk Enterprise instance monitors only the default directories that the $SPLUNK\_HOME/etc/system/default/inputs.conf configuration file defines, then the instance is not affected and the vulnerability is informational. In addition, the vulnerability is informational if the filesystem privileges required to write to the monitored directories are root, system or the Splunk user.

## Acknowledgments

Tim Ip at Adobe and Collegiate Penetration Testing Competition (CPTC)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
