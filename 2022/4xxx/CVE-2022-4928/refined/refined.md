Based on the provided content, here's an analysis of the vulnerability addressed:

**Root Cause of Vulnerability:**
The root cause is a lack of proper sanitization of HTML content within the Text Selection addon, specifically when handling selectable elements. The addon was vulnerable to Cross-Site Scripting (XSS) attacks.

**Weaknesses/Vulnerabilities Present:**
- **XSS Vulnerability:** The Text Selection addon was not properly sanitizing HTML content before using it. This allowed for the possibility of injecting malicious scripts through specially crafted HTML content within the selectable elements.
- The vulnerability exists within the `getWordsTextVoices` and `getPhrasesTextVoices` functions of the `presenter.js` file. These functions were cloning the HTML of an element, and then operating on that clone.

**Impact of Exploitation:**
- Successful exploitation could allow an attacker to inject and execute arbitrary JavaScript code in the context of the user's browser.
- This could lead to various impacts, such as:
  - Stealing sensitive information (e.g., cookies, session tokens)
  - Performing actions on behalf of the user
  - Defacing the web page
  - Redirecting the user to malicious websites
- The text-to-speech (TTS) functionality of the addon could be impacted, as the injected script could manipulate the spoken text.

**Attack Vectors:**
- An attacker could inject malicious HTML code into the selectable elements of the addon. This can happen via the Wiris addon (as mentioned in the commits), or any other part of the application that renders user-provided HTML.
- When the vulnerable functions `getWordsTextVoices` or `getPhrasesTextVoices` are executed on elements containing that malicious HTML, the injected script would execute.

**Required Attacker Capabilities/Position:**
- The attacker would need the ability to inject or control the HTML content of elements that are handled by the Text Selection addon. This could be achieved through any means of manipulating data that ends up as HTML.
- No special privileges are needed. The attacker just needs to manipulate the HTML that will be processed by the vulnerable code.

**Mitigation:**
The vulnerability was addressed by sanitizing the HTML content using `window.xssUtils.sanitize()` before processing. The code changes made ensure that the `outerHTML` of the element is sanitized, which removes or encodes potentially harmful HTML elements and attributes. The fix was applied to the `getWordsTextVoices` and `getPhrasesTextVoices` functions.

**Additional details:**
- The pull request #881 shows that the fix was implemented through several commits, addressing not only the Text Selection addon, but also a similar XSS issue in the Wiris addon
- The related ticket was 8593, "zabezpieczenie-addonu-text_selection-przed-xss", which in English would be "Securing the text_selection addon against XSS".

In summary, the vulnerability was an XSS issue in the Text Selection addon caused by the lack of sanitization of HTML, which was mitigated by introducing sanitization before any processing.