Based on the provided content, here's the breakdown of CVE-2022-4668:

**Root Cause of Vulnerability:**
The Easy Appointments plugin fails to properly validate and escape shortcode attributes before outputting them on the page. This lack of sanitization allows for the injection of malicious code via shortcode attributes.

**Weaknesses/Vulnerabilities Present:**
*   **Stored Cross-Site Scripting (XSS):** The vulnerability is a stored XSS, meaning the malicious script is stored in the database and executed when a user views the affected content.

**Impact of Exploitation:**
*   **Arbitrary JavaScript Execution:** Successful exploitation allows an attacker to inject and execute arbitrary JavaScript code in the context of a user's browser session.
*   **Account Takeover:** The injected script could be used to steal session cookies or perform other actions on behalf of the logged-in user, including administrative actions if the user has elevated privileges.

**Attack Vectors:**
*   **Shortcode Injection:** An attacker injects malicious JavaScript code by exploiting the vulnerable shortcode attribute of the Easy Appointments plugin.
*   **Shortcode:** The vulnerability is triggered through the `ea_full_calendar` shortcode.

**Required Attacker Capabilities/Position:**
*   **Contributor Role or Higher:** The attacker needs at least a contributor role within the WordPress site to be able to create or edit content containing the malicious shortcode.

**Additional Notes**
* The provided Proof of Concept demonstrates how an attacker can inject malicious JavaScript code using the `column_header_format` attribute of the `ea_full_calendar` shortcode.
* The vulnerability has been fixed in version 3.11.2 of the Easy Appointments plugin.