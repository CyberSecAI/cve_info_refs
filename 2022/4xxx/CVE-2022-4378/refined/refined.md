```json
{
  "CVE-2022-4378": {
    "Description": "The vulnerability is caused by a missing check on user input. More specifically, __do_proc_dointvec function has the following snippet:\n~~~~\nif (write) {\n    ......\n    if (left > PAGE_SIZE - 1)\n        left = PAGE_SIZE - 1;\n    p = buffer;\n}\n......\nif (write) {\n    left -= proc_skip_spaces(&p);\n~~~~\nIn this snippet, `buffer` and `p` represent a buffer containing user-supplied input and it can contain more than 1 page of data. It first truncates user input to 1 page (by marking number of bytes `left` as 1 page). However, in a later call to `proc_skip_spaces` (a function that assumes the argument is a NULL-terminated string), it forgets the \"up to 1 page\" limit, processes all user input, and calculates how many leading spaces are there in the user input. In the buffer contains more than 1 page of spaces, `left` will be set to a negative value. The negative value will then be passed to `proc_get_long` and the least significant 4 bytes will be used as length for memcpy that copies data to kernel stack, causing stack-based buffer overflow: (the check on `len` won't work because `len` is signed)\n~~~~\nstatic int proc_get_long(...)\n{\n    char tmp[TMPBUFLEN];\n    int len = *size;\n\n    if (len > TMPBUFLEN - 1)\n        len = TMPBUFLEN - 1;\n\n    memcpy(tmp, *buf, len);\n    ......\n}\n~~~~\n",
    "Weaknesses": [
      "Stack-based buffer overflow",
      "Missing check on user input",
      "Improper handling of negative lengths in memcpy",
      "Incorrect assumption of null-terminated string"
    ],
    "Impact": "DOS and is potentially exploitable,  A successful exploit could give minimal consequences, The negative value will then be passed to `proc_get_long` and the least significant 4 bytes will be used as length for memcpy that copies data to kernel stack, causing stack-based buffer overflow: (the check on `len` won't work because `len` is signed)",
    "AttackVectors": [
      "The bug is triggerable by non-root users if they have access to user-namespace.",
      "user-supplied input passed to  `__do_proc_dointvec` function"
    ],
    "RequiredCapabilities": [
      "Access to user-namespace",
	    "Non-root user"
    ],
        "Patches":[
        "refactor `proc_skip_spaces`, instead of assuming the argument is a NULL-terminated string, it now will process data up to a limit. The patch can be found here:\n<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=bce9332220bd677d83b19d21502776ad555a0e73>\n2. fix the signness issue in `len`:\n<https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6cfaf34be9fcd1a8285a294e18986bfc41a409c>"
    ]
  }
}
```