=== Content from gitlab.com_f78890fe_20250114_200015.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-4205.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-4205.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-4205.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-4205.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 26, 2023

  [57763ec2](/gitlab-org/cves/-/commit/57763ec2badbad0ab24d6687b6f3a33c93f37f77)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/57763ec2badbad0ab24d6687b6f3a33c93f37f77)
  ·
  57763ec2

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 26, 2023

  57763ec2

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/57763ec2badbad0ab24d6687b6f3a33c93f37f77)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 26, 2023

Loading



=== Content from gitlab.com_fd5a8115_20250114_200017.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Repository import still allows to import 40 hexadecimal branches

Related to previously closed issue [#361179 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/361179 "Import via git protocol allows to bypass checks on repository")

As flagged by [@proglottis](/proglottis "James Fargher") in <https://gitlab.com/gitlab-org/security/gitlab/-/issues/714#note_1092057356> it's still possible to perform repository import and have 40 hexadecimal branch imported.

When using import by URL the `after_import` method is still called, `remove_prohibited_branches` returns early because [`exists?`](https://gitlab.com/gitlab-org/gitlab/blob/master/app/models/repository.rb#L1178-1178) returns false, which looks like a cached value which should be true at this point.

### Potential solution

Perhaps these 2 method calls are in a wrong order:

```
def after_import
    repository.remove_prohibited_branches
    repository.expire_content_cache
...
```

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


