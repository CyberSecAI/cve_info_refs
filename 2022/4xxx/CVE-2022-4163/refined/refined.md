The provided content relates to CVE-2022-4163.

**Root cause of vulnerability:**
The vulnerability stems from the `Contest Gallery` plugin not properly sanitizing or escaping user-supplied input before using it in SQL queries. Specifically, the `cg_deactivate` and `cg_activate` POST parameters are directly concatenated into SQL queries in the `2_deactivate.php` and `4_activate.php` files respectively.

**Weaknesses/vulnerabilities present:**
- SQL Injection vulnerability (CWE-89).
- Improper input sanitization.
- Direct concatenation of user-supplied input into SQL queries.

**Impact of exploitation:**
- Malicious users with at least author privileges can inject arbitrary SQL code.
- This can lead to sensitive information disclosure from the database.
- Potential for other malicious actions, such as data modification, depending on the database privileges of the user executing the query.
- In the provided Proof of Concept, the attacker demonstrates the ability to execute `SLEEP(5)` which may also lead to Denial of Service.

**Attack vectors:**
- HTTP POST requests to `/wp-admin/admin-ajax.php` endpoint.
- Exploitation occurs via `cg_deactivate` and `cg_activate` parameters.

**Required attacker capabilities/position:**
- The attacker needs to have at least "author" privileges on the WordPress site.
- The attacker needs to be able to send HTTP POST requests to the WordPress site.