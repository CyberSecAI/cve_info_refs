=== Content from gitlab.com_77641c1f_20250114_192503.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-4335.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-4335.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-4335.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-4335.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 26, 2023

  [25302f34](/gitlab-org/cves/-/commit/25302f34241d8c77e1a3fc17194323fba93a310b)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/25302f34241d8c77e1a3fc17194323fba93a310b)
  ·
  25302f34

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 26, 2023

  25302f34

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/25302f34241d8c77e1a3fc17194323fba93a310b)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 26, 2023

Loading



=== Content from gitlab.com_4d2d6ebc_20250114_192505.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Blind SSRF in repository mirroring using DNS rebinding

**[HackerOne report #1462437](https://hackerone.com/reports/1462437)** by `ashish_r_padelkar` on 2022-01-28, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello,

I found a Blind SSRF issue in repository mirroring using DNS rebinding.

##### Steps to reproduce

1. Go to `https://lock.cmpxchg8b.com/rebinder.html` and put any ip address in A and 127.0.0.1 in B.
2. Now login to your project and go to `https://gitlab.com/<NameSpace>/<ProjectName>/-/settings/repository#js-push-remote-settings`
3. In `Mirroring repositories` put the url generated in step 1 for eg `http://ac41fb4e.7f000001.rbndr.us` in `Git repository URL`.
4. Use `Push` as mirror direction.
5. It may block several times giving you reason as localhost not allowed(expected as it will switch to localhost in dns rebinding) but keep trying several times till it gets added .
6. Once added, use the refresh icon near url several times and after few tries you should see message like below.

[![Screen_Shot_2022-01-28_at_11.22.54_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0e034fe0e1d802012f36f8f6343645f6d815fb4e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62636231333330612d393663632d346466622d396262652d3530333330623463366437312f53637265656e5f53686f745f323032322d30312d32385f61745f31312e32322e35345f414d2e706e67)

7. This indicates that request reached localhost but connection got refused as port is closed.

##### Examples

If you want i can add you in my project for POC where i have already added the urls and you can see the error messages.

`https://gitlab.com/[REDACTED]/githubimport/-/settings/repository#js-push-remote-settings`

##### What is the current *bug* behavior?

Blind SSRF using DNS rebinding

##### What is the expected *correct* behavior?

Request should be blocked to localhost !

##### Output of checks

This bug happens on GitLab.com

Regards,

Ashish

#### Impact

Blind SSRF in repository mirroring using DNS rebinding

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Shot\_2022-01-28\_at\_11.22.54\_AM.png](https://h1.sec.gitlab.net/a/bcb1330a-96cc-4dfb-9bbe-50330b4c6d71/Screen_Shot_2022-01-28_at_11.22.54_AM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Steps were explained clearly by the reporter above, also see the video in [#353018 (comment 845509652)](https://gitlab.com/gitlab-org/gitlab/-/issues/353018#note_845509652 "Blind SSRF in repository mirroring using DNS rebinding")

Edited Jan 25, 2023 by [Costel Maxim](/cmaxim)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


