```json
{
  "CVE-2022-4138": {
    "Description": "The default branch name for a group is not being validated correctly. When uploading a file from the web interface, a POST request is issued that includes in the request path the default branch name of a group. This allows to place in the main branch name a path with traversal path to any api endpoint and issue POST requests with the current session. An attacker can take over the victim's repository through the use case where a victim decides to use the web interface to upload a file to an empty repository to which he was invited.",
    "Root cause": "The application does not properly validate the default branch name for a group, allowing a malicious actor to inject path traversal characters. When a user uploads a file through the web interface, the application incorporates the group's default branch name into the request path without proper sanitization. This allows an attacker to manipulate the request path to target arbitrary API endpoints.",
    "Weaknesses": [
      "Insufficient input validation of group default branch name.",
      "Path traversal vulnerability."
    ],
    "Impact": "An attacker can take control of any victim's repository. By manipulating the group's default branch name, an attacker can force a victim's browser to send a POST request to an arbitrary API endpoint within the application context, using the victim's session. Specifically, the attacker can leverage the `/api/v4/projects/<ID-VICTIM-PROJECT>/import_project_members/<ID-ATTACKER-PROJECT>` endpoint to import project members, granting the attacker control of the victim's repository.",
    "Attack vectors": [
      "Web interface file upload.",
      "Manipulating group's default branch name."
    ],
    "Required attacker capabilities": [
      "Ability to create a group and project.",
      "Ability to manipulate the group's default branch name.",
      "Ability to invite the victim user to the attacker-controlled project.",
      "Victim must be an owner or maintainer of target repository",
      "Victim must perform a file upload through the web interface to the attacker controlled project."
    ]
  }
}
```