=== Content from github.com_893bdd71_20250114_224352.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fcommit%2F246f4e2a97ad81491c00a7ed72ce5e7c7f75050a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fcommit%2F246f4e2a97ad81491c00a7ed72ce5e7c7f75050a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=3dcitydb%2Fweb-feature-service)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[3dcitydb](/3dcitydb)
/
**[web-feature-service](/3dcitydb/web-feature-service)**
Public

* [Notifications](/login?return_to=%2F3dcitydb%2Fweb-feature-service) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2F3dcitydb%2Fweb-feature-service)
* [Star
   30](/login?return_to=%2F3dcitydb%2Fweb-feature-service)

* [Code](/3dcitydb/web-feature-service)
* [Issues
  0](/3dcitydb/web-feature-service/issues)
* [Pull requests
  0](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects
  0](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

Additional navigation options

* [Code](/3dcitydb/web-feature-service)
* [Issues](/3dcitydb/web-feature-service/issues)
* [Pull requests](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

## Commit

[Permalink](/3dcitydb/web-feature-service/commit/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#12](https://github.com/3dcitydb/web-feature-service/pull/12) from 3dcitydb/hotfix-prevent-xxe-vulnerabilities

[Browse files](/3dcitydb/web-feature-service/tree/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a)
Browse the repository at this point in the history

```
Prevent XXE vulnerabilities
```

* Loading branch information

[![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=40&v=4)](/clausnagel)

[clausnagel](/3dcitydb/web-feature-service/commits?author=clausnagel "View all commits by clausnagel")
authored
Jun 21, 2022

2 parents
[123da28](/3dcitydb/web-feature-service/commit/123da2830d6facbc7d863e492a173c5bc395ea9f)
+
[4da529c](/3dcitydb/web-feature-service/commit/4da529c66d94c6cc717685a25cfc5bb4cdbb4cbf)

commit 246f4e2

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**37 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGES.md
  [CHANGES.md](#diff-d975bf659606195d2165918f93e1cf680ef68ea3c9cab994f033705fea8238b2)
* build.gradle
  [build.gradle](#diff-49a96e7eea8a94af862798a45174e6ac43eb4f8b4bd40759b5da63ba31ec3ef7)
* src/main/java/vcs/citydb/wfs

  + src/main/java/vcs/citydb/wfs/WFSService.java
    [WFSService.java](#diff-b51fe97d54b6e550c7ea48ba3edc065221330e5ceea309f99c8f9a053f92d90b)
  + config

    - src/main/java/vcs/citydb/wfs/config/WFSConfigSchemaWriter.java
      [WFSConfigSchemaWriter.java](#diff-cf16d5eea9e77303d54dba4dc861103316770c32b105c092034fcc8d62805205)
  + operation

    - getfeature/citygml

      * src/main/java/vcs/citydb/wfs/operation/getfeature/citygml/CityGMLWriterBuilder.java
        [CityGMLWriterBuilder.java](#diff-c84f236e068a91ecf3dbd7283cb644c493971a1056d244f496d8a04b41740956)
    - getpropertyvalue

      * src/main/java/vcs/citydb/wfs/operation/getpropertyvalue/GetPropertyValueResponseBuilder.java
        [GetPropertyValueResponseBuilder.java](#diff-808bb50fd16917a245a7d579f9de9ab5efe80144ef542e3316a0acbf2e70fc33)
    - storedquery

      * src/main/java/vcs/citydb/wfs/operation/storedquery/StoredQueryManager.java
        [StoredQueryManager.java](#diff-61d0adf9cac8beb53e35769713d29d2ef0522e139dead99524963d6bac31442a)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[CHANGES.md](#diff-d975bf659606195d2165918f93e1cf680ef68ea3c9cab994f033705fea8238b2 "CHANGES.md")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/CHANGES.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,6 +1,11 @@ |
|  |  | Change Log |
|  |  | ========== |
|  |  |  |
|  |  | ### 5.2.1 - tba |
|  |  |  |
|  |  | #### Fixes |
|  |  | \* Fixed XXE vulnerabilities when parsing XML files. [#12](https://github.com/3dcitydb/web-feature-service/pull/12/files) |
|  |  |  |
|  |  | ### 5.2.0 - 2022-05-23 |
|  |  |  |
|  |  | This release is based on the Importer/Exporter version 5.2.0 libraries, and thus incorporates all bug fixes and updates |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[build.gradle](#diff-49a96e7eea8a94af862798a45174e6ac43eb4f8b4bd40759b5da63ba31ec3ef7 "build.gradle")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/build.gradle)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,11 +39,14 @@ repositories { |
|  |  | maven { |
|  |  | url 'https://citydb.jfrog.io/artifactory/maven' |
|  |  | } |
|  |  | maven { |
|  |  | url 'https://oss.sonatype.org/content/repositories/snapshots/' |
|  |  | } |
|  |  | mavenCentral() |
|  |  | } |
|  |  |  |
|  |  | dependencies { |
|  |  | implementation 'org.citydb:impexp-core:5.2.0' |
|  |  | implementation 'org.citydb:impexp-core:5.2.1-SNAPSHOT' |
|  |  | implementation 'com.github.seancfoley:ipaddress:5.3.4' |
|  |  | implementation 'org.glassfish.jersey.containers:jersey-container-servlet:2.35' |
|  |  | implementation 'org.glassfish.jersey.inject:jersey-hk2:2.35' |
| Expand Down | |  |

13 changes: 11 additions & 2 deletions

13
[src/main/java/vcs/citydb/wfs/WFSService.java](#diff-b51fe97d54b6e550c7ea48ba3edc065221330e5ceea309f99c8f9a053f92d90b "src/main/java/vcs/citydb/wfs/WFSService.java")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/src/main/java/vcs/citydb/wfs/WFSService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,6 +7,7 @@ |
|  |  | import org.citydb.core.util.Util; |
|  |  | import org.citydb.util.concurrent.SingleWorkerPool; |
|  |  | import org.citydb.util.log.Logger; |
|  |  | import org.citydb.util.xml.SecureXMLProcessors; |
|  |  | import org.citygml4j.builder.jaxb.CityGMLBuilder; |
|  |  | import org.citygml4j.xml.schema.SchemaHandler; |
|  |  | import org.xml.sax.InputSource; |
| Expand Down  Expand Up | | @@ -90,8 +91,16 @@ public void init() throws ServletException { |
|  |  | wfsConfig = registry.lookup(WFSConfig.class); |
|  |  |  |
|  |  | exceptionReportHandler = new WFSExceptionReportHandler(cityGMLBuilder); |
|  |  | saxParserFactory = SAXParserFactory.newInstance(); |
|  |  | saxParserFactory.setNamespaceAware(true); |
|  |  |  |
|  |  | try { |
|  |  | saxParserFactory = SecureXMLProcessors.newSAXParserFactory(); |
|  |  | saxParserFactory.setNamespaceAware(true); |
|  |  | } catch (Throwable e) { |
|  |  | String message = "Failed to enable secure processing of XML queries."; |
|  |  | log.error(message); |
|  |  | log.error(e.getMessage()); |
|  |  | throw new ServletException(message, e); |
|  |  | } |
|  |  |  |
|  |  | try { |
|  |  | StoredQueryManager storedQueryManager = new StoredQueryManager(cityGMLBuilder, saxParserFactory, getServletContext().getRealPath(Constants.STORED\_QUERIES\_PATH), wfsConfig); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/main/java/vcs/citydb/wfs/config/WFSConfigSchemaWriter.java](#diff-cf16d5eea9e77303d54dba4dc861103316770c32b105c092034fcc8d62805205 "src/main/java/vcs/citydb/wfs/config/WFSConfigSchemaWriter.java")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/src/main/java/vcs/citydb/wfs/config/WFSConfigSchemaWriter.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | package vcs.citydb.wfs.config; |
|  |  |  |
|  |  | import org.citydb.config.ConfigUtil; |
|  |  | import org.citydb.config.util.ConfigConstants; |
|  |  |  |
|  |  | import javax.xml.bind.JAXBContext; |
|  |  | import javax.xml.bind.SchemaOutputResolver; |
| Expand All | | @@ -21,7 +21,7 @@ public static void main(String[] args) throws Exception { |
|  |  | public Result createOutput(String namespaceUri, String suggestedFileName) throws IOException { |
|  |  | File file; |
|  |  |  |
|  |  | if (namespaceUri.equals(ConfigUtil.CITYDB\_CONFIG\_NAMESPACE\_URI)) |
|  |  | if (namespaceUri.equals(ConfigConstants.CITYDB\_CONFIG\_NAMESPACE\_URI)) |
|  |  | file = new File(Constants.CONFIG\_SCHEMA\_FILE); |
|  |  | else |
|  |  | file = new File(Constants.CONFIG\_SCHEMA\_PATH + "/ows/" + suggestedFileName); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/main/java/vcs/citydb/wfs/operation/getfeature/citygml/CityGMLWriterBuilder.java](#diff-c84f236e068a91ecf3dbd7283cb644c493971a1056d244f496d8a04b41740956 "src/main/java/vcs/citydb/wfs/operation/getfeature/citygml/CityGMLWriterBuilder.java")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/src/main/java/vcs/citydb/wfs/operation/getfeature/citygml/CityGMLWriterBuilder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,7 @@ |
|  |  | import org.citydb.core.operation.exporter.util.InternalConfig; |
|  |  | import org.citydb.core.operation.exporter.writer.FeatureWriteException; |
|  |  | import org.citydb.util.log.Logger; |
|  |  | import org.citydb.util.xml.SecureXMLProcessors; |
|  |  | import org.citygml4j.model.module.Module; |
|  |  | import org.citygml4j.model.module.ModuleContext; |
|  |  | import org.citygml4j.model.module.Modules; |
| Expand All | | @@ -29,7 +30,6 @@ |
|  |  | import javax.xml.datatype.DatatypeConfigurationException; |
|  |  | import javax.xml.transform.Templates; |
|  |  | import javax.xml.transform.TransformerConfigurationException; |
|  |  | import javax.xml.transform.TransformerFactory; |
|  |  | import javax.xml.transform.sax.SAXTransformerFactory; |
|  |  | import javax.xml.transform.stream.StreamSource; |
|  |  | import java.io.File; |
| Expand Down  Expand Up | | @@ -140,7 +140,7 @@ public void initializeContext( |
|  |  | && wfsConfig.getPostProcessing().getXSLTransformation().isSetStylesheets()) { |
|  |  | try { |
|  |  | List<String> stylesheets = wfsConfig.getPostProcessing().getXSLTransformation().getStylesheets(); |
|  |  | SAXTransformerFactory factory = (SAXTransformerFactory) TransformerFactory.newInstance(); |
|  |  | SAXTransformerFactory factory = (SAXTransformerFactory) SecureXMLProcessors.newTransformerFactory(); |
|  |  | Templates[] templates = new Templates[stylesheets.size()]; |
|  |  |  |
|  |  | for (int i = 0; i < stylesheets.size(); i++) { |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/main/java/vcs/citydb/wfs/operation/getpropertyvalue/GetPropertyValueResponseBuilder.java](#diff-808bb50fd16917a245a7d579f9de9ab5efe80144ef542e3316a0acbf2e70fc33 "src/main/java/vcs/citydb/wfs/operation/getpropertyvalue/GetPropertyValueResponseBuilder.java")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/src/main/java/vcs/citydb/wfs/operation/getpropertyvalue/GetPropertyValueResponseBuilder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,7 @@ |
|  |  | import org.citydb.core.database.schema.mapping.FeatureType; |
|  |  | import org.citydb.core.operation.exporter.writer.FeatureWriteException; |
|  |  | import org.citydb.util.log.Logger; |
|  |  | import org.citydb.util.xml.SecureXMLProcessors; |
|  |  | import org.citygml4j.model.module.Module; |
|  |  | import org.citygml4j.model.module.ModuleContext; |
|  |  | import org.citygml4j.model.module.Modules; |
| Expand All | | @@ -25,7 +26,6 @@ |
|  |  | import javax.xml.datatype.DatatypeConfigurationException; |
|  |  | import javax.xml.transform.Templates; |
|  |  | import javax.xml.transform.TransformerConfigurationException; |
|  |  | import javax.xml.transform.TransformerFactory; |
|  |  | import javax.xml.transform.sax.SAXTransformerFactory; |
|  |  | import javax.xml.transform.stream.StreamSource; |
|  |  | import java.io.File; |
| Expand Down  Expand Up | | @@ -124,7 +124,7 @@ public void initializeContext(GetPropertyValueType wfsRequest, |
|  |  | && wfsConfig.getPostProcessing().getXSLTransformation().isSetStylesheets()) { |
|  |  | try { |
|  |  | List<String> stylesheets = wfsConfig.getPostProcessing().getXSLTransformation().getStylesheets(); |
|  |  | SAXTransformerFactory factory = (SAXTransformerFactory) TransformerFactory.newInstance(); |
|  |  | SAXTransformerFactory factory = (SAXTransformerFactory) SecureXMLProcessors.newTransformerFactory(); |
|  |  | Templates[] templates = new Templates[stylesheets.size()]; |
|  |  |  |
|  |  | for (int i = 0; i < stylesheets.size(); i++) { |
| Expand Down | |  |

17 changes: 11 additions & 6 deletions

17
[src/main/java/vcs/citydb/wfs/operation/storedquery/StoredQueryManager.java](#diff-61d0adf9cac8beb53e35769713d29d2ef0522e139dead99524963d6bac31442a "src/main/java/vcs/citydb/wfs/operation/storedquery/StoredQueryManager.java")

Show comments

[View file](/3dcitydb/web-feature-service/blob/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a/src/main/java/vcs/citydb/wfs/operation/storedquery/StoredQueryManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  | import net.opengis.fes.\_2.FilterType; |
|  |  | import net.opengis.fes.\_2.ResourceIdType; |
|  |  | import net.opengis.wfs.\_2.\*; |
|  |  | import org.citydb.util.xml.SecureXMLProcessors; |
|  |  | import org.citygml4j.builder.jaxb.CityGMLBuilder; |
|  |  | import org.citygml4j.model.module.citygml.CityGMLModule; |
|  |  | import org.citygml4j.model.module.citygml.CityGMLModuleType; |
| Expand All | | @@ -27,6 +28,7 @@ |
|  |  | import javax.xml.parsers.SAXParser; |
|  |  | import javax.xml.parsers.SAXParserFactory; |
|  |  | import javax.xml.stream.XMLOutputFactory; |
|  |  | import javax.xml.transform.TransformerConfigurationException; |
|  |  | import javax.xml.transform.TransformerFactory; |
|  |  | import javax.xml.xpath.XPathConstants; |
|  |  | import javax.xml.xpath.XPathExpression; |
| Expand All | | @@ -35,6 +37,7 @@ |
|  |  | import java.io.BufferedReader; |
|  |  | import java.io.FileReader; |
|  |  | import java.io.IOException; |
|  |  | import java.nio.file.DirectoryStream; |
|  |  | import java.nio.file.Files; |
|  |  | import java.nio.file.Path; |
|  |  | import java.nio.file.Paths; |
| Expand All | | @@ -58,16 +61,16 @@ public class StoredQueryManager { |
|  |  | private final WFSConfig wfsConfig; |
|  |  | private final MessageDigest md5; |
|  |  |  |
|  |  | public StoredQueryManager(CityGMLBuilder cityGMLBuilder, SAXParserFactory saxParserFactory, String path, WFSConfig wfsConfig) throws ParserConfigurationException, SAXException, NoSuchAlgorithmException, IOException { |
|  |  | public StoredQueryManager(CityGMLBuilder cityGMLBuilder, SAXParserFactory saxParserFactory, String path, WFSConfig wfsConfig) throws ParserConfigurationException, SAXException, NoSuchAlgorithmException, IOException, TransformerConfigurationException { |
|  |  | this.cityGMLBuilder = cityGMLBuilder; |
|  |  | this.saxParserFactory = saxParserFactory; |
|  |  | this.wfsConfig = wfsConfig; |
|  |  |  |
|  |  | md5 = MessageDigest.getInstance("MD5"); |
|  |  | wfsFactory = new ObjectFactory(); |
|  |  | transformerFactory = TransformerFactory.newInstance(); |
|  |  | transformerFactory = SecureXMLProcessors.newTransformerFactory(); |
|  |  | xmlOutputFactory = XMLOutputFactory.newInstance(); |
|  |  | documentBuilderFactory = DocumentBuilderFactory.newInstance(); |
|  |  | documentBuilderFactory = SecureXMLProcessors.newDocumentBuilderFactory(); |
|  |  | documentBuilderFactory.setNamespaceAware(true); |
|  |  |  |
|  |  | storedQueriesPath = Paths.get(path); |
| Expand All | | @@ -83,9 +86,11 @@ public List<StoredQueryAdapter> listStoredQueries(String handle) throws WFSExcep |
|  |  | storedQueries.add(new StoredQueryAdapter(DEFAULT\_QUERY.getId())); |
|  |  |  |
|  |  | try { |
|  |  | for (Path file : Files.newDirectoryStream(storedQueriesPath)) { |
|  |  | if (Files.isRegularFile(file)) |
|  |  | storedQueries.add(new StoredQueryAdapter(file)); |
|  |  | try (DirectoryStream<Path> stream = Files.newDirectoryStream(storedQueriesPath)) { |
|  |  | for (Path file : stream) { |
|  |  | if (Files.isRegularFile(file)) |
|  |  | storedQueries.add(new StoredQueryAdapter(file)); |
|  |  | } |
|  |  | } |
|  |  | } catch (IOException e) { |
|  |  | throw new WFSException(WFSExceptionCode.OPERATION\_PROCESSING\_FAILED, "Failed to list stored queries.", handle, e); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `246f4e2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fcommit%2F246f4e2a97ad81491c00a7ed72ce5e7c7f75050a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0c6e2815_20250114_224354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Freleases%2Ftag%2Fv5.2.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Freleases%2Ftag%2Fv5.2.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=3dcitydb%2Fweb-feature-service)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[3dcitydb](/3dcitydb)
/
**[web-feature-service](/3dcitydb/web-feature-service)**
Public

* [Notifications](/login?return_to=%2F3dcitydb%2Fweb-feature-service) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2F3dcitydb%2Fweb-feature-service)
* [Star
   30](/login?return_to=%2F3dcitydb%2Fweb-feature-service)

* [Code](/3dcitydb/web-feature-service/tree/v5.2.1)
* [Issues
  0](/3dcitydb/web-feature-service/issues)
* [Pull requests
  0](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects
  0](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

Additional navigation options

* [Code](/3dcitydb/web-feature-service/tree/v5.2.1)
* [Issues](/3dcitydb/web-feature-service/issues)
* [Pull requests](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

1. [Releases](/3dcitydb/web-feature-service/releases)
2. [v5.2.1](/3dcitydb/web-feature-service/releases/tag/v5.2.1)

# v5.2.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/3dcitydb/web-feature-service/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v5.2.1)

 Loading

[View all tags](/3dcitydb/web-feature-service/tags)

![@yaozhihang](https://avatars.githubusercontent.com/u/5942971?s=40&v=4)
[yaozhihang](/yaozhihang)
released this
29 Jul 09:29

[v5.2.1](/3dcitydb/web-feature-service/tree/v5.2.1)

[`6ea2265`](/3dcitydb/web-feature-service/commit/6ea2265ac43557a633ecd8c19471c8b57b6fdf15)

This is a minor maintenance and bug fix release. See the [change log](https://github.com/3dcitydb/web-feature-service/blob/release-5.2/CHANGES.md) for the complete list of changes.

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_34febe5c_20250114_224354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fpull%2F12)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fpull%2F12)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=3dcitydb%2Fweb-feature-service)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[3dcitydb](/3dcitydb)
/
**[web-feature-service](/3dcitydb/web-feature-service)**
Public

* [Notifications](/login?return_to=%2F3dcitydb%2Fweb-feature-service) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2F3dcitydb%2Fweb-feature-service)
* [Star
   30](/login?return_to=%2F3dcitydb%2Fweb-feature-service)

* [Code](/3dcitydb/web-feature-service)
* [Issues
  0](/3dcitydb/web-feature-service/issues)
* [Pull requests
  0](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects
  0](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

Additional navigation options

* [Code](/3dcitydb/web-feature-service)
* [Issues](/3dcitydb/web-feature-service/issues)
* [Pull requests](/3dcitydb/web-feature-service/pulls)
* [Actions](/3dcitydb/web-feature-service/actions)
* [Projects](/3dcitydb/web-feature-service/projects)
* [Wiki](/3dcitydb/web-feature-service/wiki)
* [Security](/3dcitydb/web-feature-service/security)
* [Insights](/3dcitydb/web-feature-service/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2F3dcitydb%2Fweb-feature-service%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2F3dcitydb%2Fweb-feature-service%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Prevent XXE vulnerabilities #12

 Merged

[clausnagel](/clausnagel)
merged 2 commits into
[release-5.2](/3dcitydb/web-feature-service/tree/release-5.2 "3dcitydb/web-feature-service:release-5.2")
from
[hotfix-prevent-xxe-vulnerabilities](/3dcitydb/web-feature-service/tree/hotfix-prevent-xxe-vulnerabilities "3dcitydb/web-feature-service:hotfix-prevent-xxe-vulnerabilities")

Jun 21, 2022

 Merged

# [Prevent XXE vulnerabilities](#top) #12

[clausnagel](/clausnagel)
merged 2 commits into
[release-5.2](/3dcitydb/web-feature-service/tree/release-5.2 "3dcitydb/web-feature-service:release-5.2")
from
[hotfix-prevent-xxe-vulnerabilities](/3dcitydb/web-feature-service/tree/hotfix-prevent-xxe-vulnerabilities "3dcitydb/web-feature-service:hotfix-prevent-xxe-vulnerabilities")

Jun 21, 2022

[Conversation
0](/3dcitydb/web-feature-service/pull/12)
[Commits
2](/3dcitydb/web-feature-service/pull/12/commits)
[Checks
0](/3dcitydb/web-feature-service/pull/12/checks)
[Files changed](/3dcitydb/web-feature-service/pull/12/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![clausnagel](https://avatars.githubusercontent.com/u/5517439?s=60&v=4)](/clausnagel)

Copy link

Member

### @clausnagel **[clausnagel](/clausnagel)** commented [Jun 10, 2022](#issue-1267730297) • edited Loading

This PR adds necessary code to prevent [XXE vulnerabilities](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html) when parsing XML files. This mainly affects ad-hoc and stored WFS queries.

Note that this PR depends on [PR #258](https://github.com/3dcitydb/importer-exporter/pull/258) of the Importer/Exporter

Sorry, something went wrong.

All reactions

[![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=40&v=4)](/clausnagel)

`[prevent XXE vulnerabilities](/3dcitydb/web-feature-service/pull/12/commits/94e40ce0f6b11f7811f3b24bda3859bd4180f94e "prevent XXE vulnerabilities")`

`[94e40ce](/3dcitydb/web-feature-service/pull/12/commits/94e40ce0f6b11f7811f3b24bda3859bd4180f94e)`

 [![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=40&u=ca1182fb2889ec5dffb443048575f64e91862b47&v=4)](/clausnagel)
[clausnagel](/clausnagel)
requested a review
from [yaozhihang](/yaozhihang)
[June 10, 2022 15:54](#event-6787089216)

`[updated changelog](/3dcitydb/web-feature-service/pull/12/commits/4da529c66d94c6cc717685a25cfc5bb4cdbb4cbf "updated changelog")`

`[4da529c](/3dcitydb/web-feature-service/pull/12/commits/4da529c66d94c6cc717685a25cfc5bb4cdbb4cbf)`

[![yaozhihang](https://avatars.githubusercontent.com/u/5942971?s=60&v=4)](/yaozhihang)

**[yaozhihang](/yaozhihang)**
approved these changes
[Jun 20, 2022](#pullrequestreview-1012779839)

 [View reviewed changes](/3dcitydb/web-feature-service/pull/12/files/4da529c66d94c6cc717685a25cfc5bb4cdbb4cbf)

[![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=40&u=ca1182fb2889ec5dffb443048575f64e91862b47&v=4)](/clausnagel)
[clausnagel](/clausnagel)
merged commit [`246f4e2`](/3dcitydb/web-feature-service/commit/246f4e2a97ad81491c00a7ed72ce5e7c7f75050a)
into
release-5.2

[Jun 21, 2022](https://github.com/3dcitydb/web-feature-service/pull/12#event-6844146591)

 [![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=40&u=ca1182fb2889ec5dffb443048575f64e91862b47&v=4)](/clausnagel)
[clausnagel](/clausnagel)
deleted the
hotfix-prevent-xxe-vulnerabilities

branch
[June 21, 2022 05:08](#event-6844146786)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2F3dcitydb%2Fweb-feature-service%2Fpull%2F12)

Reviewers

[![@yaozhihang](https://avatars.githubusercontent.com/u/5942971?s=40&v=4)](/yaozhihang) [yaozhihang](/yaozhihang)

yaozhihang approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@clausnagel](https://avatars.githubusercontent.com/u/5517439?s=52&v=4)](/clausnagel) [![@yaozhihang](https://avatars.githubusercontent.com/u/5942971?s=52&v=4)](/yaozhihang)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


