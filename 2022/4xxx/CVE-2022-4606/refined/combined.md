=== Content from huntr.dev_a391c801_20250114_220721.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by¬†[Protect AI](https://protectai.com/)¬†and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

¬© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)

=== Content from github.com_417c6a45_20250114_220720.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fcommit%2Fc30d52b28483e1e512d0d81758d4c149f02b4068)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fcommit%2Fc30d52b28483e1e512d0d81758d4c149f02b4068)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=flatpressblog%2Fflatpress)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[flatpressblog](/flatpressblog)
/
**[flatpress](/flatpressblog/flatpress)**
Public

* [Notifications](/login?return_to=%2Fflatpressblog%2Fflatpress) You must be signed in to change notification settings
* [Fork
  57](/login?return_to=%2Fflatpressblog%2Fflatpress)
* [Star
   188](/login?return_to=%2Fflatpressblog%2Fflatpress)

* [Code](/flatpressblog/flatpress)
* [Issues
  29](/flatpressblog/flatpress/issues)
* [Pull requests
  0](/flatpressblog/flatpress/pulls)
* [Actions](/flatpressblog/flatpress/actions)
* [Projects
  0](/flatpressblog/flatpress/projects)
* [Wiki](/flatpressblog/flatpress/wiki)
* [Security](/flatpressblog/flatpress/security)
* [Insights](/flatpressblog/flatpress/pulse)

Additional navigation options

* [Code](/flatpressblog/flatpress)
* [Issues](/flatpressblog/flatpress/issues)
* [Pull requests](/flatpressblog/flatpress/pulls)
* [Actions](/flatpressblog/flatpress/actions)
* [Projects](/flatpressblog/flatpress/projects)
* [Wiki](/flatpressblog/flatpress/wiki)
* [Security](/flatpressblog/flatpress/security)
* [Insights](/flatpressblog/flatpress/pulse)

## Commit

[Permalink](/flatpressblog/flatpress/commit/c30d52b28483e1e512d0d81758d4c149f02b4068)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge branch 'master' of <https://github.com/flatpressblog/flatpress> i‚Ä¶

[Browse files](/flatpressblog/flatpress/tree/c30d52b28483e1e512d0d81758d4c149f02b4068)
Browse the repository at this point in the history

```
‚Ä¶nto issue94_smartyupdate

# resolved conflicts:
#	fp-includes/smarty/plugins/function.html_select_date.php
```

* Loading branch information

[![@azett](https://avatars.githubusercontent.com/u/22837642?s=40&v=4)](/azett)

[azett](/flatpressblog/flatpress/commits?author=azett "View all commits by azett")
committed
Oct 8, 2022

2 parents
[8bdb374](/flatpressblog/flatpress/commit/8bdb37448fbf1d64e84d7215fce044965b7f3759)
+
[d88262a](/flatpressblog/flatpress/commit/d88262ad9a2f619ffad41c594d496bab9b412dc0)

commit c30d52b

 Show file tree

 Hide file tree

Showing
**34 changed files**
with
**848 additions**
and
**310 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* CONTRIBUTORS.md
  [CONTRIBUTORS.md](#diff-c0f86987c556ec52d97b9acf0f35bb2ad0521f65c3113e1b15362ca76502eed2)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* admin

  + panels/uploader

    - admin/panels/uploader/admin.uploader.php
      [admin.uploader.php](#diff-13afdebad98a0635c375b5b07d86a4ec296e2b626aa84635c31dc432d7f28572)
  + res

    - admin/res/admin.css
      [admin.css](#diff-29fd87e06da6d5c83482ea8739a9cc6c053928013eef08b6c0454496d2769b4e)
* defaults.php
  [defaults.php](#diff-f3380e865550ba8365c8b011adb767631562f10ed28f71a19058260bd739d3ee)
* fp-includes

  + core

    - fp-includes/core/core.cookie.php
      [core.cookie.php](#diff-b2e8f1ddec4318f8d24ee7ff81bea07fdb687bd3e0fc2cff5d093aa3f803bcc5)
    - fp-includes/core/core.session.php
      [core.session.php](#diff-d34d041afe7dc1dab4ad32b886b98f9828c0198bc66b936c3a2471eec3d49937)
    - fp-includes/core/core.users.php
      [core.users.php](#diff-caae6db6c32b2c8a1f376b7c408879d7709f2395c5a6aef9feacbdaa3cbdad19)
    - fp-includes/core/core.wp-formatting.php
      [core.wp-formatting.php](#diff-d2a5c645cc7e31546cde72a3402c48340cdf4354c2f410466e1af190c8e61e2b)
    - fp-includes/core/core.wp-pluggable-funcs.php
      [core.wp-pluggable-funcs.php](#diff-3e5d252f650b061348d6927839e43a5b6eee638cb852bb5b27e9c8587c3e381f)
  + smarty/plugins

    - fp-includes/smarty/plugins/function.html\_select\_date.php
      [function.html\_select\_date.php](#diff-98dfbcb2db58c0d38ab1ef8f026456b7f5975e1451f7f687429f4eecd6c96820)
* fp-interface

  + lang/nl-nl

    - fp-interface/lang/nl-nl/lang.admin.config.php
      [lang.admin.config.php](#diff-4cc0a126ee1c6a835d47220875fb83ccb152c764394bf7546a56c9dff307ec7b)
    - fp-interface/lang/nl-nl/lang.admin.static.php
      [lang.admin.static.php](#diff-98f54119b242da91606bb0b48c9163f287acc4676453b3850eb2a6a08b16ceaa)
    - fp-interface/lang/nl-nl/lang.admin.widgets.php
      [lang.admin.widgets.php](#diff-f7caeaa6d5665418a4e3c27014c10439fac8b9cb52328565a07cd4a60f43fbf4)
    - fp-interface/lang/nl-nl/lang.comments.php
      [lang.comments.php](#diff-5b67d91701e5c07c6539e730dfda4015d5ad69559d62968a47da1c5cbb46c65f)
    - fp-interface/lang/nl-nl/lang.contact.php
      [lang.contact.php](#diff-d6720c187859f129ab7c6d367380d259ac46d86fdae39c5d7d1c7543504af4b0)
    - fp-interface/lang/nl-nl/lang.default.php
      [lang.default.php](#diff-e2cc320607463fa4b925ef357c0b66897bd459dd1cff1bd838add366b302131e)
  + sharedtpls

    - fp-interface/sharedtpls/comment-form.tpl
      [comment-form.tpl](#diff-d65b24c7be4a77d6580ea75ccc8f52acb7a965921f2faebe29c138d406d309fa)
    - fp-interface/sharedtpls/comments.tpl
      [comments.tpl](#diff-ddeff69a6eaf77a65df20b0921446c3b772668a1775e6731b7e0eb869552483a)
    - fp-interface/sharedtpls/search.tpl
      [search.tpl](#diff-c64f01aa3dcb847e3b7062ecf60330a491ed0ccecf029e38556e6916d99d9fea)
  + themes/leggero

    - flatmaas-rev/res

      * fp-interface/themes/leggero/flatmaas-rev/res/common.css
        [common.css](#diff-dba914785b8eb99a37ca055cd9552cbfcdf58a9518e3f0df80879b563413f801)
    - leggero-v2

      * res

        + fp-interface/themes/leggero/leggero-v2/res/common.css
          [common.css](#diff-0f1f7bc83a918c1134ccf54e12ee87795c0f116f71017fa0c4f933c13f7de288)
        + fp-interface/themes/leggero/leggero-v2/res/globals.css
          [globals.css](#diff-a52367571e557863d62f3a30626d2c92d201b5bfdf0e406652ab22d6d0531e2d)
      * fp-interface/themes/leggero/leggero-v2/style.conf.php
        [style.conf.php](#diff-939c0a9b1a00913077367705eed90d9f087e5b08dfb39415b3922fbc310911c1)
    - leggero

      * res

        + fp-interface/themes/leggero/leggero/res/common.css
          [common.css](#diff-439dd626118ff09d548cb3e6b9effe45ce2e0a8ca641517596ecc011d35f8acb)
        + fp-interface/themes/leggero/leggero/res/globals.css
          [globals.css](#diff-a6ee8d2f2e27f21be5daa4e46c4491db514dae5c0f5d45a62a175bd7a2427c41)
      * fp-interface/themes/leggero/leggero/style.conf.php
        [style.conf.php](#diff-3a56871cc335bff2ec305202c3bf5b2cbb78d822593a4017d6d6c2ec0abea8ae)
    - fp-interface/themes/leggero/preview.png
      [preview.png](#diff-808a406644003b495fe61eb946c9e598ae9028a0c5255535ddf0c9f06ff2cf09)
* fp-plugins

  + calendar

    - fp-plugins/calendar/plugin.calendar.php
      [plugin.calendar.php](#diff-3665d914c8b9b35d8997d0d1948226c1d6113a4157bcbeac96cc2f6628b7ba35)
  + commentcenter/lang

    - fp-plugins/commentcenter/lang/lang.de-de.php
      [lang.de-de.php](#diff-b2b357c9320942751309d06644a61c7a899b02239b408a3f8cfa6e3faeb408ad)
* login.php
  [login.php](#diff-b5866acb4c2b0d900c2623c453f9cf056193de7d29b280e8a9ceb7ef94bd28ad)
* setup

  + setup/index.php
    [index.php](#diff-d409bff02cc331e8a191cbc85d272e8f87a677930ee7f0b34d71d3914a28b3f4)
  + tpls

    - setup/tpls/header.tpl.php
      [header.tpl.php](#diff-f7d16c1824a27b002ae2f8590e6d547032dbdb57e57fa5a0e487a3b265c6e86a)

## There are no files selected for viewing

41 changes: 27 additions & 14 deletions

41
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,29 +7,42 @@ |
|  |  | - [README](https://github.com/flatpressblog/flatpress/blob/master/README.md): added "help and support" section |
|  |  |  |
|  |  | ## Plugins |
|  |  | - Gallery captions plugin added (see [#108](https://github.com/flatpressblog/flatpress/issues/108)) |
|  |  | - PhotoSwipe plugin added (see [#109](https://github.com/flatpressblog/flatpress/issues/109)) |
|  |  | - Gallery captions plugin added ([#108](https://github.com/flatpressblog/flatpress/issues/108)) |
|  |  | - PhotoSwipe plugin added ([#109](https://github.com/flatpressblog/flatpress/issues/109)) |
|  |  | - jQuery plugin: Updated jQuery (3.5.1 => 3.6) and jQueryUI (1.12.1 => 1.13.1) |
|  |  | - Media Manager plugin shows 50 items per page, not 10 |
|  |  | - LastComments plugin will not even attempt to delete or rebuild LastComments caches if LastComments plugin is not available ([#43](https://github.com/flatpressblog/flatpress/issues/43)) |
|  |  | - Comment Center config page threw errors ([#90](https://github.com/flatpressblog/flatpress/issues/90)) |
|  |  |  |
|  |  | ## Themes |
|  |  | - Leggero theme: Fixed searchbox glitch in FlatMaas revisited style (see [#97](https://github.com/flatpressblog/flatpress/issues/97)) |
|  |  | - Leggero theme: Fixed missing bullets in preview (see [#98](https://github.com/flatpressblog/flatpress/issues/98)) |
|  |  | - Leggero theme: CSS of the Leggero style had some glitches on mobile devices |
|  |  | - Leggero theme: Invalid HTML output fixed (see [#106](https://github.com/flatpressblog/flatpress/issues/106)) |
|  |  | - Leggero theme: Removed unneccessary external font resource (see [#112](https://github.com/flatpressblog/flatpress/issues/112)) |
|  |  |  |
|  |  | ## Bugfixes |
|  |  | - Comment Center config page threw errors (see [#90](https://github.com/flatpressblog/flatpress/issues/90)) |
|  |  | - Leggero |
|  |  | - Fixed searchbox glitch in FlatMaas revisited style ([#97](https://github.com/flatpressblog/flatpress/issues/97)) |
|  |  | - Fixed missing bullets in preview ([#98](https://github.com/flatpressblog/flatpress/issues/98)) |
|  |  | - CSS of the Leggero style had some glitches on mobile devices |
|  |  | - Invalid HTML output fixed ([#106](https://github.com/flatpressblog/flatpress/issues/106), [#156](https://github.com/flatpressblog/flatpress/issues/156)) |
|  |  | - Removed unneccessary external font resource ([#112](https://github.com/flatpressblog/flatpress/issues/112)) |
|  |  | - "Add comment" link has its own line ([#135](https://github.com/flatpressblog/flatpress/issues/135)) |
|  |  | - Removed legacy/invalid CSS ([#133](https://github.com/flatpressblog/flatpress/issues/133), [#134](https://github.com/flatpressblog/flatpress/issues/134)) |
|  |  | - Fixed description of Leggero and Leggero v2 styles ([#137](https://github.com/flatpressblog/flatpress/issues/137)) |
|  |  | - Obsolete bullet points removed ([#136](https://github.com/flatpressblog/flatpress/issues/136)) |
|  |  | - Updated preview image ([#139](https://github.com/flatpressblog/flatpress/issues/139)) |
|  |  |  |
|  |  | ## Internationalization |
|  |  | - Fixed glitches in Spanish an Portuguese language files |
|  |  | - Fixed wrong pt-br country code ([#100](https://github.com/flatpressblog/flatpress/issues/100)) |
|  |  | - Search page: Month names displayed in configured frontend language ([#132](https://github.com/flatpressblog/flatpress/issues/132)) |
|  |  | - German translation for Comment Center plugin added ([#148](https://github.com/flatpressblog/flatpress/issues/148)) |
|  |  |  |
|  |  | ## Other bugfixes |
|  |  | - Plugin management page: Removed empty warning messages box |
|  |  | - Fixed wrong pt-br country code (see [#100](https://github.com/flatpressblog/flatpress/issues/100)) |
|  |  | - Fixed error at prev link on first / next link on last entry (see [#95](https://github.com/flatpressblog/flatpress/issues/95)) |
|  |  | - LastComments plugin will not even attempt to delete or rebuild LastComments caches if LastComments plugin is not available (see [#43](https://github.com/flatpressblog/flatpress/issues/43)) |
|  |  | - Fixed error at prev link on first / next link on last entry ([#95](https://github.com/flatpressblog/flatpress/issues/95)) |
|  |  | - Logout redirects to home page again ([#119](https://github.com/flatpressblog/flatpress/issues/119)) |
|  |  | - Fixed disappearing non-Latin characters in page title ([#49](https://github.com/flatpressblog/flatpress/issues/49) and [#91](https://github.com/flatpressblog/flatpress/issues/91)) |
|  |  |  |
|  |  | ## Security |
|  |  | - Fixed security issue reported by huntr.dev: Session cookie missed the "secure" flag |
|  |  | - Possible XSS prevented: Session cookie missed the "secure" and "httponly" flags |
|  |  | - Possible path traversal in Media Manager plugin prevented |
|  |  | - Uploaded files wheren't checked properly ([#152](https://github.com/flatpressblog/flatpress/issues/152)) |
|  |  |  |
|  |  | # 2021-06-19: [FlatPress 1.2.1](https://github.com/flatpressblog/flatpress/releases/tag/1.2.1) |
|  |  | ## Bugfixes |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[CONTRIBUTORS.md](#diff-c0f86987c556ec52d97b9acf0f35bb2ad0521f65c3113e1b15362ca76502eed2 "CONTRIBUTORS.md")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/CONTRIBUTORS.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -37,3 +37,4 @@ FlatPress utilizes the following free frameworks and libraries. Thanks to their |
|  |  |  |
|  |  | ## Other contributions |
|  |  | - [Julian Rademacher](https://moortaube.de/) generously donated his Twitter account [@FlatPress](https://twitter.com/FlatPress). Also thanks for your useful pull requests! |
|  |  | - [Fraenkiman](https://github.com/Fraenkiman) tests FlatPress to its very core and creates a metric ton of very helpful [issues](https://github.com/flatpressblog/flatpress/issues). |

8 changes: 2 additions & 6 deletions

8
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,16 +1,16 @@ |
|  |  | [![Home page](https://img.shields.io/badge/Home%20page-üè†-555?style=plastic)](https://www.flatpress.org "Home page") |
|  |  | [![Support forum](https://img.shields.io/badge/Support%20forum-üí¨-555?style=plastic)](https://forum.flatpress.org "Support forum") |
|  |  | [![Wiki](https://img.shields.io/badge/Wiki-üìñ-555?style=plastic)](https://wiki.flatpress.org "Wiki") |
|  |  | [![Mastodon](https://img.shields.io/badge/Mastodon-üêò-555?style=plastic)](https://fosstodon.org/@flatpress "FlatPress@Mastodon") |
|  |  | [![Twitter](https://img.shields.io/badge/Twitter-üê¶-555?style=plastic)](https://twitter.com/FlatPress "FlatPress@Twitter") |
|  |  | [![Change log](https://img.shields.io/badge/Change%20log-üìú-555?style=plastic)](./CHANGELOG.md "Change log") |
|  |  | [![Security policy](https://img.shields.io/badge/Security%20policy-‚ö°-555?style=plastic)](./SECURITY.md "Security policy") |
|  |  | [![Contributors](https://img.shields.io/badge/Contributors-üòé-555?style=plastic)](./CONTRIBUTORS.md "Contributors") |
|  |  | [![Wiki](https://img.shields.io/badge/Donate-üíõ-555?style=plastic&logo=paypal)](https://www.flatpress.org/donate "Send us a little Thank You") |
|  |  |  |
|  |  | [![Releases](https://img.shields.io/github/release/flatpressblog/flatpress.svg?label=Latest%20release&style=plastic)](https://github.com/flatpressblog/flatpress/releases "See all releases") |
|  |  | [![License](https://img.shields.io/github/license/flatpressblog/flatpress.svg?style=plastic)](./LICENSE.md "License") |
|  |  | [![Open issues](https://img.shields.io/github/issues-raw/flatpressblog/flatpress?style=plastic)](https://github.com/flatpressblog/flatpress/issues "See open issues") |
|  |  | [![Last commit](https://img.shields.io/github/last-commit/flatpressblog/flatpress?style=plastic)](https://github.com/flatpressblog/flatpress/commits/ "Last commit") |
|  |  | <a href="https://fosstodon.org/users/flatpress/remote\_follow" title="Follow on Mastodon"><img alt="Mastodon Follow" src="https://img.shields.io/mastodon/follow/326815?domain=https%3A%2F%2Ffosstodon.org&style=social" alt="Follow on Mastodon"></a> <a href="https://twitter.com/intent/follow?screen\_name=flatpress" title="Follow on Twitter"><img src="https://img.shields.io/twitter/follow/flatpress.svg?style=social&logo=twitter" alt="Follow on Twitter"></a> |
|  |  |  |
|  |  | # Welcome to FlatPress! |
|  |  | FlatPress is a lightweight, easy-to-set-up blogging engine. Plain and simple, just PHP. No database needed! |
| Expand Down  Expand Up | | @@ -41,7 +41,3 @@ FlatPress runs on any web server (e.g. Apache or IIS) with PHP 7.1 or higher. Si |
|  |  |  |
|  |  | ## Credits |
|  |  | There are many people who contributed to FlatPress over the years. [See them here.](./CONTRIBUTORS.md) |
|  |  |  |
|  |  |  |
|  |  | <a href="https://fosstodon.org/users/flatpress/remote\_follow" title="Follow on Mastodon"><img alt="Mastodon Follow" src="https://img.shields.io/mastodon/follow/326815?domain=https%3A%2F%2Ffosstodon.org&style=social" alt="Follow on Mastodon"></a><br> |
|  |  | <a href="https://twitter.com/intent/follow?screen\_name=flatpress" title="Follow on Twitter"><img src="https://img.shields.io/twitter/follow/flatpress.svg?style=social&logo=twitter" alt="Follow on Twitter"></a> |

219 changes: 111 additions & 108 deletions

219
[admin/panels/uploader/admin.uploader.php](#diff-13afdebad98a0635c375b5b07d86a4ec296e2b626aa84635c31dc432d7f28572 "admin/panels/uploader/admin.uploader.php")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/admin/panels/uploader/admin.uploader.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -102,133 +102,136 @@ function onupload() { |
|  |  |  |
|  |  | foreach ($\_FILES ["upload"] ["error"] as $key => $error) { |
|  |  |  |
|  |  | if ($error == UPLOAD\_ERR\_OK) { |
|  |  | $tmp\_name = $\_FILES ["upload"] ["tmp\_name"] [$key]; |
|  |  | $name = $\_FILES ["upload"] ["name"] [$key]; |
|  |  | // Upload went wrong -> jump to the next file |
|  |  | if ($error != UPLOAD\_ERR\_OK) { |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | $tmp\_name = $\_FILES ["upload"] ["tmp\_name"] [$key]; |
|  |  | $name = $\_FILES ["upload"] ["name"] [$key]; |
|  |  |  |
|  |  | $dir = ATTACHS\_DIR; |
|  |  |  |
|  |  | /\* |
|  |  | \* second check extension list |
|  |  | \* https://stackoverflow.com/questions/4166762/php-image-upload-security-check-list |
|  |  | \* |
|  |  | \* 2019-11-24 - laborix |
|  |  | \*/ |
|  |  |  |
|  |  | $uploadfilename = strtolower($name); |
|  |  |  |
|  |  | $dir = ATTACHS\_DIR; |
|  |  | $isForbidden = false; |
|  |  | $deeptest = array(); |
|  |  | $extcount = 0; |
|  |  | $deeptest = explode('.', $uploadfilename); |
|  |  | $extcount = count($deeptest); |
|  |  |  |
|  |  | if ($extcount == 1) { |
|  |  | /\* |
|  |  | \* second check extension list |
|  |  | \* https://stackoverflow.com/questions/4166762/php-image-upload-security-check-list |
|  |  | \* none extension like .jpg or something else |
|  |  | \* |
|  |  | \* 2019-11-24 - laborix |
|  |  | \* possible filename = simple-file-without-extension - linux like ok |
|  |  | \*/ |
|  |  |  |
|  |  | $uploadfilename = strtolower($tmp\_name); |
|  |  |  |
|  |  | $isForbidden = false; |
|  |  | $deeptest = array(); |
|  |  | $extcount = 0; |
|  |  | $deeptest = explode('.', $uploadfilename); |
|  |  | $extcount = count($deeptest); |
|  |  |  |
|  |  | if ($extcount == 1) { |
|  |  | /\* |
|  |  | \* none extension like .jpg or something else |
|  |  | \* |
|  |  | \* possible filename = simple-file-without-extension - linux like ok |
|  |  | \*/ |
|  |  | $isForbidden = false; |
|  |  | } elseif ($extcount == 2) { |
|  |  | /\* |
|  |  | \* Only one possible extension |
|  |  | \* |
|  |  | \* possible filename = 1.jpg |
|  |  | \* possible filename = admin.uploader.php |
|  |  | \* possible filename = .htaccess |
|  |  | \* and so on... |
|  |  | \*/ |
|  |  | $check\_ext1 = ""; |
|  |  | $check\_ext1 = trim($deeptest [1], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext1, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  | } elseif ($extcount > 2) { |
|  |  | /\* |
|  |  | \* Chekc only the last two possible extensions |
|  |  | \* |
|  |  | \* Hint: OWASP - Unrestricted File Upload |
|  |  | \* |
|  |  | \* In Apache, a php file might be executed using the |
|  |  | \* double extension technique such as "file.php.jpg" |
|  |  | \* when ".jpg" is allowed. |
|  |  | \* |
|  |  | \* possible filename = 1.PhP.jpg |
|  |  | \* possible filename = admin.uploader.php.JPg |
|  |  | \* and so on... |
|  |  | \*/ |
|  |  | $check\_ext1 = ""; |
|  |  | $check\_ext2 = ""; |
|  |  | $check\_ext1 = trim($deeptest [$extcount - 1], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext1, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  | /\* Test only if first extension check are not in the blacklist \*/ |
|  |  | if (!$isForbidden) { |
|  |  | $check\_ext2 = trim($deeptest [$extcount - 2], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext2, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } elseif ($extcount == 2) { |
|  |  | /\* |
|  |  | \* If one blacklisted extension found then |
|  |  | \* return with -1 = An error occurred while trying to upload. |
|  |  | \* Only one possible extension |
|  |  | \* |
|  |  | \* possible filename = 1.jpg |
|  |  | \* possible filename = admin.uploader.php |
|  |  | \* possible filename = .htaccess |
|  |  | \* and so on... |
|  |  | \*/ |
|  |  | if ($isForbidden) { |
|  |  | $this->smarty->assign('success', $success ? 1 : -1); |
|  |  | sess\_add('admin\_uploader\_files', $uploaded\_files); |
|  |  | return -1; |
|  |  | $check\_ext1 = ""; |
|  |  | $check\_ext1 = trim($deeptest [1], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext1, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  |  |
|  |  | } elseif ($extcount > 2) { |
|  |  | /\* |
|  |  | \* third check extension |
|  |  | \* if someone upload a .php file as .gif, .jpg or .txt |
|  |  | \* if someone upload a .html file as .gif, .jpg or .txt |
|  |  | \* Chekc only the last two possible extensions |
|  |  | \* |
|  |  | \* Hint: OWASP - Unrestricted File Upload |
|  |  | \* |
|  |  | \* In Apache, a php file might be executed using the |
|  |  | \* double extension technique such as "file.php.jpg" |
|  |  | \* when ".jpg" is allowed. |
|  |  | \* |
|  |  | \* 2019-11-24 - laborix |
|  |  | \* possible filename = 1.PhP.jpg |
|  |  | \* possible filename = admin.uploader.php.JPg |
|  |  | \* and so on... |
|  |  | \*/ |
|  |  |  |
|  |  | if (version\_compare(PHP\_VERSION, '5.3.0') < 0) |
|  |  | return -1; |
|  |  | if (!function\_exists('finfo\_open')) |
|  |  | return -1; |
|  |  |  |
|  |  | $finfo = finfo\_open(FILEINFO\_MIME\_TYPE); |
|  |  | $mime = finfo\_file($finfo, $tmp\_name); |
|  |  | finfo\_close($finfo); |
|  |  |  |
|  |  | if (($mime == "text/x-php") || ($mime == "text/html")) { |
|  |  | $this->smarty->assign('success', $success ? 1 : -1); |
|  |  | sess\_add('admin\_uploader\_files', $uploaded\_files); |
|  |  | return -1; |
|  |  | $check\_ext1 = ""; |
|  |  | $check\_ext2 = ""; |
|  |  | $check\_ext1 = trim($deeptest [$extcount - 1], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext1, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  | /\* Test only if first extension check are not in the blacklist \*/ |
|  |  | if (!$isForbidden) { |
|  |  | $check\_ext2 = trim($deeptest [$extcount - 2], "\x00..\x1F"); |
|  |  | if (in\_array($check\_ext2, $blacklist\_extensions)) { |
|  |  | $isForbidden = true; |
|  |  | } else { |
|  |  | $isForbidden = false; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | /\* |
|  |  | \* If one blacklisted extension found then |
|  |  | \* return with -1 = An error occurred while trying to upload. |
|  |  | \*/ |
|  |  | if ($isForbidden) { |
|  |  | $this->smarty->assign('success', $success ? 1 : -1); |
|  |  | sess\_add('admin\_uploader\_files', $uploaded\_files); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | $ext = strtolower(strrchr($name, '.')); |
|  |  | /\* |
|  |  | \* third check extension |
|  |  | \* if someone upload a .php file as .gif, .jpg or .txt |
|  |  | \* if someone upload a .html file as .gif, .jpg or .txt |
|  |  | \* |
|  |  | \* 2019-11-24 - laborix |
|  |  | \*/ |
|  |  |  |
|  |  | if (version\_compare(PHP\_VERSION, '5.3.0') < 0) |
|  |  | return -1; |
|  |  | if (!function\_exists('finfo\_open')) |
|  |  | return -1; |
|  |  |  |
|  |  | $finfo = finfo\_open(FILEINFO\_MIME\_TYPE); |
|  |  | $mime = finfo\_file($finfo, $tmp\_name); |
|  |  | finfo\_close($finfo); |
|  |  |  |
|  |  | if (($mime == "text/x-php") || ($mime == "text/html")) { |
|  |  | $this->smarty->assign('success', $success ? 1 : -1); |
|  |  | sess\_add('admin\_uploader\_files', $uploaded\_files); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | if (in\_array($ext, $imgs)) { |
|  |  | $dir = IMAGES\_DIR; |
|  |  | } |
|  |  | $ext = strtolower(strrchr($name, '.')); |
|  |  |  |
|  |  | if (in\_array($ext, $imgs)) { |
|  |  | $dir = IMAGES\_DIR; |
|  |  | } |
|  |  |  |
|  |  | $name = sanitize\_title(substr($name, 0, -strlen($ext))) . $ext; |
|  |  | $name = sanitize\_title(substr($name, 0, -strlen($ext))) . $ext; |
|  |  |  |
|  |  | $target = "$dir/$name"; |
|  |  | @umask(022); |
|  |  | $success = move\_uploaded\_file($tmp\_name, $target); |
|  |  | @chmod($target, 0766); |
|  |  | $target = "$dir/$name"; |
|  |  | @umask(022); |
|  |  | $success = move\_uploaded\_file($tmp\_name, $target); |
|  |  | @chmod($target, 0766); |
|  |  |  |
|  |  | $uploaded\_files [] = $name; |
|  |  | $uploaded\_files [] = $name; |
|  |  |  |
|  |  | // one failure will make $success == false :) |
|  |  | $success &= $success; |
|  |  | } |
|  |  | // one failure will make $success == false :) |
|  |  | $success &= $success; |
|  |  | } |
|  |  |  |
|  |  | if ($uploaded\_files) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[admin/res/admin.css](#diff-29fd87e06da6d5c83482ea8739a9cc6c053928013eef08b6c0454496d2769b4e "admin/res/admin.css")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/admin/res/admin.css)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -167,7 +167,7 @@ input.maxsize { width: 99% } |
|  |  | #main ul.msgs, ul.msgs { |
|  |  | margin-top: 1em; |
|  |  | margin-left: 0em; |
|  |  | padding: 1em 2em |
|  |  | padding: 1em 2em; |
|  |  | } |
|  |  |  |
|  |  | .errors { |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[defaults.php](#diff-f3380e865550ba8365c8b011adb767631562f10ed28f71a19058260bd739d3ee "defaults.php")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/defaults.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -121,6 +121,7 @@ |
|  |  | $serverport = "false"; |
|  |  | // Unterst√ºtzung f√ºr Apache und IIS |
|  |  | ini\_set('session.cookie\_secure', 1); |
|  |  | ini\_set('session.cookie\_httponly', 1); |
|  |  | if (isset($\_SERVER ['HTTPS']) && ($\_SERVER ['HTTPS'] == '1' || strtolower($\_SERVER ['HTTPS']) == 'on')) { |
|  |  | $serverport = "https://"; |
|  |  | } else { |
| Expand Down | |  |

18 changes: 10 additions & 8 deletions

18
[fp-includes/core/core.cookie.php](#diff-b2e8f1ddec4318f8d24ee7ff81bea07fdb687bd3e0fc2cff5d093aa3f803bcc5 "fp-includes/core/core.cookie.php")

Show comments

[View file](/flatpressblog/flatpress/blob/c30d52b28483e1e512d0d81758d4c149f02b4068/fp-includes/core/core.cookie.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,8 @@ function cookie\_setup() { |
|  |  | define('COOKIE\_DOMAIN', false); |
|  |  | if (!defined('COOKIE\_SECURE')) |
|  |  | define('COOKIE\_SECURE', true); |
|  |  | if (!defined('COOKIE\_HTTPONLY')) |
|  |  | define('COOKIE\_HTTPONLY', true); |
|  |  | } |
|  |  |  |
|  |  | if (!function\_exists('wp\_get\_cookie\_login')) : |
| Expand Down  Expand Up | | @@ -62,20 +64,20 @@ function cookie\_set($username, $password, $already\_md5 = false, $home = '', $sit |
|  |  | else |
|  |  | $expire = 0; |
|  |  |  |
|  |  | setcookie(USER\_COOKIE, $username, $expire, $cookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(PASS\_COOKIE, $password, $expire, $cookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(USER\_COOKIE, $username, $expire, $cookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | setcookie(PASS\_COOKIE, $password, $expire, $cookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  |  |
|  |  | if ($cookiepath != $sitecookiepath) { |
|  |  | setcookie(USER\_COOKIE, $username, $expire, $sitecookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(PASS\_COOKIE, $password, $expire, $sitecookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(USER\_COOKIE, $username, $expire, $sitecookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | setcookie(PASS\_COOKIE, $password, $expire, $sitecookiepath, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function cookie\_clear() { |
|  |  | setcookie(USER\_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(PASS\_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(USER\_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(PASS\_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE); |
|  |  | setcookie(USER\_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | setcookie(PASS\_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | setcookie(USER\_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | setcookie(PASS\_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE\_DOMAIN, COOKIE\_SECURE, COOKIE\_HTTPONLY); |
|  |  | } |
|  |  |  |
|  |  | if (!function\_exists('wp\_login')) : |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c30d52b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fflatpressblog%2Fflatpress%2Fcommit%2Fc30d52b28483e1e512d0d81758d4c149f02b4068) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


