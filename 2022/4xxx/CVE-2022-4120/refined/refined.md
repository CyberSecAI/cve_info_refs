- **Root cause of vulnerability:** The plugin passes base64 encoded user input to the `unserialize()` PHP function when CAPTCHA is used as a second challenge. This can lead to PHP Object Injection.
- **Weaknesses/vulnerabilities present:** Unsafe deserialization of user-controlled data. The plugin is vulnerable to PHP Object Injection due to the use of the `unserialize()` function on base64 encoded data without proper sanitization.
- **Impact of exploitation:** Arbitrary code execution. An attacker could inject malicious PHP objects, leading to arbitrary code execution if a suitable gadget chain exists within the WordPress environment. The provided Proof of Concept demonstrates a simple example of this, resulting in a "Arbitrary deserialization" message upon successful exploitation.
- **Attack vectors:** An attacker could send a malicious payload via the `kp` parameter within a POST request to `/wp-login.php` while a CAPTCHA is used as the second challenge.
- **Required attacker capabilities/position:** The attacker does not need to be authenticated to exploit the vulnerability. They need to be able to make HTTP POST requests to the vulnerable endpoint `/wp-login.php` while triggering the secondary CAPTCHA challenge. They must have knowledge of a valid gadget chain for successful exploitation.