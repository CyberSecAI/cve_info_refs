```json
{
  "vulnerability": {
    "root_cause": "The `lib/banzai/filter/commit_trailers_filter.rb` uses `User.find_by_any_email` to find user handle from an email address, and `User.find_by_any_email` doesn't respect the email policy, allowing retrieval of user information based on private email addresses.",
    "weaknesses": [
      "Improper access control",
       "Information disclosure"
    ],
    "impact": "Users can look up accounts with private email addresses, potentially exposing user information that is intended to be kept private.",
    "attack_vectors": "By including a 'Co-authored-by:' or similar commit trailer in a git commit message with a target user's private email address. This commit message is then pushed to a git repository hosted on the vulnerable GitLab instance.",
    "required_capabilities": "An authenticated user that has the ability to create or push commits to a GitLab repository.",
    "details": "The vulnerability exists because the `CommitTrailersFilter` uses the method `User.find_by_any_email`, which does not respect the email privacy settings when processing commit trailers. This allows to leak the user profile information via the generated commit trailer HTML markup, despite the fact that users with private emails can't be found by search API call `https://gitlab.com/api/v4/users?search=email@example.com`"
  }
}
```