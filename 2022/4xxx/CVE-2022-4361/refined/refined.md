Based on the provided content, here's an analysis of CVE-2022-4361:

**Root Cause of Vulnerability:**
The vulnerability stems from a lax URI scheme validation within the Keycloak authorization server. Specifically, the server doesn't properly validate redirect URIs, allowing for the use of non-HTTP(S) custom schemes without explicit inclusion in the allowed patterns.

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Redirect URI Validation:** The authorization server fails to properly validate the scheme of redirect URIs, allowing non-standard schemes.
- **Open Redirect:** The lack of strict validation on redirect URIs allows an attacker to potentially redirect users to malicious sites.
- **Cross-Site Scripting (XSS):** By crafting a malicious redirect URI, specifically in the AssertionConsumerServiceURL or redirect\_uri parameters, an attacker could potentially inject and execute arbitrary JavaScript code in the user's browser.

**Impact of Exploitation:**
- **Phishing Attacks:** Attackers could leverage the open redirect vulnerability to redirect users to malicious websites that impersonate the legitimate site, tricking users into revealing sensitive information.
- **XSS Attacks:** Successful exploitation can lead to the execution of arbitrary JavaScript code in a user's browser, potentially leading to session hijacking, data theft, or defacement of the website.
- **Compromise of User Accounts:** By executing malicious scripts, attackers could gain control over the user's session and potentially compromise the user's account.

**Attack Vectors:**
- **Malicious Redirect URI:** An attacker crafts a malicious redirect URI that uses a non-standard scheme (e.g. `javascript:`) and injects it into the `redirect_uri` parameter or a similar URL parameter like `AssertionConsumerServiceURL`.
- **User Interaction:** The user would need to interact with the crafted URI, typically by clicking a link.

**Required Attacker Capabilities/Position:**
- **Ability to Influence Redirect URI:** The attacker must be able to control the value of the `redirect_uri` parameter in the authorization request, or the `AssertionConsumerServiceURL` in the SAML flow.
- **User Engagement:** The attacker needs a user to interact with the crafted malicious URI.

**Technical Details**
The fix involves changes to `org.keycloak.protocol.oidc.utils.RedirectUtils.java`
- The code now explicitly validates if a redirect URI with a custom scheme is allowed by the validation pattern. If a custom scheme is used, it needs to be explicitly allowed in the validation pattern (e.g., `custom:/app/*`).
- A general pattern like `*` no longer covers non-http(s) schemes for security reasons.
- The code now checks the scheme of the redirect URI is http(s) or is explicitly allowed.
- Additional test cases were added to ensure proper handling of various redirect URI scenarios including non-http(s) schemes.

**Additional Notes:**
- The vulnerability is present in both SAML and OIDC providers.
- The vulnerability has been addressed in Red Hat Single Sign-On versions 7.6 and RHEL-8 based Middleware Containers.
- The provided Github commit ([a1cfe6e24e5b34792699a00b8b4a8016a5929e3a](https://github.com/keycloak/keycloak/commit/a1cfe6e24e5b34792699a00b8b4a8016a5929e3a)) shows the fix applied to Keycloak, where scheme validation was improved.
- The fix does not consider a general wildcard `*` as valid for custom schemes.

This information is more detailed than what is provided in a typical CVE description.